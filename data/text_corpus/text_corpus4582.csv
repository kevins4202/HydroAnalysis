index,text
22910,this work intends to propose a high level control method for use in multiple dynamic positioned vessels to perform synchronized motion control while towing floating unactuated loads connected through cables the idea consists in usage of a cooperative control structure in which the vessels share its positions readings through a wireless network while correcting their own relative positions independently through a consensus algorithm global formation positioning is achieved through the introduction of a virtual consensus leader and its positions are dynamically corrected to take the cargo to the required positions coordinated motions of the formation ensure the load is taken to its set point simulation results for illustrative cases are presented and discussed keywords cooperative control dynamic positioning autonomous operations 1 introduction as the world heads to increasing levels of automation in the daily life where unmanned aerial vehicles uav s will deliver order packages and autonomous cars are expected to take streets soon it is probably unknown to most people that dynamic positioning dp vessels were one of the first and most successful applications of cybernetics to reach industry such success can be credited to the dynamic positioning systems dps own autonomous nature which permitted the automatic station keeping capacity required for year s length offshore missions as such marine operations grow larger and more complex the requirements for a higher number of agents from vessels to equipment working simultaneously and cooperatively become evident in this scenario the ability to perform such tasks safely coordinating all these elements will eventually reach human limits bounding also the complexity that can be achieved enhanced levels of autonomy emerge as a response to these requirements giving margin to safer larger and possibly more cost effective operations current state of the art technologies in robotics and autonomous systems along with great advances in bandwidth availability and in reliability of wireless communication systems have permitted the development of large scale multi robot and multi autonomous vehicle architectures able to solve cooperatively tasks that wouldn t be possible with a single agent in murray 2006 a list of several devised applications for multi vehicle operations is presented including examples for autonomous cars unmanned aerial vehicles satellite arrays and mixed vehicles given such examples it is easy to think also of sets of marine vehicles such as autonomous underwater vehicles auv s and autonomous surface vehicles asv s that could perform cooperative tasks and eventually enable large and complex offshore and even restricted waters operations dp vessels thought of as actual drone ships are interesting candidates for the application of marine multi agent missions their flexibility and already highly automated operational capacity might be enhanced with the introduction of cooperative systems concepts this represents a step up in the automation tasks a dp system may perform beyond the already mentioned station keeping and the trajectory tracking path following capacities already present in most of current industrial systems formation keeping tasks with multiple vessels automated collision avoidance between agents and distributed load carrying and holding may be introduced fig 1 shows an example of an operation that could take advantage of such system the installation of an underwater tunnel module uses four tugboats to position a floating barge as the tugboats are human operated accuracy in such positioning is limited to make sure the module keeps its position during the descent and installation the hoisting barge must be anchored this of course limits the application of such technique to shallow waters and very mild environmental conditions as shall be seen the simple usage of dp capable tugboats might render stability issues the task might be accomplished with less restriction if the boats were running a cooperative dp algorithm other applications devised for cooperative control systems applied to dp vessels are subsea installation operations with joint materials hoisting rescue multiple tug boat load maneuvering and large cargo transportation when designed as multiple agent tasks these operations can be advantageous by reducing overall costs enhancing operational safety and reliability due to redundancy and by enabling large configuration flexibility it was not until very recently that marine vessels have been discussed as a target for application of a cooperative control concept some works like skjetne et al 2002 kyrkjebo and pettersen 2003 ihle et al 2005 and arrichiello et al 2006 exploit path following and trajectory tracking missions of marine vessels working in coordination researches in cooperative control applied to dp systems are even scarcer in queiroz filho and tannuri 2017 an extensive experimental analysis of a consensus based control law applied to dp vessels was presented in peng et al 2016 a cooperative dp control system using the so called dynamic surface control dsc combined with an adaptive algorithm that observes and corrects the control law to respond to oceanic disturbances nonlinear methods were presented in ianagui and tannuri 2015 and ianagui et al 2016 where numerical and experimental results were presented the subject cooperative multi agent systems is rather broad and involve notions from computer science to mechatronics the most studied topics in this area for application in multi vehicle systems are the cooperative control methods these methods involve decision making cooperative motion planning and actual control theory required to perform the cooperative tasks to accomplish such objectives the vehicles may be required to collectively adopt several behaviors such as but not restricted to swarming flocking setting a formation and navigating in it tracking a leader and avoid collisions these behaviors can be achieved through the application of collective control laws referred in literature as cooperative protocols which can be either calculated in centralized fashion or distributed among the agents while centralized control is easier and can be designed through classical control methods it lacks robustness flexibility and scalability to be applied in larger scale systems within this set of requirements distributed cooperative methods are usually preferable for application in multi agent control the present work consists in the application of a decentralized cooperative control algorithm to perform autonomous operations using multiple support vessels with the objective to tow and hold a floating structure it is an extension of the work proposed in ianagui et al 2017 where preliminary results were presented the main features of this architecture are cited as follows motion synchronization a leader tracking algorithm can be used to make all dp vessels move with controlled relative positioning in all degrees of freedom and following a desired joint trajectory harder tasks like changing the heading of the whole formation as opposed to changing the heading of all individual vessels are performed in a simple manner this becomes even more advantageous when a larger number of vessels is to be controlled scalability the usual cooperative algorithms are distributed and easily scalable which once again presents an advantage when many vessels are assigned stability the introduction of restrictions between agents like cable connections does not destabilize the overall system load position correction when carrying a load with multiple vessels the leader position may be corrected online to relocate the load to a desired position while not very different from the control structures that are applied to other vehicles the cooperative algorithms needed for dp vessels must address some specific challenges like the persistent and or random punctual disturbances from waves winds and currents the communication topologies used should also be correctly addressed to keep the system safe reliable and available 2 cooperative control of dp vessels the architecture proposed for the cooperative dp system is presented in fig 2 the control is decentralized so the wireless communication structure illustrated in the figure is not a hardware implementation this block represents what will be defined later in terms of a graph communication topology between the agents each vessel sends its own position relative position references are broadcast fig 3 shows the internal blocks of each agent depicted in the last figure the system considers that a standard local dp system is running in each single vessel wind feedforward compensation is not shown but may be present the cooperative controller sees the junction dps vessel as a single plant and sends position references to it this controller can be seen in a way as a guidance system the cooperative controller may be accompanied by a local kalman filter which estimates the data of all neighbor agents this enhances the overall system robustness as in the event of a network shortage the neighbor agents positions can be integrated dead reckoning to find a cooperative control rule hereafter mentioned as protocol a simple second order model for the motion equations of the joint block vessel dps is considered equation 1 presents such model 1 x 1 x 2 0 i 3 3 a 0 a 1 x 1 x 2 0 b 1 u y 1 0 x 1 x 2 in which x 1 and x 2 are the state vectors corresponding to the global reference frame positions easting northing and heading represented here by x y and ψ and velocities x y and ψ respectively y is the observation vector and u is the desired position vector the matrices a 0 a 1 and b 1 are given by 2 a 1 2 ζ x ω n x 2 0 0 0 2 ζ y ω n y 2 0 0 0 2 ζ ψ ω n ψ 2 a 0 ω n x 2 0 0 0 ω n y 2 0 0 0 ω n ψ 2 b 1 a 0 the variables ω n i and ζ i i x y ψ are the natural frequency and the relative damping factor of the system respectively their values depend on the dp control system tuning with ζ i usually between 0 6 and 0 9 fossen 2011 and ω n i depending on the vessel size both can be easily recovered from step responses of the dp vessel by expressions 3 and 4 or by other system identification technique 3 ω n 2 π δ t 1 ζ 2 4 ζ ln m p π 2 ln m p 2 here m p is the overshoot as a fraction of the step input and δ t is the time interval between two consecutive peaks on the plot of the step response for multiple vessels the dynamic state equation 1 is to be indexed consider each dp vessel dynamics with the form 5 x i a i x i b i u i i 1 2 n here n is the number of vessels to be cooperatively controlled our objective is to define a decentralized set point generation law u i f x i j n that fulfills the required tasks the strategies presented are based on the definition of a consensus problem where multiple agents outputs are required to reach a consensus value in a coordination variable by defining this basic problem standard cooperative tasks such as formation keeping and leader following behavior can be described a thorough discussion on linear consensus theory can be found in ren et al 2007 suppose that the vessels controllers can communicate wirelessly sending each its own position and velocity and receiving such data from neighbor vessels here the concept of neighbor does not mean necessarily physical proximity but depends on how the communication topology is defined in the cooperative control area the usual way to represent such topology is by means of communication graphs a graph is defined as a pair g v e where v is a set v 1 v 2 v n called vertices or nodes set and e is a set of pairs v i v j called edges in a multi agent communication structure each vertex represents a single agent and each edge represents the availability of information between edges in a standard or undirected edge v i v j v j v i this means from the multi agent network design point of view that information is shared bi directionally i e the agent nodes connected through this edge have access to each other s states in an oriented edge v i v j v j v i which means that information is shared in only one direction and only one agent has access to the other s states graphically an oriented edge is represented through an arrow in which the point enters v j and the tail leaves v i an oriented or directed graph is also called a digraph the in degree of a node v i is the number of edges pointing to v i the neighbors of node are the set n i v j v j v i e i e it is the set of nodes with edges pointing to v i the neighbor set number of elements n i is equal to the in degree of v i each edge v j v i can be associated with a weighting factor a i j 0 fig 4 a when this is considered the neighbor set can be defined as n i v j a i j 0 a directed path is a sequence of edges v 0 v 1 v r v i v i 1 e if there is a directed path from v i to v j it is said that v i is connected to v j a graph is said to be strongly connected if any pair v i v j v i j is connected a directed tree fig 4 b is a digraph in which every node except one called root node has in degree equal to one a graph has a spanning tree if a subset of its edges forms a spanning tree this is equivalent to say that all the vertices of this graph are reachable if starting from a single vertex and following the edges arrows a graph can have multiple spanning trees a set of root nodes or leader set is the set of all roots of all spanning trees of a graph if a graph is strongly connected it has at least one spanning tree and all vertices are roots for a graph with edges weighted through a i j the adjacency matrix a is defined as 6 a a i j a i j 0 i f v j v i e a i j 0 i f v j v i e the weighted in degree d i of a node v i is the sum of the elements of the i t h row of the adjacency matrix 7 d i j 1 n a i j the in degree matrix d is defined as 8 d d i a g d i with the in degree definition the laplacian matrix can also be defined as 9 l d a now return to the problem of finding u i f x i j n for equation 5 a linear consensus control law or protocol for this system is will be given by lewis et al 2014 10 u i c k j n i a i j x j x i here n i is the set of neighbors of the i t h agent and a i j are the weight entrances of the graph edges c is a positive synchronization variable and k is a gain matrix to be designed the stability properties of the closed loop system with protocol 10 is equivalent of the stability properties of the n systems 11 e i a i c λ i b i k e i f o r i 1 2 n in which λ i are the eigenvalues of the laplacian matrix and e i is the relative error vector calculation of the gains c and k required to reach stability are an extensive topic their values depend on the graph topology note λ i also determine the cooperative system dynamics stability attendance for the gains can be found through standard linear theory applied in each block of equation 11 such as the routh stability criteria ogata 1970 optimal definition of gains for consensus problems are given in li duan 2015 and in lewis et al 2014 the latter proposes for instance k that is independent of the graph topology 12 k r 1 b i t p in which p is the unique positive definite solution of the control algebraic riccati equation 13 a i t p p a i q p b i r 1 b i t p 0 throughout the text it will be assumed that the graphs have fixed structure and at least one spanning tree under these conditions the gain calculated 12 provides asymptotical stability as long as the coupling gain c satisfies 14 c 1 2 min r e λ i f o r a l l λ i 0 even though the standard consensus theory can provide control over the relative states of multiple agents it is rather limited in the way it was presented to enforce some desired behaviors on the agents that are of operational practice the protocol and graph topology are now discussed in order to provided formation control and leader following behavior which are more applicable in the operations of marine vehicles formation control can be achieved through the introduction of reference relative position signals δ i j between the agents in the control inputs for the most general case 15 u i c k j n i a i j x j x i δ ji the reference signals do not need to be constant along time which means that a trajectory generation law can be input to enforce a dynamically varying formation when thinking about a dp system mass spring damper analogy fig 5 a the introduction of such law corresponds to adding extra spring damper sets between the vessels as can be seen in fig 5 b see fig 6 the consensus algorithm does not provide means to control the general location of the agents and the formation function from equation 15 controls only relative position full controllability of the cooperative positioning behavior can be achieved through the introduction of a leader agent this is consensus leader following is referred in literature as consensus tracking consensus tracking can only be introduced in digraphs by the usage of one root node of a spanning tree that has in degree equal to zero in this case the row of the adjacency the in degree and the laplacian matrixes corresponding to this node has all elements equal to zero the overall result is that the consensus value reached for every agent except the leader is the initial leader state lewis et al 2014 note that the leader node is not required to be a real ship its positions can be defined as a sequence of set point signals with prescribed profile respecting the real agents performance restrictions in fact this behavior is even desirable as the eventual failure of an agent defined as the leader system could handle the cooperative system uncontrollable in fig 5 b such method is exemplified with l the central leader node reference 3 application to load positioning consider a system composed of a load and n support vessels indexed by i i 0 corresponds to the load i 1 2 n corresponds to the holding vessel each with total inertia m i considering the hydrodynamic added mass connected by cables of horizontal restoring coefficient k both support vessels have dp controllers and keep their positions while connected to the central load drilling rig this analysis will consider the vessels motion only in the x axis surge direction as shown in the figure below the objective is to modulate the formation s virtual leader position in order to correct the overall formation position online and take keep the load in a desired position eliminating offset errors caused by environmental loads the dynamics of each vessel are considered linear and approximated by 16 m x i f t h r i c r x 1 k x 0 x i l 0 m 0 x 0 c r 0 x 0 2 k x 0 k x 1 x 2 where x 0 and x i are the positions of the rig and of each vessel i respectively c r is a linear viscous drag coefficient f t h r i are the vessels required thruster forces k is the cable restoring coefficient and l 0 its paid length the support vessels masses are equal to m and the drilling rig mass and drag coefficient are given respectively by m 0 and c r 0 each holding vessel is locally positioned by a pid controller 17 f t h r i k p x i x i d k d x i x i d k i x i x i d d t in which k p k i and k d are the controller gains and x i d are the set point positions given to the controller the vessels are kept with their relative positions controlled through a cooperative algorithm given by 18 x i d x i c j n i a i j k 1 x j x i δ i j k 2 x j x i where δ i j are the desired formation relative positions between vessels i and j when i 0 in 18 the rig position x 0 will be replaced by the desired rig position x 0 d this value corresponds to that of a virtual leader to vessels 1 and 2 the gains k 1 k 2 and c are the consensus gains that can be calculated through equations 12 14 if the communication topology graph is connected equations 16 18 can be combined by means of an auxiliary state variable w i 1 n x i 19 m w k d c r k p c k 2 w k k p c k 1 k i c k 2 w 2 k x 0 k i c k 1 w d t 2 c k p k 1 k i k 2 u 2 k p c k 2 u 2 k i c k 1 u d t m x 0 c r 0 x 0 k x 0 0 5 k w here symmetry in the reference formation relative positions is assumed which means that i 1 n δ i j 0 equation 19 represents a fifth order siso system which can be controlled through any linear method for instance control may be performed through a proportional integral pi controller applied to the leader virtual dynamics input 20 u k p x 0 d x 0 k i x 0 d x 0 d t in which x 0 d is the virtual leader desired position vector and k p and k i are positive gains note that this is a high level controller which intends only to regulate the target position in face of external disturbances this means that the time constant of the plant must be kept the overall architecture of the proposed application for two support vessels can be seen in fig 7 a reference generator block is added to provide smoothed inputs for the controllers 4case study load hold back and maneuvering this section describes a case study using four dp anchor handling tug supply ahts vessels and an unactuated drilling rig this setup is similar to what would be required to position the tunnel construction module mentioned in the introduction although it is performed in a larger scale the system considered is an expansion of the situation studied in huang et al 2017 where a hold back vessel is used to help a drilling rig to keep its position during a partial failure in its energy supply system degrading its station keeping capacity the results showed that the cable connection of two dp vessels running separate auto positioning might cause control instability reinforcing results seen in jenssen 2008 and imca 2000 by using two or more ahts vessels sharing the load the instability can be mitigated as the cable tension value that destabilizes the system may be kept far from the operational condition for the current study an extreme situation is proposed in which there is no running dp system in the rig and four supply boats perform its positioning the mathematical model of the simulator used numerical offshore tank simulator and validation results are presented in nishimoto et al 2002 tannuri and morishita 2006 tannuri et al 2009 and tannuri et al 2014 4 1 system data the supply vessels are based on the maersk handler ahts imo 9246724 and the central load is based on the west eminence imo 8768438 table 1 presents both vessels main properties table 2 and table 3 displays the hold back vessels dynamic parameters and propellers data respectively table 4 shows control parameters used for the ahts dp system note that there is no integral gains data for the study proposed integral action in the support vessels was not considered necessary as the interest is in accurate positioning of the load not the hold back ahts s and its destabilizing characteristics might harm overall system performance an extended kalman filter is used for wave filtering wind feed forward compensation is also taken in account the filter design parameters are given in table 5 the smoothed step responses for each motion mode of a single ahts are show in fig 8 they correspond to a second order system with natural frequencies ω n i 0 017 0 01 0 01 r a d s and damping factors ξ i 0 9 0 7 1 2 4 2 formation control a consensus protocol applied over the communication topology graph from fig 9 is then applied to the set of four supply vessels as required by the technique the graph is connected and has a spanning tree with the root as the leader note that the leader node is a virtual node whose position will be corrected according to the required overall formation position the protocol design matrices and the optimal consensus gain definitions based on this system s second order approximation are given in table 6 this communication topology provides a laplacian matrix with eigenvalues λ i equal to 0 1 3 3 5 by applying these to the system 11 with the ahts linear second order dynamics and gain matrix k from table 6 it is possible to estimate the settling time of the cooperative dynamics the minimum nonzero eigenvalue will provide the slowest dynamic response the 2 settling time of the closed loop system associated to it is estimated then as 312 seconds fig 10 shows the relative positioning errors obtained from full scale simulation without environmental disturbances the consensus algorithm is started at 500s at approximately 800s both relative positioning errors in easting and heading are within 10 m bounds the heading response reaches 5 errors in this time span but holds less correlation with the linear estimated settling time this can be associated with effects from coupling of motion modes in special between sway and yaw motion during the formation establishment surge sway and yaw motions occur simultaneously fig 11 shows the virtual leader tracking capacity with 400m and 45 references the virtual leader s motion is a smoothed step with characteristics of a second order system with natural frequency of 0 005 rad s and damping of 0 9 with these slow reference changes required to keep the thrusters output far from saturation the formation performs almost perfect tracking despite differences in the heading time constant these results show that the consensus algorithm can be easily applied to the dp vessels without physical coupling this is translated as the synchronization characteristic of controller permitting maneuvers in tight formation control next the cooperative algorithm is applied to the load maneuvering case in which cables provide physical coupling between the agents 4 3 load maneuvering to perform the load positioning correction the fleet of cooperative ahts s is coupled to a platform by means of steel cables such coupling can destabilize the control system depending on the cable horizontal restoring coefficient for a catenary cable model this means that stability may be subject to the force applied to the cable for the vessels studied in this case restoring coefficients larger than 164 k n m have been shown in huang et al 2017 to destabilize a holdback setup fig 12 shows restoring coefficients for steel and polyester cables as a function of the horizontal force for the selected cable in the case studied table 7 the stability limit can be easily reached with forces as low as 50 t o n f and could be even smaller for shorter cables see table 8 by distributing the loads through more than one ahts the cable forces can be kept under such limit enabling operations in harsher environmental conditions in this example the ahts fleet is required to maintain formation and move the drilling rig connected to them fig 13 to ensure accurate positioning of the load equation 20 is used to modulate the virtual leader desired position control gains obtained through pole placement are k i d i a g 1 1 5 1 and k i d i a g 0 002 0 003 0 002 the system starts with all dp vessels running standalone and simply holding the rig after an initial stabilization the cooperative control starts to run and corrects the drilling rig position to a desired one a set of maneuvers then occur as follows as a modified version of a 4 corner test værnø et al 2017 where surge sway yaw and coupled motions are verified i the dp vessels start in formation running standalone ii at 2000s the cooperative control is turned on and the vessels are commanded to enter formation and the platform position correction control is started the formation pattern defined a priori is illustrated in fig 14 the formation set points in meters are given by δ 1 l 394 237 149 δ 2 l 394 237 31 δ 3 l 394 237 31 δ 4 l 394 237 149 δ 12 δ 21 788 0 118 δ 23 δ 32 0 474 62 δ 34 δ 43 788 0 118 δ 14 δ 41 0 474 62 iii once is assembled the leader vessel is commanded to a sequence of set points in x y in meters and ψ in degrees fig 15 waiting for stabilization after each command step times for each change are 5000s 8000s 11000s 14000s and 17000s with references given by x d y d ψ d 0 0 0 400 0 0 400 400 0 400 400 45 0 400 45 0 0 0 the virtual leader step references are smoothed by a second order transfer function with all degrees of freedom having natural frequency of 0 005 rad s and damping ration of 0 9 this avoids saturation of the dp vessels propulsion system and permits smoother loading of cables for the manoeuvring over such a large area with long distances involved mild environmental conditions were considered a restriction that would be expected in this kind of operation wind current and wave intensities and directions are given by fig 16 simulations were run for 23000s with a step size of 0 5s the total motion footprint is shown in fig 17 with the rig center trajectory being depicted in fig 18 each step of the joint motion is depicted in fig 19 the drilling rig positions in easting northing and heading for the initial phase when the cooperative controller is not active are plotted in fig 20 the steady state error in easting is of about 30m while in northing is of 110m heading error is kept under 5 given the environmental conditions coming mainly from northeast such errors are expected as the cable flexibility permits a large offset from the rig even if the dp vessels set point errors are low when the cooperative controller is started fig 21 the error drops to zero and follows the desired set points with dynamics close to the one designed for the virtual leader reaching the desired values in around 3150s results for tracking of easting signal can be compared to the linear approximation obtained from equations 19 and 20 response of the linear system with the same parameters and the simulated results are plotted in fig 22 the settling time of both is similar with a slight overshoot seen in the linear system the small differences are due to environmental loads nonlinearities and couplings on the actual system power usage is presented in fig 23 these bar graphs provide total thruster usage time in which each color represents thrust intensity categorized according to table 8 tunnel stern thrusters for all support vessels are largely required as they are the only ones providing lateral force in the stern of the vessel note that vessels 3 and 4 are more required overall this is expected as the environmental loads come from northeast vessel 3 in specially is highly demanded as for the formation used this is the one aligned to the environmental vectors cable tension series fig 24 also indicate this effect as the tensions in cable 3 and 4 reach high values during the rig repositioning in both northing and easting positive directions in which cable loads reach instability values and end up with high peaks reconfiguration of the formation distributing the loads homogeneously among the agents would largely reduce this effect 4 4 hold back positioning under environmental action 4 4 1 uncoordinated performance evaluation in the presence of environmental loads automatic positioning of the platform using just standalone positioning of the individual dp vessels becomes unfeasible as the platform will drift due to cable elasticity and there is no feedback of its position to the system in this case the load positioning task will only be achievable with leading commands from human mooring master responsible for synchronizing the whole operation in the next couple of cases simulations are run for a system with case a and without case b any cooperative protocol where the platform and agents are subjected only to wind disturbances the simulation events occur as follows i the dp vessels start with the same formation from fig 14 running either standalone systems case a or the cooperative protocol case b environmental conditions are set to zero in this moment ii at 250s the wind starts to blow from east 90 with 25 knots intensity fig 25 left the dp vessels are only required to keep auto positioned case a or to control the platform position case b iii at 5000s the wind is turned to blow from north 0 keeping the velocity fig 25 right fig 26 depict the positions of the platform and the holding vessels for case a without the consensus algorithm the lack of a coordinated control for position compensation of the platform it drifts from its initial set position even though each of the holding vessels can keep its position reasonably well this is evidenced by the time series of the rig positions fig 27 in which both an oscillatory behavior related to the integral action of the single dp controllers and a positioning offset in steady state of due to the cable elasticity can be observed after 4000s the rig position offset in easting due to the wind in this direction is of about 25m after 9000s the offset in northing is around 50m the single dp positioning performances are shown in fig 28 despite no offset error there are large oscillations for all agents around the setpoints which are reflected in the rig s behavior fig 29 depict the positions of the platform and the holding vessels for case b with the consensus algorithm note that the relative positions of the holding vessels are changed throughout the operation but the rig steady state positions are kept without the offset observed in case a the load position is also stabilized without the large oscillations see fig 30 the positions of the rig center of coordinates throughout the simulation for both cases are plotted in fig 31 despite a large drift during transients the offset is completely removed when the cooperative positioning is used as opposed to the case without it the transient performance is limited by the power and dynamics of the tugs and might be enhanced by optimal load distribution 4 4 2 large environmental action in this section assessment on the behavior of the proposed setup is performed in harsher environmental conditions fig 32 shows the two conditions tested these are common situations at santos basin oil field in the brazilian coast the conditions are referred to as medium and strong related to the intensities of the environmental effects as the loads in this case are much higher the objective here is to perform just repositioning of the rig without the need to complete the large distance maneuvers from last section this is equivalent to perform a hold back maneuver in which the support vessels are required to hold the load subjected to disturbances the operation steps occur as follows i the dp vessels start with the formation from fig 14 running standalone ii at 2000s the cooperative control is turned on and the vessels are commanded to enter formation defined once again a priori the pattern is illustrated in fig 33 the formation set points are given by δ 1 l 394 237 149 δ 2 l 455 30 0 δ 3 l 394 237 31 δ 4 l 50 432 90 δ 12 δ 21 859 207 149 δ 23 δ 32 61 267 31 δ 34 δ 43 344 195 59 δ 14 δ 41 444 669 121 iii at 4000s the platform positioning correction is started requiring the platform position to be taken to its initial location this geometry tries to reduce the load in the cable from vessel 3 by splitting the forces through vessels 2 and 4 cables the time series responses for the positioning of the rig in medium condition are shown in fig 34 before the formation protocol is started t 2000s the platform drifts around 90m to west and 200m to the south and settles once the consensus algorithm is started the support vessels try to reach the formation set point relative positions during the settling transient between 2000 and 3000 seconds the formation is autonomously set which ends up permitting a larger drift from the platform reaching 140m error in easting and 250m error in northing once the formation is assembled the error is actually reduced to less than 50m in each direction as the loads are better distributed through the hold back vessels finally the rig s positioning correction is started at 4000s the rig is returned to the initial position within less than 500s fig 35 a shows the cable tensions throughout the maneuver vessel 3 s cable force show a large oscillation during the initial phase as it holds most of the environmental forces and reaches the 50 t o n f stability limit for 400m cables before the second formation is set during the formation transient this limit is reached several times by vessels 3 and 4 cables resulting in the peaks observed between 3000 and 4000s once the formation is established the large oscillations are reduced and the cable forces are considered stabilized fig 35 b the transient oscillations might be reduced through the introduction of smoothing functions between changes in the relative positions set points keeping desired formation references throughout the whole maneuver for the strong condition the positioning behavior is very similar to the medium condition fig 36 shows this case s time series and trajectories dynamic performance and accuracy are virtually the same however cable tensions easily reach the stability limit which result in large oscillations throughout the whole maneuver even after the platform position is settled fig 37 this effect rise from unequally distributed loads among the vessels cables fig 38 evidences the differences in cable tensions from both medium a and strong b cases between 6500 and 7000s while such differences are kept relatively small and with lower variation for the medium case a very large oscillation can be seen in the strong case wave frequency may also be affecting these results as differences in positioning between vessels in the direction of wave propagation may produce undesired oscillations such effects may be mitigated through optimal formation distribution as proposed in oshiro et al 2012 a consensus load distribution protocol operating over the relative angles between the vessels and the rig could also be applied 5 conclusions this paper has shown an application of a high level guidance controller to dp systems using robotics concepts to automate a relative positioning and a towing operation even though the proposed case study is set in a situation with a relatively low vessel quantity this method is easily scalable permitting a very large fleet to present the described behaviors by its own nature the cooperative controller enforces synchronization as long as the vessel agents actuators are able to perform the required motion without saturation simulations run under complex environmental disturbances provided promising results in both low speed maneuvering and positioning operations using multiple dp vessels connected to a large load problems related to cable loadings and large oscillations might be solved by the expansion of concepts explored like usage of smarter rules for formation settling smoothing functions in relative positioning set point changes and automatic formation definition through grasping allocation rules like the ones used in thrust allocation of standalone dp vessels weathervaning and automatic cable load distribution among agents might also be applied to reduce the required loads in individual vessels in actual applications where communication hardware limitations may arise local kalman filters should be used to perform dead reckoning of neighbor positions from the software point of view most aspects of cooperative control methods are already solved in a robust manner to achieve applicability in actual operations most remaining issues rely on hardware and wireless communication standards definitions besides adequate human interfaces to command and control the required inputs acknowledgements the first author acknowledges the higher education personnel improvement coordination capes for the scholarship the second author acknowledges the brazilian national council for scientific and technological development cnpq for the research grant process 304784 2017 6 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 02 003 
22910,this work intends to propose a high level control method for use in multiple dynamic positioned vessels to perform synchronized motion control while towing floating unactuated loads connected through cables the idea consists in usage of a cooperative control structure in which the vessels share its positions readings through a wireless network while correcting their own relative positions independently through a consensus algorithm global formation positioning is achieved through the introduction of a virtual consensus leader and its positions are dynamically corrected to take the cargo to the required positions coordinated motions of the formation ensure the load is taken to its set point simulation results for illustrative cases are presented and discussed keywords cooperative control dynamic positioning autonomous operations 1 introduction as the world heads to increasing levels of automation in the daily life where unmanned aerial vehicles uav s will deliver order packages and autonomous cars are expected to take streets soon it is probably unknown to most people that dynamic positioning dp vessels were one of the first and most successful applications of cybernetics to reach industry such success can be credited to the dynamic positioning systems dps own autonomous nature which permitted the automatic station keeping capacity required for year s length offshore missions as such marine operations grow larger and more complex the requirements for a higher number of agents from vessels to equipment working simultaneously and cooperatively become evident in this scenario the ability to perform such tasks safely coordinating all these elements will eventually reach human limits bounding also the complexity that can be achieved enhanced levels of autonomy emerge as a response to these requirements giving margin to safer larger and possibly more cost effective operations current state of the art technologies in robotics and autonomous systems along with great advances in bandwidth availability and in reliability of wireless communication systems have permitted the development of large scale multi robot and multi autonomous vehicle architectures able to solve cooperatively tasks that wouldn t be possible with a single agent in murray 2006 a list of several devised applications for multi vehicle operations is presented including examples for autonomous cars unmanned aerial vehicles satellite arrays and mixed vehicles given such examples it is easy to think also of sets of marine vehicles such as autonomous underwater vehicles auv s and autonomous surface vehicles asv s that could perform cooperative tasks and eventually enable large and complex offshore and even restricted waters operations dp vessels thought of as actual drone ships are interesting candidates for the application of marine multi agent missions their flexibility and already highly automated operational capacity might be enhanced with the introduction of cooperative systems concepts this represents a step up in the automation tasks a dp system may perform beyond the already mentioned station keeping and the trajectory tracking path following capacities already present in most of current industrial systems formation keeping tasks with multiple vessels automated collision avoidance between agents and distributed load carrying and holding may be introduced fig 1 shows an example of an operation that could take advantage of such system the installation of an underwater tunnel module uses four tugboats to position a floating barge as the tugboats are human operated accuracy in such positioning is limited to make sure the module keeps its position during the descent and installation the hoisting barge must be anchored this of course limits the application of such technique to shallow waters and very mild environmental conditions as shall be seen the simple usage of dp capable tugboats might render stability issues the task might be accomplished with less restriction if the boats were running a cooperative dp algorithm other applications devised for cooperative control systems applied to dp vessels are subsea installation operations with joint materials hoisting rescue multiple tug boat load maneuvering and large cargo transportation when designed as multiple agent tasks these operations can be advantageous by reducing overall costs enhancing operational safety and reliability due to redundancy and by enabling large configuration flexibility it was not until very recently that marine vessels have been discussed as a target for application of a cooperative control concept some works like skjetne et al 2002 kyrkjebo and pettersen 2003 ihle et al 2005 and arrichiello et al 2006 exploit path following and trajectory tracking missions of marine vessels working in coordination researches in cooperative control applied to dp systems are even scarcer in queiroz filho and tannuri 2017 an extensive experimental analysis of a consensus based control law applied to dp vessels was presented in peng et al 2016 a cooperative dp control system using the so called dynamic surface control dsc combined with an adaptive algorithm that observes and corrects the control law to respond to oceanic disturbances nonlinear methods were presented in ianagui and tannuri 2015 and ianagui et al 2016 where numerical and experimental results were presented the subject cooperative multi agent systems is rather broad and involve notions from computer science to mechatronics the most studied topics in this area for application in multi vehicle systems are the cooperative control methods these methods involve decision making cooperative motion planning and actual control theory required to perform the cooperative tasks to accomplish such objectives the vehicles may be required to collectively adopt several behaviors such as but not restricted to swarming flocking setting a formation and navigating in it tracking a leader and avoid collisions these behaviors can be achieved through the application of collective control laws referred in literature as cooperative protocols which can be either calculated in centralized fashion or distributed among the agents while centralized control is easier and can be designed through classical control methods it lacks robustness flexibility and scalability to be applied in larger scale systems within this set of requirements distributed cooperative methods are usually preferable for application in multi agent control the present work consists in the application of a decentralized cooperative control algorithm to perform autonomous operations using multiple support vessels with the objective to tow and hold a floating structure it is an extension of the work proposed in ianagui et al 2017 where preliminary results were presented the main features of this architecture are cited as follows motion synchronization a leader tracking algorithm can be used to make all dp vessels move with controlled relative positioning in all degrees of freedom and following a desired joint trajectory harder tasks like changing the heading of the whole formation as opposed to changing the heading of all individual vessels are performed in a simple manner this becomes even more advantageous when a larger number of vessels is to be controlled scalability the usual cooperative algorithms are distributed and easily scalable which once again presents an advantage when many vessels are assigned stability the introduction of restrictions between agents like cable connections does not destabilize the overall system load position correction when carrying a load with multiple vessels the leader position may be corrected online to relocate the load to a desired position while not very different from the control structures that are applied to other vehicles the cooperative algorithms needed for dp vessels must address some specific challenges like the persistent and or random punctual disturbances from waves winds and currents the communication topologies used should also be correctly addressed to keep the system safe reliable and available 2 cooperative control of dp vessels the architecture proposed for the cooperative dp system is presented in fig 2 the control is decentralized so the wireless communication structure illustrated in the figure is not a hardware implementation this block represents what will be defined later in terms of a graph communication topology between the agents each vessel sends its own position relative position references are broadcast fig 3 shows the internal blocks of each agent depicted in the last figure the system considers that a standard local dp system is running in each single vessel wind feedforward compensation is not shown but may be present the cooperative controller sees the junction dps vessel as a single plant and sends position references to it this controller can be seen in a way as a guidance system the cooperative controller may be accompanied by a local kalman filter which estimates the data of all neighbor agents this enhances the overall system robustness as in the event of a network shortage the neighbor agents positions can be integrated dead reckoning to find a cooperative control rule hereafter mentioned as protocol a simple second order model for the motion equations of the joint block vessel dps is considered equation 1 presents such model 1 x 1 x 2 0 i 3 3 a 0 a 1 x 1 x 2 0 b 1 u y 1 0 x 1 x 2 in which x 1 and x 2 are the state vectors corresponding to the global reference frame positions easting northing and heading represented here by x y and ψ and velocities x y and ψ respectively y is the observation vector and u is the desired position vector the matrices a 0 a 1 and b 1 are given by 2 a 1 2 ζ x ω n x 2 0 0 0 2 ζ y ω n y 2 0 0 0 2 ζ ψ ω n ψ 2 a 0 ω n x 2 0 0 0 ω n y 2 0 0 0 ω n ψ 2 b 1 a 0 the variables ω n i and ζ i i x y ψ are the natural frequency and the relative damping factor of the system respectively their values depend on the dp control system tuning with ζ i usually between 0 6 and 0 9 fossen 2011 and ω n i depending on the vessel size both can be easily recovered from step responses of the dp vessel by expressions 3 and 4 or by other system identification technique 3 ω n 2 π δ t 1 ζ 2 4 ζ ln m p π 2 ln m p 2 here m p is the overshoot as a fraction of the step input and δ t is the time interval between two consecutive peaks on the plot of the step response for multiple vessels the dynamic state equation 1 is to be indexed consider each dp vessel dynamics with the form 5 x i a i x i b i u i i 1 2 n here n is the number of vessels to be cooperatively controlled our objective is to define a decentralized set point generation law u i f x i j n that fulfills the required tasks the strategies presented are based on the definition of a consensus problem where multiple agents outputs are required to reach a consensus value in a coordination variable by defining this basic problem standard cooperative tasks such as formation keeping and leader following behavior can be described a thorough discussion on linear consensus theory can be found in ren et al 2007 suppose that the vessels controllers can communicate wirelessly sending each its own position and velocity and receiving such data from neighbor vessels here the concept of neighbor does not mean necessarily physical proximity but depends on how the communication topology is defined in the cooperative control area the usual way to represent such topology is by means of communication graphs a graph is defined as a pair g v e where v is a set v 1 v 2 v n called vertices or nodes set and e is a set of pairs v i v j called edges in a multi agent communication structure each vertex represents a single agent and each edge represents the availability of information between edges in a standard or undirected edge v i v j v j v i this means from the multi agent network design point of view that information is shared bi directionally i e the agent nodes connected through this edge have access to each other s states in an oriented edge v i v j v j v i which means that information is shared in only one direction and only one agent has access to the other s states graphically an oriented edge is represented through an arrow in which the point enters v j and the tail leaves v i an oriented or directed graph is also called a digraph the in degree of a node v i is the number of edges pointing to v i the neighbors of node are the set n i v j v j v i e i e it is the set of nodes with edges pointing to v i the neighbor set number of elements n i is equal to the in degree of v i each edge v j v i can be associated with a weighting factor a i j 0 fig 4 a when this is considered the neighbor set can be defined as n i v j a i j 0 a directed path is a sequence of edges v 0 v 1 v r v i v i 1 e if there is a directed path from v i to v j it is said that v i is connected to v j a graph is said to be strongly connected if any pair v i v j v i j is connected a directed tree fig 4 b is a digraph in which every node except one called root node has in degree equal to one a graph has a spanning tree if a subset of its edges forms a spanning tree this is equivalent to say that all the vertices of this graph are reachable if starting from a single vertex and following the edges arrows a graph can have multiple spanning trees a set of root nodes or leader set is the set of all roots of all spanning trees of a graph if a graph is strongly connected it has at least one spanning tree and all vertices are roots for a graph with edges weighted through a i j the adjacency matrix a is defined as 6 a a i j a i j 0 i f v j v i e a i j 0 i f v j v i e the weighted in degree d i of a node v i is the sum of the elements of the i t h row of the adjacency matrix 7 d i j 1 n a i j the in degree matrix d is defined as 8 d d i a g d i with the in degree definition the laplacian matrix can also be defined as 9 l d a now return to the problem of finding u i f x i j n for equation 5 a linear consensus control law or protocol for this system is will be given by lewis et al 2014 10 u i c k j n i a i j x j x i here n i is the set of neighbors of the i t h agent and a i j are the weight entrances of the graph edges c is a positive synchronization variable and k is a gain matrix to be designed the stability properties of the closed loop system with protocol 10 is equivalent of the stability properties of the n systems 11 e i a i c λ i b i k e i f o r i 1 2 n in which λ i are the eigenvalues of the laplacian matrix and e i is the relative error vector calculation of the gains c and k required to reach stability are an extensive topic their values depend on the graph topology note λ i also determine the cooperative system dynamics stability attendance for the gains can be found through standard linear theory applied in each block of equation 11 such as the routh stability criteria ogata 1970 optimal definition of gains for consensus problems are given in li duan 2015 and in lewis et al 2014 the latter proposes for instance k that is independent of the graph topology 12 k r 1 b i t p in which p is the unique positive definite solution of the control algebraic riccati equation 13 a i t p p a i q p b i r 1 b i t p 0 throughout the text it will be assumed that the graphs have fixed structure and at least one spanning tree under these conditions the gain calculated 12 provides asymptotical stability as long as the coupling gain c satisfies 14 c 1 2 min r e λ i f o r a l l λ i 0 even though the standard consensus theory can provide control over the relative states of multiple agents it is rather limited in the way it was presented to enforce some desired behaviors on the agents that are of operational practice the protocol and graph topology are now discussed in order to provided formation control and leader following behavior which are more applicable in the operations of marine vehicles formation control can be achieved through the introduction of reference relative position signals δ i j between the agents in the control inputs for the most general case 15 u i c k j n i a i j x j x i δ ji the reference signals do not need to be constant along time which means that a trajectory generation law can be input to enforce a dynamically varying formation when thinking about a dp system mass spring damper analogy fig 5 a the introduction of such law corresponds to adding extra spring damper sets between the vessels as can be seen in fig 5 b see fig 6 the consensus algorithm does not provide means to control the general location of the agents and the formation function from equation 15 controls only relative position full controllability of the cooperative positioning behavior can be achieved through the introduction of a leader agent this is consensus leader following is referred in literature as consensus tracking consensus tracking can only be introduced in digraphs by the usage of one root node of a spanning tree that has in degree equal to zero in this case the row of the adjacency the in degree and the laplacian matrixes corresponding to this node has all elements equal to zero the overall result is that the consensus value reached for every agent except the leader is the initial leader state lewis et al 2014 note that the leader node is not required to be a real ship its positions can be defined as a sequence of set point signals with prescribed profile respecting the real agents performance restrictions in fact this behavior is even desirable as the eventual failure of an agent defined as the leader system could handle the cooperative system uncontrollable in fig 5 b such method is exemplified with l the central leader node reference 3 application to load positioning consider a system composed of a load and n support vessels indexed by i i 0 corresponds to the load i 1 2 n corresponds to the holding vessel each with total inertia m i considering the hydrodynamic added mass connected by cables of horizontal restoring coefficient k both support vessels have dp controllers and keep their positions while connected to the central load drilling rig this analysis will consider the vessels motion only in the x axis surge direction as shown in the figure below the objective is to modulate the formation s virtual leader position in order to correct the overall formation position online and take keep the load in a desired position eliminating offset errors caused by environmental loads the dynamics of each vessel are considered linear and approximated by 16 m x i f t h r i c r x 1 k x 0 x i l 0 m 0 x 0 c r 0 x 0 2 k x 0 k x 1 x 2 where x 0 and x i are the positions of the rig and of each vessel i respectively c r is a linear viscous drag coefficient f t h r i are the vessels required thruster forces k is the cable restoring coefficient and l 0 its paid length the support vessels masses are equal to m and the drilling rig mass and drag coefficient are given respectively by m 0 and c r 0 each holding vessel is locally positioned by a pid controller 17 f t h r i k p x i x i d k d x i x i d k i x i x i d d t in which k p k i and k d are the controller gains and x i d are the set point positions given to the controller the vessels are kept with their relative positions controlled through a cooperative algorithm given by 18 x i d x i c j n i a i j k 1 x j x i δ i j k 2 x j x i where δ i j are the desired formation relative positions between vessels i and j when i 0 in 18 the rig position x 0 will be replaced by the desired rig position x 0 d this value corresponds to that of a virtual leader to vessels 1 and 2 the gains k 1 k 2 and c are the consensus gains that can be calculated through equations 12 14 if the communication topology graph is connected equations 16 18 can be combined by means of an auxiliary state variable w i 1 n x i 19 m w k d c r k p c k 2 w k k p c k 1 k i c k 2 w 2 k x 0 k i c k 1 w d t 2 c k p k 1 k i k 2 u 2 k p c k 2 u 2 k i c k 1 u d t m x 0 c r 0 x 0 k x 0 0 5 k w here symmetry in the reference formation relative positions is assumed which means that i 1 n δ i j 0 equation 19 represents a fifth order siso system which can be controlled through any linear method for instance control may be performed through a proportional integral pi controller applied to the leader virtual dynamics input 20 u k p x 0 d x 0 k i x 0 d x 0 d t in which x 0 d is the virtual leader desired position vector and k p and k i are positive gains note that this is a high level controller which intends only to regulate the target position in face of external disturbances this means that the time constant of the plant must be kept the overall architecture of the proposed application for two support vessels can be seen in fig 7 a reference generator block is added to provide smoothed inputs for the controllers 4case study load hold back and maneuvering this section describes a case study using four dp anchor handling tug supply ahts vessels and an unactuated drilling rig this setup is similar to what would be required to position the tunnel construction module mentioned in the introduction although it is performed in a larger scale the system considered is an expansion of the situation studied in huang et al 2017 where a hold back vessel is used to help a drilling rig to keep its position during a partial failure in its energy supply system degrading its station keeping capacity the results showed that the cable connection of two dp vessels running separate auto positioning might cause control instability reinforcing results seen in jenssen 2008 and imca 2000 by using two or more ahts vessels sharing the load the instability can be mitigated as the cable tension value that destabilizes the system may be kept far from the operational condition for the current study an extreme situation is proposed in which there is no running dp system in the rig and four supply boats perform its positioning the mathematical model of the simulator used numerical offshore tank simulator and validation results are presented in nishimoto et al 2002 tannuri and morishita 2006 tannuri et al 2009 and tannuri et al 2014 4 1 system data the supply vessels are based on the maersk handler ahts imo 9246724 and the central load is based on the west eminence imo 8768438 table 1 presents both vessels main properties table 2 and table 3 displays the hold back vessels dynamic parameters and propellers data respectively table 4 shows control parameters used for the ahts dp system note that there is no integral gains data for the study proposed integral action in the support vessels was not considered necessary as the interest is in accurate positioning of the load not the hold back ahts s and its destabilizing characteristics might harm overall system performance an extended kalman filter is used for wave filtering wind feed forward compensation is also taken in account the filter design parameters are given in table 5 the smoothed step responses for each motion mode of a single ahts are show in fig 8 they correspond to a second order system with natural frequencies ω n i 0 017 0 01 0 01 r a d s and damping factors ξ i 0 9 0 7 1 2 4 2 formation control a consensus protocol applied over the communication topology graph from fig 9 is then applied to the set of four supply vessels as required by the technique the graph is connected and has a spanning tree with the root as the leader note that the leader node is a virtual node whose position will be corrected according to the required overall formation position the protocol design matrices and the optimal consensus gain definitions based on this system s second order approximation are given in table 6 this communication topology provides a laplacian matrix with eigenvalues λ i equal to 0 1 3 3 5 by applying these to the system 11 with the ahts linear second order dynamics and gain matrix k from table 6 it is possible to estimate the settling time of the cooperative dynamics the minimum nonzero eigenvalue will provide the slowest dynamic response the 2 settling time of the closed loop system associated to it is estimated then as 312 seconds fig 10 shows the relative positioning errors obtained from full scale simulation without environmental disturbances the consensus algorithm is started at 500s at approximately 800s both relative positioning errors in easting and heading are within 10 m bounds the heading response reaches 5 errors in this time span but holds less correlation with the linear estimated settling time this can be associated with effects from coupling of motion modes in special between sway and yaw motion during the formation establishment surge sway and yaw motions occur simultaneously fig 11 shows the virtual leader tracking capacity with 400m and 45 references the virtual leader s motion is a smoothed step with characteristics of a second order system with natural frequency of 0 005 rad s and damping of 0 9 with these slow reference changes required to keep the thrusters output far from saturation the formation performs almost perfect tracking despite differences in the heading time constant these results show that the consensus algorithm can be easily applied to the dp vessels without physical coupling this is translated as the synchronization characteristic of controller permitting maneuvers in tight formation control next the cooperative algorithm is applied to the load maneuvering case in which cables provide physical coupling between the agents 4 3 load maneuvering to perform the load positioning correction the fleet of cooperative ahts s is coupled to a platform by means of steel cables such coupling can destabilize the control system depending on the cable horizontal restoring coefficient for a catenary cable model this means that stability may be subject to the force applied to the cable for the vessels studied in this case restoring coefficients larger than 164 k n m have been shown in huang et al 2017 to destabilize a holdback setup fig 12 shows restoring coefficients for steel and polyester cables as a function of the horizontal force for the selected cable in the case studied table 7 the stability limit can be easily reached with forces as low as 50 t o n f and could be even smaller for shorter cables see table 8 by distributing the loads through more than one ahts the cable forces can be kept under such limit enabling operations in harsher environmental conditions in this example the ahts fleet is required to maintain formation and move the drilling rig connected to them fig 13 to ensure accurate positioning of the load equation 20 is used to modulate the virtual leader desired position control gains obtained through pole placement are k i d i a g 1 1 5 1 and k i d i a g 0 002 0 003 0 002 the system starts with all dp vessels running standalone and simply holding the rig after an initial stabilization the cooperative control starts to run and corrects the drilling rig position to a desired one a set of maneuvers then occur as follows as a modified version of a 4 corner test værnø et al 2017 where surge sway yaw and coupled motions are verified i the dp vessels start in formation running standalone ii at 2000s the cooperative control is turned on and the vessels are commanded to enter formation and the platform position correction control is started the formation pattern defined a priori is illustrated in fig 14 the formation set points in meters are given by δ 1 l 394 237 149 δ 2 l 394 237 31 δ 3 l 394 237 31 δ 4 l 394 237 149 δ 12 δ 21 788 0 118 δ 23 δ 32 0 474 62 δ 34 δ 43 788 0 118 δ 14 δ 41 0 474 62 iii once is assembled the leader vessel is commanded to a sequence of set points in x y in meters and ψ in degrees fig 15 waiting for stabilization after each command step times for each change are 5000s 8000s 11000s 14000s and 17000s with references given by x d y d ψ d 0 0 0 400 0 0 400 400 0 400 400 45 0 400 45 0 0 0 the virtual leader step references are smoothed by a second order transfer function with all degrees of freedom having natural frequency of 0 005 rad s and damping ration of 0 9 this avoids saturation of the dp vessels propulsion system and permits smoother loading of cables for the manoeuvring over such a large area with long distances involved mild environmental conditions were considered a restriction that would be expected in this kind of operation wind current and wave intensities and directions are given by fig 16 simulations were run for 23000s with a step size of 0 5s the total motion footprint is shown in fig 17 with the rig center trajectory being depicted in fig 18 each step of the joint motion is depicted in fig 19 the drilling rig positions in easting northing and heading for the initial phase when the cooperative controller is not active are plotted in fig 20 the steady state error in easting is of about 30m while in northing is of 110m heading error is kept under 5 given the environmental conditions coming mainly from northeast such errors are expected as the cable flexibility permits a large offset from the rig even if the dp vessels set point errors are low when the cooperative controller is started fig 21 the error drops to zero and follows the desired set points with dynamics close to the one designed for the virtual leader reaching the desired values in around 3150s results for tracking of easting signal can be compared to the linear approximation obtained from equations 19 and 20 response of the linear system with the same parameters and the simulated results are plotted in fig 22 the settling time of both is similar with a slight overshoot seen in the linear system the small differences are due to environmental loads nonlinearities and couplings on the actual system power usage is presented in fig 23 these bar graphs provide total thruster usage time in which each color represents thrust intensity categorized according to table 8 tunnel stern thrusters for all support vessels are largely required as they are the only ones providing lateral force in the stern of the vessel note that vessels 3 and 4 are more required overall this is expected as the environmental loads come from northeast vessel 3 in specially is highly demanded as for the formation used this is the one aligned to the environmental vectors cable tension series fig 24 also indicate this effect as the tensions in cable 3 and 4 reach high values during the rig repositioning in both northing and easting positive directions in which cable loads reach instability values and end up with high peaks reconfiguration of the formation distributing the loads homogeneously among the agents would largely reduce this effect 4 4 hold back positioning under environmental action 4 4 1 uncoordinated performance evaluation in the presence of environmental loads automatic positioning of the platform using just standalone positioning of the individual dp vessels becomes unfeasible as the platform will drift due to cable elasticity and there is no feedback of its position to the system in this case the load positioning task will only be achievable with leading commands from human mooring master responsible for synchronizing the whole operation in the next couple of cases simulations are run for a system with case a and without case b any cooperative protocol where the platform and agents are subjected only to wind disturbances the simulation events occur as follows i the dp vessels start with the same formation from fig 14 running either standalone systems case a or the cooperative protocol case b environmental conditions are set to zero in this moment ii at 250s the wind starts to blow from east 90 with 25 knots intensity fig 25 left the dp vessels are only required to keep auto positioned case a or to control the platform position case b iii at 5000s the wind is turned to blow from north 0 keeping the velocity fig 25 right fig 26 depict the positions of the platform and the holding vessels for case a without the consensus algorithm the lack of a coordinated control for position compensation of the platform it drifts from its initial set position even though each of the holding vessels can keep its position reasonably well this is evidenced by the time series of the rig positions fig 27 in which both an oscillatory behavior related to the integral action of the single dp controllers and a positioning offset in steady state of due to the cable elasticity can be observed after 4000s the rig position offset in easting due to the wind in this direction is of about 25m after 9000s the offset in northing is around 50m the single dp positioning performances are shown in fig 28 despite no offset error there are large oscillations for all agents around the setpoints which are reflected in the rig s behavior fig 29 depict the positions of the platform and the holding vessels for case b with the consensus algorithm note that the relative positions of the holding vessels are changed throughout the operation but the rig steady state positions are kept without the offset observed in case a the load position is also stabilized without the large oscillations see fig 30 the positions of the rig center of coordinates throughout the simulation for both cases are plotted in fig 31 despite a large drift during transients the offset is completely removed when the cooperative positioning is used as opposed to the case without it the transient performance is limited by the power and dynamics of the tugs and might be enhanced by optimal load distribution 4 4 2 large environmental action in this section assessment on the behavior of the proposed setup is performed in harsher environmental conditions fig 32 shows the two conditions tested these are common situations at santos basin oil field in the brazilian coast the conditions are referred to as medium and strong related to the intensities of the environmental effects as the loads in this case are much higher the objective here is to perform just repositioning of the rig without the need to complete the large distance maneuvers from last section this is equivalent to perform a hold back maneuver in which the support vessels are required to hold the load subjected to disturbances the operation steps occur as follows i the dp vessels start with the formation from fig 14 running standalone ii at 2000s the cooperative control is turned on and the vessels are commanded to enter formation defined once again a priori the pattern is illustrated in fig 33 the formation set points are given by δ 1 l 394 237 149 δ 2 l 455 30 0 δ 3 l 394 237 31 δ 4 l 50 432 90 δ 12 δ 21 859 207 149 δ 23 δ 32 61 267 31 δ 34 δ 43 344 195 59 δ 14 δ 41 444 669 121 iii at 4000s the platform positioning correction is started requiring the platform position to be taken to its initial location this geometry tries to reduce the load in the cable from vessel 3 by splitting the forces through vessels 2 and 4 cables the time series responses for the positioning of the rig in medium condition are shown in fig 34 before the formation protocol is started t 2000s the platform drifts around 90m to west and 200m to the south and settles once the consensus algorithm is started the support vessels try to reach the formation set point relative positions during the settling transient between 2000 and 3000 seconds the formation is autonomously set which ends up permitting a larger drift from the platform reaching 140m error in easting and 250m error in northing once the formation is assembled the error is actually reduced to less than 50m in each direction as the loads are better distributed through the hold back vessels finally the rig s positioning correction is started at 4000s the rig is returned to the initial position within less than 500s fig 35 a shows the cable tensions throughout the maneuver vessel 3 s cable force show a large oscillation during the initial phase as it holds most of the environmental forces and reaches the 50 t o n f stability limit for 400m cables before the second formation is set during the formation transient this limit is reached several times by vessels 3 and 4 cables resulting in the peaks observed between 3000 and 4000s once the formation is established the large oscillations are reduced and the cable forces are considered stabilized fig 35 b the transient oscillations might be reduced through the introduction of smoothing functions between changes in the relative positions set points keeping desired formation references throughout the whole maneuver for the strong condition the positioning behavior is very similar to the medium condition fig 36 shows this case s time series and trajectories dynamic performance and accuracy are virtually the same however cable tensions easily reach the stability limit which result in large oscillations throughout the whole maneuver even after the platform position is settled fig 37 this effect rise from unequally distributed loads among the vessels cables fig 38 evidences the differences in cable tensions from both medium a and strong b cases between 6500 and 7000s while such differences are kept relatively small and with lower variation for the medium case a very large oscillation can be seen in the strong case wave frequency may also be affecting these results as differences in positioning between vessels in the direction of wave propagation may produce undesired oscillations such effects may be mitigated through optimal formation distribution as proposed in oshiro et al 2012 a consensus load distribution protocol operating over the relative angles between the vessels and the rig could also be applied 5 conclusions this paper has shown an application of a high level guidance controller to dp systems using robotics concepts to automate a relative positioning and a towing operation even though the proposed case study is set in a situation with a relatively low vessel quantity this method is easily scalable permitting a very large fleet to present the described behaviors by its own nature the cooperative controller enforces synchronization as long as the vessel agents actuators are able to perform the required motion without saturation simulations run under complex environmental disturbances provided promising results in both low speed maneuvering and positioning operations using multiple dp vessels connected to a large load problems related to cable loadings and large oscillations might be solved by the expansion of concepts explored like usage of smarter rules for formation settling smoothing functions in relative positioning set point changes and automatic formation definition through grasping allocation rules like the ones used in thrust allocation of standalone dp vessels weathervaning and automatic cable load distribution among agents might also be applied to reduce the required loads in individual vessels in actual applications where communication hardware limitations may arise local kalman filters should be used to perform dead reckoning of neighbor positions from the software point of view most aspects of cooperative control methods are already solved in a robust manner to achieve applicability in actual operations most remaining issues rely on hardware and wireless communication standards definitions besides adequate human interfaces to command and control the required inputs acknowledgements the first author acknowledges the higher education personnel improvement coordination capes for the scholarship the second author acknowledges the brazilian national council for scientific and technological development cnpq for the research grant process 304784 2017 6 appendix a supplementary data the following is the supplementary data to this article multimedia component 1 multimedia component 1 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j oceaneng 2019 02 003 
22911,a reynolds averaged navier stokes computational fluid dynamics rans cfd package will be one of the primary tools used during the development of a performance prediction program for wind assisted commercial ships this paper is part 1 of a two part series describing the rans cfd method adopted for this study the modelling challenge presented by large separated flow structures in the wake of a sailing ship points to a conscientious validation study a validation data set consisting of hydrodynamic forces acting on the ships sailing with a leeway angle was collected at the delft university of technology towing tank facility for bare hull and appended cases appended cases were designed to represent a broad range of appendage typologies rudder bilge keels skeg and barkeel a validation statement is made for simulations for the entire bare hull series and for appended geometries excepting the bilge keel case the simulation method is described in part 2 including the assessment of the numerical uncertainty keywords green shipping computational fluid dynamics validation sailing vessels ships climate change 1 introduction wind as a source of energy for commercial ships has again garnered interest as an environmentally friendly propulsion alternative as a possible response to volatile fuel prices and to comply with increasingly exacting environmental regulations the further development of this promising technology is hampered by a poor understanding of the interaction effects between wind propulsors and the hydromechanics of commercial ships the wind assisted ship propulsion wasp performance prediction program under development at delft university of technology will provide designers and researchers the ability to explore the possibilities offered by wind as an auxiliary propulsor the performance prediction tool is developed and documented in a rigorous and transparent way so that the designer or researcher can confidently report performance figures for subsequent environmental and economic analyses the introduction of wind propulsors aboard commercial vessels will introduce forces and moments besides the desired forward thrust for sailing equilibrium the transvers component of the aerodynamic force must be opposed by a righting moment and a hydrodynamic sideforce the production of these reactionary forces gives rise to a steady heel angle and leeway angle vessel performance with leeway angles is characterised by an increase in resistance and by the generation of a strong destabilising moment about the yaw axis both of which are key design concerns with the wasp performance prediction program a designer is able to perform parametric investigations for the arrangement of wind propulsors and the hull form geometry and can eventually optimize a commercial hull form for sailing for example the well known phenomenon of induced drag for lifting surfaces has a direct analogue for commercial ship types while generating hydrodynamic sideforce though the flow mechanisms only vaguely resemble the prandtl wing and the associated derivation for the induced drag the accounting for energy loss in shed vorticity is especially relevant for the present application following theories for low aspect planforms jones 1946 the induced drag may be significant for commercial ships meaning that the thrust delivered by a wind propulsor might well be overwhelmed by this increase in resistance negating the benefit of adding the wind propulsor models that capture the behaviour of a generic commercial vessel under sail will be derived by studying the sensitivity of vessel performance to changes in hull geometry for example to determine the influence of vessel draft vessel behaviour for increased and decreased draft is fit to some functional form of course as other hull form parameters are allowed to vary the structure of this function will become increasingly complex the force models for a generic hull would be determined by polynomial regression techniques from a large set of systematically varied hulls in the past this database for regression analysis was built using results from towing tank experiments keuning and sonnenberg 1998 the maturity of reynolds averaged navier stokes computational fluid dynamics rans cfd solvers offers the ready inexpensive analysis for a large number of hull variations however simulations that remain computationally affordable may be unable to model the flow patterns occurring near a sailing commercial ship fluid flow around the wind assisted ship operating at a leeway angle will experience separation effects and will become entrained in large vortices in the wake of the ship modelling the occurrence of separation and the evolution of these vortices is the principal simulation challenge as both phenomena may challenge modelling assumptions made in the simulation setup in this paper a validation exercise is described for the computationally affordable assessment of large numbers of ship hull variations this simulation work is performed in the service of a regression based modelling for the performance of wind assist vessels production runs are performed with a six million cell grid which gave numerical uncertainties that were commensurate with the uncertainties in the experimental data the results for this validation exercise are presented for bare hull and appended hull rans cfd simulations 1 1 simulation method the simulation method for the production runs is designed for the assessment of hull geometry variants of the delft wind assist series the level of grid refinement is such that the volume of simulations is feasible using the cartesius supercomputer facility surf sara n d the simulations methodology for the validation exercise is described briefly to provide context for the reader the drift sweep procedure toxopeus 2011 was adopted for the efficient analysis of a series of leeway angles and speeds the domain is meshed once with the ship aligned with the x axis and assigned a prescribed motion including a leeway angle within a quiescent fluid as in fig 1 simulation cases proceed from a converged solution to the next combination of leeway angle and vessel speed using a gradual transition such that the time required for the convergence of the new solution is reduced compared with reinitializing the computation integrated fluid forces on the ship hull are determined in the coordinate system aligned with the direction of forward motion vessel response may be unsteady due to shedding behaviour around the hull but only averaged forces are of interest within the context of this study after the simulation has converged an average is made over one characteristic time interval equal to l u the simulations are performed with the fine marine suite a commercial rans cfd package distributed by numeca the unsteady rans equations are solved with the isis cfd flow solver developed at ecole centrale nantes the isis cfd flow solver is an incompressible unsteady rans method the unstructured spatial discretization for the transport equations is based on the finite volume method free surface flows are simulated with a conservation equation for the mass fraction a detailed description of the solver is provided in deng et al 2005 deng et al 2006 duvigneau and visonneau 2003 queutey and visonneau 2007 turbulence is modelled using the explicit algebraic stress model easm to provide an anisotropic modelling that remains computationally affordable simulation boundary conditions and meshing details are indicated in fig 2 the boundary layer at the ship hull is modelled with a logarithmic wall function boundary condition for model scale validation simulations five boundary layer cells were sufficient to satisfy the modelling criterion for y value at the hull as a single mesh is used for several operating conditions the average y was between 30 and 60 depending on the froude number while the maximum y varies between 65 and 90 located at the region of flow acceleration around the forward bilge the mesh refinement level at the hull corresponds to 500 cells per ship length the free surface is refined to a level nine in the z direction a detailed description of the simulation method meshing strategy and the simulation verification exercise is presented in part 2 of this publication 2 validation data set the validation dataset is composed of hulls from the delft wind assist series each hull and appended case is tested at three speeds froude number f n 0 128 0 168 0 21 corresponding to 9 12 and 15 knots at full scale at model scale the vessel speed is equal to 0 65 0 87 and 1 09 m s the full scale reynolds number is approximately 8e8 the model scale reynolds number is approximately 2 3e6 four leeway angles β 0 3 6 9 were tested giving a total of 12 operating conditions the validation data consists of global forces acting on the ship resistance x sideforce y and yaw moment n these are evaluated in a flow aligned coordinate system 2 1 delft wind assist series the hulls in the wind assist series are systematic variations of a wind assist concept designed by dykstra naval architects of the netherlands fig 3 the series comprises 65 hulls for which the prismatic coefficient the midship coefficient the draft to length ratio and the deadrise angle are systematically varied the variation for prismatic coefficient is effected by lengthening or shortening the parallel mid body the midship coefficient is modified by increasing and decreasing the bilge radius for variations in the draft to length ratio the displacement is kept constant by reducing the beam accordingly finally the deadrise hulls are defined by extending a tangent line from the bilge to the centreline at the appropriate angle the extents of the systematic series and the geometry for validation cases are presented in fig 4 and table 2 hull 1 and hull 34 were selected as representative hulls for the series hull 1 being the parent hull at the centre of all variations and hull 34 as the median case for the deadrise hulls hull 16 with sharp bilges is expected to generate pronounced bilge vortices challenging the capabilities of the fluid modelling in this respect hull 19 with a slender form and rounded bilges will challenge the modelling for flow separation together the validation set is considered to well represent the entire delft wind assist systematic series it is assumed that a favourable result for the validation set can be interpreted as a validation statement for the series as a whole 2 2 appended geometries hull 1 and hull 34 were fitted with a series of appendages that was designed to represent a broad range of appendage typologies hull 1 was fitted with a rudder and bilge keels the rudder was mounted on a high precision quadrant that could be set to 0 6 and 6 hull 34 was fitted with a skeg and a combination skeg and barkeel fig 5 2 3 experimental campaigns the validation data used in this exercise was collected during two experimental campaigns in 2015 and in 2016 hull 1 bare hull 16 bare and hull 19 bare were tested during the 2015 campaign struijk 2015 hull 34 bare and all appended cases were tested in 2016 with the intent to eventually make statements about the validation level of simulations it is necessary to address any inconsistencies in the validation data set especially as may pertain to the experimental uncertainty two items need to be addressed the treatment for sinkage and trim and the adoption of a uniform strip resistance coefficient during the 2015 experiments the model was mounted using the setup normally used for sailing yachts at delft university of technology keuning and sonnenberg 1998 free to trim and sink according to the speed and leeway angle a fully restrained setup was used during the 2016 experiment with trim and sinkage both set to zero all simulations were performed with heave and pitch constrained in view of the low froude numbers considered a large discrepancy is not expected no correction to the experimental data was made for trim or sinkage the motivation for this change will be discussed further in section 4 finally a uniform turbulence stimulation resistance coefficient c ts was adopted determined in 2016 for hull 34 the post processing for the 2015 experiment was revisited with the 2016 c ts value 3 validation methodology fluid flow around the sailing ship will experience separation effects and will become entrained in large vortices in the wake of the ship as discussed in the introduction the modelling of these phenomena is the principal simulation challenge 3 1 validation statement the methodology for validation is taken from the international towing tank conference ittc guideline ittc 2014a and from the american society of mechanical engineers asme standard asme 2009 a validation statement is made according to the relationship between the comparison error defined as the difference between simulation and experimental values e s i m e x p and the validation standard uncertainty u val which is a combination of the uncertainties associated with the simulation and experimental data the following validation statement is adopted from ittc 2014b e u val the comparison error falls within uncertainty band defined by validation standard uncertainty the modelling error is within the noise level of the validation exercise the simulation is validated with a validation level equal to u val the validation level u val is of interest as a measure of the uncertainty of simulation data if the validation statement is affirmative confidence commensurate with the validation level is placed on the simulation methodology this estimate of the uncertainty for simulation data is retained for further work in regression analysis one objective of this validation exercise is to bound the modelling errors with a bandwidth defined by the validation standard uncertainty 1 δ model e u val e u val the modelling error may be inferred from the results of the validation exercise without making assumptions about the probability distribution of the errors δ n u m δ i n p u t δ e x p if the magnitude of the comparison error is much larger than the validation level 2 e u val in which case δ m o d e l e otherwise the modelling error is obscured by the noise level of the validation exercise represented by u val asme 2009 determining u val is thus a central task in the validation exercise following the derivation from the asme standard the error for a simulation result is separated into a component arising due to the modelling assumptions and approximations δ model and a component arising from the numerical solution of the equations δ num input uncertainties are excluded in this exercise the numerical error is expressed as an uncertainty u num roache 1997 eça and hoekstra 2014 assuming u num and u exp are uncorrelated and neglecting u input the following definition is adopted 3 u val u num 2 u exp 2 an example of a model error and a central complication for the validation data is the possible effect of the turbulence stimulators on separation location and on the strength of any separated vortices as determinants for the sideforce and yaw moments in this case one might argue that the simulation better resembles a real ship however the validation exercise measures the degree to which the simulation is able to reproduce experiments and the fault is therefore a modelling error for the simulation similarly vessel sinkage and trim which was allowed during the 2015 experiments and constrained for the 2016 experiments is constrained for all simulations although the 2016 experiment is less realistic one component of the simulation modelling error has been removed the focus here is the test the capabilities of rans cfd for separating flow structures and the validation cases might better be thought of as ship like forms an unambiguous categorization of numerical and the modelling errors is necessary to isolate and quantify the modelling error the validation procedure is carried out without modification for the case for f n 0 17 and β 0 6 9 for which an estimate for the validation standard uncertainty is directly available these results are presented in section 6 3 2 extended validation statement a validation statement is made for simulation of the delft wind assist series by applying a multivariate validation metric as proposed in hills 2006 to the validation data set it is assumed that the validation exercise and the statistics for the comparison error of the validation cases will be representative of the entire wind assist series the multivariate metric compares the radius of a hyper ellipse defined by the set of validation points with a reference radius for a corresponding normal distribution the radius r and r r e f are defined hills 2006 4 r e t v v a l 1 e 5 r r e f n 2 n e is the vector of n comparison errors and v val is the covariance matrix a diagonal matrix with the squared validation uncertainty for each validation point along the diagonal if the ratio r r r e f is larger than one than the comparison errors are generally larger than the validation level for r r r e f less than one the errors are less than expected for the corresponding normal distribution with n degrees of freedom following the same argumentation as for the single point validation statement above the simulation is regarded as validated for r r r e f less than one with a validation level according to the values for u v a l 4 experimental method 4 1 experimental setup experiments were designed to obtain validation data with minimal uncertainty as detailed in section 2 the validation data was collected during two experimental campaigns in 2015 and 2016 the setup for the experiment was altered for the 2016 campaign the fully constrained setup with the six component measurement frame rather than the sailing yacht set up gave better control over the position of the model and provides extra flexibility when designing the arrangement of sensors again with the aim to minimize experimental uncertainty the 2016 experiments are described in the remainder of this section the yacht setup of the delft ship hydromechanics laboratory is documented in keuning and sonnenberg 1998 during the 2016 test campaign the models were tested in fully captive setup the models were connected to the hexapod with the six component measurement frame the measurement frame is designed to resolve any applied force or moment into orthogonal forces and moments the hexapod setup is illustrated in fig 6 right with the top plate of the six component frame removed for clarity the arrangement of the sensors on the measurement frame was made to obtain the best possible fidelity for the sideforce the position of the model is recorded using a certus optical tracking system all signals are filtered with a low pass filter set to 100 hz before sampling to prevent aliasing the signal is sampled at a frequency of 1000 hz and written to disc the measurement campaign was three weeks long to assure that a consistent procedure was followed the following protocol was adopted 1 model set to zero leeway position for nul measurement 2 model set to leeway angle for second nul measurement 3 carriage accelerated to test speed 10 s is allowed for the flow to reach a steady condition 4 measurements recorded for 60 s the nominal rest period between runs was 20 min the test program is arranged so that high speed runs and repeat runs were interspersed regularly and so that a low speed run did not immediately follow a high speed run the first run of each day and the first run after a weekend was marked in the measurement log 4 1 1 turbulence stimulators the models were fitted with turbulence stimulators to ensure a turbulent boundary layer along the hull the correction for an added resistance due to turbulence stimulation was determined according to the standard practice of the delft ship hydromechanics laboratory by comparing resistance curves obtained for single and double strip configurations the turbulence stimulation strip resistance coefficient was determined for hull 34 bare this value is adopted for all other data including results from the 2015 experiment the resistance is corrected for the change in resistance due to the presence of turbulence stimulators 6 δ r t s 1 2 ρ v 2 c t s a t s a t s is the area of the turbulence stimulator 4 1 2 bow wave measurements as a further qualitative check for the simulations the interface capturing for the asymmetric bow wave was compared to measurements from experiments the profile of the bow wave was measured using cameras and grid markings on the ship the images were de warped to correct for lens effect and perspective and scaled so that one is pixel was equal to 0 5 mm it was then possible to measure the position of the maximum and minimum wave elevation this exercise was performed for hull 34 bare 4 2 experimental uncertainty the experimental uncertainty is determined according to the ittc guideline for planar motion tests ittc 2014a the following error components were found to be significant bias errors arising from the measurement of forces and moments with the six component frame bias errors arising from model misalignment in the tank bias errors due to geometric faults in the model construction and an end to end estimate of the precision error for the complete experimental setup the calculation of u x is detailed for hull 34 bare at f n 0 17 and β 9 presented in table 3 4 2 1 bias errors it is necessary to determine the sensitivity for each force component to each bias error the standard manoeuvring non dimensionalization is used to derive the sensitivities defined as the partial derivative with respect to the quantity of interest 7 x x 1 2 ρ u 2 t l 8 f x x 2 ρ u 2 t l 9 β x x β 10 t x 2 f x ρ u 2 t 2 l the bias error for forces measured with the six component frame was estimated by repeating the calibration process for the fully assembled frame the six component measurement frame contributes to the stiffness of the measurement system a variety of forces and moments were applied to the frame giving a correction to the calibration for x y and n of 0 5 1 2 and 1 respectively the remaining disparity including a significant hysteresis effect was used as b f x the hysteresis phenomena observed for strain gauges is exacerbated for the mechanically complex measurement frame anticipating that the vibrations of a moving carriage would encourage a settling of the frame a set of measurements was made with a typical carriage speed in fact the hysteresis effect was significantly reduced the estimate for b f x is therefore likely a conservative value the alignment of the model for each case was measured with ten repeat runs with five positive leeway angles and five negative leeway angles this allowed for a test for the symmetry of the system and also gave an indication for the precision of the setup these runs were arranged so that the position of the model was changed before each run i e the model was not simply towed repeatedly for a single condition for hull 1 rudder the rudder angle was set to positive and negative angles five runs with 6 leeway 6 rudder and five runs with 6 leeway 6 rudder as in fig 7 these runs were interspersed throughout the measurement campaign so that the ship position and rudder angle were altered before each repeat run the bias error for leeway angle b β was estimated using the x intercept of the linear fit for these results as a conservative estimate a sum was made of the absolute offset determined using the sideforce and the yaw moment this estimate for the bias might also contain the influence of an asymmetry in the model geometry finally the bias error due to faults in the model geometry is assumed b t 1 5 mm the bias error for x is expressed as an expanded uncertainty with 95 confidence level ittc 2014b 11 b x 2 x f x 2 b f x 2 x β 2 b β 2 x t b t 2 4 2 2 precision errors the repeatability of the measurement is an end to end test for the precision of the setup the repeat runs are meant to capture any variations in the test condition over the duration of the test program ten repeat runs positive leeway angle only were carried out for hull 34 skeg and the precision of the setup was determined as 12 p x 2 228 σ x the uncertainties are combined as uncorrelated quantities 13 u x b x 2 p x 2 5 results discussion the results for the validation exercise are presented the direct validation for hull 1 bare at fn 0 168 and leeway angles β 0 6 9 is given the validation statement is made for the bare hull geometries in the wind assist series followed by the visualization of the bow wave profile for hull 34 bare finally results for the validation of select appended geometries are given 5 1 explicit validation case all components of the validation standard uncertainty are available for hull 1 bare at f n 0 168 and for leeway angles β 0 6 9 the mesh contains 6m cells requiring 4 h to perform one simulation with the available computing resources a very good agreement between the simulation result and the experimental value is reported in table 4 the comparison error is less than the validation uncertainty for all cases and the simulation is validated at the respective validation levels the experimental and numerical uncertainties are of similar magnitudes details for the comparison error and the validation level are presented in table 4 5 2 bow wave profile the bow wave elevation was measured with cameras and using grid markings on the model a formal validation statement is not possible as the uncertainty associated with the simulation waterline was not determined a good quantitative agreement is reported for the maximum bow wave height and location pressure side and the minimum wave height and location suction side the distance between the simulation and experimental value is reported as δ δ x δ y the median error values occurred for f n 0 168 and β 6 ⁰ for this case the error for the bow wave crest pressure side is δ 4 6 mm the error for the bow wave trough suction side is δ 5 0 mm the results for this case are shown in figs 8 and 9 5 3 validation statement for rans cfd simulation of the delft wind assist series as described in section 3 3 the ratio r r r e f is adopted as a multiple point validation metric there are three validation points resistance x sideforce y and yaw moment n for each hull at each operating condition or 120 validation points in total results for r r r e f are also presented per force component several assumptions are required for the numerical uncertainty which is only available for the parent hull hull 1 at f n 0 168 and for leeway angles β 0 6 9 the computational effort required to determine the numerical uncertainty for additional geometries and operating conditions was prohibitive the numerical uncertainty for the sideforce in particular may be the dominant contribution to the validation level results for r r r e f are presented for several subsets of the validation data set defined according to the assumptions made for the numerical uncertainty subset 1 is defined by cases where the numerical uncertainty is directly available for f n 0 168 and for leeway angles β 0 6 9 subset 2 consists of all hulls of the bare hull validation set at the same operating condition as subset 1 where it is assumed that the numerical uncertainty is unchanged for varying hull geometry finally r r r e f is given for the complete validation set n 120 here it is assumed that the numerical uncertainty at f n 0 168 and leeway angle β 3 is equal to the uncertainty at f n 0 168 and β 6 the numerical uncertainty at other speeds in the validation data is assumed to scale with the magnitude of the measured quantity the ratio r r r e f must be considered against the validation uncertainty which form the entries of the covariance matrix v v a l the validation uncertainty for hull 1 bare is presented in table 5 in absolute and relative terms the validation uncertainties for other geometries will vary as the experimental uncertainty can be computed for all cases but the values for hull 1 bare are representative the magnitude of the sideforce at low speeds and for small angles is such that the validation uncertainty when expressed in relative terms may exceed 25 the simulation data to be obtained for hulls in the delft wind assist series will be evaluated in subsequent analysis together with a confidence interval dictated by this validation exercise although a detailed discussion of the derived quantities used for modelling for wind assist vessels is outside the scope of this publication this material is briefly introduced to highlight the implications of the validation levels presented see keuning and sonnenberg 1998 and van der kolk 2016 the principal quantities of interest for are the increase in resistance due to sideforce production x i and the centre of effort for hydrodynamic sideforce coe which is related to the maneuverability of the sailing vessel 14 x i x x β 0 15 coe n y the resistance increase due to sideforce production is modelled as an effective draft t e representing the efficiency of the hull this quantity is related to the slope of a linear fit through data for several leeway angles the second quantity of principal interest for this modelling for wind assist vessels is the center of effort coe for the distribution of lateral force which is related to the manoeuvrability of these vessels the position of the coe is determined as the quotient of the yaw moment and the sideforce the implications of the validation levels presented here for these derived quantities will be discussed below results for simulation validation for the complete wind assist series are presented in table 6 the multiple set point validation metric r r r e f is less than one for all subsets and all entries meaning that the comparison errors are generally less than the associated uncertainties following the validation approach outlined in section 3 the simulation method for the delft wind assist series is validated at the validation levels summarized in table 5 r r r e f 1 for all entries for the first subset indicates that the comparison error for these cases is much less than the associated validation uncertainties this is the same result already presented as a point wise validation in table 4 the simulation results for hull 1 at these operating conditions are in very close agreement with the validation data simulation and experimental results for resistance sideforce and yaw moment are presented in figs 10 13 for the validation set with β 0 the comparison errors for each component for each operating condition and for each hull follows for which the validation level presented in table 5 must be kept in mind simulation and experimental values for resistance are presented in fig 10 with the exception of hull 16 excellent agreement between these data is observed resistance for hull 16 the fuller hull with small bilge radius is under predicted though the comparison errors do lie within bounds of the validation level r r r e f 0 62 for resistance for hull 16 for modelling of wind assist vessels the resistance increase due to sideforce x i is the relevant quantity this derived quantity is determined from simulation and experimental values and presented in fig 11 this quantity is approximately one order of magnitude smaller than the data used for this validation exercise the validation uncertainty for resistance when expressed as a percentage of x i lies between 25 and 200 without considering the combination correlation of errors for the values x β 0 x still a good agreement for the trends in this data is observed considering the order of magnitude of the data and the uncertainties present the comparison between simulation and experimental results is poorest for hull 16 the fuller hull with small bilge radius stronger separation behaviour at the bilge and a larger more energetic wake of vortices is expected for this hull and the simulation is apparently unable to capture the behaviour completely in subsequent analysis for the derivation of a regression model for wind assist vessels the efficiency of a hull is expressed as an effective draft t e this quantity is related to the slope of a linear fit through data for several leeway angles the data at 9 leeway for maximum x i where the validation level for resistance is approximately 25 of x i is sufficient to determine the effective draft of the vessel though the magnitude of x i is quite small compared to the uncertainties present for resistance the linear modelling for the effective draft t e permits an analysis that relies on the larger values only for which the validation level is no longer prohibitive results for sideforce and yaw moment presented in fig 12 and fig 13 show close agreement with the exception of the sideforce for hull 16 here again a consistent under prediction is observed for the hull where strong separation behaviour is expected as discussed above it is likely that logarithmic wall modelling is inadequate for the separation behaviour associated with cross flow drag a sideforce component that should be quite strong for this hull for reference r r r e f 1 26 for sideforce y for hull 16 this appears to be a systematic error for all operating cases raising the possibility of implementing a correction for the simulation value for context the comparison error is on average 33 larger than the validation level for this hull in contrast with the sideforce the comparison error for yaw moment for hull 16 is much smaller yielding an r r r e f 0 68 a wall resolved boundary layer modelling may be a more appropriate simulation approach but the computational cost is deemed prohibitive in light of the volume of simulations anticipated the second quantity of principal interest for this modelling for wind assist vessels is the center of effort coe for the distribution of lateral force which is related to the course keeping ability of these vessels the position of the coe is determined as the quotient of the yaw moment and the sideforce the yaw moment is well predicted by simulation but the validation level for the sideforce is similarly troubled as the induced resistance above for the sideforce the large contribution of the numerical uncertainty see table 4 is a compounding factor despite the large relative uncertainties associated with the prediction sideforce production the results presented in fig 12 show a good agreement between simulation and the validation data even for hull 16 a consistent offset is observed but it may be said that the trend in the validation set is reproduced by simulation the distribution of comparison errors is presented in fig 14 for cases where the leeway angle β 0 resistance runs at β 0 a routine application of rans cfd were excluded to create a data sets with the same number of entries n 36 for resistance sideforce and yaw moment the comparison error is made relative using a constant equal to one half of the range of the measurands 16 e ens 100 s i m e x p 1 2 m a x e x p m i n e x p this definition for an ensemble comparison error was adopted to facilitate the presentation of the entire validation set as a distribution of relative errors it is a compromise that attempts to accommodate the range in order of magnitude for the sideforce and yaw moment by scaling the comparison error approximately in proportion with the validation uncertainty if each error is expressed as a percent of the experimental value errors that do not scale with the measurand would be overstated for smaller values of sideforce and yaw moment under the present definition of an ensemble comparison error e e n s the normalisation by a constant value for all errors will understate the relative error for small values of sideforce and yaw moment and overstate the relative errors for large values for small values of sideforce the validation level is larger in percentage terms motivation the suppression of these errors the opposing tendency exists for larger measurands the errors for each component appear to be normally distributed the statistics of the distribution are presented in table 7 including a 95 confidence interval of the ensemble comparison error which is understood as an estimate for the range of the comparison errors for the delft wind assist series for the sideforce in particular a 2 mean offset indicates there is a systematic under prediction by the simulation the negative outliers in fig 14 correspond to hull 16 with sharp bilges where pronounced separation of bilge vortices is expected simulation for sideforce is consistently under predicted for this hull 5 4 validation for appended cases simulation validation for appended cases is successful for select geometries and operating conditions only the simulation results for the bilge keel case significantly under predicts the lateral force the log law modelling for the boundary layer is not sufficient to capture separation behaviour at the bilge keel results for this case are not reported results for r r r e f for hull 1 rudder are presented in table 8 the validation set for the rudder was designed to bring the rudder into the stall regime for rudder angle equal to 6 and β 9 as expected r r r e f for hull 1 rudder 6 indicates that the comparison error for sideforce exceeds the validation uncertainty the onset of stall can be identified for this case in fig 16 if the stalled cases for rudder angle equal to 6 and β 9 are removed the validation metric for sideforce is reduced to r r r e f 0 36 results for r r r e f for hull 34 skeg and hull 34 skeg barkeel are presented in table 9 for these geometries the validation metric is less than one for all cases and all entries and the simulation is validated at validation levels similar to the values given in table 5 the results for x i for appended geometries is subject to the same qualifications outlined above for the bare hull result for the appended cases the resistance increase due to sideforce is generally over predicted a trend that also present for the bare hull cases excepting hull 16 as with any lifting profile the production of sideforce for wind assist vessels is characterised by a wake of vortices the presence of numerical dissipation may be introducing a non physical energy loss to the accounting for energy lost in shed vorticity though an apparently systematic error is observed the validation level for this quantity is much too large to consider making a correction see fig 15 simulation and experimental values for sideforce and yaw angle are presented in figs 16 and 17 an excellent agreement is observed when rudder stall angles are removed indicating that the simulation methodology may be used to study the sailing balance of wind assist vessels for these appendage types 6 conclusion the validation exercise for rans cfd simulation of wind assist vessels at leeway angles was presented for bare hull cases and appended cases the validation methodology was described for point wise comparison and for multiple validation points the experimental method was described with attention placed on the quantification of uncertainty the uncertainty for numerical simulation was adopted from part ii of this paper finally a series of validation statements was made for the simulation of hulls from the delft wind assist series first an explicit validation statement was made for the parent hull of the series operating at f n 0 168 and for leeway angles β 0 6 9 next a validation statement was made based on multiple validation points here the knowledge of the numerical uncertainty was limited to three operating conditions for the hull 1 only results for r r r e f were presented for several subsets of the validation set defined according to the assumptions made for the numerical uncertainty the validation metric r r r e f was less than one for all cases for the bare hull validation set and the simulation method is regarded as validated with validation levels indicated in table 5 the validation for appended geometries was successful for the rudder stalled conditions removed the skeg and skeg barkeel at validation levels indicated in table 5 the effective draft and the center of effort for sideforce are typical derived quantities that will be used to model the performance of wind assist vessels the implications of the validation result for resistance sideforce and yaw moment on these derived quantities has been outlined as discussed in section 6 4 the linear modelling for the t e representing the efficiency of the hull means that data at 9 leeway for maximum x i can be sufficient to determine the effective draft of the vessel the second quantity of principal interest for this modelling for wind assist vessels is the center of effort coe for the distribution of hydrodynamic sideforce related to the course keeping ability of these vessels a satisfactory result was obtained for this quantity for appended hull cases in particular the coe was very well predicted the impact of these appendage types on the course keeping for wind assist vessels may be investigated with the rans cfd tool simulation for wind assist vessels is possible with rans cfd fluid flow around these ships is characterised by the occurrence of separation and by a wake of large vortices both phenomena that likely challenge modelling assumptions made for the boundary layer and while averaging the navier stokes equations modelling separation behaviour and the evolution of vortices in the wake of a wind assist ship while maintaining a computationally affordable simulation methodology is the principal simulation challenge in general the validation level in this exercise was such that modelling errors cannot be distinguished from the uncertainties present in the exercise one exception is a consistent offset in the comparison error for sideforce for hull 16 fig 12 possibly caused by a failure of the logarithmic wall modelling to capture separation behaviour for the sharp bilges of this hull a correction for this systematic under prediction may be appropriate for context the comparison error is on average 33 larger than the validation level for this hull the log law modelling for the boundary layer is also not sufficient to capture separation behaviour at the bilge keel the shortcoming of the log law boundary layer modelling was expected but the added computational cost of wall resolved boundary layer modelling was deemed prohibitive in light of the volume of simulations anticipated acknowledgements this research is conducted with the support of the european commission as part of the joules project the author would also like to thank the vaderland fonds for their support computations were performed at the sara supercomputer facility with the sponsorship of nwo exacte natuuren wetenschappen enw nwo physical sciences division and numeca international 
22911,a reynolds averaged navier stokes computational fluid dynamics rans cfd package will be one of the primary tools used during the development of a performance prediction program for wind assisted commercial ships this paper is part 1 of a two part series describing the rans cfd method adopted for this study the modelling challenge presented by large separated flow structures in the wake of a sailing ship points to a conscientious validation study a validation data set consisting of hydrodynamic forces acting on the ships sailing with a leeway angle was collected at the delft university of technology towing tank facility for bare hull and appended cases appended cases were designed to represent a broad range of appendage typologies rudder bilge keels skeg and barkeel a validation statement is made for simulations for the entire bare hull series and for appended geometries excepting the bilge keel case the simulation method is described in part 2 including the assessment of the numerical uncertainty keywords green shipping computational fluid dynamics validation sailing vessels ships climate change 1 introduction wind as a source of energy for commercial ships has again garnered interest as an environmentally friendly propulsion alternative as a possible response to volatile fuel prices and to comply with increasingly exacting environmental regulations the further development of this promising technology is hampered by a poor understanding of the interaction effects between wind propulsors and the hydromechanics of commercial ships the wind assisted ship propulsion wasp performance prediction program under development at delft university of technology will provide designers and researchers the ability to explore the possibilities offered by wind as an auxiliary propulsor the performance prediction tool is developed and documented in a rigorous and transparent way so that the designer or researcher can confidently report performance figures for subsequent environmental and economic analyses the introduction of wind propulsors aboard commercial vessels will introduce forces and moments besides the desired forward thrust for sailing equilibrium the transvers component of the aerodynamic force must be opposed by a righting moment and a hydrodynamic sideforce the production of these reactionary forces gives rise to a steady heel angle and leeway angle vessel performance with leeway angles is characterised by an increase in resistance and by the generation of a strong destabilising moment about the yaw axis both of which are key design concerns with the wasp performance prediction program a designer is able to perform parametric investigations for the arrangement of wind propulsors and the hull form geometry and can eventually optimize a commercial hull form for sailing for example the well known phenomenon of induced drag for lifting surfaces has a direct analogue for commercial ship types while generating hydrodynamic sideforce though the flow mechanisms only vaguely resemble the prandtl wing and the associated derivation for the induced drag the accounting for energy loss in shed vorticity is especially relevant for the present application following theories for low aspect planforms jones 1946 the induced drag may be significant for commercial ships meaning that the thrust delivered by a wind propulsor might well be overwhelmed by this increase in resistance negating the benefit of adding the wind propulsor models that capture the behaviour of a generic commercial vessel under sail will be derived by studying the sensitivity of vessel performance to changes in hull geometry for example to determine the influence of vessel draft vessel behaviour for increased and decreased draft is fit to some functional form of course as other hull form parameters are allowed to vary the structure of this function will become increasingly complex the force models for a generic hull would be determined by polynomial regression techniques from a large set of systematically varied hulls in the past this database for regression analysis was built using results from towing tank experiments keuning and sonnenberg 1998 the maturity of reynolds averaged navier stokes computational fluid dynamics rans cfd solvers offers the ready inexpensive analysis for a large number of hull variations however simulations that remain computationally affordable may be unable to model the flow patterns occurring near a sailing commercial ship fluid flow around the wind assisted ship operating at a leeway angle will experience separation effects and will become entrained in large vortices in the wake of the ship modelling the occurrence of separation and the evolution of these vortices is the principal simulation challenge as both phenomena may challenge modelling assumptions made in the simulation setup in this paper a validation exercise is described for the computationally affordable assessment of large numbers of ship hull variations this simulation work is performed in the service of a regression based modelling for the performance of wind assist vessels production runs are performed with a six million cell grid which gave numerical uncertainties that were commensurate with the uncertainties in the experimental data the results for this validation exercise are presented for bare hull and appended hull rans cfd simulations 1 1 simulation method the simulation method for the production runs is designed for the assessment of hull geometry variants of the delft wind assist series the level of grid refinement is such that the volume of simulations is feasible using the cartesius supercomputer facility surf sara n d the simulations methodology for the validation exercise is described briefly to provide context for the reader the drift sweep procedure toxopeus 2011 was adopted for the efficient analysis of a series of leeway angles and speeds the domain is meshed once with the ship aligned with the x axis and assigned a prescribed motion including a leeway angle within a quiescent fluid as in fig 1 simulation cases proceed from a converged solution to the next combination of leeway angle and vessel speed using a gradual transition such that the time required for the convergence of the new solution is reduced compared with reinitializing the computation integrated fluid forces on the ship hull are determined in the coordinate system aligned with the direction of forward motion vessel response may be unsteady due to shedding behaviour around the hull but only averaged forces are of interest within the context of this study after the simulation has converged an average is made over one characteristic time interval equal to l u the simulations are performed with the fine marine suite a commercial rans cfd package distributed by numeca the unsteady rans equations are solved with the isis cfd flow solver developed at ecole centrale nantes the isis cfd flow solver is an incompressible unsteady rans method the unstructured spatial discretization for the transport equations is based on the finite volume method free surface flows are simulated with a conservation equation for the mass fraction a detailed description of the solver is provided in deng et al 2005 deng et al 2006 duvigneau and visonneau 2003 queutey and visonneau 2007 turbulence is modelled using the explicit algebraic stress model easm to provide an anisotropic modelling that remains computationally affordable simulation boundary conditions and meshing details are indicated in fig 2 the boundary layer at the ship hull is modelled with a logarithmic wall function boundary condition for model scale validation simulations five boundary layer cells were sufficient to satisfy the modelling criterion for y value at the hull as a single mesh is used for several operating conditions the average y was between 30 and 60 depending on the froude number while the maximum y varies between 65 and 90 located at the region of flow acceleration around the forward bilge the mesh refinement level at the hull corresponds to 500 cells per ship length the free surface is refined to a level nine in the z direction a detailed description of the simulation method meshing strategy and the simulation verification exercise is presented in part 2 of this publication 2 validation data set the validation dataset is composed of hulls from the delft wind assist series each hull and appended case is tested at three speeds froude number f n 0 128 0 168 0 21 corresponding to 9 12 and 15 knots at full scale at model scale the vessel speed is equal to 0 65 0 87 and 1 09 m s the full scale reynolds number is approximately 8e8 the model scale reynolds number is approximately 2 3e6 four leeway angles β 0 3 6 9 were tested giving a total of 12 operating conditions the validation data consists of global forces acting on the ship resistance x sideforce y and yaw moment n these are evaluated in a flow aligned coordinate system 2 1 delft wind assist series the hulls in the wind assist series are systematic variations of a wind assist concept designed by dykstra naval architects of the netherlands fig 3 the series comprises 65 hulls for which the prismatic coefficient the midship coefficient the draft to length ratio and the deadrise angle are systematically varied the variation for prismatic coefficient is effected by lengthening or shortening the parallel mid body the midship coefficient is modified by increasing and decreasing the bilge radius for variations in the draft to length ratio the displacement is kept constant by reducing the beam accordingly finally the deadrise hulls are defined by extending a tangent line from the bilge to the centreline at the appropriate angle the extents of the systematic series and the geometry for validation cases are presented in fig 4 and table 2 hull 1 and hull 34 were selected as representative hulls for the series hull 1 being the parent hull at the centre of all variations and hull 34 as the median case for the deadrise hulls hull 16 with sharp bilges is expected to generate pronounced bilge vortices challenging the capabilities of the fluid modelling in this respect hull 19 with a slender form and rounded bilges will challenge the modelling for flow separation together the validation set is considered to well represent the entire delft wind assist systematic series it is assumed that a favourable result for the validation set can be interpreted as a validation statement for the series as a whole 2 2 appended geometries hull 1 and hull 34 were fitted with a series of appendages that was designed to represent a broad range of appendage typologies hull 1 was fitted with a rudder and bilge keels the rudder was mounted on a high precision quadrant that could be set to 0 6 and 6 hull 34 was fitted with a skeg and a combination skeg and barkeel fig 5 2 3 experimental campaigns the validation data used in this exercise was collected during two experimental campaigns in 2015 and in 2016 hull 1 bare hull 16 bare and hull 19 bare were tested during the 2015 campaign struijk 2015 hull 34 bare and all appended cases were tested in 2016 with the intent to eventually make statements about the validation level of simulations it is necessary to address any inconsistencies in the validation data set especially as may pertain to the experimental uncertainty two items need to be addressed the treatment for sinkage and trim and the adoption of a uniform strip resistance coefficient during the 2015 experiments the model was mounted using the setup normally used for sailing yachts at delft university of technology keuning and sonnenberg 1998 free to trim and sink according to the speed and leeway angle a fully restrained setup was used during the 2016 experiment with trim and sinkage both set to zero all simulations were performed with heave and pitch constrained in view of the low froude numbers considered a large discrepancy is not expected no correction to the experimental data was made for trim or sinkage the motivation for this change will be discussed further in section 4 finally a uniform turbulence stimulation resistance coefficient c ts was adopted determined in 2016 for hull 34 the post processing for the 2015 experiment was revisited with the 2016 c ts value 3 validation methodology fluid flow around the sailing ship will experience separation effects and will become entrained in large vortices in the wake of the ship as discussed in the introduction the modelling of these phenomena is the principal simulation challenge 3 1 validation statement the methodology for validation is taken from the international towing tank conference ittc guideline ittc 2014a and from the american society of mechanical engineers asme standard asme 2009 a validation statement is made according to the relationship between the comparison error defined as the difference between simulation and experimental values e s i m e x p and the validation standard uncertainty u val which is a combination of the uncertainties associated with the simulation and experimental data the following validation statement is adopted from ittc 2014b e u val the comparison error falls within uncertainty band defined by validation standard uncertainty the modelling error is within the noise level of the validation exercise the simulation is validated with a validation level equal to u val the validation level u val is of interest as a measure of the uncertainty of simulation data if the validation statement is affirmative confidence commensurate with the validation level is placed on the simulation methodology this estimate of the uncertainty for simulation data is retained for further work in regression analysis one objective of this validation exercise is to bound the modelling errors with a bandwidth defined by the validation standard uncertainty 1 δ model e u val e u val the modelling error may be inferred from the results of the validation exercise without making assumptions about the probability distribution of the errors δ n u m δ i n p u t δ e x p if the magnitude of the comparison error is much larger than the validation level 2 e u val in which case δ m o d e l e otherwise the modelling error is obscured by the noise level of the validation exercise represented by u val asme 2009 determining u val is thus a central task in the validation exercise following the derivation from the asme standard the error for a simulation result is separated into a component arising due to the modelling assumptions and approximations δ model and a component arising from the numerical solution of the equations δ num input uncertainties are excluded in this exercise the numerical error is expressed as an uncertainty u num roache 1997 eça and hoekstra 2014 assuming u num and u exp are uncorrelated and neglecting u input the following definition is adopted 3 u val u num 2 u exp 2 an example of a model error and a central complication for the validation data is the possible effect of the turbulence stimulators on separation location and on the strength of any separated vortices as determinants for the sideforce and yaw moments in this case one might argue that the simulation better resembles a real ship however the validation exercise measures the degree to which the simulation is able to reproduce experiments and the fault is therefore a modelling error for the simulation similarly vessel sinkage and trim which was allowed during the 2015 experiments and constrained for the 2016 experiments is constrained for all simulations although the 2016 experiment is less realistic one component of the simulation modelling error has been removed the focus here is the test the capabilities of rans cfd for separating flow structures and the validation cases might better be thought of as ship like forms an unambiguous categorization of numerical and the modelling errors is necessary to isolate and quantify the modelling error the validation procedure is carried out without modification for the case for f n 0 17 and β 0 6 9 for which an estimate for the validation standard uncertainty is directly available these results are presented in section 6 3 2 extended validation statement a validation statement is made for simulation of the delft wind assist series by applying a multivariate validation metric as proposed in hills 2006 to the validation data set it is assumed that the validation exercise and the statistics for the comparison error of the validation cases will be representative of the entire wind assist series the multivariate metric compares the radius of a hyper ellipse defined by the set of validation points with a reference radius for a corresponding normal distribution the radius r and r r e f are defined hills 2006 4 r e t v v a l 1 e 5 r r e f n 2 n e is the vector of n comparison errors and v val is the covariance matrix a diagonal matrix with the squared validation uncertainty for each validation point along the diagonal if the ratio r r r e f is larger than one than the comparison errors are generally larger than the validation level for r r r e f less than one the errors are less than expected for the corresponding normal distribution with n degrees of freedom following the same argumentation as for the single point validation statement above the simulation is regarded as validated for r r r e f less than one with a validation level according to the values for u v a l 4 experimental method 4 1 experimental setup experiments were designed to obtain validation data with minimal uncertainty as detailed in section 2 the validation data was collected during two experimental campaigns in 2015 and 2016 the setup for the experiment was altered for the 2016 campaign the fully constrained setup with the six component measurement frame rather than the sailing yacht set up gave better control over the position of the model and provides extra flexibility when designing the arrangement of sensors again with the aim to minimize experimental uncertainty the 2016 experiments are described in the remainder of this section the yacht setup of the delft ship hydromechanics laboratory is documented in keuning and sonnenberg 1998 during the 2016 test campaign the models were tested in fully captive setup the models were connected to the hexapod with the six component measurement frame the measurement frame is designed to resolve any applied force or moment into orthogonal forces and moments the hexapod setup is illustrated in fig 6 right with the top plate of the six component frame removed for clarity the arrangement of the sensors on the measurement frame was made to obtain the best possible fidelity for the sideforce the position of the model is recorded using a certus optical tracking system all signals are filtered with a low pass filter set to 100 hz before sampling to prevent aliasing the signal is sampled at a frequency of 1000 hz and written to disc the measurement campaign was three weeks long to assure that a consistent procedure was followed the following protocol was adopted 1 model set to zero leeway position for nul measurement 2 model set to leeway angle for second nul measurement 3 carriage accelerated to test speed 10 s is allowed for the flow to reach a steady condition 4 measurements recorded for 60 s the nominal rest period between runs was 20 min the test program is arranged so that high speed runs and repeat runs were interspersed regularly and so that a low speed run did not immediately follow a high speed run the first run of each day and the first run after a weekend was marked in the measurement log 4 1 1 turbulence stimulators the models were fitted with turbulence stimulators to ensure a turbulent boundary layer along the hull the correction for an added resistance due to turbulence stimulation was determined according to the standard practice of the delft ship hydromechanics laboratory by comparing resistance curves obtained for single and double strip configurations the turbulence stimulation strip resistance coefficient was determined for hull 34 bare this value is adopted for all other data including results from the 2015 experiment the resistance is corrected for the change in resistance due to the presence of turbulence stimulators 6 δ r t s 1 2 ρ v 2 c t s a t s a t s is the area of the turbulence stimulator 4 1 2 bow wave measurements as a further qualitative check for the simulations the interface capturing for the asymmetric bow wave was compared to measurements from experiments the profile of the bow wave was measured using cameras and grid markings on the ship the images were de warped to correct for lens effect and perspective and scaled so that one is pixel was equal to 0 5 mm it was then possible to measure the position of the maximum and minimum wave elevation this exercise was performed for hull 34 bare 4 2 experimental uncertainty the experimental uncertainty is determined according to the ittc guideline for planar motion tests ittc 2014a the following error components were found to be significant bias errors arising from the measurement of forces and moments with the six component frame bias errors arising from model misalignment in the tank bias errors due to geometric faults in the model construction and an end to end estimate of the precision error for the complete experimental setup the calculation of u x is detailed for hull 34 bare at f n 0 17 and β 9 presented in table 3 4 2 1 bias errors it is necessary to determine the sensitivity for each force component to each bias error the standard manoeuvring non dimensionalization is used to derive the sensitivities defined as the partial derivative with respect to the quantity of interest 7 x x 1 2 ρ u 2 t l 8 f x x 2 ρ u 2 t l 9 β x x β 10 t x 2 f x ρ u 2 t 2 l the bias error for forces measured with the six component frame was estimated by repeating the calibration process for the fully assembled frame the six component measurement frame contributes to the stiffness of the measurement system a variety of forces and moments were applied to the frame giving a correction to the calibration for x y and n of 0 5 1 2 and 1 respectively the remaining disparity including a significant hysteresis effect was used as b f x the hysteresis phenomena observed for strain gauges is exacerbated for the mechanically complex measurement frame anticipating that the vibrations of a moving carriage would encourage a settling of the frame a set of measurements was made with a typical carriage speed in fact the hysteresis effect was significantly reduced the estimate for b f x is therefore likely a conservative value the alignment of the model for each case was measured with ten repeat runs with five positive leeway angles and five negative leeway angles this allowed for a test for the symmetry of the system and also gave an indication for the precision of the setup these runs were arranged so that the position of the model was changed before each run i e the model was not simply towed repeatedly for a single condition for hull 1 rudder the rudder angle was set to positive and negative angles five runs with 6 leeway 6 rudder and five runs with 6 leeway 6 rudder as in fig 7 these runs were interspersed throughout the measurement campaign so that the ship position and rudder angle were altered before each repeat run the bias error for leeway angle b β was estimated using the x intercept of the linear fit for these results as a conservative estimate a sum was made of the absolute offset determined using the sideforce and the yaw moment this estimate for the bias might also contain the influence of an asymmetry in the model geometry finally the bias error due to faults in the model geometry is assumed b t 1 5 mm the bias error for x is expressed as an expanded uncertainty with 95 confidence level ittc 2014b 11 b x 2 x f x 2 b f x 2 x β 2 b β 2 x t b t 2 4 2 2 precision errors the repeatability of the measurement is an end to end test for the precision of the setup the repeat runs are meant to capture any variations in the test condition over the duration of the test program ten repeat runs positive leeway angle only were carried out for hull 34 skeg and the precision of the setup was determined as 12 p x 2 228 σ x the uncertainties are combined as uncorrelated quantities 13 u x b x 2 p x 2 5 results discussion the results for the validation exercise are presented the direct validation for hull 1 bare at fn 0 168 and leeway angles β 0 6 9 is given the validation statement is made for the bare hull geometries in the wind assist series followed by the visualization of the bow wave profile for hull 34 bare finally results for the validation of select appended geometries are given 5 1 explicit validation case all components of the validation standard uncertainty are available for hull 1 bare at f n 0 168 and for leeway angles β 0 6 9 the mesh contains 6m cells requiring 4 h to perform one simulation with the available computing resources a very good agreement between the simulation result and the experimental value is reported in table 4 the comparison error is less than the validation uncertainty for all cases and the simulation is validated at the respective validation levels the experimental and numerical uncertainties are of similar magnitudes details for the comparison error and the validation level are presented in table 4 5 2 bow wave profile the bow wave elevation was measured with cameras and using grid markings on the model a formal validation statement is not possible as the uncertainty associated with the simulation waterline was not determined a good quantitative agreement is reported for the maximum bow wave height and location pressure side and the minimum wave height and location suction side the distance between the simulation and experimental value is reported as δ δ x δ y the median error values occurred for f n 0 168 and β 6 ⁰ for this case the error for the bow wave crest pressure side is δ 4 6 mm the error for the bow wave trough suction side is δ 5 0 mm the results for this case are shown in figs 8 and 9 5 3 validation statement for rans cfd simulation of the delft wind assist series as described in section 3 3 the ratio r r r e f is adopted as a multiple point validation metric there are three validation points resistance x sideforce y and yaw moment n for each hull at each operating condition or 120 validation points in total results for r r r e f are also presented per force component several assumptions are required for the numerical uncertainty which is only available for the parent hull hull 1 at f n 0 168 and for leeway angles β 0 6 9 the computational effort required to determine the numerical uncertainty for additional geometries and operating conditions was prohibitive the numerical uncertainty for the sideforce in particular may be the dominant contribution to the validation level results for r r r e f are presented for several subsets of the validation data set defined according to the assumptions made for the numerical uncertainty subset 1 is defined by cases where the numerical uncertainty is directly available for f n 0 168 and for leeway angles β 0 6 9 subset 2 consists of all hulls of the bare hull validation set at the same operating condition as subset 1 where it is assumed that the numerical uncertainty is unchanged for varying hull geometry finally r r r e f is given for the complete validation set n 120 here it is assumed that the numerical uncertainty at f n 0 168 and leeway angle β 3 is equal to the uncertainty at f n 0 168 and β 6 the numerical uncertainty at other speeds in the validation data is assumed to scale with the magnitude of the measured quantity the ratio r r r e f must be considered against the validation uncertainty which form the entries of the covariance matrix v v a l the validation uncertainty for hull 1 bare is presented in table 5 in absolute and relative terms the validation uncertainties for other geometries will vary as the experimental uncertainty can be computed for all cases but the values for hull 1 bare are representative the magnitude of the sideforce at low speeds and for small angles is such that the validation uncertainty when expressed in relative terms may exceed 25 the simulation data to be obtained for hulls in the delft wind assist series will be evaluated in subsequent analysis together with a confidence interval dictated by this validation exercise although a detailed discussion of the derived quantities used for modelling for wind assist vessels is outside the scope of this publication this material is briefly introduced to highlight the implications of the validation levels presented see keuning and sonnenberg 1998 and van der kolk 2016 the principal quantities of interest for are the increase in resistance due to sideforce production x i and the centre of effort for hydrodynamic sideforce coe which is related to the maneuverability of the sailing vessel 14 x i x x β 0 15 coe n y the resistance increase due to sideforce production is modelled as an effective draft t e representing the efficiency of the hull this quantity is related to the slope of a linear fit through data for several leeway angles the second quantity of principal interest for this modelling for wind assist vessels is the center of effort coe for the distribution of lateral force which is related to the manoeuvrability of these vessels the position of the coe is determined as the quotient of the yaw moment and the sideforce the implications of the validation levels presented here for these derived quantities will be discussed below results for simulation validation for the complete wind assist series are presented in table 6 the multiple set point validation metric r r r e f is less than one for all subsets and all entries meaning that the comparison errors are generally less than the associated uncertainties following the validation approach outlined in section 3 the simulation method for the delft wind assist series is validated at the validation levels summarized in table 5 r r r e f 1 for all entries for the first subset indicates that the comparison error for these cases is much less than the associated validation uncertainties this is the same result already presented as a point wise validation in table 4 the simulation results for hull 1 at these operating conditions are in very close agreement with the validation data simulation and experimental results for resistance sideforce and yaw moment are presented in figs 10 13 for the validation set with β 0 the comparison errors for each component for each operating condition and for each hull follows for which the validation level presented in table 5 must be kept in mind simulation and experimental values for resistance are presented in fig 10 with the exception of hull 16 excellent agreement between these data is observed resistance for hull 16 the fuller hull with small bilge radius is under predicted though the comparison errors do lie within bounds of the validation level r r r e f 0 62 for resistance for hull 16 for modelling of wind assist vessels the resistance increase due to sideforce x i is the relevant quantity this derived quantity is determined from simulation and experimental values and presented in fig 11 this quantity is approximately one order of magnitude smaller than the data used for this validation exercise the validation uncertainty for resistance when expressed as a percentage of x i lies between 25 and 200 without considering the combination correlation of errors for the values x β 0 x still a good agreement for the trends in this data is observed considering the order of magnitude of the data and the uncertainties present the comparison between simulation and experimental results is poorest for hull 16 the fuller hull with small bilge radius stronger separation behaviour at the bilge and a larger more energetic wake of vortices is expected for this hull and the simulation is apparently unable to capture the behaviour completely in subsequent analysis for the derivation of a regression model for wind assist vessels the efficiency of a hull is expressed as an effective draft t e this quantity is related to the slope of a linear fit through data for several leeway angles the data at 9 leeway for maximum x i where the validation level for resistance is approximately 25 of x i is sufficient to determine the effective draft of the vessel though the magnitude of x i is quite small compared to the uncertainties present for resistance the linear modelling for the effective draft t e permits an analysis that relies on the larger values only for which the validation level is no longer prohibitive results for sideforce and yaw moment presented in fig 12 and fig 13 show close agreement with the exception of the sideforce for hull 16 here again a consistent under prediction is observed for the hull where strong separation behaviour is expected as discussed above it is likely that logarithmic wall modelling is inadequate for the separation behaviour associated with cross flow drag a sideforce component that should be quite strong for this hull for reference r r r e f 1 26 for sideforce y for hull 16 this appears to be a systematic error for all operating cases raising the possibility of implementing a correction for the simulation value for context the comparison error is on average 33 larger than the validation level for this hull in contrast with the sideforce the comparison error for yaw moment for hull 16 is much smaller yielding an r r r e f 0 68 a wall resolved boundary layer modelling may be a more appropriate simulation approach but the computational cost is deemed prohibitive in light of the volume of simulations anticipated the second quantity of principal interest for this modelling for wind assist vessels is the center of effort coe for the distribution of lateral force which is related to the course keeping ability of these vessels the position of the coe is determined as the quotient of the yaw moment and the sideforce the yaw moment is well predicted by simulation but the validation level for the sideforce is similarly troubled as the induced resistance above for the sideforce the large contribution of the numerical uncertainty see table 4 is a compounding factor despite the large relative uncertainties associated with the prediction sideforce production the results presented in fig 12 show a good agreement between simulation and the validation data even for hull 16 a consistent offset is observed but it may be said that the trend in the validation set is reproduced by simulation the distribution of comparison errors is presented in fig 14 for cases where the leeway angle β 0 resistance runs at β 0 a routine application of rans cfd were excluded to create a data sets with the same number of entries n 36 for resistance sideforce and yaw moment the comparison error is made relative using a constant equal to one half of the range of the measurands 16 e ens 100 s i m e x p 1 2 m a x e x p m i n e x p this definition for an ensemble comparison error was adopted to facilitate the presentation of the entire validation set as a distribution of relative errors it is a compromise that attempts to accommodate the range in order of magnitude for the sideforce and yaw moment by scaling the comparison error approximately in proportion with the validation uncertainty if each error is expressed as a percent of the experimental value errors that do not scale with the measurand would be overstated for smaller values of sideforce and yaw moment under the present definition of an ensemble comparison error e e n s the normalisation by a constant value for all errors will understate the relative error for small values of sideforce and yaw moment and overstate the relative errors for large values for small values of sideforce the validation level is larger in percentage terms motivation the suppression of these errors the opposing tendency exists for larger measurands the errors for each component appear to be normally distributed the statistics of the distribution are presented in table 7 including a 95 confidence interval of the ensemble comparison error which is understood as an estimate for the range of the comparison errors for the delft wind assist series for the sideforce in particular a 2 mean offset indicates there is a systematic under prediction by the simulation the negative outliers in fig 14 correspond to hull 16 with sharp bilges where pronounced separation of bilge vortices is expected simulation for sideforce is consistently under predicted for this hull 5 4 validation for appended cases simulation validation for appended cases is successful for select geometries and operating conditions only the simulation results for the bilge keel case significantly under predicts the lateral force the log law modelling for the boundary layer is not sufficient to capture separation behaviour at the bilge keel results for this case are not reported results for r r r e f for hull 1 rudder are presented in table 8 the validation set for the rudder was designed to bring the rudder into the stall regime for rudder angle equal to 6 and β 9 as expected r r r e f for hull 1 rudder 6 indicates that the comparison error for sideforce exceeds the validation uncertainty the onset of stall can be identified for this case in fig 16 if the stalled cases for rudder angle equal to 6 and β 9 are removed the validation metric for sideforce is reduced to r r r e f 0 36 results for r r r e f for hull 34 skeg and hull 34 skeg barkeel are presented in table 9 for these geometries the validation metric is less than one for all cases and all entries and the simulation is validated at validation levels similar to the values given in table 5 the results for x i for appended geometries is subject to the same qualifications outlined above for the bare hull result for the appended cases the resistance increase due to sideforce is generally over predicted a trend that also present for the bare hull cases excepting hull 16 as with any lifting profile the production of sideforce for wind assist vessels is characterised by a wake of vortices the presence of numerical dissipation may be introducing a non physical energy loss to the accounting for energy lost in shed vorticity though an apparently systematic error is observed the validation level for this quantity is much too large to consider making a correction see fig 15 simulation and experimental values for sideforce and yaw angle are presented in figs 16 and 17 an excellent agreement is observed when rudder stall angles are removed indicating that the simulation methodology may be used to study the sailing balance of wind assist vessels for these appendage types 6 conclusion the validation exercise for rans cfd simulation of wind assist vessels at leeway angles was presented for bare hull cases and appended cases the validation methodology was described for point wise comparison and for multiple validation points the experimental method was described with attention placed on the quantification of uncertainty the uncertainty for numerical simulation was adopted from part ii of this paper finally a series of validation statements was made for the simulation of hulls from the delft wind assist series first an explicit validation statement was made for the parent hull of the series operating at f n 0 168 and for leeway angles β 0 6 9 next a validation statement was made based on multiple validation points here the knowledge of the numerical uncertainty was limited to three operating conditions for the hull 1 only results for r r r e f were presented for several subsets of the validation set defined according to the assumptions made for the numerical uncertainty the validation metric r r r e f was less than one for all cases for the bare hull validation set and the simulation method is regarded as validated with validation levels indicated in table 5 the validation for appended geometries was successful for the rudder stalled conditions removed the skeg and skeg barkeel at validation levels indicated in table 5 the effective draft and the center of effort for sideforce are typical derived quantities that will be used to model the performance of wind assist vessels the implications of the validation result for resistance sideforce and yaw moment on these derived quantities has been outlined as discussed in section 6 4 the linear modelling for the t e representing the efficiency of the hull means that data at 9 leeway for maximum x i can be sufficient to determine the effective draft of the vessel the second quantity of principal interest for this modelling for wind assist vessels is the center of effort coe for the distribution of hydrodynamic sideforce related to the course keeping ability of these vessels a satisfactory result was obtained for this quantity for appended hull cases in particular the coe was very well predicted the impact of these appendage types on the course keeping for wind assist vessels may be investigated with the rans cfd tool simulation for wind assist vessels is possible with rans cfd fluid flow around these ships is characterised by the occurrence of separation and by a wake of large vortices both phenomena that likely challenge modelling assumptions made for the boundary layer and while averaging the navier stokes equations modelling separation behaviour and the evolution of vortices in the wake of a wind assist ship while maintaining a computationally affordable simulation methodology is the principal simulation challenge in general the validation level in this exercise was such that modelling errors cannot be distinguished from the uncertainties present in the exercise one exception is a consistent offset in the comparison error for sideforce for hull 16 fig 12 possibly caused by a failure of the logarithmic wall modelling to capture separation behaviour for the sharp bilges of this hull a correction for this systematic under prediction may be appropriate for context the comparison error is on average 33 larger than the validation level for this hull the log law modelling for the boundary layer is also not sufficient to capture separation behaviour at the bilge keel the shortcoming of the log law boundary layer modelling was expected but the added computational cost of wall resolved boundary layer modelling was deemed prohibitive in light of the volume of simulations anticipated acknowledgements this research is conducted with the support of the european commission as part of the joules project the author would also like to thank the vaderland fonds for their support computations were performed at the sara supercomputer facility with the sponsorship of nwo exacte natuuren wetenschappen enw nwo physical sciences division and numeca international 
22912,this paper introduces a time domain potential flow method for simulating fully nonlinear wave interaction with a fluid filled membrane mounted on the seabed the numerical method is based on a mixed eulerian lagrangian method which tracks the free water surface and the membrane using a lagrangian method and solves the flow fields inside and outside the membrane using an eulerian method to remove the numerical instability a method that satisfies the no flux condition on the membrane at any location and any time was developed to calculate the radial displacement of the membrane at every time step and a fourier series expression for the radial displacement of the membrane was used to calculate the local curvature of the membrane accurately experimental results from an existing experimental study were used for model validation and verification the response of the membrane and the nonlinear wave scattering were simulated the simulation results show that the transmission coefficients of the fundamental waves second harmonic free and locked waves approach zero when a resonant response of the membrane to waves occurs sample results of the simulated tension in the membrane and interior pressure are also included in the discussion keywords fluid filled membrane fluid structure interaction nonlinear waves mixed eulerian lagrangian method breakwater coastal structures 1 introduction fluid filled membrane structures can be used as temporary removable breakwaters which have the advantages such as lower costs easy deployment and non intrusion ohyama et al 1989 unlike traditional breakwaters fluid filled membrane structures may have large deformation under the action of incoming waves which can be used to control wave transmission through destructive interference between the radiated waves and the scattered waves existing studies on the wave interaction with membrane structures focused mainly on linear and two dimensional problems ohyama et al 1989 modeled a submerged bottom mounted fluid filled membrane as a lumped mass system and used linear potential theory to study the transmission and reflection of regular waves zhao 1995 and zhao and aarsnes 1998 theoretically studied the dynamic response of a floating liquid filled membrane structure by a small perturbation to the static solution lo 2000 used an eigen function expansion method to study the linear interaction of water waves with a vertical suspended flexible membrane and found that the wave generated by the membrane motion could cancel the wave transmitted through the gap between the lower end of the membrane and the bottom using a boundary element method bem coupled with finite element method fem phadke and cheung 1999 2001 studied the response of a fluid filled membrane to linear gravity waves assuming linear waves and small amplitude membrane response suresh et al 2007 studied the wave scattering by a vertical flexible porous membrane barrier in a two layer fluid using an eigen function expansion method karmakar and sahoo 2008 studied the wave scattering by a floating horizontal membrane using an eigen function expansion method and calculated the reflection and transmission coefficients by the energy flux conservation and the green s second identity karmakar et al 2012 studied the linear wave scattering by multiple surface piercing floating membranes using an eigen function expansion method with a wide spacing approximation only a few studies of the three dimensional responses of flexible membrane structures to ocean waves can be found in the literature cho and kim 1998 employed an eigen function expansion method to investigate the interaction of oblique monochromatic waves with a horizontal flexible membrane in the context of linear hydro elastic theory assuming linear waves and small membrane deflection das and cheung 2009 used a boundary element method coupled with a finite element model to study the three dimensional response of a bottom mounted fluid filled membrane in a wave flume setting koley and sahoo 2017 used linear water waves theory to study the three dimensional wave scattering by a permeable vertical flexible membrane and found that zero transmission could occur under certain conditions all aforementioned studies have assumed linear water waves strictly speaking linear wave assumption is valid only for small amplitude waves as the wave amplitude increases the membrane deformation increases and higher harmonic waves become apparent which will in turn affect the deformation of the membrane therefore for nonlinear waves the geometric nonlinearity due to the large deformation of the membrane and the generation of higher harmonics must be considered assuming linear waves phadke and cheung 2003 considered the geometric nonlinearity and derived the governing integral equation for finite membrane deformation based on the principle of virtual work a linear boundary element method was used to solve the potential flows inside and outside the membrane and a nonlinear finite element model was used to solve the motion of the membrane in the time domain phadke and cheung 2003 revealed that the geometric nonlinearity could affect the resonant frequency at which a minimum transmission occurs broderick and leonard 1995 presented a method to simulate the interaction of the nonlinear waves with the fluid filled membrane by using bem coupled with fem but they assumed that the internal fluid contained by the membrane could be modeled as a lumped mass and that the internal pressure could be treated as a constant the validity of these assumptions however is questionable we are not aware of the existence of time domain potential flow solvers developed for simulating fully nonlinear wave interaction with fluid filled membrane structures coastal waves are better described by nonlinear waves for engineering designs of this type of breakwaters it is necessary to have the ability to simulate the nonlinear wave interaction with fluid filled membrane structures this study presents a time domain potential flow solver developed specifically for fully nonlinear waves interacting with a fluid filled membrane mounted on the seabed the solver is based on a lagrangian eulerian formulation which tracks the free water surface and the membrane using a lagrangian method and solves the flow fields inside and outside the membrane using an eulerian method the mathematical formulation is presented in section 2 which is followed by a detailed description of the numerical method in section 3 model validation and key results are presented in section 4 where effects of wave frequency and wave height on the wave transmission and the response of the membrane higher harmonic free and locked waves on the lee side of the membrane structure higher harmonic responses of the membrane and the tension force in the membrane are discussed main conclusions are drawn in section 5 2 mathematical formulation the breakwater under consideration is a bottom mounted membrane filled with water as shown in fig 1 where the water enclosed by the membrane is the same as the surrounding water the virtual wave gauges g 1 through g 4 shown in the figure are for wave separation analysis 2 1 coordinate systems at its static equilibrium state the shape of the membrane is a segment of a circle whose center and radius are denoted by o and r i respectively to describe the motion of the membrane two coordinate systems are defined one is a cartesian coordinate system x z and the other is a polar coordinate system r θ these two coordinate systems share the same origin which is at the center of the circle x axis is on a horizontal plane pointing in the direction of wave propagation and z axis points upward for the polar coordinate system θ is the angle between x and r so that 1 x r cos θ and z r sin θ a global cartesian coordinate system x z is also defined with the horizontal axis x being on the still water surface and the vertical axis z pointing upward and on the surface of the symmetry of the membrane 2 2 description of the membrane and its displacement after the membrane is filled with water there will be a pressure difference on the two sides of the membrane in the absence of waves the pressure at any location x e z e outside the membrane is the hydro static pressure ρ g z e and the pressure at any location x i z i inside the membrane is ρ g z i p where p is the so called excess pressure at any point on the membrane the difference in the pressures on the two sides of the membrane is denoted by p in the absence of waves the shape of the membrane is an arch with a radius r i and the excess pressure p is balanced by the initial tension τ i so that 2 τ i p r i the initial length of the membrane l i can be obtained by l i r i δ θ where δ θ is the difference of the values of θ at the two ends of the membrane for later use we denote the radius and the length of the arc when p 0 by r 0 and l 0 respectively the initial tension corresponding to the excess pressure p can be related to the material property by 3 τ i e d l i l 0 l 0 where e is the membrane elastic modulus and d the thickness of the membrane under the action of water waves the membrane will deform and the instantaneous shape of the deformed membrane is better described in the polar coordinate system by r i ζ t θ the length of the membrane will also change with the deformation of the membrane the instantaneous length of the membrane l t will always be longer than l i and l 0 resulting in an increase in the tension the instantaneous tension τ t is determined by the instantaneous length of the membrane l t 4 τ t e d l t l 0 l 0 which can be re written as 5 τ t τ i e d l t l i l i l i l 0 we consider a thin membrane whose mass is very small compared to the mass of the fluid enclosed by the membrane so that the inertial force of the membrane can be ignored see appendix a for a discussion in this case the instantaneous tension can be caused by the difference of the pressures on the two sides of the membrane i e 6 p i p e τ t κ on the membrane where p i and p e are the local pressures on the inner and outer sides of the membrane respectively and κ is the local curvature of the membrane because the local curvature κ and the tension τ can be determined when the shape of the membrane is known eq 6 can be used to relate p i to p e the local curvature κ is the magnitude of the rate of change of the unit tangent vector mathematically the local curvature at a point x z on the membrane can be calculated by 7 κ d α d s where d s is the length of a small segment of the membrane and d α the difference of the angles of unit tangent vector at the two ends of the segment 8 d s d x 2 d z 2 in the polar coordinate system r θ the radial displacement of the membrane from its static location r r i can be described by 9 ζ θ t r r i and the point x z can be expressed in the polar coordinate system as 10 x r i ζ θ cos θ z r i ζ θ sin θ using eq 10 in eq 8 gives 11 d s x θ 2 z θ 2 d θ the angle of a unit tangent vector at the point x z can be obtained by 12 tan α z θ x θ from which we have 13 d α 2 z θ 2 x θ 2 x θ 2 z θ x θ 2 z θ 2 d θ substituting eqs 13 and 11 in eq 7 gives 14 κ 2 z θ 2 x θ 2 x θ 2 z θ x θ 2 z θ 2 3 2 because x θ and z θ can be obtained by taking the first derivative of eq 10 with respect to θ we express the local curvature in terms of the polar coordinates as 15 κ r i ζ r i ζ 2 ζ θ 2 2 ζ θ 2 r i ζ 2 ζ θ 2 3 2 therefore the local curvature can be calculated using eq 15 after the radial displacement of the membrane ζ is obtained 2 3 flow outside the membrane the external flow is governed by the following laplace s equation 16 2 ϕ e 0 where ϕ e is the velocity potential for the external flow we impose the following boundary conditions for the external flow 1 on the water surface z η where η is the surface displacement the dynamic condition is 17 ϕ e t g η 1 2 ϕ e ϕ e 0 where g is the gravitational acceleration any point on the water surface can be described by a position vector x f x f η the kinematic boundary condition is 18 d x f d t ϕ e where d d t is the material derivative 2 at the bottom z h the no flux condition requires 19 ϕ e z 0 3 at any point on the membrane x x m the pressure on the outer side of the membrane surface is calculated by the bernoulli equation 20 ϕ e t p e ρ g z m 1 2 ϕ e ϕ e 0 2 4 flow inside the membrane the internal flow is governed by the following laplace s equation 21 2 ϕ i 0 where ϕ i is the velocity potential for the internal flow we impose the following boundary conditions for the internal flow 1 at the bottom z h the no flux condition on the bottom requires 22 ϕ i z 0 2 the pressure on the inner side of the membrane surface can be determined using the following bernoulli equation 23 ϕ i t p i ρ g z m 1 2 ϕ i ϕ i κ i τ i ρ at any time instant when a fluid particle passes a point it will possess the velocity at that point mathematically it requires that 24 d x d t ϕ i where x x z it is more suitable to track the motion of the membrane in the polar coordinate system the mapping between the cartesian coordinate system and the polar coordinate system is 25 x r cos θ z r sin θ and the mapping between the unit vectors are 26 e r cos θ e x sin θ e z e θ sin θ e x cos θ e z from which we have 27 e x cos θ e r sin θ e θ e z cos θ e θ sin θ e r it then follows that 28 ϕ i cos θ ϕ i x sin θ ϕ i z e r sin θ ϕ i x cos θ ϕ i z e θ the relation between the velocities described in the two coordinate systems is 29 d x d t d r d t e r r d θ d t e θ therefore we have 30 d r d t sin θ ϕ i x cos θ ϕ i z and 31 d θ d t 1 r sin θ ϕ i x cos θ ϕ i z in principle we can use eqs 30 and 31 to determine the location of the membrane using an initial value problem solver however the fluid particle may move out of the computational domain at the two ends of the membrane from one time step to the next as a result interpolation is needed at every time step which will introduce numerical error in the radial displacement especially at the two ends the numerical error of this nature may cause a water particle to cross the membrane especially at the two ends violating the no flux boundary condition which we must impose on the membrane the local pressure balance eq 6 is very sensitive to the local curvature κ which itself is very sensitive to small errors in the radial displacement of the membrane because the second derivative of the membrane radial displacement is needed in the calculation of the curvature see eq 15 in other words the numerical error in the curvature will affect the pressure of the internal flow calculated using eq 6 and may lead to numerical instability therefore when we determine the location of the membrane from the internal flow field we need to impose the no flux condition on the membrane mathematically the surface of the membrane can be expressed by f r ζ θ t r i 0 with r i being the initial radius of the membrane and ζ the radial displacement the non flux condition can be written as 32 d f d t 0 which by chain rule gives 33 ζ t d r d t d θ d t ζ θ 0 after using eqs 30 and 31 we obtain 34 ζ t sin θ ϕ i z cos θ ϕ i x 1 r i ζ sin θ ϕ i x cos θ ϕ i z ζ θ or 35 ζ t sin θ cos θ r i ζ ζ θ ϕ i z cos θ sin θ r i ζ ζ θ ϕ i x physically ζ t is the time rate of change of the local radius of the membrane on which the fluid particle moves when using eq 35 to determine the radial displacement there is no need to perform interpolation at the two ends of the membrane therefore the no flux condition can be satisfied automatically on the membrane at any location and at any time 2 5 acceleration potential to calculate the dynamic pressure in both the external and internal flows the time derivatives of the velocity potentials ϕ e t and ϕ i t are needed these two derivatives are called the acceleration potential which satisfy the following laplace s equations 36 2 ϕ e t 0 2 ϕ i t 0 hereinafter ϕ e t ϕ e t and ϕ i t ϕ i t on the water surface the bernoulli equation holds 37 ϕ e t g η 1 2 ϕ e ϕ e at the bottom the no flux condition gives 38 ϕ e t z 0 ϕ i t z 0 on the membrane the no flux condition requires 39 ϕ e t n ϕ i t n where n means the gradient along the local normal direction the external and internal pressures are determined by the bernoulli equations eqs 20 and 23 from which the force balance eq 6 can be written as 40 ϕ e t ϕ i t τ κ τ i κ i ρ 1 2 ϕ i ϕ i ϕ e ϕ e at the two ends of the tank the no flux condition requires that 41 ϕ e t x 0 3 numerical method in the governing equations and boundary conditions given in section 2 the locations of the moving boundaries the water surface and the membrane together with the internal and external velocity potentials are to be found numerically traditional eulerian methods to solve the problem formulated in section 2 approximate the conditions on the moving boundaries by a taylor expansion about their corresponding undisturbed positions mei 1989 the validity of taylor expansion makes these methods not suitable for highly nonlinear wave problems recently the spectral methods are used to study nonlinear waves in wave flumes ducrozet et al 2012 paprota and sulisz 2018 however the interactions of the nonlinear waves with structures with complex geometries are still a challenge to the spectral method to study the interactions of highly nonlinear waves with flexible membrane the so called mixed eulerian lagrangian method proposed first by longuet higgins and cokelet 1976 is more suitable the method employed in this study is based on the mixed eulerian lagrangian method of longuet higgins and cokelet 1976 which can be used to study highly nonlinear wave problems 3 1 mixed eulerian lagrangian method the mixed eulerian lagrangian method solves the problem formulated in section 2 in two steps cao et al 1991 an eulerian step to solve the boundary value problems bvps and a lagrangian step to solve the initial value problems ivps the implementation of the mixed eulerian lagrangian method used here is slightly different from that employed in cao et al 1991 and liu et al 2009 in the present problem the acceleration potential on the membrane needs to be obtained before implementing the eulerian lagrangian method below is a summary of the implementation of the mixed eulerian lagrangian method for the present problem 1 the external and internal velocity potentials ϕ e n ϕ i n at t t n are given in the flow fields and on all boundaries at t t n the water surface is located at x f x f n the subscript f means free surface and the membrane is located at r r i ζ n at any specified angle θ 2 solve the bvps for the external and internal acceleration potentials ϕ e t n ϕ i t n simultaneously at t t n using an appropriate bvp solver the governing equations are 42 2 ϕ e t n 0 and 2 ϕ i t n 0 the boundary conditions and the matching conditions on the membrane are the following a on the water surface x f x f n the acceleration potential is known 43 ϕ e t n α n where 44 α n g η n ϕ e n ϕ e n 2 b on the membrane r r i ζ n the accelerations on the two side are the same 45 ϕ e t n n ϕ i t n n c on the membrane r r i ζ n the difference of the acceleration potentials on the two side of the membrane is known 46 ϕ e t n ϕ i t n β n where 47 β n τ n κ n τ i κ i ρ ϕ i n ϕ i n ϕ e n ϕ e n 2 d the following no flux conditions are imposed on the bottom 48 ϕ e t n z 0 and ϕ i t n z 0 e the following no flux condition is imposed on the lateral boundaries 49 ϕ e t n x 0 3 solve the ivps for the displacement of the water surface η n 1 the velocity potential on the water surface ϕ e n 1 the displacement of the membrane ζ n 1 in a given direction θ and the velocity potential on the inner surface of the membrane ϕ i n 1 in a given direction θ the fourth order runge kutta method is adopted here for the ivps with the initial conditions at t t n are given by ϕ e t n ϕ e n x f t n x f n ζ t n ζ n and ϕ i t n ϕ i n the equation to determine ϕ e n 1 is 50 ϕ e n 1 ϕ e n t s 1 4 κ s k s t n φ n where φ n ϕ e n ϕ i n ϕ e t n ϕ i t n ζ n and the equation to determine x f n 1 is 51 x f n 1 x f n t s 1 4 κ s λ s t n φ n the equation to determine ϕ i n 1 on the inner surface of the membrane is 52 ϕ i n 1 ϕ i n t s 1 4 κ s γ s t n φ n and the equation to determine the radial displacement of the membrane ζ n 1 is 53 ζ n 1 ζ n δ t s 1 4 κ s ξ s t n φ n in these equations the weights are κ 1 κ 4 1 6 and κ 2 κ 3 1 3 and the expressions for the slopes i e k s t n φ n λ s t n φ n γ s t n φ n and ξ s t n φ n are given in the appendix 4 solve the bvp for the internal velocity potentials at t t n 1 using an appropriate bvp solver the governing equation for ϕ i n 1 is 54 2 ϕ i n 1 0 and the boundary conditions are a at the bottom the following no flux condition is imposed 55 ϕ i n 1 z 0 b on the membrane two types of boundary conditions are used together with eq 54 and eq 55 in a predictor corrector manner to solve for ϕ i n 1 at the predictor step the internal problem is solved using eq 54 eq 55 and the boundary value of ϕ i n 1 on the membrane given by eq 52 the solution at this step is denoted by ϕ ˆ i n 1 at the corrector step the internal problem is solved again using eq 54 eq 55 and the following no flux condition 56 ϕ i n 1 n v r n 1 e r n where v r n 1 is determined by eq 35 57 v r n 1 ζ t n 1 sin θ cos θ r i ζ n 1 ζ n 1 θ ϕ ˆ i n 1 z cos θ sin θ r i ζ n 1 ζ n 1 θ ϕ ˆ i n 1 x the solution of ϕ i n 1 at the corrector step will be used on the right hand side of eq 60 to solve for ϕ e n 1 5 solve the bvp for the external velocity potentials at t t n 1 using an appropriate bvp solver the governing equation for ϕ e n 1 is 58 2 ϕ e n 1 0 and the boundary conditions and matching condition on the membrane are a the no flux condition is imposed on the lateral boundaries 59 ϕ e n 1 x 0 b on the water surface x f x f n 1 the velocity potential ϕ e n 1 is given c on the membrane r r i ζ n 1 the normal velocity on the outer surface is equal to that on the inner surface 60 ϕ e n 1 n ϕ i n 1 n 3 2 desingularized boundary integral equation method for bvps in this study the boundary value problems are solved using a desingularized boundary integral equation method dbiem which construct the solutions using rankine sources placed on an imaginary boundary ω that is adjacent to the physical boundary ω see cao et al 1991 and liu et al 2009 the small distance between the imaginary boundary ω and the physical boundary ω can be spatially variable in this study the rankine sources specified by the following green function are used 61 g x x s ln x x s ln x 2 h k x s where h is the water depth k the unit vector in the vertical direction x s the position of the rankine source the second term in eq 61 is the image of the first term about the horizontal bottom which makes the green function so defined satisfy the no flux condition at the bottom as a result we only need to place rankine sources on the free surface the inner and outer surfaces of the membrane and the two ends of the numerical tank the internal and external velocity potentials can be expressed as 62 ϕ i n 1 j 1 n i α j n 1 g x x j and ϕ e n 1 k 1 n e β k n 1 g x x k where α j n 1 and β k n 1 are the corresponding strengths of the rankine sources the internal and external acceleration potentials can be expressed as 63 ϕ i t n j 1 n i σ j n g x x j and ϕ e t n k 1 n e γ k n g x x k where σ j n and γ k n are the corresponding strengths of the rankine sources 3 3 techniques to improve numerical stability because the first and second order derivatives of the membrane displacement ζ with respect to the angular coordinate θ are needed in the calculation of the local curvature κ see eq 15 and the calculation of the radial velocity of the membrane see eq 35 or eq 57 the accumulation of the numerical error introduced by using finite difference schemes to calculate the derivatives may lead to numerical instability our numerical experiments show that using fourier series to express the membrane displacement and performing differentiation analytically can greatly improve the numerical stability the membrane displacement ζ θ can be expressed in a fourier series as 64 ζ θ k 1 n o a k sin k π θ θ 0 θ 1 θ 0 where θ 1 and θ 0 are the values of θ at the left and right ends of the membrane respectively and n o is the number of the modes to be included in the fourier series the coefficients a k in the finite fourier series must be chosen such that the conservation of the fluid mass contained in the membrane is satisfied for in compressible fluids the conservation of mass requires that at any time 65 1 2 θ 0 θ 1 r i 2 d θ 1 2 θ 0 θ 1 r i ζ θ 2 d θ which gives 66 θ 0 θ 1 ζ θ d θ 1 2 r i θ 0 θ 1 ζ 2 θ d θ under the assumption that ζ θ r i the conservation of mass can be approximated by the following equation 67 θ 0 θ 1 ζ θ d θ 0 our numerical results showed that eq 66 and eq 67 give nearly identical results for the conditions examined in this study using eq 64 in eq 67 gives 68 k 1 n o a k 1 cos k π k 0 therefore a 1 can be expressed by a k k 2 n 0 69 a 1 k 2 n o a k cos k π 1 2 k to determine the coefficients a k k 2 n o we minimize the following error function 70 e ζ m 0 m ζ θ m k 1 n o a k sin k π θ m θ 0 θ 1 θ 0 2 0 where ζ θ m is the membrane displacement given by eq 53 on a polar grid θ m θ 0 m 1 δ θ with δ θ being the grid size and m 1 2 m the least square method is used to determine the coefficients a k k 2 n o by requiring 71 e ζ a k 0 k 2 3 n o after a k k 2 3 n o are found the coefficient a 1 can be determined by eq 69 finally the first and the second derivatives of ζ θ with respect to θ which are needed to calculate the local curvature can be calculated analytically from eq 64 before using the no flux condition eq 56 at the corrector step to solve for ϕ i n 1 numerical errors need to be removed from the values of v r n 1 obtained from eq 57 so that the conservation of mass can be satisfied for this purpose we express v r n 1 in the following fourier series as we did for the membrane displacement ζ θ 72 v r n 1 k 1 n o v k sin k π θ θ 0 θ 1 θ 0 the first order approximation to the conservation of mass requires 73 θ 0 θ 1 v r n 1 θ d θ 0 which gives 74 k 1 n o v k 1 cos k π k 0 the coefficient v 1 can be expressed in terms of v k k 2 3 n o 75 v 1 k 2 n o v k cos k π 1 2 k to determine the coefficients v k k 2 3 n o the following error function is defined 76 e v m 0 m v r n 1 θ m k 1 n o v k sin k π θ m θ 0 θ 1 θ 0 2 0 where v r n 1 θ m is the radial velocity of the membrane given by eq 57 on a polar grid θ m θ 0 m 1 δ θ with δ θ being the grid size and m 1 2 m the least square method is used to determine the coefficients v k k 2 n o by requiring 77 e v a k 0 k 2 3 n o after the coefficients v k have been obtained the radial velocity v r n 1 calculated by eq 72 can be used on the right hand side of eq 56 to solve for ϕ i n 1 4 results and discussion 4 1 model verification and validation the theory and the code are validated and verified by comparing with the experimental results of ohyama et al 1989 and the linear analysis results of phadke and cheung 2001 the following parameters are used for producing the numerical results in section 4 1 the elastic modulus 58000k n m 2 the thickness of the membrane 1 65 mm the water depth h 0 8 m the wave amplitude a w 0 025 h the height of the membrane h m 0 56 h and the width of the membrane b 2 0 h these parameters were used in ohyama et al 1989 and phadke and cheung 2001 who examined three values of the dimensionless initial excess pressure p i ρ g h 0 065 0 116 0 208 in the numerical simulation a truncated fourier series of n o terms is used to express the membrane displacement for numerical stability consideration theoretically including more terms in the truncated fourier series should give more accurate simulation results however the computational cost and the accumulation of round off errors increase with increasing n o as a result there is an optimum value for n o which balances the accuracy and computational cost the surface displacements recorded by the wave gauge g i i 1 2 3 4 whose positions are shown in fig 1 are used to analyze transmission coefficients the time history of the surface displacement can be expressed as 78 η t x i n 1 n a n x i cos n ω t ψ n x i where x i is the location of the wave gauge g i ω is the angular frequency of the fundamental waves a n x i and ψ n x i are the amplitude and the phase angle of the nth harmonic waves respectively based on the first harmonic components recorded by g 1 and g 2 the amplitudes of the reflected waves and incident waves a i and a r can be calculated by performing a wave separation analysis using the two point method of goda and suzuki 1976 on the lee side of the membrane the higher harmonic waves contain both free waves and phase locked waves the free and locked waves can be separated by the method given by grue 1992 the transmission coefficients for the fundamental waves and the higher harmonic free and locked waves are defined respectively by 79 c t a t a i t n f a n f a i and t n l a n l a i where a t is the amplitude of the fundamental transmitted waves and a n f and a n l are the amplitudes of the nth order free and locked waves respectively the transmission coefficient for the fundamental waves c t is referred to the transmission coefficient hereinafter for simplicity the transmission coefficient as a function of b l w for the case of n o 5 n o 13 and n o 18 are shown in fig 2 where b is the width of the membrane structure a w and l w are the amplitude and the length of the incident waves respectively it can be seen that there exists a critical value of b l w at which the minimum transmission coefficient occurs this critical value is denoted by b l w c hereinafter a shift of b l w c with the increase of n o can be observed however the transmission coefficients obtained for different values of n o are almost the same when n o is large enough say n o 13 or n o 18 implying that the simulation accuracy can be guaranteed with n o 18 the coefficients a k of the fourier series of r θ for n o 18 are given in fig 3 as expected the magnitude of a k in eq 64 becomes very small as k approaches n o the influence of the terms with k 18 in eq 64 on the membrane displacement can be safely ignored we remark that the optimal value of n o is affected mainly by the geometry of the membrane the optimal value n o 18 can be adopted only if the geometry of the membrane is similar to the one studied here ohyama et al 1989 defined the transmission coefficient as the ratio of the root mean square height of the transmitted waves to the height of the incident waves i e 80 c t 1 n i 1 n h i t 2 h i where h i is the height of the incident waves in the absence of the structure and h i t is the height of the ith transmitted waves in a time series of the measured surface displacement table 1 lists the two transmission coefficients obtained by eqs 79 and 80 and the reflection coefficients c r a r a i obtained by a two point wave separation analysis for fundamental waves for a w h 0 025 and p i ρ g h 0 208 it is seen that maximum relative error of two transmission coefficients is less than 2 for all the conditions examined we also used the conservation of wave energy to check the numerical accuracy for infinitesimal monochromatic waves the conservation of wave energy flux requires 81 c r 2 c t 2 1 for finite amplitude waves the existence of weak higher harmonic wave components makes c r 2 c t 2 slightly less than unity from table 1 it can be seen that the maximum value of 1 c r 2 c t 2 is less than 6 the value of this error in the linear analysis of phadke and cheung 2001 is about 3 we remark that the reflection and transmission coefficients c r and c t are defined for the first harmonic waves and equation c r 2 c t 2 1 is derived under the assumption that the energy flux contained in higher harmonic wave components can be ignored when waves are nonlinear waves and energy flux contained in higher harmonic wave components cannot be ignored 1 c r 2 c t 2 is theoretically equal to n 1 n t n f 2 t n l 2 where t n f and t n l are contributions from the energy contained in the higher harmonic free and lock waves therefore a smaller value of 1 c r 2 c t 2 obtained by a linear analysis does not mean the linear analysis is more accurate than the nonlinear analysis if waves are nonlinear waves the purpose that we compare our results with that of phadke and cheung 2001 for linear waves is to show that our non linear analysis is accurate as the linear analysis for linear waves the simulated transmission coefficients for a range of values of b l w is shown in fig 4 where the transmission coefficients measured by ohyama et al 1989 are also included for comparison it can be seen that the numerical simulation captures well the trend of the measured transmission coefficients in particular both the experiment and the simulation show that the transmission coefficient takes a minimum value at certain wave frequencies which are referred to resonant frequencies by phadke and cheung 2003 the resonant frequencies can be captured well by the simulation indicating that viscous effects do not play an important role in the determination of the resonant frequency there are still certain discrepancy in the minimum value of the transmission coefficient at the resonance this discrepancy is attributed mainly to three dimensional effects in the experiment and experimental errors phadke and cheung 2003 we remark that the same degree of under prediction in the transmission coefficient also exists in other numerical studies see for example phadke and cheung 2001 2003 4 2 response of the membrane and its effects on wave transmission the response of the membrane can be evaluated by the radial deformation ζ θ t which is expressed as the following fourier series 82 ζ θ t k 1 n o a k t sin k π δ θ θ θ 0 the simulation can output the time series of a k t which can be also expanded as the following fourier series with its coefficients to be determined by fitting to the data 83 a k t n 1 n a k n cos n ω t ψ n here a k n and ψ n are the amplitude and the phase angle of the nth harmonic membrane response respectively table 2 gives the values of a k n r i for weak incident waves it is stressed there the subscript n means the n th temporal harmonic oscillation of the membrane and the subscript k means the k th spatial modal shape of the membrane it can be seen that for any modal shape any given k the first harmonic amplitude n 1 is always stronger than those of higher harmonics n 1 this is also true for the other cases where waves are weakly nonlinear waves therefore only the first harmonic response of the membrane is discussed for weakly non linear waves of a w h 0 025 in this section nonlinear waves will be discussed in the next section fig 5 shows the values of a k 1 r i k 1 2 3 4 versus b l w the values of a k 1 for k 4 are not shown because their values are very small it can be seen that a 2 1 and a 3 1 are dominant in the case of p i ρ g h 0 208 the value of b l w at which the maximum a 2 1 occurs is very close to the one at which the minimum transmission coefficient occurs in the case of p i ρ g h 0 116 there are two values of b l w at which the transmission coefficient reaches a local minimum one corresponds to the maximum a 2 1 and the other corresponds to the maximum a 3 1 in the case of p i ρ g h 0 065 the value of b l w at which the minimum transmission coefficient occurs corresponds to the maximum a 3 1 the phenomenon that the minimum transmission coefficient occurs at the resonant response of the membrane may be explained by the destructive interference between the transmitted waves and radiated waves when the membrane has a resonant response to the incoming waves to confirm this point the wave interaction with a bottom mounted rigid breakwater of the same dimensions i e the membrane elastic modulus approaches the infinity was simulated the snapshots of the surface elevations for this rigid breakwater and the flexible fluid filled membrane at the resonant frequency are shown in fig 6 a much stronger wave transmission can be observed for the case of the rigid breakwater but the transmitted waves are hardly observable for the case of the flexible fluid filled membrane breakwater therefore it is the radiated waves generated by the membrane resonant response that weakens the waves on the lee side for the case shown in fig 6 b the radial displacements of the membrane as a function of θ at four instants are shown in fig 7 hereinafter the dimensionless time t which is normalized by the period of incident waves is use to present time series it can be seen that the mode of the membrane deformation is affected by the dimensionless initial excess pressure p i ρ g h in the case of a higher initial excess pressure p i ρ g h 0 208 only the first mode of membrane deformation is observed in the case of a lower initial excess pressure p i ρ g h 0 065 only the second mode of membrane deformation is observed for a moderate pressure p i ρ g h 0 116 both the first and second modes of the membrane deformation are observed this phenomenon can be explained by the effective stiffness of the fluid filled membrane system a higher initial excess pressure can induce a higher tension in the membrane which can result in a higher effective stiffness therefore the natural frequency of the system with a higher initial excess pressure is higher than that with a lower initial excess pressure for the same mode vibration for the same excitation frequency the resonant mode of the system with a higher initial excess pressure is lower than that with a lower initial excess pressure the maximum radial displacements of the membrane at resonance ζ m a x r i are listed in table 3 which shows that the assumption of ζ r i can be satisfied the initial tension in the membrane τ i which can be calculated by the eq 2 is used to normalize the tension in the membrane τ m under the action of waves examples of time series of τ m τ i are shown in fig 8 for different values of n o it can be seen that n o the number of terms in the fourier series affects the simulated phase of τ m until n o is large enough as n o 16 further increasing n o has little effect on the simulated phase of τ m therefore it is reasonable to choose n o 18 the average of τ m over a wave period shows that the mean tension in the membrane τ m is larger than the initial tension τ i ohyama et al 1989 also observed that the excess pressure increased under the action of waves however ohyama et al 1989 did not give any explanation the increase of the mean tension in the membrane under the action of waves explains the phenomenon observed by ohyama et al 1989 the following is an explanation why the mean tension in the membrane is larger than the initial tension according to eq 5 the increase of the instantaneous tension relative to the initial tension is determined by the increase of the instantaneous membrane length relative to the initial length of the membrane δ l m l t l i ignoring the higher order effects on ζ r i δ l m is expressed as 84 l m θ 0 θ 1 ζ d θ 1 2 θ 0 θ 1 ζ θ 2 r i ζ d θ substituting eq 66 into eq 84 and ignoring the higher order of ς r i we have 85 l m 1 2 θ 0 θ 1 ζ 2 r i d θ 1 2 θ 0 θ 1 ζ θ 2 r i ζ d θ substituting eq 64 into eq 85 and considering l i r i δ θ gives 86 l m l i 1 4 π δ θ 2 k 1 n o a k r i 2 k 2 δ θ π 2 it can be seen from eq 86 that δ l m is always positive therefore the instantaneous tension is always larger than the initial tension it can also be noticed that δ l m increases with the amplitude of the membrane response table 4 gives the mean tension in the membrane for four wave amplitudes as wave amplitude increases the amplitude of the membrane response also increases therefore a larger mean tension in the membrane is expected for larger waves the effective stiffness of the fluid filled membrane system stiffness increases with the mean tension which can result in a shift of the resonant frequency the shift of resonant frequency under larger waves was also observed in the simulation of phadke and cheung 2003 the presented simulation has also confirmed this phenomenon the dynamic pressure is the pressure induced by waves which can be obtained by subtracting the static pressure from the total pressure the dynamic external and internal pressure distributions along the membrane p e and p i are shown in fig 9 it can be seen that the dynamic pressure on the membrane both the external pressure and the internal pressure are not uniform the maximum of the dynamic internal pressure is much larger than that of the dynamic external pressure at resonance see in fig 9 a away from the resonant response the maximum values of the dynamic internal and external pressure are similar see fig 9 b therefore the internal pressure inside the membrane cannot be treated as a constant in the simulation as did in broderick and leonard 1995 4 3 locked and free waves as wave amplitude increases higher harmonic waves will be generated by 1 the wave wave interactions in the water above the membrane and 2 the nonlinear membrane response the higher harmonic waves generated by wave wave interactions in the water above the membrane are phase locked waves before they leave the membrane when they enter the deeper water on the lee side of the membrane these higher harmonic waves become free waves therefore the higher harmonic free and locked waves co exist on the lee side of the membrane and the method given by grue 1992 can be used to separate the free and locked waves the transmission coefficients defined in eq 79 for the fundamental waves the second harmonic free and locked waves for four incident wave amplitudes are shown in fig 10 for longer waves i e the wave frequency is less than the resonant frequency the second harmonic free waves become stronger as the incident wave amplitude increases generally the locked waves are much weaker than the free waves however a sudden increase of the amplitude of the locked waves occurs in a narrow frequency band a stronger second harmonic response of the membrane can also be observed in this narrow frequency band the reason for this however is not clear for shorter waves i e the wave frequency is higher than the resonant frequency the second harmonic free waves become much weaker and only the locked waves can be observed the amplitude of the locked waves increases with the ratio of the amplitude to the wave length of the fundamental waves which agrees with the stokes wave theory when the wave frequency equals to the resonant frequency the transmission coefficients for the fundamental waves second harmonic free and locked waves approach zero for all four cases which means that transmitted fundamental and higher harmonic waves can be suppressed by the destructive interference no matter what the wave height is as a closing remark viscous effects are not important in this problem viscous effects comes from wave boundary layer and vortex shedding both effects on wave scattering are not important in this problem the relative importance of the vortex shedding from the membrane the k c number can be defined by 2 π a w b where a w is the amplitude and b is the width of the membrane in this study k c 0 2 which means that the effect of the vortex shedding does not occur mei 1989 and the energy loss is mainly due to the viscous energy dissipation associated with the wave boundary layer which is usually of a thickness on the order of millimeters the energy dissipated within the wave boundary layer is always small compared to the energy contained in incident reflected or transmitted waves even though the energy dissipated by the wave boundary layer is small theoretically the real transmission coefficient is expected to be slightly less than that predicted by the potential theory the effect of viscous energy dissipation is even smaller as the wave frequency approaches the resonant frequency when resonant response occurs the destructive interference between the transmitted waves and radiated waves become the most important factor to reduce the transmission coefficient 5 conclusions in this study a mixed eulerian lagrangian method based on potential flow theory was used to simulate the fully nonlinear interaction between coastal waves and a fluid filled membrane breakwater the response of the membrane and the nonlinear wave scattering were simulated the numerical results were compared with the experiments of ohyama et al 1989 the following conclusions can be drawn from this study 1 the numerical stability can be implemented by expressing the radial displacement of the membrane as a fourier series and ensuring that the no flux condition on the membrane is satisfied at any location for every time step 2 when the number of terms in the fourier series is large enough n o 16 the presented simulation can give the results in agreement with the experimental results of ohyama et al 1989 3 the destructive interference of the transmission waves and radiation waves by the membrane resonant response can reduce the transmission coefficient greatly at resonance the transmission coefficients of the fundamental waves second harmonic free and locked waves approach zero 4 the wave interaction with the membrane can increase the mean tension in the membrane the increase of the mean tension becomes larger as the wave amplitude increases resulting in a shift of the resonant frequency with wave amplitude acknowledgement the first author c r l would like to thank the xiamen science and technology bureau china 3502z20173036 for its financial support to his visit to uh manoa in 2018 for this work the corresponding author z h h acknowledges the support by the national science foundation under grant no 1706938 any opinions findings and conclusions or recommendations expressed in this material are those of the author s and do not necessarily reflect the views of the national science foundation this is soest contribution no 10666 appendix a unimportance of the membrane inertia force and some expressions used in the runge kutta method appendix a 1 unimportance of the membrane inertia force according to newton s second law the motion equation of a small element of membrane can be written as a 1 ρ m d d v m d t d s p i p e n d s f τ where ρ m is the density of the membrane d is the thickness of the membrane d s is the area of a small membrane element v m is the velocity of the membrane element p i and p e are the internal and external dynamic pressure on the membrane element respectively n is the unit vector normal to the membrane element and f τ is the force caused by the tension in the membrane element the order of magnitude of the inertia force can be estimated as a 2 o ρ m d d v m d t d s o ρ m d a t 2 d s where a and t are the amplitude and period of the incident waves respectively the order of magnitude of the force related to the dynamic pressure on the membrane element can be estimated as a 3 o p i p e d s o ρ g a d s where ρ is the density of the water according to eqs a 2 and a 3 the ratio of the dynamic pressure force to the inertia force can be estimated as a 4 p i p e d s ρ m d d v m d t d s o ρ ρ m g t 2 d for the present problem wave periods are in the range of 0 5 s and 2 0 s and the thickness of the membrane is 1 65 mm therefore the inertia force is much smaller than the force related to the dynamic pressure and thus can be safely ignored appendix a 2 some expressions used in the runge kutta method the expressions for the slopes used in the implementation of runge kutta method are k s t n φ n ϕ e t n s λ s t n φ n ϕ e n s γ s t n φ n ϕ i t n s ξ s t n φ n sin θ cos θ r i ζ n s ζ n s θ ϕ i n s z cos θ sin θ r i ζ n s ζ n s θ ϕ i n s z where φ n s φ ϕ e ϕ i ϕ e t ϕ i t ζ is the value of φ at step n s for s 1 the step n s is the time step n for s 2 3 4 the step n s is the predictor step the value of φ at step n s 1 can be calculated based on its value at n s 
22912,this paper introduces a time domain potential flow method for simulating fully nonlinear wave interaction with a fluid filled membrane mounted on the seabed the numerical method is based on a mixed eulerian lagrangian method which tracks the free water surface and the membrane using a lagrangian method and solves the flow fields inside and outside the membrane using an eulerian method to remove the numerical instability a method that satisfies the no flux condition on the membrane at any location and any time was developed to calculate the radial displacement of the membrane at every time step and a fourier series expression for the radial displacement of the membrane was used to calculate the local curvature of the membrane accurately experimental results from an existing experimental study were used for model validation and verification the response of the membrane and the nonlinear wave scattering were simulated the simulation results show that the transmission coefficients of the fundamental waves second harmonic free and locked waves approach zero when a resonant response of the membrane to waves occurs sample results of the simulated tension in the membrane and interior pressure are also included in the discussion keywords fluid filled membrane fluid structure interaction nonlinear waves mixed eulerian lagrangian method breakwater coastal structures 1 introduction fluid filled membrane structures can be used as temporary removable breakwaters which have the advantages such as lower costs easy deployment and non intrusion ohyama et al 1989 unlike traditional breakwaters fluid filled membrane structures may have large deformation under the action of incoming waves which can be used to control wave transmission through destructive interference between the radiated waves and the scattered waves existing studies on the wave interaction with membrane structures focused mainly on linear and two dimensional problems ohyama et al 1989 modeled a submerged bottom mounted fluid filled membrane as a lumped mass system and used linear potential theory to study the transmission and reflection of regular waves zhao 1995 and zhao and aarsnes 1998 theoretically studied the dynamic response of a floating liquid filled membrane structure by a small perturbation to the static solution lo 2000 used an eigen function expansion method to study the linear interaction of water waves with a vertical suspended flexible membrane and found that the wave generated by the membrane motion could cancel the wave transmitted through the gap between the lower end of the membrane and the bottom using a boundary element method bem coupled with finite element method fem phadke and cheung 1999 2001 studied the response of a fluid filled membrane to linear gravity waves assuming linear waves and small amplitude membrane response suresh et al 2007 studied the wave scattering by a vertical flexible porous membrane barrier in a two layer fluid using an eigen function expansion method karmakar and sahoo 2008 studied the wave scattering by a floating horizontal membrane using an eigen function expansion method and calculated the reflection and transmission coefficients by the energy flux conservation and the green s second identity karmakar et al 2012 studied the linear wave scattering by multiple surface piercing floating membranes using an eigen function expansion method with a wide spacing approximation only a few studies of the three dimensional responses of flexible membrane structures to ocean waves can be found in the literature cho and kim 1998 employed an eigen function expansion method to investigate the interaction of oblique monochromatic waves with a horizontal flexible membrane in the context of linear hydro elastic theory assuming linear waves and small membrane deflection das and cheung 2009 used a boundary element method coupled with a finite element model to study the three dimensional response of a bottom mounted fluid filled membrane in a wave flume setting koley and sahoo 2017 used linear water waves theory to study the three dimensional wave scattering by a permeable vertical flexible membrane and found that zero transmission could occur under certain conditions all aforementioned studies have assumed linear water waves strictly speaking linear wave assumption is valid only for small amplitude waves as the wave amplitude increases the membrane deformation increases and higher harmonic waves become apparent which will in turn affect the deformation of the membrane therefore for nonlinear waves the geometric nonlinearity due to the large deformation of the membrane and the generation of higher harmonics must be considered assuming linear waves phadke and cheung 2003 considered the geometric nonlinearity and derived the governing integral equation for finite membrane deformation based on the principle of virtual work a linear boundary element method was used to solve the potential flows inside and outside the membrane and a nonlinear finite element model was used to solve the motion of the membrane in the time domain phadke and cheung 2003 revealed that the geometric nonlinearity could affect the resonant frequency at which a minimum transmission occurs broderick and leonard 1995 presented a method to simulate the interaction of the nonlinear waves with the fluid filled membrane by using bem coupled with fem but they assumed that the internal fluid contained by the membrane could be modeled as a lumped mass and that the internal pressure could be treated as a constant the validity of these assumptions however is questionable we are not aware of the existence of time domain potential flow solvers developed for simulating fully nonlinear wave interaction with fluid filled membrane structures coastal waves are better described by nonlinear waves for engineering designs of this type of breakwaters it is necessary to have the ability to simulate the nonlinear wave interaction with fluid filled membrane structures this study presents a time domain potential flow solver developed specifically for fully nonlinear waves interacting with a fluid filled membrane mounted on the seabed the solver is based on a lagrangian eulerian formulation which tracks the free water surface and the membrane using a lagrangian method and solves the flow fields inside and outside the membrane using an eulerian method the mathematical formulation is presented in section 2 which is followed by a detailed description of the numerical method in section 3 model validation and key results are presented in section 4 where effects of wave frequency and wave height on the wave transmission and the response of the membrane higher harmonic free and locked waves on the lee side of the membrane structure higher harmonic responses of the membrane and the tension force in the membrane are discussed main conclusions are drawn in section 5 2 mathematical formulation the breakwater under consideration is a bottom mounted membrane filled with water as shown in fig 1 where the water enclosed by the membrane is the same as the surrounding water the virtual wave gauges g 1 through g 4 shown in the figure are for wave separation analysis 2 1 coordinate systems at its static equilibrium state the shape of the membrane is a segment of a circle whose center and radius are denoted by o and r i respectively to describe the motion of the membrane two coordinate systems are defined one is a cartesian coordinate system x z and the other is a polar coordinate system r θ these two coordinate systems share the same origin which is at the center of the circle x axis is on a horizontal plane pointing in the direction of wave propagation and z axis points upward for the polar coordinate system θ is the angle between x and r so that 1 x r cos θ and z r sin θ a global cartesian coordinate system x z is also defined with the horizontal axis x being on the still water surface and the vertical axis z pointing upward and on the surface of the symmetry of the membrane 2 2 description of the membrane and its displacement after the membrane is filled with water there will be a pressure difference on the two sides of the membrane in the absence of waves the pressure at any location x e z e outside the membrane is the hydro static pressure ρ g z e and the pressure at any location x i z i inside the membrane is ρ g z i p where p is the so called excess pressure at any point on the membrane the difference in the pressures on the two sides of the membrane is denoted by p in the absence of waves the shape of the membrane is an arch with a radius r i and the excess pressure p is balanced by the initial tension τ i so that 2 τ i p r i the initial length of the membrane l i can be obtained by l i r i δ θ where δ θ is the difference of the values of θ at the two ends of the membrane for later use we denote the radius and the length of the arc when p 0 by r 0 and l 0 respectively the initial tension corresponding to the excess pressure p can be related to the material property by 3 τ i e d l i l 0 l 0 where e is the membrane elastic modulus and d the thickness of the membrane under the action of water waves the membrane will deform and the instantaneous shape of the deformed membrane is better described in the polar coordinate system by r i ζ t θ the length of the membrane will also change with the deformation of the membrane the instantaneous length of the membrane l t will always be longer than l i and l 0 resulting in an increase in the tension the instantaneous tension τ t is determined by the instantaneous length of the membrane l t 4 τ t e d l t l 0 l 0 which can be re written as 5 τ t τ i e d l t l i l i l i l 0 we consider a thin membrane whose mass is very small compared to the mass of the fluid enclosed by the membrane so that the inertial force of the membrane can be ignored see appendix a for a discussion in this case the instantaneous tension can be caused by the difference of the pressures on the two sides of the membrane i e 6 p i p e τ t κ on the membrane where p i and p e are the local pressures on the inner and outer sides of the membrane respectively and κ is the local curvature of the membrane because the local curvature κ and the tension τ can be determined when the shape of the membrane is known eq 6 can be used to relate p i to p e the local curvature κ is the magnitude of the rate of change of the unit tangent vector mathematically the local curvature at a point x z on the membrane can be calculated by 7 κ d α d s where d s is the length of a small segment of the membrane and d α the difference of the angles of unit tangent vector at the two ends of the segment 8 d s d x 2 d z 2 in the polar coordinate system r θ the radial displacement of the membrane from its static location r r i can be described by 9 ζ θ t r r i and the point x z can be expressed in the polar coordinate system as 10 x r i ζ θ cos θ z r i ζ θ sin θ using eq 10 in eq 8 gives 11 d s x θ 2 z θ 2 d θ the angle of a unit tangent vector at the point x z can be obtained by 12 tan α z θ x θ from which we have 13 d α 2 z θ 2 x θ 2 x θ 2 z θ x θ 2 z θ 2 d θ substituting eqs 13 and 11 in eq 7 gives 14 κ 2 z θ 2 x θ 2 x θ 2 z θ x θ 2 z θ 2 3 2 because x θ and z θ can be obtained by taking the first derivative of eq 10 with respect to θ we express the local curvature in terms of the polar coordinates as 15 κ r i ζ r i ζ 2 ζ θ 2 2 ζ θ 2 r i ζ 2 ζ θ 2 3 2 therefore the local curvature can be calculated using eq 15 after the radial displacement of the membrane ζ is obtained 2 3 flow outside the membrane the external flow is governed by the following laplace s equation 16 2 ϕ e 0 where ϕ e is the velocity potential for the external flow we impose the following boundary conditions for the external flow 1 on the water surface z η where η is the surface displacement the dynamic condition is 17 ϕ e t g η 1 2 ϕ e ϕ e 0 where g is the gravitational acceleration any point on the water surface can be described by a position vector x f x f η the kinematic boundary condition is 18 d x f d t ϕ e where d d t is the material derivative 2 at the bottom z h the no flux condition requires 19 ϕ e z 0 3 at any point on the membrane x x m the pressure on the outer side of the membrane surface is calculated by the bernoulli equation 20 ϕ e t p e ρ g z m 1 2 ϕ e ϕ e 0 2 4 flow inside the membrane the internal flow is governed by the following laplace s equation 21 2 ϕ i 0 where ϕ i is the velocity potential for the internal flow we impose the following boundary conditions for the internal flow 1 at the bottom z h the no flux condition on the bottom requires 22 ϕ i z 0 2 the pressure on the inner side of the membrane surface can be determined using the following bernoulli equation 23 ϕ i t p i ρ g z m 1 2 ϕ i ϕ i κ i τ i ρ at any time instant when a fluid particle passes a point it will possess the velocity at that point mathematically it requires that 24 d x d t ϕ i where x x z it is more suitable to track the motion of the membrane in the polar coordinate system the mapping between the cartesian coordinate system and the polar coordinate system is 25 x r cos θ z r sin θ and the mapping between the unit vectors are 26 e r cos θ e x sin θ e z e θ sin θ e x cos θ e z from which we have 27 e x cos θ e r sin θ e θ e z cos θ e θ sin θ e r it then follows that 28 ϕ i cos θ ϕ i x sin θ ϕ i z e r sin θ ϕ i x cos θ ϕ i z e θ the relation between the velocities described in the two coordinate systems is 29 d x d t d r d t e r r d θ d t e θ therefore we have 30 d r d t sin θ ϕ i x cos θ ϕ i z and 31 d θ d t 1 r sin θ ϕ i x cos θ ϕ i z in principle we can use eqs 30 and 31 to determine the location of the membrane using an initial value problem solver however the fluid particle may move out of the computational domain at the two ends of the membrane from one time step to the next as a result interpolation is needed at every time step which will introduce numerical error in the radial displacement especially at the two ends the numerical error of this nature may cause a water particle to cross the membrane especially at the two ends violating the no flux boundary condition which we must impose on the membrane the local pressure balance eq 6 is very sensitive to the local curvature κ which itself is very sensitive to small errors in the radial displacement of the membrane because the second derivative of the membrane radial displacement is needed in the calculation of the curvature see eq 15 in other words the numerical error in the curvature will affect the pressure of the internal flow calculated using eq 6 and may lead to numerical instability therefore when we determine the location of the membrane from the internal flow field we need to impose the no flux condition on the membrane mathematically the surface of the membrane can be expressed by f r ζ θ t r i 0 with r i being the initial radius of the membrane and ζ the radial displacement the non flux condition can be written as 32 d f d t 0 which by chain rule gives 33 ζ t d r d t d θ d t ζ θ 0 after using eqs 30 and 31 we obtain 34 ζ t sin θ ϕ i z cos θ ϕ i x 1 r i ζ sin θ ϕ i x cos θ ϕ i z ζ θ or 35 ζ t sin θ cos θ r i ζ ζ θ ϕ i z cos θ sin θ r i ζ ζ θ ϕ i x physically ζ t is the time rate of change of the local radius of the membrane on which the fluid particle moves when using eq 35 to determine the radial displacement there is no need to perform interpolation at the two ends of the membrane therefore the no flux condition can be satisfied automatically on the membrane at any location and at any time 2 5 acceleration potential to calculate the dynamic pressure in both the external and internal flows the time derivatives of the velocity potentials ϕ e t and ϕ i t are needed these two derivatives are called the acceleration potential which satisfy the following laplace s equations 36 2 ϕ e t 0 2 ϕ i t 0 hereinafter ϕ e t ϕ e t and ϕ i t ϕ i t on the water surface the bernoulli equation holds 37 ϕ e t g η 1 2 ϕ e ϕ e at the bottom the no flux condition gives 38 ϕ e t z 0 ϕ i t z 0 on the membrane the no flux condition requires 39 ϕ e t n ϕ i t n where n means the gradient along the local normal direction the external and internal pressures are determined by the bernoulli equations eqs 20 and 23 from which the force balance eq 6 can be written as 40 ϕ e t ϕ i t τ κ τ i κ i ρ 1 2 ϕ i ϕ i ϕ e ϕ e at the two ends of the tank the no flux condition requires that 41 ϕ e t x 0 3 numerical method in the governing equations and boundary conditions given in section 2 the locations of the moving boundaries the water surface and the membrane together with the internal and external velocity potentials are to be found numerically traditional eulerian methods to solve the problem formulated in section 2 approximate the conditions on the moving boundaries by a taylor expansion about their corresponding undisturbed positions mei 1989 the validity of taylor expansion makes these methods not suitable for highly nonlinear wave problems recently the spectral methods are used to study nonlinear waves in wave flumes ducrozet et al 2012 paprota and sulisz 2018 however the interactions of the nonlinear waves with structures with complex geometries are still a challenge to the spectral method to study the interactions of highly nonlinear waves with flexible membrane the so called mixed eulerian lagrangian method proposed first by longuet higgins and cokelet 1976 is more suitable the method employed in this study is based on the mixed eulerian lagrangian method of longuet higgins and cokelet 1976 which can be used to study highly nonlinear wave problems 3 1 mixed eulerian lagrangian method the mixed eulerian lagrangian method solves the problem formulated in section 2 in two steps cao et al 1991 an eulerian step to solve the boundary value problems bvps and a lagrangian step to solve the initial value problems ivps the implementation of the mixed eulerian lagrangian method used here is slightly different from that employed in cao et al 1991 and liu et al 2009 in the present problem the acceleration potential on the membrane needs to be obtained before implementing the eulerian lagrangian method below is a summary of the implementation of the mixed eulerian lagrangian method for the present problem 1 the external and internal velocity potentials ϕ e n ϕ i n at t t n are given in the flow fields and on all boundaries at t t n the water surface is located at x f x f n the subscript f means free surface and the membrane is located at r r i ζ n at any specified angle θ 2 solve the bvps for the external and internal acceleration potentials ϕ e t n ϕ i t n simultaneously at t t n using an appropriate bvp solver the governing equations are 42 2 ϕ e t n 0 and 2 ϕ i t n 0 the boundary conditions and the matching conditions on the membrane are the following a on the water surface x f x f n the acceleration potential is known 43 ϕ e t n α n where 44 α n g η n ϕ e n ϕ e n 2 b on the membrane r r i ζ n the accelerations on the two side are the same 45 ϕ e t n n ϕ i t n n c on the membrane r r i ζ n the difference of the acceleration potentials on the two side of the membrane is known 46 ϕ e t n ϕ i t n β n where 47 β n τ n κ n τ i κ i ρ ϕ i n ϕ i n ϕ e n ϕ e n 2 d the following no flux conditions are imposed on the bottom 48 ϕ e t n z 0 and ϕ i t n z 0 e the following no flux condition is imposed on the lateral boundaries 49 ϕ e t n x 0 3 solve the ivps for the displacement of the water surface η n 1 the velocity potential on the water surface ϕ e n 1 the displacement of the membrane ζ n 1 in a given direction θ and the velocity potential on the inner surface of the membrane ϕ i n 1 in a given direction θ the fourth order runge kutta method is adopted here for the ivps with the initial conditions at t t n are given by ϕ e t n ϕ e n x f t n x f n ζ t n ζ n and ϕ i t n ϕ i n the equation to determine ϕ e n 1 is 50 ϕ e n 1 ϕ e n t s 1 4 κ s k s t n φ n where φ n ϕ e n ϕ i n ϕ e t n ϕ i t n ζ n and the equation to determine x f n 1 is 51 x f n 1 x f n t s 1 4 κ s λ s t n φ n the equation to determine ϕ i n 1 on the inner surface of the membrane is 52 ϕ i n 1 ϕ i n t s 1 4 κ s γ s t n φ n and the equation to determine the radial displacement of the membrane ζ n 1 is 53 ζ n 1 ζ n δ t s 1 4 κ s ξ s t n φ n in these equations the weights are κ 1 κ 4 1 6 and κ 2 κ 3 1 3 and the expressions for the slopes i e k s t n φ n λ s t n φ n γ s t n φ n and ξ s t n φ n are given in the appendix 4 solve the bvp for the internal velocity potentials at t t n 1 using an appropriate bvp solver the governing equation for ϕ i n 1 is 54 2 ϕ i n 1 0 and the boundary conditions are a at the bottom the following no flux condition is imposed 55 ϕ i n 1 z 0 b on the membrane two types of boundary conditions are used together with eq 54 and eq 55 in a predictor corrector manner to solve for ϕ i n 1 at the predictor step the internal problem is solved using eq 54 eq 55 and the boundary value of ϕ i n 1 on the membrane given by eq 52 the solution at this step is denoted by ϕ ˆ i n 1 at the corrector step the internal problem is solved again using eq 54 eq 55 and the following no flux condition 56 ϕ i n 1 n v r n 1 e r n where v r n 1 is determined by eq 35 57 v r n 1 ζ t n 1 sin θ cos θ r i ζ n 1 ζ n 1 θ ϕ ˆ i n 1 z cos θ sin θ r i ζ n 1 ζ n 1 θ ϕ ˆ i n 1 x the solution of ϕ i n 1 at the corrector step will be used on the right hand side of eq 60 to solve for ϕ e n 1 5 solve the bvp for the external velocity potentials at t t n 1 using an appropriate bvp solver the governing equation for ϕ e n 1 is 58 2 ϕ e n 1 0 and the boundary conditions and matching condition on the membrane are a the no flux condition is imposed on the lateral boundaries 59 ϕ e n 1 x 0 b on the water surface x f x f n 1 the velocity potential ϕ e n 1 is given c on the membrane r r i ζ n 1 the normal velocity on the outer surface is equal to that on the inner surface 60 ϕ e n 1 n ϕ i n 1 n 3 2 desingularized boundary integral equation method for bvps in this study the boundary value problems are solved using a desingularized boundary integral equation method dbiem which construct the solutions using rankine sources placed on an imaginary boundary ω that is adjacent to the physical boundary ω see cao et al 1991 and liu et al 2009 the small distance between the imaginary boundary ω and the physical boundary ω can be spatially variable in this study the rankine sources specified by the following green function are used 61 g x x s ln x x s ln x 2 h k x s where h is the water depth k the unit vector in the vertical direction x s the position of the rankine source the second term in eq 61 is the image of the first term about the horizontal bottom which makes the green function so defined satisfy the no flux condition at the bottom as a result we only need to place rankine sources on the free surface the inner and outer surfaces of the membrane and the two ends of the numerical tank the internal and external velocity potentials can be expressed as 62 ϕ i n 1 j 1 n i α j n 1 g x x j and ϕ e n 1 k 1 n e β k n 1 g x x k where α j n 1 and β k n 1 are the corresponding strengths of the rankine sources the internal and external acceleration potentials can be expressed as 63 ϕ i t n j 1 n i σ j n g x x j and ϕ e t n k 1 n e γ k n g x x k where σ j n and γ k n are the corresponding strengths of the rankine sources 3 3 techniques to improve numerical stability because the first and second order derivatives of the membrane displacement ζ with respect to the angular coordinate θ are needed in the calculation of the local curvature κ see eq 15 and the calculation of the radial velocity of the membrane see eq 35 or eq 57 the accumulation of the numerical error introduced by using finite difference schemes to calculate the derivatives may lead to numerical instability our numerical experiments show that using fourier series to express the membrane displacement and performing differentiation analytically can greatly improve the numerical stability the membrane displacement ζ θ can be expressed in a fourier series as 64 ζ θ k 1 n o a k sin k π θ θ 0 θ 1 θ 0 where θ 1 and θ 0 are the values of θ at the left and right ends of the membrane respectively and n o is the number of the modes to be included in the fourier series the coefficients a k in the finite fourier series must be chosen such that the conservation of the fluid mass contained in the membrane is satisfied for in compressible fluids the conservation of mass requires that at any time 65 1 2 θ 0 θ 1 r i 2 d θ 1 2 θ 0 θ 1 r i ζ θ 2 d θ which gives 66 θ 0 θ 1 ζ θ d θ 1 2 r i θ 0 θ 1 ζ 2 θ d θ under the assumption that ζ θ r i the conservation of mass can be approximated by the following equation 67 θ 0 θ 1 ζ θ d θ 0 our numerical results showed that eq 66 and eq 67 give nearly identical results for the conditions examined in this study using eq 64 in eq 67 gives 68 k 1 n o a k 1 cos k π k 0 therefore a 1 can be expressed by a k k 2 n 0 69 a 1 k 2 n o a k cos k π 1 2 k to determine the coefficients a k k 2 n o we minimize the following error function 70 e ζ m 0 m ζ θ m k 1 n o a k sin k π θ m θ 0 θ 1 θ 0 2 0 where ζ θ m is the membrane displacement given by eq 53 on a polar grid θ m θ 0 m 1 δ θ with δ θ being the grid size and m 1 2 m the least square method is used to determine the coefficients a k k 2 n o by requiring 71 e ζ a k 0 k 2 3 n o after a k k 2 3 n o are found the coefficient a 1 can be determined by eq 69 finally the first and the second derivatives of ζ θ with respect to θ which are needed to calculate the local curvature can be calculated analytically from eq 64 before using the no flux condition eq 56 at the corrector step to solve for ϕ i n 1 numerical errors need to be removed from the values of v r n 1 obtained from eq 57 so that the conservation of mass can be satisfied for this purpose we express v r n 1 in the following fourier series as we did for the membrane displacement ζ θ 72 v r n 1 k 1 n o v k sin k π θ θ 0 θ 1 θ 0 the first order approximation to the conservation of mass requires 73 θ 0 θ 1 v r n 1 θ d θ 0 which gives 74 k 1 n o v k 1 cos k π k 0 the coefficient v 1 can be expressed in terms of v k k 2 3 n o 75 v 1 k 2 n o v k cos k π 1 2 k to determine the coefficients v k k 2 3 n o the following error function is defined 76 e v m 0 m v r n 1 θ m k 1 n o v k sin k π θ m θ 0 θ 1 θ 0 2 0 where v r n 1 θ m is the radial velocity of the membrane given by eq 57 on a polar grid θ m θ 0 m 1 δ θ with δ θ being the grid size and m 1 2 m the least square method is used to determine the coefficients v k k 2 n o by requiring 77 e v a k 0 k 2 3 n o after the coefficients v k have been obtained the radial velocity v r n 1 calculated by eq 72 can be used on the right hand side of eq 56 to solve for ϕ i n 1 4 results and discussion 4 1 model verification and validation the theory and the code are validated and verified by comparing with the experimental results of ohyama et al 1989 and the linear analysis results of phadke and cheung 2001 the following parameters are used for producing the numerical results in section 4 1 the elastic modulus 58000k n m 2 the thickness of the membrane 1 65 mm the water depth h 0 8 m the wave amplitude a w 0 025 h the height of the membrane h m 0 56 h and the width of the membrane b 2 0 h these parameters were used in ohyama et al 1989 and phadke and cheung 2001 who examined three values of the dimensionless initial excess pressure p i ρ g h 0 065 0 116 0 208 in the numerical simulation a truncated fourier series of n o terms is used to express the membrane displacement for numerical stability consideration theoretically including more terms in the truncated fourier series should give more accurate simulation results however the computational cost and the accumulation of round off errors increase with increasing n o as a result there is an optimum value for n o which balances the accuracy and computational cost the surface displacements recorded by the wave gauge g i i 1 2 3 4 whose positions are shown in fig 1 are used to analyze transmission coefficients the time history of the surface displacement can be expressed as 78 η t x i n 1 n a n x i cos n ω t ψ n x i where x i is the location of the wave gauge g i ω is the angular frequency of the fundamental waves a n x i and ψ n x i are the amplitude and the phase angle of the nth harmonic waves respectively based on the first harmonic components recorded by g 1 and g 2 the amplitudes of the reflected waves and incident waves a i and a r can be calculated by performing a wave separation analysis using the two point method of goda and suzuki 1976 on the lee side of the membrane the higher harmonic waves contain both free waves and phase locked waves the free and locked waves can be separated by the method given by grue 1992 the transmission coefficients for the fundamental waves and the higher harmonic free and locked waves are defined respectively by 79 c t a t a i t n f a n f a i and t n l a n l a i where a t is the amplitude of the fundamental transmitted waves and a n f and a n l are the amplitudes of the nth order free and locked waves respectively the transmission coefficient for the fundamental waves c t is referred to the transmission coefficient hereinafter for simplicity the transmission coefficient as a function of b l w for the case of n o 5 n o 13 and n o 18 are shown in fig 2 where b is the width of the membrane structure a w and l w are the amplitude and the length of the incident waves respectively it can be seen that there exists a critical value of b l w at which the minimum transmission coefficient occurs this critical value is denoted by b l w c hereinafter a shift of b l w c with the increase of n o can be observed however the transmission coefficients obtained for different values of n o are almost the same when n o is large enough say n o 13 or n o 18 implying that the simulation accuracy can be guaranteed with n o 18 the coefficients a k of the fourier series of r θ for n o 18 are given in fig 3 as expected the magnitude of a k in eq 64 becomes very small as k approaches n o the influence of the terms with k 18 in eq 64 on the membrane displacement can be safely ignored we remark that the optimal value of n o is affected mainly by the geometry of the membrane the optimal value n o 18 can be adopted only if the geometry of the membrane is similar to the one studied here ohyama et al 1989 defined the transmission coefficient as the ratio of the root mean square height of the transmitted waves to the height of the incident waves i e 80 c t 1 n i 1 n h i t 2 h i where h i is the height of the incident waves in the absence of the structure and h i t is the height of the ith transmitted waves in a time series of the measured surface displacement table 1 lists the two transmission coefficients obtained by eqs 79 and 80 and the reflection coefficients c r a r a i obtained by a two point wave separation analysis for fundamental waves for a w h 0 025 and p i ρ g h 0 208 it is seen that maximum relative error of two transmission coefficients is less than 2 for all the conditions examined we also used the conservation of wave energy to check the numerical accuracy for infinitesimal monochromatic waves the conservation of wave energy flux requires 81 c r 2 c t 2 1 for finite amplitude waves the existence of weak higher harmonic wave components makes c r 2 c t 2 slightly less than unity from table 1 it can be seen that the maximum value of 1 c r 2 c t 2 is less than 6 the value of this error in the linear analysis of phadke and cheung 2001 is about 3 we remark that the reflection and transmission coefficients c r and c t are defined for the first harmonic waves and equation c r 2 c t 2 1 is derived under the assumption that the energy flux contained in higher harmonic wave components can be ignored when waves are nonlinear waves and energy flux contained in higher harmonic wave components cannot be ignored 1 c r 2 c t 2 is theoretically equal to n 1 n t n f 2 t n l 2 where t n f and t n l are contributions from the energy contained in the higher harmonic free and lock waves therefore a smaller value of 1 c r 2 c t 2 obtained by a linear analysis does not mean the linear analysis is more accurate than the nonlinear analysis if waves are nonlinear waves the purpose that we compare our results with that of phadke and cheung 2001 for linear waves is to show that our non linear analysis is accurate as the linear analysis for linear waves the simulated transmission coefficients for a range of values of b l w is shown in fig 4 where the transmission coefficients measured by ohyama et al 1989 are also included for comparison it can be seen that the numerical simulation captures well the trend of the measured transmission coefficients in particular both the experiment and the simulation show that the transmission coefficient takes a minimum value at certain wave frequencies which are referred to resonant frequencies by phadke and cheung 2003 the resonant frequencies can be captured well by the simulation indicating that viscous effects do not play an important role in the determination of the resonant frequency there are still certain discrepancy in the minimum value of the transmission coefficient at the resonance this discrepancy is attributed mainly to three dimensional effects in the experiment and experimental errors phadke and cheung 2003 we remark that the same degree of under prediction in the transmission coefficient also exists in other numerical studies see for example phadke and cheung 2001 2003 4 2 response of the membrane and its effects on wave transmission the response of the membrane can be evaluated by the radial deformation ζ θ t which is expressed as the following fourier series 82 ζ θ t k 1 n o a k t sin k π δ θ θ θ 0 the simulation can output the time series of a k t which can be also expanded as the following fourier series with its coefficients to be determined by fitting to the data 83 a k t n 1 n a k n cos n ω t ψ n here a k n and ψ n are the amplitude and the phase angle of the nth harmonic membrane response respectively table 2 gives the values of a k n r i for weak incident waves it is stressed there the subscript n means the n th temporal harmonic oscillation of the membrane and the subscript k means the k th spatial modal shape of the membrane it can be seen that for any modal shape any given k the first harmonic amplitude n 1 is always stronger than those of higher harmonics n 1 this is also true for the other cases where waves are weakly nonlinear waves therefore only the first harmonic response of the membrane is discussed for weakly non linear waves of a w h 0 025 in this section nonlinear waves will be discussed in the next section fig 5 shows the values of a k 1 r i k 1 2 3 4 versus b l w the values of a k 1 for k 4 are not shown because their values are very small it can be seen that a 2 1 and a 3 1 are dominant in the case of p i ρ g h 0 208 the value of b l w at which the maximum a 2 1 occurs is very close to the one at which the minimum transmission coefficient occurs in the case of p i ρ g h 0 116 there are two values of b l w at which the transmission coefficient reaches a local minimum one corresponds to the maximum a 2 1 and the other corresponds to the maximum a 3 1 in the case of p i ρ g h 0 065 the value of b l w at which the minimum transmission coefficient occurs corresponds to the maximum a 3 1 the phenomenon that the minimum transmission coefficient occurs at the resonant response of the membrane may be explained by the destructive interference between the transmitted waves and radiated waves when the membrane has a resonant response to the incoming waves to confirm this point the wave interaction with a bottom mounted rigid breakwater of the same dimensions i e the membrane elastic modulus approaches the infinity was simulated the snapshots of the surface elevations for this rigid breakwater and the flexible fluid filled membrane at the resonant frequency are shown in fig 6 a much stronger wave transmission can be observed for the case of the rigid breakwater but the transmitted waves are hardly observable for the case of the flexible fluid filled membrane breakwater therefore it is the radiated waves generated by the membrane resonant response that weakens the waves on the lee side for the case shown in fig 6 b the radial displacements of the membrane as a function of θ at four instants are shown in fig 7 hereinafter the dimensionless time t which is normalized by the period of incident waves is use to present time series it can be seen that the mode of the membrane deformation is affected by the dimensionless initial excess pressure p i ρ g h in the case of a higher initial excess pressure p i ρ g h 0 208 only the first mode of membrane deformation is observed in the case of a lower initial excess pressure p i ρ g h 0 065 only the second mode of membrane deformation is observed for a moderate pressure p i ρ g h 0 116 both the first and second modes of the membrane deformation are observed this phenomenon can be explained by the effective stiffness of the fluid filled membrane system a higher initial excess pressure can induce a higher tension in the membrane which can result in a higher effective stiffness therefore the natural frequency of the system with a higher initial excess pressure is higher than that with a lower initial excess pressure for the same mode vibration for the same excitation frequency the resonant mode of the system with a higher initial excess pressure is lower than that with a lower initial excess pressure the maximum radial displacements of the membrane at resonance ζ m a x r i are listed in table 3 which shows that the assumption of ζ r i can be satisfied the initial tension in the membrane τ i which can be calculated by the eq 2 is used to normalize the tension in the membrane τ m under the action of waves examples of time series of τ m τ i are shown in fig 8 for different values of n o it can be seen that n o the number of terms in the fourier series affects the simulated phase of τ m until n o is large enough as n o 16 further increasing n o has little effect on the simulated phase of τ m therefore it is reasonable to choose n o 18 the average of τ m over a wave period shows that the mean tension in the membrane τ m is larger than the initial tension τ i ohyama et al 1989 also observed that the excess pressure increased under the action of waves however ohyama et al 1989 did not give any explanation the increase of the mean tension in the membrane under the action of waves explains the phenomenon observed by ohyama et al 1989 the following is an explanation why the mean tension in the membrane is larger than the initial tension according to eq 5 the increase of the instantaneous tension relative to the initial tension is determined by the increase of the instantaneous membrane length relative to the initial length of the membrane δ l m l t l i ignoring the higher order effects on ζ r i δ l m is expressed as 84 l m θ 0 θ 1 ζ d θ 1 2 θ 0 θ 1 ζ θ 2 r i ζ d θ substituting eq 66 into eq 84 and ignoring the higher order of ς r i we have 85 l m 1 2 θ 0 θ 1 ζ 2 r i d θ 1 2 θ 0 θ 1 ζ θ 2 r i ζ d θ substituting eq 64 into eq 85 and considering l i r i δ θ gives 86 l m l i 1 4 π δ θ 2 k 1 n o a k r i 2 k 2 δ θ π 2 it can be seen from eq 86 that δ l m is always positive therefore the instantaneous tension is always larger than the initial tension it can also be noticed that δ l m increases with the amplitude of the membrane response table 4 gives the mean tension in the membrane for four wave amplitudes as wave amplitude increases the amplitude of the membrane response also increases therefore a larger mean tension in the membrane is expected for larger waves the effective stiffness of the fluid filled membrane system stiffness increases with the mean tension which can result in a shift of the resonant frequency the shift of resonant frequency under larger waves was also observed in the simulation of phadke and cheung 2003 the presented simulation has also confirmed this phenomenon the dynamic pressure is the pressure induced by waves which can be obtained by subtracting the static pressure from the total pressure the dynamic external and internal pressure distributions along the membrane p e and p i are shown in fig 9 it can be seen that the dynamic pressure on the membrane both the external pressure and the internal pressure are not uniform the maximum of the dynamic internal pressure is much larger than that of the dynamic external pressure at resonance see in fig 9 a away from the resonant response the maximum values of the dynamic internal and external pressure are similar see fig 9 b therefore the internal pressure inside the membrane cannot be treated as a constant in the simulation as did in broderick and leonard 1995 4 3 locked and free waves as wave amplitude increases higher harmonic waves will be generated by 1 the wave wave interactions in the water above the membrane and 2 the nonlinear membrane response the higher harmonic waves generated by wave wave interactions in the water above the membrane are phase locked waves before they leave the membrane when they enter the deeper water on the lee side of the membrane these higher harmonic waves become free waves therefore the higher harmonic free and locked waves co exist on the lee side of the membrane and the method given by grue 1992 can be used to separate the free and locked waves the transmission coefficients defined in eq 79 for the fundamental waves the second harmonic free and locked waves for four incident wave amplitudes are shown in fig 10 for longer waves i e the wave frequency is less than the resonant frequency the second harmonic free waves become stronger as the incident wave amplitude increases generally the locked waves are much weaker than the free waves however a sudden increase of the amplitude of the locked waves occurs in a narrow frequency band a stronger second harmonic response of the membrane can also be observed in this narrow frequency band the reason for this however is not clear for shorter waves i e the wave frequency is higher than the resonant frequency the second harmonic free waves become much weaker and only the locked waves can be observed the amplitude of the locked waves increases with the ratio of the amplitude to the wave length of the fundamental waves which agrees with the stokes wave theory when the wave frequency equals to the resonant frequency the transmission coefficients for the fundamental waves second harmonic free and locked waves approach zero for all four cases which means that transmitted fundamental and higher harmonic waves can be suppressed by the destructive interference no matter what the wave height is as a closing remark viscous effects are not important in this problem viscous effects comes from wave boundary layer and vortex shedding both effects on wave scattering are not important in this problem the relative importance of the vortex shedding from the membrane the k c number can be defined by 2 π a w b where a w is the amplitude and b is the width of the membrane in this study k c 0 2 which means that the effect of the vortex shedding does not occur mei 1989 and the energy loss is mainly due to the viscous energy dissipation associated with the wave boundary layer which is usually of a thickness on the order of millimeters the energy dissipated within the wave boundary layer is always small compared to the energy contained in incident reflected or transmitted waves even though the energy dissipated by the wave boundary layer is small theoretically the real transmission coefficient is expected to be slightly less than that predicted by the potential theory the effect of viscous energy dissipation is even smaller as the wave frequency approaches the resonant frequency when resonant response occurs the destructive interference between the transmitted waves and radiated waves become the most important factor to reduce the transmission coefficient 5 conclusions in this study a mixed eulerian lagrangian method based on potential flow theory was used to simulate the fully nonlinear interaction between coastal waves and a fluid filled membrane breakwater the response of the membrane and the nonlinear wave scattering were simulated the numerical results were compared with the experiments of ohyama et al 1989 the following conclusions can be drawn from this study 1 the numerical stability can be implemented by expressing the radial displacement of the membrane as a fourier series and ensuring that the no flux condition on the membrane is satisfied at any location for every time step 2 when the number of terms in the fourier series is large enough n o 16 the presented simulation can give the results in agreement with the experimental results of ohyama et al 1989 3 the destructive interference of the transmission waves and radiation waves by the membrane resonant response can reduce the transmission coefficient greatly at resonance the transmission coefficients of the fundamental waves second harmonic free and locked waves approach zero 4 the wave interaction with the membrane can increase the mean tension in the membrane the increase of the mean tension becomes larger as the wave amplitude increases resulting in a shift of the resonant frequency with wave amplitude acknowledgement the first author c r l would like to thank the xiamen science and technology bureau china 3502z20173036 for its financial support to his visit to uh manoa in 2018 for this work the corresponding author z h h acknowledges the support by the national science foundation under grant no 1706938 any opinions findings and conclusions or recommendations expressed in this material are those of the author s and do not necessarily reflect the views of the national science foundation this is soest contribution no 10666 appendix a unimportance of the membrane inertia force and some expressions used in the runge kutta method appendix a 1 unimportance of the membrane inertia force according to newton s second law the motion equation of a small element of membrane can be written as a 1 ρ m d d v m d t d s p i p e n d s f τ where ρ m is the density of the membrane d is the thickness of the membrane d s is the area of a small membrane element v m is the velocity of the membrane element p i and p e are the internal and external dynamic pressure on the membrane element respectively n is the unit vector normal to the membrane element and f τ is the force caused by the tension in the membrane element the order of magnitude of the inertia force can be estimated as a 2 o ρ m d d v m d t d s o ρ m d a t 2 d s where a and t are the amplitude and period of the incident waves respectively the order of magnitude of the force related to the dynamic pressure on the membrane element can be estimated as a 3 o p i p e d s o ρ g a d s where ρ is the density of the water according to eqs a 2 and a 3 the ratio of the dynamic pressure force to the inertia force can be estimated as a 4 p i p e d s ρ m d d v m d t d s o ρ ρ m g t 2 d for the present problem wave periods are in the range of 0 5 s and 2 0 s and the thickness of the membrane is 1 65 mm therefore the inertia force is much smaller than the force related to the dynamic pressure and thus can be safely ignored appendix a 2 some expressions used in the runge kutta method the expressions for the slopes used in the implementation of runge kutta method are k s t n φ n ϕ e t n s λ s t n φ n ϕ e n s γ s t n φ n ϕ i t n s ξ s t n φ n sin θ cos θ r i ζ n s ζ n s θ ϕ i n s z cos θ sin θ r i ζ n s ζ n s θ ϕ i n s z where φ n s φ ϕ e ϕ i ϕ e t ϕ i t ζ is the value of φ at step n s for s 1 the step n s is the time step n for s 2 3 4 the step n s is the predictor step the value of φ at step n s 1 can be calculated based on its value at n s 
22913,efficient evaluation of the transient free surface green function with sufficient accuracy is the key to employ time domain panel method in solving hydrodynamic problems in this paper series and asymptotic expansions for the green function and its two spatial derivatives are deduced in detail for the evaluation new residual functions are derived straightforwardly from the resulted asymptotic formulas and it is concluded that the present residual functions decay rapidly than existing choices the ultimate algorithm is the combination of chebyshev approximations and asymptotic expressions along with a special partitioning line introduced to speed up the evaluation after comprehensive numerical validation it is pointed out that the present algorithm owns at least 6 digits of accuracy and sufficient efficiency for practical application any efficient method for evaluating the green function will use the asymptotic expansions furthermore it should be pointed out that the present residual functions can also be conveniently applied to the scheme of interpolation in a precomputed table keywords the transient green function new residual functions asymptotic expansions chebyshev approximations marine hydrodynamic 1 introduction in recent years the nonlinear seakeeping and wave load analysis in time domain is urgently needed for ship design purpose the methods based on potential flow theory are attractive and necessary as they are much more efficient to implement than cfd codes whether the program is developed with the so called hybrid method zhang et al 1998 yasukawa 2003 kataoka and iwashita 2004 liu and papanikolaou 2011 tang et al 2014 or the direct free surface green function method bingham et al 1993 sen 2002 datta et al 2011 walree 2014 the calculation of the transient free surface green function always plays an important role in these efficient implementations for the evaluation of the transient green function a number of papers have appeared over the years except for the inefficient scheme of direct numerical integration and analytic expansions liapis 1986 king 1987 there are mainly other three numerical schemes a the interpolation in a precomputed table b the polynomial approximations c the solution to a fourth order ordinary differential equation ode as to a and b efficient calculations of green function are generally divided into two parts those are evaluations of a relatively simple expression with high oscillation called the subtraction function and a slow varying residual function beck 1994 and huang 1992 individually developed the method with the interpolation in a table the selected subtraction function by beck 1994 was a combination of bessel functions which inevitably introduced extra computational time due to these special functions although huang 1992 chose simpler formulae sine function was not involved in the subtraction function and consequently the important role of sine function in effectively reducing the oscillation of residual functions was ignored in addition newman 1992 and lin and yue 1990 presented methods for the green function with polynomial approximations and newman extended his method to the case of finite depth however the derivation of subtraction functions for the spatial derivatives were not explicit which makes the direct use of these method inconvenient for the first time clement 1998 observes that the transient green function is the solution of a fourth order ode which was envisioned as an alternative means for numerical evaluations then subsequent progresses using this philosophy were presented in these papers li et al 2015 duan and dai 2001 zhu et al 2007 chuang et al 2007 among which the difference was the adopted solution to this ode in 2016 after a representative test case of the relative efficiency bingham 2016 concluded that the polynomial approximation method from newman 1992 was much more efficient than these ode based methods therefore in view of the computational efficiency of green function the schemes a and b will be a better choice meanwhile we also need know that the success of these schemes mainly rely on whether the residual functions are slowly varying enough furthermore considering the very large tables required in the interpolation method ranging from 64 000 to 2 000 000 entries beck 1994 and the computational efficiency inherent in the minimax polynomial approximations this paper will use the scheme of the polynomial approximations to evaluate the green function and its derivatives the objective of this paper is to seek efficient and practical solutions to the transient green function in time domain water wave interactions analytic expansions for both the green function and its two spatial derivatives has been put forward these expansions consist of the series expansions at small time and the asymptotic expansions at large time the new slow varying residual functions are derived straightforwardly from the asymptotic results for the first time subsequently the efficient algorithm is developed by combing the polynomial approximations with the asymptotic expansions a special partitioning line is introduced to speed up the evaluation for large time regions after well designed numerical validation we conclude that the algorithm has at least 6 digits of accuracy and sufficient efficiency for practical application 2 the analytic expansions of the green function 2 1 the green function and its spatial derivatives considering a field point p x y z and a source point q ξ η ζ in the earth fixed coordinate the infinite depth transient green function is given by 1 g p q t δ t 1 r 1 r 1 h t g f p q t t 0 where δ t is the dirac delta function and h t the heaviside step function here 2 g f r z t 2 0 g k sin t g k e k z j 0 k r d k with r x ξ 2 y η 2 z z ζ r r 2 z ζ 2 r 1 r 2 z ζ 2 after using spherical coordinates with z ζ r 1 cos θ r r 1 sin θ the nondimensional time τ t g r 1 1 2 and the substitution k r 1 k the wave part of green function g f and its spatial derivatives g r f g z f can be written with only two variables θ and τ 3 g f 2 g 1 2 r 1 3 2 0 k 1 2 sin τ k 1 2 e k cos θ j 0 k sin θ d k g r f 2 g 1 2 r 1 5 2 0 k 3 2 sin τ k 1 2 e k cos θ j 1 k sin θ d k g z f 2 g 1 2 r 1 5 2 0 k 3 2 sin τ k 1 2 e k cos θ j 0 k sin θ d k introducing the auxiliary function f p for eq 3 4 f p 0 k p exp i τ k 1 2 k cos θ j 0 k sin θ d k thus 5 g f 2 g 1 2 r 1 3 2 g 1 g r f 2 g 1 2 r 1 5 2 g 4 g z f 2 g 1 2 r 1 5 2 g 3 with 6 g 1 i m f 1 2 g 2 r e f 1 g 3 i m f 3 2 g 4 3 2 g 1 τ 2 g 2 cos θ g 3 sin θ sin θ 0 the objective is to evaluate g i i 1 2 3 or f p p 1 2 1 3 2 in the computational domain 0 τ 0 θ π 2 now a set of analytic expansions will be derived in section 2 2 and 2 3 which is the prerequisite to develop the corresponding numerical approximations 2 2 series expansions for small values of τ for small values of τ after making the taylor expansion in τ 0 to exp i τ k 1 2 of f p and using the properties of gamma function γ and legendre polynomial p v gradshteyn and ryzhik 1980 the uniformly convergent expansion is given by 7 f p n 0 i τ n n γ n 2 p 1 p n 2 p cos θ substitution of eq 7 in eq 6 gives the desired series expansions 8 g 1 m 0 1 m τ 2 m 1 m 1 2 m 1 p m 1 cos θ g 2 m 0 1 m τ 2 m m 1 2 m p m 1 cos θ g 3 m 0 1 m τ 2 m 1 m 2 2 m 1 p m 2 cos θ 2 3 asymptotic expansions for large values of τ for large values of τ we rearrange the integral of f p with the substitution of k ω 2 and then decompose the integral in the form newman 1992 9 f p 2 0 ω 2 p 1 e i τ ω ω 2 cos θ j 0 ω 2 sin θ d ω f 0 p f 1 p f 2 p with 10 f 0 p 2 0 i τ 2 ω 2 p 1 e i ω τ ω 2 cos θ j 0 ω 2 sin θ d ω f 1 2 p i τ 2 ω 2 p 1 e i ω τ ω 2 cos θ h 0 1 2 ω 2 sin θ d ω h 0 1 2 is the hankel function j 0 iy 0 with the following expressions 11 h 0 1 2 ω 2 sin θ e i ω 2 sin θ π 4 2 π ω 2 sin θ n 0 c n i ω 2 sin θ n where c n γ n 1 2 2 π 2 n n for f 0 p the integral can be expanded by using the partial integration and the relationship of bessel function and legendre polynomial with the desired result 12 f 0 p 2 i 2 p 2 n 0 2 n 2 p 1 τ 2 n 2 p 2 n p n cos θ for f 1 2 p newman 1992 has observed that the integral f 1 p can be ignored by use of stationary phase method similarly then the rearranged f 2 p is explicitly given by 13 f 2 p 2 2 π sin θ e 1 4 τ 2 e i θ i θ 2 i π 4 n 0 c n i n ω 2 p 2 n 1 sin n θ i ν with 14 i ν e 1 4 τ 2 ν 2 1 i e i θ 2 ν 2 p 2 n d ν for the case of 2 p 2 n 0 applying the binomial theorem to eq 14 gets sun 2009 15 i ν k 0 c 2 p 2 n k i k e i k θ 2 e 1 4 τ 2 ν 2 ν k d ν when k 2 m 1 we get i ν 0 since the integrand is an odd function for k 2 m the following formulation is obtained 16 i ν m 0 c 2 p 2 n 2 m e i m θ 2 τ m 1 γ 1 m 2 substituting eq 16 into eq 13 thus 17 f 2 p 2 2 sin θ e τ 2 cos θ 4 n 0 1 sin n θ m 0 d n m 0 e i θ n m 2 τ 2 m 2 n 2 p with 18 θ n m τ 2 4 s i n θ p m n 2 1 4 π m 2 n 2 p 1 2 θ d n m 0 c n 2 p 2 n 2 p 2 m 2 n 2 2 m m 2 p 2 n 0 for the other case of 2 p 2 n 0 the auxiliary function f ν is given by 19 f ν 1 i e i θ 2 ν 2 p 2 n making the taylor expansion in ν 0 gets 20 f ν k 0 f k 0 n ν k when k 2 m 1 i ν of eq 14 can be ignored due to the odd function f ν whereas when k 2 m i ν can be rearranged by removing the odd terms 21 i ν e 1 4 τ 2 ν 2 1 i e i θ 2 ν 2 p 2 n d ν e 1 4 τ 2 ν 2 m 0 f 2 m 0 n ν 2 m d ν with 22 f 2 m 0 i 2 m e i m θ 2 m 2 n 2 p 1 2 n 2 p 1 substituting eq 22 into eq 21 thus 23 i ν m 0 i 2 m e i m θ 2 m 2 n 2 p 1 2 n 2 p 1 i ν ν with 24 i ν ν e 1 4 τ 2 ν 2 ν 2 m d ν we rearrange i ν ν with the substitution of x τ ν 2 25 i ν ν 2 τ 2 m 1 e x 2 x 2 m d x 2 τ 2 m 1 i x x after integrating term by term i x x becomes 26 i x x e x 2 x 2 m d x 2 m 1 2 m 3 2 m 2 m 1 2 m e x 2 d x 2 m 2 2 m m π substituting eq 25 eq 26 and eq 23 into eq 13 gets the analogical formulation as eq 17 27 f 2 p 2 2 sin θ e τ 2 4 cos θ n 0 1 sin n θ m 0 d n m 0 e i θ n m 2 τ 2 m 2 n 2 p with the same θ n m as eq 18 and 28 d n m 0 c n 2 m 2 n 2 p 1 2 n 2 p 1 2 2 m m 2 p 2 n 0 in conclusion for large values of τ we get the unified expressions of f 2 p 29 f 2 p a b n 0 1 sin n θ m 0 d n m e i θ n m 2 τ 2 m 2 n 2 p with a 2 2 sin θ 1 2 b exp τ 2 cos θ 4 and 30 d n m c n 2 p 2 n 2 p 2 m 2 n 2 2 m m 2 p 2 n 0 c n 2 m 2 n 2 p 1 2 n 2 p 1 2 2 m m 2 p 2 n 0 3 the combination of chebyshev polynomials and asymptotic expansions without considering the efficiency the series expansions g i in 8 asymptotic expansions f 0 p in 12 and f 2 p in 29 can be used to yield any desired degree of accuracy see fig 1 additionally to achieve 6d accuracy the expansions f 0 p and f 2 p usually work effectively at τ 12 with the truncated number n of f 0 p and n m of f 2 p not more than 3 and 4 2 respectively however the expansion g i in 8 always needs a truncated order m of at least 80 at 10 τ 12 and this is too large for the effective use therefore for the case of 0 τ 12 we use the philosophy of the residual function inspired from newman 1985a 1985b 1992 instead of using the series expansions 8 this philosophy mainly relies on the extent to which the obtained residual functions in each region are slowly varying then the next objective is to obtain the residual functions and the related regions 3 1 reasonable selection of the residual functions the results of g i are outlined in fig 2 4 with the inefficient method a1 see fig 1 it is clearly shown that g i has high frequency oscillation with increasing amplitude when cos θ is near zero but has slow varying extent in most of rest region any kind of efficient scheme will not be adopted in a straightforward manner to approximate g i for the region of cos θ near zero however that scheme may be useful for the slow varying region of cos θ 0 4 therefore special attention should be given only to the rest region of 0 cos θ 0 4 in other words we need to obtain the subtraction part from g i for efficient approximations in this respect the analytic expansions already obtained in section 2 are essential the asymptotic result f 2 p includes not only the explicit formulation 2 2 sin θ 1 2 exp τ 2 cos θ 4 but also the oscillating cosine or sine function inherent in exp i θ n m f 2 p has these advantages over g i in 8 and f 0 p accordingly it is used to obtain the subtraction functions after substituting p 1 2 1 3 2 into 29 and specifying the first few items we get 31 f 2 1 2 a b τ a 31 2 n 1 1 sin n θ m 0 d n m e i θ n m 2 τ 2 m 2 n 1 f 2 1 a b a 1 8 sin θ τ 2 a 51 4 a 32 2 n 2 1 sin n θ m 0 d n m e i θ n m 2 τ 2 m 2 n 2 f 2 3 2 a b 3 τ a 52 4 τ 3 a 7 8 τ a 33 16 sin θ n 2 1 sin n θ m 0 d n m e i θ n m 2 τ 2 m 2 n 3 here 32 a 1 cos π 4 θ 2 c a 31 sin 3 π 4 3 θ 2 c a 32 cos π 4 3 θ 2 c a 33 sin π 4 3 θ 2 c a 51 cos π 4 5 θ 2 c a 52 sin π 4 5 θ 2 c a 7 s i n π 4 7 θ 2 c with c τ 2 sin θ 4 therefore the residual functions g i for g i are derived from 31 and explicitly given for regions of 0 cos θ 0 4 and 0 τ 12 33 g 1 g 1 a b τ a 31 2 g 2 g 2 a b a 1 8 sin θ τ 2 a 51 4 a 32 2 g 3 g 3 a b 3 τ a 52 4 τ 3 a 7 8 τ a 33 16 sin θ the present residual function and the two existing choices from huang 1992 and beck 1994 are listed as 34 g 1 present g 1 τ b 2 sin θ sin 3 π 4 3 θ 2 τ 2 sin θ 4 g 1 huang g 1 τ b 2 sin τ 2 4 g 1 beck g 1 π τ 3 b 16 2 j 1 4 τ 2 8 j 1 4 τ 2 8 j 3 4 τ 2 8 j 3 4 τ 2 8 the g 1 huang does not contain sin θ but our numerical test observes that sin θ is essential to effectively slowdown the oscillation the g 1 beck derived from wehausen and laitone 1960 is a combination of products of bessel functions which inevitably introduced the unwanted computational time the oscillations of these three kinds of results can be founded in fig 5 the oscillation trend is much higher for the yellow surface g 1 huang and the grey surface g 1 beck than the blue one g 1 present more clearly the extracted special cases see fig 6 show that g 1 present is indeed the most slow varying this means compared with the other two the present one will need fewer terms of polynomial or interpolation coefficients to obtain the same numerical accuracy in addition although the residual functions of g 2 and g 3 are not showed in huang 1992 and beck 1994 we believe that the same conclusion will be made to these two cases comparing fig 5 and 6 with fig 2 indicates that the amplitude of the residual functions is reduced significantly and more importantly the residual function decays rapidly all these make the effective use of polynomial approximations possible 3 2 the algorithm combined with chebyshev approximations and asymptotic expansions for the case of 0 τ 12 the algorithm with chebyshev approximations is used at first g i in eq 33 is evaluated by the above mentioned a1 with at least 10d accuracy then g i is approximated by the two dimensional chebyshev polynomials although g i has the respective oscillation numerical computations suggest that the following partitions are applicable to these three cases with τ 0 0 5 10 5 10 92 11 2 11 48 11 75 12 0 and cos θ 0 0 1 1 0 finally we subdivided the τ cos θ domain into 26 10 260 rectangles economized chebyshev coefficients are obtained to guarantee an accuracy of 6d the truncated number of each coefficients matrix varies from 4 up to 45 now taking the region 0 τ 0 5 0 cosθ 0 1 as example the resulted coefficients are illustrated in tables 1 3 in which n 1 and n 2 is the economized coefficient order the coefficient matrix for g 1 g 2 and g 3 does not have the same elements and that is quite different from the frequency domain case shan 2018 moreover for the expressions in detail of the chebyshev approximation please refer to shan 2018 in which this scheme is similarly adopted to the frequency domain green function in infinite depth for the other case of τ 12 the algorithm with the asymptotic expansions is used numerical experimentations confirm that when τ 3 cos θ 0 01 10 only the solution of f 0 p can even obtain sufficient accuracy since in this case f 2 p is usually less than 10 6 huang 1992 using this partitioning line can certainly speed up the evaluation for the large time regions furthermore the appropriate truncated number n of f 0 p and n m of f 2 p have been chosen respectively according to different regions ultimately the efficient algorithm for g i i 1 2 3 is showed in fig 7 it should point out that when cos θ is near zero the chebyshev coefficients and the truncated terms of asymptotic expansions should be carefully selected to ensure the 6d accuracy 4 the validation of numerical accuracy and efficiency 4 1 the numerical accuracy the numerical error is validated by a 2 a 1 which means the absolute value of results from a2 subtracted by those from a1 the number of calculation point along τ and cos θ is 1201 and 101 respectively for both small and large τ regions the error for small τ region 0 τ 12 is shown in fig 8 it can be clearly found that the different rectangular subdomain has different error distribution due to the individual truncated chebyshev coefficients the chosen partitions along τ and cos θ works well for these three function the evaluation of every single point can maintain 6d accuracy and even almost half of calculation domain has at least 7d accuracy fig 9 illustrates the error distribution of large τ region 12 τ 24 because this region is straightforwardly evaluated by the use of the asymptotic expansions there is not so many subdomains as the small τ region it also can be clearly observed that the evaluation of every single point has at least 6d accuracy and most of region has 7d accuracy the same conclusion can be made in the larger τ region of τ 24 to avoid repetition it is not described here 4 2 the numerical efficiency to evaluate the efficiency of this algorithm calculations of the green function and its two derivatives in different region are implemented with the same number of calculation point that is 10000 calculation points along τ and 1000 points along cos θ respectively 107 points totally all the calculations are run on a personal computer with an intel core i7 4790 with cpu clock of 3 6 ghz from fig 10 we find the consumed time of one single point for 0 τ 12 is only about 0 4 μs and the efficiency of asymptotic expansion for τ 12 is even several times higher than that of polynomial approximation for 0 τ 12 moreover the efficiency is becoming higher with the increase of τ that is to say an efficient method for evaluating the green function needs adopt the asymptotic expansions at large time fig 11 shows the consumed time of the region near cos θ 0 is more than that near cos θ 1 since the former has more terms of chebyshev coefficients and that is also a natural consequence of varying trend of the residual function 5 conclusion a complete set of formulae for the green function and its two spatial derivatives are presented detailedly in this paper the new residual functions are obtained directly from the asymptotic expressions and the new one decays faster than the other two existing choices the successive algorithm is developed by combing the chebyshev polynomial approximations with the asymptotic results it is concluded that the present method is shown to be with at least 6d of accuracy and high efficiency for practical application moreover any efficient method for evaluating the green function will use the asymptotic expansions at last it should be pointed out that the present residual functions can also be conveniently applied to the scheme of interpolation in a precomputed table acknowledge this work has been financially supported by the miit high tech ship research projects project no 2016 25 k24333 and by national natural science foundation of china nsfc grant no 51479117 51579147 appendix a the deduction of eq 6 it is straightforward to obtain the expressions of g 1 3 through eqs 3 5 however the deduction of g 4 along with g 2 is a little complex partial integration of the integral from g r f yields the relation 35 g r f 2 g 1 2 r 1 5 2 0 k 3 2 sin τ k 1 2 e k cos θ j 1 k sin θ d k 2 g 1 2 r 1 5 2 sin θ k 3 2 sin τ k 1 2 e k cos θ j 0 k sin θ 0 3 2 0 k 1 2 sin τ k 1 2 e k cos θ j 0 k sin θ d k τ 2 0 k cos τ k 1 2 e k cos θ j 0 k sin θ d k cos θ 0 k 3 2 sin τ k 1 2 e k cos θ j 0 k sin θ d k 2 g 1 2 r 1 5 2 sin θ 3 2 im f 1 2 τ 2 re f 1 cos θ im f 3 2 2 g 1 2 r 1 5 2 sin θ 3 2 g 1 τ 2 g 2 cos θ g 3 2 g 1 2 r 1 5 2 g 4 with g 2 re f 1 then eq 6 is entirely obtained 
22913,efficient evaluation of the transient free surface green function with sufficient accuracy is the key to employ time domain panel method in solving hydrodynamic problems in this paper series and asymptotic expansions for the green function and its two spatial derivatives are deduced in detail for the evaluation new residual functions are derived straightforwardly from the resulted asymptotic formulas and it is concluded that the present residual functions decay rapidly than existing choices the ultimate algorithm is the combination of chebyshev approximations and asymptotic expressions along with a special partitioning line introduced to speed up the evaluation after comprehensive numerical validation it is pointed out that the present algorithm owns at least 6 digits of accuracy and sufficient efficiency for practical application any efficient method for evaluating the green function will use the asymptotic expansions furthermore it should be pointed out that the present residual functions can also be conveniently applied to the scheme of interpolation in a precomputed table keywords the transient green function new residual functions asymptotic expansions chebyshev approximations marine hydrodynamic 1 introduction in recent years the nonlinear seakeeping and wave load analysis in time domain is urgently needed for ship design purpose the methods based on potential flow theory are attractive and necessary as they are much more efficient to implement than cfd codes whether the program is developed with the so called hybrid method zhang et al 1998 yasukawa 2003 kataoka and iwashita 2004 liu and papanikolaou 2011 tang et al 2014 or the direct free surface green function method bingham et al 1993 sen 2002 datta et al 2011 walree 2014 the calculation of the transient free surface green function always plays an important role in these efficient implementations for the evaluation of the transient green function a number of papers have appeared over the years except for the inefficient scheme of direct numerical integration and analytic expansions liapis 1986 king 1987 there are mainly other three numerical schemes a the interpolation in a precomputed table b the polynomial approximations c the solution to a fourth order ordinary differential equation ode as to a and b efficient calculations of green function are generally divided into two parts those are evaluations of a relatively simple expression with high oscillation called the subtraction function and a slow varying residual function beck 1994 and huang 1992 individually developed the method with the interpolation in a table the selected subtraction function by beck 1994 was a combination of bessel functions which inevitably introduced extra computational time due to these special functions although huang 1992 chose simpler formulae sine function was not involved in the subtraction function and consequently the important role of sine function in effectively reducing the oscillation of residual functions was ignored in addition newman 1992 and lin and yue 1990 presented methods for the green function with polynomial approximations and newman extended his method to the case of finite depth however the derivation of subtraction functions for the spatial derivatives were not explicit which makes the direct use of these method inconvenient for the first time clement 1998 observes that the transient green function is the solution of a fourth order ode which was envisioned as an alternative means for numerical evaluations then subsequent progresses using this philosophy were presented in these papers li et al 2015 duan and dai 2001 zhu et al 2007 chuang et al 2007 among which the difference was the adopted solution to this ode in 2016 after a representative test case of the relative efficiency bingham 2016 concluded that the polynomial approximation method from newman 1992 was much more efficient than these ode based methods therefore in view of the computational efficiency of green function the schemes a and b will be a better choice meanwhile we also need know that the success of these schemes mainly rely on whether the residual functions are slowly varying enough furthermore considering the very large tables required in the interpolation method ranging from 64 000 to 2 000 000 entries beck 1994 and the computational efficiency inherent in the minimax polynomial approximations this paper will use the scheme of the polynomial approximations to evaluate the green function and its derivatives the objective of this paper is to seek efficient and practical solutions to the transient green function in time domain water wave interactions analytic expansions for both the green function and its two spatial derivatives has been put forward these expansions consist of the series expansions at small time and the asymptotic expansions at large time the new slow varying residual functions are derived straightforwardly from the asymptotic results for the first time subsequently the efficient algorithm is developed by combing the polynomial approximations with the asymptotic expansions a special partitioning line is introduced to speed up the evaluation for large time regions after well designed numerical validation we conclude that the algorithm has at least 6 digits of accuracy and sufficient efficiency for practical application 2 the analytic expansions of the green function 2 1 the green function and its spatial derivatives considering a field point p x y z and a source point q ξ η ζ in the earth fixed coordinate the infinite depth transient green function is given by 1 g p q t δ t 1 r 1 r 1 h t g f p q t t 0 where δ t is the dirac delta function and h t the heaviside step function here 2 g f r z t 2 0 g k sin t g k e k z j 0 k r d k with r x ξ 2 y η 2 z z ζ r r 2 z ζ 2 r 1 r 2 z ζ 2 after using spherical coordinates with z ζ r 1 cos θ r r 1 sin θ the nondimensional time τ t g r 1 1 2 and the substitution k r 1 k the wave part of green function g f and its spatial derivatives g r f g z f can be written with only two variables θ and τ 3 g f 2 g 1 2 r 1 3 2 0 k 1 2 sin τ k 1 2 e k cos θ j 0 k sin θ d k g r f 2 g 1 2 r 1 5 2 0 k 3 2 sin τ k 1 2 e k cos θ j 1 k sin θ d k g z f 2 g 1 2 r 1 5 2 0 k 3 2 sin τ k 1 2 e k cos θ j 0 k sin θ d k introducing the auxiliary function f p for eq 3 4 f p 0 k p exp i τ k 1 2 k cos θ j 0 k sin θ d k thus 5 g f 2 g 1 2 r 1 3 2 g 1 g r f 2 g 1 2 r 1 5 2 g 4 g z f 2 g 1 2 r 1 5 2 g 3 with 6 g 1 i m f 1 2 g 2 r e f 1 g 3 i m f 3 2 g 4 3 2 g 1 τ 2 g 2 cos θ g 3 sin θ sin θ 0 the objective is to evaluate g i i 1 2 3 or f p p 1 2 1 3 2 in the computational domain 0 τ 0 θ π 2 now a set of analytic expansions will be derived in section 2 2 and 2 3 which is the prerequisite to develop the corresponding numerical approximations 2 2 series expansions for small values of τ for small values of τ after making the taylor expansion in τ 0 to exp i τ k 1 2 of f p and using the properties of gamma function γ and legendre polynomial p v gradshteyn and ryzhik 1980 the uniformly convergent expansion is given by 7 f p n 0 i τ n n γ n 2 p 1 p n 2 p cos θ substitution of eq 7 in eq 6 gives the desired series expansions 8 g 1 m 0 1 m τ 2 m 1 m 1 2 m 1 p m 1 cos θ g 2 m 0 1 m τ 2 m m 1 2 m p m 1 cos θ g 3 m 0 1 m τ 2 m 1 m 2 2 m 1 p m 2 cos θ 2 3 asymptotic expansions for large values of τ for large values of τ we rearrange the integral of f p with the substitution of k ω 2 and then decompose the integral in the form newman 1992 9 f p 2 0 ω 2 p 1 e i τ ω ω 2 cos θ j 0 ω 2 sin θ d ω f 0 p f 1 p f 2 p with 10 f 0 p 2 0 i τ 2 ω 2 p 1 e i ω τ ω 2 cos θ j 0 ω 2 sin θ d ω f 1 2 p i τ 2 ω 2 p 1 e i ω τ ω 2 cos θ h 0 1 2 ω 2 sin θ d ω h 0 1 2 is the hankel function j 0 iy 0 with the following expressions 11 h 0 1 2 ω 2 sin θ e i ω 2 sin θ π 4 2 π ω 2 sin θ n 0 c n i ω 2 sin θ n where c n γ n 1 2 2 π 2 n n for f 0 p the integral can be expanded by using the partial integration and the relationship of bessel function and legendre polynomial with the desired result 12 f 0 p 2 i 2 p 2 n 0 2 n 2 p 1 τ 2 n 2 p 2 n p n cos θ for f 1 2 p newman 1992 has observed that the integral f 1 p can be ignored by use of stationary phase method similarly then the rearranged f 2 p is explicitly given by 13 f 2 p 2 2 π sin θ e 1 4 τ 2 e i θ i θ 2 i π 4 n 0 c n i n ω 2 p 2 n 1 sin n θ i ν with 14 i ν e 1 4 τ 2 ν 2 1 i e i θ 2 ν 2 p 2 n d ν for the case of 2 p 2 n 0 applying the binomial theorem to eq 14 gets sun 2009 15 i ν k 0 c 2 p 2 n k i k e i k θ 2 e 1 4 τ 2 ν 2 ν k d ν when k 2 m 1 we get i ν 0 since the integrand is an odd function for k 2 m the following formulation is obtained 16 i ν m 0 c 2 p 2 n 2 m e i m θ 2 τ m 1 γ 1 m 2 substituting eq 16 into eq 13 thus 17 f 2 p 2 2 sin θ e τ 2 cos θ 4 n 0 1 sin n θ m 0 d n m 0 e i θ n m 2 τ 2 m 2 n 2 p with 18 θ n m τ 2 4 s i n θ p m n 2 1 4 π m 2 n 2 p 1 2 θ d n m 0 c n 2 p 2 n 2 p 2 m 2 n 2 2 m m 2 p 2 n 0 for the other case of 2 p 2 n 0 the auxiliary function f ν is given by 19 f ν 1 i e i θ 2 ν 2 p 2 n making the taylor expansion in ν 0 gets 20 f ν k 0 f k 0 n ν k when k 2 m 1 i ν of eq 14 can be ignored due to the odd function f ν whereas when k 2 m i ν can be rearranged by removing the odd terms 21 i ν e 1 4 τ 2 ν 2 1 i e i θ 2 ν 2 p 2 n d ν e 1 4 τ 2 ν 2 m 0 f 2 m 0 n ν 2 m d ν with 22 f 2 m 0 i 2 m e i m θ 2 m 2 n 2 p 1 2 n 2 p 1 substituting eq 22 into eq 21 thus 23 i ν m 0 i 2 m e i m θ 2 m 2 n 2 p 1 2 n 2 p 1 i ν ν with 24 i ν ν e 1 4 τ 2 ν 2 ν 2 m d ν we rearrange i ν ν with the substitution of x τ ν 2 25 i ν ν 2 τ 2 m 1 e x 2 x 2 m d x 2 τ 2 m 1 i x x after integrating term by term i x x becomes 26 i x x e x 2 x 2 m d x 2 m 1 2 m 3 2 m 2 m 1 2 m e x 2 d x 2 m 2 2 m m π substituting eq 25 eq 26 and eq 23 into eq 13 gets the analogical formulation as eq 17 27 f 2 p 2 2 sin θ e τ 2 4 cos θ n 0 1 sin n θ m 0 d n m 0 e i θ n m 2 τ 2 m 2 n 2 p with the same θ n m as eq 18 and 28 d n m 0 c n 2 m 2 n 2 p 1 2 n 2 p 1 2 2 m m 2 p 2 n 0 in conclusion for large values of τ we get the unified expressions of f 2 p 29 f 2 p a b n 0 1 sin n θ m 0 d n m e i θ n m 2 τ 2 m 2 n 2 p with a 2 2 sin θ 1 2 b exp τ 2 cos θ 4 and 30 d n m c n 2 p 2 n 2 p 2 m 2 n 2 2 m m 2 p 2 n 0 c n 2 m 2 n 2 p 1 2 n 2 p 1 2 2 m m 2 p 2 n 0 3 the combination of chebyshev polynomials and asymptotic expansions without considering the efficiency the series expansions g i in 8 asymptotic expansions f 0 p in 12 and f 2 p in 29 can be used to yield any desired degree of accuracy see fig 1 additionally to achieve 6d accuracy the expansions f 0 p and f 2 p usually work effectively at τ 12 with the truncated number n of f 0 p and n m of f 2 p not more than 3 and 4 2 respectively however the expansion g i in 8 always needs a truncated order m of at least 80 at 10 τ 12 and this is too large for the effective use therefore for the case of 0 τ 12 we use the philosophy of the residual function inspired from newman 1985a 1985b 1992 instead of using the series expansions 8 this philosophy mainly relies on the extent to which the obtained residual functions in each region are slowly varying then the next objective is to obtain the residual functions and the related regions 3 1 reasonable selection of the residual functions the results of g i are outlined in fig 2 4 with the inefficient method a1 see fig 1 it is clearly shown that g i has high frequency oscillation with increasing amplitude when cos θ is near zero but has slow varying extent in most of rest region any kind of efficient scheme will not be adopted in a straightforward manner to approximate g i for the region of cos θ near zero however that scheme may be useful for the slow varying region of cos θ 0 4 therefore special attention should be given only to the rest region of 0 cos θ 0 4 in other words we need to obtain the subtraction part from g i for efficient approximations in this respect the analytic expansions already obtained in section 2 are essential the asymptotic result f 2 p includes not only the explicit formulation 2 2 sin θ 1 2 exp τ 2 cos θ 4 but also the oscillating cosine or sine function inherent in exp i θ n m f 2 p has these advantages over g i in 8 and f 0 p accordingly it is used to obtain the subtraction functions after substituting p 1 2 1 3 2 into 29 and specifying the first few items we get 31 f 2 1 2 a b τ a 31 2 n 1 1 sin n θ m 0 d n m e i θ n m 2 τ 2 m 2 n 1 f 2 1 a b a 1 8 sin θ τ 2 a 51 4 a 32 2 n 2 1 sin n θ m 0 d n m e i θ n m 2 τ 2 m 2 n 2 f 2 3 2 a b 3 τ a 52 4 τ 3 a 7 8 τ a 33 16 sin θ n 2 1 sin n θ m 0 d n m e i θ n m 2 τ 2 m 2 n 3 here 32 a 1 cos π 4 θ 2 c a 31 sin 3 π 4 3 θ 2 c a 32 cos π 4 3 θ 2 c a 33 sin π 4 3 θ 2 c a 51 cos π 4 5 θ 2 c a 52 sin π 4 5 θ 2 c a 7 s i n π 4 7 θ 2 c with c τ 2 sin θ 4 therefore the residual functions g i for g i are derived from 31 and explicitly given for regions of 0 cos θ 0 4 and 0 τ 12 33 g 1 g 1 a b τ a 31 2 g 2 g 2 a b a 1 8 sin θ τ 2 a 51 4 a 32 2 g 3 g 3 a b 3 τ a 52 4 τ 3 a 7 8 τ a 33 16 sin θ the present residual function and the two existing choices from huang 1992 and beck 1994 are listed as 34 g 1 present g 1 τ b 2 sin θ sin 3 π 4 3 θ 2 τ 2 sin θ 4 g 1 huang g 1 τ b 2 sin τ 2 4 g 1 beck g 1 π τ 3 b 16 2 j 1 4 τ 2 8 j 1 4 τ 2 8 j 3 4 τ 2 8 j 3 4 τ 2 8 the g 1 huang does not contain sin θ but our numerical test observes that sin θ is essential to effectively slowdown the oscillation the g 1 beck derived from wehausen and laitone 1960 is a combination of products of bessel functions which inevitably introduced the unwanted computational time the oscillations of these three kinds of results can be founded in fig 5 the oscillation trend is much higher for the yellow surface g 1 huang and the grey surface g 1 beck than the blue one g 1 present more clearly the extracted special cases see fig 6 show that g 1 present is indeed the most slow varying this means compared with the other two the present one will need fewer terms of polynomial or interpolation coefficients to obtain the same numerical accuracy in addition although the residual functions of g 2 and g 3 are not showed in huang 1992 and beck 1994 we believe that the same conclusion will be made to these two cases comparing fig 5 and 6 with fig 2 indicates that the amplitude of the residual functions is reduced significantly and more importantly the residual function decays rapidly all these make the effective use of polynomial approximations possible 3 2 the algorithm combined with chebyshev approximations and asymptotic expansions for the case of 0 τ 12 the algorithm with chebyshev approximations is used at first g i in eq 33 is evaluated by the above mentioned a1 with at least 10d accuracy then g i is approximated by the two dimensional chebyshev polynomials although g i has the respective oscillation numerical computations suggest that the following partitions are applicable to these three cases with τ 0 0 5 10 5 10 92 11 2 11 48 11 75 12 0 and cos θ 0 0 1 1 0 finally we subdivided the τ cos θ domain into 26 10 260 rectangles economized chebyshev coefficients are obtained to guarantee an accuracy of 6d the truncated number of each coefficients matrix varies from 4 up to 45 now taking the region 0 τ 0 5 0 cosθ 0 1 as example the resulted coefficients are illustrated in tables 1 3 in which n 1 and n 2 is the economized coefficient order the coefficient matrix for g 1 g 2 and g 3 does not have the same elements and that is quite different from the frequency domain case shan 2018 moreover for the expressions in detail of the chebyshev approximation please refer to shan 2018 in which this scheme is similarly adopted to the frequency domain green function in infinite depth for the other case of τ 12 the algorithm with the asymptotic expansions is used numerical experimentations confirm that when τ 3 cos θ 0 01 10 only the solution of f 0 p can even obtain sufficient accuracy since in this case f 2 p is usually less than 10 6 huang 1992 using this partitioning line can certainly speed up the evaluation for the large time regions furthermore the appropriate truncated number n of f 0 p and n m of f 2 p have been chosen respectively according to different regions ultimately the efficient algorithm for g i i 1 2 3 is showed in fig 7 it should point out that when cos θ is near zero the chebyshev coefficients and the truncated terms of asymptotic expansions should be carefully selected to ensure the 6d accuracy 4 the validation of numerical accuracy and efficiency 4 1 the numerical accuracy the numerical error is validated by a 2 a 1 which means the absolute value of results from a2 subtracted by those from a1 the number of calculation point along τ and cos θ is 1201 and 101 respectively for both small and large τ regions the error for small τ region 0 τ 12 is shown in fig 8 it can be clearly found that the different rectangular subdomain has different error distribution due to the individual truncated chebyshev coefficients the chosen partitions along τ and cos θ works well for these three function the evaluation of every single point can maintain 6d accuracy and even almost half of calculation domain has at least 7d accuracy fig 9 illustrates the error distribution of large τ region 12 τ 24 because this region is straightforwardly evaluated by the use of the asymptotic expansions there is not so many subdomains as the small τ region it also can be clearly observed that the evaluation of every single point has at least 6d accuracy and most of region has 7d accuracy the same conclusion can be made in the larger τ region of τ 24 to avoid repetition it is not described here 4 2 the numerical efficiency to evaluate the efficiency of this algorithm calculations of the green function and its two derivatives in different region are implemented with the same number of calculation point that is 10000 calculation points along τ and 1000 points along cos θ respectively 107 points totally all the calculations are run on a personal computer with an intel core i7 4790 with cpu clock of 3 6 ghz from fig 10 we find the consumed time of one single point for 0 τ 12 is only about 0 4 μs and the efficiency of asymptotic expansion for τ 12 is even several times higher than that of polynomial approximation for 0 τ 12 moreover the efficiency is becoming higher with the increase of τ that is to say an efficient method for evaluating the green function needs adopt the asymptotic expansions at large time fig 11 shows the consumed time of the region near cos θ 0 is more than that near cos θ 1 since the former has more terms of chebyshev coefficients and that is also a natural consequence of varying trend of the residual function 5 conclusion a complete set of formulae for the green function and its two spatial derivatives are presented detailedly in this paper the new residual functions are obtained directly from the asymptotic expressions and the new one decays faster than the other two existing choices the successive algorithm is developed by combing the chebyshev polynomial approximations with the asymptotic results it is concluded that the present method is shown to be with at least 6d of accuracy and high efficiency for practical application moreover any efficient method for evaluating the green function will use the asymptotic expansions at last it should be pointed out that the present residual functions can also be conveniently applied to the scheme of interpolation in a precomputed table acknowledge this work has been financially supported by the miit high tech ship research projects project no 2016 25 k24333 and by national natural science foundation of china nsfc grant no 51479117 51579147 appendix a the deduction of eq 6 it is straightforward to obtain the expressions of g 1 3 through eqs 3 5 however the deduction of g 4 along with g 2 is a little complex partial integration of the integral from g r f yields the relation 35 g r f 2 g 1 2 r 1 5 2 0 k 3 2 sin τ k 1 2 e k cos θ j 1 k sin θ d k 2 g 1 2 r 1 5 2 sin θ k 3 2 sin τ k 1 2 e k cos θ j 0 k sin θ 0 3 2 0 k 1 2 sin τ k 1 2 e k cos θ j 0 k sin θ d k τ 2 0 k cos τ k 1 2 e k cos θ j 0 k sin θ d k cos θ 0 k 3 2 sin τ k 1 2 e k cos θ j 0 k sin θ d k 2 g 1 2 r 1 5 2 sin θ 3 2 im f 1 2 τ 2 re f 1 cos θ im f 3 2 2 g 1 2 r 1 5 2 sin θ 3 2 g 1 τ 2 g 2 cos θ g 3 2 g 1 2 r 1 5 2 g 4 with g 2 re f 1 then eq 6 is entirely obtained 
22914,the problem of a dam break flow induced front wave impacting a vertical wall placed at the downstream end was numerically investigated by using the level set ls method and coupled level set volume of fluid clsvof method for the ls approach the advection equation of the level set function to capture the interface is discretized by the fifth order weighted essentially non oscillatory weno5 scheme for the clsvof approach the tangent of hyperbola for interface capturing weighed line interface calculation thinc wlic scheme is adopted to capture the interface and improve mass conservation the interface normal vector in the wlic reconstruction procedure can be estimated from the ls function instead of vof function the navier stokes solver which uses an explicit adams bashforth algorithm is performed on a staggered eulerian grid the numerical experiments are carried out in a rectangular flume with a smooth horizontal wet bed with four different tailwater levels this study investigates the formation and propagation of the negative wave resulting from the reflection of flood waves against the downstream end wall the numerical results are compared with laboratory experiment results studied in ref kocaman and ozmen cagatay 2015 and a reasonable agreement is achieved numerical results show that the clsvof solutions are better than ls solutions in terms of mass conservation keywords level set method clsvof dam break thinc wlic 1 introduction dam break has been the focus of many researches since the last century because of the strong nonlinear and unsteady flows it produces which can cause catastrophic damages for example urban areas or farmlands downstream of the river channel can be dramatically destroyed kocaman and ozmen cagatay 2015 francesca et al 2015 if a dam suddenly breaks any structure such as breakwater or bridge located downstream of the flow will act as a vertical wall which can generate front wave reflection against these structures with high velocity towards the dam axis and propagating along the negative direction visscher and hager 1998 wet bed depth of the front wave is an important factor to be determined for dam break induced flood understanding such dramatic flow behavior such as tsunami wave by experimental or numerical simulation is essential yang et al 2018a so as to reduce human life or property losses as well as to guide engineering applications kocaman and ozmen cagatay discussed the effect of lateral channel contraction by investigating dam break flow in a channel with lateral contraction they compared their experiment results against those of reynolds averaged navier stokes equations rans based numerical simulation ozmen cagatay and kocaman 2012 in recent decades numerical approaches have also been widely adopted to investigate dam break induced nonlinear flows for example it is widely accepted that 1 d unsteady water flow is governed by the shallow water or saint venant equations garcia navarro et al 1999 it is also worth mentioning that numerical models based on depth averaged two dimensional 2 d shallow water equations swes have been widely adopted in dam break flow investigation in the past few years brufau and garcia navarro 2000 marras et al 2018 cozzolino et al 2018 hu et al 2015 this model is regarded as a suitable mathematical formulation to describe dam break flows in realistic open channels due to its less computational cost brufau and garcia navarro 2000 to further reduce the computational cost high performance calculations are used to simulate dam break events in ref zhang et al 2014 the 2 d swes and rans with the κ ε turbulence model are compared for dam break flow impacting a vertical wall kocaman and ozmen cagatay 2015 comparison with experiment results shows that rans solutions are better than swes solutions because swes are derived from depth integrating the 3 d continuity and momentum equations the 2 d dam break models cannot be used to simulate flows with significant variations in the vertical direction in addition swes based models fail to accurately reflect the actual situation due to its hypothesis and deficiency especially during the initial stage kocaman and ozmen cagatay 2015 hence in comparison with the 1 d and 2 d shallow water equations numerical models based on three dimensional navier stokes equation 3d nses have been more widely adopted for dam break induced flow simulation park et al 2012 celis et al 2017 yang et al 2018b present methods that can be used to deal with two phase problems can be generally divided into two categories lagrangian methods and eulerian methods lagrangian methods such as moving particle semi implicit mps zhang and wan 2014 ng et al 2015 shakibaeinia and jin 2011 and smoothed particle hydrodynamics sph nomeritaeedoardo et al 2016 fourtakas and rogers 2016 are well known for their remarkable advantage in dealing with interface deformation and fragmentation in eulerian methods the flow equations are solved in an eulerian mesh grid overlaid on a flow domain of interest there have been eulerian methods that can accurately solve free surface deformation such as volume of fluid vof method hirt and nichols 1981 ye and zhao 2017 and level set ls method osher and fedkiw 2001 2003 the vof method was proposed by hirt and nichols hirt and nichols 1981 it was adopted in free surface numerical modeling and was paid much attention to in the field of hydrodynamics in recent years due to its advantage of mass conservation vof methods can be subdivided into geometrical and algebraic methods geometrical vof methods involving geometrical reconstruction known as plic piecewise linear interface calculation parker and youngs 1992 are relatively complicated in terms of programming since it uses a linear approximation to reconstruct the interface with the interface orientation considered different from geometrical vof methods algebraic vof methods do not require any geometrical reconstruction xiao et al 2005 proposed a simple and practical algebraic vof method known as tangent of hyperbola for interface capturing thinc the thinc scheme can calculate the fluid fraction function with less oscillation and smearing which is achieved by computing the numerical flux for the fluid fraction function using the hyperbolic tangent function ref yokoi 2007 has reported a multi dimensional flux approximation using the slic simple line interface calculation reconstruction while at the same time considering the interface orientation which is called vof wlic wlic weighed line interface calculation ref yokoi 2007 proposes an interface orientation dependent weighting between the original thinc scheme xiao et al 2011 and the first order donor cell scheme this scheme significantly improves the geometrical accuracy of the original thinc scheme xiao et al 2011 presented an improved multi dimensional vof method to capture moving interfaces known as thinc sw thinc with slope weighting on the basis of thinc the thinc sw scheme significantly improved accuracy in computing multi dimensional moving interfaces numerical simulation of dam break problems by using vof methods were carried out to investigate nonlinear dam break induced flow behaviors liu et al 2013 marsooli and wu 2014 ls methods have become increasingly popular for simulating moving interfaces in air water two phase flows yang et al 2014 zhu et al 2016 in ls methods the interface between the two phases is defined as the zero contour of a continuous signed distance function this allows the normal and curvature of the interface to be easily obtained besides by means of implementing a high order advection scheme the topology changes can also be easily handled kim and liou 2011 however two issues confront level set based methods the first issue is its numerical dissipation and dispersion which would cause deterioration in predicted level set solutions in some occasions a useful suggestion is to adopt high order schemes such as essentially non oscillatory eno schemes or weighted eno weno based schemes hermann 2005 salih and moulic 2009 the second issue is that a small amount of mass may be gained or lost when the zero level set is altered during the re initialization procedure luo et al 2015 a re initialization step adopted in sussman s research is also suggested for improving the process in which the mass property is corrected by adding an additional mass correction term to the re initialization equation sussman and fatemi 1999 the attractive feature of such an approach is that it conserves the mass bounded by the interface and maintains the level set function as a distance function another reasonable technique is to adopt a hybrid approach namely a coupled level set volume of fluid clsvof method wang and tong 2010 wang et al 2012 balczar et al 2016 yokoi 2013 chakraborty et al 2013 ningegowda and premachandran 2014 sussman and elbridge 2000 the clsvof method combines the advantages of both vof and ls methods which can further improve mass conservation and calculate interface curvature more accurately this coupling method is widely used for high precision simulation such as droplet impacting a dry surface yokoi et al 2009 bubble growth and detachment albadawi et al 2013 and plunging breaking waves koo et al 2012 in the clsvof method developed by sussman and puckett sussman and elbridge 2000 for the computation of 3d and axisymmetric incompressible two phase flows they obtained the surface curvature by finite differences of the level set function which in turn is derived from the level set function and volume of fluid function the clsvof method was also implemented by wang et al 2012 for numerically simulating interfacial flows in ship hydrodynamics their method re distances the level set function using the reconstructed interface with a geometric algorithm and handles interface jump conditions by using a ghost fluid methodology their method was applied in the simulation of a gas bubble rising in a viscous liquid and a water drop impacting onto a deepwater pool sun et al sun and tao 2010 have developed a coupled volume of fluid and level set method which reconstructs the distance function by an iterative algorithm and advects the interface by the vof method two dimensional simulations on rising bubbles and dam break problems are performed to validate their method in this study a clsvof based numerical solver where the interface is presented by the vof function is developed to further investigate the dam break induced free surface behaviors and is compared with the level set method this paper is organized as follows in section 2 governing equations of the two fluids and clsvof method are presented section 3 describes the numerical scheme for ls and vof methods as well as the solution algorithm of navier stokes equation which is solved by using the projection method and direct numerical simulation dns is adopted to handle turbulence flow in section 4 numerical experiments are carried out in a rectangular flume with a smooth horizontal wet bed with different tailwater levels to investigate in detail the formation and propagation of the negative wave towards the upstream direction the numerical results are also compared with laboratory experiment results kocaman and ozmen cagatay 2015 conclusions are drawn in section 5 2 mathematical model 2 1 level set method in level set based methods the interface motion can be tracked by solving the ls evolution equation as follows sussman et al 1994 1 ϕ t u ϕ 0 where ϕ is the level set function which is usually set as a signed distance function d the value of which denoting the distance from a particular spatial point to the interface usually d is defined to be positive for liquid and negative for gas the interface level is always located at zero ψ with the following form 2 ϕ x y z d for x y z in the liquid 0 for x y z ψ d for x y z in the gas the level set function ϕ is no longer a signed distance function as time marches a re initialization process is thus required to keep ϕ as a signed distance function by means of solving the following equation sussman and fatemi 1999 3 ϕ τ s ϕ 0 1 ϕ λ δ ϕ ϕ where τ is the pseudo time for iteration and ϕ 0 is the level set function before re initialization λ and delta function δ ϕ are respectively given as 4 λ ω δ ϕ s ϕ 0 1 ϕ d ω ω δ 2 ϕ ϕ d ω 5 δ ϕ 1 2 ε 1 cos π ϕ ε if ϕ ε 0 otherwise note that s ϕ 0 denotes the smoothed sign function with δ x being the local grid size to smear out the sign function 6 s ϕ 0 2 h ϕ 0 0 5 with 7 h ϕ 0 if ϕ ε 1 2 1 ϕ ε 1 π sin π ϕ ε if ϕ ε 1 if ϕ ε where ε 1 5 δ x is chosen in this study 2 2 volume of fluid method the characteristic function χ is adopted in vof method and is passively advected owing to its zero substantial derivative with the following form yokoi 2007 8 χ t u χ χ u 0 with 9 χ x y z 1 for x y z in the liquid 0 for x y z in the gas the fraction function c as an integral of the phase s characteristic function χ is used 10 c i j k 1 δ x δ y δ z 0 δ x 0 δ y 0 δ z χ x y z d x d y d z because the characteristic function χ is discontinuous equation 8 cannot be directly solved using χ concept it is therefore necessary to use flux expressions the volume averaged characteristic function c namely the vof function is calculated by the flux formulation in the form of 11 c i j k a c i j k n f x i 1 2 j k n f x i 1 2 j k n δ x c i j k n u x i 1 2 j k u x i 1 2 j k δ x δ t 12 c i j k b c i j k a f y i j 1 2 k f y i j 1 2 k δ y c i j k n u y i j 1 2 k u y i j 1 2 k δ y δ t 13 c i j k n 1 c i j k b f z i j k 1 2 f z i j k 1 2 δ z c i j k n u z i j k 1 2 u z i j k 1 2 δ z δ t where f x i 1 2 j k f y i j 1 2 k and f z i j k 1 2 are the flux given below 14 f x i 1 2 j k z i j k 1 2 z i j k 1 2 y i j 1 2 k y i j 1 2 k x i 1 2 j k x i 1 2 j k u x i 1 2 j k δ t χ i s j k x y z d x d y d z 15 f y i j 1 2 k z i j k 1 2 z i j k 1 2 y i j 1 2 k y i j 1 2 k u y i j 1 2 k δ t x i 1 2 j k x i 1 2 j k χ i j s k x y z d x d y d z 16 f z i j k 1 2 z i j k 1 2 z i j k 1 2 u z i j k 1 2 δ t y i j 1 2 k y i j 1 2 k x i 1 2 j k x i 1 2 j k χ i j k s x y z d x d y d z the subscripts i s j s and k s in eq 14 eq 15 and eq 16 are 17 i s i if u x i 1 2 j k 0 i 1 if u x i 1 2 j k 0 18 j s j if u y i j 1 2 k 0 j 1 if u y i j 1 2 k 0 and 19 k s k if u z i j k 1 2 0 k 1 if u z i j k 1 2 0 the order of sweep direction of eqs 14 16 is altered at every time step to minimize the error by dimensional splitting 2 3 coupled level set and volume of fluid clsvof method although the vof method can well conserve mass it has difficulties in capturing geometric properties of the interface in the ls method however geometric properties of the interface can be easily described by using a continuous level set function ϕ which on the other hand does not guarantee mass conservation we are thus motivated to couple the vof method and the ls method to achieve both mass conservation and accurate geometry description this is achieved in the proposed clsvof method the clsvof algorithm is shown as follows image 1 in the above clsvof algorithm the governing equations of the level set function ϕ and volume fraction c are solved from t n to t n 1 from step 1 and step 2 so that ϕ and c are advected interface reconstruction of step 3 is required to ensure that the predicted interfaces from ϕ and c are close to each other an intermediate function ψ 2 c n 1 1 is introduced in the reconstruction procedure whose isoline ψ 0 indicates the position of the interface which is identical to that indicated by c n 1 1 2 then step 3 2 is performed until ψ reaches a steady state solution at the interface which is exactly the value of ψ at the interface following this step we perform step 3 3 to construct another intermediate level set function ϕ n 1 from ϕ n 1 and ψ n 1 to ensure that ϕ n 1 and c n 1 indicate the same interface position step 3 4 is performed until a steady state solution ϕ n 1 is reached to eliminate the discontinuity at ϕ n 1 ε 2 4 navier stokes equations and physical properties the two immiscible e g water and air incompressible viscous flows are governed by the navier stokes equations 20 u 0 21 u t u u 1 ρ p 1 ρ 2 μ d g where u is the velocity vector t is the time p is the pressure d u u t is the deformation tensor and g represents the gravitational acceleration each phase of density and viscosity shown in eq 21 can be defined by the vof function ρ ρ a ρ w ρ a c 22 μ μ a μ w μ a c where ρ a and ρ w represent the air and water density respectively in fact the turbulence model should be implemented in this study for high reynolds number dam break flow problems however the qualities such as front wave and tailwater levels can be calculated accurately using the present direct numerical simulation dns model compared with experiment studies we will further consider the turbulence model such as large eddy simulation les in the two phase flow system we have added corresponding illustration for les in the appendix 3 numerical scheme dam break flow impacting a vertical wall is investigated numerically using a uniform staggered cartesian grid system the variable arrangement is as follows the velocity components are located at cell faces while density ρ viscosity μ pressure p level set function ϕ and vof function c are defined at cell centers 3 1 level set method solver the level set evolution equation i e eq 1 can be expressed in the following conservative form 23 ϕ t u ϕ 0 eq 23 leads to an ordinary differential equation ode with a semi discrete conservative finite difference scheme 24 d ϕ i j k d t l ϕ i j k 1 δ x f ˆ i 1 2 j k f ˆ i 1 2 j k 1 δ y g ˆ i j 1 2 k g ˆ i j 1 2 k 1 δ z h ˆ i j k 1 2 h ˆ i j k 1 2 where f ˆ i 1 2 j k g ˆ i j 1 2 k h ˆ i j k 1 2 are the approximation of the numerical fluxes at point x i 1 2 j k y i j 1 2 k z i j k 1 2 respectively which can be reconstructed from the discrete values of f u ϕ g v ϕ and h w ϕ the numerical fluxes at cell faces are reconstructed using an interpolation based on the idea of a fifth order weno weno scheme jiang and shu 1996 similarly the re initialization equation 3 in 3 d cases can be expressed in a semi discrete form 25 d ϕ d t h g ϕ x ϕ x ϕ y ϕ y ϕ z ϕ z 0 where h g is the godunov hamiltonian the spatial discretization ϕ x i j k left biased stencil from i 3 to i 2 and ϕ x i j k right biased stencil from i 2 to i 3 in eq 3 can be evaluated similarly as done in the evolution equation by weno5 scheme with local lax friedrichs llf flux splitting method jiang and peng 2000 the third order total variation diminishing runge kutta tvd rk3 scheme is used for time advancement shu 1988 3 2 volume of fluid vof solver 3 2 1 weighed linear interface calculation wlic the wlic method was published by yokoi 2007 following the idea of simple linear interface calculation slic method we define the horizontal interface interface consisting of x coordinate and y coordinate and vertical interface consisting of x coordinate and z coordinate consisting of y coordinate and z coordinate the weights of the interfaces are calculated from the surface normal n χ i j k x y z ω x i j k n i j k χ x i j k x y z ω y i j k n i j k χ y i j k x y z 26 ω z i j k n i j k χ z i j k x y z where n i j k is the local normal vector and χ x i j k x y z χ y i j k x y z and χ z i j k x y z are the characteristic functions of the vertical interface and horizontal interface respectively ω x i j k ω y i j k and ω z i j k in eq 26 are weighting functions the weighting function ω x i j k for x component used in eq 26 is randomly chosen and the three available choices are listed in table 1 aniszewski et al 2014 discontinuity of the spatial derivatives of vof function near the interface can lead to inaccuracy of the geometric properties the calculation of ω x i j k ω y i j k and ω z i j k presented in this study employs the signed distance function of ls method for example we calculate the weighting function ω ξ i j k ξ x y z by the following equation 27 ω ξ i j k n ξ i j k n x i j k n y i j k n z i j k where n ξ i j k ϕ ξ ϕ x 2 ϕ y 2 ϕ z 2 3 2 2 thinc wlic scheme the flux f x x in eq 34 is calculated using a one dimensional thinc scheme the piecewise modified hyperbolic tangent function 28 χ x i 1 2 1 α x tanh β x x i 1 2 δ x x i is used as the characteristic function where α x and β represent the interface direction and smoothness respectively α x is given as 29 α x 1 i f n x i 0 1 i f n x i 0 where n x i c i 1 c i 1 is used in this study β 3 5 is chosen which is equal to one mesh spacing smoothing x i δ x indicates the distance between x i 1 2 and the interface and denotes the position of the interface x i is calculated by cell averaging χ i as follows 30 1 δ x x i 1 2 x i 1 2 χ i x x i d x c i n the formulation f x i 1 2 j k f y i j 1 2 k and f z i j k 1 2 in eqs 14 16 can be generalized to three dimensional cases using the thinc wlic method as follows 31 f x i 1 2 j k f x i 1 2 f x x i 1 2 f x y i 1 2 f x z i 1 2 32 f y i j 1 2 k f y j 1 2 f y x j 1 2 f y y j 1 2 f y z j 1 2 33 f z i j k 1 2 f z k 1 2 f z x k 1 2 f z y k 1 2 f z z k 1 2 with 34 f ξ ξ m 1 2 ξ m 1 2 ξ m 1 2 u m 1 2 δ t ω ξ m s χ ξ m s d ξ 35 χ ξ m s 1 2 1 α ξ tanh β ξ ξ m s 1 2 δ ξ ξ m s 36 α ξ 1 i f n ξ m s 0 1 i f n ξ m s 0 37 m s m i f u ξ m 1 2 0 m 1 i f u ξ m 1 2 0 the weights ω ξ m in eq 34 for x component i e ξ x and m i are calculated by 38 ω ξ m ω ξ m j k ω x i j k n x i j k n x i j k n y i j k n z i j k note that n x i j k in eq 38 is the normal vector for x component and can be calculated by level set function ϕ 39 n x i j k ϕ x ϕ x 2 ϕ y 2 ϕ z 2 the first derivative terms ϕ x ϕ y ϕ z are approximated by second order centered difference scheme n y i j k and n z i j k can also be calculated in the same way described in eq 39 for convenience we rewrite eqs 31 33 as follows 40 f x i 1 2 f x x i 1 2 f x v i 1 2 41 f y j 1 2 f y y j 1 2 f y v j 1 2 42 f z k 1 2 f z z k 1 2 f z v k 1 2 where the flux f ξ v m 1 2 in eqs 31 33 can be expressed in terms of the vertical surface for the flux direction for instance f x v f x y f x z the flux f ξ v m 1 2 is calculated as follows 43 f ξ v m 1 2 1 ω ξ m s c m s u ξ m 1 2 δ t 3 3 navier stokes equation solver 3 3 1 momentum equation solver the second order upwinding scheme is used for the convective terms in eq 21 in the x direction momentum equation using u u x as an example the discretization can be approximated as 44 u u x 1 2 δ x u 3 u i j k 4 u i 1 j k u i 2 j k u u i 2 j k 4 u i 1 j k 3 u i j k where u 1 2 u i j k u i j k and u 1 2 u i j k u i j k for the diffusion terms in eq 21 second order central difference scheme is used 3 3 2 projection method given u n and f n the second order adams bashforth scheme is used for time advancement and is written as follows 45 u n 1 u n δ t 3 2 a n 1 2 a n 1 1 ρ p n 1 2 0 where a denotes 46 a u u 1 ρ μ u u t g by using the continuity equation and the divergence operator in eq 45 the poisson equation for p n 1 2 can be derived as 47 1 ρ p n 1 2 u n δ t 3 2 a n 1 2 a n 1 note that p n 1 2 must satisfy the neumann boundary condition at all walls shown below 48 p n 1 2 n f n u n 1 u n δ t we then discretize eq 47 as 49 a p i 1 j k b p i 1 j k c p i j k d p i j 1 k e p i j 1 k f p i j k 1 g p i j k 1 r h s i j k a point successive over relaxation psor method is used for the above tridiagonal and sparse matrix of pressure the convergence tolerance ε 10 4 is used for the solutions calculated from two consecutive iterations p m 1 p m where m is the iteration counter using the projection method to solve navier stoke equations along with the psor method for the pressure poisson equation ensures a second order accuracy in both time and space o δ t 2 δ x 2 which may be critical for the accuracy in capturing free interfaces 3 3 3 solution algorithm the numerical algorithm which combines clsvof and the projection method is shown as follows image 2 4 numerical verification and investigation for dam break with tail water level in this section dam break problems with large density variation across the interface are investigated with different tailwater levels in order to justify the ls and the present clsvof solver 4 1 parameters and setting of numerical simulations we choose a typical model experiment for comparison kocaman and ozmen cagatay 2015 as shown in fig 1 the experiment domain is 8 90 m long 0 30 m wide and 0 30 m high and six probes p 1 p 6 are located along the channel the gate is located between the reservoir and the tailwater a still water body which is 4 65 m long 0 30 m wide and 0 25 m high is initially placed in the reservoir in the model experiment a 4 25 m long water body is adopted two water depths 0 025 m and 0 01 m are utilized to investigate the tailwater level effect on dam break front waves corresponding to the water depth ratio of α 0 1 and α 0 4 respectively once the gate is removed the initial reservoir water mixes with the tailwater under the effect of gravity and in the meantime the tailwater resisted the drag force kocaman and ozmen cagatay 2015 both upstream and downstream boundaries are set as wall i e u v w 0 since no flow enters into the reservoir and the downstream end is closed by a vertical steel gate the boundary conditions of channel sidewall are also set as wall the computational domain is subdivided into a mesh of fixed rectangular cells using cartesian coordinates 4 2 mesh convergence study for ls and clsvof methods this section presents the mesh convergence study where the tailwater level for probe p 2 with α 0 4 is calculated fig 2 shows the temporal evolution of water level calculated in grid intervals 10 m m and 20 m m using ls and clsvof methods in fig 2 time t is multiplied by g h 0 0 5 to get dimensionless time t where g is the acceleration of gravity the water levels for both methods in finer grid interval 10 m m agree quite well with the experiment results in ref kocaman and ozmen cagatay 2015 it is also observed that the water level results by using clsvof method for grid interval 10 m m and 20 m m are almost identical to the experiment results which means that the clsvof method can calculate water level more accurately than the ls method even in the coarse grid interval 20 m m case in this dam break problem after ensuring that the grids are independent of tailwater level the grid interval 10 m m i e δ x δ y δ z 10 m m is carried out in the other dam break cases to understand dam break flows with large density ratio of 1000 can successfully converge the tolerance to 10 4 for pressure when solve poisson equation we also conduct this case which use α 0 1 to demonstrate the applicability of present models fig 3 shows the iteration numbers with respect to time for the ls thinc sw and the proposed clsvof methods during t 4 80 s 6 80 s one can observe that the iteration number is mostly below 4 when using the clsvof method also tolerance converges to 10 4 for all methods even in large density ratio violent free surface flow in addition the iteration number and tolerance at t 2 68 s 3 26 s 5 18 s and 6 64 s are shown in fig 4 respectively at t 2 68 the deformation of the free surface is relatively steady so the tolerance converges quickly as shown in fig 4 b d the tolerance converges slowly since free surface deformation is relatively violent after the wave front impacting the vertical wall 4 3 mass conservation comparison of ls clsvof and thinc sw methods to quantify the ability of mass conservation for the dam break problems the mass error m e r r o r is defined as follows 50 m e r r o r m t m 0 m 0 where m t ω c t d ω is the mass at the end of the computation and m 0 ω c 0 d ω is the mass at the beginning of the computation the mass error of dam break flow impacting a vertical wall for ls clsvof and thinc sw methods is presented in fig 5 in the case of α 0 1 see fig 5 a a mass loss of 17 is reported using the fifth order weno5 scheme for the ls method this is because weno5 scheme produces numerical dissipation and dispersion and as such mass may be gained or lost in addition this case uses a re initialization procedure which reduces mass loss due to the deviation of the zero level set location for α 0 4 see fig 5 b ls presents a poor mass conservation performance obviously while clsvof gives a better mass conservation the reason may be that the proposed clsvof is transported using conservative equations which reduce mass conservation errors while retaining the accuracy of interface normal vector even in break up phenomena we also calculate the central processing unit cpu time in table 3 by using ls and clsvof methods 4 4 free surface evolution comparison of ls and clsvof methods comparison results of free surface shape slices of α 0 1 for both ls and clsvof methods are shown from fig 6 to fig 11 as well as their corresponding 3d free surface behaviors at each corresponding time instant from figs 6 11 three lines are used to represent the free surface deformation at each corresponding time instant the blue line represents the section with y 0 15 and the red line and green line represent y 0 05 and y 0 25 respectively one can see that the wave front breaks in fig 6 similarly the numerical results for α 0 4 are shown from fig 12 to fig 17 it can be found from figs 6 11 that both ls and clsvof methods can accurately simulate dam break problems with strong nonlinearity from figs 6 17 the wave front travels faster for α 0 1 than for α 0 4 during t 0 92 s 2 68 s with dissipation of the turbulence quasi straight flood waves propagate in the downstream for both α 0 1 and α 0 4 at t 0 92 s an insignificant wave breaking occurs on the tip of the wave front resulting in slight turbulence there from figs 6 17 it can be observed that clsvof gives better results on wave break phenomena according to the model experiment kocaman and ozmen cagatay 2015 the arrival time of wave front at the downstream end wall after dam break for α 0 1 is about 2 68 s clsvof model predicts the arrival time quite accurately but the ls model result lags a bit at t 3 26 s it can be found from figs 8 and 14 that reflection of the flood wave against the wall just starts for α 0 4 however due to the fast wave front and early reflection for α 0 1 wave breaking is significant on the reflected wave however unlike the speed of the flood wave front at t 5 18 s it can be found from figs 10 and 16 that the speed of the reflected wave front is faster for α 0 4 than that for α 0 1 this is because wave breaking and turbulence mixing dissipate the kinetic energy of the reflected wave since the nonlinear phenomena are more significant for α 0 1 than for α 0 4 it is obvious that the clsvof model has a much better performance in capturing strong nonlinear free surface evolution than the ls method especially on turbulence induced three dimensional effect with the same n s equation numerical solver it can also be seen in figs 12 15 that due to the poor mass conservation ls can only accurately predict the surface elevation and can only reconstruct simple harmonic waves in free surface reconstruction but fails when applied to strong nonlinearity problems in other words the clsvof scheme which combines the advantages of thinc wlic and ls schemes makes the nonlinear phenomena of free surface close to experiment results in summary the clsvof scheme is far better than the level set scheme in terms of numerical accuracy in simulating free surface problems with strong nonlinearity like plunging breaking and deformation as shown in figs 6 17 4 5 investigation of different tailwater levels for ls and clsvof methods the free surface elevation results from both experimental and numerical methods in terms of probes p 1 p 6 for α 0 1 and α 0 4 are listed in figs 18 21 respectively in figs 18 21 horizontal distance x and flow depth h are divided into initial reservoir water depth h 0 in order to obtain the non dimensional form of the horizontal distance x x h 0 and flow depth h h h 0 in the meantime time t is multiplied by g h 0 0 5 to get dimensionless time t where g is the acceleration of gravity for both α 0 1 and α 0 4 a quite good agreement between experimental data and numerical results can be observed in figs 18 21 both clsvof and level set models are able to accurately simulate reflected wave front and undulation on the free surface however both models slightly over estimate the water level for the first three sections p 1 p 3 the unphysical oscillations shown in fig 21 a and b arise from the undesired mass loss or gain because of the numerical diffusion produced by the weno5 scheme in the ls method this may also be attributed to the reinitialization procedure in the ls method where mass loss result from the deviation of the zero level set location unphysical oscillations may occur once mass conservation is not well satisfied which produces inaccurate solutions of the water level of dam problems this disadvantage however can be well overcome by the present clsvof method during the reflected wave front coming stage ls model underestimates the water level at the last two sections p 5 p 6 for α 0 1 for α 0 4 it can also be observed that although both experimental data and numerical results demonstrate a very good agreement for all sections clsvof model still gives better results than level set model at all sections during the reflected wave front coming stage both clsvof and ls models underestimate the water level at the two sections p 4 p 5 however the ls model over estimates water level before the reflected wave front comes and is inferior to clsvof model in terms of capturing the real free surface nonlinear deformation since clsvof method has an excellent ability in capturing nonlinear wave surface evolution we add in this section two extra ratios α 0 2 and α 0 3 to further investigate the tailwater level effect fig 22 and fig 22 compare the numerically measured water level evolution for α 0 1 α 0 2 α 0 3 and α 0 4 at all sections once the flood wave impacts the downstream vertical wall it reflects against the wall and then reaches the measurement sections in the meantime the water level all all sections suddenly increase to a peak value and then a wave train appears as time goes on a wave train appears as a result of the flood wave reflection against the downstream end wall see fig 23 4 6 comparison of energy lose for ls and clsvof methods because of the impact of the flood wave on the vertical wall the energy of flood wave dissipates and velocity of the flow decreases the time required for the wave front to reach p 6 from p 2 and to reach p 2 from p 6 are listed in table 2 for different α it can be seen from table 2 that as α increases the arrival time for the flood wave to reach p 2 p 6 increases but the arrival time of the reflected wave to reach p 6 p 2 decreases which means that the energy of the flood wave dissipates and velocity of the flow decreases with the increase of α according to table 2 which uses the clsvof model for α 0 1 the arrival time for the flood wave to reach p 6 from p 2 is t g h 0 23 6786 while that for the reflected wave to reach p 2 from p 6 is t g h 0 12 9072 thus according to ref kocaman and ozmen cagatay 2015 the wave energy and velocity of the wave front decrease by approximately 23 6786 12 9072 23 6786 45 similarly 36 31 and 23 can be obtained for α 0 2 α 0 3 α 0 4 respectively these energy results agree well with those in ref kocaman and ozmen cagatay 2015 consequently the collision of the flood wave with the reflected wave results in a significant energy loss due to intense turbulence mixing into flow the current numerical study indicates that energy loss increases with decreasing depth ratio α furthermore occurrence of undular bore for α 0 4 indicates that turbulence is not dominant when the initial tailwater level is adequately high on the other hand the ls model is also used to investigate energy loss figs 6 9 show that the wave front arrival time at the vertical wall by the ls method lags behind that by the clsvof method before the wave front reaches the vertical wall but after reflection the ls wave front gradually catches up with the clsvof wave front which implies that ls will underestimate the energy loss by the dam break wave impacting the vertical wall if mass conservation is not modified the simulation results show that the flood wave reflection at the vertical wall induced by the dam break wave will cause significant energy loss the present clsvof method has derived satisfactory results in energy loss and free surface capturing by ensuring mass conservation because of its disadvantage in poor mass conservation property the ls method cannot be applied to energy loss problems caused by wave structure interaction even if high resolution discretization schemes were adopted 5 concluding remarks in this study a dam break induced flood wave impacting a vertical downstream end wall over an initially wet downstream channel is numerically investigated with four tailwater levels by means of clsvof and ls models the clsvof model has an excellent ability to deal with interface simulation especially on wave breaking and large amplitude free surface deformation as compared against the ls model clsvof model shows that the impact of dam break flood wave on downstream end wall causes wave reflection against the wall and the occurrence of a negative wave moving towards the upstream direction with undulations on free surface the numerical results at most of the measurement sections indicate that celerity of reflected wave front increases with increasing initial tailwater level in addition energy loss due to flood wave collision with reflected wave and intense turbulence mixing into flow increases as depth ratio α decreases it can be seen from table 2 that this is because it takes longer time for the wave to propagate back from p 6 to p 2 we also find that less energy loss and smaller turbulence will occur for cases with bigger water depth thus making it easier for the wave to maintain its shape acknowledgements this study is financially supported by national natural science foundation of china no 91547211 national natural science foundation of china no 51579164 no 51609269 department of science and technology of sichuan province no 2019yj0118 innovation spark project no scuh0049 and opening foundation of sichuan univ state key lab hydraul mt river engn no skhl1820 appendix subgrid scale model the les approach adopts a spatial filtering on the navier stokes equations so that large scale energy carrying eddies are resolved and small scale dissipative eddies are modeled by a subgrid scale model applying the filtering operation to eqs 20 and 21 may derive the following equations 51 u 0 52 u t u u 1 ρ p 1 ρ μ u u t τ where f denotes the filter operation on the variable f τ u u u u is the subgrid scale sgs stress tensor whose deviatoric part is parametrized by following the smagorinsky procedure as 53 τ 1 3 t r a c e τ i 2 ν t s the turbulent eddy viscosity is defined as follows 54 ν t c δ 2 s 55 s 2 s s the model parameter c in the eddy viscosity definition is required for closing the equations the sgs model which can handle complex geometries without requiring homogeneous direction s is adopted therefore eq 52 can be rewritten as follows 56 u t u u 1 ρ p 1 ρ μ u u t ν t u u t with the trace of the sgs stress tensor 1 3 t r a c e τ incorporated into p 
22914,the problem of a dam break flow induced front wave impacting a vertical wall placed at the downstream end was numerically investigated by using the level set ls method and coupled level set volume of fluid clsvof method for the ls approach the advection equation of the level set function to capture the interface is discretized by the fifth order weighted essentially non oscillatory weno5 scheme for the clsvof approach the tangent of hyperbola for interface capturing weighed line interface calculation thinc wlic scheme is adopted to capture the interface and improve mass conservation the interface normal vector in the wlic reconstruction procedure can be estimated from the ls function instead of vof function the navier stokes solver which uses an explicit adams bashforth algorithm is performed on a staggered eulerian grid the numerical experiments are carried out in a rectangular flume with a smooth horizontal wet bed with four different tailwater levels this study investigates the formation and propagation of the negative wave resulting from the reflection of flood waves against the downstream end wall the numerical results are compared with laboratory experiment results studied in ref kocaman and ozmen cagatay 2015 and a reasonable agreement is achieved numerical results show that the clsvof solutions are better than ls solutions in terms of mass conservation keywords level set method clsvof dam break thinc wlic 1 introduction dam break has been the focus of many researches since the last century because of the strong nonlinear and unsteady flows it produces which can cause catastrophic damages for example urban areas or farmlands downstream of the river channel can be dramatically destroyed kocaman and ozmen cagatay 2015 francesca et al 2015 if a dam suddenly breaks any structure such as breakwater or bridge located downstream of the flow will act as a vertical wall which can generate front wave reflection against these structures with high velocity towards the dam axis and propagating along the negative direction visscher and hager 1998 wet bed depth of the front wave is an important factor to be determined for dam break induced flood understanding such dramatic flow behavior such as tsunami wave by experimental or numerical simulation is essential yang et al 2018a so as to reduce human life or property losses as well as to guide engineering applications kocaman and ozmen cagatay discussed the effect of lateral channel contraction by investigating dam break flow in a channel with lateral contraction they compared their experiment results against those of reynolds averaged navier stokes equations rans based numerical simulation ozmen cagatay and kocaman 2012 in recent decades numerical approaches have also been widely adopted to investigate dam break induced nonlinear flows for example it is widely accepted that 1 d unsteady water flow is governed by the shallow water or saint venant equations garcia navarro et al 1999 it is also worth mentioning that numerical models based on depth averaged two dimensional 2 d shallow water equations swes have been widely adopted in dam break flow investigation in the past few years brufau and garcia navarro 2000 marras et al 2018 cozzolino et al 2018 hu et al 2015 this model is regarded as a suitable mathematical formulation to describe dam break flows in realistic open channels due to its less computational cost brufau and garcia navarro 2000 to further reduce the computational cost high performance calculations are used to simulate dam break events in ref zhang et al 2014 the 2 d swes and rans with the κ ε turbulence model are compared for dam break flow impacting a vertical wall kocaman and ozmen cagatay 2015 comparison with experiment results shows that rans solutions are better than swes solutions because swes are derived from depth integrating the 3 d continuity and momentum equations the 2 d dam break models cannot be used to simulate flows with significant variations in the vertical direction in addition swes based models fail to accurately reflect the actual situation due to its hypothesis and deficiency especially during the initial stage kocaman and ozmen cagatay 2015 hence in comparison with the 1 d and 2 d shallow water equations numerical models based on three dimensional navier stokes equation 3d nses have been more widely adopted for dam break induced flow simulation park et al 2012 celis et al 2017 yang et al 2018b present methods that can be used to deal with two phase problems can be generally divided into two categories lagrangian methods and eulerian methods lagrangian methods such as moving particle semi implicit mps zhang and wan 2014 ng et al 2015 shakibaeinia and jin 2011 and smoothed particle hydrodynamics sph nomeritaeedoardo et al 2016 fourtakas and rogers 2016 are well known for their remarkable advantage in dealing with interface deformation and fragmentation in eulerian methods the flow equations are solved in an eulerian mesh grid overlaid on a flow domain of interest there have been eulerian methods that can accurately solve free surface deformation such as volume of fluid vof method hirt and nichols 1981 ye and zhao 2017 and level set ls method osher and fedkiw 2001 2003 the vof method was proposed by hirt and nichols hirt and nichols 1981 it was adopted in free surface numerical modeling and was paid much attention to in the field of hydrodynamics in recent years due to its advantage of mass conservation vof methods can be subdivided into geometrical and algebraic methods geometrical vof methods involving geometrical reconstruction known as plic piecewise linear interface calculation parker and youngs 1992 are relatively complicated in terms of programming since it uses a linear approximation to reconstruct the interface with the interface orientation considered different from geometrical vof methods algebraic vof methods do not require any geometrical reconstruction xiao et al 2005 proposed a simple and practical algebraic vof method known as tangent of hyperbola for interface capturing thinc the thinc scheme can calculate the fluid fraction function with less oscillation and smearing which is achieved by computing the numerical flux for the fluid fraction function using the hyperbolic tangent function ref yokoi 2007 has reported a multi dimensional flux approximation using the slic simple line interface calculation reconstruction while at the same time considering the interface orientation which is called vof wlic wlic weighed line interface calculation ref yokoi 2007 proposes an interface orientation dependent weighting between the original thinc scheme xiao et al 2011 and the first order donor cell scheme this scheme significantly improves the geometrical accuracy of the original thinc scheme xiao et al 2011 presented an improved multi dimensional vof method to capture moving interfaces known as thinc sw thinc with slope weighting on the basis of thinc the thinc sw scheme significantly improved accuracy in computing multi dimensional moving interfaces numerical simulation of dam break problems by using vof methods were carried out to investigate nonlinear dam break induced flow behaviors liu et al 2013 marsooli and wu 2014 ls methods have become increasingly popular for simulating moving interfaces in air water two phase flows yang et al 2014 zhu et al 2016 in ls methods the interface between the two phases is defined as the zero contour of a continuous signed distance function this allows the normal and curvature of the interface to be easily obtained besides by means of implementing a high order advection scheme the topology changes can also be easily handled kim and liou 2011 however two issues confront level set based methods the first issue is its numerical dissipation and dispersion which would cause deterioration in predicted level set solutions in some occasions a useful suggestion is to adopt high order schemes such as essentially non oscillatory eno schemes or weighted eno weno based schemes hermann 2005 salih and moulic 2009 the second issue is that a small amount of mass may be gained or lost when the zero level set is altered during the re initialization procedure luo et al 2015 a re initialization step adopted in sussman s research is also suggested for improving the process in which the mass property is corrected by adding an additional mass correction term to the re initialization equation sussman and fatemi 1999 the attractive feature of such an approach is that it conserves the mass bounded by the interface and maintains the level set function as a distance function another reasonable technique is to adopt a hybrid approach namely a coupled level set volume of fluid clsvof method wang and tong 2010 wang et al 2012 balczar et al 2016 yokoi 2013 chakraborty et al 2013 ningegowda and premachandran 2014 sussman and elbridge 2000 the clsvof method combines the advantages of both vof and ls methods which can further improve mass conservation and calculate interface curvature more accurately this coupling method is widely used for high precision simulation such as droplet impacting a dry surface yokoi et al 2009 bubble growth and detachment albadawi et al 2013 and plunging breaking waves koo et al 2012 in the clsvof method developed by sussman and puckett sussman and elbridge 2000 for the computation of 3d and axisymmetric incompressible two phase flows they obtained the surface curvature by finite differences of the level set function which in turn is derived from the level set function and volume of fluid function the clsvof method was also implemented by wang et al 2012 for numerically simulating interfacial flows in ship hydrodynamics their method re distances the level set function using the reconstructed interface with a geometric algorithm and handles interface jump conditions by using a ghost fluid methodology their method was applied in the simulation of a gas bubble rising in a viscous liquid and a water drop impacting onto a deepwater pool sun et al sun and tao 2010 have developed a coupled volume of fluid and level set method which reconstructs the distance function by an iterative algorithm and advects the interface by the vof method two dimensional simulations on rising bubbles and dam break problems are performed to validate their method in this study a clsvof based numerical solver where the interface is presented by the vof function is developed to further investigate the dam break induced free surface behaviors and is compared with the level set method this paper is organized as follows in section 2 governing equations of the two fluids and clsvof method are presented section 3 describes the numerical scheme for ls and vof methods as well as the solution algorithm of navier stokes equation which is solved by using the projection method and direct numerical simulation dns is adopted to handle turbulence flow in section 4 numerical experiments are carried out in a rectangular flume with a smooth horizontal wet bed with different tailwater levels to investigate in detail the formation and propagation of the negative wave towards the upstream direction the numerical results are also compared with laboratory experiment results kocaman and ozmen cagatay 2015 conclusions are drawn in section 5 2 mathematical model 2 1 level set method in level set based methods the interface motion can be tracked by solving the ls evolution equation as follows sussman et al 1994 1 ϕ t u ϕ 0 where ϕ is the level set function which is usually set as a signed distance function d the value of which denoting the distance from a particular spatial point to the interface usually d is defined to be positive for liquid and negative for gas the interface level is always located at zero ψ with the following form 2 ϕ x y z d for x y z in the liquid 0 for x y z ψ d for x y z in the gas the level set function ϕ is no longer a signed distance function as time marches a re initialization process is thus required to keep ϕ as a signed distance function by means of solving the following equation sussman and fatemi 1999 3 ϕ τ s ϕ 0 1 ϕ λ δ ϕ ϕ where τ is the pseudo time for iteration and ϕ 0 is the level set function before re initialization λ and delta function δ ϕ are respectively given as 4 λ ω δ ϕ s ϕ 0 1 ϕ d ω ω δ 2 ϕ ϕ d ω 5 δ ϕ 1 2 ε 1 cos π ϕ ε if ϕ ε 0 otherwise note that s ϕ 0 denotes the smoothed sign function with δ x being the local grid size to smear out the sign function 6 s ϕ 0 2 h ϕ 0 0 5 with 7 h ϕ 0 if ϕ ε 1 2 1 ϕ ε 1 π sin π ϕ ε if ϕ ε 1 if ϕ ε where ε 1 5 δ x is chosen in this study 2 2 volume of fluid method the characteristic function χ is adopted in vof method and is passively advected owing to its zero substantial derivative with the following form yokoi 2007 8 χ t u χ χ u 0 with 9 χ x y z 1 for x y z in the liquid 0 for x y z in the gas the fraction function c as an integral of the phase s characteristic function χ is used 10 c i j k 1 δ x δ y δ z 0 δ x 0 δ y 0 δ z χ x y z d x d y d z because the characteristic function χ is discontinuous equation 8 cannot be directly solved using χ concept it is therefore necessary to use flux expressions the volume averaged characteristic function c namely the vof function is calculated by the flux formulation in the form of 11 c i j k a c i j k n f x i 1 2 j k n f x i 1 2 j k n δ x c i j k n u x i 1 2 j k u x i 1 2 j k δ x δ t 12 c i j k b c i j k a f y i j 1 2 k f y i j 1 2 k δ y c i j k n u y i j 1 2 k u y i j 1 2 k δ y δ t 13 c i j k n 1 c i j k b f z i j k 1 2 f z i j k 1 2 δ z c i j k n u z i j k 1 2 u z i j k 1 2 δ z δ t where f x i 1 2 j k f y i j 1 2 k and f z i j k 1 2 are the flux given below 14 f x i 1 2 j k z i j k 1 2 z i j k 1 2 y i j 1 2 k y i j 1 2 k x i 1 2 j k x i 1 2 j k u x i 1 2 j k δ t χ i s j k x y z d x d y d z 15 f y i j 1 2 k z i j k 1 2 z i j k 1 2 y i j 1 2 k y i j 1 2 k u y i j 1 2 k δ t x i 1 2 j k x i 1 2 j k χ i j s k x y z d x d y d z 16 f z i j k 1 2 z i j k 1 2 z i j k 1 2 u z i j k 1 2 δ t y i j 1 2 k y i j 1 2 k x i 1 2 j k x i 1 2 j k χ i j k s x y z d x d y d z the subscripts i s j s and k s in eq 14 eq 15 and eq 16 are 17 i s i if u x i 1 2 j k 0 i 1 if u x i 1 2 j k 0 18 j s j if u y i j 1 2 k 0 j 1 if u y i j 1 2 k 0 and 19 k s k if u z i j k 1 2 0 k 1 if u z i j k 1 2 0 the order of sweep direction of eqs 14 16 is altered at every time step to minimize the error by dimensional splitting 2 3 coupled level set and volume of fluid clsvof method although the vof method can well conserve mass it has difficulties in capturing geometric properties of the interface in the ls method however geometric properties of the interface can be easily described by using a continuous level set function ϕ which on the other hand does not guarantee mass conservation we are thus motivated to couple the vof method and the ls method to achieve both mass conservation and accurate geometry description this is achieved in the proposed clsvof method the clsvof algorithm is shown as follows image 1 in the above clsvof algorithm the governing equations of the level set function ϕ and volume fraction c are solved from t n to t n 1 from step 1 and step 2 so that ϕ and c are advected interface reconstruction of step 3 is required to ensure that the predicted interfaces from ϕ and c are close to each other an intermediate function ψ 2 c n 1 1 is introduced in the reconstruction procedure whose isoline ψ 0 indicates the position of the interface which is identical to that indicated by c n 1 1 2 then step 3 2 is performed until ψ reaches a steady state solution at the interface which is exactly the value of ψ at the interface following this step we perform step 3 3 to construct another intermediate level set function ϕ n 1 from ϕ n 1 and ψ n 1 to ensure that ϕ n 1 and c n 1 indicate the same interface position step 3 4 is performed until a steady state solution ϕ n 1 is reached to eliminate the discontinuity at ϕ n 1 ε 2 4 navier stokes equations and physical properties the two immiscible e g water and air incompressible viscous flows are governed by the navier stokes equations 20 u 0 21 u t u u 1 ρ p 1 ρ 2 μ d g where u is the velocity vector t is the time p is the pressure d u u t is the deformation tensor and g represents the gravitational acceleration each phase of density and viscosity shown in eq 21 can be defined by the vof function ρ ρ a ρ w ρ a c 22 μ μ a μ w μ a c where ρ a and ρ w represent the air and water density respectively in fact the turbulence model should be implemented in this study for high reynolds number dam break flow problems however the qualities such as front wave and tailwater levels can be calculated accurately using the present direct numerical simulation dns model compared with experiment studies we will further consider the turbulence model such as large eddy simulation les in the two phase flow system we have added corresponding illustration for les in the appendix 3 numerical scheme dam break flow impacting a vertical wall is investigated numerically using a uniform staggered cartesian grid system the variable arrangement is as follows the velocity components are located at cell faces while density ρ viscosity μ pressure p level set function ϕ and vof function c are defined at cell centers 3 1 level set method solver the level set evolution equation i e eq 1 can be expressed in the following conservative form 23 ϕ t u ϕ 0 eq 23 leads to an ordinary differential equation ode with a semi discrete conservative finite difference scheme 24 d ϕ i j k d t l ϕ i j k 1 δ x f ˆ i 1 2 j k f ˆ i 1 2 j k 1 δ y g ˆ i j 1 2 k g ˆ i j 1 2 k 1 δ z h ˆ i j k 1 2 h ˆ i j k 1 2 where f ˆ i 1 2 j k g ˆ i j 1 2 k h ˆ i j k 1 2 are the approximation of the numerical fluxes at point x i 1 2 j k y i j 1 2 k z i j k 1 2 respectively which can be reconstructed from the discrete values of f u ϕ g v ϕ and h w ϕ the numerical fluxes at cell faces are reconstructed using an interpolation based on the idea of a fifth order weno weno scheme jiang and shu 1996 similarly the re initialization equation 3 in 3 d cases can be expressed in a semi discrete form 25 d ϕ d t h g ϕ x ϕ x ϕ y ϕ y ϕ z ϕ z 0 where h g is the godunov hamiltonian the spatial discretization ϕ x i j k left biased stencil from i 3 to i 2 and ϕ x i j k right biased stencil from i 2 to i 3 in eq 3 can be evaluated similarly as done in the evolution equation by weno5 scheme with local lax friedrichs llf flux splitting method jiang and peng 2000 the third order total variation diminishing runge kutta tvd rk3 scheme is used for time advancement shu 1988 3 2 volume of fluid vof solver 3 2 1 weighed linear interface calculation wlic the wlic method was published by yokoi 2007 following the idea of simple linear interface calculation slic method we define the horizontal interface interface consisting of x coordinate and y coordinate and vertical interface consisting of x coordinate and z coordinate consisting of y coordinate and z coordinate the weights of the interfaces are calculated from the surface normal n χ i j k x y z ω x i j k n i j k χ x i j k x y z ω y i j k n i j k χ y i j k x y z 26 ω z i j k n i j k χ z i j k x y z where n i j k is the local normal vector and χ x i j k x y z χ y i j k x y z and χ z i j k x y z are the characteristic functions of the vertical interface and horizontal interface respectively ω x i j k ω y i j k and ω z i j k in eq 26 are weighting functions the weighting function ω x i j k for x component used in eq 26 is randomly chosen and the three available choices are listed in table 1 aniszewski et al 2014 discontinuity of the spatial derivatives of vof function near the interface can lead to inaccuracy of the geometric properties the calculation of ω x i j k ω y i j k and ω z i j k presented in this study employs the signed distance function of ls method for example we calculate the weighting function ω ξ i j k ξ x y z by the following equation 27 ω ξ i j k n ξ i j k n x i j k n y i j k n z i j k where n ξ i j k ϕ ξ ϕ x 2 ϕ y 2 ϕ z 2 3 2 2 thinc wlic scheme the flux f x x in eq 34 is calculated using a one dimensional thinc scheme the piecewise modified hyperbolic tangent function 28 χ x i 1 2 1 α x tanh β x x i 1 2 δ x x i is used as the characteristic function where α x and β represent the interface direction and smoothness respectively α x is given as 29 α x 1 i f n x i 0 1 i f n x i 0 where n x i c i 1 c i 1 is used in this study β 3 5 is chosen which is equal to one mesh spacing smoothing x i δ x indicates the distance between x i 1 2 and the interface and denotes the position of the interface x i is calculated by cell averaging χ i as follows 30 1 δ x x i 1 2 x i 1 2 χ i x x i d x c i n the formulation f x i 1 2 j k f y i j 1 2 k and f z i j k 1 2 in eqs 14 16 can be generalized to three dimensional cases using the thinc wlic method as follows 31 f x i 1 2 j k f x i 1 2 f x x i 1 2 f x y i 1 2 f x z i 1 2 32 f y i j 1 2 k f y j 1 2 f y x j 1 2 f y y j 1 2 f y z j 1 2 33 f z i j k 1 2 f z k 1 2 f z x k 1 2 f z y k 1 2 f z z k 1 2 with 34 f ξ ξ m 1 2 ξ m 1 2 ξ m 1 2 u m 1 2 δ t ω ξ m s χ ξ m s d ξ 35 χ ξ m s 1 2 1 α ξ tanh β ξ ξ m s 1 2 δ ξ ξ m s 36 α ξ 1 i f n ξ m s 0 1 i f n ξ m s 0 37 m s m i f u ξ m 1 2 0 m 1 i f u ξ m 1 2 0 the weights ω ξ m in eq 34 for x component i e ξ x and m i are calculated by 38 ω ξ m ω ξ m j k ω x i j k n x i j k n x i j k n y i j k n z i j k note that n x i j k in eq 38 is the normal vector for x component and can be calculated by level set function ϕ 39 n x i j k ϕ x ϕ x 2 ϕ y 2 ϕ z 2 the first derivative terms ϕ x ϕ y ϕ z are approximated by second order centered difference scheme n y i j k and n z i j k can also be calculated in the same way described in eq 39 for convenience we rewrite eqs 31 33 as follows 40 f x i 1 2 f x x i 1 2 f x v i 1 2 41 f y j 1 2 f y y j 1 2 f y v j 1 2 42 f z k 1 2 f z z k 1 2 f z v k 1 2 where the flux f ξ v m 1 2 in eqs 31 33 can be expressed in terms of the vertical surface for the flux direction for instance f x v f x y f x z the flux f ξ v m 1 2 is calculated as follows 43 f ξ v m 1 2 1 ω ξ m s c m s u ξ m 1 2 δ t 3 3 navier stokes equation solver 3 3 1 momentum equation solver the second order upwinding scheme is used for the convective terms in eq 21 in the x direction momentum equation using u u x as an example the discretization can be approximated as 44 u u x 1 2 δ x u 3 u i j k 4 u i 1 j k u i 2 j k u u i 2 j k 4 u i 1 j k 3 u i j k where u 1 2 u i j k u i j k and u 1 2 u i j k u i j k for the diffusion terms in eq 21 second order central difference scheme is used 3 3 2 projection method given u n and f n the second order adams bashforth scheme is used for time advancement and is written as follows 45 u n 1 u n δ t 3 2 a n 1 2 a n 1 1 ρ p n 1 2 0 where a denotes 46 a u u 1 ρ μ u u t g by using the continuity equation and the divergence operator in eq 45 the poisson equation for p n 1 2 can be derived as 47 1 ρ p n 1 2 u n δ t 3 2 a n 1 2 a n 1 note that p n 1 2 must satisfy the neumann boundary condition at all walls shown below 48 p n 1 2 n f n u n 1 u n δ t we then discretize eq 47 as 49 a p i 1 j k b p i 1 j k c p i j k d p i j 1 k e p i j 1 k f p i j k 1 g p i j k 1 r h s i j k a point successive over relaxation psor method is used for the above tridiagonal and sparse matrix of pressure the convergence tolerance ε 10 4 is used for the solutions calculated from two consecutive iterations p m 1 p m where m is the iteration counter using the projection method to solve navier stoke equations along with the psor method for the pressure poisson equation ensures a second order accuracy in both time and space o δ t 2 δ x 2 which may be critical for the accuracy in capturing free interfaces 3 3 3 solution algorithm the numerical algorithm which combines clsvof and the projection method is shown as follows image 2 4 numerical verification and investigation for dam break with tail water level in this section dam break problems with large density variation across the interface are investigated with different tailwater levels in order to justify the ls and the present clsvof solver 4 1 parameters and setting of numerical simulations we choose a typical model experiment for comparison kocaman and ozmen cagatay 2015 as shown in fig 1 the experiment domain is 8 90 m long 0 30 m wide and 0 30 m high and six probes p 1 p 6 are located along the channel the gate is located between the reservoir and the tailwater a still water body which is 4 65 m long 0 30 m wide and 0 25 m high is initially placed in the reservoir in the model experiment a 4 25 m long water body is adopted two water depths 0 025 m and 0 01 m are utilized to investigate the tailwater level effect on dam break front waves corresponding to the water depth ratio of α 0 1 and α 0 4 respectively once the gate is removed the initial reservoir water mixes with the tailwater under the effect of gravity and in the meantime the tailwater resisted the drag force kocaman and ozmen cagatay 2015 both upstream and downstream boundaries are set as wall i e u v w 0 since no flow enters into the reservoir and the downstream end is closed by a vertical steel gate the boundary conditions of channel sidewall are also set as wall the computational domain is subdivided into a mesh of fixed rectangular cells using cartesian coordinates 4 2 mesh convergence study for ls and clsvof methods this section presents the mesh convergence study where the tailwater level for probe p 2 with α 0 4 is calculated fig 2 shows the temporal evolution of water level calculated in grid intervals 10 m m and 20 m m using ls and clsvof methods in fig 2 time t is multiplied by g h 0 0 5 to get dimensionless time t where g is the acceleration of gravity the water levels for both methods in finer grid interval 10 m m agree quite well with the experiment results in ref kocaman and ozmen cagatay 2015 it is also observed that the water level results by using clsvof method for grid interval 10 m m and 20 m m are almost identical to the experiment results which means that the clsvof method can calculate water level more accurately than the ls method even in the coarse grid interval 20 m m case in this dam break problem after ensuring that the grids are independent of tailwater level the grid interval 10 m m i e δ x δ y δ z 10 m m is carried out in the other dam break cases to understand dam break flows with large density ratio of 1000 can successfully converge the tolerance to 10 4 for pressure when solve poisson equation we also conduct this case which use α 0 1 to demonstrate the applicability of present models fig 3 shows the iteration numbers with respect to time for the ls thinc sw and the proposed clsvof methods during t 4 80 s 6 80 s one can observe that the iteration number is mostly below 4 when using the clsvof method also tolerance converges to 10 4 for all methods even in large density ratio violent free surface flow in addition the iteration number and tolerance at t 2 68 s 3 26 s 5 18 s and 6 64 s are shown in fig 4 respectively at t 2 68 the deformation of the free surface is relatively steady so the tolerance converges quickly as shown in fig 4 b d the tolerance converges slowly since free surface deformation is relatively violent after the wave front impacting the vertical wall 4 3 mass conservation comparison of ls clsvof and thinc sw methods to quantify the ability of mass conservation for the dam break problems the mass error m e r r o r is defined as follows 50 m e r r o r m t m 0 m 0 where m t ω c t d ω is the mass at the end of the computation and m 0 ω c 0 d ω is the mass at the beginning of the computation the mass error of dam break flow impacting a vertical wall for ls clsvof and thinc sw methods is presented in fig 5 in the case of α 0 1 see fig 5 a a mass loss of 17 is reported using the fifth order weno5 scheme for the ls method this is because weno5 scheme produces numerical dissipation and dispersion and as such mass may be gained or lost in addition this case uses a re initialization procedure which reduces mass loss due to the deviation of the zero level set location for α 0 4 see fig 5 b ls presents a poor mass conservation performance obviously while clsvof gives a better mass conservation the reason may be that the proposed clsvof is transported using conservative equations which reduce mass conservation errors while retaining the accuracy of interface normal vector even in break up phenomena we also calculate the central processing unit cpu time in table 3 by using ls and clsvof methods 4 4 free surface evolution comparison of ls and clsvof methods comparison results of free surface shape slices of α 0 1 for both ls and clsvof methods are shown from fig 6 to fig 11 as well as their corresponding 3d free surface behaviors at each corresponding time instant from figs 6 11 three lines are used to represent the free surface deformation at each corresponding time instant the blue line represents the section with y 0 15 and the red line and green line represent y 0 05 and y 0 25 respectively one can see that the wave front breaks in fig 6 similarly the numerical results for α 0 4 are shown from fig 12 to fig 17 it can be found from figs 6 11 that both ls and clsvof methods can accurately simulate dam break problems with strong nonlinearity from figs 6 17 the wave front travels faster for α 0 1 than for α 0 4 during t 0 92 s 2 68 s with dissipation of the turbulence quasi straight flood waves propagate in the downstream for both α 0 1 and α 0 4 at t 0 92 s an insignificant wave breaking occurs on the tip of the wave front resulting in slight turbulence there from figs 6 17 it can be observed that clsvof gives better results on wave break phenomena according to the model experiment kocaman and ozmen cagatay 2015 the arrival time of wave front at the downstream end wall after dam break for α 0 1 is about 2 68 s clsvof model predicts the arrival time quite accurately but the ls model result lags a bit at t 3 26 s it can be found from figs 8 and 14 that reflection of the flood wave against the wall just starts for α 0 4 however due to the fast wave front and early reflection for α 0 1 wave breaking is significant on the reflected wave however unlike the speed of the flood wave front at t 5 18 s it can be found from figs 10 and 16 that the speed of the reflected wave front is faster for α 0 4 than that for α 0 1 this is because wave breaking and turbulence mixing dissipate the kinetic energy of the reflected wave since the nonlinear phenomena are more significant for α 0 1 than for α 0 4 it is obvious that the clsvof model has a much better performance in capturing strong nonlinear free surface evolution than the ls method especially on turbulence induced three dimensional effect with the same n s equation numerical solver it can also be seen in figs 12 15 that due to the poor mass conservation ls can only accurately predict the surface elevation and can only reconstruct simple harmonic waves in free surface reconstruction but fails when applied to strong nonlinearity problems in other words the clsvof scheme which combines the advantages of thinc wlic and ls schemes makes the nonlinear phenomena of free surface close to experiment results in summary the clsvof scheme is far better than the level set scheme in terms of numerical accuracy in simulating free surface problems with strong nonlinearity like plunging breaking and deformation as shown in figs 6 17 4 5 investigation of different tailwater levels for ls and clsvof methods the free surface elevation results from both experimental and numerical methods in terms of probes p 1 p 6 for α 0 1 and α 0 4 are listed in figs 18 21 respectively in figs 18 21 horizontal distance x and flow depth h are divided into initial reservoir water depth h 0 in order to obtain the non dimensional form of the horizontal distance x x h 0 and flow depth h h h 0 in the meantime time t is multiplied by g h 0 0 5 to get dimensionless time t where g is the acceleration of gravity for both α 0 1 and α 0 4 a quite good agreement between experimental data and numerical results can be observed in figs 18 21 both clsvof and level set models are able to accurately simulate reflected wave front and undulation on the free surface however both models slightly over estimate the water level for the first three sections p 1 p 3 the unphysical oscillations shown in fig 21 a and b arise from the undesired mass loss or gain because of the numerical diffusion produced by the weno5 scheme in the ls method this may also be attributed to the reinitialization procedure in the ls method where mass loss result from the deviation of the zero level set location unphysical oscillations may occur once mass conservation is not well satisfied which produces inaccurate solutions of the water level of dam problems this disadvantage however can be well overcome by the present clsvof method during the reflected wave front coming stage ls model underestimates the water level at the last two sections p 5 p 6 for α 0 1 for α 0 4 it can also be observed that although both experimental data and numerical results demonstrate a very good agreement for all sections clsvof model still gives better results than level set model at all sections during the reflected wave front coming stage both clsvof and ls models underestimate the water level at the two sections p 4 p 5 however the ls model over estimates water level before the reflected wave front comes and is inferior to clsvof model in terms of capturing the real free surface nonlinear deformation since clsvof method has an excellent ability in capturing nonlinear wave surface evolution we add in this section two extra ratios α 0 2 and α 0 3 to further investigate the tailwater level effect fig 22 and fig 22 compare the numerically measured water level evolution for α 0 1 α 0 2 α 0 3 and α 0 4 at all sections once the flood wave impacts the downstream vertical wall it reflects against the wall and then reaches the measurement sections in the meantime the water level all all sections suddenly increase to a peak value and then a wave train appears as time goes on a wave train appears as a result of the flood wave reflection against the downstream end wall see fig 23 4 6 comparison of energy lose for ls and clsvof methods because of the impact of the flood wave on the vertical wall the energy of flood wave dissipates and velocity of the flow decreases the time required for the wave front to reach p 6 from p 2 and to reach p 2 from p 6 are listed in table 2 for different α it can be seen from table 2 that as α increases the arrival time for the flood wave to reach p 2 p 6 increases but the arrival time of the reflected wave to reach p 6 p 2 decreases which means that the energy of the flood wave dissipates and velocity of the flow decreases with the increase of α according to table 2 which uses the clsvof model for α 0 1 the arrival time for the flood wave to reach p 6 from p 2 is t g h 0 23 6786 while that for the reflected wave to reach p 2 from p 6 is t g h 0 12 9072 thus according to ref kocaman and ozmen cagatay 2015 the wave energy and velocity of the wave front decrease by approximately 23 6786 12 9072 23 6786 45 similarly 36 31 and 23 can be obtained for α 0 2 α 0 3 α 0 4 respectively these energy results agree well with those in ref kocaman and ozmen cagatay 2015 consequently the collision of the flood wave with the reflected wave results in a significant energy loss due to intense turbulence mixing into flow the current numerical study indicates that energy loss increases with decreasing depth ratio α furthermore occurrence of undular bore for α 0 4 indicates that turbulence is not dominant when the initial tailwater level is adequately high on the other hand the ls model is also used to investigate energy loss figs 6 9 show that the wave front arrival time at the vertical wall by the ls method lags behind that by the clsvof method before the wave front reaches the vertical wall but after reflection the ls wave front gradually catches up with the clsvof wave front which implies that ls will underestimate the energy loss by the dam break wave impacting the vertical wall if mass conservation is not modified the simulation results show that the flood wave reflection at the vertical wall induced by the dam break wave will cause significant energy loss the present clsvof method has derived satisfactory results in energy loss and free surface capturing by ensuring mass conservation because of its disadvantage in poor mass conservation property the ls method cannot be applied to energy loss problems caused by wave structure interaction even if high resolution discretization schemes were adopted 5 concluding remarks in this study a dam break induced flood wave impacting a vertical downstream end wall over an initially wet downstream channel is numerically investigated with four tailwater levels by means of clsvof and ls models the clsvof model has an excellent ability to deal with interface simulation especially on wave breaking and large amplitude free surface deformation as compared against the ls model clsvof model shows that the impact of dam break flood wave on downstream end wall causes wave reflection against the wall and the occurrence of a negative wave moving towards the upstream direction with undulations on free surface the numerical results at most of the measurement sections indicate that celerity of reflected wave front increases with increasing initial tailwater level in addition energy loss due to flood wave collision with reflected wave and intense turbulence mixing into flow increases as depth ratio α decreases it can be seen from table 2 that this is because it takes longer time for the wave to propagate back from p 6 to p 2 we also find that less energy loss and smaller turbulence will occur for cases with bigger water depth thus making it easier for the wave to maintain its shape acknowledgements this study is financially supported by national natural science foundation of china no 91547211 national natural science foundation of china no 51579164 no 51609269 department of science and technology of sichuan province no 2019yj0118 innovation spark project no scuh0049 and opening foundation of sichuan univ state key lab hydraul mt river engn no skhl1820 appendix subgrid scale model the les approach adopts a spatial filtering on the navier stokes equations so that large scale energy carrying eddies are resolved and small scale dissipative eddies are modeled by a subgrid scale model applying the filtering operation to eqs 20 and 21 may derive the following equations 51 u 0 52 u t u u 1 ρ p 1 ρ μ u u t τ where f denotes the filter operation on the variable f τ u u u u is the subgrid scale sgs stress tensor whose deviatoric part is parametrized by following the smagorinsky procedure as 53 τ 1 3 t r a c e τ i 2 ν t s the turbulent eddy viscosity is defined as follows 54 ν t c δ 2 s 55 s 2 s s the model parameter c in the eddy viscosity definition is required for closing the equations the sgs model which can handle complex geometries without requiring homogeneous direction s is adopted therefore eq 52 can be rewritten as follows 56 u t u u 1 ρ p 1 ρ μ u u t ν t u u t with the trace of the sgs stress tensor 1 3 t r a c e τ incorporated into p 
