index,text
22325,vortex induced vibration viv can cause fatigue damage of risers many devices such as fairings helical strakes are developed to suppress riser viv however risers are long in a range from hundreds of meters to thousands of meters where to install a limited number of suppression devices or in other words how to design the suppression device configuration is still a challenge for riser engineering evolution theory is introduced to solve the optimization problem of the suppression device configuration of risers in this paper several optimization methods including ga ea and mga are proposed for the optimization of the suppression device configuration of risers each riser element is firstly represented as a gene with two states with suppression devices or not then the suppression device configuration of risers will evolve in the direction of decreasing riser viv fatigue until reaching the optimal configuration the proposed method is demonstrated by its application to an engineering case it turns out that the proposed method can perform the optimization design of the suppression device configuration accurately and efficiently the riser viv fatigue can be reduced obviously through the optimization design keywords riser vortex induced vibration suppression device configuration optimization genetic algorithm 1 introduction drilling and production risers are key equipments connecting surface platforms and subsea wellheads chen et al 2013 chang et al 2019 nie et al 2019 risers are exposed to sea water and affected by ocean current in the long term when the ocean current flows through risers flow separates from riser and vortices form risers experience unsteady loads due to the flow separation and the formation of the vortex the vortex can induce riser vibration which is often called vortex induced vibration viv viv which can cause riser fatigue failure is a challenge for riser engineering williamson and govardhan 2008 bearman 2011 wu et al 2012 therefore several types of viv suppression devices have been developed such as rigid splitter plates fairings and helical strakes a number of experiments and simulation were conducted to measure the suppression effect of these devices in previous research works rashidi et al 2016 sui et al 2016 each viv suppression method is not discussed in detail for brevity suppression devices can prevent the generation of vortex around risers however a riser system is long even thousands of meters it is not possible to install viv suppression devices on every part of a riser system a limited number of viv suppression devices are often hoped to be installed to reduce project cost and increase operation efficiency dev 2018 therefore where install viv suppression devices is a key problem to be solved that is how to design the suppression device configuration of risers is to be solved in contrast to a great many studies on viv suppression method the investigation on the configuration location and length design of viv suppression devices remains scarce frank et al 2004 conducted viv experiments on a flexible cylinder with varied helical stake coverage densities from 0 to 100 coverage to examine the influence of various lengths of strake coverage on riser vibrations trim et al 2005 tested risers without viv suppression and with various strake arrangements the results suggest that a key consideration in viv fatigue design is the length of suppression coverage vandiver et al 2006 conducted two filed experiments on three different distributions of triple helical strakes they showed that helical strakes reduce not only the amplitude of viv vibration but also the frequency content of the vibration at high mode number quen et al 2014 conducted an experimental investigation on a flexible riser with and without various strake arrangements the response performance of the flexible riser depends closely on the geometry of the strake configuration such as heights and pitches of strakes fang et al 2014 gao et al 2014 and gao et al 2015 conducted several experimental investigations on a flexible cylinder with varied coverage by helical strakes the experimental results indicate that the response characteristics of a bare riser can be quite distinct from those of a riser with helical strakes helical strakes can reduce the viv responses in the cross flow however how to design the configuration of viv suppression devices is still a problem to be solved park et al 2016 proposed a systematic design procedure for strake configuration i e location and length using the modal approach for steel catenary riser it is a good start for the configuration design of viv suppression devices extension work such as the optimization design of the suppression device configuration of risers should be further studied to bridge the gap between viv suppression devices and engineering application problems that involve optimization design of the suppression device configuration of risers are addressed in this study evolution theory is introduced to solve the configuration optimization problem of risers the remainder of this paper is organized as follows section 2 describes the optimization problem of the suppression device configuration of risers including riser viv model and optimization methods section 3 provides a detailed optimization process based on the riser viv model and optimization methods section 4 presents an optimization design for an engineering case with equality constraints and inequality constraints to validate the proposed optimization method and process section 5 provides conclusions 2 model and method the goal of designing the suppression device configuration of risers is to minimize the total viv fatigue damage the optimization model can be written as follows nocedal and wright 2006 1 opt min f x s t g x 0 h x 0 where x is the suppression device configuration f is riser viv model which is used to predict the viv response of risers the riser viv model will be introduced in detail in section 2 1 g and h are inequality constraints and equality constraints respectively the optimization problem shown in eq 1 can be further divided into two subproblems the first one is to establish riser viv model considering suppression devices the second one is to propose an optimization method searching for the optimal riser configuration the two subproblems will be introduced in the following respectively 2 1 riser viv model there have been lots of available methods to predict the viv of a flexible riser which can be divided into two types computational fluid dynamics cfd method and semi empirical prediction method lie and kaasen 2006 wan and duan 2017 zhang et al 2018 cfd method requires such a large amount of calculation that it is not suitable for engineering applications wang et al 2012 2013 lin and wang 2019 the semi empirical prediction method has been widely used in riser engineering and was developed as several industrial software such as shear7 vandiver and li 2007 viva triantafyllou et al 1999 vivana larsen et al 2001 et al shear7 which is developed by vandiver at mit is the most popular riser viv analysis software the shear7 viv response prediction includes root mean square rms displacement velocity acceleration rms stress and fatigue damage rate as well as local drag amplification coefficients which are enough for the viv analysis in the optimization design of the suppression device configuration of risers therefore shear7 is chosen as the riser viv analysis model in the optimization model shown in eq 1 shear7 is a mode superposition program it identifies which modes are likely to be excited and estimates the crossflow viv response in steady uniform or sheared flows the displacement response of a riser system can be written as the superposition of modal responses vandiver and li 2007 2 y x t r y r x q r t r y r x a r cos w r t where y r and w r are rth mode shape and natural frequency of the riser system respectively which can be calculated by sehar7 directly or input from exiting modal analysis results q r is the model displacement of rth mode x is the coordinate axis along the riser system t is time a r is the rth mode displacement of the riser system it is assumed that for each mode the input and output power are in balance then a r is to be solved according to 3 a r d 1 2 l r ρ f v 2 x c l x ω r y r x d x l l r r h x y r 2 x ω r d x 0 l r s x y r 2 x ω r d x where d is the outer diameter of risers ρ f is the density of sea water v is the current velocity l is the length of the riser system l r is the length of the power in region the damping has been separated into the hydrodynamic part r h and the structural part r s because they have different integration intervals c l is the lift coefficient shear7 provides c l data for a bare cylinder and a cylinder with strakes as shown in fig 1 fig 1 shows that c l of a cylinder with strakes is smaller than that of a bare cylinder since strakes can suppress the formulation of vortex fig 1 also shows that the magnitude of c l is related to riser viv response a which is the superposition of each modal response a r therefore the calculation of a r shown in eq 3 is an iteration process due to the relationship between c l and a in actual calculation an initial value is assigned to the lift coefficient c l for preliminary analysis lift force and damping are updated according to the analysis results of the previous analysis step until a convergence is reached once the a r for each mode is determined rms displacement velocity acceleration rms stress of risers can be calculated based on the a r finally the viv fatigue damage of a riser system with different suppression device configurations can be determined 2 2 optimization method the second subproblem is to present an optimization method to solve the optimization problem the optimization problem as shown in eq 1 can be solved by using enumeration and random methods liu et al 2018 the enumeration method which is also called enumeration algorithm ea is often used to find the optimal solution in ea the viv fatigue of risers with every possible suppression device configuration should be calculated respectively and the riser configuration whose viv fatigue is least is the optimal solution ea is the simplest method for solving the optimization problem shown in eq 1 however ea is often low in efficiency take a riser system with forty riser joints for example every riser joint is divided into two cases installed with strakes or not then the number of suppression device configuration of the riser system is 240 1 1 1012 it takes too large amount of calculation to find the optimal configuration based on ea an efficient method should be introduced to solve the optimization problem with a large amount of calculation genetic algorithm ga which is a random method is selected for the optimization problem with a large amount of calculation due to its efficient global search capability this computational model of the biological evolution process simulates the natural selection and genetic mechanism of darwin s theory of biological evolution ga also serves as a method of searching the optimal solution by simulating the natural evolutionary process fulcher and jain 2008 liu et al 2019 before the optimization how to represent riser configuration x shown in eq 1 should also be determined as we all known variables are represented as genes in ga the suppression device configuration of risers can also be represented as a gene as shown in fig 2 the riser system is divided into a number of finite elements each element is represented by a gene with two states with suppression devices or not 0 stands for the riser element without strakes while 1 stands for the riser element with strakes then the suppression device configuration of the riser system evolves through basic genetic operators including reproduction crossover and mutation as shown in fig 2 finally the optimal configuration can be determined through a series of evolutions 3 optimization process as previously mentioned shear7 is introduced to analyze riser viv response and ea and ga are selected for the optimization design of the suppression device configuration a comprehensive optimization process based on riser viv model ea and ga is then proposed to conduct the configuration optimization of a riser system as shown in fig 3 the program based on ga is divided into three parts namely the main module filtering module and viv fatigue module as shown in fig 3 the main module is designed for ga calculations including the generation reproduction crossover and mutation of configurations encoded in genetic strings the filtering module is designed for filtering possible solutions according constraints shown in eq 1 the viv fatigue module is designed for calculating the fitness value during the optimization process in actual optimization process the suppression device configuration of risers is firstly represented as a genetic strings shown in fig 2 to perform subsequent configuration evolution based on ga then the genetic strings go through the main module filtering module and viv fatigue module cyclically until the fitness value satisfies termination criteria compared with the program based on ga the program based on ea is simple all possible solutions are enumerated firstly the viv fatigue damage of each possible configuration are then calculated in turn the optimal solution is the riser configuration with minimal viv fatigue damage ea method is applicable to optimization problems with strong constraints while ga method is suitable to optimization problems with weak constraints take a riser system with forty riser joints as example there are a total of 240 possible solutions for the optimization problem with no constraints weak constraints since every riser joint may be installed with suppression devices or not ga method which is efficient in global search should be selected for the optimization problem with weak constraints due to so many possible solutions if three suppression devices will be installed on the riser system strong constraints there are a total of 9880 c 40 3 possible solutions for the optimization problem ea method should be chosen for the configuration optimization considering a limited number of possible solutions besides there is an optimization problem with intermediate constraints which are between strong constraints and weak constraints in this case it is too inefficiency for ea to solve the optimization problem with intermediate constraints owing to so many possible solutions meanwhile ga is not suitable to solve the optimization problem since so few possible solutions satisfy the intermediate constraints for example if four suppression devices will be installed on the riser system intermediate constraints there are a total of 91390 c 40 4 possible solutions for the optimization problem it is too inefficiency for ea and not suitable for ga to solve the optimization problem therefore a modified optimization process for the optimization problem with intermediate constraints is proposed as shown in fig 4 the modified ga mga is a more complex optimization method compared with ga in the mga encoding and decoding methods are integrated with ga the mga is divided into four parts namely the encoding module ga main module viv fatigue module and decoding module as shown in fig 4 all possible solutions are firstly listed and then encoded as a series of genetic strings through the encoding module for example four suppression devices will be installed on a riser system with forty riser joints each suppression devices may be installed on the 1st to the 40th riser joint the solution of each suppression device can be represented as a 6 bit genetic strings since 26 is greater than 40 as shown in fig 5 therefore the configuration solution of four suppression devices can be represented as a 24 bit genetic strings the encoded mga genetic string has a one to one correspondence with the position of each suppression device therefore the encoded mga genetic string is likely to satisfy constraints compared with initial ga genetic string then the mga genetic strings go through the ga main module and viv fatigue module cyclically until the fitness value satisfies termination criteria finally the optimal mga genetic strings are found and then decoded back to the actual suppression device configuration through decoding module 4 optimization design the proposed method is applied to an engineering case to validate its accuracy and efficiency the riser system is 684 m in length and constituted by 40 riser joints each riser joint is 17 1 m in length 0 244 m in external diameter and 0 212 m in internal diameter the mass of risers per length is 94 kg and the elastic modules of risers is 2 07 1011 pa the density of sea water is 1025 kg m3 the riser system is regarded as a pinned pinned beam with varying tension some strakes are hoped to be installed on the riser system the fatigue curve of each riser joint is shown in fig 6 the riser system is exposed to marine environment in the long term current velocity can change continually taggart and tognarelli 2008 the configuration optimization should consider varied current velocities to guarantee that the optimization results satisfy actual engineering application requirements weibull distribution is often used to describe different current velocities and their exceedance probabilities which can be written as follows chang et al 2014 xu et al 2019 4 p 1 f u exp u θ β where p is exceedance probability f is weibull function u is current velocity β and θ are shape parameter and scale parameter of weibull distribution respectively based on statistical results of ocean current in the south china sea typical current states with different exceedance probabilities are shown in fig 7 the detailed surface current velocities with different exceedance probabilities are listed in table 1 the probability of each current velocity can be further written as 5 p i 1 p 1 i 1 p i p i 1 i 1 where p i is the exceedance probability of the ith current state p i is the probability of the ith current state the designed configuration of suppression devices must be compact and robust enough to be used in a changed current velocity the optimal configuration is to minimize the riser viv fatigue in long term situations therefore the optimized objective function is expressed as 6 min d x i 1 n p i d i x where d i is riser viv fatigue in ith current state n is the total number of current states finally a systematic optimization process is proposed based on riser viv model optimization method and long term current states as shown in fig 8 the optimization process based on ea ga and mga have been introduced in figs 3 and 4 in detail an optimization program is also developed based on matlab due to its good user programming environment the optimization problem shown in eq 1 can be divided in to two categories according to constraint conditions problems with equality constraints and problems with inequality constraints the two optimization problems will be solved based on the developed optimization program in the following respectively 4 1 case 1 equality constraints the optimization problem with equality constraints is common in riser engineering for example a fixed number of strakes are likely to be installed on a riser system where to install the fixed number of strakes is a typical optimization problem with equality constraints three strakes are assumed to be installed on the riser system with forty riser joints each riser joint is taken as an element with strakes or not the configuration of strakes are optimized based on ga mga an ea respectively the initial population size crossover probability and mutation probability of ga are 80 0 9 and 0 1 respectively the results show that ga can not be used in this optimization problem because the equality constraint is so strong that generated genetic strings based on ga can not satisfy the strong constraint the generated genetic strings are mostly filtered out by the filtering module shown in fig 3 however mga and ea can be used in the optimization problem optimization results based on mga are shown in fig 9 at the initial stage of the mga search the reproduced configurations change with large amplitude and nearly cover the whole riser system which can guarantee the global optimization as shown in fig 9 a the reproduced configurations converge to the optimal values gradually with the increase in search steps under the influence of reproduced configurations with large fluctuating amplitude the calculated mean fitness riser viv fatigue also differs considerably from the best fitness at the initial stage then the calculated mean fitness approaches the best fitness gradually as shown in fig 9 b when the reproduced configurations and calculated fitness almost do not change the reproduced configuration is the optimal result ea is utilized to validate the optimal results and guarantee the accuracy of mga the riser viv fatigue of all configurations a total of 9880 configurations are calculated to find the minimum value based on ea the viv fatigue results of every riser configuration are shown in fig 10 the point marked with in fig 10 is the optimal result based on mga it is obvious that the optimal result based on mga is also the optimal result based on ea the viv fatigue of risers with optimal suppression device configuration is much less than others that is the riser viv fatigue can be reduced largely through the optimization design besides another cases with different number of strakes i e 1 2 3 and 7 are calculated to validate the calculation efficiency and accuracy of each method as listed in table 2 the equality constraints are strong when the number of strakes is one two and three the generated genetic strings based on ga is hard to satisfy the strong constraints therefore only the mga and ea are used in the optimization problem when the number of strakes is one two and three as the number of strakes increases the calculation quantity based on ea increases exponentially for example 91390 c 40 4 calculations should be taken based on ea when the number of strakes is four a total of 822510s 228 h is consumed since 9 s need to be taken in one calculation it is so long time for the optimization design that the calculation based on ea in the case of four strakes is not conducted as the number of strakes further increases the generated genetic strings based on ga can satisfy the equality constraints when the number of strakes is seven therefore the optimization problem with seven strakes is solved based ga and mga respectively as listed in table 2 table 2 shows that when the number of strakes is one and two the calculation time based on ea is less than that of mga because of the strict termination criteria of mga however the run time of ea increases exponentially with the strake number while the run time of mga is basically unchanged and presents random distribution when the strake number is three the ea run time is 67601s i e more than 18 h which is much longer than that of mga the optimization design of riser configurations with more strakes is unrealistic based on ea whereas mga provides an efficient solution for the optimization design of riser configurations the optimal riser viv fatigue based on mga is basically same with that based on ea therefore the calculation accuracy of mga is validated to be high besides the ga calculation accuracy is also validated to be high through the comparison between mga and ga however there may be a little difference among the fatigue damages based on ea ga and mga as listed in table 2 the main reason is that ga or mga which is a random method may not find the optimal configuration in every optimization nevertheless the optimization results based ga and mga are very close to the optimal results owing to the strict termination criteria in ga and mga which guarantee the reliability of the optimization results some analysis is further conducted to show the reliability of the optimization results 28 times of optimizations of suppression device configuration with 7 strakes are conduced based on mga to test the reliability of optimization results as listed in table 3 the results show that the optimization results are basically the same the optimization results are verified to be reliable in summary ea mga and ga are recommended to be used in optimization problems with strong constraints intermediate constraints and weak constraints in sequence with comprehensive consideration of calculation efficiency and accuracy in the following cases with the number of strakes from one to thirty are calculated based on the proposed method the maximum viv fatigue damage of the riser system with different number of strakes are shown in fig 11 the results show that the viv fatigue of the riser system decreases quickly with the number of strakes firstly and then decreases slowly take case with ten strakes as an example for detailed discussion the optimal configuration of the riser system are shown in fig 12 a yellow parts in fig 12 a represent riser joints with strakes while blue parts represent riser joints without strakes the optimal configuration of strakes are in staggered distribution besides strakes are often uniformly spaced to decrease riser viv fatigue in traditional practice as shown in fig 12 b the riser viv responses of the optimal configuration and the uniformly spaced configuration are calculated and compared with each other as shown in figs 13 and 14 fig 13 a and fig 14 a shows the rms displace of the riser system in typical surface current velocities as listed in table 1 fig 13 b and fig 14 b demonstrates the viv fatigue of the riser system in long term current states the results show that the rms displacement and viv fatigue damage of the riser system with optimal riser configuration is less than that with uniformly spaced configuration the optimization method proposed in this paper can decreases the viv fatigue of risers 4 2 case 2 inequality constraints in practical riser engineering strakes may be hoped to be installed on less than a certain percentage of a riser system sometimes which is a typical optimization problem with inequality constraints inequality constraints is the other constraint condition of the optimization problem except the abovementioned equality constraints compared with equality constraints more generated configurations can satisfy inequality constraints weak constraints therefore ga is often chosen for the configuration optimization in inequality constraint condition cases with different inequality constraints i e 20 40 60 80 and no constraints are calculated respectively based on ga the optimization results in inequality constraint 20 are shown in fig 15 yellow parts in fig 15 a represent riser joints with strakes while blue parts represent riser joints without strakes the results show that just like optimization results in equality constraints the reproduced configurations change with large amplitude and nearly cover the riser system which can guarantee the global optimization as shown in fig 15 a the reproduced configuration converge to the optimal values gradually with the increase in search steps as shown in fig 15 b finally the optimal configuration can be determined through a series of iterative calculations the optimal configuration under different inequality constraints are shown in fig 16 yellow parts in fig 16 represent riser joints with strakes while blue parts represent riser joints without strakes the results show that the distribution of strakes is staggered and ruleless fortunately the optimal configuration can be determined quickly based on the proposed method in this paper the maximum viv fatigue of the riser system with different inequality constraints is shown in fig 17 the results show that the viv fatigue decreases quickly and then slowly as the inequality constraints become weak it seems that more strakes can reduce riser viv fatigue however the number of strakes should be determined considering both riser viv fatigue and project cost in actual riser engineering 5 conclusions in this paper a challenging problem of riser engineering has been addressed the optimization of suppression device configuration of risers evolution theory is introduced to solve the optimization problem based on this idea the suppression device configuration of risers is represented as a gene then the suppression device configuration of a riser system evolves in the direction of decreasing riser viv fatigue through basic genetic operators including reproduction crossover and mutation the proposed optimization strategy for riser engineering has not been explored in the existing literature several optimization methods including ga ea and mga are proposed for the optimization of the suppression device configuration of risers the relevant configuration optimization program for riser engineering is also developed based on matlab then the optimization of the suppression device configuration of risers can be conducted by taking full advantage of the three proposed methods the proposed methods are applied in the configuration optimization of a riser system with equality constraints and inequality constraints respectively the results show that the proposed methods perform optimization design of the suppression device configuration of risers accurately and efficiently the riser viv fatigue is reduced obviously through the optimization design of the suppression device configuration of risers ea mga and ga are recommended to be used in optimization problems with strong constraints intermediate constraints and weak constraints in sequence with comprehensive consideration of calculation efficiency and accuracy the proposed methods provide a practical engineering tool for the optimization design of suppression device configuration of risers which bridge the gap between viv suppression devices and engineering application acknowledgements this work was supported by national natural science foundation of china grant no 51809279 major national science and technology program grant no 2016zx05028 001 05 national program on key basic research project 973 program grant no 2015cb251203 program for changjiang scholars and innovative research team in university grant no irt14r58 fundamental research funds for the central universities grant no 17cx02025a and research initiation funds of china university of petroleum grant no y1703008 
22325,vortex induced vibration viv can cause fatigue damage of risers many devices such as fairings helical strakes are developed to suppress riser viv however risers are long in a range from hundreds of meters to thousands of meters where to install a limited number of suppression devices or in other words how to design the suppression device configuration is still a challenge for riser engineering evolution theory is introduced to solve the optimization problem of the suppression device configuration of risers in this paper several optimization methods including ga ea and mga are proposed for the optimization of the suppression device configuration of risers each riser element is firstly represented as a gene with two states with suppression devices or not then the suppression device configuration of risers will evolve in the direction of decreasing riser viv fatigue until reaching the optimal configuration the proposed method is demonstrated by its application to an engineering case it turns out that the proposed method can perform the optimization design of the suppression device configuration accurately and efficiently the riser viv fatigue can be reduced obviously through the optimization design keywords riser vortex induced vibration suppression device configuration optimization genetic algorithm 1 introduction drilling and production risers are key equipments connecting surface platforms and subsea wellheads chen et al 2013 chang et al 2019 nie et al 2019 risers are exposed to sea water and affected by ocean current in the long term when the ocean current flows through risers flow separates from riser and vortices form risers experience unsteady loads due to the flow separation and the formation of the vortex the vortex can induce riser vibration which is often called vortex induced vibration viv viv which can cause riser fatigue failure is a challenge for riser engineering williamson and govardhan 2008 bearman 2011 wu et al 2012 therefore several types of viv suppression devices have been developed such as rigid splitter plates fairings and helical strakes a number of experiments and simulation were conducted to measure the suppression effect of these devices in previous research works rashidi et al 2016 sui et al 2016 each viv suppression method is not discussed in detail for brevity suppression devices can prevent the generation of vortex around risers however a riser system is long even thousands of meters it is not possible to install viv suppression devices on every part of a riser system a limited number of viv suppression devices are often hoped to be installed to reduce project cost and increase operation efficiency dev 2018 therefore where install viv suppression devices is a key problem to be solved that is how to design the suppression device configuration of risers is to be solved in contrast to a great many studies on viv suppression method the investigation on the configuration location and length design of viv suppression devices remains scarce frank et al 2004 conducted viv experiments on a flexible cylinder with varied helical stake coverage densities from 0 to 100 coverage to examine the influence of various lengths of strake coverage on riser vibrations trim et al 2005 tested risers without viv suppression and with various strake arrangements the results suggest that a key consideration in viv fatigue design is the length of suppression coverage vandiver et al 2006 conducted two filed experiments on three different distributions of triple helical strakes they showed that helical strakes reduce not only the amplitude of viv vibration but also the frequency content of the vibration at high mode number quen et al 2014 conducted an experimental investigation on a flexible riser with and without various strake arrangements the response performance of the flexible riser depends closely on the geometry of the strake configuration such as heights and pitches of strakes fang et al 2014 gao et al 2014 and gao et al 2015 conducted several experimental investigations on a flexible cylinder with varied coverage by helical strakes the experimental results indicate that the response characteristics of a bare riser can be quite distinct from those of a riser with helical strakes helical strakes can reduce the viv responses in the cross flow however how to design the configuration of viv suppression devices is still a problem to be solved park et al 2016 proposed a systematic design procedure for strake configuration i e location and length using the modal approach for steel catenary riser it is a good start for the configuration design of viv suppression devices extension work such as the optimization design of the suppression device configuration of risers should be further studied to bridge the gap between viv suppression devices and engineering application problems that involve optimization design of the suppression device configuration of risers are addressed in this study evolution theory is introduced to solve the configuration optimization problem of risers the remainder of this paper is organized as follows section 2 describes the optimization problem of the suppression device configuration of risers including riser viv model and optimization methods section 3 provides a detailed optimization process based on the riser viv model and optimization methods section 4 presents an optimization design for an engineering case with equality constraints and inequality constraints to validate the proposed optimization method and process section 5 provides conclusions 2 model and method the goal of designing the suppression device configuration of risers is to minimize the total viv fatigue damage the optimization model can be written as follows nocedal and wright 2006 1 opt min f x s t g x 0 h x 0 where x is the suppression device configuration f is riser viv model which is used to predict the viv response of risers the riser viv model will be introduced in detail in section 2 1 g and h are inequality constraints and equality constraints respectively the optimization problem shown in eq 1 can be further divided into two subproblems the first one is to establish riser viv model considering suppression devices the second one is to propose an optimization method searching for the optimal riser configuration the two subproblems will be introduced in the following respectively 2 1 riser viv model there have been lots of available methods to predict the viv of a flexible riser which can be divided into two types computational fluid dynamics cfd method and semi empirical prediction method lie and kaasen 2006 wan and duan 2017 zhang et al 2018 cfd method requires such a large amount of calculation that it is not suitable for engineering applications wang et al 2012 2013 lin and wang 2019 the semi empirical prediction method has been widely used in riser engineering and was developed as several industrial software such as shear7 vandiver and li 2007 viva triantafyllou et al 1999 vivana larsen et al 2001 et al shear7 which is developed by vandiver at mit is the most popular riser viv analysis software the shear7 viv response prediction includes root mean square rms displacement velocity acceleration rms stress and fatigue damage rate as well as local drag amplification coefficients which are enough for the viv analysis in the optimization design of the suppression device configuration of risers therefore shear7 is chosen as the riser viv analysis model in the optimization model shown in eq 1 shear7 is a mode superposition program it identifies which modes are likely to be excited and estimates the crossflow viv response in steady uniform or sheared flows the displacement response of a riser system can be written as the superposition of modal responses vandiver and li 2007 2 y x t r y r x q r t r y r x a r cos w r t where y r and w r are rth mode shape and natural frequency of the riser system respectively which can be calculated by sehar7 directly or input from exiting modal analysis results q r is the model displacement of rth mode x is the coordinate axis along the riser system t is time a r is the rth mode displacement of the riser system it is assumed that for each mode the input and output power are in balance then a r is to be solved according to 3 a r d 1 2 l r ρ f v 2 x c l x ω r y r x d x l l r r h x y r 2 x ω r d x 0 l r s x y r 2 x ω r d x where d is the outer diameter of risers ρ f is the density of sea water v is the current velocity l is the length of the riser system l r is the length of the power in region the damping has been separated into the hydrodynamic part r h and the structural part r s because they have different integration intervals c l is the lift coefficient shear7 provides c l data for a bare cylinder and a cylinder with strakes as shown in fig 1 fig 1 shows that c l of a cylinder with strakes is smaller than that of a bare cylinder since strakes can suppress the formulation of vortex fig 1 also shows that the magnitude of c l is related to riser viv response a which is the superposition of each modal response a r therefore the calculation of a r shown in eq 3 is an iteration process due to the relationship between c l and a in actual calculation an initial value is assigned to the lift coefficient c l for preliminary analysis lift force and damping are updated according to the analysis results of the previous analysis step until a convergence is reached once the a r for each mode is determined rms displacement velocity acceleration rms stress of risers can be calculated based on the a r finally the viv fatigue damage of a riser system with different suppression device configurations can be determined 2 2 optimization method the second subproblem is to present an optimization method to solve the optimization problem the optimization problem as shown in eq 1 can be solved by using enumeration and random methods liu et al 2018 the enumeration method which is also called enumeration algorithm ea is often used to find the optimal solution in ea the viv fatigue of risers with every possible suppression device configuration should be calculated respectively and the riser configuration whose viv fatigue is least is the optimal solution ea is the simplest method for solving the optimization problem shown in eq 1 however ea is often low in efficiency take a riser system with forty riser joints for example every riser joint is divided into two cases installed with strakes or not then the number of suppression device configuration of the riser system is 240 1 1 1012 it takes too large amount of calculation to find the optimal configuration based on ea an efficient method should be introduced to solve the optimization problem with a large amount of calculation genetic algorithm ga which is a random method is selected for the optimization problem with a large amount of calculation due to its efficient global search capability this computational model of the biological evolution process simulates the natural selection and genetic mechanism of darwin s theory of biological evolution ga also serves as a method of searching the optimal solution by simulating the natural evolutionary process fulcher and jain 2008 liu et al 2019 before the optimization how to represent riser configuration x shown in eq 1 should also be determined as we all known variables are represented as genes in ga the suppression device configuration of risers can also be represented as a gene as shown in fig 2 the riser system is divided into a number of finite elements each element is represented by a gene with two states with suppression devices or not 0 stands for the riser element without strakes while 1 stands for the riser element with strakes then the suppression device configuration of the riser system evolves through basic genetic operators including reproduction crossover and mutation as shown in fig 2 finally the optimal configuration can be determined through a series of evolutions 3 optimization process as previously mentioned shear7 is introduced to analyze riser viv response and ea and ga are selected for the optimization design of the suppression device configuration a comprehensive optimization process based on riser viv model ea and ga is then proposed to conduct the configuration optimization of a riser system as shown in fig 3 the program based on ga is divided into three parts namely the main module filtering module and viv fatigue module as shown in fig 3 the main module is designed for ga calculations including the generation reproduction crossover and mutation of configurations encoded in genetic strings the filtering module is designed for filtering possible solutions according constraints shown in eq 1 the viv fatigue module is designed for calculating the fitness value during the optimization process in actual optimization process the suppression device configuration of risers is firstly represented as a genetic strings shown in fig 2 to perform subsequent configuration evolution based on ga then the genetic strings go through the main module filtering module and viv fatigue module cyclically until the fitness value satisfies termination criteria compared with the program based on ga the program based on ea is simple all possible solutions are enumerated firstly the viv fatigue damage of each possible configuration are then calculated in turn the optimal solution is the riser configuration with minimal viv fatigue damage ea method is applicable to optimization problems with strong constraints while ga method is suitable to optimization problems with weak constraints take a riser system with forty riser joints as example there are a total of 240 possible solutions for the optimization problem with no constraints weak constraints since every riser joint may be installed with suppression devices or not ga method which is efficient in global search should be selected for the optimization problem with weak constraints due to so many possible solutions if three suppression devices will be installed on the riser system strong constraints there are a total of 9880 c 40 3 possible solutions for the optimization problem ea method should be chosen for the configuration optimization considering a limited number of possible solutions besides there is an optimization problem with intermediate constraints which are between strong constraints and weak constraints in this case it is too inefficiency for ea to solve the optimization problem with intermediate constraints owing to so many possible solutions meanwhile ga is not suitable to solve the optimization problem since so few possible solutions satisfy the intermediate constraints for example if four suppression devices will be installed on the riser system intermediate constraints there are a total of 91390 c 40 4 possible solutions for the optimization problem it is too inefficiency for ea and not suitable for ga to solve the optimization problem therefore a modified optimization process for the optimization problem with intermediate constraints is proposed as shown in fig 4 the modified ga mga is a more complex optimization method compared with ga in the mga encoding and decoding methods are integrated with ga the mga is divided into four parts namely the encoding module ga main module viv fatigue module and decoding module as shown in fig 4 all possible solutions are firstly listed and then encoded as a series of genetic strings through the encoding module for example four suppression devices will be installed on a riser system with forty riser joints each suppression devices may be installed on the 1st to the 40th riser joint the solution of each suppression device can be represented as a 6 bit genetic strings since 26 is greater than 40 as shown in fig 5 therefore the configuration solution of four suppression devices can be represented as a 24 bit genetic strings the encoded mga genetic string has a one to one correspondence with the position of each suppression device therefore the encoded mga genetic string is likely to satisfy constraints compared with initial ga genetic string then the mga genetic strings go through the ga main module and viv fatigue module cyclically until the fitness value satisfies termination criteria finally the optimal mga genetic strings are found and then decoded back to the actual suppression device configuration through decoding module 4 optimization design the proposed method is applied to an engineering case to validate its accuracy and efficiency the riser system is 684 m in length and constituted by 40 riser joints each riser joint is 17 1 m in length 0 244 m in external diameter and 0 212 m in internal diameter the mass of risers per length is 94 kg and the elastic modules of risers is 2 07 1011 pa the density of sea water is 1025 kg m3 the riser system is regarded as a pinned pinned beam with varying tension some strakes are hoped to be installed on the riser system the fatigue curve of each riser joint is shown in fig 6 the riser system is exposed to marine environment in the long term current velocity can change continually taggart and tognarelli 2008 the configuration optimization should consider varied current velocities to guarantee that the optimization results satisfy actual engineering application requirements weibull distribution is often used to describe different current velocities and their exceedance probabilities which can be written as follows chang et al 2014 xu et al 2019 4 p 1 f u exp u θ β where p is exceedance probability f is weibull function u is current velocity β and θ are shape parameter and scale parameter of weibull distribution respectively based on statistical results of ocean current in the south china sea typical current states with different exceedance probabilities are shown in fig 7 the detailed surface current velocities with different exceedance probabilities are listed in table 1 the probability of each current velocity can be further written as 5 p i 1 p 1 i 1 p i p i 1 i 1 where p i is the exceedance probability of the ith current state p i is the probability of the ith current state the designed configuration of suppression devices must be compact and robust enough to be used in a changed current velocity the optimal configuration is to minimize the riser viv fatigue in long term situations therefore the optimized objective function is expressed as 6 min d x i 1 n p i d i x where d i is riser viv fatigue in ith current state n is the total number of current states finally a systematic optimization process is proposed based on riser viv model optimization method and long term current states as shown in fig 8 the optimization process based on ea ga and mga have been introduced in figs 3 and 4 in detail an optimization program is also developed based on matlab due to its good user programming environment the optimization problem shown in eq 1 can be divided in to two categories according to constraint conditions problems with equality constraints and problems with inequality constraints the two optimization problems will be solved based on the developed optimization program in the following respectively 4 1 case 1 equality constraints the optimization problem with equality constraints is common in riser engineering for example a fixed number of strakes are likely to be installed on a riser system where to install the fixed number of strakes is a typical optimization problem with equality constraints three strakes are assumed to be installed on the riser system with forty riser joints each riser joint is taken as an element with strakes or not the configuration of strakes are optimized based on ga mga an ea respectively the initial population size crossover probability and mutation probability of ga are 80 0 9 and 0 1 respectively the results show that ga can not be used in this optimization problem because the equality constraint is so strong that generated genetic strings based on ga can not satisfy the strong constraint the generated genetic strings are mostly filtered out by the filtering module shown in fig 3 however mga and ea can be used in the optimization problem optimization results based on mga are shown in fig 9 at the initial stage of the mga search the reproduced configurations change with large amplitude and nearly cover the whole riser system which can guarantee the global optimization as shown in fig 9 a the reproduced configurations converge to the optimal values gradually with the increase in search steps under the influence of reproduced configurations with large fluctuating amplitude the calculated mean fitness riser viv fatigue also differs considerably from the best fitness at the initial stage then the calculated mean fitness approaches the best fitness gradually as shown in fig 9 b when the reproduced configurations and calculated fitness almost do not change the reproduced configuration is the optimal result ea is utilized to validate the optimal results and guarantee the accuracy of mga the riser viv fatigue of all configurations a total of 9880 configurations are calculated to find the minimum value based on ea the viv fatigue results of every riser configuration are shown in fig 10 the point marked with in fig 10 is the optimal result based on mga it is obvious that the optimal result based on mga is also the optimal result based on ea the viv fatigue of risers with optimal suppression device configuration is much less than others that is the riser viv fatigue can be reduced largely through the optimization design besides another cases with different number of strakes i e 1 2 3 and 7 are calculated to validate the calculation efficiency and accuracy of each method as listed in table 2 the equality constraints are strong when the number of strakes is one two and three the generated genetic strings based on ga is hard to satisfy the strong constraints therefore only the mga and ea are used in the optimization problem when the number of strakes is one two and three as the number of strakes increases the calculation quantity based on ea increases exponentially for example 91390 c 40 4 calculations should be taken based on ea when the number of strakes is four a total of 822510s 228 h is consumed since 9 s need to be taken in one calculation it is so long time for the optimization design that the calculation based on ea in the case of four strakes is not conducted as the number of strakes further increases the generated genetic strings based on ga can satisfy the equality constraints when the number of strakes is seven therefore the optimization problem with seven strakes is solved based ga and mga respectively as listed in table 2 table 2 shows that when the number of strakes is one and two the calculation time based on ea is less than that of mga because of the strict termination criteria of mga however the run time of ea increases exponentially with the strake number while the run time of mga is basically unchanged and presents random distribution when the strake number is three the ea run time is 67601s i e more than 18 h which is much longer than that of mga the optimization design of riser configurations with more strakes is unrealistic based on ea whereas mga provides an efficient solution for the optimization design of riser configurations the optimal riser viv fatigue based on mga is basically same with that based on ea therefore the calculation accuracy of mga is validated to be high besides the ga calculation accuracy is also validated to be high through the comparison between mga and ga however there may be a little difference among the fatigue damages based on ea ga and mga as listed in table 2 the main reason is that ga or mga which is a random method may not find the optimal configuration in every optimization nevertheless the optimization results based ga and mga are very close to the optimal results owing to the strict termination criteria in ga and mga which guarantee the reliability of the optimization results some analysis is further conducted to show the reliability of the optimization results 28 times of optimizations of suppression device configuration with 7 strakes are conduced based on mga to test the reliability of optimization results as listed in table 3 the results show that the optimization results are basically the same the optimization results are verified to be reliable in summary ea mga and ga are recommended to be used in optimization problems with strong constraints intermediate constraints and weak constraints in sequence with comprehensive consideration of calculation efficiency and accuracy in the following cases with the number of strakes from one to thirty are calculated based on the proposed method the maximum viv fatigue damage of the riser system with different number of strakes are shown in fig 11 the results show that the viv fatigue of the riser system decreases quickly with the number of strakes firstly and then decreases slowly take case with ten strakes as an example for detailed discussion the optimal configuration of the riser system are shown in fig 12 a yellow parts in fig 12 a represent riser joints with strakes while blue parts represent riser joints without strakes the optimal configuration of strakes are in staggered distribution besides strakes are often uniformly spaced to decrease riser viv fatigue in traditional practice as shown in fig 12 b the riser viv responses of the optimal configuration and the uniformly spaced configuration are calculated and compared with each other as shown in figs 13 and 14 fig 13 a and fig 14 a shows the rms displace of the riser system in typical surface current velocities as listed in table 1 fig 13 b and fig 14 b demonstrates the viv fatigue of the riser system in long term current states the results show that the rms displacement and viv fatigue damage of the riser system with optimal riser configuration is less than that with uniformly spaced configuration the optimization method proposed in this paper can decreases the viv fatigue of risers 4 2 case 2 inequality constraints in practical riser engineering strakes may be hoped to be installed on less than a certain percentage of a riser system sometimes which is a typical optimization problem with inequality constraints inequality constraints is the other constraint condition of the optimization problem except the abovementioned equality constraints compared with equality constraints more generated configurations can satisfy inequality constraints weak constraints therefore ga is often chosen for the configuration optimization in inequality constraint condition cases with different inequality constraints i e 20 40 60 80 and no constraints are calculated respectively based on ga the optimization results in inequality constraint 20 are shown in fig 15 yellow parts in fig 15 a represent riser joints with strakes while blue parts represent riser joints without strakes the results show that just like optimization results in equality constraints the reproduced configurations change with large amplitude and nearly cover the riser system which can guarantee the global optimization as shown in fig 15 a the reproduced configuration converge to the optimal values gradually with the increase in search steps as shown in fig 15 b finally the optimal configuration can be determined through a series of iterative calculations the optimal configuration under different inequality constraints are shown in fig 16 yellow parts in fig 16 represent riser joints with strakes while blue parts represent riser joints without strakes the results show that the distribution of strakes is staggered and ruleless fortunately the optimal configuration can be determined quickly based on the proposed method in this paper the maximum viv fatigue of the riser system with different inequality constraints is shown in fig 17 the results show that the viv fatigue decreases quickly and then slowly as the inequality constraints become weak it seems that more strakes can reduce riser viv fatigue however the number of strakes should be determined considering both riser viv fatigue and project cost in actual riser engineering 5 conclusions in this paper a challenging problem of riser engineering has been addressed the optimization of suppression device configuration of risers evolution theory is introduced to solve the optimization problem based on this idea the suppression device configuration of risers is represented as a gene then the suppression device configuration of a riser system evolves in the direction of decreasing riser viv fatigue through basic genetic operators including reproduction crossover and mutation the proposed optimization strategy for riser engineering has not been explored in the existing literature several optimization methods including ga ea and mga are proposed for the optimization of the suppression device configuration of risers the relevant configuration optimization program for riser engineering is also developed based on matlab then the optimization of the suppression device configuration of risers can be conducted by taking full advantage of the three proposed methods the proposed methods are applied in the configuration optimization of a riser system with equality constraints and inequality constraints respectively the results show that the proposed methods perform optimization design of the suppression device configuration of risers accurately and efficiently the riser viv fatigue is reduced obviously through the optimization design of the suppression device configuration of risers ea mga and ga are recommended to be used in optimization problems with strong constraints intermediate constraints and weak constraints in sequence with comprehensive consideration of calculation efficiency and accuracy the proposed methods provide a practical engineering tool for the optimization design of suppression device configuration of risers which bridge the gap between viv suppression devices and engineering application acknowledgements this work was supported by national natural science foundation of china grant no 51809279 major national science and technology program grant no 2016zx05028 001 05 national program on key basic research project 973 program grant no 2015cb251203 program for changjiang scholars and innovative research team in university grant no irt14r58 fundamental research funds for the central universities grant no 17cx02025a and research initiation funds of china university of petroleum grant no y1703008 
22326,this paper carries out research on the prototype of an autonomous vessel that is normally used for passenger transportation a path generation system is proposed using a dynamic time warping algorithm based on automatic identification system history data in order to ensure strong stability properties a nonlinear controller with globally exponentially stability is introduced for the heading controller the least square support vector machine is employed to estimate the parameters of the control model based on full scale manoeuvring tests the identified results are validated with analytical values the kinematics and control object of path following are presented and a time varying vector field guidance law is proposed for the path following control of autonomous vessels the guidance and control subsystems are interconnected and form a cascade structure the stability of the coupled guidance and control system is carried out using the cascaded system theory the proof ensures that the equilibrium point of the cascaded system is uniformly semiglobally exponentially stable path following scenario was considered in the presence of currents based on a nonlinear manoeuvring model simulation studies were used to verify the theoretical results keywords autonomous vessels guidance and control usges path generation ais data path following nomenclature ais automatic identification system cpmc computerized planar motion carriage clf control lyapunov function dtw dynamic time warping dof degree of freedom gas global asymptotic stable ges globally exponentially stable gnss global navigation satellite system mass maritime autonomous surface ships usges uniformly semiglobally exponentially stable imo international maritime organization ins inertial navigation system ilos integral line of sight los line of sight ls svm least squares support vector machine mmsi maritime mobile service identify ned north east down coordinate system uav unmanned aerial vehicles vhf very high frequency radio vts vessel traffic services b bias term c w ratio of the induced velocity and ideal velocity m mass of the ship kg u v r velocities of surge sway and yaw rate m s rad s u r v r local velocity near propulsor m s m s u v r acceleration of the surge sway and yaw motions m s2 rad s2 x t y t real time location of ship m m x p t y p t original point of path tangential reference frame m m x g gravity centre of the ship in x direction m x r y r location of propulsor m m y e cross track error m c regularization factor c t a loading coefficient i z z yaw moment of inertia with z axis kg m2 k x x kernel function n 0 n u v n u r nondimensionalized hydrodynamic coefficients of yaw motion t draft of the ship m t e ship resistace in straight motion n l pp length between perpendiculars m u speed over ground m s u a inflow velocity near the propulsor m s x p y p n p forces and moment of steerable waterjets n n m x h y h n h surge and sway force yaw moment of bare hull n n m x 0 x v v x v r nondimensionalized hydrodynamic coefficients of surge motion y v y r y v v v nondimensionalized hydrodynamic coefficients of sway motion n v n r n v v v nondimensionalized hydrodynamic coefficients of yawmotion α i lagrange multipliers β crab angle rad β r local drift angle rad γ p rotation angle rad δ pre defined constant w weight matrix ω induced velocity m s ω a ideal induced velocity m s ρ density of water kg m3 l w b e i α i lagrange function μ 11 μ 22 μ 66 added mass and moment of inertia kg kg m2 μ 26 cross inertial due to sway and yaw motion kg m2 i 1 n e i 2 empirical error ϕ x mapping function χ 2 θ chi squared errors χ course angle rad χ d desired course angle rad χ course angle error rad ψ heading angle rad ψ d desired heading angle rad ψ heading angle error rad 1 introduction maritime autonomous surface ships mass have a broad application perspectives in the future maritime industry they are able to perform advanced operations and tasks in dangerous or inaccessible places consequently they have been widely used both in navy applications and even some commercial applications such as marine survey coast patrol inspection and operation of the underwater production system recently automated vessel technology is rapidly transiting from theoretical formulations to the practical applications as the number and scope of the unmanned vessel or autonomous ship projects increase around the globe to illustrate rolls royce 2015 led a new project that could pave the way for autonomous ships and the following year unveiled their version of the future of remote and autonomous shipping world s first official test bed for autonomous shipping opens in norway maritime 2016 and it was set to become a vital facility for the future of shipping kongsberg 2017 announced to build the world s first autonomous and zero emissions ship the international maritime organization imo 2018 endorsed a framework for a regulatory scoping exercise as work in progress including preliminary definitions of maritime autonomous surface ships mass and degrees of autonomy in 2018 rolls royce and finnish 2018 have successfully carried out the sea trials of the world s first fully autonomous ferry the autonomous shipping would bring a huge asset to the marine industry and it also could point out ways of mitigating various problems such as pollution and pirate among others all ships with or over 300 gross tonnage and all passenger ships regardless of size are required to be equipped with automatic identification system ais rong et al 2019 information provided by ais equipment such as unique identification position course and speed is automatically exchanged using vhf radio waves by analysing the ais data it is possible to determine the obvious motion patterns of ship traffic gunnar aarsæther and moan 2009 pallotta et al 2013 therefore the ais has become increasingly important to characterize the ship traffic and related risks in specific maritime areas and have been used by vessel traffic services vts for monitoring and managing ship traffic on busy marine routes silveira et al 2013 in the context of maritime traffic analysis rong et al 2015 have used the concept of ship domain fujii and tanaka 1971 to evaluate near ship collision scenarios in the tagus river estuary using a simulation model of ship navigation in restricted waters developed by rong et al 2014 ais data of ships entering and leaving the port of lisbon were analyzed to obtain the main characteristics of traffic parameters used as input for the traffic simulation model rong et al 2016 have identified and characterized statistically the near ship collision scenarios off the coast of portugal using directly observed ais data of the ship trajectories along the coast however to analyse the historical ais data manually to derive the motion features of ship traffic is an extremely time consuming procedure gunnar aarsæther and moan 2009 have applied computer vision techniques to automatically separate trajectories given by ais data into manoeuvre sequences and grouped ship trajectories according to their similarity from a statistical analysis of these manoeuvre sequences voyage plans of different ship groups were derived etienne et al 2010 have adopted data mining techniques to ships trajectory data in order to identify the spatio temporal patterns of the ships behavior using this approach deviations from the navigation schedule can be detected based on the statistical analysis of the traffic patterns in this study an unsupervised learning method is presented to derive knowledge of ship route from historical ais data the knowledge of ship route consists of the mean route and route boundary information which can be used for path generation guidance and control for the autonomous vessel on the safety of autonomous ships utne et al 2017 clarified categorized and classified the risk related to autonomous marine systems and establish a foundation for risk management perera and murray 2019 studied on identifying the challenges in future ship encounters with possible solutions to improve situation awareness in a mixed environment as the main contribution polvara et al 2018 studied collision detection and path planning methods for usv and discussed the difference between local and global path planners lyu and yin 2019 proposed a real time and deterministic path planning method for autonomous ships in complex and dynamic navigation environments using modified artificial potential fields kurowski et al 2019 studied the autonomous cooperation between vehicles in confined waters like harbors or port entrances and proposed a guidance navigation and control system for multi ships bassam et al 2019 introduced an autonomous tanker ship to study the ship energy efficiency level in ship design for autonomous surface ship guidance system is critically important for the overall performance and safety breivik and fossen 2009 because they are concerned with the transient motion behavior associated with the achievement of motion control scenarios such as path following breivik and fossen 2004 fossen and lekkas 2015 path tracking breivik et al 2008 and path manoeuvring yanushevsky 2011 etc for path following control the objective is to follow a predefined path with a small cross track error the path is usually specified by waypoints fossen 2011 the trajectory can be generated by connecting the way points with straight lines curved lines depending on the requirement of the application line of sight los is a popular and effective guidance law for autonomous marine vehicles and its properties have been studied thoroughly in the literature see liu et al 2015 fossen et al 2015 kelasidi et al 2017 moe and pettersen 2016 moe et al 2016 xu and guedes soares 2015 2018 classical los methods usually rely on a constant look ahead distance by mimicking an experienced sailor a time varying los was introduced by lekkas fossen 2012 by defining the look ahead distance as a function of the cross track error a dynamic version of los can also be found in moreira et al 2007 recently an integral los ilos has been proposed and extensively analyzed it embeds an integral term that compensates the transverse disturbance borhaug et al 2008 caharija et al 2012 lekkas and fossen 2014 caharija et al 2016 a conceptual new ilos based on adaptive control theory was proposed by fossen and lekkas 2015 and it can compensate the drift forces effectively the stability analysis is an important and challenging topic for the cascaded guidance and control system of autonomous vessels fossen and pettersen 2014 for an autonomous vessel global exponential stable ges is usually the most desired quality of a closed loop control system khalil 2002 loría and panteley 2005 since it guarantees additional robustness and performance properties however ges cannot be achieved for this type of system due to the kinematic representation which introduces saturation through the trigonometric functions for autonomous marine ships it is well known that the kinematics introduces saturation through the trigonometric functions fossen and pettersen 2014 global κ exponential stability as defined by sørdalen and egeland 1995 was first proven for these problems and later by pettersen and lefeber 2001 who used a simplified vehicle model global κ exponential stability is a weaker stability property than global exponential stable but stronger than global asymptotic stability gas fredriksen and pettersen 2006 because global κ exponential stability can guarantee the closed loop system is the local exponentially stable this work has been further extended to a more complex ship model see borhaug and pettersen 2005 fredriksen and pettersen 2006 more recently the stability results were strengthened to uniform semiglobal exponential stability usges by fossen and pettersen 2014 usges is very important for the robustness of a system with environmental disturbance it is slightly weaker than ges but stronger than global κ exponential stability lyapunov sufficient conditions for usges of nonlinear time varying systems were presented by fossen and pettersen 2014 and its robustness properties were also discussed in pettersen 2017 the vector field guidance law is a promising guidance law that has been widely used for unmanned aerial vehicles uavs nelson et al 2007 lawrence et al 2008 proved that the vector field guidance law is globally stable using lyapunov techniques wang et al 2018 presented a global uniform bounded stability of the vector field for the arbitrary curves path following nelson et al 2006 2007 proposed a vector field guidance law and implemented it in the guidance system of a small unmanned air vehicle to the authors best knowledge a vector field guidance law with strong stability property has so far not proposed in this paper we proposed a structure of vector field guidance law which is proven to yield usges for the path following problems recently vector field guidance law has been used for path following control of underactuated marine vehicles and provides good performance xu and guedes soares 2016a b caharija et al 2015 compared the ilos guidance and the vector field guidance for an underwater vehicle the structure of this paper is illustrated as in fig 1 as presented in fig 1 the whole study can be divided into two main parts path generating using ais history data and guidance and control system ais data can provide various information such as unique identification position course and speed the raw data was collected and stored in the database after the quality checking and fault detection such as range and wild point testing by analyzing the ais data it is possible to determine the obvious motion patterns of ship traffic the second part is the design and stability analyses of the guidance and control system for maritime autonomous surface ships the main contribution of the paper is to propose a series of time varying vector field guidance laws for path following control of maritime autonomous surface ships the equilibrium point of the time varying vector field guidance law in cascade with a heading autopilot is proved to be usges using cascaded theory to the authors best knowledge only global asymptotic stability of the vector field guidance law has so far been proven in the literature another contribution is the path generations based on ais data in order to get a safe trajectory a history ais data in the tagus river was collected and a dynamic time warping algorithm is used for path generation the manoeuvring model of the catamaran algés is briefly introduced and the control model is identified using least square support vector machine based on the full scale free running manoeuvring test in order to obtain a strong stability property of the cascaded system a sliding mode control is used for heading autopilot design in order to eliminate the chattering a saturating function is introduced in the controller a control lyapunov function clf is employed to derive the control law which guarantees that the equilibrium point of the subsystem is ges using cascaded theory it is possible to show usges of the whole system finally in order to evaluate the performance and robustness of the proposed time varying vector field guidance law path following simulations are studied under the influence of ocean currents the paper is organized as follows section 2 introduces the path generation using ais history data and the dynamic time warping algorithm is also introduced section 3 introduces the nonlinear manoeuvring mathematical model for the catamaran section 4 is a brief introduction to the kinematics of path following control problems and the control object is also given in this section section 5 offers a detailed description of a time varying vector field guidance laws in section 6 a heading autopilot using sliding mode control is presented least square support vector machine is used to estimate the parameter of the control model the control law is derived using a clf and ges of the subsystem is proven in section 7 a theorem is developed to guarantee usges of the nonlinear time varying cascaded system and the detailed proof is also given in this section path following simulation under the influence of ocean currents is presented in section 8 finally the conclusions are presented 2 path generation using ais data the main routes are characterized by statistical analysis of ship trajectories typically trajectories in one route are replicated inevitably with some variations especially in turning sections in addition ship trajectories derived from ais data are of different length and are defined from different number points mainly due to speed variations of the ships along the route in this study the dynamic time warping dtw algorithm is applied to deal with this variability in the trajectory time series 2 1 main routes modelling based on dynamic time warping algorithm the dtw is a well known algorithm in many areas it was first introduced in the 60s bellman and kalaba 1959 and has been extensively explored and applied to the moving objects alignment and matching vlachos et al 2005 and trajectory learning vuković et al 2015 basically the algorithm calculates an optimal match between two given sequences e g ship trajectories with certain restrictions first of all an average route of ship route r can be estimated based on ship trajectories followed this route as described above a route r is built from a cluster of ship trajectories following the same itinerary the centerline of route r then can be estimated by averaging ship trajectories that followed the route r due to inevitable variations and different time series length in ship trajectories dtw based centerline estimation algorithm is applied to deal with the variability in ship trajectories in time series analysis dtw is one of the algorithms for aligning two temporal sequences which may vary in speed for instance alignments in ship trajectories can be detected using dtw even if there are accelerations and decelerations during the course of an observation basically the algorithm calculates an optimal match between two given sequences e g ship trajectories with certain restrictions and rules table 1 for two time series x x 1 x 2 x 3 x n of length n and y y 1 y 2 y 3 y n of length m a n m warping path is a sequence γ γ 1 γ l γ l with γ l n l m l 1 n 1 m for l 1 l satisfying the following three conditions 1 boundary condition γ 1 1 1 and γ l n m 2 monotonicity condition n 1 n 2 n l and m 1 m 2 m l 3 step size condition γ l 1 γ l 1 0 0 1 1 1 for l 1 l a n m warping path γ γ 1 γ l γ l defines an alignment between two time series x x 1 x 2 x 3 x n and y y 1 y 2 y 3 y n by assigning the element x n l of x to the element y n l of y the boundary condition enforces that the first elements of x and y as well as the last elements of x and y are aligned to each other in other words the alignment refers to the entire sequences x and y it should be mentioned that all elements in both time series are aligned which might require repeating elements from a time series but in the alignment it cannot be simultaneously repeated an element in both time series according to condition 2 the step size condition expresses a kind of continuity condition which means no element in x and y can be omitted and there are no replications in the alignment fig 2 shows an example of dtw alignment between two trajectories the optimal match represented by black dots as shown in fig 2 a is denoted by the match that satisfies all restrictions and the rules mentioned above these two ship trajectories contain 34 and 38 positions represented by red dots and blue dots in fig 2 a respectively the position sequences are warped non linearly in the index dimension to determine a measure of their similarity independent of certain non linear variations in the ship positions algorithm 1 dtw algorithm for estimation mean route image 1078023 after each trajectory within the shipping route is aligned the mean route can be derived from the arithmetic mean of the aligned positions let n be the number of trajectories belonging to the route r t r a j 1 t r a j 2 t r a j 3 t r a j n the dtw algorithm for estimation the mean route r is given in algorithm 1 when ships navigate in an open sea it is normal that ship trajectories deviate from the centreline while falling within a certain area this deviation may vary along the centreline that represents the spatial extent of the ship route in this study another property of ship route is the route boundary r b l b r b which consists of two sequences estimated by the centreline r and ship trajectories in the route it should be mentioned that the left and right boundary is defined by the left hand rule with centreline increasing downstream the algorithm for the ship route boundary determination is given in algorithm 2 algorithm 2 ship route boundary determination image 10264 once the mean route r and route boundary rb are determined in order to optimize the computation time for path generation method the mean route r and route boundary rb are simplified using a filter initially proposed by douglas and peucker 1973 the goal of this filter is to retain only significant positions of the mean route r and route boundary rb while keeping information about heading changes 2 2 waypoint determination on catamaran ferry route the ais data employed in this study were collected from 1st october to 31st december 2015 and the study area in this paper is bounded by parallels 38 62 n and 38 74 n and by meridians 8 95 w and 9 21 w fig 3 a shows the ais data that are used in this study which exhibits several overlapping and well defined traffic patterns as shown in fig 3 b there are submerged reef and tidal flat near the harbour which cannot be observed from the map so the resulted trajectory using ais data is a simple and practical one because the ais data usually represents the real and safe trajectory of the ship in history to identify main trajectories i e main traffic patterns the ais data are sorted by maritime mobile service identify mmsi number and time to construct a time series of each vessel s trajectory and result in 621 ship trajectories a clustering algorithm is used to group similar trajectories based on the hausdorff distance a superior limit of 500 m hausdorff distance is adapted to group similar ships trajectories and the montijo ferry route is applied in this study to test the method for the autonomous vessel as shown in fig 4 there are 1280 trajectories of 6 ships the numbers of positions are 25 269 next the main route followed by most of the trajectories is computed by statistical analysis using the dtw algorithm ship trajectories can be aligned and the median track can be derived by averaging the aligned elements as the time series reconstructed from ais data have heterogeneous sample rates the application of the dtw algorithm is well suited to measure the variations within each individual ship trajectory in addition the dtw algorithm is similarity based that enable to capture the curvature feature of the shipping route which is generated in controlled circumstances the desired output of mean route and route boundary based on dtw algorithm is sets of time series as shown in fig 5 3 nonlinear manoeuvring mathematical model in this section a nonlinear manoeuvring mathematical model is briefly introduced for a marine surface vessel the motions can be described in 6 degree of freedoms dofs as illustrated in fig 6 they are the surge sway heave roll pitch and yaw but the manoeuvring problem the motions in 3 dof surge sway and yaw are typically considered because the manoeuvring motion occurs with a much lower frequency than the wave encounter frequencies sutulo and guedes soares 2011 so it is reasonable to neglect the fluid memory effects fossen 2011 assuming a ship moving in a horizontal plane as presented in fig 7 two different coordinate systems north east down ned and body fixed frame are defined the ned is usually defined as the tangent plane on the surface of the earth the body frame is a moving coordinate frame that is fixed to the craft the manoeuvring mathematical model is usually defined in the body fixed frame without loss of generality any ship can be treated as the free rigid body moving under the action of the external forces and moments the euler equations of arbitrary motion in the horizontal plane are given 1 m μ 11 u m v r m x g r 2 x h x p m μ 22 v m x g μ 26 r m u r y h y p m x g μ 26 v i z z μ 66 r m x g u r n h n p where m and i z z are the mass and the moment of inertia respectively x g is the position of centre of mass in the x direction μ 11 μ 22 and μ 26 are the added masses and moments respectively x h y h and n h are the hydrodynamic forces and moments of the bare hull x p y p and n p are the forces and moments of the steerable waterjets the bare hull added masses are calculated using empirical formulae approximating ellipsoidal data more details can be found in ferrari et al 2016 2015 quasi polynomials are employed to approximate the hydrodynamic forces and moments x h y h and n h because the quasi polynomials can be slightly more economical from the viewpoint of the number of terms and computation speed even the corresponded response surface is not smooth everywhere sutulo and guedes soares 2011 sutulo and guedes soares 2004 the mathematical model for surge sway and yaw motion are given 2 x h x 0 x v v v v x v r v r x r r r r y h y v v y r r y v v v v 3 y r r r r 3 y v v r v 2 r y v r r v r 2 n h n v v n r r n v v v v 3 n r r r r 3 n v v r v 2 r n v r r v r 2 in order to compare the coefficients of different ships and to estimate the dynamics of a full size ship the hydrodynamic parameters need to be converted to dimensionless ones the prime system recommended by sname 1950 will be used to normalize the hydrodynamic coefficients the water density ρ the ship length l and the ship speed u are employed as the characteristic dimensional parameter the forces are normalized with 0 5 ρ u 2 l t and the moment with 0 5 ρ u 2 l 2 t where t is the draft at the midship the nondimensionalized velocities and yaw rate are u u u v v u r r l u more detailed information on particulars of the catamaran can be found in ref lúcia moreira and guedes soares 2012 fig 8 the propulsion system of the catamaran consists of two steerable waterjet propulsors each of them is installed in the aft part of the single hull and can be operated independently from the other the generated thrust and steering angle can be different the classic actuator disk theory is used to approximate the forces generated by the waterjet propulsor ferrari et al 2016 3 x p t e 1 c w cos δ 1 y p t e c w sin δ where t e is equal to the ship resistance in straight motion c w is the ratio of the induced velocity ω and the ideal one ω a ω is the induced velocity at infinity taking into account the deflection of the propulsor ω a is the velocity derived from the ideal propulsor theory 4 kinematics of path following guidance and control system are typical components for an autonomous vessel and usually are of critical importance for the overall performance of system a typical guidance and control system for marine crafts is shown in fig 9 where several assumptions are given firstly the crab angle β is assumed to be directly measured using an inertial navigation system ins aided by a global navigation satellite system gnss lekkas and fossen 2014 so the crab angle β due to the environmental disturbance can be compensated second various sensors are available and the motions of the ship can be measured correctly the waypoints are generated by the path generations block using the ais data as discussed in the preceding section the resulted path is more practical and safer for the autonomous ship travelling in a complex environment especially the offshore area with submerged reef and tidal flat because the ais data usually represents the real and safe trajectory of the ship in history in this section the kinematics of two dimensional path following guidance problems is briefly reviewed and the control objective is given for a marine surface ship two dimensional path following is typically considered but for underwater vessels it is a three dimensional problem because the depth is needed to be controlled it can be solved independently in the horizontal and vertical planes a marine craft is assumed to follow a pre defined straight path as shown in fig 10 three coordinate frames are defined in fig 10 for example the curved path is defined in the north east down ned frame the body fixed frame is a moving coordinate frame that is fixed to the craft the path tangential frame is a moving coordinate frame whose origin is the projection of the ship s centre of gravity more details about the definition of the frames can be found in fossen 2011 4 1 control objective consider a marine craft moving in a horizontal plane a two dimensional continuous c 0 path is predefined as the straight line that connects the adjacent points the path is assumed to go through the predefined way points x j y j for j 1 n the path tangential angle γ p is the rotation angle relative to the inertial frame hence the path tangential reference frame can be found by rotating an angle γ p in ned reference frame using the rotation matrix 4 r γ p cos γ p sin γ p sin γ p cos γ p s o 2 by inspection of fig 10 the cross track error can be calculated using 5 0 y e r t γ p x t x p t y t y p t where x t y t is the ship s position in real time x p t y p t is the origin point of a path tangential reference frame expanding 5 leads to the normal line 6 y t y p t x t x p t 1 tan γ p and the cross track error y e 7 y e t x t x p t sin γ p y t y p t cos γ p obviously the aim of the path following is to control the ship to follow the predefined path with zero cross track error so the control objective for straight line path following is given 8 lim t y e t 0 4 2 kinematic equations the kinematic equations of a marine vessel in a horizontal plane can be described using the velocity of the surge sway and yaw u v and r it is given as 9 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r where ψ is the yaw angle which can be measured using a compass differentiation of 7 is given as 10 y e x x p sin γ p y y p cos γ p x x p cos γ p y y p sin γ p γ p it can be further simplified by substituting eqs 6 and 9 into eq 10 and the definition of γ p resulting 11 y e x sin γ p y cos γ p u cos ψ v sin ψ sin γ p u sin ψ v cos ψ cos γ p u sin ψ γ p β where u is the ground speed of a ship u u 2 v 2 and it can be directly measured using gnss lekkas and fossen 2014 the phase β atan2 v u is recognized as crab angle it is the difference in heading angle ψ and course angle χ moreover 12 χ ψ β finally the time differential for y e becomes 13 y e u sin χ γ p 5 time varying vector field guidance law this section presented a time varying vector field law for path following control the main motivation behind the vector field guidance law is to generate vectors around the predefined path the vectors denote the desired travelling direction for the autonomous vessels as presented in fig 11 a vector field is generated along the predefined straight path obviously if the ship tracks the vectors it will follow the path here a time varying vector field guidance law is proposed as the following 14 χ d ψ d β γ p tan 1 sgn y e y e δ θ t y e γ p sgn y e tan 1 y e δ θ t y e where θ t y e is a time varying function to be defined later and δ 0 is a pre defined constant the course angle tracking error satisfies 15 χ χ χ d ψ ψ d ψ substituting 14 and 15 into 13 gives 16 y e u sin ψ sgn y e tan 1 y e δ θ t y e expand the formula using the property sin a b sin a cos b cos a sin b gives 17 y e u sin ψ cos tan 1 y e δ θ t y e sgn y e u cos ψ sin tan 1 y e δ θ t y e which can be simplified by using the trigonometry equation sin tan 1 x x 1 x 2 moreover 18 y e u sin ψ δ θ t y e δ 2 θ t y e y e 2 θ t y e sgn y e u cos ψ y e θ t y e δ 2 θ t y e y e 2 θ t y e sgn y e u y e θ t y e δ 2 θ t y e y e 2 θ t y e f 1 t y e u ϕ t y e ψ ψ g t y e ψ where ϕ t y e ψ is defined as 19 ϕ t y e ψ sin ψ χ δ θ t y e δ 2 θ t y e y e 2 θ t y e sgn y e cos ψ 1 χ y e θ t y e δ 2 θ t y e y e 2 θ t y e here the function ϕ t y e ψ is upper bounded ϕ t y e ψ c for all y e and ψ assume that 0 δ min δ δ max as can be observed the sub function sin x x 1 and cos x 1 x 0 73 are upper bounded and 20 δ θ t y e δ 2 θ t y e y e 2 θ t y e 1 y e θ t y e δ 2 θ t y e y e 2 θ t y e 1 consequently it can be concluded that the ϕ t y e ψ is upper bounded moreover c 1 73 will be an upper bound for ϕ t y e ψ fossen and lekkas 2015 6 nonlinear controller for autopilot 6 1 nonlinear control and stability analysis in this section in order to obtain strong stability properties a nonlinear control technology sliding model controller is used for the heading autopilot design for the path following of autonomous vessels the control law is derived using the lyapunov function and the proof of globally exponentially stability ges will be also presented the nomoto model is used for the control design it is derived from the linearized manoeuvring model and widely used to describe the yaw dynamics of a marine vessel due to its simple structure fossen 2011 a sliding mode controller for heading autopilot design is given 21 ψ r t r r k δ b 0 where t and k are the nomoto time and gain constants respectively b 0 b max is a bounded bias term due to environmental disturbance and unmodeled dynamics and δ is the rudder deflection angle define the heading error as ψ ψ ψ d note that χ ψ so it is sufficient to analyse the heading error dynamics which is expressed in terms of the sliding surface 22 s d d t λ 2 0 t ψ τ d τ ψ 2 λ ψ λ 2 0 t ψ τ d τ s 0 λ s 0 where s 0 ψ λ 0 t ψ τ d τ and λ is a design constant which reflect the bandwidth of the controller fossen 2011 when s 0 eq 22 describes a sliding surface with exponentially stable dynamics then the error dynamics can be expressed in state space form as 23 ψ s 0 λ λ 0 λ a ψ s 0 1 1 b s define the signal r r r s and substitute into eq 21 gives 24 t s s k δ t r r r r b 0 considering the stability the control law can be chosen as 25 δ 1 k t r r r r k d s η sgn s where k d 0 is the feedback control gain which is used to speed up the convergence of the tracking error s to zero sgn s is the signum function η b max is a positive design gain which is determined by lyapunov stability analysis slotine and li 1991 substituting 25 into 24 give 26 t s 1 k d s η sgn s b 0 in the following part the stability of the sliding mode controller is given consider the control lyapunov function clf 27 v 2 x t p x 1 2 t s 2 where x ψ s 0 t and p p t 0 is given by 28 p a a t p q i where q 0 is a specified constant hence it follows that 29 v 2 x t a t p p a x 2 x t p b s 1 k d s 2 b 0 s η s q x 2 2 x p s 1 k d s 2 x s q p p 1 k d x s from eq 29 in order to imply that v 2 0 the feedback control gain k d need to be carefully chosen assume λ max p is the maximum eigenvalue of p 30 q λ max p λ max p 1 k d 0 then the control gain can be defined as k d λ max p 2 q 1 0 which clearly implies that v 2 is negative hence the equilibrium point ψ s 0 t 0 is globally exponentially stable ges theorem 4 10 in khalil 2002 as discussed in fossen and lekkas 2015 it is practical to treat the k d and η as tunable parameters because it is easy to satisfy the gain requirements for a marine craft described by the nomoto model in order to eliminate the chattering in the sliding mode controller a saturating function tanh s ϕ is introduced where ϕ is a positive parameter used to shape the slope of the saturating function this function serves as a low pass filter structure to the dynamics inside the boundary layer fossen 2011 then the control law can be given as 31 δ 1 k t r r r r k d s η tanh s ϕ 6 2 parameter estimation using ls svm as discussed above the nonlinear controller based on nomoto model is proposed and strong stability ges is also obtained in the following part the parameters of nomoto model need to be estimated in order to obtain the parameters the full scale manoeuvrability trials were conducted in the transtejo s catamaran which properties are listed in table 2 the test was carried out in windy conditions the absolute wind speed varied from 15 to 35 knots wind force between 4 and 7bft during the tests these trails were carried out in water depths varying from 2 4 to 7 4 m more details on the trails can be found in guedes soares et al 1999a b moreira and guedes soares 2012 here 20 20 zigzag manoeuvre test carried out at 80 full speed is used to estimate the parameters the deflection angle of the steerable nozzle yaw angle and yaw rate are shown in fig 12 here the deflection angle of the steerable nozzle is denoted as rudder angle system identification technology is used to obtain the parameters system identification has been widely used in the modelling of ship steering and different approaches have been adopted fossen et al 1996 sutulo and guedes soares 2014 xu et al 2018a b xu and guedes soares 2019 perera et al 2015 applied an extended kalman filter to identify a nonlinear ocean vessel steering model velagic et al 2003 used an adaptive fuzzy gain autopilot for ship track keeping recently a robust method support vector machine luo et al 2016 2014 luo and zou 2009 xu et al 2019a b c zhang and zou 2011 was applied to identify the ship manoeuvring model and performed satisfactorily in the following part ls svm is used to estimate the parameters based on the zigzag manoeuvring test more details of the ls svm for parameter estimation can be found in appendix a for ls svm the regularization factor c 2544 is chosen luo et al 2016 the nomoto time and gain constants are the parameters to be identified the identification and experimental heading curves are in good agreement which is presented in fig 13 k is equal to 0 1258 and t is equal to 5 1973 in order to validate the accuracy of the result of system identification the analysis method presented in clarke 2003 journee 1970 will be used to obtain the parameters if eq 21 is integrated with respect to time t the following equation results 32 t 0 t r d t 0 t r d t k 0 t δ d t by choosing the range of time the parameters k and t can be given in the following equation 33 k ψ 1 ψ 2 t 1 t 2 δ d t k t r 3 r 4 t 3 t 4 δ d t as shown in fig 14 a in the restricted area the yaw velocity r is constant and the derivative of the yaw velocity is zero according to eq 33 the parameter k can be found as k 0 1424 similarly eq 33 is applied to the first two zero crossing points of the heading record as shown in fig 13 in this case the heading ψ is equal to zero and t t 5 8437 can be calculated from eq 33 the identified parameters are near the analytical values so the ls svm can provide a robust estimation using zigzag manoeuvring test 7 stability analysis of the cascaded system guidance and control system the two sub systems described by eqs 18 and 21 are interconnected and form a cascade structure error dynamics of the cascaded system can be described in fig 15 where σ2 is the driving system and σ1 is the driven system the driving system is the autopilot control system since the convergence to the desired heading angle ψ d affects the stability of the guidance system by the function g t y e ψ however the guidance system perturbs the autopilot control system due to the cross track error y e appears in the vector field guidance law equation as presented in eq 14 the error dynamics of the cascaded system is defined as 34 σ 1 y e sgn y e u y e θ t y e δ 2 θ t y e y e 2 θ t y e f 1 t y e u ϕ t y e ψ g t y e ψ ψ 35 σ 2 ψ f 2 t ψ where f 2 t ψ defines the course tracking error dynamics discussed in section 6 the vehicle dynamics along with the heading controller is the driving system σ2 and the vehicle in combination with the time varying vector field guidance law constitutes the driven system σ1 the yaw angle tracking error affects the convergence of the guidance system s objective which is to minimise the cross track error y e as can be observed from eqs 34 and 35 the function θ t y e plays an important role in the stability analysis of the cascaded system it controls the converging speed of the cross track error the value of θ t y e should increase with the cross track error y e this ensures that when the system has a higher converge rate when the cross track error is large so the definition and properties of the function θ t y e should be given first definition 1 the time varying function θ t y e is a non decreasing positive semi definite function and θ t y e 0 1 furthermore 36 θ t y e 0 property 1 the time varying function θ t y e stratifies the definition 1 and guarantees that the function g t y e y e θ t y e 1 is continuous positive defined and lower bounded moreover 37 0 c r g t y e the stability properties of the cascaded system defined in eqs 34 and 35 are given by theorem 1 it guarantees that the cascade system of the time varying vector field guidance law and heading autopilot is uniform semiglobal exponential stability usges it needs to point out that usges is slightly weaker than global exponential stability ges which is usually the most desired property for the dynamic system because ges guarantees that any oscillations in the output will decay at an exponential rate but in this case ges cannot be achieved due to the definition of the cross track error dynamics 10 which is saturated due to the sinusoidal function usges is slightly stronger than the global κ exponential stability proven in fredriksen and pettersen 2006 due to the convergence properties theorem 1 assume that the control law eq 25 is used to stabilize the system σ2 and that the time varying vector field guidance law eq 14 specifies the desired heading angle ψ d for the system σ1 then the equilibrium point y e ψ 0 0 of the system 34 35 is usges if the function θ t y e satisfies property 1 and the predefined parameter δ satisfies 0 δmin δ δmax for speeds 0 umin u umax proof see appendix b as discussed before the time varying function θ t y e need to be chosen carefully in order to guarantee the strong stability property of the cascaded system here a linear function is chosen 38 θ t y e c y e 1 where c is a positive constant this function increases with variable ye and the function g t y e is continuous positive defined and lower bounded 39 g t y e y e θ t y e 1 y e c y e e c 1 e 0 8 simulations in order to evaluate and compare the performance and robustness of the proposed guidance and control system path following is carried out in the simulation study the ship considered is the 3 dof surge sway and yaw nonlinear mathematical model of the catamaran this manoeuvring model is comprehensive and it gives highly realistic results the hydrodynamic coefficients were estimated based on captive model tests more details about the mathematical model and hydrodynamic coefficients can be found in reference sutulo and guedes soares 2006 the obtained manoeuvring model was used for automatic berthing ferrari et al 2016 2015 the goal of path following is to follow a trajectory which is specified in terms of way points the way points are calculated based on the ais history data and defined in a geographic coordinate system where latitude and longitude are used as suggested in fossen 2011 the north east down ned coordinate system is used for marine vessels control the geometrical information of predefined straight path in a geographic coordinate system is presented in fig 16 a the autonomous vessel is going from terreiro do paco station in lisbon to montijo it is a tourism line runs by transtejo soflusa the trip takes around 20 min and provides a chance to enjoy views of lisbon river the tagus the path expressed in the ned frame is presented in fig 16 b without loss of generality the initial position of the ship is assumed to be the origin during the simulation the current is chosen as the main environment disturbance the current with constant magnitude and direction u c 2 m s and β c 45 deg is considering in the simulation the rudder saturation δ 32 deg and the initial conditions are given u 0 10 3 m s ψ 0 26 deg and r 0 0 the desired speed is kept as constant during the simulation the heading controller parameters are selected as k d 0 4 η 1 and λ 0 1 we have chosen the time varying function as θ t y e 0 04 y e 1 while the time varying vector field guidance law is given by eq 17 obviously the proposed time varying vector field guidance law satisfies property 1 and hence the system equilibrium point is usges the predefined parameter δ 2l pp is chosen as twice the ship length when the ship is moving along the straight line a switching mechanism for selecting the next waypoint is needed for this purpose a circle of acceptance with radius r 4l pp around the waypoints is chosen considering the ship s speed when the ship enters the transition area of the way points x k 1 x t 2 y k 1 y t 2 r 2 the next way point should be selected the guidance and control system will control the ship to follow the next segment of the predefined path fig 17 presents the real time trajectory of the ship blue line and the desired path red line in the presence of a current with constant magnitude and direction fig 17 a shows the trajectories in the ned coordinate system as shown in the figure the ship can follow the straight line path in the presence of an ocean current during the transition of the way points the route is smooth and without any overshoot fig 17 b are the trajectories of the ship expressed in the geographic coordinate system during the simulation in fig 18 the yaw angle surge speed desired versus true and sway speed are presented as shown in fig 18 the real time heading angle agrees with the desired angle very well which indicated that the heading autopilot has an excellent performance during the simulation the total speed was constant there are some oscillations of the surge speed during the transition of the way points due to the effect of the ocean current when the ship manoeuvres the sway speed is kept as zero when the ship stays on the predefined path the course angles desired versus true as well as the crab angle are plotted in fig 19 there is a small difference between the true values and the desired values due to the crab angle or drift angle because the proposed autopilot is used to stabilize the heading angle as presented in fig 18 fig 20 shows the deflection angle of the steerable nozzle and the cross track errors during straight line path following the deflection angle of the steerable nozzle is stable and kept as zero when the ship stays on the predefined path it means that the chattering of the sliding mode controller is eliminated successfully the lower plot in fig 20 is the cross track errors during the simulation the cross track error indicated the performance of the proposed guidance and control system however it should be noted that the cross track error is actually the input for the guidance sub system it is a bit different with the distance from the path in common sense especially during the ship enters the transition area of the way points the circle of acceptance when the ship lies within the circle of acceptance the next way point is selected so the cross track error is the distance from the next segment of the path the ship is actually following the previous segment of the path this can be observed from fig 17 the ship follows the path with a small error during the transition area of the way points but the cross tack errors are large when the ship turns to the next way point 9 conclusions a system combining path generation guidance and control for a prototype of autonomous catamaran ferry was presented in this paper considering the complex traffic environment in the harbour a path generation system based on dtw algorithm was proposed dtw algorithm calculates the safety trajectory as well as boundaries using the ais data which was collected in the tagus river a nonlinear manoeuvring mathematical model of a catamaran ship in 3 dof surge sway and yaw is briefly introduced the least square support vector machine was employed to estimate the parameters of the control model using the full scale manoeuvrability trials this paper indicated that the guidance and control systems are coupled together where the control sub system is the driving system and guidance sub system is the driven system lyapunov based sliding mode control has been used for heading autopilot design and globally exponentially stability ges was proven a saturating function is introduced to eliminate the chattering in the sliding mode controller a nonlinear time varying vector field guidance law was proposed for the autonomous catamaran ferry using lyapunov stability theory for nonlinear cascaded systems the coupled guidance and control system was proven usges and the proof was also presented to evaluate the performance and robustness of the cascaded system the path following simulation was carried out in the presence of an ocean current the simulation showed that the cascade system is robust with constant external disturbance and the proposed time varying vector field guidance law is capable of following the predefined paths declaration of competing interest there are no conflicts of interest acknowledgements this work was performed within the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 this work is a contribution to the project m mships maneuvering moored ships in ports ptdc emstra 5628 2014 funded by the fct appendix a least square support vector machine for parameter estimation for regression purposes support vector regression gives a general approximation function form suykens et al 2002 a 1 y w t φ x b where x is the training sample y r n y is the target value y r w t φ x b is the prediction for that sample b is the bias term ω is a weight matrix φ is a nonlinear kernel function that can map the training sample to a high dimensional feature space in order to minimise the structural risk which provides a trade off between hypothesis space complexity and the empirical error a cost function is defined as follows a 2 min w b e f w e 1 2 w t w 1 2 c i 1 l e i 2 s u b j e c t t o y i w t φ x i b e i where e i i 1 l are error variables and c is the regularization factor the minimization of w t w is closely related to the use of a weight decay term in the training of neural networks and the i 1 l e i 2 controls the trade off between the empirical error and the model complexity cortes and vapnik 1995 the lagrangian function can be constructed as a 3 l w b e α 1 2 w t w 1 2 c i 1 l e i 2 i 1 l α i w t φ x i b e i y i where αi are the lagrange multipliers the optimality conditions are defined by computing the derivatives of a 3 with respect to ω b e α a 4 l w 0 w i 1 l α i φ x i l b 0 i 1 l α i 0 l e i 0 α i c e i l α i 0 w t φ x i b e i y i 0 after elimination of variables ω and ei from equation a 4 and applying the kernel function this allows working in high dimensional feature spaces without explicit computations on them the ls svm model for function estimation yield a 5 y x i 1 l α i k x x i b where k is the kernel function that represents an inner product between its operands the kernel must be positive definite and must satisfy the mercer condition suykens et al 2002 vapnik 1995 in order to obtain the parameters the linear kernel function is adopted for the ls svm appendix b proof of theorem 1 proof as shown in section 6 the equilibrium point ψ 0 and thus χ 0 of the heading autopilot system σ2 given by 35 is ges the nominal system σ1 system with ψ 0 is b 1 y e sgn y e u y e θ t y e δ 2 θ t y e y e 2 θ t y e system b 1 is nonautonomous sine the function θ t y e is time varying consider the clf b 2 v 1 t y e 1 2 y e 2 where v 1 t y e 0 if y e 0 the time derivative is b 3 v 1 t y e sgn y e y e u y e θ t y e δ 2 θ t y e y e 2 θ t y e u y e θ t y e 1 δ 2 θ t y e y e 2 θ t y e since v 1 t y e 0 and v 1 t y e 0 according to theorem 4 8 by khalil 2002 the equilibrium point is uniformly stable moreover b 4a y e t y e t 0 t t 0 rewriting b 3 as in b 5 and define φ t y e as b 4b φ t y e u y e θ t y e 1 δ 2 θ t y e y e 2 θ t y e gives b 5 v 1 t y e φ t y e y e 2 for y e b r where b r x b r x r and from property 1 it then follows that b 6 φ t y e u y e θ t y e 1 δ 2 θ t y e y e 2 θ t y e u min c r δ max 2 θ t 0 r r 2 θ t 0 r c r then b 7 v 1 t y e φ t y e y e 2 2 c r v 1 t y e y e b r considering b 4 the above equation holds for all trajectories generated by the initial conditions y e t 0 using the comparison lemma lemma 3 4 by khalil 2002 eq b 7 has the solution v 1 t y e e 2 c r t t 0 v 1 t 0 y e t 0 therefore b 8 y e t e 2 c r t t 0 y e t 0 t t 0 and y e t 0 b r hence we can conclude that the equilibrium point y e 0 of the nominal system σ1 system with ψ 0 is usges definition 2 7 by loría and panteley 2005 finally under the property 1 the equilibrium point y e 0 ψ 0 of the cascaded system described by 34 35 is usges fossen and pettersen 2014 panteley et al 1998 panteley and loria 1998 
22326,this paper carries out research on the prototype of an autonomous vessel that is normally used for passenger transportation a path generation system is proposed using a dynamic time warping algorithm based on automatic identification system history data in order to ensure strong stability properties a nonlinear controller with globally exponentially stability is introduced for the heading controller the least square support vector machine is employed to estimate the parameters of the control model based on full scale manoeuvring tests the identified results are validated with analytical values the kinematics and control object of path following are presented and a time varying vector field guidance law is proposed for the path following control of autonomous vessels the guidance and control subsystems are interconnected and form a cascade structure the stability of the coupled guidance and control system is carried out using the cascaded system theory the proof ensures that the equilibrium point of the cascaded system is uniformly semiglobally exponentially stable path following scenario was considered in the presence of currents based on a nonlinear manoeuvring model simulation studies were used to verify the theoretical results keywords autonomous vessels guidance and control usges path generation ais data path following nomenclature ais automatic identification system cpmc computerized planar motion carriage clf control lyapunov function dtw dynamic time warping dof degree of freedom gas global asymptotic stable ges globally exponentially stable gnss global navigation satellite system mass maritime autonomous surface ships usges uniformly semiglobally exponentially stable imo international maritime organization ins inertial navigation system ilos integral line of sight los line of sight ls svm least squares support vector machine mmsi maritime mobile service identify ned north east down coordinate system uav unmanned aerial vehicles vhf very high frequency radio vts vessel traffic services b bias term c w ratio of the induced velocity and ideal velocity m mass of the ship kg u v r velocities of surge sway and yaw rate m s rad s u r v r local velocity near propulsor m s m s u v r acceleration of the surge sway and yaw motions m s2 rad s2 x t y t real time location of ship m m x p t y p t original point of path tangential reference frame m m x g gravity centre of the ship in x direction m x r y r location of propulsor m m y e cross track error m c regularization factor c t a loading coefficient i z z yaw moment of inertia with z axis kg m2 k x x kernel function n 0 n u v n u r nondimensionalized hydrodynamic coefficients of yaw motion t draft of the ship m t e ship resistace in straight motion n l pp length between perpendiculars m u speed over ground m s u a inflow velocity near the propulsor m s x p y p n p forces and moment of steerable waterjets n n m x h y h n h surge and sway force yaw moment of bare hull n n m x 0 x v v x v r nondimensionalized hydrodynamic coefficients of surge motion y v y r y v v v nondimensionalized hydrodynamic coefficients of sway motion n v n r n v v v nondimensionalized hydrodynamic coefficients of yawmotion α i lagrange multipliers β crab angle rad β r local drift angle rad γ p rotation angle rad δ pre defined constant w weight matrix ω induced velocity m s ω a ideal induced velocity m s ρ density of water kg m3 l w b e i α i lagrange function μ 11 μ 22 μ 66 added mass and moment of inertia kg kg m2 μ 26 cross inertial due to sway and yaw motion kg m2 i 1 n e i 2 empirical error ϕ x mapping function χ 2 θ chi squared errors χ course angle rad χ d desired course angle rad χ course angle error rad ψ heading angle rad ψ d desired heading angle rad ψ heading angle error rad 1 introduction maritime autonomous surface ships mass have a broad application perspectives in the future maritime industry they are able to perform advanced operations and tasks in dangerous or inaccessible places consequently they have been widely used both in navy applications and even some commercial applications such as marine survey coast patrol inspection and operation of the underwater production system recently automated vessel technology is rapidly transiting from theoretical formulations to the practical applications as the number and scope of the unmanned vessel or autonomous ship projects increase around the globe to illustrate rolls royce 2015 led a new project that could pave the way for autonomous ships and the following year unveiled their version of the future of remote and autonomous shipping world s first official test bed for autonomous shipping opens in norway maritime 2016 and it was set to become a vital facility for the future of shipping kongsberg 2017 announced to build the world s first autonomous and zero emissions ship the international maritime organization imo 2018 endorsed a framework for a regulatory scoping exercise as work in progress including preliminary definitions of maritime autonomous surface ships mass and degrees of autonomy in 2018 rolls royce and finnish 2018 have successfully carried out the sea trials of the world s first fully autonomous ferry the autonomous shipping would bring a huge asset to the marine industry and it also could point out ways of mitigating various problems such as pollution and pirate among others all ships with or over 300 gross tonnage and all passenger ships regardless of size are required to be equipped with automatic identification system ais rong et al 2019 information provided by ais equipment such as unique identification position course and speed is automatically exchanged using vhf radio waves by analysing the ais data it is possible to determine the obvious motion patterns of ship traffic gunnar aarsæther and moan 2009 pallotta et al 2013 therefore the ais has become increasingly important to characterize the ship traffic and related risks in specific maritime areas and have been used by vessel traffic services vts for monitoring and managing ship traffic on busy marine routes silveira et al 2013 in the context of maritime traffic analysis rong et al 2015 have used the concept of ship domain fujii and tanaka 1971 to evaluate near ship collision scenarios in the tagus river estuary using a simulation model of ship navigation in restricted waters developed by rong et al 2014 ais data of ships entering and leaving the port of lisbon were analyzed to obtain the main characteristics of traffic parameters used as input for the traffic simulation model rong et al 2016 have identified and characterized statistically the near ship collision scenarios off the coast of portugal using directly observed ais data of the ship trajectories along the coast however to analyse the historical ais data manually to derive the motion features of ship traffic is an extremely time consuming procedure gunnar aarsæther and moan 2009 have applied computer vision techniques to automatically separate trajectories given by ais data into manoeuvre sequences and grouped ship trajectories according to their similarity from a statistical analysis of these manoeuvre sequences voyage plans of different ship groups were derived etienne et al 2010 have adopted data mining techniques to ships trajectory data in order to identify the spatio temporal patterns of the ships behavior using this approach deviations from the navigation schedule can be detected based on the statistical analysis of the traffic patterns in this study an unsupervised learning method is presented to derive knowledge of ship route from historical ais data the knowledge of ship route consists of the mean route and route boundary information which can be used for path generation guidance and control for the autonomous vessel on the safety of autonomous ships utne et al 2017 clarified categorized and classified the risk related to autonomous marine systems and establish a foundation for risk management perera and murray 2019 studied on identifying the challenges in future ship encounters with possible solutions to improve situation awareness in a mixed environment as the main contribution polvara et al 2018 studied collision detection and path planning methods for usv and discussed the difference between local and global path planners lyu and yin 2019 proposed a real time and deterministic path planning method for autonomous ships in complex and dynamic navigation environments using modified artificial potential fields kurowski et al 2019 studied the autonomous cooperation between vehicles in confined waters like harbors or port entrances and proposed a guidance navigation and control system for multi ships bassam et al 2019 introduced an autonomous tanker ship to study the ship energy efficiency level in ship design for autonomous surface ship guidance system is critically important for the overall performance and safety breivik and fossen 2009 because they are concerned with the transient motion behavior associated with the achievement of motion control scenarios such as path following breivik and fossen 2004 fossen and lekkas 2015 path tracking breivik et al 2008 and path manoeuvring yanushevsky 2011 etc for path following control the objective is to follow a predefined path with a small cross track error the path is usually specified by waypoints fossen 2011 the trajectory can be generated by connecting the way points with straight lines curved lines depending on the requirement of the application line of sight los is a popular and effective guidance law for autonomous marine vehicles and its properties have been studied thoroughly in the literature see liu et al 2015 fossen et al 2015 kelasidi et al 2017 moe and pettersen 2016 moe et al 2016 xu and guedes soares 2015 2018 classical los methods usually rely on a constant look ahead distance by mimicking an experienced sailor a time varying los was introduced by lekkas fossen 2012 by defining the look ahead distance as a function of the cross track error a dynamic version of los can also be found in moreira et al 2007 recently an integral los ilos has been proposed and extensively analyzed it embeds an integral term that compensates the transverse disturbance borhaug et al 2008 caharija et al 2012 lekkas and fossen 2014 caharija et al 2016 a conceptual new ilos based on adaptive control theory was proposed by fossen and lekkas 2015 and it can compensate the drift forces effectively the stability analysis is an important and challenging topic for the cascaded guidance and control system of autonomous vessels fossen and pettersen 2014 for an autonomous vessel global exponential stable ges is usually the most desired quality of a closed loop control system khalil 2002 loría and panteley 2005 since it guarantees additional robustness and performance properties however ges cannot be achieved for this type of system due to the kinematic representation which introduces saturation through the trigonometric functions for autonomous marine ships it is well known that the kinematics introduces saturation through the trigonometric functions fossen and pettersen 2014 global κ exponential stability as defined by sørdalen and egeland 1995 was first proven for these problems and later by pettersen and lefeber 2001 who used a simplified vehicle model global κ exponential stability is a weaker stability property than global exponential stable but stronger than global asymptotic stability gas fredriksen and pettersen 2006 because global κ exponential stability can guarantee the closed loop system is the local exponentially stable this work has been further extended to a more complex ship model see borhaug and pettersen 2005 fredriksen and pettersen 2006 more recently the stability results were strengthened to uniform semiglobal exponential stability usges by fossen and pettersen 2014 usges is very important for the robustness of a system with environmental disturbance it is slightly weaker than ges but stronger than global κ exponential stability lyapunov sufficient conditions for usges of nonlinear time varying systems were presented by fossen and pettersen 2014 and its robustness properties were also discussed in pettersen 2017 the vector field guidance law is a promising guidance law that has been widely used for unmanned aerial vehicles uavs nelson et al 2007 lawrence et al 2008 proved that the vector field guidance law is globally stable using lyapunov techniques wang et al 2018 presented a global uniform bounded stability of the vector field for the arbitrary curves path following nelson et al 2006 2007 proposed a vector field guidance law and implemented it in the guidance system of a small unmanned air vehicle to the authors best knowledge a vector field guidance law with strong stability property has so far not proposed in this paper we proposed a structure of vector field guidance law which is proven to yield usges for the path following problems recently vector field guidance law has been used for path following control of underactuated marine vehicles and provides good performance xu and guedes soares 2016a b caharija et al 2015 compared the ilos guidance and the vector field guidance for an underwater vehicle the structure of this paper is illustrated as in fig 1 as presented in fig 1 the whole study can be divided into two main parts path generating using ais history data and guidance and control system ais data can provide various information such as unique identification position course and speed the raw data was collected and stored in the database after the quality checking and fault detection such as range and wild point testing by analyzing the ais data it is possible to determine the obvious motion patterns of ship traffic the second part is the design and stability analyses of the guidance and control system for maritime autonomous surface ships the main contribution of the paper is to propose a series of time varying vector field guidance laws for path following control of maritime autonomous surface ships the equilibrium point of the time varying vector field guidance law in cascade with a heading autopilot is proved to be usges using cascaded theory to the authors best knowledge only global asymptotic stability of the vector field guidance law has so far been proven in the literature another contribution is the path generations based on ais data in order to get a safe trajectory a history ais data in the tagus river was collected and a dynamic time warping algorithm is used for path generation the manoeuvring model of the catamaran algés is briefly introduced and the control model is identified using least square support vector machine based on the full scale free running manoeuvring test in order to obtain a strong stability property of the cascaded system a sliding mode control is used for heading autopilot design in order to eliminate the chattering a saturating function is introduced in the controller a control lyapunov function clf is employed to derive the control law which guarantees that the equilibrium point of the subsystem is ges using cascaded theory it is possible to show usges of the whole system finally in order to evaluate the performance and robustness of the proposed time varying vector field guidance law path following simulations are studied under the influence of ocean currents the paper is organized as follows section 2 introduces the path generation using ais history data and the dynamic time warping algorithm is also introduced section 3 introduces the nonlinear manoeuvring mathematical model for the catamaran section 4 is a brief introduction to the kinematics of path following control problems and the control object is also given in this section section 5 offers a detailed description of a time varying vector field guidance laws in section 6 a heading autopilot using sliding mode control is presented least square support vector machine is used to estimate the parameter of the control model the control law is derived using a clf and ges of the subsystem is proven in section 7 a theorem is developed to guarantee usges of the nonlinear time varying cascaded system and the detailed proof is also given in this section path following simulation under the influence of ocean currents is presented in section 8 finally the conclusions are presented 2 path generation using ais data the main routes are characterized by statistical analysis of ship trajectories typically trajectories in one route are replicated inevitably with some variations especially in turning sections in addition ship trajectories derived from ais data are of different length and are defined from different number points mainly due to speed variations of the ships along the route in this study the dynamic time warping dtw algorithm is applied to deal with this variability in the trajectory time series 2 1 main routes modelling based on dynamic time warping algorithm the dtw is a well known algorithm in many areas it was first introduced in the 60s bellman and kalaba 1959 and has been extensively explored and applied to the moving objects alignment and matching vlachos et al 2005 and trajectory learning vuković et al 2015 basically the algorithm calculates an optimal match between two given sequences e g ship trajectories with certain restrictions first of all an average route of ship route r can be estimated based on ship trajectories followed this route as described above a route r is built from a cluster of ship trajectories following the same itinerary the centerline of route r then can be estimated by averaging ship trajectories that followed the route r due to inevitable variations and different time series length in ship trajectories dtw based centerline estimation algorithm is applied to deal with the variability in ship trajectories in time series analysis dtw is one of the algorithms for aligning two temporal sequences which may vary in speed for instance alignments in ship trajectories can be detected using dtw even if there are accelerations and decelerations during the course of an observation basically the algorithm calculates an optimal match between two given sequences e g ship trajectories with certain restrictions and rules table 1 for two time series x x 1 x 2 x 3 x n of length n and y y 1 y 2 y 3 y n of length m a n m warping path is a sequence γ γ 1 γ l γ l with γ l n l m l 1 n 1 m for l 1 l satisfying the following three conditions 1 boundary condition γ 1 1 1 and γ l n m 2 monotonicity condition n 1 n 2 n l and m 1 m 2 m l 3 step size condition γ l 1 γ l 1 0 0 1 1 1 for l 1 l a n m warping path γ γ 1 γ l γ l defines an alignment between two time series x x 1 x 2 x 3 x n and y y 1 y 2 y 3 y n by assigning the element x n l of x to the element y n l of y the boundary condition enforces that the first elements of x and y as well as the last elements of x and y are aligned to each other in other words the alignment refers to the entire sequences x and y it should be mentioned that all elements in both time series are aligned which might require repeating elements from a time series but in the alignment it cannot be simultaneously repeated an element in both time series according to condition 2 the step size condition expresses a kind of continuity condition which means no element in x and y can be omitted and there are no replications in the alignment fig 2 shows an example of dtw alignment between two trajectories the optimal match represented by black dots as shown in fig 2 a is denoted by the match that satisfies all restrictions and the rules mentioned above these two ship trajectories contain 34 and 38 positions represented by red dots and blue dots in fig 2 a respectively the position sequences are warped non linearly in the index dimension to determine a measure of their similarity independent of certain non linear variations in the ship positions algorithm 1 dtw algorithm for estimation mean route image 1078023 after each trajectory within the shipping route is aligned the mean route can be derived from the arithmetic mean of the aligned positions let n be the number of trajectories belonging to the route r t r a j 1 t r a j 2 t r a j 3 t r a j n the dtw algorithm for estimation the mean route r is given in algorithm 1 when ships navigate in an open sea it is normal that ship trajectories deviate from the centreline while falling within a certain area this deviation may vary along the centreline that represents the spatial extent of the ship route in this study another property of ship route is the route boundary r b l b r b which consists of two sequences estimated by the centreline r and ship trajectories in the route it should be mentioned that the left and right boundary is defined by the left hand rule with centreline increasing downstream the algorithm for the ship route boundary determination is given in algorithm 2 algorithm 2 ship route boundary determination image 10264 once the mean route r and route boundary rb are determined in order to optimize the computation time for path generation method the mean route r and route boundary rb are simplified using a filter initially proposed by douglas and peucker 1973 the goal of this filter is to retain only significant positions of the mean route r and route boundary rb while keeping information about heading changes 2 2 waypoint determination on catamaran ferry route the ais data employed in this study were collected from 1st october to 31st december 2015 and the study area in this paper is bounded by parallels 38 62 n and 38 74 n and by meridians 8 95 w and 9 21 w fig 3 a shows the ais data that are used in this study which exhibits several overlapping and well defined traffic patterns as shown in fig 3 b there are submerged reef and tidal flat near the harbour which cannot be observed from the map so the resulted trajectory using ais data is a simple and practical one because the ais data usually represents the real and safe trajectory of the ship in history to identify main trajectories i e main traffic patterns the ais data are sorted by maritime mobile service identify mmsi number and time to construct a time series of each vessel s trajectory and result in 621 ship trajectories a clustering algorithm is used to group similar trajectories based on the hausdorff distance a superior limit of 500 m hausdorff distance is adapted to group similar ships trajectories and the montijo ferry route is applied in this study to test the method for the autonomous vessel as shown in fig 4 there are 1280 trajectories of 6 ships the numbers of positions are 25 269 next the main route followed by most of the trajectories is computed by statistical analysis using the dtw algorithm ship trajectories can be aligned and the median track can be derived by averaging the aligned elements as the time series reconstructed from ais data have heterogeneous sample rates the application of the dtw algorithm is well suited to measure the variations within each individual ship trajectory in addition the dtw algorithm is similarity based that enable to capture the curvature feature of the shipping route which is generated in controlled circumstances the desired output of mean route and route boundary based on dtw algorithm is sets of time series as shown in fig 5 3 nonlinear manoeuvring mathematical model in this section a nonlinear manoeuvring mathematical model is briefly introduced for a marine surface vessel the motions can be described in 6 degree of freedoms dofs as illustrated in fig 6 they are the surge sway heave roll pitch and yaw but the manoeuvring problem the motions in 3 dof surge sway and yaw are typically considered because the manoeuvring motion occurs with a much lower frequency than the wave encounter frequencies sutulo and guedes soares 2011 so it is reasonable to neglect the fluid memory effects fossen 2011 assuming a ship moving in a horizontal plane as presented in fig 7 two different coordinate systems north east down ned and body fixed frame are defined the ned is usually defined as the tangent plane on the surface of the earth the body frame is a moving coordinate frame that is fixed to the craft the manoeuvring mathematical model is usually defined in the body fixed frame without loss of generality any ship can be treated as the free rigid body moving under the action of the external forces and moments the euler equations of arbitrary motion in the horizontal plane are given 1 m μ 11 u m v r m x g r 2 x h x p m μ 22 v m x g μ 26 r m u r y h y p m x g μ 26 v i z z μ 66 r m x g u r n h n p where m and i z z are the mass and the moment of inertia respectively x g is the position of centre of mass in the x direction μ 11 μ 22 and μ 26 are the added masses and moments respectively x h y h and n h are the hydrodynamic forces and moments of the bare hull x p y p and n p are the forces and moments of the steerable waterjets the bare hull added masses are calculated using empirical formulae approximating ellipsoidal data more details can be found in ferrari et al 2016 2015 quasi polynomials are employed to approximate the hydrodynamic forces and moments x h y h and n h because the quasi polynomials can be slightly more economical from the viewpoint of the number of terms and computation speed even the corresponded response surface is not smooth everywhere sutulo and guedes soares 2011 sutulo and guedes soares 2004 the mathematical model for surge sway and yaw motion are given 2 x h x 0 x v v v v x v r v r x r r r r y h y v v y r r y v v v v 3 y r r r r 3 y v v r v 2 r y v r r v r 2 n h n v v n r r n v v v v 3 n r r r r 3 n v v r v 2 r n v r r v r 2 in order to compare the coefficients of different ships and to estimate the dynamics of a full size ship the hydrodynamic parameters need to be converted to dimensionless ones the prime system recommended by sname 1950 will be used to normalize the hydrodynamic coefficients the water density ρ the ship length l and the ship speed u are employed as the characteristic dimensional parameter the forces are normalized with 0 5 ρ u 2 l t and the moment with 0 5 ρ u 2 l 2 t where t is the draft at the midship the nondimensionalized velocities and yaw rate are u u u v v u r r l u more detailed information on particulars of the catamaran can be found in ref lúcia moreira and guedes soares 2012 fig 8 the propulsion system of the catamaran consists of two steerable waterjet propulsors each of them is installed in the aft part of the single hull and can be operated independently from the other the generated thrust and steering angle can be different the classic actuator disk theory is used to approximate the forces generated by the waterjet propulsor ferrari et al 2016 3 x p t e 1 c w cos δ 1 y p t e c w sin δ where t e is equal to the ship resistance in straight motion c w is the ratio of the induced velocity ω and the ideal one ω a ω is the induced velocity at infinity taking into account the deflection of the propulsor ω a is the velocity derived from the ideal propulsor theory 4 kinematics of path following guidance and control system are typical components for an autonomous vessel and usually are of critical importance for the overall performance of system a typical guidance and control system for marine crafts is shown in fig 9 where several assumptions are given firstly the crab angle β is assumed to be directly measured using an inertial navigation system ins aided by a global navigation satellite system gnss lekkas and fossen 2014 so the crab angle β due to the environmental disturbance can be compensated second various sensors are available and the motions of the ship can be measured correctly the waypoints are generated by the path generations block using the ais data as discussed in the preceding section the resulted path is more practical and safer for the autonomous ship travelling in a complex environment especially the offshore area with submerged reef and tidal flat because the ais data usually represents the real and safe trajectory of the ship in history in this section the kinematics of two dimensional path following guidance problems is briefly reviewed and the control objective is given for a marine surface ship two dimensional path following is typically considered but for underwater vessels it is a three dimensional problem because the depth is needed to be controlled it can be solved independently in the horizontal and vertical planes a marine craft is assumed to follow a pre defined straight path as shown in fig 10 three coordinate frames are defined in fig 10 for example the curved path is defined in the north east down ned frame the body fixed frame is a moving coordinate frame that is fixed to the craft the path tangential frame is a moving coordinate frame whose origin is the projection of the ship s centre of gravity more details about the definition of the frames can be found in fossen 2011 4 1 control objective consider a marine craft moving in a horizontal plane a two dimensional continuous c 0 path is predefined as the straight line that connects the adjacent points the path is assumed to go through the predefined way points x j y j for j 1 n the path tangential angle γ p is the rotation angle relative to the inertial frame hence the path tangential reference frame can be found by rotating an angle γ p in ned reference frame using the rotation matrix 4 r γ p cos γ p sin γ p sin γ p cos γ p s o 2 by inspection of fig 10 the cross track error can be calculated using 5 0 y e r t γ p x t x p t y t y p t where x t y t is the ship s position in real time x p t y p t is the origin point of a path tangential reference frame expanding 5 leads to the normal line 6 y t y p t x t x p t 1 tan γ p and the cross track error y e 7 y e t x t x p t sin γ p y t y p t cos γ p obviously the aim of the path following is to control the ship to follow the predefined path with zero cross track error so the control objective for straight line path following is given 8 lim t y e t 0 4 2 kinematic equations the kinematic equations of a marine vessel in a horizontal plane can be described using the velocity of the surge sway and yaw u v and r it is given as 9 x u cos ψ v sin ψ y u sin ψ v cos ψ ψ r where ψ is the yaw angle which can be measured using a compass differentiation of 7 is given as 10 y e x x p sin γ p y y p cos γ p x x p cos γ p y y p sin γ p γ p it can be further simplified by substituting eqs 6 and 9 into eq 10 and the definition of γ p resulting 11 y e x sin γ p y cos γ p u cos ψ v sin ψ sin γ p u sin ψ v cos ψ cos γ p u sin ψ γ p β where u is the ground speed of a ship u u 2 v 2 and it can be directly measured using gnss lekkas and fossen 2014 the phase β atan2 v u is recognized as crab angle it is the difference in heading angle ψ and course angle χ moreover 12 χ ψ β finally the time differential for y e becomes 13 y e u sin χ γ p 5 time varying vector field guidance law this section presented a time varying vector field law for path following control the main motivation behind the vector field guidance law is to generate vectors around the predefined path the vectors denote the desired travelling direction for the autonomous vessels as presented in fig 11 a vector field is generated along the predefined straight path obviously if the ship tracks the vectors it will follow the path here a time varying vector field guidance law is proposed as the following 14 χ d ψ d β γ p tan 1 sgn y e y e δ θ t y e γ p sgn y e tan 1 y e δ θ t y e where θ t y e is a time varying function to be defined later and δ 0 is a pre defined constant the course angle tracking error satisfies 15 χ χ χ d ψ ψ d ψ substituting 14 and 15 into 13 gives 16 y e u sin ψ sgn y e tan 1 y e δ θ t y e expand the formula using the property sin a b sin a cos b cos a sin b gives 17 y e u sin ψ cos tan 1 y e δ θ t y e sgn y e u cos ψ sin tan 1 y e δ θ t y e which can be simplified by using the trigonometry equation sin tan 1 x x 1 x 2 moreover 18 y e u sin ψ δ θ t y e δ 2 θ t y e y e 2 θ t y e sgn y e u cos ψ y e θ t y e δ 2 θ t y e y e 2 θ t y e sgn y e u y e θ t y e δ 2 θ t y e y e 2 θ t y e f 1 t y e u ϕ t y e ψ ψ g t y e ψ where ϕ t y e ψ is defined as 19 ϕ t y e ψ sin ψ χ δ θ t y e δ 2 θ t y e y e 2 θ t y e sgn y e cos ψ 1 χ y e θ t y e δ 2 θ t y e y e 2 θ t y e here the function ϕ t y e ψ is upper bounded ϕ t y e ψ c for all y e and ψ assume that 0 δ min δ δ max as can be observed the sub function sin x x 1 and cos x 1 x 0 73 are upper bounded and 20 δ θ t y e δ 2 θ t y e y e 2 θ t y e 1 y e θ t y e δ 2 θ t y e y e 2 θ t y e 1 consequently it can be concluded that the ϕ t y e ψ is upper bounded moreover c 1 73 will be an upper bound for ϕ t y e ψ fossen and lekkas 2015 6 nonlinear controller for autopilot 6 1 nonlinear control and stability analysis in this section in order to obtain strong stability properties a nonlinear control technology sliding model controller is used for the heading autopilot design for the path following of autonomous vessels the control law is derived using the lyapunov function and the proof of globally exponentially stability ges will be also presented the nomoto model is used for the control design it is derived from the linearized manoeuvring model and widely used to describe the yaw dynamics of a marine vessel due to its simple structure fossen 2011 a sliding mode controller for heading autopilot design is given 21 ψ r t r r k δ b 0 where t and k are the nomoto time and gain constants respectively b 0 b max is a bounded bias term due to environmental disturbance and unmodeled dynamics and δ is the rudder deflection angle define the heading error as ψ ψ ψ d note that χ ψ so it is sufficient to analyse the heading error dynamics which is expressed in terms of the sliding surface 22 s d d t λ 2 0 t ψ τ d τ ψ 2 λ ψ λ 2 0 t ψ τ d τ s 0 λ s 0 where s 0 ψ λ 0 t ψ τ d τ and λ is a design constant which reflect the bandwidth of the controller fossen 2011 when s 0 eq 22 describes a sliding surface with exponentially stable dynamics then the error dynamics can be expressed in state space form as 23 ψ s 0 λ λ 0 λ a ψ s 0 1 1 b s define the signal r r r s and substitute into eq 21 gives 24 t s s k δ t r r r r b 0 considering the stability the control law can be chosen as 25 δ 1 k t r r r r k d s η sgn s where k d 0 is the feedback control gain which is used to speed up the convergence of the tracking error s to zero sgn s is the signum function η b max is a positive design gain which is determined by lyapunov stability analysis slotine and li 1991 substituting 25 into 24 give 26 t s 1 k d s η sgn s b 0 in the following part the stability of the sliding mode controller is given consider the control lyapunov function clf 27 v 2 x t p x 1 2 t s 2 where x ψ s 0 t and p p t 0 is given by 28 p a a t p q i where q 0 is a specified constant hence it follows that 29 v 2 x t a t p p a x 2 x t p b s 1 k d s 2 b 0 s η s q x 2 2 x p s 1 k d s 2 x s q p p 1 k d x s from eq 29 in order to imply that v 2 0 the feedback control gain k d need to be carefully chosen assume λ max p is the maximum eigenvalue of p 30 q λ max p λ max p 1 k d 0 then the control gain can be defined as k d λ max p 2 q 1 0 which clearly implies that v 2 is negative hence the equilibrium point ψ s 0 t 0 is globally exponentially stable ges theorem 4 10 in khalil 2002 as discussed in fossen and lekkas 2015 it is practical to treat the k d and η as tunable parameters because it is easy to satisfy the gain requirements for a marine craft described by the nomoto model in order to eliminate the chattering in the sliding mode controller a saturating function tanh s ϕ is introduced where ϕ is a positive parameter used to shape the slope of the saturating function this function serves as a low pass filter structure to the dynamics inside the boundary layer fossen 2011 then the control law can be given as 31 δ 1 k t r r r r k d s η tanh s ϕ 6 2 parameter estimation using ls svm as discussed above the nonlinear controller based on nomoto model is proposed and strong stability ges is also obtained in the following part the parameters of nomoto model need to be estimated in order to obtain the parameters the full scale manoeuvrability trials were conducted in the transtejo s catamaran which properties are listed in table 2 the test was carried out in windy conditions the absolute wind speed varied from 15 to 35 knots wind force between 4 and 7bft during the tests these trails were carried out in water depths varying from 2 4 to 7 4 m more details on the trails can be found in guedes soares et al 1999a b moreira and guedes soares 2012 here 20 20 zigzag manoeuvre test carried out at 80 full speed is used to estimate the parameters the deflection angle of the steerable nozzle yaw angle and yaw rate are shown in fig 12 here the deflection angle of the steerable nozzle is denoted as rudder angle system identification technology is used to obtain the parameters system identification has been widely used in the modelling of ship steering and different approaches have been adopted fossen et al 1996 sutulo and guedes soares 2014 xu et al 2018a b xu and guedes soares 2019 perera et al 2015 applied an extended kalman filter to identify a nonlinear ocean vessel steering model velagic et al 2003 used an adaptive fuzzy gain autopilot for ship track keeping recently a robust method support vector machine luo et al 2016 2014 luo and zou 2009 xu et al 2019a b c zhang and zou 2011 was applied to identify the ship manoeuvring model and performed satisfactorily in the following part ls svm is used to estimate the parameters based on the zigzag manoeuvring test more details of the ls svm for parameter estimation can be found in appendix a for ls svm the regularization factor c 2544 is chosen luo et al 2016 the nomoto time and gain constants are the parameters to be identified the identification and experimental heading curves are in good agreement which is presented in fig 13 k is equal to 0 1258 and t is equal to 5 1973 in order to validate the accuracy of the result of system identification the analysis method presented in clarke 2003 journee 1970 will be used to obtain the parameters if eq 21 is integrated with respect to time t the following equation results 32 t 0 t r d t 0 t r d t k 0 t δ d t by choosing the range of time the parameters k and t can be given in the following equation 33 k ψ 1 ψ 2 t 1 t 2 δ d t k t r 3 r 4 t 3 t 4 δ d t as shown in fig 14 a in the restricted area the yaw velocity r is constant and the derivative of the yaw velocity is zero according to eq 33 the parameter k can be found as k 0 1424 similarly eq 33 is applied to the first two zero crossing points of the heading record as shown in fig 13 in this case the heading ψ is equal to zero and t t 5 8437 can be calculated from eq 33 the identified parameters are near the analytical values so the ls svm can provide a robust estimation using zigzag manoeuvring test 7 stability analysis of the cascaded system guidance and control system the two sub systems described by eqs 18 and 21 are interconnected and form a cascade structure error dynamics of the cascaded system can be described in fig 15 where σ2 is the driving system and σ1 is the driven system the driving system is the autopilot control system since the convergence to the desired heading angle ψ d affects the stability of the guidance system by the function g t y e ψ however the guidance system perturbs the autopilot control system due to the cross track error y e appears in the vector field guidance law equation as presented in eq 14 the error dynamics of the cascaded system is defined as 34 σ 1 y e sgn y e u y e θ t y e δ 2 θ t y e y e 2 θ t y e f 1 t y e u ϕ t y e ψ g t y e ψ ψ 35 σ 2 ψ f 2 t ψ where f 2 t ψ defines the course tracking error dynamics discussed in section 6 the vehicle dynamics along with the heading controller is the driving system σ2 and the vehicle in combination with the time varying vector field guidance law constitutes the driven system σ1 the yaw angle tracking error affects the convergence of the guidance system s objective which is to minimise the cross track error y e as can be observed from eqs 34 and 35 the function θ t y e plays an important role in the stability analysis of the cascaded system it controls the converging speed of the cross track error the value of θ t y e should increase with the cross track error y e this ensures that when the system has a higher converge rate when the cross track error is large so the definition and properties of the function θ t y e should be given first definition 1 the time varying function θ t y e is a non decreasing positive semi definite function and θ t y e 0 1 furthermore 36 θ t y e 0 property 1 the time varying function θ t y e stratifies the definition 1 and guarantees that the function g t y e y e θ t y e 1 is continuous positive defined and lower bounded moreover 37 0 c r g t y e the stability properties of the cascaded system defined in eqs 34 and 35 are given by theorem 1 it guarantees that the cascade system of the time varying vector field guidance law and heading autopilot is uniform semiglobal exponential stability usges it needs to point out that usges is slightly weaker than global exponential stability ges which is usually the most desired property for the dynamic system because ges guarantees that any oscillations in the output will decay at an exponential rate but in this case ges cannot be achieved due to the definition of the cross track error dynamics 10 which is saturated due to the sinusoidal function usges is slightly stronger than the global κ exponential stability proven in fredriksen and pettersen 2006 due to the convergence properties theorem 1 assume that the control law eq 25 is used to stabilize the system σ2 and that the time varying vector field guidance law eq 14 specifies the desired heading angle ψ d for the system σ1 then the equilibrium point y e ψ 0 0 of the system 34 35 is usges if the function θ t y e satisfies property 1 and the predefined parameter δ satisfies 0 δmin δ δmax for speeds 0 umin u umax proof see appendix b as discussed before the time varying function θ t y e need to be chosen carefully in order to guarantee the strong stability property of the cascaded system here a linear function is chosen 38 θ t y e c y e 1 where c is a positive constant this function increases with variable ye and the function g t y e is continuous positive defined and lower bounded 39 g t y e y e θ t y e 1 y e c y e e c 1 e 0 8 simulations in order to evaluate and compare the performance and robustness of the proposed guidance and control system path following is carried out in the simulation study the ship considered is the 3 dof surge sway and yaw nonlinear mathematical model of the catamaran this manoeuvring model is comprehensive and it gives highly realistic results the hydrodynamic coefficients were estimated based on captive model tests more details about the mathematical model and hydrodynamic coefficients can be found in reference sutulo and guedes soares 2006 the obtained manoeuvring model was used for automatic berthing ferrari et al 2016 2015 the goal of path following is to follow a trajectory which is specified in terms of way points the way points are calculated based on the ais history data and defined in a geographic coordinate system where latitude and longitude are used as suggested in fossen 2011 the north east down ned coordinate system is used for marine vessels control the geometrical information of predefined straight path in a geographic coordinate system is presented in fig 16 a the autonomous vessel is going from terreiro do paco station in lisbon to montijo it is a tourism line runs by transtejo soflusa the trip takes around 20 min and provides a chance to enjoy views of lisbon river the tagus the path expressed in the ned frame is presented in fig 16 b without loss of generality the initial position of the ship is assumed to be the origin during the simulation the current is chosen as the main environment disturbance the current with constant magnitude and direction u c 2 m s and β c 45 deg is considering in the simulation the rudder saturation δ 32 deg and the initial conditions are given u 0 10 3 m s ψ 0 26 deg and r 0 0 the desired speed is kept as constant during the simulation the heading controller parameters are selected as k d 0 4 η 1 and λ 0 1 we have chosen the time varying function as θ t y e 0 04 y e 1 while the time varying vector field guidance law is given by eq 17 obviously the proposed time varying vector field guidance law satisfies property 1 and hence the system equilibrium point is usges the predefined parameter δ 2l pp is chosen as twice the ship length when the ship is moving along the straight line a switching mechanism for selecting the next waypoint is needed for this purpose a circle of acceptance with radius r 4l pp around the waypoints is chosen considering the ship s speed when the ship enters the transition area of the way points x k 1 x t 2 y k 1 y t 2 r 2 the next way point should be selected the guidance and control system will control the ship to follow the next segment of the predefined path fig 17 presents the real time trajectory of the ship blue line and the desired path red line in the presence of a current with constant magnitude and direction fig 17 a shows the trajectories in the ned coordinate system as shown in the figure the ship can follow the straight line path in the presence of an ocean current during the transition of the way points the route is smooth and without any overshoot fig 17 b are the trajectories of the ship expressed in the geographic coordinate system during the simulation in fig 18 the yaw angle surge speed desired versus true and sway speed are presented as shown in fig 18 the real time heading angle agrees with the desired angle very well which indicated that the heading autopilot has an excellent performance during the simulation the total speed was constant there are some oscillations of the surge speed during the transition of the way points due to the effect of the ocean current when the ship manoeuvres the sway speed is kept as zero when the ship stays on the predefined path the course angles desired versus true as well as the crab angle are plotted in fig 19 there is a small difference between the true values and the desired values due to the crab angle or drift angle because the proposed autopilot is used to stabilize the heading angle as presented in fig 18 fig 20 shows the deflection angle of the steerable nozzle and the cross track errors during straight line path following the deflection angle of the steerable nozzle is stable and kept as zero when the ship stays on the predefined path it means that the chattering of the sliding mode controller is eliminated successfully the lower plot in fig 20 is the cross track errors during the simulation the cross track error indicated the performance of the proposed guidance and control system however it should be noted that the cross track error is actually the input for the guidance sub system it is a bit different with the distance from the path in common sense especially during the ship enters the transition area of the way points the circle of acceptance when the ship lies within the circle of acceptance the next way point is selected so the cross track error is the distance from the next segment of the path the ship is actually following the previous segment of the path this can be observed from fig 17 the ship follows the path with a small error during the transition area of the way points but the cross tack errors are large when the ship turns to the next way point 9 conclusions a system combining path generation guidance and control for a prototype of autonomous catamaran ferry was presented in this paper considering the complex traffic environment in the harbour a path generation system based on dtw algorithm was proposed dtw algorithm calculates the safety trajectory as well as boundaries using the ais data which was collected in the tagus river a nonlinear manoeuvring mathematical model of a catamaran ship in 3 dof surge sway and yaw is briefly introduced the least square support vector machine was employed to estimate the parameters of the control model using the full scale manoeuvrability trials this paper indicated that the guidance and control systems are coupled together where the control sub system is the driving system and guidance sub system is the driven system lyapunov based sliding mode control has been used for heading autopilot design and globally exponentially stability ges was proven a saturating function is introduced to eliminate the chattering in the sliding mode controller a nonlinear time varying vector field guidance law was proposed for the autonomous catamaran ferry using lyapunov stability theory for nonlinear cascaded systems the coupled guidance and control system was proven usges and the proof was also presented to evaluate the performance and robustness of the cascaded system the path following simulation was carried out in the presence of an ocean current the simulation showed that the cascade system is robust with constant external disturbance and the proposed time varying vector field guidance law is capable of following the predefined paths declaration of competing interest there are no conflicts of interest acknowledgements this work was performed within the strategic research plan of the centre for marine technology and ocean engineering centec which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 this work is a contribution to the project m mships maneuvering moored ships in ports ptdc emstra 5628 2014 funded by the fct appendix a least square support vector machine for parameter estimation for regression purposes support vector regression gives a general approximation function form suykens et al 2002 a 1 y w t φ x b where x is the training sample y r n y is the target value y r w t φ x b is the prediction for that sample b is the bias term ω is a weight matrix φ is a nonlinear kernel function that can map the training sample to a high dimensional feature space in order to minimise the structural risk which provides a trade off between hypothesis space complexity and the empirical error a cost function is defined as follows a 2 min w b e f w e 1 2 w t w 1 2 c i 1 l e i 2 s u b j e c t t o y i w t φ x i b e i where e i i 1 l are error variables and c is the regularization factor the minimization of w t w is closely related to the use of a weight decay term in the training of neural networks and the i 1 l e i 2 controls the trade off between the empirical error and the model complexity cortes and vapnik 1995 the lagrangian function can be constructed as a 3 l w b e α 1 2 w t w 1 2 c i 1 l e i 2 i 1 l α i w t φ x i b e i y i where αi are the lagrange multipliers the optimality conditions are defined by computing the derivatives of a 3 with respect to ω b e α a 4 l w 0 w i 1 l α i φ x i l b 0 i 1 l α i 0 l e i 0 α i c e i l α i 0 w t φ x i b e i y i 0 after elimination of variables ω and ei from equation a 4 and applying the kernel function this allows working in high dimensional feature spaces without explicit computations on them the ls svm model for function estimation yield a 5 y x i 1 l α i k x x i b where k is the kernel function that represents an inner product between its operands the kernel must be positive definite and must satisfy the mercer condition suykens et al 2002 vapnik 1995 in order to obtain the parameters the linear kernel function is adopted for the ls svm appendix b proof of theorem 1 proof as shown in section 6 the equilibrium point ψ 0 and thus χ 0 of the heading autopilot system σ2 given by 35 is ges the nominal system σ1 system with ψ 0 is b 1 y e sgn y e u y e θ t y e δ 2 θ t y e y e 2 θ t y e system b 1 is nonautonomous sine the function θ t y e is time varying consider the clf b 2 v 1 t y e 1 2 y e 2 where v 1 t y e 0 if y e 0 the time derivative is b 3 v 1 t y e sgn y e y e u y e θ t y e δ 2 θ t y e y e 2 θ t y e u y e θ t y e 1 δ 2 θ t y e y e 2 θ t y e since v 1 t y e 0 and v 1 t y e 0 according to theorem 4 8 by khalil 2002 the equilibrium point is uniformly stable moreover b 4a y e t y e t 0 t t 0 rewriting b 3 as in b 5 and define φ t y e as b 4b φ t y e u y e θ t y e 1 δ 2 θ t y e y e 2 θ t y e gives b 5 v 1 t y e φ t y e y e 2 for y e b r where b r x b r x r and from property 1 it then follows that b 6 φ t y e u y e θ t y e 1 δ 2 θ t y e y e 2 θ t y e u min c r δ max 2 θ t 0 r r 2 θ t 0 r c r then b 7 v 1 t y e φ t y e y e 2 2 c r v 1 t y e y e b r considering b 4 the above equation holds for all trajectories generated by the initial conditions y e t 0 using the comparison lemma lemma 3 4 by khalil 2002 eq b 7 has the solution v 1 t y e e 2 c r t t 0 v 1 t 0 y e t 0 therefore b 8 y e t e 2 c r t t 0 y e t 0 t t 0 and y e t 0 b r hence we can conclude that the equilibrium point y e 0 of the nominal system σ1 system with ψ 0 is usges definition 2 7 by loría and panteley 2005 finally under the property 1 the equilibrium point y e 0 ψ 0 of the cascaded system described by 34 35 is usges fossen and pettersen 2014 panteley et al 1998 panteley and loria 1998 
22327,wind field data from the national centers for environmental prediction climate forecast system version 2 cfsv2 the european centre for medium range weather forecasts era interim and era5 and the era5 blended into the parametric typhoon model era5h from september 1 to 30 2016 were adopted to drive a fully coupled circulation wave model the best performance of the maximum storm tide and significant wave height swh and mean wave period simulation for typhoon events was found by applying the era5h the contributions of nonlinear interactions to the storm tide induced by super typhoon meranti in 2016 were quantified using seven scenario simulations the results indicated that the wave setup had the most significant nonlinear interaction with the storm tide which was up to 0 97 m both with and without tidal effects the wave tide interaction was relatively minor for the total water level and contributed only 0 1 m to the storm tide significant differences in the tide surge interactions were detected with and without wave effects as these interactions provided approximately 0 06 0 08 m and 0 02 m of the storm tide respectively the spatial distributions of the maximum swh for typhoon events were similar when coupled and decoupled models were employed in this paper it is concluded that storm surge miscalculation can be avoided if wave setups are included when predicting typhoon generated storm tides keywords nonlinear interaction wave setup storm tide super typhoon fully coupled circulation wave model 1 introduction every year typhoons known as tropical cyclones or hurricanes impact millions of people and result in billions of dollars us dollars usd of damage worldwide according to the international disaster database report typhoons affected 12 8 million people and resulted in a record 1 593 deaths in 2018 the economic losses resulting from typhoons particularly those due to hurricanes michael 16 billion usd for the united states and florence 14 billion usd for the united states and typhoon jebi 12 5 billion usd for japan indicate that typhoons were the costliest disasters in 2018 a super typhoon is the equivalent of a category 4 or 5 hurricane on the saffir simpson scale meaning the maximum wind speed near the typhoon centre exceeds 114 kt or 58 6 ms 1 huang and xu 2010 in addition to powerful winds a super typhoon has the ability to produce high storm surges and torrential downpours which rank among the most destructive global natural hazards balaguru et al 2016 for example super typhoon haiyan made landfall in the philippines on november 7 2013 as one of the strongest tropical cyclones ever recorded and at least 90 of the structures in the city of tacloban were damaged or destroyed by up to 4 m high storm surges furthermore seiche oscillation significantly amplified the water surface elevations inside the leyte gulf in addition to the strong wind from super typhoon haiyan mori et al 2014 over the past 30 years the average latitude where typhoons reach their peak intensity has shifted northward in the western north pacific ocean this migration is anticipated to increase the threat of typhoons in the east china sea region including the taiwan islands japan and the ryukyu islands the korea peninsula and parts of eastern china kossin et al 2016 however global warming not only causes the locations of typhoon peak intensity to migrate but also increases the wind speed and frequency of strong typhoons emanuel 2005 suggested that future increases in global mean temperatures may cause an upward trend in the devastating potential of a typhoon which will result in increased typhoon related losses recently his research completed a linear trend analysis of historical typhoon data from 1980 to 2016 and a significant global increase was found for all typhoons with maximum wind speeds of 175 km h typhoons with wind speeds of 200 km h or more have doubled in number and those with wind speeds of 250 km h or more have tripled this result provides conclusive evidence that a global increase in the most intense typhoons due to global warming not only has been predicted by models but also is already occurring the storm tide also known as the sea surface elevation or total water level is a combination of the astronomical tide and storm surge and is the actual sea water level that leads to inundations in low lying areas along the coast many previous studies have focused on storm surge and thus subtract either simulated tides or harmonic tides tides obtained from the harmonic constants from the total water levels to remove astronomical tide fluctuations however the modelled and measured storm tides in coastal waters are highly non stationary with significant variations in phase and amplitude during a typhoon moreover tidal ranges may commonly be reduced or even eliminated when typhoons bring large amounts of freshwater to the coast near estuaries kukulka and jay 2003 georgas 2012 therefore excluding the tidal signal from the sea surface elevation is not a straightforward task orton et al 2012 the mean tidal range along the taiwan coast varies from 0 8 to 4 0 m representing the most important role of the total water elevation which is the primary concern and should be included in studies on coastal flooding wave tide interactions can modulate the wave climate in regions with strong dynamics although this process is usually ignored lewis et al 2019 bernier and thompson 2007 found that strong tide surge interactions occur in the northumberland strait canada and the gulf of maine lin et al 2012 simulated large numbers of synthetic surge events under projected climates for the battery new york city their results indicated that tide surge nonlinearity is positive at low tides and negative at high tides wave setup is a very important phenomenon in surf zone hydrodynamics wave setup is the local elevation in the mean water level on the foreshore which is induced by the presence of breaking waves reduction in wave height through the surf zone under typhoon conditions radiation stress can be an important term in storm tides or storm surge applications because wave setup increases the total water level close to the coast causing widespread damage associated with coastal area flooding kim et al 2010 brown et al 2011 chen et al 2017 thuy et al 2017 indicated that the surge wave interaction is crucial to the storm surge simulations on the coast of central vietnam an extreme sea level event i e storm tide is primarily driven by an integration of the tide and typhoon generated storm surge and waves lewis et al 2011 2013 hence quantifying the contributions of nonlinear interactions e g wave tide tide surge interactions and wave setup to the storm tide is important for marine forecasting and simulations especially for a super typhoon event predicting or hindcasting realistic storm tides surges and waves highly relies on numerical efficiency and a robust and high resolution fully coupled circulation wave model as well as an accurate typhoon wind field powell et al 2010 accordingly forcing the circulation and wave models using gridded meteorological data with high spatial and temporal resolution instead of analytical parametric models could improve the accuracy of storm surge and wave simulations the aim of this paper is to study the role of nonlinear interactions in storm tide simulations by employing a fully coupled tide surge wave model and meteorological conditions from global numerical weather simulation systems the details of the methods and materials are described in the following section and the results of a series of scenario simulations are presented in section 3 in section 4 a discussion and uncertainties of the present study are given which is followed by a summary and conclusion in section 5 2 methods and materials 2 1 wind fields and open boundary conditions accurate wind forcing is an indispensable meteorological condition for the accurate simulation of storm tides and wind waves janssen 2004 wind field specification for a typhoon is fairly complicated cardone and cox 2009 therefore three dynamic wind fields were adopted during the same period to obtain better simulations of the storm tide significant wave height swh and mean wave period 2 1 1 era interim reanalysis wind field reanalysis data of the wind fields produced by era interim were acquired from the public datasets of the european center for medium range weather forecasts ecmwf era interim is a global atmospheric reanalysis dataset that begins in 1979 and the data are continuously updated monthly with a two month delay dee et al 2011 the original era interim gridded dataset has a horizontal resolution of 0 75 0 75 approximately 80 km era interim represents a third generation reanalysis because it uses an atmospheric model and assimilation system that are greatly improved from those used in era 40 in the present study the 10 m u and v wind components were acquired from the era interim reanalysis interpolated products at a spatial resolution of 0 125 0 125 approximately 13 km and a temporal resolution of 6 h four analysis fields per day at 00 00 06 00 12 00 and 18 00 utc 2 1 2 era5 reanalysis wind field era5 is a fifth generation ecmwf atmospheric reanalysis of the global climate that combines vast amounts of historical observations into global estimates using advanced modelling and data assimilation systems the era5 dataset provides hourly estimates of a large number of atmospheric land and oceanic climate variables and includes information about uncertainties for all variables the reanalysis data cover the earth on a 0 25 approximately 30 km grid and resolve the atmosphere using 137 levels from the surface to a height of 80 km the era5 data are now published with quality assured monthly updates within 3 months of real time with respect to era interim the hourly output resolution of era5 is an improvement and provides a more detailed evolution of particular severe weather events such as typhoons 2 1 3 cfsv2 wind field the national centers for environmental prediction ncep climate forecast system cfs was upgraded to version 2 cfsv2 and made operational at the ncep in march 2011 the cfsv2 is the same model that was used to create the ncep climate forecast system reanalysis cfsr the cfsv2 is undoubtedly superior to the cfs especially on the intraseasonal time scale the cfsv2 also creates many more products for subseasonal and seasonal forecasting with an extensive set of retrospective forecasts for users to calibrate their forecast products saha et al 2014 the cfsv2 products are available at horizontal resolutions of 0 2 0 5 1 0 and 2 5 and hourly intervals thus hourly wind data with a 0 2 spatial resolution were utilized in the present study 2 1 4 hybrid typhoon wind model a parametric typhoon wind model generally creates a highly accurate wind field near the centre of a typhoon but the accuracy decreases as the distance from the typhoon centre increases while a reanalysis wind product is superior in the areas away from the centre of a typhoon but inferior around the typhoon centre pan et al 2016 it is believed that improved wind fields of an entire typhoon for storm tide surge and wave modelling can be acquired through a combination of parametric typhoon models and reanalysis wind products chang et al 2018 yu et al 2019 chen et al 2019 the modified rankine vortex mrv model phadke et al 2003 was employed to superpose the reanalysis wind field data by an approach proposed by shao et al 2018 1 w h w m r 2 r max α 0 70 α 0 06 w m 1 α 0 72 1 α 0 28 w r 2 r max r 7 r max w r r 7 r max where w h is the hybrid typhoon wind w m is the parametric typhoon wind w r is the reanalysis wind r is the radial distance from the centre of the typhoon to an arbitrary point r max is the radius of the maximum wind speed and α 7 r r max 5 2 1 5 tidal forcing the harmonic constants including the amplitudes and phases of eight main tidal constituents m2 s2 n2 k2 k1 o1 p1 and q1 were extracted from a regional inverse tidal model for the china seas indonesia with a resolution of 1 30 zu et al 2008 and were then considered to be the boundary conditions to drive the model at each time step an inverted barometer effect resulting from low atmospheric pressure was also considered in the model 2 2 fully coupled circulation wave model schism wwm iii a semi implicit cross scale hydroscience integrated system model schism developed by zhang et al 2016 was used to reproduce the water surface elevations and tidal currents of taiwanese waters in sep 2016 schism is an evolutionary product of the original selfe semi implicit eulerian lagrangian finite element model zhang and baptista 2008 and the model has many enhancements and upgrades the key features of schism include a new extension to a large scale eddy regime and a seamless cross scale capability from streamlet to ocean schism solves the shallow water equations with hydrostatic and boussinesq approximations using finite element and finite volume methods the use of no mode splitting in schism results in the elimination of numerical errors that result from the splitting between internal and external modes shchepetkin and mcwilliams 2005 schism eliminates the most severe stability restrictions e g courant friedrichs lewy cfl since the semi implicit schemes are applied to all governing equations the nonlinear advection terms in the momentum equations are treated with an eulerian lagrangian method thus the numerical stability constraints are further relaxed the 2d depth integrated model is preferred to the 3d model for storm tides and wave modelling owing to the affordable computer resource requirements and the reduced execution time additionally typhoon induced phenomena are well captured by the 2d model therefore the 2d depth integrated version of schism schism 2d was used in the present study a manning coefficient of 0 025 and a time of 120 s were set in the model based on the type of sea bottom material and numerical stability komen et al 1994 indicated that phase averaged spectral wave models are efficient tools for simulating sea states for realistic applications therefore the third generation spectral wave model wind wave model iii wwm iii was adopted in the present study wwm iii was originally derived from the source code of hsu et al 2005 but most of the numerical schemes physics robustness and efficiency of the model were overhauled by roland 2009 the fractional steps method proposed by yanenko 1971 was utilized to solve the wave action equation on an unstructured grid in wwm iii first the geographical part was solved using the residual distribution scheme introduced by roe 1982 and improved by abgrall 2006 subsequently the advection in spectral space was treated by the ultimate quickest finite difference scheme leonard 1991 the source terms of the wave action equation were finally integrated in a manner similar to that used for wavewatchiii tolman 2009 according to the terms time scales or nonlinearity the nonlinear interactions in deep and shallow water were computed using the discrete interaction approximation of hasselmann et al 1985 and the lumped triad approximation of eldeberky 1996 the shallow water wave breaking formulation was based on the work of battjes and janssen 1978 and the wave dissipation by bottom friction was modelled according to the experimental results from the joint north sea wave project jonswap hasselmann et al 1973 the peak enhancement and bottom friction coefficients were set to 3 3 and 0 067 respectively the wave directions of wwm iii contained 36 bins over a range of 0 360 the discrete wave frequencies were also divided into 36 bins with the lowest and highest frequency limits of 0 03 hz and 1 0 hz respectively a constant wave breaking coefficient of 0 78 was adopted in wwm iii for computing waves breaking in shallow water areas different time steps were used to maximize the execution efficiency in schism 2d and wwm iii a time step of 600 s was assigned to wwm iii i e schism 2d and wwm iii exchanged information at 5 hydrodynamic time intervals the wind velocities water surface elevations and depth integrated velocities were passed from schism 2d to wwm iii the calculated radiation stress was returned to schism 2d by solving the wave action equation the schism wwm iii has been used to evaluate the potential storm wave hazards in the nearshore waters of taiwan shih et al 2018 chang et al 2018 roland et al 2012 described in detail how the coupling procedures of the schism wwm iii were achieved 2 3 computational mesh and bathymetric data a computational domain from 111 e to 135 e and 18 n to 30 n was developed for the schism wwm iii this coverage is sufficiently wide for simulating storm surges and storm waves driven by typhoons travelling long distances from east to west over taiwan as shown in fig 2a the schism wwm iii mesh consists of 327 955 triangular cells and 168 829 unstructured grids fig 1 a the resolutions of the triangular meshes are varied from tens of kilometres to hundreds of metres in the coastal waters fine meshes with 200 m resolutions were arranged along the coastline of taiwan and its offshore islands and coarse meshes with 40 km resolutions were distributed in the open ocean beyond the coastal region although the simulation accuracy may be improved using a high resolution mesh the computational demands such as computer resources and execution time will increase according to the results from previous studies zhang and sheng 2013 muis et al 2016 marsooli and lin 2018 the mesh resolution determined in the present study was sufficiently fine to represent the surf zone and shallow waters the gridded bathymetric data for the schism wwm iii comprise global scale and local scale datasets the gebco 2014 grid obtained from the general bathymetric chart of the oceans gebco is a global scale dataset with 30 arcsecond resolution the local scale dataset with a 200 m resolution has an extent from 100 e to 128 e and from 4 n to 29 n which was received from the department of land administration and the ministry of the interior in taiwan two datasets were merged to produce the final bathymetric data for the computational domain of the schism wwm iii after the unstructured grids were created the merged gridded bathymetric dataset was interpolated to each node to represent the seafloor elevations in the schism wwm iii fig 1b the use of the same computational domain mesh in both the schism 2d and wwm iii eliminated the requirements for interpolation and simplified the information exchange between the two models thus leading to increased execution efficiency 2 4 typhoons and observations the model output of the storm tide sea surface elevation swh and mean wave period were validated hourly with observational data a one month simulation from september 1 to september 30 2016 was conducted by the schism wwm iii three severe weather events typhoons meranti malakas and megi were considered in the present study and these three typhoons were categorized as no 4 6 and 3 respectively by the central weather bureau cwb of taiwan according to their tracks regarding the typhoon intensity scales typhoon meranti in 2016 was one of the most intense typhoons tropical cyclones on record meranti became a super typhoon early on september 12 and reached its peak intensity on september 13 2016 the maximum wind speed of super typhoon meranti in 2016 was attained at 61 m s the intensities of typhoons malakas and megi in 2016 were relatively weak with maximum wind speeds of only 48 m s and 43 m s respectively according to the report from the cwb typhoon meranti had the highest wind speed and closest track to taiwan in the past 20 years 1999 2018 even though it passed the southern waters of taiwan without making landfall typhoon malakas immediately followed typhoon meranti and slightly affected the eastern waters of taiwan the interactions between these two typhoons must be considered in the storm tide surge and wave simulations additionally it is worthwhile to study the storm tide surge and wave impacts that occurred in response to the typhoon that made landfall in taiwan e g typhoon megi the detailed information on the three typhoons is individually summarized in tables 1 3 fig 2 demonstrates the tracks and arrival times of typhoons meranti fig 2a malakas fig 2b and megi fig 2c in 2016 the observations of the storm tides swh and mean wave periods measured at four tidal stations and four wave buoys by the taiwan cwb in september 2016 were adopted to evaluate the most adequate wind field for the schism wwm iii as well as further numerical experiment analyses the locations of four tidal stations the wushi suao hualien and houbuhu tidal stations and four wave buoys the guishandao suao hualien and taitung buoys are also shown in fig 2a c the coordinates and water depths of the four wave buoys are listed in table 4 3 results 3 1 effects of wind fields on model performance the storm tides swhs and mean wave periods of taiwanese waters in september 2016 were reproduced by the schism wwm iii the wind fields extracted from the global cfsv2 era5 and era interim served as meteorological conditions for the schism wwm iii fig 3 illustrates the wind field snapshots of cfsv2 fig 3a d and 3g era5 fig 3b e and 3h and era interim fig 3c f and 3i for typhoons meranti fig 3a b and 3c malakas fig 3d e and 3f and megi fig 3g h and 3i in 2016 as shown in fig 3 a c the cfsv2 wind speed exceeded 50 m s and was distinctly higher than that of the era5 and era interim for super typhoon meranti in 2016 the cfsv2 and era5 generated similar wind speeds approximately 30 40 m s fig 3d and e for typhoon malakas in 2016 however weak winds of less than 30 m s were found in the era interim for the same typhoon fig 3f in addition the central positions of typhoon malakas in 2016 from the cfsv2 and era5 were close but inconsistent with that from the era interim slight differences between the wind speeds of cfsv2 era5 and era interim are shown in fig 3 g i for typhoon megi in 2016 as the wind speeds ranged from 35 to 45 m s fig 4 a d presents the time series model data comparisons for swhs at the guishandao fig 4a suao fig 4b hualien fig 4c and taitung fig 4d wave buoys from september 11 to september 30 2016 the maximum swhs of approximately 5 0 m were measured at the guishandao and hualien buoys while a maximum of 4 5 m was measured at the suao buoy a large swh exceeding 16 0 m was observed at the taitung buoy when super typhoon meranti passed the southern waters of taiwan september 13 to september 16 2016 typhoon malakas induced maximum swhs were insignificant and less than 5 0 m at the four wave buoys because the track of typhoon malakas was far from taiwan september 16 to september 18 2016 the maximum swhs generated by typhoon megi reached 11 0 m at the guishandao suao and hualien buoys and 10 0 m at the taitung buoy september 26 to september 29 2016 the swh simulations driven by winds from the cfsv2 and era5 were consistent with the observations from all buoys during typhoons malakas and megi in 2016 swh overestimations were obtained using the cfsv2 wind field while underestimations were found by employing the era5 winds for super typhoon meranti in 2016 all shw simulations under the era interim typhoon conditions were greatly inferior to those produced by exerting the cfsv2 and era5 winds this phenomenon was obvious at the taitung buoy during super typhoon meranti in 2016 fig 4d the time series and model data comparisons for the mean wave period are demonstrated in fig 4e h fig 4e for the guishandao buoy fig 4f for the suao buoy fig 4g for the hualien buoy and fig 4h for the taitung buoy the schism wwm iii pairing with the cfsv2 and era5 wind fields well simulated the mean wave periods at the four wave buoys except that the cfsv2 winds were imposed for super typhoon meranti in 2016 the overall mean wave period simulations obtained by adopting the era interim winds provided the worst results the typhoon driven storm tides at the four tidal stations are illustrated in fig 5 fig 5a for the wushi tidal station fig 5b for the suao tidal station fig 5c for the hualien tidal station and fig 5d for the houbihu tidal station in general the storm tide observations at the wushi suao and hualien tidal stations were nearly identical to the astronomical tides indicating that the typhoon induced storm surge was insignificant along the eastern coast of taiwan even though typhoon megi in 2016 made landfall near the hualien tidal station the wind stress acting on a shallow water area accounts for the large storm surges as the water depth increases the storm surge decreases under the same wind stress the eastern waters of taiwan are thousands of metres deep which consequently weakens the wind stress effect on the storm surge fig 1b a significant storm tide of 1 85 m was measured at the houbihu tidal station when super typhoon meranti in 2016 passed the southern waters of taiwan this occurrence was mainly due to the flat seafloor near that station as well as the strong typhoon winds all storm tide simulations for the houbihu tidal station were underestimated except through the utilization of the wind field from the cfsv2 however the overestimations of the swh and mean wave period for super typhoon meranti in 2016 were significant to develop the best typhoon wind field for generating acceptable swh mean wave period and storm tide simulations the parametric typhoon wind models mrv were incorporated into the era5 to create the hybrid wind fields by means of eq 1 hereafter era5h because the wind speeds from the era5 were between those from the cfsv2 and the era interim the instantaneous wind field distributions of the era5h for typhoons meranti malakas and megi in 2016 are shown in fig 6 a c respectively the wind speeds increased obviously near the centers of the typhoons the improvements to the swh mean wave period and storm tide simulations that resulted from utilizing winds from the era5h were significant as shown by the comparison of figs 4 and 7 for the swhs and mean wave periods and figs 5 and 8 for the storm tides hence the pairing of the schism wwm iii with the era5h winds was employed to further assess the contributions of nonlinear terms to the storm tide for super typhoon meranti in 2016 3 2 the wave setup and wave tide interaction contributions to the storm tide as listed in table 5 seven scenarios s1 for tide s2 for surge s3 for tide surge s4 for surge wave s5 for tide surge wave s6 for surge wave with wave dependent bottom stress and s7 for tide surge wave with wave dependent bottom stress were considered under different simulation conditions to achieve the goals of the present study the contributions of wave setup with and without tidal effects to the storm tide were quantified via the storm tide differences of s5 minus s3 and s4 minus s2 respectively the contributions of the tide surge interaction with and without wave effects to the storm tide were quantified via the storm tide differences of s5 minus s1 and s4 and s3 minus s1 and s2 respectively the wave tide interaction contributions to the storm tide were quantified by subtracting the wave setup with the tidal effect from those without the tidal effect the details of each scenario are also listed in table 6 fig 9 depicts the time series storm tide simulations that were created by using fully coupled tide surge wave s5 and tide surge s3 models and the difference between the two scenarios i e wave setup with tidal effects for the houbihu tidal station the maximal wave setup was approximately 0 97 m and accounted for 64 of the total water level storm tide storm surges simulated with s4 and without s2 waves were performed to better understand the effects of tides on the wave setup the results detected in fig 10 reveal that storm surge miscalculations may arise due to the absence of waves the maximal wave setup without tidal effects reached 0 98 m and contributed 103 of the total surge when the wind induced surge was negative the wave setups were very significant when tides were both present and absent the spatial distributions of the wave setup with and without tidal effects at the time when the maximum wave setup occurred at the houbihu tidal station for super typhoon meranti in 2016 are illustrated in fig 11 a and fig 11b respectively sea areas with water depths greater than 50 m are shown depth induced wave breaking and bottom friction in shallow areas of the southern coastal waters of taiwan cause intensive wave energy dissipation and consequently increase the wave setup marsooli and lin 2018 the model results reveal that the wave setup along the coast varied from 0 1 m to 0 9 m and the wave setup highly depended on the wave height bathymetry and coastline geometry xie et al 2019 the difference between the wave setups with and without tidal effects quantified the contribution of the wave tide interaction to the storm tide at the houbihu tidal station during super typhoon meranti in 2016 the time series comparison is demonstrated in fig 12 the wave tide interactions provide the total water level within 0 1 m for the houbihu tidal station compared to the wave setup the spatial distribution of the wave tide interaction is minor for the storm tide as shown in fig 13 this phenomenon may be due to the small tidal variations and weak wave tide interactions i e the tide effects on the wave setup changes are enhanced by large tidal variations kim et al 2008 3 3 the contribution of the tide surge interaction to the storm tide the storm tide simulations from s5 tide surge wave minus those from the sum of s1 tide and s4 surge wave are determined to be the contributions of the tide surge interaction with wave effects to the storm tide fig 14 a similarly the differences in storm tide simulations between s3 tide surge and s2 surge are considered to be the contributions of the tide surge interaction without wave effects to the storm tide fig 14b the maximum tide surge interaction at the houbihu tidal station during super typhoon meranti in 2016 was approximately 0 4 m however the general tide surge interactions were the least significant and weakest nonlinear interactions for the storm tide in the present study at only 0 005 m and 0 m respectively fig 14b also shows that the maximum storm tide will be severely underestimated even if the tide surge interactions are included in the model s3 snapshots of the contribution of the tide surge interaction to the storm tide with and without wave effects for the time when the maximum storm tide occurred at the houbihu tidal station during super typhoon meranti in 2016 are illustrated in fig 15 a and fig 15b respectively to better reveal their spatial distributions the effects of significant differences in tide surge interactions on the storm tide with and without wave effects were detected the tide surge interaction with wave effects was approximately 0 06 0 08 m while the tide surge interaction without wave effects supplied only 0 02 m to the storm tide in the sea areas adjacent to the houbihu tidal station 4 discussion and uncertainties krien et al 2017 assessed the storm surge hazard for the island of martinique in the lesser antilles and found that the contribution of radiation stress gradients i e wave setup can account for almost all the total surge up to 100 in some cases for instance this phenomenon occurs when a hurricane typhoon makes landfall and induces cross shore or offshore wind along the northern coast of martinique pedreros et al 2018 investigated the importance of wave setup to the storm surge on truc vert beach and tubuai island their results also demonstrated that the wave setup is a predominant constituent of the whole storm surge with contributions ranging from 50 to 80 and 20 120 of the total storm surge for truc vert beach and tubuai island respectively additionally values exceeding 100 were observed on tubuai island when the atmospheric storm surge was negative their findings are identical to the results deduced from the present study storm surges in coastal shallow water areas are mainly driven by the momentum transmitted to the water column from winds and waves many previous studies that focused on storm tide and storm surge modelling ignored wind waves and attempted to atone for this omission by adjusting the wind drag coefficient to fit the local calibration data dube et al 2004 dietsche et al 2007 park and suh 2012 chen et al 2012 oey and chou 2015 in this case the wind drag coefficient was made as large as necessary in the storm surge model if underestimations occurred resio and westerink 2008 however powell et al 2003 indicated that the wind drag coefficient should be limited to approximately 0 0025 in the region of the typhoon generated storm surge additionally the momentum transfer rate from wave breaking is highly dependent on the depth and slope of the seafloor and relatively independent of the wind contribution fig 16 depicts the strong exceeded 40 m s offshore fig 16a and onshore fig 16b winds caused by super typhoon meranti in 2016 the times in fig 16a and b correspond to those of points a and b in fig 10 respectively a negative surge of 0 03 m was generated by offshore winds fig 16a when the waves at time point a were excluded from the model dashed red line in fig 10 but the surge manifested as positive 0 95 m at the same time point owing to the presence of waves in the model solid black line in fig 10 an interesting phenomenon is that the surges simulated by s4 surge wave were always higher than those simulated by s2 surge only although a decrease occurred at time point a implying that the radiation stress led by the waves was more intensive than the wind stress for the storm tides at the houbihu tidal station during super typhoon meranti in 2016 in contrast the onshore winds fig 16b without waves developed a positive surge of only 0 63 m at time point b dashed red line in fig 10 however the surge simulated with waves reached nearly 1 36 m solid black line in fig 10 at the same time point the result reveals that a surge enhancement by the waves could be 1 16 times 1 36 0 63 0 63 1 16 as large as that by the wind alone in the coastal shallow water areas being affected by a super typhoon this problem can be resolved by considering the surface wave induced momentum flux radiation stress exerted on the mean flow apart from momentum transfer from winds in the numerical model i e employing a fully coupled tide surge wave model for storm tides and storm surges simulation fig 17 demonstrates the simulations of maximum swh that were created by utilizing the fully coupled fig 17a c and e and decoupled fig 17b d and f models for typhoons meranti fig 17a and b malakas fig 17c and d and megi fig 17e and f in september 2016 as shown in fig 17 there are almost no discrepancies in the spatial distribution or the magnitude between the two models waters deeper than 5000 m and small tidal variations are the main reasons for this phenomenon the model validations in the present study are satisfactory however uncertainties may arise due to the omission of some physical processes e g setting a constant manning coefficient and neglecting the baroclinic forcing and freshwater discharge from rivers jones and davies 1998 suggested that the improvements to storm surge predictions that result from including wave enhanced bottom stress for storm surge modelling need to be clarified the contribution of wave dependent bottom stress to wave setup was also investigated using the parameterizations proposed by grant and madsen 1979 fig 18 reveals the comparison between the manning and wave dependent bottom stress approaches for the storm surge fig 18a simulations from s4 and s6 and wave setup fig 18b simulations from s5 s3 and s7 s3 simulations at the houbihu tidal station the wave dependent bottom stress generally decreased the surge and wave setup by 0 024 m and 0 020 m respectively when the maximum surge or wave setup occurred this discrepancy was too small to confirm whether the wave dependent drag had an influence on storm surge or wave setup the selected tidal gauge station is linked to the bashi channel where the water depths rapidly exceed 20 m deep water might be one of the reasons why the bottom stress is a second order process for surge and wave setup bertin et al 2015 investigated the contributions of short waves to storm surges in the bay of biscay and found that the wave dependent bottom stress in the model decreased the storm surge by only 0 05 m and the result was similar to the results of the present study however the seabed shear stress could be modified by surface wave generated near bed orbital water motion additionally the developing waves may alter the sea surface roughness and consequently vary the wind stress further studies in shallow coastal areas should be carried out via a fully coupled tide surge wave model that incorporates the effects of surface waves on the sea surface and seabed stress to better assess their influences on storm tides or storm surge simulations the storm surge and waves are mainly driven by a reanalysis wind product merged with a parametric typhoon wind model in the present study a shift in the arrival time of typhoons is difficult to predict thus the effect of the tide on the wave setup at different tidal phases is not analysed in the present study 5 summary and conclusions in this study the storm tides swhs and mean wave periods in the waters surrounding taiwan were reproduced for the period of september 2016 which covers typhoons meranti malakas and megi by applying a two dimensional high resolution unstructured grid and a fully coupled circulation wave model schism wwm iii wind fields from the cfs version 2 cfsv2 of the ncep era interim and era5 of the ecmwf and the era5 merged with mrv era5h served as the meteorological conditions and were imposed on the schism wwm iii to achieve excellent simulation performances the cfsv2 wind speeds were higher than those of the era interim and era5 and particularly obvious in the case of super typhoon meranti in 2016 the schism wwm iii and the era5h winds were utilized to investigate the contributions of nonlinear terms to the storm tide for super typhoon meranti in 2016 because the maximum storm tide swh and mean wave period simulations at the houbihu tidal station were well matched by application of only the era5h winds seven scenario simulations were conducted to quantify the contributions of nonlinear interactions to the storm tide also known as the sea surface elevation or total water level simulation during super typhoon meranti in 2016 the wave setup was proven to be the most important nonlinear interaction component for the storm tide and its maximum reached 0 97 m and accounted for 64 of the storm tide at the houbihu tidal station during super typhoon meranti in 2016 the wave tide interaction contributed 0 1 m to the sea surface elevation at the houbihu tidal station and showed fewer effects on the storm tide than the wave setup the tide surge interaction with and without wave effects contributed 0 06 0 08 m and 0 02 m to the total water level respectively in the shallow sea areas adjacent to the houbihu tidal station and had minimal impact on the storm tide the results of the present study quantify and clarify the influence of nonlinear interactions on storm tide simulations suggesting that nonlinear interactions from surface waves especially wave setups must be considered in the numerical model to avoid severe miscalculations of storm tides or storm surges in shallow water coastal areas acknowledgments this research was supported by the ministry of science and technology most taiwan grant no most 108 2625 m 865 001 the authors would like to thank the central weather bureau and the department of land administration and the ministry of the interior in taiwan for providing the measurements dr joseph zhang at the virginia institute of marine science college of william mary and dr aron roland at the institute for hydraulic and water resources engineering technische universität darmstadt for kindly sharing their experiences of using the numerical model 
22327,wind field data from the national centers for environmental prediction climate forecast system version 2 cfsv2 the european centre for medium range weather forecasts era interim and era5 and the era5 blended into the parametric typhoon model era5h from september 1 to 30 2016 were adopted to drive a fully coupled circulation wave model the best performance of the maximum storm tide and significant wave height swh and mean wave period simulation for typhoon events was found by applying the era5h the contributions of nonlinear interactions to the storm tide induced by super typhoon meranti in 2016 were quantified using seven scenario simulations the results indicated that the wave setup had the most significant nonlinear interaction with the storm tide which was up to 0 97 m both with and without tidal effects the wave tide interaction was relatively minor for the total water level and contributed only 0 1 m to the storm tide significant differences in the tide surge interactions were detected with and without wave effects as these interactions provided approximately 0 06 0 08 m and 0 02 m of the storm tide respectively the spatial distributions of the maximum swh for typhoon events were similar when coupled and decoupled models were employed in this paper it is concluded that storm surge miscalculation can be avoided if wave setups are included when predicting typhoon generated storm tides keywords nonlinear interaction wave setup storm tide super typhoon fully coupled circulation wave model 1 introduction every year typhoons known as tropical cyclones or hurricanes impact millions of people and result in billions of dollars us dollars usd of damage worldwide according to the international disaster database report typhoons affected 12 8 million people and resulted in a record 1 593 deaths in 2018 the economic losses resulting from typhoons particularly those due to hurricanes michael 16 billion usd for the united states and florence 14 billion usd for the united states and typhoon jebi 12 5 billion usd for japan indicate that typhoons were the costliest disasters in 2018 a super typhoon is the equivalent of a category 4 or 5 hurricane on the saffir simpson scale meaning the maximum wind speed near the typhoon centre exceeds 114 kt or 58 6 ms 1 huang and xu 2010 in addition to powerful winds a super typhoon has the ability to produce high storm surges and torrential downpours which rank among the most destructive global natural hazards balaguru et al 2016 for example super typhoon haiyan made landfall in the philippines on november 7 2013 as one of the strongest tropical cyclones ever recorded and at least 90 of the structures in the city of tacloban were damaged or destroyed by up to 4 m high storm surges furthermore seiche oscillation significantly amplified the water surface elevations inside the leyte gulf in addition to the strong wind from super typhoon haiyan mori et al 2014 over the past 30 years the average latitude where typhoons reach their peak intensity has shifted northward in the western north pacific ocean this migration is anticipated to increase the threat of typhoons in the east china sea region including the taiwan islands japan and the ryukyu islands the korea peninsula and parts of eastern china kossin et al 2016 however global warming not only causes the locations of typhoon peak intensity to migrate but also increases the wind speed and frequency of strong typhoons emanuel 2005 suggested that future increases in global mean temperatures may cause an upward trend in the devastating potential of a typhoon which will result in increased typhoon related losses recently his research completed a linear trend analysis of historical typhoon data from 1980 to 2016 and a significant global increase was found for all typhoons with maximum wind speeds of 175 km h typhoons with wind speeds of 200 km h or more have doubled in number and those with wind speeds of 250 km h or more have tripled this result provides conclusive evidence that a global increase in the most intense typhoons due to global warming not only has been predicted by models but also is already occurring the storm tide also known as the sea surface elevation or total water level is a combination of the astronomical tide and storm surge and is the actual sea water level that leads to inundations in low lying areas along the coast many previous studies have focused on storm surge and thus subtract either simulated tides or harmonic tides tides obtained from the harmonic constants from the total water levels to remove astronomical tide fluctuations however the modelled and measured storm tides in coastal waters are highly non stationary with significant variations in phase and amplitude during a typhoon moreover tidal ranges may commonly be reduced or even eliminated when typhoons bring large amounts of freshwater to the coast near estuaries kukulka and jay 2003 georgas 2012 therefore excluding the tidal signal from the sea surface elevation is not a straightforward task orton et al 2012 the mean tidal range along the taiwan coast varies from 0 8 to 4 0 m representing the most important role of the total water elevation which is the primary concern and should be included in studies on coastal flooding wave tide interactions can modulate the wave climate in regions with strong dynamics although this process is usually ignored lewis et al 2019 bernier and thompson 2007 found that strong tide surge interactions occur in the northumberland strait canada and the gulf of maine lin et al 2012 simulated large numbers of synthetic surge events under projected climates for the battery new york city their results indicated that tide surge nonlinearity is positive at low tides and negative at high tides wave setup is a very important phenomenon in surf zone hydrodynamics wave setup is the local elevation in the mean water level on the foreshore which is induced by the presence of breaking waves reduction in wave height through the surf zone under typhoon conditions radiation stress can be an important term in storm tides or storm surge applications because wave setup increases the total water level close to the coast causing widespread damage associated with coastal area flooding kim et al 2010 brown et al 2011 chen et al 2017 thuy et al 2017 indicated that the surge wave interaction is crucial to the storm surge simulations on the coast of central vietnam an extreme sea level event i e storm tide is primarily driven by an integration of the tide and typhoon generated storm surge and waves lewis et al 2011 2013 hence quantifying the contributions of nonlinear interactions e g wave tide tide surge interactions and wave setup to the storm tide is important for marine forecasting and simulations especially for a super typhoon event predicting or hindcasting realistic storm tides surges and waves highly relies on numerical efficiency and a robust and high resolution fully coupled circulation wave model as well as an accurate typhoon wind field powell et al 2010 accordingly forcing the circulation and wave models using gridded meteorological data with high spatial and temporal resolution instead of analytical parametric models could improve the accuracy of storm surge and wave simulations the aim of this paper is to study the role of nonlinear interactions in storm tide simulations by employing a fully coupled tide surge wave model and meteorological conditions from global numerical weather simulation systems the details of the methods and materials are described in the following section and the results of a series of scenario simulations are presented in section 3 in section 4 a discussion and uncertainties of the present study are given which is followed by a summary and conclusion in section 5 2 methods and materials 2 1 wind fields and open boundary conditions accurate wind forcing is an indispensable meteorological condition for the accurate simulation of storm tides and wind waves janssen 2004 wind field specification for a typhoon is fairly complicated cardone and cox 2009 therefore three dynamic wind fields were adopted during the same period to obtain better simulations of the storm tide significant wave height swh and mean wave period 2 1 1 era interim reanalysis wind field reanalysis data of the wind fields produced by era interim were acquired from the public datasets of the european center for medium range weather forecasts ecmwf era interim is a global atmospheric reanalysis dataset that begins in 1979 and the data are continuously updated monthly with a two month delay dee et al 2011 the original era interim gridded dataset has a horizontal resolution of 0 75 0 75 approximately 80 km era interim represents a third generation reanalysis because it uses an atmospheric model and assimilation system that are greatly improved from those used in era 40 in the present study the 10 m u and v wind components were acquired from the era interim reanalysis interpolated products at a spatial resolution of 0 125 0 125 approximately 13 km and a temporal resolution of 6 h four analysis fields per day at 00 00 06 00 12 00 and 18 00 utc 2 1 2 era5 reanalysis wind field era5 is a fifth generation ecmwf atmospheric reanalysis of the global climate that combines vast amounts of historical observations into global estimates using advanced modelling and data assimilation systems the era5 dataset provides hourly estimates of a large number of atmospheric land and oceanic climate variables and includes information about uncertainties for all variables the reanalysis data cover the earth on a 0 25 approximately 30 km grid and resolve the atmosphere using 137 levels from the surface to a height of 80 km the era5 data are now published with quality assured monthly updates within 3 months of real time with respect to era interim the hourly output resolution of era5 is an improvement and provides a more detailed evolution of particular severe weather events such as typhoons 2 1 3 cfsv2 wind field the national centers for environmental prediction ncep climate forecast system cfs was upgraded to version 2 cfsv2 and made operational at the ncep in march 2011 the cfsv2 is the same model that was used to create the ncep climate forecast system reanalysis cfsr the cfsv2 is undoubtedly superior to the cfs especially on the intraseasonal time scale the cfsv2 also creates many more products for subseasonal and seasonal forecasting with an extensive set of retrospective forecasts for users to calibrate their forecast products saha et al 2014 the cfsv2 products are available at horizontal resolutions of 0 2 0 5 1 0 and 2 5 and hourly intervals thus hourly wind data with a 0 2 spatial resolution were utilized in the present study 2 1 4 hybrid typhoon wind model a parametric typhoon wind model generally creates a highly accurate wind field near the centre of a typhoon but the accuracy decreases as the distance from the typhoon centre increases while a reanalysis wind product is superior in the areas away from the centre of a typhoon but inferior around the typhoon centre pan et al 2016 it is believed that improved wind fields of an entire typhoon for storm tide surge and wave modelling can be acquired through a combination of parametric typhoon models and reanalysis wind products chang et al 2018 yu et al 2019 chen et al 2019 the modified rankine vortex mrv model phadke et al 2003 was employed to superpose the reanalysis wind field data by an approach proposed by shao et al 2018 1 w h w m r 2 r max α 0 70 α 0 06 w m 1 α 0 72 1 α 0 28 w r 2 r max r 7 r max w r r 7 r max where w h is the hybrid typhoon wind w m is the parametric typhoon wind w r is the reanalysis wind r is the radial distance from the centre of the typhoon to an arbitrary point r max is the radius of the maximum wind speed and α 7 r r max 5 2 1 5 tidal forcing the harmonic constants including the amplitudes and phases of eight main tidal constituents m2 s2 n2 k2 k1 o1 p1 and q1 were extracted from a regional inverse tidal model for the china seas indonesia with a resolution of 1 30 zu et al 2008 and were then considered to be the boundary conditions to drive the model at each time step an inverted barometer effect resulting from low atmospheric pressure was also considered in the model 2 2 fully coupled circulation wave model schism wwm iii a semi implicit cross scale hydroscience integrated system model schism developed by zhang et al 2016 was used to reproduce the water surface elevations and tidal currents of taiwanese waters in sep 2016 schism is an evolutionary product of the original selfe semi implicit eulerian lagrangian finite element model zhang and baptista 2008 and the model has many enhancements and upgrades the key features of schism include a new extension to a large scale eddy regime and a seamless cross scale capability from streamlet to ocean schism solves the shallow water equations with hydrostatic and boussinesq approximations using finite element and finite volume methods the use of no mode splitting in schism results in the elimination of numerical errors that result from the splitting between internal and external modes shchepetkin and mcwilliams 2005 schism eliminates the most severe stability restrictions e g courant friedrichs lewy cfl since the semi implicit schemes are applied to all governing equations the nonlinear advection terms in the momentum equations are treated with an eulerian lagrangian method thus the numerical stability constraints are further relaxed the 2d depth integrated model is preferred to the 3d model for storm tides and wave modelling owing to the affordable computer resource requirements and the reduced execution time additionally typhoon induced phenomena are well captured by the 2d model therefore the 2d depth integrated version of schism schism 2d was used in the present study a manning coefficient of 0 025 and a time of 120 s were set in the model based on the type of sea bottom material and numerical stability komen et al 1994 indicated that phase averaged spectral wave models are efficient tools for simulating sea states for realistic applications therefore the third generation spectral wave model wind wave model iii wwm iii was adopted in the present study wwm iii was originally derived from the source code of hsu et al 2005 but most of the numerical schemes physics robustness and efficiency of the model were overhauled by roland 2009 the fractional steps method proposed by yanenko 1971 was utilized to solve the wave action equation on an unstructured grid in wwm iii first the geographical part was solved using the residual distribution scheme introduced by roe 1982 and improved by abgrall 2006 subsequently the advection in spectral space was treated by the ultimate quickest finite difference scheme leonard 1991 the source terms of the wave action equation were finally integrated in a manner similar to that used for wavewatchiii tolman 2009 according to the terms time scales or nonlinearity the nonlinear interactions in deep and shallow water were computed using the discrete interaction approximation of hasselmann et al 1985 and the lumped triad approximation of eldeberky 1996 the shallow water wave breaking formulation was based on the work of battjes and janssen 1978 and the wave dissipation by bottom friction was modelled according to the experimental results from the joint north sea wave project jonswap hasselmann et al 1973 the peak enhancement and bottom friction coefficients were set to 3 3 and 0 067 respectively the wave directions of wwm iii contained 36 bins over a range of 0 360 the discrete wave frequencies were also divided into 36 bins with the lowest and highest frequency limits of 0 03 hz and 1 0 hz respectively a constant wave breaking coefficient of 0 78 was adopted in wwm iii for computing waves breaking in shallow water areas different time steps were used to maximize the execution efficiency in schism 2d and wwm iii a time step of 600 s was assigned to wwm iii i e schism 2d and wwm iii exchanged information at 5 hydrodynamic time intervals the wind velocities water surface elevations and depth integrated velocities were passed from schism 2d to wwm iii the calculated radiation stress was returned to schism 2d by solving the wave action equation the schism wwm iii has been used to evaluate the potential storm wave hazards in the nearshore waters of taiwan shih et al 2018 chang et al 2018 roland et al 2012 described in detail how the coupling procedures of the schism wwm iii were achieved 2 3 computational mesh and bathymetric data a computational domain from 111 e to 135 e and 18 n to 30 n was developed for the schism wwm iii this coverage is sufficiently wide for simulating storm surges and storm waves driven by typhoons travelling long distances from east to west over taiwan as shown in fig 2a the schism wwm iii mesh consists of 327 955 triangular cells and 168 829 unstructured grids fig 1 a the resolutions of the triangular meshes are varied from tens of kilometres to hundreds of metres in the coastal waters fine meshes with 200 m resolutions were arranged along the coastline of taiwan and its offshore islands and coarse meshes with 40 km resolutions were distributed in the open ocean beyond the coastal region although the simulation accuracy may be improved using a high resolution mesh the computational demands such as computer resources and execution time will increase according to the results from previous studies zhang and sheng 2013 muis et al 2016 marsooli and lin 2018 the mesh resolution determined in the present study was sufficiently fine to represent the surf zone and shallow waters the gridded bathymetric data for the schism wwm iii comprise global scale and local scale datasets the gebco 2014 grid obtained from the general bathymetric chart of the oceans gebco is a global scale dataset with 30 arcsecond resolution the local scale dataset with a 200 m resolution has an extent from 100 e to 128 e and from 4 n to 29 n which was received from the department of land administration and the ministry of the interior in taiwan two datasets were merged to produce the final bathymetric data for the computational domain of the schism wwm iii after the unstructured grids were created the merged gridded bathymetric dataset was interpolated to each node to represent the seafloor elevations in the schism wwm iii fig 1b the use of the same computational domain mesh in both the schism 2d and wwm iii eliminated the requirements for interpolation and simplified the information exchange between the two models thus leading to increased execution efficiency 2 4 typhoons and observations the model output of the storm tide sea surface elevation swh and mean wave period were validated hourly with observational data a one month simulation from september 1 to september 30 2016 was conducted by the schism wwm iii three severe weather events typhoons meranti malakas and megi were considered in the present study and these three typhoons were categorized as no 4 6 and 3 respectively by the central weather bureau cwb of taiwan according to their tracks regarding the typhoon intensity scales typhoon meranti in 2016 was one of the most intense typhoons tropical cyclones on record meranti became a super typhoon early on september 12 and reached its peak intensity on september 13 2016 the maximum wind speed of super typhoon meranti in 2016 was attained at 61 m s the intensities of typhoons malakas and megi in 2016 were relatively weak with maximum wind speeds of only 48 m s and 43 m s respectively according to the report from the cwb typhoon meranti had the highest wind speed and closest track to taiwan in the past 20 years 1999 2018 even though it passed the southern waters of taiwan without making landfall typhoon malakas immediately followed typhoon meranti and slightly affected the eastern waters of taiwan the interactions between these two typhoons must be considered in the storm tide surge and wave simulations additionally it is worthwhile to study the storm tide surge and wave impacts that occurred in response to the typhoon that made landfall in taiwan e g typhoon megi the detailed information on the three typhoons is individually summarized in tables 1 3 fig 2 demonstrates the tracks and arrival times of typhoons meranti fig 2a malakas fig 2b and megi fig 2c in 2016 the observations of the storm tides swh and mean wave periods measured at four tidal stations and four wave buoys by the taiwan cwb in september 2016 were adopted to evaluate the most adequate wind field for the schism wwm iii as well as further numerical experiment analyses the locations of four tidal stations the wushi suao hualien and houbuhu tidal stations and four wave buoys the guishandao suao hualien and taitung buoys are also shown in fig 2a c the coordinates and water depths of the four wave buoys are listed in table 4 3 results 3 1 effects of wind fields on model performance the storm tides swhs and mean wave periods of taiwanese waters in september 2016 were reproduced by the schism wwm iii the wind fields extracted from the global cfsv2 era5 and era interim served as meteorological conditions for the schism wwm iii fig 3 illustrates the wind field snapshots of cfsv2 fig 3a d and 3g era5 fig 3b e and 3h and era interim fig 3c f and 3i for typhoons meranti fig 3a b and 3c malakas fig 3d e and 3f and megi fig 3g h and 3i in 2016 as shown in fig 3 a c the cfsv2 wind speed exceeded 50 m s and was distinctly higher than that of the era5 and era interim for super typhoon meranti in 2016 the cfsv2 and era5 generated similar wind speeds approximately 30 40 m s fig 3d and e for typhoon malakas in 2016 however weak winds of less than 30 m s were found in the era interim for the same typhoon fig 3f in addition the central positions of typhoon malakas in 2016 from the cfsv2 and era5 were close but inconsistent with that from the era interim slight differences between the wind speeds of cfsv2 era5 and era interim are shown in fig 3 g i for typhoon megi in 2016 as the wind speeds ranged from 35 to 45 m s fig 4 a d presents the time series model data comparisons for swhs at the guishandao fig 4a suao fig 4b hualien fig 4c and taitung fig 4d wave buoys from september 11 to september 30 2016 the maximum swhs of approximately 5 0 m were measured at the guishandao and hualien buoys while a maximum of 4 5 m was measured at the suao buoy a large swh exceeding 16 0 m was observed at the taitung buoy when super typhoon meranti passed the southern waters of taiwan september 13 to september 16 2016 typhoon malakas induced maximum swhs were insignificant and less than 5 0 m at the four wave buoys because the track of typhoon malakas was far from taiwan september 16 to september 18 2016 the maximum swhs generated by typhoon megi reached 11 0 m at the guishandao suao and hualien buoys and 10 0 m at the taitung buoy september 26 to september 29 2016 the swh simulations driven by winds from the cfsv2 and era5 were consistent with the observations from all buoys during typhoons malakas and megi in 2016 swh overestimations were obtained using the cfsv2 wind field while underestimations were found by employing the era5 winds for super typhoon meranti in 2016 all shw simulations under the era interim typhoon conditions were greatly inferior to those produced by exerting the cfsv2 and era5 winds this phenomenon was obvious at the taitung buoy during super typhoon meranti in 2016 fig 4d the time series and model data comparisons for the mean wave period are demonstrated in fig 4e h fig 4e for the guishandao buoy fig 4f for the suao buoy fig 4g for the hualien buoy and fig 4h for the taitung buoy the schism wwm iii pairing with the cfsv2 and era5 wind fields well simulated the mean wave periods at the four wave buoys except that the cfsv2 winds were imposed for super typhoon meranti in 2016 the overall mean wave period simulations obtained by adopting the era interim winds provided the worst results the typhoon driven storm tides at the four tidal stations are illustrated in fig 5 fig 5a for the wushi tidal station fig 5b for the suao tidal station fig 5c for the hualien tidal station and fig 5d for the houbihu tidal station in general the storm tide observations at the wushi suao and hualien tidal stations were nearly identical to the astronomical tides indicating that the typhoon induced storm surge was insignificant along the eastern coast of taiwan even though typhoon megi in 2016 made landfall near the hualien tidal station the wind stress acting on a shallow water area accounts for the large storm surges as the water depth increases the storm surge decreases under the same wind stress the eastern waters of taiwan are thousands of metres deep which consequently weakens the wind stress effect on the storm surge fig 1b a significant storm tide of 1 85 m was measured at the houbihu tidal station when super typhoon meranti in 2016 passed the southern waters of taiwan this occurrence was mainly due to the flat seafloor near that station as well as the strong typhoon winds all storm tide simulations for the houbihu tidal station were underestimated except through the utilization of the wind field from the cfsv2 however the overestimations of the swh and mean wave period for super typhoon meranti in 2016 were significant to develop the best typhoon wind field for generating acceptable swh mean wave period and storm tide simulations the parametric typhoon wind models mrv were incorporated into the era5 to create the hybrid wind fields by means of eq 1 hereafter era5h because the wind speeds from the era5 were between those from the cfsv2 and the era interim the instantaneous wind field distributions of the era5h for typhoons meranti malakas and megi in 2016 are shown in fig 6 a c respectively the wind speeds increased obviously near the centers of the typhoons the improvements to the swh mean wave period and storm tide simulations that resulted from utilizing winds from the era5h were significant as shown by the comparison of figs 4 and 7 for the swhs and mean wave periods and figs 5 and 8 for the storm tides hence the pairing of the schism wwm iii with the era5h winds was employed to further assess the contributions of nonlinear terms to the storm tide for super typhoon meranti in 2016 3 2 the wave setup and wave tide interaction contributions to the storm tide as listed in table 5 seven scenarios s1 for tide s2 for surge s3 for tide surge s4 for surge wave s5 for tide surge wave s6 for surge wave with wave dependent bottom stress and s7 for tide surge wave with wave dependent bottom stress were considered under different simulation conditions to achieve the goals of the present study the contributions of wave setup with and without tidal effects to the storm tide were quantified via the storm tide differences of s5 minus s3 and s4 minus s2 respectively the contributions of the tide surge interaction with and without wave effects to the storm tide were quantified via the storm tide differences of s5 minus s1 and s4 and s3 minus s1 and s2 respectively the wave tide interaction contributions to the storm tide were quantified by subtracting the wave setup with the tidal effect from those without the tidal effect the details of each scenario are also listed in table 6 fig 9 depicts the time series storm tide simulations that were created by using fully coupled tide surge wave s5 and tide surge s3 models and the difference between the two scenarios i e wave setup with tidal effects for the houbihu tidal station the maximal wave setup was approximately 0 97 m and accounted for 64 of the total water level storm tide storm surges simulated with s4 and without s2 waves were performed to better understand the effects of tides on the wave setup the results detected in fig 10 reveal that storm surge miscalculations may arise due to the absence of waves the maximal wave setup without tidal effects reached 0 98 m and contributed 103 of the total surge when the wind induced surge was negative the wave setups were very significant when tides were both present and absent the spatial distributions of the wave setup with and without tidal effects at the time when the maximum wave setup occurred at the houbihu tidal station for super typhoon meranti in 2016 are illustrated in fig 11 a and fig 11b respectively sea areas with water depths greater than 50 m are shown depth induced wave breaking and bottom friction in shallow areas of the southern coastal waters of taiwan cause intensive wave energy dissipation and consequently increase the wave setup marsooli and lin 2018 the model results reveal that the wave setup along the coast varied from 0 1 m to 0 9 m and the wave setup highly depended on the wave height bathymetry and coastline geometry xie et al 2019 the difference between the wave setups with and without tidal effects quantified the contribution of the wave tide interaction to the storm tide at the houbihu tidal station during super typhoon meranti in 2016 the time series comparison is demonstrated in fig 12 the wave tide interactions provide the total water level within 0 1 m for the houbihu tidal station compared to the wave setup the spatial distribution of the wave tide interaction is minor for the storm tide as shown in fig 13 this phenomenon may be due to the small tidal variations and weak wave tide interactions i e the tide effects on the wave setup changes are enhanced by large tidal variations kim et al 2008 3 3 the contribution of the tide surge interaction to the storm tide the storm tide simulations from s5 tide surge wave minus those from the sum of s1 tide and s4 surge wave are determined to be the contributions of the tide surge interaction with wave effects to the storm tide fig 14 a similarly the differences in storm tide simulations between s3 tide surge and s2 surge are considered to be the contributions of the tide surge interaction without wave effects to the storm tide fig 14b the maximum tide surge interaction at the houbihu tidal station during super typhoon meranti in 2016 was approximately 0 4 m however the general tide surge interactions were the least significant and weakest nonlinear interactions for the storm tide in the present study at only 0 005 m and 0 m respectively fig 14b also shows that the maximum storm tide will be severely underestimated even if the tide surge interactions are included in the model s3 snapshots of the contribution of the tide surge interaction to the storm tide with and without wave effects for the time when the maximum storm tide occurred at the houbihu tidal station during super typhoon meranti in 2016 are illustrated in fig 15 a and fig 15b respectively to better reveal their spatial distributions the effects of significant differences in tide surge interactions on the storm tide with and without wave effects were detected the tide surge interaction with wave effects was approximately 0 06 0 08 m while the tide surge interaction without wave effects supplied only 0 02 m to the storm tide in the sea areas adjacent to the houbihu tidal station 4 discussion and uncertainties krien et al 2017 assessed the storm surge hazard for the island of martinique in the lesser antilles and found that the contribution of radiation stress gradients i e wave setup can account for almost all the total surge up to 100 in some cases for instance this phenomenon occurs when a hurricane typhoon makes landfall and induces cross shore or offshore wind along the northern coast of martinique pedreros et al 2018 investigated the importance of wave setup to the storm surge on truc vert beach and tubuai island their results also demonstrated that the wave setup is a predominant constituent of the whole storm surge with contributions ranging from 50 to 80 and 20 120 of the total storm surge for truc vert beach and tubuai island respectively additionally values exceeding 100 were observed on tubuai island when the atmospheric storm surge was negative their findings are identical to the results deduced from the present study storm surges in coastal shallow water areas are mainly driven by the momentum transmitted to the water column from winds and waves many previous studies that focused on storm tide and storm surge modelling ignored wind waves and attempted to atone for this omission by adjusting the wind drag coefficient to fit the local calibration data dube et al 2004 dietsche et al 2007 park and suh 2012 chen et al 2012 oey and chou 2015 in this case the wind drag coefficient was made as large as necessary in the storm surge model if underestimations occurred resio and westerink 2008 however powell et al 2003 indicated that the wind drag coefficient should be limited to approximately 0 0025 in the region of the typhoon generated storm surge additionally the momentum transfer rate from wave breaking is highly dependent on the depth and slope of the seafloor and relatively independent of the wind contribution fig 16 depicts the strong exceeded 40 m s offshore fig 16a and onshore fig 16b winds caused by super typhoon meranti in 2016 the times in fig 16a and b correspond to those of points a and b in fig 10 respectively a negative surge of 0 03 m was generated by offshore winds fig 16a when the waves at time point a were excluded from the model dashed red line in fig 10 but the surge manifested as positive 0 95 m at the same time point owing to the presence of waves in the model solid black line in fig 10 an interesting phenomenon is that the surges simulated by s4 surge wave were always higher than those simulated by s2 surge only although a decrease occurred at time point a implying that the radiation stress led by the waves was more intensive than the wind stress for the storm tides at the houbihu tidal station during super typhoon meranti in 2016 in contrast the onshore winds fig 16b without waves developed a positive surge of only 0 63 m at time point b dashed red line in fig 10 however the surge simulated with waves reached nearly 1 36 m solid black line in fig 10 at the same time point the result reveals that a surge enhancement by the waves could be 1 16 times 1 36 0 63 0 63 1 16 as large as that by the wind alone in the coastal shallow water areas being affected by a super typhoon this problem can be resolved by considering the surface wave induced momentum flux radiation stress exerted on the mean flow apart from momentum transfer from winds in the numerical model i e employing a fully coupled tide surge wave model for storm tides and storm surges simulation fig 17 demonstrates the simulations of maximum swh that were created by utilizing the fully coupled fig 17a c and e and decoupled fig 17b d and f models for typhoons meranti fig 17a and b malakas fig 17c and d and megi fig 17e and f in september 2016 as shown in fig 17 there are almost no discrepancies in the spatial distribution or the magnitude between the two models waters deeper than 5000 m and small tidal variations are the main reasons for this phenomenon the model validations in the present study are satisfactory however uncertainties may arise due to the omission of some physical processes e g setting a constant manning coefficient and neglecting the baroclinic forcing and freshwater discharge from rivers jones and davies 1998 suggested that the improvements to storm surge predictions that result from including wave enhanced bottom stress for storm surge modelling need to be clarified the contribution of wave dependent bottom stress to wave setup was also investigated using the parameterizations proposed by grant and madsen 1979 fig 18 reveals the comparison between the manning and wave dependent bottom stress approaches for the storm surge fig 18a simulations from s4 and s6 and wave setup fig 18b simulations from s5 s3 and s7 s3 simulations at the houbihu tidal station the wave dependent bottom stress generally decreased the surge and wave setup by 0 024 m and 0 020 m respectively when the maximum surge or wave setup occurred this discrepancy was too small to confirm whether the wave dependent drag had an influence on storm surge or wave setup the selected tidal gauge station is linked to the bashi channel where the water depths rapidly exceed 20 m deep water might be one of the reasons why the bottom stress is a second order process for surge and wave setup bertin et al 2015 investigated the contributions of short waves to storm surges in the bay of biscay and found that the wave dependent bottom stress in the model decreased the storm surge by only 0 05 m and the result was similar to the results of the present study however the seabed shear stress could be modified by surface wave generated near bed orbital water motion additionally the developing waves may alter the sea surface roughness and consequently vary the wind stress further studies in shallow coastal areas should be carried out via a fully coupled tide surge wave model that incorporates the effects of surface waves on the sea surface and seabed stress to better assess their influences on storm tides or storm surge simulations the storm surge and waves are mainly driven by a reanalysis wind product merged with a parametric typhoon wind model in the present study a shift in the arrival time of typhoons is difficult to predict thus the effect of the tide on the wave setup at different tidal phases is not analysed in the present study 5 summary and conclusions in this study the storm tides swhs and mean wave periods in the waters surrounding taiwan were reproduced for the period of september 2016 which covers typhoons meranti malakas and megi by applying a two dimensional high resolution unstructured grid and a fully coupled circulation wave model schism wwm iii wind fields from the cfs version 2 cfsv2 of the ncep era interim and era5 of the ecmwf and the era5 merged with mrv era5h served as the meteorological conditions and were imposed on the schism wwm iii to achieve excellent simulation performances the cfsv2 wind speeds were higher than those of the era interim and era5 and particularly obvious in the case of super typhoon meranti in 2016 the schism wwm iii and the era5h winds were utilized to investigate the contributions of nonlinear terms to the storm tide for super typhoon meranti in 2016 because the maximum storm tide swh and mean wave period simulations at the houbihu tidal station were well matched by application of only the era5h winds seven scenario simulations were conducted to quantify the contributions of nonlinear interactions to the storm tide also known as the sea surface elevation or total water level simulation during super typhoon meranti in 2016 the wave setup was proven to be the most important nonlinear interaction component for the storm tide and its maximum reached 0 97 m and accounted for 64 of the storm tide at the houbihu tidal station during super typhoon meranti in 2016 the wave tide interaction contributed 0 1 m to the sea surface elevation at the houbihu tidal station and showed fewer effects on the storm tide than the wave setup the tide surge interaction with and without wave effects contributed 0 06 0 08 m and 0 02 m to the total water level respectively in the shallow sea areas adjacent to the houbihu tidal station and had minimal impact on the storm tide the results of the present study quantify and clarify the influence of nonlinear interactions on storm tide simulations suggesting that nonlinear interactions from surface waves especially wave setups must be considered in the numerical model to avoid severe miscalculations of storm tides or storm surges in shallow water coastal areas acknowledgments this research was supported by the ministry of science and technology most taiwan grant no most 108 2625 m 865 001 the authors would like to thank the central weather bureau and the department of land administration and the ministry of the interior in taiwan for providing the measurements dr joseph zhang at the virginia institute of marine science college of william mary and dr aron roland at the institute for hydraulic and water resources engineering technische universität darmstadt for kindly sharing their experiences of using the numerical model 
22328,as a special type of high speed vessel the hydrodynamic performance of trimanran is not yet fully understood and is still under investigation in this paper a viscous method is established based on rans to study the resistance in calm water added resistance and motion response in head waves of various wave amplitudes results from numerical simulation show satisfactory agreement with the experimental data in addition the effect of hull attitude on resistance in calm water and the effect of wave amplitude on added resistance as well as motion response are analysed the results show that the resistance of the trimaran in calm water is significantly influenced by the hull attitude at high speed however this resistance could be underestimated if the ship attitude is ignored because of the miscalculation of the free surface and the resistance of outriggers it is found that the added resistance induced by the center hull composes the dominant part of the total added resistance and the non dimensional value of added resistance is decreased with wave amplitude while the influence of wave amplitude on the non dimensional results of heave and pitch motion is not significant keywords trimaran resistance attitude motion wave amplitude 1 introduction in recent years there has been a remarkable increase in the number of high speed trimarans all over the world the trimaran has attracted an ever growing attention for its outstanding advantages such as lower levels of resistance at high speed and good seagoing performance bertorello et al 2001 and a comparatively wide deck compared with mono hull and catamaran hull forms the current trend in high speed trimarans especially for coastal car passenger ferries has led to a further research on the hydrodynamic characteristics in calm water and waves the wave interference between the center hull and the outriggers of a trimaran is known to be complicated as the waves repeatedly reflected and superimposed in a limited water area restrained by the main hull and the outrigger therefore the wave making resistance of trimaran in calm water is of interest most researches on the configuration and hull form optimization are performed based on the calculation of wave resistance such as kang et al 2001 and yang et al 2001 first order panel method and dawson s approach were adopted by kang to calculate the wave making resistance and free surface while in yang s research the wave making resistance estimation is based on the zeroth order slender ship approximation both of the calculation ignored the attitude of the trimaran and the comparison of the calculated results with the test data showed a good agreement in tendency but an obvious discrepancy in values because the method based on potential theory is capable of wave making resistance calculation it is adopted by some researchers even after several years to investigate the influence of the outriggers position on the hydrodynamic interference of high speed trimaran the slender body method embedded in the commercial software maxsurfa is used by hafez and el kot 2012 to calculate the resistance of three symmetric trimaran series moving in calm water and the effect of stagger of the outriggers is discussed a fast numerical method for trimaran wave making resistance prediction is proposed by yu et al 2015 based on an extension of the slender ship theory of noblesse in which the highly oscillatory terms within the associated kochin function are expanded as series of products of bessel functions and legendre polynomials to facilitate faster computation and to separate out specific parameter dependencies it is suggested by the researches that the method based on potential theory can offer an accurate result of wave making resistance but it is powerless in the calculation of sinkage and trim though some high order nonlinear factors such as the influence of the sinking and trim transom as well as ship wave immersed hull surface are taken into account by wang and lu 2011 to solve the trimaran wave making problems which is based on wyatt s work the nonlinear free surface boundary condition the time domain concept and the full nonlinear wave making theory model test begovic et al 2001 su et al 2014 is a common means to obtain the attitude variation in the recent years theories of viscous flow are adopted to simulate the flow fluid around trimaran which is a powerful way to obtain ship attitude and the obtained force applied on the vessel is more accurate for taking sinkage and trim into account meanwhile some approaches were introduced by the researchers to calculate the attitude of the trimaran javanmardi et al 2008 developed a cfd code and used it to investigate the hydrodynamic resistance and maneuvering of a trimaran with wigley body form in the conditions of different outrigger positions based on the viscous method a dynamic mesh technique is adopted by ni et al 2011 to coincide with the variation of sinkage and trim of high speed trimaran on voyage a three dimensional computational fluid dynamic cfd code based on the finite volume method fvm was used by jiang et al 2016 to simulate the forward motion of a planing trimaran hull with two degrees of freedom sinkage and trim all the numerical results in the work mentioned above showed a good agreement when compared with the test data a systematic analysis of the effect of trimming and sinkage on the resistance of a trimaran with and without appendage was performed by deng et al 2015 in which cfd method was adopted taking viscous effect and the free surface into account it is suggested that researchers are in an ever growing attraction on the computational methods based on the viscous theory and sinkage as well as trim is an important factor in the resistance calculation of trimaran which can not be neglected the added resistance and motion of trimaran in waves is another attractive topic however it is known as a difficult problem for the method based on potential theory because the motion is hard to calculate in the frequency domain though the wave loads and the effect of configuration on the added resistance can be obtained fang and chen 2008 presented a spectral analysis based on wave loads to select suitable side hull arrangements for a trimaran traveling in waves by neglecting the steady flow effect a three dimensional source distribution method is adopted to solve the corresponding hydrodynamic coefficients in which a pulsating source potential was used and incorporated with the panel method but the motion was neglected xu and zhang 2011 investigated the effect of layouts and lengths of side hulls on the wave loads based on three dimensional potential theory and green s function then a parametric optimization is performed in their work the wave loads in which vertical shear forces and vertical bending moments at different locations on the main hull are included and the transverse bending moments at the junction of the cross structure and main hull are analysed but again the motion of the vessel was neglected an interesting work is carried out by bruzzone and grasso 2007 in which a hybrid approach had been employed to analyse the seakeeping performance of trimaran advancing in head seas with regular waves in this method an unsteady hydrodynamic problem was solved in the frequency domain and the equations of motion were solved in the time domain radiation and diffraction forces were transferred from frequency to time domain while nonlinear froude krylov and hydrostatic forces are computed considering the actual hull wetted surface at each time step the integration of the solutions in frequency and time domain made it is possible to calculate the motion in a similar way an approach for hydrodynamic optimization of a triswach was developed by yang and huang 2014 both the positions and the shape of the side hulls are considered in the method potential flow based tool and euler rans navier stokes based cfd tool had been integrated into a practical multi objective hydrodynamic optimization approach these mean the method used to investigate the motion response of trimaran is turned from potential tools to semi viscous approach and the motion of the trimaran in waves is being drawn much more attention to than before meanwhile model test is an effective approach all the time kaspar et al 2007 investigated the effect of the stagger of the side hulls on heave and pitch of a trimaran and pointed out that variation of the gyration radius opposed a significant effect on the heave and pitch motions in the same year egorov and tonyuk 2007 conducted a systematic model test of trimaran longitudinal motion s hydrodynamic and kinematic properties and the exciting forces as well as damping coefficients are determined by special methods ma et al 2015 investigated the effect of the center of gravity on the seakeeping ability of a trimaran planing hull by experiment a series of important model test were performed by vakilabadi et al 2014 in which the effect of the velocity of the test model wave length and the wave amplitude on heave and pitch motion was investigated and a detailed conclusion was obtained investigations have shown that little research has been conducted on the numerical simulation of trimaran in waves by a viscous method taking heave and pitch motion into account but a study have to mention is the one carried out by http xueshu baidu com s wd author 3a 28karim 20akbari 20vakilabadi 29 20 tn se baiduxueshu c1gjeupa ie utf 8 sc f para sc hilight 3dperson wu et al 2011 in the work a cfd computation of the motions and added resistance of a trimaran was performed based on a limited amount of grid nodes rans and fvm method are employed and coupled with the motion equations of 6 degrees of freedom and good agreements are obtained between the computational results and experimental data it is suggested that the viscous method now is an effective approach in the investigation of the added resistance and motion of the trimaran in waves and it will be a powerful tool in the future the purpose of the present work is to study the hydrodynamic characteristics of a coastal passenger trimaran in calm water and regular head waves which induces calm water resistance variation of sinkage and trim added resistance and motion response researches are carried out in a series of numerical simulation and model test at first a reliable numerical scheme is set up and validated by the test data in the condition of calm water and then the influence of sinkage and trim is analysed then the scheme is validated by the test data in the condition of 30 0 mm regular head waves and the hydrodynamic characteristics are analysed next three different wave amplitudes are adopted to investigate the influence of wave amplitude and some results are found at last a series of wave amplitudes are employed for three conditions to study the effect of wave amplitude in details the investigation here will offer a better understanding of the hydrodynamic characteristics of the trimaran 2 numerical model the numerical model is constructed in accordance with the full scale ship with a scale ratio of 1 27 5 and the parameters of the model is shown in table 1 in table 1 l b t are length beam and draught respectively c b denotes the block coefficient s w is the water plane area δ is displacement and s is the wetted surface the clearance between the central longitudinal planes of the center hull and outrigger is 0 42 m the pitch radius of gyration is 0 9 m the natural pitch and heave periods are 5 48 and 4 40 s respectively the body plan of the center hull and outrigger as well as the configuration of the test model on the waterline plane is shown in fig 1 3 numerical scheme a numerical scheme in which the extent of the computational domain mesh generation turbulence model multi phase interaction boundary conditions and motion estimation are included is necessary for the numerical simulation to obtain accurate results the coordinate system is shown in fig 2 the origin of coordinate locates on the intersection of free surface of calm water symmetric plane and vertical transverse mid plane of the main hull in the simulation the trimaran is sailing in the longitudinal way which is in the negative x direction and sinks in the negative z direction the center of gravity is located at x 0 21 m y 0 m and z 0 15 m and the lcg of the vessel is 0 21 m in the present coordinate which coincides with the center of gravity the gm of the model is 0 29 m the location of the outriggers is adopted from the original design of the full scale ship suppose that the flow field is symmetric and half of the flow field is taken as the computational domain the extents of the computational domain are 1 5 l 3 5 l in the x direction 1 0 l 0 l in the y direction and 1 0 l 1 0 l in the z direction where l denotes the length of the trimaran it is known that mesh generation of the computational domain is quite important for the numerical calculation and therefore an appropriate mesh distribution is adopted to calculate the interaction between the center hull and the outriggers deng et al 2010 2011 deng et al 2011a b the mesh size on the hull surface as shown in fig 3 is about 0 1 l where l denotes the length of the center hull and the y value is estimated by the formula as follow 1 y 0 172 y l re 0 9 where y indicates the projected distance between the first node and hull surface and re is the reynolds number the y value is about 19 45 for the present trimaran in the condition of fr 0 495 v 3 924 m s the mesh size in the domain between the center hull and outriggers is about 0 1 l and the mesh is refined in the z direction from 0 5 b to 0 5 b the size of which is about 0 05 l the boundary conditions adopted in simulation include velocity inlet free stream outlet and symmetric plane the outline and mesh generation of the computational domain as well as the boundary conditions are shown in fig 3 in which the boundaries that are not shown with mesh are defined as wall with non slip condition finite volume method is adopted in the simulation and taken as incompressible viscous fluid the flow field should satisfy the equations of continuity 2 u i x i 0 i 1 2 3 unsteady incompressible reynolds averaged navier stokes rans method is employed as the governing equations as below 3 u i t x j u i u j p x i x j μ u i x j u i u j i j 1 2 3 the turbulence model in the present simulation is the classical 2 equation eddy viscosity model k ω shear stress transport sst model which takes the transverse flow and the effect of the curved hull surface into account the setting of the turbulence model is discussed in the preliminary research deng et al 2011 2013 and standard wall function is adopted in the simulation the equations of the k ω model are presented as follows 4 k t u j k x j x j ν ν t σ k k x j ν t u i x j u j x i u i x j β f β k ω i j 1 2 3 5 ω t u j ω x j x j ν ν t σ ω ω x j α u i x j u j x i u i x j β ω 2 d ω i j 1 2 3 6 ν t k ω 1 max 1 α ω f 2 α 1 ω 7 α α α 0 re t r k 1 re t r k 8 re t k ν ω 9 α 0 β i 3 10 β β i 1 ζ f m t 11 β i β 4 15 re t r β 4 1 re t r β 4 12 f m t 0 m t 2 m t 0 2 m t m t 0 m t m t 0 13 m t 2 2 k a 2 14 α α α α 0 re t r ω 1 re t r ω 15 β β i 1 β i β i ζ f m t 16 f β 1 70 χ ω 1 80 χ ω 17 χ ω ω i j ω j i s j i β ω 3 18 ω i j 1 2 u i x j u j x i i j 1 2 3 19 s j i 1 2 u i x j u j x i i j 1 2 3 20 σ k 1 f 1 σ k 1 1 f 1 σ k 2 21 σ ω 1 f 1 σ ω 1 1 f 1 σ ω 2 22 ω 2 ω i j ω i j 1 2 i j 1 2 3 23 f 1 tanh φ 1 4 24 φ 1 min max k 0 09 ω y 500 ν y 2 ω 4 ρ k σ ω 2 d ω y 2 25 d ω max 2 ρ 1 σ ω 2 1 ω k x j ω x j 10 20 i j 1 2 3 26 f 2 tanh φ 2 2 27 φ 2 max 2 k 0 09 ω y 500 ν y 2 ω 28 d ω 2 1 f 1 σ ω 2 1 ω k x j ω x j i j 1 2 3 29 α f 1 α 1 1 f 1 α 2 30 α 1 β i 1 β k 2 σ ω 1 β 31 α 2 β i 2 β k 2 σ ω 2 β 32 β i f 1 β i 1 1 f 1 β i 2 where α 1 0 α 0 1 9 r k 6 0 r β 8 0 r ω 2 95 β i 0 072 f β 1 β 0 09 m t 0 0 25 ζ 1 5 α 1 0 31 σ k 1 1 176 σ k 2 1 0 σ ω 1 2 0 σ ω 2 1 168 k 0 41 β i 1 0 075 β i 2 0 0828 and a is the velocity of sound volume of fluid vof method hirt and nichols 1981 is adopted to calculate the free surface velocity and pressure in the flow field are coupled by the pressure implicit split operator piso algorithm and second order up wind difference scheme is applied the ship model is of six degrees of freedom and the governing equations of motion are shown as follows 33 m d u i d t f i i 1 2 3 34 d d t i ω i m i i 1 2 3 where m is the mass of the trimaran u i is the velocity component f i denotes the applied force in the corresponding direction i is the moment of inertia ω i is the angular velocity and m i is the applied moment in the present research f i and m i are the hydrodynamic force and moment induced by viscous flow which conduct the motion of the trimaran and can be obtained by an integration on the wetted surface the code used in the present paper is the commercial software star ccm which is a widely used in ship and ocean engineering hydrodynamic analysis in the condition of head waves a domain next to the outlet boundary is employed for wave absorbing the extent of which is 1 l a numerical simulation in which the wave length is 1 80 m and the wave amplitude is 30 0 mm is performed to study the wave dissipation the free surface and wave pattern at computing time 5 7 s are shown in fig 4 it is shown that the wave is dissipated while propagating in the extent from 5 40 m to 5 40 m the variation of wave amplitude is less than 1 0 mm and in the extent from 5 40 m to 9 00 m the dissipation is intensified because of the effect of wave absorbing in the extent from 5 40 m to 12 60 m the wave is absorbed it is demonstrated by the results of fig 4 that the simulation of wave is of acceptable accuracy 4 experimental facility and set up the experiment is performed in the towing tank of harbin engineering university the length width and depth of the towing tank are 108 0 m 7 0 m and 3 5 m respectively the carriage is controlled by the computer and the velocity range of the carriage is 0 100 6 500 m s surging motion of the model are restrained in the experiment of calm water and the trimaran model is of six degrees of freedom in the condition of head waves the maximum wave length and amplitude can be generated by the wave maker is 25 00 m and 0 400 m respectively the test model is connected with the sensor system which sends real time signals of the force displacement as well as angle to the data acquisition system and they are recorded at a frequency of 50 hz all the instruments used are calibrated before the experiment the test model is weighed carefully and a boundary layer trip is fixed at the location 180 0 mm away from the stem post of the center hull compared with the test model in the condition of calm water two additional devices are employed to adjust the moment of inertia in the test of head waves but the two models are of the same displacement the experiment of the trimaran in head waves is only performed in the condition that wave amplitude equals to 30 0 mm and the model test in the conditions of calm water and head waves are shown in fig 5 5 results in the condition of calm water in order to study the influence of sinkage and trim on calm water resistance of the trimaran numerical calculation is performed in the conditions of captive and free model the results are used to validate the constructed numerical scheme and analyse the effect of hull attitude the simulation is conducted by the scheme mentioned above and the velocities of the trimaran are 0 500 0 700 0 900 1 177 1 766 2 550 2 943 3 531 3 924 m s the f r numbers are 0 084 0 118 0 151 0 198 0 297 0 429 0 495 0 594 0 660 correspondingly as shown in the literature review some researchers prefer to ignore ship attitude and its influence the present simulation are performed in the conditions of captive model and free model respectively in order to compare the results and investigate the influence of ship attitude on high speed trimaran the comparison of the numerical results of free model and experimental data as well as the results of free model and captive model is shown in fig 6 where r sw indicates the averaged resistance in calm water h is the sinkage at the center of gravity and α denotes the trim angle of the trimaran it is shown in the comparison that the calm water resistance in the condition of free model obtained by the scheme agrees with the test data well which demonstrates that the numerical scheme constructed is helpful to improve the calculation results but the results obtained in the condition of captive model only show good agreement at low speed the comparison suggests that when the velocity is less than 1 766 m s f r 0 297 the numerical results of both captive and free model coincide with the experimental data which means the calm water resistance of the present trimaran in this condition could be estimated by captive model approximately when the velocity is larger than 1 766 m s f r 0 297 the numerical results of free model still show a satisfactory agreement with the test data but the simulation of captive model underestimates the resistance and the discrepancy between them is increased with velocity the numerical results of sinkage and trim possess the same tendency with the experimental data and satisfactory accuracy the sinkage of the hull is increased with velocity possessing a maximum value at the velocity equals to 2 943 m s f r 0 495 and the results of trim angle are increased in the entire range of speed the interpretation of the discrepancy between the calm water resistance of captive and free model is the influence induced by sinkage and trim when the velocity is less than 1 766 m s f r 0 297 in which condition the sinkage at the center of gravity is less than 4 0 mm and the trim angle is about 0 2 little difference of hull attitude is found between captive and free model therefore little discrepancy between the resistance of the trimaran in these two conditions arises the variation of hull attitude is significant compared with the condition of zero speed when the velocity is increased and thus the discrepancy between the calm water resistance of captive and free model is increased the illustration of that is a remarkable difference between the results in these two conditions is located at v 3 531 m s f r 0 594 in which condition the sinkage is two times and the trim angle is about five times of that at v 1 766 m s f r 0 297 it is demonstrated the discrepancy between the calm water resistance in the conditions of captive and free model is caused by ship attitude and it is indicated by the comparison that hull attitude is important and necessary for the calm water resistance calculation of high speed trimaran 6 results in the condition of regular head waves the hydrodynamic characteristics of the trimaran in waves is another important issue and the simulation of the present trimaran in regular head waves of ξ 30 0 mm wave amplitude is conducted by the constructed scheme the velocities of the trimaran are 1 766 2 354 2 943 and 3 531 m s the f r numbers of which are 0 297 0 396 0 495 and 0 594 correspondingly four different wave lengths are adopted which are 1 80 3 60 5 40 and 7 20 m and the ratios of wave length to the length of the ship are 0 50 1 00 1 50 and 2 00 for the resultant resistance and motion in regular head waves taking the conditions that v 1 766 m s f r 0 297 and v 3 531 m s f r 0 594 for example in which the length of the wave both equal to 3 60 m and the ratio of wave length to the length of the trimaran equals to 1 00 the computing histories of resultant resistance heave as well as pitch motion obtained in numerical simulation and experiment are compared in fig 7 where r wave is the resultant resistance of the trimaran in waves z denotes the heave motion θ is the pitch angle λ denotes wave length and ξ is wave amplitude it can be seen from the comparison that the numerical results agree with the experimental data for the resultant resistance in the condition that f r 0 297 the simulation overestimates the total resistance and the periods of the numerical results are shorter than the experimental data but the discrepancy is acceptable for an averaged resistance meanwhile for the condition that f r 0 594 simulation meets with the measured data in period and amplitude the computing history of heave motion calculated agrees with the data recorded in the test well in the condition that f r 0 297 but the amplitudes of the calculated results are a little less than the test data in the condition that f r 0 594 for the time history of pitch motion the numerical results coincide with the records of the experiment with a negligible discrepancy for the two conditions it is demonstrated in the comparison that for the present trimaran in head waves satisfactory results can be obtained by the numerical scheme especially at high speed it is suggested that the numerical scheme is reliable for the simulation of the trimaran in head waves even in the condition that the wave length equals to the length of the trimaran in which it is difficult to obtain satisfactory results because of the severe motion of the vessel and the interference between center hull and outriggers the added resistance for the trimaran in waves can be obtained as 35 r a w r w v r s w where r w v and r s w denote the averaged resistance in waves and calm water respectively the non dimensional added resistance transfer function can be expressed as 36 r a w r a w ρ g ξ 2 b 2 l in which ξ is wave amplitude b and l are the beam and length of the center hull respectively ρ is density and g is the acceleration of gravity heave and pitch motion can be expressed in time domain as 37 z z a cos ω e t ε z 38 θ θ a cos ω e t ε θ where z a and θ a are amplitudes of heave and pitch motions respectively ω e is the encounter frequency in radian ε z and ε θ are initial phase angles which equal to zero in the initial stage the non dimensional transfer functions of heave and pitch are derived as 39 z a z a ξ 40 θ a θ a k ξ where k is wave number and ξ denotes wave amplitude both of the simulation and model test are performed in the conditions of various velocities and wave length the velocities of simulation and model test are 1 766 2 354 2 943 and 3 531 m s f r 0 297 0 396 0 495 and 0 594 and the wave length of them are 1 80 3 60 5 40 and 7 20 m λ l 0 50 1 00 1 50 and 2 00 in order to validate the numerical results and get a general idea of the added resistance as well as motion response of the trimaran in waves the averaged resistance in waves heave and pitch motion calculated are compared with the experimental data by encounter frequency as shown in fig 8 where ω e is encounter frequency it is shown in the comparison that the numerical results possess the same tendency with the test data and meet with them for the curve of averaged resistance in waves it varies with the encounter frequency but the results are classified into four levels clearly by velocity though there are some oscillation when the encounter frequency is increased the results of heave motion possess the maximum value approximate in the region 1 0 ω e 2 0 and decreased rapidly after that the results of pitch motion is much more organized than the averaged resistance and heave motion as it is increased at first possess the maximum value at encounter frequency equals to about 1 3 without any oscillation and then decreased with the encounter frequency it is demonstrated by the comparison that the numerical results agree with the experimental data the interference between the center hull and outriggers is the dominant part of the resistance even in head waves which is well calculated by the refined mesh distributed between them therefore there is no significant discrepancy between the numerical results and test data of the averaged resistance the possible reason of the difference between the numerical and experimental results of heave and pitch motion comes from the simulation of the free surface near the bow in which it is difficult to calculate the wave breaking and spraying caused by the motion accurately it is also indicated that the calculation of the severe interference between hull and wave is a key point for the motion response estimation an illustration of that is shown in fig 9 in which severe spray in the experiment is not found in the simulation and the influence of it on the motion is the primary reason of the discrepancy the comparison of the validated numerical results is performed in details in which the numerical results are analysed as transfer functions and the influence of velocity and wave length are separated the transfer functions of added resistance heave and pitch motion in the conditions of different velocities are compared and shown in fig 10 where f r is froude number λ denotes wave length and l is the length of the trimaran the non dimensional results of added resistance are increased by wave length and velocity the maximum values of which are located at λ l 1 00 and f r 0 495 and then decreased the vertical motion possesses the same tendency as added resistance but the peaks are located at λ l 1 50 and increased by velocity the pitch transfer functions are also increased by wave length the maximum values of the curves in the conditions that f r equal to 0 297 0 396 and 0 495 are located at λ l 1 50 and increased by velocity but no peak is found in the condition of f r 0 594 as the curve is increasing with wave length in the entire region the present trimaran is a displacement vessel for which the added resistance and motion of it in waves are influenced by wave length and speed the location of the maximum values of added resistance and motion is influenced by wave length but the values are effected by velocity meanwhile trimaran is a slender high speed vessel and the maximum values of added resistance heave and pitch motion are susceptible to the speed which would be changed significantly when the velocity is varied 7 numerical results in the conditions of different wave amplitudes the trimaran is supposed to travel in various conditions especially in the rough sea in order to get a general idea about the effect of wave condition on the added resistance and motion response induced by wave the simulation of the present trimaran in head waves of ξ 25 0 mm and ξ 35 0 mm wave amplitudes are performed though there is no model test data to validate the numerical results the validation of the resistance and motion of the trimaran in the conditions of calm water and ξ 30 0 mm head waves demonstrate that reasonable results can be obtained by the constructed scheme in each condition the velocities of the trimaran are 1 766 2 354 2 943 and 3 531 m s the f r numbers of which are 0 297 0 396 0 495 and 0 594 correspondingly four different wave length λ are adopted which are 1 80 3 60 5 40 and 7 20 m and the ratios of wave length to the length of the vessel are 0 50 1 00 1 50 and 2 00 the transfer functions of added resistance and motion in the conditions of different wave amplitudes are compared as shown in fig 11 it is shown in the comparison that the non dimensional added resistance is decreased rapidly with wave amplitude and in each condition the peaks are located at λ l 1 0 the comparison indicates the added resistance transfer function is influenced by wave amplitude obviously and the influence in the condition of short waves λ l 1 0 is much more significant than that in the condition of long waves λ l 1 0 the possible reason of it is the configuration of the vessel when the trimaran is in short waves the reflection and superposition of the waves between the center hull and outriggers is significant which makes the trimaran more susceptible to wave amplitude than in the condition of long waves compared with the added resistance the non dimensional results of heave and pitch motion are not varied remarkable by wave amplitude at each froude number and this may be because of the outriggers which can offer sufficient buoyancy and mitigate the motion of the trimaran it is suggested by the comparison that trimaran is a proper choice in various types of vessels in the condition of rough sea 8 discussion it is found that the numerical results of the calm water resistance of a trimaran is underestimated when the hull attitude is ignored but the reason is not clear therefore a further investigation is conducted as an illustration of influence of ship attitude this investigation is carried out by comparing the resistance variation of the center hull and that of the outriggers in the conditions of captive model and free model in the entire range of the velocity the comparison is shown in fig 12 where δ r s w is the resistance variation of the center hull and outrigger expressed in terms of percentage and calculated as follow 41 δ r s w r s w c a p r s w f r e e r s w f r e e 100 in which r s w c a p denotes the calm water resistance of captive model and r s w f r e e is the resistance of free model as it is shown in fig 12 the resistance of both the center hull and outrigger in the captive model is less than that in the condition of free model but the resistance reduction of the center hull is not larger than about 15 meanwhile the resistance reduction of the outrigger is more than 70 at high speed the comparison suggests that the calm water resistance is influenced by ship attitude and the miscalculation of the resistance is caused primarily by underestimation of the resistance of outriggers though it is clear that the discrepancy between the results of captive and free model at high speed is caused by ignoring hull attitude as analysed illustration in details is necessary it is interesting to notice in fig 6 that the maximum sinkage is arisen when the velocity is 2 943 m s f r 0 495 and the maximum trim angle is arisen at the velocity of 3 924 m s f r 0 660 but the maximum discrepancy between the numerical results of free model and captive model is located at the velocity of 3 531 m s f r 0 594 which indicates the coupled effect of sinkage and trim is the dominant factor that influences the resistance of a trimaran in order to illustrate the effect of ship attitude on calm water resistance the wetted surface of the outrigger and the free surface of captive and free model at velocity is 3 531 m s f r 0 594 are compared in which condition the maximum difference arises the comparison is shown in fig 13 it is shown in fig 13 a that the wetted surface of the outrigger at f r 0 594 in these two conditions are different obviously which is one of the reasons why there is a remarkable discrepancy between the numerical results of the captive and free model at high speed the other reason can be obtained as shown in fig 13 b the waves on the free surface are different in the two conditions which implies the wave making resistance of the captive model is less than the free model it is indicated by the analysis that for the trimaran presented calculation of the still water resistance should be performed by a free model especially at high speed which takes the hull attitude into account it is known that the non dimensional added resistance is more susceptible to wave amplitude compared with that of motion response and the outriggers may also influence the added resistance an interesting problem about the added resistance of the trimaran is that for the added resistance of the center hull and outriggers which is the dominating part of the resultant added resistance a further analysis of the added resistance components is performed by comparing the added resistance of the center hull with the resultant added resistance in the conditions of various wave amplitudes as it is shown in fig 14 where r a w c is the added resistance of the center hull and r a w is the resultant added resistance it is shown in the comparison that the variation of the added resistance of the center hull is complex for the tendency and the location of the peaks are varied at four velocities which is also can be served as a illustration of the effect caused by outriggers but in each condition the added resistance of the center hull is not less than about 80 of the resultant added resistance which indicates that the added resistance induced by the center hull is the dominate part of it and the behaviour of the added resistance of the trimaran is in accordance with that of the center hull the percentage of the added resistance of the center hull in the condition of long waves λ l 1 0 is larger than that of short waves λ l 1 0 and the reason is the influence of the outriggers which cause the reflection of the waves in the region between center hull and outriggers 9 conclusions the present research starts from the calculation of the calm water resistance of a trimaran in the conditions of captive and free model and the discrepancy between the results are analysed which is caused by hull attitude then the resistance and motion of the trimaran in regular head waves of different amplitudes are calculated and the numerical results in the condition of 30 0 mm wave amplitude are compared with the experimental data at last the influence of the hull attitude and the behaviour of added resistance of the center hull are discussed in detail conclusions obtained from the investigation are as follows a the hull attitude is important for the calculation of calm water resistance of the present trimaran and the discrepancy between the numerical results of free model and captive model which is primarily attributed to the outriggers is induced by the attitude neglecting hull attitude may lead to a miscalculation of the wetted surface of the outriggers as well as the free surface and thus an underestimation of the still water resistance b the results under 30 0 mm wave amplitude indicate that the non dimensional added resistance and motion are influenced by both the wave length and ship velocity and the location of the peaks of are decided by wave length while the value of them are varied by velocity c comparison of the results from different wave amplitudes suggests that the non dimensional added resistance is more susceptible to wave amplitude than motion response because of the outriggers by which the interference between the center hull and outriggers is intensified the non dimensional added resistance of the present trimaran in short waves is more susceptible to wave amplitude than that in long waves d the added resistance of the center hull is the dominating part of the resultant added resistance and in the conditions of various wave amplitudes calculated in the present paper the added resistance of the center hull is not less than 80 of the total added resistance the present paper includes a series of numerical calculation on the resistance and motion of a trimaran in many different conditions the conclusions are helpful in understanding the characteristics and assessing the feasibility of trimaran in different conditions further investigation should be performed in order to obtain a better knowledge of hydrodynamic characteristics in various conditions acknowledgements these financial support has been provided by national natural science foundation of china grant no 51679053 51209048 foundation of the chinese people s liberation army grant no 6140241010103 and fund of aeronautics science of china grant no 201723p6001 
22328,as a special type of high speed vessel the hydrodynamic performance of trimanran is not yet fully understood and is still under investigation in this paper a viscous method is established based on rans to study the resistance in calm water added resistance and motion response in head waves of various wave amplitudes results from numerical simulation show satisfactory agreement with the experimental data in addition the effect of hull attitude on resistance in calm water and the effect of wave amplitude on added resistance as well as motion response are analysed the results show that the resistance of the trimaran in calm water is significantly influenced by the hull attitude at high speed however this resistance could be underestimated if the ship attitude is ignored because of the miscalculation of the free surface and the resistance of outriggers it is found that the added resistance induced by the center hull composes the dominant part of the total added resistance and the non dimensional value of added resistance is decreased with wave amplitude while the influence of wave amplitude on the non dimensional results of heave and pitch motion is not significant keywords trimaran resistance attitude motion wave amplitude 1 introduction in recent years there has been a remarkable increase in the number of high speed trimarans all over the world the trimaran has attracted an ever growing attention for its outstanding advantages such as lower levels of resistance at high speed and good seagoing performance bertorello et al 2001 and a comparatively wide deck compared with mono hull and catamaran hull forms the current trend in high speed trimarans especially for coastal car passenger ferries has led to a further research on the hydrodynamic characteristics in calm water and waves the wave interference between the center hull and the outriggers of a trimaran is known to be complicated as the waves repeatedly reflected and superimposed in a limited water area restrained by the main hull and the outrigger therefore the wave making resistance of trimaran in calm water is of interest most researches on the configuration and hull form optimization are performed based on the calculation of wave resistance such as kang et al 2001 and yang et al 2001 first order panel method and dawson s approach were adopted by kang to calculate the wave making resistance and free surface while in yang s research the wave making resistance estimation is based on the zeroth order slender ship approximation both of the calculation ignored the attitude of the trimaran and the comparison of the calculated results with the test data showed a good agreement in tendency but an obvious discrepancy in values because the method based on potential theory is capable of wave making resistance calculation it is adopted by some researchers even after several years to investigate the influence of the outriggers position on the hydrodynamic interference of high speed trimaran the slender body method embedded in the commercial software maxsurfa is used by hafez and el kot 2012 to calculate the resistance of three symmetric trimaran series moving in calm water and the effect of stagger of the outriggers is discussed a fast numerical method for trimaran wave making resistance prediction is proposed by yu et al 2015 based on an extension of the slender ship theory of noblesse in which the highly oscillatory terms within the associated kochin function are expanded as series of products of bessel functions and legendre polynomials to facilitate faster computation and to separate out specific parameter dependencies it is suggested by the researches that the method based on potential theory can offer an accurate result of wave making resistance but it is powerless in the calculation of sinkage and trim though some high order nonlinear factors such as the influence of the sinking and trim transom as well as ship wave immersed hull surface are taken into account by wang and lu 2011 to solve the trimaran wave making problems which is based on wyatt s work the nonlinear free surface boundary condition the time domain concept and the full nonlinear wave making theory model test begovic et al 2001 su et al 2014 is a common means to obtain the attitude variation in the recent years theories of viscous flow are adopted to simulate the flow fluid around trimaran which is a powerful way to obtain ship attitude and the obtained force applied on the vessel is more accurate for taking sinkage and trim into account meanwhile some approaches were introduced by the researchers to calculate the attitude of the trimaran javanmardi et al 2008 developed a cfd code and used it to investigate the hydrodynamic resistance and maneuvering of a trimaran with wigley body form in the conditions of different outrigger positions based on the viscous method a dynamic mesh technique is adopted by ni et al 2011 to coincide with the variation of sinkage and trim of high speed trimaran on voyage a three dimensional computational fluid dynamic cfd code based on the finite volume method fvm was used by jiang et al 2016 to simulate the forward motion of a planing trimaran hull with two degrees of freedom sinkage and trim all the numerical results in the work mentioned above showed a good agreement when compared with the test data a systematic analysis of the effect of trimming and sinkage on the resistance of a trimaran with and without appendage was performed by deng et al 2015 in which cfd method was adopted taking viscous effect and the free surface into account it is suggested that researchers are in an ever growing attraction on the computational methods based on the viscous theory and sinkage as well as trim is an important factor in the resistance calculation of trimaran which can not be neglected the added resistance and motion of trimaran in waves is another attractive topic however it is known as a difficult problem for the method based on potential theory because the motion is hard to calculate in the frequency domain though the wave loads and the effect of configuration on the added resistance can be obtained fang and chen 2008 presented a spectral analysis based on wave loads to select suitable side hull arrangements for a trimaran traveling in waves by neglecting the steady flow effect a three dimensional source distribution method is adopted to solve the corresponding hydrodynamic coefficients in which a pulsating source potential was used and incorporated with the panel method but the motion was neglected xu and zhang 2011 investigated the effect of layouts and lengths of side hulls on the wave loads based on three dimensional potential theory and green s function then a parametric optimization is performed in their work the wave loads in which vertical shear forces and vertical bending moments at different locations on the main hull are included and the transverse bending moments at the junction of the cross structure and main hull are analysed but again the motion of the vessel was neglected an interesting work is carried out by bruzzone and grasso 2007 in which a hybrid approach had been employed to analyse the seakeeping performance of trimaran advancing in head seas with regular waves in this method an unsteady hydrodynamic problem was solved in the frequency domain and the equations of motion were solved in the time domain radiation and diffraction forces were transferred from frequency to time domain while nonlinear froude krylov and hydrostatic forces are computed considering the actual hull wetted surface at each time step the integration of the solutions in frequency and time domain made it is possible to calculate the motion in a similar way an approach for hydrodynamic optimization of a triswach was developed by yang and huang 2014 both the positions and the shape of the side hulls are considered in the method potential flow based tool and euler rans navier stokes based cfd tool had been integrated into a practical multi objective hydrodynamic optimization approach these mean the method used to investigate the motion response of trimaran is turned from potential tools to semi viscous approach and the motion of the trimaran in waves is being drawn much more attention to than before meanwhile model test is an effective approach all the time kaspar et al 2007 investigated the effect of the stagger of the side hulls on heave and pitch of a trimaran and pointed out that variation of the gyration radius opposed a significant effect on the heave and pitch motions in the same year egorov and tonyuk 2007 conducted a systematic model test of trimaran longitudinal motion s hydrodynamic and kinematic properties and the exciting forces as well as damping coefficients are determined by special methods ma et al 2015 investigated the effect of the center of gravity on the seakeeping ability of a trimaran planing hull by experiment a series of important model test were performed by vakilabadi et al 2014 in which the effect of the velocity of the test model wave length and the wave amplitude on heave and pitch motion was investigated and a detailed conclusion was obtained investigations have shown that little research has been conducted on the numerical simulation of trimaran in waves by a viscous method taking heave and pitch motion into account but a study have to mention is the one carried out by http xueshu baidu com s wd author 3a 28karim 20akbari 20vakilabadi 29 20 tn se baiduxueshu c1gjeupa ie utf 8 sc f para sc hilight 3dperson wu et al 2011 in the work a cfd computation of the motions and added resistance of a trimaran was performed based on a limited amount of grid nodes rans and fvm method are employed and coupled with the motion equations of 6 degrees of freedom and good agreements are obtained between the computational results and experimental data it is suggested that the viscous method now is an effective approach in the investigation of the added resistance and motion of the trimaran in waves and it will be a powerful tool in the future the purpose of the present work is to study the hydrodynamic characteristics of a coastal passenger trimaran in calm water and regular head waves which induces calm water resistance variation of sinkage and trim added resistance and motion response researches are carried out in a series of numerical simulation and model test at first a reliable numerical scheme is set up and validated by the test data in the condition of calm water and then the influence of sinkage and trim is analysed then the scheme is validated by the test data in the condition of 30 0 mm regular head waves and the hydrodynamic characteristics are analysed next three different wave amplitudes are adopted to investigate the influence of wave amplitude and some results are found at last a series of wave amplitudes are employed for three conditions to study the effect of wave amplitude in details the investigation here will offer a better understanding of the hydrodynamic characteristics of the trimaran 2 numerical model the numerical model is constructed in accordance with the full scale ship with a scale ratio of 1 27 5 and the parameters of the model is shown in table 1 in table 1 l b t are length beam and draught respectively c b denotes the block coefficient s w is the water plane area δ is displacement and s is the wetted surface the clearance between the central longitudinal planes of the center hull and outrigger is 0 42 m the pitch radius of gyration is 0 9 m the natural pitch and heave periods are 5 48 and 4 40 s respectively the body plan of the center hull and outrigger as well as the configuration of the test model on the waterline plane is shown in fig 1 3 numerical scheme a numerical scheme in which the extent of the computational domain mesh generation turbulence model multi phase interaction boundary conditions and motion estimation are included is necessary for the numerical simulation to obtain accurate results the coordinate system is shown in fig 2 the origin of coordinate locates on the intersection of free surface of calm water symmetric plane and vertical transverse mid plane of the main hull in the simulation the trimaran is sailing in the longitudinal way which is in the negative x direction and sinks in the negative z direction the center of gravity is located at x 0 21 m y 0 m and z 0 15 m and the lcg of the vessel is 0 21 m in the present coordinate which coincides with the center of gravity the gm of the model is 0 29 m the location of the outriggers is adopted from the original design of the full scale ship suppose that the flow field is symmetric and half of the flow field is taken as the computational domain the extents of the computational domain are 1 5 l 3 5 l in the x direction 1 0 l 0 l in the y direction and 1 0 l 1 0 l in the z direction where l denotes the length of the trimaran it is known that mesh generation of the computational domain is quite important for the numerical calculation and therefore an appropriate mesh distribution is adopted to calculate the interaction between the center hull and the outriggers deng et al 2010 2011 deng et al 2011a b the mesh size on the hull surface as shown in fig 3 is about 0 1 l where l denotes the length of the center hull and the y value is estimated by the formula as follow 1 y 0 172 y l re 0 9 where y indicates the projected distance between the first node and hull surface and re is the reynolds number the y value is about 19 45 for the present trimaran in the condition of fr 0 495 v 3 924 m s the mesh size in the domain between the center hull and outriggers is about 0 1 l and the mesh is refined in the z direction from 0 5 b to 0 5 b the size of which is about 0 05 l the boundary conditions adopted in simulation include velocity inlet free stream outlet and symmetric plane the outline and mesh generation of the computational domain as well as the boundary conditions are shown in fig 3 in which the boundaries that are not shown with mesh are defined as wall with non slip condition finite volume method is adopted in the simulation and taken as incompressible viscous fluid the flow field should satisfy the equations of continuity 2 u i x i 0 i 1 2 3 unsteady incompressible reynolds averaged navier stokes rans method is employed as the governing equations as below 3 u i t x j u i u j p x i x j μ u i x j u i u j i j 1 2 3 the turbulence model in the present simulation is the classical 2 equation eddy viscosity model k ω shear stress transport sst model which takes the transverse flow and the effect of the curved hull surface into account the setting of the turbulence model is discussed in the preliminary research deng et al 2011 2013 and standard wall function is adopted in the simulation the equations of the k ω model are presented as follows 4 k t u j k x j x j ν ν t σ k k x j ν t u i x j u j x i u i x j β f β k ω i j 1 2 3 5 ω t u j ω x j x j ν ν t σ ω ω x j α u i x j u j x i u i x j β ω 2 d ω i j 1 2 3 6 ν t k ω 1 max 1 α ω f 2 α 1 ω 7 α α α 0 re t r k 1 re t r k 8 re t k ν ω 9 α 0 β i 3 10 β β i 1 ζ f m t 11 β i β 4 15 re t r β 4 1 re t r β 4 12 f m t 0 m t 2 m t 0 2 m t m t 0 m t m t 0 13 m t 2 2 k a 2 14 α α α α 0 re t r ω 1 re t r ω 15 β β i 1 β i β i ζ f m t 16 f β 1 70 χ ω 1 80 χ ω 17 χ ω ω i j ω j i s j i β ω 3 18 ω i j 1 2 u i x j u j x i i j 1 2 3 19 s j i 1 2 u i x j u j x i i j 1 2 3 20 σ k 1 f 1 σ k 1 1 f 1 σ k 2 21 σ ω 1 f 1 σ ω 1 1 f 1 σ ω 2 22 ω 2 ω i j ω i j 1 2 i j 1 2 3 23 f 1 tanh φ 1 4 24 φ 1 min max k 0 09 ω y 500 ν y 2 ω 4 ρ k σ ω 2 d ω y 2 25 d ω max 2 ρ 1 σ ω 2 1 ω k x j ω x j 10 20 i j 1 2 3 26 f 2 tanh φ 2 2 27 φ 2 max 2 k 0 09 ω y 500 ν y 2 ω 28 d ω 2 1 f 1 σ ω 2 1 ω k x j ω x j i j 1 2 3 29 α f 1 α 1 1 f 1 α 2 30 α 1 β i 1 β k 2 σ ω 1 β 31 α 2 β i 2 β k 2 σ ω 2 β 32 β i f 1 β i 1 1 f 1 β i 2 where α 1 0 α 0 1 9 r k 6 0 r β 8 0 r ω 2 95 β i 0 072 f β 1 β 0 09 m t 0 0 25 ζ 1 5 α 1 0 31 σ k 1 1 176 σ k 2 1 0 σ ω 1 2 0 σ ω 2 1 168 k 0 41 β i 1 0 075 β i 2 0 0828 and a is the velocity of sound volume of fluid vof method hirt and nichols 1981 is adopted to calculate the free surface velocity and pressure in the flow field are coupled by the pressure implicit split operator piso algorithm and second order up wind difference scheme is applied the ship model is of six degrees of freedom and the governing equations of motion are shown as follows 33 m d u i d t f i i 1 2 3 34 d d t i ω i m i i 1 2 3 where m is the mass of the trimaran u i is the velocity component f i denotes the applied force in the corresponding direction i is the moment of inertia ω i is the angular velocity and m i is the applied moment in the present research f i and m i are the hydrodynamic force and moment induced by viscous flow which conduct the motion of the trimaran and can be obtained by an integration on the wetted surface the code used in the present paper is the commercial software star ccm which is a widely used in ship and ocean engineering hydrodynamic analysis in the condition of head waves a domain next to the outlet boundary is employed for wave absorbing the extent of which is 1 l a numerical simulation in which the wave length is 1 80 m and the wave amplitude is 30 0 mm is performed to study the wave dissipation the free surface and wave pattern at computing time 5 7 s are shown in fig 4 it is shown that the wave is dissipated while propagating in the extent from 5 40 m to 5 40 m the variation of wave amplitude is less than 1 0 mm and in the extent from 5 40 m to 9 00 m the dissipation is intensified because of the effect of wave absorbing in the extent from 5 40 m to 12 60 m the wave is absorbed it is demonstrated by the results of fig 4 that the simulation of wave is of acceptable accuracy 4 experimental facility and set up the experiment is performed in the towing tank of harbin engineering university the length width and depth of the towing tank are 108 0 m 7 0 m and 3 5 m respectively the carriage is controlled by the computer and the velocity range of the carriage is 0 100 6 500 m s surging motion of the model are restrained in the experiment of calm water and the trimaran model is of six degrees of freedom in the condition of head waves the maximum wave length and amplitude can be generated by the wave maker is 25 00 m and 0 400 m respectively the test model is connected with the sensor system which sends real time signals of the force displacement as well as angle to the data acquisition system and they are recorded at a frequency of 50 hz all the instruments used are calibrated before the experiment the test model is weighed carefully and a boundary layer trip is fixed at the location 180 0 mm away from the stem post of the center hull compared with the test model in the condition of calm water two additional devices are employed to adjust the moment of inertia in the test of head waves but the two models are of the same displacement the experiment of the trimaran in head waves is only performed in the condition that wave amplitude equals to 30 0 mm and the model test in the conditions of calm water and head waves are shown in fig 5 5 results in the condition of calm water in order to study the influence of sinkage and trim on calm water resistance of the trimaran numerical calculation is performed in the conditions of captive and free model the results are used to validate the constructed numerical scheme and analyse the effect of hull attitude the simulation is conducted by the scheme mentioned above and the velocities of the trimaran are 0 500 0 700 0 900 1 177 1 766 2 550 2 943 3 531 3 924 m s the f r numbers are 0 084 0 118 0 151 0 198 0 297 0 429 0 495 0 594 0 660 correspondingly as shown in the literature review some researchers prefer to ignore ship attitude and its influence the present simulation are performed in the conditions of captive model and free model respectively in order to compare the results and investigate the influence of ship attitude on high speed trimaran the comparison of the numerical results of free model and experimental data as well as the results of free model and captive model is shown in fig 6 where r sw indicates the averaged resistance in calm water h is the sinkage at the center of gravity and α denotes the trim angle of the trimaran it is shown in the comparison that the calm water resistance in the condition of free model obtained by the scheme agrees with the test data well which demonstrates that the numerical scheme constructed is helpful to improve the calculation results but the results obtained in the condition of captive model only show good agreement at low speed the comparison suggests that when the velocity is less than 1 766 m s f r 0 297 the numerical results of both captive and free model coincide with the experimental data which means the calm water resistance of the present trimaran in this condition could be estimated by captive model approximately when the velocity is larger than 1 766 m s f r 0 297 the numerical results of free model still show a satisfactory agreement with the test data but the simulation of captive model underestimates the resistance and the discrepancy between them is increased with velocity the numerical results of sinkage and trim possess the same tendency with the experimental data and satisfactory accuracy the sinkage of the hull is increased with velocity possessing a maximum value at the velocity equals to 2 943 m s f r 0 495 and the results of trim angle are increased in the entire range of speed the interpretation of the discrepancy between the calm water resistance of captive and free model is the influence induced by sinkage and trim when the velocity is less than 1 766 m s f r 0 297 in which condition the sinkage at the center of gravity is less than 4 0 mm and the trim angle is about 0 2 little difference of hull attitude is found between captive and free model therefore little discrepancy between the resistance of the trimaran in these two conditions arises the variation of hull attitude is significant compared with the condition of zero speed when the velocity is increased and thus the discrepancy between the calm water resistance of captive and free model is increased the illustration of that is a remarkable difference between the results in these two conditions is located at v 3 531 m s f r 0 594 in which condition the sinkage is two times and the trim angle is about five times of that at v 1 766 m s f r 0 297 it is demonstrated the discrepancy between the calm water resistance in the conditions of captive and free model is caused by ship attitude and it is indicated by the comparison that hull attitude is important and necessary for the calm water resistance calculation of high speed trimaran 6 results in the condition of regular head waves the hydrodynamic characteristics of the trimaran in waves is another important issue and the simulation of the present trimaran in regular head waves of ξ 30 0 mm wave amplitude is conducted by the constructed scheme the velocities of the trimaran are 1 766 2 354 2 943 and 3 531 m s the f r numbers of which are 0 297 0 396 0 495 and 0 594 correspondingly four different wave lengths are adopted which are 1 80 3 60 5 40 and 7 20 m and the ratios of wave length to the length of the ship are 0 50 1 00 1 50 and 2 00 for the resultant resistance and motion in regular head waves taking the conditions that v 1 766 m s f r 0 297 and v 3 531 m s f r 0 594 for example in which the length of the wave both equal to 3 60 m and the ratio of wave length to the length of the trimaran equals to 1 00 the computing histories of resultant resistance heave as well as pitch motion obtained in numerical simulation and experiment are compared in fig 7 where r wave is the resultant resistance of the trimaran in waves z denotes the heave motion θ is the pitch angle λ denotes wave length and ξ is wave amplitude it can be seen from the comparison that the numerical results agree with the experimental data for the resultant resistance in the condition that f r 0 297 the simulation overestimates the total resistance and the periods of the numerical results are shorter than the experimental data but the discrepancy is acceptable for an averaged resistance meanwhile for the condition that f r 0 594 simulation meets with the measured data in period and amplitude the computing history of heave motion calculated agrees with the data recorded in the test well in the condition that f r 0 297 but the amplitudes of the calculated results are a little less than the test data in the condition that f r 0 594 for the time history of pitch motion the numerical results coincide with the records of the experiment with a negligible discrepancy for the two conditions it is demonstrated in the comparison that for the present trimaran in head waves satisfactory results can be obtained by the numerical scheme especially at high speed it is suggested that the numerical scheme is reliable for the simulation of the trimaran in head waves even in the condition that the wave length equals to the length of the trimaran in which it is difficult to obtain satisfactory results because of the severe motion of the vessel and the interference between center hull and outriggers the added resistance for the trimaran in waves can be obtained as 35 r a w r w v r s w where r w v and r s w denote the averaged resistance in waves and calm water respectively the non dimensional added resistance transfer function can be expressed as 36 r a w r a w ρ g ξ 2 b 2 l in which ξ is wave amplitude b and l are the beam and length of the center hull respectively ρ is density and g is the acceleration of gravity heave and pitch motion can be expressed in time domain as 37 z z a cos ω e t ε z 38 θ θ a cos ω e t ε θ where z a and θ a are amplitudes of heave and pitch motions respectively ω e is the encounter frequency in radian ε z and ε θ are initial phase angles which equal to zero in the initial stage the non dimensional transfer functions of heave and pitch are derived as 39 z a z a ξ 40 θ a θ a k ξ where k is wave number and ξ denotes wave amplitude both of the simulation and model test are performed in the conditions of various velocities and wave length the velocities of simulation and model test are 1 766 2 354 2 943 and 3 531 m s f r 0 297 0 396 0 495 and 0 594 and the wave length of them are 1 80 3 60 5 40 and 7 20 m λ l 0 50 1 00 1 50 and 2 00 in order to validate the numerical results and get a general idea of the added resistance as well as motion response of the trimaran in waves the averaged resistance in waves heave and pitch motion calculated are compared with the experimental data by encounter frequency as shown in fig 8 where ω e is encounter frequency it is shown in the comparison that the numerical results possess the same tendency with the test data and meet with them for the curve of averaged resistance in waves it varies with the encounter frequency but the results are classified into four levels clearly by velocity though there are some oscillation when the encounter frequency is increased the results of heave motion possess the maximum value approximate in the region 1 0 ω e 2 0 and decreased rapidly after that the results of pitch motion is much more organized than the averaged resistance and heave motion as it is increased at first possess the maximum value at encounter frequency equals to about 1 3 without any oscillation and then decreased with the encounter frequency it is demonstrated by the comparison that the numerical results agree with the experimental data the interference between the center hull and outriggers is the dominant part of the resistance even in head waves which is well calculated by the refined mesh distributed between them therefore there is no significant discrepancy between the numerical results and test data of the averaged resistance the possible reason of the difference between the numerical and experimental results of heave and pitch motion comes from the simulation of the free surface near the bow in which it is difficult to calculate the wave breaking and spraying caused by the motion accurately it is also indicated that the calculation of the severe interference between hull and wave is a key point for the motion response estimation an illustration of that is shown in fig 9 in which severe spray in the experiment is not found in the simulation and the influence of it on the motion is the primary reason of the discrepancy the comparison of the validated numerical results is performed in details in which the numerical results are analysed as transfer functions and the influence of velocity and wave length are separated the transfer functions of added resistance heave and pitch motion in the conditions of different velocities are compared and shown in fig 10 where f r is froude number λ denotes wave length and l is the length of the trimaran the non dimensional results of added resistance are increased by wave length and velocity the maximum values of which are located at λ l 1 00 and f r 0 495 and then decreased the vertical motion possesses the same tendency as added resistance but the peaks are located at λ l 1 50 and increased by velocity the pitch transfer functions are also increased by wave length the maximum values of the curves in the conditions that f r equal to 0 297 0 396 and 0 495 are located at λ l 1 50 and increased by velocity but no peak is found in the condition of f r 0 594 as the curve is increasing with wave length in the entire region the present trimaran is a displacement vessel for which the added resistance and motion of it in waves are influenced by wave length and speed the location of the maximum values of added resistance and motion is influenced by wave length but the values are effected by velocity meanwhile trimaran is a slender high speed vessel and the maximum values of added resistance heave and pitch motion are susceptible to the speed which would be changed significantly when the velocity is varied 7 numerical results in the conditions of different wave amplitudes the trimaran is supposed to travel in various conditions especially in the rough sea in order to get a general idea about the effect of wave condition on the added resistance and motion response induced by wave the simulation of the present trimaran in head waves of ξ 25 0 mm and ξ 35 0 mm wave amplitudes are performed though there is no model test data to validate the numerical results the validation of the resistance and motion of the trimaran in the conditions of calm water and ξ 30 0 mm head waves demonstrate that reasonable results can be obtained by the constructed scheme in each condition the velocities of the trimaran are 1 766 2 354 2 943 and 3 531 m s the f r numbers of which are 0 297 0 396 0 495 and 0 594 correspondingly four different wave length λ are adopted which are 1 80 3 60 5 40 and 7 20 m and the ratios of wave length to the length of the vessel are 0 50 1 00 1 50 and 2 00 the transfer functions of added resistance and motion in the conditions of different wave amplitudes are compared as shown in fig 11 it is shown in the comparison that the non dimensional added resistance is decreased rapidly with wave amplitude and in each condition the peaks are located at λ l 1 0 the comparison indicates the added resistance transfer function is influenced by wave amplitude obviously and the influence in the condition of short waves λ l 1 0 is much more significant than that in the condition of long waves λ l 1 0 the possible reason of it is the configuration of the vessel when the trimaran is in short waves the reflection and superposition of the waves between the center hull and outriggers is significant which makes the trimaran more susceptible to wave amplitude than in the condition of long waves compared with the added resistance the non dimensional results of heave and pitch motion are not varied remarkable by wave amplitude at each froude number and this may be because of the outriggers which can offer sufficient buoyancy and mitigate the motion of the trimaran it is suggested by the comparison that trimaran is a proper choice in various types of vessels in the condition of rough sea 8 discussion it is found that the numerical results of the calm water resistance of a trimaran is underestimated when the hull attitude is ignored but the reason is not clear therefore a further investigation is conducted as an illustration of influence of ship attitude this investigation is carried out by comparing the resistance variation of the center hull and that of the outriggers in the conditions of captive model and free model in the entire range of the velocity the comparison is shown in fig 12 where δ r s w is the resistance variation of the center hull and outrigger expressed in terms of percentage and calculated as follow 41 δ r s w r s w c a p r s w f r e e r s w f r e e 100 in which r s w c a p denotes the calm water resistance of captive model and r s w f r e e is the resistance of free model as it is shown in fig 12 the resistance of both the center hull and outrigger in the captive model is less than that in the condition of free model but the resistance reduction of the center hull is not larger than about 15 meanwhile the resistance reduction of the outrigger is more than 70 at high speed the comparison suggests that the calm water resistance is influenced by ship attitude and the miscalculation of the resistance is caused primarily by underestimation of the resistance of outriggers though it is clear that the discrepancy between the results of captive and free model at high speed is caused by ignoring hull attitude as analysed illustration in details is necessary it is interesting to notice in fig 6 that the maximum sinkage is arisen when the velocity is 2 943 m s f r 0 495 and the maximum trim angle is arisen at the velocity of 3 924 m s f r 0 660 but the maximum discrepancy between the numerical results of free model and captive model is located at the velocity of 3 531 m s f r 0 594 which indicates the coupled effect of sinkage and trim is the dominant factor that influences the resistance of a trimaran in order to illustrate the effect of ship attitude on calm water resistance the wetted surface of the outrigger and the free surface of captive and free model at velocity is 3 531 m s f r 0 594 are compared in which condition the maximum difference arises the comparison is shown in fig 13 it is shown in fig 13 a that the wetted surface of the outrigger at f r 0 594 in these two conditions are different obviously which is one of the reasons why there is a remarkable discrepancy between the numerical results of the captive and free model at high speed the other reason can be obtained as shown in fig 13 b the waves on the free surface are different in the two conditions which implies the wave making resistance of the captive model is less than the free model it is indicated by the analysis that for the trimaran presented calculation of the still water resistance should be performed by a free model especially at high speed which takes the hull attitude into account it is known that the non dimensional added resistance is more susceptible to wave amplitude compared with that of motion response and the outriggers may also influence the added resistance an interesting problem about the added resistance of the trimaran is that for the added resistance of the center hull and outriggers which is the dominating part of the resultant added resistance a further analysis of the added resistance components is performed by comparing the added resistance of the center hull with the resultant added resistance in the conditions of various wave amplitudes as it is shown in fig 14 where r a w c is the added resistance of the center hull and r a w is the resultant added resistance it is shown in the comparison that the variation of the added resistance of the center hull is complex for the tendency and the location of the peaks are varied at four velocities which is also can be served as a illustration of the effect caused by outriggers but in each condition the added resistance of the center hull is not less than about 80 of the resultant added resistance which indicates that the added resistance induced by the center hull is the dominate part of it and the behaviour of the added resistance of the trimaran is in accordance with that of the center hull the percentage of the added resistance of the center hull in the condition of long waves λ l 1 0 is larger than that of short waves λ l 1 0 and the reason is the influence of the outriggers which cause the reflection of the waves in the region between center hull and outriggers 9 conclusions the present research starts from the calculation of the calm water resistance of a trimaran in the conditions of captive and free model and the discrepancy between the results are analysed which is caused by hull attitude then the resistance and motion of the trimaran in regular head waves of different amplitudes are calculated and the numerical results in the condition of 30 0 mm wave amplitude are compared with the experimental data at last the influence of the hull attitude and the behaviour of added resistance of the center hull are discussed in detail conclusions obtained from the investigation are as follows a the hull attitude is important for the calculation of calm water resistance of the present trimaran and the discrepancy between the numerical results of free model and captive model which is primarily attributed to the outriggers is induced by the attitude neglecting hull attitude may lead to a miscalculation of the wetted surface of the outriggers as well as the free surface and thus an underestimation of the still water resistance b the results under 30 0 mm wave amplitude indicate that the non dimensional added resistance and motion are influenced by both the wave length and ship velocity and the location of the peaks of are decided by wave length while the value of them are varied by velocity c comparison of the results from different wave amplitudes suggests that the non dimensional added resistance is more susceptible to wave amplitude than motion response because of the outriggers by which the interference between the center hull and outriggers is intensified the non dimensional added resistance of the present trimaran in short waves is more susceptible to wave amplitude than that in long waves d the added resistance of the center hull is the dominating part of the resultant added resistance and in the conditions of various wave amplitudes calculated in the present paper the added resistance of the center hull is not less than 80 of the total added resistance the present paper includes a series of numerical calculation on the resistance and motion of a trimaran in many different conditions the conclusions are helpful in understanding the characteristics and assessing the feasibility of trimaran in different conditions further investigation should be performed in order to obtain a better knowledge of hydrodynamic characteristics in various conditions acknowledgements these financial support has been provided by national natural science foundation of china grant no 51679053 51209048 foundation of the chinese people s liberation army grant no 6140241010103 and fund of aeronautics science of china grant no 201723p6001 
22329,bearing capacity failures of offshore pile foundations under cyclic loads in sandy soils are usually initiated by soil strength reduction due to cyclic pile sand interface sliding in this paper a large scale constant normal stiffness cns cyclic direct shear apparatus is designed to simulate this sliding mechanism with an effective shearing area of 0 14 m2 the cyclic pile sand interface behaviour of two common types of piles concrete and steel piles is subsequently investigated under different confining pressures and cyclic deformation amplitudes the experimentally obtained results including the induced shear normal stress displacement behaviour stress path behaviour and particle distribution at the pile sand interface are analysed this further leads to a detailed study for the associated pile sand interface cyclic weakening mechanism through the investigations of cyclic attenuation of shear normal stress amplitude strength reduction and particle crushing respectively furthermore experimental results highlight the effect of initial confining pressure cyclic shear deformation amplitude and pile surface roughness on the investigated pile sand interface cyclic weakening mechanism keywords cyclic direct interface shear tests pile sand interface interface weakening mechanism constant normal stiffness 1 introduction the stability of engineering structures constructed on geotechnical deposits are usually guaranteed by transferring their self weight and external loads to deeper stiff soils or bedrock through underlying supporting systems piles have been effectively employed as the required supporting structures in the form of single pile such as for wind turbines or pile group such as for railway embankments with the significant development of marine resources pile group foundations are increasingly widely used for various offshore engineering structures e g offshore platforms man made islands large span bridges etc under the wind and ocean wave induced cyclic loads the installed piles in pile group foundations are prone to potential bearing capacity failures which are usually initiated by pile soil interface sliding due to interface material strength reduction randolph 2003 however this pile soil interface weakening mechanism has not been thoroughly understood due to its dependency on the critical dynamic and geotechnical factors such as the dynamic characteristics of cyclic loads interface stress conditions pile types etc therefore there is a need to investigate the cyclic pile soil interface behaviour in order to better understand the associated interface weakening mechanism and to account for the induced offshore pile foundation failures for this purpose full scale in situ tests e g chow 1997 tsuha et al 2012 jardine and standing 2012 standing et al 2013 buckley et al 2018 and laboratory tests e g rimoy 2013 li et al 2012 lombardi et al 2013 huang and liu 2015 zhang et al 2017 altuhafi et al 2018 zhou et al 2019 have been carried out to investigate the cyclic pile soil interface behaviour in particular full scale in situ tests can reflect the realistic natural state of soils where investigation results are not affected by the scaling effect or sample disturbance on the other hand laboratory tests can define a variety of boundary conditions to simulate different pile foundation problems the obtained measurements are more accurate and the result interpretation procedure is more straightforward however full scale in situ tests are usually only used for the pile testing before the final engineering installation due to the time and cost inefficiency while laboratory tests can be more effectively employed for parametrically investigating the interface behaviour of pile soil interaction problems considering different geotechnical materials pile types loading conditions etc such laboratory investigations are attributed to rimoy 2013 li et al 2012 lombardi et al 2013 and huang and liu 2015 however these works have been concentrated on the pile soil interface behaviour under monotonic loads and the more critical cyclic investigations however are limited most of the conventional pile soil interface experiments apply the constant normal load cnl boundary conditions on soil specimens throughout shearing this can simulate the external loading conditions of some engineering stability problems such as anchored soil slopes and retaining walls under traffic loads however there are more practical problems such as the pile foundations where the normal load acting on the interface does not remain constant and therefore the cnl is not an appropriate representation of realistic boundary conditions in this case any volume change in the pile soil interface zone is constrained by the soil beyond this zone this can be simulated by applying a constant normal stiffness cns boundary condition during the direct shear tests to represent the constraining effects from the surrounding soil as a result the normal stress on the interface may decrease or increase depending on whether the soil in the interface zone contracts or dilates respectively therefore the cyclic interface pile soil behaviour for pile foundation problems is usually investigated employing the cns direct shear apparatus such as in johnston et al 1987 ooi and carter 1987 tabucanon et al 1995 porcina et al 2003 fakharian and evgin 1997 dejong et al 2003 2006 jiang et al 2004 mortaraetal et al 2007 2010 peng et al 2014 and di donna et al 2016 one of the limitations of the laboratory investigations for pile soil interface behaviour is the scaling effects in other words the effective shearing area of laboratory tests is considerably smaller than the prototype one therefore in this paper in order to reduce the influence the scaling effects and the boundary effects induced by shear box wall a large scale cns cyclic direct shear apparatus is designed to investigate the pile soil cyclic interface behaviour investigations are concentrated in two common types of piles concrete and steel installed in the fujian sand from south china sea due to the significant development of offshore engineering in this area the objectives of the work are to reveal the pile sand interface cyclic weakening mechanism in terms of the cyclic attenuation of shear normal stress amplitude strength reduction behaviour and particle crushing of the interfacial material furthermore the influence of initial confining pressure cyclic shear deformation amplitude and pile surface roughness on pile sand interface cyclic weakening mechanism is also investigated 2 large scale cns cyclic direct shear tests 2 1 testing apparatus as illustrated in fig 1 the concerned domain for pile soil interface investigations can be simplified into three zones i e the shearing zone the elastic zone and the undisturbed zone white and bolton 2002 liu et al 2019 the cyclic shear deformation is mainly induced in the shearing zone with infinitesimal thickness compared to the pile dimension under cyclic loads the soil particles in this zone can be re arranged and crushed resulting in plastic deformation and weakening effects on the interface soils however beyond the shearing zone cyclic loads only induce recoverable elastic deformation in the soil adjacent to the interface this zone is defined as the elastic zone and can be experimentally represented by the ideal constant normal stiffness boundary conditions i e elastic springs applied on the shear zone as shown in fig 1 furthermore in the far field the induced deformation is insignificant and this can be considered as the fixed end for the elastic springs i e the undisturbed zone as shown in fig 1 the spring stiffness k which represents the elastic zone can be estimated by equation 4g d boulon and foray 1986 where d is the diameter of pile and g is the operational shear modulus of the soil around the pile and can be estimated approximately by 0 4g 0 where g 0 is the undisturbed soil shear modulus fahey et al 2003 as shown in fig 2 the designed large scale cns direct shear apparatus consists of four main parts the cns loading system the pile soil interface direct shear system the cyclic actuating system and the data acquisition system the main components of the actuating and data acquisition systems are 1 the gear motor includes a frequency variable motor and a speed reducer with the following characteristics power 2 kw rotational speed 1500r min frequency 5 50 hz speed reducer 1 100 controlled shearing rate 0 15 15 mm min maximum shearing amplitude 100 mm 2 fiber bragg grating fbg sensors are employed for measuring interface shear stresses with the following characteristics central wave length 1530 nm sensitivity 3 7 p m με range 2000με resolution 1με 3 a resistive earth pressure gauge is used for measuring interface normal stresses with the following characteristics diameter 28 mm thickness 10 mm range 0 0 2 mpa sensitivity 2 0 accuracy 0 08 4 an automatic data acquisition system the layout of the fbg sensors and the earth pressure gauge which are used to measure shear and normal stresses respectively is shown in fig 3 it is noted that the fbg sensors were sealed with epoxy resins while the earth pressure gauge is in direct contact with the tested soil material furthermore as shown in figs 2 and 3 the effective shearing area is 0 14 m2 and remains constant during shearing this essentially mitigates the scaling effects involved in common laboratory interface direct shear tests and enhances the reliability of the experimental results in this study 2 2 testing materials and testing scheme the dry fujian sand was tested for the pile soil interface investigations as shown in fig 4 a the sand sample was taken from xiamen in fujian province southeast of china where the offshore projects such as wind turbines and oil and gas offshore platforms are under significant development the particle size distribution psd and the material properties are shown in fig 4 b and table 1 respectively for the tested two piles the concrete pile was sampled using c40 cement with sand gravel and water the proportion is 2 4 1 7 8 1 following 28 day standard indoor cure and the material of the steel pile was q235 steel it is noted that the surface roughness of the two piles were processed to fall in the range of 200 300 μm and 40 50 μm respectively the same as the prototype values the laboratory tests were designed to investigate the effects of several critical factors on cyclic pile sand interface behaviour i e the pile type concrete and steel shear deformation amplitude 5 mm and 10 mm and initial confining pressure 90 kpa and 110 kpa the adopted testing scenarios are listed in table 2 it is noted that 20 cycles are relatively low when considering tidal loads however this research targeted its initial idea to firstly understand the interfacial cyclic weakening mechanism at the bnning of the large number cyclic loading the pile soil interfacial cyclic behaviour under large cycle numbers will be considered in the future work 3 monotonic pile sand interface behaviour monotonic tests were first carried out to investigate the pile sand interface behaviour which can also be considered as the validation for the designed cns direct shear apparatus fig 5 shows the shear stress displacement behaviour at the pile sand interface of the two tested piles under two initial confining pressures overall the tested sand shows a softening behaviour after reaching the peak strength which then gradually approaches the residual strength as the shear deformation increases in particular the concrete sand reaches the peak strength at the shear displacements of 3 3 and 3 1 mm for the confining pressures of 90 and 110 kpa respectively the steel sand shows a faster trend reaching the peak strength at the displacement levels of 1 7 and 1 6 mm for the two confining pressures it can be seen that the strength of the concrete sand interface is larger than that of the steel sand interface showing the positive effects of the higher surface roughness of the concrete pile on interface shear resistance furthermore the higher confining pressure induces larger interface strength and this influence is more significant for rougher piles these observations are in agreement with the monotonic results from fakharian and evgin 1997 showing the reliability of the designed cns direct shear apparatus for the subsequent cyclic investigations it is noted that the experiments were conducted under two confining pressure conditions 90 kpa and 110 kpa fig 5 presents both results to show the effects of confining pressure on the cyclic interfacial behaviour it is noted that the normal stress we used in each test is constant 4 cyclic pile sand interface weakening mechanism in this section the cyclic pile sand interface behaviours of the concrete and steel piles are investigated under different confining pressures and cyclic deformation amplitudes the experimentally obtained results including the induced shear normal stress displacement behaviour stress path behaviour and particle size distribution at the pile sand interface are analysed this further leads to a detailed study for the associated pile sand interface cyclic weakening mechanism through the investigations of cyclic attenuation of shear normal stress amplitude strength reduction and particle crushing respectively 4 1 cyclic attenuation of interface shear and normal stress amplitudes the experimentally obtained interface stress displacement behaviour for the concrete pile is shown in fig 6 under two confining pressures and subjected to two cyclic deformation amplitudes taking the results from the cs 1 test for example fig 6 a and b overall both the shear and normal stress amplitudes tend to attenuate as cycle number increases in particular for the shear stress displacement behaviour fig 6 a under the initial loading of the first cycle the interface sand reaches the peak shear stress of 59 kpa at the displacement level of 3 3 mm and gradually approaches the residual strength of 48 kpa which is the same as the monotonic behaviour discussed in the previous section however compared to the residual strength at the 1st cycle the residual strength reduces as the cycle number increases with the reduction ratio of 34 42 48 and 52 at the 5th 10th 15th and 20th cycle respectively it can be seen that the attenuation is the most significant in the first 5 cycles and the shear stress amplitude gradually stabilises after 15 cycles as seen from fig 6 b the normal stress amplitude also attenuates as cycle number increases this is due to the shearing induced particle movements and crushing and thus soil densification under the cns boundary conditions where the interface zone thickness reduces and therefore the normal load applied on the interface is relaxed the induced normal stress amplitude reduction ratio at the maximum positive shear deformation levels are 30 40 48 and 52 at the 5th 10th 15th and 20th cycle respectively again the normal stress amplitude attenuation is the most significant in the first 5 cycles it is noted that the normal stress displacement behaviour presents a butterfly shape loop in other words as shown in fig 6 b under both the positive directional loading ④① and negative directional loading ②③ the normal stress decreases first and then increases this reflects that the sand in the interface zone contracts first and then dilates similar results were also observed by cui and battacharya 2016 in the numerical simulations of cyclic soil pile interaction using discrete element modelling consequently for the conducted tests under the cns boundary conditions the induced normal load decreases and increases however the observed alternating particle contraction and dilation in this work can only reflect the cyclic interfacial behaviour specifically for the investigated sand some investigations showed particle contraction and stress relaxation behaviour only during cyclic interface direct shear tests silver 1971 the stress displacement behaviours subjected to other confining pressure and shear deformation amplitude are shown in fig 6 c 6 f for the cs 2 and cs 3 tests similar patterns for the stress displacement behaviour are observed from these two tests compared to those for the cs 1 test in particular hysteretic and butterfly loops can be found for the shear stress and normal stress behaviour respectively with amplitudes cyclically attenuating as cycle number increases in order to investigate the influence of confining pressure and shear deformation amplitude on the observed attenuation behaviour the obtained shear and normal stress amplitudes are plotted against cycle numbers in fig 7 based on liu et al 2012 the attenuation trends of the shear and normal stress amplitudes can be best fitted with the logarithmic models expressed by equations 1 and 2 respectively 1 τ m n ln n l 2 σ a b ln n c where parameters m and a means the initial shear and normal stress parameters n and b are the factors which quantify the stress amplitude attenuation rate n is the cycle number l and l are considered as the factors which influence the locations of curves all the model parameters which can be obtained by curve fitting the experimental results based on fig 7 overall the attenuations of the shear and normal stress amplitudes are most significant in the first 5 cycles and the degradation rate gradually decreases as cycle number increases and is negligible after 15 cycles the comparison of the results between the cs 2 and cs 1 tests show that a higher confining pressure would contribute to a higher shear strength on the pile sand interface furthermore by comparing the values of the parameter b in the best fit attenuation curves for the cs 2 and cs 1 tests the higher confining pressure induces a more significant attenuation behaviour for the shear stress amplitude in particular under higher normal loads soil particles at the pile sand interface can be crushed more significantly which therefore induces a more profound attenuation of the shear stress amplitude this is also in agreement with the comparison of the normal stress attenuation between the cs 2 and cs 1 results when comparing the results between the cs 3 and cs 1 tests it can be seen that larger shear deformation amplitude leads to a lower interface shear stress and slightly more significant attenuation behaviour the interface stress displacement behaviours for the steel pile under two confining pressures and subjected to two cyclic deformation amplitudes are shown in fig 8 the overall shear and normal stress displacement behaviours are similar to those of the concrete pile in particular hysteretic and butterfly loops can be found for the shear stress and normal stress behaviour respectively with amplitudes cyclically attenuating as cycle number increases however for the normal stress behaviour the alternating contractive and dilative behaviours are not as significant as those at the concrete sand interface this is mainly due to the higher roughness of concrete surface which causes more significant particle movements thus more profound dilation or contraction furthermore the overall shear strength amplitude i e the height of the hysteretic loop is smaller than that of the concrete pile this is also reflected by comparing the shear stress amplitude attenuation curves in fig 9 with those in fig 7 this is mainly induced by the lower surface roughness at the steel sand interface compared to the concrete pile approximately 40 50 μm and 200 300 μm respectively resulting in lower friction angle and therefore fewer particle rearrangements and less energy dissipation furthermore it is found that the attenuation rate of the shear stress amplitude quantified by the parameter n is larger under higher confining pressure and larger shear deformation amplitude which is in agreement with the observations from the concrete sand tests 4 2 stress path behaviour the stress path behaviour of the concrete sand and steel sand tests are presented in figs 10 and 11 respectively for cs 1 and cs 2 tests the tested sands reach peak strength envelop at the 1st cycle and the corresponding peak friction angles are approximately 30 9 and 32 6 respectively after the 1st cycle significant relaxation behaviour is observed represented by the sharp friction angle reduction this softening behaviour is attributed to the particle rearrangement and crushing especially for the particles locked in rough interface asperities induced by the large shear deformation amplitude at the bnning of the cyclic tests the destructed interface sand would then significantly contract which leads to the normal stress reduction under the cns boundary conditions due to the soil contraction and densification the friction angle decreases and the corresponding final friction angles are approximately 26 1 and 28 6 respectively however every time when the destructed sand reaches the residual strength envelop the interface sand dilates represented by the increase of the normal stress this finally results in the observed butterfly shape normal stress displacement behaviour shown in figs 6 and 8 increase in the shear deformation amplitude produced larger loops however for the cs 3 test the difference between the peak and final friction angles is insignificant due to the small shear deformation amplitude applied in the cs 3 test regarding the stress path behaviour obtained from the steel sand tests a slight hardening behaviour is evident in fig 11 with a higher friction angle being mobilised at lower normal stresses in particular the friction angles for the three steel sand tests are 23 3 22 4 and 23 1 at the first cycle while reduce to the residual strength of 30 9 29 8 and 29 5 respectively this phenomena is also observed by de jong et al 2006 in soil structure interface direct shear tests this increase in friction angle i e hardening behaviour can be attributed to the reduction of normal stress and increase of density boulon and foray 1986 another difference observed for the steel interface compared to the concrete interface is that no loops are observed for the first cycle however with the increase of relative density during the following cycles loops occur similar patterns are observed by mortara et al 2007 the experimentally obtained peak interface friction angles of all the tests are listed in table 3 the ratio between the peak interface friction angles and natural sand internal friction angles are in the range of 0 73 0 81 this ratio is found to be smaller for the steel pile which results in the lower interface shear strength in agreement with the observations in the previous section it is noted that when carrying out the safety design and analysis for offshore pile foundation the interfacial friction angle is usually assumed to be constant as friction angle is determined by the pile material soil material and soil relative density however this assumption only represents the initial condition as interface soil is subject to densification under cyclic shearing this can be justified by the results shown in figs 10 and 11 and table 3 4 3 interface particle crushing in order to more specifically investigate the pile sand interface weakening mechanism from micro perspective the particle size distribution of the sands at different distances from the interface i e 0 1 1 2 2 3 3 4 and 4 5 cm from the interface after the cyclic tests were experimentally obtained and are shown in figs 12 and 13 for the concrete sand and steel sand tests respectively furthermore based on the particle size distribution curves the d 50 at the different locations was obtained and plotted against the distance from the interface in fig 14 for all the tests overall it is observed that the particle crushing is only significant within 1 cm from the interface and is negligible beyond this range the cyclically induced particle crushing is found to be more profound under higher confining pressure by comparing the cs 1 ss 1 and cs 2 ss 2 results or subjected to larger shear deformation amplitude by comparing the cs 1 ss 1 and cs 3 ss 3 results this induces more significant stress amplitude attenuation under these two conditions as observed in fig 7 furthermore it shows that the particle crushing is more significant at the concrete sand interface due to the higher surface roughness of the concrete pile 5 conclusions in this paper the cyclic pile sand interface behaviour of two common types of piles concrete and steel piles was investigated under different confining pressures and cyclic deformation amplitudes using large scale cns cyclic direct shear tests the design of the employed cns apparatus was first introduced the experimentally obtained results including the shear normal stress displacement behaviour stress path behaviour and particle size distribution at the pile sand interface were subsequently analysed this further led to a detailed study for the associated pile sand interface cyclic weakening mechanism through the investigations of cyclic attenuation of shear normal stress strength reduction and micro scale particle crushing respectively key findings regarding the cyclic pile sand interface behaviour are summarised as below 1 the overall shear and normal stress displacement behaviours exhibit as hysteretic and butterfly alternating contractive and dilative behaviour loops respectively higher confining pressure and smaller shear deformation amplitude contribute to a higher shear strength on the pile sand interface 2 the shear and normal stress amplitudes attenuate significantly in the first 5 cycles and the degradation rate gradually becomes smaller and is negligible after 15 cycles the reduction rate is more profound under higher initial confining pressure and larger shear deformation amplitude 3 stress path results showed that under larger shear deformation amplitude the sand at concrete pile interface tends to reach the peak strength at the bnning of the cyclic loading and then gradually reduces to the residual strength showing a softening behaviour this is due to the significant particle crushing at the 1st cycle induced by the large shear deformation however for the steel sand tests a slight hardening behaviour is evident with a higher friction angle being mobilised at lower normal stresses 4 micro scale psd investigations showed that cyclically induced particle crushing is only significant within 1 cm from the interface and is negligible beyond this range particle crushing was found to be more profound under higher confining pressure and subjected to larger shear deformation amplitude furthermore it showed that the particle crushing is more significant at the concrete sand interface compared to its counterpart due to the higher surface roughness of the concrete pile it is noted that only dry sands were considered for this work however this manuscript is the first stage of our long term research project a clear understanding about the pile sand interface cyclic behaviour with the situation we presented in this manuscript is necessary before we further consider the offshore environment acknowledgement the authors gratefully acknowledge the support from national natural science foundation of china 41502304 41772318 51979155 qingdao fundamental research project 16 5 1 34 jch shandong key research and development plan 2017gsf20107 2019ghy112078 open fund of state key laboratory of coastal and offshore engineering lp1712 ministry of housing and urban rural development of china 2014 k3 026 and natural science foundation of shandong province zr2018qee008 
22329,bearing capacity failures of offshore pile foundations under cyclic loads in sandy soils are usually initiated by soil strength reduction due to cyclic pile sand interface sliding in this paper a large scale constant normal stiffness cns cyclic direct shear apparatus is designed to simulate this sliding mechanism with an effective shearing area of 0 14 m2 the cyclic pile sand interface behaviour of two common types of piles concrete and steel piles is subsequently investigated under different confining pressures and cyclic deformation amplitudes the experimentally obtained results including the induced shear normal stress displacement behaviour stress path behaviour and particle distribution at the pile sand interface are analysed this further leads to a detailed study for the associated pile sand interface cyclic weakening mechanism through the investigations of cyclic attenuation of shear normal stress amplitude strength reduction and particle crushing respectively furthermore experimental results highlight the effect of initial confining pressure cyclic shear deformation amplitude and pile surface roughness on the investigated pile sand interface cyclic weakening mechanism keywords cyclic direct interface shear tests pile sand interface interface weakening mechanism constant normal stiffness 1 introduction the stability of engineering structures constructed on geotechnical deposits are usually guaranteed by transferring their self weight and external loads to deeper stiff soils or bedrock through underlying supporting systems piles have been effectively employed as the required supporting structures in the form of single pile such as for wind turbines or pile group such as for railway embankments with the significant development of marine resources pile group foundations are increasingly widely used for various offshore engineering structures e g offshore platforms man made islands large span bridges etc under the wind and ocean wave induced cyclic loads the installed piles in pile group foundations are prone to potential bearing capacity failures which are usually initiated by pile soil interface sliding due to interface material strength reduction randolph 2003 however this pile soil interface weakening mechanism has not been thoroughly understood due to its dependency on the critical dynamic and geotechnical factors such as the dynamic characteristics of cyclic loads interface stress conditions pile types etc therefore there is a need to investigate the cyclic pile soil interface behaviour in order to better understand the associated interface weakening mechanism and to account for the induced offshore pile foundation failures for this purpose full scale in situ tests e g chow 1997 tsuha et al 2012 jardine and standing 2012 standing et al 2013 buckley et al 2018 and laboratory tests e g rimoy 2013 li et al 2012 lombardi et al 2013 huang and liu 2015 zhang et al 2017 altuhafi et al 2018 zhou et al 2019 have been carried out to investigate the cyclic pile soil interface behaviour in particular full scale in situ tests can reflect the realistic natural state of soils where investigation results are not affected by the scaling effect or sample disturbance on the other hand laboratory tests can define a variety of boundary conditions to simulate different pile foundation problems the obtained measurements are more accurate and the result interpretation procedure is more straightforward however full scale in situ tests are usually only used for the pile testing before the final engineering installation due to the time and cost inefficiency while laboratory tests can be more effectively employed for parametrically investigating the interface behaviour of pile soil interaction problems considering different geotechnical materials pile types loading conditions etc such laboratory investigations are attributed to rimoy 2013 li et al 2012 lombardi et al 2013 and huang and liu 2015 however these works have been concentrated on the pile soil interface behaviour under monotonic loads and the more critical cyclic investigations however are limited most of the conventional pile soil interface experiments apply the constant normal load cnl boundary conditions on soil specimens throughout shearing this can simulate the external loading conditions of some engineering stability problems such as anchored soil slopes and retaining walls under traffic loads however there are more practical problems such as the pile foundations where the normal load acting on the interface does not remain constant and therefore the cnl is not an appropriate representation of realistic boundary conditions in this case any volume change in the pile soil interface zone is constrained by the soil beyond this zone this can be simulated by applying a constant normal stiffness cns boundary condition during the direct shear tests to represent the constraining effects from the surrounding soil as a result the normal stress on the interface may decrease or increase depending on whether the soil in the interface zone contracts or dilates respectively therefore the cyclic interface pile soil behaviour for pile foundation problems is usually investigated employing the cns direct shear apparatus such as in johnston et al 1987 ooi and carter 1987 tabucanon et al 1995 porcina et al 2003 fakharian and evgin 1997 dejong et al 2003 2006 jiang et al 2004 mortaraetal et al 2007 2010 peng et al 2014 and di donna et al 2016 one of the limitations of the laboratory investigations for pile soil interface behaviour is the scaling effects in other words the effective shearing area of laboratory tests is considerably smaller than the prototype one therefore in this paper in order to reduce the influence the scaling effects and the boundary effects induced by shear box wall a large scale cns cyclic direct shear apparatus is designed to investigate the pile soil cyclic interface behaviour investigations are concentrated in two common types of piles concrete and steel installed in the fujian sand from south china sea due to the significant development of offshore engineering in this area the objectives of the work are to reveal the pile sand interface cyclic weakening mechanism in terms of the cyclic attenuation of shear normal stress amplitude strength reduction behaviour and particle crushing of the interfacial material furthermore the influence of initial confining pressure cyclic shear deformation amplitude and pile surface roughness on pile sand interface cyclic weakening mechanism is also investigated 2 large scale cns cyclic direct shear tests 2 1 testing apparatus as illustrated in fig 1 the concerned domain for pile soil interface investigations can be simplified into three zones i e the shearing zone the elastic zone and the undisturbed zone white and bolton 2002 liu et al 2019 the cyclic shear deformation is mainly induced in the shearing zone with infinitesimal thickness compared to the pile dimension under cyclic loads the soil particles in this zone can be re arranged and crushed resulting in plastic deformation and weakening effects on the interface soils however beyond the shearing zone cyclic loads only induce recoverable elastic deformation in the soil adjacent to the interface this zone is defined as the elastic zone and can be experimentally represented by the ideal constant normal stiffness boundary conditions i e elastic springs applied on the shear zone as shown in fig 1 furthermore in the far field the induced deformation is insignificant and this can be considered as the fixed end for the elastic springs i e the undisturbed zone as shown in fig 1 the spring stiffness k which represents the elastic zone can be estimated by equation 4g d boulon and foray 1986 where d is the diameter of pile and g is the operational shear modulus of the soil around the pile and can be estimated approximately by 0 4g 0 where g 0 is the undisturbed soil shear modulus fahey et al 2003 as shown in fig 2 the designed large scale cns direct shear apparatus consists of four main parts the cns loading system the pile soil interface direct shear system the cyclic actuating system and the data acquisition system the main components of the actuating and data acquisition systems are 1 the gear motor includes a frequency variable motor and a speed reducer with the following characteristics power 2 kw rotational speed 1500r min frequency 5 50 hz speed reducer 1 100 controlled shearing rate 0 15 15 mm min maximum shearing amplitude 100 mm 2 fiber bragg grating fbg sensors are employed for measuring interface shear stresses with the following characteristics central wave length 1530 nm sensitivity 3 7 p m με range 2000με resolution 1με 3 a resistive earth pressure gauge is used for measuring interface normal stresses with the following characteristics diameter 28 mm thickness 10 mm range 0 0 2 mpa sensitivity 2 0 accuracy 0 08 4 an automatic data acquisition system the layout of the fbg sensors and the earth pressure gauge which are used to measure shear and normal stresses respectively is shown in fig 3 it is noted that the fbg sensors were sealed with epoxy resins while the earth pressure gauge is in direct contact with the tested soil material furthermore as shown in figs 2 and 3 the effective shearing area is 0 14 m2 and remains constant during shearing this essentially mitigates the scaling effects involved in common laboratory interface direct shear tests and enhances the reliability of the experimental results in this study 2 2 testing materials and testing scheme the dry fujian sand was tested for the pile soil interface investigations as shown in fig 4 a the sand sample was taken from xiamen in fujian province southeast of china where the offshore projects such as wind turbines and oil and gas offshore platforms are under significant development the particle size distribution psd and the material properties are shown in fig 4 b and table 1 respectively for the tested two piles the concrete pile was sampled using c40 cement with sand gravel and water the proportion is 2 4 1 7 8 1 following 28 day standard indoor cure and the material of the steel pile was q235 steel it is noted that the surface roughness of the two piles were processed to fall in the range of 200 300 μm and 40 50 μm respectively the same as the prototype values the laboratory tests were designed to investigate the effects of several critical factors on cyclic pile sand interface behaviour i e the pile type concrete and steel shear deformation amplitude 5 mm and 10 mm and initial confining pressure 90 kpa and 110 kpa the adopted testing scenarios are listed in table 2 it is noted that 20 cycles are relatively low when considering tidal loads however this research targeted its initial idea to firstly understand the interfacial cyclic weakening mechanism at the bnning of the large number cyclic loading the pile soil interfacial cyclic behaviour under large cycle numbers will be considered in the future work 3 monotonic pile sand interface behaviour monotonic tests were first carried out to investigate the pile sand interface behaviour which can also be considered as the validation for the designed cns direct shear apparatus fig 5 shows the shear stress displacement behaviour at the pile sand interface of the two tested piles under two initial confining pressures overall the tested sand shows a softening behaviour after reaching the peak strength which then gradually approaches the residual strength as the shear deformation increases in particular the concrete sand reaches the peak strength at the shear displacements of 3 3 and 3 1 mm for the confining pressures of 90 and 110 kpa respectively the steel sand shows a faster trend reaching the peak strength at the displacement levels of 1 7 and 1 6 mm for the two confining pressures it can be seen that the strength of the concrete sand interface is larger than that of the steel sand interface showing the positive effects of the higher surface roughness of the concrete pile on interface shear resistance furthermore the higher confining pressure induces larger interface strength and this influence is more significant for rougher piles these observations are in agreement with the monotonic results from fakharian and evgin 1997 showing the reliability of the designed cns direct shear apparatus for the subsequent cyclic investigations it is noted that the experiments were conducted under two confining pressure conditions 90 kpa and 110 kpa fig 5 presents both results to show the effects of confining pressure on the cyclic interfacial behaviour it is noted that the normal stress we used in each test is constant 4 cyclic pile sand interface weakening mechanism in this section the cyclic pile sand interface behaviours of the concrete and steel piles are investigated under different confining pressures and cyclic deformation amplitudes the experimentally obtained results including the induced shear normal stress displacement behaviour stress path behaviour and particle size distribution at the pile sand interface are analysed this further leads to a detailed study for the associated pile sand interface cyclic weakening mechanism through the investigations of cyclic attenuation of shear normal stress amplitude strength reduction and particle crushing respectively 4 1 cyclic attenuation of interface shear and normal stress amplitudes the experimentally obtained interface stress displacement behaviour for the concrete pile is shown in fig 6 under two confining pressures and subjected to two cyclic deformation amplitudes taking the results from the cs 1 test for example fig 6 a and b overall both the shear and normal stress amplitudes tend to attenuate as cycle number increases in particular for the shear stress displacement behaviour fig 6 a under the initial loading of the first cycle the interface sand reaches the peak shear stress of 59 kpa at the displacement level of 3 3 mm and gradually approaches the residual strength of 48 kpa which is the same as the monotonic behaviour discussed in the previous section however compared to the residual strength at the 1st cycle the residual strength reduces as the cycle number increases with the reduction ratio of 34 42 48 and 52 at the 5th 10th 15th and 20th cycle respectively it can be seen that the attenuation is the most significant in the first 5 cycles and the shear stress amplitude gradually stabilises after 15 cycles as seen from fig 6 b the normal stress amplitude also attenuates as cycle number increases this is due to the shearing induced particle movements and crushing and thus soil densification under the cns boundary conditions where the interface zone thickness reduces and therefore the normal load applied on the interface is relaxed the induced normal stress amplitude reduction ratio at the maximum positive shear deformation levels are 30 40 48 and 52 at the 5th 10th 15th and 20th cycle respectively again the normal stress amplitude attenuation is the most significant in the first 5 cycles it is noted that the normal stress displacement behaviour presents a butterfly shape loop in other words as shown in fig 6 b under both the positive directional loading ④① and negative directional loading ②③ the normal stress decreases first and then increases this reflects that the sand in the interface zone contracts first and then dilates similar results were also observed by cui and battacharya 2016 in the numerical simulations of cyclic soil pile interaction using discrete element modelling consequently for the conducted tests under the cns boundary conditions the induced normal load decreases and increases however the observed alternating particle contraction and dilation in this work can only reflect the cyclic interfacial behaviour specifically for the investigated sand some investigations showed particle contraction and stress relaxation behaviour only during cyclic interface direct shear tests silver 1971 the stress displacement behaviours subjected to other confining pressure and shear deformation amplitude are shown in fig 6 c 6 f for the cs 2 and cs 3 tests similar patterns for the stress displacement behaviour are observed from these two tests compared to those for the cs 1 test in particular hysteretic and butterfly loops can be found for the shear stress and normal stress behaviour respectively with amplitudes cyclically attenuating as cycle number increases in order to investigate the influence of confining pressure and shear deformation amplitude on the observed attenuation behaviour the obtained shear and normal stress amplitudes are plotted against cycle numbers in fig 7 based on liu et al 2012 the attenuation trends of the shear and normal stress amplitudes can be best fitted with the logarithmic models expressed by equations 1 and 2 respectively 1 τ m n ln n l 2 σ a b ln n c where parameters m and a means the initial shear and normal stress parameters n and b are the factors which quantify the stress amplitude attenuation rate n is the cycle number l and l are considered as the factors which influence the locations of curves all the model parameters which can be obtained by curve fitting the experimental results based on fig 7 overall the attenuations of the shear and normal stress amplitudes are most significant in the first 5 cycles and the degradation rate gradually decreases as cycle number increases and is negligible after 15 cycles the comparison of the results between the cs 2 and cs 1 tests show that a higher confining pressure would contribute to a higher shear strength on the pile sand interface furthermore by comparing the values of the parameter b in the best fit attenuation curves for the cs 2 and cs 1 tests the higher confining pressure induces a more significant attenuation behaviour for the shear stress amplitude in particular under higher normal loads soil particles at the pile sand interface can be crushed more significantly which therefore induces a more profound attenuation of the shear stress amplitude this is also in agreement with the comparison of the normal stress attenuation between the cs 2 and cs 1 results when comparing the results between the cs 3 and cs 1 tests it can be seen that larger shear deformation amplitude leads to a lower interface shear stress and slightly more significant attenuation behaviour the interface stress displacement behaviours for the steel pile under two confining pressures and subjected to two cyclic deformation amplitudes are shown in fig 8 the overall shear and normal stress displacement behaviours are similar to those of the concrete pile in particular hysteretic and butterfly loops can be found for the shear stress and normal stress behaviour respectively with amplitudes cyclically attenuating as cycle number increases however for the normal stress behaviour the alternating contractive and dilative behaviours are not as significant as those at the concrete sand interface this is mainly due to the higher roughness of concrete surface which causes more significant particle movements thus more profound dilation or contraction furthermore the overall shear strength amplitude i e the height of the hysteretic loop is smaller than that of the concrete pile this is also reflected by comparing the shear stress amplitude attenuation curves in fig 9 with those in fig 7 this is mainly induced by the lower surface roughness at the steel sand interface compared to the concrete pile approximately 40 50 μm and 200 300 μm respectively resulting in lower friction angle and therefore fewer particle rearrangements and less energy dissipation furthermore it is found that the attenuation rate of the shear stress amplitude quantified by the parameter n is larger under higher confining pressure and larger shear deformation amplitude which is in agreement with the observations from the concrete sand tests 4 2 stress path behaviour the stress path behaviour of the concrete sand and steel sand tests are presented in figs 10 and 11 respectively for cs 1 and cs 2 tests the tested sands reach peak strength envelop at the 1st cycle and the corresponding peak friction angles are approximately 30 9 and 32 6 respectively after the 1st cycle significant relaxation behaviour is observed represented by the sharp friction angle reduction this softening behaviour is attributed to the particle rearrangement and crushing especially for the particles locked in rough interface asperities induced by the large shear deformation amplitude at the bnning of the cyclic tests the destructed interface sand would then significantly contract which leads to the normal stress reduction under the cns boundary conditions due to the soil contraction and densification the friction angle decreases and the corresponding final friction angles are approximately 26 1 and 28 6 respectively however every time when the destructed sand reaches the residual strength envelop the interface sand dilates represented by the increase of the normal stress this finally results in the observed butterfly shape normal stress displacement behaviour shown in figs 6 and 8 increase in the shear deformation amplitude produced larger loops however for the cs 3 test the difference between the peak and final friction angles is insignificant due to the small shear deformation amplitude applied in the cs 3 test regarding the stress path behaviour obtained from the steel sand tests a slight hardening behaviour is evident in fig 11 with a higher friction angle being mobilised at lower normal stresses in particular the friction angles for the three steel sand tests are 23 3 22 4 and 23 1 at the first cycle while reduce to the residual strength of 30 9 29 8 and 29 5 respectively this phenomena is also observed by de jong et al 2006 in soil structure interface direct shear tests this increase in friction angle i e hardening behaviour can be attributed to the reduction of normal stress and increase of density boulon and foray 1986 another difference observed for the steel interface compared to the concrete interface is that no loops are observed for the first cycle however with the increase of relative density during the following cycles loops occur similar patterns are observed by mortara et al 2007 the experimentally obtained peak interface friction angles of all the tests are listed in table 3 the ratio between the peak interface friction angles and natural sand internal friction angles are in the range of 0 73 0 81 this ratio is found to be smaller for the steel pile which results in the lower interface shear strength in agreement with the observations in the previous section it is noted that when carrying out the safety design and analysis for offshore pile foundation the interfacial friction angle is usually assumed to be constant as friction angle is determined by the pile material soil material and soil relative density however this assumption only represents the initial condition as interface soil is subject to densification under cyclic shearing this can be justified by the results shown in figs 10 and 11 and table 3 4 3 interface particle crushing in order to more specifically investigate the pile sand interface weakening mechanism from micro perspective the particle size distribution of the sands at different distances from the interface i e 0 1 1 2 2 3 3 4 and 4 5 cm from the interface after the cyclic tests were experimentally obtained and are shown in figs 12 and 13 for the concrete sand and steel sand tests respectively furthermore based on the particle size distribution curves the d 50 at the different locations was obtained and plotted against the distance from the interface in fig 14 for all the tests overall it is observed that the particle crushing is only significant within 1 cm from the interface and is negligible beyond this range the cyclically induced particle crushing is found to be more profound under higher confining pressure by comparing the cs 1 ss 1 and cs 2 ss 2 results or subjected to larger shear deformation amplitude by comparing the cs 1 ss 1 and cs 3 ss 3 results this induces more significant stress amplitude attenuation under these two conditions as observed in fig 7 furthermore it shows that the particle crushing is more significant at the concrete sand interface due to the higher surface roughness of the concrete pile 5 conclusions in this paper the cyclic pile sand interface behaviour of two common types of piles concrete and steel piles was investigated under different confining pressures and cyclic deformation amplitudes using large scale cns cyclic direct shear tests the design of the employed cns apparatus was first introduced the experimentally obtained results including the shear normal stress displacement behaviour stress path behaviour and particle size distribution at the pile sand interface were subsequently analysed this further led to a detailed study for the associated pile sand interface cyclic weakening mechanism through the investigations of cyclic attenuation of shear normal stress strength reduction and micro scale particle crushing respectively key findings regarding the cyclic pile sand interface behaviour are summarised as below 1 the overall shear and normal stress displacement behaviours exhibit as hysteretic and butterfly alternating contractive and dilative behaviour loops respectively higher confining pressure and smaller shear deformation amplitude contribute to a higher shear strength on the pile sand interface 2 the shear and normal stress amplitudes attenuate significantly in the first 5 cycles and the degradation rate gradually becomes smaller and is negligible after 15 cycles the reduction rate is more profound under higher initial confining pressure and larger shear deformation amplitude 3 stress path results showed that under larger shear deformation amplitude the sand at concrete pile interface tends to reach the peak strength at the bnning of the cyclic loading and then gradually reduces to the residual strength showing a softening behaviour this is due to the significant particle crushing at the 1st cycle induced by the large shear deformation however for the steel sand tests a slight hardening behaviour is evident with a higher friction angle being mobilised at lower normal stresses 4 micro scale psd investigations showed that cyclically induced particle crushing is only significant within 1 cm from the interface and is negligible beyond this range particle crushing was found to be more profound under higher confining pressure and subjected to larger shear deformation amplitude furthermore it showed that the particle crushing is more significant at the concrete sand interface compared to its counterpart due to the higher surface roughness of the concrete pile it is noted that only dry sands were considered for this work however this manuscript is the first stage of our long term research project a clear understanding about the pile sand interface cyclic behaviour with the situation we presented in this manuscript is necessary before we further consider the offshore environment acknowledgement the authors gratefully acknowledge the support from national natural science foundation of china 41502304 41772318 51979155 qingdao fundamental research project 16 5 1 34 jch shandong key research and development plan 2017gsf20107 2019ghy112078 open fund of state key laboratory of coastal and offshore engineering lp1712 ministry of housing and urban rural development of china 2014 k3 026 and natural science foundation of shandong province zr2018qee008 
