index,text
5230,in this study a new simulation optimization approach is proposed to solve the multi pollutant waste load allocation wla problems in surface water systems the proposed approach simulates the fate and transport of multiple pollutants utilizing the aquatox model since aquatox is an independent model and its integration into the optimization process is computationally not efficient a multi pollutant concentration response matrix mpcrm is developed by using the results of the aquatox model this mpcrm is then integrated into an optimization model where a nonlinear generalized reduced gradient grg optimization method is used unlike in previously conducted studies a new optimization formulation is proposed wherein the multiple pollutant loads are allocated among the source locations depending on their pre assigned load allocation weights this formulation allows for an equal or variable pollutant load allocation plan among source locations depending on the water management strategy for the watershed the applicability of the proposed approach is evaluated on a sub watershed of the küçük menderes river basin kmrb in turkey by considering different load allocation scenarios furthermore a detailed sensitivity analysis is conducted to evaluate the model results for different problem parameters identified results suggest that the proposed simulation optimization approach is an effective way to solve the multi pollutant wla problem keywords waste load allocation multi pollutant load allocation weights simulation optimization 1 introduction pollution of surface water systems is one of the widespread environmental problems throughout the world the pollution problem arises from the negative impacts of various point and non point sources on receiving water bodies such as streams rivers or lakes in order to control these impacts water authorities impose water quality standards in the management of river basins these standards aim to maintain the water quality at a desired target level by defining discharge limits for conventional specific or priority pollutants as an example the european union water framework directive 2000 60 ec states that the concentration of priority and specific pollutants in surface water systems must be lower than the specified water quality targets wqt to protect the aquatic environment european commission 2000 to attain the specified wqt values it is required to take some measures which reduce the negative impacts of wastewater discharges from point sources although these measures can be taken by following different ways one of the most appropriate ways is to allocate the total maximum daily load between pollutant point sources and subsequently define discharge limits to attain wqts in practice this is called the waste load allocation wla problem the current literature includes many studies that examine the basic principles and considered solution approaches to solve the wla problem the typical wla problem is usually solved using a trial and error approach where the wastewater loads are manually allocated among the source locations until the water quality model of the river system predicts that the wqts have been met although this allocation approach seems to be straightforward it is very time consuming especially if there are many pollution sources in large watersheds therefore it is essential to follow a systematic solution approach rather than the trial and error based solution approaches it is apparent from previous studies that the combined simulation optimization methods are usually the preferred solution approaches for solving the wla problems the previous works include applications of different simulation and optimization models among them simulation models are usually selected depending on the processes to be simulated regarding these processes a variety of water quality models can be used including qual2e qual2k ce qual w2 wasp4 hspf etc these models can model the fate and transport processes for most of the pollutants in surface water systems burn and yulianti 2001 jia and culver 2006 saadatpour and afshar 2007 parmar and keshari 2014 afshar et al 2018 similar to simulation models the developed models differ in terms of the considered optimization approaches note that both deterministic and heuristic optimization approaches have been applied to the solution of wla problems in literature among them the pioneering work was conducted by deininger 1965 where the problem was solved by means of linear programming lp to maintain a dissolved oxygen profile in river systems similarly revelle et al 1968 developed a river water quality management model by using the lp approach liebman and lynn 1966 and klemetson and grenny 1985 studied the same problem by using dynamic programming dp which is used to minimize the wastewater treatment cost mcnamara 1976 and carmichael and strzepek 2000 developed a water quality management model and solved the wla problem by using a nonlinear programming nlp approach note that heuristic optimization approaches are also used for solving different wla problems both single and multi objective versions of these optimization approaches are employed to the solution of wla problems for single objective problems the objective is usually taken as the maximization of the total pollutant load by allocating it among source locations cho et al 2004 afshar and masoumi 2016 afshar et al 2018 on the other hand minimization of the wastewater treatment costs water quality standard violations and inequity of the allocated loads among different source locations are the other frequently considered objectives of multi objective problems burn and yulianti 2001 yandamuri et al 2006 andrade et al 2013 skardi et al 2015 saadatpour et al 2019 furthermore there are also some single and multi objective applications where the uncertainty of the model parameters is evaluated through fuzzy objectives burn and mcbean 1985 chen and chang 1998 mujumdar and vemula 2004 nikoo et al 2012 ghosh and mujumdar 2009 as indicated previously it is required to integrate a water quality simulation model to the optimization approach for simulating the fate and transport process during the solution of the wla problem if it is desired to solve it systematically in this integration the optimization model determines the pollutant loads at the source locations and passes this information to the water quality simulation model after this process the water quality simulation model determines the pollutant concentrations at monitoring locations for the allocated pollutant loads finally this concentration data is passed to the optimization model again to calculate an objective function value and adjust the allocated loads at source locations it can be seen from this solution scheme that the water quality simulation model should be executed for each optimization iteration and this process increases the computational burden especially for the large scale water quality simulation models therefore surrogate modeling approaches are used to reduce the computational burden in simulation optimization studies the idea of the surrogate modeling approach is to approximate the behavior of the original water quality simulation model so that the water quality responses at a given location can be obtained in reasonable times wagner 1995 several studies examine the applicability of different surrogate models in simulation optimization studies wagner 1995 mousavi and shourian 2010 skardi et al 2015 afshar et al 2018 among them one of the most important ones is the concentration response matrix crm approach which has been originally developed to solve groundwater management studies gorelick 1982a 1982b the current literature includes several studies that employ a crm approach to the solution of wla problems burn and mcbean 1985 jia and culver 2006 su et al 2018 2019 elçi et al 2019 however all of them consider a single pollutant and as far as authors knowledge there is no any multi pollutant crm mpcrm approach to solve the wla problems another important issue in wla applications is to allocate the total pollutant loads among the source locations by considering a fairly balanced load distribution although this is an expected allocation procedure in some cases it may be necessary to allocate higher pollutant loads to some source locations and this may not be possible through the currently used solution approaches in literature therefore the allocation of the pollutant loads by considering load allocation weights of the sources also becomes an important aspect of wla problems the main objective of this study is to propose a simulation optimization approach to solve the multi pollutant wla optimization problem in contrast to previous studies the approach takes multiple pollutants into account that may originate from more than one point source in the simulation part of the proposed approach fate and transport of the multiple pollutants including ammonium and ammonia n h 4 n h 3 nitrate n o 3 total soluble phosphorus t s p total phosphorus t p and carbonaceous biochemical oxygen demand c b o d 5 are simulated for a river system with the aquatox park et al 2008 model after this process a mpcrm is developed by using the results of aquatox and integrated into an optimization model where the nonlinear grg optimization approach is used the applicability of the proposed approach is demonstrated on a sub watershed of the küçük menderes river basin kmrb in turkey for different wla scenarios furthermore a detailed sensitivity analysis is conducted to evaluate the performance of the proposed approach for different solution parameters and initial solutions 2 methods 2 1 problem formulation as indicated in the previous section the objective of this study is to solve the multi pollutant wla problem by considering different weights of the pollutant sources this problem can be mathematically expressed using the following optimization formulation let n d be the number of point sources in the river basin n c be the number of pollutants injected from the point source locations n m be the number of monitoring points in the river basin n o be the number of pollutant parameters observed at the monitoring points n t be the number of time steps and q i j be the load of the j t h pollutant which is released from the i t h source location the multi pollutant wla problem can be solved using the objective function and constraints given below i 1 2 3 n d j 1 2 3 n c k 1 2 3 n o l 1 2 3 n m t 1 2 3 n t 1 z m a x i 1 n d j 1 n c q i j β i p 1 i j λ i p 2 i j subject to 2 p 1 i j q i j ω i q j 2 3 p 2 i j b 2 q i q i j 4 q i j c i j q i 5 λ i 1 if ω i 1 b 1 otherwise 6 q j i 1 n d q i j i 1 n d ω i 7 c k l t c k 8 c j m i n c i j c j m a x where z is the objective function value to be maximized p 1 i j is the penalty function which is used to balance the load allocation among pollution sources p 2 i j is the penalty function which is used to prevent zero load discharges from the source locations β i and λ i are the penalty coefficients which are used to adjust the magnitudes of p 1 i j and p 2 i j respectively ω i is the load allocation weight of the i t h pollution source q j is the allocation load which ensures that the load of the j t h pollutant is allocated among the source locations in desired levels q j equals to mean of q i j if ω i values are all equal to 1 q i is the flow discharge of the river reach where i t h pollutant source releases the pollutants c i j is the concentration of the j t h pollutant which is discharged from the i t h source location c j m i n and c j m a x are the minimum and maximum concentrations of the j t h discharged pollutant b 1 and b 2 are the positive integer numbers c k l t is the concentration of the k t h pollutant observed at l t h monitoring point and t t h time step and c k is the limit wqt value for the k t h pollutant observed at monitoring points in the river basin system in this problem formulation the objective function of the proposed approach is constrained by two penalty functions given in eqs 2 and 3 by using the first penalty function p 1 i j it is possible to allocate pollutant loads to the sources in equal or in different amounts this task is achieved based on the load allocation weights of ω i for instance if a condition of ω i 1 is considered for all the sources pollutant loads are allocated equally among the source locations on the other hand if the value of ω i is taken greater than 1 for any given source by setting to 1 for the other sources this source will get a higher load allocation which is to be proportional with the given weight thereby it is possible to allocate the pollutant loads according to weights of the pollutant sources using the proposed optimization formulation it should be noted that this load allocation procedure does not always penalizes the objective function value in this procedure the final objective function value does not have any penalty for the condition of ω i 1 for all the sources however the final objective function value will get a penalty when the problem is solved by considering different load allocation weigths for such a case the optimization model approximates the value of the allocated pollutant loads to zero for minimizing the penalty value in the final objective function value since eq 2 is used this result is considered as an appropriate solution by the optimization model since the condition given in eq 7 is already satisfied however in practice this is not a meaningful solution since zero or nearly zero pollutant loads are assigned to the source locations to prevent this problem the penalty function of p 2 i j given in eq 3 is implemented according to this function the final objective function value will get a penalty value with a magnitude of λ i b 2 q i q i j when the allocated loads of any source approaches to zero note that the penalty coefficient of λ i used here has a dynamic nature eq 5 such that its value will be equal to a large integer b 1 when the value of ω i is different from 1 the optimization formulation given above has three parameters b 1 b 2 β i that affect the model results therefore a detailed sensitivity analysis is conducted to determine which parameter mostly influences the allocation results the decision variables of the optimization problem are the pollutant concentrations c i j and their are determined by maximizing eq 1 subject to the constraints given by eq 2 to 8 2 2 simulation model development of aquatox based mpcrm the simulation model is the key part of the proposed approach since it determines the fate and transport of the pollutants in the river system from a mathematical perspective a water quality simulation model can be considered as a function that transforms the pollutant loads at source locations to pollutant concentrations in the receiving waterbody i e concentrations at monitoring points this property can also be seen from the proposed optimization formulation as follows i the concentrations of c i j are determined by the optimization model by considering the minimum and maximum bounds eq 8 ii the values of c i j are converted to the pollutant loads of q i j eq 4 iii the water quality simulation model calculates the concentrations of c k l t by using the pollutant loads of q i j as model input iv the values of c k l t are compared with the value of c k to evaluate if the wqt requirement is satisfied eq 7 it is important to note that the computational steps given above need to be conducted for each optimization iteration therefore an aquatox based mpcrm approach is proposed in this study to simulate the fate and transport of various pollutants such as nutrients and organic chemicals in this approach the concentration of the k t h pollutant parameter observed at l t h monitoring point and t t h time step can be calculated as follows i 1 2 3 n d j 1 2 3 n c k 1 2 3 n o l 1 2 3 n m t 1 2 3 n t 9 c k l t i 1 n d j 1 n c α i j k l t q i j c k l 0 t where c k l 0 t is the background concentration of the k t h pollutant which is observed at l t h monitoring point and t t h time step and α i j k l t α is the composite response coefficient which is used to calculate the concentration of the k t h pollutant observed at l t h monitoring point and t t h time step due to the unit injection q i j 1 of the j t h pollutant from i t h source location α is the mpcrm having n c n o n t rows and n d n m columns note that elements of α are calculated by performing separate aquatox model executions for each source location and each pollutant after performing these n d n c aquatox model executions elements of α are calculated as follows 10 α i j k l t c k l t c k l 0 t q i j where c k l t is the concentration calculated by the aquatox model for the k t h pollutant observed at l t h monitoring point and t t h time step after obtaining the elements of α the associated multi pollutant concentration time series at monitoring points can be calculated by means of eq 9 by integrating eq 9 and α to the optimization model the multi pollutant wla problem can be solved using the proposed approach it should be noted that the concept of the crm approach is based on the principle of linear superposition i e the superposition of concentration responses from individual point sources therefore the linearity of the water quality simulation model should be warranted to obtain a close match between the surrogate model mpcrm results and actual water quality model aquatox results 2 3 optimization model grg optimization approach the multi pollutant wla problem is solved using the grg approach in the optimization model grg first proposed by lasdon et al 1974 is a nonlinear optimization approach that can solve many unconstrained and constrained engineering optimization problems in this approach the inequality constraints of the problem are converted into the equality constraints by adding nonnegative slack variables after this conversion the objective function and the converted equality constraints are written in the form of the first order taylor series to minimize the value of the objective function in the specified solution point by means of the reduced gradient approach note that grg is a very powerful optimization approach especially for problems where the shape of the search space is convex grg is also used as a nonlinear optimization engine in solver add in which is used in most spreadsheet platforms detailed information about grg optimization approach can be found in lasdon et al 1974 3 wla application 3 1 study area kmrb is located in the western part of turkey fig 1 which lies between 38 41 05 and 37 24 08 n latitudes and 28 24 36 and 26 11 48 e longitudes the drainage area of the basin is about 3 400 km2 and the collected water from this area is discharged to the aegean sea through küçük menderes river and its tributaries the length of the main reach of küçük menderes river is about 130 km and this reach has a mean discharge of 11 45 m3 s coefficient of determination of the discharges is about 1 03 tubitak mrc 2010 note that water quality in kmrb is subjected to significant environmental stress because of the negative effects of agriculture husbandry domestic and industrial wastewater discharges as a result of these activities approximately 109 000 m3 d wastewater is discharged to surface water bodies in kmrb according to moef 2016 roughly 77 of this wastewater is discharged from the treatment plants while the remaining part is directly released from the sewerage systems the aquatox model is set up for a sub watershed of kmrb by considering hypothetical but realistic hydraulic parameters and pollutant source loadings the considered study area where the proposed approach is applied is given in fig 2 the main reach to be modeled is the ilica stream pink colored reach in fig 2 which has a length of 12 km and an assumed constant discharge of 1 906 m3 s this main reach merges with a tributary uladi stream before ultimately merging with fetrek stream which is one of the most polluted tributaries of the küçük menderes river the discharge of the tributary before connecting the main reach is about 0 05 m3 s there are 5 pollution sources in the considered sub basin among them ps 1 represents a domestic wastewater treatment plant which releases treated wastewater to the main reach with a discharge rate of 0 093 m3 s since water quality of the tributary is not modeled its contribution to the main reach is also considered as a pollutant source ps 2 the remaining source locations p s 3 5 are the discharge points of three industrial facilities and each of them discharges the wastewater to the main reach with a rate of 0 116 m3 s note that the influence of these pollutant sources to river water quality is evaluated at three monitoring points which are shown in fig 2 as km 19 km 20 and km 22 3 2 simulation of river water quality as indicated previously simulation of the water quality is conducted by modeling the ilıca stream on aquatox considering hypothetical but realistic hydraulics and water quality variables for this purpose the segmentation given in fig 3 is used as can be seen the main reach of the ilica stream is divided into 12 flow segments each of them has 1 km long and 15 m width in order to calculate the water depths easily the cross section of each segment is assumed to be rectangular note that these rectangular segments are approximated as ideal completely mixed reactors where all physical and chemical properties are assumed to be homogeneous and are linked sequentially to create a one dimensional uniform cascading flow condition furthermore multiple pollutants are released from each source location by considering a first order decay with a constant of k 5 d 1 for simplicity the release rates are assumed to be constant however it is possible to assign transient loadings for each source as indicated previously the wla problem is solved by considering multiple pollutants for this purpose the developed aquatox model is executed considering four different pollutants discharged from the points sources these parameters are total ammonia nitrogen nitrate nitrogen total soluble phosphorus tsp and detritus organic matter after the execution of the model the influence of these discharges are observed at the monitoring points in terms of five pollutant state variable namely n h 4 n h 3 n o 3 t s p total phosphorus t p and carbonaceous biological oxygen demand c b o d 5 this input output structure is conceptually shown in fig 4 as can be seen the developed aquatox model is used as a function that transforms the given four input parameters to the five output parameters at the monitoring points note that the aquatox model is executed by considering the total simulation time of 30 days during this period the time step size is considered variable which is determined by the model by considering the numerical stability conditions as an example case the developed aquatox model is executed for the pollutant source characteristics given in table 1 note that all discharge rates and pollutant concentrations are arbitrary and do not rely on any kind of measurement in the field for the given pre optimization load allocation resulting concentrations at each monitoring point and their comparison with the corresponding wqt values are given in table 2 the results show that all the pollutant concentrations after 30 days of simulation time exceed the corresponding wqts except for n o 3 concentrations therefore the initial pollutant loads table 1 should be adjusted using the proposed simulation optimization approach so that the wqts for each pollutant at all monitoring points are satisfied it should be noted that the simulation of water quality within optimization process is conducted by substituting the aquatox model with the mpcrm since the mpcrm is based on the principle of linear superposition the substitution of the actual water quality model with the surrogate model mpcrm is possible only if the water quality model shows linear behavior therefore the linearity condition of the aquatox model needs also be evaluated for this purpose ten different sets of pollutant source characteristics are randomly generated similar to the ones given in table 1 after this process the resulting pollutant concentrations at monitoring points are determined by using these data as the input of the aquatox and mpcrm respectively by considering all the output parameters given in fig 4 results of the aquatox and mpcrm are compared in fig 5 as can be seen results of the mpcrm match almost perfectly the results of the aquatox model for each monitoring point this outcome indicates linearity and thereby the usability of the mpcrm as the surrogate water quality simulation model within the optimization process detailed information about this evaluation can be obtained from sadak 2019 4 allocation results in this section the allocation results of the proposed simulation optimization approach are presented note that the applicability of the proposed approach is evaluated by considering four different scenarios in terms of different load allocation weights ω i the weights used in these scenarios are given in table 3 considering these weights the proposed simulation optimization approach is executed by using b 1 10 b 2 10 and β i 1 i 1 2 3 n d during these executions the lower and upper bounds of the decision variables are set to c j m i n 0 and c j m a x 100 mg l j 1 2 3 n c and the optimization process is terminated when the absolute error between two successive iterations is lower than a tolerance bound of 10 10 for these parameter values the variation of the total pollutant loads for each grg iteration is given in fig 6 as can be seen from fig 6 all the scenarios start the search process from the same point and converge to different total pollutant load values which represent the highest possible load to the sub watershed without compromising the wqts while the biggest final load value is obtained for scenario 1 829 kg d the lowest is obtained for scenario 2 712 kg d note that all the scenarios required around 50 grg iterations to reach the solution for these final pollutant loads the identification results are compared in table 4 the results given in table 4 demonstrate the influence of the ω i values on the results of the allocated pollutant loads it is evident from scenario 1 results that pollutant loads are allocated equally between source locations since the same ω i values are used for each source unlike scenario 1 the pollutant loads in scenario 2 are allocated among source locations in proportion to the corresponding ω i values as an example case the allocated total ammonia as n loads of ps 1 and ps 4 are obtained as 2 511 and 10 041 in scenario 2 respectively as can be seen the allocated pollutant load of ps 4 is about 4 times larger than ps 1 since the value of ω 4 is 4 times large than ω 1 similar results are also obtained for scenario 3 and 4 such that the pollutant loads are allocated proportionally with the assigned ω i values after obtaining the load allocations for each scenario the resulting pollutant concentrations at monitoring points are checked if the desired wqt values table 5 it is evident from table 5 that the resulting concentrations for each pollutant do not exceed the corresponding wqts in each scenario in fact the resulting concentrations at upstream locations km 19 and km 20 are lower than the wqts for each pollutant this is an expected behavior since the resulting concentrations at these particular monitoring points are only affected by the pollutant discharges from ps 1 fig 3 in contrast the resulting n h 4 n h 3 n o 3 t p and c b o d 5 concentrations at km 22 are equal to the given wqt values for each scenario this is also an expected behavior since km 22 is a downstream location on the river and a cumulative influence of all source locations is observed at km 22 these results indicate that the proposed model allows the maximum possible pollutant discharge while keeping the water quality at a desired level note that the influence of different ω i values can also be seen from the resulting concentration values as an example case for scenario 2 ps 1 is assigned the minimum load allocation and therefore its influence observed at km 19 and km 20 are minimal compared to the influence of the other sources observed at km 22 5 sensitivity analysis as can be seen from the allocation results given above the proposed simulation optimization approach can effectively solve the multi pollutant wla problem for different load allocation scenarios since the results of the proposed approach are based on the selection of three model parameters e g b 1 b 2 β i a sensitivity analysis is conducted to determine the influence of these parameters to model results depending on the experiences during the development of the optimization formulation the following parameter values are used in the analysis b 1 1 10 100 1000 b 2 1 10 100 1000 β i 0 001 0 01 0 1 1 by considering these parameter values the problem is solved scenario 1 is taken into account for 4 3 64 different parameter combinations where variation of each parameter is taken account as indicated previously solution of the problem is conducted with parameter values b 1 10 b 2 10 and β i 1 and this solution is labeled as the base solution in order to evaluate the model performance the identified results have been compared to the base solution by means of the measure of centroid distance cd ayvaz and elci 2013 the mathematical definition of the cd measure for solution of the multi pollutant wla problem is explained as follows let cp j be the centroid of the j t h pollutant load which is specified for the base solution cp j k be the centroid of the j t h pollutant load which is specified for the k t h parameter combination j 1 2 3 n c k 1 2 3 64 x j and y j be the centroid coordinates of the j t h pollutant load for the base solution x j k and y j k be the centroid coordinates of the j t h pollutant load for the k t h parameter combination and x i and y i be the coordinates of the the i t h pollutant source i 1 2 3 n d depending on these definitions centroid coordinates of the j t h pollutant load are calculated as follows 11 x j κ i 1 n d q i j x i i 1 n d q i j 12 y j κ i 1 n d q i j y i i 1 n d q i j 13 κ base solution k k th parameter combination as can be seen from eqs 11 to 13 centroids coordinates of the j t h pollutant load are calculated by taking the weighted mean of the source locations with respect to the identified pollutant loads after this process centroid distance between k t h solution and the base solution is calculated as follows 14 cd j k x j k x j 2 y j k y j 2 1 2 where cd j k represents the centroid distance for the j t h pollutant load which is calculated by using the centroid coordinates of the k t h parameter combination and the base solution note that eq 14 states that the proposed model finds similar solutions when the value of cd j k approaches to zero after this process the proposed simulation optimization approach is executed for each parameter combination and the identified results are compared to the base solution in fig 7 for different pollutant parameters as can be seen although some centroid points are located very close to the base solution there are some points which are located far from the base solution this result indicates that the proposed approach is sensitive to some of the solution parameters in 64 different parameter combinations in order to determine the most sensitive parameters or parameter combinations the measure of cd j k j 1 2 3 n c k 1 2 3 64 is calculated for each released parameter and given in fig 8 as can be seen from fig 8 the maximum cd j k values are obtained about 4 743 m for the total ammonia as n 4868 m for the nitrate as n 2 652 m for the total soluble p and 5 093 m for organic matter respectively when the total ammonia n is taken into account it can be observed that the values of cd j k are very low until the 16th solution after this point a systematic behavior is observed such that the calculated cd j k values for 17th 21st 25th and 29th solutions group 1 are equal and significantly higher than the first 15 solutions similar systematical behavior can also be observed for 33rd 37th 41st 45th group 2 50th 54th 58th 62nd group 3 and 49th 53rd 57th 61st group 4 solutions respectively note that cd j k values for groups 1 to 4 are obtained about 1 823 m 4 742 m 4 743 m and 4 330 m respectively when these solutions and the corresponding data sets are evaluated in detail it is observed that b 1 and β i values are equal in each quartet groups mentioned above another interesting finding is that the ratios of b 1 β i are obtained as 104 for group 1 105 for groups 2 and 3 and 106 for group 4 respectively in this respect it is observed that the calculated cd j k values are obtained in the range of 0 and 367 50 m when the the ratios of b 1 β i are between 1 and 1 000 note that the value of b 2 does not have a significant effect on the calculated results for these quartet data combinations based on these results it can be concluded that the model provides different solutions than the base solution when the ratio of b 1 β i is greater than 1 000 note that similar results can also be observed for the other pollutant parameters given in fig 8 6 discussion and conclusions as can be seen from the identified results presented above the proposed simulation optimization approach can be used to solve the multi pollutant wla problems in surface water systems depending on the identified outcomes the following points can be addressed regarding the proposed simulation optimization approach one of the important features of the proposed approach is a new problem formulation which allows wla by weights for each point source different weightings can be useful in practice when an equal distribution of the total pollutant load is not possible because of wastewater treatment technology constraints or when an equal distribution of loadings is not fair concerning the position upstream versus downstream of the discharge according to the identified results all allocated pollutant loads are proportional with their weighting coefficients moreover it is worth noting that the formulation can only be used for point sources for other source types the proposed allocation approach cannot be used in its present form and should be modified another important conclusion of this study is the usefulness of the mpcrm approach in cases where multiple decaying pollutant parameters must be considered simultaneously as indicated previously this approach is based upon the principle of linear superposition which can only be used for linear water quality models however this linearity condition may not be satisfied for models where more interacting species of pollutants are simulated and consequently the fate and transport process of multiple pollutants may not be simulated by using the proposed mpcrm approach for such cases different nonlinear surrogate modeling approaches can be used rather than the mpcrm approach furthermore the grg optimization approach is gradient based and finding the global optimum solution may only be possible when the problem has a convex search space for problems with non convex search space finding the global optimum solution is only possible when good starting points are provided based on the trials it is observed that the proposed approach converges to the same objective function values when the problem is solved for different starting points this result suggests that the search space of the problem is convex in shape and the solution of the problem using the grg approach yields feasible results however this convex search space may change in case of the inclusion of additional constraints or decision variables for such cases global optimum solutions may not be obtained with the grg approach and application of heuristic optimization methods may be required credit authorship contribution statement derya sadak methodology software formal analysis writing original draft visualization m tamer ayvaz conceptualization methodology software formal analysis writing original draft writing review editing visualization alper elçi conceptualization methodology validation formal analysis writing original draft writing review editing visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study is funded by the scientific and technological research council of turkey tubitak under project number 116y413 116y414 116y415 
5230,in this study a new simulation optimization approach is proposed to solve the multi pollutant waste load allocation wla problems in surface water systems the proposed approach simulates the fate and transport of multiple pollutants utilizing the aquatox model since aquatox is an independent model and its integration into the optimization process is computationally not efficient a multi pollutant concentration response matrix mpcrm is developed by using the results of the aquatox model this mpcrm is then integrated into an optimization model where a nonlinear generalized reduced gradient grg optimization method is used unlike in previously conducted studies a new optimization formulation is proposed wherein the multiple pollutant loads are allocated among the source locations depending on their pre assigned load allocation weights this formulation allows for an equal or variable pollutant load allocation plan among source locations depending on the water management strategy for the watershed the applicability of the proposed approach is evaluated on a sub watershed of the küçük menderes river basin kmrb in turkey by considering different load allocation scenarios furthermore a detailed sensitivity analysis is conducted to evaluate the model results for different problem parameters identified results suggest that the proposed simulation optimization approach is an effective way to solve the multi pollutant wla problem keywords waste load allocation multi pollutant load allocation weights simulation optimization 1 introduction pollution of surface water systems is one of the widespread environmental problems throughout the world the pollution problem arises from the negative impacts of various point and non point sources on receiving water bodies such as streams rivers or lakes in order to control these impacts water authorities impose water quality standards in the management of river basins these standards aim to maintain the water quality at a desired target level by defining discharge limits for conventional specific or priority pollutants as an example the european union water framework directive 2000 60 ec states that the concentration of priority and specific pollutants in surface water systems must be lower than the specified water quality targets wqt to protect the aquatic environment european commission 2000 to attain the specified wqt values it is required to take some measures which reduce the negative impacts of wastewater discharges from point sources although these measures can be taken by following different ways one of the most appropriate ways is to allocate the total maximum daily load between pollutant point sources and subsequently define discharge limits to attain wqts in practice this is called the waste load allocation wla problem the current literature includes many studies that examine the basic principles and considered solution approaches to solve the wla problem the typical wla problem is usually solved using a trial and error approach where the wastewater loads are manually allocated among the source locations until the water quality model of the river system predicts that the wqts have been met although this allocation approach seems to be straightforward it is very time consuming especially if there are many pollution sources in large watersheds therefore it is essential to follow a systematic solution approach rather than the trial and error based solution approaches it is apparent from previous studies that the combined simulation optimization methods are usually the preferred solution approaches for solving the wla problems the previous works include applications of different simulation and optimization models among them simulation models are usually selected depending on the processes to be simulated regarding these processes a variety of water quality models can be used including qual2e qual2k ce qual w2 wasp4 hspf etc these models can model the fate and transport processes for most of the pollutants in surface water systems burn and yulianti 2001 jia and culver 2006 saadatpour and afshar 2007 parmar and keshari 2014 afshar et al 2018 similar to simulation models the developed models differ in terms of the considered optimization approaches note that both deterministic and heuristic optimization approaches have been applied to the solution of wla problems in literature among them the pioneering work was conducted by deininger 1965 where the problem was solved by means of linear programming lp to maintain a dissolved oxygen profile in river systems similarly revelle et al 1968 developed a river water quality management model by using the lp approach liebman and lynn 1966 and klemetson and grenny 1985 studied the same problem by using dynamic programming dp which is used to minimize the wastewater treatment cost mcnamara 1976 and carmichael and strzepek 2000 developed a water quality management model and solved the wla problem by using a nonlinear programming nlp approach note that heuristic optimization approaches are also used for solving different wla problems both single and multi objective versions of these optimization approaches are employed to the solution of wla problems for single objective problems the objective is usually taken as the maximization of the total pollutant load by allocating it among source locations cho et al 2004 afshar and masoumi 2016 afshar et al 2018 on the other hand minimization of the wastewater treatment costs water quality standard violations and inequity of the allocated loads among different source locations are the other frequently considered objectives of multi objective problems burn and yulianti 2001 yandamuri et al 2006 andrade et al 2013 skardi et al 2015 saadatpour et al 2019 furthermore there are also some single and multi objective applications where the uncertainty of the model parameters is evaluated through fuzzy objectives burn and mcbean 1985 chen and chang 1998 mujumdar and vemula 2004 nikoo et al 2012 ghosh and mujumdar 2009 as indicated previously it is required to integrate a water quality simulation model to the optimization approach for simulating the fate and transport process during the solution of the wla problem if it is desired to solve it systematically in this integration the optimization model determines the pollutant loads at the source locations and passes this information to the water quality simulation model after this process the water quality simulation model determines the pollutant concentrations at monitoring locations for the allocated pollutant loads finally this concentration data is passed to the optimization model again to calculate an objective function value and adjust the allocated loads at source locations it can be seen from this solution scheme that the water quality simulation model should be executed for each optimization iteration and this process increases the computational burden especially for the large scale water quality simulation models therefore surrogate modeling approaches are used to reduce the computational burden in simulation optimization studies the idea of the surrogate modeling approach is to approximate the behavior of the original water quality simulation model so that the water quality responses at a given location can be obtained in reasonable times wagner 1995 several studies examine the applicability of different surrogate models in simulation optimization studies wagner 1995 mousavi and shourian 2010 skardi et al 2015 afshar et al 2018 among them one of the most important ones is the concentration response matrix crm approach which has been originally developed to solve groundwater management studies gorelick 1982a 1982b the current literature includes several studies that employ a crm approach to the solution of wla problems burn and mcbean 1985 jia and culver 2006 su et al 2018 2019 elçi et al 2019 however all of them consider a single pollutant and as far as authors knowledge there is no any multi pollutant crm mpcrm approach to solve the wla problems another important issue in wla applications is to allocate the total pollutant loads among the source locations by considering a fairly balanced load distribution although this is an expected allocation procedure in some cases it may be necessary to allocate higher pollutant loads to some source locations and this may not be possible through the currently used solution approaches in literature therefore the allocation of the pollutant loads by considering load allocation weights of the sources also becomes an important aspect of wla problems the main objective of this study is to propose a simulation optimization approach to solve the multi pollutant wla optimization problem in contrast to previous studies the approach takes multiple pollutants into account that may originate from more than one point source in the simulation part of the proposed approach fate and transport of the multiple pollutants including ammonium and ammonia n h 4 n h 3 nitrate n o 3 total soluble phosphorus t s p total phosphorus t p and carbonaceous biochemical oxygen demand c b o d 5 are simulated for a river system with the aquatox park et al 2008 model after this process a mpcrm is developed by using the results of aquatox and integrated into an optimization model where the nonlinear grg optimization approach is used the applicability of the proposed approach is demonstrated on a sub watershed of the küçük menderes river basin kmrb in turkey for different wla scenarios furthermore a detailed sensitivity analysis is conducted to evaluate the performance of the proposed approach for different solution parameters and initial solutions 2 methods 2 1 problem formulation as indicated in the previous section the objective of this study is to solve the multi pollutant wla problem by considering different weights of the pollutant sources this problem can be mathematically expressed using the following optimization formulation let n d be the number of point sources in the river basin n c be the number of pollutants injected from the point source locations n m be the number of monitoring points in the river basin n o be the number of pollutant parameters observed at the monitoring points n t be the number of time steps and q i j be the load of the j t h pollutant which is released from the i t h source location the multi pollutant wla problem can be solved using the objective function and constraints given below i 1 2 3 n d j 1 2 3 n c k 1 2 3 n o l 1 2 3 n m t 1 2 3 n t 1 z m a x i 1 n d j 1 n c q i j β i p 1 i j λ i p 2 i j subject to 2 p 1 i j q i j ω i q j 2 3 p 2 i j b 2 q i q i j 4 q i j c i j q i 5 λ i 1 if ω i 1 b 1 otherwise 6 q j i 1 n d q i j i 1 n d ω i 7 c k l t c k 8 c j m i n c i j c j m a x where z is the objective function value to be maximized p 1 i j is the penalty function which is used to balance the load allocation among pollution sources p 2 i j is the penalty function which is used to prevent zero load discharges from the source locations β i and λ i are the penalty coefficients which are used to adjust the magnitudes of p 1 i j and p 2 i j respectively ω i is the load allocation weight of the i t h pollution source q j is the allocation load which ensures that the load of the j t h pollutant is allocated among the source locations in desired levels q j equals to mean of q i j if ω i values are all equal to 1 q i is the flow discharge of the river reach where i t h pollutant source releases the pollutants c i j is the concentration of the j t h pollutant which is discharged from the i t h source location c j m i n and c j m a x are the minimum and maximum concentrations of the j t h discharged pollutant b 1 and b 2 are the positive integer numbers c k l t is the concentration of the k t h pollutant observed at l t h monitoring point and t t h time step and c k is the limit wqt value for the k t h pollutant observed at monitoring points in the river basin system in this problem formulation the objective function of the proposed approach is constrained by two penalty functions given in eqs 2 and 3 by using the first penalty function p 1 i j it is possible to allocate pollutant loads to the sources in equal or in different amounts this task is achieved based on the load allocation weights of ω i for instance if a condition of ω i 1 is considered for all the sources pollutant loads are allocated equally among the source locations on the other hand if the value of ω i is taken greater than 1 for any given source by setting to 1 for the other sources this source will get a higher load allocation which is to be proportional with the given weight thereby it is possible to allocate the pollutant loads according to weights of the pollutant sources using the proposed optimization formulation it should be noted that this load allocation procedure does not always penalizes the objective function value in this procedure the final objective function value does not have any penalty for the condition of ω i 1 for all the sources however the final objective function value will get a penalty when the problem is solved by considering different load allocation weigths for such a case the optimization model approximates the value of the allocated pollutant loads to zero for minimizing the penalty value in the final objective function value since eq 2 is used this result is considered as an appropriate solution by the optimization model since the condition given in eq 7 is already satisfied however in practice this is not a meaningful solution since zero or nearly zero pollutant loads are assigned to the source locations to prevent this problem the penalty function of p 2 i j given in eq 3 is implemented according to this function the final objective function value will get a penalty value with a magnitude of λ i b 2 q i q i j when the allocated loads of any source approaches to zero note that the penalty coefficient of λ i used here has a dynamic nature eq 5 such that its value will be equal to a large integer b 1 when the value of ω i is different from 1 the optimization formulation given above has three parameters b 1 b 2 β i that affect the model results therefore a detailed sensitivity analysis is conducted to determine which parameter mostly influences the allocation results the decision variables of the optimization problem are the pollutant concentrations c i j and their are determined by maximizing eq 1 subject to the constraints given by eq 2 to 8 2 2 simulation model development of aquatox based mpcrm the simulation model is the key part of the proposed approach since it determines the fate and transport of the pollutants in the river system from a mathematical perspective a water quality simulation model can be considered as a function that transforms the pollutant loads at source locations to pollutant concentrations in the receiving waterbody i e concentrations at monitoring points this property can also be seen from the proposed optimization formulation as follows i the concentrations of c i j are determined by the optimization model by considering the minimum and maximum bounds eq 8 ii the values of c i j are converted to the pollutant loads of q i j eq 4 iii the water quality simulation model calculates the concentrations of c k l t by using the pollutant loads of q i j as model input iv the values of c k l t are compared with the value of c k to evaluate if the wqt requirement is satisfied eq 7 it is important to note that the computational steps given above need to be conducted for each optimization iteration therefore an aquatox based mpcrm approach is proposed in this study to simulate the fate and transport of various pollutants such as nutrients and organic chemicals in this approach the concentration of the k t h pollutant parameter observed at l t h monitoring point and t t h time step can be calculated as follows i 1 2 3 n d j 1 2 3 n c k 1 2 3 n o l 1 2 3 n m t 1 2 3 n t 9 c k l t i 1 n d j 1 n c α i j k l t q i j c k l 0 t where c k l 0 t is the background concentration of the k t h pollutant which is observed at l t h monitoring point and t t h time step and α i j k l t α is the composite response coefficient which is used to calculate the concentration of the k t h pollutant observed at l t h monitoring point and t t h time step due to the unit injection q i j 1 of the j t h pollutant from i t h source location α is the mpcrm having n c n o n t rows and n d n m columns note that elements of α are calculated by performing separate aquatox model executions for each source location and each pollutant after performing these n d n c aquatox model executions elements of α are calculated as follows 10 α i j k l t c k l t c k l 0 t q i j where c k l t is the concentration calculated by the aquatox model for the k t h pollutant observed at l t h monitoring point and t t h time step after obtaining the elements of α the associated multi pollutant concentration time series at monitoring points can be calculated by means of eq 9 by integrating eq 9 and α to the optimization model the multi pollutant wla problem can be solved using the proposed approach it should be noted that the concept of the crm approach is based on the principle of linear superposition i e the superposition of concentration responses from individual point sources therefore the linearity of the water quality simulation model should be warranted to obtain a close match between the surrogate model mpcrm results and actual water quality model aquatox results 2 3 optimization model grg optimization approach the multi pollutant wla problem is solved using the grg approach in the optimization model grg first proposed by lasdon et al 1974 is a nonlinear optimization approach that can solve many unconstrained and constrained engineering optimization problems in this approach the inequality constraints of the problem are converted into the equality constraints by adding nonnegative slack variables after this conversion the objective function and the converted equality constraints are written in the form of the first order taylor series to minimize the value of the objective function in the specified solution point by means of the reduced gradient approach note that grg is a very powerful optimization approach especially for problems where the shape of the search space is convex grg is also used as a nonlinear optimization engine in solver add in which is used in most spreadsheet platforms detailed information about grg optimization approach can be found in lasdon et al 1974 3 wla application 3 1 study area kmrb is located in the western part of turkey fig 1 which lies between 38 41 05 and 37 24 08 n latitudes and 28 24 36 and 26 11 48 e longitudes the drainage area of the basin is about 3 400 km2 and the collected water from this area is discharged to the aegean sea through küçük menderes river and its tributaries the length of the main reach of küçük menderes river is about 130 km and this reach has a mean discharge of 11 45 m3 s coefficient of determination of the discharges is about 1 03 tubitak mrc 2010 note that water quality in kmrb is subjected to significant environmental stress because of the negative effects of agriculture husbandry domestic and industrial wastewater discharges as a result of these activities approximately 109 000 m3 d wastewater is discharged to surface water bodies in kmrb according to moef 2016 roughly 77 of this wastewater is discharged from the treatment plants while the remaining part is directly released from the sewerage systems the aquatox model is set up for a sub watershed of kmrb by considering hypothetical but realistic hydraulic parameters and pollutant source loadings the considered study area where the proposed approach is applied is given in fig 2 the main reach to be modeled is the ilica stream pink colored reach in fig 2 which has a length of 12 km and an assumed constant discharge of 1 906 m3 s this main reach merges with a tributary uladi stream before ultimately merging with fetrek stream which is one of the most polluted tributaries of the küçük menderes river the discharge of the tributary before connecting the main reach is about 0 05 m3 s there are 5 pollution sources in the considered sub basin among them ps 1 represents a domestic wastewater treatment plant which releases treated wastewater to the main reach with a discharge rate of 0 093 m3 s since water quality of the tributary is not modeled its contribution to the main reach is also considered as a pollutant source ps 2 the remaining source locations p s 3 5 are the discharge points of three industrial facilities and each of them discharges the wastewater to the main reach with a rate of 0 116 m3 s note that the influence of these pollutant sources to river water quality is evaluated at three monitoring points which are shown in fig 2 as km 19 km 20 and km 22 3 2 simulation of river water quality as indicated previously simulation of the water quality is conducted by modeling the ilıca stream on aquatox considering hypothetical but realistic hydraulics and water quality variables for this purpose the segmentation given in fig 3 is used as can be seen the main reach of the ilica stream is divided into 12 flow segments each of them has 1 km long and 15 m width in order to calculate the water depths easily the cross section of each segment is assumed to be rectangular note that these rectangular segments are approximated as ideal completely mixed reactors where all physical and chemical properties are assumed to be homogeneous and are linked sequentially to create a one dimensional uniform cascading flow condition furthermore multiple pollutants are released from each source location by considering a first order decay with a constant of k 5 d 1 for simplicity the release rates are assumed to be constant however it is possible to assign transient loadings for each source as indicated previously the wla problem is solved by considering multiple pollutants for this purpose the developed aquatox model is executed considering four different pollutants discharged from the points sources these parameters are total ammonia nitrogen nitrate nitrogen total soluble phosphorus tsp and detritus organic matter after the execution of the model the influence of these discharges are observed at the monitoring points in terms of five pollutant state variable namely n h 4 n h 3 n o 3 t s p total phosphorus t p and carbonaceous biological oxygen demand c b o d 5 this input output structure is conceptually shown in fig 4 as can be seen the developed aquatox model is used as a function that transforms the given four input parameters to the five output parameters at the monitoring points note that the aquatox model is executed by considering the total simulation time of 30 days during this period the time step size is considered variable which is determined by the model by considering the numerical stability conditions as an example case the developed aquatox model is executed for the pollutant source characteristics given in table 1 note that all discharge rates and pollutant concentrations are arbitrary and do not rely on any kind of measurement in the field for the given pre optimization load allocation resulting concentrations at each monitoring point and their comparison with the corresponding wqt values are given in table 2 the results show that all the pollutant concentrations after 30 days of simulation time exceed the corresponding wqts except for n o 3 concentrations therefore the initial pollutant loads table 1 should be adjusted using the proposed simulation optimization approach so that the wqts for each pollutant at all monitoring points are satisfied it should be noted that the simulation of water quality within optimization process is conducted by substituting the aquatox model with the mpcrm since the mpcrm is based on the principle of linear superposition the substitution of the actual water quality model with the surrogate model mpcrm is possible only if the water quality model shows linear behavior therefore the linearity condition of the aquatox model needs also be evaluated for this purpose ten different sets of pollutant source characteristics are randomly generated similar to the ones given in table 1 after this process the resulting pollutant concentrations at monitoring points are determined by using these data as the input of the aquatox and mpcrm respectively by considering all the output parameters given in fig 4 results of the aquatox and mpcrm are compared in fig 5 as can be seen results of the mpcrm match almost perfectly the results of the aquatox model for each monitoring point this outcome indicates linearity and thereby the usability of the mpcrm as the surrogate water quality simulation model within the optimization process detailed information about this evaluation can be obtained from sadak 2019 4 allocation results in this section the allocation results of the proposed simulation optimization approach are presented note that the applicability of the proposed approach is evaluated by considering four different scenarios in terms of different load allocation weights ω i the weights used in these scenarios are given in table 3 considering these weights the proposed simulation optimization approach is executed by using b 1 10 b 2 10 and β i 1 i 1 2 3 n d during these executions the lower and upper bounds of the decision variables are set to c j m i n 0 and c j m a x 100 mg l j 1 2 3 n c and the optimization process is terminated when the absolute error between two successive iterations is lower than a tolerance bound of 10 10 for these parameter values the variation of the total pollutant loads for each grg iteration is given in fig 6 as can be seen from fig 6 all the scenarios start the search process from the same point and converge to different total pollutant load values which represent the highest possible load to the sub watershed without compromising the wqts while the biggest final load value is obtained for scenario 1 829 kg d the lowest is obtained for scenario 2 712 kg d note that all the scenarios required around 50 grg iterations to reach the solution for these final pollutant loads the identification results are compared in table 4 the results given in table 4 demonstrate the influence of the ω i values on the results of the allocated pollutant loads it is evident from scenario 1 results that pollutant loads are allocated equally between source locations since the same ω i values are used for each source unlike scenario 1 the pollutant loads in scenario 2 are allocated among source locations in proportion to the corresponding ω i values as an example case the allocated total ammonia as n loads of ps 1 and ps 4 are obtained as 2 511 and 10 041 in scenario 2 respectively as can be seen the allocated pollutant load of ps 4 is about 4 times larger than ps 1 since the value of ω 4 is 4 times large than ω 1 similar results are also obtained for scenario 3 and 4 such that the pollutant loads are allocated proportionally with the assigned ω i values after obtaining the load allocations for each scenario the resulting pollutant concentrations at monitoring points are checked if the desired wqt values table 5 it is evident from table 5 that the resulting concentrations for each pollutant do not exceed the corresponding wqts in each scenario in fact the resulting concentrations at upstream locations km 19 and km 20 are lower than the wqts for each pollutant this is an expected behavior since the resulting concentrations at these particular monitoring points are only affected by the pollutant discharges from ps 1 fig 3 in contrast the resulting n h 4 n h 3 n o 3 t p and c b o d 5 concentrations at km 22 are equal to the given wqt values for each scenario this is also an expected behavior since km 22 is a downstream location on the river and a cumulative influence of all source locations is observed at km 22 these results indicate that the proposed model allows the maximum possible pollutant discharge while keeping the water quality at a desired level note that the influence of different ω i values can also be seen from the resulting concentration values as an example case for scenario 2 ps 1 is assigned the minimum load allocation and therefore its influence observed at km 19 and km 20 are minimal compared to the influence of the other sources observed at km 22 5 sensitivity analysis as can be seen from the allocation results given above the proposed simulation optimization approach can effectively solve the multi pollutant wla problem for different load allocation scenarios since the results of the proposed approach are based on the selection of three model parameters e g b 1 b 2 β i a sensitivity analysis is conducted to determine the influence of these parameters to model results depending on the experiences during the development of the optimization formulation the following parameter values are used in the analysis b 1 1 10 100 1000 b 2 1 10 100 1000 β i 0 001 0 01 0 1 1 by considering these parameter values the problem is solved scenario 1 is taken into account for 4 3 64 different parameter combinations where variation of each parameter is taken account as indicated previously solution of the problem is conducted with parameter values b 1 10 b 2 10 and β i 1 and this solution is labeled as the base solution in order to evaluate the model performance the identified results have been compared to the base solution by means of the measure of centroid distance cd ayvaz and elci 2013 the mathematical definition of the cd measure for solution of the multi pollutant wla problem is explained as follows let cp j be the centroid of the j t h pollutant load which is specified for the base solution cp j k be the centroid of the j t h pollutant load which is specified for the k t h parameter combination j 1 2 3 n c k 1 2 3 64 x j and y j be the centroid coordinates of the j t h pollutant load for the base solution x j k and y j k be the centroid coordinates of the j t h pollutant load for the k t h parameter combination and x i and y i be the coordinates of the the i t h pollutant source i 1 2 3 n d depending on these definitions centroid coordinates of the j t h pollutant load are calculated as follows 11 x j κ i 1 n d q i j x i i 1 n d q i j 12 y j κ i 1 n d q i j y i i 1 n d q i j 13 κ base solution k k th parameter combination as can be seen from eqs 11 to 13 centroids coordinates of the j t h pollutant load are calculated by taking the weighted mean of the source locations with respect to the identified pollutant loads after this process centroid distance between k t h solution and the base solution is calculated as follows 14 cd j k x j k x j 2 y j k y j 2 1 2 where cd j k represents the centroid distance for the j t h pollutant load which is calculated by using the centroid coordinates of the k t h parameter combination and the base solution note that eq 14 states that the proposed model finds similar solutions when the value of cd j k approaches to zero after this process the proposed simulation optimization approach is executed for each parameter combination and the identified results are compared to the base solution in fig 7 for different pollutant parameters as can be seen although some centroid points are located very close to the base solution there are some points which are located far from the base solution this result indicates that the proposed approach is sensitive to some of the solution parameters in 64 different parameter combinations in order to determine the most sensitive parameters or parameter combinations the measure of cd j k j 1 2 3 n c k 1 2 3 64 is calculated for each released parameter and given in fig 8 as can be seen from fig 8 the maximum cd j k values are obtained about 4 743 m for the total ammonia as n 4868 m for the nitrate as n 2 652 m for the total soluble p and 5 093 m for organic matter respectively when the total ammonia n is taken into account it can be observed that the values of cd j k are very low until the 16th solution after this point a systematic behavior is observed such that the calculated cd j k values for 17th 21st 25th and 29th solutions group 1 are equal and significantly higher than the first 15 solutions similar systematical behavior can also be observed for 33rd 37th 41st 45th group 2 50th 54th 58th 62nd group 3 and 49th 53rd 57th 61st group 4 solutions respectively note that cd j k values for groups 1 to 4 are obtained about 1 823 m 4 742 m 4 743 m and 4 330 m respectively when these solutions and the corresponding data sets are evaluated in detail it is observed that b 1 and β i values are equal in each quartet groups mentioned above another interesting finding is that the ratios of b 1 β i are obtained as 104 for group 1 105 for groups 2 and 3 and 106 for group 4 respectively in this respect it is observed that the calculated cd j k values are obtained in the range of 0 and 367 50 m when the the ratios of b 1 β i are between 1 and 1 000 note that the value of b 2 does not have a significant effect on the calculated results for these quartet data combinations based on these results it can be concluded that the model provides different solutions than the base solution when the ratio of b 1 β i is greater than 1 000 note that similar results can also be observed for the other pollutant parameters given in fig 8 6 discussion and conclusions as can be seen from the identified results presented above the proposed simulation optimization approach can be used to solve the multi pollutant wla problems in surface water systems depending on the identified outcomes the following points can be addressed regarding the proposed simulation optimization approach one of the important features of the proposed approach is a new problem formulation which allows wla by weights for each point source different weightings can be useful in practice when an equal distribution of the total pollutant load is not possible because of wastewater treatment technology constraints or when an equal distribution of loadings is not fair concerning the position upstream versus downstream of the discharge according to the identified results all allocated pollutant loads are proportional with their weighting coefficients moreover it is worth noting that the formulation can only be used for point sources for other source types the proposed allocation approach cannot be used in its present form and should be modified another important conclusion of this study is the usefulness of the mpcrm approach in cases where multiple decaying pollutant parameters must be considered simultaneously as indicated previously this approach is based upon the principle of linear superposition which can only be used for linear water quality models however this linearity condition may not be satisfied for models where more interacting species of pollutants are simulated and consequently the fate and transport process of multiple pollutants may not be simulated by using the proposed mpcrm approach for such cases different nonlinear surrogate modeling approaches can be used rather than the mpcrm approach furthermore the grg optimization approach is gradient based and finding the global optimum solution may only be possible when the problem has a convex search space for problems with non convex search space finding the global optimum solution is only possible when good starting points are provided based on the trials it is observed that the proposed approach converges to the same objective function values when the problem is solved for different starting points this result suggests that the search space of the problem is convex in shape and the solution of the problem using the grg approach yields feasible results however this convex search space may change in case of the inclusion of additional constraints or decision variables for such cases global optimum solutions may not be obtained with the grg approach and application of heuristic optimization methods may be required credit authorship contribution statement derya sadak methodology software formal analysis writing original draft visualization m tamer ayvaz conceptualization methodology software formal analysis writing original draft writing review editing visualization alper elçi conceptualization methodology validation formal analysis writing original draft writing review editing visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this study is funded by the scientific and technological research council of turkey tubitak under project number 116y413 116y414 116y415 
5231,the nonlinear flow behavior in a single rock fracture srf has been studied for decades however the existing models to link fracture geometries and nonlinear flow behavior are less accurate due to insufficient characterization of fracture geometries the primary goal of this study is to propose new parameters to characterize the geometric characteristics of a srf and then to evaluate the nonlinear flow behavior in a srf a series of high precision hydraulic tests are conducted on 50 mated and unmated artificial fractured samples the results show that forchheimer equation adequately describes the nonlinear fluid flow through a srf with rough walls and variable apertures and its nonlinear coefficients can be determined by quantifying the fracture geometries by introducing the concept of a threshold aperture meaning that only those zones with greater apertures than a threshold value are involved in the flow process the heterogeneity of aperture distribution is quantified based on the cumulative distribution of individual apertures of sampling points in addition the influence of surface roughness on the nonlinear flow in a srf is quantified with the standard deviation of secondary roughness lastly an equation that relates the nonlinear coefficient to the newly proposed geometrical parameters is arrived which is further used to link the friction factor nonlinear flow model and critical reynolds number with the fracture geometric characteristics the newly proposed equations in this study predict and characterize the nonlinear flow characteristics in a srf very well keywords rock fracture fracture geometries nonlinear flow forchheimer equation 1 introduction rock mass in natural geological setting is composed of rock matrix and fractures the presence of fractures can drastically affect the hydraulic properties of rock mass due to their typically much greater permeability comparing with rock matrix chen et al 2015 liu et al 2018 understanding fluid flow in rock fractures is of great concern in numerous geophysical hydrological environmental and geotechnical engineering activities such as geothermal extraction zhao et al 2015 oil or natural gas exploration camac et al 2006 zhao et al 2004 contaminant pollution control qian et al 2011b noiriel et al 2013 hazardous wastes isolation nowamooz et al 2009 etc although the topic has been widely studied in recent decades it is still very difficult to accurately describe the flow processes through individual fractures due to the complicated fracture geometries chen et al 2017 2019 the navier stokes ns equations can accurately describe the flow process in a single rock fracture srf zimmerman and bodvarsson 1996 however the computational cost of solving the ns equations in practice is significant and sometime untenable partially because of the complexity arising from the nonlinear partial differential equations coupled with velocity and pressure fields in a srf with complex geometry brush and thomson 2003 therefore a rough fracture with variable apertures was regarded as smooth parallel plates in earlier studies snow 1969 and the well known cubic law which is a form of the hagen poiseuille equation in a srf was yielded zimmerman and bodvarsson 1996 in this simplified model the flow rate is proportional to the cubic power of the separation between the plates however a typical natural srf is generally complex in geometries with rough walls and variable apertures instead of smooth and parallel fracture surfaces when the surface roughness needs to be considered the cubic law is assumed to hold locally walsh 1981 with this in view the cubic law can be modified with separation between the plates being replaced by hydraulic aperture however neither the cubic law nor the modified cubic law can correctly describe the flow behavior in a srf it was found from previous studies on fracture flow that darcy s law or linear flow was only validated in low rate laminar flow furthermore the flow could exhibit a nonlinear phenomenon even under the laminar flow regime when the applied pressure flow rate became sufficiently large witherspoon et al 1980 kohl et al 1997 yeo and ge 2001 wen et al 2006 zhang and nemcik 2013b zou et al 2017 zhou et al 2019 there are a few reasons that can trigger nonlinear flow in a srf zimmerman and bodvarsson 1996 emphasized that the roughness contact areas and tortuosity may cause variations in flow velocity and flow direction because of constrictions and obstructions and initiation of turbulence due to localized eddy flow formation these features may result in nonlinear flow in a srf similar conclusions were also reached from experiments and numerical works by different investigators zimmerman et al 2004 zhou et al 2015 zou et al 2017 xiong et al 2018 recently nonlinear flow in a real srf with variable apertures have been extensively investigated both empirically ranjith and darlington 2007 qian et al 2011a zou et al 2015 zhang et al 2015 zhou et al 2015 zhou et al 2016 li et al 2016 and numerically zimmerman et al 2004 zou et al 2017 zhou et al 2020 their studies suggested that the forchheimer equation describes the nonlinear relation between pressure gradient and volumetric flow rate satisfactory in many cases meanwhile the well known darcy weisbach equation white 2003 which describes the pressure head loss in the flow process from the perspective of flow friction resistance is also widely used in practice based on these equations many researchers made great efforts to investigate the nonlinear flow in a srf by considering the total dilation rong et al 2016 2018 the normal confining stress zhang and nemcik 2013a b zhang et al 2015 chen et al 2015 zhou et al 2016 chen et al 2019 and the fluid slippage zhou et al 2020 etc it can be seen that the nonlinear flow in a srf is closely related to the shear displacement and confining stress in fact the underlying mechanism behind it can be ascribed to the fracture geometry properties varying with these conditions chen et al 2019 therefore it is extremely important to properly quantify the influence of fracture geometries on nonlinear flow in a srf a point to note is that the fracture geometries include not only the surface morphology of fractures but also the aperture field in a fracture each of which alone is not sufficient to represent such an influence chen et al 2019 in this study the influences of both surface morphology of fractures and the aperture field on the nonlinear flow are taken into account therefore the fracture geometries mentioned in this study include both the surface morphology and the aperture field in a fracture it has been confirmed by previous works zimmerman and bodvarsson 1996 xiong et al 2011 zhang and nemcik 2013b zou et al 2017 that fluid flow and solute transport processes in fractured rock masses are highly sensitive to the aperture distribution and the surface roughness thus quantitative characterization of the heterogeneity of variable aperture distributions and surface roughness is a starting point for a better interpretation of fluid flow and solute transport in a srf over the past decades a large body of research has been published on the geometric characteristics of a srf some geometrical parameters such as the peak asperity of surface profiles fractional contact area etc were taken into consideration in describing the coefficients of the forchheimer equation chen et al 2015 xiong et al 2018 and the friction factor of the darcy weisbach equation chen et al 2009 zhang and nemcik 2013a zhang et al 2015 zhou et al 2016 to describe the nonlinear flow in a srf according to the definition of the peak asperity of surface profiles proposed by chen et al 2015 quantification of this term only focuses on the maximum and minimum asperity height of some profiles which is not sufficient to characterize the entire fracture surfaces furthermore although there is a certain correlation between the contact area and the tortuosity of flow paths this parameter cannot adequately represent the heterogeneity of variable aperture distributions as the contact area only accounts for a small part of the fracture surface even if there were no contact fluid flow might still take tortuous pathways in a srf under the influence of variable apertures zou et al 2017 for describing the roughness of rock joints many parameters such as fractal parameters brown 1987 xie 1993 odling 1994 statistic parameters myers 1962 thomas 1981 grasselli et al 2002 and joint roughness coefficient jrc barton and choubey 1977 have been proposed such parameters have improved our understanding of the roughness of fracture surfaces however most of these parameters were proposed to investigate the shear properties of rock joints thus they may not be suitable for evaluating the effect of surface roughness on flow in a srf a positive sign to note is that a number of studies pertaining to the effect of roughness on flow in a srf have been reported recently for instance zou et al 2015 and wang et al 2016 studied the effects of roughness on fluid flow in a srf through flow simulations in a series of two dimensional 2d and three dimensional 3d models of rough fractures however these studies did not present any quantitative indicators on flow mechanism in a srf when the fracture surface roughness is of concern with respect to the quantification of the heterogeneity of variable apertures the box counting fractal dimension d of the interconnected void areas was proposed by chen et al 2017 2019 however this method is too complicated to give a set of computational procedures for all fracture surfaces based on the coordinate data of the fracture surface aiming at above issues the primary motivation of the present study is to quantitatively evaluate the influence of fracture geometries on nonlinear flow behaviors in a srf based on newly available experimental observations made by the authors in the present research the effect of variable aperture distributions and surface roughness on fluid flow in a srf is characterized by two parameters the parameter c related to the threshold aperture and the standard deviation σ ii of the secondary roughness both will be explained in details later a series of high precision hydraulic tests have been conducted on both mated and unmated artificial fractured samples based on the test results some empirical models relating those proposed two geometrical parameters with indexes characterizing fluid flow nonlinear coefficient friction factor and critical reynolds number are further employed to study nonlinear flow characteristics in a srf 2 theories relevant to this study the flow of an incompressible newtonian viscous fluid in a srf is governed by the navier stokes ns equations which are derived from the newton s second law for the steady state fluid flow the ns equations can be expressed as zimmerman and bodvarsson 1996 xiong et al 2011 zou et al 2017 1 p μ 2 u ρ u u 2 u 0 where u is velocity vector ρ is fluid density p is pressure and μ is dynamic viscosity coefficient eq 2 is the continuity equation which is complementary to eq 1 representing a conservation of mass it can be seen from eq 1 that the pressure losses are composed of viscous dissipation the first term and inertial losses the second term in the certain case that the reynolds number is low enough the inertial forces are negligible compared to the viscous forces then eq 1 is simplified as 3 p μ 2 u eq 3 is the well known stokes equation which is a set of linear equations although the computational burden has been greatly reduced it is still very hard to solve the stokes equation for practical problems for smooth parallel plates that are separated by a small aperture it is reasonable to assume that the velocity is parallel to pressure gradient the following cubic law is obtained by integrating both sides of eq 3 4 q w e 3 12 μ p where q is the volumetric flow rate e is the aperture of the idealized parallel smooth fracture and w is the width of the fracture which is normal to the direction of fluid flow for fluid flow in a rough fracture the aperture e would be replaced by hydraulic aperture e h which is defined as an equivalent smooth fracture possessing the same water conducting capacity with its original rough fracture zimmerman and bodvarsson 1996 brush and thomson 2003 konzuk and kueper 2004 therefore e h is variable and decreases as the flow rate increases due to the nonlinear effect which may be induced by the complicated geometries and the increased flow rate in this study the same approach in nowamooz et al 2009 chen et al 2015 2019 is adopted in this way e h only represents the intrinsic hydraulic aperture of the fracture which could be inversely calculated with eq 4 in laminar flow regime in which the inertial forces are negligible compared with viscous forces hence the e h term used in this study is a constant independent of the varying flow rates and only determined by the given fracture to characterize the nonlinear flow behavior in a rough fracture with variable aperture distributions numerous empirical and theoretical equations have been proposed in which the forchheimer equation is the most widely used one zhang and nemcik 2013b chen et al 2015 qian et al 2019 5 p a q b q 2 6 a μ kw e h 12 μ w e h 3 b β ρ w 2 e h 2 where a and b are the coefficients representing viscous and inertial effects respectively k is the intrinsic permeability defined as e h 2 12 and β is called the nonlinear coefficient or the inertial resistance at sufficiently low flow rates the pressure losses induced by the inertial effect the second term on the right hand side of eq 5 are negligible compared with the viscous effect which would lead to the forchheimer equation reduces to darcy s law eq 4 on the contrary for fluid flow with sufficiently high flow rates the pressure losses induced by the viscous effect the first term on the right hand side of eq 5 could be vanished it shows that the flow has transited into a turbulent flow regime where the inertial effect is dominating qian et al 2005 tzelepis et al 2015 meanwhile the pressure losses in the process of flow in a srf are also characterized widely by the darcy weisbach equation white 2003 which reads 7 p f 1 d h ρ v 2 2 where f is the friction factor d h which equal to 2 e h is the characteristic dimension of the fracture and v is the mean flow velocity the reynolds number re which characterizes the flow regimes is defined as the ratio of the inertial force against the viscous force and can be written as zimmerman et al 2004 8 re ρ u e h μ ρ q μ w where u is the average velocity it has been well understood that the friction factor f can be related to the flow regimes and the fracture geometries white 2003 chen et al 2009 qian et al 2011a zhang and nemcik 2013a zhou et al 2016 at sufficiently low reynolds number the flow in a srf can be described by cubic law eq 4 then combining eqs 4 7 and 8 f 48 re can be derived for fully developed turbulent flow the pressure losses induced by the viscous effect could be vanished combining eqs 5 and 7 and using the relations a 0 and b β ρ w 2 e h 2 one can obtain f 4 e h β by incorporating the forchheimer equation zhou et al 2016 proposed that the friction factor is equal to the sum of components due to the viscous and inertial effects respectively and the following expression was developed 9 f 48 re 4 e h β above equation has a clear physical significance and would be used in this study to quantitatively evaluate the flow behavior in a srf 3 experimental methodology and results 3 1 specimens preparation and measurement to investigate the flow behavior in a srf it is best to use natural fractures however it is difficult to get enough fractured samples for laboratory tests therefore the tensile fractures are used as alternatives in this study the fresh tensile fractures used in the study are made by splitting from granite samples which are collected from dabieshan anhui province of china the processes for making tensile fractures are as follows firstly the natural granite samples are cut into cubic samples with 200 mm 100 mm 100 mm then these cubic samples are fixed in a self design mold to ensure that the normal load acts on the middle of the rock sample finally the normal load is applied along the loading line with a normal velocity of 0 3 mm min until the tensile fractures are made more details regarding the brazilian splitting technique can be found in yang et al 2016 fifty representative single fractures with different roughness are selected and numbered from g1 to g50 to quantify the effect of fracture geometries on fluid flow the first step is to precisely measure the fracture geometries a 3d morphology scanner system composed of a scanning camera a projection lens and a scanning controller is utilized here to measure the fracture surface topography and aperture distribution see fig 1 such a scanner system offers the advantages of high measurement speed high precision and favorable repeatability the resolution of a sampling point can achieve a precision up to 10 µm in this study both mated and slightly offset granite fractures are adopted in the flow tests for examining the possibly different flow behaviors in fractures with different mated states taking a typical sample g1 as an example the measurement of its geometric characteristics mainly includes two processes of scanning and stitching see fig 2 first of all the fracture is fixed with a slight offset 1 mm between the upper and lower surfaces and then marking points are pasted on the fronts of the upper and lower fractured rock halves after that these marking points are scanned with the scanner system to record their relative positions the purpose of using marking points here is to ensure that the srf can be completely reconstructed to its previous position after scanning the fracture surfaces subsequently the upper and lower surfaces of the fractured rock sample are scanned and digitized separately the topographical data of each surface are obtained with an interval of 0 1 mm in both x and y directions where x and y are along the long and short sides of the surface respectively it is worth noting that the average fluid flow direction in the following flow experiments is along the x axis also after finishing the scanning process the data of the upper and lower surface topography are put in the same coordinate system according to the marked points at last the aperture distribution is calculated with the coordinate data of the upper and lower surfaces in the same coordinate system 3 2 water flow experiment after measuring the aperture distribution and the surfaces morphology all the selected cuboid fractured samples with different mated states are used to conduct water flow tests a notable point is that the aperture field is a result of two rough surfaces in contact which is subject to change when different stresses are acting on the fracture this may cause an inaccurate aperture field measured by morphology scanners because the elastic and or elastic plastic deformation of asperities are not taken into account to circumvent the problem in all the experiments conducted in this study the specimen is not fixed by applying normal stress but by two bolts the bolts provide the constrained force to prevent the fracture from dilation due to water pressure in this case the elastic and or elastic plastic deformation of asperities is negligible the experiments are performed in the state key laboratory of water resources and hydropower engineering science wuhan university china with a room temperature 25 c and the density and dynamic viscosity of water are ρ 0 997 103 kg m3 and μ 0 89 10 3 pa s respectively here the self designed fracture flow testing system which consists of an isco pump 500d with an injection rate ranging from 0 to 204 ml min and a specially designed flow apparatus is employed as indicated in fig 3 before testing the lateral sides of these fractured samples are sealed with silicone rubber to ensure unilateral flow in the fracture first and then two specially designed rectangular tanks made of polyurethane are mounted on the inlet and outlet of the fractured sample to ensure even distribution of water pressure over the inlet of the sample and to collect the fluid discharge subsequently the fractured sample is placed in a specially designed experimental box and fixed with two bolts this design can ensure that the aperture distributions do not change in testing after a watertight test distilled water is injected from the servo controlled fluid pump to the inlet tank mounted on the test sample and it then flows through the fracture and finally exit via the outlet tank for each sample a total of 10 water flow tests with 10 different flow rates are performed each flow test starts with a given inlet flow rate and the applied flow rate q ranges from 0 to 200 ml min the differential pressure between the inlet and outlet of the sample is continuously recorded by a differential pressure gauge connected to both tanks in order to ensure the measurement accuracy as much as possible three different specifications of differential pressure gauges are used in this study their maximum test pressures are 2 5 kpa 35 kpa and 1 mpa respectively with the corresponding precisions of 0 001 kpa 0 01 kpa and 1 0 kpa for most given inlet flow rates the one with a maximum test pressure of 35 kpa and a precision of 0 01 kpa is used 3 3 experimental observations in the study a number of 500 flow tests are conducted on the 50 fractured samples each sample has 10 tests with different flow rates with different fracture geometries a total of 1000 data points including the pressure gradient and flow rate corresponding to different fracture geometries have been collected and analyzed which are anticipated to provide a statistically valid dataset to justify the problem of concern information about flow behavior can obtained from the relationship between the pressure gradient p and flow rate q fig 4 presents the results of flow tests in 50 fractured samples it can be seen that the pressure gradient rises up linearly with increasing flow rate at the beginning and then the pressure gradient increases with the flow rate in a super linear fashion indicating the nonlinear flow occurrence the dash line in fig 4e represents the predicted curve using darcy s law it is found that darcy s law will overestimate the flow rate at the same pressure gradient due to the nonlinearity of the flow with the increase of the pressure gradient the nonlinearity becomes more evident the main reason for the emergence of nonlinear flow is that the high water velocities have substantially enhanced the inertial forces which become increasingly important and non negligible as compared to the viscous forces in this case a larger injection pressure is required to obtain the corresponding volumetric flow rate as compared to what is required for the same flow rate under the linear flow darcy s law or cubic law scenario as also plotted in fig 4 the best fitting curves using a zero intercept quadratic polynomial show that the forchheimer equation describes the nonlinearity of the fluid very well for each fractured sample the linear and nonlinear quadratic coefficients in the forchheimer law are gained by performing best fit regression using eq 2a and the results are presented in table 1 the value of a represents the intrinsic permeability of the fracture and the coefficient b can be regarded as a vital parameter to describe the nonlinear flow chen et al 2015 2019 as mentioned before some samples have well matched surfaces and others are offset by different distances in this study our primary objective here is not to perform an exhaustive analysis for the matching state but to obtain different fracture geometries therefore the offset of samples is random and the distance of offset is not recorded in addition unlike the usual shear flow experiments water flow experiments are not conducted on the same sample at different offsets but each sample may have a different displacement distance in this study this makes it almost impossible to accurately evaluate the influences of the matching state on the nonlinear flow behavior because the effect of the fracture surface roughness is not excluded in this study the same rock type is used to conduct experiments under the same conditions so it can be assumed that the degrees of large scale waviness of these fracture surfaces obtained are generally consistent in this case the matching degree may be related to the mechanical aperture of the fracture according to the shear characteristics of rock joints in the laboratory javadi et al 2014 yang et al 2016 a larger mechanical aperture generally corresponds to a longer distance of offset and a smaller matching degree therefore by analyzing the flow behavior in samples with different mechanical apertures the influences of the matching state on the nonlinear flow behavior can be indirectly investigated and discussed fig 5 presents variations of coefficients a and b with the mechanical aperture e 0 as shown in fig 5 the variation patterns of coefficients a and b are very similar both coefficients show an abrupt reduction at first and then decreases gradually to attain a somewhat constant value for mechanical apertures exceeding 0 7 mm the variation pattern is generally consistent with the results obtained in javadi et al 2014 in which the role of shear processes on nonlinear flow rock fractures was discussed indicating that it is reasonable to qualitatively estimate the matching state effect through the mechanical aperture at each mechanical aperture the value of b a which can be viewed as the ratio of nonlinear to linear pressure losses at unit flow is calculated to evaluate the nonlinearity variation of b a with mechanical aperture is shown in fig 6 it can be seen that the scatter points are widely distributed which can be attributed to the influence of fracture surface roughness in general the value of b a shows a descending variation with the increasing mechanical aperture indicating that the nonlinearity of fluid flow decreases with the increasing offset distance or matching degree this is because although the offset reduces the matching degree between the two fracture surfaces it also increases the probability of the connectivity of large apertures matsuki et al 2006 javadi et al 2014 it should be noted that here we only qualitatively discuss the influence of matching state in an indirect manner in the future more targeted experiments are needed to intuitively analyze the matching state effects the hydraulic behavior is greatly associated with the equivalent hydraulic aperture e h which could be estimated with the cubic law when the flow rate is small to connect the mechanical behavior of fractures to their hydraulic behavior the relation between the mechanical aperture and the hydraulic aperture is shown in fig 7 the red line in the figure represents that the mechanical aperture is equal to the hydraulic aperture and the blue line is the best fitting curve with a zero intercept linear equation it can be seen that the hydraulic apertures e h are smaller than the mechanical apertures e 0 due to the influence of the fracture geometry in general e h is proportional to e 0 however many points deviate from the fitting curve as a result of difference in geometrical characteristics of these fractures it can be seen from eq 6 that the flow behavior in rock fractures is associated with the cubic of e h indicating that small deviations in e h will also produce large errors in flow behavior therefore the fitting formula in fig 7 is not recommended to predict e h to further quantitatively evaluate the effect of fracture geometry on e h the dimensionless number 1 e h e 0 for each fracture is calculated fig 8 represents the variation of 1 e h e 0 with mechanical aperture e 0 it can be seen that the scatter points are widely distributed indicating that the fracture geometry of each fracture is different in addition it also can be observed that the value of 1 e h e 0 decreases with increasing e 0 and gradually attains a somewhat constant value indicating that the larger e 0 is the smaller the influence of fracture geometry on fluid flow in a srf will be in order not to deviate from the main purpose of this study no attempt is made to evaluate how the fracture geometry affects the hydraulic aperture e h instead all e h used in this study is calculated with the cubic law when the flow rate is small in summary the forchheimer equation describes the nonlinearity of the fluid very well the coefficients a and b in the forchheimer equation are closely associated with the fracture geometric characteristics it can be seen from eq 6 that the coefficient a has an explicit expression that is inversely proportional to the cube of e h while few general expressions for b considering the fracture geometries effect has been reported yet this is because quantification of the fracture geometry effect on nonlinear flow in a srf is still largely unknown which would be discussed in details in the following 4 representation of fracture geometric characteristics as is mentioned before a natural rock fracture is characterized by rough surfaces and variable aperture distributions resulting in complex geometries therefore we mainly focus on the characteristics of variable aperture distributions and surface roughness in this study by considering their influence on nonlinear flow in a srf the complexity or heterogeneity of fracture geometries is discussed and quantified with two geometric parameters the parameter c related to the threshold aperture and the standard deviation σ ii of the secondary roughness which are explained in details in the following subsections 4 1 heterogeneity of aperture distribution this section aims to quantify the heterogeneity of aperture distributions of a fracture therefore only the projection surface of the fracture surface on the horizontal plane is analyzed without considering the surface roughness the projection surface can be thought of as consisting of a number of squares centered on the sample points whose apertures are measured in advance under the influence of variable aperture distribution the fluid flow in a srf will take tortuous pathways in this case the streamlines in the fracture are not generally homogenous with paralleled lines along the principal flow direction but concentrated in a few fast flowing channels with greater apertures inside the fracture of concern xiong et al 2011 cheng et al 2017 zou et al 2017 channeling flow is an important phenomenon in fracture flow and seems to play a primary role in enhancing the nonlinearity of fluid flow cheng et al 2017 zhou et al 2015 zhang and nemcik 2013b there are a few reasons which can cause the channeling flow one of them is that there are some randomly distributed contacting regions in the fracture it could lead to increasing tortuosity of flow paths because fluid flows in the fracture must move around these contact areas cheng et al 2017 xiong et al 2018 besides since pressure drop in the flowing process is extremely sensitive to the aperture inversely proportional to the cubic of aperture fluid flow in a variable aperture fracture under saturated conditions will tend to follow paths of the least resistance i e paths of the largest aperture zimmerman and bodvarsson 1996 it can be seen from above analysis that not all the surface is involved in transmitting fluid flow the more complex the aperture distributions are the more obvious the channeling flow phenomenon will be therefore we can assume that only those zones with apertures greater than a threshold value which is unique for a specified aperture distribution are involved in the flow process in a srf in this way it is possible to discriminate the fraction of surface that might be involved in transmitting flow as a function of a threshold value e this fractional area is referred as the normalized area a which is defined as the area of the surface with an aperture greater than a selected threshold value normalized with respect to the total area of the surface at the heterogeneity of aperture distribution can be evaluated by comparing the cumulative distributions of a this method is analogous to the analysis of surface roughness conducted by grasselli et al 2002 to study the relationship between the normalized fractional area a and the corresponding minimum aperture e the digitized aperture data are used to calculate a for several values of e from 0 mm to maximum in which a total of 50 threshold aperture values for each fracture are selected this process is similar to sieving analysis which is widely used to determine the cumulative grain size distribution of soil in geotechnical engineering taking fractured sample g33 as an example the relation between the normalized area a and threshold aperture e is obtained and shown in fig 9 it can be seen that the change of a shows an inverse sigmoid curve as the threshold aperture e increases the normalized area a decreases from 1 to 0 and the decreasing rate increases first and then decreases and finally slowly approaches 0 to quantify the relationship between a and e the following equation is adopted to best fit the data after testing numerous functions by the authors solid line in fig 9 10 a 1 1 e e 0 c where e 0 is the mean mechanical aperture and c is a dimensionless fitting parameter calculated via a nonlinear least square regression analysis the best fitting results of other fractured samples are listed in table 1 it can be seen that eq 10 provided satisfactory fits to the data with a coefficient of determination r 2 ranging between 0 933 and 0 999 for a certain given fracture the mean mechanical aperture e 0 is a constant it can be seen from eq 10 that the relationship between a and e only depends on the parameter c to make it clear what the parameter c stands for the lines defined by eq 10 with e 0 0 700 and different values of c are also plotted in fig 9 dotted line it is observed that with constant e 0 the value of c controls the slope of the curve a larger c value means a steeper curve and a wider distribution this implies that the aperture distribution with a larger c value has a relatively lower degree of heterogeneity for a fixed e 0 a value of c approaching infinity is indicative of a fracture with an identical aperture at every point in the sense that there is no channeling flow phenomenon in the fracture and fluid flow in the fracture has the smallest nonlinearity therefore the fitting parameter c is suggested to characterize the complexity or heterogeneity of the aperture distributions 4 2 surface roughness as is mentioned before in addition to the channeling flow caused by the variable aperture distributions the fracture surface roughness is also an important reason for the nonlinearity of fluid flow in a srf to quantitatively characterize the relationship between the nonlinearity and the surface roughness it is important to understand how the surface roughness influences the fluid flow in a srf from a rigorous physical perspective by conducting numerical simulations zou et al 2015 and wang et al 2016 systematically investigated the impacts of surface roughness on the nonlinear fluid flow in 2d and 3d rough fractures respectively specifically they decomposed the surface roughness into primary roughness i e the large scale waviness of fracture morphology and secondary roughness i e the small scale unevenness with a wavelet analysis which is also adopted in this study their results showed that the nonlinear properties of the fluid flow are mainly caused by the secondary roughness rather than the primary roughness therefore it is necessary to quantify the secondary roughness which obeys a gaussian distribution with an average value closes to 0 as a random process of white noise zou et al 2015 pointed out that the secondary roughness will form a thin boundary layer with nonlinear dynamic eddy flow over the whole domain therefore the effect of the secondary roughness on the nonlinear properties of the fluid flow through a srf can be quantified by comparing the intensity or standard deviation of the secondary roughness this method is also widely used to evaluate the turbulence intensity of flow in hydraulics therefore we recommend using parameter σ ii the standard deviation of the secondary roughness to represent the effect of the surface roughness on nonlinear fluid flow in a srf in this study more details regarding the method for surface decomposition and reconstruction can be found in wang et al 2016 taking a 2d profile as an example the primary roughness secondary roughness and σ ii are shown in fig 10 the values of the parameter σ ii for all the selected fractured samples are computed and listed in table 1 it should be noted that σ ii is the sum of the standard deviation of the upper and lower surfaces i e σ ii σ ii u σ ii l where the superscripts u and l represent the upper and lower surfaces respectively apparently a higher value of σ ii corresponds to the fluid flow in a srf with a stronger nonlinearity we should note that the fluid flow is essentially controlled by the aperture field in other words what the parameter σ ii actually quantifies is the influence of local changes of the aperture field on the flow behavior in a srf therefore we can decompose the aperture field into large scale components and small scale components with a wavelet analysis the standard deviation of the small scale components of the aperture field may also be a reasonable parameter to represent such an influence in this study we select the standard deviation of the secondary roughness instead of the small scale components of the aperture field mainly for the following reasons firstly the influence of the secondary roughness on fluid flow and solute transport in rock fractures has been extensively investigated in recent years zou et al 2015 wang et al 2016 dou et al 2018 2019 the use of parameter σ ii is aligned with these previous research results and has a clear physical meaning secondly compared with the aperture field it is much easier to obtain the surface morphology information of a fracture therefore the parameter σ ii is more likely to be applied in the field and laboratory it should be noted that the standard deviation of the secondary roughness is subject to change when elastic deformation or damages occur on asperities and this issue is out of the scope of this study 4 3 test of proposed parameters in sections 4 1 and 4 2 we proposed two parameters for quantifying the heterogeneity of aperture distribution and surface roughness respectively by considering their effects on nonlinear flow behavior in a srf to examine the reliability of the proposed parameters the commercial finite element software package comsol multiphysics is employed to simulate the fluid flow on a few selected cases by solving the navier stokes ns equations the results of simulations are illustrated as follows 4 3 1 the parameter c as is mentioned above the parameter c represents the complexity or heterogeneity of the aperture distributions to quantify the parameter c the digital surface of the fracture sample g2 is used as the parent surface and three fracture models with different aperture distributions are generated the scanned surface is lifted upwards in the vertical direction i e z direction with a value of 1 mm firstly afterwards a series of shear displacements d 0 5 1 2 mm are applied to the upper surface to generate three artificially sheared fractures at last for each sheared fracture a 25 mm 50 mm section is selected from the created fracture to form the fracture models for the consideration of computational efficiency in solving partial differential equations with high accuracy i e models m1 m3 taking fractured model m3 as an example the digital surface and the approach of creating the fracture model are illustrated in fig 11 note that this numerical shear is not to simulate a shearing process but to construct fracture models with different aperture distributions based on the method proposed in section 4 1 the calculated values of parameter c for three fracture models are listed in table 2 for each model triangular meshing is used over the fracture model considering the adaptability of rough joints the inlet boundary conditions are specified with different values of constant flow rates the outlet boundary condition is set as zero pressure and the rest fracture walls are set as non slip boundaries three laminar entrance inflow conditions with different reynolds number re 1 10 and 100 are applied for each fracture model fig 12 presents the simulated streamlines under the exemplified case with re 100 for three fracture models it can be seen that the streamline distributions of model m1 is generally homogenous with paralleled lines along the principal flow direction but that of m2 shows slight channeling due to variable apertures for model m3 the streamline distributions are strongly channelized with significant tortuosity dominated by the heterogeneity of aperture distribution created by shear despite the fact that the degrees of surface roughness of the three models are identical one can see that the parameter c is associated with the tortuosity of streamline distributions fluid flow in the fracture with a relatively high value of c leads to less tortuous streamlines the ratio of nonlinear to linear pressure losses is further used to evaluate the degree of nonlinearity of the fluid flow and can be expressed as 11 f p non p lin p sim p lin 1 where p lin is the linear pressure loss which can be calculated with the cubic law p non is the nonlinear pressure loss and p sim is the total pressure loss calculated from the simulation to calculate p lin under different flowrates the equivalent hydraulic aperture e h is determined in advance with the cubic law using the total flow rate through the fracture and the pressure gradient between the inlet and outlet when re 1 after that the values of f for three fracture models are calculated and listed in table 2 it can be seen that fluid flow in the fracture with a relatively high value of c corresponds to a low degree of nonlinearity indicating that the parameter c can characterize the heterogeneity of aperture distribution well 4 3 2 the parameter σ ii as mentioned above the surface roughness is decomposed into primary roughness and secondary roughness and the standard deviation of the secondary roughness σ ii is suggested to represent the effect of the surface roughness on nonlinear fluid flow in a srf in this study this section is to investigate whether it is reasonable to rule out the contribution of the primary roughness to the development of nonlinearity in the assessment to serve this purpose two fracture models m4 and m5 one with and another without the secondary roughness are generated for simulations so that the secondary roughness effects can be clearly demonstrated by comparison between results from the two models in this section a 25 mm 50 mm section of the decomposed primary waviness from the fracture sample g2 is used as the parent surface to eliminate the effect of the aperture distributions on the nonlinear flow behavior no shear step is applied to the upper surface i e d 0 for the two models the first model m4 is built by numerically lifting the parent surface upwards in the vertical direction i e z direction with a value of 0 25 mm this relatively small mechanical aperture is used here to highlight the effect of roughness the second model m5 is built numerically by superimposing the secondary roughness decomposed from upper and lower surfaces of the fracture sample g2 on the primary waviness after the same lift step used for building model m4 the lower surfaces of m4 and m5 are shown in fig 13 the initial and boundary conditions of the two models are the same as models m1 m3 built in section 4 3 1 based on the numerical simulation results the values of f for models m4 and m5 are calculated and listed in table 2 it can be seen that the secondary roughness significantly enhances the nonlinearity of the fluid flow in the fracture specifically the value of f for fluid flow in model m4 is about one magnitude smaller than that in model m5 indicating that the nonlinearity induced by the primary roughness is negligible compared to the secondary roughness therefore the contribution of the primary roughness to the development of nonlinearity is not considered in this study 5 quantitative characterization of the nonlinear flow the above analysis presents two parameters c and σ ii which characterize the geometric characteristics of a srf to quantify the effect of fracture geometric characteristics on the nonlinear flow in a srf an equation that relates the nonlinear coefficient to these proposed two geometrical parameters is arrived on this basis the friction factor nonlinear flow model and the critical reynolds number re c are also associated with these two parameters to characterize and predict the nonlinear flow characteristics the reliability of these proposed equations is examined based on the test results 5 1 friction factor of water flow in a srf it can be seen from eq 9 that the friction factor is associated with the nonlinear coefficient β which depends only on the geometrical properties of the media zeng and grigg 2006 cherubini et al 2012 as well as the reynolds number establishing the relationship between the nonlinear coefficient and the geometric characteristics of the fracture is an important step to accurately evaluate the friction factor in the flow process over the past several decades extensive researches on the nonlinear coefficient have been conducted and numerous equations have been proposed among which the equation proposed by louis 1969 has been widely used for the characterization of the nonlinear flow in practice chen et al 2019 12 β 1 8 e h log s log ξ 2 e h 2 where s is a dimensionless coefficient dependent on the surface roughness index defined as ξ 2 e h and ξ is the peak asperity of surface profiles based on eq 12 one can conclude that β 1 e h log ξ 2 e h b as is mentioned above the parameter ξ is limited to discrete feature points of profiles of fracture which is not sufficient to characterize the entire fracture therefore to better characterize the effect of roughness on nonlinear flow the parameter ξ is replaced by σ ii besides the variable aperture distribution effect has not been considered in eq 12 thus the parameter c which is suggested to characterize the complexity or heterogeneity of the aperture distributions is added into the expression for nonlinear coefficient β the similar method is also used by chen et al 2019 according to the analysis in section 4 1 fluid flow in the fracture with a larger c value has a relatively lower degree of nonlinearity which causes a lower value of β as well therefore the form of 1 c is used and a new expression for nonlinear coefficient β is suggested as follows 13 β a 1 c e h log σ 2 e h b where a and b are dimensionless regression coefficients and can be regarded as the correction factor in this form of expression it is noted that eq 13 is not a theoretical expression but an empirical expression therefore other forms of expression with different correction factors may also be possible the present form is adopted mainly for the following reasons first of all we hope to make the new expression obtained as simple as possible on the basis of eq 12 which will help the expression to be applied in practical projects secondly this form of expression can ensure its dimensional consistency since the nonlinear coefficient β is in dimension of l 1 e h and σ ii are in dimension of l and c is a dimensionless parameter as mentioned in section 4 1 according to eq 12 we can speculate that a 0 and b 0 which are confirmed in the analysis below for a smooth parallel plate c and σ ii 0 in this case one can obtain β 0 based on eq 13 indicating that this form of expression encompasses the idealized condition assumed in the smooth parallel plate model combining eqs 9 and 13 yields an expression for friction factor f as a function of e h c and σ ii 14 f 48 re 4 a 1 c log σ 2 e h b π this equation adequately considers the influences of the variable aperture distributions and surface roughness on the fluid flow in a srf the dimensionless coefficients a and b are no longer dependent on the fracture geometries and hence eq 14 can be conveniently integrated into computational fluid dynamics and groundwater simulations under variable flow regimes the friction factor corresponding to different flow regimes for water flow in all the fractured samples are calculated with the darcy weisbach equation based on the raw flow data obtained from laboratory tests to determine the regression coefficients a and b independent of the fracture geometries in eq 14 fig 14 shows a 3d plot between f and the three independent variables re σ ii and c obtained in the experiments this plot indicates a clear correlation between f and the three variables a regression analysis is performed over the total 500 experimental data using the levenberg marquardt lm optimization algorithm which yields the best fitted values of the dimensionless coefficients in eq 14 a 0 255 and b 0 2 with a high coefficient of determination r 2 0 93 indicating that the proposed equation can be used to accurately estimate the friction factor 5 2 a nonlinear flow model for fluid flow in a natural fracture the impacts of surface roughness and variable aperture distribution result in a nonlinear relationship between the flow rate and the pressure gradient to further evaluate the nonlinear relationship a nonlinear flow model is built based on above analysis to serve this purpose substituting eq 14 into eq 7 we arrive at the following expression for pressure gradient 15 p 48 re 4 a 1 c log σ 2 e h b 1 d h ρ v 2 2 12 μ w e h 3 q 0 255 1 c log σ 2 e h 0 2 ρ w 2 e h q 2 it can be seen that eqs 15 and 5 have the same form combining these two equations yields a triple parameter expression for coefficient b as a function of e h c and σ ii 16 b 0 255 1 c log σ 2 e h 0 2 ρ w 2 e h 3 the expression for coefficient b can also be obtained by substituting eq 13 into eq 6 with a 0 255 and b 0 2 fig 15 shows a comparison between the experimental values of b and the predictions by eq 16 in which 50 samples are divided into 3 groups according to the magnitudes of the parameter b values to show the results more clearly it can be seen that the equation agrees reasonably well with the experimental data to further verify the flow model quantitatively the differences between the calculated results with eq 15 and measured pressure gradient are presented in fig 16 the solid line in the figure represents that the calculated value is equal to the measured pressure gradient it can be seen that the equation proposed in the study has satisfactory accuracy as almost all of the data points are located near the solid line the average estimation error is further evaluated by the following equation 17 e ave 1 500 j 1 500 p mea j p cal j p mea j 100 where p mea j is the measured pressure gradient p cal j is the calculated pressure gradient and j represents the j th fractured sample the average estimation error is 5 1 for the proposed model in summary the experimental results of our tests are well captured by the proposed equation suggesting that it can be used to effectively characterize and predict the nonlinear flow characteristics 5 3 critical flow regime in various fields related to fluid flow in rock fractures one of the most important works is to make a choice between the linear darcy s law or the nonlinear forchheimer law as is mentioned before the linear darcy s law can be easily used in practice due to its simplicity but the law may also bring large errors because of the nonlinearity of fluid flow therefore it is important to quantitatively predict the onset of the transition from linear flow to nonlinear flow in recent decades a lot of works have been carried out and a wide range of critical reynolds numbers re c which mark the point of transition from linear flow to nonlinear flow from 0 001 to 2300 have been suggested such a wide range of re c values reported by various investigators are due to the non unique criteria of flow regime transition inconsistent definitions of re by various investigators and variability of fracture geometries witherspoon et al 1980 wittke 1990 koyama et al 2008 radilla et al 2013 javadi et al 2014 chen et al 2015 zhou et al 2015 rong et al 2016 to overcome this limitation a factor α which was defined as the ratio of nonlinearity the second term in eq 5 to overall pressure losses in the forchheimer equation was introduced by zeng and grigg 2006 to quantify the degree of nonlinear flow effect this parameter represents the ratio of the pressure gradient required to overcome inertial forces against that of the total forces and it is expressed as 18 α b q 2 a q b q 2 the critical point between the linear and nonlinear flow is reached when α 10 beyond which the flow is considered to enter the nonlinear flow regime as suggested in a number of studies before zimmerman et al 2004 zeng and grigg 2006 the condition of α 10 is also adopted in this study to quantitatively estimate the critical reynolds number re c for different fractured samples when α 10 substituting eq 18 into eq 8 yields 19 r e c a ρ 9 b μ w by substituting eq 16 into eq 19 and using the relation a 12 μ w e h 3 the following equation is obtained 20 r e c 5 229 c log σ 2 e h 0 2 as one can see the critical reynolds number depends largely on the fracture geometries eq 20 provides a mathematical prediction using the dimensionless best fitting parameter c hydraulic aperture e h and the standard deviation of the secondary roughness σ ii to quantitatively evaluate the critical reynolds number re c for fluid flow through a srf to verify the proposed equation the experimental values of the critical reynolds number re c are calculated by eq 19 with the best fitted values of coefficients a and b for each fractured sample which are listed in table 1 the comparison of the experimental and theoretical values of the critical reynolds number re c for all fractured samples are shown in fig 17 the average estimation error is also calculated with a method similar to eq 17 and the average estimation error of 5 7 is obtained the high accuracy means that eq 20 matches the experimental data very well and can be expected to predict the critical reynolds number re c in related fracture flow problems a point to note is that many previous studies reported critical re numbers for rough walled fractures with magnitudes smaller typically 1 than those shown in fig 17 brush and thomson 2003 konzuk and kueper 2004 radilla et al 2013 javadi et al 2014 we think the main reason resulting in the discrepancy is that the geometries of the fractures used in those studies are different from our experiment for example the hydraulic apertures identified by eq 6 are about 7 μm to 0 2 mm for all experimental cases in javadi et al 2014 which is much smaller than our results 0 06 mm to 1 10 mm the larger hydraulic aperture in this study can be attributed to the absence of normal stress in addition the use of different types of fractured specimens and inconsistent definition criteria for re c may cause this discrepancy as well 6 discussions in natural setting flow in rock fractures may vary from laminar to turbulent states under constrains of various pressure flow rate and fracture geometry it can be seen from eqs 5 and 6 that the nonlinear coefficient is responsible for the nonlinearity of the flow in this study we present new models to link the nonlinear flow behavior and fracture geometry while the latter is quantified by two parameters c and σ ii the satisfactory prediction ability of the proposed modes for experimental data in turn proves that these two parameters can characterize the fracture geometry well while dealing with fracture flow problems to further investigate the impact of fracture geometry on nonlinear flow parameter analyses are conducted based on eq 13 with relative changes 50 25 25 50 of the benchmark value of c and σ ii which are equal to the average value of 50 experimental samples c 7 147 σ ii 0 09 mm fig 18 plots the predicted variation of nonlinear coefficient β with e h at different values of c and σ ii respectively the results imply that the nonlinear coefficient β is very sensitive to c and σ ii especially for lower value of e h the coefficient β decreases drastically with the increase decrease of c σ ii at the same e h it also can be seen that compared with c the change of curves with relative changes of σ ii is smaller which means that the nonlinearity of fluid flow in a srf is more likely to be caused by uneven aperture distributions similar conclusions can also be obtained from other research results zhang and nemcik 2013b zou et al 2017 besides one can find from fig 18 that the difference among the values of β for different values of c and σ ii decreases with increasing e h indicating that the fracture geometry becomes less important when e h is large enough the parameter analyses above suggest that a reasonable estimation of c and σ ii would be crucial to accurately describe the nonlinear flow in rock fractures besides the proposed two parameters are expected to be useful for evaluating heat transfer and solute transport in rock fractures as well as those processes are also greatly associated with the fracture geometry he et al 2016 vilarrasa et al 2011 he et al 2019 over the past several decades a variety of instruments and methods have been developed to measure rock discontinuity topography in situ and in the laboratory tatone 2009 however the acquisition of aperture distributions of a rock fracture in the field remains an open issue that needs to be further investigated although a reliable method for measuring the aperture distributions of a srf is proposed in this study this method is only applicable to the case where the aperture distributions do not change during the experiment it can be seen from section 5 that all the coefficients in the models proposed in the study are independent of the fracture geometries except c and σ ii the favorable feature of these models makes it possible to inversely calculate the value of c with the flow data to serve this purpose the comparison between the measured parameter c and the inversely calculated values by eq 16 with the flow data is shown in fig 19 the high degree of matching between them indicates that this method can serve as a reliable choice to obtain the parameter c it should be noted that this does not mean that the models proposed in this study can be used directly to inversely calculate the parameter c in the field because these models are obtained at laboratory scales there are other factors such as weathering and alteration that cannot be simulated because we cannot simulate actual geological time in the laboratory weathering occurs on fractures in all lithologies and will have the effect of smoothing fracture surfaces as can be seen from the above analysis in this article this effect will increase the value of c and reduce the value of σ ii of the fracture which reduces the nonlinearity of fluid flow in the fracture on the other hand weathering processes alter mineralogical physical and mechanical properties of rocks selby 1993 for example with the increasing grade of the weathering the number of micro cracks and voids increases which increases the permeability of the rock khanlari et al 2012 ciantiaa and castellanzab 2016 severe weathering can even transform a hard rock into non cohesive residual soil in these cases the rock matrix may not be considered impermeable which causes the fracture flow to become more unpredictable in the future field experiments of fluid flow in rock fractures will be conducted to further improve and expand the proposed model and weathering and other effects will be considered in summary upscaling the laboratory results to field scale problems with natural fracture systems is still an outstanding research topic and needs to be further explored chen et al 2015 neuville et al 2012 nevertheless the physical laws which govern the flow behavior in a srf would not change for rock fractures of different scales and positions therefore the proposed models may still provide an important guidance for further development or extension to field scale flow problems 7 conclusions in this study a large number of flow tests are conducted on 50 fractured samples with different fracture geometries mainly for quantitatively evaluating the influence of fracture geometries on nonlinear flow behaviors in a srf it is demonstrated that the forchheimer equation adequately describes the nonlinear deviation for fluid flow through a srf with rough walls and variable apertures but its nonlinear coefficient needs to be further determined by quantifying the fracture geometries by considering the combined effects of the aperture distribution and the surfaces roughness on nonlinear flow in a srf two parameters which characterize the geometric characteristics of the fracture are proposed one is the dimensionless fitting parameter c which is suggested to represent the degree of heterogeneity fluid flow in the fracture with a relatively high value of c leads to less tortuous streamlines and a low degree of nonlinearity another one is the standard deviation of the secondary roughness σ ii which represents the effect of surface roughness after this an equation that relates the nonlinear coefficient to the proposed two geometrical parameters is arrived based on which the friction factor nonlinear flow model and the critical reynolds number re c are also represented by the fracture geometric characteristics the reliability of these proposed equations is examined based on the test results this study presents the first attempt to conduct a quantitative analysis on fracture geometries by considering its effect on fracture flow the proposed models offer an explicit quantitative criterion for evaluating the nonlinearity flow in a srf with any mated states the methods and results are expected to be useful to geologists and hydrologists who focus on rock aquifer systems credit authorship contribution statement guan rong conceptualization methodology supervision jie tan data curation methodology writing original draft writing review editing hongbin zhan conceptualization software writing review editing renhui he methodology validation ziyang zhang validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national natural science foundation of china grant nos 41772305 and 51579189 and the china scholarship council csc grant number 201906270116 these supports are gratefully acknowledged the constructive comments made by the editors and anonymous reviewers are very helpful for us to revise the manuscript and we thank them for their inputs 
5231,the nonlinear flow behavior in a single rock fracture srf has been studied for decades however the existing models to link fracture geometries and nonlinear flow behavior are less accurate due to insufficient characterization of fracture geometries the primary goal of this study is to propose new parameters to characterize the geometric characteristics of a srf and then to evaluate the nonlinear flow behavior in a srf a series of high precision hydraulic tests are conducted on 50 mated and unmated artificial fractured samples the results show that forchheimer equation adequately describes the nonlinear fluid flow through a srf with rough walls and variable apertures and its nonlinear coefficients can be determined by quantifying the fracture geometries by introducing the concept of a threshold aperture meaning that only those zones with greater apertures than a threshold value are involved in the flow process the heterogeneity of aperture distribution is quantified based on the cumulative distribution of individual apertures of sampling points in addition the influence of surface roughness on the nonlinear flow in a srf is quantified with the standard deviation of secondary roughness lastly an equation that relates the nonlinear coefficient to the newly proposed geometrical parameters is arrived which is further used to link the friction factor nonlinear flow model and critical reynolds number with the fracture geometric characteristics the newly proposed equations in this study predict and characterize the nonlinear flow characteristics in a srf very well keywords rock fracture fracture geometries nonlinear flow forchheimer equation 1 introduction rock mass in natural geological setting is composed of rock matrix and fractures the presence of fractures can drastically affect the hydraulic properties of rock mass due to their typically much greater permeability comparing with rock matrix chen et al 2015 liu et al 2018 understanding fluid flow in rock fractures is of great concern in numerous geophysical hydrological environmental and geotechnical engineering activities such as geothermal extraction zhao et al 2015 oil or natural gas exploration camac et al 2006 zhao et al 2004 contaminant pollution control qian et al 2011b noiriel et al 2013 hazardous wastes isolation nowamooz et al 2009 etc although the topic has been widely studied in recent decades it is still very difficult to accurately describe the flow processes through individual fractures due to the complicated fracture geometries chen et al 2017 2019 the navier stokes ns equations can accurately describe the flow process in a single rock fracture srf zimmerman and bodvarsson 1996 however the computational cost of solving the ns equations in practice is significant and sometime untenable partially because of the complexity arising from the nonlinear partial differential equations coupled with velocity and pressure fields in a srf with complex geometry brush and thomson 2003 therefore a rough fracture with variable apertures was regarded as smooth parallel plates in earlier studies snow 1969 and the well known cubic law which is a form of the hagen poiseuille equation in a srf was yielded zimmerman and bodvarsson 1996 in this simplified model the flow rate is proportional to the cubic power of the separation between the plates however a typical natural srf is generally complex in geometries with rough walls and variable apertures instead of smooth and parallel fracture surfaces when the surface roughness needs to be considered the cubic law is assumed to hold locally walsh 1981 with this in view the cubic law can be modified with separation between the plates being replaced by hydraulic aperture however neither the cubic law nor the modified cubic law can correctly describe the flow behavior in a srf it was found from previous studies on fracture flow that darcy s law or linear flow was only validated in low rate laminar flow furthermore the flow could exhibit a nonlinear phenomenon even under the laminar flow regime when the applied pressure flow rate became sufficiently large witherspoon et al 1980 kohl et al 1997 yeo and ge 2001 wen et al 2006 zhang and nemcik 2013b zou et al 2017 zhou et al 2019 there are a few reasons that can trigger nonlinear flow in a srf zimmerman and bodvarsson 1996 emphasized that the roughness contact areas and tortuosity may cause variations in flow velocity and flow direction because of constrictions and obstructions and initiation of turbulence due to localized eddy flow formation these features may result in nonlinear flow in a srf similar conclusions were also reached from experiments and numerical works by different investigators zimmerman et al 2004 zhou et al 2015 zou et al 2017 xiong et al 2018 recently nonlinear flow in a real srf with variable apertures have been extensively investigated both empirically ranjith and darlington 2007 qian et al 2011a zou et al 2015 zhang et al 2015 zhou et al 2015 zhou et al 2016 li et al 2016 and numerically zimmerman et al 2004 zou et al 2017 zhou et al 2020 their studies suggested that the forchheimer equation describes the nonlinear relation between pressure gradient and volumetric flow rate satisfactory in many cases meanwhile the well known darcy weisbach equation white 2003 which describes the pressure head loss in the flow process from the perspective of flow friction resistance is also widely used in practice based on these equations many researchers made great efforts to investigate the nonlinear flow in a srf by considering the total dilation rong et al 2016 2018 the normal confining stress zhang and nemcik 2013a b zhang et al 2015 chen et al 2015 zhou et al 2016 chen et al 2019 and the fluid slippage zhou et al 2020 etc it can be seen that the nonlinear flow in a srf is closely related to the shear displacement and confining stress in fact the underlying mechanism behind it can be ascribed to the fracture geometry properties varying with these conditions chen et al 2019 therefore it is extremely important to properly quantify the influence of fracture geometries on nonlinear flow in a srf a point to note is that the fracture geometries include not only the surface morphology of fractures but also the aperture field in a fracture each of which alone is not sufficient to represent such an influence chen et al 2019 in this study the influences of both surface morphology of fractures and the aperture field on the nonlinear flow are taken into account therefore the fracture geometries mentioned in this study include both the surface morphology and the aperture field in a fracture it has been confirmed by previous works zimmerman and bodvarsson 1996 xiong et al 2011 zhang and nemcik 2013b zou et al 2017 that fluid flow and solute transport processes in fractured rock masses are highly sensitive to the aperture distribution and the surface roughness thus quantitative characterization of the heterogeneity of variable aperture distributions and surface roughness is a starting point for a better interpretation of fluid flow and solute transport in a srf over the past decades a large body of research has been published on the geometric characteristics of a srf some geometrical parameters such as the peak asperity of surface profiles fractional contact area etc were taken into consideration in describing the coefficients of the forchheimer equation chen et al 2015 xiong et al 2018 and the friction factor of the darcy weisbach equation chen et al 2009 zhang and nemcik 2013a zhang et al 2015 zhou et al 2016 to describe the nonlinear flow in a srf according to the definition of the peak asperity of surface profiles proposed by chen et al 2015 quantification of this term only focuses on the maximum and minimum asperity height of some profiles which is not sufficient to characterize the entire fracture surfaces furthermore although there is a certain correlation between the contact area and the tortuosity of flow paths this parameter cannot adequately represent the heterogeneity of variable aperture distributions as the contact area only accounts for a small part of the fracture surface even if there were no contact fluid flow might still take tortuous pathways in a srf under the influence of variable apertures zou et al 2017 for describing the roughness of rock joints many parameters such as fractal parameters brown 1987 xie 1993 odling 1994 statistic parameters myers 1962 thomas 1981 grasselli et al 2002 and joint roughness coefficient jrc barton and choubey 1977 have been proposed such parameters have improved our understanding of the roughness of fracture surfaces however most of these parameters were proposed to investigate the shear properties of rock joints thus they may not be suitable for evaluating the effect of surface roughness on flow in a srf a positive sign to note is that a number of studies pertaining to the effect of roughness on flow in a srf have been reported recently for instance zou et al 2015 and wang et al 2016 studied the effects of roughness on fluid flow in a srf through flow simulations in a series of two dimensional 2d and three dimensional 3d models of rough fractures however these studies did not present any quantitative indicators on flow mechanism in a srf when the fracture surface roughness is of concern with respect to the quantification of the heterogeneity of variable apertures the box counting fractal dimension d of the interconnected void areas was proposed by chen et al 2017 2019 however this method is too complicated to give a set of computational procedures for all fracture surfaces based on the coordinate data of the fracture surface aiming at above issues the primary motivation of the present study is to quantitatively evaluate the influence of fracture geometries on nonlinear flow behaviors in a srf based on newly available experimental observations made by the authors in the present research the effect of variable aperture distributions and surface roughness on fluid flow in a srf is characterized by two parameters the parameter c related to the threshold aperture and the standard deviation σ ii of the secondary roughness both will be explained in details later a series of high precision hydraulic tests have been conducted on both mated and unmated artificial fractured samples based on the test results some empirical models relating those proposed two geometrical parameters with indexes characterizing fluid flow nonlinear coefficient friction factor and critical reynolds number are further employed to study nonlinear flow characteristics in a srf 2 theories relevant to this study the flow of an incompressible newtonian viscous fluid in a srf is governed by the navier stokes ns equations which are derived from the newton s second law for the steady state fluid flow the ns equations can be expressed as zimmerman and bodvarsson 1996 xiong et al 2011 zou et al 2017 1 p μ 2 u ρ u u 2 u 0 where u is velocity vector ρ is fluid density p is pressure and μ is dynamic viscosity coefficient eq 2 is the continuity equation which is complementary to eq 1 representing a conservation of mass it can be seen from eq 1 that the pressure losses are composed of viscous dissipation the first term and inertial losses the second term in the certain case that the reynolds number is low enough the inertial forces are negligible compared to the viscous forces then eq 1 is simplified as 3 p μ 2 u eq 3 is the well known stokes equation which is a set of linear equations although the computational burden has been greatly reduced it is still very hard to solve the stokes equation for practical problems for smooth parallel plates that are separated by a small aperture it is reasonable to assume that the velocity is parallel to pressure gradient the following cubic law is obtained by integrating both sides of eq 3 4 q w e 3 12 μ p where q is the volumetric flow rate e is the aperture of the idealized parallel smooth fracture and w is the width of the fracture which is normal to the direction of fluid flow for fluid flow in a rough fracture the aperture e would be replaced by hydraulic aperture e h which is defined as an equivalent smooth fracture possessing the same water conducting capacity with its original rough fracture zimmerman and bodvarsson 1996 brush and thomson 2003 konzuk and kueper 2004 therefore e h is variable and decreases as the flow rate increases due to the nonlinear effect which may be induced by the complicated geometries and the increased flow rate in this study the same approach in nowamooz et al 2009 chen et al 2015 2019 is adopted in this way e h only represents the intrinsic hydraulic aperture of the fracture which could be inversely calculated with eq 4 in laminar flow regime in which the inertial forces are negligible compared with viscous forces hence the e h term used in this study is a constant independent of the varying flow rates and only determined by the given fracture to characterize the nonlinear flow behavior in a rough fracture with variable aperture distributions numerous empirical and theoretical equations have been proposed in which the forchheimer equation is the most widely used one zhang and nemcik 2013b chen et al 2015 qian et al 2019 5 p a q b q 2 6 a μ kw e h 12 μ w e h 3 b β ρ w 2 e h 2 where a and b are the coefficients representing viscous and inertial effects respectively k is the intrinsic permeability defined as e h 2 12 and β is called the nonlinear coefficient or the inertial resistance at sufficiently low flow rates the pressure losses induced by the inertial effect the second term on the right hand side of eq 5 are negligible compared with the viscous effect which would lead to the forchheimer equation reduces to darcy s law eq 4 on the contrary for fluid flow with sufficiently high flow rates the pressure losses induced by the viscous effect the first term on the right hand side of eq 5 could be vanished it shows that the flow has transited into a turbulent flow regime where the inertial effect is dominating qian et al 2005 tzelepis et al 2015 meanwhile the pressure losses in the process of flow in a srf are also characterized widely by the darcy weisbach equation white 2003 which reads 7 p f 1 d h ρ v 2 2 where f is the friction factor d h which equal to 2 e h is the characteristic dimension of the fracture and v is the mean flow velocity the reynolds number re which characterizes the flow regimes is defined as the ratio of the inertial force against the viscous force and can be written as zimmerman et al 2004 8 re ρ u e h μ ρ q μ w where u is the average velocity it has been well understood that the friction factor f can be related to the flow regimes and the fracture geometries white 2003 chen et al 2009 qian et al 2011a zhang and nemcik 2013a zhou et al 2016 at sufficiently low reynolds number the flow in a srf can be described by cubic law eq 4 then combining eqs 4 7 and 8 f 48 re can be derived for fully developed turbulent flow the pressure losses induced by the viscous effect could be vanished combining eqs 5 and 7 and using the relations a 0 and b β ρ w 2 e h 2 one can obtain f 4 e h β by incorporating the forchheimer equation zhou et al 2016 proposed that the friction factor is equal to the sum of components due to the viscous and inertial effects respectively and the following expression was developed 9 f 48 re 4 e h β above equation has a clear physical significance and would be used in this study to quantitatively evaluate the flow behavior in a srf 3 experimental methodology and results 3 1 specimens preparation and measurement to investigate the flow behavior in a srf it is best to use natural fractures however it is difficult to get enough fractured samples for laboratory tests therefore the tensile fractures are used as alternatives in this study the fresh tensile fractures used in the study are made by splitting from granite samples which are collected from dabieshan anhui province of china the processes for making tensile fractures are as follows firstly the natural granite samples are cut into cubic samples with 200 mm 100 mm 100 mm then these cubic samples are fixed in a self design mold to ensure that the normal load acts on the middle of the rock sample finally the normal load is applied along the loading line with a normal velocity of 0 3 mm min until the tensile fractures are made more details regarding the brazilian splitting technique can be found in yang et al 2016 fifty representative single fractures with different roughness are selected and numbered from g1 to g50 to quantify the effect of fracture geometries on fluid flow the first step is to precisely measure the fracture geometries a 3d morphology scanner system composed of a scanning camera a projection lens and a scanning controller is utilized here to measure the fracture surface topography and aperture distribution see fig 1 such a scanner system offers the advantages of high measurement speed high precision and favorable repeatability the resolution of a sampling point can achieve a precision up to 10 µm in this study both mated and slightly offset granite fractures are adopted in the flow tests for examining the possibly different flow behaviors in fractures with different mated states taking a typical sample g1 as an example the measurement of its geometric characteristics mainly includes two processes of scanning and stitching see fig 2 first of all the fracture is fixed with a slight offset 1 mm between the upper and lower surfaces and then marking points are pasted on the fronts of the upper and lower fractured rock halves after that these marking points are scanned with the scanner system to record their relative positions the purpose of using marking points here is to ensure that the srf can be completely reconstructed to its previous position after scanning the fracture surfaces subsequently the upper and lower surfaces of the fractured rock sample are scanned and digitized separately the topographical data of each surface are obtained with an interval of 0 1 mm in both x and y directions where x and y are along the long and short sides of the surface respectively it is worth noting that the average fluid flow direction in the following flow experiments is along the x axis also after finishing the scanning process the data of the upper and lower surface topography are put in the same coordinate system according to the marked points at last the aperture distribution is calculated with the coordinate data of the upper and lower surfaces in the same coordinate system 3 2 water flow experiment after measuring the aperture distribution and the surfaces morphology all the selected cuboid fractured samples with different mated states are used to conduct water flow tests a notable point is that the aperture field is a result of two rough surfaces in contact which is subject to change when different stresses are acting on the fracture this may cause an inaccurate aperture field measured by morphology scanners because the elastic and or elastic plastic deformation of asperities are not taken into account to circumvent the problem in all the experiments conducted in this study the specimen is not fixed by applying normal stress but by two bolts the bolts provide the constrained force to prevent the fracture from dilation due to water pressure in this case the elastic and or elastic plastic deformation of asperities is negligible the experiments are performed in the state key laboratory of water resources and hydropower engineering science wuhan university china with a room temperature 25 c and the density and dynamic viscosity of water are ρ 0 997 103 kg m3 and μ 0 89 10 3 pa s respectively here the self designed fracture flow testing system which consists of an isco pump 500d with an injection rate ranging from 0 to 204 ml min and a specially designed flow apparatus is employed as indicated in fig 3 before testing the lateral sides of these fractured samples are sealed with silicone rubber to ensure unilateral flow in the fracture first and then two specially designed rectangular tanks made of polyurethane are mounted on the inlet and outlet of the fractured sample to ensure even distribution of water pressure over the inlet of the sample and to collect the fluid discharge subsequently the fractured sample is placed in a specially designed experimental box and fixed with two bolts this design can ensure that the aperture distributions do not change in testing after a watertight test distilled water is injected from the servo controlled fluid pump to the inlet tank mounted on the test sample and it then flows through the fracture and finally exit via the outlet tank for each sample a total of 10 water flow tests with 10 different flow rates are performed each flow test starts with a given inlet flow rate and the applied flow rate q ranges from 0 to 200 ml min the differential pressure between the inlet and outlet of the sample is continuously recorded by a differential pressure gauge connected to both tanks in order to ensure the measurement accuracy as much as possible three different specifications of differential pressure gauges are used in this study their maximum test pressures are 2 5 kpa 35 kpa and 1 mpa respectively with the corresponding precisions of 0 001 kpa 0 01 kpa and 1 0 kpa for most given inlet flow rates the one with a maximum test pressure of 35 kpa and a precision of 0 01 kpa is used 3 3 experimental observations in the study a number of 500 flow tests are conducted on the 50 fractured samples each sample has 10 tests with different flow rates with different fracture geometries a total of 1000 data points including the pressure gradient and flow rate corresponding to different fracture geometries have been collected and analyzed which are anticipated to provide a statistically valid dataset to justify the problem of concern information about flow behavior can obtained from the relationship between the pressure gradient p and flow rate q fig 4 presents the results of flow tests in 50 fractured samples it can be seen that the pressure gradient rises up linearly with increasing flow rate at the beginning and then the pressure gradient increases with the flow rate in a super linear fashion indicating the nonlinear flow occurrence the dash line in fig 4e represents the predicted curve using darcy s law it is found that darcy s law will overestimate the flow rate at the same pressure gradient due to the nonlinearity of the flow with the increase of the pressure gradient the nonlinearity becomes more evident the main reason for the emergence of nonlinear flow is that the high water velocities have substantially enhanced the inertial forces which become increasingly important and non negligible as compared to the viscous forces in this case a larger injection pressure is required to obtain the corresponding volumetric flow rate as compared to what is required for the same flow rate under the linear flow darcy s law or cubic law scenario as also plotted in fig 4 the best fitting curves using a zero intercept quadratic polynomial show that the forchheimer equation describes the nonlinearity of the fluid very well for each fractured sample the linear and nonlinear quadratic coefficients in the forchheimer law are gained by performing best fit regression using eq 2a and the results are presented in table 1 the value of a represents the intrinsic permeability of the fracture and the coefficient b can be regarded as a vital parameter to describe the nonlinear flow chen et al 2015 2019 as mentioned before some samples have well matched surfaces and others are offset by different distances in this study our primary objective here is not to perform an exhaustive analysis for the matching state but to obtain different fracture geometries therefore the offset of samples is random and the distance of offset is not recorded in addition unlike the usual shear flow experiments water flow experiments are not conducted on the same sample at different offsets but each sample may have a different displacement distance in this study this makes it almost impossible to accurately evaluate the influences of the matching state on the nonlinear flow behavior because the effect of the fracture surface roughness is not excluded in this study the same rock type is used to conduct experiments under the same conditions so it can be assumed that the degrees of large scale waviness of these fracture surfaces obtained are generally consistent in this case the matching degree may be related to the mechanical aperture of the fracture according to the shear characteristics of rock joints in the laboratory javadi et al 2014 yang et al 2016 a larger mechanical aperture generally corresponds to a longer distance of offset and a smaller matching degree therefore by analyzing the flow behavior in samples with different mechanical apertures the influences of the matching state on the nonlinear flow behavior can be indirectly investigated and discussed fig 5 presents variations of coefficients a and b with the mechanical aperture e 0 as shown in fig 5 the variation patterns of coefficients a and b are very similar both coefficients show an abrupt reduction at first and then decreases gradually to attain a somewhat constant value for mechanical apertures exceeding 0 7 mm the variation pattern is generally consistent with the results obtained in javadi et al 2014 in which the role of shear processes on nonlinear flow rock fractures was discussed indicating that it is reasonable to qualitatively estimate the matching state effect through the mechanical aperture at each mechanical aperture the value of b a which can be viewed as the ratio of nonlinear to linear pressure losses at unit flow is calculated to evaluate the nonlinearity variation of b a with mechanical aperture is shown in fig 6 it can be seen that the scatter points are widely distributed which can be attributed to the influence of fracture surface roughness in general the value of b a shows a descending variation with the increasing mechanical aperture indicating that the nonlinearity of fluid flow decreases with the increasing offset distance or matching degree this is because although the offset reduces the matching degree between the two fracture surfaces it also increases the probability of the connectivity of large apertures matsuki et al 2006 javadi et al 2014 it should be noted that here we only qualitatively discuss the influence of matching state in an indirect manner in the future more targeted experiments are needed to intuitively analyze the matching state effects the hydraulic behavior is greatly associated with the equivalent hydraulic aperture e h which could be estimated with the cubic law when the flow rate is small to connect the mechanical behavior of fractures to their hydraulic behavior the relation between the mechanical aperture and the hydraulic aperture is shown in fig 7 the red line in the figure represents that the mechanical aperture is equal to the hydraulic aperture and the blue line is the best fitting curve with a zero intercept linear equation it can be seen that the hydraulic apertures e h are smaller than the mechanical apertures e 0 due to the influence of the fracture geometry in general e h is proportional to e 0 however many points deviate from the fitting curve as a result of difference in geometrical characteristics of these fractures it can be seen from eq 6 that the flow behavior in rock fractures is associated with the cubic of e h indicating that small deviations in e h will also produce large errors in flow behavior therefore the fitting formula in fig 7 is not recommended to predict e h to further quantitatively evaluate the effect of fracture geometry on e h the dimensionless number 1 e h e 0 for each fracture is calculated fig 8 represents the variation of 1 e h e 0 with mechanical aperture e 0 it can be seen that the scatter points are widely distributed indicating that the fracture geometry of each fracture is different in addition it also can be observed that the value of 1 e h e 0 decreases with increasing e 0 and gradually attains a somewhat constant value indicating that the larger e 0 is the smaller the influence of fracture geometry on fluid flow in a srf will be in order not to deviate from the main purpose of this study no attempt is made to evaluate how the fracture geometry affects the hydraulic aperture e h instead all e h used in this study is calculated with the cubic law when the flow rate is small in summary the forchheimer equation describes the nonlinearity of the fluid very well the coefficients a and b in the forchheimer equation are closely associated with the fracture geometric characteristics it can be seen from eq 6 that the coefficient a has an explicit expression that is inversely proportional to the cube of e h while few general expressions for b considering the fracture geometries effect has been reported yet this is because quantification of the fracture geometry effect on nonlinear flow in a srf is still largely unknown which would be discussed in details in the following 4 representation of fracture geometric characteristics as is mentioned before a natural rock fracture is characterized by rough surfaces and variable aperture distributions resulting in complex geometries therefore we mainly focus on the characteristics of variable aperture distributions and surface roughness in this study by considering their influence on nonlinear flow in a srf the complexity or heterogeneity of fracture geometries is discussed and quantified with two geometric parameters the parameter c related to the threshold aperture and the standard deviation σ ii of the secondary roughness which are explained in details in the following subsections 4 1 heterogeneity of aperture distribution this section aims to quantify the heterogeneity of aperture distributions of a fracture therefore only the projection surface of the fracture surface on the horizontal plane is analyzed without considering the surface roughness the projection surface can be thought of as consisting of a number of squares centered on the sample points whose apertures are measured in advance under the influence of variable aperture distribution the fluid flow in a srf will take tortuous pathways in this case the streamlines in the fracture are not generally homogenous with paralleled lines along the principal flow direction but concentrated in a few fast flowing channels with greater apertures inside the fracture of concern xiong et al 2011 cheng et al 2017 zou et al 2017 channeling flow is an important phenomenon in fracture flow and seems to play a primary role in enhancing the nonlinearity of fluid flow cheng et al 2017 zhou et al 2015 zhang and nemcik 2013b there are a few reasons which can cause the channeling flow one of them is that there are some randomly distributed contacting regions in the fracture it could lead to increasing tortuosity of flow paths because fluid flows in the fracture must move around these contact areas cheng et al 2017 xiong et al 2018 besides since pressure drop in the flowing process is extremely sensitive to the aperture inversely proportional to the cubic of aperture fluid flow in a variable aperture fracture under saturated conditions will tend to follow paths of the least resistance i e paths of the largest aperture zimmerman and bodvarsson 1996 it can be seen from above analysis that not all the surface is involved in transmitting fluid flow the more complex the aperture distributions are the more obvious the channeling flow phenomenon will be therefore we can assume that only those zones with apertures greater than a threshold value which is unique for a specified aperture distribution are involved in the flow process in a srf in this way it is possible to discriminate the fraction of surface that might be involved in transmitting flow as a function of a threshold value e this fractional area is referred as the normalized area a which is defined as the area of the surface with an aperture greater than a selected threshold value normalized with respect to the total area of the surface at the heterogeneity of aperture distribution can be evaluated by comparing the cumulative distributions of a this method is analogous to the analysis of surface roughness conducted by grasselli et al 2002 to study the relationship between the normalized fractional area a and the corresponding minimum aperture e the digitized aperture data are used to calculate a for several values of e from 0 mm to maximum in which a total of 50 threshold aperture values for each fracture are selected this process is similar to sieving analysis which is widely used to determine the cumulative grain size distribution of soil in geotechnical engineering taking fractured sample g33 as an example the relation between the normalized area a and threshold aperture e is obtained and shown in fig 9 it can be seen that the change of a shows an inverse sigmoid curve as the threshold aperture e increases the normalized area a decreases from 1 to 0 and the decreasing rate increases first and then decreases and finally slowly approaches 0 to quantify the relationship between a and e the following equation is adopted to best fit the data after testing numerous functions by the authors solid line in fig 9 10 a 1 1 e e 0 c where e 0 is the mean mechanical aperture and c is a dimensionless fitting parameter calculated via a nonlinear least square regression analysis the best fitting results of other fractured samples are listed in table 1 it can be seen that eq 10 provided satisfactory fits to the data with a coefficient of determination r 2 ranging between 0 933 and 0 999 for a certain given fracture the mean mechanical aperture e 0 is a constant it can be seen from eq 10 that the relationship between a and e only depends on the parameter c to make it clear what the parameter c stands for the lines defined by eq 10 with e 0 0 700 and different values of c are also plotted in fig 9 dotted line it is observed that with constant e 0 the value of c controls the slope of the curve a larger c value means a steeper curve and a wider distribution this implies that the aperture distribution with a larger c value has a relatively lower degree of heterogeneity for a fixed e 0 a value of c approaching infinity is indicative of a fracture with an identical aperture at every point in the sense that there is no channeling flow phenomenon in the fracture and fluid flow in the fracture has the smallest nonlinearity therefore the fitting parameter c is suggested to characterize the complexity or heterogeneity of the aperture distributions 4 2 surface roughness as is mentioned before in addition to the channeling flow caused by the variable aperture distributions the fracture surface roughness is also an important reason for the nonlinearity of fluid flow in a srf to quantitatively characterize the relationship between the nonlinearity and the surface roughness it is important to understand how the surface roughness influences the fluid flow in a srf from a rigorous physical perspective by conducting numerical simulations zou et al 2015 and wang et al 2016 systematically investigated the impacts of surface roughness on the nonlinear fluid flow in 2d and 3d rough fractures respectively specifically they decomposed the surface roughness into primary roughness i e the large scale waviness of fracture morphology and secondary roughness i e the small scale unevenness with a wavelet analysis which is also adopted in this study their results showed that the nonlinear properties of the fluid flow are mainly caused by the secondary roughness rather than the primary roughness therefore it is necessary to quantify the secondary roughness which obeys a gaussian distribution with an average value closes to 0 as a random process of white noise zou et al 2015 pointed out that the secondary roughness will form a thin boundary layer with nonlinear dynamic eddy flow over the whole domain therefore the effect of the secondary roughness on the nonlinear properties of the fluid flow through a srf can be quantified by comparing the intensity or standard deviation of the secondary roughness this method is also widely used to evaluate the turbulence intensity of flow in hydraulics therefore we recommend using parameter σ ii the standard deviation of the secondary roughness to represent the effect of the surface roughness on nonlinear fluid flow in a srf in this study more details regarding the method for surface decomposition and reconstruction can be found in wang et al 2016 taking a 2d profile as an example the primary roughness secondary roughness and σ ii are shown in fig 10 the values of the parameter σ ii for all the selected fractured samples are computed and listed in table 1 it should be noted that σ ii is the sum of the standard deviation of the upper and lower surfaces i e σ ii σ ii u σ ii l where the superscripts u and l represent the upper and lower surfaces respectively apparently a higher value of σ ii corresponds to the fluid flow in a srf with a stronger nonlinearity we should note that the fluid flow is essentially controlled by the aperture field in other words what the parameter σ ii actually quantifies is the influence of local changes of the aperture field on the flow behavior in a srf therefore we can decompose the aperture field into large scale components and small scale components with a wavelet analysis the standard deviation of the small scale components of the aperture field may also be a reasonable parameter to represent such an influence in this study we select the standard deviation of the secondary roughness instead of the small scale components of the aperture field mainly for the following reasons firstly the influence of the secondary roughness on fluid flow and solute transport in rock fractures has been extensively investigated in recent years zou et al 2015 wang et al 2016 dou et al 2018 2019 the use of parameter σ ii is aligned with these previous research results and has a clear physical meaning secondly compared with the aperture field it is much easier to obtain the surface morphology information of a fracture therefore the parameter σ ii is more likely to be applied in the field and laboratory it should be noted that the standard deviation of the secondary roughness is subject to change when elastic deformation or damages occur on asperities and this issue is out of the scope of this study 4 3 test of proposed parameters in sections 4 1 and 4 2 we proposed two parameters for quantifying the heterogeneity of aperture distribution and surface roughness respectively by considering their effects on nonlinear flow behavior in a srf to examine the reliability of the proposed parameters the commercial finite element software package comsol multiphysics is employed to simulate the fluid flow on a few selected cases by solving the navier stokes ns equations the results of simulations are illustrated as follows 4 3 1 the parameter c as is mentioned above the parameter c represents the complexity or heterogeneity of the aperture distributions to quantify the parameter c the digital surface of the fracture sample g2 is used as the parent surface and three fracture models with different aperture distributions are generated the scanned surface is lifted upwards in the vertical direction i e z direction with a value of 1 mm firstly afterwards a series of shear displacements d 0 5 1 2 mm are applied to the upper surface to generate three artificially sheared fractures at last for each sheared fracture a 25 mm 50 mm section is selected from the created fracture to form the fracture models for the consideration of computational efficiency in solving partial differential equations with high accuracy i e models m1 m3 taking fractured model m3 as an example the digital surface and the approach of creating the fracture model are illustrated in fig 11 note that this numerical shear is not to simulate a shearing process but to construct fracture models with different aperture distributions based on the method proposed in section 4 1 the calculated values of parameter c for three fracture models are listed in table 2 for each model triangular meshing is used over the fracture model considering the adaptability of rough joints the inlet boundary conditions are specified with different values of constant flow rates the outlet boundary condition is set as zero pressure and the rest fracture walls are set as non slip boundaries three laminar entrance inflow conditions with different reynolds number re 1 10 and 100 are applied for each fracture model fig 12 presents the simulated streamlines under the exemplified case with re 100 for three fracture models it can be seen that the streamline distributions of model m1 is generally homogenous with paralleled lines along the principal flow direction but that of m2 shows slight channeling due to variable apertures for model m3 the streamline distributions are strongly channelized with significant tortuosity dominated by the heterogeneity of aperture distribution created by shear despite the fact that the degrees of surface roughness of the three models are identical one can see that the parameter c is associated with the tortuosity of streamline distributions fluid flow in the fracture with a relatively high value of c leads to less tortuous streamlines the ratio of nonlinear to linear pressure losses is further used to evaluate the degree of nonlinearity of the fluid flow and can be expressed as 11 f p non p lin p sim p lin 1 where p lin is the linear pressure loss which can be calculated with the cubic law p non is the nonlinear pressure loss and p sim is the total pressure loss calculated from the simulation to calculate p lin under different flowrates the equivalent hydraulic aperture e h is determined in advance with the cubic law using the total flow rate through the fracture and the pressure gradient between the inlet and outlet when re 1 after that the values of f for three fracture models are calculated and listed in table 2 it can be seen that fluid flow in the fracture with a relatively high value of c corresponds to a low degree of nonlinearity indicating that the parameter c can characterize the heterogeneity of aperture distribution well 4 3 2 the parameter σ ii as mentioned above the surface roughness is decomposed into primary roughness and secondary roughness and the standard deviation of the secondary roughness σ ii is suggested to represent the effect of the surface roughness on nonlinear fluid flow in a srf in this study this section is to investigate whether it is reasonable to rule out the contribution of the primary roughness to the development of nonlinearity in the assessment to serve this purpose two fracture models m4 and m5 one with and another without the secondary roughness are generated for simulations so that the secondary roughness effects can be clearly demonstrated by comparison between results from the two models in this section a 25 mm 50 mm section of the decomposed primary waviness from the fracture sample g2 is used as the parent surface to eliminate the effect of the aperture distributions on the nonlinear flow behavior no shear step is applied to the upper surface i e d 0 for the two models the first model m4 is built by numerically lifting the parent surface upwards in the vertical direction i e z direction with a value of 0 25 mm this relatively small mechanical aperture is used here to highlight the effect of roughness the second model m5 is built numerically by superimposing the secondary roughness decomposed from upper and lower surfaces of the fracture sample g2 on the primary waviness after the same lift step used for building model m4 the lower surfaces of m4 and m5 are shown in fig 13 the initial and boundary conditions of the two models are the same as models m1 m3 built in section 4 3 1 based on the numerical simulation results the values of f for models m4 and m5 are calculated and listed in table 2 it can be seen that the secondary roughness significantly enhances the nonlinearity of the fluid flow in the fracture specifically the value of f for fluid flow in model m4 is about one magnitude smaller than that in model m5 indicating that the nonlinearity induced by the primary roughness is negligible compared to the secondary roughness therefore the contribution of the primary roughness to the development of nonlinearity is not considered in this study 5 quantitative characterization of the nonlinear flow the above analysis presents two parameters c and σ ii which characterize the geometric characteristics of a srf to quantify the effect of fracture geometric characteristics on the nonlinear flow in a srf an equation that relates the nonlinear coefficient to these proposed two geometrical parameters is arrived on this basis the friction factor nonlinear flow model and the critical reynolds number re c are also associated with these two parameters to characterize and predict the nonlinear flow characteristics the reliability of these proposed equations is examined based on the test results 5 1 friction factor of water flow in a srf it can be seen from eq 9 that the friction factor is associated with the nonlinear coefficient β which depends only on the geometrical properties of the media zeng and grigg 2006 cherubini et al 2012 as well as the reynolds number establishing the relationship between the nonlinear coefficient and the geometric characteristics of the fracture is an important step to accurately evaluate the friction factor in the flow process over the past several decades extensive researches on the nonlinear coefficient have been conducted and numerous equations have been proposed among which the equation proposed by louis 1969 has been widely used for the characterization of the nonlinear flow in practice chen et al 2019 12 β 1 8 e h log s log ξ 2 e h 2 where s is a dimensionless coefficient dependent on the surface roughness index defined as ξ 2 e h and ξ is the peak asperity of surface profiles based on eq 12 one can conclude that β 1 e h log ξ 2 e h b as is mentioned above the parameter ξ is limited to discrete feature points of profiles of fracture which is not sufficient to characterize the entire fracture therefore to better characterize the effect of roughness on nonlinear flow the parameter ξ is replaced by σ ii besides the variable aperture distribution effect has not been considered in eq 12 thus the parameter c which is suggested to characterize the complexity or heterogeneity of the aperture distributions is added into the expression for nonlinear coefficient β the similar method is also used by chen et al 2019 according to the analysis in section 4 1 fluid flow in the fracture with a larger c value has a relatively lower degree of nonlinearity which causes a lower value of β as well therefore the form of 1 c is used and a new expression for nonlinear coefficient β is suggested as follows 13 β a 1 c e h log σ 2 e h b where a and b are dimensionless regression coefficients and can be regarded as the correction factor in this form of expression it is noted that eq 13 is not a theoretical expression but an empirical expression therefore other forms of expression with different correction factors may also be possible the present form is adopted mainly for the following reasons first of all we hope to make the new expression obtained as simple as possible on the basis of eq 12 which will help the expression to be applied in practical projects secondly this form of expression can ensure its dimensional consistency since the nonlinear coefficient β is in dimension of l 1 e h and σ ii are in dimension of l and c is a dimensionless parameter as mentioned in section 4 1 according to eq 12 we can speculate that a 0 and b 0 which are confirmed in the analysis below for a smooth parallel plate c and σ ii 0 in this case one can obtain β 0 based on eq 13 indicating that this form of expression encompasses the idealized condition assumed in the smooth parallel plate model combining eqs 9 and 13 yields an expression for friction factor f as a function of e h c and σ ii 14 f 48 re 4 a 1 c log σ 2 e h b π this equation adequately considers the influences of the variable aperture distributions and surface roughness on the fluid flow in a srf the dimensionless coefficients a and b are no longer dependent on the fracture geometries and hence eq 14 can be conveniently integrated into computational fluid dynamics and groundwater simulations under variable flow regimes the friction factor corresponding to different flow regimes for water flow in all the fractured samples are calculated with the darcy weisbach equation based on the raw flow data obtained from laboratory tests to determine the regression coefficients a and b independent of the fracture geometries in eq 14 fig 14 shows a 3d plot between f and the three independent variables re σ ii and c obtained in the experiments this plot indicates a clear correlation between f and the three variables a regression analysis is performed over the total 500 experimental data using the levenberg marquardt lm optimization algorithm which yields the best fitted values of the dimensionless coefficients in eq 14 a 0 255 and b 0 2 with a high coefficient of determination r 2 0 93 indicating that the proposed equation can be used to accurately estimate the friction factor 5 2 a nonlinear flow model for fluid flow in a natural fracture the impacts of surface roughness and variable aperture distribution result in a nonlinear relationship between the flow rate and the pressure gradient to further evaluate the nonlinear relationship a nonlinear flow model is built based on above analysis to serve this purpose substituting eq 14 into eq 7 we arrive at the following expression for pressure gradient 15 p 48 re 4 a 1 c log σ 2 e h b 1 d h ρ v 2 2 12 μ w e h 3 q 0 255 1 c log σ 2 e h 0 2 ρ w 2 e h q 2 it can be seen that eqs 15 and 5 have the same form combining these two equations yields a triple parameter expression for coefficient b as a function of e h c and σ ii 16 b 0 255 1 c log σ 2 e h 0 2 ρ w 2 e h 3 the expression for coefficient b can also be obtained by substituting eq 13 into eq 6 with a 0 255 and b 0 2 fig 15 shows a comparison between the experimental values of b and the predictions by eq 16 in which 50 samples are divided into 3 groups according to the magnitudes of the parameter b values to show the results more clearly it can be seen that the equation agrees reasonably well with the experimental data to further verify the flow model quantitatively the differences between the calculated results with eq 15 and measured pressure gradient are presented in fig 16 the solid line in the figure represents that the calculated value is equal to the measured pressure gradient it can be seen that the equation proposed in the study has satisfactory accuracy as almost all of the data points are located near the solid line the average estimation error is further evaluated by the following equation 17 e ave 1 500 j 1 500 p mea j p cal j p mea j 100 where p mea j is the measured pressure gradient p cal j is the calculated pressure gradient and j represents the j th fractured sample the average estimation error is 5 1 for the proposed model in summary the experimental results of our tests are well captured by the proposed equation suggesting that it can be used to effectively characterize and predict the nonlinear flow characteristics 5 3 critical flow regime in various fields related to fluid flow in rock fractures one of the most important works is to make a choice between the linear darcy s law or the nonlinear forchheimer law as is mentioned before the linear darcy s law can be easily used in practice due to its simplicity but the law may also bring large errors because of the nonlinearity of fluid flow therefore it is important to quantitatively predict the onset of the transition from linear flow to nonlinear flow in recent decades a lot of works have been carried out and a wide range of critical reynolds numbers re c which mark the point of transition from linear flow to nonlinear flow from 0 001 to 2300 have been suggested such a wide range of re c values reported by various investigators are due to the non unique criteria of flow regime transition inconsistent definitions of re by various investigators and variability of fracture geometries witherspoon et al 1980 wittke 1990 koyama et al 2008 radilla et al 2013 javadi et al 2014 chen et al 2015 zhou et al 2015 rong et al 2016 to overcome this limitation a factor α which was defined as the ratio of nonlinearity the second term in eq 5 to overall pressure losses in the forchheimer equation was introduced by zeng and grigg 2006 to quantify the degree of nonlinear flow effect this parameter represents the ratio of the pressure gradient required to overcome inertial forces against that of the total forces and it is expressed as 18 α b q 2 a q b q 2 the critical point between the linear and nonlinear flow is reached when α 10 beyond which the flow is considered to enter the nonlinear flow regime as suggested in a number of studies before zimmerman et al 2004 zeng and grigg 2006 the condition of α 10 is also adopted in this study to quantitatively estimate the critical reynolds number re c for different fractured samples when α 10 substituting eq 18 into eq 8 yields 19 r e c a ρ 9 b μ w by substituting eq 16 into eq 19 and using the relation a 12 μ w e h 3 the following equation is obtained 20 r e c 5 229 c log σ 2 e h 0 2 as one can see the critical reynolds number depends largely on the fracture geometries eq 20 provides a mathematical prediction using the dimensionless best fitting parameter c hydraulic aperture e h and the standard deviation of the secondary roughness σ ii to quantitatively evaluate the critical reynolds number re c for fluid flow through a srf to verify the proposed equation the experimental values of the critical reynolds number re c are calculated by eq 19 with the best fitted values of coefficients a and b for each fractured sample which are listed in table 1 the comparison of the experimental and theoretical values of the critical reynolds number re c for all fractured samples are shown in fig 17 the average estimation error is also calculated with a method similar to eq 17 and the average estimation error of 5 7 is obtained the high accuracy means that eq 20 matches the experimental data very well and can be expected to predict the critical reynolds number re c in related fracture flow problems a point to note is that many previous studies reported critical re numbers for rough walled fractures with magnitudes smaller typically 1 than those shown in fig 17 brush and thomson 2003 konzuk and kueper 2004 radilla et al 2013 javadi et al 2014 we think the main reason resulting in the discrepancy is that the geometries of the fractures used in those studies are different from our experiment for example the hydraulic apertures identified by eq 6 are about 7 μm to 0 2 mm for all experimental cases in javadi et al 2014 which is much smaller than our results 0 06 mm to 1 10 mm the larger hydraulic aperture in this study can be attributed to the absence of normal stress in addition the use of different types of fractured specimens and inconsistent definition criteria for re c may cause this discrepancy as well 6 discussions in natural setting flow in rock fractures may vary from laminar to turbulent states under constrains of various pressure flow rate and fracture geometry it can be seen from eqs 5 and 6 that the nonlinear coefficient is responsible for the nonlinearity of the flow in this study we present new models to link the nonlinear flow behavior and fracture geometry while the latter is quantified by two parameters c and σ ii the satisfactory prediction ability of the proposed modes for experimental data in turn proves that these two parameters can characterize the fracture geometry well while dealing with fracture flow problems to further investigate the impact of fracture geometry on nonlinear flow parameter analyses are conducted based on eq 13 with relative changes 50 25 25 50 of the benchmark value of c and σ ii which are equal to the average value of 50 experimental samples c 7 147 σ ii 0 09 mm fig 18 plots the predicted variation of nonlinear coefficient β with e h at different values of c and σ ii respectively the results imply that the nonlinear coefficient β is very sensitive to c and σ ii especially for lower value of e h the coefficient β decreases drastically with the increase decrease of c σ ii at the same e h it also can be seen that compared with c the change of curves with relative changes of σ ii is smaller which means that the nonlinearity of fluid flow in a srf is more likely to be caused by uneven aperture distributions similar conclusions can also be obtained from other research results zhang and nemcik 2013b zou et al 2017 besides one can find from fig 18 that the difference among the values of β for different values of c and σ ii decreases with increasing e h indicating that the fracture geometry becomes less important when e h is large enough the parameter analyses above suggest that a reasonable estimation of c and σ ii would be crucial to accurately describe the nonlinear flow in rock fractures besides the proposed two parameters are expected to be useful for evaluating heat transfer and solute transport in rock fractures as well as those processes are also greatly associated with the fracture geometry he et al 2016 vilarrasa et al 2011 he et al 2019 over the past several decades a variety of instruments and methods have been developed to measure rock discontinuity topography in situ and in the laboratory tatone 2009 however the acquisition of aperture distributions of a rock fracture in the field remains an open issue that needs to be further investigated although a reliable method for measuring the aperture distributions of a srf is proposed in this study this method is only applicable to the case where the aperture distributions do not change during the experiment it can be seen from section 5 that all the coefficients in the models proposed in the study are independent of the fracture geometries except c and σ ii the favorable feature of these models makes it possible to inversely calculate the value of c with the flow data to serve this purpose the comparison between the measured parameter c and the inversely calculated values by eq 16 with the flow data is shown in fig 19 the high degree of matching between them indicates that this method can serve as a reliable choice to obtain the parameter c it should be noted that this does not mean that the models proposed in this study can be used directly to inversely calculate the parameter c in the field because these models are obtained at laboratory scales there are other factors such as weathering and alteration that cannot be simulated because we cannot simulate actual geological time in the laboratory weathering occurs on fractures in all lithologies and will have the effect of smoothing fracture surfaces as can be seen from the above analysis in this article this effect will increase the value of c and reduce the value of σ ii of the fracture which reduces the nonlinearity of fluid flow in the fracture on the other hand weathering processes alter mineralogical physical and mechanical properties of rocks selby 1993 for example with the increasing grade of the weathering the number of micro cracks and voids increases which increases the permeability of the rock khanlari et al 2012 ciantiaa and castellanzab 2016 severe weathering can even transform a hard rock into non cohesive residual soil in these cases the rock matrix may not be considered impermeable which causes the fracture flow to become more unpredictable in the future field experiments of fluid flow in rock fractures will be conducted to further improve and expand the proposed model and weathering and other effects will be considered in summary upscaling the laboratory results to field scale problems with natural fracture systems is still an outstanding research topic and needs to be further explored chen et al 2015 neuville et al 2012 nevertheless the physical laws which govern the flow behavior in a srf would not change for rock fractures of different scales and positions therefore the proposed models may still provide an important guidance for further development or extension to field scale flow problems 7 conclusions in this study a large number of flow tests are conducted on 50 fractured samples with different fracture geometries mainly for quantitatively evaluating the influence of fracture geometries on nonlinear flow behaviors in a srf it is demonstrated that the forchheimer equation adequately describes the nonlinear deviation for fluid flow through a srf with rough walls and variable apertures but its nonlinear coefficient needs to be further determined by quantifying the fracture geometries by considering the combined effects of the aperture distribution and the surfaces roughness on nonlinear flow in a srf two parameters which characterize the geometric characteristics of the fracture are proposed one is the dimensionless fitting parameter c which is suggested to represent the degree of heterogeneity fluid flow in the fracture with a relatively high value of c leads to less tortuous streamlines and a low degree of nonlinearity another one is the standard deviation of the secondary roughness σ ii which represents the effect of surface roughness after this an equation that relates the nonlinear coefficient to the proposed two geometrical parameters is arrived based on which the friction factor nonlinear flow model and the critical reynolds number re c are also represented by the fracture geometric characteristics the reliability of these proposed equations is examined based on the test results this study presents the first attempt to conduct a quantitative analysis on fracture geometries by considering its effect on fracture flow the proposed models offer an explicit quantitative criterion for evaluating the nonlinearity flow in a srf with any mated states the methods and results are expected to be useful to geologists and hydrologists who focus on rock aquifer systems credit authorship contribution statement guan rong conceptualization methodology supervision jie tan data curation methodology writing original draft writing review editing hongbin zhan conceptualization software writing review editing renhui he methodology validation ziyang zhang validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national natural science foundation of china grant nos 41772305 and 51579189 and the china scholarship council csc grant number 201906270116 these supports are gratefully acknowledged the constructive comments made by the editors and anonymous reviewers are very helpful for us to revise the manuscript and we thank them for their inputs 
5232,this study focuses on the nexus between coal mining and water storage analyzing the strategies to reduce the negative effects of exhausted abandoned mining sites on catchments where water reservoirs are located sediment management represent a key point to promote sustainable water resources development and it is strictly connected with the proper management of land use change especially in the areas devoted to mining activities the presence of a reservoir represents a major challenge because these structures are threatened by the rapid loss of storage volume due to excessive sedimentation the case of san cipriano reservoir in central italy represents an ideal set to explore the effects of mining on water storage because it is located at the outlet of a catchment strongly influenced by one of the most important lignite mine in central italy the soil water assessment tool swat is used to evaluate different scenarios of mine decommissioning aiming at supporting the identification of the best strategies to avoid reservoir sedimentation two scenarios of environmental restoration of the mining area are evaluated in the first case the ongoing reforestation with native plants like oaks and deciduous trees is analyzed in the second scenario the authors focus on the evaluation of a wider landscape restoration project including reforestation and river bodies rehabilitation recently drafted by local institutions the results provide a quantitative evaluation of the effectiveness of the proposed strategies in reducing the impacts of existing mining sites from a hydrological perspective in particular the analyzed scenarios show that afforestation and river restoration lead to a strong reduction of sediment yield while downward trend occurred for water yield keywords land use change hydrosedimentological modelling swat soil erodibility reservoirs silting mining site decommissioning 1 introduction coal based power plant represented one of the pillars of the italian energy system up to the 70 s bartoletto and rubio 2008 supporting the development of the country postwar economy magazzino 2014 the necessity of energy for the reconstruction and the development of new industrial production led to the exploitation of the country most available energy sources and new coal mines were initiated throughout italy according to the italian agency for environmental protection apat agenzia per la protezione dell ambiente e per i servizi tecnici mining census active mines in italy reached their peak in the 50 s and their development was associated to the construction of several coal based thermal plants that included new reservoirs to serve the electricity generation apat 2005 the coal mining of the first half of the 20th century caused significant environmental impacts due to the change in land use that affected the existing ecosystems determining a radical transformation on the landscape functionality chadwick et al 2013 in the second half of 20th century coal use started to decrease reflecting the european generalized decreasing trend li et al 2019 at present electricity generation from coal represents around the 13 of the total energy produced in italy littlecott and schwartzkopff 2015 the energy national strategy supported the conversion of the existing coal based plants to more sustainable production systems but the retirement of mining sites became a major challenge also due to an incomplete policy support littlecott 2017 on one hand there is the necessity of minimizing the social and economic consequences of restructuring and the reducing the coal industry rabanal 2003 on the other hand the necessity to identify the appropriate restoration measures to handle landscape change and minimize the associated environmental impacts zhengfu et al 2010 water management plays a key role for determining strategies to reduce these impacts e g necessity of restoring natural drainage patterns implementing flood control measures and restoring hydrological natural behavior mchaina 2001 fundamental aspects are certainly represented by the runoff variation guo et al 2019 and the proper sediment management that influences both the quality of water bodies e g sediment concentration and load rates bonta 2000 and the functionality of existing hydraulic structures annandale 2006 schleiss and boes 2011 different framework have been developed tiwary 2001 fox 2009 and models such as the soil and water assessment tool swat arnold et al 1998 and the water erosion prediction project wepp nearing et al 1989 have been applied to evaluate the soil erosion sedimentation processes and to analyze the effect of land use changes on hydrological processes in different contexts e g li et al 2009 du et al 2013 krysanova and srinivasan 2015 daramola et al 2019 mosbahi and benabdallah 2020 although various case studies dealt with reservoir silting and associated mitigation strategies de araujo et al 2006 haregeweyn et al 2012 djebou 2018 tadesse and dai 2019 the nexus between coal mining and reservoir capacity remains an important aspect to be investigated in order to identify the proper intervention strategies determining the effectiveness of rehabilitation works is particularly difficult due to the complexities in modelling the transformation of the disturbed sites doley and audet 2013 moreover a focus on reservoir silting due to mining sites and the evaluation of the effectiveness of mitigation measures is a non common aspect that need to be tackled especially because the lack of quantitative data related to erosion phenomena walling and webb 1996 betrie et al 2011 the objective of this study is to give quantitative evidence of the effects of mining on reservoir silting and above all to evaluate the effects of decommissioning strategies on sediment management historical reconstruction and data collection were carried out to set up the swat hydro sedimentological model for the specific case study of san cipriano lake the model was used to simulate a baseline scenario and two development scenarios representing different landscape settings from the ongoing natural reforestation to a sound rehabilitation of the area a brief description of the study area is given in the next section followed by a discussion of the methodology used and the scenarios analyzed the fourth and fifth sections present the model results and discussion of different intervention scenarios finally the conclusion summarizes the main findings highlighting how they can support the implementation of sustainable sediment and water resources management in the region 2 overview of the study area in 1940 cavriglia municipality tuscany region arno river basin had the most important lignite mines in central italy called castelnuovo dei sabbioni in 1955 an industrial plan for the development of the area began with the realization of new open cast mines and the construction of a coal based power plant between 1956 and 1958 an earth dam was built in the valley to intercept the san cipriano creek and its tributaries upstream catchment 16 km2 creating a reservoir that assured the power plant with the necessary water amount i e san cipriano lake 700 314 e 4827994 n at the day of its completion the earth dam of 16 5 m height assured a total storage capacity of 3 660 000 m3 fig 1 the mining activity continued for decades bringing to exhaustion the various veins of lignite that were among an area of around 700 ha on march 1994 the last excavation machine still in use was stopped at the closing date the earth movements were in the order of 390 million cubic meters of barren land and 40 000 tons of lignite the nearby power plant was converted to the natural gas in 2007 and the reservoir continued to fulfil the central water needs while also assuring an extra volume for flood peak reduction since its construction the san cipriano lake started suffering of high sedimentation due to the expanding mining site area the area is characterized by a mountainous or high hilly complex with a predominantly arenaceous substratum in which the deciduous forests represent 65 of the total coverage of the area the area nearby the reservoir consists of a lake origin sedimentary complex with clays and clayey sands belonging to the pliocene besides the mines the land use is mainly characterized by woods and cultivated lands fig 2 the situation started to recover with the end of the mining activities associated with the natural process of reforestation sedimentation in any case continued to represent a major concern because of its strategic importance of the reservoir for the nearby thermal plant and the implication that sediment have on reservoir water quality indeed mines can contribute significantly to water quality degradation also after their reclamation lindberg et al 2011 according to the 2017 annual publication made by the regional agency for environmental protection of tuscany arpat 2017 the lake has moderate ecological and bad chemical status monitoring period 2013 2015 referring to the köppen and geiger climate classification rubel et al 2017 the study area is placed in the csa category i e in a temperate climate zone characterized by hot and dry summers as shown in fig 3 with the average rainfall and temperature data over the 1991 2016 time period 3 materials and methods 3 1 modelling approach the hydrosedimentological balance is made using the swat 2012 model swat is a continuous time semidistributed hydrological model with a daily time step it is a versatile tool for watershed assessments particularly when it is used to deal with rainfall runoff and erosion processes for this reason it can be very useful to describe with high efficiency the hydrological processes under changing environments breuer et al 2009 the model divides the river basin into sub basins and can simulate many components hydrology climate soils land management plant growth pesticides and the nutrients cycle in each subbasin homogeneous subzones i e hydrological response units hru are identified with a unique combination of land use soil and slope features arnold et al 1998 arnold and fohrer 2005 for each hru the water balance is calculated as follows 1 s w t s w o i 1 t r d a y q s u r f e a w s e e p q g w where s w t final water content in the soil mm s w o initial water content in the soil mm t time days r d a y rainfall depth in the i th day mm q s u r f run off discharge in the i th day referred to a unitary area mm e a evapotranspiration in the i th day mm w s e e p entry water in the vadose zone from the terrain profile in the i th day mm q g w return flow in the i th day mm the run off is primarily evaluated for each hru and then is calculated for the entire river basin the river basin subdivision into an optimal number of hru strauch et al 2016 makes the model able to efficaciously represent the specific behavior of the different soils and land use combinations if reservoirs are included in the model the main characteristics reservoir surface area and associated water volume must be included in the model and the water volumes balance is calculated according to the following equation 2 v v s t o r e d v f l o w i n v f l o w o u t v p c p v e v a p v s e e p where v is the volume of water in the impoundment at the end of the day m3 vstored is the volume of water stored in the water body at the beginning of the day m3 vflowin is the volume of water entering the water body during the day vflowout is the volume of water flowing out of the water body during the day m3 vpcp is the volume of precipitation falling on the water body during the day m3 vevap is the volume of water removed from the water body by evaporation during the day m3 and vseep is the volume of water lost from the water body by seepage m3 regarding the erosive process caused by the rainfall swat applies the modified universal soil loss musle equation williams 1975a b that is a modified version of usle equation wischmeier and smith 1965 with its rainfall factor replaced by a runoff factor 3 s e d 11 8 q s u r f q p e a k a r e a h r u 0 56 k u s l e c u s l e p u s l e l s u s l e c f r g where sed sediment production in a day ton q s u r f run off volume mm ha q p e a k peak run off discharge m 3 s a r e a h r u hru area ha k u s l e usle soil erodibility factor 0 013 ton m 2 hr m 3 ton cm c u s l e usle cover and management factor dimensionless p u s l e usle support practice factor dimensionless l s u s l e slope length factor dimensionless cfrg coarse fragment factor dimensionless the equation that describe the sediment solid transport within the drainage network is the simplified version of bagnold s 1977 definition of stream power 4 c o n c s e d c h m a x s p c o n v c h p k s p e x p where c o n c s e d c h m a x maximum transportable concentration by water ton m 3 or kg l s p c o n linear parameter for calculating the maximum amount of sediment that can be re entrained during channel sediment routing spcon in swat v c h p k water velocity within the channel m s s p e x p exponent parameter for calculating sediment re entrained in channel sediment routing the model was run for the period 1999 2016 with the first 3 years skipped for model stabilization 3 2 model input the swat model is used to study the influence that mining activities have on the variation of soil erosion conditions and subsequently on the reservoir silting table 1 summarizes the data inputs used to model the hydrological functioning of the basin land use data come from the 2013 corine land cover project and from the regional database created by the lamma consortium environmental monitoring and modelling laboratory regarding the soil data is taken from the carta dei suoli della regione toscana made by the geotechnology center of the university of siena and the lamma consortium in 2013 meteorological data by tuscany region meteorological database were used with a spatial distribution that is representative of the case study area lamole 690200 e 4824600 n montevarchi 708089 e 4823847 n to ensure the rainfall dataset had the fewest missing data some data belonging to neighboring rain gauges is added in the dataset to cover the entire simulation period nusenna in chianti 704885 e 4814160 n il palagio 696070 e 4831975 n radda in chianti 690 738 e 4817059 n the sedimentation rate in the san cipriano lake was estimated on the basis of the bathymetric surveys by the company that is managing the energy production in the area and that controls dam maintenance and monitoring 3 3 model calibration aiming at adequately reproducing the sediment transport and deposition in the san cipriano lake the swat model was calibrated to reproduce the sediment yield in the catchment and the sediment transport in the river reaches up to the reservoir despite the surface runoff represents one of the main determinants of the erosion and sediment transport to the reservoirs calibration and validation of the discharge were not possible due to the lack of reliable measurement on the san cipriano creek however the model parameters for soil and land use were based on previous studies using swat in the arno river basin rossi 2007 pacetti 2018 assuring the correct representation of the main hydrological processes occurring in the catchment moreover calibration of flow is not essential for the swat model to determine the relative change induced by land use modification on the main hydrological processes niraula et al 2015 castelli et al 2017 as presented in the result section the model calibration was based on the sediment deposition measurements in the san cipriano lake provided by the reservoir management company using the bathymetric data it was possible to calculate the sediment volumes settled within the lake in the period contained between two consecutive surveys the bathymetries were measured in the years 2002 may 2011 may and 2016 july and therefore it is possible to determine 2 different volumes of reservoir silting related to the period 2002 2011 and 2011 2016 table 2 since only an estimation of the average sedimentation between the two measurement campaigns is possible the calibration of the model is obtained aiming at the convergence of the mean annual silting rate in particular the model is calibrated using the silting volume of the 2011 2016 interval as the land use data refer to the year 2013 and it would not be representative for the previous period according to existing literature oeurng et al 2011 xu et al 2009 arnold et al 2012 djebou 2018 a manual procedure was set up to determine the most sensitive parameters and to perform the model calibration firstly a sensitivity analysis on the parameters connected to the sediment transport in the river channel according to the bagnold simplified approach eq 4 for sediment routing the swat exponential parameter for calculating the channel sediment routing spexp the linear parameter for calculating the maximum amount of sediment that can be entrained during channel sediment routing spcon the peak rate adjustment factor for the sediment routing prf the channel cover factor ch cod and the channel erodibility factor ch erod were considered the parameters spexp and spcon resulted to be the most sensitive and were selected for the model calibration while the other parameters were fixed within reasonable values ranges xu et al 2009 el sadek and irvem 2014 in particular ch cod and ch erod were defined as 0 5 and 0 8 representing a sparsely vegetated channel with low resistance to erosion while the prf was set up to 1 6 an iterative calibration was performed to fine tune the parameters chosen in the sensitivity analysis aiming at minimizing the relative error on the estimation of sediment input at the reservoir feyereisen et al 2007 5 r e x t s obs x t s mod θ x t s obs x t 100 where re x t is the error at point x and the time interval t sobs x is the sediment transport measured at point x and time t smod θ x t is the estimate of sediment transport through a set of parameters θ the calibration objective was to lower re under a 3 threshold that is defined as the convergence criteria to conclude the iteration the initial and final values for the parameters considered in the calibration are reported in table 3 3 4 catchment management intervention scenarios 3 4 1 baseline scenario the first swat model refers to the baseline reference i e present situation and it is calibrated according to the sedimentation measures of the period 2011 2016 over the decades mining activity led to the complete distortion of the river network upstream to the lake streams buried river diversions and canalization therefore it was necessary to make dem adjustments and corrections to identify the real hydrographic network of the site and to efficiently analyze the surface runoff the various channels and deviations necessary for an hru correct estimation are reported in the dem according to satellite images and historical documents fig 4 the land use utilized in the baseline scenario i e the 2013 land use map published by tuscany region table 1 shows how the end of mining activities determine the beginning of a natural reforestation process however large area in the central part of the catchment that still suffers the effects of the past mining activity being the fertile substrate covered over the years by the waste rocks of the mine fig 6a 3 4 2 first development scenario renaturation the purpose of this development scenario is to analyze how much the solid material contribution can vary within the san cipriano reservoir by modifying only the land use of the former mining areas after the calibration of the model for the baseline scenario the land use characteristics is changed to represent a possible renaturation of the area occupied by the exhausted mines this scenario of intervention consists in the conversion of the mining site with deciduous and oak forests native plants of the place part of the mining area is also converted into agricultural land therefore the main changes consist in the transformation of the mining area of the previous model i e mine land use in areas characterized by the presence of oak other deciduous forests and agriculture respectively oak frsd and agrl in fig 6b all the other conditions dem pedology climate and rainfall data and calibrated parameters for the solid transport have not varied compared to the previous model 3 4 3 second development scenario landscape restoration while in the first development scenario the river network is left unchanged maintaining canalizations and deviations carried out during the last century in the second scenario a complete restoration of the area is hypothesized also changing the structure of the river network while maintaining same land use data of the renaturation scenario i e first scenario the first hypothesis is the deviation of the water coming from the mountain sub basins towards allori lake which is located upstream of the lake of san cipriano in red in fig 5 allori lake is managed by the same company in charge of san cipriano lake monitoring and maintenance the reservoir has a total volume of 2 000 000 m3 the second hypothesis is the rehabilitation of the meleto reach which was buried in the past downstream of allori lake in green in fig 5 changing the river network the catchment area of the san cipriano lake is larger in this scenario increasing from 16 km2 to 22 km2 the land use of the new part of the catchment was developed planning the creation of a forested area around allori lake fig 6 c the pedology used in this scenario is the same as the previous ones apart from the extension 4 results 4 1 calibration and baseline scenario the total volume of sediment in the 2011 2016 period at the san cipriano reservoir was targeted in the calibration of the baseline model the results i e 60 000 m3 show a good accordance with the silting rate evaluated through the bathymetric data i e 62 000 m3 this underlines the validity of the used modelling approach and its efficacy in representing the erosion processes occurring in the catchment and the consequent reservoir silting rate the simulated silting rate at san cipriano lake differs only by 3 from the measured value after the calibration of the model the mean annual sedimentation in the san cipriano lake is obtained for all the years within the observation period fig 7 sedimentation values vary over time due to different annual precipitation distribution indeed the annual precipitation of the wettest year is 1106 mm in the 2013 while the lowest value of cumulated precipitation is in the 2011 516 mm the average value obtained in the model i e 11625 m3 yr is in accordance with the measured volumes 12 000 m3 yr table 2 for a more detailed analysis of the effects produced by the land use change soil loss is calculated for each sub basin to highlight which land use category is more influential on the lake silting the fig 8 shows the results in terms of annual cubic meters of soil lost per hectare the subbasins with the greater contribution on the lake silting are those that had mining activity in the past subbasins 7 11 12 and those occupied vineyards subbasin 3 with erosion values even up to 35 m3 yr per hectare the lower values are characterized by wooded areas both hilly and mountainous bordering the lake of san cipriano 4 1 1 first development scenario in the first development scenario the sedimentation values at the san cipriano lake closing section are much lower than the baseline scenario with an average annual silting rate of 5442 m3 yr the effects of reforestation in sediment reduction are spread in the entire basin but if we look at the subbasin scale results it appears evident a clear erosion decrease in the central area of the catchment previously occupied by the mining site subbasins 7 11 and 12 in fig 8 the maximum great soil loss around 25 m3 ha yr is registered in the subbasin where the presence of vineyards is predominant subbasin 3 fig 9 all other sub basins have low erosion values that ranges between 1 and 10 m3 ha yr 4 1 2 second development scenario also in this second scenario the results show a decrement of soil loss comparing with the first development scenario the simulated annual silting rate of this scenario is 2968 m3 yr this additional reduction is associated to the new river network layout that influence the hydrological behavior of the basin as shown in fig 10 the of the annual soil loss for the various sub basins ranges between 1 to 14 m3 ha yr 5 discussion two different environmental development scenarios of the mining areas have been modelled on swat the scenarios integrate the already ongoing adaptation process in the catchment after mine abandonment and that emerges comparing the mean annual silting rate of the 2002 2011 period with the baseline 2012 2016 period in table 2 a 49 5 reduction on sediment transport within the reservoir is registered also in the baseline scenario even if no specific rehabilitation intervention took place this is mainly due to the natural reforestation process started with the end of the mining activities that led to a progressive reduction over time of the sediments eroded by the mining activity area indeed this reduction is not linked with a diminishing in the run off volumes since the mean annual precipitation map has been greater in the second period fig 11 nevertheless a stronger reduction in the mean annual silting rate is evident if renaturation actions take place in the basin 76 3 of silting rate reduction in the first scenario fig 12 since the baseline and the first renaturalization scenarios differ only in the land use precisely in the entire reforestation of former mining areas the difference in sedimentation loss can be clearly explained by the mining area conversion these results confirm the evident impacts of mining activity on soil loss firstly and on reservoirs storage reduction secondarily on the other hand the results also show how environmental interventions can be a useful technique in the water resource management as they preserve the reservoirs capacity comparing the first and the second development scenarios the landscape restoration produce an additional reduction of mean annual silting rate within the reservoir despite the river basin area increase from 16 to 22 km2 in this scenario on a yearly average the amount of sediment in the san cipriano reservoir drop to 2968 m3 yr determining a diminution of 87 compared to the silting rate registered before mining decommissioning therefore interventions involving landscape restoration including river network restoration can have a greater effect on the sediment reduction than just the land use reconversion in this scenario the reduction is also influenced by the allori lake position which reduces the sediment contribution inside san cipriano reservoir acting as a settling tank slowing down of the water coming from the upstream areas and a reduction on the solid transport capacity of eroded materials the annual average sedimentation in the allori lake is estimated around 370 m3 yr with a total silting volume in the period 2011 2016 of 2000 m3 although the mean annual silting rate is the main aspect investigated in this work the analysis of the other model outputs can provide a more general idea of the modification that the two scenarios make on the hydrological cycle fig 13 shows the percentage variations in terms of sediment production surface runoff evapotranspiration and water yield between the two scenarios and the baseline these variations are averaged over the period 2011 2016 on a monthly time step in addition to the reduction of sediment transport described in the previous section the outputs show that in both scenarios the evapotranspiration increases while the water yield decreases the growth of evapotranspiration is clearly attributable to an increase in the river basin vegetation as well as the decrease of water yield can be linked to the afforestation as described widely in other studies e g belluscio 2009 filoso et al 2017 the increase of evapotranspiration can be also correlated to the reduction mean amount of water that percolate towards the aquifer especially in summer period the mean estimated reduction ranges of percolation varies between 10 and 12 in line with other estimation silveira et al 2016 comparing the discharge in the reservoir results underline a slight reduction in the first intervention scenario especially during low flow period also this effect can be connected to the regulating services provided by forests as already proven in other studies e g farley et al 2005 buendia et al 2016 on the other hand the second scenario highlights a large increase in reservoir inflow due to the new river network layout that determines a larger catchment contributing to the reservoir it has to be noted that the results may be affected by the scarcity of data for calibration that allow only for a simplified calibration procedure where the error is treated as a single lumped additive variable beven 2006 even with scarce data availability swat model confirmed to be a valuable tool to carry out a practical assessment of the sediment load to reservoirs tadesse and dai 2019 and to provide useful insights on the effects of different land use management scenarios daramola et al 2019 zhang et al 2019 if compared to other chemical and mechanical methods the contaminated areas naturalization with native trees plantation represent a less environmental disruptive and more economical method favas et al 2014 the results demonstrate also its effectiveness to reduce the negative consequences of exhausted abandoned mining sites on catchments where water reservoirs are located other important aspect such as water quality should be included in the environmental assessment to have a complete picture of the decommissioning effect indeed abandoned mining sites often give rise to polluted soil and water and this can continue for a long period after the mining site closing bell and donnelly 2006 however the reduction of solid transport obtained in the re naturalization scenarios can be also linked to a gradual improvement of water quality at least for some metals and ions related to mining operations bonta 2000 lindberg et al 2011 6 conclusion the study provides a detailed analysis of the changes in the hydrological process in two scenarios of environmental restoration of a decommissioned mining area the study shows that swat hydrosedimentological modelling provide adequate estimation of the main hydrological process occurring in the catchment and allowing to identify the sediment dynamics results highlight a strong reduction of sediment yield and detect a decrease in water yield associated to the re naturalization intervention this is due mainly to the effect of reforestation natural or artificial that influence the hydrological cycle inducing an increase of water storage in the soil and determine a reduction in the erosion due to the runoff the model results represent as a valuable a decision support tool that help understanding the effectiveness of different mining decommissioning strategies especially when dealing with reservoir silting credit authorship contribution statement tommaso pacetti conceptualization methodology formal analysis writing original draft marco lompi data curation visualization writing review editing claudio petri data curation methodology enrica caporali conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
5232,this study focuses on the nexus between coal mining and water storage analyzing the strategies to reduce the negative effects of exhausted abandoned mining sites on catchments where water reservoirs are located sediment management represent a key point to promote sustainable water resources development and it is strictly connected with the proper management of land use change especially in the areas devoted to mining activities the presence of a reservoir represents a major challenge because these structures are threatened by the rapid loss of storage volume due to excessive sedimentation the case of san cipriano reservoir in central italy represents an ideal set to explore the effects of mining on water storage because it is located at the outlet of a catchment strongly influenced by one of the most important lignite mine in central italy the soil water assessment tool swat is used to evaluate different scenarios of mine decommissioning aiming at supporting the identification of the best strategies to avoid reservoir sedimentation two scenarios of environmental restoration of the mining area are evaluated in the first case the ongoing reforestation with native plants like oaks and deciduous trees is analyzed in the second scenario the authors focus on the evaluation of a wider landscape restoration project including reforestation and river bodies rehabilitation recently drafted by local institutions the results provide a quantitative evaluation of the effectiveness of the proposed strategies in reducing the impacts of existing mining sites from a hydrological perspective in particular the analyzed scenarios show that afforestation and river restoration lead to a strong reduction of sediment yield while downward trend occurred for water yield keywords land use change hydrosedimentological modelling swat soil erodibility reservoirs silting mining site decommissioning 1 introduction coal based power plant represented one of the pillars of the italian energy system up to the 70 s bartoletto and rubio 2008 supporting the development of the country postwar economy magazzino 2014 the necessity of energy for the reconstruction and the development of new industrial production led to the exploitation of the country most available energy sources and new coal mines were initiated throughout italy according to the italian agency for environmental protection apat agenzia per la protezione dell ambiente e per i servizi tecnici mining census active mines in italy reached their peak in the 50 s and their development was associated to the construction of several coal based thermal plants that included new reservoirs to serve the electricity generation apat 2005 the coal mining of the first half of the 20th century caused significant environmental impacts due to the change in land use that affected the existing ecosystems determining a radical transformation on the landscape functionality chadwick et al 2013 in the second half of 20th century coal use started to decrease reflecting the european generalized decreasing trend li et al 2019 at present electricity generation from coal represents around the 13 of the total energy produced in italy littlecott and schwartzkopff 2015 the energy national strategy supported the conversion of the existing coal based plants to more sustainable production systems but the retirement of mining sites became a major challenge also due to an incomplete policy support littlecott 2017 on one hand there is the necessity of minimizing the social and economic consequences of restructuring and the reducing the coal industry rabanal 2003 on the other hand the necessity to identify the appropriate restoration measures to handle landscape change and minimize the associated environmental impacts zhengfu et al 2010 water management plays a key role for determining strategies to reduce these impacts e g necessity of restoring natural drainage patterns implementing flood control measures and restoring hydrological natural behavior mchaina 2001 fundamental aspects are certainly represented by the runoff variation guo et al 2019 and the proper sediment management that influences both the quality of water bodies e g sediment concentration and load rates bonta 2000 and the functionality of existing hydraulic structures annandale 2006 schleiss and boes 2011 different framework have been developed tiwary 2001 fox 2009 and models such as the soil and water assessment tool swat arnold et al 1998 and the water erosion prediction project wepp nearing et al 1989 have been applied to evaluate the soil erosion sedimentation processes and to analyze the effect of land use changes on hydrological processes in different contexts e g li et al 2009 du et al 2013 krysanova and srinivasan 2015 daramola et al 2019 mosbahi and benabdallah 2020 although various case studies dealt with reservoir silting and associated mitigation strategies de araujo et al 2006 haregeweyn et al 2012 djebou 2018 tadesse and dai 2019 the nexus between coal mining and reservoir capacity remains an important aspect to be investigated in order to identify the proper intervention strategies determining the effectiveness of rehabilitation works is particularly difficult due to the complexities in modelling the transformation of the disturbed sites doley and audet 2013 moreover a focus on reservoir silting due to mining sites and the evaluation of the effectiveness of mitigation measures is a non common aspect that need to be tackled especially because the lack of quantitative data related to erosion phenomena walling and webb 1996 betrie et al 2011 the objective of this study is to give quantitative evidence of the effects of mining on reservoir silting and above all to evaluate the effects of decommissioning strategies on sediment management historical reconstruction and data collection were carried out to set up the swat hydro sedimentological model for the specific case study of san cipriano lake the model was used to simulate a baseline scenario and two development scenarios representing different landscape settings from the ongoing natural reforestation to a sound rehabilitation of the area a brief description of the study area is given in the next section followed by a discussion of the methodology used and the scenarios analyzed the fourth and fifth sections present the model results and discussion of different intervention scenarios finally the conclusion summarizes the main findings highlighting how they can support the implementation of sustainable sediment and water resources management in the region 2 overview of the study area in 1940 cavriglia municipality tuscany region arno river basin had the most important lignite mines in central italy called castelnuovo dei sabbioni in 1955 an industrial plan for the development of the area began with the realization of new open cast mines and the construction of a coal based power plant between 1956 and 1958 an earth dam was built in the valley to intercept the san cipriano creek and its tributaries upstream catchment 16 km2 creating a reservoir that assured the power plant with the necessary water amount i e san cipriano lake 700 314 e 4827994 n at the day of its completion the earth dam of 16 5 m height assured a total storage capacity of 3 660 000 m3 fig 1 the mining activity continued for decades bringing to exhaustion the various veins of lignite that were among an area of around 700 ha on march 1994 the last excavation machine still in use was stopped at the closing date the earth movements were in the order of 390 million cubic meters of barren land and 40 000 tons of lignite the nearby power plant was converted to the natural gas in 2007 and the reservoir continued to fulfil the central water needs while also assuring an extra volume for flood peak reduction since its construction the san cipriano lake started suffering of high sedimentation due to the expanding mining site area the area is characterized by a mountainous or high hilly complex with a predominantly arenaceous substratum in which the deciduous forests represent 65 of the total coverage of the area the area nearby the reservoir consists of a lake origin sedimentary complex with clays and clayey sands belonging to the pliocene besides the mines the land use is mainly characterized by woods and cultivated lands fig 2 the situation started to recover with the end of the mining activities associated with the natural process of reforestation sedimentation in any case continued to represent a major concern because of its strategic importance of the reservoir for the nearby thermal plant and the implication that sediment have on reservoir water quality indeed mines can contribute significantly to water quality degradation also after their reclamation lindberg et al 2011 according to the 2017 annual publication made by the regional agency for environmental protection of tuscany arpat 2017 the lake has moderate ecological and bad chemical status monitoring period 2013 2015 referring to the köppen and geiger climate classification rubel et al 2017 the study area is placed in the csa category i e in a temperate climate zone characterized by hot and dry summers as shown in fig 3 with the average rainfall and temperature data over the 1991 2016 time period 3 materials and methods 3 1 modelling approach the hydrosedimentological balance is made using the swat 2012 model swat is a continuous time semidistributed hydrological model with a daily time step it is a versatile tool for watershed assessments particularly when it is used to deal with rainfall runoff and erosion processes for this reason it can be very useful to describe with high efficiency the hydrological processes under changing environments breuer et al 2009 the model divides the river basin into sub basins and can simulate many components hydrology climate soils land management plant growth pesticides and the nutrients cycle in each subbasin homogeneous subzones i e hydrological response units hru are identified with a unique combination of land use soil and slope features arnold et al 1998 arnold and fohrer 2005 for each hru the water balance is calculated as follows 1 s w t s w o i 1 t r d a y q s u r f e a w s e e p q g w where s w t final water content in the soil mm s w o initial water content in the soil mm t time days r d a y rainfall depth in the i th day mm q s u r f run off discharge in the i th day referred to a unitary area mm e a evapotranspiration in the i th day mm w s e e p entry water in the vadose zone from the terrain profile in the i th day mm q g w return flow in the i th day mm the run off is primarily evaluated for each hru and then is calculated for the entire river basin the river basin subdivision into an optimal number of hru strauch et al 2016 makes the model able to efficaciously represent the specific behavior of the different soils and land use combinations if reservoirs are included in the model the main characteristics reservoir surface area and associated water volume must be included in the model and the water volumes balance is calculated according to the following equation 2 v v s t o r e d v f l o w i n v f l o w o u t v p c p v e v a p v s e e p where v is the volume of water in the impoundment at the end of the day m3 vstored is the volume of water stored in the water body at the beginning of the day m3 vflowin is the volume of water entering the water body during the day vflowout is the volume of water flowing out of the water body during the day m3 vpcp is the volume of precipitation falling on the water body during the day m3 vevap is the volume of water removed from the water body by evaporation during the day m3 and vseep is the volume of water lost from the water body by seepage m3 regarding the erosive process caused by the rainfall swat applies the modified universal soil loss musle equation williams 1975a b that is a modified version of usle equation wischmeier and smith 1965 with its rainfall factor replaced by a runoff factor 3 s e d 11 8 q s u r f q p e a k a r e a h r u 0 56 k u s l e c u s l e p u s l e l s u s l e c f r g where sed sediment production in a day ton q s u r f run off volume mm ha q p e a k peak run off discharge m 3 s a r e a h r u hru area ha k u s l e usle soil erodibility factor 0 013 ton m 2 hr m 3 ton cm c u s l e usle cover and management factor dimensionless p u s l e usle support practice factor dimensionless l s u s l e slope length factor dimensionless cfrg coarse fragment factor dimensionless the equation that describe the sediment solid transport within the drainage network is the simplified version of bagnold s 1977 definition of stream power 4 c o n c s e d c h m a x s p c o n v c h p k s p e x p where c o n c s e d c h m a x maximum transportable concentration by water ton m 3 or kg l s p c o n linear parameter for calculating the maximum amount of sediment that can be re entrained during channel sediment routing spcon in swat v c h p k water velocity within the channel m s s p e x p exponent parameter for calculating sediment re entrained in channel sediment routing the model was run for the period 1999 2016 with the first 3 years skipped for model stabilization 3 2 model input the swat model is used to study the influence that mining activities have on the variation of soil erosion conditions and subsequently on the reservoir silting table 1 summarizes the data inputs used to model the hydrological functioning of the basin land use data come from the 2013 corine land cover project and from the regional database created by the lamma consortium environmental monitoring and modelling laboratory regarding the soil data is taken from the carta dei suoli della regione toscana made by the geotechnology center of the university of siena and the lamma consortium in 2013 meteorological data by tuscany region meteorological database were used with a spatial distribution that is representative of the case study area lamole 690200 e 4824600 n montevarchi 708089 e 4823847 n to ensure the rainfall dataset had the fewest missing data some data belonging to neighboring rain gauges is added in the dataset to cover the entire simulation period nusenna in chianti 704885 e 4814160 n il palagio 696070 e 4831975 n radda in chianti 690 738 e 4817059 n the sedimentation rate in the san cipriano lake was estimated on the basis of the bathymetric surveys by the company that is managing the energy production in the area and that controls dam maintenance and monitoring 3 3 model calibration aiming at adequately reproducing the sediment transport and deposition in the san cipriano lake the swat model was calibrated to reproduce the sediment yield in the catchment and the sediment transport in the river reaches up to the reservoir despite the surface runoff represents one of the main determinants of the erosion and sediment transport to the reservoirs calibration and validation of the discharge were not possible due to the lack of reliable measurement on the san cipriano creek however the model parameters for soil and land use were based on previous studies using swat in the arno river basin rossi 2007 pacetti 2018 assuring the correct representation of the main hydrological processes occurring in the catchment moreover calibration of flow is not essential for the swat model to determine the relative change induced by land use modification on the main hydrological processes niraula et al 2015 castelli et al 2017 as presented in the result section the model calibration was based on the sediment deposition measurements in the san cipriano lake provided by the reservoir management company using the bathymetric data it was possible to calculate the sediment volumes settled within the lake in the period contained between two consecutive surveys the bathymetries were measured in the years 2002 may 2011 may and 2016 july and therefore it is possible to determine 2 different volumes of reservoir silting related to the period 2002 2011 and 2011 2016 table 2 since only an estimation of the average sedimentation between the two measurement campaigns is possible the calibration of the model is obtained aiming at the convergence of the mean annual silting rate in particular the model is calibrated using the silting volume of the 2011 2016 interval as the land use data refer to the year 2013 and it would not be representative for the previous period according to existing literature oeurng et al 2011 xu et al 2009 arnold et al 2012 djebou 2018 a manual procedure was set up to determine the most sensitive parameters and to perform the model calibration firstly a sensitivity analysis on the parameters connected to the sediment transport in the river channel according to the bagnold simplified approach eq 4 for sediment routing the swat exponential parameter for calculating the channel sediment routing spexp the linear parameter for calculating the maximum amount of sediment that can be entrained during channel sediment routing spcon the peak rate adjustment factor for the sediment routing prf the channel cover factor ch cod and the channel erodibility factor ch erod were considered the parameters spexp and spcon resulted to be the most sensitive and were selected for the model calibration while the other parameters were fixed within reasonable values ranges xu et al 2009 el sadek and irvem 2014 in particular ch cod and ch erod were defined as 0 5 and 0 8 representing a sparsely vegetated channel with low resistance to erosion while the prf was set up to 1 6 an iterative calibration was performed to fine tune the parameters chosen in the sensitivity analysis aiming at minimizing the relative error on the estimation of sediment input at the reservoir feyereisen et al 2007 5 r e x t s obs x t s mod θ x t s obs x t 100 where re x t is the error at point x and the time interval t sobs x is the sediment transport measured at point x and time t smod θ x t is the estimate of sediment transport through a set of parameters θ the calibration objective was to lower re under a 3 threshold that is defined as the convergence criteria to conclude the iteration the initial and final values for the parameters considered in the calibration are reported in table 3 3 4 catchment management intervention scenarios 3 4 1 baseline scenario the first swat model refers to the baseline reference i e present situation and it is calibrated according to the sedimentation measures of the period 2011 2016 over the decades mining activity led to the complete distortion of the river network upstream to the lake streams buried river diversions and canalization therefore it was necessary to make dem adjustments and corrections to identify the real hydrographic network of the site and to efficiently analyze the surface runoff the various channels and deviations necessary for an hru correct estimation are reported in the dem according to satellite images and historical documents fig 4 the land use utilized in the baseline scenario i e the 2013 land use map published by tuscany region table 1 shows how the end of mining activities determine the beginning of a natural reforestation process however large area in the central part of the catchment that still suffers the effects of the past mining activity being the fertile substrate covered over the years by the waste rocks of the mine fig 6a 3 4 2 first development scenario renaturation the purpose of this development scenario is to analyze how much the solid material contribution can vary within the san cipriano reservoir by modifying only the land use of the former mining areas after the calibration of the model for the baseline scenario the land use characteristics is changed to represent a possible renaturation of the area occupied by the exhausted mines this scenario of intervention consists in the conversion of the mining site with deciduous and oak forests native plants of the place part of the mining area is also converted into agricultural land therefore the main changes consist in the transformation of the mining area of the previous model i e mine land use in areas characterized by the presence of oak other deciduous forests and agriculture respectively oak frsd and agrl in fig 6b all the other conditions dem pedology climate and rainfall data and calibrated parameters for the solid transport have not varied compared to the previous model 3 4 3 second development scenario landscape restoration while in the first development scenario the river network is left unchanged maintaining canalizations and deviations carried out during the last century in the second scenario a complete restoration of the area is hypothesized also changing the structure of the river network while maintaining same land use data of the renaturation scenario i e first scenario the first hypothesis is the deviation of the water coming from the mountain sub basins towards allori lake which is located upstream of the lake of san cipriano in red in fig 5 allori lake is managed by the same company in charge of san cipriano lake monitoring and maintenance the reservoir has a total volume of 2 000 000 m3 the second hypothesis is the rehabilitation of the meleto reach which was buried in the past downstream of allori lake in green in fig 5 changing the river network the catchment area of the san cipriano lake is larger in this scenario increasing from 16 km2 to 22 km2 the land use of the new part of the catchment was developed planning the creation of a forested area around allori lake fig 6 c the pedology used in this scenario is the same as the previous ones apart from the extension 4 results 4 1 calibration and baseline scenario the total volume of sediment in the 2011 2016 period at the san cipriano reservoir was targeted in the calibration of the baseline model the results i e 60 000 m3 show a good accordance with the silting rate evaluated through the bathymetric data i e 62 000 m3 this underlines the validity of the used modelling approach and its efficacy in representing the erosion processes occurring in the catchment and the consequent reservoir silting rate the simulated silting rate at san cipriano lake differs only by 3 from the measured value after the calibration of the model the mean annual sedimentation in the san cipriano lake is obtained for all the years within the observation period fig 7 sedimentation values vary over time due to different annual precipitation distribution indeed the annual precipitation of the wettest year is 1106 mm in the 2013 while the lowest value of cumulated precipitation is in the 2011 516 mm the average value obtained in the model i e 11625 m3 yr is in accordance with the measured volumes 12 000 m3 yr table 2 for a more detailed analysis of the effects produced by the land use change soil loss is calculated for each sub basin to highlight which land use category is more influential on the lake silting the fig 8 shows the results in terms of annual cubic meters of soil lost per hectare the subbasins with the greater contribution on the lake silting are those that had mining activity in the past subbasins 7 11 12 and those occupied vineyards subbasin 3 with erosion values even up to 35 m3 yr per hectare the lower values are characterized by wooded areas both hilly and mountainous bordering the lake of san cipriano 4 1 1 first development scenario in the first development scenario the sedimentation values at the san cipriano lake closing section are much lower than the baseline scenario with an average annual silting rate of 5442 m3 yr the effects of reforestation in sediment reduction are spread in the entire basin but if we look at the subbasin scale results it appears evident a clear erosion decrease in the central area of the catchment previously occupied by the mining site subbasins 7 11 and 12 in fig 8 the maximum great soil loss around 25 m3 ha yr is registered in the subbasin where the presence of vineyards is predominant subbasin 3 fig 9 all other sub basins have low erosion values that ranges between 1 and 10 m3 ha yr 4 1 2 second development scenario also in this second scenario the results show a decrement of soil loss comparing with the first development scenario the simulated annual silting rate of this scenario is 2968 m3 yr this additional reduction is associated to the new river network layout that influence the hydrological behavior of the basin as shown in fig 10 the of the annual soil loss for the various sub basins ranges between 1 to 14 m3 ha yr 5 discussion two different environmental development scenarios of the mining areas have been modelled on swat the scenarios integrate the already ongoing adaptation process in the catchment after mine abandonment and that emerges comparing the mean annual silting rate of the 2002 2011 period with the baseline 2012 2016 period in table 2 a 49 5 reduction on sediment transport within the reservoir is registered also in the baseline scenario even if no specific rehabilitation intervention took place this is mainly due to the natural reforestation process started with the end of the mining activities that led to a progressive reduction over time of the sediments eroded by the mining activity area indeed this reduction is not linked with a diminishing in the run off volumes since the mean annual precipitation map has been greater in the second period fig 11 nevertheless a stronger reduction in the mean annual silting rate is evident if renaturation actions take place in the basin 76 3 of silting rate reduction in the first scenario fig 12 since the baseline and the first renaturalization scenarios differ only in the land use precisely in the entire reforestation of former mining areas the difference in sedimentation loss can be clearly explained by the mining area conversion these results confirm the evident impacts of mining activity on soil loss firstly and on reservoirs storage reduction secondarily on the other hand the results also show how environmental interventions can be a useful technique in the water resource management as they preserve the reservoirs capacity comparing the first and the second development scenarios the landscape restoration produce an additional reduction of mean annual silting rate within the reservoir despite the river basin area increase from 16 to 22 km2 in this scenario on a yearly average the amount of sediment in the san cipriano reservoir drop to 2968 m3 yr determining a diminution of 87 compared to the silting rate registered before mining decommissioning therefore interventions involving landscape restoration including river network restoration can have a greater effect on the sediment reduction than just the land use reconversion in this scenario the reduction is also influenced by the allori lake position which reduces the sediment contribution inside san cipriano reservoir acting as a settling tank slowing down of the water coming from the upstream areas and a reduction on the solid transport capacity of eroded materials the annual average sedimentation in the allori lake is estimated around 370 m3 yr with a total silting volume in the period 2011 2016 of 2000 m3 although the mean annual silting rate is the main aspect investigated in this work the analysis of the other model outputs can provide a more general idea of the modification that the two scenarios make on the hydrological cycle fig 13 shows the percentage variations in terms of sediment production surface runoff evapotranspiration and water yield between the two scenarios and the baseline these variations are averaged over the period 2011 2016 on a monthly time step in addition to the reduction of sediment transport described in the previous section the outputs show that in both scenarios the evapotranspiration increases while the water yield decreases the growth of evapotranspiration is clearly attributable to an increase in the river basin vegetation as well as the decrease of water yield can be linked to the afforestation as described widely in other studies e g belluscio 2009 filoso et al 2017 the increase of evapotranspiration can be also correlated to the reduction mean amount of water that percolate towards the aquifer especially in summer period the mean estimated reduction ranges of percolation varies between 10 and 12 in line with other estimation silveira et al 2016 comparing the discharge in the reservoir results underline a slight reduction in the first intervention scenario especially during low flow period also this effect can be connected to the regulating services provided by forests as already proven in other studies e g farley et al 2005 buendia et al 2016 on the other hand the second scenario highlights a large increase in reservoir inflow due to the new river network layout that determines a larger catchment contributing to the reservoir it has to be noted that the results may be affected by the scarcity of data for calibration that allow only for a simplified calibration procedure where the error is treated as a single lumped additive variable beven 2006 even with scarce data availability swat model confirmed to be a valuable tool to carry out a practical assessment of the sediment load to reservoirs tadesse and dai 2019 and to provide useful insights on the effects of different land use management scenarios daramola et al 2019 zhang et al 2019 if compared to other chemical and mechanical methods the contaminated areas naturalization with native trees plantation represent a less environmental disruptive and more economical method favas et al 2014 the results demonstrate also its effectiveness to reduce the negative consequences of exhausted abandoned mining sites on catchments where water reservoirs are located other important aspect such as water quality should be included in the environmental assessment to have a complete picture of the decommissioning effect indeed abandoned mining sites often give rise to polluted soil and water and this can continue for a long period after the mining site closing bell and donnelly 2006 however the reduction of solid transport obtained in the re naturalization scenarios can be also linked to a gradual improvement of water quality at least for some metals and ions related to mining operations bonta 2000 lindberg et al 2011 6 conclusion the study provides a detailed analysis of the changes in the hydrological process in two scenarios of environmental restoration of a decommissioned mining area the study shows that swat hydrosedimentological modelling provide adequate estimation of the main hydrological process occurring in the catchment and allowing to identify the sediment dynamics results highlight a strong reduction of sediment yield and detect a decrease in water yield associated to the re naturalization intervention this is due mainly to the effect of reforestation natural or artificial that influence the hydrological cycle inducing an increase of water storage in the soil and determine a reduction in the erosion due to the runoff the model results represent as a valuable a decision support tool that help understanding the effectiveness of different mining decommissioning strategies especially when dealing with reservoir silting credit authorship contribution statement tommaso pacetti conceptualization methodology formal analysis writing original draft marco lompi data curation visualization writing review editing claudio petri data curation methodology enrica caporali conceptualization writing review editing supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
5233,stage discharge rating curves are empirical power functions that represent river dynamics by explaining the temporal variations of river discharge with respect to stage fluctuations the widespread access to measured river discharge and stage at gauging stations in the united states provides a valuable opportunity to perform regionalization techniques and transfer this information to ungauged areas in this study a recently proposed regionalization framework that integrates the behavioral based hierarchical clustering bhc with classification and aggregation namely bhc ca is applied to 128 rating curves in the arkansas white red region to detect homogeneous river reach catchments with similar river dynamics additionally the performance of the bhc compared to commonly used attribute based hierarchical clustering ahc algorithms is tested the bhc ca framework divides the entire study area into three homogeneous clusters creates three regional rating curves and finds a logistic regression with 7 physical climatic attributes as the best classifier for transferring regional rating curves to ungauged catchments results also demonstrate the effectiveness of the bhc and its usefulness as an alternative clustering algorithm for the regionalization of environmental model problems keywords regionalization ungauged basins catchment classification rating curve hydrodynamic modeling 1 introduction river gauging stations are the most reliable sources of river discharge and stage information for hydrologists in the united states the u s geological survey s usgs national water information system nwis provides a comprehensive database that includes the historical time series of the river discharge and stage at specific gauging stations despite the valuable role of this database still a majority of the us rivers are ungauged or poorly gauged due to the high cost of installment operation and maintenance of the gauges sivapalan et al 2003 to address this issue as pertained to inadequate distribution of gauging stations and to take full advantage of the available measured data from the existing database regionalization techniques have been widely used for transferring data from gauged to ungauged catchments in hydrology blöschl and sivapalan 1995 oudin et al 2010 young 2006 three approaches exist in the regionalization of the hydrologic model parameters including regression physical similarity and spatial proximity methods he et al 2011 regression methods develop a relationship between a set of physical climatic characteristics and hydrologic model parameters gibbs et al 2012 heuvelmans et al 2006 merz and blöschl 2004 mwakalila 2003 post and jakeman 1999 seibert 1999 wagener and wheater 2006 xu 2003 while physical similarity and spatial proximity methods search for those catchments that are physically or geographically similar to the ungauged catchment and then transfer the entire model parameter set to the ungauged catchment kay et al 2007 masih et al 2010 mcintyre et al 2005 oudin et al 2010 parajka et al 2005 regression based methods assume that the parameters are independent which is not always true on the other hand physical similarity and spatial proximity methods overcome this limitation of regression methods by transferring the entire parameters as a set a review of regionalization studies that compare these three approaches shows that physical similarity and spatial proximity methods can provide a more reliable set of predictions in many cases bao et al 2012 oudin et al 2008 parajka et al 2005 typically the geographical location of catchments is an important factor in regionalization problems but relying on just spatial proximity may not be adequate in many cases thus we define the similarity based method as a more reliable approach that considers both geographical location and physical characteristics of catchments during the regionalization a similarity based regionalization method consists of two steps 1 detecting homogeneous regions by selecting hydrologically similar catchments 2 transferring the information from gauged to ungauged catchments in homogeneous regions region of influence roi burn 1990 zrinji and burn 1996 and catchment classification mcdonnell and woods 2004 wagener et al 2007 methods are two approaches commonly used to detect homogeneous regions in similarity based regionalization problems in roi similarity is defined by a euclidean distance in the catchment characteristic space and a threshold is assigned to form the region of influence for each ungauged catchment holmes et al 2002 kay et al 2007 mcintyre et al 2005 oudin et al 2010 in catchment classification homogeneous regions are created from clustering catchments using a given set of physical climatic characteristics castellarin et al 2001 laaha and blöschl 2006 ramachandra rao and srinivas 2006 a fundamental assumption behind regionalization methods is that there should be some physical climatic catchment characteristics that explain the hydrological behaviors oudin et al 2010 however finding an appropriate physical climatic similarity metric that reflects the behavioral similarity is subjective and challenging in both roi and catchment classification approaches a distance based similarity metric such as euclidean and a set of physical climatic catchment characteristics are predetermined and assumed as they represent the behavioral similarity one solution to reduce this subjectivity is to couple clustering and classification algorithms so that catchments are clustered based on some catchment response signatures that are more reliable than physical climatic characteristics and then a classifier finds the appropriate physical climatic similarity metric from training the classifier on clustering results brunner et al 2018 this approach is beneficial as it reduces the subjectivity of physical climatic catchment characteristic selection nevertheless it creates a new source of subjectivity related to the appropriate selection of catchment response signatures that represent the behavioral similarity ali et al 2012 boscarello et al 2015 sawicz et al 2011 ssegane et al 2012 yadav et al 2007 recently we proposed a behavioral based hierarchical clustering algorithm bhc that uses a behavioral dissimilarity measure rather than distance based attribute dissimilarity measures for grouping similar catchments we introduced a systematic framework that integrates the bhc with classification and aggregation bhc ca for the regionalization of environmental model parameters jafarzadegan et al 2020 the bhc ca framework aims to address the regionalization for a broad range of environmental modeling purposes although a rich literature exists for the regionalization of hydrologic model parameters and detecting hydrologically similar catchments other water related fields such as hydraulics have rarely focused on regionalization there are distinct differences between the scale and processes involved in hydrology compared to hydraulics in hydrology the computational unit is a catchment a large portion of the land that collects the water from precipitation and directs it to its outlet through the interaction of a series of hydrological processes such as infiltration evapotranspiration and routing in hydraulics modeling however the resolution of simulation is usually much finer than hydrologic problems and the focus is on the river dynamics namely the temporal variation of river stage and discharge along the river corridor typically a river is divided into river reaches where it is assumed that each reach has its own dynamics based on this concept a river reach catchment is defined as a small area that drains the water into a single reach thus this study uses a very high resolution regionalization by transferring information from river rich catchments and assigning the measured discharge and stage data obtained at gauges to their corresponding river reach catchments from a flood modeling perspective integration of hydrology and hydraulics is required to simulate the inundation areas ahmadisharaf et al 2018 jafarzadegan and merwade 2017 nguyen et al 2016 first the hydrological processes are studied in a catchment to estimate the discharge at all rivers then using a finer scale a river catchment is used and the hydrodynamic behavior of each river in converting the river discharge to the stage is investigated along the river corridor the primary goal of this study is to perform the regionalization and detect homogeneous river reach catchments from a hydraulic perspective one approach is to apply the bhc ca framework for a given hydraulic model and then transfer its parameter to ungauged regions hydraulic models simulate the physics of rivers and estimate the water stage for a given set of upstream discharges considering the computational complexity involved in model calibration of each catchment the regionalization of these models which requires a multitude of model simulations in different catchments is cumbersome additionally each hydraulic model has its assumptions so regionalization on a specific model may not necessarily apply to all models and the actual river dynamics to overcome these issues we replace the complex hydraulic models with simple empirical power equations referred to as stage discharge rating curves and regionalize these rating curves to identify homogeneous river reaches with similar dynamics detecting homogeneous river reach catchments from a hydraulic perspective is beneficial for parameterization of hydrodynamic models for flood events analyses two common approaches are to apply either a river based or a distributed parametrization horritt and bates 2002 liu et al 2019 for the former the entire river network is divided into a few rivers and one set of parameters is assigned to each river while the latter assigns a large number of parameter sets as each cell has its parametrization while the river based approach is more efficient due to the low number of parametrizations its accuracy can be concerning because the dynamics of a long heterogeneous river may not be fully simulated by defining a single set of parameters on the other hand the distributed parameterization is an inefficient approach due to its computational complexity and it may also lead to an unsuccessful calibration due to over parametrization the regionalization of rating curves and detecting homogeneous river reaches provide a third parameterization approach for the calibration of hydrodynamic models in this approach the river network is divided into homogeneous river reaches and one single parameter set is assigned to each homogeneous region this approach is advantageous compared to both river based and distributed parametrization methods as it improves the accuracy of modeling compared to a river based parametrization and it will be more efficient than a distributed approach owing to smaller parameter set the literature shows that the regionalization of rating curves has been only limited to few studies that focused on the sediment load estimation in ungauged areas heng and suetsugi 2015 2014 isik 2013 in those studies sediment load rating curves that relate the sediment flux to water discharge were regionalized to the best of our knowledge this is the first study that applies the regionalization on stage discharge rating curves for detecting homogeneous river reaches with similar dynamics in addition this study aims to further investigate the main features of the bhc ca framework including its generic application for different regionalization purposes and its superior performance owing to the behavioral based clustering approach since bhc ca has been only implemented on a floodplain mapping problem jafarzadegan et al 2020 this study tests the generality of this framework by applying it for a different regionalization context related to the river dynamics furthermore there is a potential concern that regardless of the lower subjectivity offered by bhc it may not improve the overall performance of clustering to address this concern this study validates the performance of bhc and compares its efficacy and robustness against commonly used attribute based hierarchical clustering ahc algorithms that use catchment response signatures for clustering 2 study area and data the arkansas white red region is one of the largest regions within the u s territory that covers a portion of 8 central and southern u s states this region is used as the domain of regionalization in this study due to its highly variable topography and climate the western parts of this region in new mexico and colorado are highly elevated areas while the eastern parts in missouri arkansas and louisiana are relatively flat the high heterogeneity in physical climatic characteristics of catchments located in this region provides an attractive opportunity to test and highlight the performance of regionalization frameworks to perform the regionalization 128 river gauges are selected from different geographical locations with various physical climatic characteristics these 128 gauges are finalized after filtering around 250 existing gauges in the region the main criterion for filtering is to remove those gauges with insufficient records of data and those small gauging stations that do not cover an appropriate range of streamflow or stage to show the application of the regionalization framework three ungauged basins from the western central and eastern parts of the region are selected and the bhc ca detects homogeneous regions among more than 1000 river reach catchments within these three basins in fig 1 the geographical location of 128 training gauges and three ungauged basins are shown in the arkansas white red region the main input to the regionalization methods is a set of physical climatic catchment characteristics that should be calculated for each catchment in this study multiple freely available datasets related to the topography climate land cover soil and geology are used to obtain an appropriate list of potential catchment characteristics the river reaches and their catchments are selected from the national hydrography dataset nhd the topographic characteristics of the catchments are calculated from one arc second 30 m dems provided by the united states geological survey s usgs national elevation dataset ned to calculate the climatic characteristics the daily 10 km gpm level 3 imerg precipitation dataset is used for the last two years huffman et al 2015 for land cover characteristics the moderate resolution imaging spectroradiometer modis 8 day dataset with 500 m resolution is used to derive the mean of leaf area index lai and the 2011 national land cover database nlcd with a resolution of 30 m is used for the calculation of roughness coefficient and land use percentages in catchments the soil depth characteristics and the geologic characteristics including the subsurface porosity and permeability are derived from pelletier et al 2016 and global hydrogeology maps glhymps gleeson et al 2014 respectively 3 method in this study the recently proposed bhc ca framework is applied for the regionalization of rating curves within the arkansas white red region in the usa the bhc ca framework consists of three main phases the primary phase is the clustering where a behavioral version of hierarchical clustering algorithms bhc is used to detect homogenous regions of similar catchments then the clustering results are used for classification c and aggregation phases a in the classification phase a classifier relates physical climatic catchment characteristics to the results of bhc the trained classifier can be later used to predict the class of ungauged catchments in the aggregation phase regional models are developed by aggregating the calibrated models of data rich catchments please see jafarzadegan et al 2020 for detailed information about the bhc ca framework the bhc algorithm used in this framework considers the behavioral similarity rather than signature response similarities for grouping the similar catchments to demonstrate the significance of bhc over commonly used ahc algorithms we set up a new set of clustering actions by replacing the bhc with ahc algorithms and compare the overall performance of regional rating curves between both cases 3 1 detecting homogeneous gauged river reach catchments using bhc 3 1 1 model setup an important decision in a regionalization problem is to define the computational unit in hydrology the computation unit is a catchment commonly defined as a hydrologic unit code 8 huc8 and a drainage area that directs a network of streams to its outlet this means that a gauge is treated as the outlet of its catchment and the streamflow information obtained at the gauge location is representative of the entire catchment in hydraulics however the dynamics of two neighboring river reaches can be different therefore a river reach catchment is selected as the computational unit of the regionalization rating curves can be used as simple models of river dynamics because they relate the river flow discharge to the water stage it is assumed that those reaches with similar rating curves reflect a similar dynamic by converting the discharge to the water stage using this concept we calibrate 128 rating curves in the arkansas white red region and implement the bhc to group them based on their behavioral similarity a rating curve model is an empirical power equation defined as 1 q f θ h a h b c where q and h denote the river discharge and water stage respectively f denotes the rating curve model and θ is the vector of three model parameters a b c that should be calibrated at each gauge it is noteworthy that the water stage is measured from an arbitrary datum that varies across the gauges so the role of parameter b is to convert the water stage to the water depth in the rivers h b for each gauge we pick the 30 minute time series of flow and water stage from january 2017 to dec 2018 inclusive and fit the optimum rating curve to find the calibrated parameters due to the nonstationarity of rating curves as they change over a long period we only focus on the last two years of data this period is long enough as it contains a sufficient record of low and high flow information for most gauges in the study area 3 1 2 behavioral hierarchical clustering bhc the core of hierarchical clustering algorithms is a dissimilarity matrix where its elements reflect the amount of dissimilarity between two data points in an attributed based approach a set of attributes is defined and a dissimilarity measure such as euclidean distance estimates the dissimilarity in the attribute space of data points on the other hand the bhc algorithm does not cope with the selection of attributes because it directly estimates the dissimilarity from model transferability between data points considering gauges as data points and rating curves as models the following steps are taken to calculate the dissimilarity between two gauges a rating curve equation is shown in eq 2 where the simulated flow at gauge i q m i is a function of calibrated parameters θ i and water stage h i using eq 3 we calculate q m ij denoted as the simulated flow at gauge i using a rating curve with calibrated parameters at gauge j and stage at gauge i f θ j h i 2 q m i f θ i h i 3 q m ij f θ j h i comparing these simulated flows with the observed flow at gauge i q o i two errors are calculated as follows 4 e ii t 1 n q m i t q o i t 2 5 e ij t 1 n q m ij t q o i t 2 where e ii or e jj referred to as the existing error is the error in gauge i or j when the rating curve is calibrated on the same gauge either i or j and e ij referred to as the cross modeling error is the error when the rating curve calibrated from gauge j is applied to gauge i the net errors at gauges i or j defined as the difference between the cross modeling and existing errors in gauge i j are calculated using eqs 6 and 7 6 δ ij e ij e ii 7 δ ji e ji e jj taking the average of net errors at gauge i and j the dissimilarity measure d ij o r d ji between these two gauges are calculated as follows 8 d ij d ji δ ij δ ji 2 the process of dissimilarity measure calculation eqs 2 8 is repeated for all pairs of gauges to create a 128 by 128 dissimilarity matrix which is the main input to the clustering algorithms we use the average linkage method in the bhc method so that the average of dissimilarity measures between groups is used as the updated dissimilarity measure during the hierarchical clustering process the bhc algorithm finds the pair of gauges or clusters with the highest similarity and joins them repeatedly to create a hierarchical tree of clustered gauges referred to as a dendrogram a dendrogram is the main output of a hierarchical clustering algorithm that visually describes the similarity between data points it shows how similar data points are joined at different levels of the hierarchy to find the point clusters a cutoff is applied to the dendrogram to divide the dataset into similar groups readers are referred to murtagh and contreras 2012 for more details related to the linkage methods and hierarchical clustering procedure 3 1 3 optimum number of clusters one of the main challenges in clustering problems is to decide about the optimum number of clusters although looking at the density of data points in a dendrogram provides useful information about the potential number of clusters a more objective solution is to use a cluster validation index cvi the silhouette index is one of the most common cvis used to find the optimum number of clusters fig 2 shows an illustration of silhouette value calculation for the red data point considering a i as the average distance between object i red data point and other objects in the same cluster average length of of green lines and b i as the average distance between object i and all objects in the nearest cluster average length of orange lines the silhouette value of object i is defined as follows rousseeuw 1987 9 s i b i a i m a x a i b i the silhouette value ranges from 1 to 1 where the higher values reflect a better performance and the negative values indicate a wrong clustering for each object it should be noted that s i 0 if a cluster has only one object the silhouette index is finally calculated by averaging all silhouette values in this study first the silhouette index corresponding to a wide range of clustering numbers is calculated and the optimum number of clusters is determined then the distribution of silhouette values corresponding to the optimum cluster number is plotted for all 128 gauges and the points with negative values are detected finally a correction step is applied so that negative points are transferred to the neighboring clusters until all points provide positive silhouette values the correction step improves the clustering performance for creating the regional rating curves in the aggregation step 3 2 detecting homogeneous ungauged river reach catchments classification phase to apply the regionalization methods in ungauged catchments a set of physical climatic catchment characteristics should be used within a similarity metric the bhc ca framework explores the appropriate physical climatic similarity metric by coupling a classifier to clustering results first an attribute array including potential physical climatic characteristics is calculated for all 128 river reach catchments in this study 26 characteristics related to the catchment location and shape topography climate land use soil and geology and hydrography are calculated table 1 to perform a successful classification the attribute array is normalized using the yeo johnson transformation operator weisberg 2001 and the clustering results provided by bhc are used as the vector of class labels multiple classifiers are trained by mapping the transformed attribute array to the vector of class labels in order to filter 26 attributes and use the n most significant ones we perform the recursive feature elimination rfe technique so that the classifier is fit on all 26 attributes and it recursively eliminates the worst attribute based on the weights calculated by the classifier this process is repeated until the attributes decrease to n numbers https www scikit yb org en latest api model selection rfecv html for example assume a scenario of classification with 10 attributes the rfe initiates the classification for all 26 attributes then the worst classifier is removed depending on the ranking of attributes determined by the classifier the classification is repeated with 25 attributes and it continues until the best 10 attributes are determined by the classifier 3 3 regional rating curves aggregation phase after clustering the gauged river reach catchments based on the behavioral similarity of their rating curves the regional rating curves are created using an aggregation of rating curves that belong to the same cluster considering 128 rating curves clustered into m groups the aggregation phase creates m regional rating curves as they represent the whole set of 128 curves in the study area to keep the maximum information during the aggregation phase we consider the median 20 and 90 percent confidence interval of similar rating curves and create a spread of regional curves that capture the majority of the 128 rating curves 3 4 validating the bhc ca framework this section describes the validation of the bhc ca framework for regionalization of rating curves first we evaluate the bhc performance and compare it against the attribute based hierarchical clustering algorithms ahc to perform the validation the regional rating curves generated by aggregation from either bhc or ahc results are analyzed therefore the focus of this part is on the evaluation of both clustering and aggregation phases in the second part the classification phase is validated using the k fold cross validation cv technique 3 4 1 bhc performance in this section the efficacy of incorporating the behavioral dissimilarity measure within a hierarchical clustering algorithm is outlined a common approach to clustering in gauged catchments is to select some observed flow response signatures at gauges and utilize them as attributes of clustering the selection of these attributes is subjective and the main advantage of using the behavioral similarity is that it directly clusters the catchments without the need to cope with attributes however one hypothesis is that despite the existing subjectivity in the attribute selection using some signatures that reflect the rating curve behavior and river dynamics might be better than using the behavioral dissimilarity measure to test the validity of this hypothesis we perform the clustering with catchment response signatures attributes and compare the performance of regional rating curves created from the ahc against those created by the bhc an appropriate set of response signatures should capture the maximum information from the measured discharge and water stage data because a rating curve reflects their relationship for rivers the six catchment response signatures selected for the comparison with bhc are listed in table 2 the bhc algorithm uses the average linkage method due to its consistency with averaging during the dissimilarity measure calculation for ahc we perform the clustering with both average and ward linkage methods ward 1963 due to their popularity in clustering problems defining an objective function as the sum of squares of the deviation of attributes from the centroid of their corresponding cluster the ward method merges those clusters that result in the minimum increase in the objective function it is worth mentioning that the ward method requires the attributes and it cannot be used with the bhc algorithm in order to compare the performance of different clustering methods we first create regional rating curves based on their corresponding clustering results then we estimate the water stage time series at all 128 gauges using those regional curves and calculate four performance measures for each gauge by comparing the predicted stage time series with the observed stage time series data in this study we use bias rmse nse and correlation to examine the performance of the estimated regional water stage time series at gauges using eqs 10 to 13 10 bias t 1 n h m t h o t n 11 rmse t 1 n h m t h o t 2 n 12 nse 1 t 1 n h m t h o t 2 t 1 n h o t h o 2 13 correlation t 1 n h o t h o h m t h m t 1 n h o t h o 2 t 1 n h m t h m 2 where h m t and h m denote the simulated water stage at time t and its average over the entire period respectively similarly h o t and h o are the observed water stage at time t and its average over the entire period and n is the total number of time steps 3 4 2 classification performance we apply a 16 fold cross validation technique where the 128 gauges are randomly divided into 16 folds with 8 gauges in each fold each time the classifier is trained on 15 folds 120 gauges and tested on the remaining fold 8 gauges the average of 16 classifications is reported as the cv score corresponding to a given classifier with n number of attributes in this study the performance of two well known classifiers namely random forest and logistic regression is investigated using a varied number of attributes n ranges from 2 to 20 and then the best classifier with the optimum number of attributes is selected this classifier is trained on all 128 gauges and utilized for classifying the ungauged river reach catchments based on its physical climatic attributes the trained classifier acts as a physical climatic similarity metric that detects homogeneous river reach catchments by predicting their class labels as all catchments with similar labels belong to a homogeneous region the cv score reported for the best classifier shows the performance of the classification phase in this study 4 results 4 1 homogeneous gauged river reach catchments bhc results the bhc algorithm creates a dendrogram by using the behavioral dissimilarity measure and the average linkage method for 128 river reach catchments a cutoff is determined to divide the dendrogram into the required parts to find the optimum number of clusters the silhouette analysis is carried out fig 3 a displays the variation of the silhouette score with the number of clusters and demonstrates that using three clusters is the best option due to its highest clustering score however looking at the distribution of silhouette values in fig 3 b reveals that there are around 10 gauges in clusters 2 and 3 with negative values that need to be moved to their neighboring clusters in fig 3 c the revised silhouette plot after correcting the poorly clustered points is shown in the revised plot the silhouette score also rises from 0 63 to 0 76 showing the effectiveness of the correction step in the clustering in fig 4 the map of three clustered gauges in the arkansas white red region is illustrated around half the gauges belong to the third cluster while the first cluster includes the lowest number of gauges there are also some geographical patterns in the clustering results as the second cluster is mostly in the center of the region and the southern and northern east of the region is mostly dominated with the first and third clusters of gauges respectively 4 2 regional rating curves aggregation results in addition to grouping the gauges into three clusters with bhc their rating curves should be also aggregated fig 5 shows three regional rating curves created from clustering results the red dashed line is the median of all rating curves that belong to each cluster and the cyan and grey areas represent the 20 and 90 percent confidence intervals respectively as can be seen using these regional curves the uncertainty of stage estimation is significantly large for high flows fig 5 also shows that reaches in cluster 2 have a higher water stage for a given discharge compared to other clusters deep reaches on the contrary reaches in cluster 1 are those reaches that convert a given discharge to the lowest water stage shallow reaches cluster 3 includes the majority of reaches that categorizes as medium reaches 4 3 validation results 4 3 1 clustering and aggregation comparison of the bhc performance against ahc algorithms the six catchment response signatures provided in table 2 are used as attributes of ahc in fig 6 a the silhouette analysis for the ahc with both average and ward methods is presented results show that unlike bhc using two clusters has a higher silhouette score than three clusters however since we used three clusters for bhc we still consider the three clustering option for both average and ward methods to remove the potential impacts of cluster numbers in our comparison thus four ahc cases including the average and ward with two and three clusters ahc avg2 ahc avg3 ahc ward2 ahc ward3 are selected and their performances are compared against the bhc using average linkage with 3 clusters bhc avg3 in fig 6 b the distribution of silhouette values for ahc avg2 and ahc avg3 show that one cluster has a single point for both cases in fig 6 c although there is no cluster with one point one of the clusters is still very small compared to the other one furthermore the silhouette score shown with the red dashed line in fig 6 b and 6 c do not intersect with one or two clusters in all four cases this shows that the points that belong to the small clusters are not perfectly clustered due to their relatively low silhouette values compared to the average value silhouette score in order to compare the performance of the bhc against four ahc cases we created regional curves corresponding to each case predicted the water stage time series at 128 gauges using regional curves and calculated performance measures at all these gauges in fig 7 a to 7d the performance of these five cases is compared by presenting the distribution of four different performance measures among 128 gauges in fig 7a the average bias in bhc is almost zero while the other four cases show some degree of negative bias in addition the interquartile and the total range of bias distribution in bhc is lower than in other cases for rmse also even though the total range in bhc is higher than ahc ward the 25th percentile and the median are lower than all ahc cases one of the most distinguishing differences can be seen in nse where the total range of negative values in bhc is significantly smaller than in ahc cases the negative nse values demonstrate a poor performance that is inferior to a simple averaging furthermore the median of nse is around 0 5 in bhc while this value is around 0 25 in ahc cases the last performance measure namely correlation is high for all cases where the bhc is still in a better position due to the marginally higher median and 25th percentile compared to other cases 4 3 2 classification performance clustering results generated by the bhc along with the 25 potential physical climatic catchment characteristics are used as inputs to a classifier we used an extensive 16 fold cv coupled with rfe method to find the desirable classifier with the optimum number of attributes in fig 8 a the cv score corresponding to the different number of attributes and two classifiers namely logistic regression and random forest are presented according to the benchmark experiments on average the random forest classifier is more accurate compared to the logistic regression couronné et al 2018 however in this study the logistic regression performs better and it generates a higher cv score of 70 with 7 attributes in fig 8b details of logistic regression performance with 7 attributes are presented by showing its cv score at all 16 folds this figure shows the sensitivity of the logistic regression classifier to the distribution of training test data depending on this distribution fold number the accuracy of the classifier varies from 50 folds 6 and 10 to 100 percent fold 8 in fig 8 c the name and importance of the selected 7 physical climatic characteristics are illustrated the latitude lat and average elevation ae of river reach catchments are demonstrated as the most important attributes for the regionalization of rating curves in this study area 4 4 homogeneous ungauged river reach catchments we apply the trained bhc ca framework to three ungauged basins that contain more than 1000 river reach catchments fig 1 the trained framework includes a bhc algorithm with three clusters coupling with a logistic regression classifier with 7 attributes it should be noted that we had already validated the performance of the bhc ca framework on 128 training river reach catchments therefore this section aims to only show the application of the bhc ca framework for detecting homogenous ungauged river reach catchments fig 9 illustrates the results of homogenization in these three ungauged basins as can be seen the western basin acts as a lumped unit where all river reach catchments belong to one cluster the central basin is divided into two regions and the eastern basin includes all three clusters of the river reach catchments it is also worth mentioning that cluster 3 is the dominating region for all three basins and cluster 1 is rarely assigned to river reach catchments in this study area 5 discussion due to the dependence of environmental models to measured data for reliable calibration and accurate prediction the uneven distribution of these data and accordingly the lack of them for a large number of catchments regionalization should be deemed as a practical tool for various environmental purposes however looking into the literature shows that the majority of regionalization studies have been centered on hydrological problems for streamflow prediction in ungauged catchments in a recent work jafarzadegan et al 2020 we proposed the bhc ca framework as a generic approach to regionalization and demonstrated its efficacy for a statistical model that detects floodplains in data scarce regions to extend the application of the bhc ca framework to regionalization beyond hydrology this study applies this framework for a hydraulic problem where stage discharge rating curves are regionalized and homogeneous river reach catchments are determined in addition to providing a more reasonable approach to the parametrization of hydrodynamic models the regionalization of stage discharge rating curves provides a tool for the preliminary estimation of the river stage in ungauged areas knowing the water discharge of rivers the regional rating curves can estimate the river stage dynamics without needing to run a hydrodynamic model it is worth mentioning that regional rating curves cannot compete with hydrodynamic models when accuracy is a matter of concern however the regional rating curve can be significantly useful when a rough estimation of the river stage is needed or when the hydrodynamic modeling is challenging due to the complexity or lack of detailed data for their simulation the main strength of the bhc ca framework is related to the existence of a behavioral based dissimilarity measure within the hierarchical clustering algorithm where similar catchments are clustered without needing to select appropriate attributes nevertheless there is a potential concern that despite this advantage an attributed based clustering algorithm can still outperform the other in this study we specifically compared the performance of bhc with commonly used ahc algorithms and the results confirmed that besides reducing the subjectivity the bhc has a better performance compared to ahc algorithms because the attributes subjectively selected by ahc may not fully represent the behavioral similarity the better performance of bhc compared to ahc algorithms is an important finding that demonstrates the merit of bhc as an alternative clustering algorithm for catchment classification in future environmental problems in this study the bhc and aggregation phases were coupled and three regional rating curves that successfully represent the entire study area were generated however the performance of the classification phase used to transfer these curves to ungauged catchments is slightly concerning the trained logistic regression classifier with 72 accuracy is still vulnerable to misclassification of around one third of catchments this shows that the potential 25 physical climatic attributes used in this study cannot ideally explain the river dynamics and additional attributes are required to improve the classifier performance in future studies it would be useful to perform a comprehensive search for finding more physical climatic characteristics that represent the river dynamics specifically it seems that soil and geological information should be improved because current databases are relatively coarse for a high resolution classification like this study 6 summary and conclusion in this study a generic regionalization framework namely bhc ca is applied to the regionalization of stage discharge rating curves in the arkansas white red region the bhc algorithm divides 128 gauged catchments into three homogeneous partitions and the aggregation phase creates three regional rating curves for each cluster using a 16 fold cross validation technique a logistic regression classifier with 7 physical climatic characteristics and 72 accuracy was found to be the best algorithm for detecting homogeneous regions in ungauged catchments additionally the performance of the behavioral based hierarchical clustering bhc is compared with commonly used attributed based clustering ahc algorithms results show that besides reducing the subjectivity of clustering the bhc is more reliable for creating the regional rating curves this finding demonstrates the efficacy and robustness of bhc as a new alternative clustering algorithm for catchment classification and regionalization problems in future studies credit authorship contribution statement keighobad jafarzadegan conceptualization methodology software validation formal analysis writing original draft visualization writing review editing hamid moradkhani writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to thank the editor dr andras bardossy for handling this manuscript and dr geoff pegram and one anonymous reviewer for providing positive and constructive comments 
5233,stage discharge rating curves are empirical power functions that represent river dynamics by explaining the temporal variations of river discharge with respect to stage fluctuations the widespread access to measured river discharge and stage at gauging stations in the united states provides a valuable opportunity to perform regionalization techniques and transfer this information to ungauged areas in this study a recently proposed regionalization framework that integrates the behavioral based hierarchical clustering bhc with classification and aggregation namely bhc ca is applied to 128 rating curves in the arkansas white red region to detect homogeneous river reach catchments with similar river dynamics additionally the performance of the bhc compared to commonly used attribute based hierarchical clustering ahc algorithms is tested the bhc ca framework divides the entire study area into three homogeneous clusters creates three regional rating curves and finds a logistic regression with 7 physical climatic attributes as the best classifier for transferring regional rating curves to ungauged catchments results also demonstrate the effectiveness of the bhc and its usefulness as an alternative clustering algorithm for the regionalization of environmental model problems keywords regionalization ungauged basins catchment classification rating curve hydrodynamic modeling 1 introduction river gauging stations are the most reliable sources of river discharge and stage information for hydrologists in the united states the u s geological survey s usgs national water information system nwis provides a comprehensive database that includes the historical time series of the river discharge and stage at specific gauging stations despite the valuable role of this database still a majority of the us rivers are ungauged or poorly gauged due to the high cost of installment operation and maintenance of the gauges sivapalan et al 2003 to address this issue as pertained to inadequate distribution of gauging stations and to take full advantage of the available measured data from the existing database regionalization techniques have been widely used for transferring data from gauged to ungauged catchments in hydrology blöschl and sivapalan 1995 oudin et al 2010 young 2006 three approaches exist in the regionalization of the hydrologic model parameters including regression physical similarity and spatial proximity methods he et al 2011 regression methods develop a relationship between a set of physical climatic characteristics and hydrologic model parameters gibbs et al 2012 heuvelmans et al 2006 merz and blöschl 2004 mwakalila 2003 post and jakeman 1999 seibert 1999 wagener and wheater 2006 xu 2003 while physical similarity and spatial proximity methods search for those catchments that are physically or geographically similar to the ungauged catchment and then transfer the entire model parameter set to the ungauged catchment kay et al 2007 masih et al 2010 mcintyre et al 2005 oudin et al 2010 parajka et al 2005 regression based methods assume that the parameters are independent which is not always true on the other hand physical similarity and spatial proximity methods overcome this limitation of regression methods by transferring the entire parameters as a set a review of regionalization studies that compare these three approaches shows that physical similarity and spatial proximity methods can provide a more reliable set of predictions in many cases bao et al 2012 oudin et al 2008 parajka et al 2005 typically the geographical location of catchments is an important factor in regionalization problems but relying on just spatial proximity may not be adequate in many cases thus we define the similarity based method as a more reliable approach that considers both geographical location and physical characteristics of catchments during the regionalization a similarity based regionalization method consists of two steps 1 detecting homogeneous regions by selecting hydrologically similar catchments 2 transferring the information from gauged to ungauged catchments in homogeneous regions region of influence roi burn 1990 zrinji and burn 1996 and catchment classification mcdonnell and woods 2004 wagener et al 2007 methods are two approaches commonly used to detect homogeneous regions in similarity based regionalization problems in roi similarity is defined by a euclidean distance in the catchment characteristic space and a threshold is assigned to form the region of influence for each ungauged catchment holmes et al 2002 kay et al 2007 mcintyre et al 2005 oudin et al 2010 in catchment classification homogeneous regions are created from clustering catchments using a given set of physical climatic characteristics castellarin et al 2001 laaha and blöschl 2006 ramachandra rao and srinivas 2006 a fundamental assumption behind regionalization methods is that there should be some physical climatic catchment characteristics that explain the hydrological behaviors oudin et al 2010 however finding an appropriate physical climatic similarity metric that reflects the behavioral similarity is subjective and challenging in both roi and catchment classification approaches a distance based similarity metric such as euclidean and a set of physical climatic catchment characteristics are predetermined and assumed as they represent the behavioral similarity one solution to reduce this subjectivity is to couple clustering and classification algorithms so that catchments are clustered based on some catchment response signatures that are more reliable than physical climatic characteristics and then a classifier finds the appropriate physical climatic similarity metric from training the classifier on clustering results brunner et al 2018 this approach is beneficial as it reduces the subjectivity of physical climatic catchment characteristic selection nevertheless it creates a new source of subjectivity related to the appropriate selection of catchment response signatures that represent the behavioral similarity ali et al 2012 boscarello et al 2015 sawicz et al 2011 ssegane et al 2012 yadav et al 2007 recently we proposed a behavioral based hierarchical clustering algorithm bhc that uses a behavioral dissimilarity measure rather than distance based attribute dissimilarity measures for grouping similar catchments we introduced a systematic framework that integrates the bhc with classification and aggregation bhc ca for the regionalization of environmental model parameters jafarzadegan et al 2020 the bhc ca framework aims to address the regionalization for a broad range of environmental modeling purposes although a rich literature exists for the regionalization of hydrologic model parameters and detecting hydrologically similar catchments other water related fields such as hydraulics have rarely focused on regionalization there are distinct differences between the scale and processes involved in hydrology compared to hydraulics in hydrology the computational unit is a catchment a large portion of the land that collects the water from precipitation and directs it to its outlet through the interaction of a series of hydrological processes such as infiltration evapotranspiration and routing in hydraulics modeling however the resolution of simulation is usually much finer than hydrologic problems and the focus is on the river dynamics namely the temporal variation of river stage and discharge along the river corridor typically a river is divided into river reaches where it is assumed that each reach has its own dynamics based on this concept a river reach catchment is defined as a small area that drains the water into a single reach thus this study uses a very high resolution regionalization by transferring information from river rich catchments and assigning the measured discharge and stage data obtained at gauges to their corresponding river reach catchments from a flood modeling perspective integration of hydrology and hydraulics is required to simulate the inundation areas ahmadisharaf et al 2018 jafarzadegan and merwade 2017 nguyen et al 2016 first the hydrological processes are studied in a catchment to estimate the discharge at all rivers then using a finer scale a river catchment is used and the hydrodynamic behavior of each river in converting the river discharge to the stage is investigated along the river corridor the primary goal of this study is to perform the regionalization and detect homogeneous river reach catchments from a hydraulic perspective one approach is to apply the bhc ca framework for a given hydraulic model and then transfer its parameter to ungauged regions hydraulic models simulate the physics of rivers and estimate the water stage for a given set of upstream discharges considering the computational complexity involved in model calibration of each catchment the regionalization of these models which requires a multitude of model simulations in different catchments is cumbersome additionally each hydraulic model has its assumptions so regionalization on a specific model may not necessarily apply to all models and the actual river dynamics to overcome these issues we replace the complex hydraulic models with simple empirical power equations referred to as stage discharge rating curves and regionalize these rating curves to identify homogeneous river reaches with similar dynamics detecting homogeneous river reach catchments from a hydraulic perspective is beneficial for parameterization of hydrodynamic models for flood events analyses two common approaches are to apply either a river based or a distributed parametrization horritt and bates 2002 liu et al 2019 for the former the entire river network is divided into a few rivers and one set of parameters is assigned to each river while the latter assigns a large number of parameter sets as each cell has its parametrization while the river based approach is more efficient due to the low number of parametrizations its accuracy can be concerning because the dynamics of a long heterogeneous river may not be fully simulated by defining a single set of parameters on the other hand the distributed parameterization is an inefficient approach due to its computational complexity and it may also lead to an unsuccessful calibration due to over parametrization the regionalization of rating curves and detecting homogeneous river reaches provide a third parameterization approach for the calibration of hydrodynamic models in this approach the river network is divided into homogeneous river reaches and one single parameter set is assigned to each homogeneous region this approach is advantageous compared to both river based and distributed parametrization methods as it improves the accuracy of modeling compared to a river based parametrization and it will be more efficient than a distributed approach owing to smaller parameter set the literature shows that the regionalization of rating curves has been only limited to few studies that focused on the sediment load estimation in ungauged areas heng and suetsugi 2015 2014 isik 2013 in those studies sediment load rating curves that relate the sediment flux to water discharge were regionalized to the best of our knowledge this is the first study that applies the regionalization on stage discharge rating curves for detecting homogeneous river reaches with similar dynamics in addition this study aims to further investigate the main features of the bhc ca framework including its generic application for different regionalization purposes and its superior performance owing to the behavioral based clustering approach since bhc ca has been only implemented on a floodplain mapping problem jafarzadegan et al 2020 this study tests the generality of this framework by applying it for a different regionalization context related to the river dynamics furthermore there is a potential concern that regardless of the lower subjectivity offered by bhc it may not improve the overall performance of clustering to address this concern this study validates the performance of bhc and compares its efficacy and robustness against commonly used attribute based hierarchical clustering ahc algorithms that use catchment response signatures for clustering 2 study area and data the arkansas white red region is one of the largest regions within the u s territory that covers a portion of 8 central and southern u s states this region is used as the domain of regionalization in this study due to its highly variable topography and climate the western parts of this region in new mexico and colorado are highly elevated areas while the eastern parts in missouri arkansas and louisiana are relatively flat the high heterogeneity in physical climatic characteristics of catchments located in this region provides an attractive opportunity to test and highlight the performance of regionalization frameworks to perform the regionalization 128 river gauges are selected from different geographical locations with various physical climatic characteristics these 128 gauges are finalized after filtering around 250 existing gauges in the region the main criterion for filtering is to remove those gauges with insufficient records of data and those small gauging stations that do not cover an appropriate range of streamflow or stage to show the application of the regionalization framework three ungauged basins from the western central and eastern parts of the region are selected and the bhc ca detects homogeneous regions among more than 1000 river reach catchments within these three basins in fig 1 the geographical location of 128 training gauges and three ungauged basins are shown in the arkansas white red region the main input to the regionalization methods is a set of physical climatic catchment characteristics that should be calculated for each catchment in this study multiple freely available datasets related to the topography climate land cover soil and geology are used to obtain an appropriate list of potential catchment characteristics the river reaches and their catchments are selected from the national hydrography dataset nhd the topographic characteristics of the catchments are calculated from one arc second 30 m dems provided by the united states geological survey s usgs national elevation dataset ned to calculate the climatic characteristics the daily 10 km gpm level 3 imerg precipitation dataset is used for the last two years huffman et al 2015 for land cover characteristics the moderate resolution imaging spectroradiometer modis 8 day dataset with 500 m resolution is used to derive the mean of leaf area index lai and the 2011 national land cover database nlcd with a resolution of 30 m is used for the calculation of roughness coefficient and land use percentages in catchments the soil depth characteristics and the geologic characteristics including the subsurface porosity and permeability are derived from pelletier et al 2016 and global hydrogeology maps glhymps gleeson et al 2014 respectively 3 method in this study the recently proposed bhc ca framework is applied for the regionalization of rating curves within the arkansas white red region in the usa the bhc ca framework consists of three main phases the primary phase is the clustering where a behavioral version of hierarchical clustering algorithms bhc is used to detect homogenous regions of similar catchments then the clustering results are used for classification c and aggregation phases a in the classification phase a classifier relates physical climatic catchment characteristics to the results of bhc the trained classifier can be later used to predict the class of ungauged catchments in the aggregation phase regional models are developed by aggregating the calibrated models of data rich catchments please see jafarzadegan et al 2020 for detailed information about the bhc ca framework the bhc algorithm used in this framework considers the behavioral similarity rather than signature response similarities for grouping the similar catchments to demonstrate the significance of bhc over commonly used ahc algorithms we set up a new set of clustering actions by replacing the bhc with ahc algorithms and compare the overall performance of regional rating curves between both cases 3 1 detecting homogeneous gauged river reach catchments using bhc 3 1 1 model setup an important decision in a regionalization problem is to define the computational unit in hydrology the computation unit is a catchment commonly defined as a hydrologic unit code 8 huc8 and a drainage area that directs a network of streams to its outlet this means that a gauge is treated as the outlet of its catchment and the streamflow information obtained at the gauge location is representative of the entire catchment in hydraulics however the dynamics of two neighboring river reaches can be different therefore a river reach catchment is selected as the computational unit of the regionalization rating curves can be used as simple models of river dynamics because they relate the river flow discharge to the water stage it is assumed that those reaches with similar rating curves reflect a similar dynamic by converting the discharge to the water stage using this concept we calibrate 128 rating curves in the arkansas white red region and implement the bhc to group them based on their behavioral similarity a rating curve model is an empirical power equation defined as 1 q f θ h a h b c where q and h denote the river discharge and water stage respectively f denotes the rating curve model and θ is the vector of three model parameters a b c that should be calibrated at each gauge it is noteworthy that the water stage is measured from an arbitrary datum that varies across the gauges so the role of parameter b is to convert the water stage to the water depth in the rivers h b for each gauge we pick the 30 minute time series of flow and water stage from january 2017 to dec 2018 inclusive and fit the optimum rating curve to find the calibrated parameters due to the nonstationarity of rating curves as they change over a long period we only focus on the last two years of data this period is long enough as it contains a sufficient record of low and high flow information for most gauges in the study area 3 1 2 behavioral hierarchical clustering bhc the core of hierarchical clustering algorithms is a dissimilarity matrix where its elements reflect the amount of dissimilarity between two data points in an attributed based approach a set of attributes is defined and a dissimilarity measure such as euclidean distance estimates the dissimilarity in the attribute space of data points on the other hand the bhc algorithm does not cope with the selection of attributes because it directly estimates the dissimilarity from model transferability between data points considering gauges as data points and rating curves as models the following steps are taken to calculate the dissimilarity between two gauges a rating curve equation is shown in eq 2 where the simulated flow at gauge i q m i is a function of calibrated parameters θ i and water stage h i using eq 3 we calculate q m ij denoted as the simulated flow at gauge i using a rating curve with calibrated parameters at gauge j and stage at gauge i f θ j h i 2 q m i f θ i h i 3 q m ij f θ j h i comparing these simulated flows with the observed flow at gauge i q o i two errors are calculated as follows 4 e ii t 1 n q m i t q o i t 2 5 e ij t 1 n q m ij t q o i t 2 where e ii or e jj referred to as the existing error is the error in gauge i or j when the rating curve is calibrated on the same gauge either i or j and e ij referred to as the cross modeling error is the error when the rating curve calibrated from gauge j is applied to gauge i the net errors at gauges i or j defined as the difference between the cross modeling and existing errors in gauge i j are calculated using eqs 6 and 7 6 δ ij e ij e ii 7 δ ji e ji e jj taking the average of net errors at gauge i and j the dissimilarity measure d ij o r d ji between these two gauges are calculated as follows 8 d ij d ji δ ij δ ji 2 the process of dissimilarity measure calculation eqs 2 8 is repeated for all pairs of gauges to create a 128 by 128 dissimilarity matrix which is the main input to the clustering algorithms we use the average linkage method in the bhc method so that the average of dissimilarity measures between groups is used as the updated dissimilarity measure during the hierarchical clustering process the bhc algorithm finds the pair of gauges or clusters with the highest similarity and joins them repeatedly to create a hierarchical tree of clustered gauges referred to as a dendrogram a dendrogram is the main output of a hierarchical clustering algorithm that visually describes the similarity between data points it shows how similar data points are joined at different levels of the hierarchy to find the point clusters a cutoff is applied to the dendrogram to divide the dataset into similar groups readers are referred to murtagh and contreras 2012 for more details related to the linkage methods and hierarchical clustering procedure 3 1 3 optimum number of clusters one of the main challenges in clustering problems is to decide about the optimum number of clusters although looking at the density of data points in a dendrogram provides useful information about the potential number of clusters a more objective solution is to use a cluster validation index cvi the silhouette index is one of the most common cvis used to find the optimum number of clusters fig 2 shows an illustration of silhouette value calculation for the red data point considering a i as the average distance between object i red data point and other objects in the same cluster average length of of green lines and b i as the average distance between object i and all objects in the nearest cluster average length of orange lines the silhouette value of object i is defined as follows rousseeuw 1987 9 s i b i a i m a x a i b i the silhouette value ranges from 1 to 1 where the higher values reflect a better performance and the negative values indicate a wrong clustering for each object it should be noted that s i 0 if a cluster has only one object the silhouette index is finally calculated by averaging all silhouette values in this study first the silhouette index corresponding to a wide range of clustering numbers is calculated and the optimum number of clusters is determined then the distribution of silhouette values corresponding to the optimum cluster number is plotted for all 128 gauges and the points with negative values are detected finally a correction step is applied so that negative points are transferred to the neighboring clusters until all points provide positive silhouette values the correction step improves the clustering performance for creating the regional rating curves in the aggregation step 3 2 detecting homogeneous ungauged river reach catchments classification phase to apply the regionalization methods in ungauged catchments a set of physical climatic catchment characteristics should be used within a similarity metric the bhc ca framework explores the appropriate physical climatic similarity metric by coupling a classifier to clustering results first an attribute array including potential physical climatic characteristics is calculated for all 128 river reach catchments in this study 26 characteristics related to the catchment location and shape topography climate land use soil and geology and hydrography are calculated table 1 to perform a successful classification the attribute array is normalized using the yeo johnson transformation operator weisberg 2001 and the clustering results provided by bhc are used as the vector of class labels multiple classifiers are trained by mapping the transformed attribute array to the vector of class labels in order to filter 26 attributes and use the n most significant ones we perform the recursive feature elimination rfe technique so that the classifier is fit on all 26 attributes and it recursively eliminates the worst attribute based on the weights calculated by the classifier this process is repeated until the attributes decrease to n numbers https www scikit yb org en latest api model selection rfecv html for example assume a scenario of classification with 10 attributes the rfe initiates the classification for all 26 attributes then the worst classifier is removed depending on the ranking of attributes determined by the classifier the classification is repeated with 25 attributes and it continues until the best 10 attributes are determined by the classifier 3 3 regional rating curves aggregation phase after clustering the gauged river reach catchments based on the behavioral similarity of their rating curves the regional rating curves are created using an aggregation of rating curves that belong to the same cluster considering 128 rating curves clustered into m groups the aggregation phase creates m regional rating curves as they represent the whole set of 128 curves in the study area to keep the maximum information during the aggregation phase we consider the median 20 and 90 percent confidence interval of similar rating curves and create a spread of regional curves that capture the majority of the 128 rating curves 3 4 validating the bhc ca framework this section describes the validation of the bhc ca framework for regionalization of rating curves first we evaluate the bhc performance and compare it against the attribute based hierarchical clustering algorithms ahc to perform the validation the regional rating curves generated by aggregation from either bhc or ahc results are analyzed therefore the focus of this part is on the evaluation of both clustering and aggregation phases in the second part the classification phase is validated using the k fold cross validation cv technique 3 4 1 bhc performance in this section the efficacy of incorporating the behavioral dissimilarity measure within a hierarchical clustering algorithm is outlined a common approach to clustering in gauged catchments is to select some observed flow response signatures at gauges and utilize them as attributes of clustering the selection of these attributes is subjective and the main advantage of using the behavioral similarity is that it directly clusters the catchments without the need to cope with attributes however one hypothesis is that despite the existing subjectivity in the attribute selection using some signatures that reflect the rating curve behavior and river dynamics might be better than using the behavioral dissimilarity measure to test the validity of this hypothesis we perform the clustering with catchment response signatures attributes and compare the performance of regional rating curves created from the ahc against those created by the bhc an appropriate set of response signatures should capture the maximum information from the measured discharge and water stage data because a rating curve reflects their relationship for rivers the six catchment response signatures selected for the comparison with bhc are listed in table 2 the bhc algorithm uses the average linkage method due to its consistency with averaging during the dissimilarity measure calculation for ahc we perform the clustering with both average and ward linkage methods ward 1963 due to their popularity in clustering problems defining an objective function as the sum of squares of the deviation of attributes from the centroid of their corresponding cluster the ward method merges those clusters that result in the minimum increase in the objective function it is worth mentioning that the ward method requires the attributes and it cannot be used with the bhc algorithm in order to compare the performance of different clustering methods we first create regional rating curves based on their corresponding clustering results then we estimate the water stage time series at all 128 gauges using those regional curves and calculate four performance measures for each gauge by comparing the predicted stage time series with the observed stage time series data in this study we use bias rmse nse and correlation to examine the performance of the estimated regional water stage time series at gauges using eqs 10 to 13 10 bias t 1 n h m t h o t n 11 rmse t 1 n h m t h o t 2 n 12 nse 1 t 1 n h m t h o t 2 t 1 n h o t h o 2 13 correlation t 1 n h o t h o h m t h m t 1 n h o t h o 2 t 1 n h m t h m 2 where h m t and h m denote the simulated water stage at time t and its average over the entire period respectively similarly h o t and h o are the observed water stage at time t and its average over the entire period and n is the total number of time steps 3 4 2 classification performance we apply a 16 fold cross validation technique where the 128 gauges are randomly divided into 16 folds with 8 gauges in each fold each time the classifier is trained on 15 folds 120 gauges and tested on the remaining fold 8 gauges the average of 16 classifications is reported as the cv score corresponding to a given classifier with n number of attributes in this study the performance of two well known classifiers namely random forest and logistic regression is investigated using a varied number of attributes n ranges from 2 to 20 and then the best classifier with the optimum number of attributes is selected this classifier is trained on all 128 gauges and utilized for classifying the ungauged river reach catchments based on its physical climatic attributes the trained classifier acts as a physical climatic similarity metric that detects homogeneous river reach catchments by predicting their class labels as all catchments with similar labels belong to a homogeneous region the cv score reported for the best classifier shows the performance of the classification phase in this study 4 results 4 1 homogeneous gauged river reach catchments bhc results the bhc algorithm creates a dendrogram by using the behavioral dissimilarity measure and the average linkage method for 128 river reach catchments a cutoff is determined to divide the dendrogram into the required parts to find the optimum number of clusters the silhouette analysis is carried out fig 3 a displays the variation of the silhouette score with the number of clusters and demonstrates that using three clusters is the best option due to its highest clustering score however looking at the distribution of silhouette values in fig 3 b reveals that there are around 10 gauges in clusters 2 and 3 with negative values that need to be moved to their neighboring clusters in fig 3 c the revised silhouette plot after correcting the poorly clustered points is shown in the revised plot the silhouette score also rises from 0 63 to 0 76 showing the effectiveness of the correction step in the clustering in fig 4 the map of three clustered gauges in the arkansas white red region is illustrated around half the gauges belong to the third cluster while the first cluster includes the lowest number of gauges there are also some geographical patterns in the clustering results as the second cluster is mostly in the center of the region and the southern and northern east of the region is mostly dominated with the first and third clusters of gauges respectively 4 2 regional rating curves aggregation results in addition to grouping the gauges into three clusters with bhc their rating curves should be also aggregated fig 5 shows three regional rating curves created from clustering results the red dashed line is the median of all rating curves that belong to each cluster and the cyan and grey areas represent the 20 and 90 percent confidence intervals respectively as can be seen using these regional curves the uncertainty of stage estimation is significantly large for high flows fig 5 also shows that reaches in cluster 2 have a higher water stage for a given discharge compared to other clusters deep reaches on the contrary reaches in cluster 1 are those reaches that convert a given discharge to the lowest water stage shallow reaches cluster 3 includes the majority of reaches that categorizes as medium reaches 4 3 validation results 4 3 1 clustering and aggregation comparison of the bhc performance against ahc algorithms the six catchment response signatures provided in table 2 are used as attributes of ahc in fig 6 a the silhouette analysis for the ahc with both average and ward methods is presented results show that unlike bhc using two clusters has a higher silhouette score than three clusters however since we used three clusters for bhc we still consider the three clustering option for both average and ward methods to remove the potential impacts of cluster numbers in our comparison thus four ahc cases including the average and ward with two and three clusters ahc avg2 ahc avg3 ahc ward2 ahc ward3 are selected and their performances are compared against the bhc using average linkage with 3 clusters bhc avg3 in fig 6 b the distribution of silhouette values for ahc avg2 and ahc avg3 show that one cluster has a single point for both cases in fig 6 c although there is no cluster with one point one of the clusters is still very small compared to the other one furthermore the silhouette score shown with the red dashed line in fig 6 b and 6 c do not intersect with one or two clusters in all four cases this shows that the points that belong to the small clusters are not perfectly clustered due to their relatively low silhouette values compared to the average value silhouette score in order to compare the performance of the bhc against four ahc cases we created regional curves corresponding to each case predicted the water stage time series at 128 gauges using regional curves and calculated performance measures at all these gauges in fig 7 a to 7d the performance of these five cases is compared by presenting the distribution of four different performance measures among 128 gauges in fig 7a the average bias in bhc is almost zero while the other four cases show some degree of negative bias in addition the interquartile and the total range of bias distribution in bhc is lower than in other cases for rmse also even though the total range in bhc is higher than ahc ward the 25th percentile and the median are lower than all ahc cases one of the most distinguishing differences can be seen in nse where the total range of negative values in bhc is significantly smaller than in ahc cases the negative nse values demonstrate a poor performance that is inferior to a simple averaging furthermore the median of nse is around 0 5 in bhc while this value is around 0 25 in ahc cases the last performance measure namely correlation is high for all cases where the bhc is still in a better position due to the marginally higher median and 25th percentile compared to other cases 4 3 2 classification performance clustering results generated by the bhc along with the 25 potential physical climatic catchment characteristics are used as inputs to a classifier we used an extensive 16 fold cv coupled with rfe method to find the desirable classifier with the optimum number of attributes in fig 8 a the cv score corresponding to the different number of attributes and two classifiers namely logistic regression and random forest are presented according to the benchmark experiments on average the random forest classifier is more accurate compared to the logistic regression couronné et al 2018 however in this study the logistic regression performs better and it generates a higher cv score of 70 with 7 attributes in fig 8b details of logistic regression performance with 7 attributes are presented by showing its cv score at all 16 folds this figure shows the sensitivity of the logistic regression classifier to the distribution of training test data depending on this distribution fold number the accuracy of the classifier varies from 50 folds 6 and 10 to 100 percent fold 8 in fig 8 c the name and importance of the selected 7 physical climatic characteristics are illustrated the latitude lat and average elevation ae of river reach catchments are demonstrated as the most important attributes for the regionalization of rating curves in this study area 4 4 homogeneous ungauged river reach catchments we apply the trained bhc ca framework to three ungauged basins that contain more than 1000 river reach catchments fig 1 the trained framework includes a bhc algorithm with three clusters coupling with a logistic regression classifier with 7 attributes it should be noted that we had already validated the performance of the bhc ca framework on 128 training river reach catchments therefore this section aims to only show the application of the bhc ca framework for detecting homogenous ungauged river reach catchments fig 9 illustrates the results of homogenization in these three ungauged basins as can be seen the western basin acts as a lumped unit where all river reach catchments belong to one cluster the central basin is divided into two regions and the eastern basin includes all three clusters of the river reach catchments it is also worth mentioning that cluster 3 is the dominating region for all three basins and cluster 1 is rarely assigned to river reach catchments in this study area 5 discussion due to the dependence of environmental models to measured data for reliable calibration and accurate prediction the uneven distribution of these data and accordingly the lack of them for a large number of catchments regionalization should be deemed as a practical tool for various environmental purposes however looking into the literature shows that the majority of regionalization studies have been centered on hydrological problems for streamflow prediction in ungauged catchments in a recent work jafarzadegan et al 2020 we proposed the bhc ca framework as a generic approach to regionalization and demonstrated its efficacy for a statistical model that detects floodplains in data scarce regions to extend the application of the bhc ca framework to regionalization beyond hydrology this study applies this framework for a hydraulic problem where stage discharge rating curves are regionalized and homogeneous river reach catchments are determined in addition to providing a more reasonable approach to the parametrization of hydrodynamic models the regionalization of stage discharge rating curves provides a tool for the preliminary estimation of the river stage in ungauged areas knowing the water discharge of rivers the regional rating curves can estimate the river stage dynamics without needing to run a hydrodynamic model it is worth mentioning that regional rating curves cannot compete with hydrodynamic models when accuracy is a matter of concern however the regional rating curve can be significantly useful when a rough estimation of the river stage is needed or when the hydrodynamic modeling is challenging due to the complexity or lack of detailed data for their simulation the main strength of the bhc ca framework is related to the existence of a behavioral based dissimilarity measure within the hierarchical clustering algorithm where similar catchments are clustered without needing to select appropriate attributes nevertheless there is a potential concern that despite this advantage an attributed based clustering algorithm can still outperform the other in this study we specifically compared the performance of bhc with commonly used ahc algorithms and the results confirmed that besides reducing the subjectivity the bhc has a better performance compared to ahc algorithms because the attributes subjectively selected by ahc may not fully represent the behavioral similarity the better performance of bhc compared to ahc algorithms is an important finding that demonstrates the merit of bhc as an alternative clustering algorithm for catchment classification in future environmental problems in this study the bhc and aggregation phases were coupled and three regional rating curves that successfully represent the entire study area were generated however the performance of the classification phase used to transfer these curves to ungauged catchments is slightly concerning the trained logistic regression classifier with 72 accuracy is still vulnerable to misclassification of around one third of catchments this shows that the potential 25 physical climatic attributes used in this study cannot ideally explain the river dynamics and additional attributes are required to improve the classifier performance in future studies it would be useful to perform a comprehensive search for finding more physical climatic characteristics that represent the river dynamics specifically it seems that soil and geological information should be improved because current databases are relatively coarse for a high resolution classification like this study 6 summary and conclusion in this study a generic regionalization framework namely bhc ca is applied to the regionalization of stage discharge rating curves in the arkansas white red region the bhc algorithm divides 128 gauged catchments into three homogeneous partitions and the aggregation phase creates three regional rating curves for each cluster using a 16 fold cross validation technique a logistic regression classifier with 7 physical climatic characteristics and 72 accuracy was found to be the best algorithm for detecting homogeneous regions in ungauged catchments additionally the performance of the behavioral based hierarchical clustering bhc is compared with commonly used attributed based clustering ahc algorithms results show that besides reducing the subjectivity of clustering the bhc is more reliable for creating the regional rating curves this finding demonstrates the efficacy and robustness of bhc as a new alternative clustering algorithm for catchment classification and regionalization problems in future studies credit authorship contribution statement keighobad jafarzadegan conceptualization methodology software validation formal analysis writing original draft visualization writing review editing hamid moradkhani writing review editing supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we would like to thank the editor dr andras bardossy for handling this manuscript and dr geoff pegram and one anonymous reviewer for providing positive and constructive comments 
5234,the temporal resolution of storm data plays an important role in constructing reliable inundation simulations the effects of the temporal resolution of storms with different return periods peak coefficients and durations on the simulated flood inundation were investigated with a two dimensional numerical model after analysing the modelled inundation peak values and occurrence times which are affected by the temporal resolution of a storm the following conclusions were obtained 1 the accuracy of the simulated inundation results in terms of the peak values and shift times of the storm increases as the temporal resolution of the storm increases 2 for the same temporal resolution of storm the accuracy of the simulated inundation in terms of the peak values and shift times increases as the storm return period increases except for the shift time in the second test case investigated 3 for the same temporal resolution of storm the accuracy of the simulated inundation in terms of the peak values and shift times of the storm does not display an obvious correlation with the storm peak coefficient and storm duration and 4 the most suitable temporal resolution of storm is 15 min for obtaining an accurate numerical simulation of urban flood inundation these results can help researchers understand the key effects of the temporal resolution of storms on urban flood inundation and identify storm temporal resolutions that can produce relatively accurate simulated inundation results even without high temporal resolution data keywords urban flood inundation temporal resolution storm numerical simulation relative error shift time nomenclature gast gpu accelerated surface water flow and transportation trs temporal resolution of storm min minute re relative error st shift time i the designed storm intensity mm minute q the designed storm intensity l s ha p storm return period year t storm duration min c storm peak coefficient t time subscript x x axis of the cartesian subscript y y axis of the cartesian q the variable vector h depth of water q x single width discharge in x axis direction q y single width discharge in y axis direction f the flux vector of x direction g the flux vector of y direction s source vector s b slope source terms s f friction source terms u current velocity of x direction v current velocity of y direction zb the bottom elevation of riverbed cf the chezy s coefficient c f g n 2 h 1 3 n manning coefficient i net storm rate ir the storm rate ii the infiltration rate z the water level z h z b 1 introduction due to global warming in recent years short duration extreme storms have occurred frequently mailhot et al 2010 westra et al 2014 xie et al 2010 which has led to serious flood inundation issues especially in urban areas where there are abundant of impermeable surfaces for example the flood that occurred in boulder colorado united states of america in september 2013 when approximately 1 year worth of rain fell in 6 days led to widespread flooding causing 8 deaths and significant infrastructure damage deniz et al 2016 outside of the usa the flood that occurred in beijing the capital of china on 21 july 2012 lasted for approximately 16 h and the amount of precipitation reached 215 mm resulting in 79 fatalities and approximately 1 6 billion in damage zhang et al 2015 substantial research efforts have been made to mitigate urban flood inundation issues the most effective methods involved forecasting the inundation situation using hydrodynamic numerical models of urban a hydrodynamic numerical model can simulate flood inundation conditions with high precision depending on the precision of input data especially high temporal resolution storm data however the temporal resolution of the existing forecast storm data sets is relatively low for example the european centre for medium range weather forecasts ecmwf a unique international organisation that focuses on weather forecasting research developed a model that can only predict storm data with a temporal resolution of 6 h manzato et al 2019 similarly the weather research and forecasting wrf model from which reliable hourly resolution storms are generated by selecting suitable physical schemes for specific regions pan et al 2015 patel et al 2019 consequently it is important to investigate the effects of the temporal resolution of storm data on urban flood inundation cecinati et al 2017 hailegeorgis and alfredsen 2018 lyu et al 2018 song et al 2017 and to choose input data sets with an appropriate temporal resolution to run models and obtain accurate inundation simulation results in recent years an increasing amount of research has investigated the effects of the temporal resolution of storms trss on inundation anis and rode 2015 behrangi et al 2012 cecinati et al 2017 coulthard and skinner 2016 hailegeorgis and alfredsen 2018 lobo and bonilla 2015 lyu et al 2018 song et al 2016 thorndahl et al 2014 yoon et al 2017 huang et al 2019 analysed the sensitivity of daily and hourly temporal resolutions of storm with the distributed hbv hydrologiska byråns vattenbalansavdelning model and concluded that high trss can lead to a significant improvement in model performance bruni et al 2015 studied the effects of the trs on urban flood inundation by considering 4 sets of radar based storms with temporal resolutions of 1 min 5 min and 10 min and found that compared with the maximum inundation depth the peak inundation value is more sensitive to the trs in addition due to the aggregation of trs data the decorrelation length increased and the occurrence time of the inundation peak shifted by several minutes however the relative error re of the inundation peak value and specific shift time st with different trss remain uncertain the return period peak coefficient and duration are the major characteristics of storms and the differences in these values reflect different sensitivities to disasters the storm peak coefficient is related to the distribution of the rainstorm intensity at a given time scale and the maximum intensity and depth of inundation the effects of the storm duration on runoff discharge prediction were studied by changhwan kim who found that the storm duration is an important factor for accurately forecasting flood inundation kim and kim 2018 however few studies have investigated the effects of the trs on urban flood inundation considering different storm return periods peak coefficients and durations in this paper the effects of the trs on urban flood inundation are investigated by using different return periods p peak coefficients t and durations c of storm data based on a two dimensional hydrodynamic model called gast gpu accelerated surface water flow and transport model hou et al 2016 2018 the temporal resolutions of the storm data were 1 min 5 min 15 min 30 min 60 min and 180 min and the relative error and shift time of the inundation peak were calculated and analysed this paper focused on the following three objectives 1 investigating the effects of the trs on the accuracy of the simulated inundation in terms of the peak value and shift time 2 studying the effects of storm return periods peak coefficients and durations on the accuracy of simulated inundation in terms of the peak value and shift time and 3 determining the most suitable trs for obtaining an accurate numerical simulation of urban flood inundation these findings can be used to develop an effective method for obtaining high resolution simulations of flood inundation with the appropriate trs data and contribute to forecasting urban flood inundation thereby providing flood risk warning information for scientists and decision makers 2 methods and data 2 1 the two dimensional hydrodynamic model the gast model used in this study is governed by the godunov type finite volume method of solving the 2d shallow water equations swes and is coupled with hydrological and hydrodynamic processes 2 1 1 governing equations the governing equations used in the gast model are the 2d shallow water equations swes which are derived by vertically averaging the reynolds averaged navier stokes equation ranse assuming the hydrostatic pressure distribution and neglecting viscous and turbulent stresses in a conservative form the vector format of the 2d shallow water equations can be written as follows liang 2010 liang and marche 2009 1 q t f x g y s 2 q h q x q y f q x u q x g h 2 2 μ q y g q y υ q x υ q y g h 2 2 3 s s b s f i g h z b x c f u u 2 υ 2 g h z b y c f υ u 2 υ 2 where t represents the time x and y represent the x axis and y axis of the cartesian coordinates respectively q denotes the variable vector which includes the depth of water h and single width discharges q x and q y f and g are the flux vectors in the x direction and y direction respectively s is the source vector and can be subdivided into slope source terms s b and friction source terms s f u and v are the current velocities in the x direction and y direction respectively z b represents the bottom elevation of the riverbed c f is chezy s coefficient which can generally be calculated by c f g n 2 h 1 3 n is the manning coefficient and runoff yield in excess of infiltration was adopted in the model i denotes the net storm rate which is computed by i i r i i where i r and i i denote the storm rate and infiltration rate respectively the value of i just change with the value of i r and i i when i r i i i e the storm rate is higher than the infiltration rate i is a source term and i is positive otherwise when i r i i i e the storm rate is lower than the infiltration rate i is a sink term and i is negative it should be noted that the net increasing water depth in a cell must following equation 4 to preserve the mass conservation 4 h m a x h l i d t 0 where h represents the water depth at the present moment mm h l indicates the water depth at the last moment mm dt is the time step in addition the water level is computed by the formula z h z b 2 1 2 numerical method in this model the godunov type finite volume method is applied to discretise the swes simons et al 2014 the dynamic wave method is adopted to simulate the evolution process of basin floods to consider rapidly varying flows and discontinuities smith and liang 2013 an approximate riemann solver based on the harten lax van leer contact hllc method is used to calculate the mass flux and momentum flux at the cell interface hou et al 2013 the slope flux method is proposed to evaluate the slope source term and solve momentum non conservation issues which are caused by variable topography hou et al 2013 a second order explicit method is used in the friction source term to ensure the second order accuracy of time integration hou et al 2013 the issue of the negative water depth at the wet and dry boundary is solved by employing a hydrostatic reconstruction method when the water level is lower than 0 000005 m the grid is considered a dry grid which means both velocity and water depth are set to zero otherwise the grid is considered a wet grid in addition by replacing the single width velocity with the flow velocity the second order scheme of the algorithm is automatically reduced to the first order form hou et al 2013 in which the water depth and velocity change dramatically to ensure stable operation at the wet and dry boundaries liang and smith 2015 the water balance concept is applied to evaluate the runoff process runoff is generated only when the storm rate is larger than the sum of the surface storage and infiltration rates gpu acceleration technology plays a dominant role in improving the computational efficiency and reducing economic costs smith and liang 2013 in addition high resolution dem data are among the most important inputs in hydrodynamic simulations to obtain realistic surface features and accurate fill volumes the principle of equivalent infiltration is applied to quantitatively consider the drainage capacity of urban underground pipeline networks specifically the drainage capacity is calculated according to practical design standards and as an infiltration rate added to the grid where the area is affected by the network 2 2 data two test cases are used in this study the first test case is based on normalized terrain and the second test case involves part of the xixian new area in xi an both test cases require different temporal resolutions of storm data and basic underlying surface data 2 2 1 storm data with different temporal resolutions the storm data used in the two test cases are the same currently the highest temporal resolution of storm data is 5 min and the data are collected by rain gauges the main temporal resolutions of the storm data predicted by meteorological models are 180 min and 360 min or longer for example the trs of 180 min of grapes meso data and t639 data can be download from the website of national meteorological science data center http data cma cn data cdcdetail datacode f 0009 0001 html the trs of 360 min of ecmwf data can be download from the website of european centre for medium range weather forecasts https apps ecmwf int datasets in addition the lower temporal resolution forecast storm data exists but it is very difficult to obtain the trs of 1 min can be generated by the chicago rain generator therefore 6 different resolutions of trs data are selected for analysis including 1 min 5 min 15 min 30 min 60 min and 180 min tables 1 and 2 show the different storm characteristics considered in this study including 3 different storm return periods p 3 different storm peak coefficients t and 3 different storm durations c non repeated permutations and combinations of different storm characteristics were considered to assess the influence of different factors therefore this study required 6 3 3 3 162 different storm data sets in total according to the code for design of outdoor drainage gb50014 2006 a design code of china the designed storm formula of the xixian new area hou et al 2016 2017 was adopted and this formula is as follows 5 i q 167 1239 91 1 1 971 lgp 167 t 7 4246 0 8124 where i is the designed storm intensity mm min q is the designed storm intensity l s ha lg is the logarithm base 10 p represents the designed return period year and t indicates the storm duration minute trs of 1 min are generated by the chicago rain generator trss of 5 min 15 min 30 min 60 min and 180 min are generated from the 1 min trs data by upscaling the storm data here storm data with a temporal resolution of 5 min are taken as an example to illustrate the method of generating upscaled storm data first the sum of every five consecutive data points of the 1 min storm data is obtained second the sum is divided into 5 replicate values on average finally the data unit is converted to mm h which is used in the gast model the upscaled storm data with 15 min 30 min 60 min and 180 min temporal resolutions are obtained by the same method 2 2 2 basic underlying surface data for the two test cases the basic underlying surface data include high resolution digital elevation model dem data land use data and the corresponding manning values infiltration data and data on the equivalent infiltration of the urban pipe network in the first test case the elevation of the dem is the same everywhere and the corresponding map is shown in fig 1 the terrain is a rectangular grassland with an area of 1 10 4 m2 and the length and width of each computational element are set as 1 m the land use is grassland and the corresponding manning value is 0 06 three different infiltration values are chosen from the infiltration data for the second test case table 1 including is 8 96 mm h im 19 43 mm h and il 37 55 mm h which represent small moderate and large infiltrations respectively for the second test case dem data are extracted from the real terrain of the xixian new area xi an china there are 1129 and 816 transverse and longitudinal grids of dem data respectively the resolution of the grids is 2 m fig 2 and the area is 3 69 km2 the land use is divided into 5 categories fig 3 and the corresponding manning values are taken from the relevant literature the infiltration data are obtained by measurements and the value of equivalent infiltration is 10 47 mm h the specific values of input data are shown in table 2 in the first test case 162 different storm data sets and 3 categories of infiltration conditions are considered resulting in 162 3 486 different simulated inundations storm data sets with the same p t and c values and different trss are classified as different scenarios yielding 486 6 81 scenarios table 1 in the second test case 162 different storm data sets and 1 infiltration condition are considered resulting in 162 1 162 different simulated inundations as in the first test case storm data sets with the same p t and c values and different trss are classified as different scenarios yielding 162 6 27 cases table 2 the two test cases total 486 162 648 simulated inundations and 81 27 108 scenarios 2 3 evaluation indicator of the modelling accuracy 2 3 1 the relative error of the inundation peak to statistically and quantitatively describe the effects of the trs of peak inundation the relative error re of the inundation peak which is a dimensionless parameter is used to quantify the difference between a peak value of verified accuracy and simulated values here the simulated flood inundations based on storm data with a trs of 1 min are taken as the verified accurate values and the flood inundations simulated by other upscaled storm data series are taken as the simulated values including for trss of 5 min 15 min 30 min 60 min and 180 min the formulation of re is as follows 6 re q s q a q a 100 where q s represents a simulated value of the inundation peak m3 and q a represents the verified actual value of the inundation peak re 0 indicates that the simulated value is underestimated compared with the verified actual value and re 0 indicates that the simulated value is overestimated compared with the verified actual value 2 3 2 the shift time of the inundation peak to statistically and quantitatively describe the effects of the trs on the shift time st of the inundation peak the st of the inundation peak is assigned to quantify the difference of the inundation peak between the actual and simulated values the formulation of st is as follows 7 st t s t a where st represents the st of the inundation peak t s represents the occurrence time min of the simulated value of the inundation peak and t a represents the verified actual occurrence time st 0 indicates that the occurrence time of the simulated inundation peak lags behind the verified actual time st 0 indicates that the occurrence time of the simulated inundation peak is before the verified actual time and st 0 indicates that the occurrence time of the simulated inundation peak is equal to the verified actual time 3 results and discussion based on 684 simulated inundations the inundation depth curves shown as fig 4 were plotted the inundation volume data for the two test cases with different trss were obtained to analyse the effects of the trs on urban flood inundation for different p t and c values in fig 4 a the inundation depth is the same everywhere because the topographic height in the first test case is the same everywhere which is consistent with the expected result in fig 4 b the inundation depth is consistent with the actual depth and there is more inundation at intersections and in low lying areas than in other areas fig 4 indicates that the simulation results can be used to assess the effects of the trs on urban flood inundation additionally all the simulated inundations display same trends when analysing the effects of the trs on the inundation process therefore only individual simulation cases are analysed considering the length limitation of the article 3 1 effects of the trs on the inundation peak for different storm return periods fig 5 shows the inundation process for trss with different storm return periods in the first test case notably the accuracy of the inundation results increases as the trs increases and the storm return period increases the inundation results for trss of 1 min 5 min and 15 min almost perfectly coincide with the storm return period however the inundation results for trss of 30 min 60 min and 180 min display a large disparity with the results for a trs of 1 min fig 6 shows the corresponding inundation process plot for the second test case in general the same trends as observed in the first test case are identified and the accuracy of the corresponding inundation result slightly increases fig 7 a shows the re of the inundation peak in the first test case additionally the accuracy change trend for a given trs and storm return period is same as the inundation process shown the singularity points with large res the m point and n point all appeared in p 1 indicating that a low storm return period leads to a low precision inundation simulation for the trs of 5 min the re value reached 10 for p 50 and 20 for p 5 for the trs of 15 min the re value reached 10 for p 50 and 20 for p 5 however for the trss of 30 min 60 min and 180 min the re value just reached 20 45 and 100 for p 50 respectively and these accuracies were quite low the variations in the proportions of different sts in the first test case fig 7 b indicate that the accuracy trend changes with the trs and storm return period as reflected by the inundation results for the trs of 5 min 100 of the sts were within 5 min for the trs of 15 min almost 100 of the sts were within 10 min for p 5 and p 50 for trss of 30 min 60 min and 180 min the corresponding proportion gradually decreased the re of the inundation peak in the second test case fig 8 a shows that the accuracy trend varies with the trs and storm return period this result is surprisingly similar to the trend observed for the inundation results in the first test case the corresponding re value decreased slightly for the trs of 5 min the re value reached 1 for p 50 and p 5 and 10 for p 1 for the trs of 15 min the re value reached 2 for p 50 10 for p 5 and 48 for p 1 however for trss of 30 min 60 min and 180 min the re values reached 8 39 and 60 for p 50 respectively these accuracies are quite low the proportions of different sts in the second test case fig 8 b show that accuracy trend varies with the trs and storm return period this result is surprisingly similar to the trend observed from the inundation results in the first test case in addition the accuracy of the simulated inundations increased slightly in this case for the trs of 5 min 100 of the sts were within 5 min and for the trs of 15 min 100 of the sts were within 10 min however for trss of 30 min 60 min and 180 min the corresponding percentages gradually decreased figs 5 8 indicate that the accuracy of simulated inundations increases as the trs increases and the storm return period increases therefore trss of 5 min and 15 min can meet the research requirements in addition considering the availability in the forecasted storm data a storm with a trs of 15 min would be the optimal choice which is consistent with the findings of lyu et al 2018 3 2 effects of the trs on the inundation peak for different storm peak coefficients for different storm peaks and trss in the first test case fig 9 the accuracy of the inundation process increases as the trs increases and the effect is similar to that of the storm return period however there is no obvious correlation between the accuracy of the simulated inundations and the storm peak coefficient in the second test case fig 10 the results are similar to those in the first test case although the accuracy of the corresponding inundation result slightly increased the re of the inundation peak in the first test case fig 11 a shows that the accuracy varies with the trs but the re of the inundation peak has no obvious correlation with the storm peak coefficient for the trs of 5 min the re value can reach 12 for c 0 5 which is larger than 9 for c 0 8 and 2 for c 0 2 however for the trs of 15 min the re value can reach 50 for c 0 5 which is larger than 20 for c 0 8 and smaller than 55 for c 0 2 the re values of trss of 30 min 60 min and 180 min all reach 100 thus the corresponding parameters cannot be used in research and practice the proportions of different sts in the first test case fig 11 b indicate that the accuracy increase with the trs rises but the proportions of different sts displayed no obvious correlation with the storm peak coefficient for the trs of 5 min 100 of the sts are within 5 min for the trs of 15 min the proportions of different sts within 10 min were 89 for c 0 2 and 78 for c 0 5 and c 0 8 whereas for trss of 30 min 60 min and 180 min the corresponding proportions gradually decreased the re of the inundation peak in the second test case fig 12 a shows that the accuracy changes with the trs as for the inundation process in the first test case and the corresponding re value decreases slightly for the trs of 15 min the re value can reach 40 for c 0 5 which is smaller than 42 for c 0 2 and 50 for c 0 8 the proportions of different sts in the second test case fig 12 b indicate that the accuracy varies with the trs as in the first test case however the accuracy of the simulation results increases slightly in this case notably for the trs of 15 min 100 of the sts are within 10 min figs 9 12 show that the accuracy of simulated inundations increases as the trs increases but do not show an obvious correlation between the inundation volume and the storm peak coefficient because the inundation volume is equal to the storm volume minus infiltration thus the storm and infiltration volumes are determined by the cumulative storm intensity and infiltration rate respectively however the storm peak coefficient has no effect on the cumulative storm intensity therefore there is no correlation between the storm peak coefficient and the accuracy of the simulated inundation values as shown in the storm return period results the results for a storm with a trs of 15 min are better than those for storms with other trss 3 3 effects of the trs on the inundation peak for different storm durations the inundation process of the trs with different storm durations in the first test case fig 13 shows that similar to the effects of the storm return period performed the accuracy of the inundation process increases as the trs rises however similar to the effects of storm peak coefficient performed there is no obvious correlation between the accuracy of simulation inundation and storm duration the inundation process of the second test case fig 14 except for getting the same rules as in the first test case shown the accuracy of the corresponding inundation process increased slightly the re of the inundation peak in the first test case fig 15 a shows that the accuracy changes with the trs as for the inundation results but the re of the inundation peak has no obvious correlation with the storm duration for the trs of 5 min the re value can reach 7 for t 6 which is smaller than 11 for t 3 and 9 for t 9 however for the trs of 15 min the re value can reach 70 for t 6 which is larger than 25 for t 3 and 50 for t 9 the re values of trss of 30 min 60 min and 180 min all reach 100 and the corresponding parameters cannot be used in research or practice the proportions of different sts in the first test case fig 11 b shows that the accuracy variation with the trs is the same as that observed for the inundation results additionally the proportions of different sts have no obvious correlation with the storm duration for the trs of 5 min 100 of the sts were within 5 min for the trs of 15 min approximately 82 78 and 85 of the sts were within 10 min for t 3 t 6 and t 9 respectively however for trss of 30 min 60 min and 180 min the corresponding proportions gradually decreased the re of the inundation peak in the second test case fig 16 a shows that the accuracy variations with the trs are the same as those for the inundation results in the first test case and the corresponding re value slightly decreases for the trs of 15 min the re can reach 50 for t 6 which is larger than 40 for t 3 and 23 for t 9 the proportions of different sts in the second test case fig 16 b show that the accuracy variation with the trs is the same as that for the inundation results in the first test case however the accuracy of the simulation result increased slightly compared with that in the first test case for the trs of 15 min 100 of the sts are within 10 min figs 13 16 indicate that the accuracy of the simulated inundations increases with increasing trs but that the simulated inundation is not obviously correlated with the storm duration similar to the storm peak coefficient the storm duration has no effect on the cumulative value of the storm intensity therefore there is no correlation between the storm peak coefficient and the accuracy of the simulated inundation values based on the storm return period and peak coefficient the results for the storm with a trs of 15 min are better than those for storms with other trss 4 conclusions and outlook in this paper the effects of the trs on the simulated flood inundation are investigated using a two dimensional numerical model with different return periods peak coefficients and durations to study and analyse the effects of the trs considering different storm characteristics the objectives of the study were to discover an appropriate trs that could produce reliable simulated inundation results and quantify the re and st of the inundation peak for the appropriate trss the main findings and implications of this study are as follows 1 the accuracy of the simulated inundation values in terms of the peak and st increased as the trs rise in the two test cases and the accuracy in the second test case was higher than that in the first test case in the second test case the maximum re reached 10 48 75 100 and 100 for trss of 5 min 15 min 30 min 60 min and 180 min respectively the majority of sts were within 0 min 5 min 15 min and other for trss of 5 min 15 min 30 min 60 min and 180 min respectively 2 for the same trs in the first test case the accuracy of the simulated inundation results in terms of the peak value and shift time increased as the storm return period increased in the second test case the accuracy of the simulated inundation peak value increased as the storm return period increased but the shift time of the storm did not display an obvious correlation with the storm return period notably in the second test case for the trs of 15 min the re value of the inundation peak reached 1 10 and 48 for p 50 p 5 and p 1 respectively additionally 100 of the sts were within 10 min 3 for the same trs in the two test cases the accuracy of the simulated inundation values in terms of the peak value and shift time did not show obvious correlations with the storm peak coefficient or storm duration for example in the second test case for the trs of 15 min the re value of the inundation peak reached 42 40 and 50 for c 0 2 c 0 5 and c 0 8 and 40 50 and 23 for t 3 t 6 and t 9 respectively additionally for different c and t values 100 of the sts were within 10 min 4 the most suitable trs was 15 min for obtaining accurate numerical simulations of urban flood inundation in both test cases considering the availability of forecasted storm data to the best of our knowledge this study is the first study to quantify the effects of the trs on urban flood inundation and the findings provide valuable insight regarding improvements in the accuracy of urban flood inundation simulations however this study has some limitations specifically the presented findings are obtained for only two test cases additionally the size of the study area may have some influence on trs when the size of the study area is bigger than 1 km2 the effect of trs on average re of inundation peak decrease with the size of the study area increase whereas when the size of the study area is smaller than 1 km2 the effect of trs on average re of inundation peak decrease with the size of the study area decrease lyu et al 2018 future research should focus on the effects of different types of areas on urban flood inundation based on the approach in the second test case 5 author statement jingming hou and na wang have made substantial contributions to the conception and design of the work data analysis and manuscript preparation kaihua guo donglai li haixiao jing tian wang and reinhard hinkelmann helped perform the analysis with constructive discussions all authors contributed to the development of ideas and to write the manuscript all persons who have made substantial contributions to the work reported in the manuscript including those who provided editing and writing assistance but who are not authors are named in the acknowledgments section of the manuscript and have given their written permission to be named declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is partly supported by the national key research program during the 13th five year plan 2016yfc0402704 shaanxi water conservancy science and technology program 2017slkj 14 national natural science foundation of china 51709223 2017 ningxia construction science and technology plan project numerical simulation research on key indicators of sponge city construction effect 2017 hmkt 01 
5234,the temporal resolution of storm data plays an important role in constructing reliable inundation simulations the effects of the temporal resolution of storms with different return periods peak coefficients and durations on the simulated flood inundation were investigated with a two dimensional numerical model after analysing the modelled inundation peak values and occurrence times which are affected by the temporal resolution of a storm the following conclusions were obtained 1 the accuracy of the simulated inundation results in terms of the peak values and shift times of the storm increases as the temporal resolution of the storm increases 2 for the same temporal resolution of storm the accuracy of the simulated inundation in terms of the peak values and shift times increases as the storm return period increases except for the shift time in the second test case investigated 3 for the same temporal resolution of storm the accuracy of the simulated inundation in terms of the peak values and shift times of the storm does not display an obvious correlation with the storm peak coefficient and storm duration and 4 the most suitable temporal resolution of storm is 15 min for obtaining an accurate numerical simulation of urban flood inundation these results can help researchers understand the key effects of the temporal resolution of storms on urban flood inundation and identify storm temporal resolutions that can produce relatively accurate simulated inundation results even without high temporal resolution data keywords urban flood inundation temporal resolution storm numerical simulation relative error shift time nomenclature gast gpu accelerated surface water flow and transportation trs temporal resolution of storm min minute re relative error st shift time i the designed storm intensity mm minute q the designed storm intensity l s ha p storm return period year t storm duration min c storm peak coefficient t time subscript x x axis of the cartesian subscript y y axis of the cartesian q the variable vector h depth of water q x single width discharge in x axis direction q y single width discharge in y axis direction f the flux vector of x direction g the flux vector of y direction s source vector s b slope source terms s f friction source terms u current velocity of x direction v current velocity of y direction zb the bottom elevation of riverbed cf the chezy s coefficient c f g n 2 h 1 3 n manning coefficient i net storm rate ir the storm rate ii the infiltration rate z the water level z h z b 1 introduction due to global warming in recent years short duration extreme storms have occurred frequently mailhot et al 2010 westra et al 2014 xie et al 2010 which has led to serious flood inundation issues especially in urban areas where there are abundant of impermeable surfaces for example the flood that occurred in boulder colorado united states of america in september 2013 when approximately 1 year worth of rain fell in 6 days led to widespread flooding causing 8 deaths and significant infrastructure damage deniz et al 2016 outside of the usa the flood that occurred in beijing the capital of china on 21 july 2012 lasted for approximately 16 h and the amount of precipitation reached 215 mm resulting in 79 fatalities and approximately 1 6 billion in damage zhang et al 2015 substantial research efforts have been made to mitigate urban flood inundation issues the most effective methods involved forecasting the inundation situation using hydrodynamic numerical models of urban a hydrodynamic numerical model can simulate flood inundation conditions with high precision depending on the precision of input data especially high temporal resolution storm data however the temporal resolution of the existing forecast storm data sets is relatively low for example the european centre for medium range weather forecasts ecmwf a unique international organisation that focuses on weather forecasting research developed a model that can only predict storm data with a temporal resolution of 6 h manzato et al 2019 similarly the weather research and forecasting wrf model from which reliable hourly resolution storms are generated by selecting suitable physical schemes for specific regions pan et al 2015 patel et al 2019 consequently it is important to investigate the effects of the temporal resolution of storm data on urban flood inundation cecinati et al 2017 hailegeorgis and alfredsen 2018 lyu et al 2018 song et al 2017 and to choose input data sets with an appropriate temporal resolution to run models and obtain accurate inundation simulation results in recent years an increasing amount of research has investigated the effects of the temporal resolution of storms trss on inundation anis and rode 2015 behrangi et al 2012 cecinati et al 2017 coulthard and skinner 2016 hailegeorgis and alfredsen 2018 lobo and bonilla 2015 lyu et al 2018 song et al 2016 thorndahl et al 2014 yoon et al 2017 huang et al 2019 analysed the sensitivity of daily and hourly temporal resolutions of storm with the distributed hbv hydrologiska byråns vattenbalansavdelning model and concluded that high trss can lead to a significant improvement in model performance bruni et al 2015 studied the effects of the trs on urban flood inundation by considering 4 sets of radar based storms with temporal resolutions of 1 min 5 min and 10 min and found that compared with the maximum inundation depth the peak inundation value is more sensitive to the trs in addition due to the aggregation of trs data the decorrelation length increased and the occurrence time of the inundation peak shifted by several minutes however the relative error re of the inundation peak value and specific shift time st with different trss remain uncertain the return period peak coefficient and duration are the major characteristics of storms and the differences in these values reflect different sensitivities to disasters the storm peak coefficient is related to the distribution of the rainstorm intensity at a given time scale and the maximum intensity and depth of inundation the effects of the storm duration on runoff discharge prediction were studied by changhwan kim who found that the storm duration is an important factor for accurately forecasting flood inundation kim and kim 2018 however few studies have investigated the effects of the trs on urban flood inundation considering different storm return periods peak coefficients and durations in this paper the effects of the trs on urban flood inundation are investigated by using different return periods p peak coefficients t and durations c of storm data based on a two dimensional hydrodynamic model called gast gpu accelerated surface water flow and transport model hou et al 2016 2018 the temporal resolutions of the storm data were 1 min 5 min 15 min 30 min 60 min and 180 min and the relative error and shift time of the inundation peak were calculated and analysed this paper focused on the following three objectives 1 investigating the effects of the trs on the accuracy of the simulated inundation in terms of the peak value and shift time 2 studying the effects of storm return periods peak coefficients and durations on the accuracy of simulated inundation in terms of the peak value and shift time and 3 determining the most suitable trs for obtaining an accurate numerical simulation of urban flood inundation these findings can be used to develop an effective method for obtaining high resolution simulations of flood inundation with the appropriate trs data and contribute to forecasting urban flood inundation thereby providing flood risk warning information for scientists and decision makers 2 methods and data 2 1 the two dimensional hydrodynamic model the gast model used in this study is governed by the godunov type finite volume method of solving the 2d shallow water equations swes and is coupled with hydrological and hydrodynamic processes 2 1 1 governing equations the governing equations used in the gast model are the 2d shallow water equations swes which are derived by vertically averaging the reynolds averaged navier stokes equation ranse assuming the hydrostatic pressure distribution and neglecting viscous and turbulent stresses in a conservative form the vector format of the 2d shallow water equations can be written as follows liang 2010 liang and marche 2009 1 q t f x g y s 2 q h q x q y f q x u q x g h 2 2 μ q y g q y υ q x υ q y g h 2 2 3 s s b s f i g h z b x c f u u 2 υ 2 g h z b y c f υ u 2 υ 2 where t represents the time x and y represent the x axis and y axis of the cartesian coordinates respectively q denotes the variable vector which includes the depth of water h and single width discharges q x and q y f and g are the flux vectors in the x direction and y direction respectively s is the source vector and can be subdivided into slope source terms s b and friction source terms s f u and v are the current velocities in the x direction and y direction respectively z b represents the bottom elevation of the riverbed c f is chezy s coefficient which can generally be calculated by c f g n 2 h 1 3 n is the manning coefficient and runoff yield in excess of infiltration was adopted in the model i denotes the net storm rate which is computed by i i r i i where i r and i i denote the storm rate and infiltration rate respectively the value of i just change with the value of i r and i i when i r i i i e the storm rate is higher than the infiltration rate i is a source term and i is positive otherwise when i r i i i e the storm rate is lower than the infiltration rate i is a sink term and i is negative it should be noted that the net increasing water depth in a cell must following equation 4 to preserve the mass conservation 4 h m a x h l i d t 0 where h represents the water depth at the present moment mm h l indicates the water depth at the last moment mm dt is the time step in addition the water level is computed by the formula z h z b 2 1 2 numerical method in this model the godunov type finite volume method is applied to discretise the swes simons et al 2014 the dynamic wave method is adopted to simulate the evolution process of basin floods to consider rapidly varying flows and discontinuities smith and liang 2013 an approximate riemann solver based on the harten lax van leer contact hllc method is used to calculate the mass flux and momentum flux at the cell interface hou et al 2013 the slope flux method is proposed to evaluate the slope source term and solve momentum non conservation issues which are caused by variable topography hou et al 2013 a second order explicit method is used in the friction source term to ensure the second order accuracy of time integration hou et al 2013 the issue of the negative water depth at the wet and dry boundary is solved by employing a hydrostatic reconstruction method when the water level is lower than 0 000005 m the grid is considered a dry grid which means both velocity and water depth are set to zero otherwise the grid is considered a wet grid in addition by replacing the single width velocity with the flow velocity the second order scheme of the algorithm is automatically reduced to the first order form hou et al 2013 in which the water depth and velocity change dramatically to ensure stable operation at the wet and dry boundaries liang and smith 2015 the water balance concept is applied to evaluate the runoff process runoff is generated only when the storm rate is larger than the sum of the surface storage and infiltration rates gpu acceleration technology plays a dominant role in improving the computational efficiency and reducing economic costs smith and liang 2013 in addition high resolution dem data are among the most important inputs in hydrodynamic simulations to obtain realistic surface features and accurate fill volumes the principle of equivalent infiltration is applied to quantitatively consider the drainage capacity of urban underground pipeline networks specifically the drainage capacity is calculated according to practical design standards and as an infiltration rate added to the grid where the area is affected by the network 2 2 data two test cases are used in this study the first test case is based on normalized terrain and the second test case involves part of the xixian new area in xi an both test cases require different temporal resolutions of storm data and basic underlying surface data 2 2 1 storm data with different temporal resolutions the storm data used in the two test cases are the same currently the highest temporal resolution of storm data is 5 min and the data are collected by rain gauges the main temporal resolutions of the storm data predicted by meteorological models are 180 min and 360 min or longer for example the trs of 180 min of grapes meso data and t639 data can be download from the website of national meteorological science data center http data cma cn data cdcdetail datacode f 0009 0001 html the trs of 360 min of ecmwf data can be download from the website of european centre for medium range weather forecasts https apps ecmwf int datasets in addition the lower temporal resolution forecast storm data exists but it is very difficult to obtain the trs of 1 min can be generated by the chicago rain generator therefore 6 different resolutions of trs data are selected for analysis including 1 min 5 min 15 min 30 min 60 min and 180 min tables 1 and 2 show the different storm characteristics considered in this study including 3 different storm return periods p 3 different storm peak coefficients t and 3 different storm durations c non repeated permutations and combinations of different storm characteristics were considered to assess the influence of different factors therefore this study required 6 3 3 3 162 different storm data sets in total according to the code for design of outdoor drainage gb50014 2006 a design code of china the designed storm formula of the xixian new area hou et al 2016 2017 was adopted and this formula is as follows 5 i q 167 1239 91 1 1 971 lgp 167 t 7 4246 0 8124 where i is the designed storm intensity mm min q is the designed storm intensity l s ha lg is the logarithm base 10 p represents the designed return period year and t indicates the storm duration minute trs of 1 min are generated by the chicago rain generator trss of 5 min 15 min 30 min 60 min and 180 min are generated from the 1 min trs data by upscaling the storm data here storm data with a temporal resolution of 5 min are taken as an example to illustrate the method of generating upscaled storm data first the sum of every five consecutive data points of the 1 min storm data is obtained second the sum is divided into 5 replicate values on average finally the data unit is converted to mm h which is used in the gast model the upscaled storm data with 15 min 30 min 60 min and 180 min temporal resolutions are obtained by the same method 2 2 2 basic underlying surface data for the two test cases the basic underlying surface data include high resolution digital elevation model dem data land use data and the corresponding manning values infiltration data and data on the equivalent infiltration of the urban pipe network in the first test case the elevation of the dem is the same everywhere and the corresponding map is shown in fig 1 the terrain is a rectangular grassland with an area of 1 10 4 m2 and the length and width of each computational element are set as 1 m the land use is grassland and the corresponding manning value is 0 06 three different infiltration values are chosen from the infiltration data for the second test case table 1 including is 8 96 mm h im 19 43 mm h and il 37 55 mm h which represent small moderate and large infiltrations respectively for the second test case dem data are extracted from the real terrain of the xixian new area xi an china there are 1129 and 816 transverse and longitudinal grids of dem data respectively the resolution of the grids is 2 m fig 2 and the area is 3 69 km2 the land use is divided into 5 categories fig 3 and the corresponding manning values are taken from the relevant literature the infiltration data are obtained by measurements and the value of equivalent infiltration is 10 47 mm h the specific values of input data are shown in table 2 in the first test case 162 different storm data sets and 3 categories of infiltration conditions are considered resulting in 162 3 486 different simulated inundations storm data sets with the same p t and c values and different trss are classified as different scenarios yielding 486 6 81 scenarios table 1 in the second test case 162 different storm data sets and 1 infiltration condition are considered resulting in 162 1 162 different simulated inundations as in the first test case storm data sets with the same p t and c values and different trss are classified as different scenarios yielding 162 6 27 cases table 2 the two test cases total 486 162 648 simulated inundations and 81 27 108 scenarios 2 3 evaluation indicator of the modelling accuracy 2 3 1 the relative error of the inundation peak to statistically and quantitatively describe the effects of the trs of peak inundation the relative error re of the inundation peak which is a dimensionless parameter is used to quantify the difference between a peak value of verified accuracy and simulated values here the simulated flood inundations based on storm data with a trs of 1 min are taken as the verified accurate values and the flood inundations simulated by other upscaled storm data series are taken as the simulated values including for trss of 5 min 15 min 30 min 60 min and 180 min the formulation of re is as follows 6 re q s q a q a 100 where q s represents a simulated value of the inundation peak m3 and q a represents the verified actual value of the inundation peak re 0 indicates that the simulated value is underestimated compared with the verified actual value and re 0 indicates that the simulated value is overestimated compared with the verified actual value 2 3 2 the shift time of the inundation peak to statistically and quantitatively describe the effects of the trs on the shift time st of the inundation peak the st of the inundation peak is assigned to quantify the difference of the inundation peak between the actual and simulated values the formulation of st is as follows 7 st t s t a where st represents the st of the inundation peak t s represents the occurrence time min of the simulated value of the inundation peak and t a represents the verified actual occurrence time st 0 indicates that the occurrence time of the simulated inundation peak lags behind the verified actual time st 0 indicates that the occurrence time of the simulated inundation peak is before the verified actual time and st 0 indicates that the occurrence time of the simulated inundation peak is equal to the verified actual time 3 results and discussion based on 684 simulated inundations the inundation depth curves shown as fig 4 were plotted the inundation volume data for the two test cases with different trss were obtained to analyse the effects of the trs on urban flood inundation for different p t and c values in fig 4 a the inundation depth is the same everywhere because the topographic height in the first test case is the same everywhere which is consistent with the expected result in fig 4 b the inundation depth is consistent with the actual depth and there is more inundation at intersections and in low lying areas than in other areas fig 4 indicates that the simulation results can be used to assess the effects of the trs on urban flood inundation additionally all the simulated inundations display same trends when analysing the effects of the trs on the inundation process therefore only individual simulation cases are analysed considering the length limitation of the article 3 1 effects of the trs on the inundation peak for different storm return periods fig 5 shows the inundation process for trss with different storm return periods in the first test case notably the accuracy of the inundation results increases as the trs increases and the storm return period increases the inundation results for trss of 1 min 5 min and 15 min almost perfectly coincide with the storm return period however the inundation results for trss of 30 min 60 min and 180 min display a large disparity with the results for a trs of 1 min fig 6 shows the corresponding inundation process plot for the second test case in general the same trends as observed in the first test case are identified and the accuracy of the corresponding inundation result slightly increases fig 7 a shows the re of the inundation peak in the first test case additionally the accuracy change trend for a given trs and storm return period is same as the inundation process shown the singularity points with large res the m point and n point all appeared in p 1 indicating that a low storm return period leads to a low precision inundation simulation for the trs of 5 min the re value reached 10 for p 50 and 20 for p 5 for the trs of 15 min the re value reached 10 for p 50 and 20 for p 5 however for the trss of 30 min 60 min and 180 min the re value just reached 20 45 and 100 for p 50 respectively and these accuracies were quite low the variations in the proportions of different sts in the first test case fig 7 b indicate that the accuracy trend changes with the trs and storm return period as reflected by the inundation results for the trs of 5 min 100 of the sts were within 5 min for the trs of 15 min almost 100 of the sts were within 10 min for p 5 and p 50 for trss of 30 min 60 min and 180 min the corresponding proportion gradually decreased the re of the inundation peak in the second test case fig 8 a shows that the accuracy trend varies with the trs and storm return period this result is surprisingly similar to the trend observed for the inundation results in the first test case the corresponding re value decreased slightly for the trs of 5 min the re value reached 1 for p 50 and p 5 and 10 for p 1 for the trs of 15 min the re value reached 2 for p 50 10 for p 5 and 48 for p 1 however for trss of 30 min 60 min and 180 min the re values reached 8 39 and 60 for p 50 respectively these accuracies are quite low the proportions of different sts in the second test case fig 8 b show that accuracy trend varies with the trs and storm return period this result is surprisingly similar to the trend observed from the inundation results in the first test case in addition the accuracy of the simulated inundations increased slightly in this case for the trs of 5 min 100 of the sts were within 5 min and for the trs of 15 min 100 of the sts were within 10 min however for trss of 30 min 60 min and 180 min the corresponding percentages gradually decreased figs 5 8 indicate that the accuracy of simulated inundations increases as the trs increases and the storm return period increases therefore trss of 5 min and 15 min can meet the research requirements in addition considering the availability in the forecasted storm data a storm with a trs of 15 min would be the optimal choice which is consistent with the findings of lyu et al 2018 3 2 effects of the trs on the inundation peak for different storm peak coefficients for different storm peaks and trss in the first test case fig 9 the accuracy of the inundation process increases as the trs increases and the effect is similar to that of the storm return period however there is no obvious correlation between the accuracy of the simulated inundations and the storm peak coefficient in the second test case fig 10 the results are similar to those in the first test case although the accuracy of the corresponding inundation result slightly increased the re of the inundation peak in the first test case fig 11 a shows that the accuracy varies with the trs but the re of the inundation peak has no obvious correlation with the storm peak coefficient for the trs of 5 min the re value can reach 12 for c 0 5 which is larger than 9 for c 0 8 and 2 for c 0 2 however for the trs of 15 min the re value can reach 50 for c 0 5 which is larger than 20 for c 0 8 and smaller than 55 for c 0 2 the re values of trss of 30 min 60 min and 180 min all reach 100 thus the corresponding parameters cannot be used in research and practice the proportions of different sts in the first test case fig 11 b indicate that the accuracy increase with the trs rises but the proportions of different sts displayed no obvious correlation with the storm peak coefficient for the trs of 5 min 100 of the sts are within 5 min for the trs of 15 min the proportions of different sts within 10 min were 89 for c 0 2 and 78 for c 0 5 and c 0 8 whereas for trss of 30 min 60 min and 180 min the corresponding proportions gradually decreased the re of the inundation peak in the second test case fig 12 a shows that the accuracy changes with the trs as for the inundation process in the first test case and the corresponding re value decreases slightly for the trs of 15 min the re value can reach 40 for c 0 5 which is smaller than 42 for c 0 2 and 50 for c 0 8 the proportions of different sts in the second test case fig 12 b indicate that the accuracy varies with the trs as in the first test case however the accuracy of the simulation results increases slightly in this case notably for the trs of 15 min 100 of the sts are within 10 min figs 9 12 show that the accuracy of simulated inundations increases as the trs increases but do not show an obvious correlation between the inundation volume and the storm peak coefficient because the inundation volume is equal to the storm volume minus infiltration thus the storm and infiltration volumes are determined by the cumulative storm intensity and infiltration rate respectively however the storm peak coefficient has no effect on the cumulative storm intensity therefore there is no correlation between the storm peak coefficient and the accuracy of the simulated inundation values as shown in the storm return period results the results for a storm with a trs of 15 min are better than those for storms with other trss 3 3 effects of the trs on the inundation peak for different storm durations the inundation process of the trs with different storm durations in the first test case fig 13 shows that similar to the effects of the storm return period performed the accuracy of the inundation process increases as the trs rises however similar to the effects of storm peak coefficient performed there is no obvious correlation between the accuracy of simulation inundation and storm duration the inundation process of the second test case fig 14 except for getting the same rules as in the first test case shown the accuracy of the corresponding inundation process increased slightly the re of the inundation peak in the first test case fig 15 a shows that the accuracy changes with the trs as for the inundation results but the re of the inundation peak has no obvious correlation with the storm duration for the trs of 5 min the re value can reach 7 for t 6 which is smaller than 11 for t 3 and 9 for t 9 however for the trs of 15 min the re value can reach 70 for t 6 which is larger than 25 for t 3 and 50 for t 9 the re values of trss of 30 min 60 min and 180 min all reach 100 and the corresponding parameters cannot be used in research or practice the proportions of different sts in the first test case fig 11 b shows that the accuracy variation with the trs is the same as that observed for the inundation results additionally the proportions of different sts have no obvious correlation with the storm duration for the trs of 5 min 100 of the sts were within 5 min for the trs of 15 min approximately 82 78 and 85 of the sts were within 10 min for t 3 t 6 and t 9 respectively however for trss of 30 min 60 min and 180 min the corresponding proportions gradually decreased the re of the inundation peak in the second test case fig 16 a shows that the accuracy variations with the trs are the same as those for the inundation results in the first test case and the corresponding re value slightly decreases for the trs of 15 min the re can reach 50 for t 6 which is larger than 40 for t 3 and 23 for t 9 the proportions of different sts in the second test case fig 16 b show that the accuracy variation with the trs is the same as that for the inundation results in the first test case however the accuracy of the simulation result increased slightly compared with that in the first test case for the trs of 15 min 100 of the sts are within 10 min figs 13 16 indicate that the accuracy of the simulated inundations increases with increasing trs but that the simulated inundation is not obviously correlated with the storm duration similar to the storm peak coefficient the storm duration has no effect on the cumulative value of the storm intensity therefore there is no correlation between the storm peak coefficient and the accuracy of the simulated inundation values based on the storm return period and peak coefficient the results for the storm with a trs of 15 min are better than those for storms with other trss 4 conclusions and outlook in this paper the effects of the trs on the simulated flood inundation are investigated using a two dimensional numerical model with different return periods peak coefficients and durations to study and analyse the effects of the trs considering different storm characteristics the objectives of the study were to discover an appropriate trs that could produce reliable simulated inundation results and quantify the re and st of the inundation peak for the appropriate trss the main findings and implications of this study are as follows 1 the accuracy of the simulated inundation values in terms of the peak and st increased as the trs rise in the two test cases and the accuracy in the second test case was higher than that in the first test case in the second test case the maximum re reached 10 48 75 100 and 100 for trss of 5 min 15 min 30 min 60 min and 180 min respectively the majority of sts were within 0 min 5 min 15 min and other for trss of 5 min 15 min 30 min 60 min and 180 min respectively 2 for the same trs in the first test case the accuracy of the simulated inundation results in terms of the peak value and shift time increased as the storm return period increased in the second test case the accuracy of the simulated inundation peak value increased as the storm return period increased but the shift time of the storm did not display an obvious correlation with the storm return period notably in the second test case for the trs of 15 min the re value of the inundation peak reached 1 10 and 48 for p 50 p 5 and p 1 respectively additionally 100 of the sts were within 10 min 3 for the same trs in the two test cases the accuracy of the simulated inundation values in terms of the peak value and shift time did not show obvious correlations with the storm peak coefficient or storm duration for example in the second test case for the trs of 15 min the re value of the inundation peak reached 42 40 and 50 for c 0 2 c 0 5 and c 0 8 and 40 50 and 23 for t 3 t 6 and t 9 respectively additionally for different c and t values 100 of the sts were within 10 min 4 the most suitable trs was 15 min for obtaining accurate numerical simulations of urban flood inundation in both test cases considering the availability of forecasted storm data to the best of our knowledge this study is the first study to quantify the effects of the trs on urban flood inundation and the findings provide valuable insight regarding improvements in the accuracy of urban flood inundation simulations however this study has some limitations specifically the presented findings are obtained for only two test cases additionally the size of the study area may have some influence on trs when the size of the study area is bigger than 1 km2 the effect of trs on average re of inundation peak decrease with the size of the study area increase whereas when the size of the study area is smaller than 1 km2 the effect of trs on average re of inundation peak decrease with the size of the study area decrease lyu et al 2018 future research should focus on the effects of different types of areas on urban flood inundation based on the approach in the second test case 5 author statement jingming hou and na wang have made substantial contributions to the conception and design of the work data analysis and manuscript preparation kaihua guo donglai li haixiao jing tian wang and reinhard hinkelmann helped perform the analysis with constructive discussions all authors contributed to the development of ideas and to write the manuscript all persons who have made substantial contributions to the work reported in the manuscript including those who provided editing and writing assistance but who are not authors are named in the acknowledgments section of the manuscript and have given their written permission to be named declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is partly supported by the national key research program during the 13th five year plan 2016yfc0402704 shaanxi water conservancy science and technology program 2017slkj 14 national natural science foundation of china 51709223 2017 ningxia construction science and technology plan project numerical simulation research on key indicators of sponge city construction effect 2017 hmkt 01 
