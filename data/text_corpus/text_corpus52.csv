index,text
260,salt deposition has been encountered in near wellbore regions of saline reservoirs during field scale carbon dioxide co2 sequestration to explain this phenomenon pore scale studies mostly in the form of micromodel visualizations have been previously implemented however there is limited knowledge about salt deposition and inherent dynamics in reservoir rocks this study investigates and characterizes the pore scale evolution of salt precipitation in natural sandstone and carbonate rocks at conditions prevalent in deep saline aquifers using x ray micro tomography imaging techniques three evolution stages advection dominated transition and diffusion dominated evaporative drying are delineated we provide direct evidence for a new mechanism that occurs during the transition from advection to diffusion limited flow called reverse solute diffusion this is typified by upward solute diffusion from regions of lower concentrations within the aqueous phase to the highly concentrated evaporating front salt deposits eventually form due to solute accumulation at the brine supercritical co2 interface the time and extent of precipitation are influenced by co2 injection rate and morphological heterogeneity specifically a higher injection rate increases the rapidity of precipitation but causes lower salt deposition furthermore less precipitates form as systems become more homogeneous for the same injection rate these relationships directly correlate with porosity reduction leading to a gradual but higher degree of pore plugging in heterogeneous systems keywords carbon dioxide co2 sequestration salt precipitation saline aquifers evaporative drying micro computed tomography imaging pore scale 1 introduction carbon neutrality in the energy sector has been at the forefront of global policy advocacy in recent years this has become even more important because greenhouse gas emissions have continued on an upward trend increasing the vulnerability of a variety of ecosystems and communities to the debilitating effects of climate change hewitson et al 2014 colburn et al 2016 li et al 2018 it prescribes that energy comes from renewable sources such as wind and solar systems but when it is derived from fossil based sources the resulting carbon dioxide co2 emissions have to be counteracted by an equal measure of carbon capture and storage european parliament 2019 carbon geological sequestration is the main option for large scale co2 storage under this scheme captured co2 is injected into subsurface formations such as deep saline aquifers depleted hydrocarbon reservoirs and uneconomical coal bed seams at supercritical conditions above 1070 psi and 31 c bickle 2009 friedmann 2007 field scale co2 utilization in the petroleum industry for enhanced oil recovery has been implemented since the 1970s merchant 2017 carbon dioxide has been injected as a separate gas phase such as in water alternating gas injection schemes worden and smith 2004 or pre dissolved in brine before injection as in the case of carbonated water flooding torrey 1951 hickok et al 1960 alizadeh et al 2014 this serves a dual purpose of storage and hydrocarbon production co2 storage in saline aquifers is a more recent endeavor it has arisen because of the need for more storage capacity that does not directly result in hydrocarbon production there are at least five fully commercialized and operational large scale co2 geo sequestration projects in deep saline aquifers among other pilots and projects still under development global ccs institute 2020 the first is the sleipner field project offshore norway which started operation in 1996 equinor 2019 2021 other notable projects are the quest project canada the illinois basin decatur project usa the snøhvit field project norway and the gorgon co2 injection project australia global ccs institute 2019 global ccs institute 2020 implementing carbon storage has come with attendant challenges at the field scale potential issues emanating from storage integrity such as leakage risks seismic tremors from over pressurization and uncertainties in reservoir characterization have come up damen et al 2006 koornneef et al 2012 de coninck and benson 2014 another problem that has been encountered in pilots is the precipitation of dissolved salts mostly halite from brine in near wellbore regions of reservoirs during co2 injection specifically in saline aquifers salt precipitation has been suspected of causing low permeability zones in near wellbore areas baumann et al 2014 grude et al 2014 a case in point is the ketzin field germany where it was discovered through a combination of radiometric pulsed neutron gamma png logging and extended saturation modeling that water evaporation ultimately resulting in halite precipitation caused an unusually high co2 saturation in a near wellbore formation baumann et al 2014 another suspected case of salt precipitation was in the snøhvit field here significant pressure buildup was encountered during co2 injection into a near wellbore formation grude et al 2014 this was caused by an unusually low permeability zone around this region which in turn was suspected to be a consequence of salt precipitation leading to injectivity loss a mixture of methyl ethyl glycol and water had to be injected to stimulate the well grude et al 2014 injectivity loss occurs when the permeability in the near wellbore region decreases due to the plugging of pores in this vicinity limiting the injected fluid migration to further regions in the reservoir benson et al 2005 solomon and flach 2010 this severely affects injection efficiency as it would require more energy to introduce fluids such as co2 into the main reservoir for the same injection rate if unabated declining injectivity would lead to pressure buildup in and around the well causing catastrophic effects additional expenses would also be incurred in well workover operations mainly stimulation to counteract this effect and in some cases drilling a new well might be required solomon and flach 2010 salt deposition in porous media is a natural phenomenon that occurs at both ambient and higher temperature and pressure conditions all water bearing porous media exposed to a flowing undersaturated gas that can evaporate water would eventually dry out due to water moving from the aqueous phase to the gaseous phase a consequence of this is solute deposition the extent of which depends on the solute concentration in the aqueous phase the theory of salt precipitation is directly related to evaporation evaporative drying within porous media is a physical process that happens either naturally as in evapotranspiration in plants and soils or anthropogenically on buildings masonry and during geological carbon sequestration or et al 2013 rufai and crawshaw 2018 early studies on evaporative drying due to porous media exposure to air have delineated three drying regimes the advection dominated constant rate period crp the falling rate period frp and the diffusion dominated receding front period rfp chauvet et al 2009 lehmann et al 2008 during the crp the gas phase accesses and invades the pore space on the attainment of the capillary entry threshold pressure required for the invasion of connected pore elements as the undersaturated gas invades the pores and displaces water it also contacts other bypassed pores that are water filled but hydraulically connected to the displaced pores having water in the crevices and corners chauvet et al 2009 depending on factors such as salinity grain size pore size and wettability the crp could last from a few minutes to several hours and is characterized by a high and constant evaporation rate lehmann et al 2008 chauvet et al 2009 rufai and crawshaw 2018 afterward the drying process is characterized by a transition period where the evaporation rate begins to decrease drastically because of lower water saturation in pore bodies lehmann et al 2008 or et al 2013 this frp culminates in reducing advective flow contribution to the drying process and an increase in diffusive flow chauvet et al 2009 lehmann et al 2008 thereafter diffusion dominated rfp is attained where water is transferred through the interfaces to the gas phase due to the concentration difference between water bearing pores and the undersaturated gas chauvet et al 2009 in brine saturated systems salt precipitation within the dried pores shortens the crp because the initially high evaporation rate induces early precipitation at the entry surface causing an increase in solute demand from the hydraulically connected brine in the main porous medium shokri et al 2010 rufai and crawshaw 2018 this results in an increase in diffusion controlled drying and salt deposition starting from the entry surface i e the inlet surface during experimental gas injection to the evaporation front within the porous medium shokri et al 2010 rufai and crawshaw 2018 solute transport within the connected brine is supported by a capillary pressure gradient and not the advective pressure drop that allows for brine countercurrent flow backflow or reflow towards the entry surface shokri et al 2010 ott et al 2015 miri and hellevang 2016 eventually as solutes accumulate and precipitate out of the brine phase the hydraulic conductivity of the pores significantly reduces and some pore elements could become plugged salt deposition could occur at the entry surface in the corners of dried out pores and in the center of pore elements depending on factors such as pore size grain size wettability and salt type shahidzadeh bonn et al 2008 previous experimental studies have investigated the order type and distribution of salt deposits shahidzadeh bonn et al 2008 ott et al 2015 specifically ott and coworkers suggested that the evaporative drying order starts with a short time attainment of a residual brine saturation followed by a longer dry out period resulting in salt precipitation ott et al 2015 they also discovered that the precipitation distribution is non homogeneous and restricted to pores and throats previously occupied by brine others have looked into the effects of grain size grain angularity and pore size on salt precipitation ott et al 2013 veran tissoires and prat 2014 hidri et al 2013 rad et al 2015 rad and shokri 2014 particularly studies by rad and coworkers have revealed that as pore size increases and as grain angularity decreases salt precipitation in macropores increases in addition to this salt deposition becomes more homogeneous and surface deposits become thicker rad et al 2015 rad and shokri 2014 according to a literature review by miri hellevang 2016 the effect of gas flow rate on evaporation and salt precipitation is inconclusive they argue that on the one hand a higher injection rate will result in a suppression of the capillary reflow or backflow of water to the evaporating surface thereby reducing the extent of salt deposition at evaporating sites however on the other hand higher rates connote higher injection pressures which in turn increase the evaporation rate relative to capillary reflow causing a more expansive accumulation of salt deposits miri and hellevang 2016 he and coworkers endeavored to address this in the context of co2 injection in hydrophilic micromodels they observed that at a flow rate of 0 1 ml min salt clusters accumulated at the mainstream region of the micromodel causing less salt deposition in peripheral regions at higher rates 0 5 ml min and 2 ml min the amount of precipitated salt decreased however salt deposits were more evenly distributed across all regions of the micromodel they attributed this observation at higher rates to an increase in the velocity gradient that prevented the backflow of brine towards the mainstream region he et al 2019 most pore scale experiments on evaporative drying have been implemented with single or bundles of capillary tubes polished micromodels uniformly round glass beads and sandpacks veran tissoires and prat 2014 hidri et al 2013 rad et al 2015 rad and shokri 2014 miri et al 2015 kim et al 2013 however only ott and coworkers and most recently falcon suarez et al 2020 and lopez et al 2020 have used naturally occurring rock sandstone and carbonate samples in their pore scale experimental investigations of in situ salt precipitation ott et al 2013 2014 2015 falcon suarez et al 2020 lopez et al 2020 in addition although numerous investigations have been conducted in the form of surface gas flow at ambient conditions applicable to soil salinization and building masonry structures or et al 2013 shokri et al 2010 rad and shokri 2014 rad et al 2015 hidri et al 2013 veran tissoires and prat 2014 shahidzadeh bonn et al 2008 there is a shortage of pore scale experimental studies at higher pressure and temperature conditions applicable to supercritical co2 storage in deep saline aquifers ott et al 2013 2014 2015 he et al 2019 therefore in this work we investigate the pore scale evaporative drying process that leads to salt precipitation in brine saturated porous rocks by performing miniature core flooding experiments with simultaneous high resolution x ray imaging at high pressure and temperature conditions we first carry out an in depth investigation on the evolution of the evaporative drying process highlighting the different forces that control component transport within and across phases we then analyze the extent and distribution of salt deposits within pore elements afterward we determine the effect of physical heterogeneity of the porous medium on precipitate occupancy within pore elements we further ascertain the impact of the supercritical co2 injection rate on the rapidity and amount of salt deposition finally we quantify the contribution of salt precipitation to porosity reduction in the subsequent sections of this article we first highlight and describe the materials apparatus and procedures employed in the course of our experimental investigation we then present experimental results and discuss salient observations which are eventually distilled into concluding remarks 2 materials and methods the overall methodology of this study covers pore scale micron and sub micron investigation and characterization of salt precipitation in natural porous media containing two fluid phases brine and co2 at subsurface reservoir conditions the micro scale investigation is conducted by incorporating micro computed tomography micro ct imaging with core flooding and the sub micron characterization is performed by using scanning electron microscopy sem techniques to simulate near wellbore flow and transport during gas injection in saline aquifers at elevated pressure and temperature conditions the experiments were performed at 1500 psi pore pressure and 50 c temperature selected based on a study by saraji et al 2014 in which saline aquifer candidates for co2 injection were characterized using pressure and temperature gradients see the supplementary materials 2 1 rock properties 2 1 1 rock samples two outcrop rock samples were used in this study the first is a clashach sandstone rock sample with mineral grains comprising 89 quartz 10 feldspar mostly k feldspar and 1 mica mostly illite see fig 1 a although clashach is well known as one of the less clay bearing sandstones trace amounts of intergranular microporous clay minerals illite and kaolinite still form a distinct matrix within the rock iglauer et al 2012 duthie 2012 the second rock sample used is prairie shell limestone this carbonate rock is about 96 calcite with marginal quantities of quartz 2 apatite 0 9 dolomite 0 4 and trace amounts of anhydrite biotite and illite see fig 1 b prairie shell has a fossil based solid phase system hence it is a bioclast having intergranular moldic and slightly vuggy macroporosity with various instances of microporosity microporosity could be intragranular intrafossil within fossil shells or intercrystalline across clay particles sandstone reservoir rocks are generally known to be quite homogenous in terms of pore size distribution this is because they are usually well sorted with uniform grain size overall the diagenetic processes of mechanical compaction due to overburden stress and cementation contribute to the eventual pore morphology haldar and tišljar 2014 the degree of heterogeneity of carbonate rocks depends on the morphology which in turn is a function of the origin of the rock fossils are the more heterogeneous of the non cemented carbonates because they emerge from the accumulation and compaction of shells endo and exoskeletons of land and marine animals haldar and tišljar 2014 pore size distributions of both sandstone and carbonate core samples used in this study have been determined from a pore space analysis conducted on micro ct images fig 2 compares the pore size distribution of prairie shell to that of clashach the pore size distribution of clashach is narrow and uniform with a range between 8 µm and 250 µm in addition it has a modal pore size of 87 µm it should be noted that we have defined pore size as the equivalent pore diameter an approximation of a circular pore geometry the prairie shell pore size distribution is wider ranging from 10 µm to 600 µm and characterized by higher incidences of large pores equivalent diameter 200 µm it is also right skewed positive skewness meaning that the mean pore size calculated as 142 µm is much higher than the modal pore size 70 µm these observations suggest a more heterogeneous porous medium in prairie shell 2 1 2 geometric and petrophysical characterization all miniature 9 mm in diameter core samples used in this work were derived from parent core plugs that had been wet cored from an outcrop block the clashach sandstone tagged cs 04 1 was cored out of a 1 5 inch diameter core plug with an average porosity and gas permeability of 18 and 667 md respectively the carbonate miniature samples labeled as ps 24 1 and ps 27 2 originated from two separate 1 5 inch diameter core plugs ps 24 and ps 27 having average porosity values of 27 and 24 respectively in addition the gas permeability values averaged at 347 md and 354 md respectively average values were determined from three separate measurements to improve data accuracy table 1 summarizes these measurements as well as geometrical dimensions of the rock samples the petrophysical properties described so far were measured with an ap 608 automated permeameter porosimeter from coretest systems micro scale characterization of porosity and permeability has also been determined from micro ct images these in situ quantifications shown in table 1 agree well with prior ex situ measurements 2 2 fluid properties saline aquifers contain large amounts of saline brine with high sodium chloride concentrations kharaka and hanor 2003 trémosa et al 2014 the synthetic saline brine used in this study is a sodium iodide nai solution with a salinity of 250 000 ppm this salinity value agrees well with what is obtainable in natural reservoir systems kharaka and hanor 2003 trémosa et al 2014 sodium iodide was chosen because of its higher ionic density when dissolved in water compared to other halide salts this makes it a suitable dopant that enables better distinction of fluid phases in micro ct images the density and viscosity of the solution at ambient pressure and 50 c were 1 1681 g cm3 and 0 6161 mpa s respectively they were measured with an anton paar svm 3001 kinematic viscometer supercritical co2 scco2 was used as the co2 phase in all experiments this was derived by compressing liquid co2 99 5 to 100 purity initially at 850 psi to 1500 psi while keeping the system temperature at 50 c the density and viscosity of sco2 at these conditions were 0 439 g cm3 and 0 0319 mpa s respectively these properties were estimated from phase behavior models irc 2020 2 3 experimental procedure 2 3 1 miniature core flooding experiments the experimental procedure simulates actual fluid flow at conditions characteristic of subsurface reservoirs this was implemented using a proprietary core flooding setup illustrated in fig 3 it consists of four quizix 5000 dual syringe pumps a teledyne isco 500d syringe pump hastelloy flow lines pneumatic and manual valves rosemount differential pressure transducers and a miniature carbon fiber core holder two quizix pumps were used for continuous fluid injection into the core holder while the other two were for backpressure and confining pressure maintenance respectively the isco pump was used to initially pressurize the supplied liquid co2 to a supercritical state before injection the core flooding setup also incorporates the pore scale imaging capabilities of a heliscan micro ct scanner manufactured by thermo fisher scientific three core flooding experiments experiments 1 to 3 were performed using this apparatus table 2 summarizes the important aspects of each experiment before starting each experiment all flow lines and pumps were cleaned by sequential toluene methanol and distilled water flushes then dried with a 200 psi stream of nitrogen gas furthermore all core samples were covered with a heat shrink pvdf tube to limit the diffusion of co2 into the aflas core holder sleeve to commence each experiment a dry 9 mm diameter core sample was inserted into the core holder and mounted on the ct scanner stage after mounting the core holder the inlet outlet and confining pressure flow lines were connected snugly to the core holder and confining pressure of 200 psi was imposed on the core sample gaseous co2 was injected continuously for 40 min at 60 psi pressure to expel in situ air and water vapor within the pore space the entire system pumps flow lines and core sample was evacuated for 12 h to impose initial vacuum conditions and then a dry reference high resolution image was taken from the middle section of the core with the micro ct scanner this middle cylindrical section was the field of view fov for all images taken with the scanner table 3 summarizes the input parameters for all scans conducted during the three experiments these defined the fov as well as the image resolution or voxel size for each experiment after acquiring the dry reference image the core was vacuum saturated with the saline brine followed by brine injection at 0 2 cm3 min until the brine effluent was received at the outlet of the core the backpressure pump was then ramped up from atmospheric pressure to a gauge pressure of 1500 psi simultaneously the confining pressure was also ramped up to 1700 psi these pressure conditions as well as a 50 c temperature were maintained throughout the flow experiment the injection rate was then reduced to 0 0005 cm3 min to limit the backflow of fluids and maintain quasi static conditions and a high resolution image of the brine saturated core sample was taken after establishing 100 water saturation co2 was introduced at the top of the core sample at an injection rate of 0 1 cm3 min this flow rate and the resulting capillary number listed in table 2 was sufficient to simulate near wellbore flow conditions at which viscous advective forces dominate over capillary forces from the perspective of co2 brine drainage displacement characterization herring et al 2013 initial co2 injection ended when the remaining water saturation stayed unchanged after injecting 20 to 25 pore volumes at this moment a high resolution image of the fov was taken to serve as time zero of the drying process next in experiments 1 and 3 only scco2 was continuously injected at 0 1 cm3 min for 4 h and images of the fov were taken afterward subsequent scco2 injection and image acquisition sequences were done at 12 24 48 60 and 72 drying hours as the case may be in experiment 2 the injection rate was set at 0 5 cm3 min and only one 12 hour injection sequence was implemented high resolution images of the fov were taken at the end of each injection sequence it is important to highlight that due to operational limitations of the micro ct scanner images were not taken in real time nonetheless a quasi dynamic approach was implemented such that before each scan the scco2 flow rate was ramped down to a minimum flow rate 0 0005 cm3 min that ensured the maintenance of the backpressure without allowing for the backflow of effluent scco2 into the core holder the entire image acquisition process in each gas injection sequence took about 7 h on average after acquiring the required images in each stage the flow rate was ramped back up to 0 1 cm3 min to re initiate gas injection for the next time interval all micro tomographs were reconstructed to two dimensional slices of stacked images using a field back projection fbp algorithm that runs on the qmango software fei a thermo fisher scientific company the reconstructed digital images were visualized processed and analyzed on the pergeos 2020 software platform to commence image processing the raw slices were automatically registered against the dry reference image followed by a denoising process to reduce salt and pepper noise using a median filter gallagher and wise 1981 thereafter a non local means filter was applied to the denoised image for edge preservation and smoothening of the images buades et al 2005 the fluid and solid phases were segmented based on the application of thresholds to grayscale histograms otsu 1979 in some cases a machine learning based segmentation technique was applied see the supplementary materials all processed images were used to determine fluid saturation porosity and pore size distribution in addition pore fluid occupancy maps were also generated with the pergeos software 2 3 2 sem imaging two dimensional sem images of the fov were taken after the core flooding experiment this was achieved with a helios 650 nanolab fib sem manufactured by fei a thermo fisher scientific company first a cylindrical chip was cut out from the middle section of the miniature core sample one side of the chip was squared and pre tilted to expose a rectangular plane with definite edges afterward carbon coating was applied to the entire rock surface to increase conductivity and prevent excessive charging of the surface the sample was then mounted on the focused ion beam sem fib sem stage herein the rectangular plane underwent an ion milling process using a beam current of 795 pa to expose the imaging surface finally high resolution sem backscatter electron bse images were taken at different sections of the exposed surface with the beam voltage and current set at 1 kv and 0 1 na respectively 3 results and discussion 3 1 evolution of salt deposition we monitored the dynamic changes in the pore fluid occupancy as well as the behavior of the aqueous phase during the evaporative drying process based on our findings and distinct transport phenomena and phase behavior we divide the evolution of salt deposits into three main stages advection dominated flow transition and diffusion dominated flow all discussions in this section are based on experiment 1 results 3 1 1 stage 1 advection dominated flow the first stage is characterized by the typical advective flow convection within near wellbore regions which intensifies relative to the scco2 injection rate the primary drainage process of scco2 introduction into the fully brine saturated core leads to a piston like displacement of brine especially in medium to large sized pores consequently as shown in fig 4 brine is left in smaller pore elements crevices of pore walls and corners of angular pores this is typical of a hydrophilic rock system characterized by preferential wetting of the aqueous phase since the scco2 injection rate simulates near wellbore conditions viscous forces would dominate over capillary forces therefore the extent of brine displacement by scco2 during primary drainage is limited by the amount of pressure drop established during scco2 injection thus a remaining brine saturation is attained at the end of primary drainage specifically the average remaining brine saturation was 63 of the pore volume within the fov this serves as the zero hour saturation point just before the commencement of evaporative drying the drying process involved continuous scco2 injection through the core sample high resolution scans of the fov were taken at intervals 4 12 24 48 60 and 72 h during the course of drying the fluid occupancy maps in fig 5 a compare the gray scale images that reveal the fluid occupancy between the 0 and 24 hour marks these slices were selected at a position close to the top of the fov from time 0 after primary drainage to 4 h scco2 was only able to invade a few pores as shown by the pores within the red circles in fig 5 a this displacement process is still an advective one as the viscous forces overcome the threshold capillary pressure required to invade these pores it is important to highlight the unswept region bypassed by the scco2 stream at the top section of the two slices this region is mainly characterized by brine filled small to medium sized pores that have not been invaded by scco2 it also contributes significantly to the observed high brine saturation moving from 4 to 12 h of continuous scco2 injection we see additional brine displacement by scco2 in smaller pores within the red circles however the unswept region remains mostly unchanged across the fov the average brine saturation slightly reduced to 60 there were no visible phase transitions within this period implying very low brine evaporation levels within the fov advancing further from 12 to 24 h the unswept region was eventually invaded by scco2 indicating that the threshold capillary requirements for the invasion of pore elements had been met within this region this occurred because evaporation had commenced in upper sections of the core outside the fov and smaller pores in those sections had been accessed by scco2 this created a new pathway for scco2 to access and displace brine from pores in the unswept region of the fov overall advective forces still dominated over molecular diffusion within the fov 3 1 2 stage 2 transition stage as the cumulative drying time progressed from 24 to 48 h an interesting phenomenon was observed this is explicated in the static grayscale images in fig 5 b the most striking observation between the two image slices is that the aqueous phase has blended with the grain however by focusing on the selected area bounded by the red box it is clear that the aqueous phase intensity has drastically reduced becoming similar to that of the grain since the brine is a high salinity nai solution the lowering of phase intensity indicates either a reduction in the solute species concentration or total dissolved solids or brine carbonation by scco2 dissolution in the latter case dissolution is constrained by the salting out effect which limits the amount of scco2 that can dissolve in brine under equilibrium conditions using the psuco2 co2 brine phase equilibrium model developed by zhao and co workers zhao et al 2015 2015 the maximum amount of scco2 that can dissolve in 1 liter of brine under equilibrium conditions at 1500 psi and 50 c is approximately 22 5 g see supplementary materials for solubility plot this is about 9 of the mass of nai 250 g in brine however because co2 is in a supercritical state carbonation increases the density and correspondingly the intensity of the brine phase nonetheless by a meager amount therefore it is apparent that scco2 dissolution in brine is not a contributor to the decrease in brine phase intensity to explain this observation from the perspective of solute concentration reduction we initially presume that salt precipitation has already begun in the region above the fov this will be ascertained shortly the precipitation of salt above the fov induces a reverse flow of solutes within the hydraulically connected brine phase in the fov and below towards this new salt phase see fig 9 a this suggests a phenomenon we term reverse solute diffusion where solute species are transported from a region of lower concentration to that of a higher concentration due to an external driving force shokri et al 2010 the external force that influences this process is the interfacial tension ift between the supersaturated brine and the scco2 at the evaporation front ift is highest at this front due to a higher salt concentration in brine shahidzadeh bonn et al 2008 this force appears to have overcome the osmotic pressure that restricts solute transport within the brine phase leading to transport of solutes towards the concentrated evaporating front the concentration gradient created by the reverse solute flow is maintained by an interfacial tension gradient that persists ahead of the front scriven and sternling 1960 marin et al 2019 efstratiou et al 2020 the resulting enrichment of solutes in regions at the evaporating front results in solute depletion in regions away from the front to the best of our knowledge this is the first direct evidence of reverse solute diffusion during salt precipitation resulting from evaporative drying in naturally occurring rocks therefore it will be somewhat challenging to make direct comparisons to existing processes in the literature that are based on solute transport by capillary flow however similar to these processes reverse solute diffusion is aided by the capillary continuity of the aqueous wetting phase which allows for unperturbed solute transport to upper dried out or drying regions at the macro reservoir scale this process is termed salt self enhancement and occurs in conjunction with the capillary backflow of brine from regions away from the wellbore as suggested in the literature miri and hellevang 2016 it is worth mentioning that ott et al 2014 observed solute depletion and enrichment in a multi porosity system due to the presence of an overbearing microporosity in the estaillades carbonate rock used in their microscale experiment ott et al 2014 hence they observed capillary induced solute transport within the brine phase that resulted in a depletion of solutes in intragranular micropores and its enrichment in intergranular macropores ott et al 2014 conversely in this work solute depletion and enrichment was experienced simultaneously in both macropores and micropores see fig 5 6 and 9 making depletion by reverse solute diffusion different from the channeling effect induced by micropores as observed by ott et al 2014 looking at the area within the blue circle in fig 5 b it is evident that the advective flow was still ongoing within the previously unswept region this suggests that the system was gradually transiting from transport limited by advection to diffusion dominated flow 3 1 3 stage 3 diffusion dominated flow and evolution of salt deposition reverse solute diffusion continued as we moved from 48 to 60 cumulative hours of drying in addition the precipitation or drying front begins to move from regions above the fov to within the fov this is evidenced by the grayscale images from the top of the fov in fig 6 a and the vertical profile of the fov in fig 9 b the first observation between both images is that the aqueous phase intensity has dramatically increased to even higher than the original brine suggesting that salt precipitation had occurred this confirms the inference made earlier that precipitation was already happening at regions above the fov as the evaporation front moves downwards and water evaporates there is an increase in fickian diffusion of solute molecules to the brine scco2 interface this enhances the aqueous phase s supersaturation and culminates in salt precipitation when the solubility limit is eventually attained as shown in the highlighted section of the image within the red rectangle salt precipitation had occurred in three different fluid occupancy configurations the first scenario location a in the figure is precipitation in formerly brine filled pores that were not in direct contact with the scco2 phase in this case evaporation is mainly aided by the brine hydraulic connectivity such that the entire brine volume serves as a conduit for molecular water transfer to the scco2 phase which thereby helps the precipitation process see supplementary materials for brine connectivity determination the second scenario location b is precipitation in scco2 filled pores having water in the corners or pores partially filled with brine essentially brine in these pores is in direct contact with the flowing scco2 phase and precipitation results from the local diffusion of water molecules from the aqueous phase to the constantly replenished undersaturated scco2 rich phase the third scenario location c is precipitation within brine filled pores containing scco2 pockets at the center of the pore this situation arises because of incomplete displacement of brine during advection before diffusion dominated flow therefore the co2 rich phase appears trapped this however does not limit the precipitation process as water molecules still diffuse into the connected supercritical co2 phase by visualizing the middle section of the fov we get a clearer picture of the evolution of salt precipitates the images in fig 6 b reveal two different aqueous phase concentrations within the d and e bounding rectangles the first phase concentration brine i in pores within d is the same as the 48 hour brine phase concentration that had been subjected to reverse solute diffusion supplying solute species to the top of the fov as illustrated in fig 9 b the second within e with a slightly higher intensity than the grain is an aqueous phase concentration similar to that of the original brine the reemergence of the original brine is a benefit of reverse solute diffusion from the bottom of the fov this however is not the same brine as before but just a transition concentration between solute depleted brine and the solute rich brine as evaporation continues brine phase intensity increases due to the loss of water molecules to the scco2 rich phase leading to salt precipitation the pore within the region bounded by rectangle f is filled with the newly formed salt as described previously a typical image of the bottom section of the fov is shown in fig 6 c in this part of the rock the aqueous phase is mostly the same as that of the 48 hour phase this implies that reverse solute diffusion had not yet impacted the bottom of the fov as the solute species diffuse past this region to the evaporation front at upper sections it is however noticeable that some scco2 to brine displacements were still occurring therefore it is inferred that the bottom section was still at the transition stage we have applied a machine learning based segmentation tool called texture supervised classification on the pergeos software platform to segment the three fluid phases scco2 desalted brine and original brine and one solid salt precipitate phase see the supplementary materials for further information the subsequent phase saturation distribution after 60 h of evaporative drying throughout the fov is shown in fig 7 a as expected salt deposits mostly accumulated at the top together with the scco2 the higher intensity brine brine i saturation starts to increase as we move away from the top and reaches a maximum at the middle of the fov the lower intensity brine brine ii saturation is low at the top and middle and is highest at the bottom of the fov the average saturation at the 60 hour mark in fig 7 b reveals a high level of scco2 occupancy 82 3 and small amounts of salt deposits 1 5 after 72 h of drying salt precipitates had formed throughout the entire depth of the fov fig 8 confirms this as it compares the 60 hour image to the 72 hour image at the bottom of the fov as discussed previously salt had precipitated in brine filled pores the corners and crevices of scco2 filled pores and the periphery of pores that had been partially invaded by scco2 it is important to note that salt had also precipitated within the microporous grains this is further discussed in section 3 3 the final saturation distribution after evaporative drying within the fov is shown in fig 8 b it reveals that once precipitation commences advection becomes minimal with little or no scco2 to brine displacements this is evidenced by the overlapping scco2 saturation profile when moving from 60 to 72 h of evaporative drying another observation is that the salt deposition becomes more significant as brine i and eventually brine ii precipitate out their salts the final average salt saturation therefore increases from 1 5 to 17 3 this substantial amount of salt deposits in the near wellbore region can lead to pore plugging porosity and permeability reductions and well injectivity issues we determine and quantify the extent of pore space reduction in section 3 4 3 2 factors governing salt deposition mechanics based on the existing literature we have determined that salt precipitation mechanics are affected by two main factors the first is the degree of heterogeneity of the porous medium usually characterized by the pore size distribution and the scco2 injection rate in the near wellbore region to probe the former evaporative drying within a less heterogeneous clashach sandstone is compared with that in a more heterogeneous prairie shell carbonate to determine the impact of the scco2 injection rate we compare the salt deposition profile of the base case scco2 injection rate 0 1 cm3 min with that of a higher injection rate of 0 5 cm3 min for the same carbonate rock type 3 2 1 effect of rock heterogeneity on salt deposition mechanics evaporative drying experiments were carried out on both sandstone and carbonate rock types resulting in salt precipitation from the aqueous phase the time to final precipitation salt deposition sites and in situ distribution of precipitates were identified as the main parameters affected by the level of rock heterogeneity in the following subsections these effects are discussed in detail 3 2 1 1 time to final precipitation before the drying process both brine filled samples were pre flooded with 25 pore volumes of scco2 to a remaining brine saturation this served as the zero time for the drying sequence the average remaining brine saturation at the end of the pre flood in the sandstone sample was 27 6 while that of the carbonate sample was 63 1 this preliminary finding indicates that initial displacement of brine drainage by scco2 was more efficient in sandstone since threshold capillary pressure requirements in this homogeneous system were mostly uniform this implies that scco2 instantaneously invades multiple connected pores once the capillary pressure requirements are met leading to a more efficient displacement the clear distinction between the two samples is shown in the images in fig 10 another reason for this could be that the sandstone sample had better pore connectivity than the carbonate system this is evidenced by the lack of brine displacement in large pores typically characterized by low threshold capillary pressures in the carbonate medium the scco2 to brine displacements continued during evaporative drying as observed and discussed in the preceding section at the 12 hour mark the brine saturation in sandstone fell to 16 4 while a reduction to 60 was observed for the carbonate this emphasizes the previous assertion of slower displacements in a heterogeneous system compared to a homogeneous counterpart salt precipitation occurred within 12 to 24 h of evaporative drying in the sandstone sample this is shown in the saturation profile in fig 11 a therefore we confirm that it took only 24 h to evaporate the initial brine and induce salt deposition in the sandstone in the carbonate case however precipitation did not commence until after 48 h of drying at this time the brine saturation had decreased significantly to 33 6 this suggests that in both cases there is a critical brine saturation at which precipitation begins to occur this saturation heralds the cross over from advection dominated transport to diffusion limited flow for the same scco2 injection rate this critical brine saturation is lower for homogeneous systems compared to heterogeneous media salt precipitation finally ends after 72 h in the prairie shell medium see fig 11 b indicating a longer time between precipitation commencement and termination 24 h in this case versus 12 h in the clashach medium at the reservoir scale a delayed and slow rate of injectivity loss such as in the heterogeneous carbonate is more favorable however heterogeneous systems tend to have lower initial injectivity due to variation in pore sizes and typically lower permeability solomon and flach 2010 3 2 1 2 salt deposition sites as observed during the previous discussion on salt deposition evolution precipitates form at sites previously occupied by brine these sites differ based on pore morphology and connectivity fig 12 a is a typical depiction of precipitate occupancy in sandstone expectedly precipitates form mostly in the corners of scco2 filled pores these were former brine filled sites which had characteristically obeyed the wetting order in hydrophilic rock systems entirely salt filled pores were few and occurred in smaller elements that could not be invaded by the injected scco2 salt deposition in the more heterogeneous carbonate also happened in former brine filled sites however the deposition order was slightly different from that of the sandstone case first there were more pores entirely filled with salt see fig 12 b this did not directly correlate with pore size as in the sandstone case because whole deposits were found in both small and medium to large pores this could be due to poor pore connectivity in the carbonate system one similarity between both cases is that salt deposits occupied corners of scco2 filled pores deposits were also situated in crevices of the pore walls because of high surface roughness another typical observation in the carbonate system is scco2 pockets in the center of some salt filled pores highlighted within the blue circles in fig 12 b this occurrence originates from precipitation in brine pores that had been partially invaded by scco2 3 2 1 3 in situ precipitate distribution the degree of heterogeneity has been found to affect the amount of salt deposits relative to pore size pore sizes were classified based on equivalent diameter intervals under this classification pores with equivalent diameters less than 50 µm were grouped as small pores those with equivalent diameters greater than 200 µm are large pores while medium sized pores are between 50 and 200 µm in diameter fig 13 is a bar chart that describes salt deposit saturation relative to pore size overall salt deposits were mostly found in small pores however this varied with the degree of heterogeneity a higher saturation of salt deposits was found in small pores of the sandstone compared to the carbonate this emanates from a greater tendency of brine to remain in small pores in the more connected sandstone system after the initial scco2 drainage in the medium sized group salt deposits occurred more in the carbonate case this pore class contains the modal pore sizes for both rock cases 87 µm for sandstone and 70 µm for carbonate and largely determines the overall salt saturation within the fov the more homogeneous the system the closer this value is to that obtained for the medium sized pores for example the sandstone s overall salt saturation was determined to be 14 5 almost equal to the saturation in the medium sized pores however salt saturation in the carbonate was 17 3 about 5 lower than the saturation in its medium sized pores this also shows the overall saturation is determined more by larger pores higher than the modal pore size in the carbonate system due to positive pore size skewness the saturation of salt deposits in large pores was very low and similar in both cases this is expected in a hydrophilic system since scco2 would mostly occupy and saturate large pores from a practical perspective the salt deposition effect would be less detrimental to injectivity if it occurs in small pores 3 2 2 effect of scco2 injection rate on salt deposition in this section we present the results of experiments conducted to probe the impact of the scco2 injection rate on the evaporative drying process that ultimately leads to salt precipitation this is a comparison of results from evaporative drying tests carried out at two different scco2 flow rates 0 1 cm3 min experiment 1 and 0 5 cm3 min experiment 2 on two similar miniature prairie shell carbonate core samples using the core flooding setup from experimental results we have observed that the injection rate controls 1 the initial fluid scco2 and brine and final scco2 saturations 2 the time to final precipitation and 3 the amount of precipitated salt these findings are discussed below accordingly 3 2 2 1 initial and final fluid saturations under strictly advective flow higher flow rates intensify viscous forces that enhance immiscible displacements of brine by scco2 at the pore scale as shown in fig 14 a for the same pore volume of scco2 injected during primary drainage the overall effect of a higher injection rate is a lower remaining brine saturation however this does not essentially mean a uniform vertical displacement of brine by scco2 this concept becomes evident when we compare the saturation profiles for both cases in fig 14 a for the base case of 0 1 cm3 min injection rate experiment 1 a more uniform saturation profile is observed relative to the higher rate case experiment 2 this could mean that a higher rate although connoting higher scco2 phase pressure also increases the propensity for scco2 to bypass some brine filled pores in lower permeability less accessible regions at the top of the fov we confirm this by taking slices from the top a and the bottom sections b of the fov these fluid occupancy maps are shown in fig 14 b at location a we see that scco2 occupies mostly large pores in both cases however a number of brine filled pores are also prevalent across all pore sizes therefore displacement efficiency is almost the same in both cases at the lower location location b we see that the high rate case has a more significant scco2 invasion into pores of different sizes whereas the other case resembles the map at the top section we infer that a lower hydraulic conductivity at the top section in the higher rate case contributes to this initial scco2 bypass 3 2 2 2 time to final precipitation the end of primary drainage represents the zero time for the evaporative drying stage however we have already established that scco2 to brine displacements still occur during evaporative drying as scco2 injection proceeds as discussed earlier a critical scco2 saturation is attained before precipitation begins thereafter only a marginal increase in scco2 saturation occurs owing to the higher dominance of diffusion the evolution of salt deposits for experiment 1 has been discussed in section 3 1 precipitation starts after 48 h of injection and ends within 24 h in experiment 2 injecting at a higher flow rate shortens both times to final precipitation and the precipitation duration specifically precipitation occurs within the first 12 h of evaporative drying we presume that the average scco2 saturation after primary drainage was closer to the critical scco2 saturation the average scco2 saturations at the end of evaporation in experiments 1 and 2 were 82 7 and 90 5 respectively meaning that there was slightly less remaining brine in the system available for precipitation in experiment 2 compared to experiment 1 a combination of higher scco2 injection rate i e a higher rate of evaporation and lower brine saturation available after achieving critical scco2 saturation has resulted in the shortening of the precipitation time for experiment 2 3 2 2 3 final salt saturation and cluster size distribution as stated previously precipitation does not occur until a certain critical scco2 saturation where the flow is governed by diffusion the saturation profile of precipitates for both injection rate cases is shown in fig 15 a the plot reveals an overall higher salt deposition for experiment 1 this is a direct consequence of a higher average brine saturation established after the initial scco2 drainage before evaporative drying in experiment 1 compared to experiment 2 see fig 15 b the scco2 bypass effect at the top of the fov for experiment 2 explained in section 3 2 2 1 has resulted in more salt deposition in that region the final average salt saturations for the 0 1 cm3 min and 0 5 cm3 min tests were 9 5 and 17 3 respectively therefore by comparing the two carbonate cases a five fold increase in the injection rate has resulted in a 45 reduction in the amount of salt deposits going further we have used the pergeos software package to assess the size of individual salt clusters within the pore space of the carbonate medium at both injection rates this is to determine whether the scco2 injection rate plays any role in determining the morphological properties of the salt deposits results from this analysis are shown in fig 15 b the first observation from the graph is that the cumulative frequency plots in both experimental cases mostly overlap in determining the level of similarity between the two distributions in fig 15 b a two sample kolmogorov smirnov k s test was implemented with matlab smirnov 1939 grzegorzewski 2018 the two sample k s test is a non parametric equality test that evaluates the difference between two cumulative distributions grzegorzewski 2018 using the data represented in fig 15 b the resulting k s test statistic d the maximum scalar difference between the two distributions was 0 0884 and the p value was 0 000 therefore by applying a significance level of 1 i e rejecting the null hypothesis of equality when p 0 01 the two distributions are statistically unequal however the k s test statistic d is small i e much closer to 0 than 1 hence it is apparent that although the two cluster distributions are statistically unequal i e they do not come from the same distribution they are relatively similar this analysis suggests that salt cluster size is invariant of the injection rate consistent with recent observations in the literature he et al 2019 moreover for both cases about 85 of the volume of these clusters represented by the shaded area fall within the 5 10 6 mm3 to 10 3 mm3 size group meaning that they were mostly formed in connected medium sized pores this observation is also exemplified in the three dimensional volume renderings of salt clusters in both carbonate cores shown in fig 16 a although it is first obvious that more salt deposits were formed in experiment 1 where q 0 1 cm3 min compared to experiment 2 where q 0 5 cm3 min the morphology of the salt clusters appear to be very similar see fig 16 b in general by applying the cluster size classification in fig 15 b there were several medium sized clusters few large clusters and many small clusters in addition the mean cluster size calculated as 8 911 10 6 mm3 in experiment 1 and 1 020 10 5 mm3 in experiment 2 falls within the medium sized cluster category this affirms the previous assertion made in section 3 2 1 3 that medium sized pores are the limiting pore size group for salt deposition 3 3 salt precipitation in micropores 3 3 1 observation in sandstone and carbonate rocks although most clastic and carbonate rocks comprise a dominant mineral quartz as in sandstone and calcite dolomite as in limestone dolostone they also contain other minerals like feldspar mica carbonates mostly calcite in sandstone and clay minerals haldar and tišljar 2014 in sandstone clay minerals like smectite montmorillonite illite and kaolinite form the majority of the non cemented matrix interbedded with quartz grains haldar and tišljar 2014 these clay minerals are hydrophilic in nature and strongly adsorb brine due to inherent electrostatic attractive forces bleam 2017 they are also fine particles exhibiting both intercrystalline and interlayer porosity of sub micron sizes cao et al 2016 these micropores are challenging to resolve with micro ct scanners and therefore appear as darker grains as shown by the red rings on the dry image in fig 17 a for the clashach sandstone carbonates may also exhibit microporosity based on folk s classification carbonate rocks comprise constituent allochems oolites peloids fossils bioclasts intraclasts pisolites and oncoids that could be entirely or partially cemented compacted or interbedded with finely grained micrite calcite clay haldar and tišljar 2014 from our observations of qemscan and micro ct images we infer that prairie shell grains consist of skeleton and shell fragments moved by ocean tide and deposited in marine environments hence it is a bioclast in addition the microporosity in prairie shell could be intragranular within calcite grains intrafossil within fossil shells or intercrystalline across non micritic clay particles bultreys et al 2016 essentially because of their nano scale pore size microporous media in saline aquifers would consist of irreducible brine it is energy intensive for scco2 to displace brine in micropores by advection therefore as evaporative drying occurs in the macroporous media and precipitates form microporous media also undergo the same process as highlighted by the white circles for sandstone and yellow and green circles for carbonate in fig 17 a salt eventually precipitates in the micropores it is worth noting that there was no observable distinction in the evolution of salt deposition in both porous systems therefore as salt formed in macropores it also precipitated in micropores we have attempted to quantify the contributions of these micropores in both sandstone and carbonate media to the overall salt saturation we did this by segmenting out the entire salt phase in both macro and micro pores and then deducting it from the salt in the segmented macropores this difference gives an aggregate salt saturation that is then corrected for porosity we have assumed an average porosity of 33 for the micropores based on recommendations by alansari and coworkers alansari et al 2019 from the results presented for both rock types shown in fig 17 b the contribution of microporous deposits to the overall salt saturation has been determined to be significant especially in sandstone for the clashach sandstone accounting for precipitation in micropores increased the average salt saturation by an additional 4 5 i e from 14 5 to 19 by contrast only marginal increments were obtained for the two prairie shell cases 1 5 for the 0 1 cm3 min injection rate and 1 1 for the 0 5 cm3 min injection rate this difference is mainly because the sandstone rock intrinsically has more microporous sites than the carbonate therefore neglecting microporosity in reservoir scale models for precipitation simulation and prediction in sandstone saline aquifers could result in significant under prediction of salt deposition 3 3 2 sub micron characterization of salt deposits fibsem imaging of the dried out carbonate rock has elucidated the salt deposition pattern in micropores see the supplementary materials the first pattern is characterized by salt deposition in intergranular micropores as shown in fig 18 a salt crystals accumulate on surfaces of small intergranular pores that are less than 1 µm in size individual clusters are no more than 2 µm in length and are randomly distributed within the microporous elements these deposits have formed from brine that could not be displaced by scco2 advection due to high capillary pressure requirements at high magnification the deposits appear as individual particles orderly arranged on the pore walls the second pattern discovered from sem images is typified by deposition in intragranular micropores and is shown in fig 18 b these micropores are nanometer sized interconnected fissures that were initially filled with connate brine after scco2 induced evaporative drying salt deposits in these conductive fissures formed a precipitate network within the carbonate grains this pattern is similar to those derived for precipitation in ultra tight clay rich tight dolomitic siltstone rocks that showed deposition of monovalent salt crystals within fissure like pores alizadeh et al 2018 3 4 porosity reduction salt deposition in near wellbore regions of saline reservoirs has been posited as the leading cause of pressure buildup which is detrimental to scco2 injectivity grude et al 2014 solomon and flach 2010 as revealed in preceding discussions salt could occupy entire pores and throats or partially fill these pore elements thereby reducing the net pore space through which scco2 can flow fig 19 shows the reduction in porosity in the fov for the three experimental cases by comparing the carbonates to sandstone it is instantly clear that the porosity profile is more uniform for clashach sandstone compared to that in prairie shell limestone however porosity reduction appears to be uniform across core samples and between different flow rates we believe that this results from the hydrophilic nature of the system which enhances brine connectivity thereby creating deposits with a uniform thickness along the pore wall moreover for the same flow rate 0 1 cm3 min the profiles reveal that the pore space is marginally more plugged in the carbonate case than in the sandstone because there are more instances of salt filling up whole pores comparing across the flow rates for the same carbonate rock we observe less porosity reduction in the higher flow rate case directly correlating with lower salt deposits instances 4 conclusions in this study we explored the phenomenon of salt precipitation as a result of supercritical carbon dioxide injection in brine saturated natural porous media at elevated pressure and temperature conditions it was designed to determine the pore scale mechanisms that lead to macro scale observations during evaporative drying with scco2 the results agree well with the existing literature and clarify the role of heterogeneity and injection rate in salt deposition evolution as a result the following conclusions have been deduced salt precipitation during scco2 injection and storage in saline aquifers occurs as a result of evaporative drying within near wellbore regions this leads to permeability impairment accompanied by porosity reduction that could cause pressure buildup within this region with detrimental effects on well injectivity we presented in situ evidence of salt precipitation in the pore space of natural sandstone and carbonate samples the evolution of salt deposition in brine saturated systems at subsurface reservoir conditions follows a three stage sequence the first is characterized by advection dominated flow where scco2 displaces brine based on capillary pressure requirements and pore connectivity the second is a transition stage where the contribution of diffusive forces becomes as significant as advection herein reverse solute diffusion enables replenishment and accumulation of solute species at the evaporation front the third stage is exemplified by diffusion limited flow where solute accumulation at the scco2 brine interface together with water molecule diffusion to the flowing scco2 phase accelerates brine supersaturation which eventually causes precipitation overall the precipitate saturation is higher in smaller pores compared to larger pores this arises from inefficient advective brine displacement by scco2 in these pores however the final salt saturation is limited by the amount of salt deposit in medium sized pores precipitation in the heterogeneous carbonate is less uniform and less rapid relative to the moderately homogeneous sandstone for the same scco2 injection rate it is influenced by pore size and connectivity although this is beneficial at the reservoir scale heterogeneous systems are relatively less permeable hence the overall effect on the efficiency of scco2 storage is not clear a higher injection rate reduces the amount of salt deposits formed in near wellbore regions in this study a five fold increase in injection rate caused an 82 reduction in salt deposition however it occurred six times faster this tradeoff of rapidity and amount of salt deposition would need to be considered during field scale initiatives microporous media in sandstone reservoirs contribute significantly to the observed salt precipitation these deposits occupy both intergranular and intragranular micropores initially saturated with irreducible brine they form distinct deposition patterns within and on the walls of the micropores salt deposition in micropores could increase the overall salt saturation by about 4 therefore ignoring the effect of micropores in reservoir simulation predictions would erroneously underestimate the extent of salt deposition porosity reductions directly correlate with the amount of salt deposited and become more significant as the scco2injection rate decreases this ultimately results in a substantial loss of scco2 conductivity credit author statement dayo akindipe conceptualization methodology investigation visualization formal analysis writing original draft soheil saraji conceptualization methodology supervision writing review editing mohammad piri conceptualization supervision writing review editing resources funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thankfully acknowledge the financial support of thermo fisher scientific hess corporation and the school of energy resources university of wyoming in addition we extend our appreciation to our colleagues at the center of innovation for flow through porous media university of wyoming dr amir alizadeh for his insightful comments and dr zhenyuan zhang and omar elmasry for their help with sem imaging and qemscan analysis supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2021 104011 appendix supplementary materials image application 1 
260,salt deposition has been encountered in near wellbore regions of saline reservoirs during field scale carbon dioxide co2 sequestration to explain this phenomenon pore scale studies mostly in the form of micromodel visualizations have been previously implemented however there is limited knowledge about salt deposition and inherent dynamics in reservoir rocks this study investigates and characterizes the pore scale evolution of salt precipitation in natural sandstone and carbonate rocks at conditions prevalent in deep saline aquifers using x ray micro tomography imaging techniques three evolution stages advection dominated transition and diffusion dominated evaporative drying are delineated we provide direct evidence for a new mechanism that occurs during the transition from advection to diffusion limited flow called reverse solute diffusion this is typified by upward solute diffusion from regions of lower concentrations within the aqueous phase to the highly concentrated evaporating front salt deposits eventually form due to solute accumulation at the brine supercritical co2 interface the time and extent of precipitation are influenced by co2 injection rate and morphological heterogeneity specifically a higher injection rate increases the rapidity of precipitation but causes lower salt deposition furthermore less precipitates form as systems become more homogeneous for the same injection rate these relationships directly correlate with porosity reduction leading to a gradual but higher degree of pore plugging in heterogeneous systems keywords carbon dioxide co2 sequestration salt precipitation saline aquifers evaporative drying micro computed tomography imaging pore scale 1 introduction carbon neutrality in the energy sector has been at the forefront of global policy advocacy in recent years this has become even more important because greenhouse gas emissions have continued on an upward trend increasing the vulnerability of a variety of ecosystems and communities to the debilitating effects of climate change hewitson et al 2014 colburn et al 2016 li et al 2018 it prescribes that energy comes from renewable sources such as wind and solar systems but when it is derived from fossil based sources the resulting carbon dioxide co2 emissions have to be counteracted by an equal measure of carbon capture and storage european parliament 2019 carbon geological sequestration is the main option for large scale co2 storage under this scheme captured co2 is injected into subsurface formations such as deep saline aquifers depleted hydrocarbon reservoirs and uneconomical coal bed seams at supercritical conditions above 1070 psi and 31 c bickle 2009 friedmann 2007 field scale co2 utilization in the petroleum industry for enhanced oil recovery has been implemented since the 1970s merchant 2017 carbon dioxide has been injected as a separate gas phase such as in water alternating gas injection schemes worden and smith 2004 or pre dissolved in brine before injection as in the case of carbonated water flooding torrey 1951 hickok et al 1960 alizadeh et al 2014 this serves a dual purpose of storage and hydrocarbon production co2 storage in saline aquifers is a more recent endeavor it has arisen because of the need for more storage capacity that does not directly result in hydrocarbon production there are at least five fully commercialized and operational large scale co2 geo sequestration projects in deep saline aquifers among other pilots and projects still under development global ccs institute 2020 the first is the sleipner field project offshore norway which started operation in 1996 equinor 2019 2021 other notable projects are the quest project canada the illinois basin decatur project usa the snøhvit field project norway and the gorgon co2 injection project australia global ccs institute 2019 global ccs institute 2020 implementing carbon storage has come with attendant challenges at the field scale potential issues emanating from storage integrity such as leakage risks seismic tremors from over pressurization and uncertainties in reservoir characterization have come up damen et al 2006 koornneef et al 2012 de coninck and benson 2014 another problem that has been encountered in pilots is the precipitation of dissolved salts mostly halite from brine in near wellbore regions of reservoirs during co2 injection specifically in saline aquifers salt precipitation has been suspected of causing low permeability zones in near wellbore areas baumann et al 2014 grude et al 2014 a case in point is the ketzin field germany where it was discovered through a combination of radiometric pulsed neutron gamma png logging and extended saturation modeling that water evaporation ultimately resulting in halite precipitation caused an unusually high co2 saturation in a near wellbore formation baumann et al 2014 another suspected case of salt precipitation was in the snøhvit field here significant pressure buildup was encountered during co2 injection into a near wellbore formation grude et al 2014 this was caused by an unusually low permeability zone around this region which in turn was suspected to be a consequence of salt precipitation leading to injectivity loss a mixture of methyl ethyl glycol and water had to be injected to stimulate the well grude et al 2014 injectivity loss occurs when the permeability in the near wellbore region decreases due to the plugging of pores in this vicinity limiting the injected fluid migration to further regions in the reservoir benson et al 2005 solomon and flach 2010 this severely affects injection efficiency as it would require more energy to introduce fluids such as co2 into the main reservoir for the same injection rate if unabated declining injectivity would lead to pressure buildup in and around the well causing catastrophic effects additional expenses would also be incurred in well workover operations mainly stimulation to counteract this effect and in some cases drilling a new well might be required solomon and flach 2010 salt deposition in porous media is a natural phenomenon that occurs at both ambient and higher temperature and pressure conditions all water bearing porous media exposed to a flowing undersaturated gas that can evaporate water would eventually dry out due to water moving from the aqueous phase to the gaseous phase a consequence of this is solute deposition the extent of which depends on the solute concentration in the aqueous phase the theory of salt precipitation is directly related to evaporation evaporative drying within porous media is a physical process that happens either naturally as in evapotranspiration in plants and soils or anthropogenically on buildings masonry and during geological carbon sequestration or et al 2013 rufai and crawshaw 2018 early studies on evaporative drying due to porous media exposure to air have delineated three drying regimes the advection dominated constant rate period crp the falling rate period frp and the diffusion dominated receding front period rfp chauvet et al 2009 lehmann et al 2008 during the crp the gas phase accesses and invades the pore space on the attainment of the capillary entry threshold pressure required for the invasion of connected pore elements as the undersaturated gas invades the pores and displaces water it also contacts other bypassed pores that are water filled but hydraulically connected to the displaced pores having water in the crevices and corners chauvet et al 2009 depending on factors such as salinity grain size pore size and wettability the crp could last from a few minutes to several hours and is characterized by a high and constant evaporation rate lehmann et al 2008 chauvet et al 2009 rufai and crawshaw 2018 afterward the drying process is characterized by a transition period where the evaporation rate begins to decrease drastically because of lower water saturation in pore bodies lehmann et al 2008 or et al 2013 this frp culminates in reducing advective flow contribution to the drying process and an increase in diffusive flow chauvet et al 2009 lehmann et al 2008 thereafter diffusion dominated rfp is attained where water is transferred through the interfaces to the gas phase due to the concentration difference between water bearing pores and the undersaturated gas chauvet et al 2009 in brine saturated systems salt precipitation within the dried pores shortens the crp because the initially high evaporation rate induces early precipitation at the entry surface causing an increase in solute demand from the hydraulically connected brine in the main porous medium shokri et al 2010 rufai and crawshaw 2018 this results in an increase in diffusion controlled drying and salt deposition starting from the entry surface i e the inlet surface during experimental gas injection to the evaporation front within the porous medium shokri et al 2010 rufai and crawshaw 2018 solute transport within the connected brine is supported by a capillary pressure gradient and not the advective pressure drop that allows for brine countercurrent flow backflow or reflow towards the entry surface shokri et al 2010 ott et al 2015 miri and hellevang 2016 eventually as solutes accumulate and precipitate out of the brine phase the hydraulic conductivity of the pores significantly reduces and some pore elements could become plugged salt deposition could occur at the entry surface in the corners of dried out pores and in the center of pore elements depending on factors such as pore size grain size wettability and salt type shahidzadeh bonn et al 2008 previous experimental studies have investigated the order type and distribution of salt deposits shahidzadeh bonn et al 2008 ott et al 2015 specifically ott and coworkers suggested that the evaporative drying order starts with a short time attainment of a residual brine saturation followed by a longer dry out period resulting in salt precipitation ott et al 2015 they also discovered that the precipitation distribution is non homogeneous and restricted to pores and throats previously occupied by brine others have looked into the effects of grain size grain angularity and pore size on salt precipitation ott et al 2013 veran tissoires and prat 2014 hidri et al 2013 rad et al 2015 rad and shokri 2014 particularly studies by rad and coworkers have revealed that as pore size increases and as grain angularity decreases salt precipitation in macropores increases in addition to this salt deposition becomes more homogeneous and surface deposits become thicker rad et al 2015 rad and shokri 2014 according to a literature review by miri hellevang 2016 the effect of gas flow rate on evaporation and salt precipitation is inconclusive they argue that on the one hand a higher injection rate will result in a suppression of the capillary reflow or backflow of water to the evaporating surface thereby reducing the extent of salt deposition at evaporating sites however on the other hand higher rates connote higher injection pressures which in turn increase the evaporation rate relative to capillary reflow causing a more expansive accumulation of salt deposits miri and hellevang 2016 he and coworkers endeavored to address this in the context of co2 injection in hydrophilic micromodels they observed that at a flow rate of 0 1 ml min salt clusters accumulated at the mainstream region of the micromodel causing less salt deposition in peripheral regions at higher rates 0 5 ml min and 2 ml min the amount of precipitated salt decreased however salt deposits were more evenly distributed across all regions of the micromodel they attributed this observation at higher rates to an increase in the velocity gradient that prevented the backflow of brine towards the mainstream region he et al 2019 most pore scale experiments on evaporative drying have been implemented with single or bundles of capillary tubes polished micromodels uniformly round glass beads and sandpacks veran tissoires and prat 2014 hidri et al 2013 rad et al 2015 rad and shokri 2014 miri et al 2015 kim et al 2013 however only ott and coworkers and most recently falcon suarez et al 2020 and lopez et al 2020 have used naturally occurring rock sandstone and carbonate samples in their pore scale experimental investigations of in situ salt precipitation ott et al 2013 2014 2015 falcon suarez et al 2020 lopez et al 2020 in addition although numerous investigations have been conducted in the form of surface gas flow at ambient conditions applicable to soil salinization and building masonry structures or et al 2013 shokri et al 2010 rad and shokri 2014 rad et al 2015 hidri et al 2013 veran tissoires and prat 2014 shahidzadeh bonn et al 2008 there is a shortage of pore scale experimental studies at higher pressure and temperature conditions applicable to supercritical co2 storage in deep saline aquifers ott et al 2013 2014 2015 he et al 2019 therefore in this work we investigate the pore scale evaporative drying process that leads to salt precipitation in brine saturated porous rocks by performing miniature core flooding experiments with simultaneous high resolution x ray imaging at high pressure and temperature conditions we first carry out an in depth investigation on the evolution of the evaporative drying process highlighting the different forces that control component transport within and across phases we then analyze the extent and distribution of salt deposits within pore elements afterward we determine the effect of physical heterogeneity of the porous medium on precipitate occupancy within pore elements we further ascertain the impact of the supercritical co2 injection rate on the rapidity and amount of salt deposition finally we quantify the contribution of salt precipitation to porosity reduction in the subsequent sections of this article we first highlight and describe the materials apparatus and procedures employed in the course of our experimental investigation we then present experimental results and discuss salient observations which are eventually distilled into concluding remarks 2 materials and methods the overall methodology of this study covers pore scale micron and sub micron investigation and characterization of salt precipitation in natural porous media containing two fluid phases brine and co2 at subsurface reservoir conditions the micro scale investigation is conducted by incorporating micro computed tomography micro ct imaging with core flooding and the sub micron characterization is performed by using scanning electron microscopy sem techniques to simulate near wellbore flow and transport during gas injection in saline aquifers at elevated pressure and temperature conditions the experiments were performed at 1500 psi pore pressure and 50 c temperature selected based on a study by saraji et al 2014 in which saline aquifer candidates for co2 injection were characterized using pressure and temperature gradients see the supplementary materials 2 1 rock properties 2 1 1 rock samples two outcrop rock samples were used in this study the first is a clashach sandstone rock sample with mineral grains comprising 89 quartz 10 feldspar mostly k feldspar and 1 mica mostly illite see fig 1 a although clashach is well known as one of the less clay bearing sandstones trace amounts of intergranular microporous clay minerals illite and kaolinite still form a distinct matrix within the rock iglauer et al 2012 duthie 2012 the second rock sample used is prairie shell limestone this carbonate rock is about 96 calcite with marginal quantities of quartz 2 apatite 0 9 dolomite 0 4 and trace amounts of anhydrite biotite and illite see fig 1 b prairie shell has a fossil based solid phase system hence it is a bioclast having intergranular moldic and slightly vuggy macroporosity with various instances of microporosity microporosity could be intragranular intrafossil within fossil shells or intercrystalline across clay particles sandstone reservoir rocks are generally known to be quite homogenous in terms of pore size distribution this is because they are usually well sorted with uniform grain size overall the diagenetic processes of mechanical compaction due to overburden stress and cementation contribute to the eventual pore morphology haldar and tišljar 2014 the degree of heterogeneity of carbonate rocks depends on the morphology which in turn is a function of the origin of the rock fossils are the more heterogeneous of the non cemented carbonates because they emerge from the accumulation and compaction of shells endo and exoskeletons of land and marine animals haldar and tišljar 2014 pore size distributions of both sandstone and carbonate core samples used in this study have been determined from a pore space analysis conducted on micro ct images fig 2 compares the pore size distribution of prairie shell to that of clashach the pore size distribution of clashach is narrow and uniform with a range between 8 µm and 250 µm in addition it has a modal pore size of 87 µm it should be noted that we have defined pore size as the equivalent pore diameter an approximation of a circular pore geometry the prairie shell pore size distribution is wider ranging from 10 µm to 600 µm and characterized by higher incidences of large pores equivalent diameter 200 µm it is also right skewed positive skewness meaning that the mean pore size calculated as 142 µm is much higher than the modal pore size 70 µm these observations suggest a more heterogeneous porous medium in prairie shell 2 1 2 geometric and petrophysical characterization all miniature 9 mm in diameter core samples used in this work were derived from parent core plugs that had been wet cored from an outcrop block the clashach sandstone tagged cs 04 1 was cored out of a 1 5 inch diameter core plug with an average porosity and gas permeability of 18 and 667 md respectively the carbonate miniature samples labeled as ps 24 1 and ps 27 2 originated from two separate 1 5 inch diameter core plugs ps 24 and ps 27 having average porosity values of 27 and 24 respectively in addition the gas permeability values averaged at 347 md and 354 md respectively average values were determined from three separate measurements to improve data accuracy table 1 summarizes these measurements as well as geometrical dimensions of the rock samples the petrophysical properties described so far were measured with an ap 608 automated permeameter porosimeter from coretest systems micro scale characterization of porosity and permeability has also been determined from micro ct images these in situ quantifications shown in table 1 agree well with prior ex situ measurements 2 2 fluid properties saline aquifers contain large amounts of saline brine with high sodium chloride concentrations kharaka and hanor 2003 trémosa et al 2014 the synthetic saline brine used in this study is a sodium iodide nai solution with a salinity of 250 000 ppm this salinity value agrees well with what is obtainable in natural reservoir systems kharaka and hanor 2003 trémosa et al 2014 sodium iodide was chosen because of its higher ionic density when dissolved in water compared to other halide salts this makes it a suitable dopant that enables better distinction of fluid phases in micro ct images the density and viscosity of the solution at ambient pressure and 50 c were 1 1681 g cm3 and 0 6161 mpa s respectively they were measured with an anton paar svm 3001 kinematic viscometer supercritical co2 scco2 was used as the co2 phase in all experiments this was derived by compressing liquid co2 99 5 to 100 purity initially at 850 psi to 1500 psi while keeping the system temperature at 50 c the density and viscosity of sco2 at these conditions were 0 439 g cm3 and 0 0319 mpa s respectively these properties were estimated from phase behavior models irc 2020 2 3 experimental procedure 2 3 1 miniature core flooding experiments the experimental procedure simulates actual fluid flow at conditions characteristic of subsurface reservoirs this was implemented using a proprietary core flooding setup illustrated in fig 3 it consists of four quizix 5000 dual syringe pumps a teledyne isco 500d syringe pump hastelloy flow lines pneumatic and manual valves rosemount differential pressure transducers and a miniature carbon fiber core holder two quizix pumps were used for continuous fluid injection into the core holder while the other two were for backpressure and confining pressure maintenance respectively the isco pump was used to initially pressurize the supplied liquid co2 to a supercritical state before injection the core flooding setup also incorporates the pore scale imaging capabilities of a heliscan micro ct scanner manufactured by thermo fisher scientific three core flooding experiments experiments 1 to 3 were performed using this apparatus table 2 summarizes the important aspects of each experiment before starting each experiment all flow lines and pumps were cleaned by sequential toluene methanol and distilled water flushes then dried with a 200 psi stream of nitrogen gas furthermore all core samples were covered with a heat shrink pvdf tube to limit the diffusion of co2 into the aflas core holder sleeve to commence each experiment a dry 9 mm diameter core sample was inserted into the core holder and mounted on the ct scanner stage after mounting the core holder the inlet outlet and confining pressure flow lines were connected snugly to the core holder and confining pressure of 200 psi was imposed on the core sample gaseous co2 was injected continuously for 40 min at 60 psi pressure to expel in situ air and water vapor within the pore space the entire system pumps flow lines and core sample was evacuated for 12 h to impose initial vacuum conditions and then a dry reference high resolution image was taken from the middle section of the core with the micro ct scanner this middle cylindrical section was the field of view fov for all images taken with the scanner table 3 summarizes the input parameters for all scans conducted during the three experiments these defined the fov as well as the image resolution or voxel size for each experiment after acquiring the dry reference image the core was vacuum saturated with the saline brine followed by brine injection at 0 2 cm3 min until the brine effluent was received at the outlet of the core the backpressure pump was then ramped up from atmospheric pressure to a gauge pressure of 1500 psi simultaneously the confining pressure was also ramped up to 1700 psi these pressure conditions as well as a 50 c temperature were maintained throughout the flow experiment the injection rate was then reduced to 0 0005 cm3 min to limit the backflow of fluids and maintain quasi static conditions and a high resolution image of the brine saturated core sample was taken after establishing 100 water saturation co2 was introduced at the top of the core sample at an injection rate of 0 1 cm3 min this flow rate and the resulting capillary number listed in table 2 was sufficient to simulate near wellbore flow conditions at which viscous advective forces dominate over capillary forces from the perspective of co2 brine drainage displacement characterization herring et al 2013 initial co2 injection ended when the remaining water saturation stayed unchanged after injecting 20 to 25 pore volumes at this moment a high resolution image of the fov was taken to serve as time zero of the drying process next in experiments 1 and 3 only scco2 was continuously injected at 0 1 cm3 min for 4 h and images of the fov were taken afterward subsequent scco2 injection and image acquisition sequences were done at 12 24 48 60 and 72 drying hours as the case may be in experiment 2 the injection rate was set at 0 5 cm3 min and only one 12 hour injection sequence was implemented high resolution images of the fov were taken at the end of each injection sequence it is important to highlight that due to operational limitations of the micro ct scanner images were not taken in real time nonetheless a quasi dynamic approach was implemented such that before each scan the scco2 flow rate was ramped down to a minimum flow rate 0 0005 cm3 min that ensured the maintenance of the backpressure without allowing for the backflow of effluent scco2 into the core holder the entire image acquisition process in each gas injection sequence took about 7 h on average after acquiring the required images in each stage the flow rate was ramped back up to 0 1 cm3 min to re initiate gas injection for the next time interval all micro tomographs were reconstructed to two dimensional slices of stacked images using a field back projection fbp algorithm that runs on the qmango software fei a thermo fisher scientific company the reconstructed digital images were visualized processed and analyzed on the pergeos 2020 software platform to commence image processing the raw slices were automatically registered against the dry reference image followed by a denoising process to reduce salt and pepper noise using a median filter gallagher and wise 1981 thereafter a non local means filter was applied to the denoised image for edge preservation and smoothening of the images buades et al 2005 the fluid and solid phases were segmented based on the application of thresholds to grayscale histograms otsu 1979 in some cases a machine learning based segmentation technique was applied see the supplementary materials all processed images were used to determine fluid saturation porosity and pore size distribution in addition pore fluid occupancy maps were also generated with the pergeos software 2 3 2 sem imaging two dimensional sem images of the fov were taken after the core flooding experiment this was achieved with a helios 650 nanolab fib sem manufactured by fei a thermo fisher scientific company first a cylindrical chip was cut out from the middle section of the miniature core sample one side of the chip was squared and pre tilted to expose a rectangular plane with definite edges afterward carbon coating was applied to the entire rock surface to increase conductivity and prevent excessive charging of the surface the sample was then mounted on the focused ion beam sem fib sem stage herein the rectangular plane underwent an ion milling process using a beam current of 795 pa to expose the imaging surface finally high resolution sem backscatter electron bse images were taken at different sections of the exposed surface with the beam voltage and current set at 1 kv and 0 1 na respectively 3 results and discussion 3 1 evolution of salt deposition we monitored the dynamic changes in the pore fluid occupancy as well as the behavior of the aqueous phase during the evaporative drying process based on our findings and distinct transport phenomena and phase behavior we divide the evolution of salt deposits into three main stages advection dominated flow transition and diffusion dominated flow all discussions in this section are based on experiment 1 results 3 1 1 stage 1 advection dominated flow the first stage is characterized by the typical advective flow convection within near wellbore regions which intensifies relative to the scco2 injection rate the primary drainage process of scco2 introduction into the fully brine saturated core leads to a piston like displacement of brine especially in medium to large sized pores consequently as shown in fig 4 brine is left in smaller pore elements crevices of pore walls and corners of angular pores this is typical of a hydrophilic rock system characterized by preferential wetting of the aqueous phase since the scco2 injection rate simulates near wellbore conditions viscous forces would dominate over capillary forces therefore the extent of brine displacement by scco2 during primary drainage is limited by the amount of pressure drop established during scco2 injection thus a remaining brine saturation is attained at the end of primary drainage specifically the average remaining brine saturation was 63 of the pore volume within the fov this serves as the zero hour saturation point just before the commencement of evaporative drying the drying process involved continuous scco2 injection through the core sample high resolution scans of the fov were taken at intervals 4 12 24 48 60 and 72 h during the course of drying the fluid occupancy maps in fig 5 a compare the gray scale images that reveal the fluid occupancy between the 0 and 24 hour marks these slices were selected at a position close to the top of the fov from time 0 after primary drainage to 4 h scco2 was only able to invade a few pores as shown by the pores within the red circles in fig 5 a this displacement process is still an advective one as the viscous forces overcome the threshold capillary pressure required to invade these pores it is important to highlight the unswept region bypassed by the scco2 stream at the top section of the two slices this region is mainly characterized by brine filled small to medium sized pores that have not been invaded by scco2 it also contributes significantly to the observed high brine saturation moving from 4 to 12 h of continuous scco2 injection we see additional brine displacement by scco2 in smaller pores within the red circles however the unswept region remains mostly unchanged across the fov the average brine saturation slightly reduced to 60 there were no visible phase transitions within this period implying very low brine evaporation levels within the fov advancing further from 12 to 24 h the unswept region was eventually invaded by scco2 indicating that the threshold capillary requirements for the invasion of pore elements had been met within this region this occurred because evaporation had commenced in upper sections of the core outside the fov and smaller pores in those sections had been accessed by scco2 this created a new pathway for scco2 to access and displace brine from pores in the unswept region of the fov overall advective forces still dominated over molecular diffusion within the fov 3 1 2 stage 2 transition stage as the cumulative drying time progressed from 24 to 48 h an interesting phenomenon was observed this is explicated in the static grayscale images in fig 5 b the most striking observation between the two image slices is that the aqueous phase has blended with the grain however by focusing on the selected area bounded by the red box it is clear that the aqueous phase intensity has drastically reduced becoming similar to that of the grain since the brine is a high salinity nai solution the lowering of phase intensity indicates either a reduction in the solute species concentration or total dissolved solids or brine carbonation by scco2 dissolution in the latter case dissolution is constrained by the salting out effect which limits the amount of scco2 that can dissolve in brine under equilibrium conditions using the psuco2 co2 brine phase equilibrium model developed by zhao and co workers zhao et al 2015 2015 the maximum amount of scco2 that can dissolve in 1 liter of brine under equilibrium conditions at 1500 psi and 50 c is approximately 22 5 g see supplementary materials for solubility plot this is about 9 of the mass of nai 250 g in brine however because co2 is in a supercritical state carbonation increases the density and correspondingly the intensity of the brine phase nonetheless by a meager amount therefore it is apparent that scco2 dissolution in brine is not a contributor to the decrease in brine phase intensity to explain this observation from the perspective of solute concentration reduction we initially presume that salt precipitation has already begun in the region above the fov this will be ascertained shortly the precipitation of salt above the fov induces a reverse flow of solutes within the hydraulically connected brine phase in the fov and below towards this new salt phase see fig 9 a this suggests a phenomenon we term reverse solute diffusion where solute species are transported from a region of lower concentration to that of a higher concentration due to an external driving force shokri et al 2010 the external force that influences this process is the interfacial tension ift between the supersaturated brine and the scco2 at the evaporation front ift is highest at this front due to a higher salt concentration in brine shahidzadeh bonn et al 2008 this force appears to have overcome the osmotic pressure that restricts solute transport within the brine phase leading to transport of solutes towards the concentrated evaporating front the concentration gradient created by the reverse solute flow is maintained by an interfacial tension gradient that persists ahead of the front scriven and sternling 1960 marin et al 2019 efstratiou et al 2020 the resulting enrichment of solutes in regions at the evaporating front results in solute depletion in regions away from the front to the best of our knowledge this is the first direct evidence of reverse solute diffusion during salt precipitation resulting from evaporative drying in naturally occurring rocks therefore it will be somewhat challenging to make direct comparisons to existing processes in the literature that are based on solute transport by capillary flow however similar to these processes reverse solute diffusion is aided by the capillary continuity of the aqueous wetting phase which allows for unperturbed solute transport to upper dried out or drying regions at the macro reservoir scale this process is termed salt self enhancement and occurs in conjunction with the capillary backflow of brine from regions away from the wellbore as suggested in the literature miri and hellevang 2016 it is worth mentioning that ott et al 2014 observed solute depletion and enrichment in a multi porosity system due to the presence of an overbearing microporosity in the estaillades carbonate rock used in their microscale experiment ott et al 2014 hence they observed capillary induced solute transport within the brine phase that resulted in a depletion of solutes in intragranular micropores and its enrichment in intergranular macropores ott et al 2014 conversely in this work solute depletion and enrichment was experienced simultaneously in both macropores and micropores see fig 5 6 and 9 making depletion by reverse solute diffusion different from the channeling effect induced by micropores as observed by ott et al 2014 looking at the area within the blue circle in fig 5 b it is evident that the advective flow was still ongoing within the previously unswept region this suggests that the system was gradually transiting from transport limited by advection to diffusion dominated flow 3 1 3 stage 3 diffusion dominated flow and evolution of salt deposition reverse solute diffusion continued as we moved from 48 to 60 cumulative hours of drying in addition the precipitation or drying front begins to move from regions above the fov to within the fov this is evidenced by the grayscale images from the top of the fov in fig 6 a and the vertical profile of the fov in fig 9 b the first observation between both images is that the aqueous phase intensity has dramatically increased to even higher than the original brine suggesting that salt precipitation had occurred this confirms the inference made earlier that precipitation was already happening at regions above the fov as the evaporation front moves downwards and water evaporates there is an increase in fickian diffusion of solute molecules to the brine scco2 interface this enhances the aqueous phase s supersaturation and culminates in salt precipitation when the solubility limit is eventually attained as shown in the highlighted section of the image within the red rectangle salt precipitation had occurred in three different fluid occupancy configurations the first scenario location a in the figure is precipitation in formerly brine filled pores that were not in direct contact with the scco2 phase in this case evaporation is mainly aided by the brine hydraulic connectivity such that the entire brine volume serves as a conduit for molecular water transfer to the scco2 phase which thereby helps the precipitation process see supplementary materials for brine connectivity determination the second scenario location b is precipitation in scco2 filled pores having water in the corners or pores partially filled with brine essentially brine in these pores is in direct contact with the flowing scco2 phase and precipitation results from the local diffusion of water molecules from the aqueous phase to the constantly replenished undersaturated scco2 rich phase the third scenario location c is precipitation within brine filled pores containing scco2 pockets at the center of the pore this situation arises because of incomplete displacement of brine during advection before diffusion dominated flow therefore the co2 rich phase appears trapped this however does not limit the precipitation process as water molecules still diffuse into the connected supercritical co2 phase by visualizing the middle section of the fov we get a clearer picture of the evolution of salt precipitates the images in fig 6 b reveal two different aqueous phase concentrations within the d and e bounding rectangles the first phase concentration brine i in pores within d is the same as the 48 hour brine phase concentration that had been subjected to reverse solute diffusion supplying solute species to the top of the fov as illustrated in fig 9 b the second within e with a slightly higher intensity than the grain is an aqueous phase concentration similar to that of the original brine the reemergence of the original brine is a benefit of reverse solute diffusion from the bottom of the fov this however is not the same brine as before but just a transition concentration between solute depleted brine and the solute rich brine as evaporation continues brine phase intensity increases due to the loss of water molecules to the scco2 rich phase leading to salt precipitation the pore within the region bounded by rectangle f is filled with the newly formed salt as described previously a typical image of the bottom section of the fov is shown in fig 6 c in this part of the rock the aqueous phase is mostly the same as that of the 48 hour phase this implies that reverse solute diffusion had not yet impacted the bottom of the fov as the solute species diffuse past this region to the evaporation front at upper sections it is however noticeable that some scco2 to brine displacements were still occurring therefore it is inferred that the bottom section was still at the transition stage we have applied a machine learning based segmentation tool called texture supervised classification on the pergeos software platform to segment the three fluid phases scco2 desalted brine and original brine and one solid salt precipitate phase see the supplementary materials for further information the subsequent phase saturation distribution after 60 h of evaporative drying throughout the fov is shown in fig 7 a as expected salt deposits mostly accumulated at the top together with the scco2 the higher intensity brine brine i saturation starts to increase as we move away from the top and reaches a maximum at the middle of the fov the lower intensity brine brine ii saturation is low at the top and middle and is highest at the bottom of the fov the average saturation at the 60 hour mark in fig 7 b reveals a high level of scco2 occupancy 82 3 and small amounts of salt deposits 1 5 after 72 h of drying salt precipitates had formed throughout the entire depth of the fov fig 8 confirms this as it compares the 60 hour image to the 72 hour image at the bottom of the fov as discussed previously salt had precipitated in brine filled pores the corners and crevices of scco2 filled pores and the periphery of pores that had been partially invaded by scco2 it is important to note that salt had also precipitated within the microporous grains this is further discussed in section 3 3 the final saturation distribution after evaporative drying within the fov is shown in fig 8 b it reveals that once precipitation commences advection becomes minimal with little or no scco2 to brine displacements this is evidenced by the overlapping scco2 saturation profile when moving from 60 to 72 h of evaporative drying another observation is that the salt deposition becomes more significant as brine i and eventually brine ii precipitate out their salts the final average salt saturation therefore increases from 1 5 to 17 3 this substantial amount of salt deposits in the near wellbore region can lead to pore plugging porosity and permeability reductions and well injectivity issues we determine and quantify the extent of pore space reduction in section 3 4 3 2 factors governing salt deposition mechanics based on the existing literature we have determined that salt precipitation mechanics are affected by two main factors the first is the degree of heterogeneity of the porous medium usually characterized by the pore size distribution and the scco2 injection rate in the near wellbore region to probe the former evaporative drying within a less heterogeneous clashach sandstone is compared with that in a more heterogeneous prairie shell carbonate to determine the impact of the scco2 injection rate we compare the salt deposition profile of the base case scco2 injection rate 0 1 cm3 min with that of a higher injection rate of 0 5 cm3 min for the same carbonate rock type 3 2 1 effect of rock heterogeneity on salt deposition mechanics evaporative drying experiments were carried out on both sandstone and carbonate rock types resulting in salt precipitation from the aqueous phase the time to final precipitation salt deposition sites and in situ distribution of precipitates were identified as the main parameters affected by the level of rock heterogeneity in the following subsections these effects are discussed in detail 3 2 1 1 time to final precipitation before the drying process both brine filled samples were pre flooded with 25 pore volumes of scco2 to a remaining brine saturation this served as the zero time for the drying sequence the average remaining brine saturation at the end of the pre flood in the sandstone sample was 27 6 while that of the carbonate sample was 63 1 this preliminary finding indicates that initial displacement of brine drainage by scco2 was more efficient in sandstone since threshold capillary pressure requirements in this homogeneous system were mostly uniform this implies that scco2 instantaneously invades multiple connected pores once the capillary pressure requirements are met leading to a more efficient displacement the clear distinction between the two samples is shown in the images in fig 10 another reason for this could be that the sandstone sample had better pore connectivity than the carbonate system this is evidenced by the lack of brine displacement in large pores typically characterized by low threshold capillary pressures in the carbonate medium the scco2 to brine displacements continued during evaporative drying as observed and discussed in the preceding section at the 12 hour mark the brine saturation in sandstone fell to 16 4 while a reduction to 60 was observed for the carbonate this emphasizes the previous assertion of slower displacements in a heterogeneous system compared to a homogeneous counterpart salt precipitation occurred within 12 to 24 h of evaporative drying in the sandstone sample this is shown in the saturation profile in fig 11 a therefore we confirm that it took only 24 h to evaporate the initial brine and induce salt deposition in the sandstone in the carbonate case however precipitation did not commence until after 48 h of drying at this time the brine saturation had decreased significantly to 33 6 this suggests that in both cases there is a critical brine saturation at which precipitation begins to occur this saturation heralds the cross over from advection dominated transport to diffusion limited flow for the same scco2 injection rate this critical brine saturation is lower for homogeneous systems compared to heterogeneous media salt precipitation finally ends after 72 h in the prairie shell medium see fig 11 b indicating a longer time between precipitation commencement and termination 24 h in this case versus 12 h in the clashach medium at the reservoir scale a delayed and slow rate of injectivity loss such as in the heterogeneous carbonate is more favorable however heterogeneous systems tend to have lower initial injectivity due to variation in pore sizes and typically lower permeability solomon and flach 2010 3 2 1 2 salt deposition sites as observed during the previous discussion on salt deposition evolution precipitates form at sites previously occupied by brine these sites differ based on pore morphology and connectivity fig 12 a is a typical depiction of precipitate occupancy in sandstone expectedly precipitates form mostly in the corners of scco2 filled pores these were former brine filled sites which had characteristically obeyed the wetting order in hydrophilic rock systems entirely salt filled pores were few and occurred in smaller elements that could not be invaded by the injected scco2 salt deposition in the more heterogeneous carbonate also happened in former brine filled sites however the deposition order was slightly different from that of the sandstone case first there were more pores entirely filled with salt see fig 12 b this did not directly correlate with pore size as in the sandstone case because whole deposits were found in both small and medium to large pores this could be due to poor pore connectivity in the carbonate system one similarity between both cases is that salt deposits occupied corners of scco2 filled pores deposits were also situated in crevices of the pore walls because of high surface roughness another typical observation in the carbonate system is scco2 pockets in the center of some salt filled pores highlighted within the blue circles in fig 12 b this occurrence originates from precipitation in brine pores that had been partially invaded by scco2 3 2 1 3 in situ precipitate distribution the degree of heterogeneity has been found to affect the amount of salt deposits relative to pore size pore sizes were classified based on equivalent diameter intervals under this classification pores with equivalent diameters less than 50 µm were grouped as small pores those with equivalent diameters greater than 200 µm are large pores while medium sized pores are between 50 and 200 µm in diameter fig 13 is a bar chart that describes salt deposit saturation relative to pore size overall salt deposits were mostly found in small pores however this varied with the degree of heterogeneity a higher saturation of salt deposits was found in small pores of the sandstone compared to the carbonate this emanates from a greater tendency of brine to remain in small pores in the more connected sandstone system after the initial scco2 drainage in the medium sized group salt deposits occurred more in the carbonate case this pore class contains the modal pore sizes for both rock cases 87 µm for sandstone and 70 µm for carbonate and largely determines the overall salt saturation within the fov the more homogeneous the system the closer this value is to that obtained for the medium sized pores for example the sandstone s overall salt saturation was determined to be 14 5 almost equal to the saturation in the medium sized pores however salt saturation in the carbonate was 17 3 about 5 lower than the saturation in its medium sized pores this also shows the overall saturation is determined more by larger pores higher than the modal pore size in the carbonate system due to positive pore size skewness the saturation of salt deposits in large pores was very low and similar in both cases this is expected in a hydrophilic system since scco2 would mostly occupy and saturate large pores from a practical perspective the salt deposition effect would be less detrimental to injectivity if it occurs in small pores 3 2 2 effect of scco2 injection rate on salt deposition in this section we present the results of experiments conducted to probe the impact of the scco2 injection rate on the evaporative drying process that ultimately leads to salt precipitation this is a comparison of results from evaporative drying tests carried out at two different scco2 flow rates 0 1 cm3 min experiment 1 and 0 5 cm3 min experiment 2 on two similar miniature prairie shell carbonate core samples using the core flooding setup from experimental results we have observed that the injection rate controls 1 the initial fluid scco2 and brine and final scco2 saturations 2 the time to final precipitation and 3 the amount of precipitated salt these findings are discussed below accordingly 3 2 2 1 initial and final fluid saturations under strictly advective flow higher flow rates intensify viscous forces that enhance immiscible displacements of brine by scco2 at the pore scale as shown in fig 14 a for the same pore volume of scco2 injected during primary drainage the overall effect of a higher injection rate is a lower remaining brine saturation however this does not essentially mean a uniform vertical displacement of brine by scco2 this concept becomes evident when we compare the saturation profiles for both cases in fig 14 a for the base case of 0 1 cm3 min injection rate experiment 1 a more uniform saturation profile is observed relative to the higher rate case experiment 2 this could mean that a higher rate although connoting higher scco2 phase pressure also increases the propensity for scco2 to bypass some brine filled pores in lower permeability less accessible regions at the top of the fov we confirm this by taking slices from the top a and the bottom sections b of the fov these fluid occupancy maps are shown in fig 14 b at location a we see that scco2 occupies mostly large pores in both cases however a number of brine filled pores are also prevalent across all pore sizes therefore displacement efficiency is almost the same in both cases at the lower location location b we see that the high rate case has a more significant scco2 invasion into pores of different sizes whereas the other case resembles the map at the top section we infer that a lower hydraulic conductivity at the top section in the higher rate case contributes to this initial scco2 bypass 3 2 2 2 time to final precipitation the end of primary drainage represents the zero time for the evaporative drying stage however we have already established that scco2 to brine displacements still occur during evaporative drying as scco2 injection proceeds as discussed earlier a critical scco2 saturation is attained before precipitation begins thereafter only a marginal increase in scco2 saturation occurs owing to the higher dominance of diffusion the evolution of salt deposits for experiment 1 has been discussed in section 3 1 precipitation starts after 48 h of injection and ends within 24 h in experiment 2 injecting at a higher flow rate shortens both times to final precipitation and the precipitation duration specifically precipitation occurs within the first 12 h of evaporative drying we presume that the average scco2 saturation after primary drainage was closer to the critical scco2 saturation the average scco2 saturations at the end of evaporation in experiments 1 and 2 were 82 7 and 90 5 respectively meaning that there was slightly less remaining brine in the system available for precipitation in experiment 2 compared to experiment 1 a combination of higher scco2 injection rate i e a higher rate of evaporation and lower brine saturation available after achieving critical scco2 saturation has resulted in the shortening of the precipitation time for experiment 2 3 2 2 3 final salt saturation and cluster size distribution as stated previously precipitation does not occur until a certain critical scco2 saturation where the flow is governed by diffusion the saturation profile of precipitates for both injection rate cases is shown in fig 15 a the plot reveals an overall higher salt deposition for experiment 1 this is a direct consequence of a higher average brine saturation established after the initial scco2 drainage before evaporative drying in experiment 1 compared to experiment 2 see fig 15 b the scco2 bypass effect at the top of the fov for experiment 2 explained in section 3 2 2 1 has resulted in more salt deposition in that region the final average salt saturations for the 0 1 cm3 min and 0 5 cm3 min tests were 9 5 and 17 3 respectively therefore by comparing the two carbonate cases a five fold increase in the injection rate has resulted in a 45 reduction in the amount of salt deposits going further we have used the pergeos software package to assess the size of individual salt clusters within the pore space of the carbonate medium at both injection rates this is to determine whether the scco2 injection rate plays any role in determining the morphological properties of the salt deposits results from this analysis are shown in fig 15 b the first observation from the graph is that the cumulative frequency plots in both experimental cases mostly overlap in determining the level of similarity between the two distributions in fig 15 b a two sample kolmogorov smirnov k s test was implemented with matlab smirnov 1939 grzegorzewski 2018 the two sample k s test is a non parametric equality test that evaluates the difference between two cumulative distributions grzegorzewski 2018 using the data represented in fig 15 b the resulting k s test statistic d the maximum scalar difference between the two distributions was 0 0884 and the p value was 0 000 therefore by applying a significance level of 1 i e rejecting the null hypothesis of equality when p 0 01 the two distributions are statistically unequal however the k s test statistic d is small i e much closer to 0 than 1 hence it is apparent that although the two cluster distributions are statistically unequal i e they do not come from the same distribution they are relatively similar this analysis suggests that salt cluster size is invariant of the injection rate consistent with recent observations in the literature he et al 2019 moreover for both cases about 85 of the volume of these clusters represented by the shaded area fall within the 5 10 6 mm3 to 10 3 mm3 size group meaning that they were mostly formed in connected medium sized pores this observation is also exemplified in the three dimensional volume renderings of salt clusters in both carbonate cores shown in fig 16 a although it is first obvious that more salt deposits were formed in experiment 1 where q 0 1 cm3 min compared to experiment 2 where q 0 5 cm3 min the morphology of the salt clusters appear to be very similar see fig 16 b in general by applying the cluster size classification in fig 15 b there were several medium sized clusters few large clusters and many small clusters in addition the mean cluster size calculated as 8 911 10 6 mm3 in experiment 1 and 1 020 10 5 mm3 in experiment 2 falls within the medium sized cluster category this affirms the previous assertion made in section 3 2 1 3 that medium sized pores are the limiting pore size group for salt deposition 3 3 salt precipitation in micropores 3 3 1 observation in sandstone and carbonate rocks although most clastic and carbonate rocks comprise a dominant mineral quartz as in sandstone and calcite dolomite as in limestone dolostone they also contain other minerals like feldspar mica carbonates mostly calcite in sandstone and clay minerals haldar and tišljar 2014 in sandstone clay minerals like smectite montmorillonite illite and kaolinite form the majority of the non cemented matrix interbedded with quartz grains haldar and tišljar 2014 these clay minerals are hydrophilic in nature and strongly adsorb brine due to inherent electrostatic attractive forces bleam 2017 they are also fine particles exhibiting both intercrystalline and interlayer porosity of sub micron sizes cao et al 2016 these micropores are challenging to resolve with micro ct scanners and therefore appear as darker grains as shown by the red rings on the dry image in fig 17 a for the clashach sandstone carbonates may also exhibit microporosity based on folk s classification carbonate rocks comprise constituent allochems oolites peloids fossils bioclasts intraclasts pisolites and oncoids that could be entirely or partially cemented compacted or interbedded with finely grained micrite calcite clay haldar and tišljar 2014 from our observations of qemscan and micro ct images we infer that prairie shell grains consist of skeleton and shell fragments moved by ocean tide and deposited in marine environments hence it is a bioclast in addition the microporosity in prairie shell could be intragranular within calcite grains intrafossil within fossil shells or intercrystalline across non micritic clay particles bultreys et al 2016 essentially because of their nano scale pore size microporous media in saline aquifers would consist of irreducible brine it is energy intensive for scco2 to displace brine in micropores by advection therefore as evaporative drying occurs in the macroporous media and precipitates form microporous media also undergo the same process as highlighted by the white circles for sandstone and yellow and green circles for carbonate in fig 17 a salt eventually precipitates in the micropores it is worth noting that there was no observable distinction in the evolution of salt deposition in both porous systems therefore as salt formed in macropores it also precipitated in micropores we have attempted to quantify the contributions of these micropores in both sandstone and carbonate media to the overall salt saturation we did this by segmenting out the entire salt phase in both macro and micro pores and then deducting it from the salt in the segmented macropores this difference gives an aggregate salt saturation that is then corrected for porosity we have assumed an average porosity of 33 for the micropores based on recommendations by alansari and coworkers alansari et al 2019 from the results presented for both rock types shown in fig 17 b the contribution of microporous deposits to the overall salt saturation has been determined to be significant especially in sandstone for the clashach sandstone accounting for precipitation in micropores increased the average salt saturation by an additional 4 5 i e from 14 5 to 19 by contrast only marginal increments were obtained for the two prairie shell cases 1 5 for the 0 1 cm3 min injection rate and 1 1 for the 0 5 cm3 min injection rate this difference is mainly because the sandstone rock intrinsically has more microporous sites than the carbonate therefore neglecting microporosity in reservoir scale models for precipitation simulation and prediction in sandstone saline aquifers could result in significant under prediction of salt deposition 3 3 2 sub micron characterization of salt deposits fibsem imaging of the dried out carbonate rock has elucidated the salt deposition pattern in micropores see the supplementary materials the first pattern is characterized by salt deposition in intergranular micropores as shown in fig 18 a salt crystals accumulate on surfaces of small intergranular pores that are less than 1 µm in size individual clusters are no more than 2 µm in length and are randomly distributed within the microporous elements these deposits have formed from brine that could not be displaced by scco2 advection due to high capillary pressure requirements at high magnification the deposits appear as individual particles orderly arranged on the pore walls the second pattern discovered from sem images is typified by deposition in intragranular micropores and is shown in fig 18 b these micropores are nanometer sized interconnected fissures that were initially filled with connate brine after scco2 induced evaporative drying salt deposits in these conductive fissures formed a precipitate network within the carbonate grains this pattern is similar to those derived for precipitation in ultra tight clay rich tight dolomitic siltstone rocks that showed deposition of monovalent salt crystals within fissure like pores alizadeh et al 2018 3 4 porosity reduction salt deposition in near wellbore regions of saline reservoirs has been posited as the leading cause of pressure buildup which is detrimental to scco2 injectivity grude et al 2014 solomon and flach 2010 as revealed in preceding discussions salt could occupy entire pores and throats or partially fill these pore elements thereby reducing the net pore space through which scco2 can flow fig 19 shows the reduction in porosity in the fov for the three experimental cases by comparing the carbonates to sandstone it is instantly clear that the porosity profile is more uniform for clashach sandstone compared to that in prairie shell limestone however porosity reduction appears to be uniform across core samples and between different flow rates we believe that this results from the hydrophilic nature of the system which enhances brine connectivity thereby creating deposits with a uniform thickness along the pore wall moreover for the same flow rate 0 1 cm3 min the profiles reveal that the pore space is marginally more plugged in the carbonate case than in the sandstone because there are more instances of salt filling up whole pores comparing across the flow rates for the same carbonate rock we observe less porosity reduction in the higher flow rate case directly correlating with lower salt deposits instances 4 conclusions in this study we explored the phenomenon of salt precipitation as a result of supercritical carbon dioxide injection in brine saturated natural porous media at elevated pressure and temperature conditions it was designed to determine the pore scale mechanisms that lead to macro scale observations during evaporative drying with scco2 the results agree well with the existing literature and clarify the role of heterogeneity and injection rate in salt deposition evolution as a result the following conclusions have been deduced salt precipitation during scco2 injection and storage in saline aquifers occurs as a result of evaporative drying within near wellbore regions this leads to permeability impairment accompanied by porosity reduction that could cause pressure buildup within this region with detrimental effects on well injectivity we presented in situ evidence of salt precipitation in the pore space of natural sandstone and carbonate samples the evolution of salt deposition in brine saturated systems at subsurface reservoir conditions follows a three stage sequence the first is characterized by advection dominated flow where scco2 displaces brine based on capillary pressure requirements and pore connectivity the second is a transition stage where the contribution of diffusive forces becomes as significant as advection herein reverse solute diffusion enables replenishment and accumulation of solute species at the evaporation front the third stage is exemplified by diffusion limited flow where solute accumulation at the scco2 brine interface together with water molecule diffusion to the flowing scco2 phase accelerates brine supersaturation which eventually causes precipitation overall the precipitate saturation is higher in smaller pores compared to larger pores this arises from inefficient advective brine displacement by scco2 in these pores however the final salt saturation is limited by the amount of salt deposit in medium sized pores precipitation in the heterogeneous carbonate is less uniform and less rapid relative to the moderately homogeneous sandstone for the same scco2 injection rate it is influenced by pore size and connectivity although this is beneficial at the reservoir scale heterogeneous systems are relatively less permeable hence the overall effect on the efficiency of scco2 storage is not clear a higher injection rate reduces the amount of salt deposits formed in near wellbore regions in this study a five fold increase in injection rate caused an 82 reduction in salt deposition however it occurred six times faster this tradeoff of rapidity and amount of salt deposition would need to be considered during field scale initiatives microporous media in sandstone reservoirs contribute significantly to the observed salt precipitation these deposits occupy both intergranular and intragranular micropores initially saturated with irreducible brine they form distinct deposition patterns within and on the walls of the micropores salt deposition in micropores could increase the overall salt saturation by about 4 therefore ignoring the effect of micropores in reservoir simulation predictions would erroneously underestimate the extent of salt deposition porosity reductions directly correlate with the amount of salt deposited and become more significant as the scco2injection rate decreases this ultimately results in a substantial loss of scco2 conductivity credit author statement dayo akindipe conceptualization methodology investigation visualization formal analysis writing original draft soheil saraji conceptualization methodology supervision writing review editing mohammad piri conceptualization supervision writing review editing resources funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments we thankfully acknowledge the financial support of thermo fisher scientific hess corporation and the school of energy resources university of wyoming in addition we extend our appreciation to our colleagues at the center of innovation for flow through porous media university of wyoming dr amir alizadeh for his insightful comments and dr zhenyuan zhang and omar elmasry for their help with sem imaging and qemscan analysis supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2021 104011 appendix supplementary materials image application 1 
261,pfas are emergent contaminants of which the fate and transport in the environment remain poorly understood as surfactants adsorption at air water and solid water interfaces in soils complicates the retention and leaching of pfas in the vadose zone recent modeling studies accounting for the pfas specific nonlinear adsorption processes predicted that the majority of long chain pfas remain in the shallow vadose zone decades after contamination ceases in agreement with many field measurements however some field investigations show that long chain pfas have migrated to tens to a hundred meters below ground surface these discrepancies may be attributed to model simplifications such as a one dimensional 1d homogeneous representation of the vadose zone another potentially critical process that has not been fully examined by the 1d models is how surfactant induced flow sif influences pfas leaching in multidimensions we develop a new three dimensional model incorporating the pfas specific flow and transport processes to quantify the impact of sif and subsurface heterogeneities our simulations and analyses conclude that 1 sif has a minimal impact on the long term leaching of pfas in the vadose zone 2 preferential flow pathways generated by subsurface heterogeneities lead to early arrival and accelerated leaching of especially long chain pfas 3 the acceleration of pfas leaching in high water content preferential pathways or perched water above capillary barriers is more prominent than conventional contaminants due to the destruction of air water interfaces and 4 subsurface heterogeneities are among the primary sources of uncertainty for predicting pfas leaching and retention in the vadose zone graphical abstract image graphical abstract keywords surfactant induced flow preferential flow heterogeneity air water interfacial adsorption solid phase adsorption vadose zone 1 introduction per and polyfluoroalkyl substances pfas are a group of synthetic chemicals that have been widely used since the 1940s in many industrial and consumer products including nonstick and stain resistant coatings food containers paper products and fire fighting foams buck et al 2011 itrc 2018 wang et al 2017 resulting from large scale manufacturing and wide use of pfas in the past 80 years they are now ubiquitous in the environment e g soils groundwater sediments and surface water and have become emerging contaminants of international concern e g brusseau et al 2020b hatton et al 2018 hu et al 2016 sharifan et al 2021 the scientific understanding of the fate and transport of pfas in the environment especially in source zones under water unsaturated conditions is still in its infancy a growing body of field data demonstrates that pfas concentrations in soils are orders of magnitude up to seven orders of magnitude higher than those in groundwater beneath the source zones and that the majority of pfas remains near the top of the vadose zone anderson et al 2016 2019 brusseau et al 2020b dauchy et al 2019 mcguire et al 2014 xiao et al 2015 adamson et al 2020 however it remains poorly understood as to what primary mechanisms are controlling the long term retention of pfas in the vadose zone and the subsequent mass discharge to groundwater over time many pfas are surfactants kissa 2001 thus they tend to adsorb at air water and solid water interfaces in soils and may stay in the vadose zone for long times before contaminating groundwater brusseau 2018 guo et al 2020 using surface tension data of two primary pfas and measured air water interfacial awi areas in soil materials brusseau 2018 examined the impact of pfas adsorption at air water interfaces as a potential retention process in soils additional surface tension based theoretical analyses covering a wider range of pfas and solution chemistry conditions have also been reported brusseau et al 2019a 2019b brusseau van glubt 2019 costanza et al 2019 silva et al 2019 schaefer et al 2019 costanza et al 2020 the impact of awi adsorption has also been investigated by miscible displacement experiments using packed columns of different soil media and water saturation conditions brusseau et al 2019a lyu brusseau 2020 lyu et al 2018 ouni et al 2021 the measured breakthrough curves were simulated by a one dimensional 1d solute transport model assuming steady state flow under a uniform water saturation that accounts for rate limited and nonlinear adsorption at solid surfaces and air water interfaces brusseau 2020 brusseau et al 2019a the above surface tension based analyses miscible displacement experiments and the 1d solute transport simulations all focused on laboratory conditions mathematical modeling of pfas transport and retention under field conditions in the vadose zone has only begun recently guo et al 2020 reported a new mathematical model that represents a comprehensive set of pfas specific transport processes including surfactant induced flow sif nonlinear and rate limited solid phase and awi adsorption under transient variably saturated water flow numerical simulations of pfos perfluorooctanesulfonic acid c8hf17o3s released at a model aqueous film forming foam afff impacted fire training area fta site and the subsequent transport and retention in the vadose zone demonstrated that pfos can be strongly retained in the vadose zone even under highly transient variably saturated flow driven by time dependent rainfall infiltration shortly thereafter a model similar to that of guo et al 2020 was also independently reported by silva et al 2020a 2020b where example simulations were presented in 1d and 2d the numerical simulations of pfas leaching in the vadose zone reported by guo et al 2020 are generally consistent with soil pfas concentration profiles measured at contaminated sites namely concentrations of long chain pfas in the soil profiles at many source zones show that the majority of the total mass stays in the shallow vadose zone i e the first meter or two brusseau et al 2020 dauchy et al 2019 davis et al 2007 filipovic et al 2015 hale et al 2017 shin et al 2012 and the concentration decreases exponentially along with the depth brusseau et al 2020b however despite that most of the long chain pfas were reported to stay in the shallow vadose zone they have been observed in deep vadose zones and groundwater at many sites even tens or a hundred meters below the land surface brusseau et al 2020 dauchy et al 2019 afw 2019 this discrepancy between the model simulations and the field data implies that additional processes and factors not incorporated in the prior modeling studies are likely influencing the leaching of pfas in the vadose zone a potentially important factor is the subsurface heterogeneities such as macropores high conductivity channels or fractures soil lenses or layers which were widely reported to provide preferential pathways for the transport and leaching of non pfas solutes and contaminants in the vadose zone and groundwater e g brusseau rao 1990 bekhit hassan 2005 köhne et al 2006 2009 kung 1990a 1990b šimůnek et al 2003 zhou zhan 2018 another important factor that has not been fully examined is the impact of sif on pfas leaching prior experimental and modeling studies on non pfas surfactants showed that surfactant induced capillary pressure gradient can strongly influence variably saturated flow and solute transport in the vadose zone smith and gillham 1994 1999 henry et al 2002 karagunduz et al 2015 it is anticipated that similar effects of sif may be observed for pfas in source zones specifically decreases in surface tension resulting from pfas being present in porewater can cause induced drainage that on the one hand accelerates the transport of pfas in the vertical direction due to increased porewater velocities while on the other hand also leads to lateral spreading of pfas that can potentially reduce vertical leaching concomitantly surfactant induced drainage also reduces water saturation resulting in an increase in the awi area which would then increase the retention of pfas due to stronger awi adsorption it remains unclear as to how the above mechanisms will manifest to influence pfas leaching in the vadose zone systematic investigations of the impact of both subsurface heterogeneity and sif on pfas leaching require more advanced models that represent flow and transport processes in multiple dimensions to address the critical questions regarding sif and subsurface heterogeneity we extend the model formulation of guo et al 2020 to develop a three dimensional 3d model that represents the transient variably saturated flow sif and the comprehensive set of pfas specific transport processes in the vadose zone and groundwater we apply the new model to simulate contamination scenarios at a model afff impacted fta site a set of comprehensive numerical experiments are designed to examine the impact of sif and subsurface heterogeneities on pfas leaching and mass discharge to deep vadose zones or groundwater several types of typical subsurface heterogeneities are considered including soil lenses high conductivity pathways and randomly distributed soil media in space to the best of our knowledge this is one of the first 3d models for pfas transport in the vadose zone and multidimensional numerical simulation study of pfas retention and leaching in the vadose zone accounting for a wide range of subsurface heterogeneities the multidimensional mathematical formulations and the numerical framework are presented in section 2 in section 3 data and parameters used for modeling pfas transport are introduced this is followed by section 4 that presents detailed descriptions of numerical experiments and analyses of the simulation results in section 5 we discuss the implications of our findings we close with concluding remarks in section 6 2 mathematical model and numerical framework 2 1 mathematical model 2 1 1 variably saturated flow the variably saturated water flow in the subsurface may be described by the richards equation richardson 1921 richards 1931 which incorporates the extended darcy s law for variably saturated flow buckingham 1907 in the mass balance equation of the water phase here we present the richards equation in 3d 1 θ t k s k r θ h z 0 where θ is the volumetric water content cm3 cm3 h is the water pressure head cm t is time s the vertical axis z is positive downward k s is the tensor for saturated hydraulic conductivity and kr is the relative permeability parameterized as a function of θ the relative permeability function of mualem 1976 and van genuchten 1980 is used we assume that the off diagonal entries of k s are zero kij 0 for i j and that the porous medium is isotropic k 11 k 22 k 33 ks 2 1 2 pfas transport the transport and retention of a pfas in the subsurface may be described by the 3d advection dispersion equation coupled with adsorption at the solid surfaces and air water interfaces e g guo et al 2020 2 θ c t ρ b c s t c a w t θ v c θ d c 0 where c is the aqueous concentration µmol cm3 ρ b is the bulk density of the porous medium g cm3 v q θ is the vector for the interstitial porewater velocity cm s where q k s kr h z is the darcy flux cm s the hydrodynamic dispersion tensor d is the sum of the mechanical dispersion and molecular diffusion coefficients cm2 s which for an isotropic porous medium can be given by d α t v i α l α t vv v τ d 0 i bear 1988 where i is the identity matrix α l cm and α t cm are longitudinal and transverse dispersivities respectively d 0 is the molecular diffusion coefficient in free water cm2 s τ θ 7 3 θ s 2 is the tortuosity factor for the water phase millington quirk 1961 where θ s is the saturated volumetric water content cm3 cm3 cs µmol g is the solid phase adsorption which is modeled by the freundlich isotherm cs kfcn based on laboratory measurements brusseau 2020 brusseau et al 2019b higgins luthy 2006 wei et al 2017 where kf and n are fitting parameters caw is the awi adsorption µmol cm3 caw aaw γ here γ kawc is the surface excess of pfas at the air water interfaces µmol cm2 kaw is the awi adsorption coefficient cm3 cm2 we parameterize aaw as a function of water saturation i e a a w x 2 s w 2 x 1 s w x 0 where sw θ θ s these coefficients can be determined by fitting to awi area data measured by interfacial tracer experiments kaw can be determined via the gibbs adsorption equation k a w γ c 1 χ r t c σ ln c t e g rosen kunjappu 2012 where χ equals 1 for nonionic or ionic pfas in solutions with swamping electrolyte or 2 for ionic surfactants in solutions with no swamping electrolyte such as deionized water r 8 314 j k mol is the universal gas constant and t k is temperature σ is the surface tension of the solution which is a function of the aqueous concentration of pfas modeled by the szyszkowski equation e g adamson gast 1997 chang franses 1995 kissa 2001 rosen kunjappu 2012 σ σ 0 1 b ln 1 c a dyn cm where a µmol cm3 and b are fitting parameters to experimentally measured σ substituting the szyszkowski equation to the gibbs adsorption equation we obtain k a w 1 χ r t σ 0 b a c we assume that the solid phase and awi adsorption processes both reach equilibrium instantaneously see brusseau et al 2019b guelfo et al 2020 and zhou et al 2021 for mathematical formulations of kinetic solid phase adsorption and brusseau 2020 and guo et al 2020 for mathematical formulations of both kinetic solid phase and awi adsorption 2 1 3 coupling between the water flow and pfas transport when pfas is present in porewater the variably saturated water flow eq 1 and pfas transport eq 2 are fully coupled transient variably saturated flow drives advection and dispersion of pfas and also influences the awi adsorption by changing the awi area concomitantly changes in pfas concentration modify the surface tension and capillary forces and in turn influence the variably saturated water flow we parameterize θ as a function of h following the soil water characteristic swc function of van genuchten 1980 with pfas in the porewater we use the leverett j function to obtain a new pressure head h σ 0 σ cos γ 0 cos γ h that accounts for the change of surface tension leverett 1941 smith and gillham 1994 henry smith 2003 guo et al 2020 γ is the water contact angle σ is the surface tension in the presence of pfas in porewater and h 0 γ0 and σ0 are respectively the water pressure head water contact angle and surface tension when the pfas concentration is zero replacing h in the original swc function with the new water pressure head h leads to a modified swc function in the presence of pfas in soil porewater guo et al 2020 2 2 numerical framework we present a numerical framework to solve the mathematical formulations presented in section 2 1 i e eqs 1 and 2 subject to initial and boundary conditions we employ the cell centered finite difference in space and backward euler in time approximations to discretize both eqs 1 and 2 the mass conservative numerical scheme of celia et al 1990 is used for eq 1 for eq 2 a first order upwind scheme is used for the advection term while a central difference scheme is used for the dispersion term the top boundary of the domain allows for surface evaporation and ponding conditions using an implementation similar to that reported in guo et al 2020 we implement two numerical schemes for the coupling between eqs 1 and 2 within each numerical time step one employs a fully implicit fi framework that solves the two equations simultaneously while the other uses a sequential implicit si framework that iterates between the two equations until convergence in either case a newton raphson solver is employed to solve the resulting nonlinear system of equations the fi scheme assembles the discretized nonlinear formulations of eqs 1 and 2 and then linearizes by deriving a single jacobian matrix to solve for h and c simultaneously at each iteration level conversely the si scheme linearizes the discretized nonlinear formulations of eqs 1 and 2 separately and generates two smaller jacobian matrices one for h and the other for c an additional iteration loop is employed between the solvers for h and c at each numerical time step to ensure convergence more details for the fi and si frameworks are presented in appendix a we comment on the convergence properties of the two coupling frameworks in section 5 for the variably saturated flow and pfas transport simulations examined in the present work our overall numerical implementation utilizes the gridding and automatic differentiation utilities of the matlab reservoir simulation toolbox lie 2019 to validate the 3d implementation we have compared our model to a widely used open source simulator pflotran hammond et al 2014 excellent agreement between the two models is observed for both transient variably saturated flow and nonreactive solute transport in 3d see fig b 1 in appendix b 3 data and parameters we employ the newly developed 3d model to examine the impact of sif and subsurface heterogeneity on pfas leaching in the vadose zone three types of heterogeneities including the presence of soil lenses or layers high conductivity pathways and randomly distributed soil media are examined four different porous media covering a wide range of material properties and two representative pfas i e one is short chain and the other is long chain are used to construct the numerical experiments in the following subsections we introduce the detailed data and parameters for these porous media and pfas 3 1 porous media the four porous media that will be used for the numerical simulations are referred to as accusand vinton hayhook and high k sand i e a sand that has a greater hydraulic conductivity than the other three porous media detailed measured data and parameters are available for the first three from the literature guo et al 2020 jiang et al 2020a b peng brusseau 2005 the last high k sand is a porous medium that is hypothetically constructed to represent the preferential flow pathways accusand is a commercially available natural quartz sand unimin corp with a median grain diameter of 0 35 mm and a uniformity coefficient of 1 1 the uniformity coefficient is defined as d60 d10 where d60 and d10 are the grain diameters that are greater than 60 and 10 of the sample by weight respectively vinton and hayhook were both collected locally in tucson arizona vinton is a loamy sand it has a median grain diameter of 0 23 mm and a uniformity coefficient of 2 4 hayhook is a loam its mean grain diameter is 0 26 mm and the uniformity coefficient is 16 the difference between the uniformity coefficients indicates that hayhook has a much wider range of particle size than that of vinton even though vinton and hayhook have similar median grain sizes hayhook has many more smaller grains than vinton for example the clay content of hayhook 10 is much higher than that of vinton 3 the detailed parameters for the four porous media are summarized in table 1 the capillary pressure as a function of water content as well as the unsaturated hydraulic conductivity as a function of capillary pressure are plotted in fig c 1 in appendix c most of the parameters for accusand vinton and hayhook were determined in the laboratory the remaining parameters whose measured values are not available are estimated as follows experimental observations and pore scale models have demonstrated that the longitudinal and transverse dispersivities α l and α t are functions of the water content under unsaturated conditions e g bear cheng 2010 kirda et al 1973 maraqa et al 1997 padilla et al 1999 raoof hassanizadeh 2013 sato et al 2003 de smedt wierenga 1984 but general functional forms have not become available here we do not consider the dependence on water saturation and simply use the approximation for the longitudinal dispersivity under saturated conditions as α l 83 log10 l 100 2 414 xu eckstein 1995 where l is the apparent length scale in the present study we take l as the vertical depth of the vadose zone unless stated otherwise the transverse dispersivity α t was reported to be generally smaller than α l e g bear cheng 2010 yule gardner 1978 α t α l 10 is assumed in our simulations rockhold et al 2016 note that because the estimated α l and α t do not consider the impact of water saturation they may lead to underestimation of dispersion in the vadose zone the awi area aaw as a function of water saturation sw for both accusand and vinton was fitted to measured values obtained by the aqueous based interfacial partitioning tracer test iptt and mass balance surfactant tracer methods brusseau et al 2020a guo et al 2020 both of which were reported to be more representative than the awi area measured by gas based interfacial tracer methods for transport processes in the aqueous phase lyu et al 2018 brusseau et al 2019 guo et al 2020 for hayhook only aaw data obtained by the gas based iptt was available peng brusseau 2005 the gas iptt measured awi areas are generally greater than those measured by the aqueous interfacial tracer based method because a gas phase surfactant tracer can access more awi areas likely due to its greater mobility brusseau et al 2020a jiang et al 2020a the measured aqueous iptt aaw data for accusand and vinton are presented in fig 1 the measured gas iptt aaw data for accusand vinton and hayhook are presented in fig c 2 in appendix c assuming that the aaw measured by the gas iptt and the aqueous iptt differ by constant ratios for a porous medium we estimate the aqueous iptt aaw for hayhook as aaw hayhook 2 3aaw vinton to test if the scaling estimate is reasonable we then independently estimated the aqueous iptt aaw for accusand as aaw accusand 0 46aaw vinton the independently estimated aqueous iptt aaw for accusand was shown to match with the measured values well which demonstrates that the scaling estimate appears to be a reasonable approach when no directly measured data are available other approaches may be used to determine awi area such as the thermodynamic approach that estimates the awi area using the swc morrow 1970 bradford leij 1997 bradford et al 2015 however we note that the awi area estimated using the thermodynamic approach is generally lower than that measured by the interfacial tracer methods jiang et al 2020 which is also the case for the soil media and the interfacial tracer measured awi areas used in the present study the saturated hydraulic conductivity for hayhook k s hayhook e s t i m a t e d was estimated using the rosetta model schaap et al 2001 with 85 5 of sand 4 3 of silt and 10 2 of clay russo et al 2010 to ensure that the estimated saturated hydraulic conductivity for hayhook is consistent with those of the other porous media we obtain an estimated saturated hydraulic conductivity for vinton k s vinton e s t i m a t e d with 96 of sand 1 5 of silt and 3 of clay brusseau et al 2019b using rosetta and obtain k s hayhook using the following scaling k s hayhook k s hayhook e s t i m a t e d k s vinton e s t i m a t e d k s vinton m e a s u r e d the high k sand is assigned a saturated hydraulic conductivity ks that is significantly higher than that of the other three porous media e g it is approximately 78 5 times that of the ks for accusand the saturated water content and the residual water content are set to θ s 0 4 and θ r 0 02 respectively the swc curve and relative permeability are assumed to also follow the van genutchen mualem models with α 0 1 cm 1 and n 5 the organic carbon content foc is set to one tenth of that for accusand the aaw for the high k sand is supposed to be significantly lower than those of the other three porous media we assume that its aaw is one tenth of that for accusand at the same water saturation leading to a maximum aaw of 63 16 cm2 cm3 at sw 0 002 the above parameters for the high k sand are considered as the base case to examine the sensitivity of pfas leaching to the two parameters ks and aaw of the high k sand we consider a wider range of values for ks 1 3ks to 3ks and aaw 3aaw to 1 3aaw and compare them with the base case 3 2 representative pfas we consider two representative pfas pfos long chain and pfpea perfluoropentanoic acid c5hf9o2 short chain that have been widely found at contamination sites baduel et al 2017 brusseau et al 2020b dauchy et al 2017 høisæter et al 2019 houtz et al 2013 sepulvado et al 2011 as a long chain pfas pfos has a stronger adsorption capacity at both solid surfaces and air water interfaces than that of pfpea the physicochemical and transport properties of the two pfas including the szyszkowski parameters for surface tension freundlich isotherm parameters for solid phase adsorption and the molecular diffusion coefficients are presented in table 2 the szyszkowski parameters a µmol cm3 and b were obtained by fitting to surface tension data measured in synthetic groundwater sgw brusseau van glubt 2019 the surface tension of sgw with no dissolved pfas is σ0 71 dyn cm the freundlich isotherms for pfos in both accusand and vinton were obtained from prior sorption experiments reported in brusseau 2020 and brusseau et al 2019a because no solid phase adsorption data are available for pfpea we estimated the kf and n parameters from the measured freundlich isotherms of pfoa using the qspr method developed by brusseau 2019 similarly we used the same qspr method to estimate the freundlich isotherms for pfos and pfpea in hayhook and high k sand because pfos and pfpea are both anionic pfas for which the solid phase adsorption is dominated by hydrophobic interactions with the organic carbon content brusseau 2018 guelfo higgins 2013 we assume that kf scales with the organic carbon content among the different porous media for example for pfos in hayhook k f hayhook k f vinton f o c hayhook f o c vinton the n values for hayhook and high k are assumed to be the same as those for vinton and accusand respectively the molecular diffusion coefficient d 0 cm2 s for pfos and pfpea were obtained from laboratory measurements reported in schaefer et al 2019 finally because the change of contact angle is expected to be relatively small for anionic surfactants especially at relatively low aqueous concentrations relevant to pfas contaminated sites desai et al 1992 kissa 2001 rosen kunjappu 2012 we assume that the contact angle does not change i e γ γ0 and cos γ cos γ0 1 note that for cationic zwitterionic or nonionic pfas that interact more strongly with soil grain surfaces the change of contact angle may need to be accounted for especially at higher aqueous concentrations desai et al 1992 henry smith 2003 mw g mol is the molecular weight of the pfas molecules 3 3 climatic boundary conditions we employ the precipitation and evapotranspiration data from a humid region represented by the site of silas little clark 2004 in new jersey usa the data are from 01 01 2005 to 12 31 2014 for 10 years and are available from the ameriflux database https ameriflux lbl gov the 30 min resolution of the original data is smoothened to an 8 hour resolution the 10 year data were repeated 7 times to generate a data set covering 80 years the mean annual precipitation and potential evapotranspiration are 1 066 mm and 674 mm respectively all of the precipitation is assumed as rainfall for simplicity i e we do not distinguish snow from rainfall the evapotranspiration data is treated as the potential evapotranspiration to determine the surface evaporation fluxes additional details for the determination of the evaporation fluxes were reported in guo et al 2020 4 numerical simulation and results we apply the 3d model presented in section 2 to investigate the lateral spreading and vertical leaching of pfas in the vadose zone as impacted by sif and subsurface heterogeneities we consider the release of pfas to the vadose zone at a model fta site and construct two sets of scenarios one involves a homogeneous vadose zone and the other considers several typical types of heterogeneities in a heterogeneous vadose zone the following is applied to all of the scenarios 1 the fta to which diluted afff solutions are directly released has dimensions of 30 m 30 m 2 the vadose zone is assumed to have a depth of 4 m the depth to groundwater table is assumed to be deeper than 4 m so a free drainage condition for water flow and a zero gradient concentration condition for pfas transport are employed at the bottom boundary 3 two periods in time are simulated including an active contamination period of 30 years when the release of diluted afff solutions occurs regularly due to fire training and a subsequent post contamination period of 50 years during which the fire training stops and no pfas are released to the vadose zone 4 real world high resolution rainfall and evapotranspiration data are applied at the top boundary see more details of the data in section 3 3 during the active contamination period the diluted afff solution is applied to the fta once per 10 days representing a fire training event the training frequency is within the range of approximately 12 to 44 times per year reported in the literature e g rotander et al 2015 apex 2017 each application is assumed to last for 30 minutes at a rate of 22 mm d the diluted afff solution released from fire training makes up 17 mm of water per unit area added to the fta each year the diluted afff solution is assumed to contain pfos and pfpea at concentrations of 100 mg l and 0 528 mg l høisæter et al 2019 respectively if not otherwise specified 5 the initial water pressure head of the domain is h 0 100 cm and the domain is assumed initially pfas free i e c 0 0 6 convergence tests have been conducted for the numerical discretizations and all of the numerical solutions have converged in the following subsections we present more specifics for the scenarios which will be followed by detailed simulation results and analysis 4 1 scenario 1 impact of surfactant induced flow on pfas leaching in this scenario we focus on examining the impact of sif on pfas leaching in a homogenous vadose zone in particular we quantify 1 the potential acceleration of vertical leaching and 2 the strength of lateral spreading resulting from the sif as shown in fig 2 we consider a cross sectional domain 30 m 4 m of a homogeneous vadose zone represented by one of the three porous media i e accusand vinton and hayhook we assume that the fta is symmetric and thus only simulate half of the fta by imposing a no flux condition on the left boundary fire training occurs at the upper boundary covering 0 x 15 m in addition to considering pfos of 100 mg l and pfpea of 0 528 mg l in the afff solution we also simulate another case with pfos at a much higher concentration of 1 000 mg l which can be considered as an upper limit for the pfos concentration in the diluted afff solutions applied to ftas houtz et al 2013 guo et al 2020 finally a non reactive tracer at a concentration of 0 528 mg l is also simulated for comparison the 2d domain is discretized using uniform grid cells x z 10 cm we present the 2d pfas plumes at t 80 years fig 3 because the presence of long chain pfos in porewater leads to much stronger sif than that of short chain pfpea we only present the plumes for pfos the simulation results from both the release concentrations of 100 mg l and 1 000 mg l in all three porous media are presented the lateral spreading of pfos is shown to be generally small the extent of spreading in the three porous media has the following order of accusand vinton hayhook and it is greater under the higher release concentration of 1 000 mg l the largest extent of spreading occurs when 1 000 mg l of pfos is applied to the accusand the plume extends 1 2 m beyond the vadose zone directly underneath the fta x 15 m which is still insignificant compared to the overall size of the plume in the lateral direction to quantify the impact of sif we turn off the change in surface tension i e set σ σ0 and perform another set of simulations for comparison the results show that sif has a relatively minor impact i e the pfos plumes with and without accounting for sif are similar fig 3 to further quantify the impact of lateral spreading on pfas leaching we also conduct 1d simulations with and without accounting for sif similar to those reported in guo et al 2020 and compare the vertical concentration profiles with our 2d simulations fig 4 the concentrations from the 2d simulations are averaged along the horizontal dimension the difference between the 2d and 1d simulations is almost negligible confirming that the lateral spreading due to sif has a minimal impact on pfas leaching in addition to sif molecular diffusion and transverse mechanical dispersion can also cause lateral spreading to evaluate the extent of lateral spreading contributed solely by sif we compute and compare the mass fraction of pfas that migrates outside of the vadose zone directly underneath the fta with and without accounting for sif for both pfos and pfpea fig 5 the non reactive tracer is also presented as a reference we make the following observations 1 the lateral spreading is mainly driven by transverse mechanical dispersion due to strong porewater velocities in the vertical direction rather than sif note that molecular diffusion is negligible compared to the transverse mechanical dispersion 2 consistent with fig 3 the extent of lateral spreading follows the order of accusand vinton hayhook this is because the lateral spreading is mainly caused by transverse mechanical dispersion and that the vertical porewater velocities for accusand vinton hayhook see their ks in table 1 3 among the three porous media the lateral spreading due to sif is the weakest in hayhook a closer inspection reveals that the aqueous concentration of pfos is the smallest in hayhook the majority of pfos is adsorbed at solid surfaces and air water interfaces due to strong solid phase and awi adsorption a lower aqueous concentration leads to weaker sif for example the maximum aqueous concentration is 11 mg l for accusand 10 mg l for vinton and 4 5 mg l for hayhook at t 10 years when pfos is applied at 1 000 mg l 4 though lateral spreading due to sif is measurable for the release concentration 1 000 mg l for pfos approximately 5 5 it is much smaller for pfos at the release concentration of 100 mg l 1 2 for all three porous media and also for pfpea 0 1 for all three porous media in particular the spreading of pfpea is almost identical to that of the non reactive tracer indicating that sif has no impact on the lateral spreading of pfpea 4 2 scenario 2 subsurface heterogeneities in this scenario we simulate pfas leaching in the vadose zone in the presence of three typical types of subsurface heterogeneities to accurately represent the heterogeneities in our numerical discretization we focus on subdomains of a vadose zone directly underneath the fta to allow for a higher spatial numerical resolution the schematics and the spatial arrangement of the heterogeneity inclusions for the three test cases are presented in fig 6 more specific information about the heterogeneities for each set of the test cases is provided below 4 2 1 soil layering and lens a soil lens or a fully extended layer is embedded in an otherwise homogeneous vadose zone composed of the vinton soil fig 6a an x z cross sectional domain of 5 m 4 m is considered the soil lens is elliptic center x z 2 5 m 1 5 m major axis 4 m minor axis 1 m alternatively we consider a fully extended horizontal layer at 1 z 2 m the lens or layer is represented by one of the three porous media i e accusand vinton and hayhook leading to a set of five test cases homogeneous vinton vinton with an embedded lens or layer of accusand and vinton with an embedded lens or layer of hayhook the 2d domain is discretized using uniform grid cells x z 5 cm we present the time dependent vertical total concentration profiles fig 7 and the cumulative breakthrough curves cbtcs fig 8 i e the cumulative mass of pfos and pfpea leaching through the bottom of the domain for all five test cases the 1d vertical concentration profiles were obtained by averaging the 2d plumes along the x axis in addition we also present the spatial distributions of water pressure head h water saturation sw awi area aaw and total concentration ctot fig 9 comparisons of the vertical concentration profiles in fig 7 show that the inclusion of a heterogeneous soil lens or a layer in an otherwise homogeneous vadose zone significantly influences the leaching behavior of pfas this is partly due to the fact that the strengths of both solid phase and awi adsorption for pfas in vinton are stronger than that in accusand while weaker than that in hayhook notably the leaching of both pfos and pfpea is shown to be faster in the presence of a lens than that in the presence of a fully extended layer despite that they are composed of the same soil medium these observations are confirmed by the arrival times ta defined as the time at which pfas reaches the bottom of the domain shown in the cbtcs fig 8 for pfos in the homogeneous vinton ta 59 years the presence of an accusand lens leads to a significantly earlier arrival ta 34 years that is even 19 years earlier than that for a fully extended accusand layer ta 53 years the presence of a lens and a fully extended layer of hayhook leads to an arrival time of ta 54 years and ta 62 years respectively even though the presence of either a hayhook lens or a fully extended layer enhances the overall retention fig 8 it is rather interesting that a hayhook lens leads to an arrival time of 5 years earlier ta 54 years than that for the homogeneous case which indicates the presence of some type of preferential transport similar trends discussed above can be observed in the arrival times of pfpea a closer inspection reveals that the above mentioned different behaviors for the transport of pfas between the inclusion of a lens and a fully extended layer are caused by the so called funneled flow i e one type of preferential flow generated by the presence of the lens kung 1990a b for pfas in particular it is quite interesting that the funneled flow not only introduces preferential transport of pfas by advection and dispersion but also amplifies leaching by reducing the strength of awi adsorption a more detailed analysis is provided below when a lens of accusand is embedded in an otherwise homogeneous vadose zone comprised of vinton water accumulates above the vinton accusand interface before it can enter the underlying accusand the matrix potential in the accusand is greater than that in the vinton see the second plot in row 1 of fig 9 the accumulated water then moves around the accusand lens partly facilitated by the slopes which eventually leads to preferential flow pathways see column 2 of fig 9 a hayhook lens also introduces funneled flow though the mechanism is slightly different water moves around the hayhook lens resulting from its low hydraulic conductivity that makes water difficult to infiltrate note that the preferential flow generated by the hayhook lens is much less profound than that by the accusand lens like other solutes the funneled flow leads to preferential transport of pfas by advection and dispersion however what is unique about pfas is that the preferential flow leads to greater water saturation that subsequently destructs awi areas along the pathway see the second and fourth plots of row 3 fig 9 because the awi area is a primary retention process for pfas especially the long chain ones the destruction of awi areas on the preferential flow pathway further contributes to accelerating the leaching of pfas this mechanism can be illustrated by comparing the accelerated leaching of pfos to that of pfpea namely awi adsorption plays a much more important role in the retention of the long chain pfos the funneled flow caused by the lens of accusand and hayhook leads to greater acceleration of leaching for pfos than that for pfpea as demonstrated by the arrival times presented in fig 8 the other interesting finding unique to pfas is that the presence of accusand and hayhook either as a lens or a fully extended layer accelerates the leaching of pfos in the region above them but not for pfpea fig 7 shows that the mass of pfos in the first meter is smaller when a lens or a fully extended layer of accusand or hayhook is present conversely the mass of pfpea in the first meter increases in the presence of accusand or hayhook this is because both accusand and hayhook act as barriers that lead to the accumulation of water above the vinton accusand or vinton hayhook interface i e the water saturation is greater than that for the homogeneous case the greater water saturation reduces the amount of aaw and as a result decreases the retention of pfos in the vinton above conversely because awi adsorption does not play a major role in the retention of pfpea water accumulating at the vinton accusand or vinton hayhook interface leads to more pfpea in the aqueous phase accumulating above accusand or hayhook 4 2 2 high conductivity pathways we simulate pfas leaching in the presence of well connected high conductivity pathways that are composed of the high k sand fig 6b all of these high k sand channels have a width of 5 cm in addition to the base simulations using the parameters presented in table 1 we also perform a sensitivity analysis by conducting additional simulations using a wider range of values for ks and aaw of the high k sand 1 3 and 3 times of the base values of these two parameters are used in the sensitivity analysis the domain is discretized using uniform grid cells x z 2 5 cm the time dependent vertical total concentration profiles averaged from the 2d plumes along the x axis fig 10 and the cbtcs fig 11 demonstrate that the high conductivity pathways lead to much earlier arrival of pfas at the bottom of the domain especially for the long chain pfos pfos arrives at the bottom of the domain at ta 4 years in the presence of the high conductivity pathways which is approximately 1 15 of that for the homogenous case ta 59 years due to minimal retention from solid phase and awi adsorption the arrival time for the short chain pfpea is short for the homogeneous case ta 1 23 years however the presence of the high conductivity pathways further reduces it to ta 0 05 years though the high conductivity pathways lead to the early arrival of pfas at the bottom of the domain they also provide shortcut circuiting channels that can make the leaching of pfas in the surrounding lower conductivity regions less effective especially during the post contamination period this phenomenon can be observed in the vertical concentration profiles in fig 10 as well as the 2d concentration distributions in fig 12 the vertical concentration profiles show that more pfos and pfpea remain in the shallower vadose zone 0 z 1 m and 0 z 2 5 m respectively during the post contamination period t 30 years in the presence of the high conductivity channels when compared to the homogeneous case a closer inspection of the 2d concentration distributions fig 12 reveals that during the active contamination period some pfas have entered the lower conductivity regions driven by advection due to the presence of the preferential pathways provided by the high k sand channels leaching of pfas in those regions is less effective compared to that of the homogenous case finally the sensitivity test cases using a wider range of values for the hydraulic conductivity and awi area for the high k sand show a minimal difference from the base simulations figs 10 and 11 this demonstrates that the overall leaching behaviors for both pfos and pfpea observed above are robust for a relatively wide range of high k sand provided that the high k sand has a greater conductivity and weaker adsorption capacities than that of vinton 4 2 3 random heterogeneity in this final set of test cases we simulate pfas leaching in the presence of much more complex 3d heterogeneities that follow a random distribution fig 6c the 3d domain has dimensions of 1 m 1 m 4 m and is discretized using uniform grid cells x y z 10 cm we use the gaussian kriging variogram model in the gstat package pebesma 2004 to generate 3d random fields with the following parameters nugget 0 sill 10 cm correlation lengths 40 cm and 4 cm in the horizontal and vertical directions the correlation lengths are within the range reported in the literature e g russo 1991 tseng and jury 1993 the maximal number of nearest observations 100 and maximal distance from the prediction location used for prediction 50 cm note that the correlation lengths are used for illustrative purposes other correlation lengths will likely lead to different quantitative leaching behaviors but as long as preferential flow pathways are present accelerated pfas leaching due to reduced air water interfacial adsorption as demonstrated in sections 4 2 1 and 4 2 2 will occur the random values are then normalized into the range from 0 to 1 we then uniformly divide the cumulative density function into four intervals assign them to the four soils i e high k sand accusand vinton and hayhook as demonstrated in fig 6 c three different sets of fractions among the four porous media are considered 0 3 and 10 are assigned to the high k sand respectively and the remaining portions are equally assigned to the other three porous media for each set of fractions we generate 8 realizations to conduct sensitivity analysis finally we note that because the spatial heterogeneities have been explicitly represented in the 3d domain we employ a lower dispersivity coefficient α l 2 cm in each homogeneous soil medium in the simulations we present the time dependent vertical total concentrations profiles averaged from the 3d plumes along the x y plane fig 13 and the cbtcs fig 14 for the 24 simulations conducted using the randomly generated heterogeneous domains that contain 0 3 and 10 of high k sand each has 8 realizations the simulation results conducted using the homogeneous porous media i e accusand vinton and hayhook are also presented for comparison for pfos the presence of high k sand has a significant impact on its long term leaching behavior with 0 of high k sand the differences among the concentration profiles from the 8 heterogeneous realizations are minor and all of them are bounded by the concentration profiles of the homogenous hayhook and accusand cases fig 13 the arrival times for the 8 realizations vary from 43 to 76 years only 0 1 to 1 9 of the total pfos has been discharged from the bottom of the domain at t 80 years fig 14 however the addition of 3 high k sand greatly accelerates the leaching process and leads to much more significant variations among the 8 realizations the arrival times are reduced to 10 to 66 years the earliest arrival time is more than 24 years earlier than that for the homogenous accusand case for this realization more than 93 of total pfos has been discharged from the bottom of the domain at t 80 years fig 14 when the fraction of the high k sand is further increased to 10 the leaching becomes even faster and much greater variations are observed among the 8 realizations the arrival times are reduced to 3 to 27 years in the realization where leaching occurs the fastest 100 of the total pfos has been discharged from the bottom of the domain at t 40 years these synthetic simulations illustrate that even the presence of a small fraction of high conductivity media can greatly accelerate the leaching of pfos i e long chain pfas in the vadose zone conversely the presence of the high k sand shows a minimal impact on the long term leaching of the short chain pfpea which is consistent with the findings reported in sections 4 2 1 and 4 2 2 this is because the short chain pfpea is minimally retained in any of the four porous media accusand vinton hayhook and high k sand and as a result the different heterogeneity realizations generated using these four porous media do not significantly change the overall retention capacity for pfpea in the vadose zone finally we present the 3d plumes to further illustrate and visualize the impact of the high k sand on the leaching of pfos and pfpea in the vadose zone a realization with no inclusion of high k sand and a realization with 10 of high k sand the one that leads to the fastest leaching are shown as examples fig 15 the comparisons between the 3d plumes confirm that the presence of high k sand significantly accelerates the migration and leaching of the long chain pfos while it has a minimal impact on that of the short chain pfpea in the realization with 10 of high k sand the high k sand forms well connected channels that provide preferential pathways for the leaching of pfos however these preferential pathways appear to be much less effective for pfpea primarily because the retention capacity of the other three porous media for pfpea is already minimal as was discussed above 5 discussion we have developed a new 3d model that represents the coupled variably saturated flow and transport processes relevant to pfas retention and leaching in the vadose zone including sif and nonlinear adsorption of pfas at the solid surfaces and air water interfaces the newly developed multidimensional modeling framework allowed us to conduct a series of numerical experiments to investigate the impact of two critical factors sif and subsurface heterogeneities on the long term leaching of pfas in the vadose zone a prior study employing a 1d model guo et al 2020 showed that the enhanced vertical drainage resulting from sif has a negligible influence on the long term leaching of pfas however it remains unclear as to whether the lateral spreading of pfas plumes caused by sif will lead to potentially enhanced retention of pfas in the vadose zone in the present work we demonstrate that sif has a minimal impact either via enhanced vertical drainage or lateral spreading on the long term leaching of pfas our 2d numerical experiments section 4 1 show that even at the higher end release concentration of 1 000 mg l only 5 5 of pfos migrated outside the vadose zone directly underneath the fta at t 80 years notably sif only contributed to less than 1 3 of the 5 5 the remaining 4 2 was caused by transverse mechanical dispersion in the lateral dimension the reason for the minimal impact of sif is the relatively low aqueous concentration of pfas in porewater though pfas can be released at relatively high concentrations especially at ftas after entering the vadose zone the majority of long chain pfas the ones that are more surface active and can modify surface tension are adsorbed at air water interfaces and solid surfaces this mass partitioning due to solid phase and awi adsorption significantly reduces the aqueous concentrations in porewater and as a result reduces the change in surface tension for example the maximum aqueous concentrations of pfos for the simulations conducted under all conditions in section 4 1 are less than 15 mg l even though pfos was released at a concentration of 1 000 mg l the minimal impact of the sif has been further confirmed by excellent agreement among the vertical concentration profiles simulated by the 2d model and those by the 1d model with and without accounting for sif the 2d and 3d numerical experiments for heterogeneous vadose zones section 4 2 show that subsurface heterogeneity can be a primary factor that contributes to the early arrival of long chain pfas in groundwater we illustrate that the presence of soil lenses and high conductivity channels generates preferential pathways for flow and transport that can lead to the earlier arrival of pfas compared to that of pfas leaching in a homogeneous vadose zone this suggests that the presence of subsurface heterogeneity is a plausible explanation for the early arrival of pfas in the deep vadose zone or groundwater at tens to a hundred meters observed at some contaminated sites brusseau et al 2020 dauchy et al 2019 afw 2019 for example dauchy et al 2019 reported deep seepage of both short chain and long chain pfas to the groundwater below a depth of 15 m at an fta site in france despite the presence of multiple clay layers similarly at an air force base in tucson az long chain pfas reached a depth of over 70 m through a thick vadose zone afw 2019 while the above field evidence shows a significant deviation of pfas leaching rate from the simulation results based on homogeneous soils the early arrivals appear to be consistent with our model simulations that have explicitly represented subsurface heterogeneities while preferential flow and transport resulting from soil lenses or high conductivity pathways have been widely reported for other non pfas contaminants in the vadose zone and groundwater e g brusseau rao 1994 bekhit hassan 2005 köhne et al 2006 2009 kung 1990a 1990b šimůnek et al 2003 zhou zhan 2018 our simulations have revealed some interesting behaviors unique to pfas for example the preferential flow pathways generated by the presence of the soil lens i e funneled flow not only leads to preferential transport of pfas by advection and dispersion like for nonreactive solutes but also reduces the strength of retention for pfas that further enhances preferential transport the reduced retention as analyzed in section 4 2 1 is caused by the increased water saturation along the preferential flow pathways that destructs awi areas and hence decreases awi adsorption another interesting behavior is that the spatial heterogeneity influences the long term leaching of long chain pfas much more strongly than their short chain counterparts which is illustrated by the 2d experiments in sections 4 2 1 4 2 2 as well as the 3d numerical experiments conducted using randomly distributed heterogeneities in section 4 2 3 this difference between the long chain and short chain pfas may be attributed to two factors and both of which are a direct result of the long chain pfas being more strongly adsorbed at solid surfaces and air water interfaces namely for the long chain pfas the preferential transport pathways are amplified due to reductions in awi area and the differences in the adsorption capacities among the different soil media have a more significant impact on the overall retention these pfas specific responses to subsurface heterogeneities imply that compared to other more traditional contaminants e g nonreactive solutes more significant errors especially for the long chain compounds may be introduced in the predictions of long term leaching of pfas if subsurface heterogeneities are not fully represented in the numerical model we comment on some assumptions employed in our simulations and how they may potentially influence the results as presented in section 2 1 2 our model assumes equilibrium adsorption on solid grain surfaces and air water interfaces prior miscible displacement experiments indicate that rate limited adsorption is likely insignificant under field scale conditions where porewater velocities are much lower than the typical porewater velocities used in column experiments brusseau 2020 brusseau et al 2019b a recent study of batch experiments showed that kinetic solid phase desorption may be more pronounced in field aged soils especially for shorter chain pfas schaefer et al 2021 when rate limited adsorption is present pfas leaching may be enhanced during the active contamination period due to rate limited adsorption while reduced during the post contamination period due to rate limited desorption the relative importance of solid phase adsorption will depend on the specific soil media and pfas under consideration the foc values used in our study are relatively low compared to those for surface soils however since foc generally decreases rapidly along depth elzein balesdent 1995 jobbágy jackson 2000 the foc especially those for vinton soil and hayhook soil should be representative for soils and sediments in the deeper vadose zone approximately 1 m below the land surface we recognize that foc in the first meter below the land surface may be much greater than the foc employed in the present study additionally more complex sorption processes such as electrostatic interactions may lead to enhanced solid phase adsorption in particular for cationic and zwitterionic pfas barzen hanson et al 2017 mejia avendaño et al 2020 nickerson et al 2020 xiao et al 2019 under these conditions our simulations would overestimate pfas leaching the simulations conducted in the present study assume that each homogeneous soil medium is isotropic anisotropy with greater kxx or kyy than kzz would in general lead to greater lateral spreading of the plume in a homogeneous vadose zone greater lateral spreading will reduce pfas leaching in the vertical direction while in a heterogeneous vadose zone greater lateral spreading may help the pfas find preferential flow pathways and hence enhance leaching however when heterogeneities are explicitly represented like in the simulations presented in section 4 3 the domain becomes effectively anisotropic and hence would partially account for anisotropy another assumption employed in the simulations is the spatially uniform pfas loading at the upper boundary spatial variation in pfas loading rate may lead to spatially heterogeneous leaching rates locations with greater pfas loading rates will likely have greater leaching rates resulting from reduced solid phase and air water interfacial adsorption finally we comment on the two numerical schemes i e fi and si employed to couple the transient variably saturated flow and pfas transport equations in our modeling framework both of these two coupling schemes are shown to provide convergent solutions the nonlinear iteration loops for the fi method were shown to converge faster than that of the si method for the simulations conducted in the present work though the single linear jacobian matrix in the fi scheme requires a preconditioner for improved convergence if iterative linear solvers are used and accuracy properties benzi 2002 our observations are consistent with a recent numerical analysis of the iterative schemes for the coupling between surfactant transport and variably saturated flow illiano et al 2020 note that awi adsorption and solid phase adsorption were not accounted for in the model formulation of illiano et al 2020 6 conclusions in the present study we have developed a multidimensional numerical modeling framework to simulate pfas transport and leaching in the vadose zone the model formulation represents transient variably saturated flow pfas advective and dispersive transport nonlinear solid phase and awi adsorption and sif the coupled flow and transport equations are solved using a fully implicit or a sequential implicit framework either of which was shown to give convergent solutions employing the newly developed multidimensional modeling framework we have conducted a series of numerical experiments at model fta sites to understand and quantify the impact of sif and subsurface heterogeneities on the long term leaching of pfas in the vadose zone a long chain pfos and a short chain pfpea pfas that are commonly found at contaminated sites are used as examples to examine the influence of chain length on the leaching behavior all of the simulations last for 80 years including 30 year active contamination due to regular fire training activities and 50 year post contamination when fire training activities have been stopped our simulation results and analyses lead to the following conclusions 1 sif resulting from the change of surface tension due to the presence of pfas in porewater has a minimal impact on the long term retention and leaching of pfas in the vadose zone this has been confirmed by both 1d simulations that account for the induced drainage in the vertical dimension as well as 2d simulations that further represent the induced lateral spreading of the pfas plume the primary reason is that though pfas may be released at high concentrations e g at fta sites their aqueous concentration decreases significantly after entering the vadose zone due to strong adsorption at the solid surfaces and air water interfaces the relatively low aqueous concentrations have a relatively minimal impact on the porewater surface tension overall our simulations imply that it may be acceptable to decouple the richards equation and the pfas transport equations i e assuming no sif when focusing on the long term retention and leaching of pfas in the vadose zone 2 subsurface heterogeneity is a primary factor that controls the retention and leaching of pfas in the vadose zone the presence of heterogeneity generates preferential pathways for flow and transport that can lead to much earlier arrival of pfas at a given depth compared to that in the homogenous vadose zones 3 a unique property differentiating pfas from conventional non pfas contaminants is that preferential flow pathways can further amplify the preferential transport due to the destruction of air water interfaces by the increased water saturation we have also demonstrated that subsurface heterogeneities influence the long term leaching of the long chain pfas more strongly than that of their short chain counterparts 4 given the significant impact of heterogeneity on pfas leaching in the vadose zone our study suggests that it is essential to employ multidimensional models for studying the pfas retention and leaching at contaminated sites where complex heterogeneities are present credit authorship contribution statement jicai zeng methodology software investigation formal analysis visualization data curation writing original draft bo guo conceptualization methodology software investigation formal analysis supervision project administration funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was in part supported by the national science foundation 2023351 and the environmental security technology certification program estcp for project er21 5041 appendices a the fi and si frameworks we introduce the numerical procedures for the fi and si frameworks employed to solve the coupled equations in the present work let f h c 0 and g h c 0 represent the spatially and temporally discretized systems of eqs 1 and 2 respectively in the fi coupling scheme we assemble the two discretized equation sets as f f g 0 and the two sets of unknown variables as φ h c in the newton raphson iteration scheme δ ϕ j 1 k 1 f ϕ j 1 k 1 f j 1 k where the superscripts j 1 and k 1 indicate the current time and iteration levels respectively more specifically δ h j 1 k 1 δ c j 1 k 1 f h f c g h g c j 1 k 1 f g j 1 k in the si coupling scheme equations f h c 0 and g h c 0 are solved separately using a newton raphson scheme that is δ h j 1 k 1 f h j 1 k c j 1 k h 1 f h j 1 k c j 1 k and δ c j 1 k 1 g h j 1 k c j 1 k c 1 g h j 1 k c j 1 k for both the fi and si coupling schemes the solutions are updated at each iteration as h j 1 k 1 h j 1 k δ h j 1 k 1 and c j 1 k 1 c j 1 k δ c j 1 k 1 until convergence i e max δ h j 1 k 1 ε h and max δ c j 1 k 1 ε c ε h and ε c are the absolute tolerances for the water pressure head and pfas concentration to ensure convergence ε h 10 3 cm and ε c 10 7 µmol cm3 are used in the present work b numerical code validation we validate our numerical implementation by comparing it to a widely used open source simulator pflotran hammond et al 2014 in the numerical experiment at t 0 a non reactive tracer at a concentration of c 0 0 5 mg l is uniformly distributed in a 1 m 1m 1m 3d domain composed of accusand the domain is discretized using uniform cells x y z 1 cm the water table depth is 90 cm and is kept constant during the simulation the initial water pressure head is hydrostatic the four side boundaries are all set as no flux boundaries for water flow and solute transport at the center of the top boundary starting at t 0 constant infiltration of clean water at 1 cm d is applied to a 10 cm 10 cm square area and lasts for 48 hours the rest of the top boundary is set to zero flux the 3d spatial distributions of water pressure head h water saturation sw and aqueous concentration c are computed the cross sections of these distributions at y 49 5 cm at the end of simulation using results computed from our code and pflotran are presented in fig b 1 excellent agreement between the results from the two codes is observed c additional data and parameters for the four porous media supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2021 104015 appendix supplementary materials video for the transport of pfos in the vadose zone with a lens or layer video for the transport of pfpea in the vadose zone with a lens or layer video for the transport of pfos in the vadose zone with high conductivity pathways video for the transport of pfpea in the vadose zone with high conductivity pathways 
261,pfas are emergent contaminants of which the fate and transport in the environment remain poorly understood as surfactants adsorption at air water and solid water interfaces in soils complicates the retention and leaching of pfas in the vadose zone recent modeling studies accounting for the pfas specific nonlinear adsorption processes predicted that the majority of long chain pfas remain in the shallow vadose zone decades after contamination ceases in agreement with many field measurements however some field investigations show that long chain pfas have migrated to tens to a hundred meters below ground surface these discrepancies may be attributed to model simplifications such as a one dimensional 1d homogeneous representation of the vadose zone another potentially critical process that has not been fully examined by the 1d models is how surfactant induced flow sif influences pfas leaching in multidimensions we develop a new three dimensional model incorporating the pfas specific flow and transport processes to quantify the impact of sif and subsurface heterogeneities our simulations and analyses conclude that 1 sif has a minimal impact on the long term leaching of pfas in the vadose zone 2 preferential flow pathways generated by subsurface heterogeneities lead to early arrival and accelerated leaching of especially long chain pfas 3 the acceleration of pfas leaching in high water content preferential pathways or perched water above capillary barriers is more prominent than conventional contaminants due to the destruction of air water interfaces and 4 subsurface heterogeneities are among the primary sources of uncertainty for predicting pfas leaching and retention in the vadose zone graphical abstract image graphical abstract keywords surfactant induced flow preferential flow heterogeneity air water interfacial adsorption solid phase adsorption vadose zone 1 introduction per and polyfluoroalkyl substances pfas are a group of synthetic chemicals that have been widely used since the 1940s in many industrial and consumer products including nonstick and stain resistant coatings food containers paper products and fire fighting foams buck et al 2011 itrc 2018 wang et al 2017 resulting from large scale manufacturing and wide use of pfas in the past 80 years they are now ubiquitous in the environment e g soils groundwater sediments and surface water and have become emerging contaminants of international concern e g brusseau et al 2020b hatton et al 2018 hu et al 2016 sharifan et al 2021 the scientific understanding of the fate and transport of pfas in the environment especially in source zones under water unsaturated conditions is still in its infancy a growing body of field data demonstrates that pfas concentrations in soils are orders of magnitude up to seven orders of magnitude higher than those in groundwater beneath the source zones and that the majority of pfas remains near the top of the vadose zone anderson et al 2016 2019 brusseau et al 2020b dauchy et al 2019 mcguire et al 2014 xiao et al 2015 adamson et al 2020 however it remains poorly understood as to what primary mechanisms are controlling the long term retention of pfas in the vadose zone and the subsequent mass discharge to groundwater over time many pfas are surfactants kissa 2001 thus they tend to adsorb at air water and solid water interfaces in soils and may stay in the vadose zone for long times before contaminating groundwater brusseau 2018 guo et al 2020 using surface tension data of two primary pfas and measured air water interfacial awi areas in soil materials brusseau 2018 examined the impact of pfas adsorption at air water interfaces as a potential retention process in soils additional surface tension based theoretical analyses covering a wider range of pfas and solution chemistry conditions have also been reported brusseau et al 2019a 2019b brusseau van glubt 2019 costanza et al 2019 silva et al 2019 schaefer et al 2019 costanza et al 2020 the impact of awi adsorption has also been investigated by miscible displacement experiments using packed columns of different soil media and water saturation conditions brusseau et al 2019a lyu brusseau 2020 lyu et al 2018 ouni et al 2021 the measured breakthrough curves were simulated by a one dimensional 1d solute transport model assuming steady state flow under a uniform water saturation that accounts for rate limited and nonlinear adsorption at solid surfaces and air water interfaces brusseau 2020 brusseau et al 2019a the above surface tension based analyses miscible displacement experiments and the 1d solute transport simulations all focused on laboratory conditions mathematical modeling of pfas transport and retention under field conditions in the vadose zone has only begun recently guo et al 2020 reported a new mathematical model that represents a comprehensive set of pfas specific transport processes including surfactant induced flow sif nonlinear and rate limited solid phase and awi adsorption under transient variably saturated water flow numerical simulations of pfos perfluorooctanesulfonic acid c8hf17o3s released at a model aqueous film forming foam afff impacted fire training area fta site and the subsequent transport and retention in the vadose zone demonstrated that pfos can be strongly retained in the vadose zone even under highly transient variably saturated flow driven by time dependent rainfall infiltration shortly thereafter a model similar to that of guo et al 2020 was also independently reported by silva et al 2020a 2020b where example simulations were presented in 1d and 2d the numerical simulations of pfas leaching in the vadose zone reported by guo et al 2020 are generally consistent with soil pfas concentration profiles measured at contaminated sites namely concentrations of long chain pfas in the soil profiles at many source zones show that the majority of the total mass stays in the shallow vadose zone i e the first meter or two brusseau et al 2020 dauchy et al 2019 davis et al 2007 filipovic et al 2015 hale et al 2017 shin et al 2012 and the concentration decreases exponentially along with the depth brusseau et al 2020b however despite that most of the long chain pfas were reported to stay in the shallow vadose zone they have been observed in deep vadose zones and groundwater at many sites even tens or a hundred meters below the land surface brusseau et al 2020 dauchy et al 2019 afw 2019 this discrepancy between the model simulations and the field data implies that additional processes and factors not incorporated in the prior modeling studies are likely influencing the leaching of pfas in the vadose zone a potentially important factor is the subsurface heterogeneities such as macropores high conductivity channels or fractures soil lenses or layers which were widely reported to provide preferential pathways for the transport and leaching of non pfas solutes and contaminants in the vadose zone and groundwater e g brusseau rao 1990 bekhit hassan 2005 köhne et al 2006 2009 kung 1990a 1990b šimůnek et al 2003 zhou zhan 2018 another important factor that has not been fully examined is the impact of sif on pfas leaching prior experimental and modeling studies on non pfas surfactants showed that surfactant induced capillary pressure gradient can strongly influence variably saturated flow and solute transport in the vadose zone smith and gillham 1994 1999 henry et al 2002 karagunduz et al 2015 it is anticipated that similar effects of sif may be observed for pfas in source zones specifically decreases in surface tension resulting from pfas being present in porewater can cause induced drainage that on the one hand accelerates the transport of pfas in the vertical direction due to increased porewater velocities while on the other hand also leads to lateral spreading of pfas that can potentially reduce vertical leaching concomitantly surfactant induced drainage also reduces water saturation resulting in an increase in the awi area which would then increase the retention of pfas due to stronger awi adsorption it remains unclear as to how the above mechanisms will manifest to influence pfas leaching in the vadose zone systematic investigations of the impact of both subsurface heterogeneity and sif on pfas leaching require more advanced models that represent flow and transport processes in multiple dimensions to address the critical questions regarding sif and subsurface heterogeneity we extend the model formulation of guo et al 2020 to develop a three dimensional 3d model that represents the transient variably saturated flow sif and the comprehensive set of pfas specific transport processes in the vadose zone and groundwater we apply the new model to simulate contamination scenarios at a model afff impacted fta site a set of comprehensive numerical experiments are designed to examine the impact of sif and subsurface heterogeneities on pfas leaching and mass discharge to deep vadose zones or groundwater several types of typical subsurface heterogeneities are considered including soil lenses high conductivity pathways and randomly distributed soil media in space to the best of our knowledge this is one of the first 3d models for pfas transport in the vadose zone and multidimensional numerical simulation study of pfas retention and leaching in the vadose zone accounting for a wide range of subsurface heterogeneities the multidimensional mathematical formulations and the numerical framework are presented in section 2 in section 3 data and parameters used for modeling pfas transport are introduced this is followed by section 4 that presents detailed descriptions of numerical experiments and analyses of the simulation results in section 5 we discuss the implications of our findings we close with concluding remarks in section 6 2 mathematical model and numerical framework 2 1 mathematical model 2 1 1 variably saturated flow the variably saturated water flow in the subsurface may be described by the richards equation richardson 1921 richards 1931 which incorporates the extended darcy s law for variably saturated flow buckingham 1907 in the mass balance equation of the water phase here we present the richards equation in 3d 1 θ t k s k r θ h z 0 where θ is the volumetric water content cm3 cm3 h is the water pressure head cm t is time s the vertical axis z is positive downward k s is the tensor for saturated hydraulic conductivity and kr is the relative permeability parameterized as a function of θ the relative permeability function of mualem 1976 and van genuchten 1980 is used we assume that the off diagonal entries of k s are zero kij 0 for i j and that the porous medium is isotropic k 11 k 22 k 33 ks 2 1 2 pfas transport the transport and retention of a pfas in the subsurface may be described by the 3d advection dispersion equation coupled with adsorption at the solid surfaces and air water interfaces e g guo et al 2020 2 θ c t ρ b c s t c a w t θ v c θ d c 0 where c is the aqueous concentration µmol cm3 ρ b is the bulk density of the porous medium g cm3 v q θ is the vector for the interstitial porewater velocity cm s where q k s kr h z is the darcy flux cm s the hydrodynamic dispersion tensor d is the sum of the mechanical dispersion and molecular diffusion coefficients cm2 s which for an isotropic porous medium can be given by d α t v i α l α t vv v τ d 0 i bear 1988 where i is the identity matrix α l cm and α t cm are longitudinal and transverse dispersivities respectively d 0 is the molecular diffusion coefficient in free water cm2 s τ θ 7 3 θ s 2 is the tortuosity factor for the water phase millington quirk 1961 where θ s is the saturated volumetric water content cm3 cm3 cs µmol g is the solid phase adsorption which is modeled by the freundlich isotherm cs kfcn based on laboratory measurements brusseau 2020 brusseau et al 2019b higgins luthy 2006 wei et al 2017 where kf and n are fitting parameters caw is the awi adsorption µmol cm3 caw aaw γ here γ kawc is the surface excess of pfas at the air water interfaces µmol cm2 kaw is the awi adsorption coefficient cm3 cm2 we parameterize aaw as a function of water saturation i e a a w x 2 s w 2 x 1 s w x 0 where sw θ θ s these coefficients can be determined by fitting to awi area data measured by interfacial tracer experiments kaw can be determined via the gibbs adsorption equation k a w γ c 1 χ r t c σ ln c t e g rosen kunjappu 2012 where χ equals 1 for nonionic or ionic pfas in solutions with swamping electrolyte or 2 for ionic surfactants in solutions with no swamping electrolyte such as deionized water r 8 314 j k mol is the universal gas constant and t k is temperature σ is the surface tension of the solution which is a function of the aqueous concentration of pfas modeled by the szyszkowski equation e g adamson gast 1997 chang franses 1995 kissa 2001 rosen kunjappu 2012 σ σ 0 1 b ln 1 c a dyn cm where a µmol cm3 and b are fitting parameters to experimentally measured σ substituting the szyszkowski equation to the gibbs adsorption equation we obtain k a w 1 χ r t σ 0 b a c we assume that the solid phase and awi adsorption processes both reach equilibrium instantaneously see brusseau et al 2019b guelfo et al 2020 and zhou et al 2021 for mathematical formulations of kinetic solid phase adsorption and brusseau 2020 and guo et al 2020 for mathematical formulations of both kinetic solid phase and awi adsorption 2 1 3 coupling between the water flow and pfas transport when pfas is present in porewater the variably saturated water flow eq 1 and pfas transport eq 2 are fully coupled transient variably saturated flow drives advection and dispersion of pfas and also influences the awi adsorption by changing the awi area concomitantly changes in pfas concentration modify the surface tension and capillary forces and in turn influence the variably saturated water flow we parameterize θ as a function of h following the soil water characteristic swc function of van genuchten 1980 with pfas in the porewater we use the leverett j function to obtain a new pressure head h σ 0 σ cos γ 0 cos γ h that accounts for the change of surface tension leverett 1941 smith and gillham 1994 henry smith 2003 guo et al 2020 γ is the water contact angle σ is the surface tension in the presence of pfas in porewater and h 0 γ0 and σ0 are respectively the water pressure head water contact angle and surface tension when the pfas concentration is zero replacing h in the original swc function with the new water pressure head h leads to a modified swc function in the presence of pfas in soil porewater guo et al 2020 2 2 numerical framework we present a numerical framework to solve the mathematical formulations presented in section 2 1 i e eqs 1 and 2 subject to initial and boundary conditions we employ the cell centered finite difference in space and backward euler in time approximations to discretize both eqs 1 and 2 the mass conservative numerical scheme of celia et al 1990 is used for eq 1 for eq 2 a first order upwind scheme is used for the advection term while a central difference scheme is used for the dispersion term the top boundary of the domain allows for surface evaporation and ponding conditions using an implementation similar to that reported in guo et al 2020 we implement two numerical schemes for the coupling between eqs 1 and 2 within each numerical time step one employs a fully implicit fi framework that solves the two equations simultaneously while the other uses a sequential implicit si framework that iterates between the two equations until convergence in either case a newton raphson solver is employed to solve the resulting nonlinear system of equations the fi scheme assembles the discretized nonlinear formulations of eqs 1 and 2 and then linearizes by deriving a single jacobian matrix to solve for h and c simultaneously at each iteration level conversely the si scheme linearizes the discretized nonlinear formulations of eqs 1 and 2 separately and generates two smaller jacobian matrices one for h and the other for c an additional iteration loop is employed between the solvers for h and c at each numerical time step to ensure convergence more details for the fi and si frameworks are presented in appendix a we comment on the convergence properties of the two coupling frameworks in section 5 for the variably saturated flow and pfas transport simulations examined in the present work our overall numerical implementation utilizes the gridding and automatic differentiation utilities of the matlab reservoir simulation toolbox lie 2019 to validate the 3d implementation we have compared our model to a widely used open source simulator pflotran hammond et al 2014 excellent agreement between the two models is observed for both transient variably saturated flow and nonreactive solute transport in 3d see fig b 1 in appendix b 3 data and parameters we employ the newly developed 3d model to examine the impact of sif and subsurface heterogeneity on pfas leaching in the vadose zone three types of heterogeneities including the presence of soil lenses or layers high conductivity pathways and randomly distributed soil media are examined four different porous media covering a wide range of material properties and two representative pfas i e one is short chain and the other is long chain are used to construct the numerical experiments in the following subsections we introduce the detailed data and parameters for these porous media and pfas 3 1 porous media the four porous media that will be used for the numerical simulations are referred to as accusand vinton hayhook and high k sand i e a sand that has a greater hydraulic conductivity than the other three porous media detailed measured data and parameters are available for the first three from the literature guo et al 2020 jiang et al 2020a b peng brusseau 2005 the last high k sand is a porous medium that is hypothetically constructed to represent the preferential flow pathways accusand is a commercially available natural quartz sand unimin corp with a median grain diameter of 0 35 mm and a uniformity coefficient of 1 1 the uniformity coefficient is defined as d60 d10 where d60 and d10 are the grain diameters that are greater than 60 and 10 of the sample by weight respectively vinton and hayhook were both collected locally in tucson arizona vinton is a loamy sand it has a median grain diameter of 0 23 mm and a uniformity coefficient of 2 4 hayhook is a loam its mean grain diameter is 0 26 mm and the uniformity coefficient is 16 the difference between the uniformity coefficients indicates that hayhook has a much wider range of particle size than that of vinton even though vinton and hayhook have similar median grain sizes hayhook has many more smaller grains than vinton for example the clay content of hayhook 10 is much higher than that of vinton 3 the detailed parameters for the four porous media are summarized in table 1 the capillary pressure as a function of water content as well as the unsaturated hydraulic conductivity as a function of capillary pressure are plotted in fig c 1 in appendix c most of the parameters for accusand vinton and hayhook were determined in the laboratory the remaining parameters whose measured values are not available are estimated as follows experimental observations and pore scale models have demonstrated that the longitudinal and transverse dispersivities α l and α t are functions of the water content under unsaturated conditions e g bear cheng 2010 kirda et al 1973 maraqa et al 1997 padilla et al 1999 raoof hassanizadeh 2013 sato et al 2003 de smedt wierenga 1984 but general functional forms have not become available here we do not consider the dependence on water saturation and simply use the approximation for the longitudinal dispersivity under saturated conditions as α l 83 log10 l 100 2 414 xu eckstein 1995 where l is the apparent length scale in the present study we take l as the vertical depth of the vadose zone unless stated otherwise the transverse dispersivity α t was reported to be generally smaller than α l e g bear cheng 2010 yule gardner 1978 α t α l 10 is assumed in our simulations rockhold et al 2016 note that because the estimated α l and α t do not consider the impact of water saturation they may lead to underestimation of dispersion in the vadose zone the awi area aaw as a function of water saturation sw for both accusand and vinton was fitted to measured values obtained by the aqueous based interfacial partitioning tracer test iptt and mass balance surfactant tracer methods brusseau et al 2020a guo et al 2020 both of which were reported to be more representative than the awi area measured by gas based interfacial tracer methods for transport processes in the aqueous phase lyu et al 2018 brusseau et al 2019 guo et al 2020 for hayhook only aaw data obtained by the gas based iptt was available peng brusseau 2005 the gas iptt measured awi areas are generally greater than those measured by the aqueous interfacial tracer based method because a gas phase surfactant tracer can access more awi areas likely due to its greater mobility brusseau et al 2020a jiang et al 2020a the measured aqueous iptt aaw data for accusand and vinton are presented in fig 1 the measured gas iptt aaw data for accusand vinton and hayhook are presented in fig c 2 in appendix c assuming that the aaw measured by the gas iptt and the aqueous iptt differ by constant ratios for a porous medium we estimate the aqueous iptt aaw for hayhook as aaw hayhook 2 3aaw vinton to test if the scaling estimate is reasonable we then independently estimated the aqueous iptt aaw for accusand as aaw accusand 0 46aaw vinton the independently estimated aqueous iptt aaw for accusand was shown to match with the measured values well which demonstrates that the scaling estimate appears to be a reasonable approach when no directly measured data are available other approaches may be used to determine awi area such as the thermodynamic approach that estimates the awi area using the swc morrow 1970 bradford leij 1997 bradford et al 2015 however we note that the awi area estimated using the thermodynamic approach is generally lower than that measured by the interfacial tracer methods jiang et al 2020 which is also the case for the soil media and the interfacial tracer measured awi areas used in the present study the saturated hydraulic conductivity for hayhook k s hayhook e s t i m a t e d was estimated using the rosetta model schaap et al 2001 with 85 5 of sand 4 3 of silt and 10 2 of clay russo et al 2010 to ensure that the estimated saturated hydraulic conductivity for hayhook is consistent with those of the other porous media we obtain an estimated saturated hydraulic conductivity for vinton k s vinton e s t i m a t e d with 96 of sand 1 5 of silt and 3 of clay brusseau et al 2019b using rosetta and obtain k s hayhook using the following scaling k s hayhook k s hayhook e s t i m a t e d k s vinton e s t i m a t e d k s vinton m e a s u r e d the high k sand is assigned a saturated hydraulic conductivity ks that is significantly higher than that of the other three porous media e g it is approximately 78 5 times that of the ks for accusand the saturated water content and the residual water content are set to θ s 0 4 and θ r 0 02 respectively the swc curve and relative permeability are assumed to also follow the van genutchen mualem models with α 0 1 cm 1 and n 5 the organic carbon content foc is set to one tenth of that for accusand the aaw for the high k sand is supposed to be significantly lower than those of the other three porous media we assume that its aaw is one tenth of that for accusand at the same water saturation leading to a maximum aaw of 63 16 cm2 cm3 at sw 0 002 the above parameters for the high k sand are considered as the base case to examine the sensitivity of pfas leaching to the two parameters ks and aaw of the high k sand we consider a wider range of values for ks 1 3ks to 3ks and aaw 3aaw to 1 3aaw and compare them with the base case 3 2 representative pfas we consider two representative pfas pfos long chain and pfpea perfluoropentanoic acid c5hf9o2 short chain that have been widely found at contamination sites baduel et al 2017 brusseau et al 2020b dauchy et al 2017 høisæter et al 2019 houtz et al 2013 sepulvado et al 2011 as a long chain pfas pfos has a stronger adsorption capacity at both solid surfaces and air water interfaces than that of pfpea the physicochemical and transport properties of the two pfas including the szyszkowski parameters for surface tension freundlich isotherm parameters for solid phase adsorption and the molecular diffusion coefficients are presented in table 2 the szyszkowski parameters a µmol cm3 and b were obtained by fitting to surface tension data measured in synthetic groundwater sgw brusseau van glubt 2019 the surface tension of sgw with no dissolved pfas is σ0 71 dyn cm the freundlich isotherms for pfos in both accusand and vinton were obtained from prior sorption experiments reported in brusseau 2020 and brusseau et al 2019a because no solid phase adsorption data are available for pfpea we estimated the kf and n parameters from the measured freundlich isotherms of pfoa using the qspr method developed by brusseau 2019 similarly we used the same qspr method to estimate the freundlich isotherms for pfos and pfpea in hayhook and high k sand because pfos and pfpea are both anionic pfas for which the solid phase adsorption is dominated by hydrophobic interactions with the organic carbon content brusseau 2018 guelfo higgins 2013 we assume that kf scales with the organic carbon content among the different porous media for example for pfos in hayhook k f hayhook k f vinton f o c hayhook f o c vinton the n values for hayhook and high k are assumed to be the same as those for vinton and accusand respectively the molecular diffusion coefficient d 0 cm2 s for pfos and pfpea were obtained from laboratory measurements reported in schaefer et al 2019 finally because the change of contact angle is expected to be relatively small for anionic surfactants especially at relatively low aqueous concentrations relevant to pfas contaminated sites desai et al 1992 kissa 2001 rosen kunjappu 2012 we assume that the contact angle does not change i e γ γ0 and cos γ cos γ0 1 note that for cationic zwitterionic or nonionic pfas that interact more strongly with soil grain surfaces the change of contact angle may need to be accounted for especially at higher aqueous concentrations desai et al 1992 henry smith 2003 mw g mol is the molecular weight of the pfas molecules 3 3 climatic boundary conditions we employ the precipitation and evapotranspiration data from a humid region represented by the site of silas little clark 2004 in new jersey usa the data are from 01 01 2005 to 12 31 2014 for 10 years and are available from the ameriflux database https ameriflux lbl gov the 30 min resolution of the original data is smoothened to an 8 hour resolution the 10 year data were repeated 7 times to generate a data set covering 80 years the mean annual precipitation and potential evapotranspiration are 1 066 mm and 674 mm respectively all of the precipitation is assumed as rainfall for simplicity i e we do not distinguish snow from rainfall the evapotranspiration data is treated as the potential evapotranspiration to determine the surface evaporation fluxes additional details for the determination of the evaporation fluxes were reported in guo et al 2020 4 numerical simulation and results we apply the 3d model presented in section 2 to investigate the lateral spreading and vertical leaching of pfas in the vadose zone as impacted by sif and subsurface heterogeneities we consider the release of pfas to the vadose zone at a model fta site and construct two sets of scenarios one involves a homogeneous vadose zone and the other considers several typical types of heterogeneities in a heterogeneous vadose zone the following is applied to all of the scenarios 1 the fta to which diluted afff solutions are directly released has dimensions of 30 m 30 m 2 the vadose zone is assumed to have a depth of 4 m the depth to groundwater table is assumed to be deeper than 4 m so a free drainage condition for water flow and a zero gradient concentration condition for pfas transport are employed at the bottom boundary 3 two periods in time are simulated including an active contamination period of 30 years when the release of diluted afff solutions occurs regularly due to fire training and a subsequent post contamination period of 50 years during which the fire training stops and no pfas are released to the vadose zone 4 real world high resolution rainfall and evapotranspiration data are applied at the top boundary see more details of the data in section 3 3 during the active contamination period the diluted afff solution is applied to the fta once per 10 days representing a fire training event the training frequency is within the range of approximately 12 to 44 times per year reported in the literature e g rotander et al 2015 apex 2017 each application is assumed to last for 30 minutes at a rate of 22 mm d the diluted afff solution released from fire training makes up 17 mm of water per unit area added to the fta each year the diluted afff solution is assumed to contain pfos and pfpea at concentrations of 100 mg l and 0 528 mg l høisæter et al 2019 respectively if not otherwise specified 5 the initial water pressure head of the domain is h 0 100 cm and the domain is assumed initially pfas free i e c 0 0 6 convergence tests have been conducted for the numerical discretizations and all of the numerical solutions have converged in the following subsections we present more specifics for the scenarios which will be followed by detailed simulation results and analysis 4 1 scenario 1 impact of surfactant induced flow on pfas leaching in this scenario we focus on examining the impact of sif on pfas leaching in a homogenous vadose zone in particular we quantify 1 the potential acceleration of vertical leaching and 2 the strength of lateral spreading resulting from the sif as shown in fig 2 we consider a cross sectional domain 30 m 4 m of a homogeneous vadose zone represented by one of the three porous media i e accusand vinton and hayhook we assume that the fta is symmetric and thus only simulate half of the fta by imposing a no flux condition on the left boundary fire training occurs at the upper boundary covering 0 x 15 m in addition to considering pfos of 100 mg l and pfpea of 0 528 mg l in the afff solution we also simulate another case with pfos at a much higher concentration of 1 000 mg l which can be considered as an upper limit for the pfos concentration in the diluted afff solutions applied to ftas houtz et al 2013 guo et al 2020 finally a non reactive tracer at a concentration of 0 528 mg l is also simulated for comparison the 2d domain is discretized using uniform grid cells x z 10 cm we present the 2d pfas plumes at t 80 years fig 3 because the presence of long chain pfos in porewater leads to much stronger sif than that of short chain pfpea we only present the plumes for pfos the simulation results from both the release concentrations of 100 mg l and 1 000 mg l in all three porous media are presented the lateral spreading of pfos is shown to be generally small the extent of spreading in the three porous media has the following order of accusand vinton hayhook and it is greater under the higher release concentration of 1 000 mg l the largest extent of spreading occurs when 1 000 mg l of pfos is applied to the accusand the plume extends 1 2 m beyond the vadose zone directly underneath the fta x 15 m which is still insignificant compared to the overall size of the plume in the lateral direction to quantify the impact of sif we turn off the change in surface tension i e set σ σ0 and perform another set of simulations for comparison the results show that sif has a relatively minor impact i e the pfos plumes with and without accounting for sif are similar fig 3 to further quantify the impact of lateral spreading on pfas leaching we also conduct 1d simulations with and without accounting for sif similar to those reported in guo et al 2020 and compare the vertical concentration profiles with our 2d simulations fig 4 the concentrations from the 2d simulations are averaged along the horizontal dimension the difference between the 2d and 1d simulations is almost negligible confirming that the lateral spreading due to sif has a minimal impact on pfas leaching in addition to sif molecular diffusion and transverse mechanical dispersion can also cause lateral spreading to evaluate the extent of lateral spreading contributed solely by sif we compute and compare the mass fraction of pfas that migrates outside of the vadose zone directly underneath the fta with and without accounting for sif for both pfos and pfpea fig 5 the non reactive tracer is also presented as a reference we make the following observations 1 the lateral spreading is mainly driven by transverse mechanical dispersion due to strong porewater velocities in the vertical direction rather than sif note that molecular diffusion is negligible compared to the transverse mechanical dispersion 2 consistent with fig 3 the extent of lateral spreading follows the order of accusand vinton hayhook this is because the lateral spreading is mainly caused by transverse mechanical dispersion and that the vertical porewater velocities for accusand vinton hayhook see their ks in table 1 3 among the three porous media the lateral spreading due to sif is the weakest in hayhook a closer inspection reveals that the aqueous concentration of pfos is the smallest in hayhook the majority of pfos is adsorbed at solid surfaces and air water interfaces due to strong solid phase and awi adsorption a lower aqueous concentration leads to weaker sif for example the maximum aqueous concentration is 11 mg l for accusand 10 mg l for vinton and 4 5 mg l for hayhook at t 10 years when pfos is applied at 1 000 mg l 4 though lateral spreading due to sif is measurable for the release concentration 1 000 mg l for pfos approximately 5 5 it is much smaller for pfos at the release concentration of 100 mg l 1 2 for all three porous media and also for pfpea 0 1 for all three porous media in particular the spreading of pfpea is almost identical to that of the non reactive tracer indicating that sif has no impact on the lateral spreading of pfpea 4 2 scenario 2 subsurface heterogeneities in this scenario we simulate pfas leaching in the vadose zone in the presence of three typical types of subsurface heterogeneities to accurately represent the heterogeneities in our numerical discretization we focus on subdomains of a vadose zone directly underneath the fta to allow for a higher spatial numerical resolution the schematics and the spatial arrangement of the heterogeneity inclusions for the three test cases are presented in fig 6 more specific information about the heterogeneities for each set of the test cases is provided below 4 2 1 soil layering and lens a soil lens or a fully extended layer is embedded in an otherwise homogeneous vadose zone composed of the vinton soil fig 6a an x z cross sectional domain of 5 m 4 m is considered the soil lens is elliptic center x z 2 5 m 1 5 m major axis 4 m minor axis 1 m alternatively we consider a fully extended horizontal layer at 1 z 2 m the lens or layer is represented by one of the three porous media i e accusand vinton and hayhook leading to a set of five test cases homogeneous vinton vinton with an embedded lens or layer of accusand and vinton with an embedded lens or layer of hayhook the 2d domain is discretized using uniform grid cells x z 5 cm we present the time dependent vertical total concentration profiles fig 7 and the cumulative breakthrough curves cbtcs fig 8 i e the cumulative mass of pfos and pfpea leaching through the bottom of the domain for all five test cases the 1d vertical concentration profiles were obtained by averaging the 2d plumes along the x axis in addition we also present the spatial distributions of water pressure head h water saturation sw awi area aaw and total concentration ctot fig 9 comparisons of the vertical concentration profiles in fig 7 show that the inclusion of a heterogeneous soil lens or a layer in an otherwise homogeneous vadose zone significantly influences the leaching behavior of pfas this is partly due to the fact that the strengths of both solid phase and awi adsorption for pfas in vinton are stronger than that in accusand while weaker than that in hayhook notably the leaching of both pfos and pfpea is shown to be faster in the presence of a lens than that in the presence of a fully extended layer despite that they are composed of the same soil medium these observations are confirmed by the arrival times ta defined as the time at which pfas reaches the bottom of the domain shown in the cbtcs fig 8 for pfos in the homogeneous vinton ta 59 years the presence of an accusand lens leads to a significantly earlier arrival ta 34 years that is even 19 years earlier than that for a fully extended accusand layer ta 53 years the presence of a lens and a fully extended layer of hayhook leads to an arrival time of ta 54 years and ta 62 years respectively even though the presence of either a hayhook lens or a fully extended layer enhances the overall retention fig 8 it is rather interesting that a hayhook lens leads to an arrival time of 5 years earlier ta 54 years than that for the homogeneous case which indicates the presence of some type of preferential transport similar trends discussed above can be observed in the arrival times of pfpea a closer inspection reveals that the above mentioned different behaviors for the transport of pfas between the inclusion of a lens and a fully extended layer are caused by the so called funneled flow i e one type of preferential flow generated by the presence of the lens kung 1990a b for pfas in particular it is quite interesting that the funneled flow not only introduces preferential transport of pfas by advection and dispersion but also amplifies leaching by reducing the strength of awi adsorption a more detailed analysis is provided below when a lens of accusand is embedded in an otherwise homogeneous vadose zone comprised of vinton water accumulates above the vinton accusand interface before it can enter the underlying accusand the matrix potential in the accusand is greater than that in the vinton see the second plot in row 1 of fig 9 the accumulated water then moves around the accusand lens partly facilitated by the slopes which eventually leads to preferential flow pathways see column 2 of fig 9 a hayhook lens also introduces funneled flow though the mechanism is slightly different water moves around the hayhook lens resulting from its low hydraulic conductivity that makes water difficult to infiltrate note that the preferential flow generated by the hayhook lens is much less profound than that by the accusand lens like other solutes the funneled flow leads to preferential transport of pfas by advection and dispersion however what is unique about pfas is that the preferential flow leads to greater water saturation that subsequently destructs awi areas along the pathway see the second and fourth plots of row 3 fig 9 because the awi area is a primary retention process for pfas especially the long chain ones the destruction of awi areas on the preferential flow pathway further contributes to accelerating the leaching of pfas this mechanism can be illustrated by comparing the accelerated leaching of pfos to that of pfpea namely awi adsorption plays a much more important role in the retention of the long chain pfos the funneled flow caused by the lens of accusand and hayhook leads to greater acceleration of leaching for pfos than that for pfpea as demonstrated by the arrival times presented in fig 8 the other interesting finding unique to pfas is that the presence of accusand and hayhook either as a lens or a fully extended layer accelerates the leaching of pfos in the region above them but not for pfpea fig 7 shows that the mass of pfos in the first meter is smaller when a lens or a fully extended layer of accusand or hayhook is present conversely the mass of pfpea in the first meter increases in the presence of accusand or hayhook this is because both accusand and hayhook act as barriers that lead to the accumulation of water above the vinton accusand or vinton hayhook interface i e the water saturation is greater than that for the homogeneous case the greater water saturation reduces the amount of aaw and as a result decreases the retention of pfos in the vinton above conversely because awi adsorption does not play a major role in the retention of pfpea water accumulating at the vinton accusand or vinton hayhook interface leads to more pfpea in the aqueous phase accumulating above accusand or hayhook 4 2 2 high conductivity pathways we simulate pfas leaching in the presence of well connected high conductivity pathways that are composed of the high k sand fig 6b all of these high k sand channels have a width of 5 cm in addition to the base simulations using the parameters presented in table 1 we also perform a sensitivity analysis by conducting additional simulations using a wider range of values for ks and aaw of the high k sand 1 3 and 3 times of the base values of these two parameters are used in the sensitivity analysis the domain is discretized using uniform grid cells x z 2 5 cm the time dependent vertical total concentration profiles averaged from the 2d plumes along the x axis fig 10 and the cbtcs fig 11 demonstrate that the high conductivity pathways lead to much earlier arrival of pfas at the bottom of the domain especially for the long chain pfos pfos arrives at the bottom of the domain at ta 4 years in the presence of the high conductivity pathways which is approximately 1 15 of that for the homogenous case ta 59 years due to minimal retention from solid phase and awi adsorption the arrival time for the short chain pfpea is short for the homogeneous case ta 1 23 years however the presence of the high conductivity pathways further reduces it to ta 0 05 years though the high conductivity pathways lead to the early arrival of pfas at the bottom of the domain they also provide shortcut circuiting channels that can make the leaching of pfas in the surrounding lower conductivity regions less effective especially during the post contamination period this phenomenon can be observed in the vertical concentration profiles in fig 10 as well as the 2d concentration distributions in fig 12 the vertical concentration profiles show that more pfos and pfpea remain in the shallower vadose zone 0 z 1 m and 0 z 2 5 m respectively during the post contamination period t 30 years in the presence of the high conductivity channels when compared to the homogeneous case a closer inspection of the 2d concentration distributions fig 12 reveals that during the active contamination period some pfas have entered the lower conductivity regions driven by advection due to the presence of the preferential pathways provided by the high k sand channels leaching of pfas in those regions is less effective compared to that of the homogenous case finally the sensitivity test cases using a wider range of values for the hydraulic conductivity and awi area for the high k sand show a minimal difference from the base simulations figs 10 and 11 this demonstrates that the overall leaching behaviors for both pfos and pfpea observed above are robust for a relatively wide range of high k sand provided that the high k sand has a greater conductivity and weaker adsorption capacities than that of vinton 4 2 3 random heterogeneity in this final set of test cases we simulate pfas leaching in the presence of much more complex 3d heterogeneities that follow a random distribution fig 6c the 3d domain has dimensions of 1 m 1 m 4 m and is discretized using uniform grid cells x y z 10 cm we use the gaussian kriging variogram model in the gstat package pebesma 2004 to generate 3d random fields with the following parameters nugget 0 sill 10 cm correlation lengths 40 cm and 4 cm in the horizontal and vertical directions the correlation lengths are within the range reported in the literature e g russo 1991 tseng and jury 1993 the maximal number of nearest observations 100 and maximal distance from the prediction location used for prediction 50 cm note that the correlation lengths are used for illustrative purposes other correlation lengths will likely lead to different quantitative leaching behaviors but as long as preferential flow pathways are present accelerated pfas leaching due to reduced air water interfacial adsorption as demonstrated in sections 4 2 1 and 4 2 2 will occur the random values are then normalized into the range from 0 to 1 we then uniformly divide the cumulative density function into four intervals assign them to the four soils i e high k sand accusand vinton and hayhook as demonstrated in fig 6 c three different sets of fractions among the four porous media are considered 0 3 and 10 are assigned to the high k sand respectively and the remaining portions are equally assigned to the other three porous media for each set of fractions we generate 8 realizations to conduct sensitivity analysis finally we note that because the spatial heterogeneities have been explicitly represented in the 3d domain we employ a lower dispersivity coefficient α l 2 cm in each homogeneous soil medium in the simulations we present the time dependent vertical total concentrations profiles averaged from the 3d plumes along the x y plane fig 13 and the cbtcs fig 14 for the 24 simulations conducted using the randomly generated heterogeneous domains that contain 0 3 and 10 of high k sand each has 8 realizations the simulation results conducted using the homogeneous porous media i e accusand vinton and hayhook are also presented for comparison for pfos the presence of high k sand has a significant impact on its long term leaching behavior with 0 of high k sand the differences among the concentration profiles from the 8 heterogeneous realizations are minor and all of them are bounded by the concentration profiles of the homogenous hayhook and accusand cases fig 13 the arrival times for the 8 realizations vary from 43 to 76 years only 0 1 to 1 9 of the total pfos has been discharged from the bottom of the domain at t 80 years fig 14 however the addition of 3 high k sand greatly accelerates the leaching process and leads to much more significant variations among the 8 realizations the arrival times are reduced to 10 to 66 years the earliest arrival time is more than 24 years earlier than that for the homogenous accusand case for this realization more than 93 of total pfos has been discharged from the bottom of the domain at t 80 years fig 14 when the fraction of the high k sand is further increased to 10 the leaching becomes even faster and much greater variations are observed among the 8 realizations the arrival times are reduced to 3 to 27 years in the realization where leaching occurs the fastest 100 of the total pfos has been discharged from the bottom of the domain at t 40 years these synthetic simulations illustrate that even the presence of a small fraction of high conductivity media can greatly accelerate the leaching of pfos i e long chain pfas in the vadose zone conversely the presence of the high k sand shows a minimal impact on the long term leaching of the short chain pfpea which is consistent with the findings reported in sections 4 2 1 and 4 2 2 this is because the short chain pfpea is minimally retained in any of the four porous media accusand vinton hayhook and high k sand and as a result the different heterogeneity realizations generated using these four porous media do not significantly change the overall retention capacity for pfpea in the vadose zone finally we present the 3d plumes to further illustrate and visualize the impact of the high k sand on the leaching of pfos and pfpea in the vadose zone a realization with no inclusion of high k sand and a realization with 10 of high k sand the one that leads to the fastest leaching are shown as examples fig 15 the comparisons between the 3d plumes confirm that the presence of high k sand significantly accelerates the migration and leaching of the long chain pfos while it has a minimal impact on that of the short chain pfpea in the realization with 10 of high k sand the high k sand forms well connected channels that provide preferential pathways for the leaching of pfos however these preferential pathways appear to be much less effective for pfpea primarily because the retention capacity of the other three porous media for pfpea is already minimal as was discussed above 5 discussion we have developed a new 3d model that represents the coupled variably saturated flow and transport processes relevant to pfas retention and leaching in the vadose zone including sif and nonlinear adsorption of pfas at the solid surfaces and air water interfaces the newly developed multidimensional modeling framework allowed us to conduct a series of numerical experiments to investigate the impact of two critical factors sif and subsurface heterogeneities on the long term leaching of pfas in the vadose zone a prior study employing a 1d model guo et al 2020 showed that the enhanced vertical drainage resulting from sif has a negligible influence on the long term leaching of pfas however it remains unclear as to whether the lateral spreading of pfas plumes caused by sif will lead to potentially enhanced retention of pfas in the vadose zone in the present work we demonstrate that sif has a minimal impact either via enhanced vertical drainage or lateral spreading on the long term leaching of pfas our 2d numerical experiments section 4 1 show that even at the higher end release concentration of 1 000 mg l only 5 5 of pfos migrated outside the vadose zone directly underneath the fta at t 80 years notably sif only contributed to less than 1 3 of the 5 5 the remaining 4 2 was caused by transverse mechanical dispersion in the lateral dimension the reason for the minimal impact of sif is the relatively low aqueous concentration of pfas in porewater though pfas can be released at relatively high concentrations especially at ftas after entering the vadose zone the majority of long chain pfas the ones that are more surface active and can modify surface tension are adsorbed at air water interfaces and solid surfaces this mass partitioning due to solid phase and awi adsorption significantly reduces the aqueous concentrations in porewater and as a result reduces the change in surface tension for example the maximum aqueous concentrations of pfos for the simulations conducted under all conditions in section 4 1 are less than 15 mg l even though pfos was released at a concentration of 1 000 mg l the minimal impact of the sif has been further confirmed by excellent agreement among the vertical concentration profiles simulated by the 2d model and those by the 1d model with and without accounting for sif the 2d and 3d numerical experiments for heterogeneous vadose zones section 4 2 show that subsurface heterogeneity can be a primary factor that contributes to the early arrival of long chain pfas in groundwater we illustrate that the presence of soil lenses and high conductivity channels generates preferential pathways for flow and transport that can lead to the earlier arrival of pfas compared to that of pfas leaching in a homogeneous vadose zone this suggests that the presence of subsurface heterogeneity is a plausible explanation for the early arrival of pfas in the deep vadose zone or groundwater at tens to a hundred meters observed at some contaminated sites brusseau et al 2020 dauchy et al 2019 afw 2019 for example dauchy et al 2019 reported deep seepage of both short chain and long chain pfas to the groundwater below a depth of 15 m at an fta site in france despite the presence of multiple clay layers similarly at an air force base in tucson az long chain pfas reached a depth of over 70 m through a thick vadose zone afw 2019 while the above field evidence shows a significant deviation of pfas leaching rate from the simulation results based on homogeneous soils the early arrivals appear to be consistent with our model simulations that have explicitly represented subsurface heterogeneities while preferential flow and transport resulting from soil lenses or high conductivity pathways have been widely reported for other non pfas contaminants in the vadose zone and groundwater e g brusseau rao 1994 bekhit hassan 2005 köhne et al 2006 2009 kung 1990a 1990b šimůnek et al 2003 zhou zhan 2018 our simulations have revealed some interesting behaviors unique to pfas for example the preferential flow pathways generated by the presence of the soil lens i e funneled flow not only leads to preferential transport of pfas by advection and dispersion like for nonreactive solutes but also reduces the strength of retention for pfas that further enhances preferential transport the reduced retention as analyzed in section 4 2 1 is caused by the increased water saturation along the preferential flow pathways that destructs awi areas and hence decreases awi adsorption another interesting behavior is that the spatial heterogeneity influences the long term leaching of long chain pfas much more strongly than their short chain counterparts which is illustrated by the 2d experiments in sections 4 2 1 4 2 2 as well as the 3d numerical experiments conducted using randomly distributed heterogeneities in section 4 2 3 this difference between the long chain and short chain pfas may be attributed to two factors and both of which are a direct result of the long chain pfas being more strongly adsorbed at solid surfaces and air water interfaces namely for the long chain pfas the preferential transport pathways are amplified due to reductions in awi area and the differences in the adsorption capacities among the different soil media have a more significant impact on the overall retention these pfas specific responses to subsurface heterogeneities imply that compared to other more traditional contaminants e g nonreactive solutes more significant errors especially for the long chain compounds may be introduced in the predictions of long term leaching of pfas if subsurface heterogeneities are not fully represented in the numerical model we comment on some assumptions employed in our simulations and how they may potentially influence the results as presented in section 2 1 2 our model assumes equilibrium adsorption on solid grain surfaces and air water interfaces prior miscible displacement experiments indicate that rate limited adsorption is likely insignificant under field scale conditions where porewater velocities are much lower than the typical porewater velocities used in column experiments brusseau 2020 brusseau et al 2019b a recent study of batch experiments showed that kinetic solid phase desorption may be more pronounced in field aged soils especially for shorter chain pfas schaefer et al 2021 when rate limited adsorption is present pfas leaching may be enhanced during the active contamination period due to rate limited adsorption while reduced during the post contamination period due to rate limited desorption the relative importance of solid phase adsorption will depend on the specific soil media and pfas under consideration the foc values used in our study are relatively low compared to those for surface soils however since foc generally decreases rapidly along depth elzein balesdent 1995 jobbágy jackson 2000 the foc especially those for vinton soil and hayhook soil should be representative for soils and sediments in the deeper vadose zone approximately 1 m below the land surface we recognize that foc in the first meter below the land surface may be much greater than the foc employed in the present study additionally more complex sorption processes such as electrostatic interactions may lead to enhanced solid phase adsorption in particular for cationic and zwitterionic pfas barzen hanson et al 2017 mejia avendaño et al 2020 nickerson et al 2020 xiao et al 2019 under these conditions our simulations would overestimate pfas leaching the simulations conducted in the present study assume that each homogeneous soil medium is isotropic anisotropy with greater kxx or kyy than kzz would in general lead to greater lateral spreading of the plume in a homogeneous vadose zone greater lateral spreading will reduce pfas leaching in the vertical direction while in a heterogeneous vadose zone greater lateral spreading may help the pfas find preferential flow pathways and hence enhance leaching however when heterogeneities are explicitly represented like in the simulations presented in section 4 3 the domain becomes effectively anisotropic and hence would partially account for anisotropy another assumption employed in the simulations is the spatially uniform pfas loading at the upper boundary spatial variation in pfas loading rate may lead to spatially heterogeneous leaching rates locations with greater pfas loading rates will likely have greater leaching rates resulting from reduced solid phase and air water interfacial adsorption finally we comment on the two numerical schemes i e fi and si employed to couple the transient variably saturated flow and pfas transport equations in our modeling framework both of these two coupling schemes are shown to provide convergent solutions the nonlinear iteration loops for the fi method were shown to converge faster than that of the si method for the simulations conducted in the present work though the single linear jacobian matrix in the fi scheme requires a preconditioner for improved convergence if iterative linear solvers are used and accuracy properties benzi 2002 our observations are consistent with a recent numerical analysis of the iterative schemes for the coupling between surfactant transport and variably saturated flow illiano et al 2020 note that awi adsorption and solid phase adsorption were not accounted for in the model formulation of illiano et al 2020 6 conclusions in the present study we have developed a multidimensional numerical modeling framework to simulate pfas transport and leaching in the vadose zone the model formulation represents transient variably saturated flow pfas advective and dispersive transport nonlinear solid phase and awi adsorption and sif the coupled flow and transport equations are solved using a fully implicit or a sequential implicit framework either of which was shown to give convergent solutions employing the newly developed multidimensional modeling framework we have conducted a series of numerical experiments at model fta sites to understand and quantify the impact of sif and subsurface heterogeneities on the long term leaching of pfas in the vadose zone a long chain pfos and a short chain pfpea pfas that are commonly found at contaminated sites are used as examples to examine the influence of chain length on the leaching behavior all of the simulations last for 80 years including 30 year active contamination due to regular fire training activities and 50 year post contamination when fire training activities have been stopped our simulation results and analyses lead to the following conclusions 1 sif resulting from the change of surface tension due to the presence of pfas in porewater has a minimal impact on the long term retention and leaching of pfas in the vadose zone this has been confirmed by both 1d simulations that account for the induced drainage in the vertical dimension as well as 2d simulations that further represent the induced lateral spreading of the pfas plume the primary reason is that though pfas may be released at high concentrations e g at fta sites their aqueous concentration decreases significantly after entering the vadose zone due to strong adsorption at the solid surfaces and air water interfaces the relatively low aqueous concentrations have a relatively minimal impact on the porewater surface tension overall our simulations imply that it may be acceptable to decouple the richards equation and the pfas transport equations i e assuming no sif when focusing on the long term retention and leaching of pfas in the vadose zone 2 subsurface heterogeneity is a primary factor that controls the retention and leaching of pfas in the vadose zone the presence of heterogeneity generates preferential pathways for flow and transport that can lead to much earlier arrival of pfas at a given depth compared to that in the homogenous vadose zones 3 a unique property differentiating pfas from conventional non pfas contaminants is that preferential flow pathways can further amplify the preferential transport due to the destruction of air water interfaces by the increased water saturation we have also demonstrated that subsurface heterogeneities influence the long term leaching of the long chain pfas more strongly than that of their short chain counterparts 4 given the significant impact of heterogeneity on pfas leaching in the vadose zone our study suggests that it is essential to employ multidimensional models for studying the pfas retention and leaching at contaminated sites where complex heterogeneities are present credit authorship contribution statement jicai zeng methodology software investigation formal analysis visualization data curation writing original draft bo guo conceptualization methodology software investigation formal analysis supervision project administration funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was in part supported by the national science foundation 2023351 and the environmental security technology certification program estcp for project er21 5041 appendices a the fi and si frameworks we introduce the numerical procedures for the fi and si frameworks employed to solve the coupled equations in the present work let f h c 0 and g h c 0 represent the spatially and temporally discretized systems of eqs 1 and 2 respectively in the fi coupling scheme we assemble the two discretized equation sets as f f g 0 and the two sets of unknown variables as φ h c in the newton raphson iteration scheme δ ϕ j 1 k 1 f ϕ j 1 k 1 f j 1 k where the superscripts j 1 and k 1 indicate the current time and iteration levels respectively more specifically δ h j 1 k 1 δ c j 1 k 1 f h f c g h g c j 1 k 1 f g j 1 k in the si coupling scheme equations f h c 0 and g h c 0 are solved separately using a newton raphson scheme that is δ h j 1 k 1 f h j 1 k c j 1 k h 1 f h j 1 k c j 1 k and δ c j 1 k 1 g h j 1 k c j 1 k c 1 g h j 1 k c j 1 k for both the fi and si coupling schemes the solutions are updated at each iteration as h j 1 k 1 h j 1 k δ h j 1 k 1 and c j 1 k 1 c j 1 k δ c j 1 k 1 until convergence i e max δ h j 1 k 1 ε h and max δ c j 1 k 1 ε c ε h and ε c are the absolute tolerances for the water pressure head and pfas concentration to ensure convergence ε h 10 3 cm and ε c 10 7 µmol cm3 are used in the present work b numerical code validation we validate our numerical implementation by comparing it to a widely used open source simulator pflotran hammond et al 2014 in the numerical experiment at t 0 a non reactive tracer at a concentration of c 0 0 5 mg l is uniformly distributed in a 1 m 1m 1m 3d domain composed of accusand the domain is discretized using uniform cells x y z 1 cm the water table depth is 90 cm and is kept constant during the simulation the initial water pressure head is hydrostatic the four side boundaries are all set as no flux boundaries for water flow and solute transport at the center of the top boundary starting at t 0 constant infiltration of clean water at 1 cm d is applied to a 10 cm 10 cm square area and lasts for 48 hours the rest of the top boundary is set to zero flux the 3d spatial distributions of water pressure head h water saturation sw and aqueous concentration c are computed the cross sections of these distributions at y 49 5 cm at the end of simulation using results computed from our code and pflotran are presented in fig b 1 excellent agreement between the results from the two codes is observed c additional data and parameters for the four porous media supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2021 104015 appendix supplementary materials video for the transport of pfos in the vadose zone with a lens or layer video for the transport of pfpea in the vadose zone with a lens or layer video for the transport of pfos in the vadose zone with high conductivity pathways video for the transport of pfpea in the vadose zone with high conductivity pathways 
262,groundwater flow in an unconfined aquifer can be described by the boussinesq equation the boussinesq equation is nonlinear and approximate solutions exist only for specific flow conditions in the present work the nonlinear equation is tackled analytically via a refinement of its linearized solution in a perturbation series framework the perturbation series solution applies for any time dependent variation of the stream level and they are evaluated for various flow recharge and drainage conditions particular results for a sudden change and a piecewise linear variation are presented for both finite and semi infinite aquifers the approximate solutions can simulate the original nonlinear behavior with high accuracy due to the introduction of the representative depth parameter α that is evaluated in an optimal fashion for any given flow condition the derivation of the optimal α parameter has also allowed the generalization and improvement of the classical series results pertaining to the abrupt rise or drop of the stream level in a semi infinite aquifer in the case of a gradual variation of the stream level in a finite aquifer domain the linear solution with a time varying estimate of α is of sufficient accuracy for practical purposes explicit algebraic expressions are presented for the exchange flow rates and the associated flow volumes that are of prime interest in stream aquifer interaction studies keywords groundwater flow stream aquifer interaction boussinesq equation perturbation solutions green s function method flow expressions water table response 1 introduction groundwater flow in a phreatic aquifer can be described by the nonlinear boussinesq equation when the flow is predominantly horizontal solutions of the boussinesq equation yield the response of the water table to stream level variations and quantify the exchange flow between the stream and the aquifer these results have wide ranging applications in irrigation and drainage as well as in base flow separation and recession analysis the topic is a subject of active research and of much interest in the hydrological community as can be attested by the review paper by troch et al 2013 exact solutions of the nonlinear boussinesq equation are few the earliest solution is by boussinesq 1904 that simulates the drainage of a horizontal finite aquifer subject to a particular initial condition with zero boundary conditions additional exact solutions were later derived for specific boundary conditions and zero initial condition barenblatt et al 1990 parlange et al 2000 chor et al 2019 approximate solutions for particular flow conditions are more readily available especially when the governing equation is recast in a simpler form using similarity transformation e g boltzmann s the nonlinear partial differential equation is then reduced to an ordinary differential equation and approximate solutions are constructed using a perturbation series e g polubarinova kochina 1962 polynomial or functional approximation e g tolikas et al 1984 parlange et al 2000 lockington et al 2000 telyakovskiy et al 2002 hayek 2019 a power series approach e g lockington et al 2000 the weighted residual method lockington 1997 and the adomian s decomposition method moutsopoulos 2010 however the above class of solutions is restricted to a semi infinite domain with either a sudden change of the boundary head with uniform initial conditions or a specific functional form of the time varying stream level with zero initial conditions for arbitrary time dependent stream stage variations approximate solutions using the traveling wave approach basha 2013 and the adomian s decomposition method jiang and tang 2015 are available but they are also restricted to a semi infinite domain with a uniform initial condition solutions of the nonlinear boussinesq equation in a finite domain are fewer parlange et al 2001 derived an expression for the drainage outflow due to a sudden drawdown by improving upon the corresponding linear expression an indirect method to tackle the interaction of a wetting front with an impervious wall was also presented by hogarth et al 2002 the method uses the superposition concept to satisfy the no flux condition at the wall in an average sense the approximate response of the water table to a cyclic variation of the stream level was obtained using the adomian s decomposition method serrano et al 2007 finally a rich set of solutions of the linearized boussinesq equation exist wherein the nonlinear term is approximated by a constant depth value e g cooper and rorabaugh 1963 brutsaert 1994 the present work presents approximate solutions of the nonlinear boussinesq equation in a semi infinite and finite aquifer domain subject to a varying water level at the boundary the solution is obtained using an optimal perturbation approach whereby the perturbation series is constructed from three terms the representative depth α as the zero order term the linear solution as the first order term and the correction term as the second order term the α parameter is determined in an optimal sense that ensures the accuracy of the perturbation solution at all times and for all flow conditions this particular result is of theoretical and practical importance since an expression for the representative depth is derived as a function of the time dependent boundary head rather than pre defined as a constant value explicit solutions for the water table response and exchange flow rates are presented for a sudden and a piecewise linear variation of the water level at the boundary the solutions are evaluated for various flow conditions and illustrated with several examples of hydrological interest 2 theory the governing equation for unconfined groundwater flow in a horizontal aquifer is 1 k x h h x φ h t here h is the height of the water table measured from the impervious horizontal base of the aquifer l x is the horizontal coordinate l t is the time t k is the saturated hydraulic conductivity l t and φ is the effective porosity the subscript denotes that the variables are dimensional eq 1 is the one dimensional approximation of a two dimensional flow system whereby the hydraulic head h is assumed to be independent of depth and the contribution of the unsaturated zone is taken as negligible it is known as the boussinesq equation it is obtained by combining the continuity equation q x φ h t with the darcy discharge equation for a homogeneous flow domain 2 q k h h x the boundary conditions consist of a varying water level h h b t in the adjoining stream at x 0 at the far end of the horizontal aquifer at x l the flow is bounded by an impervious wall h x 0 the initial condition at t 0 is a prescribed water table height expressed in general form as h h i x however in the absence of recharge and the presence of the above mentioned boundary conditions a uniform initial water table height is the only plausible equilibrium condition a schematic representation of the flow domain along with the prescribed boundary conditions is shown in fig 1 introducing the following dimensionless variables 3 h h h o x x l o t t t o one obtains the following dimensionless form of the nonlinear governing equation 4 ω x h h x h t where ω is the dimensionless flow parameter defined by 5 ω k h o t o φ l o 2 the parameter h o is a characteristic depth scale that may be taken as the initial flow depth in the aquifer or the reference value of 1 m the parameter l o is a characteristic length scale that may be taken as the length of the aquifer and t o is the characteristic time scale that can be set equal to the reference value of 1 day the aforementioned dimensionless system is expressed in its most general form one can also define the normalizing parameters to be equal l o h o and proportional through t o φ h o k so that the governing eq 4 reduces to its barest form with ω 1 the boundary head at the inlet section hb is defined as a piecewise linear function of time over n segments in terms of the unit step function u t where u t 0 for t 0 and u t 1 for t 0 6 h b t h 1 u t t 0 h 2 h 1 u t t 1 h n h n 1 u t t n 1 here hk where k 1 2 n is a linear function of time defined over the interval t k 1 t tk by 7 h k a k t t k 1 υ k 1 a k υ k υ k 1 t k t k 1 where υ k is the boundary head value at time tk and υ 0 is the initial stage at time t 0 0 fig 2 the piecewise linear function can replicate the fluctuations of the water level in the stream thus reproducing a realistic behavior for all times a linearly varying water level from an initial stage ν is simulated by setting ak a 1 and υ k 1 υ 0 ν for an instantaneous increase or decrease to a level μ one sets a 1 0 and υ 0 μ 3 similarity model 3 1 perturbation solution for a semi infinite domain with constant initial hi ν and boundary condition hb μ the mathematical problem can be significantly simplified using similarity transformation that in effect reduces the partial differential equation to an ordinary differential equation by combining the independent space and time variable into a single variable η x 4 ω t known as the boltzmann transformation defining u η h x t eq 4 becomes 8 d d η u d u d η 2 η d u d η 0 eq 8 is nonlinear due to the presence of the coefficient u and an approximate analytical solution can be derived using a perturbation expansion method the perturbation approach consists of expanding the variable u in the form of a series in ascending powers of ε and determining the perturbation series terms 9 u α ε u 1 ε 2 u 2 ε 3 u 3 o ε 4 the zero order term is set to a constant term α to facilitate the subsequent derivation of the higher order solutions the perturbation parameter ε 1 is artificially introduced to separate the various order terms and help in the bookkeeping of terms of the same order substituting the perturbation series 9 into 8 and accounting only for terms of ε up to the 3rd order one obtains a sequence of linear ordinary differential equations 10 α d 2 u 1 d η 2 2 η d u 1 d η 0 11 α d 2 u 2 d η 2 2 η d u 2 d η 1 2 d 2 u 1 2 d η 2 12 α d 2 u 3 d η 2 2 η d u 3 d η d 2 u 1 u 2 d η 2 the above differential equations are solved consecutively as the second order equation is dependent on the first order solution through the nonhomogeneous term at the right hand side of 11 the first order solution u 1 is derived for the prescribed initial and boundary condition but subtracted by α while the higher order solutions are obtained for zero initial and boundary conditions the solution of 10 with u 1 0 μ α and u 1 ν α is 13 u 1 μ α ν μ erf η α the solution of 11 for zero boundary conditions is 14 u 2 α ν μ ν α π μ α 2 α μ ν 2 α π exp 2 η 2 α μ ν 2 α μ ν 1 α π η α α π exp η 2 α 1 u 1 u 1 2 2 α the derivation of the third order term u 3 can be similarly derived from 12 and results in a complex solution which is a generalization of the lengthy solution shown in polubarinova kochina 1962 sec 13 4 eq 4 18 p 503 one should note here that the present expansion includes as a special case the result previously derived by polubarinova kochina for α μ 1 the perturbation solution reduces to the first regular perturbation series by polubarinova kochina 1962 sec 13 4 eqs 4 15 4 16 p 503 with the typo in the exponent of h 1 as pointed out by moutsopoulos 2010 although the structure of the above equations and solutions is similar to the ones published by polubarinova kochina 1962 there is however one essential difference in the form of the expansion used and the results obtained polubarinova kochina employed a perturbation series in terms of a small parameter that is subsequently defined in terms of the boundary conditions of the problem at hand for the two cases of recharging μ ν and discharging aquifer μ ν different expansions were used in terms of two different perturbation parameters and the zero order term α was either set equal to the boundary value μ or the initial value ν in the current expansion the perturbation parameter ε 1 has no physical significance and the zero order term α is not predefined but it is estimated in an optimal framework using the method of weighted residuals as shown below as the choice of α affects the results significantly this approach offers significant flexibility in ensuring an acceptable solution for all time and flow conditions this novel perturbation expansion approach is in contrast to the traditional one whereby the series is expanded around a fixed point whose accuracy deteriorates when the evaluation point is far from the expansion point 3 2 representative depth the dimensionless parameter α α h o is a measure of the depth that best represents the saturated thickness of the aquifer it can also be considered as the scaling parameter that adjusts the linear solution so that the underlying nonlinear behavior is accurately simulated one method of estimating α consists of minimizing the difference or the residual r between the original nonlinear equation and its approximation over the solution domain this is generally known as the method of weighted residuals ames 1965 and it has many particular forms depending on the choice of the weight function w 15 0 w r d η 0 the method of moments makes use of the family of polynomials w η n while galerkin s method employs the derivative of the approximate solution with respect to the unknown parameter w u α substituting the first order solution u α u 1 into the original differential eq 8 and simplifying using 10 an expression of the first order residual is derived 16 r 1 d d η u 1 d u 1 d η the zero moment of 16 is obtained from 15 using w 1 it yields after integration and substitution of the boundary conditions 17 r 1 0 0 r 1 d η μ α ν μ 2 π α solving r 1 0 0 for the dimensionless scaling parameter α one obtains α μ the first moment of 16 whereby w η yields after integration by parts 18 r 1 1 0 η r 1 d η 1 2 h l α 2 h b α 2 here hl is the first order head at the far end boundary for sudden variations in a semi infinite medium hb μ and hl ν one obtains from the solution of r 1 1 0 19 α μ ν 2 the above result has been suggested by previous investigators e g guo 1997 as the best estimate for an overall prediction of the water table profile based on comparison with the numerical solution it is herein derived theoretically using error minimization concepts an expression for the second order residual can be derived in a similar fashion in terms of the second order solution terms however the result is not particularly useful since it requires a priori the form of the solution u whereas the moments of the first order residual 17 18 are expressed solely in terms of the boundary conditions and they can thus be evaluated independently of the shape of the water profile 4 green s function model 4 1 perturbation solution for general initial and boundary conditions the water table response in the aquifer is derived from the solution of the original nonlinear partial differential eq 4 an approximate analytical solution is again obtained using the same perturbation expansion approach coupled with the green s function method expanding the variable h in the form of a series in ascending powers of ε 20 h α ε h 1 ε 2 h 2 ε 3 h 3 o ε 4 substituting the perturbation series 20 into 4 and accounting only for terms of ε up to the 2nd order one obtains a sequence of linear partial differential equations 21 h 1 t κ 2 h 1 x 2 22 h 2 t κ 2 h 2 x 2 ω x h 1 h 1 x where κ αω is the dimensionless hydraulic diffusivity of the aquifer κ κ t o l o 2 κ k α φ the solution of eqs 21 22 can be conveniently constructed using the method of green s functions greenberg 1971 the general solution of 23 h t κ 2 h x 2 s is obtained in an integral form in terms of the appropriate green s function g 24 h 0 l h i x s g t s 0 d x s κ 0 t h b t s g x s x s 0 d t s 0 t 0 l s g d x s d t s the first integral accounts for the initial water table profile in the aquifer hi the second integral relates to the stream level at the left boundary hb and the last integral pertains to the source function s that represents the last right hand side term of 22 for a semi infinite domain the corresponding green s function is given by 25 g 1 4 π κ t t s exp x x s 2 4 κ t t s exp x x s 2 4 κ t t s for a finite domain the green s function is 26 g 1 4 π κ t t s m m 1 m exp x x s 2 m l 2 4 κ t t s exp x x s 2 m l 2 4 κ t t s an alternate expression to 26 that is amenable to algebraic manipulation and integration is in the form of an infinite trigonometric series 27 g 2 l i 1 sin β i x sin β i x s exp κ β i 2 t t s where β i 2 i 1 π 2 l is the solution of cos β i l 0 the series 27 converges rapidly for large values of time but it has a relatively slow convergence rate for small values of time the water table profile is given by h α h 1 h 2 whereby each term is obtained from the consecutive application of eq 24 the first order term h 1 is derived for the prescribed initial and boundary condition but subtracted by α 28 h 1 0 l ν α g t s 0 d x s κ 0 t h b t s α g x s x s 0 d t s while the second order term h 2 is derived for the source function s with zero initial and boundary conditions 29 h 2 ω 0 t 0 l x s h 1 h 1 x s g d x s d t s that is h 1 is the linear solution while h 2 is the correction term the correction term h 2 can also be written in terms of the first derivative of h 1 with respect to x and t that is more suitable for numerical integration 30 h 2 0 t 0 l s 1 g d x s d t s where 31 s 1 ω h 1 x 2 h 1 α h 1 t t t s x x s the dimensionless flux q q l o k h o 2 at x 0 at various orders is obtained from 2 using the expansion 20 32 q 1 α h 1 x 33 q 2 α h 2 x h 1 h 1 x where 34 h 2 x 0 t 0 l s 1 g x x 0 d x s d t s the dimensionless flow volume v v φ h o l o per unit width is defined by 35 v ω 0 t q d t 0 l h ν d x the dimensionless volume at various orders is then 36 v 1 0 l h 1 α ν d x 37 v 2 0 t 0 l s 1 γ d x s d t s where γ is the integral of the green s function defined in appendix a eq a 7 the double integrals 30 34 and 37 must be evaluated numerically noting that s 1 in the respective integrands is expressed only in terms of the integration variables xs and ts hence the bracket term s 1 31 is to be evaluated only once and subsequently reused for all values of x or t 4 2 representative depth the representative depth α is again obtained using the method of weighted residuals 38 0 t 0 l w r d x d t 0 substituting the first order solution h α h 1 into the original differential eq 4 and simplifying using the equality 21 the first order residual r 1 is 39 r 1 ω x h 1 h 1 x integrating 39 over the space domain using 38 and the weight function w 1 one obtains the zero moment of the residual 40 r 1 x 0 0 l r 1 d x ω h b α h 1 x x 0 solving r 1 x 0 0 for the dimensionless scaling parameter α one gets α hb the first moment of the residual r 1 x 1 is obtained from 38 using w x and yields 41 r 1 x 1 ω 2 h l α 2 h b α 2 solving r 1 x 1 0 the estimate of the dimensionless scaling parameter α is then 42 α h b h l 2 one can derive additional estimates of the parameter α by integrating the residual expressions over the time domain minimizing r 1 x 0 over the flow duration r 1 t 0 0 t r 1 x 0 d t and solving the resulting expression r 1 t 0 0 for α with h 1 x x 0 set to be constant one gets 43 α 1 t 0 t h b d t similarly integrating r 1 x 1 over time and solving r 1 t 1 0 for the parameter α one obtains 44 α 1 2 0 t h b 2 h l 2 d t 0 t h b h l d t therefore there are four major options for the estimation of the representative depth or scaling parameter α as expressed by 44 43 42 and α hb t they are derived from equating to zero the zero and first moments of the first order residual r 1 x 0 1 or the time integrated moments of the first order residual r 1 t 0 1 additional estimates of α can be found from the application of 42 at the temporal centroid of the distribution tc or at the geometric mean of the plotted time values tgm instead of integration over the time domain as in 44 for the most accurate estimation the time limits of the integrals 43 and 44 should capture any large variation in the variable of interest head or flow previous approaches for estimating the average or representative depth α were based on comparing the linear solution of some specific problems with their nonlinear counterparts the comparison between the exact solution and the linearized solution for the unsteady drainage from an initially saturated semi infinite horizontal aquifer gave α h i 3 where hi is the initial depth of water in the aquifer while for the case of steady groundwater flow between parallel rivers in a horizontal aquifer dupuit formula the comparison suggested that α h i 2 brutsaert 1994 in the present formulation the choice of α is not preset or fixed but it is dynamically defined by the above relationships 5 particular results the perturbation solution 28 29 can handle any form of transient variation of the stream level and pertains to finite as well as semi infinite aquifer domains particular results are presented herein for the sudden and the piecewise linear variation that can simulate any arbitrary fluctuation of the stream level the solution pertaining to the abrupt drop are of practical importance in recession flow analysis while the solutions pertaining to the varying stream level are of particular importance in stream aquifer interaction studies the solutions are constructed from three terms the representative depth α the linear solution and the correction term the first order linear solutions are all in explicit form the second order correction terms that are derived through 26 are in an integral form whereas the alternate form of g 27 allows the derivation of the complete solution in an explicit series form previous attempts at solving the boussinesq equation were restricted to its linear version and the linearized solutions were presented in the form of a convolution integral that is to be evaluated numerically e g govindaraju and koelliker 1994 or in the form of a laplace based solution that is to be numerically inverted e g hernandez and uddameri 2014 for a sudden variation with hi ν α and hb μ α in a semi infinite domain the first order term h 1 is obtained from 28 and results in the same expression as 13 while the correction term h 2 is given in integral form cf eqs 29 or 30 although a straightforward analytical integration of 29 was not possible the final result 14 is known from the similarity solution the analytical results pertaining to the case of a sudden variation in a finite aquifer are presented in appendix b the water table response is evaluated from h α h 1 h 2 whereby two forms of the first order term h 1 are given by eqs b 1 and b 7 respectively alongside the explicit form of the correction term h 2 b 8 also shown are the expressions b 3 b 4 needed to evaluate the integral form of the correction term h 2 30 alongside the first order expressions of the flux b 3 and cumulative flux b 5 the results pertaining to the case of a piecewise linear variation 6 bordering an aquifer of limited and unlimited extent are presented in appendix c two sets of results are shown one for each of the semi infinite and finite domain in addition two alternate sets of expressions are presented for the latter case one whose perturbation series terms are all in an explicit series form c 17 c 18 and the other e g c 1 whose correction term h 2 is an integral of the first order derivative terms e g c 4 c 5 also shown are the expressions for the first order flow rate eq c 8 and volume eq c 10 or c 14 6 hydrological applications analytical models for simulating the water table response as well as the stream aquifer interaction were presented in the previous sections using two approaches the similarity based model that is applicable for semi infinite aquifers with constant boundary conditions and the green s function model that can handle a time varying stream level at the boundary of finite and semi infinite aquifers in the present work particular results for a sudden change and a piecewise linear variation were derived and they are used herein to formulate explicit algebraic expressions for the flow exchange at the stream aquifer interface the perturbation solutions ps are validated against the numerical runge kutta solution rk for the special case of constant hb in a semi infinite domain and a finite difference solution fd with a non uniform grid distribution for the general fluctuating case a fine grid spacing is used near the inlet and the spacing was progressively increased as one moves away from the stream aquifer boundary a very small initial time step is also employed for the precise evaluation of the flow rate and volume the finite difference code was corroborated with the exact solutions in barenblatt et al 1990 and parlange et al 2000 and the higher order runge kutta solution the first order terms h 1 are all in explicit form while the second order terms h 2 are partly in integral form that are evaluated using the gauss legendre quadrature in the latter case the domain of integration is subdivided into time segments corresponding to the piecewise linear variation of the stream level to reduce the error resulting from integration of a discontinuous integrand for the semi infinite integral solutions the domain of integration 0 is also divided into two subdomains 0 1 and 1 and a transformation of the variable of integration through z 1 x is carried out on the second integral so that the semi infinite domain of integration 1 transforms into a finite one 0 1 the accuracy of the numerical integration scheme was validated by comparing the green s function integral solution 30 with the corresponding explicit solution for the special case of a sudden change in a semi infinite aquifer 14 the solutions for a finite aquifer for large values of l were also corroborated with the corresponding solutions for a semi infinite aquifer the series solutions derived from 26 required very few terms with m ranging from 4 to 4 rather than to for the time range values shown in the graphs while those derived from the trigonometric series 27 required a larger number of terms for the same order of accuracy i e i 100 and i 1 100 however the number of terms in the inner series of the multiple series summation that appear in the second order terms b 8 and c 18 was restricted to a small number i e i 2 10 and i 3 10 as their contribution to the final numerical value was relatively minimal when compared to the contribution of the outer series one should be reminded that the series 26 is computationally more efficient for small times than large times and vice versa for the series 27 the variable of primary hydrologic interest is the flux entering or exiting the aquifer hydrological applications include the quantification of the volume stored or extracted in riverbanks for flood and water balance calculations as well as the evaluation of the water table response to a change in the stream level for ditch irrigation or dewatering purposes numerical results illustrating these examples of practical importance are presented in this section 6 1 aquifer response the aquifer response due to the transient variation of the stream flow is of particular interest in stream aquifer interaction studies of practical importance in border irrigation applications is the zone of influence of a flood wave on the adjacent tillage fields 6 1 1 sudden variation the water table response to a sudden stream level variation is depicted in fig 3 for two recharge and discharge scenarios fig 3a shows the water table profile as a function of the similarity variable η x 4 ω t for two recharge scenarios of μ 3 and μ 5 with ν 1 while fig 3b depicts the water table for a sudden drawdown to a depth of μ 1 from an initial water level set at ν 3 and ν 5 ps curves also displayed are the runge kutta numerical solutions rk curves and the original polubarinova kochina series solution with α 1 pk curve the optimal perturbation solutions were generated using α 2 and α 3 as estimated from 19 the second order perturbation solutions are very close to the numerical solution for all the cases shown the mean relative error is around 2 for μ 5 recharge and ν 5 discharge and it is less than 1 for μ 3 recharge and ν 3 discharge it is also obvious from the poor performance of the pk curve that a proper choice of the scaling parameter α is essential for ensuring the accuracy of the perturbation solution numerical comparisons of the polubarinova kochina solutions by previous investigators e g kacimov 2001 moutsopoulos 2010 led to the conclusion that the perturbation solution is valid for small values of μ since the variation of the water table becomes non monotonic and non physical for high μ values as displayed in fig 3b this conclusion is true if the representative depth α is taken as h i or h b as in the original derivations of polubarinova kochina excellent results can still be obtained from the perturbation expansion if a proper scaling of the water table height is used by substituting the optimal estimate of α as done in the present work 6 1 2 gradual variation the water table response to a flood wave in the form of an isosceles triangular hydrograph cf fig 2 or fig 6 is portrayed in fig 4 the profiles are generated for ω 0 25 and at different times after the occurrence of the peak streamflow in order to simulate the aquifer response during flow reversal the perturbation solution performs very well even in the presence of significant transient dynamics in the aquifer the accuracy is due to the estimate of the time dependent scaling parameter α in the evaluation of the solutions the curves were generated using 43 that yields α 9 2 t 4 t for 1 t 2 and α 1 4 t for t 2 the resulting mean relative error of all three simulations is within 1 eq 44 provides an estimate of α with similar accuracy while both eq 42 and α hb t results in a poorer performance as shown for t 2 α 1 using a one time estimate of α as opposed to a time varying α for all three runs with t set equal to the arithmetic mean of the three simulations times t tam 2 167 the geometric mean t tgm 2 08 or a preselected value t 2 α 3 predicts the water table response to within a 2 mean relative error therefore the one time estimation of α can also be considered to be appropriate for most practical applications the elevation of the water table in a finite aquifer with l 1 and ω 0 25 is shown in fig 5 alongside the generated one for a semi infinite aquifer the scaling parameter was computed from 43 using t t g m 1 for a one time estimate of α 3 the simulated water table profiles for all three times are within a relative error of 1 5 the semi infinite model si generates the same profile as the more complicated finite aquifer model fi until the water table begins to vary at the impervious far end boundary at t 0 5 the water surface profile of the finite aquifer separates from the semi infinite one at the boundary and becomes horizontal in compliance with the prescribed boundary condition at t 1 the simulated water profiles fi and si are apart for over half the length of the aquifer the output of the semi infinite and finite aquifer models are indistinguishable over most of the domain l for α ω t l 2 20 as can be deduced from a mathematical comparison between eqs c 2 and c 11 at x l in case of a sudden rise or drop the semi infinite and finite aquifer profiles are identical throughout the domain of length l until the time α ω t l 2 10 fig 6 illustrates the temporal variation of the water table height at the midpoint of the finite aquifer x 0 5 for the same scenarios as in fig 5 the curves were generated using a time varying α as evaluated from 43 for each time point with a mean relative error of around 1 a one time estimate of α 2 for a single time interval 0 4 performs equally well with a slightly larger mean relative error of around 2 5 also displayed is the first order linear solution with α 2 to highlight the contribution of the correction term the variation of the water table is identical in both the infinite and semi infinite aquifer in the early phases until the influence of the far end boundary appears at t 1 the water table height in the finite aquifer fi is more accentuated than in the semi infinite case si due to the presence of the impervious boundary that limits the spread of the groundwater mound on the other hand the absence of a boundary attenuates the variation of the water table height and results in an earlier peak the presence of a boundary has a significant effect on the aquifer domain x l 2 for α ω t l 2 16 for any stream level variation within a time scale shorter than l 2 16 α ω the semi infinite model is appropriate for all practical purposes since the groundwater response is likely to die out before the boundary effect takes place 6 2 bank storage and depletion the flux exchange between the stream and aquifer is of hydrological interest as it quantifies the amount of water stored or depleted from the aquifer the flow rate and cumulative flow rate for a sudden and a gradual variation of the stream level are presented herein they are evaluated from q q 1 q 2 and v v 1 v 2 using eqs 32 37 and the pertinent solutions 6 2 1 sudden variation for a sudden variation in a semi infinite domain one can express the flux and volume in terms of the flow coefficient c 45 q c 4 ω t v c ω t where 46 c γ π α 1 2 π 1 2 δ 3 8 8 π 2 3 3 9 π δ 2 and 47 α μ ν 2 δ μ ν μ ν γ μ 2 ν 2 eq 46 is the third order expression of c with each term representing the contribution of each order the flow rate q is decaying at a rate proportional to the inverse square root of time while the volume v is linearly related to the square toot of time the two variables q and v are also inversely related q c 2 2 v or simply related through the time variable v 2ωqt although q or v are stated in the familiar form 45 the flow coefficient c is herein formulated differently 46 due to the appropriate definition of α table 1 compares the values of the normalized flow coefficient c γ with exact numerical results for various scenarios including the extreme case of a recharge of a dry aquifer ν 0 and discharge into a dry stream μ 0 the comparison includes the second order estimate c 2 the first two terms of 46 the third order estimate c 3 c the original polubarinova kochina 1962 series with two and three terms c pk 2 and c pk 3 whereby α μ the traveling wave solution c tw basha 2013 and the lockington 1997 formulation c wr the exact numerical values are obtained from the runge kutta solution and they have already appeared in many previous studies e g hayek 2019 the traveling wave estimate c tw is expressed by 48 c tw γ 2 α 1 1 w w 2 δ 1 δ 3 here w is a weight parameter that ranges from 0 to 1 it is best equal to 3 4 for recharging conditions and 3 5 for discharging conditions basha 2013 it should be noted that both the original and modified perturbation series do not involve any fitting parameter while the traveling wave estimate is in terms of one fitting parameter w and the lockington formulae are stated in terms of two fitted expressions all of the above mentioned approximations consist of distinct formulae that are applicable to any combination of μ and ν including the extreme cases of ν 0 and μ 0 although there are a number of other approaches for the evaluation of the flow coefficient e g hayek 2019 moutsopoulos 2010 tolikas et al 1990 they all involve a number of fitting parameters or coefficients that need to be estimated or tabulated for any combination of μ and ν before use the results in table 1 indicates that the second and third order estimate c 2 and c 3 are accurate to within a mean relative error of 2 and 0 25 with the maximum error being slightly larger in the unlikely extreme cases they are consistently better than the polubarinova kochina estimates and significantly more accurate in discharging conditions ν μ where the third order solution of pk diverges considerably for the case of ν 10 with a relative error greater than 50 for the extreme case of seepage into an empty aquifer ν 0 the flow coefficient is 0 8995 which is less than 1 5 different from the exact numerical value of 0 8875 while the difference is less than 1 for the other extreme case that of drainage into an empty channel μ 0 obtained from the blasius solution polubarinova kochina 1962 the traveling wave solution is comparable in accuracy to the third order estimate c 3 being slightly less precise with a relative error of less than 1 while the lockington formulation is the most accurate overall given that it involves two complex fitted expressions in terms of two parameters for the case of a finite aquifer two forms of approximate expressions are available depending on the form of the linear solution used using the first three terms of the series b 1 one obtains the following two terms approximation for the flux 49 q α μ ν π α ω t 1 2 exp 4 τ 1 exp 9 τ 1 where τ 1 4 α ω t l 2 using the first three terms of the alternate series b 7 that is generally valid for large time a good approximation for v is obtained 50 v l μ ν 1 8 π 2 exp τ 2 1 9 exp 9 τ 2 where τ 2 π 2 α ω t 4 l 2 two alternate expressions of v and q can also be derived from 49 and 50 by integrating the former and differentiating the latter equation but they are slightly less accurate than 49 and 50 at either early or late times however one can obtain an expression for v of comparable accuracy to 50 if one uses the first five terms of the series b 1 51 v 2 ω q t l μ ν 4 erfc 2 τ 1 8 erfc 4 τ 1 5 erfc 5 τ 1 eq 51 is obviously more complex than 50 but it provides a direct relationship between v q and t in addition its functional form bears some resemblance to the cumulative outflow equation presented by parlange et al 2001 that is valid only for the specific extreme case of drainage into a dry stream μ 0 while eq 51 or 50 apply to any combination of recharge μ ν and discharge μ ν scenarios fig 7 illustrates the recharge and discharge rates for a sudden variation of the stream level from a constant value of 1 to 5 and vice versa for different aquifer extents and two flow parameter values ω 1 4 and ω 1 2 the curves were generated from eqs 32 33 using the pertinent solutions and the first moment estimate of α i e eq 19 for the semi infinite case and eq 44 for the finite domain case a one time estimate of α over the time domain 0 10 was used in all the runs and provided ample accuracy a slightly better estimate of α can be obtained if one uses t tc the time centroid of the flux distribution although its estimation requires a two step process the first step is to evaluate the flux distribution q t using t tgm and the second step is to refine the estimate of α using the computed value of t tc from q t the inflow and outflow volumes corresponding to the flow rates of fig 7 are illustrated in fig 8 using the same estimate of α the prediction of the flow rate and volume using 44 is overall excellent the two terms expressions 49 and 50 with a proper choice of α are also a good approximation as shown in fig 7 and fig 8 ap curves the relative error of the algebraic approximations is within 5 for both the recharging and discharging case which is quite acceptable for practical application the one time estimate of α was obtained from 44 using the following two terms approximation for the head at the far end boundary b 7 52 h l μ ν μ 4 π exp τ 2 1 3 exp 9 τ 2 the ap curves shown in fig 8 were generated by evaluating eq 44 over the plotted time domain 0 3 the estimate of α can be slightly refined by updating the value of τ2 in an iterative fashion as it is also defined in terms of α it is interesting to note that for the same difference of head μ ν the variation of the flux is not symmetric with the wetting front being faster than the drying front as revealed in fig 7 the fact that water seeps more easily into than out of the aquifer is a common feature of the nonlinear solution the flow rate q decreases to zero faster for larger values of ω and smaller values of l similarly the cumulative flow v reaches its asymptotic value of l μ ν faster for smaller values of l and larger values of ω higher values of ω imply a higher hydraulic diffusivity of the aquifer k φ i e a quicker spread of water one can infer from 49 that the flux for a finite aquifer deviates from the semi infinite flux 45 by more than 10 for α ω t l 2 3 one can also deduce from 50 that the steady state capacity μ ν l is attained for a flooding period exceeding αωt 1 5l 2 conversely one can state that the finite aquifer is drained by more than 95 at αωt 1 5l 2 6 2 2 gradual variation for a linearly increasing water level hb a 1 t from a zero initial value hi ν 0 the exact solution of the water table is h a 1 t x a 1 ω barenblatt et al 1990 the corresponding exact flux and volume are given by 53 q e a 1 a 1 ω t v e a 1 a 1 ω t 2 2 the corresponding second order flux rate and volume are obtained from c 8 c 9 54 q q 1 q 2 a 1 t 1 2 π κ α ν a 1 t 32 3 π 9 π 55 v v 1 v 2 a 1 t 3 2 ω π κ 2 3 α ν 2 a 1 t 32 3 π 45 π table 2 compares the exact results 53 with the perturbation solutions 54 55 for two estimates of the scaling parameter the use of the zero moment estimate α hb t provided a more precise simulation of q than the first moment estimate 42 as noted by the decrease in the relative error from 3 6 to 1 47 on the other hand the computation of v is more accurate with α as computed from 42 it is interesting to note that the choice of α hb t agrees with the correction proposed by hogarth et al 1997 that considers the diffusivity to be linear in time in the simple linear rise case one should also note that the error is maximum for this extreme case due to the strongly nonlinear process involved in the wetting of a completely dry aquifer ν 0 the algebraic eqs 54 55 apply to any value of ν and perform very well for nonzero values of ν as shown in figs 9 and 10 ae curves fig 9 depicts the variation of the flow rate in a semi infinite and finite aquifer for two piecewise linear variations in hb a gradual linear rise to a new constant value and the common rise and fall of the stream level associated with a flood wave and approximated herein by the isosceles triangular hydrograph cf fig 6 the curves were generated from eqs 32 33 using the solutions derived for the gradual variation case appendix c the scaling parameter α is estimated from 43 and yields excellent reproduction of both the flux rate fig 9 and the cumulative flux fig 10 throughout the whole simulation period due to the time varying estimate of α the root mean squared error values on q ranges from 0 21 to 0 33 while those on v ranges from 0 020 to 0 032 for the graphs shown these values represent a relative error of less than 1 when normalized with respect to the simulated maximum values a one time estimate of α for a pre selected time window 0 tgm produces equally acceptable results the ps model reproduces very well the transient change in flux fig 9 as manifested by both positive and negative values of q that is due to the flow and ebb effect associated with the passing of a flood wave previous studies govindaraju and koelliker 1994 hogarth et al 1997 noted the difficulty of obtaining a uniformly accurate simulation for different time varying stream level scenarios using a pre defined transmissivity or diffusivity even with the correction proposed by hogarth et al 1997 that improved the prediction in the rising stage the authors acknowledged that their modified linear solution is not a good approximation to the numerical solution after the flow reversal the superior performance of the ps model as illustrated in fig 9 is mostly due to the dynamic evaluation of the parameter α as opposed to an adopted preset value or form as in the above mentioned studies the presence of a boundary has a more considerable effect on the flux rate for a linear rise than for a cyclic variation of hb fig 9 however the flux variation for a semi infinite and a finite aquifer become indistinguishable in both cases for l 2 3αωtd where td 2 is the base duration of the triangular hydrograph the flux drops markedly when the stage level starts decreasing and the rate of decline in the linear rise case is similar in trend to the one arising from an abrupt rise in hb in the cyclic variation of the stream level the flux drops to negative values indicating a flow reversal and it goes eventually to zero as the stream and aquifer levels become equal although the flux rate of the sudden and gradual rise is markedly different in the initial stages the discrepancy in the volume between the two solutions is within 5 after a time t 3 results not shown this is particularly useful in practical applications as the cumulative flow is an integral property and the integration process tends to attenuate measurement errors as opposed to the calculation of the flux rate that amplifies them fig 10 displays the variation of the accumulated flux in a semi infinite and finite aquifer for different aquifer extents and two flow parameter values ω 1 4 and ω 1 8 the bank storage increases with increasing values of ω and decays faster for smaller values of l and larger values of ω the time of peak storage happens when q 0 and it occurs after the occurrence of the maximum stream level t 1 the recession period is 4 to 8 times longer than the rising period even though the rate of rise and fall of the stream level is the same the algebraic eq 55 provides a conservative estimate of the volume stored in a semi infinite aquifer over the period in which a linear increase in the stream level is taking place the approximation is also valid for a finite aquifer up until the effect of the impervious boundary emerges 7 conclusions in the present work approximate solutions of the boussinesq equation for groundwater flow in horizontal aquifers were derived the analytical solutions pertain to the case of a sudden and a gradual variation of the water level in the stream that is bordering an aquifer of limited and unlimited extent the nonlinear boussinesq equation was analytically tackled via a refinement of its linearized solution in a perturbation series framework the method of green s function was used to derive the solution in a general form that can handle through analytical or numerical integration any form of transient variation of the stream level the general versatile solution is composed of three parts the representative depth α the linear solution and the correction term that is derived from the perturbation expansion the aquifer response due to the transient variation of the stream flow is of particular importance in stream aquifer interaction studies and the present solutions performed considerably well for the fluctuating inlet case with sharp reversal of flow conditions application of the perturbation solutions to the standard benchmark cases attested also to the excellent performance of the models comparisons with an exact analytical solution and numerical solutions of the boussinesq equation confirmed the validity and accuracy of the derived approximations the perturbation solutions were able to simulate the original nonlinear behavior with high precision due to the introduction of the representative depth parameter α that is evaluated in an optimal fashion for any given flow condition whether recharge or drainage it rectified and improved the original diverging series presented by polubarinova kochina 1962 for the classical case of an abrupt rise or drop of the stream level in a semi infinite aquifer excellent estimates of the flow and volume exchange are thus obtained with this simple modification in some cases the linear solution with a proper value of α is of sufficient accuracy for practical purposes this is especially true for the case of a gradual variation of the stream level bordering a finite aquifer the present formulation of the representative depth α resolves the longstanding issue of defining the appropriate transmissivity or diffusivity value κ αω in the widely applied linearized boussinesq solutions for abrupt boundary changes the scaling parameter α is best evaluated from 42 for the simulation of the water table h x and from eq 44 for the flow q t and volume v t computations the parameter α is a constant value in a semi infinite aquifer while it is time varying for a finite aquifer due to the varying head at the impervious boundary hl cf eq 52 for a gradual variation of hb eq 43 produces the best estimate of α for the simulation of the water table h x as well as the variation of the flow q t and volume v t the parameter α can be computed for each time point or evaluated once for a pre selected time range however the time varying α produces results of higher accuracy while a one time estimate of α yields equally good results but with a slightly less precision the time integrated moment estimate of α is also more accurate primarily because integration tend to minimize the deficiencies of the approximation numerical results highlighted the effect of the far end impervious boundary on the flow and volume exchange at the inlet boundary and provided the criteria for the proper use of the semi infinite simplifications the optimal perturbation solutions also allowed the derivation of new algebraic expressions for the flow and volume exchange at the stream aquifer interface for riparian aquifers of finite width explicit flow equations were thus obtained for easy implementation in recession flow analysis the present results are suitable modeling tools for the quantification of the bank storage in flood events the bank depletion in drought periods the base flow contribution to streamflow and the estimation of the aquifer parameters additional application can include the delineation of the influence zone of the adjacent stream and the evaluation of the velocity field that is particularly useful for contaminant transport in aquifers the analytical results are especially valuable in situations where detailed information on aquifer properties is scant declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the graphical results were all generated for hypothetical data no external data was used in this study appendix a green s functions two forms of the green s function for a finite domain were presented eqs 26 and 27 the green s function for a semi infinite domain 25 is the special case of 26 for m 0 eq 26 is computationally more suitable for small times rather than large times as can be deduced from the error function argument and vice versa for the other expression 27 the perturbation series terms for the water table height flux rate and volume are expressed in terms of the derivative or integrals of the green s function the latter are presented herein for the sake of completeness the water table solution 28 is in terms of g x s at xs 0 a 1 g x s x s 0 1 4 π m m 1 m c m x κ 3 2 τ 3 2 exp c m x 2 4 κ τ the second order term of q 34 is in terms of g x at x 0 a 2 g x x 0 1 π m m 1 m c m x s 4 κ 3 2 τ 3 2 exp c m x s 2 4 κ τ c m x s 4 κ 3 2 τ 3 2 exp c m x s 2 4 κ τ the second order term of v 37 is in terms of the integral of the green s function γ a 3 γ 0 l g d x 1 2 m m 1 m erf c m l x s 4 κ τ erf c m l x s 4 κ τ erf c m x s 4 κ τ erf c m x s 4 κ τ where a 4 τ t t s c m 2 ml for a semi infinite domain one sets m 0 in the above expressions the equivalent expressions using the alternate form of g are a 5 g x s x s 0 2 l i 1 β i sin β i x exp κ β i 2 t t s a 6 g x x 0 2 l i 1 β i sin β i x s exp κ β i 2 t t s a 7 γ 2 l i 1 1 β i sin β i x s exp κ β i 2 t t s appendix b sudden variation finite domain integral form the solution for the water table profile is given by h α h 1 h 2 whereas the flow rate and volume can then be derived using 32 37 for a sudden variation of the boundary head the linear solution is expressed by b 1 h 1 μ α μ ν 2 m m 1 m 2 erfc ζ x erfc ζ x l erfc ζ x l where b 2 ζ z z c m σ c m 2 ml σ 4 κ t for a semi infinite domain with m 0 and l eq b 1 reduces to 13 the correction term h 2 is given in integral form 30 whereby g is expressed by 26 and b 3 h 1 x μ ν π σ m m 1 m 2 exp ζ x 2 exp ζ x l 2 exp ζ x l 2 b 4 h 1 t 2 κ μ ν π σ 2 m m 1 m 2 ζ x exp ζ x 2 ζ x l exp ζ x l 2 ζ x l exp ζ x l 2 the first order flux term q 1 is obtained from 32 using b 3 while the first order cumulative flow v 1 is b 5 v 1 μ ν l σ 2 m m 1 m f 1 ζ 2 l 3 f 1 ζ l 3 f 1 ζ 0 f 1 ζ l where ζ z and σ are given by b 2 and b 6 f 1 z z erf z 1 π exp z 2 the volume expression b 5 is derived from the integration of h x rather than the integration of q t cf eq 35 as it is computationally more efficient especially if the large time green s function form 27 is used the second order flux component q 2 and cumulative flux component v 2 can be evaluated from 33 and 37 respectively using numerical quadrature finite domain series form a fully explicit form of the above solution can be derived from the alternate expression of g 27 the water table profile in a finite aquifer is again given by h α h 1 h 2 where b 7 h 1 μ α ν μ 2 l i 1 1 β i sin β i x exp κ β i 2 t and b 8 h 2 ω α μ ν μ 2 t l i 1 β i sin β i x exp κ β i 2 t ω ν μ 2 8 κ l 3 i 1 1 i 2 1 i 3 1 d 123 β i 1 β i 1 2 β i 2 2 β i 3 2 sin β i 1 x exp κ β i 1 2 t exp κ β i 2 2 t κ β i 3 2 t here β i 2 i 1 π 2 l and b 9 d 123 β i 1 2 β i 2 2 β i 3 2 β i 1 β i 2 β i 3 β i 1 β i 2 β i 3 β i 1 β i 2 β i 3 β i 1 β i 2 β i 3 the flow rate and volume can be easily derived from the first and second order solution terms b 7 and b 8 using 32 37 as it involves simple differentiation and integration of trigonometric and exponential terms appendix c gradual variation semi infinite domain the water table response for the piecewise linear variation of hb 6 can be found from the straightforward application of 28 however a more elegant and computationally efficient form is derived by specifying the solution as a sum of two parts one that satisfies the boundary conditions while the other satisfies the altered governing equation and initial condition c 1 h 1 h b α a 1 h 0 t u t a n a n 1 h 0 t t n 1 u t t n 1 where c 2 h 0 t x 2 2 κ t f 0 ξ ξ x 4 κ t and c 3 f 0 z 2 z π exp z 2 1 2 z 2 erf z the correction term h 2 is given in integral form 30 whereby g is expressed by 25 and c 4 h 1 x a 1 h 0 x t u t a n a n 1 h 0 x t t n 1 u t t n 1 c 5 h 1 t h b t a 1 h 0 t t u t a n a n 1 h 0 t t t n 1 u t t n 1 with c 6 h 0 x t 2 t π κ exp ξ 2 π ξ erfc ξ c 7 h 0 t t erf ξ the first order flux term q 1 is obtained from 32 using c 4 and ξ 0 that is c 8 q 1 2 α π κ a 1 t 1 2 u t a n a n 1 t t n 1 2 u t t n 1 the second order flux term q 2 can be derived from 33 in an analytical form for the first segment 0 t t 1 only c 9 q 2 a 1 t 1 2 π κ a 1 t 32 9 π 1 3 ν α the first order volume is c 10 v 1 4 α 3 π κ a 1 t 3 2 u t a n a n 1 t t n 3 2 u t t n 1 finite domain integral form for a finite domain with a piecewise linear variation of hb the first order solution is similarly expressed by c 1 with h 0 replaced by h 1 c 11 h 1 t x x 2 l 2 κ t 2 m m 1 m f 0 ζ x l f 0 ζ x l 2 f 0 ζ x here f 0 ζ z is given by c 3 and ζ z is given by b 2 for a semi infinite domain with m 0 and l the h 1 t function c 11 reduces to the h 0 t function c 2 the correction term h 2 is again given in integral form 30 wherein g is expressed by 26 and the derivative terms h 1 x and h 1 t are similarly expressed by c 4 c 5 with h 0x and h 0t replaced by h 1x and h 1t respectively c 12 h 1 x t x l κ σ 2 κ m m 1 m f 1 ζ x l f 1 ζ x l 2 f 1 ζ x c 13 h 1 t t 1 2 m m 1 m erf ζ x l erf ζ x l 2 erf ζ x here f 1 ζ z is given by b 6 ζ z and σ are again given by b 2 the first order flux q 1 is obtained from 32 using c 4 and c 12 the first order cumulative flow v 1 is c 14 v 1 a 1 v 1 t u t a n a n 1 v 1 t t n 1 u t t n 1 where c 15 v 1 t l 3 3 κ σ 3 24 κ m m 1 m f 2 ζ 2 l 3 f 2 ζ l 3 f 2 ζ 0 f 2 ζ l c 16 f 2 z z 3 2 z 2 erf z 2 π 1 z 2 exp z 2 the second order flow q 2 and volume v 2 can be computed from 33 and 37 respectively finite domain series form using the alternate expression for the green s function g 27 a fully explicit form of the above solution can be derived the linear solution h 1 is given by c 1 with h 0 replaced by the following form of the function h 1 c 17 h 1 t 2 l i 1 1 κ β i 3 sin β i x exp κ β i 2 t 1 the correction term h 2 in the interval t n 1 t tn is in an explicit form as follows c 18 h 2 2 α l i 1 sin β i x β i h 2 1 t k 2 n h 2 k t t k 1 h 2 k 1 t t k 1 h 2 n 0 8 α κ l 3 i 1 1 i 2 1 i 3 1 d 123 β i 1 β i 2 2 β i 3 2 sin β i 1 x h 3 1 t k 2 n h 3 k t t k 1 h 3 k 1 t t k 1 h 3 n 0 where d 123 is given by b 9 and c 19 h 2 k τ a k 2 b i 2 1 b i τ b i t a k ϕ k b i exp b i τ a k τ 2 t θ i k τ ϕ k θ i k τ c 20 h 3 k τ a k 2 f τ b i 1 a k θ i 2 k f τ b i 1 b i 2 a k θ i 3 k f τ b i 1 b i 3 θ i 2 k θ i 3 k f τ b i 1 b i 2 b i 3 with f τ b i exp b i τ b i b i κ β i 2 and c 21 ϕ n α ν k 2 n a k a k 1 t k 1 c 22 θ i n a 1 exp b i t k 2 n a k a k 1 exp b i t t k 1 the subscript or superscript k on the variable ak or functions ϕ k and θ i k refer to their value in the time interval k while the i subscripts implies that they are dependent on the eigenvalues β i the summation proceeds from the second time interval in case n 1 through k n that corresponds to the time interval in which the time t is being evaluated for the specific instance of a zero value of the argument of the function f e g when b i1 b i2 the function f reduces to its limiting value of f τ 0 τ the series solution c 18 can be used as a basis for any rational approximation and simplification for specific conditions however it is computationally more efficient to evaluate the second order term h 2 through numerical integration of 30 rather than using the series solution c 18 
262,groundwater flow in an unconfined aquifer can be described by the boussinesq equation the boussinesq equation is nonlinear and approximate solutions exist only for specific flow conditions in the present work the nonlinear equation is tackled analytically via a refinement of its linearized solution in a perturbation series framework the perturbation series solution applies for any time dependent variation of the stream level and they are evaluated for various flow recharge and drainage conditions particular results for a sudden change and a piecewise linear variation are presented for both finite and semi infinite aquifers the approximate solutions can simulate the original nonlinear behavior with high accuracy due to the introduction of the representative depth parameter α that is evaluated in an optimal fashion for any given flow condition the derivation of the optimal α parameter has also allowed the generalization and improvement of the classical series results pertaining to the abrupt rise or drop of the stream level in a semi infinite aquifer in the case of a gradual variation of the stream level in a finite aquifer domain the linear solution with a time varying estimate of α is of sufficient accuracy for practical purposes explicit algebraic expressions are presented for the exchange flow rates and the associated flow volumes that are of prime interest in stream aquifer interaction studies keywords groundwater flow stream aquifer interaction boussinesq equation perturbation solutions green s function method flow expressions water table response 1 introduction groundwater flow in a phreatic aquifer can be described by the nonlinear boussinesq equation when the flow is predominantly horizontal solutions of the boussinesq equation yield the response of the water table to stream level variations and quantify the exchange flow between the stream and the aquifer these results have wide ranging applications in irrigation and drainage as well as in base flow separation and recession analysis the topic is a subject of active research and of much interest in the hydrological community as can be attested by the review paper by troch et al 2013 exact solutions of the nonlinear boussinesq equation are few the earliest solution is by boussinesq 1904 that simulates the drainage of a horizontal finite aquifer subject to a particular initial condition with zero boundary conditions additional exact solutions were later derived for specific boundary conditions and zero initial condition barenblatt et al 1990 parlange et al 2000 chor et al 2019 approximate solutions for particular flow conditions are more readily available especially when the governing equation is recast in a simpler form using similarity transformation e g boltzmann s the nonlinear partial differential equation is then reduced to an ordinary differential equation and approximate solutions are constructed using a perturbation series e g polubarinova kochina 1962 polynomial or functional approximation e g tolikas et al 1984 parlange et al 2000 lockington et al 2000 telyakovskiy et al 2002 hayek 2019 a power series approach e g lockington et al 2000 the weighted residual method lockington 1997 and the adomian s decomposition method moutsopoulos 2010 however the above class of solutions is restricted to a semi infinite domain with either a sudden change of the boundary head with uniform initial conditions or a specific functional form of the time varying stream level with zero initial conditions for arbitrary time dependent stream stage variations approximate solutions using the traveling wave approach basha 2013 and the adomian s decomposition method jiang and tang 2015 are available but they are also restricted to a semi infinite domain with a uniform initial condition solutions of the nonlinear boussinesq equation in a finite domain are fewer parlange et al 2001 derived an expression for the drainage outflow due to a sudden drawdown by improving upon the corresponding linear expression an indirect method to tackle the interaction of a wetting front with an impervious wall was also presented by hogarth et al 2002 the method uses the superposition concept to satisfy the no flux condition at the wall in an average sense the approximate response of the water table to a cyclic variation of the stream level was obtained using the adomian s decomposition method serrano et al 2007 finally a rich set of solutions of the linearized boussinesq equation exist wherein the nonlinear term is approximated by a constant depth value e g cooper and rorabaugh 1963 brutsaert 1994 the present work presents approximate solutions of the nonlinear boussinesq equation in a semi infinite and finite aquifer domain subject to a varying water level at the boundary the solution is obtained using an optimal perturbation approach whereby the perturbation series is constructed from three terms the representative depth α as the zero order term the linear solution as the first order term and the correction term as the second order term the α parameter is determined in an optimal sense that ensures the accuracy of the perturbation solution at all times and for all flow conditions this particular result is of theoretical and practical importance since an expression for the representative depth is derived as a function of the time dependent boundary head rather than pre defined as a constant value explicit solutions for the water table response and exchange flow rates are presented for a sudden and a piecewise linear variation of the water level at the boundary the solutions are evaluated for various flow conditions and illustrated with several examples of hydrological interest 2 theory the governing equation for unconfined groundwater flow in a horizontal aquifer is 1 k x h h x φ h t here h is the height of the water table measured from the impervious horizontal base of the aquifer l x is the horizontal coordinate l t is the time t k is the saturated hydraulic conductivity l t and φ is the effective porosity the subscript denotes that the variables are dimensional eq 1 is the one dimensional approximation of a two dimensional flow system whereby the hydraulic head h is assumed to be independent of depth and the contribution of the unsaturated zone is taken as negligible it is known as the boussinesq equation it is obtained by combining the continuity equation q x φ h t with the darcy discharge equation for a homogeneous flow domain 2 q k h h x the boundary conditions consist of a varying water level h h b t in the adjoining stream at x 0 at the far end of the horizontal aquifer at x l the flow is bounded by an impervious wall h x 0 the initial condition at t 0 is a prescribed water table height expressed in general form as h h i x however in the absence of recharge and the presence of the above mentioned boundary conditions a uniform initial water table height is the only plausible equilibrium condition a schematic representation of the flow domain along with the prescribed boundary conditions is shown in fig 1 introducing the following dimensionless variables 3 h h h o x x l o t t t o one obtains the following dimensionless form of the nonlinear governing equation 4 ω x h h x h t where ω is the dimensionless flow parameter defined by 5 ω k h o t o φ l o 2 the parameter h o is a characteristic depth scale that may be taken as the initial flow depth in the aquifer or the reference value of 1 m the parameter l o is a characteristic length scale that may be taken as the length of the aquifer and t o is the characteristic time scale that can be set equal to the reference value of 1 day the aforementioned dimensionless system is expressed in its most general form one can also define the normalizing parameters to be equal l o h o and proportional through t o φ h o k so that the governing eq 4 reduces to its barest form with ω 1 the boundary head at the inlet section hb is defined as a piecewise linear function of time over n segments in terms of the unit step function u t where u t 0 for t 0 and u t 1 for t 0 6 h b t h 1 u t t 0 h 2 h 1 u t t 1 h n h n 1 u t t n 1 here hk where k 1 2 n is a linear function of time defined over the interval t k 1 t tk by 7 h k a k t t k 1 υ k 1 a k υ k υ k 1 t k t k 1 where υ k is the boundary head value at time tk and υ 0 is the initial stage at time t 0 0 fig 2 the piecewise linear function can replicate the fluctuations of the water level in the stream thus reproducing a realistic behavior for all times a linearly varying water level from an initial stage ν is simulated by setting ak a 1 and υ k 1 υ 0 ν for an instantaneous increase or decrease to a level μ one sets a 1 0 and υ 0 μ 3 similarity model 3 1 perturbation solution for a semi infinite domain with constant initial hi ν and boundary condition hb μ the mathematical problem can be significantly simplified using similarity transformation that in effect reduces the partial differential equation to an ordinary differential equation by combining the independent space and time variable into a single variable η x 4 ω t known as the boltzmann transformation defining u η h x t eq 4 becomes 8 d d η u d u d η 2 η d u d η 0 eq 8 is nonlinear due to the presence of the coefficient u and an approximate analytical solution can be derived using a perturbation expansion method the perturbation approach consists of expanding the variable u in the form of a series in ascending powers of ε and determining the perturbation series terms 9 u α ε u 1 ε 2 u 2 ε 3 u 3 o ε 4 the zero order term is set to a constant term α to facilitate the subsequent derivation of the higher order solutions the perturbation parameter ε 1 is artificially introduced to separate the various order terms and help in the bookkeeping of terms of the same order substituting the perturbation series 9 into 8 and accounting only for terms of ε up to the 3rd order one obtains a sequence of linear ordinary differential equations 10 α d 2 u 1 d η 2 2 η d u 1 d η 0 11 α d 2 u 2 d η 2 2 η d u 2 d η 1 2 d 2 u 1 2 d η 2 12 α d 2 u 3 d η 2 2 η d u 3 d η d 2 u 1 u 2 d η 2 the above differential equations are solved consecutively as the second order equation is dependent on the first order solution through the nonhomogeneous term at the right hand side of 11 the first order solution u 1 is derived for the prescribed initial and boundary condition but subtracted by α while the higher order solutions are obtained for zero initial and boundary conditions the solution of 10 with u 1 0 μ α and u 1 ν α is 13 u 1 μ α ν μ erf η α the solution of 11 for zero boundary conditions is 14 u 2 α ν μ ν α π μ α 2 α μ ν 2 α π exp 2 η 2 α μ ν 2 α μ ν 1 α π η α α π exp η 2 α 1 u 1 u 1 2 2 α the derivation of the third order term u 3 can be similarly derived from 12 and results in a complex solution which is a generalization of the lengthy solution shown in polubarinova kochina 1962 sec 13 4 eq 4 18 p 503 one should note here that the present expansion includes as a special case the result previously derived by polubarinova kochina for α μ 1 the perturbation solution reduces to the first regular perturbation series by polubarinova kochina 1962 sec 13 4 eqs 4 15 4 16 p 503 with the typo in the exponent of h 1 as pointed out by moutsopoulos 2010 although the structure of the above equations and solutions is similar to the ones published by polubarinova kochina 1962 there is however one essential difference in the form of the expansion used and the results obtained polubarinova kochina employed a perturbation series in terms of a small parameter that is subsequently defined in terms of the boundary conditions of the problem at hand for the two cases of recharging μ ν and discharging aquifer μ ν different expansions were used in terms of two different perturbation parameters and the zero order term α was either set equal to the boundary value μ or the initial value ν in the current expansion the perturbation parameter ε 1 has no physical significance and the zero order term α is not predefined but it is estimated in an optimal framework using the method of weighted residuals as shown below as the choice of α affects the results significantly this approach offers significant flexibility in ensuring an acceptable solution for all time and flow conditions this novel perturbation expansion approach is in contrast to the traditional one whereby the series is expanded around a fixed point whose accuracy deteriorates when the evaluation point is far from the expansion point 3 2 representative depth the dimensionless parameter α α h o is a measure of the depth that best represents the saturated thickness of the aquifer it can also be considered as the scaling parameter that adjusts the linear solution so that the underlying nonlinear behavior is accurately simulated one method of estimating α consists of minimizing the difference or the residual r between the original nonlinear equation and its approximation over the solution domain this is generally known as the method of weighted residuals ames 1965 and it has many particular forms depending on the choice of the weight function w 15 0 w r d η 0 the method of moments makes use of the family of polynomials w η n while galerkin s method employs the derivative of the approximate solution with respect to the unknown parameter w u α substituting the first order solution u α u 1 into the original differential eq 8 and simplifying using 10 an expression of the first order residual is derived 16 r 1 d d η u 1 d u 1 d η the zero moment of 16 is obtained from 15 using w 1 it yields after integration and substitution of the boundary conditions 17 r 1 0 0 r 1 d η μ α ν μ 2 π α solving r 1 0 0 for the dimensionless scaling parameter α one obtains α μ the first moment of 16 whereby w η yields after integration by parts 18 r 1 1 0 η r 1 d η 1 2 h l α 2 h b α 2 here hl is the first order head at the far end boundary for sudden variations in a semi infinite medium hb μ and hl ν one obtains from the solution of r 1 1 0 19 α μ ν 2 the above result has been suggested by previous investigators e g guo 1997 as the best estimate for an overall prediction of the water table profile based on comparison with the numerical solution it is herein derived theoretically using error minimization concepts an expression for the second order residual can be derived in a similar fashion in terms of the second order solution terms however the result is not particularly useful since it requires a priori the form of the solution u whereas the moments of the first order residual 17 18 are expressed solely in terms of the boundary conditions and they can thus be evaluated independently of the shape of the water profile 4 green s function model 4 1 perturbation solution for general initial and boundary conditions the water table response in the aquifer is derived from the solution of the original nonlinear partial differential eq 4 an approximate analytical solution is again obtained using the same perturbation expansion approach coupled with the green s function method expanding the variable h in the form of a series in ascending powers of ε 20 h α ε h 1 ε 2 h 2 ε 3 h 3 o ε 4 substituting the perturbation series 20 into 4 and accounting only for terms of ε up to the 2nd order one obtains a sequence of linear partial differential equations 21 h 1 t κ 2 h 1 x 2 22 h 2 t κ 2 h 2 x 2 ω x h 1 h 1 x where κ αω is the dimensionless hydraulic diffusivity of the aquifer κ κ t o l o 2 κ k α φ the solution of eqs 21 22 can be conveniently constructed using the method of green s functions greenberg 1971 the general solution of 23 h t κ 2 h x 2 s is obtained in an integral form in terms of the appropriate green s function g 24 h 0 l h i x s g t s 0 d x s κ 0 t h b t s g x s x s 0 d t s 0 t 0 l s g d x s d t s the first integral accounts for the initial water table profile in the aquifer hi the second integral relates to the stream level at the left boundary hb and the last integral pertains to the source function s that represents the last right hand side term of 22 for a semi infinite domain the corresponding green s function is given by 25 g 1 4 π κ t t s exp x x s 2 4 κ t t s exp x x s 2 4 κ t t s for a finite domain the green s function is 26 g 1 4 π κ t t s m m 1 m exp x x s 2 m l 2 4 κ t t s exp x x s 2 m l 2 4 κ t t s an alternate expression to 26 that is amenable to algebraic manipulation and integration is in the form of an infinite trigonometric series 27 g 2 l i 1 sin β i x sin β i x s exp κ β i 2 t t s where β i 2 i 1 π 2 l is the solution of cos β i l 0 the series 27 converges rapidly for large values of time but it has a relatively slow convergence rate for small values of time the water table profile is given by h α h 1 h 2 whereby each term is obtained from the consecutive application of eq 24 the first order term h 1 is derived for the prescribed initial and boundary condition but subtracted by α 28 h 1 0 l ν α g t s 0 d x s κ 0 t h b t s α g x s x s 0 d t s while the second order term h 2 is derived for the source function s with zero initial and boundary conditions 29 h 2 ω 0 t 0 l x s h 1 h 1 x s g d x s d t s that is h 1 is the linear solution while h 2 is the correction term the correction term h 2 can also be written in terms of the first derivative of h 1 with respect to x and t that is more suitable for numerical integration 30 h 2 0 t 0 l s 1 g d x s d t s where 31 s 1 ω h 1 x 2 h 1 α h 1 t t t s x x s the dimensionless flux q q l o k h o 2 at x 0 at various orders is obtained from 2 using the expansion 20 32 q 1 α h 1 x 33 q 2 α h 2 x h 1 h 1 x where 34 h 2 x 0 t 0 l s 1 g x x 0 d x s d t s the dimensionless flow volume v v φ h o l o per unit width is defined by 35 v ω 0 t q d t 0 l h ν d x the dimensionless volume at various orders is then 36 v 1 0 l h 1 α ν d x 37 v 2 0 t 0 l s 1 γ d x s d t s where γ is the integral of the green s function defined in appendix a eq a 7 the double integrals 30 34 and 37 must be evaluated numerically noting that s 1 in the respective integrands is expressed only in terms of the integration variables xs and ts hence the bracket term s 1 31 is to be evaluated only once and subsequently reused for all values of x or t 4 2 representative depth the representative depth α is again obtained using the method of weighted residuals 38 0 t 0 l w r d x d t 0 substituting the first order solution h α h 1 into the original differential eq 4 and simplifying using the equality 21 the first order residual r 1 is 39 r 1 ω x h 1 h 1 x integrating 39 over the space domain using 38 and the weight function w 1 one obtains the zero moment of the residual 40 r 1 x 0 0 l r 1 d x ω h b α h 1 x x 0 solving r 1 x 0 0 for the dimensionless scaling parameter α one gets α hb the first moment of the residual r 1 x 1 is obtained from 38 using w x and yields 41 r 1 x 1 ω 2 h l α 2 h b α 2 solving r 1 x 1 0 the estimate of the dimensionless scaling parameter α is then 42 α h b h l 2 one can derive additional estimates of the parameter α by integrating the residual expressions over the time domain minimizing r 1 x 0 over the flow duration r 1 t 0 0 t r 1 x 0 d t and solving the resulting expression r 1 t 0 0 for α with h 1 x x 0 set to be constant one gets 43 α 1 t 0 t h b d t similarly integrating r 1 x 1 over time and solving r 1 t 1 0 for the parameter α one obtains 44 α 1 2 0 t h b 2 h l 2 d t 0 t h b h l d t therefore there are four major options for the estimation of the representative depth or scaling parameter α as expressed by 44 43 42 and α hb t they are derived from equating to zero the zero and first moments of the first order residual r 1 x 0 1 or the time integrated moments of the first order residual r 1 t 0 1 additional estimates of α can be found from the application of 42 at the temporal centroid of the distribution tc or at the geometric mean of the plotted time values tgm instead of integration over the time domain as in 44 for the most accurate estimation the time limits of the integrals 43 and 44 should capture any large variation in the variable of interest head or flow previous approaches for estimating the average or representative depth α were based on comparing the linear solution of some specific problems with their nonlinear counterparts the comparison between the exact solution and the linearized solution for the unsteady drainage from an initially saturated semi infinite horizontal aquifer gave α h i 3 where hi is the initial depth of water in the aquifer while for the case of steady groundwater flow between parallel rivers in a horizontal aquifer dupuit formula the comparison suggested that α h i 2 brutsaert 1994 in the present formulation the choice of α is not preset or fixed but it is dynamically defined by the above relationships 5 particular results the perturbation solution 28 29 can handle any form of transient variation of the stream level and pertains to finite as well as semi infinite aquifer domains particular results are presented herein for the sudden and the piecewise linear variation that can simulate any arbitrary fluctuation of the stream level the solution pertaining to the abrupt drop are of practical importance in recession flow analysis while the solutions pertaining to the varying stream level are of particular importance in stream aquifer interaction studies the solutions are constructed from three terms the representative depth α the linear solution and the correction term the first order linear solutions are all in explicit form the second order correction terms that are derived through 26 are in an integral form whereas the alternate form of g 27 allows the derivation of the complete solution in an explicit series form previous attempts at solving the boussinesq equation were restricted to its linear version and the linearized solutions were presented in the form of a convolution integral that is to be evaluated numerically e g govindaraju and koelliker 1994 or in the form of a laplace based solution that is to be numerically inverted e g hernandez and uddameri 2014 for a sudden variation with hi ν α and hb μ α in a semi infinite domain the first order term h 1 is obtained from 28 and results in the same expression as 13 while the correction term h 2 is given in integral form cf eqs 29 or 30 although a straightforward analytical integration of 29 was not possible the final result 14 is known from the similarity solution the analytical results pertaining to the case of a sudden variation in a finite aquifer are presented in appendix b the water table response is evaluated from h α h 1 h 2 whereby two forms of the first order term h 1 are given by eqs b 1 and b 7 respectively alongside the explicit form of the correction term h 2 b 8 also shown are the expressions b 3 b 4 needed to evaluate the integral form of the correction term h 2 30 alongside the first order expressions of the flux b 3 and cumulative flux b 5 the results pertaining to the case of a piecewise linear variation 6 bordering an aquifer of limited and unlimited extent are presented in appendix c two sets of results are shown one for each of the semi infinite and finite domain in addition two alternate sets of expressions are presented for the latter case one whose perturbation series terms are all in an explicit series form c 17 c 18 and the other e g c 1 whose correction term h 2 is an integral of the first order derivative terms e g c 4 c 5 also shown are the expressions for the first order flow rate eq c 8 and volume eq c 10 or c 14 6 hydrological applications analytical models for simulating the water table response as well as the stream aquifer interaction were presented in the previous sections using two approaches the similarity based model that is applicable for semi infinite aquifers with constant boundary conditions and the green s function model that can handle a time varying stream level at the boundary of finite and semi infinite aquifers in the present work particular results for a sudden change and a piecewise linear variation were derived and they are used herein to formulate explicit algebraic expressions for the flow exchange at the stream aquifer interface the perturbation solutions ps are validated against the numerical runge kutta solution rk for the special case of constant hb in a semi infinite domain and a finite difference solution fd with a non uniform grid distribution for the general fluctuating case a fine grid spacing is used near the inlet and the spacing was progressively increased as one moves away from the stream aquifer boundary a very small initial time step is also employed for the precise evaluation of the flow rate and volume the finite difference code was corroborated with the exact solutions in barenblatt et al 1990 and parlange et al 2000 and the higher order runge kutta solution the first order terms h 1 are all in explicit form while the second order terms h 2 are partly in integral form that are evaluated using the gauss legendre quadrature in the latter case the domain of integration is subdivided into time segments corresponding to the piecewise linear variation of the stream level to reduce the error resulting from integration of a discontinuous integrand for the semi infinite integral solutions the domain of integration 0 is also divided into two subdomains 0 1 and 1 and a transformation of the variable of integration through z 1 x is carried out on the second integral so that the semi infinite domain of integration 1 transforms into a finite one 0 1 the accuracy of the numerical integration scheme was validated by comparing the green s function integral solution 30 with the corresponding explicit solution for the special case of a sudden change in a semi infinite aquifer 14 the solutions for a finite aquifer for large values of l were also corroborated with the corresponding solutions for a semi infinite aquifer the series solutions derived from 26 required very few terms with m ranging from 4 to 4 rather than to for the time range values shown in the graphs while those derived from the trigonometric series 27 required a larger number of terms for the same order of accuracy i e i 100 and i 1 100 however the number of terms in the inner series of the multiple series summation that appear in the second order terms b 8 and c 18 was restricted to a small number i e i 2 10 and i 3 10 as their contribution to the final numerical value was relatively minimal when compared to the contribution of the outer series one should be reminded that the series 26 is computationally more efficient for small times than large times and vice versa for the series 27 the variable of primary hydrologic interest is the flux entering or exiting the aquifer hydrological applications include the quantification of the volume stored or extracted in riverbanks for flood and water balance calculations as well as the evaluation of the water table response to a change in the stream level for ditch irrigation or dewatering purposes numerical results illustrating these examples of practical importance are presented in this section 6 1 aquifer response the aquifer response due to the transient variation of the stream flow is of particular interest in stream aquifer interaction studies of practical importance in border irrigation applications is the zone of influence of a flood wave on the adjacent tillage fields 6 1 1 sudden variation the water table response to a sudden stream level variation is depicted in fig 3 for two recharge and discharge scenarios fig 3a shows the water table profile as a function of the similarity variable η x 4 ω t for two recharge scenarios of μ 3 and μ 5 with ν 1 while fig 3b depicts the water table for a sudden drawdown to a depth of μ 1 from an initial water level set at ν 3 and ν 5 ps curves also displayed are the runge kutta numerical solutions rk curves and the original polubarinova kochina series solution with α 1 pk curve the optimal perturbation solutions were generated using α 2 and α 3 as estimated from 19 the second order perturbation solutions are very close to the numerical solution for all the cases shown the mean relative error is around 2 for μ 5 recharge and ν 5 discharge and it is less than 1 for μ 3 recharge and ν 3 discharge it is also obvious from the poor performance of the pk curve that a proper choice of the scaling parameter α is essential for ensuring the accuracy of the perturbation solution numerical comparisons of the polubarinova kochina solutions by previous investigators e g kacimov 2001 moutsopoulos 2010 led to the conclusion that the perturbation solution is valid for small values of μ since the variation of the water table becomes non monotonic and non physical for high μ values as displayed in fig 3b this conclusion is true if the representative depth α is taken as h i or h b as in the original derivations of polubarinova kochina excellent results can still be obtained from the perturbation expansion if a proper scaling of the water table height is used by substituting the optimal estimate of α as done in the present work 6 1 2 gradual variation the water table response to a flood wave in the form of an isosceles triangular hydrograph cf fig 2 or fig 6 is portrayed in fig 4 the profiles are generated for ω 0 25 and at different times after the occurrence of the peak streamflow in order to simulate the aquifer response during flow reversal the perturbation solution performs very well even in the presence of significant transient dynamics in the aquifer the accuracy is due to the estimate of the time dependent scaling parameter α in the evaluation of the solutions the curves were generated using 43 that yields α 9 2 t 4 t for 1 t 2 and α 1 4 t for t 2 the resulting mean relative error of all three simulations is within 1 eq 44 provides an estimate of α with similar accuracy while both eq 42 and α hb t results in a poorer performance as shown for t 2 α 1 using a one time estimate of α as opposed to a time varying α for all three runs with t set equal to the arithmetic mean of the three simulations times t tam 2 167 the geometric mean t tgm 2 08 or a preselected value t 2 α 3 predicts the water table response to within a 2 mean relative error therefore the one time estimation of α can also be considered to be appropriate for most practical applications the elevation of the water table in a finite aquifer with l 1 and ω 0 25 is shown in fig 5 alongside the generated one for a semi infinite aquifer the scaling parameter was computed from 43 using t t g m 1 for a one time estimate of α 3 the simulated water table profiles for all three times are within a relative error of 1 5 the semi infinite model si generates the same profile as the more complicated finite aquifer model fi until the water table begins to vary at the impervious far end boundary at t 0 5 the water surface profile of the finite aquifer separates from the semi infinite one at the boundary and becomes horizontal in compliance with the prescribed boundary condition at t 1 the simulated water profiles fi and si are apart for over half the length of the aquifer the output of the semi infinite and finite aquifer models are indistinguishable over most of the domain l for α ω t l 2 20 as can be deduced from a mathematical comparison between eqs c 2 and c 11 at x l in case of a sudden rise or drop the semi infinite and finite aquifer profiles are identical throughout the domain of length l until the time α ω t l 2 10 fig 6 illustrates the temporal variation of the water table height at the midpoint of the finite aquifer x 0 5 for the same scenarios as in fig 5 the curves were generated using a time varying α as evaluated from 43 for each time point with a mean relative error of around 1 a one time estimate of α 2 for a single time interval 0 4 performs equally well with a slightly larger mean relative error of around 2 5 also displayed is the first order linear solution with α 2 to highlight the contribution of the correction term the variation of the water table is identical in both the infinite and semi infinite aquifer in the early phases until the influence of the far end boundary appears at t 1 the water table height in the finite aquifer fi is more accentuated than in the semi infinite case si due to the presence of the impervious boundary that limits the spread of the groundwater mound on the other hand the absence of a boundary attenuates the variation of the water table height and results in an earlier peak the presence of a boundary has a significant effect on the aquifer domain x l 2 for α ω t l 2 16 for any stream level variation within a time scale shorter than l 2 16 α ω the semi infinite model is appropriate for all practical purposes since the groundwater response is likely to die out before the boundary effect takes place 6 2 bank storage and depletion the flux exchange between the stream and aquifer is of hydrological interest as it quantifies the amount of water stored or depleted from the aquifer the flow rate and cumulative flow rate for a sudden and a gradual variation of the stream level are presented herein they are evaluated from q q 1 q 2 and v v 1 v 2 using eqs 32 37 and the pertinent solutions 6 2 1 sudden variation for a sudden variation in a semi infinite domain one can express the flux and volume in terms of the flow coefficient c 45 q c 4 ω t v c ω t where 46 c γ π α 1 2 π 1 2 δ 3 8 8 π 2 3 3 9 π δ 2 and 47 α μ ν 2 δ μ ν μ ν γ μ 2 ν 2 eq 46 is the third order expression of c with each term representing the contribution of each order the flow rate q is decaying at a rate proportional to the inverse square root of time while the volume v is linearly related to the square toot of time the two variables q and v are also inversely related q c 2 2 v or simply related through the time variable v 2ωqt although q or v are stated in the familiar form 45 the flow coefficient c is herein formulated differently 46 due to the appropriate definition of α table 1 compares the values of the normalized flow coefficient c γ with exact numerical results for various scenarios including the extreme case of a recharge of a dry aquifer ν 0 and discharge into a dry stream μ 0 the comparison includes the second order estimate c 2 the first two terms of 46 the third order estimate c 3 c the original polubarinova kochina 1962 series with two and three terms c pk 2 and c pk 3 whereby α μ the traveling wave solution c tw basha 2013 and the lockington 1997 formulation c wr the exact numerical values are obtained from the runge kutta solution and they have already appeared in many previous studies e g hayek 2019 the traveling wave estimate c tw is expressed by 48 c tw γ 2 α 1 1 w w 2 δ 1 δ 3 here w is a weight parameter that ranges from 0 to 1 it is best equal to 3 4 for recharging conditions and 3 5 for discharging conditions basha 2013 it should be noted that both the original and modified perturbation series do not involve any fitting parameter while the traveling wave estimate is in terms of one fitting parameter w and the lockington formulae are stated in terms of two fitted expressions all of the above mentioned approximations consist of distinct formulae that are applicable to any combination of μ and ν including the extreme cases of ν 0 and μ 0 although there are a number of other approaches for the evaluation of the flow coefficient e g hayek 2019 moutsopoulos 2010 tolikas et al 1990 they all involve a number of fitting parameters or coefficients that need to be estimated or tabulated for any combination of μ and ν before use the results in table 1 indicates that the second and third order estimate c 2 and c 3 are accurate to within a mean relative error of 2 and 0 25 with the maximum error being slightly larger in the unlikely extreme cases they are consistently better than the polubarinova kochina estimates and significantly more accurate in discharging conditions ν μ where the third order solution of pk diverges considerably for the case of ν 10 with a relative error greater than 50 for the extreme case of seepage into an empty aquifer ν 0 the flow coefficient is 0 8995 which is less than 1 5 different from the exact numerical value of 0 8875 while the difference is less than 1 for the other extreme case that of drainage into an empty channel μ 0 obtained from the blasius solution polubarinova kochina 1962 the traveling wave solution is comparable in accuracy to the third order estimate c 3 being slightly less precise with a relative error of less than 1 while the lockington formulation is the most accurate overall given that it involves two complex fitted expressions in terms of two parameters for the case of a finite aquifer two forms of approximate expressions are available depending on the form of the linear solution used using the first three terms of the series b 1 one obtains the following two terms approximation for the flux 49 q α μ ν π α ω t 1 2 exp 4 τ 1 exp 9 τ 1 where τ 1 4 α ω t l 2 using the first three terms of the alternate series b 7 that is generally valid for large time a good approximation for v is obtained 50 v l μ ν 1 8 π 2 exp τ 2 1 9 exp 9 τ 2 where τ 2 π 2 α ω t 4 l 2 two alternate expressions of v and q can also be derived from 49 and 50 by integrating the former and differentiating the latter equation but they are slightly less accurate than 49 and 50 at either early or late times however one can obtain an expression for v of comparable accuracy to 50 if one uses the first five terms of the series b 1 51 v 2 ω q t l μ ν 4 erfc 2 τ 1 8 erfc 4 τ 1 5 erfc 5 τ 1 eq 51 is obviously more complex than 50 but it provides a direct relationship between v q and t in addition its functional form bears some resemblance to the cumulative outflow equation presented by parlange et al 2001 that is valid only for the specific extreme case of drainage into a dry stream μ 0 while eq 51 or 50 apply to any combination of recharge μ ν and discharge μ ν scenarios fig 7 illustrates the recharge and discharge rates for a sudden variation of the stream level from a constant value of 1 to 5 and vice versa for different aquifer extents and two flow parameter values ω 1 4 and ω 1 2 the curves were generated from eqs 32 33 using the pertinent solutions and the first moment estimate of α i e eq 19 for the semi infinite case and eq 44 for the finite domain case a one time estimate of α over the time domain 0 10 was used in all the runs and provided ample accuracy a slightly better estimate of α can be obtained if one uses t tc the time centroid of the flux distribution although its estimation requires a two step process the first step is to evaluate the flux distribution q t using t tgm and the second step is to refine the estimate of α using the computed value of t tc from q t the inflow and outflow volumes corresponding to the flow rates of fig 7 are illustrated in fig 8 using the same estimate of α the prediction of the flow rate and volume using 44 is overall excellent the two terms expressions 49 and 50 with a proper choice of α are also a good approximation as shown in fig 7 and fig 8 ap curves the relative error of the algebraic approximations is within 5 for both the recharging and discharging case which is quite acceptable for practical application the one time estimate of α was obtained from 44 using the following two terms approximation for the head at the far end boundary b 7 52 h l μ ν μ 4 π exp τ 2 1 3 exp 9 τ 2 the ap curves shown in fig 8 were generated by evaluating eq 44 over the plotted time domain 0 3 the estimate of α can be slightly refined by updating the value of τ2 in an iterative fashion as it is also defined in terms of α it is interesting to note that for the same difference of head μ ν the variation of the flux is not symmetric with the wetting front being faster than the drying front as revealed in fig 7 the fact that water seeps more easily into than out of the aquifer is a common feature of the nonlinear solution the flow rate q decreases to zero faster for larger values of ω and smaller values of l similarly the cumulative flow v reaches its asymptotic value of l μ ν faster for smaller values of l and larger values of ω higher values of ω imply a higher hydraulic diffusivity of the aquifer k φ i e a quicker spread of water one can infer from 49 that the flux for a finite aquifer deviates from the semi infinite flux 45 by more than 10 for α ω t l 2 3 one can also deduce from 50 that the steady state capacity μ ν l is attained for a flooding period exceeding αωt 1 5l 2 conversely one can state that the finite aquifer is drained by more than 95 at αωt 1 5l 2 6 2 2 gradual variation for a linearly increasing water level hb a 1 t from a zero initial value hi ν 0 the exact solution of the water table is h a 1 t x a 1 ω barenblatt et al 1990 the corresponding exact flux and volume are given by 53 q e a 1 a 1 ω t v e a 1 a 1 ω t 2 2 the corresponding second order flux rate and volume are obtained from c 8 c 9 54 q q 1 q 2 a 1 t 1 2 π κ α ν a 1 t 32 3 π 9 π 55 v v 1 v 2 a 1 t 3 2 ω π κ 2 3 α ν 2 a 1 t 32 3 π 45 π table 2 compares the exact results 53 with the perturbation solutions 54 55 for two estimates of the scaling parameter the use of the zero moment estimate α hb t provided a more precise simulation of q than the first moment estimate 42 as noted by the decrease in the relative error from 3 6 to 1 47 on the other hand the computation of v is more accurate with α as computed from 42 it is interesting to note that the choice of α hb t agrees with the correction proposed by hogarth et al 1997 that considers the diffusivity to be linear in time in the simple linear rise case one should also note that the error is maximum for this extreme case due to the strongly nonlinear process involved in the wetting of a completely dry aquifer ν 0 the algebraic eqs 54 55 apply to any value of ν and perform very well for nonzero values of ν as shown in figs 9 and 10 ae curves fig 9 depicts the variation of the flow rate in a semi infinite and finite aquifer for two piecewise linear variations in hb a gradual linear rise to a new constant value and the common rise and fall of the stream level associated with a flood wave and approximated herein by the isosceles triangular hydrograph cf fig 6 the curves were generated from eqs 32 33 using the solutions derived for the gradual variation case appendix c the scaling parameter α is estimated from 43 and yields excellent reproduction of both the flux rate fig 9 and the cumulative flux fig 10 throughout the whole simulation period due to the time varying estimate of α the root mean squared error values on q ranges from 0 21 to 0 33 while those on v ranges from 0 020 to 0 032 for the graphs shown these values represent a relative error of less than 1 when normalized with respect to the simulated maximum values a one time estimate of α for a pre selected time window 0 tgm produces equally acceptable results the ps model reproduces very well the transient change in flux fig 9 as manifested by both positive and negative values of q that is due to the flow and ebb effect associated with the passing of a flood wave previous studies govindaraju and koelliker 1994 hogarth et al 1997 noted the difficulty of obtaining a uniformly accurate simulation for different time varying stream level scenarios using a pre defined transmissivity or diffusivity even with the correction proposed by hogarth et al 1997 that improved the prediction in the rising stage the authors acknowledged that their modified linear solution is not a good approximation to the numerical solution after the flow reversal the superior performance of the ps model as illustrated in fig 9 is mostly due to the dynamic evaluation of the parameter α as opposed to an adopted preset value or form as in the above mentioned studies the presence of a boundary has a more considerable effect on the flux rate for a linear rise than for a cyclic variation of hb fig 9 however the flux variation for a semi infinite and a finite aquifer become indistinguishable in both cases for l 2 3αωtd where td 2 is the base duration of the triangular hydrograph the flux drops markedly when the stage level starts decreasing and the rate of decline in the linear rise case is similar in trend to the one arising from an abrupt rise in hb in the cyclic variation of the stream level the flux drops to negative values indicating a flow reversal and it goes eventually to zero as the stream and aquifer levels become equal although the flux rate of the sudden and gradual rise is markedly different in the initial stages the discrepancy in the volume between the two solutions is within 5 after a time t 3 results not shown this is particularly useful in practical applications as the cumulative flow is an integral property and the integration process tends to attenuate measurement errors as opposed to the calculation of the flux rate that amplifies them fig 10 displays the variation of the accumulated flux in a semi infinite and finite aquifer for different aquifer extents and two flow parameter values ω 1 4 and ω 1 8 the bank storage increases with increasing values of ω and decays faster for smaller values of l and larger values of ω the time of peak storage happens when q 0 and it occurs after the occurrence of the maximum stream level t 1 the recession period is 4 to 8 times longer than the rising period even though the rate of rise and fall of the stream level is the same the algebraic eq 55 provides a conservative estimate of the volume stored in a semi infinite aquifer over the period in which a linear increase in the stream level is taking place the approximation is also valid for a finite aquifer up until the effect of the impervious boundary emerges 7 conclusions in the present work approximate solutions of the boussinesq equation for groundwater flow in horizontal aquifers were derived the analytical solutions pertain to the case of a sudden and a gradual variation of the water level in the stream that is bordering an aquifer of limited and unlimited extent the nonlinear boussinesq equation was analytically tackled via a refinement of its linearized solution in a perturbation series framework the method of green s function was used to derive the solution in a general form that can handle through analytical or numerical integration any form of transient variation of the stream level the general versatile solution is composed of three parts the representative depth α the linear solution and the correction term that is derived from the perturbation expansion the aquifer response due to the transient variation of the stream flow is of particular importance in stream aquifer interaction studies and the present solutions performed considerably well for the fluctuating inlet case with sharp reversal of flow conditions application of the perturbation solutions to the standard benchmark cases attested also to the excellent performance of the models comparisons with an exact analytical solution and numerical solutions of the boussinesq equation confirmed the validity and accuracy of the derived approximations the perturbation solutions were able to simulate the original nonlinear behavior with high precision due to the introduction of the representative depth parameter α that is evaluated in an optimal fashion for any given flow condition whether recharge or drainage it rectified and improved the original diverging series presented by polubarinova kochina 1962 for the classical case of an abrupt rise or drop of the stream level in a semi infinite aquifer excellent estimates of the flow and volume exchange are thus obtained with this simple modification in some cases the linear solution with a proper value of α is of sufficient accuracy for practical purposes this is especially true for the case of a gradual variation of the stream level bordering a finite aquifer the present formulation of the representative depth α resolves the longstanding issue of defining the appropriate transmissivity or diffusivity value κ αω in the widely applied linearized boussinesq solutions for abrupt boundary changes the scaling parameter α is best evaluated from 42 for the simulation of the water table h x and from eq 44 for the flow q t and volume v t computations the parameter α is a constant value in a semi infinite aquifer while it is time varying for a finite aquifer due to the varying head at the impervious boundary hl cf eq 52 for a gradual variation of hb eq 43 produces the best estimate of α for the simulation of the water table h x as well as the variation of the flow q t and volume v t the parameter α can be computed for each time point or evaluated once for a pre selected time range however the time varying α produces results of higher accuracy while a one time estimate of α yields equally good results but with a slightly less precision the time integrated moment estimate of α is also more accurate primarily because integration tend to minimize the deficiencies of the approximation numerical results highlighted the effect of the far end impervious boundary on the flow and volume exchange at the inlet boundary and provided the criteria for the proper use of the semi infinite simplifications the optimal perturbation solutions also allowed the derivation of new algebraic expressions for the flow and volume exchange at the stream aquifer interface for riparian aquifers of finite width explicit flow equations were thus obtained for easy implementation in recession flow analysis the present results are suitable modeling tools for the quantification of the bank storage in flood events the bank depletion in drought periods the base flow contribution to streamflow and the estimation of the aquifer parameters additional application can include the delineation of the influence zone of the adjacent stream and the evaluation of the velocity field that is particularly useful for contaminant transport in aquifers the analytical results are especially valuable in situations where detailed information on aquifer properties is scant declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the graphical results were all generated for hypothetical data no external data was used in this study appendix a green s functions two forms of the green s function for a finite domain were presented eqs 26 and 27 the green s function for a semi infinite domain 25 is the special case of 26 for m 0 eq 26 is computationally more suitable for small times rather than large times as can be deduced from the error function argument and vice versa for the other expression 27 the perturbation series terms for the water table height flux rate and volume are expressed in terms of the derivative or integrals of the green s function the latter are presented herein for the sake of completeness the water table solution 28 is in terms of g x s at xs 0 a 1 g x s x s 0 1 4 π m m 1 m c m x κ 3 2 τ 3 2 exp c m x 2 4 κ τ the second order term of q 34 is in terms of g x at x 0 a 2 g x x 0 1 π m m 1 m c m x s 4 κ 3 2 τ 3 2 exp c m x s 2 4 κ τ c m x s 4 κ 3 2 τ 3 2 exp c m x s 2 4 κ τ the second order term of v 37 is in terms of the integral of the green s function γ a 3 γ 0 l g d x 1 2 m m 1 m erf c m l x s 4 κ τ erf c m l x s 4 κ τ erf c m x s 4 κ τ erf c m x s 4 κ τ where a 4 τ t t s c m 2 ml for a semi infinite domain one sets m 0 in the above expressions the equivalent expressions using the alternate form of g are a 5 g x s x s 0 2 l i 1 β i sin β i x exp κ β i 2 t t s a 6 g x x 0 2 l i 1 β i sin β i x s exp κ β i 2 t t s a 7 γ 2 l i 1 1 β i sin β i x s exp κ β i 2 t t s appendix b sudden variation finite domain integral form the solution for the water table profile is given by h α h 1 h 2 whereas the flow rate and volume can then be derived using 32 37 for a sudden variation of the boundary head the linear solution is expressed by b 1 h 1 μ α μ ν 2 m m 1 m 2 erfc ζ x erfc ζ x l erfc ζ x l where b 2 ζ z z c m σ c m 2 ml σ 4 κ t for a semi infinite domain with m 0 and l eq b 1 reduces to 13 the correction term h 2 is given in integral form 30 whereby g is expressed by 26 and b 3 h 1 x μ ν π σ m m 1 m 2 exp ζ x 2 exp ζ x l 2 exp ζ x l 2 b 4 h 1 t 2 κ μ ν π σ 2 m m 1 m 2 ζ x exp ζ x 2 ζ x l exp ζ x l 2 ζ x l exp ζ x l 2 the first order flux term q 1 is obtained from 32 using b 3 while the first order cumulative flow v 1 is b 5 v 1 μ ν l σ 2 m m 1 m f 1 ζ 2 l 3 f 1 ζ l 3 f 1 ζ 0 f 1 ζ l where ζ z and σ are given by b 2 and b 6 f 1 z z erf z 1 π exp z 2 the volume expression b 5 is derived from the integration of h x rather than the integration of q t cf eq 35 as it is computationally more efficient especially if the large time green s function form 27 is used the second order flux component q 2 and cumulative flux component v 2 can be evaluated from 33 and 37 respectively using numerical quadrature finite domain series form a fully explicit form of the above solution can be derived from the alternate expression of g 27 the water table profile in a finite aquifer is again given by h α h 1 h 2 where b 7 h 1 μ α ν μ 2 l i 1 1 β i sin β i x exp κ β i 2 t and b 8 h 2 ω α μ ν μ 2 t l i 1 β i sin β i x exp κ β i 2 t ω ν μ 2 8 κ l 3 i 1 1 i 2 1 i 3 1 d 123 β i 1 β i 1 2 β i 2 2 β i 3 2 sin β i 1 x exp κ β i 1 2 t exp κ β i 2 2 t κ β i 3 2 t here β i 2 i 1 π 2 l and b 9 d 123 β i 1 2 β i 2 2 β i 3 2 β i 1 β i 2 β i 3 β i 1 β i 2 β i 3 β i 1 β i 2 β i 3 β i 1 β i 2 β i 3 the flow rate and volume can be easily derived from the first and second order solution terms b 7 and b 8 using 32 37 as it involves simple differentiation and integration of trigonometric and exponential terms appendix c gradual variation semi infinite domain the water table response for the piecewise linear variation of hb 6 can be found from the straightforward application of 28 however a more elegant and computationally efficient form is derived by specifying the solution as a sum of two parts one that satisfies the boundary conditions while the other satisfies the altered governing equation and initial condition c 1 h 1 h b α a 1 h 0 t u t a n a n 1 h 0 t t n 1 u t t n 1 where c 2 h 0 t x 2 2 κ t f 0 ξ ξ x 4 κ t and c 3 f 0 z 2 z π exp z 2 1 2 z 2 erf z the correction term h 2 is given in integral form 30 whereby g is expressed by 25 and c 4 h 1 x a 1 h 0 x t u t a n a n 1 h 0 x t t n 1 u t t n 1 c 5 h 1 t h b t a 1 h 0 t t u t a n a n 1 h 0 t t t n 1 u t t n 1 with c 6 h 0 x t 2 t π κ exp ξ 2 π ξ erfc ξ c 7 h 0 t t erf ξ the first order flux term q 1 is obtained from 32 using c 4 and ξ 0 that is c 8 q 1 2 α π κ a 1 t 1 2 u t a n a n 1 t t n 1 2 u t t n 1 the second order flux term q 2 can be derived from 33 in an analytical form for the first segment 0 t t 1 only c 9 q 2 a 1 t 1 2 π κ a 1 t 32 9 π 1 3 ν α the first order volume is c 10 v 1 4 α 3 π κ a 1 t 3 2 u t a n a n 1 t t n 3 2 u t t n 1 finite domain integral form for a finite domain with a piecewise linear variation of hb the first order solution is similarly expressed by c 1 with h 0 replaced by h 1 c 11 h 1 t x x 2 l 2 κ t 2 m m 1 m f 0 ζ x l f 0 ζ x l 2 f 0 ζ x here f 0 ζ z is given by c 3 and ζ z is given by b 2 for a semi infinite domain with m 0 and l the h 1 t function c 11 reduces to the h 0 t function c 2 the correction term h 2 is again given in integral form 30 wherein g is expressed by 26 and the derivative terms h 1 x and h 1 t are similarly expressed by c 4 c 5 with h 0x and h 0t replaced by h 1x and h 1t respectively c 12 h 1 x t x l κ σ 2 κ m m 1 m f 1 ζ x l f 1 ζ x l 2 f 1 ζ x c 13 h 1 t t 1 2 m m 1 m erf ζ x l erf ζ x l 2 erf ζ x here f 1 ζ z is given by b 6 ζ z and σ are again given by b 2 the first order flux q 1 is obtained from 32 using c 4 and c 12 the first order cumulative flow v 1 is c 14 v 1 a 1 v 1 t u t a n a n 1 v 1 t t n 1 u t t n 1 where c 15 v 1 t l 3 3 κ σ 3 24 κ m m 1 m f 2 ζ 2 l 3 f 2 ζ l 3 f 2 ζ 0 f 2 ζ l c 16 f 2 z z 3 2 z 2 erf z 2 π 1 z 2 exp z 2 the second order flow q 2 and volume v 2 can be computed from 33 and 37 respectively finite domain series form using the alternate expression for the green s function g 27 a fully explicit form of the above solution can be derived the linear solution h 1 is given by c 1 with h 0 replaced by the following form of the function h 1 c 17 h 1 t 2 l i 1 1 κ β i 3 sin β i x exp κ β i 2 t 1 the correction term h 2 in the interval t n 1 t tn is in an explicit form as follows c 18 h 2 2 α l i 1 sin β i x β i h 2 1 t k 2 n h 2 k t t k 1 h 2 k 1 t t k 1 h 2 n 0 8 α κ l 3 i 1 1 i 2 1 i 3 1 d 123 β i 1 β i 2 2 β i 3 2 sin β i 1 x h 3 1 t k 2 n h 3 k t t k 1 h 3 k 1 t t k 1 h 3 n 0 where d 123 is given by b 9 and c 19 h 2 k τ a k 2 b i 2 1 b i τ b i t a k ϕ k b i exp b i τ a k τ 2 t θ i k τ ϕ k θ i k τ c 20 h 3 k τ a k 2 f τ b i 1 a k θ i 2 k f τ b i 1 b i 2 a k θ i 3 k f τ b i 1 b i 3 θ i 2 k θ i 3 k f τ b i 1 b i 2 b i 3 with f τ b i exp b i τ b i b i κ β i 2 and c 21 ϕ n α ν k 2 n a k a k 1 t k 1 c 22 θ i n a 1 exp b i t k 2 n a k a k 1 exp b i t t k 1 the subscript or superscript k on the variable ak or functions ϕ k and θ i k refer to their value in the time interval k while the i subscripts implies that they are dependent on the eigenvalues β i the summation proceeds from the second time interval in case n 1 through k n that corresponds to the time interval in which the time t is being evaluated for the specific instance of a zero value of the argument of the function f e g when b i1 b i2 the function f reduces to its limiting value of f τ 0 τ the series solution c 18 can be used as a basis for any rational approximation and simplification for specific conditions however it is computationally more efficient to evaluate the second order term h 2 through numerical integration of 30 rather than using the series solution c 18 
263,this study proposes a pore network modeling algorithm to simulate single phase reactive transport and mineral dissolution in porous media a novel pore merging approach is introduced to guarantee the conservation of the most critical variables during the merging process by using correction factors and effective properties for throat conductances and surface areas our approach solves a coupled transport and reaction pore network model that implements a kinetic model with a single heterogeneous chemical reaction describing the dissolution of calcite by acidic solutions the network geometry is updated based on the dissolution process occurring at the mineral surface and the network topology is updated based on the pore merging processes occurring throughout the network the main results include the exploration of different dissolution regimes through porosity permeability evolution curves acid concentration profiles and the use of statistical criteria importantly this methodology simulates permeability increases larger than 100 fold during the formation of preferential pathways i e wormholes keywords pore network modeling reactive transport mineral dissolution pore scale modeling pore merging nomenclature z coordination number q i j volumetric flow rate through throat i j c ϵ i j effective conductance of throat i j ϵ i j correction factor for the conductance of throat i j r i j cross section radius of the throat i j μ dynamic viscosity of the fluid l i j length of the throat i j k absolute permeability of the network δ p pressure difference through the network a cross sectional area of the network l length of the network a ψ i effective surface area of pore i a ψ i j effective surface area of throat i j ψ i surface area correction factor of pore i ψ i j surface area correction factor of throat i j t time c α i mass concentration of species α in pore i c α i j mass concentration of species α in throat i j v i volume of pore i d α diffusion coefficient of species α r i radius of pore i r α i reaction rate of specie α due to heterogeneous chemical reaction in pore i r α i j reaction rate of specie α due to heterogeneous chemical reaction in throat i j δ v i d change in volume due to dissolution process in pore i δ v i j d change in volume due to dissolution process in throat i j δ r i d change in radius of pore i due to dissolution process δ r i j d change in radius of throat i j due to dissolution process δ v i i j d d change in volume due to double dissolution in the region between pore i and throat i j δ v i d d total change in volume due to double dissolution for pore i δ v i j d d total change in volume due to double dissolution for throat i j δ r i d d change in radius of pore i due to double dissolution δ v i i j c 1 change in volume due to correction 1 in the region between pore i and throat i j δ v i c 1 total change in volume due to correction 1 for pore i δ v i j c 1 total change in volume due to correction 1 for throat i j δ r i c 1 change in radius of pore i due to correction 1 δ v i i j c 2 change in volume due to correction 2 in the region between pore i and throat i j δ v i c 2 total change in volume due to correction 2 for pore i δ v i j c 2 total change in volume due to correction 2 for throat i j δ r i c 2 change in radius of pore i due to correction 2 δ v i i j t volume of the porous region previouly belonging to throat i j transferred to pore i δ m i i j t mass of acid in the porous region previouly belonged to throat i j transferred to pore i δ v i t total change in volume due to porous space transfer from throat i j to pore i for pore i δ v i j t total change in volume due to porous space transfer from throat i j to pore i for throat i j δ m i t total change in mass of acid due to porous space transfer from throat i j to pore i for pore i δ m i j t total change in mass of acid e due to porous space transfer from throat i j to pore i for throat i j x position vector x d m k interpore distance between the newly merged pore m and the connected pore k r m n 1 radius of the newly merged pore m r k n 1 radius of the pore k connected to the new merged pore m r m k n 1 radius of the newly throat connecting the merged pore m and the connected pore k a r m k n 1 reactive surface area of the newly throat connecting the merged pore m and the connected pore k c m k n 1 conductance of the newly throat connecting the merged pore m and the connected pore k ψ m k n 1 correction factor of the newly throat connecting the merged pore m and the connected pore k σ c s standard deviation of cross section c s c v c s coefficient of variation of cross section c s c v averaged coefficient of variation δ c measure of the consumption of acid along the network δ v i total change in volume of pore i δ v i j total change in volume of throat i j 1 introduction reactive transport and mineral dissolution in porous media are fundamental processes in many subsurface applications including carbon dioxide c o 2 storage enhanced oil recovery eor and acidizing for stimulation sohrabi et al 2012 wolterbeek and raoof 2018 menke et al 2018 gharbi et al 2013 for example c o 2 injection into reservoirs triggers the occurrence of chemical reactions that induce changes in mechanical properties of the rock especially in porous media rich in carbonate minerals egermann et al 2010 rathnaweera et al 2016 bemer and lombard 2010 regarding geological c o 2 storage these structural alterations are a source of concern for the safety and efficiency of the process due to the increase of the chances for leakage and c o 2 migration out of the storage formation deng et al 2017 egermann et al 2010 rathnaweera et al 2016 bemer and lombard 2010 indeed depending on the dominant transport mechanism poor utilization of the pore space for the storage of c o 2 may occur ott and oedai 2015 regarding acidizing for well stimulation the main goal is to increase well productivity the formation of preferential pathways is desired to increase the overall conductance through the reservoir hill and schechter 2000 ott and oedai 2015 fredd and fogler 1999 accordingly good understanding of the dissolution processes is imperative to assess long term reservoir integrity properties for c o 2 storage and to design efficiently acidizing treatments rathnaweera et al 2016 bemer and lombard 2010 fredd and dowell 2000 in order to investigate the dissolution processes in porous media several numerical approaches such as direct numerical simulations dns that include computational fluid dynamics cfd soulaine et al 2017 oliveira et al 2019 molins et al 2012 lattice bolztmann method lbm liu and mostaghimi 2017 kang et al 2002 huber et al 2014 smoothed particle hydrodynamics sph tartakovsky et al 2016 and approaches that consider a simplified conceptualization of the porous media commonly associated with pore network modeling pnm have been developed esteves et al 2020 li et al 2006 algive et al 2010 raoof et al 2012 tansey and balhoff 2016 budek and szymczak 2012 an overview of the various numerical approaches applied to pore scale mineral dissolution are found in molins et al 2020 pore network modeling is a technique that is widely used to represent natural porous media and complex pore geometries using a simplified pore and throat type network algive et al 2010 since the pioneering work of fatt 1956 that studied two phase flow and capillary pressure curves pore network models have been successfully applied in numerous research areas including reactive transport and mineral dissolution problems li et al 2006 algive et al 2010 raoof et al 2012 tansey and balhoff 2016 esteves et al 2020 the computational efficiency of pore network models is related to the simplicity of their geometry and because of this feature pore network modeling is considered applicable to much larger domains when compared to direct simulation methods mehmani and balhoff 2015 yang et al 2016 in this context merging of pores and throats to form vug like pores is needed to evaluate better regimes with significant mineral reactivity the appropriate treatment of pore merging allows a better representation of the physical problem and makes possible the use of reactive transport simulations to evaluate dissolution regimes in more complex network topologies where the merging of pores is likely to occur with great frequency due to the heterogeneity of these type of porous media few pore network modeling studies explored the use of pore merging methods to explore mineral dissolution in porous media budek and szymczak 2012 performed the first pore network study that considered an approach to merge pores during reactive transport and mineral dissolution the porous medium was represented by a two dimensional triangular network of cylindrical tubes the points where the tubes meet are referred to as nodes in this way pores are defined just as node points for pressure determination then throats are tubes that enlarge during the dissolution process note that a single reactant is assumed to describe approximately the carbonate dissolution their methodology for merging considers that as the diameters of the eroding throats become comparable to the interpore distances the throats are joined together the assumption is that the new throat has the same diameter as the sum of the diameters of the original two throats with this the reactive surface area is conserved during the merging process but the volume is not tansey and balhoff 2016 developed a pore network model of heterogeneous reactive transport and matrix dissolution that considers a pore merging criterion to improve the pore scale physics of the network simulations were conducted on random close pack arrangements of spheres and the transport equation assumes pores as the only control volumes throats represent the conductances throughout the network this approach also assumes the tracking of only one chemical species and the reactive transport equation is solved explicitly during simulation pores grow assuming a static geometry by preserving the relation between surface area and volume throat cross section areas are updated based on the new surface area of the connected pores throat conductances are then updated based on the new cross sectional areas also assuming a static geometry using a shape factor to map the throat shape onto a cylindrical tube and preserving initial relationships between throat cross section and conductivity the merging approach developed by tansey and balhoff 2016 assumes that the new merged pore s volume is equal to the combined volume of both original pores the use of a merging criterion by tansey and balhoff 2016 showed the importance of capturing the formation of preferential pathways without merging of overlapping pores permeability could not increase past a small fraction of its potential reaching a plateau with no occurrence of wormholes tansey and balhoff 2016 clearly significant insights and improvements were achieved by these studies although some strong simplifications were assumed related to the evolution of geometry during dissolution and merging processes assuming static relations between surface areas and volumes may not be the best representation for all the different dissolution regimes because pores and throats may be affected differently the conservation of geometry and flow properties during the application of a merging strategy is paramount to maintain a continuous evolution of porous media due to the dissolution process the structure of the network before and after two overlapping pores merge must be represented in a manner faithful to the physical problem and include a minimum of unrealistic simplifications maintenance of the available reactive surface area and volume of the overlapping pores as well as conductivity of the connected throats are essential for an accurate evaluation of the dissolution regimes transport phenomena and reaction within the pore spaces are highly dependent on these properties therefore the main objective of this study is to develop a new methodology to describe the merging of pores and throats resulting from solid matrix dissolution during single phase flow that guarantees the conservation of the main variables of interest namely porous volume mass of acid reactive surface area and throat conductances surface areas and conductances are modeled using a novel application of correction factors and effective properties thus the conservation of these properties is possible during the merging process in addition to the volume and mass of acid already conserved this approach aims to bring pore network models closer to the physical problem and make possible reactive transport simulations to evaluate dissolution regimes in more complex network topologies in such networks the odds for the junction of two pore spaces initially separated increases due to the heterogeneity in pore sizes 2 methodology this section first presents the equations to determine the pressure and concentration fields the kinetics of dissolution and the evolution of the volumes and geometry of a stick and ball network are also described then the new pore merging approach to describe dissolving pores is introduced finally definition of the dimensionless numbers and the statistical criteria are presented the pore network models used for this study are presented at the end of this section 2 1 pressure field the pseudo steady state flow of a single phase incompressible fluid is assumed in order to obtain the pressure field of the network the mass conservation for each pore is given by 1 i j z q i j 0 where z is the coordination number and q i j is the volumetric flow rate through throat i j the volumetric flow rate through a pore throat is determined by the pressure difference between the connected pores i and j p i p j and the throat effective conductance c ϵ i j as follows 2 q i j c ϵ i j p i p j note that throat volumetric flow rates are obtained using the effective conductance instead of the conductance derived only from geometrical data effective conductances assure that the relationship between flow rate through pores and the extent of dissolution is represented accurately after merging the effective conductance c ϵ i j is described by 3 c ϵ i j ϵ i j c i j where ϵ i j is the conductance correction factor the conductance correction factor is equal to 1 for all original throats and the value is updated when the throat i j is involved in a merging process thus initially the effective conductance is equal to the conductance the throat conductance is obtained by use of poiseuille s law for laminar flow in a cylindrical tube 4 c i j π r i j 4 8 μ l i j where r i j is the radius of throat i j cross section μ is the dynamic viscosity of the fluid and l i j is the length of the throat i j substituting eqs 2 and 4 into eq 1 a linear algebraic system for the unknown pressure field is solved for the pressure in each pore constant volumetric flow rate at the inlet boundary and fixed pressure at the outlet boundary are imposed to determine the pseudo steady state flow field of the network fixed pressures are imposed at the inlet and outlet boundaries to determine the absolute permeability all other boundaries are closed therefore both cases are one dimensional flow problems considering the last case the total flow rate through the network q is obtained after pressure field determination and darcy s law is used to calculate the absolute permeability k of the system as described below 5 k μ q l a δ p where a is the cross sectional area of the network and l is the length of the network 2 2 concentration field the reactive transport problem is described by the mass balance in all available pore spaces pores and throats and is deduced from the mass conservation equations of the chemical species bird et al 2007 this new approach uses effective surface areas instead of the reactive surface areas obtained just by geometrical information the effective surface area is the geometrical reactive surface area corrected by a correction factor due to merging as presented below 6 a ψ i ψ i a r i 7 a ψ i j ψ i j a r i j where a ψ i is the effective surface area of pore i a ψ i j is the effective surface area of throat i j ψ i is the surface area correction factor of pore i and ψ i j is the surface area correction factor of throat i j thus original pores and throats have surface area correction factors equal to 1 the correction factor of a pore space is just updated if it is involved in a merging process so until a merging event occurs the effective surface area of a pore space is equal to its geometrical surface area obtained by eqs a 15 and a 12 respectively for pores and throats implementation of correction factors ensures that surface area and conductance evolve in a physically realistic manner more details about the update of surface area correction factors are available in later sections the transport of a chemical species occurs by advection and diffusion the mass balance equation for chemical species α in a spherical pore i is 8 d d t c α i v i i j i n c α i j q i j c α i i j o u t q i j i j a i j d α c α i j c α i 0 5 l i j r i r α i a ψ i where t is the time c α i is the mass concentration of species α in pore i c α i j is the mass concentration of species α in throat i j v i is the volume of pore i a i j is the cross sectional area of throat i j d α is the diffusion coefficient of species α r i is the radius of pore i r α i is the reaction rate of species α due to heterogeneous chemical reaction in pore i for control volumes represented by cylindrical throats i j the mass balance equation for species α is 9 d d t c α i j v i j c α i c α i j q i j a i j d α c α i c α i j 0 5 l i j r i a i j d α c α j c α i j 0 5 l i j r j r α i j a ψ i j where c α i is the mass concentration of species α in the pore from where the flow is arriving in the throat i j in our approach the concentration field is solved implicitly and the volume explicitly in a sequential algorithm in other words the system is solved for the new concentrations based on the previous geometry that is kept constant during the solution of eqs 8 and 9 the linear system for the unknown concentrations of species α is solved by spsolve direct method from the scipy library jones et al 2001 the domain initial condition considers a constant concentration profile and the domain boundary conditions consider a constant concentrations for the inlet pore spaces and an outflow boundary condition for the outlet pores 2 3 dissolution kinetics during the dissolution process porous medium geometry and topology evolves with heterogeneous chemical reactions at the effective surface areas of pores and throats our approach solves a coupled transport and reaction pore network model that implements a kinetic model with a single heterogeneous chemical reaction describing the dissolution of calcite c a c o 3 by acidic solutions h c l as follows 10 c a c o 3 s 2 h c l a q c a c l 2 a q c o 2 a q h 2 o l because the acid is the only component in the aqueous phase that reacts with the solid mineral it is the only chemical species concentration that needs to be tracked note that the rate limiting reaction is the acid attack on calcite and it is assumed that carbonate equilibria is totally shifted toward c o 2 a q due to the significant acid concentration in the system thus a single reaction rate is enough to represent our problem this approach follows from previous literature budek and szymczak 2012 tansey and balhoff 2016 soulaine et al 2017 esteves et al 2020 2 4 volume evolution and geometry update as our solution involves geometry changes at each time step control volumes of pores and throats are changed in this way at each time step with the solution of the concentration field based on mass balance the change in volume of the pore spaces is obtained by relating the solid volume consumed on the effective surface of each pore space to the density of the reactive mineral that composes the porous medium considering i a first order reaction rate for the heterogeneous chemical reaction and ii a stoichiometric coefficient β that relates the consumption of the hydrochloric acid α a to the consumption of the reactive mineral the change in volume due to the dissolution process is given by 11 δ v i d r a i a ψ i n β δ t ρ s k r c a i n 1 a ψ i n β δ t ρ s 12 δ v i j d r a i j a ψ i j n β δ t ρ s k r c a i j n 1 a ψ i j n β δ t ρ s where c a i n 1 and c a i j n 1 are the acid concentration in pore i and throat i j respectively after the solution of the mass transport in the network δ v i d is the change in volume due to dissolution process in pore i δ v i j d is the change in volume due to dissolution process in throat i j and ρ s is the density of the solid phase based on eqs 11 and 12 the change in the radii of pores δ r i d and throats δ r i j d due to dissolution is defined respectively as 13 δ r i d δ v i d a ψ i n k r c a i n 1 β δ t ρ s 14 δ r i j d δ v i j d a ψ i j n k r c a i j n 1 β δ t ρ s in this algorithm there are regions in the contact area between pore i and connecting throats i j that are dissolved twice that is portions of the pore i and the throat i j are dissolved simultaneously during δ t see fig 1 hatched area in red this consumed volume needs to be counted twice to keep the conservation of mass for this the volume related to this region derived from the dissolution of throat i j is transferred to the pore i the change in volume due to double dissolution is then defined by 15 δ v i i j d d π r i j n δ r i j d 2 r i j n 2 δ r i d for throats the double dissolution considers the contact area between the two connected pores i and j see eq 16 and for pores the double dissolution may account for the contact area between pore i and all connected throats i j see eq 17 16 δ v i j d d δ v i i j d d δ v j i j d d 17 δ v i d d i j δ v i i j d d the change in radius of pore i due to the double dissolution is defined by 18 δ r i d d δ v i d d a ψ i n the grain region that pore i invades due to the addition of the double dissolved volumes that is also invaded by the dissolution of throat i j see fig 1 hatched area in green is also transferred for the pore the volumes related to this region are defined by eq 19 the total change in volume related to this step for throats and pores are defined respectively in eqs 20 and 21 19 δ v i i j c 1 π r i j n δ r i j d 2 r i j n 2 δ r i d d 20 δ v i j c 1 δ v i i j c 1 δ v j i j c 1 21 δ v i c 1 i j δ v i i j c 1 the change in radius of pore i due to this first correction step is defined by 22 δ r i c 1 δ v i c 1 a ψ i n again the grain region that pore i invades due to the addition of the correction volume δ v i i j c 1 that is also invaded by the dissolution of throat i j see fig 1 hatched area in blue is transferred to the pore the volumes related to this region are defined by eq 23 the total change in volume related to this step for throats and pores are defined respectively in eqs 24 and 25 23 δ v i i j c 2 π r i j n δ r i j d 2 r i j n 2 δ r i c 1 24 δ v i j c 2 δ v i i j c 2 δ v j i j c 2 25 δ v i c 2 i j δ v i i j c 2 the change in radius of pore i due to the this second correction step is defined by 26 δ r i c 2 δ v i c 2 a ψ i n formally the transfer of volumes between pores and throats requires an iterative process to achieve a desired level of accuracy here the correction step stops in the second iteration because its magnitude is already rather small for example for a pore and a throat with diameters equal to 1 and 0 25 respectively that had an increase of 0 2 the relative error of the final volume of the pore after the second iteration compared to 10 more iterations is 0 00006 finally pore i invades a porous region previously belonging to throat i j see fig 1 hatched area in purple for this case not only the volume but also the mass of acid that previously belonged to throat i j needs to be transferred to pore i considering this the transferred porous volume and mass of acid from throat i j to pore i are defined respectively by 27 δ v i i j t δ r i d δ r i d d δ r i c 1 δ r i c 2 a i i j n 28 δ m i i j t c i j n 1 δ r i d δ r i d d δ r i c 1 δ r i c 2 a i i j n where a i i j n is the spherical cap area between the pore i and throat i j at t n that is given by eq a 14 the total change in volume related to this step for throats and pores are defined respectively in eqs 29 and 30 29 δ v i j t δ v i i j t δ v j i j t 30 δ v i t i j δ v i i j t the total change in mass of acid related to this step for throats and pores are defined respectively in eqs 31 and 32 31 δ m i j t δ m i i j t δ m j i j t 32 δ m i t i j δ m i i j t fig 1 presents a schematic of the transferred volumes described previously in this section and appendix a presents the algorithm for the volume evolution and geometry update note that some controls on the numerical scheme were implemented as follows the ratio of the change of throat radius due to dissolution δ r i j d to the throat radius from the previous time step was always kept smaller than 0 1 in order to keep a good approximation of the differentials also the courant numbers defined as the ratio of the inlet velocity multiplied by the time step to the average length of throats in all simulations ranged from 0 11 to 1 34 importantly all transport limited conditions were simulated using courant numbers smaller than 1 these control strategies make the use of 2 iterations to account for the double dissolution accurate to within about 1 part per million as compared to fully converged simulations 2 5 pore merging methodology this section presents the methodology developed to consider merging of pores and throats during reactive transport simulations when pore surfaces dissolve the novel merging approach methodology introduces the use of correction factors to conserve effective surface areas and conductances during the merging process in this way the strategy for merging of pores and throats presented here aims to conserve not only the volume and the mass balance in the system before and after the application of the merging method but also the reactive surface areas and conductances these are key parameters for the reactive transport problem that depends strongly on flow properties conductance of throats and features related to the reactivity of the system reactive surface area the idea is to consider an effective surface area and an effective conductance as the parameters necessary to solve the reactive transport problem in other words the idea is to replace the area and conductance originally obtained by an effective surface area and conductance that considers approximately the deformation of the pore spaces upon merging for this correction factors are introduced to conserve the effective surface area and effective conductance during the merging process therefore ψ is introduced as the correction factor for surface areas and ϵ is introduced as the correction factor for conductance effective surface area of pores and throats were defined previously in this section by eqs 6 and 7 effective conductance of throats are defined by eq 3 considering this original pores and throats have correction factors equal to 1 so the effective surface areas and effective conductances have the same value as the surface areas and conductances of the pores spaces newly merged pores as well as pores and throats connected to the new merged pores have correction factors different from one to account for the geometric deformations arising from the assumptions of the merge method and in this way conserve the effective surface areas and effective conductances during the merging process here the merging method is performed when two connected pores reach each other and also when a throat diameter reaches the same value of the diameter of a connected pore at the end of the geometry update due to dissolution at each time step the main steps of this novel merging methodology are then described the method is explained considering the case of the overlapping pores but it is similar for the case of throats with larger diameters than the connected pores during the merging process when the merging condition is satisfied the two original pores are replaced by one new pore with volume mass of acid and effective surface area equal to the sum of the corresponding properties of the two original pores see fig 2 the new merged pore is located in the volume weighted average of the coordinates of the connecting pores as presented below 33 x m n 1 v i n 1 x i n 1 v j n 1 x j n 1 v m n 1 where x m n 1 x i n 1 x j n 1 are the position vectors of the merged pore m and the merging pores i and j respectively the volume of the newly merged pore is given by 34 v m n 1 v i n 1 v j n 1 the new radius of the merged pore r m n 1 is obtained by 35 r m n 1 3 v m n 1 4 π 3 the length of a throat connected to the new merged pore l m k n 1 is updated due to the location of the merged pore by 36 l m k n 1 d m k n 1 r m n 1 r k n 1 where d m k n 1 is the interpore distance between the newly merged pore m and the connected pore k as follows 37 d m k n 1 x m n 1 x k n 1 where x m n 1 and x k n 1 are the position vectors of pores m and k there are two different procedures in generating the throats connected to the newly merged pore the first one applies to throats that connected pores i and j to a third pore that is not simultaneously connected to pores i and j in this case the throat properties just have to be updated otherwise throat merging is carried out for the first procedure the throats connected to the merged pore have the same volume mass of acid effective surface area and effective conductance as before the merging process in this way the radii of the throats connected to the newly merged pore are updated considering their current volume and the new length by 38 r m k n 1 v m k n 1 π l m k n 1 2 the deformation of the throats during the merging process change the reactive surface area and conductance see fig 3 the new surface area and conductance of the throats involved in the merging process are determined respectively by 39 a r m k n 1 2 π r m k n 1 l m k n 1 40 c m k n 1 π r m k n 1 4 8 μ l m k n 1 at this stage the correction factors for the surface area ψ m k and for the conductance ϵ m k are updated to maintain the correct effective surface areas and effective conductances of the throats during the merging process by 41 ψ m k n 1 a ψ i k n 1 a r m k n 1 42 ϵ m k n 1 c ϵ i k n 1 c m k n 1 if the original merging pores were connected to the same pore one new merged throat replaces the two original throats so the merged throat connected to the merged pore keeps the sum of the volume mass of acid effective surface area and conductance of the replaced throats see fig 4 the new throat length radius effective surface area and effective conductance are also computed from eqs 36 38 39 and 40 consequently the correction factors are defined as 43 ψ m k n 1 a ψ i k n 1 a ψ j k n 1 a r m k n 1 44 ϵ m k n 1 c ϵ i k n 1 c ϵ i k n 1 c m k n 1 finally the reactive surface area of the new merged pore is updated considering its new radius r m n 1 and the new radii of the connected throats using eq a 15 then the correction factor to maintain the correct effective surface area during the merging process is obtained by 45 ψ m n 1 a ψ i n 1 a ψ j n 1 a r m n 1 note that the pores connected to the new merged pore also need their effective surface areas updated due to the changes in the radii of the connected throats during the merging process the merging approach presented here uses the merging method available within openpnm gostick et al 2016 to update the topology of the network the method creates a new pore to replace the two original pores that are merging deletes all throats connected to the two original pores and creates new throats connecting the new merged pore to the pores previously connected to the original merging pores considering this data from all pores and throats involved in the merging process are identified and saved before calling the merge method from openpnm and then relocated to the new pores and throats fig 5 presents a flowchart with the main steps of the novel merging methodology and appendix b presents the algorithm for the new pore merging methodology it should be emphasized that although the simple stick and ball pore network model was used to model initially the porous medium the pore and throat shapes become abstract due to the merging process 2 6 dimensionless numbers the use of dimensionless numbers in reactive transport aims to generalize predictions and results across a range of transport and reaction rate conditions problems involving reactive transport usually take into account reynolds r e péclet p e damköhler d a and péclet damköhler p e d a numbers to characterize different dissolution patterns the definitions used in this work follow from soulaine et al 2017 are calculated at the initial time and presented below 46 r e ρ f v 0 k 0 μ f 47 p e v 0 k 0 d α 48 p e d a k r a s s d α 49 d a k r v 0 k 0 a s s where ρ f is the fluid density v 0 is the inlet interstitial velocity k 0 is the square root of the initial permeability of the porous medium μ f is the fluid dynamic viscosity d α is the diffusion coefficient of species α k r is the constant of reaction and a s s is the specific surface area of the porous medium defined as the ratio of reactive surface area of all pores and throats to the total porous volume note that the p e d a is important for diffusion dominated transport i e at low p e where dissolution patterns are driven by the competition between diffusion and reaction d a alone is appropriate in discussions involving advection dominated transport i e at high p e 2 7 statistical criteria esteves et al 2020 introduced the use of statistical approaches to classify the dissolution regimes here a novel approach that is more general and considers dimensionless parameters is proposed the use of dimensionless parameters and the linearity of the transient advective diffusive reaction problem with respect to the acid concentration guarantee that the values of the proposed parameters do not depend on the initial acid concentration the network is partitioned in n c s volumes in the flow direction more specifically in this study the networks were partitioned in 10 equally distant sections in the flow direction each pore space that has its center within a partition volume it is said to belong to this partition thus some statistical quantities can be calculated for each cross sectional partition the coefficient of variation c v is a unit free measure of the dispersion of a data set that uses the standard deviation and the mean values the cv is used to evaluate the variation of the acid concentration profile within the network considering the definition of standard deviation see eq 51 the cv is determined for each network cross section partition c v c s by eq 52 where n p s is the total number of pores and throats identified by the subscript p s derived from pore space belonging to partition c s σ c s is the standard deviation of cross section c s c a p s is the acid concentration of the pore space p s and c a c s is the average concentration of acid of all pore spaces within cross section c s see eq 50 the c v for each simulation condition is then defined by eq 53 where c v c s is the average of all c v c s 50 c a c s 1 n p s p s 1 n p s c a p s 51 σ c s 1 n p s p s 1 n p s c a p s c a c s 2 52 c v c s σ c s c a c s 53 c v c v c s 1 n c s c s 1 n c s c v c s the measure of the extension of the acid along the network in the flow direction is characterized by the parameter δ c that is defined by eq 54 where c a i n is the inlet acid concentration and c a o u t is the acid concentration in the outlet pore 54 δ c c a i n c a o u t c a o u t hence these two parameters c v and δ c are used to identified the dissolution regimes the preferential pathways dissolution regime characterized by the formation of very conductive channels where acid flows preferentially is identified by a large c v this means that acid concentration of pores and throats within the same cross section varies significantly the surface dissolution regime is characterized by a more homogeneous spread of the acid along the cross sections perpendicular to the flow and is identified by a small c v small dispersion of the values of acid concentration in each cross section and a high δ c the high δ c identifies the consumption of the acid along the network due to the large reactivity of this dissolution regime finally uniform dissolution is described by small values of c v and δ c that identify a regime that the acid concentration is homogeneous within the cross sections and the consumption is nearly uniform in the entire domain due to the small reactivity of this dissolution regime 2 8 pore network models porous media are investigated using two and three dimensional 2d and 3d pore network models pore networks were constructed using openpnm gostick et al 2016 the pores are characterized as spherical and are connected to each other by cylindrical throats with circular cross sections as appropriate for single phase flow calculations pore walls are assumed to be composed of a single mineral such as calcite the two dimensional cubic network composed of 40x40 pores was generated considering a random uniform distribution of pore sizes in the range of 100 300 μ m throat diameters have 1 8 of the diameter of the smallest pore connected to it and the interpore distances are equal to 300 μ m the random three dimensional pore network was generated by a method from openpnm gostick et al 2016 that creates a random network formed by gabriel tessellation of arbitrary base points the size of the pores were defined by a random value between 70 90 of the smallest connected throat interpore distance throat diameters have 1 8 of the diameter of the smallest pore connected to it the network has a total of 1000 pores 3447 throats and an average coordination number of 6 89 a three dimensional network was constructed based on the topology information of a carbonate sample this means that the connectivity between pores as well as the location of pores and throats in the network were not generated randomly instead they were obtained by mapping the image of the pore spaces of a real carbonate rock sample the size of the pores were defined by a random value between 60 80 of the smallest connected throat interpore distance throat diameters have 1 8 of the diameter of the smallest pore connected to it the network has a total of 2612 pores 5071 throats and an average coordination number of 3 88 table 1 presents the initial porosity ϕ 0 and initial absolute permeability k 0 of the networks used in this study 3 results and discussion simulations of reactive transport and mineral dissolution are performed in different networks to show the applicability of the methodology for a wide range of systems acid with a concentration of 10 k g m 3 is injected from the left hand side of the network one dimensional flow in the positive x direction at a constant volumetric flow rate corresponding to a r e 0 1 fluid and solid properties are set to μ f 10 3 p a s ρ f 1000 k g m 3 and ρ s o l i d 2165 k g m 3 the stoichiometric coefficient that relates the consumed acid species with the consumed solid reactive mineral is set to β 1 37 simulation conditions were explored based on the dimensionless numbers p e d a and p e d a see table 2 for details these numbers were selected to represent the main dissolution regimes i e uniform dissolution surface dissolution and preferential pathways identified in the behavior diagrams presented in our previous work esteves et al 2020 recall that the uniform dissolution is observed for small d a numbers and is characterized by a reaction limited process surface dissolution and the preferential pathways regimes otherwise are characterized by transport limited processes and are highly dependent on p e esteves et al 2020 golfier et al 2002 the inlet velocity was fixed in order to keep r e constant and to make the time step the only free parameter necessary to define the courant number hence reaction rate constant and diffusivity were adjusted to reach the desired values of d a and p e respectively alternately v 0 could have been varied to obtain the desired range of p e d a and p e d a this alternative procedure was not implemented the range of k r and d α that were used are 10 4 m s 1 10 2 m s 1 and 10 9 m 2 s 1 10 2 m 2 s 1 respectively 3 1 effects of using correction factors the objective of this section is to show the importance of the use of correction factors in stick and ball pore network models one of the main important pieces of information transferred from pore scale to larger scales is the permeability versus porosity curves this type of curve is a constitutive relationship for reservoir simulations that relates the evolving permeability based on the increase of the porosity of the porous medium fig 6 presents an example of the permeability versus porosity curves obtained for simulations not considering the use of the correction factors in red and considering the use of correction factors in blue in the two dimensional network under the preferential pathways regime conditions in a small sample of a completely soluble porous media in the preferential pathways regime the acid solution should produce a k ϕ curve that is continuous smooth and resembles a power function with a large positive exponent or an exponential function the k ϕ obtained using the proposed pore merging method with correction factors clearly shows this behavior the deformation of the original pore spaces due to the merging hypothesis impacts significantly the behavior of the k ϕ curve fig 6 shows that the evolution of permeability is poorly represented without using correction factors as it shows some discontinuities see inset that is magnified in fig 6 and a much smaller permeability increase this means that the new methodology proposed here helps in the construction of a more accurate physical description of the evolution of a porous medium under reactive transport and mineral dissolution processes and generates more reliable input information for larger scale simulations 3 2 application in a two dimensional network this section aims to show the applicability of the methodology for two dimensional networks fig 7 presents the acid concentration profile at the end of simulations in the 40x40 network the expected dissolution regime for each simulation condition is observed preferential pathways are observed in the middle region of the network for condition 1 see fig 7a surface dissolution is characterized by a homogeneous high acid consumption along the network for condition 2 see fig 7b a uniform dissolution regime is observed for conditions 3 and 4 see figs 7c and 7d by a uniform and large spread of the acid throughout the entire network note that an analysis of the mass balance errors of these simulations as well as the next simulations discussed in this study are presented in appendix c fig 8 illustrates the complex flow rate profile for condition 1 characterized by a preferential pathways regime after 94 pvi in the 40x40 network the path with the greatest flow rates in the network corroborates the location of the preferential pathways formed during the simulation fig 9 presents the permeability versus porosity curves obtained for simulations in the 40x40 network the preferential pathways regime presents the largest increase of the permeability blue curve while the surface dissolution presents the largest increase of porosity orange curve these behaviors are observed because during the formation of preferential pathways most changes happen through the most permeable flow paths affecting significantly the overall conductance of the network whereas during the surface dissolution regime most changes happen nearby the inlet area of the network increasing the overall porosity but not the permeability uniform dissolution curves green and red curves present intermediate behavior the observed behaviors are expected as previously described in the literature egermann et al 2010 soulaine et al 2017 esteves et al 2020 varloteaux et al 2013 besides that note that the curve of preferential pathways dissolution regime needs more porosity increase than the uniform dissolution curves to reach the largest permeability increase this fact demonstrates the possible differences in behaviors for networks with different characteristic lengths and the importance to take into account the heterogeneity of the porous medium when discussing results also note that the increases observed in fig 9 reach values larger than 100 times the initial permeability of the network these results are possible because of the ability of the algorithm to merge pores and calculate conductance smoothly and accurately during the dissolution of the porous medium enabling a more accurate representation of what occurs in real porous media using a simplified stick and ball pore network model additionally a power law expression is generally used to represent the relationship between the logarithm of the k k 0 and the logarithm of ϕ ϕ 0 table d 1 from appendix d presents the power law exponents and coefficients of determination r 2 obtained for the simulations in the two dimensional networks and also for the next simulations presented in this study 3 2 1 evolution of correction factors this section presents the final profile of the correction factors simulating condition 1 characterized by a preferential pathways dissolution regime in the 40x40 network see fig 10 the objective here is to show the magnitude of the values necessary to correct the deformation of the pore spaces and conserve the main important properties for the reactive transport and mineral dissolution simulations note that modified correction factors are located around the preferential pathway and the pore spaces that suffered a merging process figs 10a and 10b present the final profile of the correction factor for the effective surface area of pores ψ i and throats ψ i j respectively the maximum changes for these cases reached approximately one order of magnitude fig 10c presents the final profile of the correction factor for the effective conductance of throats ϵ i j here the value of ϵ i j span eleven orders of magnitude it can be greater than 10 8 times the original values these results highlight the impact of the deformation of throats on transport during the merging process that impacts directly the permeability of the network and the importance in considering correction factors to conserve the evolution of the conductance profile along the network it should be noted that being locally defined the magnitudes of the correction factors do not depend on the network size 3 3 three dimensional network this section aims to show the applicability of the methodology for simulations in a three dimensional random network fig 11 presents the acid concentration profile at the end of simulations in the three dimensional random network preferential pathways are observed in the upper region of the network for condition 1 see fig 11a surface dissolution is characterized by a homogeneous high acid consumption along the network for condition 2 see fig 11b uniform dissolution is observed for conditions 3 and 4 see figs 11c and 11d by a uniform and significant spread of the acid throughout the entire network the pores with small acid concentration in fig 11c are in the inlet and outlet regions and are mostly connected to pores in the same region in this way they are under the same pressure and as diffusive transport in this condition is very small acid couldn t be transported to these specific pores fig 12 presents the permeability versus porosity curves obtained for simulations in the random network these results resemble behavior from simulations in the two dimensional network 3 4 carbonate network this section aims to show the possibility to use the pore merging methodology for very heterogeneous networks fig 13 presents the acid concentration profile at the end of simulations in the carbonate network the expected dissolution regime for each simulation condition is observed here there is the formation of different preferential pathways due to the significant heterogeneity of the system for condition 1 see fig 13a surface dissolution is characterized by a homogeneous and large acid consumption along the network for condition 2 see fig 13b the uniform dissolution regime is observed for conditions 3 and 4 see figs 13c and 13d by a large spread of the acid throughout the entire network note that there are many pores with small acid concentration in fig 13c condition 3 this is a consequence of the considerable heterogeneity of this network that presents many restricted pore spaces therefore acid can only reach these pore spaces by diffusion that occurs at a minimal rate under condition 3 fig 14 presents the permeability versus porosity curves obtained for simulations in the carbonate network the general trends are observed although the curve of the surface dissolution regime in orange presents a larger slope than the curve of the uniform dissolution with the same small peclet number in red this behavior is explained by the small permeability of this network and its significant heterogeneity there is significant flow resistance in the throats near the inlet region of the network thus the preferential dissolution of this region characteristic of the surface dissolution reduces this resistance and promotes the increase of the overall network permeability during the time simulated therefore this slightly odd behavior for the surface dissolution regimes does not occur for the more homogeneous networks previously discussed see figs 9 and 12 3 5 statistical parameters analysis here the statistical parameters obtained to identify the dissolution regimes are presented table 3 lists the statistical parameter c v and table 4 presents the statistical parameter δ c obtained for all the reactive transport and mineral dissolution simulations note that the results reflect the final acid concentration profiles and that the increase of porosity for all simulations reached at least 40 preferential pathways are identified by the largest values of c v and consequently the largest variance in the values of acid concentration within each cross section of the network based on the simulation results preferential pathways are identified by c v 1 surface dissolution cases are identified by the largest values of δ c this means that large acid consumption and large spread of the acid throughout the network are observed based on the simulation results the surface dissolution regime is identified by δ c 1 the uniform dissolution regime is characterized by the smallest values of c v and δ c this means that reactivity is small and acid spreads homogeneously throughout the entire network based on the simulation results the uniform dissolution regime is identified by both c v 1 and δ c 1 note that even for the more complex network topology the proposed parameters and criteria are able to identify the three main dissolution regimes this result is obtained despite the presence of significant heterogeneity with greater restrictions to flow and a large number of dead end pores that make interpretation difficult using simple quantitative criteria in addition appendix e presents quantitative results that demonstrate the adequacy of the proposed criteria for similar regular cubic networks generated with different random seeds finally it is suggested for future studies to obtain the values of these parameters in the region of intermediate p e and d a numbers in order to map their trends during regime transition 4 conclusions this study presents a novel pore network model to simulate single phase reactive transport and mineral dissolution in porous media a new methodology for the merging of pores and throats resulting from solid dissolution is introduced to guarantee the conservation of surface areas and throat conductances during the merging process pore surface areas and throat conductances are modeled accurately using a novel application of correction factors and effective properties a wide range of pore network models from a regular two dimensional network to highly heterogeneous three dimensional networks were used to study the reactive transport problem the main results include the exploration of different dissolution regimes through porosity permeability evolution curves acid concentration profiles and the use of statistical criteria to differentiate regimes importantly this methodology has the ability to simulate permeability increases larger than 100 fold during the formation of preferential pathways through the network the innovative approaches presented here may be used to improve the representation of many subsurface applications where reactive transport and mineral dissolution are the fundamental phenomena at the pore scale including performance of acidizing for stimulation geological storage of c o 2 and enhanced oil recovery as for future work a validation exercise is suggested to explore the accuracy of the model using core flow or micromodel experiments with extensive dissolution for verification this is an interesting research topic to verify the ability of the algorithm to represent mineral dissolution processes in porous media credit authorship contribution statement barbara f esteves conceptualization software writing original draft paulo l c lage conceptualization writing review editing paulo couto funding acquisition writing review editing anthony r kovscek conceptualization funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments bfe and ark acknowledge gratefully the support of the stanford center for carbon storage this study was financed in part by the coordenação de aperfeiçoamento de pessoal de nível superior brasil capes the conselho nacional de desenvolvimento científico e tecnológico cnpq and the project anp 20163 2 sponsored by shell brasil paulo l c lage acknowledges the financial support from cnpq grant no 305276 2019 0 appendix a algorithm for the volume evolution and geometry update the steps for the volume evolution and the geometry update of pores and throats are described below 1 computation of the change in volume of pores and throats due to a dissolution δ v i d and δ v i j d using eqs 11 and 12 b double dissolution δ v i d d and δ v i j d d using eqs 17 and 16 c the first correction step δ v i c 1 and δ v i j c 1 using eqs 21 and 20 d the second correction step δ v i c 2 and δ v i j c 2 using eqs 25 and 24 and e the transfer of porous spaces δ v i t and δ v i j t using eqs 30 and 29 2 computation of the total change in volume of pores by a 1 δ v i δ v i d δ v i d d δ v i c 1 δ v i c 2 δ v i t 3 computation of the total change in volume of throats by a 2 δ v i j δ v i j d δ v i j d d δ v i j c 1 δ v i j c 2 δ v i j t 4 update of the new volume of pores and throats respectively by a 3 v i n 1 v i n δ v i a 4 v i j n 1 v i j n δ v i j 5 computation of the change in mass of acid of pores and throats due to the transfer of porous spaces δ m i t and δ m i j t using eqs 32 and 31 6 computation of the total change in mass of acid inside of pores and throats by a 5 m i n 1 c i n 1 v i n δ m i t a 6 m i j n 1 c i j n 1 v i j n δ m i j t 7 update of the acid concentration based on the new volumes obtained by the geometry update as a 7 c i n 1 m i n 1 v i n 1 a 8 c i j n 1 m i j n 1 v i j n 1 8 calculation of the new pore radii considering pores as spheres by a 9 r i n 1 3 v i n 1 4 π 3 9 correction of the new length of throats by a 10 l i j n 1 d i j r i n 1 r j n 1 10 calculation of the new throat radii by a 11 r i j n 1 v i j n 1 π l i j n 1 2 11 update of the reactive surface area and cross sectional area of throats respectively using a 12 a r i j n 1 2 π r i j n 1 l i j n 1 a 13 a i j n 1 π r i j n 1 2 12 update the spherical cap areas at the inlet and outlet regions of pore i and determine the reactive surface area using respectively a 14 a i i j n 1 2 π r i n 1 r i n 1 r i n 1 2 r i j n 1 2 a 15 a r i n 1 4 π r i n 1 2 i j a i i j n 1 13 update of the effective surface area of pores and throats using eqs 6 and 7 14 update of the conductance of throats using eq 4 15 update of the effective conductance of throats using eq 3 the above procedure is repeated for each time step and because of this it is possible to evaluate the evolution of the permeability and porosity during the simulation of the reactive transport coupled with the dissolution process appendix b algorithm for the novel pore merging methodology the steps of the novel merging approach are described below 1 merging condition is satisfied 2 save geometric data of all original pores and throats involved in the merging process 3 call openpnm method for merging of pores and throats note that this method deletes the two original merging pores and all connected throats and after that creates a new merged pore and new connections between the new pore and the previous connected pores these new pore spaces do not have any geometric information or any data from the mass balance 4 update the position of the new merged pore using eq 33 5 update the radius of the new merged pore and all connected pores using eq 35 6 update the length of the new throats using eq 36 7 new connected throat radii are obtained by eq 38 the surface areas are obtained by eq 39 and the conductances are obtained by eq 40 8 correction factors for the effective surface area and conductance of the connected throats are updated respectively using eqs 41 and 42 if a new throat replaced two original throats use eqs 43 and 44 9 surface areas and correction factors for the effective surface area of the new merged pore and connected pores are updated using eqs a 15 and 45 10 effective surface area of pores and throats are updated using eqs 6 and 7 11 effective conductance of throats are updated using eq 3 remember that the correction factors are updated just after a change in the topology of the network and that the effective properties are used during the entire simulation for flow and mass balance equations thus for each time step after the geometry update of the pore spaces effective properties are determined using the actual correction factors appendix c mass balance errors the mass balance errors are estimated based on the relative difference between the accumulation term and the sum of the terms related to inlet outlet and consumption of mass of acid at the end of the simulation as described bellow c 16 m b e r r o r a c c u m u l a t i o n i n l e t o u t l e t c o n s u m p t i o n a c c u m u l a t i o n table c 1 presents the mass balance errors for the four simulation conditions explored using the three pore network models explored in this study the error is presented as a percentage appendix d power law exponents table d 1 presents the power law exponents and coefficients of determination r 2 obtained for the simulations in all networks considered in this work generally the surface dissolution regime condition 2 is identified by the smallest power law exponents this means that the increase of permeability is limited for a limited porosity variation note that in this regime most of the changes in volume occur around the inlet area where most of the acid is already consumed however the results for the carbonate network did not follow this trend as one case with uniform dissolution condition 4 showed a smaller power law coefficient the formation of preferential pathways condition 1 leads to sharp increases of the permeability for a limited porosity variation and consequently is identified by the largest values of the power law coefficients the simulation results in the 40x40 network present an exception to this conclusion and the uniform dissolution cases conditions 3 and 4 present the largest values of the exponents this can be explained by small values of the r 2 that shows that the power law form can not be the best expression to represent the behavior of the permeability versus permeability curves the uniform dissolution regime conditions 3 and 4 in general presents intermediate behavior of the curves compared to the preferential pathways regime and the surface dissolution regime appendix e quantitative criteria in similar networks tables e 1 and e 2 present the parameters c v and δ c respectively and their average values and standard deviation obtained by simulating reactive transport and mineral dissolution in different 10x10x10 regular cubic pore network models different initial seeds were used to generate the pore space sizes and all simulations reached at least 40 increase in porosity the main objective here is to show the viability of the proposed criteria to identify the main dissolution regimes in similarly constructed networks the bold values highlight the agreement with the proposed criteria where the preferential pathways regime is identified by c v 1 while c v 1 and δ c 1 characterize the surface dissolution regime the reported error at the 95 confidence level clearly shows that the regime classification using c v and δ c does not change within this error range 
263,this study proposes a pore network modeling algorithm to simulate single phase reactive transport and mineral dissolution in porous media a novel pore merging approach is introduced to guarantee the conservation of the most critical variables during the merging process by using correction factors and effective properties for throat conductances and surface areas our approach solves a coupled transport and reaction pore network model that implements a kinetic model with a single heterogeneous chemical reaction describing the dissolution of calcite by acidic solutions the network geometry is updated based on the dissolution process occurring at the mineral surface and the network topology is updated based on the pore merging processes occurring throughout the network the main results include the exploration of different dissolution regimes through porosity permeability evolution curves acid concentration profiles and the use of statistical criteria importantly this methodology simulates permeability increases larger than 100 fold during the formation of preferential pathways i e wormholes keywords pore network modeling reactive transport mineral dissolution pore scale modeling pore merging nomenclature z coordination number q i j volumetric flow rate through throat i j c ϵ i j effective conductance of throat i j ϵ i j correction factor for the conductance of throat i j r i j cross section radius of the throat i j μ dynamic viscosity of the fluid l i j length of the throat i j k absolute permeability of the network δ p pressure difference through the network a cross sectional area of the network l length of the network a ψ i effective surface area of pore i a ψ i j effective surface area of throat i j ψ i surface area correction factor of pore i ψ i j surface area correction factor of throat i j t time c α i mass concentration of species α in pore i c α i j mass concentration of species α in throat i j v i volume of pore i d α diffusion coefficient of species α r i radius of pore i r α i reaction rate of specie α due to heterogeneous chemical reaction in pore i r α i j reaction rate of specie α due to heterogeneous chemical reaction in throat i j δ v i d change in volume due to dissolution process in pore i δ v i j d change in volume due to dissolution process in throat i j δ r i d change in radius of pore i due to dissolution process δ r i j d change in radius of throat i j due to dissolution process δ v i i j d d change in volume due to double dissolution in the region between pore i and throat i j δ v i d d total change in volume due to double dissolution for pore i δ v i j d d total change in volume due to double dissolution for throat i j δ r i d d change in radius of pore i due to double dissolution δ v i i j c 1 change in volume due to correction 1 in the region between pore i and throat i j δ v i c 1 total change in volume due to correction 1 for pore i δ v i j c 1 total change in volume due to correction 1 for throat i j δ r i c 1 change in radius of pore i due to correction 1 δ v i i j c 2 change in volume due to correction 2 in the region between pore i and throat i j δ v i c 2 total change in volume due to correction 2 for pore i δ v i j c 2 total change in volume due to correction 2 for throat i j δ r i c 2 change in radius of pore i due to correction 2 δ v i i j t volume of the porous region previouly belonging to throat i j transferred to pore i δ m i i j t mass of acid in the porous region previouly belonged to throat i j transferred to pore i δ v i t total change in volume due to porous space transfer from throat i j to pore i for pore i δ v i j t total change in volume due to porous space transfer from throat i j to pore i for throat i j δ m i t total change in mass of acid due to porous space transfer from throat i j to pore i for pore i δ m i j t total change in mass of acid e due to porous space transfer from throat i j to pore i for throat i j x position vector x d m k interpore distance between the newly merged pore m and the connected pore k r m n 1 radius of the newly merged pore m r k n 1 radius of the pore k connected to the new merged pore m r m k n 1 radius of the newly throat connecting the merged pore m and the connected pore k a r m k n 1 reactive surface area of the newly throat connecting the merged pore m and the connected pore k c m k n 1 conductance of the newly throat connecting the merged pore m and the connected pore k ψ m k n 1 correction factor of the newly throat connecting the merged pore m and the connected pore k σ c s standard deviation of cross section c s c v c s coefficient of variation of cross section c s c v averaged coefficient of variation δ c measure of the consumption of acid along the network δ v i total change in volume of pore i δ v i j total change in volume of throat i j 1 introduction reactive transport and mineral dissolution in porous media are fundamental processes in many subsurface applications including carbon dioxide c o 2 storage enhanced oil recovery eor and acidizing for stimulation sohrabi et al 2012 wolterbeek and raoof 2018 menke et al 2018 gharbi et al 2013 for example c o 2 injection into reservoirs triggers the occurrence of chemical reactions that induce changes in mechanical properties of the rock especially in porous media rich in carbonate minerals egermann et al 2010 rathnaweera et al 2016 bemer and lombard 2010 regarding geological c o 2 storage these structural alterations are a source of concern for the safety and efficiency of the process due to the increase of the chances for leakage and c o 2 migration out of the storage formation deng et al 2017 egermann et al 2010 rathnaweera et al 2016 bemer and lombard 2010 indeed depending on the dominant transport mechanism poor utilization of the pore space for the storage of c o 2 may occur ott and oedai 2015 regarding acidizing for well stimulation the main goal is to increase well productivity the formation of preferential pathways is desired to increase the overall conductance through the reservoir hill and schechter 2000 ott and oedai 2015 fredd and fogler 1999 accordingly good understanding of the dissolution processes is imperative to assess long term reservoir integrity properties for c o 2 storage and to design efficiently acidizing treatments rathnaweera et al 2016 bemer and lombard 2010 fredd and dowell 2000 in order to investigate the dissolution processes in porous media several numerical approaches such as direct numerical simulations dns that include computational fluid dynamics cfd soulaine et al 2017 oliveira et al 2019 molins et al 2012 lattice bolztmann method lbm liu and mostaghimi 2017 kang et al 2002 huber et al 2014 smoothed particle hydrodynamics sph tartakovsky et al 2016 and approaches that consider a simplified conceptualization of the porous media commonly associated with pore network modeling pnm have been developed esteves et al 2020 li et al 2006 algive et al 2010 raoof et al 2012 tansey and balhoff 2016 budek and szymczak 2012 an overview of the various numerical approaches applied to pore scale mineral dissolution are found in molins et al 2020 pore network modeling is a technique that is widely used to represent natural porous media and complex pore geometries using a simplified pore and throat type network algive et al 2010 since the pioneering work of fatt 1956 that studied two phase flow and capillary pressure curves pore network models have been successfully applied in numerous research areas including reactive transport and mineral dissolution problems li et al 2006 algive et al 2010 raoof et al 2012 tansey and balhoff 2016 esteves et al 2020 the computational efficiency of pore network models is related to the simplicity of their geometry and because of this feature pore network modeling is considered applicable to much larger domains when compared to direct simulation methods mehmani and balhoff 2015 yang et al 2016 in this context merging of pores and throats to form vug like pores is needed to evaluate better regimes with significant mineral reactivity the appropriate treatment of pore merging allows a better representation of the physical problem and makes possible the use of reactive transport simulations to evaluate dissolution regimes in more complex network topologies where the merging of pores is likely to occur with great frequency due to the heterogeneity of these type of porous media few pore network modeling studies explored the use of pore merging methods to explore mineral dissolution in porous media budek and szymczak 2012 performed the first pore network study that considered an approach to merge pores during reactive transport and mineral dissolution the porous medium was represented by a two dimensional triangular network of cylindrical tubes the points where the tubes meet are referred to as nodes in this way pores are defined just as node points for pressure determination then throats are tubes that enlarge during the dissolution process note that a single reactant is assumed to describe approximately the carbonate dissolution their methodology for merging considers that as the diameters of the eroding throats become comparable to the interpore distances the throats are joined together the assumption is that the new throat has the same diameter as the sum of the diameters of the original two throats with this the reactive surface area is conserved during the merging process but the volume is not tansey and balhoff 2016 developed a pore network model of heterogeneous reactive transport and matrix dissolution that considers a pore merging criterion to improve the pore scale physics of the network simulations were conducted on random close pack arrangements of spheres and the transport equation assumes pores as the only control volumes throats represent the conductances throughout the network this approach also assumes the tracking of only one chemical species and the reactive transport equation is solved explicitly during simulation pores grow assuming a static geometry by preserving the relation between surface area and volume throat cross section areas are updated based on the new surface area of the connected pores throat conductances are then updated based on the new cross sectional areas also assuming a static geometry using a shape factor to map the throat shape onto a cylindrical tube and preserving initial relationships between throat cross section and conductivity the merging approach developed by tansey and balhoff 2016 assumes that the new merged pore s volume is equal to the combined volume of both original pores the use of a merging criterion by tansey and balhoff 2016 showed the importance of capturing the formation of preferential pathways without merging of overlapping pores permeability could not increase past a small fraction of its potential reaching a plateau with no occurrence of wormholes tansey and balhoff 2016 clearly significant insights and improvements were achieved by these studies although some strong simplifications were assumed related to the evolution of geometry during dissolution and merging processes assuming static relations between surface areas and volumes may not be the best representation for all the different dissolution regimes because pores and throats may be affected differently the conservation of geometry and flow properties during the application of a merging strategy is paramount to maintain a continuous evolution of porous media due to the dissolution process the structure of the network before and after two overlapping pores merge must be represented in a manner faithful to the physical problem and include a minimum of unrealistic simplifications maintenance of the available reactive surface area and volume of the overlapping pores as well as conductivity of the connected throats are essential for an accurate evaluation of the dissolution regimes transport phenomena and reaction within the pore spaces are highly dependent on these properties therefore the main objective of this study is to develop a new methodology to describe the merging of pores and throats resulting from solid matrix dissolution during single phase flow that guarantees the conservation of the main variables of interest namely porous volume mass of acid reactive surface area and throat conductances surface areas and conductances are modeled using a novel application of correction factors and effective properties thus the conservation of these properties is possible during the merging process in addition to the volume and mass of acid already conserved this approach aims to bring pore network models closer to the physical problem and make possible reactive transport simulations to evaluate dissolution regimes in more complex network topologies in such networks the odds for the junction of two pore spaces initially separated increases due to the heterogeneity in pore sizes 2 methodology this section first presents the equations to determine the pressure and concentration fields the kinetics of dissolution and the evolution of the volumes and geometry of a stick and ball network are also described then the new pore merging approach to describe dissolving pores is introduced finally definition of the dimensionless numbers and the statistical criteria are presented the pore network models used for this study are presented at the end of this section 2 1 pressure field the pseudo steady state flow of a single phase incompressible fluid is assumed in order to obtain the pressure field of the network the mass conservation for each pore is given by 1 i j z q i j 0 where z is the coordination number and q i j is the volumetric flow rate through throat i j the volumetric flow rate through a pore throat is determined by the pressure difference between the connected pores i and j p i p j and the throat effective conductance c ϵ i j as follows 2 q i j c ϵ i j p i p j note that throat volumetric flow rates are obtained using the effective conductance instead of the conductance derived only from geometrical data effective conductances assure that the relationship between flow rate through pores and the extent of dissolution is represented accurately after merging the effective conductance c ϵ i j is described by 3 c ϵ i j ϵ i j c i j where ϵ i j is the conductance correction factor the conductance correction factor is equal to 1 for all original throats and the value is updated when the throat i j is involved in a merging process thus initially the effective conductance is equal to the conductance the throat conductance is obtained by use of poiseuille s law for laminar flow in a cylindrical tube 4 c i j π r i j 4 8 μ l i j where r i j is the radius of throat i j cross section μ is the dynamic viscosity of the fluid and l i j is the length of the throat i j substituting eqs 2 and 4 into eq 1 a linear algebraic system for the unknown pressure field is solved for the pressure in each pore constant volumetric flow rate at the inlet boundary and fixed pressure at the outlet boundary are imposed to determine the pseudo steady state flow field of the network fixed pressures are imposed at the inlet and outlet boundaries to determine the absolute permeability all other boundaries are closed therefore both cases are one dimensional flow problems considering the last case the total flow rate through the network q is obtained after pressure field determination and darcy s law is used to calculate the absolute permeability k of the system as described below 5 k μ q l a δ p where a is the cross sectional area of the network and l is the length of the network 2 2 concentration field the reactive transport problem is described by the mass balance in all available pore spaces pores and throats and is deduced from the mass conservation equations of the chemical species bird et al 2007 this new approach uses effective surface areas instead of the reactive surface areas obtained just by geometrical information the effective surface area is the geometrical reactive surface area corrected by a correction factor due to merging as presented below 6 a ψ i ψ i a r i 7 a ψ i j ψ i j a r i j where a ψ i is the effective surface area of pore i a ψ i j is the effective surface area of throat i j ψ i is the surface area correction factor of pore i and ψ i j is the surface area correction factor of throat i j thus original pores and throats have surface area correction factors equal to 1 the correction factor of a pore space is just updated if it is involved in a merging process so until a merging event occurs the effective surface area of a pore space is equal to its geometrical surface area obtained by eqs a 15 and a 12 respectively for pores and throats implementation of correction factors ensures that surface area and conductance evolve in a physically realistic manner more details about the update of surface area correction factors are available in later sections the transport of a chemical species occurs by advection and diffusion the mass balance equation for chemical species α in a spherical pore i is 8 d d t c α i v i i j i n c α i j q i j c α i i j o u t q i j i j a i j d α c α i j c α i 0 5 l i j r i r α i a ψ i where t is the time c α i is the mass concentration of species α in pore i c α i j is the mass concentration of species α in throat i j v i is the volume of pore i a i j is the cross sectional area of throat i j d α is the diffusion coefficient of species α r i is the radius of pore i r α i is the reaction rate of species α due to heterogeneous chemical reaction in pore i for control volumes represented by cylindrical throats i j the mass balance equation for species α is 9 d d t c α i j v i j c α i c α i j q i j a i j d α c α i c α i j 0 5 l i j r i a i j d α c α j c α i j 0 5 l i j r j r α i j a ψ i j where c α i is the mass concentration of species α in the pore from where the flow is arriving in the throat i j in our approach the concentration field is solved implicitly and the volume explicitly in a sequential algorithm in other words the system is solved for the new concentrations based on the previous geometry that is kept constant during the solution of eqs 8 and 9 the linear system for the unknown concentrations of species α is solved by spsolve direct method from the scipy library jones et al 2001 the domain initial condition considers a constant concentration profile and the domain boundary conditions consider a constant concentrations for the inlet pore spaces and an outflow boundary condition for the outlet pores 2 3 dissolution kinetics during the dissolution process porous medium geometry and topology evolves with heterogeneous chemical reactions at the effective surface areas of pores and throats our approach solves a coupled transport and reaction pore network model that implements a kinetic model with a single heterogeneous chemical reaction describing the dissolution of calcite c a c o 3 by acidic solutions h c l as follows 10 c a c o 3 s 2 h c l a q c a c l 2 a q c o 2 a q h 2 o l because the acid is the only component in the aqueous phase that reacts with the solid mineral it is the only chemical species concentration that needs to be tracked note that the rate limiting reaction is the acid attack on calcite and it is assumed that carbonate equilibria is totally shifted toward c o 2 a q due to the significant acid concentration in the system thus a single reaction rate is enough to represent our problem this approach follows from previous literature budek and szymczak 2012 tansey and balhoff 2016 soulaine et al 2017 esteves et al 2020 2 4 volume evolution and geometry update as our solution involves geometry changes at each time step control volumes of pores and throats are changed in this way at each time step with the solution of the concentration field based on mass balance the change in volume of the pore spaces is obtained by relating the solid volume consumed on the effective surface of each pore space to the density of the reactive mineral that composes the porous medium considering i a first order reaction rate for the heterogeneous chemical reaction and ii a stoichiometric coefficient β that relates the consumption of the hydrochloric acid α a to the consumption of the reactive mineral the change in volume due to the dissolution process is given by 11 δ v i d r a i a ψ i n β δ t ρ s k r c a i n 1 a ψ i n β δ t ρ s 12 δ v i j d r a i j a ψ i j n β δ t ρ s k r c a i j n 1 a ψ i j n β δ t ρ s where c a i n 1 and c a i j n 1 are the acid concentration in pore i and throat i j respectively after the solution of the mass transport in the network δ v i d is the change in volume due to dissolution process in pore i δ v i j d is the change in volume due to dissolution process in throat i j and ρ s is the density of the solid phase based on eqs 11 and 12 the change in the radii of pores δ r i d and throats δ r i j d due to dissolution is defined respectively as 13 δ r i d δ v i d a ψ i n k r c a i n 1 β δ t ρ s 14 δ r i j d δ v i j d a ψ i j n k r c a i j n 1 β δ t ρ s in this algorithm there are regions in the contact area between pore i and connecting throats i j that are dissolved twice that is portions of the pore i and the throat i j are dissolved simultaneously during δ t see fig 1 hatched area in red this consumed volume needs to be counted twice to keep the conservation of mass for this the volume related to this region derived from the dissolution of throat i j is transferred to the pore i the change in volume due to double dissolution is then defined by 15 δ v i i j d d π r i j n δ r i j d 2 r i j n 2 δ r i d for throats the double dissolution considers the contact area between the two connected pores i and j see eq 16 and for pores the double dissolution may account for the contact area between pore i and all connected throats i j see eq 17 16 δ v i j d d δ v i i j d d δ v j i j d d 17 δ v i d d i j δ v i i j d d the change in radius of pore i due to the double dissolution is defined by 18 δ r i d d δ v i d d a ψ i n the grain region that pore i invades due to the addition of the double dissolved volumes that is also invaded by the dissolution of throat i j see fig 1 hatched area in green is also transferred for the pore the volumes related to this region are defined by eq 19 the total change in volume related to this step for throats and pores are defined respectively in eqs 20 and 21 19 δ v i i j c 1 π r i j n δ r i j d 2 r i j n 2 δ r i d d 20 δ v i j c 1 δ v i i j c 1 δ v j i j c 1 21 δ v i c 1 i j δ v i i j c 1 the change in radius of pore i due to this first correction step is defined by 22 δ r i c 1 δ v i c 1 a ψ i n again the grain region that pore i invades due to the addition of the correction volume δ v i i j c 1 that is also invaded by the dissolution of throat i j see fig 1 hatched area in blue is transferred to the pore the volumes related to this region are defined by eq 23 the total change in volume related to this step for throats and pores are defined respectively in eqs 24 and 25 23 δ v i i j c 2 π r i j n δ r i j d 2 r i j n 2 δ r i c 1 24 δ v i j c 2 δ v i i j c 2 δ v j i j c 2 25 δ v i c 2 i j δ v i i j c 2 the change in radius of pore i due to the this second correction step is defined by 26 δ r i c 2 δ v i c 2 a ψ i n formally the transfer of volumes between pores and throats requires an iterative process to achieve a desired level of accuracy here the correction step stops in the second iteration because its magnitude is already rather small for example for a pore and a throat with diameters equal to 1 and 0 25 respectively that had an increase of 0 2 the relative error of the final volume of the pore after the second iteration compared to 10 more iterations is 0 00006 finally pore i invades a porous region previously belonging to throat i j see fig 1 hatched area in purple for this case not only the volume but also the mass of acid that previously belonged to throat i j needs to be transferred to pore i considering this the transferred porous volume and mass of acid from throat i j to pore i are defined respectively by 27 δ v i i j t δ r i d δ r i d d δ r i c 1 δ r i c 2 a i i j n 28 δ m i i j t c i j n 1 δ r i d δ r i d d δ r i c 1 δ r i c 2 a i i j n where a i i j n is the spherical cap area between the pore i and throat i j at t n that is given by eq a 14 the total change in volume related to this step for throats and pores are defined respectively in eqs 29 and 30 29 δ v i j t δ v i i j t δ v j i j t 30 δ v i t i j δ v i i j t the total change in mass of acid related to this step for throats and pores are defined respectively in eqs 31 and 32 31 δ m i j t δ m i i j t δ m j i j t 32 δ m i t i j δ m i i j t fig 1 presents a schematic of the transferred volumes described previously in this section and appendix a presents the algorithm for the volume evolution and geometry update note that some controls on the numerical scheme were implemented as follows the ratio of the change of throat radius due to dissolution δ r i j d to the throat radius from the previous time step was always kept smaller than 0 1 in order to keep a good approximation of the differentials also the courant numbers defined as the ratio of the inlet velocity multiplied by the time step to the average length of throats in all simulations ranged from 0 11 to 1 34 importantly all transport limited conditions were simulated using courant numbers smaller than 1 these control strategies make the use of 2 iterations to account for the double dissolution accurate to within about 1 part per million as compared to fully converged simulations 2 5 pore merging methodology this section presents the methodology developed to consider merging of pores and throats during reactive transport simulations when pore surfaces dissolve the novel merging approach methodology introduces the use of correction factors to conserve effective surface areas and conductances during the merging process in this way the strategy for merging of pores and throats presented here aims to conserve not only the volume and the mass balance in the system before and after the application of the merging method but also the reactive surface areas and conductances these are key parameters for the reactive transport problem that depends strongly on flow properties conductance of throats and features related to the reactivity of the system reactive surface area the idea is to consider an effective surface area and an effective conductance as the parameters necessary to solve the reactive transport problem in other words the idea is to replace the area and conductance originally obtained by an effective surface area and conductance that considers approximately the deformation of the pore spaces upon merging for this correction factors are introduced to conserve the effective surface area and effective conductance during the merging process therefore ψ is introduced as the correction factor for surface areas and ϵ is introduced as the correction factor for conductance effective surface area of pores and throats were defined previously in this section by eqs 6 and 7 effective conductance of throats are defined by eq 3 considering this original pores and throats have correction factors equal to 1 so the effective surface areas and effective conductances have the same value as the surface areas and conductances of the pores spaces newly merged pores as well as pores and throats connected to the new merged pores have correction factors different from one to account for the geometric deformations arising from the assumptions of the merge method and in this way conserve the effective surface areas and effective conductances during the merging process here the merging method is performed when two connected pores reach each other and also when a throat diameter reaches the same value of the diameter of a connected pore at the end of the geometry update due to dissolution at each time step the main steps of this novel merging methodology are then described the method is explained considering the case of the overlapping pores but it is similar for the case of throats with larger diameters than the connected pores during the merging process when the merging condition is satisfied the two original pores are replaced by one new pore with volume mass of acid and effective surface area equal to the sum of the corresponding properties of the two original pores see fig 2 the new merged pore is located in the volume weighted average of the coordinates of the connecting pores as presented below 33 x m n 1 v i n 1 x i n 1 v j n 1 x j n 1 v m n 1 where x m n 1 x i n 1 x j n 1 are the position vectors of the merged pore m and the merging pores i and j respectively the volume of the newly merged pore is given by 34 v m n 1 v i n 1 v j n 1 the new radius of the merged pore r m n 1 is obtained by 35 r m n 1 3 v m n 1 4 π 3 the length of a throat connected to the new merged pore l m k n 1 is updated due to the location of the merged pore by 36 l m k n 1 d m k n 1 r m n 1 r k n 1 where d m k n 1 is the interpore distance between the newly merged pore m and the connected pore k as follows 37 d m k n 1 x m n 1 x k n 1 where x m n 1 and x k n 1 are the position vectors of pores m and k there are two different procedures in generating the throats connected to the newly merged pore the first one applies to throats that connected pores i and j to a third pore that is not simultaneously connected to pores i and j in this case the throat properties just have to be updated otherwise throat merging is carried out for the first procedure the throats connected to the merged pore have the same volume mass of acid effective surface area and effective conductance as before the merging process in this way the radii of the throats connected to the newly merged pore are updated considering their current volume and the new length by 38 r m k n 1 v m k n 1 π l m k n 1 2 the deformation of the throats during the merging process change the reactive surface area and conductance see fig 3 the new surface area and conductance of the throats involved in the merging process are determined respectively by 39 a r m k n 1 2 π r m k n 1 l m k n 1 40 c m k n 1 π r m k n 1 4 8 μ l m k n 1 at this stage the correction factors for the surface area ψ m k and for the conductance ϵ m k are updated to maintain the correct effective surface areas and effective conductances of the throats during the merging process by 41 ψ m k n 1 a ψ i k n 1 a r m k n 1 42 ϵ m k n 1 c ϵ i k n 1 c m k n 1 if the original merging pores were connected to the same pore one new merged throat replaces the two original throats so the merged throat connected to the merged pore keeps the sum of the volume mass of acid effective surface area and conductance of the replaced throats see fig 4 the new throat length radius effective surface area and effective conductance are also computed from eqs 36 38 39 and 40 consequently the correction factors are defined as 43 ψ m k n 1 a ψ i k n 1 a ψ j k n 1 a r m k n 1 44 ϵ m k n 1 c ϵ i k n 1 c ϵ i k n 1 c m k n 1 finally the reactive surface area of the new merged pore is updated considering its new radius r m n 1 and the new radii of the connected throats using eq a 15 then the correction factor to maintain the correct effective surface area during the merging process is obtained by 45 ψ m n 1 a ψ i n 1 a ψ j n 1 a r m n 1 note that the pores connected to the new merged pore also need their effective surface areas updated due to the changes in the radii of the connected throats during the merging process the merging approach presented here uses the merging method available within openpnm gostick et al 2016 to update the topology of the network the method creates a new pore to replace the two original pores that are merging deletes all throats connected to the two original pores and creates new throats connecting the new merged pore to the pores previously connected to the original merging pores considering this data from all pores and throats involved in the merging process are identified and saved before calling the merge method from openpnm and then relocated to the new pores and throats fig 5 presents a flowchart with the main steps of the novel merging methodology and appendix b presents the algorithm for the new pore merging methodology it should be emphasized that although the simple stick and ball pore network model was used to model initially the porous medium the pore and throat shapes become abstract due to the merging process 2 6 dimensionless numbers the use of dimensionless numbers in reactive transport aims to generalize predictions and results across a range of transport and reaction rate conditions problems involving reactive transport usually take into account reynolds r e péclet p e damköhler d a and péclet damköhler p e d a numbers to characterize different dissolution patterns the definitions used in this work follow from soulaine et al 2017 are calculated at the initial time and presented below 46 r e ρ f v 0 k 0 μ f 47 p e v 0 k 0 d α 48 p e d a k r a s s d α 49 d a k r v 0 k 0 a s s where ρ f is the fluid density v 0 is the inlet interstitial velocity k 0 is the square root of the initial permeability of the porous medium μ f is the fluid dynamic viscosity d α is the diffusion coefficient of species α k r is the constant of reaction and a s s is the specific surface area of the porous medium defined as the ratio of reactive surface area of all pores and throats to the total porous volume note that the p e d a is important for diffusion dominated transport i e at low p e where dissolution patterns are driven by the competition between diffusion and reaction d a alone is appropriate in discussions involving advection dominated transport i e at high p e 2 7 statistical criteria esteves et al 2020 introduced the use of statistical approaches to classify the dissolution regimes here a novel approach that is more general and considers dimensionless parameters is proposed the use of dimensionless parameters and the linearity of the transient advective diffusive reaction problem with respect to the acid concentration guarantee that the values of the proposed parameters do not depend on the initial acid concentration the network is partitioned in n c s volumes in the flow direction more specifically in this study the networks were partitioned in 10 equally distant sections in the flow direction each pore space that has its center within a partition volume it is said to belong to this partition thus some statistical quantities can be calculated for each cross sectional partition the coefficient of variation c v is a unit free measure of the dispersion of a data set that uses the standard deviation and the mean values the cv is used to evaluate the variation of the acid concentration profile within the network considering the definition of standard deviation see eq 51 the cv is determined for each network cross section partition c v c s by eq 52 where n p s is the total number of pores and throats identified by the subscript p s derived from pore space belonging to partition c s σ c s is the standard deviation of cross section c s c a p s is the acid concentration of the pore space p s and c a c s is the average concentration of acid of all pore spaces within cross section c s see eq 50 the c v for each simulation condition is then defined by eq 53 where c v c s is the average of all c v c s 50 c a c s 1 n p s p s 1 n p s c a p s 51 σ c s 1 n p s p s 1 n p s c a p s c a c s 2 52 c v c s σ c s c a c s 53 c v c v c s 1 n c s c s 1 n c s c v c s the measure of the extension of the acid along the network in the flow direction is characterized by the parameter δ c that is defined by eq 54 where c a i n is the inlet acid concentration and c a o u t is the acid concentration in the outlet pore 54 δ c c a i n c a o u t c a o u t hence these two parameters c v and δ c are used to identified the dissolution regimes the preferential pathways dissolution regime characterized by the formation of very conductive channels where acid flows preferentially is identified by a large c v this means that acid concentration of pores and throats within the same cross section varies significantly the surface dissolution regime is characterized by a more homogeneous spread of the acid along the cross sections perpendicular to the flow and is identified by a small c v small dispersion of the values of acid concentration in each cross section and a high δ c the high δ c identifies the consumption of the acid along the network due to the large reactivity of this dissolution regime finally uniform dissolution is described by small values of c v and δ c that identify a regime that the acid concentration is homogeneous within the cross sections and the consumption is nearly uniform in the entire domain due to the small reactivity of this dissolution regime 2 8 pore network models porous media are investigated using two and three dimensional 2d and 3d pore network models pore networks were constructed using openpnm gostick et al 2016 the pores are characterized as spherical and are connected to each other by cylindrical throats with circular cross sections as appropriate for single phase flow calculations pore walls are assumed to be composed of a single mineral such as calcite the two dimensional cubic network composed of 40x40 pores was generated considering a random uniform distribution of pore sizes in the range of 100 300 μ m throat diameters have 1 8 of the diameter of the smallest pore connected to it and the interpore distances are equal to 300 μ m the random three dimensional pore network was generated by a method from openpnm gostick et al 2016 that creates a random network formed by gabriel tessellation of arbitrary base points the size of the pores were defined by a random value between 70 90 of the smallest connected throat interpore distance throat diameters have 1 8 of the diameter of the smallest pore connected to it the network has a total of 1000 pores 3447 throats and an average coordination number of 6 89 a three dimensional network was constructed based on the topology information of a carbonate sample this means that the connectivity between pores as well as the location of pores and throats in the network were not generated randomly instead they were obtained by mapping the image of the pore spaces of a real carbonate rock sample the size of the pores were defined by a random value between 60 80 of the smallest connected throat interpore distance throat diameters have 1 8 of the diameter of the smallest pore connected to it the network has a total of 2612 pores 5071 throats and an average coordination number of 3 88 table 1 presents the initial porosity ϕ 0 and initial absolute permeability k 0 of the networks used in this study 3 results and discussion simulations of reactive transport and mineral dissolution are performed in different networks to show the applicability of the methodology for a wide range of systems acid with a concentration of 10 k g m 3 is injected from the left hand side of the network one dimensional flow in the positive x direction at a constant volumetric flow rate corresponding to a r e 0 1 fluid and solid properties are set to μ f 10 3 p a s ρ f 1000 k g m 3 and ρ s o l i d 2165 k g m 3 the stoichiometric coefficient that relates the consumed acid species with the consumed solid reactive mineral is set to β 1 37 simulation conditions were explored based on the dimensionless numbers p e d a and p e d a see table 2 for details these numbers were selected to represent the main dissolution regimes i e uniform dissolution surface dissolution and preferential pathways identified in the behavior diagrams presented in our previous work esteves et al 2020 recall that the uniform dissolution is observed for small d a numbers and is characterized by a reaction limited process surface dissolution and the preferential pathways regimes otherwise are characterized by transport limited processes and are highly dependent on p e esteves et al 2020 golfier et al 2002 the inlet velocity was fixed in order to keep r e constant and to make the time step the only free parameter necessary to define the courant number hence reaction rate constant and diffusivity were adjusted to reach the desired values of d a and p e respectively alternately v 0 could have been varied to obtain the desired range of p e d a and p e d a this alternative procedure was not implemented the range of k r and d α that were used are 10 4 m s 1 10 2 m s 1 and 10 9 m 2 s 1 10 2 m 2 s 1 respectively 3 1 effects of using correction factors the objective of this section is to show the importance of the use of correction factors in stick and ball pore network models one of the main important pieces of information transferred from pore scale to larger scales is the permeability versus porosity curves this type of curve is a constitutive relationship for reservoir simulations that relates the evolving permeability based on the increase of the porosity of the porous medium fig 6 presents an example of the permeability versus porosity curves obtained for simulations not considering the use of the correction factors in red and considering the use of correction factors in blue in the two dimensional network under the preferential pathways regime conditions in a small sample of a completely soluble porous media in the preferential pathways regime the acid solution should produce a k ϕ curve that is continuous smooth and resembles a power function with a large positive exponent or an exponential function the k ϕ obtained using the proposed pore merging method with correction factors clearly shows this behavior the deformation of the original pore spaces due to the merging hypothesis impacts significantly the behavior of the k ϕ curve fig 6 shows that the evolution of permeability is poorly represented without using correction factors as it shows some discontinuities see inset that is magnified in fig 6 and a much smaller permeability increase this means that the new methodology proposed here helps in the construction of a more accurate physical description of the evolution of a porous medium under reactive transport and mineral dissolution processes and generates more reliable input information for larger scale simulations 3 2 application in a two dimensional network this section aims to show the applicability of the methodology for two dimensional networks fig 7 presents the acid concentration profile at the end of simulations in the 40x40 network the expected dissolution regime for each simulation condition is observed preferential pathways are observed in the middle region of the network for condition 1 see fig 7a surface dissolution is characterized by a homogeneous high acid consumption along the network for condition 2 see fig 7b a uniform dissolution regime is observed for conditions 3 and 4 see figs 7c and 7d by a uniform and large spread of the acid throughout the entire network note that an analysis of the mass balance errors of these simulations as well as the next simulations discussed in this study are presented in appendix c fig 8 illustrates the complex flow rate profile for condition 1 characterized by a preferential pathways regime after 94 pvi in the 40x40 network the path with the greatest flow rates in the network corroborates the location of the preferential pathways formed during the simulation fig 9 presents the permeability versus porosity curves obtained for simulations in the 40x40 network the preferential pathways regime presents the largest increase of the permeability blue curve while the surface dissolution presents the largest increase of porosity orange curve these behaviors are observed because during the formation of preferential pathways most changes happen through the most permeable flow paths affecting significantly the overall conductance of the network whereas during the surface dissolution regime most changes happen nearby the inlet area of the network increasing the overall porosity but not the permeability uniform dissolution curves green and red curves present intermediate behavior the observed behaviors are expected as previously described in the literature egermann et al 2010 soulaine et al 2017 esteves et al 2020 varloteaux et al 2013 besides that note that the curve of preferential pathways dissolution regime needs more porosity increase than the uniform dissolution curves to reach the largest permeability increase this fact demonstrates the possible differences in behaviors for networks with different characteristic lengths and the importance to take into account the heterogeneity of the porous medium when discussing results also note that the increases observed in fig 9 reach values larger than 100 times the initial permeability of the network these results are possible because of the ability of the algorithm to merge pores and calculate conductance smoothly and accurately during the dissolution of the porous medium enabling a more accurate representation of what occurs in real porous media using a simplified stick and ball pore network model additionally a power law expression is generally used to represent the relationship between the logarithm of the k k 0 and the logarithm of ϕ ϕ 0 table d 1 from appendix d presents the power law exponents and coefficients of determination r 2 obtained for the simulations in the two dimensional networks and also for the next simulations presented in this study 3 2 1 evolution of correction factors this section presents the final profile of the correction factors simulating condition 1 characterized by a preferential pathways dissolution regime in the 40x40 network see fig 10 the objective here is to show the magnitude of the values necessary to correct the deformation of the pore spaces and conserve the main important properties for the reactive transport and mineral dissolution simulations note that modified correction factors are located around the preferential pathway and the pore spaces that suffered a merging process figs 10a and 10b present the final profile of the correction factor for the effective surface area of pores ψ i and throats ψ i j respectively the maximum changes for these cases reached approximately one order of magnitude fig 10c presents the final profile of the correction factor for the effective conductance of throats ϵ i j here the value of ϵ i j span eleven orders of magnitude it can be greater than 10 8 times the original values these results highlight the impact of the deformation of throats on transport during the merging process that impacts directly the permeability of the network and the importance in considering correction factors to conserve the evolution of the conductance profile along the network it should be noted that being locally defined the magnitudes of the correction factors do not depend on the network size 3 3 three dimensional network this section aims to show the applicability of the methodology for simulations in a three dimensional random network fig 11 presents the acid concentration profile at the end of simulations in the three dimensional random network preferential pathways are observed in the upper region of the network for condition 1 see fig 11a surface dissolution is characterized by a homogeneous high acid consumption along the network for condition 2 see fig 11b uniform dissolution is observed for conditions 3 and 4 see figs 11c and 11d by a uniform and significant spread of the acid throughout the entire network the pores with small acid concentration in fig 11c are in the inlet and outlet regions and are mostly connected to pores in the same region in this way they are under the same pressure and as diffusive transport in this condition is very small acid couldn t be transported to these specific pores fig 12 presents the permeability versus porosity curves obtained for simulations in the random network these results resemble behavior from simulations in the two dimensional network 3 4 carbonate network this section aims to show the possibility to use the pore merging methodology for very heterogeneous networks fig 13 presents the acid concentration profile at the end of simulations in the carbonate network the expected dissolution regime for each simulation condition is observed here there is the formation of different preferential pathways due to the significant heterogeneity of the system for condition 1 see fig 13a surface dissolution is characterized by a homogeneous and large acid consumption along the network for condition 2 see fig 13b the uniform dissolution regime is observed for conditions 3 and 4 see figs 13c and 13d by a large spread of the acid throughout the entire network note that there are many pores with small acid concentration in fig 13c condition 3 this is a consequence of the considerable heterogeneity of this network that presents many restricted pore spaces therefore acid can only reach these pore spaces by diffusion that occurs at a minimal rate under condition 3 fig 14 presents the permeability versus porosity curves obtained for simulations in the carbonate network the general trends are observed although the curve of the surface dissolution regime in orange presents a larger slope than the curve of the uniform dissolution with the same small peclet number in red this behavior is explained by the small permeability of this network and its significant heterogeneity there is significant flow resistance in the throats near the inlet region of the network thus the preferential dissolution of this region characteristic of the surface dissolution reduces this resistance and promotes the increase of the overall network permeability during the time simulated therefore this slightly odd behavior for the surface dissolution regimes does not occur for the more homogeneous networks previously discussed see figs 9 and 12 3 5 statistical parameters analysis here the statistical parameters obtained to identify the dissolution regimes are presented table 3 lists the statistical parameter c v and table 4 presents the statistical parameter δ c obtained for all the reactive transport and mineral dissolution simulations note that the results reflect the final acid concentration profiles and that the increase of porosity for all simulations reached at least 40 preferential pathways are identified by the largest values of c v and consequently the largest variance in the values of acid concentration within each cross section of the network based on the simulation results preferential pathways are identified by c v 1 surface dissolution cases are identified by the largest values of δ c this means that large acid consumption and large spread of the acid throughout the network are observed based on the simulation results the surface dissolution regime is identified by δ c 1 the uniform dissolution regime is characterized by the smallest values of c v and δ c this means that reactivity is small and acid spreads homogeneously throughout the entire network based on the simulation results the uniform dissolution regime is identified by both c v 1 and δ c 1 note that even for the more complex network topology the proposed parameters and criteria are able to identify the three main dissolution regimes this result is obtained despite the presence of significant heterogeneity with greater restrictions to flow and a large number of dead end pores that make interpretation difficult using simple quantitative criteria in addition appendix e presents quantitative results that demonstrate the adequacy of the proposed criteria for similar regular cubic networks generated with different random seeds finally it is suggested for future studies to obtain the values of these parameters in the region of intermediate p e and d a numbers in order to map their trends during regime transition 4 conclusions this study presents a novel pore network model to simulate single phase reactive transport and mineral dissolution in porous media a new methodology for the merging of pores and throats resulting from solid dissolution is introduced to guarantee the conservation of surface areas and throat conductances during the merging process pore surface areas and throat conductances are modeled accurately using a novel application of correction factors and effective properties a wide range of pore network models from a regular two dimensional network to highly heterogeneous three dimensional networks were used to study the reactive transport problem the main results include the exploration of different dissolution regimes through porosity permeability evolution curves acid concentration profiles and the use of statistical criteria to differentiate regimes importantly this methodology has the ability to simulate permeability increases larger than 100 fold during the formation of preferential pathways through the network the innovative approaches presented here may be used to improve the representation of many subsurface applications where reactive transport and mineral dissolution are the fundamental phenomena at the pore scale including performance of acidizing for stimulation geological storage of c o 2 and enhanced oil recovery as for future work a validation exercise is suggested to explore the accuracy of the model using core flow or micromodel experiments with extensive dissolution for verification this is an interesting research topic to verify the ability of the algorithm to represent mineral dissolution processes in porous media credit authorship contribution statement barbara f esteves conceptualization software writing original draft paulo l c lage conceptualization writing review editing paulo couto funding acquisition writing review editing anthony r kovscek conceptualization funding acquisition writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments bfe and ark acknowledge gratefully the support of the stanford center for carbon storage this study was financed in part by the coordenação de aperfeiçoamento de pessoal de nível superior brasil capes the conselho nacional de desenvolvimento científico e tecnológico cnpq and the project anp 20163 2 sponsored by shell brasil paulo l c lage acknowledges the financial support from cnpq grant no 305276 2019 0 appendix a algorithm for the volume evolution and geometry update the steps for the volume evolution and the geometry update of pores and throats are described below 1 computation of the change in volume of pores and throats due to a dissolution δ v i d and δ v i j d using eqs 11 and 12 b double dissolution δ v i d d and δ v i j d d using eqs 17 and 16 c the first correction step δ v i c 1 and δ v i j c 1 using eqs 21 and 20 d the second correction step δ v i c 2 and δ v i j c 2 using eqs 25 and 24 and e the transfer of porous spaces δ v i t and δ v i j t using eqs 30 and 29 2 computation of the total change in volume of pores by a 1 δ v i δ v i d δ v i d d δ v i c 1 δ v i c 2 δ v i t 3 computation of the total change in volume of throats by a 2 δ v i j δ v i j d δ v i j d d δ v i j c 1 δ v i j c 2 δ v i j t 4 update of the new volume of pores and throats respectively by a 3 v i n 1 v i n δ v i a 4 v i j n 1 v i j n δ v i j 5 computation of the change in mass of acid of pores and throats due to the transfer of porous spaces δ m i t and δ m i j t using eqs 32 and 31 6 computation of the total change in mass of acid inside of pores and throats by a 5 m i n 1 c i n 1 v i n δ m i t a 6 m i j n 1 c i j n 1 v i j n δ m i j t 7 update of the acid concentration based on the new volumes obtained by the geometry update as a 7 c i n 1 m i n 1 v i n 1 a 8 c i j n 1 m i j n 1 v i j n 1 8 calculation of the new pore radii considering pores as spheres by a 9 r i n 1 3 v i n 1 4 π 3 9 correction of the new length of throats by a 10 l i j n 1 d i j r i n 1 r j n 1 10 calculation of the new throat radii by a 11 r i j n 1 v i j n 1 π l i j n 1 2 11 update of the reactive surface area and cross sectional area of throats respectively using a 12 a r i j n 1 2 π r i j n 1 l i j n 1 a 13 a i j n 1 π r i j n 1 2 12 update the spherical cap areas at the inlet and outlet regions of pore i and determine the reactive surface area using respectively a 14 a i i j n 1 2 π r i n 1 r i n 1 r i n 1 2 r i j n 1 2 a 15 a r i n 1 4 π r i n 1 2 i j a i i j n 1 13 update of the effective surface area of pores and throats using eqs 6 and 7 14 update of the conductance of throats using eq 4 15 update of the effective conductance of throats using eq 3 the above procedure is repeated for each time step and because of this it is possible to evaluate the evolution of the permeability and porosity during the simulation of the reactive transport coupled with the dissolution process appendix b algorithm for the novel pore merging methodology the steps of the novel merging approach are described below 1 merging condition is satisfied 2 save geometric data of all original pores and throats involved in the merging process 3 call openpnm method for merging of pores and throats note that this method deletes the two original merging pores and all connected throats and after that creates a new merged pore and new connections between the new pore and the previous connected pores these new pore spaces do not have any geometric information or any data from the mass balance 4 update the position of the new merged pore using eq 33 5 update the radius of the new merged pore and all connected pores using eq 35 6 update the length of the new throats using eq 36 7 new connected throat radii are obtained by eq 38 the surface areas are obtained by eq 39 and the conductances are obtained by eq 40 8 correction factors for the effective surface area and conductance of the connected throats are updated respectively using eqs 41 and 42 if a new throat replaced two original throats use eqs 43 and 44 9 surface areas and correction factors for the effective surface area of the new merged pore and connected pores are updated using eqs a 15 and 45 10 effective surface area of pores and throats are updated using eqs 6 and 7 11 effective conductance of throats are updated using eq 3 remember that the correction factors are updated just after a change in the topology of the network and that the effective properties are used during the entire simulation for flow and mass balance equations thus for each time step after the geometry update of the pore spaces effective properties are determined using the actual correction factors appendix c mass balance errors the mass balance errors are estimated based on the relative difference between the accumulation term and the sum of the terms related to inlet outlet and consumption of mass of acid at the end of the simulation as described bellow c 16 m b e r r o r a c c u m u l a t i o n i n l e t o u t l e t c o n s u m p t i o n a c c u m u l a t i o n table c 1 presents the mass balance errors for the four simulation conditions explored using the three pore network models explored in this study the error is presented as a percentage appendix d power law exponents table d 1 presents the power law exponents and coefficients of determination r 2 obtained for the simulations in all networks considered in this work generally the surface dissolution regime condition 2 is identified by the smallest power law exponents this means that the increase of permeability is limited for a limited porosity variation note that in this regime most of the changes in volume occur around the inlet area where most of the acid is already consumed however the results for the carbonate network did not follow this trend as one case with uniform dissolution condition 4 showed a smaller power law coefficient the formation of preferential pathways condition 1 leads to sharp increases of the permeability for a limited porosity variation and consequently is identified by the largest values of the power law coefficients the simulation results in the 40x40 network present an exception to this conclusion and the uniform dissolution cases conditions 3 and 4 present the largest values of the exponents this can be explained by small values of the r 2 that shows that the power law form can not be the best expression to represent the behavior of the permeability versus permeability curves the uniform dissolution regime conditions 3 and 4 in general presents intermediate behavior of the curves compared to the preferential pathways regime and the surface dissolution regime appendix e quantitative criteria in similar networks tables e 1 and e 2 present the parameters c v and δ c respectively and their average values and standard deviation obtained by simulating reactive transport and mineral dissolution in different 10x10x10 regular cubic pore network models different initial seeds were used to generate the pore space sizes and all simulations reached at least 40 increase in porosity the main objective here is to show the viability of the proposed criteria to identify the main dissolution regimes in similarly constructed networks the bold values highlight the agreement with the proposed criteria where the preferential pathways regime is identified by c v 1 while c v 1 and δ c 1 characterize the surface dissolution regime the reported error at the 95 confidence level clearly shows that the regime classification using c v and δ c does not change within this error range 
264,recent droughts in europe have shown that national water systems are facing increasing challenges when dealing with drought impacts especially the netherlands has seen an increasing need to adapt their water management to improve preparedness for future drought events ideally the necessary information needed for operational water management decisions should be readily available ahead of time and or computed flexibly and efficiently to ensure sufficient time to evaluate the various management actions in this study we show that in addition to physically based hydrological models the upcoming and promising trend of incorporating machine learning ml in hydrology can provide the basis for future efforts in supporting national operational water management by providing the needed information efficiently and with the required accuracy as a precursor for their use in a forecasting system we assessed the ability of five different data driven methods to simulate hydrological variables at a national scale we developed a unified workflow where we use limited information on hydro meteorological variables and general water management policies to simulate historic timeseries of discharge groundwater levels surface water levels and surface water temperatures we find that all ml methods ranging from very simple to more complex ones showed a generally good performance for stations and target levels which are closely linked to the input data and location e g stations along main river network for downstream stations and small rivers the random forest method outperforms the other methods both for discharge and surface water levels for surface water temperature no location dependency was observed and for groundwater levels all methods were performing comparable with most stations ranging in nrmse 0 2 0 3 generally the best performances were reached by the more advanced random forest and lstm methods which was also seen when simulating high and low flow events high flow events were slightly better captured than low flow events but overall simulating extreme events based on a simple input data set remains challenging specific training sets including event related information and additional input variables could like improve future assessments including the feature importance of the methods allowed us to detect how and where water management influence played an important role the addition of information on water management in the ml routines increases overall performance although limited we conclude that ml and other data driven approaches have potential in predicting different hydrological variables we were able to capture and incorporate water management aspects in our analysis creating a base for future experiments where scenario analysis might reveal ml based mitigation strategies the combination of limited input data requirement and short computation times makes this new framework suitable for forecasting purposes keywords hydrology machine learning water management droughts 1 introduction droughts are prolonged periods with below normal water availability and can have a severe impact on nature and society wanders and wada 2015 van loon et al 2016 over the last two decades many european countries experienced severe droughts with notable examples in the years 2003 2005 2010 and 2015 stahl et al 2016 van lanen et al 2016 more recently the consecutive years 2018 and 2019 with record breaking droughts and heatwaves posed a big challenge for many western european countries bakke et al 2020 these consecutive drought years have had a severe impact on agriculture water management shipping ecosystems and other water dependent sectors consecutive years with severe and long lasting drought events do not only pose a challenge during the event but also lead to difficulties for nature to recover from these extreme situations which makes it important to not underestimate them de ruiter et al 2020 hari et al 2020 all these droughts were caused by a lack of precipitation in combination with an increased evaporative demand that propagated through the hydrological cycle resulting in deficits in soil moisture surface water and groundwater herrera estrada and diffenbaugh 2020 ionita et al 2017 both drought periods in 2018 and 2019 further showed how drought can propagate throughout the hydrological system not only in time but also spatially studies have shown that both the frequency and severity of drought events are expected to increase under climate change hari et al 2020 hattermann et al 2018 marx et al 2017 philip et al 2020 samaniego et al 2018 van der wiel et al 2019 this further indicates how important it is to advance monitoring and prediction of drought periods and their associated drought impacts sutanto et al 2019 despite recent efforts to improve the monitoring and forecasting of drought conditions e g wanders et al 2019 the recent drought events have shown that the challenges for water management planning and water distribution remain high witte et al 2020 in order to mitigate upcoming drought impacts and water shortages as much as possible water management decisions that rely on upstream water storage on groundwater or reservoirs need proper lead times to be effective especially for the larger rivers systems this would require forecasts of droughts and drought impacts with lead times up to several months or longer samaniego et al 2019 ideally the information necessary to make adequate decisions should be readily available when decisions need to be made to fulfill this goal the hydrological and water management models that support decision making should be computationally efficient reliable adaptive and able to ingest the latest observations available this would allow a scenario analysis to find the optimal near future management strategies to be part of day to day operational water management e g through dynamic programming bertsekas 2011 or model predictive control camacho and alba 2013 aydin et al 2019 this can be challenging as national scale hydrological models are often too time and computationally demanding to be used for large scale ensemble simulations to support scenario analysis with uncertainty estimations to overcome the obstacle of computational efforts in real time forecasting and scenario analysis data based modelling methods such collectively called machine learning ml methods e g alpaydin 2020 have proven to be a valid alternative in providing hydrological simulations as accurate as hydrological models at a fraction of the computational demand kratzert et al 2018 machine learning in hydrological analysis is interesting as it allows to handle large amounts of observational data to analyse and detect relationships between them and to predict or recreate the outcome based on the established relationships in an efficient manner thus machine learning might not only be helpful in finding answers to hydrological research questions but also provide additional advantages for operational water management studies have shown that various ml algorithms ranging from simple regression to more advance neural networks deep learning can be effectively used for rainfall runoff modelling kratzert et al 2018 or for assessing groundwater levels koch et al 2019 while using similar input data as common hydrological models other studies indicate the potential in capturing and forecasting different drought indicators such as the standardized precipitation index and standardized precipitation evaporation index amongst others sutanto et al 2019 even though a large number of studies have shown the usefulness of machine learning for predicting individual hydrological variables such as time series of catchment scale discharge kratzert et al 2018 or basin scale terrestrial water storage sun et al 2020 to our knowledge the suitability of different machine learning methods for predicting several interlinked hydrological variables on national scale based on a simple input dataset has not been tried furthermore in the context of using forecasting for operational water management the impacts of water management measures on hydrological states needs to be included which has only been done in a limited number of studies e g majumdar et al 2020 zhang et al 2018 being able to predict hydrological parameters with and without management strategies included creates new opportunities to not only analyse the hydrological situation in the present and near future but to also include scenario analysis which can be more efficient and flexible than large hydrological models used so far before ml methods are used in a forecasting system it is necessary to first test their ability to reproduce historical observations ideally these ml based predictions should rely on only a few input variables that can also be obtained as forecasts from current forecasting systems once the accuracy in reproducing historical observations is known it is then possible to attribute lack of forecasting skill in to model errors and forecasting errors of the input variables the aim of this study therefore is to evaluate the ability of ml methods in reproducing a large set of inter related time series of multiple hydrological variables for a human influenced national scale hydrological system to do this we use a small set of meteorological and hydrological input variables precipitation evaporation upstream discharge and sea level that are readily available from current forecasting systems we will test the accuracy of different ml algorithms for predicting multiple hydrological variables discharge groundwater levels as well as surface water levels and surface water temperatures at multiple locations that are usually computed by a large scale hydrological model additionally we will incorporate water management variables as input to our analysis to see whether ml can indeed be suitable for operational water management especially during periods of drought our goal is to contribute to the current knowledge in the field and set the basis for the potential use of this approach for operational long range forecasting and water management including the selection of optimal water management options in the following section 2 we will describe the study area and the data introduce the ml methods used as well as the experiment setup to test the predictive capabilities of these methods in section 3 the accuracy of the different ml based simulations will be evaluated for the different hydrological variables followed by more in depth assessments of the performance of specific algorithms both for average high and low flow periods the results will be followed by a discussion section 4 on the findings and placing them into context of other current research efforts in the field the paper will be closed by a conclusion section 5 and outlook on possible following studies 2 material and methods the following sections present information on the study on the general experiment setup and on the data sets and sources used as we provide and give an introduction of the selected ml algorithms and describe the final pipeline of our experiment 2 1 study area and experiment setup the netherlands located in western europe was used as a study area on the one hand the location of the netherlands directly at the sea its topographic characteristics e g 26 of the area lying below sea level and over 50 sensitive to flooding and the elaborate and complex water management system create an interesting case with unique hydrological challenges not only during wet but also dry periods on the other hand the last few summers have shown that water management which is historically known for reducing flood impacts has to adapt and further specialise on buffering and storing water prior to upcoming drought periods witte et al 2020 approaching this as a case study allows to develop and test out methods in a confined setting furthermore the netherlands has long observational records of various hydrological variables making it possible to assess large amounts of data constituting a good foundation for ml methods lastly the netherlands has an intricate and extensive water management system which makes it interesting to combine and assess the effect of human influence on the national water distribution during drought episodes to explore the potential of machine learning in this hydrological setting we have selected five frequently used data driven statistical and ml techniques hereafter generally referred as ml methods the set of machine learning algorithms that will be used ranges from simple linear methods as a benchmark to recurrent neural networks with the purpose to identify the optimal trade off between complexity and performance and includes the following multi linear regression lasso regression decision trees random forests and the recurrent neural networks algorithm long short term memory lstm multi linear and lasso regression are more classical statistical methods decision trees and random forest represent regression algorithms that use simple decision rules to make an optimal regression of the variable of interest and finally lstm as recurrent neural networks and time dependent deep learning to provide simulations of the target variable the general experimental setup used to test for the suitability of ml methods in predicting hydrological variables is as follows a simple set of input data or features is defined per type of analysis e g natural vs water management run type of ml algorithm and hydrological target variable the time series of input and target variables to be predicted are split up into training and validation data after training the ml algorithm the predictive performance of the ml method is evaluated using the validation data each method will be evaluated using frequently used performance metrics like the pearson correlation r the normalized root mean squared error nrmse and kling gupta efficiency gupta et al 2009 kge additionally information on the input sensitivity also known as feature importance will be gathered to investigate the influence of different input parameters and specifically the inclusion of water management plans in the ml simulations where possible more information on ml method and feature specific behaviour will be provided 2 2 data sources and preparation we focused on gathering national hydrological and meteorological data for the period 1980 2019 to ensure a sufficiently long record of historic observations for our assessment including several drought years the aim was to minimize data pre processing efforts to keep the methodology applicable for real time applications however a minimal quality control is performed as the quality of the input variables is essential for a successful ml application this generally includes removing outliers by using the 1 and 99 percentile and aggregating the data to either daily or weekly temporal resolution depending on the target variable we additionally include water management plans used during previous drought periods to investigate the suitability of ml methods in reproducing those decisions regarding water distribution and to create opportunities to develop scenario analysis for operational water management settings in the future we obtained water management guidelines through the national water management planning office rijkswaterstaat the following sections will give more insight on the target variables input variables and water management data considered 2 2 1 target variables the data availability for the netherlands is very good with an abundance of observations of sub surface hydrological variables we focused our analyses on hydrological variables or target variables that are of interest to water managers and informative for operational water management under drought conditions these include besides observations on discharge surface water levels main river network surface water temperature and groundwater levels for the first three variables the measurements depending on the location and the observation years have a daily to 10min temporal resolution for the analysis the data was prepared by removing outliers using the 1 and 99 percentile and aggregated to daily temporal resolution in the end only stations with more than 10 year of observation records were retained this resulted in the following number of stations per variable 69 for discharge 97 for surface water level 105 for surface water temperature groundwater observations were aggregated from daily to weekly temporal resolution when needed to ensure consistency between the records as groundwater levels usually show a slow response time this will have no major impact on the results and it has a better resemblance with the temporal resolution required for operational water management decisions the same approach of removing outliers was taken as for the other hydrological data sets and again only stations with an observation length of 10 years were taken into account to ensure sufficient data coverage this resulted in 3984 locations with groundwater level observations 2 2 2 input variables the input variables chosen include a selection of five meteorological and hydrological variables location of each input variable can be seen in fig 1 the selection of input variables was intentionally kept simple and easily replaceable as our aim is to test potential of the data driven approaches and their skills in retrieving and combining information even if only limited input parameters are used and to be able to easily replace input forcing with forecasts of these variable in later subsequent work regarding meteorological data daily time series of precipitation and potential evaporation were obtained from the national weather service knmi contrary to gathering and preparing all possible stations available as it was done with the hydrological observations it was decided to only take the main observational site in de bilt in the centre of the netherlands this was done consciously with the idea that the meteorological data will be part of the very simple set of input data used for the ml routine and with the goal to keep the input data simple a second advantage is that the use of only this location will also allow to run the routine in forecast modes in the future as weather forecast and projections are by default generated for de bilt weather station from the whole set of hydrological variables we selected the border stations of two major rivers to be part of the simple set of input data for the ml routine these inflow points into the national system were selected as they are important reference stations for the national water authority and common output from medium range and seasonal forecasting models the selection includes the discharge observations at lobith and eijsden which are representative for the discharge values for the rhine and meuse at the border covering the main rivers feeding the river system of the country additionally a station measuring the water levels of the north sea close to the haringvliet sluice was chosen as a reference of the tidal influence and the major free outflow outlet points of the dutch hydrological system near the delta of the river rhine and meuse 2 2 3 water management information on water management practices was gathered with the help of water managers at rijkswaterstaat we additionally included water management plans used during previous drought periods to investigate the suitability of ml methods in reproducing those decisions regarding water distribution and to create opportunities to develop scenario analysis for operational water management settings in the future most of the management decisions are based on the rhine discharge at lobith which affects the water distribution and operation of the locks along the river network towards the sea and the ijsselmeer lake also see fig 1 red locations the main infrastructures addressed in those management plans that we included in our analysis were the locks at driel and at haringvliet the lock at driel is used to steer the water distribution between the rivers nederrijn and waal which subsequently guides the water into different regions the haringvliet locks determine how much water is released to the north sea at the west coast as no observations exist of the operating policies we reconstructed the time series of the discharge at driel and haringvliet using the default operating rules based on the operational plan and the rhine discharge observation at lobith appendix a fig a 9 fig a1 and table a1 we further decided to include the locks den oever and kornwerderzand at the ijsselmeer lake which represent the amount of water released from the ijsselmeer lake to the wadden sea by including time series of their management as the ijsselmeer is currently used as one of the main water bodies to store water in case of droughts the reconstructed time series combined with the historical observations of the discharge at den oever and kornwerderzand were used as an additional set of input data for the ml routine for all the stations and target variables 2 3 ml algorithms for the experiment a selection of different ml algorithms was used covering simple linear to more complex techniques multi linear regression lasso regression decision trees random forests and the recurrent neural networks algorithm long short term memory lstm the analysis was done using python3 6 and most methods used were setup by either using the libraries scikit learn or keras to find the best parameter setup for most methods the hyperparameter tuning process gridsearchcv was used and run over all discharge stations with min 10 years observation record the best options that were counted most were used in the setup the following sections provide a brief summary of every method used and how they were set up 2 3 1 multilinear regression multilinear regression mreg is a very common type of linear regression used to predict a target variable based on using several explanatory input variables due to its simplicity it is used here as a benchmark method to compare more advanced methods to 2 3 2 lasso regression the lasso acronym lasso standing for least absolute shrinkage and selection operator regression lasso which was first introduced by tibshirani 1996 is a type of linear regression which includes an additional benefit compared to other linear regression types by eliminating variables which are less informative than others bardsley et al 2015 this is achieved by incorporating a regularization to the quadratic error term that penalizes large regression coefficients representing input variables that add little information a tuning parameter λ defines a threshold below which a regression weight will be optimised or forced towards zero meaning the variable will have little information bardsley et al 2015 the optimal value for λ was found to be λ 0 0001 2 3 3 decision tree and random forests decision trees dt are a type of regression model build up in a tree structure where the data is split multiple times into subsets until no further subsets can be made random forests rf originally proposed by breiman 2001 are an ensemble consisting of a number of decision tree predictors the concept of rf includes the setup of decision trees containing elements of randomness by bagging and selecting a fixed number of variables randomly while setting up the decision tree koch et al 2019 tyralis et al 2020 hyperparameter tuning using the gridsearchcv function was taken into account for both one dt and one rf including the following parameters and results the maximum depth dt 10 rf 100 which defines the maximum depth of the decision tree the maximum features dt auto rf sqrt which describes the number of features considered to find the best split the minimum sample leaf dt 100 rf 1 and sample split dt 100 rf 2 to set the minimum number of samples required for a leaf node and the minimum number to split an internal node as well as the number of trees in the forest rf 1000 2 3 4 long short term memory a more complex method considered in this study includes the long short term memory lstm network first introduced by hochreiter and schmidhuber 1997 lstm belongs to a special class of artificial neural networks called recurrent neural networks the advantage of this specific type is that compared to classical feedforward approaches seen in other neural networks it has the ability to invoke a sort of memory by using their internal state allowing to learn long term dependencies a detailed explanation of the lstm method is given in the work by kratzert et al 2018 the lstm architecture chosen for this study was build using the keras library and consisted of two lstm layers with dropout layers in between the end of the architecture further included a layer to flatten the outputs and a dense layer the number of neurons epochs and batch size were determined by running several combinations of different setups varying the number of neurons epochs and batch sizes for all the discharge stations the best setup of each station was selected and the most recurrent number of neurons epochs and batch size throughout all the discharge stations was chosen for the overall lstm setup the number of input neurons n h to be tested was chosen by following a rule of thumb n h n s α n i n o where n i number of input neurons n o number of output neurons n s number of samples in training data set α an arbitrary scaling factor usually 2 10 this resulted in testing 14 40 44 50 57 67 80 100 133 199 to estimate the possible number of suitable neurons number of epochs and batch size was tested over 1 10 50 100 based on the calculated rmse score for the training period the following setup appeared to be most suitable two lstm layers neurons 199 epochs 100 batch size 1 with two dropout layers dropout 0 4 in between one layer to flatten the outputs and a dense layer at the end 2 4 experimental setup pipeline the target data in our case for example discharge observations for each station individually was predicted based on the input data set natural run or water management included before the input data was incorporated in the standard training and testing routine we evaluated lagged correlations that could help explain the historic patterns using the partial autocorrelation function pacf we identified the lagged input with significant information content for each input time series the pacf was computed and the timeseries corresponding to the first three lags were considered as additional timeseries in the input data set table 1 taking into account this lagged input helps explain second order statistics that provide valuable information in timeseries analysis the input and target data were split into training and testing validation data 60 training 40 testing validation by using random segments of min one year length even though the traditional approach of splitting timeseries in two consecutive independent sets is used for this type problem the random segments approach was done to keep the timeseries aspect but preserve the chance of including drought periods of the recent years depending on the random selection of the segments otherwise these recent drought events would have fallen away if splitting the timeseries traditionally with the first 60 as training and last 40 as testing validation data furthermore the 60 40 splitting ensures that the individual ml models are not overtrained and can only use a certain amount of the whole dataset to establish the relationship between the different variables all target values except groundwater levels were trained on the daily dataset groundwater levels were computed by training on the difference y k y k 1 further also referred as deltachange of weekly groundwater observations which were added to the observation of the previous time step to compute back to the actual groundwater levels in prediction mode the 40 testing validation data set aside was then used to evaluate the predictions computed with the trained model using pearson correlation nrmse and kge gupta et al 2009 an overview of the pipeline can be seen in fig 2 while the following lines describe each step in more detail 1 input target data general input data set the natural run precipitation p evaporation evap discharge of rhine qrhine and meuse qmeuse at the borders as well as water level observation close to the coast and the haringvliet sluice wlharingvliet water management wm input data natural run reconstructed discharge time series of the main water infrastructures like lock driel and haringvliet and observations regarding two locks at the ijsselmeer lake 2 calculating pacf using timeseries corresponding to the first three lags as additional input time series 3 for each station the target variable was selected and we ensured that the time periods of both input and target align table 1 a normalization input and target data were normalized using the quantile transformer by scikit learn b splitting data into training and testing sets input and target data were defined into segments of min one year length and randomly selected into training and testing validation sets overall using 60 of the segments for training and 40 for testing validation c training and prediction per algorithm every algorithm is first trained with the same subset of training data per variable of interest the obtained trained models are then used to predict the variable of interest based on the testing validation data d back transforming the results are back transformed into the observations units of the original observation 4 validation scores to analyse the predicted results and the goodness of fit of the historical time series we computed the pearson correlation normalized root square mean error nrmse and kling gupta efficiency kge for the training testing validation and total period 5 post processing a summary statistics the results of all station simulations are used to get an overall understanding by including summary statistics like cdfs averages etc b feature importance the feature importance of all stations were considered to get a better understanding of the input data sensitivity also regarding water management influence the feature importance for random forest and decision tree was computed by using the feature importance property by scikit learn also known as gini importance and for lasso and multi linear regression the property model coefficient from scikit learn was used to get a crude type of feature importance c high and low flow periods to assess high and low flow periods for extreme events the highest lowest 30 of the observation records and the corresponding simulations results of each station were selected the nrmse was computed to assess the performance of each method 3 results in our analysis we explored the suitability of five different machine learning ml methods to simulate various hydrological observation by 1 developing a data preparation routine 2 training of different ml models 3 validating our simulations based on historical observations we extended our base natural scenario by additionally incorporating water management influence to assess the effect of additional data on human water interactions on the method s predictive skill further we evaluated the model performance for high and low flow events to see whether we can accurately capture drought events with our methods the following sections will highlight the main results for these three main aspects reproduction of historical observations water management influence and high and low flow events 3 1 simulation and reproduction of historical observations the routine developed for the different ml algorithms was used to predict and reproduce discharge surface water level surface water temperature and groundwater level observations the input data was defined into segments 60 of the segments were randomly chosen and used to train the different models while the remaining 40 of the data was used to test validate the simulation performance of the methods for validation purposes the normalized rmse nrmse score was computed which gives an indication on how close the predicted values are to the observed ones while the normalization makes it possible to compare stations with different mean discharge comparing the training and validation nrmse scores per method and target variable by plotting the results as a cumulative distribution function cdf highlights the differences in prediction skills fig 3 generally a slight decrease in predictive skill is expected for the validation set we observed that both training and validation scores for the daily simulations discharge surface water level and surface water temperature show a similar pattern especially for the simpler methods including multi linear regression mreg lasso regression lasso and decision tree dt with slight decrease in prediction skill for the validation set the most noticeable decrease in predictive skill was seen for both the random forest rf and lstm models which ultimately brings their validation score closer to the more simple models while the nrmse scores for the surface water temperature lay within a range of 0 0 2 and with a steep cdf the surface water level and discharge scores and cdfs indicate that prediction of these target variable is more challenging nrmse ranging from 0 to 0 45 looking at the cdfs of training and validation scores for discharge there is a small plateau effect recognizable followed by a similar slope as seen for the surface water level scores the plateau effect is likely due to the information included in the input data set combined with the proximity of some of the discharge stations to the two main discharge time series included in the input data set rhine and meuse the nrmse scores for groundwater levels show a slightly larger variation between the different methods as well as a plateau effect for almost all methods both for the training and validation set there is a distinct cut off in the nrmse around 0 1 to 0 25 which is related to stations that have no nrmse around or equal to the climatological mean in case the input data and the target variable have a very low correlation most algorithms will default to a prediction that is around the long term mean resulting in a nrmse between 0 0 0 5 computational time regarding training the different ml methods for all the target variables and all their stations was ranging between a few hours mreg lasso and dt a few days rf and lstm to a week groundwater levels by rf and lstm models while training the models can be time consuming depending on the method and the number of station considered the simulations of the target variables based on the trained models and the whole input data was done within a few hours up to one two days these calculation would be even shorter order of hours when used in forecasting mode with expected maximum lead times up to 3 6 months at maximum having a relatively short computation time can be of benefit especially regarding water management aspects as the information necessary timeseries scenarios etc to make decision can be delivered reasonably fast compared to large scale hydrological models which can require large computation times fig 4 provides a spatial picture of the different stations considered per target variable and the nrmse scores of the predictions from the rf model which is chosen as it was giving the best results overall the scores were computed based on the training and testing data together where the whole data for the specific station was used the darker the colour of the station the lower the nrmse score indicating a good performance of the rf model for discharge and surface water level it can be seen that upstream stations along the main river network rhine and meuse show low errors while the prediction skill decreases further downstream or in smaller side rivers this is likely due to the strong influence of the input features which is still visible on upstream locations especially for discharge stations downstream stations and smaller river areas are often heavily influenced by local water management infrastructures and management decisions making it more difficult to provide accurate simulations resulting in a higher nrmse score other factors like soil moisture land cover and catchment characteristics could potentially influence the model performance for these stations as the focus in this study was laid on testing out a simple input dataset assessing all possible influencing factors was out of scope this general trend and spatial pattern is also observed for the other ml models with minor differences appendix b 2 fig b1 figure b2 and b3 while counting the number of stations falling in the range of nrmse used in fig 4 for the different target variables table b 1 it can be seen that for discharge all methods have roughly the same amount of stations 16 17 in the lowest nrmse range 0 0 1 a large difference can be observed for the following ranges 0 1 0 2 and 0 2 0 3 where rf and lstm models include more stations that are having a better performance e g 12 stations mreg lasso and dt vs 41 20 stations for rf and lstm for surface water level prediction a similar distinction between the more simple and advanced methods can be made where the largest difference is seen again in the range of nrmse 0 1 0 2 compared to discharge the lowest range is reached by more stations of the rf 31 and lstm 21 a very clear pattern regarding performance skills was observed for surface water temperature all models for mreg lasso and dt fall in the nrmse range 0 1 0 2 while lstm shows almost equal numbers for 0 0 1 and 0 1 0 2 and rf having the most number of station in the lowest nrmse range in contrast to the clear distinction between the different methods and number of models per nrmse range seen before the results of the groundwater level models show a relatively comparable order of the 4000 station models around 400 450 fall into the range 0 0 1 150 200 in the range 0 1 0 2 and the majority 2300 3200 into range 0 2 0 3 for all methods except lasso where a large amount of stations can already be found in 0 1 0 2 but also 0 3 0 4 nrmse range table b 1 overall it can be observed that for the simulation of groundwater levels no particular method is doing better than the others this might be due to the input data not having a direct influence on the simulation as the rhine discharge for downstream stations as an example minor differences between the methods regarding average nrmse scores table b 2 were also seen for surface water temperature while rf and lstm show the lowest errors overall the location of the stations and the simulation does not influence the results this is likely due to the strong link to the evaporation data and with that connected to air temperature included in the input data set simulating full timeseries of the different target data and comparing them to the observed records further shows how close the ml methods like rf and lstm come in reproducing the historical observations appendix b 3 fig b4 please note that in these figures we combine training and validation data for the purposes of visual inspection we see that surface water temperature timeseries are well predicted by all methods and especially well by the rf model which is in agreement with the low nrmse scores for discharge and surface water level simulations we see that that the prediction skill deteriorates depending on the location of the station within the national river system as already observed in fig 4 discharge stations which are along the main river network and close to the geographical location of the border discharge input data show a higher prediction skill low nrmse scores but also kge ranging from 0 7 0 985 than stations that are located further downstream kge between 0 6 0 5 lowest kge value 0 4 the timeseries of upstream stations have a stronger correlation with the input timeseries not shown and ml models for these locations are therefore expected to show a good performance to get a better understanding of the way the input data was used by the different models we had a look at the feature importance or model coefficients as a crude type of feature importance score for mreg and lasso models for all methods except the lstm due to its complexity the strong influence of the different input variables was observed by plotting the feature importance per station as seen in fig 6 for discharge and surface water level both natural and water management run using the rf method each station is represented by a diagram showing the feature importance lags are summed up of the different input variables with a color code which got extended for the water management input data set we observed that the rhine and meuse discharge play an important role in the prediction of discharge and surface water levels which was expected for some stations as these rivers are the main two tributaries to the dutch hydrological system for discharge stations the rhine influence is mostly seen along the main river network leading to the sea while the meuse plays a strong role for stations in the south of the netherlands but surprisingly also in some stations in the north east an increase in importance of the information gained from the surface water level station close to haringvliet can be seen for the surface water level simulations of stations close the sea while the main influence of the rhine and meuse discharge in the main river network remains stations around the ijsselmeer and to the east show a more balanced incorporation of the input data for surface water temperature the main influence stems from evaporation information which is ultimately also connected to air temperature while the rf model includes the different input variables in a more balanced way the dt focuses on a few main variables with meuse discharge being more prominent than in the rf model the model coefficients used for mreg and lasso further show which input variables have an inverse relationship in these models e g additional lagged timeseries or certain input variables depending on station location fig b5 b7 and b9 3 2 the impact of water management to assess the impact of including water management as an explanatory input variable in our simulations we included reconstructed timeseries of water management infrastructure based on operational plans and the discharge at lobith these timeseries were added to the general input data set and used in the ml routine to predict the discharge surface water levels and surface water temperatures as we hypothesize that the impact on groundwater levels is negligible as the previous nrmse scores for the normal scenario were already good including water management as input variable generally leads to a small added benefit fig 5 the simple models included in our assessment display a similar behaviour as the rf model where the included water management information only improved the nrmse scores minimally average improvement for mreg 2 9 dt 3 3 rf 4 6 and for lasso even a slight decrease 0 5 compared to the natural run the slight decrease for the lasso method might be due to the random segments splitting approach for defining training and testing data which might have lead to segments being less informative than the one of the natural run the lstm model however notably benefits from the additional information on management with almost all stations showing an improved validation nrmse score average improvement by 9 8 this is likely due to the internal memory that lstm architecture includes enabling the additional information to be included over more calculations steps and improving simulations of stations further downstream which are more affected by water management decisions than the upstream ones for every method the two stations showing the largest improvements in the water management influenced run are the two stations at the ijsselmeer lake which were used as additional input information to represent the water management influence looking again at the feature importance of the different methods for the water management scenarios highlights to which extent the added water management information impacts the simulations even though the improvement in nrmse score was only minor for most methods for the run including water management information the influence of the added reconstructed operational timeseries can be seen in red lock at driel azure lock at haringvliet pink and violet two locks at the ijsselmeer the influence of all these additional input variables can be seen throughout all the discharge and surface water stations in fig 6 with a varying strength for both of these target variables the influence of the lock driel which is the main infrastructure to change the discharge distribution and located only a few km downstream lobith can be seen especially at stations which are close to the main river system observed influence upstream is caused by backwater effects during times when the lock driel is partly closed the reconstructed time series of lock haringvliet have a comparable importance across most of the stations as found for the lock at driel as both of those reconstructed timeseries depend on the discharge at lobith they are all linked together and show a similar importance the influence of the two locks at the ijsselmeer appears to be less strong in general with some exceptions close to those locks compared to the more balanced feature importances of the rf model the dt model fig b6 and b8 focuses again mostly on one major input series for each station while the simple methods only include the water management to a limited degree the predictions of surface water temperature barely take the additional water management information into account with evaporation remaining the most influential input feature as seen in the natural run 3 3 high and low flow simulations in order to test the ability of the ml methods to reproduce discharge and surface water levels during high and low flow periods we selected the highest and lowest 30 of observed records of every station and calculated the nrmse score from the observed and predicted timeseries for these timesteps in fig 7 we show the nrmse scores for the high and low scores plotted against the natural run scores for every method and target variables discharge and surface water levels for both target variables it can be observed that the prediction skill for low flow periods is lower compared to the total natural run scores in average the skill for low flow periods are 15 20 and 5 12 lower for discharge and surface water levels resp while discharge low flows appear to be more challenging to simulate using the currently trained models the surface water level low flows are closer to the total scores with lstm showing the smallest loss in prediction skill and lying closer to the 1 1 line the same observation can be made for high flows where the nrmse results for surface water level stations are generally closer to the total natural nrmse scores showing even a slightly higher skill of 3 6 compared to the latter the scores for discharge also indicate a relatively good performance for high flow periods with most stations having a similar to slightly better score but also a few stations which struggle to reproduce the high flow events table b 2 gives a further overview of the average prediction skill for every method and target variable fig 8 further shows the simulated timeseries of surface water levels for 2015 2019 highlighting the difference in prediction skill for low flow periods per method for one station lying half way on the main river network while the simple methods like mreg and lasso struggle in general to reproduce low flow periods for the time period shown the other methods especially struggle during the drought of 2018 when low flows occurred over several months while previous low flows are captured relatively well besides the model properties also the choice of using random segments for training can have an impact on the simulation performance as extreme low events e g the drought 2018 might not have been selected for the training phase 4 discussion in this study we investigated the suitability of five different machine learning ml methods in simulating various hydrological variables in a national scale managed hydrological system based on a simple input dataset in addition we assessed the impact of including water management information on the ml methods predictive skill by incorporating operational rules of major water infrastructures finally we looked at high and low flow periods separately to check the ml methods capability of capturing for example drought periods which provided the most challenging conditions for operational water management during the last few drought periods 4 1 machine learning models differences difficulties and advantages the selection of the models was done considering different levels of complexity the multi linear regression mreg method was chosen as a benchmark representing the simplest method in our methods set the lasso regression lasso was included due to its simple composition but with the benefit of variable selection the inclusion of the decision tree dt and random forest rf method were considered for their buildable complexity and lstm as a representation for a recurrent neural network which is promising for hydrological assessments e g kratzert et al 2018 2019b we saw that the more advance methods like rf and lstm used in this study in combination with a very simple input data set of 4 8 main features outperform more simple methods especially if target variables are directly connected to the input data for example discharge of rhine and meuse was observed as one of the main features having a strong influence on discharge and surface water level simulations primarily along the main river network the rf models were further outperforming the other methods for stations further downstream for both target variables compared to the other target variables the groundwater level simulations appeared to be more challenging for the different ml methods with most stations of all methods falling into nrmse range of 0 2 0 3 as the simple input dataset used did not have a dominating feature which some of the methods could have taken advantage off furthermore with the change in groundwater levels being relatively slow and small the input variables might have been less informative and relationships harder to extract compared to discharge observations which fluctuate more with all methods performing comparable and no clear method outperforming others computation time could be added to the factors influencing the choice of which ml methods to use in this case as there are roughly 4000 stations included the simple methods like mreg lasso and dt are preferable if a lower computation time is a requirement as these methods were able to simulate all stations within a few hours up to a day while ml methods appear to become a respectable choice in hydrological assessments and we saw that even with a small set of input features some methods can already perform well some aspects can limit or enhance their full potential first since ml methods as used here cannot rely on preconceived rules of system behaviour their dependency on sufficient data of good quality and time series length is key second ml predictions are difficult to interpret owing to their black to grey box nature depending on the ml method different aspects of the method can be analysed or visualized e g tree structure for dt or rf feature importance and model coefficients but for more complex methods as neural networks it can be difficult to fully identify which drivers and processes drive accurate prediction recent efforts to remedy this are based on reporting and analysing cell states kratzert et al 2018 which can help to unravel some of the black box characteristics furthermore finding the right hyperparameter setup for specific methods e g lstm can be challenging we tried to include a coherent approach between the different methods but the best architecture of the lstm neural network is often found by trial and error as there are no clear guidelines on finding the perfect setup a strong advantage of ml methods is their flexibility in learning new relationships handling large amounts of data efficiently and often being less computational demanding than large scale hydrological models in our case simulating the time series of a single variable takes a few seconds to minutes depending on the method and simulating all stations is done within a few hours note that these are serial computation times based on a standard desktop pc simulating many stations simultaneously could be efficiently parallelized on a high performance computer finding the best hyper parameterisation can be more time consuming especially if the gridsearchcv or a similar setup is run for many parameters and for example for more complex ml methods like rf and lstm however these analyses can also be speeded up by performing them in parallel regardless once the model is setup with the most promising parameters and trained the simulation run time is often shorter than for physical based hydrological models 4 2 impact of input timeseries feature importance our analysis shows that different ml methods based on a very few input features can perform well in simulating hydrological variables especially if the there is a direct connection to the target variable we could observe that there is a location dependency of prediction accuracy for discharge and surface water levels related to the proximity of the station to the input locations slight deterioration of the nrmse score could be observed if the station of interest was further away from the different input variable locations which is in line with the general expectation this is also recognizable by the feature importance analysis specifically looking at discharge and surface water level stations following the main river network input variable regarding rhine discharge showing the decreasing influence of the rhine discharge on the simulation results if the station is closer to the coast and thus further from lobith fig 4 other examples of distinct use of the input features were also seen in specific areas e g the use of the water level haringvliet input feature for stations close to the sea target variable surface water levels as well as the use of meuse discharge input feature for stations south east and the use of the rhine discharge for around main river network following from lobith areas especially in the northern part of the netherlands were incorporating the different features more equally or even showing a higher importance of a feature that was not necessarily expected e g meuse discharge for discharge stations overall the incorporation of the feature importance shed more light on the importance of various input variables in the simulations and how this relates to location in the hydrological system as such it provided a limited peak inside the black boxes that most ml methods are 4 3 impact of human water management as the nrmse of the different ml methods already showed a strong performance without it adding additional information on water management practices led to only a small improvement except for the lstm model where the improvement was considerable around 7 and 9 for surface water levels and discharge resp nevertheless the feature importance analysis revealed that including management information is being picked up as a valid predictor by some of the methods fig 6 the main water management infrastructures which are operated based on the rhine discharge appeared to have a large influence on upstream stations and stations close to the infrastructures when looking at the rf results while no impact was found for the more simple methods like mreg and lasso the total influence of the reconstructed time series driel and haringvliet and the rhine discharge are equal to the original influence of the rhine discharge in the normal run even though there is a clear dependency on the rhine discharge the influence of the different management infrastructures depends on the location of the stations although we did not compute the feature importance or a similar measure for the lstm model due to its complex setup we observed that the lstm model was the one method that profited most from the inclusion of water management information fig 5 as the additional water management input timeseries are based on operational rules that are linearly or quasi linearly related to discharge we hypothesize that methods like the rf are especially good in learning these management operations from discharge alone while probably having lower predictive skill if the management rules would be more complex we would expect the lstm model to be more suitable for these due to its characteristics and using the internal state as a sort of memory to substantiate this assumption and to assess the sensitivity to different types of management rules further experiments would be needed which is beyond the scope of this study nevertheless by including human water management the ml algorithms now provide a representation of the hydrological system that is closer to the reality of a managed system in addition this would allow us in future studies to explore the potential of water management changes with the clear limitation that the rules and impacts are assumed to be stationary in time 4 4 performance under droughts conditions in the last part of the analysis we focused on high and low flow periods in more detail we showed that more advanced methods like rf and lstm are generally better in capturing low flow events compared to the simple methods but struggle to recreate extreme events like summer 2018 simple methods like mreg and lasso are not able to capture any of the peaks both low and high due to the stronger non linear relationships that occur during these extreme conditions we observed that simulating high and low flow periods can be challenging especially if only limited data is given to the ml models including more information regarding catchment characteristics and soil moisture which are also important aspects for drought development could improve future simulation experiments similar to kratzert et al 2018 2019a 2019b furthermore the choice of using random segments to split the data into training and testing data further affects the prediction skill as extreme drought periods like 2018 might likely not be in the selected training data resulting in a less good performance for such events as the model has not seen this data before a possibility to improve the predictability of low flows could be to include additional training sets including long term droughts while at the same time using a wider set of input data that inform on the water storage in upstream areas e g snow cover data or total water storage from grace compared to the low flow periods the scores for the high flow periods are generally closer to the nrmse scores of the total simulations and in most cases slightly better e g for surface water level stations 4 5 opportunities for improvement the study s focus is on simulating hydrological variables for stations of the monitoring network of the national water management planning office rijkswaterstaat with the choice of the input data and only working with existing stations in accordance with future forecasting at these locations the assessment assumes stationarity and changes regarding land use or climate change are not directly included climate change could be included in future studies by changing the input data with projections from global climate models in combination with large scale hydrological models van der wiel et al 2019 such an approach could be tested by training the ml models on data from e g the early 1970s and evaluate the trained methods using observations from the last 10 years out of the different methods the lstm model is the only model which has a sort of memory effect which would be interesting to further assess the benefit of it in future studies touching on this aspect of changing climate by focusing on existing stations from the monitoring network the study does not touch upon the problem of prediction in ungauged basins which is an important issue in hydrological modelling for future studies it would be interesting to branch out and test out different setup including adding additional input data as well for example recent studies by kratzert et al 2018 2019a 2019b have shown the promising use of lstm models for regional rainfall runoff modelling in comparison to their work we did not include any location specific static information such as surface elevation soil type proximity to power plants along the river etc it is likely that including such additional information would improve our general predictive skill and would need to be tested in additional experiments furthermore adding additional information regarding soil moisture land use and vegetation might be useful especially for simulating drought period as the current setup appeared to only give limited information for this purpose a particularly interesting result from kratzert et al 2019b is that training a single lstm model on all timeseries using location specific static information as additional input variables performed better than the lstm models trained on each timeseries separately performing such an experiment on the groundwater timeseries used in this study would be an interesting follow on study furthermore regarding incorporating ml methods for groundwater level prediction koch et al 2019 recently showed their efforts to combine the rf method and a physically based model to simulate the shallow water table at a national scale for denmark it would be interesting to see if using e g the long term average groundwater depth from the national hydrological model de lange et al 2014 as location specific feature would improve groundwater level predictions in our case we also realized that the incorporation of water management information in predicting groundwater levels can be challenging as this depends on regional to even local water management by drinking water companies water boards and farmers with diverse and difficult to obtain specific management rules as groundwater is an important aspect of the hydrological system in the netherlands it would be an interesting addition to also include information on regional water management and local groundwater pumping in future experiments if the data availability allows it given that we have shown that the trained ml methods are successful in reproducing observed time series of various hydrological variables at many locations relevant for national scale water management a next step would be to use the trained ml models in a forecasting experiment and evaluate the forecasts for past periods of drought and water shortage in this context with water management as one of the input variables the ml methods with their short computation times can also be used for on the fly implementation of operational management scenarios e g operating scenarios and evaluating their ability to mitigate imminent hydrological droughts 5 conclusion in this study we explored the suitability of five different ml methods for simulating hydrological variables i e discharge surface water levels surface water temperature and groundwater levels that are deemed relevant for water management at a national scale based on a very limited set of input data that are also available from existing weather and large scale hydrological forecasting systems we additionally explored the possibility of incorporating water management practices and the ml methods capability in capturing high and low flow events this in light of future efforts to devise a computationally efficient seasonal forecasting framework that allows operational on the fly water management scenario analyses to mitigate imminent droughts we find that all ml methods ranging from very simple to more complex ones showed a generally good performance for stations and target levels which are closely linked to the input data and location e g stations along main river network for downstream stations and small rivers the random forest method outperforms the other methods both for discharge and surface water levels for surface water temperature no location dependency was observed generally the best performances were reached by the more advanced random forest and lstm methods which was especially the case when simulating high and low flow events high flow events were slightly better captured than low flow events but overall simulating extreme events based on a simple input data set remains challenging specific training sets including event related information and additional input variables could help to improve future assessments for simulating groundwater levels all methods were performing comparably with most stations ranging in nrmse 0 2 0 3 including the feature importance of the methods allowed us to detect how and where water management influence played an important role the addition of information on water management in the ml routines increases overall performance although limited we conclude that ml methods proved to be successful in simulating a large set of inter related time series of multiple hydrological variables for a human influenced national scale hydrological system there are of course limitations and drawbacks of such methods that should not be ignored having enough data of good quality is an important prerequisite for being able to develop an ml routine with high skill also the black box nature of ml methods makes it hard or even impossible to follow or understand the information flow implicit assumptions and the causes of prediction accuracy depending on the ml method it is possible to trace back some of the decision steps and we tried to get an insight on how the input data is used by inspecting the feature importance nevertheless ml methods in general and the routine developed in this study show a large potential for various types of hydrological assessments not only simulating current or historic observations but potentially also for forecasting experiments and scenario analysis in heavily managed river systems around the world the ml routine developed in this study shows a high level of agreement with the observations and can thus act as an additional decision support tool to be implemented in operational water management 6 data availability hydrological data on discharge surface water levels and surface water temperatures were obtained from the webservices and data portal from rijkswaterstaat https waterinfo rws nl nav index the groundwater level observations were taken from the dinoloket https www dinoloket nl ondergrondgegevens daily meteorological data was obtained via knmi https www knmi nl nederland nu klimatologie daggegevens credit authorship contribution statement sandra m hauswirth data curation formal analysis writing review editing marc f p bierkens conceptualization formal analysis writing review editing vincent beijk conceptualization formal analysis writing review editing niko wanders conceptualization formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements sh acknowledges funding from the cooperate innovation program and the department of water transport and environment at the dutch national water authority rijkswaterstaat nw acknowledges funding from nwo 016 veni 181 049 furthermore the authors would like to thank the reviewers for their input and suggestions appendix a material and methods water management appendix b results prediction and reproduction of historical observations b1 nrmse scores b2 nrmse scores maps b3 time series natural run b4 feature importance the feature importance of the stations are ordered according to their distance from lobith station which acts as an input timeseries which enables us to observe the different incorporation of the input data following the river downstream furthermore the main input series e g precipitation evaporation rhine discharge etc are colour coded including the additional lagged timeseries in a lighter colour 
264,recent droughts in europe have shown that national water systems are facing increasing challenges when dealing with drought impacts especially the netherlands has seen an increasing need to adapt their water management to improve preparedness for future drought events ideally the necessary information needed for operational water management decisions should be readily available ahead of time and or computed flexibly and efficiently to ensure sufficient time to evaluate the various management actions in this study we show that in addition to physically based hydrological models the upcoming and promising trend of incorporating machine learning ml in hydrology can provide the basis for future efforts in supporting national operational water management by providing the needed information efficiently and with the required accuracy as a precursor for their use in a forecasting system we assessed the ability of five different data driven methods to simulate hydrological variables at a national scale we developed a unified workflow where we use limited information on hydro meteorological variables and general water management policies to simulate historic timeseries of discharge groundwater levels surface water levels and surface water temperatures we find that all ml methods ranging from very simple to more complex ones showed a generally good performance for stations and target levels which are closely linked to the input data and location e g stations along main river network for downstream stations and small rivers the random forest method outperforms the other methods both for discharge and surface water levels for surface water temperature no location dependency was observed and for groundwater levels all methods were performing comparable with most stations ranging in nrmse 0 2 0 3 generally the best performances were reached by the more advanced random forest and lstm methods which was also seen when simulating high and low flow events high flow events were slightly better captured than low flow events but overall simulating extreme events based on a simple input data set remains challenging specific training sets including event related information and additional input variables could like improve future assessments including the feature importance of the methods allowed us to detect how and where water management influence played an important role the addition of information on water management in the ml routines increases overall performance although limited we conclude that ml and other data driven approaches have potential in predicting different hydrological variables we were able to capture and incorporate water management aspects in our analysis creating a base for future experiments where scenario analysis might reveal ml based mitigation strategies the combination of limited input data requirement and short computation times makes this new framework suitable for forecasting purposes keywords hydrology machine learning water management droughts 1 introduction droughts are prolonged periods with below normal water availability and can have a severe impact on nature and society wanders and wada 2015 van loon et al 2016 over the last two decades many european countries experienced severe droughts with notable examples in the years 2003 2005 2010 and 2015 stahl et al 2016 van lanen et al 2016 more recently the consecutive years 2018 and 2019 with record breaking droughts and heatwaves posed a big challenge for many western european countries bakke et al 2020 these consecutive drought years have had a severe impact on agriculture water management shipping ecosystems and other water dependent sectors consecutive years with severe and long lasting drought events do not only pose a challenge during the event but also lead to difficulties for nature to recover from these extreme situations which makes it important to not underestimate them de ruiter et al 2020 hari et al 2020 all these droughts were caused by a lack of precipitation in combination with an increased evaporative demand that propagated through the hydrological cycle resulting in deficits in soil moisture surface water and groundwater herrera estrada and diffenbaugh 2020 ionita et al 2017 both drought periods in 2018 and 2019 further showed how drought can propagate throughout the hydrological system not only in time but also spatially studies have shown that both the frequency and severity of drought events are expected to increase under climate change hari et al 2020 hattermann et al 2018 marx et al 2017 philip et al 2020 samaniego et al 2018 van der wiel et al 2019 this further indicates how important it is to advance monitoring and prediction of drought periods and their associated drought impacts sutanto et al 2019 despite recent efforts to improve the monitoring and forecasting of drought conditions e g wanders et al 2019 the recent drought events have shown that the challenges for water management planning and water distribution remain high witte et al 2020 in order to mitigate upcoming drought impacts and water shortages as much as possible water management decisions that rely on upstream water storage on groundwater or reservoirs need proper lead times to be effective especially for the larger rivers systems this would require forecasts of droughts and drought impacts with lead times up to several months or longer samaniego et al 2019 ideally the information necessary to make adequate decisions should be readily available when decisions need to be made to fulfill this goal the hydrological and water management models that support decision making should be computationally efficient reliable adaptive and able to ingest the latest observations available this would allow a scenario analysis to find the optimal near future management strategies to be part of day to day operational water management e g through dynamic programming bertsekas 2011 or model predictive control camacho and alba 2013 aydin et al 2019 this can be challenging as national scale hydrological models are often too time and computationally demanding to be used for large scale ensemble simulations to support scenario analysis with uncertainty estimations to overcome the obstacle of computational efforts in real time forecasting and scenario analysis data based modelling methods such collectively called machine learning ml methods e g alpaydin 2020 have proven to be a valid alternative in providing hydrological simulations as accurate as hydrological models at a fraction of the computational demand kratzert et al 2018 machine learning in hydrological analysis is interesting as it allows to handle large amounts of observational data to analyse and detect relationships between them and to predict or recreate the outcome based on the established relationships in an efficient manner thus machine learning might not only be helpful in finding answers to hydrological research questions but also provide additional advantages for operational water management studies have shown that various ml algorithms ranging from simple regression to more advance neural networks deep learning can be effectively used for rainfall runoff modelling kratzert et al 2018 or for assessing groundwater levels koch et al 2019 while using similar input data as common hydrological models other studies indicate the potential in capturing and forecasting different drought indicators such as the standardized precipitation index and standardized precipitation evaporation index amongst others sutanto et al 2019 even though a large number of studies have shown the usefulness of machine learning for predicting individual hydrological variables such as time series of catchment scale discharge kratzert et al 2018 or basin scale terrestrial water storage sun et al 2020 to our knowledge the suitability of different machine learning methods for predicting several interlinked hydrological variables on national scale based on a simple input dataset has not been tried furthermore in the context of using forecasting for operational water management the impacts of water management measures on hydrological states needs to be included which has only been done in a limited number of studies e g majumdar et al 2020 zhang et al 2018 being able to predict hydrological parameters with and without management strategies included creates new opportunities to not only analyse the hydrological situation in the present and near future but to also include scenario analysis which can be more efficient and flexible than large hydrological models used so far before ml methods are used in a forecasting system it is necessary to first test their ability to reproduce historical observations ideally these ml based predictions should rely on only a few input variables that can also be obtained as forecasts from current forecasting systems once the accuracy in reproducing historical observations is known it is then possible to attribute lack of forecasting skill in to model errors and forecasting errors of the input variables the aim of this study therefore is to evaluate the ability of ml methods in reproducing a large set of inter related time series of multiple hydrological variables for a human influenced national scale hydrological system to do this we use a small set of meteorological and hydrological input variables precipitation evaporation upstream discharge and sea level that are readily available from current forecasting systems we will test the accuracy of different ml algorithms for predicting multiple hydrological variables discharge groundwater levels as well as surface water levels and surface water temperatures at multiple locations that are usually computed by a large scale hydrological model additionally we will incorporate water management variables as input to our analysis to see whether ml can indeed be suitable for operational water management especially during periods of drought our goal is to contribute to the current knowledge in the field and set the basis for the potential use of this approach for operational long range forecasting and water management including the selection of optimal water management options in the following section 2 we will describe the study area and the data introduce the ml methods used as well as the experiment setup to test the predictive capabilities of these methods in section 3 the accuracy of the different ml based simulations will be evaluated for the different hydrological variables followed by more in depth assessments of the performance of specific algorithms both for average high and low flow periods the results will be followed by a discussion section 4 on the findings and placing them into context of other current research efforts in the field the paper will be closed by a conclusion section 5 and outlook on possible following studies 2 material and methods the following sections present information on the study on the general experiment setup and on the data sets and sources used as we provide and give an introduction of the selected ml algorithms and describe the final pipeline of our experiment 2 1 study area and experiment setup the netherlands located in western europe was used as a study area on the one hand the location of the netherlands directly at the sea its topographic characteristics e g 26 of the area lying below sea level and over 50 sensitive to flooding and the elaborate and complex water management system create an interesting case with unique hydrological challenges not only during wet but also dry periods on the other hand the last few summers have shown that water management which is historically known for reducing flood impacts has to adapt and further specialise on buffering and storing water prior to upcoming drought periods witte et al 2020 approaching this as a case study allows to develop and test out methods in a confined setting furthermore the netherlands has long observational records of various hydrological variables making it possible to assess large amounts of data constituting a good foundation for ml methods lastly the netherlands has an intricate and extensive water management system which makes it interesting to combine and assess the effect of human influence on the national water distribution during drought episodes to explore the potential of machine learning in this hydrological setting we have selected five frequently used data driven statistical and ml techniques hereafter generally referred as ml methods the set of machine learning algorithms that will be used ranges from simple linear methods as a benchmark to recurrent neural networks with the purpose to identify the optimal trade off between complexity and performance and includes the following multi linear regression lasso regression decision trees random forests and the recurrent neural networks algorithm long short term memory lstm multi linear and lasso regression are more classical statistical methods decision trees and random forest represent regression algorithms that use simple decision rules to make an optimal regression of the variable of interest and finally lstm as recurrent neural networks and time dependent deep learning to provide simulations of the target variable the general experimental setup used to test for the suitability of ml methods in predicting hydrological variables is as follows a simple set of input data or features is defined per type of analysis e g natural vs water management run type of ml algorithm and hydrological target variable the time series of input and target variables to be predicted are split up into training and validation data after training the ml algorithm the predictive performance of the ml method is evaluated using the validation data each method will be evaluated using frequently used performance metrics like the pearson correlation r the normalized root mean squared error nrmse and kling gupta efficiency gupta et al 2009 kge additionally information on the input sensitivity also known as feature importance will be gathered to investigate the influence of different input parameters and specifically the inclusion of water management plans in the ml simulations where possible more information on ml method and feature specific behaviour will be provided 2 2 data sources and preparation we focused on gathering national hydrological and meteorological data for the period 1980 2019 to ensure a sufficiently long record of historic observations for our assessment including several drought years the aim was to minimize data pre processing efforts to keep the methodology applicable for real time applications however a minimal quality control is performed as the quality of the input variables is essential for a successful ml application this generally includes removing outliers by using the 1 and 99 percentile and aggregating the data to either daily or weekly temporal resolution depending on the target variable we additionally include water management plans used during previous drought periods to investigate the suitability of ml methods in reproducing those decisions regarding water distribution and to create opportunities to develop scenario analysis for operational water management settings in the future we obtained water management guidelines through the national water management planning office rijkswaterstaat the following sections will give more insight on the target variables input variables and water management data considered 2 2 1 target variables the data availability for the netherlands is very good with an abundance of observations of sub surface hydrological variables we focused our analyses on hydrological variables or target variables that are of interest to water managers and informative for operational water management under drought conditions these include besides observations on discharge surface water levels main river network surface water temperature and groundwater levels for the first three variables the measurements depending on the location and the observation years have a daily to 10min temporal resolution for the analysis the data was prepared by removing outliers using the 1 and 99 percentile and aggregated to daily temporal resolution in the end only stations with more than 10 year of observation records were retained this resulted in the following number of stations per variable 69 for discharge 97 for surface water level 105 for surface water temperature groundwater observations were aggregated from daily to weekly temporal resolution when needed to ensure consistency between the records as groundwater levels usually show a slow response time this will have no major impact on the results and it has a better resemblance with the temporal resolution required for operational water management decisions the same approach of removing outliers was taken as for the other hydrological data sets and again only stations with an observation length of 10 years were taken into account to ensure sufficient data coverage this resulted in 3984 locations with groundwater level observations 2 2 2 input variables the input variables chosen include a selection of five meteorological and hydrological variables location of each input variable can be seen in fig 1 the selection of input variables was intentionally kept simple and easily replaceable as our aim is to test potential of the data driven approaches and their skills in retrieving and combining information even if only limited input parameters are used and to be able to easily replace input forcing with forecasts of these variable in later subsequent work regarding meteorological data daily time series of precipitation and potential evaporation were obtained from the national weather service knmi contrary to gathering and preparing all possible stations available as it was done with the hydrological observations it was decided to only take the main observational site in de bilt in the centre of the netherlands this was done consciously with the idea that the meteorological data will be part of the very simple set of input data used for the ml routine and with the goal to keep the input data simple a second advantage is that the use of only this location will also allow to run the routine in forecast modes in the future as weather forecast and projections are by default generated for de bilt weather station from the whole set of hydrological variables we selected the border stations of two major rivers to be part of the simple set of input data for the ml routine these inflow points into the national system were selected as they are important reference stations for the national water authority and common output from medium range and seasonal forecasting models the selection includes the discharge observations at lobith and eijsden which are representative for the discharge values for the rhine and meuse at the border covering the main rivers feeding the river system of the country additionally a station measuring the water levels of the north sea close to the haringvliet sluice was chosen as a reference of the tidal influence and the major free outflow outlet points of the dutch hydrological system near the delta of the river rhine and meuse 2 2 3 water management information on water management practices was gathered with the help of water managers at rijkswaterstaat we additionally included water management plans used during previous drought periods to investigate the suitability of ml methods in reproducing those decisions regarding water distribution and to create opportunities to develop scenario analysis for operational water management settings in the future most of the management decisions are based on the rhine discharge at lobith which affects the water distribution and operation of the locks along the river network towards the sea and the ijsselmeer lake also see fig 1 red locations the main infrastructures addressed in those management plans that we included in our analysis were the locks at driel and at haringvliet the lock at driel is used to steer the water distribution between the rivers nederrijn and waal which subsequently guides the water into different regions the haringvliet locks determine how much water is released to the north sea at the west coast as no observations exist of the operating policies we reconstructed the time series of the discharge at driel and haringvliet using the default operating rules based on the operational plan and the rhine discharge observation at lobith appendix a fig a 9 fig a1 and table a1 we further decided to include the locks den oever and kornwerderzand at the ijsselmeer lake which represent the amount of water released from the ijsselmeer lake to the wadden sea by including time series of their management as the ijsselmeer is currently used as one of the main water bodies to store water in case of droughts the reconstructed time series combined with the historical observations of the discharge at den oever and kornwerderzand were used as an additional set of input data for the ml routine for all the stations and target variables 2 3 ml algorithms for the experiment a selection of different ml algorithms was used covering simple linear to more complex techniques multi linear regression lasso regression decision trees random forests and the recurrent neural networks algorithm long short term memory lstm the analysis was done using python3 6 and most methods used were setup by either using the libraries scikit learn or keras to find the best parameter setup for most methods the hyperparameter tuning process gridsearchcv was used and run over all discharge stations with min 10 years observation record the best options that were counted most were used in the setup the following sections provide a brief summary of every method used and how they were set up 2 3 1 multilinear regression multilinear regression mreg is a very common type of linear regression used to predict a target variable based on using several explanatory input variables due to its simplicity it is used here as a benchmark method to compare more advanced methods to 2 3 2 lasso regression the lasso acronym lasso standing for least absolute shrinkage and selection operator regression lasso which was first introduced by tibshirani 1996 is a type of linear regression which includes an additional benefit compared to other linear regression types by eliminating variables which are less informative than others bardsley et al 2015 this is achieved by incorporating a regularization to the quadratic error term that penalizes large regression coefficients representing input variables that add little information a tuning parameter λ defines a threshold below which a regression weight will be optimised or forced towards zero meaning the variable will have little information bardsley et al 2015 the optimal value for λ was found to be λ 0 0001 2 3 3 decision tree and random forests decision trees dt are a type of regression model build up in a tree structure where the data is split multiple times into subsets until no further subsets can be made random forests rf originally proposed by breiman 2001 are an ensemble consisting of a number of decision tree predictors the concept of rf includes the setup of decision trees containing elements of randomness by bagging and selecting a fixed number of variables randomly while setting up the decision tree koch et al 2019 tyralis et al 2020 hyperparameter tuning using the gridsearchcv function was taken into account for both one dt and one rf including the following parameters and results the maximum depth dt 10 rf 100 which defines the maximum depth of the decision tree the maximum features dt auto rf sqrt which describes the number of features considered to find the best split the minimum sample leaf dt 100 rf 1 and sample split dt 100 rf 2 to set the minimum number of samples required for a leaf node and the minimum number to split an internal node as well as the number of trees in the forest rf 1000 2 3 4 long short term memory a more complex method considered in this study includes the long short term memory lstm network first introduced by hochreiter and schmidhuber 1997 lstm belongs to a special class of artificial neural networks called recurrent neural networks the advantage of this specific type is that compared to classical feedforward approaches seen in other neural networks it has the ability to invoke a sort of memory by using their internal state allowing to learn long term dependencies a detailed explanation of the lstm method is given in the work by kratzert et al 2018 the lstm architecture chosen for this study was build using the keras library and consisted of two lstm layers with dropout layers in between the end of the architecture further included a layer to flatten the outputs and a dense layer the number of neurons epochs and batch size were determined by running several combinations of different setups varying the number of neurons epochs and batch sizes for all the discharge stations the best setup of each station was selected and the most recurrent number of neurons epochs and batch size throughout all the discharge stations was chosen for the overall lstm setup the number of input neurons n h to be tested was chosen by following a rule of thumb n h n s α n i n o where n i number of input neurons n o number of output neurons n s number of samples in training data set α an arbitrary scaling factor usually 2 10 this resulted in testing 14 40 44 50 57 67 80 100 133 199 to estimate the possible number of suitable neurons number of epochs and batch size was tested over 1 10 50 100 based on the calculated rmse score for the training period the following setup appeared to be most suitable two lstm layers neurons 199 epochs 100 batch size 1 with two dropout layers dropout 0 4 in between one layer to flatten the outputs and a dense layer at the end 2 4 experimental setup pipeline the target data in our case for example discharge observations for each station individually was predicted based on the input data set natural run or water management included before the input data was incorporated in the standard training and testing routine we evaluated lagged correlations that could help explain the historic patterns using the partial autocorrelation function pacf we identified the lagged input with significant information content for each input time series the pacf was computed and the timeseries corresponding to the first three lags were considered as additional timeseries in the input data set table 1 taking into account this lagged input helps explain second order statistics that provide valuable information in timeseries analysis the input and target data were split into training and testing validation data 60 training 40 testing validation by using random segments of min one year length even though the traditional approach of splitting timeseries in two consecutive independent sets is used for this type problem the random segments approach was done to keep the timeseries aspect but preserve the chance of including drought periods of the recent years depending on the random selection of the segments otherwise these recent drought events would have fallen away if splitting the timeseries traditionally with the first 60 as training and last 40 as testing validation data furthermore the 60 40 splitting ensures that the individual ml models are not overtrained and can only use a certain amount of the whole dataset to establish the relationship between the different variables all target values except groundwater levels were trained on the daily dataset groundwater levels were computed by training on the difference y k y k 1 further also referred as deltachange of weekly groundwater observations which were added to the observation of the previous time step to compute back to the actual groundwater levels in prediction mode the 40 testing validation data set aside was then used to evaluate the predictions computed with the trained model using pearson correlation nrmse and kge gupta et al 2009 an overview of the pipeline can be seen in fig 2 while the following lines describe each step in more detail 1 input target data general input data set the natural run precipitation p evaporation evap discharge of rhine qrhine and meuse qmeuse at the borders as well as water level observation close to the coast and the haringvliet sluice wlharingvliet water management wm input data natural run reconstructed discharge time series of the main water infrastructures like lock driel and haringvliet and observations regarding two locks at the ijsselmeer lake 2 calculating pacf using timeseries corresponding to the first three lags as additional input time series 3 for each station the target variable was selected and we ensured that the time periods of both input and target align table 1 a normalization input and target data were normalized using the quantile transformer by scikit learn b splitting data into training and testing sets input and target data were defined into segments of min one year length and randomly selected into training and testing validation sets overall using 60 of the segments for training and 40 for testing validation c training and prediction per algorithm every algorithm is first trained with the same subset of training data per variable of interest the obtained trained models are then used to predict the variable of interest based on the testing validation data d back transforming the results are back transformed into the observations units of the original observation 4 validation scores to analyse the predicted results and the goodness of fit of the historical time series we computed the pearson correlation normalized root square mean error nrmse and kling gupta efficiency kge for the training testing validation and total period 5 post processing a summary statistics the results of all station simulations are used to get an overall understanding by including summary statistics like cdfs averages etc b feature importance the feature importance of all stations were considered to get a better understanding of the input data sensitivity also regarding water management influence the feature importance for random forest and decision tree was computed by using the feature importance property by scikit learn also known as gini importance and for lasso and multi linear regression the property model coefficient from scikit learn was used to get a crude type of feature importance c high and low flow periods to assess high and low flow periods for extreme events the highest lowest 30 of the observation records and the corresponding simulations results of each station were selected the nrmse was computed to assess the performance of each method 3 results in our analysis we explored the suitability of five different machine learning ml methods to simulate various hydrological observation by 1 developing a data preparation routine 2 training of different ml models 3 validating our simulations based on historical observations we extended our base natural scenario by additionally incorporating water management influence to assess the effect of additional data on human water interactions on the method s predictive skill further we evaluated the model performance for high and low flow events to see whether we can accurately capture drought events with our methods the following sections will highlight the main results for these three main aspects reproduction of historical observations water management influence and high and low flow events 3 1 simulation and reproduction of historical observations the routine developed for the different ml algorithms was used to predict and reproduce discharge surface water level surface water temperature and groundwater level observations the input data was defined into segments 60 of the segments were randomly chosen and used to train the different models while the remaining 40 of the data was used to test validate the simulation performance of the methods for validation purposes the normalized rmse nrmse score was computed which gives an indication on how close the predicted values are to the observed ones while the normalization makes it possible to compare stations with different mean discharge comparing the training and validation nrmse scores per method and target variable by plotting the results as a cumulative distribution function cdf highlights the differences in prediction skills fig 3 generally a slight decrease in predictive skill is expected for the validation set we observed that both training and validation scores for the daily simulations discharge surface water level and surface water temperature show a similar pattern especially for the simpler methods including multi linear regression mreg lasso regression lasso and decision tree dt with slight decrease in prediction skill for the validation set the most noticeable decrease in predictive skill was seen for both the random forest rf and lstm models which ultimately brings their validation score closer to the more simple models while the nrmse scores for the surface water temperature lay within a range of 0 0 2 and with a steep cdf the surface water level and discharge scores and cdfs indicate that prediction of these target variable is more challenging nrmse ranging from 0 to 0 45 looking at the cdfs of training and validation scores for discharge there is a small plateau effect recognizable followed by a similar slope as seen for the surface water level scores the plateau effect is likely due to the information included in the input data set combined with the proximity of some of the discharge stations to the two main discharge time series included in the input data set rhine and meuse the nrmse scores for groundwater levels show a slightly larger variation between the different methods as well as a plateau effect for almost all methods both for the training and validation set there is a distinct cut off in the nrmse around 0 1 to 0 25 which is related to stations that have no nrmse around or equal to the climatological mean in case the input data and the target variable have a very low correlation most algorithms will default to a prediction that is around the long term mean resulting in a nrmse between 0 0 0 5 computational time regarding training the different ml methods for all the target variables and all their stations was ranging between a few hours mreg lasso and dt a few days rf and lstm to a week groundwater levels by rf and lstm models while training the models can be time consuming depending on the method and the number of station considered the simulations of the target variables based on the trained models and the whole input data was done within a few hours up to one two days these calculation would be even shorter order of hours when used in forecasting mode with expected maximum lead times up to 3 6 months at maximum having a relatively short computation time can be of benefit especially regarding water management aspects as the information necessary timeseries scenarios etc to make decision can be delivered reasonably fast compared to large scale hydrological models which can require large computation times fig 4 provides a spatial picture of the different stations considered per target variable and the nrmse scores of the predictions from the rf model which is chosen as it was giving the best results overall the scores were computed based on the training and testing data together where the whole data for the specific station was used the darker the colour of the station the lower the nrmse score indicating a good performance of the rf model for discharge and surface water level it can be seen that upstream stations along the main river network rhine and meuse show low errors while the prediction skill decreases further downstream or in smaller side rivers this is likely due to the strong influence of the input features which is still visible on upstream locations especially for discharge stations downstream stations and smaller river areas are often heavily influenced by local water management infrastructures and management decisions making it more difficult to provide accurate simulations resulting in a higher nrmse score other factors like soil moisture land cover and catchment characteristics could potentially influence the model performance for these stations as the focus in this study was laid on testing out a simple input dataset assessing all possible influencing factors was out of scope this general trend and spatial pattern is also observed for the other ml models with minor differences appendix b 2 fig b1 figure b2 and b3 while counting the number of stations falling in the range of nrmse used in fig 4 for the different target variables table b 1 it can be seen that for discharge all methods have roughly the same amount of stations 16 17 in the lowest nrmse range 0 0 1 a large difference can be observed for the following ranges 0 1 0 2 and 0 2 0 3 where rf and lstm models include more stations that are having a better performance e g 12 stations mreg lasso and dt vs 41 20 stations for rf and lstm for surface water level prediction a similar distinction between the more simple and advanced methods can be made where the largest difference is seen again in the range of nrmse 0 1 0 2 compared to discharge the lowest range is reached by more stations of the rf 31 and lstm 21 a very clear pattern regarding performance skills was observed for surface water temperature all models for mreg lasso and dt fall in the nrmse range 0 1 0 2 while lstm shows almost equal numbers for 0 0 1 and 0 1 0 2 and rf having the most number of station in the lowest nrmse range in contrast to the clear distinction between the different methods and number of models per nrmse range seen before the results of the groundwater level models show a relatively comparable order of the 4000 station models around 400 450 fall into the range 0 0 1 150 200 in the range 0 1 0 2 and the majority 2300 3200 into range 0 2 0 3 for all methods except lasso where a large amount of stations can already be found in 0 1 0 2 but also 0 3 0 4 nrmse range table b 1 overall it can be observed that for the simulation of groundwater levels no particular method is doing better than the others this might be due to the input data not having a direct influence on the simulation as the rhine discharge for downstream stations as an example minor differences between the methods regarding average nrmse scores table b 2 were also seen for surface water temperature while rf and lstm show the lowest errors overall the location of the stations and the simulation does not influence the results this is likely due to the strong link to the evaporation data and with that connected to air temperature included in the input data set simulating full timeseries of the different target data and comparing them to the observed records further shows how close the ml methods like rf and lstm come in reproducing the historical observations appendix b 3 fig b4 please note that in these figures we combine training and validation data for the purposes of visual inspection we see that surface water temperature timeseries are well predicted by all methods and especially well by the rf model which is in agreement with the low nrmse scores for discharge and surface water level simulations we see that that the prediction skill deteriorates depending on the location of the station within the national river system as already observed in fig 4 discharge stations which are along the main river network and close to the geographical location of the border discharge input data show a higher prediction skill low nrmse scores but also kge ranging from 0 7 0 985 than stations that are located further downstream kge between 0 6 0 5 lowest kge value 0 4 the timeseries of upstream stations have a stronger correlation with the input timeseries not shown and ml models for these locations are therefore expected to show a good performance to get a better understanding of the way the input data was used by the different models we had a look at the feature importance or model coefficients as a crude type of feature importance score for mreg and lasso models for all methods except the lstm due to its complexity the strong influence of the different input variables was observed by plotting the feature importance per station as seen in fig 6 for discharge and surface water level both natural and water management run using the rf method each station is represented by a diagram showing the feature importance lags are summed up of the different input variables with a color code which got extended for the water management input data set we observed that the rhine and meuse discharge play an important role in the prediction of discharge and surface water levels which was expected for some stations as these rivers are the main two tributaries to the dutch hydrological system for discharge stations the rhine influence is mostly seen along the main river network leading to the sea while the meuse plays a strong role for stations in the south of the netherlands but surprisingly also in some stations in the north east an increase in importance of the information gained from the surface water level station close to haringvliet can be seen for the surface water level simulations of stations close the sea while the main influence of the rhine and meuse discharge in the main river network remains stations around the ijsselmeer and to the east show a more balanced incorporation of the input data for surface water temperature the main influence stems from evaporation information which is ultimately also connected to air temperature while the rf model includes the different input variables in a more balanced way the dt focuses on a few main variables with meuse discharge being more prominent than in the rf model the model coefficients used for mreg and lasso further show which input variables have an inverse relationship in these models e g additional lagged timeseries or certain input variables depending on station location fig b5 b7 and b9 3 2 the impact of water management to assess the impact of including water management as an explanatory input variable in our simulations we included reconstructed timeseries of water management infrastructure based on operational plans and the discharge at lobith these timeseries were added to the general input data set and used in the ml routine to predict the discharge surface water levels and surface water temperatures as we hypothesize that the impact on groundwater levels is negligible as the previous nrmse scores for the normal scenario were already good including water management as input variable generally leads to a small added benefit fig 5 the simple models included in our assessment display a similar behaviour as the rf model where the included water management information only improved the nrmse scores minimally average improvement for mreg 2 9 dt 3 3 rf 4 6 and for lasso even a slight decrease 0 5 compared to the natural run the slight decrease for the lasso method might be due to the random segments splitting approach for defining training and testing data which might have lead to segments being less informative than the one of the natural run the lstm model however notably benefits from the additional information on management with almost all stations showing an improved validation nrmse score average improvement by 9 8 this is likely due to the internal memory that lstm architecture includes enabling the additional information to be included over more calculations steps and improving simulations of stations further downstream which are more affected by water management decisions than the upstream ones for every method the two stations showing the largest improvements in the water management influenced run are the two stations at the ijsselmeer lake which were used as additional input information to represent the water management influence looking again at the feature importance of the different methods for the water management scenarios highlights to which extent the added water management information impacts the simulations even though the improvement in nrmse score was only minor for most methods for the run including water management information the influence of the added reconstructed operational timeseries can be seen in red lock at driel azure lock at haringvliet pink and violet two locks at the ijsselmeer the influence of all these additional input variables can be seen throughout all the discharge and surface water stations in fig 6 with a varying strength for both of these target variables the influence of the lock driel which is the main infrastructure to change the discharge distribution and located only a few km downstream lobith can be seen especially at stations which are close to the main river system observed influence upstream is caused by backwater effects during times when the lock driel is partly closed the reconstructed time series of lock haringvliet have a comparable importance across most of the stations as found for the lock at driel as both of those reconstructed timeseries depend on the discharge at lobith they are all linked together and show a similar importance the influence of the two locks at the ijsselmeer appears to be less strong in general with some exceptions close to those locks compared to the more balanced feature importances of the rf model the dt model fig b6 and b8 focuses again mostly on one major input series for each station while the simple methods only include the water management to a limited degree the predictions of surface water temperature barely take the additional water management information into account with evaporation remaining the most influential input feature as seen in the natural run 3 3 high and low flow simulations in order to test the ability of the ml methods to reproduce discharge and surface water levels during high and low flow periods we selected the highest and lowest 30 of observed records of every station and calculated the nrmse score from the observed and predicted timeseries for these timesteps in fig 7 we show the nrmse scores for the high and low scores plotted against the natural run scores for every method and target variables discharge and surface water levels for both target variables it can be observed that the prediction skill for low flow periods is lower compared to the total natural run scores in average the skill for low flow periods are 15 20 and 5 12 lower for discharge and surface water levels resp while discharge low flows appear to be more challenging to simulate using the currently trained models the surface water level low flows are closer to the total scores with lstm showing the smallest loss in prediction skill and lying closer to the 1 1 line the same observation can be made for high flows where the nrmse results for surface water level stations are generally closer to the total natural nrmse scores showing even a slightly higher skill of 3 6 compared to the latter the scores for discharge also indicate a relatively good performance for high flow periods with most stations having a similar to slightly better score but also a few stations which struggle to reproduce the high flow events table b 2 gives a further overview of the average prediction skill for every method and target variable fig 8 further shows the simulated timeseries of surface water levels for 2015 2019 highlighting the difference in prediction skill for low flow periods per method for one station lying half way on the main river network while the simple methods like mreg and lasso struggle in general to reproduce low flow periods for the time period shown the other methods especially struggle during the drought of 2018 when low flows occurred over several months while previous low flows are captured relatively well besides the model properties also the choice of using random segments for training can have an impact on the simulation performance as extreme low events e g the drought 2018 might not have been selected for the training phase 4 discussion in this study we investigated the suitability of five different machine learning ml methods in simulating various hydrological variables in a national scale managed hydrological system based on a simple input dataset in addition we assessed the impact of including water management information on the ml methods predictive skill by incorporating operational rules of major water infrastructures finally we looked at high and low flow periods separately to check the ml methods capability of capturing for example drought periods which provided the most challenging conditions for operational water management during the last few drought periods 4 1 machine learning models differences difficulties and advantages the selection of the models was done considering different levels of complexity the multi linear regression mreg method was chosen as a benchmark representing the simplest method in our methods set the lasso regression lasso was included due to its simple composition but with the benefit of variable selection the inclusion of the decision tree dt and random forest rf method were considered for their buildable complexity and lstm as a representation for a recurrent neural network which is promising for hydrological assessments e g kratzert et al 2018 2019b we saw that the more advance methods like rf and lstm used in this study in combination with a very simple input data set of 4 8 main features outperform more simple methods especially if target variables are directly connected to the input data for example discharge of rhine and meuse was observed as one of the main features having a strong influence on discharge and surface water level simulations primarily along the main river network the rf models were further outperforming the other methods for stations further downstream for both target variables compared to the other target variables the groundwater level simulations appeared to be more challenging for the different ml methods with most stations of all methods falling into nrmse range of 0 2 0 3 as the simple input dataset used did not have a dominating feature which some of the methods could have taken advantage off furthermore with the change in groundwater levels being relatively slow and small the input variables might have been less informative and relationships harder to extract compared to discharge observations which fluctuate more with all methods performing comparable and no clear method outperforming others computation time could be added to the factors influencing the choice of which ml methods to use in this case as there are roughly 4000 stations included the simple methods like mreg lasso and dt are preferable if a lower computation time is a requirement as these methods were able to simulate all stations within a few hours up to a day while ml methods appear to become a respectable choice in hydrological assessments and we saw that even with a small set of input features some methods can already perform well some aspects can limit or enhance their full potential first since ml methods as used here cannot rely on preconceived rules of system behaviour their dependency on sufficient data of good quality and time series length is key second ml predictions are difficult to interpret owing to their black to grey box nature depending on the ml method different aspects of the method can be analysed or visualized e g tree structure for dt or rf feature importance and model coefficients but for more complex methods as neural networks it can be difficult to fully identify which drivers and processes drive accurate prediction recent efforts to remedy this are based on reporting and analysing cell states kratzert et al 2018 which can help to unravel some of the black box characteristics furthermore finding the right hyperparameter setup for specific methods e g lstm can be challenging we tried to include a coherent approach between the different methods but the best architecture of the lstm neural network is often found by trial and error as there are no clear guidelines on finding the perfect setup a strong advantage of ml methods is their flexibility in learning new relationships handling large amounts of data efficiently and often being less computational demanding than large scale hydrological models in our case simulating the time series of a single variable takes a few seconds to minutes depending on the method and simulating all stations is done within a few hours note that these are serial computation times based on a standard desktop pc simulating many stations simultaneously could be efficiently parallelized on a high performance computer finding the best hyper parameterisation can be more time consuming especially if the gridsearchcv or a similar setup is run for many parameters and for example for more complex ml methods like rf and lstm however these analyses can also be speeded up by performing them in parallel regardless once the model is setup with the most promising parameters and trained the simulation run time is often shorter than for physical based hydrological models 4 2 impact of input timeseries feature importance our analysis shows that different ml methods based on a very few input features can perform well in simulating hydrological variables especially if the there is a direct connection to the target variable we could observe that there is a location dependency of prediction accuracy for discharge and surface water levels related to the proximity of the station to the input locations slight deterioration of the nrmse score could be observed if the station of interest was further away from the different input variable locations which is in line with the general expectation this is also recognizable by the feature importance analysis specifically looking at discharge and surface water level stations following the main river network input variable regarding rhine discharge showing the decreasing influence of the rhine discharge on the simulation results if the station is closer to the coast and thus further from lobith fig 4 other examples of distinct use of the input features were also seen in specific areas e g the use of the water level haringvliet input feature for stations close to the sea target variable surface water levels as well as the use of meuse discharge input feature for stations south east and the use of the rhine discharge for around main river network following from lobith areas especially in the northern part of the netherlands were incorporating the different features more equally or even showing a higher importance of a feature that was not necessarily expected e g meuse discharge for discharge stations overall the incorporation of the feature importance shed more light on the importance of various input variables in the simulations and how this relates to location in the hydrological system as such it provided a limited peak inside the black boxes that most ml methods are 4 3 impact of human water management as the nrmse of the different ml methods already showed a strong performance without it adding additional information on water management practices led to only a small improvement except for the lstm model where the improvement was considerable around 7 and 9 for surface water levels and discharge resp nevertheless the feature importance analysis revealed that including management information is being picked up as a valid predictor by some of the methods fig 6 the main water management infrastructures which are operated based on the rhine discharge appeared to have a large influence on upstream stations and stations close to the infrastructures when looking at the rf results while no impact was found for the more simple methods like mreg and lasso the total influence of the reconstructed time series driel and haringvliet and the rhine discharge are equal to the original influence of the rhine discharge in the normal run even though there is a clear dependency on the rhine discharge the influence of the different management infrastructures depends on the location of the stations although we did not compute the feature importance or a similar measure for the lstm model due to its complex setup we observed that the lstm model was the one method that profited most from the inclusion of water management information fig 5 as the additional water management input timeseries are based on operational rules that are linearly or quasi linearly related to discharge we hypothesize that methods like the rf are especially good in learning these management operations from discharge alone while probably having lower predictive skill if the management rules would be more complex we would expect the lstm model to be more suitable for these due to its characteristics and using the internal state as a sort of memory to substantiate this assumption and to assess the sensitivity to different types of management rules further experiments would be needed which is beyond the scope of this study nevertheless by including human water management the ml algorithms now provide a representation of the hydrological system that is closer to the reality of a managed system in addition this would allow us in future studies to explore the potential of water management changes with the clear limitation that the rules and impacts are assumed to be stationary in time 4 4 performance under droughts conditions in the last part of the analysis we focused on high and low flow periods in more detail we showed that more advanced methods like rf and lstm are generally better in capturing low flow events compared to the simple methods but struggle to recreate extreme events like summer 2018 simple methods like mreg and lasso are not able to capture any of the peaks both low and high due to the stronger non linear relationships that occur during these extreme conditions we observed that simulating high and low flow periods can be challenging especially if only limited data is given to the ml models including more information regarding catchment characteristics and soil moisture which are also important aspects for drought development could improve future simulation experiments similar to kratzert et al 2018 2019a 2019b furthermore the choice of using random segments to split the data into training and testing data further affects the prediction skill as extreme drought periods like 2018 might likely not be in the selected training data resulting in a less good performance for such events as the model has not seen this data before a possibility to improve the predictability of low flows could be to include additional training sets including long term droughts while at the same time using a wider set of input data that inform on the water storage in upstream areas e g snow cover data or total water storage from grace compared to the low flow periods the scores for the high flow periods are generally closer to the nrmse scores of the total simulations and in most cases slightly better e g for surface water level stations 4 5 opportunities for improvement the study s focus is on simulating hydrological variables for stations of the monitoring network of the national water management planning office rijkswaterstaat with the choice of the input data and only working with existing stations in accordance with future forecasting at these locations the assessment assumes stationarity and changes regarding land use or climate change are not directly included climate change could be included in future studies by changing the input data with projections from global climate models in combination with large scale hydrological models van der wiel et al 2019 such an approach could be tested by training the ml models on data from e g the early 1970s and evaluate the trained methods using observations from the last 10 years out of the different methods the lstm model is the only model which has a sort of memory effect which would be interesting to further assess the benefit of it in future studies touching on this aspect of changing climate by focusing on existing stations from the monitoring network the study does not touch upon the problem of prediction in ungauged basins which is an important issue in hydrological modelling for future studies it would be interesting to branch out and test out different setup including adding additional input data as well for example recent studies by kratzert et al 2018 2019a 2019b have shown the promising use of lstm models for regional rainfall runoff modelling in comparison to their work we did not include any location specific static information such as surface elevation soil type proximity to power plants along the river etc it is likely that including such additional information would improve our general predictive skill and would need to be tested in additional experiments furthermore adding additional information regarding soil moisture land use and vegetation might be useful especially for simulating drought period as the current setup appeared to only give limited information for this purpose a particularly interesting result from kratzert et al 2019b is that training a single lstm model on all timeseries using location specific static information as additional input variables performed better than the lstm models trained on each timeseries separately performing such an experiment on the groundwater timeseries used in this study would be an interesting follow on study furthermore regarding incorporating ml methods for groundwater level prediction koch et al 2019 recently showed their efforts to combine the rf method and a physically based model to simulate the shallow water table at a national scale for denmark it would be interesting to see if using e g the long term average groundwater depth from the national hydrological model de lange et al 2014 as location specific feature would improve groundwater level predictions in our case we also realized that the incorporation of water management information in predicting groundwater levels can be challenging as this depends on regional to even local water management by drinking water companies water boards and farmers with diverse and difficult to obtain specific management rules as groundwater is an important aspect of the hydrological system in the netherlands it would be an interesting addition to also include information on regional water management and local groundwater pumping in future experiments if the data availability allows it given that we have shown that the trained ml methods are successful in reproducing observed time series of various hydrological variables at many locations relevant for national scale water management a next step would be to use the trained ml models in a forecasting experiment and evaluate the forecasts for past periods of drought and water shortage in this context with water management as one of the input variables the ml methods with their short computation times can also be used for on the fly implementation of operational management scenarios e g operating scenarios and evaluating their ability to mitigate imminent hydrological droughts 5 conclusion in this study we explored the suitability of five different ml methods for simulating hydrological variables i e discharge surface water levels surface water temperature and groundwater levels that are deemed relevant for water management at a national scale based on a very limited set of input data that are also available from existing weather and large scale hydrological forecasting systems we additionally explored the possibility of incorporating water management practices and the ml methods capability in capturing high and low flow events this in light of future efforts to devise a computationally efficient seasonal forecasting framework that allows operational on the fly water management scenario analyses to mitigate imminent droughts we find that all ml methods ranging from very simple to more complex ones showed a generally good performance for stations and target levels which are closely linked to the input data and location e g stations along main river network for downstream stations and small rivers the random forest method outperforms the other methods both for discharge and surface water levels for surface water temperature no location dependency was observed generally the best performances were reached by the more advanced random forest and lstm methods which was especially the case when simulating high and low flow events high flow events were slightly better captured than low flow events but overall simulating extreme events based on a simple input data set remains challenging specific training sets including event related information and additional input variables could help to improve future assessments for simulating groundwater levels all methods were performing comparably with most stations ranging in nrmse 0 2 0 3 including the feature importance of the methods allowed us to detect how and where water management influence played an important role the addition of information on water management in the ml routines increases overall performance although limited we conclude that ml methods proved to be successful in simulating a large set of inter related time series of multiple hydrological variables for a human influenced national scale hydrological system there are of course limitations and drawbacks of such methods that should not be ignored having enough data of good quality is an important prerequisite for being able to develop an ml routine with high skill also the black box nature of ml methods makes it hard or even impossible to follow or understand the information flow implicit assumptions and the causes of prediction accuracy depending on the ml method it is possible to trace back some of the decision steps and we tried to get an insight on how the input data is used by inspecting the feature importance nevertheless ml methods in general and the routine developed in this study show a large potential for various types of hydrological assessments not only simulating current or historic observations but potentially also for forecasting experiments and scenario analysis in heavily managed river systems around the world the ml routine developed in this study shows a high level of agreement with the observations and can thus act as an additional decision support tool to be implemented in operational water management 6 data availability hydrological data on discharge surface water levels and surface water temperatures were obtained from the webservices and data portal from rijkswaterstaat https waterinfo rws nl nav index the groundwater level observations were taken from the dinoloket https www dinoloket nl ondergrondgegevens daily meteorological data was obtained via knmi https www knmi nl nederland nu klimatologie daggegevens credit authorship contribution statement sandra m hauswirth data curation formal analysis writing review editing marc f p bierkens conceptualization formal analysis writing review editing vincent beijk conceptualization formal analysis writing review editing niko wanders conceptualization formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements sh acknowledges funding from the cooperate innovation program and the department of water transport and environment at the dutch national water authority rijkswaterstaat nw acknowledges funding from nwo 016 veni 181 049 furthermore the authors would like to thank the reviewers for their input and suggestions appendix a material and methods water management appendix b results prediction and reproduction of historical observations b1 nrmse scores b2 nrmse scores maps b3 time series natural run b4 feature importance the feature importance of the stations are ordered according to their distance from lobith station which acts as an input timeseries which enables us to observe the different incorporation of the input data following the river downstream furthermore the main input series e g precipitation evaporation rhine discharge etc are colour coded including the additional lagged timeseries in a lighter colour 
