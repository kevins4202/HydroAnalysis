index,text
23595,most available planing craft design tools and guidelines were not envisioned to be used with vessels that have active control systems acs consequently vessels with acs are conventionally designed as add ons in a sequential manner first the geometry of the vessel is designed using traditional guidelines and then the acs is implemented however sequential design is not always optimal for systems whose dynamics are affected by control systems this research explores the design space of a planing craft with an acs and performs an exhaustive search in the coupled design space of vessel geometry and acs parameters using a time domain simulation program in sea states ss 2 and 3 the vessel is assumed to be prismatic and the controller is a linear quadratic regulator lqr whose outputs are forces on the vessel the results suggest that if the acs is designed along with the planing craft the seaway drag could be reduced in some cases by 30 in ss 2 and 10 in ss 3 the seakeeping also shows significant improvements with 20 reductions in the iso 2631 5 metric d z for ss 2 and 50 in ss 3 thus it is recommended that if a vessel is expected to have an acs co design should be pursued by considering the vessel s geometry and its controller simultaneously keywords multidisciplinary optimization co design planing craft design nomenclature c δ load coefficient δ γ b 3 c v speed coefficient v g b d z acceleration dose from iso 2631 5 m s 2 f 1 acs s body fixed vertical force at the stern n f 2 acs s body fixed vertical force loa 3 forward from the stern n f z lift total vertical force n l d lift to drag ratio l c chine wetted length m l k keel wetted length m r t c calm water drag total horizontal calm water resistance n r t s seaway drag total horizontal seaway resistance n r g pitch radius of gyration m v forward velocity of vessel m s δ displacement n β deadrise angle degrees η 3 vertical displacement of the center of gravity relative to z w l m η 5 rotation of the body relative to the calm water τ degrees γ specific weight of water 10 06 k n m 3 τ trim angle degrees b beam of planing vessel m g gravitational acceleration 9 807 m s 2 l c g longitudinal distance of center of gravity from transom m v c g vertical distance of center of gravity from keel m z w l vertical distance of center of gravity to the calm water line m acs active control system loa length overall m ols open loop stable olu open loop unstable 1 introduction the design of planing craft is commonly based on semi empirical methods and guidelines which can provide quick conceptual designs of the vessel s geometry while the rich knowledge and history of semi empirical methods represent a great success in the advancement of conventional planing craft design little is known about their appropriateness for designing vessels with active control systems acss consequently it has been customary to first design a planing boat following the conventional approach and then adapt an acs to the vessel i e sequentially designing the vessel geometry and the acs but a first sign of caution is that the existing semi empirical methods are based on experimental results of vessels without acss consequently they do not exploit any coupling that might exist between the vessel geometry and its acs in this paper we build from our previous calm water co design results which showed that the calm water and seaway drag could be improved if the vessel was allowed to be open loop 1 1 open loop and closed loop refers to the behavior of the craft without acs and with acs respectively unstable olu castro feliciano et al 2016 and be stabilized by an acs here we explore the seakeeping and seaway drag behavior to further understand and characterize the differences in the sequential design and co design approaches when applied to a planing craft and its acs we accomplish this by performing an exhaustive search in the vessel geometry and control parameter spaces using powersea akers 1999 a strip theory planing boat simulation program the results of this paper suggest the following co designed vessels surpassed the sequentially designed vessels both in seakeeping and transport efficiency results suggest reductions in seaway drag of 30 for sea state 2 and 10 in sea state 3 and reductions in the seakeeping metric d z an iso definition to be discussed in section 3 2 of 20 in sea state 2 and 50 in sea state 3 for the two metrics considered namely average seaway drag r t s and d z co designed optimal vessels at the pareto front are in general not the same as those resulting from the pareto front of sequential design a vessel with an acs has an optimal average seaway trim angle for seakeeping i e the vessel s seakeeping does not monotonically deteriorate with increasing average seaway trim angle as a result the vessel can operate in more drag efficient trim angles in a seaway without a serious penalty in seakeeping 2 background planing craft geometry design was mostly based on experience and rule of thumb up until the 1960 s where research in high speed craft became a popular research subject throughout the 60 s and early 70 s the most common planing craft concept design tools used today come from this period of research where the use of acss was essentially nonexistent one of the popular calm water powering prediction methods is savitsky s semi empirical method savitsky 1964 for seakeeping guidance savitsky s and brown s empirical equations savitsky and brown 1976 based on fridsma s model tests fridsma 1971 have been used extensively a summary of the research from this period can be found in savitsky 1985 doctors 1985 with these two relatively simple methods a designer can have a rough concept design of a planing craft and its estimated calm water and seaway performance the end result would be a traditionally sound concept design however these methods and guidelines were never envisioned to be used for vessels with acss therefore if a vessel will have an acs the designer might be starting off with a concept design that unnecessarily inhibits the synergy between the planing craft and its acs take for example the success stories of co designing a vehicle and its acs in aerospace modern fighter aircraft such as the f 16 may be inherently unstable nguyen et al 1979 known as relaxed static stability in aircraft design and they are only capable of stable flight because of their acs in other words if you turned off the acs of the f 16 mid flight the plane would diverge from its path possibly catastrophically and not glide steadily but not imposing open loop stability allows the aircraft to be lighter more efficient and more maneuverable agard 1974 if the analogous design method was used from conventional planing craft design with acs to fighter aircraft design an aerospace designer would have never come up with the f 16 early in planing craft research it was documented that planing vessels could suffer from instabilities e g porpoising sun and faltinsen 2011 celano 1998 and chine walking katayama et al 2007 lewandowski 1998 and the first guidelines to prevent these were empirical savitsky 1964 based on model test results conducted by day and haag 1952 an overview of planing craft instabilities can be found in faltinsen 2005 blount and condega 1992 because the use of acss in planing craft is usually not considered at the design stage instabilities are generally seen as undesirable and the approach to correct or prevent any instabilities is to modify the vessel hull geometry change the running trim angle and or restrict the operating speeds however restricting the vessel to be open loop stable ols might prevent the vessel from operating at the optimal lift to drag ratio savitsky 1964 where the disadvantage of operating in open loop stable regimes increases as speed increases castro feliciano et al 2016 moreover while the seakeeping of planing craft has improved significantly since the early designs savitsky 1985 there is still a need for seakeeping improvement for vessels operating in rough sea conditions to protect people onboard such as mariners of the coast guard police and navy the rate of injury for this type of craft is known to be high a survey of combatant craft crewmen reported that 65 of them had sustained at least one injury during service with the harsh craft s motion being the primary subject ensign et al 2000 consequently recent research has explored the use of acss in planing craft in order to improve the vessel s seakeeping this research has shown that a planing craft with an acs is capable of superior seakeeping compared to those without wang 1985 savitsky 2003 shimozono and kays 2011 engle et al 2011 rijkens 2013 in addition not only can an acs improve the seakeeping of a planing craft it can also stabilize it so that it can operate at its optimal lift to drag trim angle xi and sun 2006 all these promising results for incorporating acs into planing craft are with vessels that were designed sequentially i e the vessel geometry was first selected and then the acs was incorporated but because the vessel geometry and acs are coupled both affect the vessel s dynamics even better results are possible if both are co designed and the hardware control couplings are explored castro feliciano et al 2016 peters 2010 co design of vessel geometry and acs requires effective tools to facilitate optimization particularly the models that capture the sensitivity of key planing boat performance with respect to both geometry and acs parameters recent research in the hydrodynamic optimization of a planing craft ayob et al 2009 2010 estimated the seaway drag and seakeeping performance by using empirical equations savitsky and brown 1976 savitsky and koelbel 1993 as previously mentioned the model tests used fridsma 1971 did not have acs and therefore the empirical equations do not incorporate the effects of an acs consequently a time domain simulation program is required to estimate the seakeeping performance of a planing craft with an acs more specifically the problem of designing a planing craft with an acs is a multidisciplinary design optimization mdo problem one discipline is the controls engineering and the other is the naval architecture hydrodynamics of the vessel and acs s hardware aerospace is one of the most active fields in mdo a summary of some mdo techniques used in aerospace is documented in sobieszczanski sobieski and hafka 1997 it is easy to see how an mdo problem could be made as complex as the designer would want for example we could also include structure design into the problem definition therefore one of the challenges in mdo is choosing parameter spaces that have great influence on the design objectives while maintaining the optimization problem tractable in this paper we focus in exploring simplified definitions of the acs and vessel s geometry which are known to be influential in the seakeeping and lift to drag ratio and consider seakeeping and drag reduction as the primary design objectives 3 design methodology while the main objective of our research is to explore the optimal vessels obtained by sequential design and co design the approach taken is an exploratory one rather than numerical optimization this approach is taken for the following reasons 1 it allows us to investigate the seakeeping and drag behavior of the craft as we vary design parameters and 2 there is a guarantee that we will find the global minimums from the discretized design space the approach is further explained in section 3 2 and the modeling of the planing craft and acs is presented in section 3 1 3 1 modeling 3 1 1 craft geometry in order to simplify the vessel s hydrodynamics and isolate the key variables that influence the craft s behavior the body is prismatic and the bow shape follows that from the models tested by fridsma 1969 which have constant deadrise throughout the fixed vessel particulars can be seen in table 1 and a diagram of the vessel in fig 1 the vessel s geometry design variables considered in this work are β deadrise angle and l c g longitudinal center of gravity 3 1 2 acs the acs is modeled as two vertical body fixed point forces f 1 and f 2 in fig 1 with a horizontal body fixed drag penalty r 1 and r 2 in fig 1 proportional to the force magnitude a simplistic approach to simulate the acs s hardware s lift to drag ratio l d which is set to l d 10 the approximate l d of the tandem hydrofoil found in wetzel and schiebe 1960 while this approach leaves room for future improvement in terms of acs s hardware modeling and simulation the resultant forces could be instead analyzed to evaluate appropriate acs s hardware i e reverse engineering the required hardware two force locations are used in order to allow the acs to exert pure moments on the vessel the greater the distance between the forces the greater the pitch control authority the acs will have however a hydrofoil located far forward might have practical problems such as slamming in a seaway therefore as a design feature one force is located on the stern and the other was set to one third of the vessel length loa 3 illustrated in fig 1 note that the suitability of this location was not investigated the acs s controller is chosen as the linear quadratic regulator lqr designed using the linear model described in castro feliciano et al 2016 2 2 the linear model is largely based on faltinsen s work faltinsen 2005 which in turn uses savitsky s semi empirical equations savitsky 1964 with the difference that b the input matrix now contains the distance loa 3 instead of loa the controller minimizes the cost function 1 j u 0 η t q η u t r u d t where the r matrix is set as an identity matrix 2 2 the state variables are η η 3 η 5 η 3 η 5 t q is 2 q 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 q 44 where q 44 is a design parameter and u are the acs s forces f 1 and f 2 the weight on pitch velocity q 44 was selected as the design parameter because previous research wang 1985 suggests that seakeeping is sensitive to pitch velocity feedback the output from the lqr are the controller gains k ℝ 2 4 where u f 1 f 2 t kη note that in this work eq 1 is evaluated with the linearized model of a planing craft operating in calm water while lqr is a favorable controller for an optimization study it guarantees closed loop local stability allows for an arbitrary number of control inputs and limits the controller design variables to the lqr tuning parameters better performance might be possible with a nonlinear controller that takes into account the nonlinear dynamics of a planing craft therefore the appropriateness of using conventional lqr in planing craft needs further examination outside of the present work 3 1 3 simulated conditions in our previous study on co design of planing craft with acs castro feliciano et al 2016 where calm water drag was the sole optimized objective the largest drag reduction of co designing occurred at the highest simulated speed of c v 4 5 however the co designed vessel s seakeeping was the worst at this high speed since we are focusing on the possibility that the co designed vessels are significantly better both at seakeeping and drag the present work explores vessels operating in a seaway with a speed of v 45 kt c v 4 6 a speed we know the co designed vessels will excel at least in drag optimization castro feliciano et al 2016 and a common high speed for the investigated vessel size e g high speed patrol boats and rhibs two sea conditions are explored sea state ss 2 and 3 these are conditions typically encountered by vessels with particulars similar to those of table 1 the seaway is simulated by using the issc sea spectrum with 100 wave components the issc parameters used are shown in table 2 because the seas are stochastic the objective functions defined in sec 3 2 2 are a function of simulation time which should converge to a value as the simulation time goes to infinity a naive approach to selecting a simulation length would be to conduct the exploration with a simulation time of one hour as recommended by the ittc ittc 2002 for accurate statistics but in this paper we are interested in which vessels are better instead of what are the seakeeping statistics within a high confidence level one can see that these two questions have conflicting requirements in order to find the better vessels one would want to run as many different configurations as possible but on the other hand if we want accurate statistics we want to run the tests for as long as possible this kind of problem is known in the machine learning community as the exploration exploitation dilemma crepinsek et al 2013 heuristically speaking the approach taken in this paper follows the idea that if the vessels are tested with the same wave history there should be a finite simulation time that when comparing the results one can select the winner within some certainty calculating the confidence interval is non trivial because while the seaway has a well defined stochastic model the vessel s response is highly nonlinear savitsky and brown 1976 to avoid the issue of improper metric comparison between vessel simulations we simulated each design for 180 s with the same random seed number i e the wave time histories are identical for all runs this is akin to treating the results for the 180 s seaway as a metric similar to how the controls field uses standard responses to measure performance e g step response and impulse response the behavior of the objective functions defined in sec 3 2 2 with fixed deadrise and varying l c g and simulation times are seen in fig 2 this investigated case suggests that design variables that minimizes the objective space created by a simulation time of 180 s are close to the design variables that minimize the objective space for extended simulation times while this approach may not be ideal it is the most efficient given the available tools and design constraints 3 1 4 virtual test bed the simulations are performed in the time domain using the program powersea akers 1999 which is based on a strip theory approach with empirical wedge impact forces zarnickdavid 1979 since the hull s wave forces are estimated from the empirical wedge impact forces the acs s forces are uncoupled from any hull wave interaction because the research will require extensive simulations a strip theory approach is adequate since it is computationally fast powersea allows for script automation via component object model com interoperability the tuning parameters in powersea are empirical akers 2013 but they have a strong effect on the vessel s stability and operation behavior however some of the empirical correction parameters are meant to correct for varying deadrise and or beam specifically the geometric coefficients which the tested vessels do not have since they are prismatic powersea can automatically adjust these coefficients depending on the operating conditions but this procedure is itself active research and therefore fixed values were used as it was done in the original program zarnickdavid 1979 values used in this study are shown in table 3 the only value that differs from the default powersea and zarnickdavid 1979 values is the buoyancy lift coefficient zarnick zarnickdavid 1979 and the powersea documentation have a default of 0 5 for this coefficient however this value is originally quoted from shuford shuford 1958 where it indicates that 0 5 is a reasonable value for τ 8 but larger values are needed for τ 4 since we are interested in the optimal drag and seakeeping operating trim angles and those are known to be around 4 to 5 for drag savitsky 1964 and even lower for seakeeping savitsky and brown 1976 a value of 0 85 is used following the results in shuford 1958 3 2 exhaustive search approach in this investigation we are interested in both the seakeeping performance and drag therefore we have a multi objective problem the drag metric j 1 is simply the average seaway drag r t s i e j 1 r t s the seakeeping metric is j 2 d z t m 1 6 which is the vertical acceleration dose d z i a i z 6 1 6 presented in iso 2631 5 iso standard 2631 5 2004 divided by the period in seconds over which d z was measured to the 1 6 power t m 1 6 where a i z is the i th peak of the spine s vertical acceleration response to the vessel s vertical motion given by a recurrent neural network model from iso standard 2631 5 2004 and shown in b in the present work we took the conservative approach of using the bow motions to calculate the spine s response the units of d z are m s 2 and j 2 can be interpreted as the d z normalized to a one second exposure i e j 2 d z 1 sec t m 1 6 thus in this work j 2 will have m s 2 as units following this interpretation moreover j 2 could be extended to include the long term health effects following the procedure in iso standard 2631 5 2004 but this was not pursued in this work an excerpt of iso standard 2631 5 2004 can be found in b while a limitation of the d z metric is that it could over or under predict the effects of impact accelerations events larger than 4 g iso standard 2631 5 2004 its validity for the present work is demonstrated in sec 4 1 1 an important note is that while powersea is capable of estimating the seaway accelerations which are used for calculating d z and drag its accuracy is limited akers 1999 the strength in powersea or planing boat strip theory methods in general lies on capturing the general dynamics of the vessel operating in a seaway in a computationally efficient manner as a result powersea allows us to conduct an exhaustive search with the available computational resources keep in mind however that the results in this paper are more valuable in the relative comparisons and qualitative aspects rather than on the quantitative ones the design space consists of l c b b β log q 44 where l c g b and β are physical design parameters and q 44 is the control design parameter q 44 is the 4 4 element in the q matrix see sec 3 1 2 the use of log q 44 instead of q 44 is to facilitate the exploration of this metric s influence range which was found to extend approximately between 1 log q 44 7 in preliminary tests the l c g b range also comes from preliminary tests investigating the upper and lower values where the vessel failed to complete a seaway run and the β range is a practical range for a positive deadrise hull powersea cannot simulated negative deadrise hulls the design space was discretized following table 4 and an exhaustive search was performed in powersea parameter combinations in which the vessel never reached stable equilibrium in calm water or encountered excessive trim angles during the 180 s of simulation e g bow dived or lost stability were simply classified as failed runs and the partial data was unused the framework used to perform the exhaustive search is further explained in section 3 2 1 3 2 1 process framework the exhaustive search was automated by using powersea s and matlab s com interop with visual basic net vb net the process framework schematic for when the vessel is designed with an acs and when it is designed without an acs can be seen in fig 3 and fig 4 respectively when the vessel is designed with an acs the exhaustive search control module controls the test design variables which are passed to the vessel geometry and lqr design modules the vessel geometry module creates the vessel in powersea afterwards the stabilizing velocity feedback acs module is run which creates in powersea an acs with a heave and pitch velocity feedback high gain controller velocity in stabilizing velocity feedback acs refers to the heave and pitch velocity not vessel speed not to be confused with the lqr controller used in the seaway simulation the stabilizing velocity feedback acs is only used to find the vessel s calm water equilibrium it is truly only required for when the vessel is open loop unstable the velocity feedback acs shown in eq 3 has no drag and the forces create a couple on the vessel 3 f 1 5 10 4 7 10 6 η 3 η 5 f 2 f 1 since the velocity feedback acs has only feedback on the state velocities the vessel should reach its unforced equilibrium f 1 f 2 0 as η 3 η 5 0 regardless of η 3 η 5 stability by this controller is not guaranteed and the gains come from tuning a badly porpoising vessel β 2 and l c g b 0 10 so that it has a settling time during closed loop operation of roughly 20 s 3 3 the velocity feedback acs step could be made more sophisticated by tuning the controller for each test case however the controller presented turns out to be sufficiently robust to avoid the added complexity and subsequently required exception handling next the vessel is run in calm water until it reaches equilibrium if it does not reach equilibrium the run is classified as a fail and the process ends and the steady calm water running attitude is set as the initial conditions for the seaway simulation and also passed to the controller design module the controller design module calls the matlab script linear model estimation whose equations are shown in castro feliciano et al 2016 where a state space model is created and passed to the lqr design matlab script the lqr design module takes the state space model and the lqr parameters as described in section 3 1 2 and uses matlab s lqr function to calculate the controller s gains mathworks online document 2016 the controller gains are then passed to the acs incorporation module where it then replaces the stabilizing velocity feedback acs with the acs described in section 3 1 2 afterwards the seaway run module is run which passes the seaway parameters mentioned in section 3 1 3 and simulates the vessel in powersea the results from the seaway simulation are then processed to obtain the performance metrics average seaway drag and d z t m 1 6 the whole process is then repeated for the next point in the design and control space when the vessel is designed with no acs the process will not have any of the acs related steps as illustrated in fig 4 since the vessel without acs needs to be open loop stable the results from the calm water run are used to check for stability if the vessel is not stable the test case is skipped the vessel is not simulated in a seaway if it is stable the process continues with the modules having the same function as previously described 3 2 2 pareto fronts the optimization problem formulations for the vessels following co design and sequential design approaches are given in table 5 and table 6 respectively the objective functions are defined as j 1 r t s average seaway drag and j 2 d z t m 1 6 seakeeping metric in both design approaches while x l c g b β l o g q 44 is the optimizing variables for the co design problem and x ˆ l c g b β and x ˇ l o g q 44 are the optimizing variables for the sequential design in step 1 and 2 respectively δ τ c is the peak to peak amplitude of the calm water trim angle i e unacceptable porpoising is considered to be δ τ c 0 5 in a multi objective optimization usually there is no unique optimum that optimizes both objectives instead a family of optimal solutions that represents the trade off among competing objectives can be obtained this family of optimal solutions is called the pareto set or pareto frontier we call a design pareto optimal part of the pareto set if its performance in one objective cannot be improved without degrading the performance on another objective the general approach to estimating the pareto front from a series of runs is to find the non dominated nd designs however because it is easier to check for dominance a simple approach is to first find all the designs that are dominated and then remove them leaving only the designs that were not dominated nd designs design x 1 is said to weakly dominate x 2 if i all objectives achieved by x 1 are no worse than those achieved by x 2 and ii at least one objective at x 1 is strictly better than the corresponding objective at x 2 4 results and discussion the naming convention used throughout this section is as follows the pareto fronts are co design olu pareto optimal vessels that are open loop unstable and have acs co design ols pareto optimal vessels that are open loop stable and have acs sequential 1 w o acs pareto optimal vessels that are open loop stable but without acs in addition the performance of the pareto fronts are named co design ols w o acs pareto optimal designs of co design ols when acs is removed sequential 2 w acs pareto optimal designs of sequential 1 w o acs with optimized acs the raw results alongside their constructed pareto fronts are shown in a even though the results are presented in non dimensional form caution must be taken when applying these results to vessels which have different properties from those fixed in this study this includes the fact that the acs used in this work was two point forces at specific locations 4 1 pareto optimality in both tested sea states the pareto optimal vessels co designed with acs and allowed to be open loop unstable co design olu dominate all other pareto optimal designs see fig 5 i e there is a design in co design olu which outperforms both in seakeeping and drag any other possible design in the other classes if the sequential 1 w o acs vessels are then modified to have an acs which is optimized to perform well in seakeeping we can see that the designs sequential 2 w acs are in general not the pareto optimal designs obtained by co designing both an open loop stable vessel and its acs co design ols see fig 6 moreover a designer following the sequential design would quickly discard the vessels that have the best performance with an acs since as fig 7 shows the performance of the co design ols w o acs vessels have in general a considerably inferior performance when compared to the sequential 1 w o acs vessels 4 1 1 seakeeping metric validity before proceeding with the results discussion note in fig 8 that the exhaustive search results have in general a distinct upper bound to the average bow impact acceleration for a selected d z t m 1 6 e g for ss 2 a run with d z t m 1 6 20 m s2 has an average bow impact acceleration of 10 g thus the probability of an impact a exceeding 4 g the upper limit where d z is applicable is p a 4 e 4 a assuming an exponential distribution as suggested by fridsma 1971 where a is the average peak acceleration in g s considering that the upper d z t m 1 6 values of practical interest are around 20 and 50 for ss 2 and ss 3 see fig 5 accordingly the average peak accelerations upper bounds in ss 2 and ss 3 are around 1 g and 2 g see fig 8 respectively the probabilities of an impact exceeding 4 g at these upper bounds are p a 4 a 1 2 and p a 4 a 2 14 for ss 2 and ss 3 considering the low probabilities of encountering impacts larger than 4 g on the upper bounds of the regions of interest the use of d z as a seakeeping metric is reasonable 4 1 2 performance evaluation we can see from figs 5 and 6 that considerable improvement can be made if one follows the co design methodology instead of the sequential and this improvement is at its greatest when the stability constraint is relaxed and the vessels are allowed to be open loop unstable some example changes in performance from the pareto optimal sequential 2 w acs vessels to the vessels in co design olu and co design ols are shown in table 7 and table 8 these results were found by linear interpolation within the pareto fronts in short for the tested speed coefficient and sea state conditions the co designed vessels outperformed the sequentially designed vessels in both seakeeping and drag by considerable margins for essentially all combinations of seaway drag or seakeeping constraints 4 2 optimal design parameters the geometry design variables of the ss 2 pareto fronts designs are plotted in fig 9 a and for ss 3 in fig 9b the results show that in general when there is an ols constraint the pareto optimal designs are as close to being olu as possible however the designs obtained by the sequential optimization tell a different story in ss 2 the designs try to keep the lowest running trim angle as expected from traditional vessel design by having the lcg as far forward as possible see fig 9a while in ss 3 the optimal sequential vessels appear to be those that are around the middle of the ols l c g b range which is likely due to the fact that the vessel has a finite length therefore making very low trim angles in a bad seaway dangerous for bow diving 4 4 while powersea does not model the hydrodynamic forces caused by bow diving it does estimate the hydrostatic forces at all times including bow diving events 4 3 effect of average seaway trim fig 10 a and fig 10b show how r t s and d z change with respect to the average seaway trim angle which is changed by l c g b as illustrated in fig 10c the deadrise is fixed and the controller variable that minimizes the seakeeping metric is selected for each point the r t s results show that the seaway transport efficiency 5 5 seaway transport efficiency refers here to the required energy to move the vessel a certain distance at a certain high speed in a seaway is improved as the vessel is allowed to be open loop unstable which supports the preliminary results presented in castro feliciano et al 2016 a surprising result is that the seakeeping does not necessarily worsen monotonically with increasing trim angle as the example in fig 10b shows this goes against what it is commonly known from past research of vessels without acs savitsky and brown 1976 and the fundamental reasons of why this behavior occurs when an acs is present are unknown however since the co designed vessel can go towards higher trim angles to improve both the seakeeping and transport efficiency it is comprehensible how the co designed vessels outperform the traditionally designed vessels in these two metrics 4 4 general design observations when designing a planing craft which will have an acs the designer should keep in mind the following observations the overall optimal vessels are not obtained by following a sequential design for the vessels investigated the co design ols vessels are on the edge of being olu indicating that the ols constraint is active having an acs might create optimal seakeeping trim angles which goes against the common rule of thumb that a planing craft s seakeeping will improve monotonically as the trim angle is reduced an observation generally obtained for vessels without acs 5 conclusion design optimization of a planing hull in both geometry space and control space is explored in this paper through a case study the results show a clear advantage of co designing a planing craft with acs over the traditional approach of sequentially designing one then followed by another co designed vessels show superior seakeeping and efficiency over the sequentially designed vessels moreover the co designed pareto optimal vessels are not the sequentially designed pareto optimal vessels even when the co designed vessels are restricted to be ols in addition the vessels obtained by sequential design have limited synergy with their acs when compared to the co designed vessels this investigation supports the hypothesis that because the acs affects the relationship between seakeeping and the vessel s geometry the conventional empirically based seakeeping guidelines are not appropriate for vessels with acs nonetheless if a planing boat is expected to have an acs it is best if it is co designed with the vessel s geometry in order to exploit the synergy between them to the best of the authors knowledge co designing a planing craft and its acs has never been performed in practice thus the proposed framework offers an opportunity of designing planing craft that are more efficient and have better seakeeping than conventionally designed planing craft 5 1 recommended future work since planing craft design is heavily influenced by empirical guidelines the addition of acs to the design renews many of the early and ongoing research questions in high speed vessel design in general the renewed research questions could be summarized as what are the effects of the design variables on the transport efficiency seakeeping maneuverability and seaway impact forces this work attempts to shed some light to the transport efficiency and seakeeping aspects of co design and following this path future work should focus on developing optimization techniques to find the pareto front more efficiently in order to expand the number of geometry and acs optimization variables e g optimizing b and additional lqr tuning parameters moreover while considering a rudder controller when estimating a vessel s maneuverability is done practice faltinsen 2005 to the best of the authors knowledge a co design investigation of a vessel s geometry and acs has not been documented in literature allowing a planing craft to be directionally olu might result in super maneuverable vessels in parallel the insights gained from the optimal co design can be explored to develop design procedures and guidelines for the high speed planing hull for example since the required l c g of the co designed vessels is far aft future work can include a case study investigating the feasibility of developing functional co designed vessels a valid question that is not answered in this paper is if these results are simply an artifact of the modeling techniques therefore higher fidelity modeling could be used in the case study to increase the confidence in the performance enhancement of the co designed vessels moreover planing crafts have nonlinear dynamics that an lqr is naive to future research will need to explore nonlinear controllers to further exploit the co design framework acknowledgments this work was supported by naval engineering education consortium neec and by onr n00014 11 1 0831 and n00014 11 1 0832 program director ms kelly cooper the authors are also appreciative of the significant help provided by mr richard akers at main marine composites in assisting with powersea simulations appendix a results scatter plots with pareto fronts please see fig 11 fig 11 scatter plot of raw results with the resulting pareto fronts fig 11 appendix b iso 2631 5 excerpt this appendix is meant to succinctly illustrate the iso standard 2631 5 2004 metrics as used in this work for a complete description of the equations presented and thorough instructions the reader is referred to the original work iso standard 2631 5 2004 the symbols and subscripts used throughout this appendix are shown in table 9 table 9 symbols and subscripts from iso standard 2631 5 2004 table 9 symbols subscripts r 1 2 l 3 4 a acceleration d daily as in duration of daily exposure t d a peak acceleration e equivalent as in equivalent static compressive stress s e δ constant i j counter d acceleration dose k counter x y or z f frequency l lumbar m dose coefficient m measured as in measured period t m r factor n natural as in natural frequency f n s displacement v vessel s compressive stress u ultimate as in ultimate stress s u t time x y z reference axis u model acceleration term w w model coefficients ζ critical damping ratio ω angular frequency b 1 spinal response and exposure metric the x y and z directions correspond to the longitudinal transverse and vertical axes with the positive directions forward left port and up assume the vessel s accelerations a v k are measured with a sampling frequency of f k where k x y or z the x and y direction sampling rate should be appropriate to the analysis of an 80 hz signal and the z direction a sampling rate that is a multiple of 160 samples per second is recommended iso standard 2631 5 2004 appendix b 1 1 spinal response in horizontal directions k x y iso standard 2631 5 2004 uses a linear model represented by a single degree of freedom sdof lumped parameter model with natural frequency ω n 13 35 s 1 and critical damping ratio ζ 0 22 therefore using a 1 d filter we can estimate the lumbar response by using the rational transfer function a l k z b 0 b 1 z 1 b 2 z 2 c 0 c 1 z 1 c 2 z 2 a v k z where a l k z and a v k z are the z transform of the lumbar and vessel accelerations and b 1 sin β β e α 2 sin β β e α cos β e 2 α sin β β e α c 1 2 cos β e α e 2 α α ω n 2 q f k β ω n f k 1 1 2 q 2 q 1 2 ζ in matlab a l k can be calculated with a l k t f i l t e r b c a v k t appendix b 1 2 spinal response in the vertical direction k z iso standard 2631 5 2004 uses a recurrent neural network to represent the spinal vertical response the lumbar spine vertical acceleration a l z is predicted in m s2 using eq b 4 and eq b 5 along with tables 10 and 11 b 4 a l z t j 1 7 w j u j t w 8 b 5 u j t tanh i 1 4 w j i a l z t i i 5 12 w j i a v z t i 4 w j 13 table 10 z axis model coefficients for eq b 4 from iso standard 2631 5 2004 table 10 w 1 w 2 w 3 w 4 57 96539 52 32773 49 78227 53 16885 w 5 w 6 w 7 w 8 56 02619 27 79550 72 34446 21 51959 table 11 z axis model coefficients for eq b 5 from iso standard 2631 5 2004 table 11 j 1 2 3 4 5 6 7 w j 1 0 00130 0 01841 0 00336 0 01471 0 00174 0 00137 0 00145 w j 2 0 00646 0 00565 0 00539 0 01544 0 00542 0 00381 0 00497 w j 3 0 00091 0 02073 0 00708 0 00091 0 00255 0 00216 0 01001 w j 4 0 00898 0 02626 0 00438 0 00595 0 00774 0 00034 0 01283 w j 5 0 00201 0 00579 0 00330 0 00065 0 00459 0 00417 0 00468 w j 6 0 00158 0 00859 0 00166 0 00490 0 00546 0 00057 0 00797 w j 7 0 00361 0 00490 0 00452 0 00079 0 00604 0 00638 0 00529 w j 8 0 00167 0 00098 0 00743 0 00795 0 01095 0 00627 0 00341 w j 9 0 00078 0 00261 0 00771 0 00600 0 00908 0 00504 0 00135 w j 10 0 00405 0 00210 0 00520 0 00176 0 00465 0 00198 0 00451 w j 11 0 00563 0 00218 0 00105 0 00195 0 00296 0 00190 0 00306 w j 12 0 00372 0 00037 0 00045 0 00197 0 00289 0 00448 0 00216 w j 13 0 31088 0 95883 0 67105 0 14423 0 04063 0 07029 1 03300 the range of applicability for the z axis lumbar acceleration model is 20 m s2 to 40 m s2 and 0 5 hz 40 hz iso standard 2631 5 2004 appendix b 1 3 calculation of the acceleration dose iso standard 2631 5 2004 defines the acceleration dose d k in m s2 as shown in eq b 6 b 6 d k i a i k 6 1 6 where a i k is the i th peak of the response acceleration a l k t and k x y or z from iso standard 2631 5 2004 a peak is defined here as the maximum absolute value of the response acceleration between two consecutive zero crossings for the x and y directions peaks in positive and negative directions shall be counted for the z direction only positive peaks shall be counted compression of the spine is the primary interest for exposure severity the average daily dose d k d in m s2 a person will be exposed to is calculated with eq b 7 b 7 d k d d k t d t m 1 6 where t d is the duration of the daily exposure t m is the period over which d k has been measured d k d can be used for health assessments as presented in section b 2 iso standard 2631 5 2004 iso standard 2631 5 2004 also includes the possibility of calculating d k d when the daily vibration exposure consists of multiple n periods of different magnitudes by using eq b 8 b 8 d k d j 1 n d k j 6 t d j t m j 1 6 where t d j is the duration of the daily exposure to condition j and t m j is the period over which d k j has been measured while this study used eq b 7 eq b 8 would be relevant if the reader desires to do scenario based optimizations e g the vessel operates daily for 1 h at ss 1 2 h at ss 2 and 1 h at ss 3 appendix b 2 assessment of health effects from iso standard 2631 5 2004 by use of a biomechanical model based on experimental data it has been shown that there is a linear relationship between the part of compressive stress that is due to the input shocks and the peak acceleration response in the spine the first step for assessing health effects is to calculate the daily equivalent static compression dose s e in mpa b 9 s ed k x y z m k d k d 6 1 6 where the recommended values of m x m y and m z are 0 015 0 035 and 0 032 mpa m s2 accordingly iso standard 2631 5 2004 afterwards the factor r is used to assess adverse health effects related to the human response acceleration dose iso standard 2631 5 2004 and is defined as b 10 r i 1 n s ed n 1 6 s u i δ 6 1 6 where n is the number of exposure days per year i is the year counter n is the number of years of exposure δ is a constant representing the static stress due to gravitational force s u i is the ultimate strength of the lumber spine for a person of age b i years and b is the age at which the exposure starts following iso standard 2631 5 2004 δ 0 25 mpa can be used for a driving posture and s u i 6 75 0 066 b i from iso standard 2631 5 2004 there is a significant human variability and r 0 8 indicates a low probability of an adverse health effect r 1 2 indicates a high probability of an adverse health effect 
23595,most available planing craft design tools and guidelines were not envisioned to be used with vessels that have active control systems acs consequently vessels with acs are conventionally designed as add ons in a sequential manner first the geometry of the vessel is designed using traditional guidelines and then the acs is implemented however sequential design is not always optimal for systems whose dynamics are affected by control systems this research explores the design space of a planing craft with an acs and performs an exhaustive search in the coupled design space of vessel geometry and acs parameters using a time domain simulation program in sea states ss 2 and 3 the vessel is assumed to be prismatic and the controller is a linear quadratic regulator lqr whose outputs are forces on the vessel the results suggest that if the acs is designed along with the planing craft the seaway drag could be reduced in some cases by 30 in ss 2 and 10 in ss 3 the seakeeping also shows significant improvements with 20 reductions in the iso 2631 5 metric d z for ss 2 and 50 in ss 3 thus it is recommended that if a vessel is expected to have an acs co design should be pursued by considering the vessel s geometry and its controller simultaneously keywords multidisciplinary optimization co design planing craft design nomenclature c δ load coefficient δ γ b 3 c v speed coefficient v g b d z acceleration dose from iso 2631 5 m s 2 f 1 acs s body fixed vertical force at the stern n f 2 acs s body fixed vertical force loa 3 forward from the stern n f z lift total vertical force n l d lift to drag ratio l c chine wetted length m l k keel wetted length m r t c calm water drag total horizontal calm water resistance n r t s seaway drag total horizontal seaway resistance n r g pitch radius of gyration m v forward velocity of vessel m s δ displacement n β deadrise angle degrees η 3 vertical displacement of the center of gravity relative to z w l m η 5 rotation of the body relative to the calm water τ degrees γ specific weight of water 10 06 k n m 3 τ trim angle degrees b beam of planing vessel m g gravitational acceleration 9 807 m s 2 l c g longitudinal distance of center of gravity from transom m v c g vertical distance of center of gravity from keel m z w l vertical distance of center of gravity to the calm water line m acs active control system loa length overall m ols open loop stable olu open loop unstable 1 introduction the design of planing craft is commonly based on semi empirical methods and guidelines which can provide quick conceptual designs of the vessel s geometry while the rich knowledge and history of semi empirical methods represent a great success in the advancement of conventional planing craft design little is known about their appropriateness for designing vessels with active control systems acss consequently it has been customary to first design a planing boat following the conventional approach and then adapt an acs to the vessel i e sequentially designing the vessel geometry and the acs but a first sign of caution is that the existing semi empirical methods are based on experimental results of vessels without acss consequently they do not exploit any coupling that might exist between the vessel geometry and its acs in this paper we build from our previous calm water co design results which showed that the calm water and seaway drag could be improved if the vessel was allowed to be open loop 1 1 open loop and closed loop refers to the behavior of the craft without acs and with acs respectively unstable olu castro feliciano et al 2016 and be stabilized by an acs here we explore the seakeeping and seaway drag behavior to further understand and characterize the differences in the sequential design and co design approaches when applied to a planing craft and its acs we accomplish this by performing an exhaustive search in the vessel geometry and control parameter spaces using powersea akers 1999 a strip theory planing boat simulation program the results of this paper suggest the following co designed vessels surpassed the sequentially designed vessels both in seakeeping and transport efficiency results suggest reductions in seaway drag of 30 for sea state 2 and 10 in sea state 3 and reductions in the seakeeping metric d z an iso definition to be discussed in section 3 2 of 20 in sea state 2 and 50 in sea state 3 for the two metrics considered namely average seaway drag r t s and d z co designed optimal vessels at the pareto front are in general not the same as those resulting from the pareto front of sequential design a vessel with an acs has an optimal average seaway trim angle for seakeeping i e the vessel s seakeeping does not monotonically deteriorate with increasing average seaway trim angle as a result the vessel can operate in more drag efficient trim angles in a seaway without a serious penalty in seakeeping 2 background planing craft geometry design was mostly based on experience and rule of thumb up until the 1960 s where research in high speed craft became a popular research subject throughout the 60 s and early 70 s the most common planing craft concept design tools used today come from this period of research where the use of acss was essentially nonexistent one of the popular calm water powering prediction methods is savitsky s semi empirical method savitsky 1964 for seakeeping guidance savitsky s and brown s empirical equations savitsky and brown 1976 based on fridsma s model tests fridsma 1971 have been used extensively a summary of the research from this period can be found in savitsky 1985 doctors 1985 with these two relatively simple methods a designer can have a rough concept design of a planing craft and its estimated calm water and seaway performance the end result would be a traditionally sound concept design however these methods and guidelines were never envisioned to be used for vessels with acss therefore if a vessel will have an acs the designer might be starting off with a concept design that unnecessarily inhibits the synergy between the planing craft and its acs take for example the success stories of co designing a vehicle and its acs in aerospace modern fighter aircraft such as the f 16 may be inherently unstable nguyen et al 1979 known as relaxed static stability in aircraft design and they are only capable of stable flight because of their acs in other words if you turned off the acs of the f 16 mid flight the plane would diverge from its path possibly catastrophically and not glide steadily but not imposing open loop stability allows the aircraft to be lighter more efficient and more maneuverable agard 1974 if the analogous design method was used from conventional planing craft design with acs to fighter aircraft design an aerospace designer would have never come up with the f 16 early in planing craft research it was documented that planing vessels could suffer from instabilities e g porpoising sun and faltinsen 2011 celano 1998 and chine walking katayama et al 2007 lewandowski 1998 and the first guidelines to prevent these were empirical savitsky 1964 based on model test results conducted by day and haag 1952 an overview of planing craft instabilities can be found in faltinsen 2005 blount and condega 1992 because the use of acss in planing craft is usually not considered at the design stage instabilities are generally seen as undesirable and the approach to correct or prevent any instabilities is to modify the vessel hull geometry change the running trim angle and or restrict the operating speeds however restricting the vessel to be open loop stable ols might prevent the vessel from operating at the optimal lift to drag ratio savitsky 1964 where the disadvantage of operating in open loop stable regimes increases as speed increases castro feliciano et al 2016 moreover while the seakeeping of planing craft has improved significantly since the early designs savitsky 1985 there is still a need for seakeeping improvement for vessels operating in rough sea conditions to protect people onboard such as mariners of the coast guard police and navy the rate of injury for this type of craft is known to be high a survey of combatant craft crewmen reported that 65 of them had sustained at least one injury during service with the harsh craft s motion being the primary subject ensign et al 2000 consequently recent research has explored the use of acss in planing craft in order to improve the vessel s seakeeping this research has shown that a planing craft with an acs is capable of superior seakeeping compared to those without wang 1985 savitsky 2003 shimozono and kays 2011 engle et al 2011 rijkens 2013 in addition not only can an acs improve the seakeeping of a planing craft it can also stabilize it so that it can operate at its optimal lift to drag trim angle xi and sun 2006 all these promising results for incorporating acs into planing craft are with vessels that were designed sequentially i e the vessel geometry was first selected and then the acs was incorporated but because the vessel geometry and acs are coupled both affect the vessel s dynamics even better results are possible if both are co designed and the hardware control couplings are explored castro feliciano et al 2016 peters 2010 co design of vessel geometry and acs requires effective tools to facilitate optimization particularly the models that capture the sensitivity of key planing boat performance with respect to both geometry and acs parameters recent research in the hydrodynamic optimization of a planing craft ayob et al 2009 2010 estimated the seaway drag and seakeeping performance by using empirical equations savitsky and brown 1976 savitsky and koelbel 1993 as previously mentioned the model tests used fridsma 1971 did not have acs and therefore the empirical equations do not incorporate the effects of an acs consequently a time domain simulation program is required to estimate the seakeeping performance of a planing craft with an acs more specifically the problem of designing a planing craft with an acs is a multidisciplinary design optimization mdo problem one discipline is the controls engineering and the other is the naval architecture hydrodynamics of the vessel and acs s hardware aerospace is one of the most active fields in mdo a summary of some mdo techniques used in aerospace is documented in sobieszczanski sobieski and hafka 1997 it is easy to see how an mdo problem could be made as complex as the designer would want for example we could also include structure design into the problem definition therefore one of the challenges in mdo is choosing parameter spaces that have great influence on the design objectives while maintaining the optimization problem tractable in this paper we focus in exploring simplified definitions of the acs and vessel s geometry which are known to be influential in the seakeeping and lift to drag ratio and consider seakeeping and drag reduction as the primary design objectives 3 design methodology while the main objective of our research is to explore the optimal vessels obtained by sequential design and co design the approach taken is an exploratory one rather than numerical optimization this approach is taken for the following reasons 1 it allows us to investigate the seakeeping and drag behavior of the craft as we vary design parameters and 2 there is a guarantee that we will find the global minimums from the discretized design space the approach is further explained in section 3 2 and the modeling of the planing craft and acs is presented in section 3 1 3 1 modeling 3 1 1 craft geometry in order to simplify the vessel s hydrodynamics and isolate the key variables that influence the craft s behavior the body is prismatic and the bow shape follows that from the models tested by fridsma 1969 which have constant deadrise throughout the fixed vessel particulars can be seen in table 1 and a diagram of the vessel in fig 1 the vessel s geometry design variables considered in this work are β deadrise angle and l c g longitudinal center of gravity 3 1 2 acs the acs is modeled as two vertical body fixed point forces f 1 and f 2 in fig 1 with a horizontal body fixed drag penalty r 1 and r 2 in fig 1 proportional to the force magnitude a simplistic approach to simulate the acs s hardware s lift to drag ratio l d which is set to l d 10 the approximate l d of the tandem hydrofoil found in wetzel and schiebe 1960 while this approach leaves room for future improvement in terms of acs s hardware modeling and simulation the resultant forces could be instead analyzed to evaluate appropriate acs s hardware i e reverse engineering the required hardware two force locations are used in order to allow the acs to exert pure moments on the vessel the greater the distance between the forces the greater the pitch control authority the acs will have however a hydrofoil located far forward might have practical problems such as slamming in a seaway therefore as a design feature one force is located on the stern and the other was set to one third of the vessel length loa 3 illustrated in fig 1 note that the suitability of this location was not investigated the acs s controller is chosen as the linear quadratic regulator lqr designed using the linear model described in castro feliciano et al 2016 2 2 the linear model is largely based on faltinsen s work faltinsen 2005 which in turn uses savitsky s semi empirical equations savitsky 1964 with the difference that b the input matrix now contains the distance loa 3 instead of loa the controller minimizes the cost function 1 j u 0 η t q η u t r u d t where the r matrix is set as an identity matrix 2 2 the state variables are η η 3 η 5 η 3 η 5 t q is 2 q 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 q 44 where q 44 is a design parameter and u are the acs s forces f 1 and f 2 the weight on pitch velocity q 44 was selected as the design parameter because previous research wang 1985 suggests that seakeeping is sensitive to pitch velocity feedback the output from the lqr are the controller gains k ℝ 2 4 where u f 1 f 2 t kη note that in this work eq 1 is evaluated with the linearized model of a planing craft operating in calm water while lqr is a favorable controller for an optimization study it guarantees closed loop local stability allows for an arbitrary number of control inputs and limits the controller design variables to the lqr tuning parameters better performance might be possible with a nonlinear controller that takes into account the nonlinear dynamics of a planing craft therefore the appropriateness of using conventional lqr in planing craft needs further examination outside of the present work 3 1 3 simulated conditions in our previous study on co design of planing craft with acs castro feliciano et al 2016 where calm water drag was the sole optimized objective the largest drag reduction of co designing occurred at the highest simulated speed of c v 4 5 however the co designed vessel s seakeeping was the worst at this high speed since we are focusing on the possibility that the co designed vessels are significantly better both at seakeeping and drag the present work explores vessels operating in a seaway with a speed of v 45 kt c v 4 6 a speed we know the co designed vessels will excel at least in drag optimization castro feliciano et al 2016 and a common high speed for the investigated vessel size e g high speed patrol boats and rhibs two sea conditions are explored sea state ss 2 and 3 these are conditions typically encountered by vessels with particulars similar to those of table 1 the seaway is simulated by using the issc sea spectrum with 100 wave components the issc parameters used are shown in table 2 because the seas are stochastic the objective functions defined in sec 3 2 2 are a function of simulation time which should converge to a value as the simulation time goes to infinity a naive approach to selecting a simulation length would be to conduct the exploration with a simulation time of one hour as recommended by the ittc ittc 2002 for accurate statistics but in this paper we are interested in which vessels are better instead of what are the seakeeping statistics within a high confidence level one can see that these two questions have conflicting requirements in order to find the better vessels one would want to run as many different configurations as possible but on the other hand if we want accurate statistics we want to run the tests for as long as possible this kind of problem is known in the machine learning community as the exploration exploitation dilemma crepinsek et al 2013 heuristically speaking the approach taken in this paper follows the idea that if the vessels are tested with the same wave history there should be a finite simulation time that when comparing the results one can select the winner within some certainty calculating the confidence interval is non trivial because while the seaway has a well defined stochastic model the vessel s response is highly nonlinear savitsky and brown 1976 to avoid the issue of improper metric comparison between vessel simulations we simulated each design for 180 s with the same random seed number i e the wave time histories are identical for all runs this is akin to treating the results for the 180 s seaway as a metric similar to how the controls field uses standard responses to measure performance e g step response and impulse response the behavior of the objective functions defined in sec 3 2 2 with fixed deadrise and varying l c g and simulation times are seen in fig 2 this investigated case suggests that design variables that minimizes the objective space created by a simulation time of 180 s are close to the design variables that minimize the objective space for extended simulation times while this approach may not be ideal it is the most efficient given the available tools and design constraints 3 1 4 virtual test bed the simulations are performed in the time domain using the program powersea akers 1999 which is based on a strip theory approach with empirical wedge impact forces zarnickdavid 1979 since the hull s wave forces are estimated from the empirical wedge impact forces the acs s forces are uncoupled from any hull wave interaction because the research will require extensive simulations a strip theory approach is adequate since it is computationally fast powersea allows for script automation via component object model com interoperability the tuning parameters in powersea are empirical akers 2013 but they have a strong effect on the vessel s stability and operation behavior however some of the empirical correction parameters are meant to correct for varying deadrise and or beam specifically the geometric coefficients which the tested vessels do not have since they are prismatic powersea can automatically adjust these coefficients depending on the operating conditions but this procedure is itself active research and therefore fixed values were used as it was done in the original program zarnickdavid 1979 values used in this study are shown in table 3 the only value that differs from the default powersea and zarnickdavid 1979 values is the buoyancy lift coefficient zarnick zarnickdavid 1979 and the powersea documentation have a default of 0 5 for this coefficient however this value is originally quoted from shuford shuford 1958 where it indicates that 0 5 is a reasonable value for τ 8 but larger values are needed for τ 4 since we are interested in the optimal drag and seakeeping operating trim angles and those are known to be around 4 to 5 for drag savitsky 1964 and even lower for seakeeping savitsky and brown 1976 a value of 0 85 is used following the results in shuford 1958 3 2 exhaustive search approach in this investigation we are interested in both the seakeeping performance and drag therefore we have a multi objective problem the drag metric j 1 is simply the average seaway drag r t s i e j 1 r t s the seakeeping metric is j 2 d z t m 1 6 which is the vertical acceleration dose d z i a i z 6 1 6 presented in iso 2631 5 iso standard 2631 5 2004 divided by the period in seconds over which d z was measured to the 1 6 power t m 1 6 where a i z is the i th peak of the spine s vertical acceleration response to the vessel s vertical motion given by a recurrent neural network model from iso standard 2631 5 2004 and shown in b in the present work we took the conservative approach of using the bow motions to calculate the spine s response the units of d z are m s 2 and j 2 can be interpreted as the d z normalized to a one second exposure i e j 2 d z 1 sec t m 1 6 thus in this work j 2 will have m s 2 as units following this interpretation moreover j 2 could be extended to include the long term health effects following the procedure in iso standard 2631 5 2004 but this was not pursued in this work an excerpt of iso standard 2631 5 2004 can be found in b while a limitation of the d z metric is that it could over or under predict the effects of impact accelerations events larger than 4 g iso standard 2631 5 2004 its validity for the present work is demonstrated in sec 4 1 1 an important note is that while powersea is capable of estimating the seaway accelerations which are used for calculating d z and drag its accuracy is limited akers 1999 the strength in powersea or planing boat strip theory methods in general lies on capturing the general dynamics of the vessel operating in a seaway in a computationally efficient manner as a result powersea allows us to conduct an exhaustive search with the available computational resources keep in mind however that the results in this paper are more valuable in the relative comparisons and qualitative aspects rather than on the quantitative ones the design space consists of l c b b β log q 44 where l c g b and β are physical design parameters and q 44 is the control design parameter q 44 is the 4 4 element in the q matrix see sec 3 1 2 the use of log q 44 instead of q 44 is to facilitate the exploration of this metric s influence range which was found to extend approximately between 1 log q 44 7 in preliminary tests the l c g b range also comes from preliminary tests investigating the upper and lower values where the vessel failed to complete a seaway run and the β range is a practical range for a positive deadrise hull powersea cannot simulated negative deadrise hulls the design space was discretized following table 4 and an exhaustive search was performed in powersea parameter combinations in which the vessel never reached stable equilibrium in calm water or encountered excessive trim angles during the 180 s of simulation e g bow dived or lost stability were simply classified as failed runs and the partial data was unused the framework used to perform the exhaustive search is further explained in section 3 2 1 3 2 1 process framework the exhaustive search was automated by using powersea s and matlab s com interop with visual basic net vb net the process framework schematic for when the vessel is designed with an acs and when it is designed without an acs can be seen in fig 3 and fig 4 respectively when the vessel is designed with an acs the exhaustive search control module controls the test design variables which are passed to the vessel geometry and lqr design modules the vessel geometry module creates the vessel in powersea afterwards the stabilizing velocity feedback acs module is run which creates in powersea an acs with a heave and pitch velocity feedback high gain controller velocity in stabilizing velocity feedback acs refers to the heave and pitch velocity not vessel speed not to be confused with the lqr controller used in the seaway simulation the stabilizing velocity feedback acs is only used to find the vessel s calm water equilibrium it is truly only required for when the vessel is open loop unstable the velocity feedback acs shown in eq 3 has no drag and the forces create a couple on the vessel 3 f 1 5 10 4 7 10 6 η 3 η 5 f 2 f 1 since the velocity feedback acs has only feedback on the state velocities the vessel should reach its unforced equilibrium f 1 f 2 0 as η 3 η 5 0 regardless of η 3 η 5 stability by this controller is not guaranteed and the gains come from tuning a badly porpoising vessel β 2 and l c g b 0 10 so that it has a settling time during closed loop operation of roughly 20 s 3 3 the velocity feedback acs step could be made more sophisticated by tuning the controller for each test case however the controller presented turns out to be sufficiently robust to avoid the added complexity and subsequently required exception handling next the vessel is run in calm water until it reaches equilibrium if it does not reach equilibrium the run is classified as a fail and the process ends and the steady calm water running attitude is set as the initial conditions for the seaway simulation and also passed to the controller design module the controller design module calls the matlab script linear model estimation whose equations are shown in castro feliciano et al 2016 where a state space model is created and passed to the lqr design matlab script the lqr design module takes the state space model and the lqr parameters as described in section 3 1 2 and uses matlab s lqr function to calculate the controller s gains mathworks online document 2016 the controller gains are then passed to the acs incorporation module where it then replaces the stabilizing velocity feedback acs with the acs described in section 3 1 2 afterwards the seaway run module is run which passes the seaway parameters mentioned in section 3 1 3 and simulates the vessel in powersea the results from the seaway simulation are then processed to obtain the performance metrics average seaway drag and d z t m 1 6 the whole process is then repeated for the next point in the design and control space when the vessel is designed with no acs the process will not have any of the acs related steps as illustrated in fig 4 since the vessel without acs needs to be open loop stable the results from the calm water run are used to check for stability if the vessel is not stable the test case is skipped the vessel is not simulated in a seaway if it is stable the process continues with the modules having the same function as previously described 3 2 2 pareto fronts the optimization problem formulations for the vessels following co design and sequential design approaches are given in table 5 and table 6 respectively the objective functions are defined as j 1 r t s average seaway drag and j 2 d z t m 1 6 seakeeping metric in both design approaches while x l c g b β l o g q 44 is the optimizing variables for the co design problem and x ˆ l c g b β and x ˇ l o g q 44 are the optimizing variables for the sequential design in step 1 and 2 respectively δ τ c is the peak to peak amplitude of the calm water trim angle i e unacceptable porpoising is considered to be δ τ c 0 5 in a multi objective optimization usually there is no unique optimum that optimizes both objectives instead a family of optimal solutions that represents the trade off among competing objectives can be obtained this family of optimal solutions is called the pareto set or pareto frontier we call a design pareto optimal part of the pareto set if its performance in one objective cannot be improved without degrading the performance on another objective the general approach to estimating the pareto front from a series of runs is to find the non dominated nd designs however because it is easier to check for dominance a simple approach is to first find all the designs that are dominated and then remove them leaving only the designs that were not dominated nd designs design x 1 is said to weakly dominate x 2 if i all objectives achieved by x 1 are no worse than those achieved by x 2 and ii at least one objective at x 1 is strictly better than the corresponding objective at x 2 4 results and discussion the naming convention used throughout this section is as follows the pareto fronts are co design olu pareto optimal vessels that are open loop unstable and have acs co design ols pareto optimal vessels that are open loop stable and have acs sequential 1 w o acs pareto optimal vessels that are open loop stable but without acs in addition the performance of the pareto fronts are named co design ols w o acs pareto optimal designs of co design ols when acs is removed sequential 2 w acs pareto optimal designs of sequential 1 w o acs with optimized acs the raw results alongside their constructed pareto fronts are shown in a even though the results are presented in non dimensional form caution must be taken when applying these results to vessels which have different properties from those fixed in this study this includes the fact that the acs used in this work was two point forces at specific locations 4 1 pareto optimality in both tested sea states the pareto optimal vessels co designed with acs and allowed to be open loop unstable co design olu dominate all other pareto optimal designs see fig 5 i e there is a design in co design olu which outperforms both in seakeeping and drag any other possible design in the other classes if the sequential 1 w o acs vessels are then modified to have an acs which is optimized to perform well in seakeeping we can see that the designs sequential 2 w acs are in general not the pareto optimal designs obtained by co designing both an open loop stable vessel and its acs co design ols see fig 6 moreover a designer following the sequential design would quickly discard the vessels that have the best performance with an acs since as fig 7 shows the performance of the co design ols w o acs vessels have in general a considerably inferior performance when compared to the sequential 1 w o acs vessels 4 1 1 seakeeping metric validity before proceeding with the results discussion note in fig 8 that the exhaustive search results have in general a distinct upper bound to the average bow impact acceleration for a selected d z t m 1 6 e g for ss 2 a run with d z t m 1 6 20 m s2 has an average bow impact acceleration of 10 g thus the probability of an impact a exceeding 4 g the upper limit where d z is applicable is p a 4 e 4 a assuming an exponential distribution as suggested by fridsma 1971 where a is the average peak acceleration in g s considering that the upper d z t m 1 6 values of practical interest are around 20 and 50 for ss 2 and ss 3 see fig 5 accordingly the average peak accelerations upper bounds in ss 2 and ss 3 are around 1 g and 2 g see fig 8 respectively the probabilities of an impact exceeding 4 g at these upper bounds are p a 4 a 1 2 and p a 4 a 2 14 for ss 2 and ss 3 considering the low probabilities of encountering impacts larger than 4 g on the upper bounds of the regions of interest the use of d z as a seakeeping metric is reasonable 4 1 2 performance evaluation we can see from figs 5 and 6 that considerable improvement can be made if one follows the co design methodology instead of the sequential and this improvement is at its greatest when the stability constraint is relaxed and the vessels are allowed to be open loop unstable some example changes in performance from the pareto optimal sequential 2 w acs vessels to the vessels in co design olu and co design ols are shown in table 7 and table 8 these results were found by linear interpolation within the pareto fronts in short for the tested speed coefficient and sea state conditions the co designed vessels outperformed the sequentially designed vessels in both seakeeping and drag by considerable margins for essentially all combinations of seaway drag or seakeeping constraints 4 2 optimal design parameters the geometry design variables of the ss 2 pareto fronts designs are plotted in fig 9 a and for ss 3 in fig 9b the results show that in general when there is an ols constraint the pareto optimal designs are as close to being olu as possible however the designs obtained by the sequential optimization tell a different story in ss 2 the designs try to keep the lowest running trim angle as expected from traditional vessel design by having the lcg as far forward as possible see fig 9a while in ss 3 the optimal sequential vessels appear to be those that are around the middle of the ols l c g b range which is likely due to the fact that the vessel has a finite length therefore making very low trim angles in a bad seaway dangerous for bow diving 4 4 while powersea does not model the hydrodynamic forces caused by bow diving it does estimate the hydrostatic forces at all times including bow diving events 4 3 effect of average seaway trim fig 10 a and fig 10b show how r t s and d z change with respect to the average seaway trim angle which is changed by l c g b as illustrated in fig 10c the deadrise is fixed and the controller variable that minimizes the seakeeping metric is selected for each point the r t s results show that the seaway transport efficiency 5 5 seaway transport efficiency refers here to the required energy to move the vessel a certain distance at a certain high speed in a seaway is improved as the vessel is allowed to be open loop unstable which supports the preliminary results presented in castro feliciano et al 2016 a surprising result is that the seakeeping does not necessarily worsen monotonically with increasing trim angle as the example in fig 10b shows this goes against what it is commonly known from past research of vessels without acs savitsky and brown 1976 and the fundamental reasons of why this behavior occurs when an acs is present are unknown however since the co designed vessel can go towards higher trim angles to improve both the seakeeping and transport efficiency it is comprehensible how the co designed vessels outperform the traditionally designed vessels in these two metrics 4 4 general design observations when designing a planing craft which will have an acs the designer should keep in mind the following observations the overall optimal vessels are not obtained by following a sequential design for the vessels investigated the co design ols vessels are on the edge of being olu indicating that the ols constraint is active having an acs might create optimal seakeeping trim angles which goes against the common rule of thumb that a planing craft s seakeeping will improve monotonically as the trim angle is reduced an observation generally obtained for vessels without acs 5 conclusion design optimization of a planing hull in both geometry space and control space is explored in this paper through a case study the results show a clear advantage of co designing a planing craft with acs over the traditional approach of sequentially designing one then followed by another co designed vessels show superior seakeeping and efficiency over the sequentially designed vessels moreover the co designed pareto optimal vessels are not the sequentially designed pareto optimal vessels even when the co designed vessels are restricted to be ols in addition the vessels obtained by sequential design have limited synergy with their acs when compared to the co designed vessels this investigation supports the hypothesis that because the acs affects the relationship between seakeeping and the vessel s geometry the conventional empirically based seakeeping guidelines are not appropriate for vessels with acs nonetheless if a planing boat is expected to have an acs it is best if it is co designed with the vessel s geometry in order to exploit the synergy between them to the best of the authors knowledge co designing a planing craft and its acs has never been performed in practice thus the proposed framework offers an opportunity of designing planing craft that are more efficient and have better seakeeping than conventionally designed planing craft 5 1 recommended future work since planing craft design is heavily influenced by empirical guidelines the addition of acs to the design renews many of the early and ongoing research questions in high speed vessel design in general the renewed research questions could be summarized as what are the effects of the design variables on the transport efficiency seakeeping maneuverability and seaway impact forces this work attempts to shed some light to the transport efficiency and seakeeping aspects of co design and following this path future work should focus on developing optimization techniques to find the pareto front more efficiently in order to expand the number of geometry and acs optimization variables e g optimizing b and additional lqr tuning parameters moreover while considering a rudder controller when estimating a vessel s maneuverability is done practice faltinsen 2005 to the best of the authors knowledge a co design investigation of a vessel s geometry and acs has not been documented in literature allowing a planing craft to be directionally olu might result in super maneuverable vessels in parallel the insights gained from the optimal co design can be explored to develop design procedures and guidelines for the high speed planing hull for example since the required l c g of the co designed vessels is far aft future work can include a case study investigating the feasibility of developing functional co designed vessels a valid question that is not answered in this paper is if these results are simply an artifact of the modeling techniques therefore higher fidelity modeling could be used in the case study to increase the confidence in the performance enhancement of the co designed vessels moreover planing crafts have nonlinear dynamics that an lqr is naive to future research will need to explore nonlinear controllers to further exploit the co design framework acknowledgments this work was supported by naval engineering education consortium neec and by onr n00014 11 1 0831 and n00014 11 1 0832 program director ms kelly cooper the authors are also appreciative of the significant help provided by mr richard akers at main marine composites in assisting with powersea simulations appendix a results scatter plots with pareto fronts please see fig 11 fig 11 scatter plot of raw results with the resulting pareto fronts fig 11 appendix b iso 2631 5 excerpt this appendix is meant to succinctly illustrate the iso standard 2631 5 2004 metrics as used in this work for a complete description of the equations presented and thorough instructions the reader is referred to the original work iso standard 2631 5 2004 the symbols and subscripts used throughout this appendix are shown in table 9 table 9 symbols and subscripts from iso standard 2631 5 2004 table 9 symbols subscripts r 1 2 l 3 4 a acceleration d daily as in duration of daily exposure t d a peak acceleration e equivalent as in equivalent static compressive stress s e δ constant i j counter d acceleration dose k counter x y or z f frequency l lumbar m dose coefficient m measured as in measured period t m r factor n natural as in natural frequency f n s displacement v vessel s compressive stress u ultimate as in ultimate stress s u t time x y z reference axis u model acceleration term w w model coefficients ζ critical damping ratio ω angular frequency b 1 spinal response and exposure metric the x y and z directions correspond to the longitudinal transverse and vertical axes with the positive directions forward left port and up assume the vessel s accelerations a v k are measured with a sampling frequency of f k where k x y or z the x and y direction sampling rate should be appropriate to the analysis of an 80 hz signal and the z direction a sampling rate that is a multiple of 160 samples per second is recommended iso standard 2631 5 2004 appendix b 1 1 spinal response in horizontal directions k x y iso standard 2631 5 2004 uses a linear model represented by a single degree of freedom sdof lumped parameter model with natural frequency ω n 13 35 s 1 and critical damping ratio ζ 0 22 therefore using a 1 d filter we can estimate the lumbar response by using the rational transfer function a l k z b 0 b 1 z 1 b 2 z 2 c 0 c 1 z 1 c 2 z 2 a v k z where a l k z and a v k z are the z transform of the lumbar and vessel accelerations and b 1 sin β β e α 2 sin β β e α cos β e 2 α sin β β e α c 1 2 cos β e α e 2 α α ω n 2 q f k β ω n f k 1 1 2 q 2 q 1 2 ζ in matlab a l k can be calculated with a l k t f i l t e r b c a v k t appendix b 1 2 spinal response in the vertical direction k z iso standard 2631 5 2004 uses a recurrent neural network to represent the spinal vertical response the lumbar spine vertical acceleration a l z is predicted in m s2 using eq b 4 and eq b 5 along with tables 10 and 11 b 4 a l z t j 1 7 w j u j t w 8 b 5 u j t tanh i 1 4 w j i a l z t i i 5 12 w j i a v z t i 4 w j 13 table 10 z axis model coefficients for eq b 4 from iso standard 2631 5 2004 table 10 w 1 w 2 w 3 w 4 57 96539 52 32773 49 78227 53 16885 w 5 w 6 w 7 w 8 56 02619 27 79550 72 34446 21 51959 table 11 z axis model coefficients for eq b 5 from iso standard 2631 5 2004 table 11 j 1 2 3 4 5 6 7 w j 1 0 00130 0 01841 0 00336 0 01471 0 00174 0 00137 0 00145 w j 2 0 00646 0 00565 0 00539 0 01544 0 00542 0 00381 0 00497 w j 3 0 00091 0 02073 0 00708 0 00091 0 00255 0 00216 0 01001 w j 4 0 00898 0 02626 0 00438 0 00595 0 00774 0 00034 0 01283 w j 5 0 00201 0 00579 0 00330 0 00065 0 00459 0 00417 0 00468 w j 6 0 00158 0 00859 0 00166 0 00490 0 00546 0 00057 0 00797 w j 7 0 00361 0 00490 0 00452 0 00079 0 00604 0 00638 0 00529 w j 8 0 00167 0 00098 0 00743 0 00795 0 01095 0 00627 0 00341 w j 9 0 00078 0 00261 0 00771 0 00600 0 00908 0 00504 0 00135 w j 10 0 00405 0 00210 0 00520 0 00176 0 00465 0 00198 0 00451 w j 11 0 00563 0 00218 0 00105 0 00195 0 00296 0 00190 0 00306 w j 12 0 00372 0 00037 0 00045 0 00197 0 00289 0 00448 0 00216 w j 13 0 31088 0 95883 0 67105 0 14423 0 04063 0 07029 1 03300 the range of applicability for the z axis lumbar acceleration model is 20 m s2 to 40 m s2 and 0 5 hz 40 hz iso standard 2631 5 2004 appendix b 1 3 calculation of the acceleration dose iso standard 2631 5 2004 defines the acceleration dose d k in m s2 as shown in eq b 6 b 6 d k i a i k 6 1 6 where a i k is the i th peak of the response acceleration a l k t and k x y or z from iso standard 2631 5 2004 a peak is defined here as the maximum absolute value of the response acceleration between two consecutive zero crossings for the x and y directions peaks in positive and negative directions shall be counted for the z direction only positive peaks shall be counted compression of the spine is the primary interest for exposure severity the average daily dose d k d in m s2 a person will be exposed to is calculated with eq b 7 b 7 d k d d k t d t m 1 6 where t d is the duration of the daily exposure t m is the period over which d k has been measured d k d can be used for health assessments as presented in section b 2 iso standard 2631 5 2004 iso standard 2631 5 2004 also includes the possibility of calculating d k d when the daily vibration exposure consists of multiple n periods of different magnitudes by using eq b 8 b 8 d k d j 1 n d k j 6 t d j t m j 1 6 where t d j is the duration of the daily exposure to condition j and t m j is the period over which d k j has been measured while this study used eq b 7 eq b 8 would be relevant if the reader desires to do scenario based optimizations e g the vessel operates daily for 1 h at ss 1 2 h at ss 2 and 1 h at ss 3 appendix b 2 assessment of health effects from iso standard 2631 5 2004 by use of a biomechanical model based on experimental data it has been shown that there is a linear relationship between the part of compressive stress that is due to the input shocks and the peak acceleration response in the spine the first step for assessing health effects is to calculate the daily equivalent static compression dose s e in mpa b 9 s ed k x y z m k d k d 6 1 6 where the recommended values of m x m y and m z are 0 015 0 035 and 0 032 mpa m s2 accordingly iso standard 2631 5 2004 afterwards the factor r is used to assess adverse health effects related to the human response acceleration dose iso standard 2631 5 2004 and is defined as b 10 r i 1 n s ed n 1 6 s u i δ 6 1 6 where n is the number of exposure days per year i is the year counter n is the number of years of exposure δ is a constant representing the static stress due to gravitational force s u i is the ultimate strength of the lumber spine for a person of age b i years and b is the age at which the exposure starts following iso standard 2631 5 2004 δ 0 25 mpa can be used for a driving posture and s u i 6 75 0 066 b i from iso standard 2631 5 2004 there is a significant human variability and r 0 8 indicates a low probability of an adverse health effect r 1 2 indicates a high probability of an adverse health effect 
23596,the tip leakage vortex tlv cavitation is investigated by a commercial reynolds averaged navier stokes rans solver a referenced test on a naca0009 hydrofoil is used to validate the numerical simulation considering the local rotation characteristics of the vortical flow a rotation curvature corrected shear stress transport model sst cc model is applied to simulate the time averaged turbulent flow compared to the original sst model the sst cc model improves the prediction of the velocity in tlv on the measured sections in downstream and the vorticity and pressure features along the tlv trajectory are analysed numerically in order to increase the prediction accuracy for the tlv cavitation the empirical condensation coefficient f c in zwart s cavitation model is calibrated based on the referenced experiment by introducing a vortex identification parameter f related to the strain rate tensor and the vorticity tensor a relationship between the f c and f is built and the effects of the rotational motion of the vortex on the cavity are embodied in a modified zwart s cavitation model compared to the conventional zwart s cavitation model the modified cavitation model significantly improves the prediction of the tlv cavitation and gets a better agreement with the referenced test on different conditions with various gap widths keywords tip leakage vortex cavitation eddy viscosity model rotation curvature correction 1 introduction the rotor tip clearance is inevitable in many axial flow hydraulic machineries such as the kaplan and bulb turbines axial pumps and shrouded propulsors the tip clearance can result in the leakage flow and the formation of vortices among various vortices the tip leakage vortex tlv has the highest total pressure drop and the highest total pressure loss xiao et al 2001 and the resulting vortex cavitation raises much concerns such as the severe erosion near the blade tip the performance deterioration unit vibration and the acoustic noise laborde et al 1997 avellan 2004 the cavitating tlv draws much attention for a long time but this flow is complex and not well understood until recently liu et al 2015 luo et al 2016 the confused physics involved in vortex cavitation is that the cavitation is not only induced in vortical structures but is also a source of vorticity arndt 2002 most of the new advances rely on the application of new experimental techniques and the development of computational tools tan et al 2015 used a transparent acrylic rotor allowing uninhibited visual access to the cavitation phenomena in an axial waterjet pump the interactions between the tlv and the cloud cavitation were investigated by high speed imaging particle imaging velocimetry piv is usually used to examine the vortical flows with cavitation suppressed the rollup process of the tlv was identified by wu et al 2011 but multiple interlaced vortical structures in rotor disturbed the tlv and increased the flow variability oweis and ceccio 2005 an in depth study on the primary tlv is usually by means of a hydrofoil for example gopalan et al 2002 measured the velocity and thus vorticity and circulation of tlv in several planes and dreyer et al 2014 adopted the stereo piv to investigate the 3d flow fields in these experiments the cavitation phenomenon is a way of showing the tlv trajectory but the internal flow test on the cavitation condition is relatively difficult the computational fluid dynamics cfd is helpful to explore more extensive characteristics of the cavitating vortex a commercial reynolds averaged navier stokes rans solver in conjunction with a turbulence model and a cavitation model is generally adopted for engineering practice but the simulation results usually have a much shorter or smaller cavitation region than the experimental observations for different kinds of vortex cavitation decaix et al 2015a wang et al 2014 zhou et al 2017 in order to improve the predictions most efforts have been done to develop the calculation models the eddy viscosity turbulence model is a particularly important way to simulate the turbulent flow currently the most prominent model is the k ω based shear stress transport sst model menter 1994 which could capture the global features of the tlv in much previous examples kato et al 2011 decaix et al 2015b guo et al 2016 smirnov and menter 2009 put a rotation curvature correction cc term into the original sst model to form a sst cc model it could increase the prediction accuracy for the non cavitating vortex evolution smirnov and menter 2009 arolla and durbin 2014 but its application on the cavitating tlv is not clear the cavitation model is another key factor affecting the prediction of vortex cavitation in the eulerian eulerian multiphase flow field the mass transfer models proposed by various authors such as kunz et al 2000 singhal et al 2002 zwart et al 2004 and so on have demonstrated their capabilities to reproduce the main features of cavitating flows for decades frikha et al 2009 these cavitation models share the common feature of employing empirical coefficients which are determined through numerical experimental results and are adjusted for different geometries and different flow conditions according to calibrating the coefficient values a larger resemblance can be observed among most cavitation models the effects of the coefficient from three models kunz et al 2000 singhal et al 2002 zwart et al 2004 on the computed results of the cavitating tip vortex in propellers have been analysed morgut and nobile 2012 and it reveals that further improvement on the simulated cavity extension is needed in consideration of the cavitation vortex interactions zhao et al 2016 have built a relationship between the cavitation bubble radius and vortex effects based on the zwart s cavitation model and the predictive ability of a new vortex cavitation model has been verified the above researches have achieved a certain positive effect respectively but a comprehensive evaluation for the effects of both turbulence model and cavitation model is not enough on the complicated tlv flow and cavitation the aim of this study is to evaluate the calculation models for simulating the tlv and its cavitation a referenced hydrofoil test in the single phase flow and the multiphase flow is used to validate the simulated results numerical setups are shown in section 2 in section 3 the non cavitating vortex flow is analysed by the sst cc turbulence model whose influence on predicting the cavitating tlv is analysed in section 4 in the multiphase flow the empirical coefficient in zwart s cavitation model is calibrated based on the vortex intensity and a modified cavitation model is established finally the conclusions are summarized in section 5 2 numerical setups 2 1 governing equations a commercial cfd code of ansys cfx ansys cfx 2011 is used in present work with a rans solver in the following steady state equations the bar is dropped for averaged quantities except for products of fluctuating quantities 1 ρ t x j ρ u j 0 2 t ρ u i x j ρ u i u j p x i x j μ u i x j ρ u i u j s m where u i i u v w is the velocity x i i x y z is the position t is the time p is the pressure μ is the dynamic viscosity s m is the external momentum source term the reynolds stresses ρ u i u j can be modified by a turbulence model for the multiphase flow the homogeneous one fluid model allows some simplifications with an assumption that the transported quantities are the same for all phases except for the volume fraction α the ρ is defined as the density of mixture with the following definition 3 ρ α v ρ v α l ρ l where the subscripts v and l represent the vapor and liquid phases respectively 2 2 computational domain and mesh validation referring to dreyer et al s experiment dreyer 2015 a naca0009 hydrofoil had the truncated chord c of 100 mm and its maximum thickness h was 9 9 mm which was tested in a water tunnel with a 150 mm wide cross section and 750 mm length there was a gap between the foil tip and the tunnel lateral wall and the cavity extension is different with various gap widths a non dimensional parameter τ was defined as the ratio of the absolute gap width and the foil thickness and two typical conditions with τ 0 2 and τ 1 are discussed here with different cavity extension the computational domain with boundary conditions is shown in fig 1 the inlet which is located in the upstream with about 2c distance to the foil leading edge has a velocity of v in 10 m s with low turbulence intensity below 1 the outlet has a static pressure to maintain the inlet pressure p in near 1 bar no slip walls are at the other boundaries and the foil incidence angle is 10 a structured hexahedral mesh is generated in the computational domain with fig 2 showing the local mesh near the foil tip based on the richardson extrapolation method which is currently the most reliable method available for the prediction of numerical uncertainty a grid convergence index gci fine 21 is used to validate the mesh resolution celik et al 2008 the detailed process for mesh validation has been finished in our previous work guo et al 2016 the pressure coefficient c p p p in 0 5ρv in 2 in the tlv core is chosen as a key variable when the convergence index gci fine 21 for c p is within 5 the total number of mesh cells about 4 4 million is used the averaged y is 20 and 60 for the maximum on the foil surface and both sides of the gap in the simulation the high resolution scheme is used for the advection scheme and convergence is specified as rms residuals of 10 5 3 simulation of the non cavitating tlv flow 3 1 rotation curvature correction for the eddy viscosity model the gradient diffusion hypothesis is frequently used in numerical simulations of turbulent flows involving transport equations the eddy viscosity turbulence models use this hypothesis to relate the reynolds stresses to the mean velocity gradients and the eddy viscosity μ t the μ t can be linked to the turbulence kinetic energy k and turbulent frequency ω via this relation 4 μ t ρ k ω and then many k ω models are formed the k ω sst shear stress transport model of menter 1994 accounts for the transport of the turbulent shear stress and gives highly accurate predictions of the onset and the amount of flow separation under adverse pressure gradients one of the weaknesses of eddy viscosity models is that they are not capable of capturing the rotational motion and streamline curvature which play a important role in the vortical flows the sst model modifed with a rotation curvature correction cc was presented by smirnov and menter 2009 by using a multiplier f r1 to control the production terms the first term on the right hand side of the equation in original k and ω transport equations 5 ρ k t ρ u j k x j p k f r 1 β ρ k ω x j μ e f k x j 6 ρ ω t ρ u j ω x j α ρ p k μ t f r 1 d ω c d ω x j μ e f ω x j the f r1 is slightly modified from the empirical function f rotation suggested by spalart and shur 1997 for sensitization of the one equation spalart allmaras turbulence model to the effects of streamline curvature and system rotation with the following expressions 7 f rotation 1 c r 1 2 r 1 r 1 c r 3 tan 1 c r 2 r c r 1 8 f r 1 max min f rotation 1 25 0 0 except for a couple of constants of c r1 1 0 c r2 2 0 and c r3 1 0 the variables r and r are related to the strain rate tensor s and vorticity tensor ω 9 r s ω 10 r 2 ω i k s j k d s i j d t ε i m n s j n ε j m n s i n ω m r o t 1 ω d 3 this rotation curvature correction cc is available for sst model in ansys cfx software and the calculation results from the sst cc and the original sst turbulence models will be compared in present simulation 3 2 effects of the rotation curvature correction on non cavitating tlv on the cavitation free conditions the downstream velocity field around the tlv was measured in the referenced test dreyer 2015 take the downstream plane of z c 1 for example fig 3 shows the contours of the streamwise velocity along z axial direction v z from the numerical simulations with sst and sst cc models compared with the test data overall both the simulations reflect the general features in the velocity distribution not only including the wake like or jet like profiles in the tlv region but also involving the effects of the wall boundary left hand side of the figure and the foil suction side on the velocity field the main difference between the simulations with two models is on the vortex core region where the wake like or jet like nature of the streamwise velocity is determined by the tlv intensity under the two different gap widths the sst cc model gets a lower v z at τ 0 2 and a higher v z at τ 1 within tlv compared to the sst model and the results from sst cc model agree well with the test figure in order to further validate the simulations quantitatively fig 4 demonstrates the velocity magnitude along a horizontal line as shown in fig 3 through the vortex center the value of v z is normalized by the inflow velocity v in 10 m s in the vertical coordinates compared with the referenced test data the sst model underestimates the velocity change inside the tlv core region and the sst cc model increases the velocity gradient within tlv and gets an improvement for the predictions the difference between the two models can be explained by fig 5 with showing the distribution of the eddy viscosity μ t at one condition of τ 1 it can be found that the sst cc model results in a strong suppression of the μ t in tlv region and a fast decay of the core velocity is avoided limited by the experimental devices only the downstream vortex flow features are available during the test the numerical simulation provides a great convenience to reveal the vortex features along the tlv trajectory such as the simulation results in fig 5 in general the vortex center can be determined by the maximum vorticity criterion in order to fully reveal the tlv features fig 6 shows the variation of some flow parameters along tlv trajectory including the velocity vorticity and pressure information the streamwise velocity and pressure at tlv center are normalized by the inflow conditions and a non dimensional vorticity coefficient c ω is defined as 11 c ω ω z v in c where ω z is the streamwise vorticity at the tlv center and c is the foil chord of 0 1 m in fig 6 the curves can be roughly divided into two zones along the abscissa the one zone i is within 0 5 z c 0 5 corresponding to the range from foil leading edge to the trailing edge and the other zone ii is in the downstream region of z c 0 5 fig 6 a shows that the wake like velocity feature at τ 0 2 is prominent in zone ii with an obvious difference between the two model results the effects of the rotation curvature correction cc is almost not working in zone i at τ 1 the curves with v z v in 1 represent the jet like profile and the role of the sst cc model is reflected with the development of tlv in fig 6 b and c the differences from the sst cc and sst models are not obvious for the smaller gap of τ 0 2 but the sst cc model significantly increases the c ω and decreases the c p for the larger gap of τ 1 as the vorticity is related to the vortex intensity the higher value of c ω from sst cc model means the tlv will last to far downstream with a wider gap this can be explained by the spatial form of tlv displayed in fig 7 the vortex can be identified by many methods zhang et al 2018 based on the strain rate tensor s and vorticity tensor ω a symmetric tensor s 2 ω 2 has real eigenvalues only if λ 1 λ 2 and λ 3 are eigenvalues and λ 1 λ 2 λ 3 jeong and hussain 1995 used the λ 2 0 to define the vortex core and provided the λ 2 criterion some common used vortex identification methods have been compared in present simulation and the λ 2 criterion can accurately identify the tlv core with an intuitively clear geometry the value of λ 2 determines the vortex region size and a specific value can be used for comparison like in fig 7 using a iso surface a surface of constant value for a specified variable of λ 2 7 106 s 2 to display the tlv region it shows that the streamwise length of tlv is much longer from sst cc model than the sst model at τ 1 under the same vortex identification criterion the tlv region is short at τ 1 and there is no significant difference between the two models as the vortical motion leads to a local pressure minimum the increased vorticity is corresponding to a pressure drop in fig 6 c in addition a lower c p in sst cc model will influence the cavitation region with a wider gap 4 simulation of the cavitating tlv flow 4 1 numerical method to solve the cavitating flow cavitation refers to the process by which vapor forms in a low pressure regions of a liquid flow for cavitating flow the homogeneous multiphase model in eulerian eulerian scheme is typically used because the vapor velocity field is often assumed to be the same as that of the liquid based on the mass conservation equation 1 the liquid vapor mass transfer in cavitation can be governed by the vapor transport equation 12 t α v ρ v x j α v ρ v u v j m e m c where the m e and m c are the mass transfer source terms connected to the growth and collapse of the vapor bubbles respectively the rayleigh plesset equation provides the basis for the rate equation controlling vapor generation and condensation and a simplified expression describing the growth of a bubble in a liquid is shown as 13 d r b d t 2 3 p v p ρ l where r b represents the bubble radius p v is the pressure in the bubble assumed to be the vapor pressure at the liquid temperature and p is the pressure in the liquid surrounding the bubble based on the simplified rayleigh plesset equation zwart et al 2004 derived the total interphase mass transfer rate due to cavitation per unit volume the final form of the zwart s cavitation model is 14 m e f e 3 α n u c 1 α v ρ v r b 2 3 p v p ρ l if p p v 15 m c f c 3 α v ρ v r b 2 3 p p v ρ l if p p v the following model parameters have found to work well for a variety of fluids and devices r b 1 10 6m α nuc 5 10 4 f e 50 and f c 0 01 with the increasing of the demand for the prediction accuracy more and more researches have done to calibrate the model parameters for different types of cavitation the effects of the model coefficient on the tlv cavitation will be discussed in section 4 3 and 4 4 4 2 application of the sst cc model to cavitating tlv simulation the cavitation is a convenient way to visualize the tlv as shown in fig 8 a the mean tlv trajectory is shown by the superposition of the snapshots during 11 ms the yellow marks represent the position of tlv on the downstream planes of z c 1 and z c 1 2 using the zwart s cavitation model the volume fraction for each phase in cavitating tlv can be calculated and the cavitation area can be illustrated by a low pressure p region or a region with a specific value of vapor volume fraction the 10 volume fraction α v is quite reasonable in most cases fig 8 b and c use the iso surface of α v 0 1 to show the simulated cavitation area based on the improvement of the sst cc model on predicting the non cavitating tlv a comparison for the cavitating tlv simulation is carried out between the sst cc and sst models as revealed in the test the cavitating tlv region is short with a narrow gap on the condition of τ 0 2 the predicted tlv cavitation from both turbulence models is similar with the test image the cavitation inside the gap due to the boundary layer separation is also replicated by the simulations for the larger gap condition of τ 1 the cavitating tlv develops to the far downstream compared with the test image the simulated tlv cavitation region is much shorter especially with the sst turbulence model the sst cc model can capture the cavitation in further downstream until the position of z c 1 1 this is because the sst cc model has reduced the pressure at tlv center as shown in fig 6 c overall the sst cc model could get more reasonable predictions for tlv flow both on non cavitating and cavitating conditions meanwhile the effects of sst cc model is more dramatic with a wider gap like τ 1 in present simulation so the vortex features affected by the gap width are worthy of attention in the study of the vortex cavitation 4 3 effect of cavitation model coefficient on tlv cavitation after the confirmation of the sst cc turbulence model the effects of the cavitation model on predicting the tlv cavitation will be discussed in this section as shown in fig 8 the simulated cavitation region with the improved turbulence model is still shorter than the test image in fact the original movies from the test illustrated that the cavitating tlv at least extended to the downstream position of z c 1 8 at τ 1 shown in fig 15 researches have shown that the empirical coefficients in cavitation models are determined by different flow conditions and the resemblance among any models could be achieved by adjusting the coefficients using zwart s cavitation model the appropriate coefficients for the tlv cavitation are investigated in present work based on other cavitation examples zwart et al 2004 morgut and nobile 2012 liu et al 2014 the optimal phase change coefficients in cavitation models were adjusted within the hundredth and hundredfold of the default values f e 50 and f c 0 01 according to a series of simulations for the present tlv cavitation case with different f e and f c it is found that the evaporation coefficient f e has small effect on the cavitation region and a lower condensation coefficient f c can effectively extend the cavitating tlv a reduction factor c fc is used as a multiplier c fc f c to control the decreasing degree of f c and three simulation results are shown in fig 9 the tlv cavitation develops to further downstream keeping its original trajectory with the decrease of f c it is due to a lower condensation coefficient leading to the reduction of the mass transport from vapor to liquid as described in equation 15 in consideration of the mechanism in vortex cavitation the angular momentum in vortical flow could delay the collapse of cavities and the influence of the vortex motion on the cavitation can be reflected by controlling the condensation process the scheme iii with c fc 0 01 extends the cavitating tlv to the downstream position near z c 1 86 at τ 1 which is similar to the test phenomenon in fig 15 but meanwhile the cavitating tlv is over predicted with too long cavitation region at τ 0 2 in addition some extra unreal cavitation region is introduced with the decreasing of f c it follows that the cavitation model should be adjusted concentrated in the vortex region and based on the vortex intensity with different gap widths 4 4 modification of the cavitation model based on the vortex identification the vortex can be identified by many methods zhang et al 2018 such as the swirling strength the helicity the q criterion and the λ 2 criterion used in present simulation in section 3 2 however most the vortex identification methods are sensitive to the chosen values for the vortex analysis and the captured vortex structure changes with the values of criteria in order to seek a suitable method to identify the tlv region a dimensionless function from the rotation curvature correction method attracts our attention that is the empirical function f rotation in equation 7 take two positions of z c 0 and z c 1 for example fig 10 shows the distribution of f rotation within 0 1 on the two planes with different gap widths the regions marked by the dashed circle is near the tlv it can be seen that the vortex region with highly helicity has a local low value for f rotation and the vortex center nearly satisfies the condition of f rotation 0 the lower f rotation reduces the eddy viscosity in tlv and has improved the prediction of the turbulence flow field in fig 10 the f rotation close to 0 is a roughly criterion to identify the tlv region but not an accurate method because some other regions also can be captured by f rotation 0 in order to identify the tlv region more centrally a new variable extracted from the original function of f rotation is established as 16 f 2 r 1 r the original equation 7 is simplified as the expression of r which is directly related to the strain rate tensor s and the vorticity tensor ω with the definition of r s ω the equation 16 can be transformed with the following expression 17 f 2 1 r 1 if ω s r 0 f 0 if ω s r 1 f 1 if ω s r f 2 according to a comparison for the magnitude of ω and s equation 16 can be divided into three cases in the first case if the flow has a strong rotational motion the ω is much larger than s the r is close to 0 and then the f also approaches to zero in the second case with the weakening of the rotational motion when ω is numerical equivalent to s both values for r and f are close to 1 in the third case if the rotational motion is very weak a maximum for s will result in an infinite r and the limit value for f is 2 overall if the vorticity tensor plays an important role in the flow compared to the shear stress tensor the criterion of 0 f 1 should be able to reflect the relatively stronger rotational motion in order to validate this assumption fig 11 reveals the distribution of f on the same planes as shown in fig 10 it shows that the region with lower f is more concentrated on the tlv field most of the other areas irrelevant with the cavitating vortical flow are no longer recognized by 0 f 1 although some other vortex structures are also covered by the criterion of 0 f 1 such as the small vortex near left hand side of the figure on z c 1 the tlv region processes the minimum value of f in the tip clearance field compared to the displaying results from fig 10 using the rotation curvature correction factor the new simplified variable f gets a better effect on the tlv identification fig 11 shows that the values of f change at different planes and increase from inside to outside along the radius of vortex core on one certain plane moreover the differences between the gap widths result in the different distribution of f in order to have a better understanding on the spatial distribution of f fig 12 demonstrates the variation of f along the tlv trajectory as shown in figs 7 c and 8 c the tlv core radius illustrated by the λ 2 criterion on non cavitating condition is similar with the cavitating tlv radius shown by the α v criterion so the expected cavitating tlv region can be approximately predicted through the vortex identification before calculating the cavitation for example in the simulation result of the single phase flow at τ 1 fig 12 a uses the λ 2 criterion to indicate the cavitating tlv region extending to 1 8 times the length of foil chord c in the downstream with showing the f contours on different cross sections the f has a growth trend along the vortex radius and its maximum f m on each cross section can be regarded as the limit value f f m to identify the cavitating vortex region the variation of f m along the tlv trajectory is shown in fig 12 b and the effects of the gap width are embodied apart from the condition of τ 0 2 that the tlv cavitation has a short visual extent the cavitating tlv is visible at least to the downstream position of 1 8c with a wider gap as shown in the test from fig 15 in an overall view of fig 12 b the curves of f m have a declining trend with the development of tlv based on the present simulation the zwart s cavitation model could predict the cavitating vortex from the foil leading edge to the trailing edge in the range of 0 5 z c 0 5 with different gap widths it means the default f c is effective in part a with f m being around 1 0 the deviation between the numerical simulation and the test data is focus on the far downstream with a wider gap like shown in fig 9 at τ 1 with z c 1 2 a much lower f c is needed to get an ideal prediction for this cavitation region the corresponding lower f m within 0 0 6 indicates that the vortical motion has a remarkable influence on the cavity and the phase change rate needs to be controlled in cavitation model it has been validated that the one percent of the original f c c fc 0 01 has a contribution to capturing the tlv cavitation beyond the z c 1 2 region which is corresponding to the part c in fig 12 b in the rest part b the variation pattern for c fc is uncertain in consideration of the continuity between the part a and part c the c fc should vary from 0 01 to 1 for the condition with narrow gap of τ 0 2 the c fc cannot be too low to over predict the cavitation region within f m 0 9 for the wider gap a lower c fc is needed to maintain a extending for the vortex cavitation referring to the simulation results from fig 9 the variation of c fc with the terminal position of the predicted cavitating tlv is shown in fig 13 compared to the default value when the f c falls within 10 percent the c fc has little influence on the cavitation region while the cavitation length is sensitive to the change of f c when c fc 0 1 by comparing many calculation results it is found that the variation trend for c fc similar to the pattern in fig 13 is beneficial to meet the calculation requirements of various conditions with different gap widths finally a relationship between the reduction factor c fc and the vortex identification parameter f is established as shown in fig 14 in the range of f 1 the default f c is enough in the far downstream vortex region with f 0 6 the reasonable prediction needs a much lower f c with c fc 0 01 for the middle region within 0 6 f 1 after a serious of comparisons a 3rd order polynomial is used to describe the transition of c fc from 0 01 to the default value of 1 the specific expression for the variation of c fc with the vortex identification parameter f is shown in equation 18 in the cfx software the variables of f and c fc are added by cfx expression language cel which enable cfx users to enhance their simulations without recourse to writing and linking separate external fortran routines the reduction factor c fc is used as a multiplier to modify the condensation coefficient in zwart s cavitation model then the modified cavitation model based on the vortex identification is established and it is denoted as a vortex cavitation model 18 c f c 0 01 if f 0 6 34 58 f 3 71 63 f 2 49 29 f 11 25 if 0 6 f 1 1 if f 1 4 5 simulation results by the vortex cavitation model the vortex cavitation model is used to simulate the cavitating tlv with different gap widths the calculation results are compared with the test data and the results from the zwart s cavitation model as shown in fig 15 in the referenced test some movies are available as supplementary material to show the cavitating tlv within the scope of z c 1 8 in downstream from the original movies it can be found that the cavitating tlv basically keeps its trajectory at different time and the screenshot at one time t 0 5 ms is shown in fig 15 the simulated cavitation regions with four gap widths are shown by the iso surface of α v 0 1 compared to the calculation results from zwart s cavitation model the vortex cavitation model improves the prediction of the cavitating tlv in downstream significantly with a wider gap including the conditions of τ 0 3 τ 0 5 and τ 1 in an overall view the vortex cavitation model prolongs the cavitation region for each conditions and the extended length is gradually increasing with the enlargement of the gap width although there is still room for improvement of the simulation results by the vortex cavitation model it gets a better agreement with the test phenomena for the cavitating tlv with different gap widths in addition the cavitation region inside the gap is also captured by this modified model in order to further analyse the effect of the vortex cavitation model fig 16 shows the phase change rate m between vapor and liquid in the simulations by the zwart s model and the vortex cavitation model on the condition of τ 1 for example the m is defined as the mass change rate in unit volume between two phases its positive value represents the increase of liquid corresponding to the condensation process and the negative value for m represents the reverse direction in fig 16 the contours of m are displayed in several planes along the tlv trajectory and the cavitation region is shown by the iso surface of α v 0 1 with some transparency it can be seen that the mass transform between the two phases ends in z c 1 3 with zwart s model and the vortex cavitation model extends the phase transformation to further downstream around z c 1 9 as the condensation coefficient in the vortex cavitation model is lower the reduced condensation rate results in a smaller m within tlv cavitation in fig 16 b in addition the mechanism of the vortex cavitation can be reflected by fig 17 with the distribution of pressure the pressure is measured by the saturated vapor pressure p v and the cavitation region is also illustrated by the iso surface of α v 0 1 it shows that the cavitating tlv lasts to the downstream region where the pressure is already higher than the vapor pressure in fig 17 b a similar phenomenon occurs in the cavitation inception region inside the tip vortex that the mean flow pressure is higher than the vapor pressure of the liquid oweis and ceccio 2005 this suggests that the vortex cavitation model involves the effect of the angular momentum from the vortex on the cavity and it extends the lifetime of the cavitating vortical flow based on the above analysis it can be summarised that the vortex cavitation model improves the prediction of the cavitating tlv by involving the impact of the vortical motion the different swirling strength along the tlv trajectory and among different conditions with various gap widths is identified by a rotational factor f and the phase change rate in cavitation can be adjusted by means of the vortex intensity 5 conclusions the steady state characteristics of the tip leakage vortex tlv flow and its cavitation on the naca0009 hydrofoil have been investigated numerically the turbulence model and cavitation model are validated and improved according to the referenced test some observations made as results are as follows 1 in consideration of the local rotational motion of the vortical flow a rotation curvature correction cc on the eddy viscosity model is applied to calculating the turbulent flow in the tlv both the simulation results from the sst and sst cc turbulence models are compared to the test data on the non cavitating conditions the sst cc model improves the prediction of the velocity features in tlv on the downstream measurement sections because it suppresses the eddy viscosity in the vortex region and leads to a slower velocity decay in tlv in addition the effects of the turbulence models on the vorticity and pressure characteristics along the tlv trajectory are analysed with different gap widths 2 when the zwart s cavitation model is used the sst and sst cc turbulence models have different influences on the prediction of tlv cavitation depending on the gap width compared to the cavitation phonomena in the referenced test the predicted cavitating tlv using the two turbulence models are similar with the test at τ 0 2 and the sst cc model increases the prediction accuracy at τ 1 with a longer cavitating vortex zone but it still cannot capture the cavitation region beyond 1 2 times of the foil chord in downstream with a wider gap 3 the emperical coefficients in zwart s cavitation model are calibrated by present simulation for predicting the tlv cavitation a serious of calculations validate that a lower condensation coefficient f c can effectively extend the vortex cavitation region by controlling the mass conversion rate from vapor to liquid and a reasonable prediction needs a proper allocation for f c according to the vortex strength 4 a parameter f related to strain rate tensor and the vorticity tensor is used to identify the degree of rotation in vortex and a relationship between the f and the f c in zwart s cavitation model is established to form a modified vortex cavitation model the vortex cavitation model significantly increases the prediction accuracy of the tlv cavitation with different gap widths and it is capable of capturing the cavitation inside the gap compared to the conventional zwart s cavitation model the present vortex cavitation model gets a better agreement with the referenced test results acknowledgements the authors thank the national natural science foundation of china no 51479200 for supporting this work 
23596,the tip leakage vortex tlv cavitation is investigated by a commercial reynolds averaged navier stokes rans solver a referenced test on a naca0009 hydrofoil is used to validate the numerical simulation considering the local rotation characteristics of the vortical flow a rotation curvature corrected shear stress transport model sst cc model is applied to simulate the time averaged turbulent flow compared to the original sst model the sst cc model improves the prediction of the velocity in tlv on the measured sections in downstream and the vorticity and pressure features along the tlv trajectory are analysed numerically in order to increase the prediction accuracy for the tlv cavitation the empirical condensation coefficient f c in zwart s cavitation model is calibrated based on the referenced experiment by introducing a vortex identification parameter f related to the strain rate tensor and the vorticity tensor a relationship between the f c and f is built and the effects of the rotational motion of the vortex on the cavity are embodied in a modified zwart s cavitation model compared to the conventional zwart s cavitation model the modified cavitation model significantly improves the prediction of the tlv cavitation and gets a better agreement with the referenced test on different conditions with various gap widths keywords tip leakage vortex cavitation eddy viscosity model rotation curvature correction 1 introduction the rotor tip clearance is inevitable in many axial flow hydraulic machineries such as the kaplan and bulb turbines axial pumps and shrouded propulsors the tip clearance can result in the leakage flow and the formation of vortices among various vortices the tip leakage vortex tlv has the highest total pressure drop and the highest total pressure loss xiao et al 2001 and the resulting vortex cavitation raises much concerns such as the severe erosion near the blade tip the performance deterioration unit vibration and the acoustic noise laborde et al 1997 avellan 2004 the cavitating tlv draws much attention for a long time but this flow is complex and not well understood until recently liu et al 2015 luo et al 2016 the confused physics involved in vortex cavitation is that the cavitation is not only induced in vortical structures but is also a source of vorticity arndt 2002 most of the new advances rely on the application of new experimental techniques and the development of computational tools tan et al 2015 used a transparent acrylic rotor allowing uninhibited visual access to the cavitation phenomena in an axial waterjet pump the interactions between the tlv and the cloud cavitation were investigated by high speed imaging particle imaging velocimetry piv is usually used to examine the vortical flows with cavitation suppressed the rollup process of the tlv was identified by wu et al 2011 but multiple interlaced vortical structures in rotor disturbed the tlv and increased the flow variability oweis and ceccio 2005 an in depth study on the primary tlv is usually by means of a hydrofoil for example gopalan et al 2002 measured the velocity and thus vorticity and circulation of tlv in several planes and dreyer et al 2014 adopted the stereo piv to investigate the 3d flow fields in these experiments the cavitation phenomenon is a way of showing the tlv trajectory but the internal flow test on the cavitation condition is relatively difficult the computational fluid dynamics cfd is helpful to explore more extensive characteristics of the cavitating vortex a commercial reynolds averaged navier stokes rans solver in conjunction with a turbulence model and a cavitation model is generally adopted for engineering practice but the simulation results usually have a much shorter or smaller cavitation region than the experimental observations for different kinds of vortex cavitation decaix et al 2015a wang et al 2014 zhou et al 2017 in order to improve the predictions most efforts have been done to develop the calculation models the eddy viscosity turbulence model is a particularly important way to simulate the turbulent flow currently the most prominent model is the k ω based shear stress transport sst model menter 1994 which could capture the global features of the tlv in much previous examples kato et al 2011 decaix et al 2015b guo et al 2016 smirnov and menter 2009 put a rotation curvature correction cc term into the original sst model to form a sst cc model it could increase the prediction accuracy for the non cavitating vortex evolution smirnov and menter 2009 arolla and durbin 2014 but its application on the cavitating tlv is not clear the cavitation model is another key factor affecting the prediction of vortex cavitation in the eulerian eulerian multiphase flow field the mass transfer models proposed by various authors such as kunz et al 2000 singhal et al 2002 zwart et al 2004 and so on have demonstrated their capabilities to reproduce the main features of cavitating flows for decades frikha et al 2009 these cavitation models share the common feature of employing empirical coefficients which are determined through numerical experimental results and are adjusted for different geometries and different flow conditions according to calibrating the coefficient values a larger resemblance can be observed among most cavitation models the effects of the coefficient from three models kunz et al 2000 singhal et al 2002 zwart et al 2004 on the computed results of the cavitating tip vortex in propellers have been analysed morgut and nobile 2012 and it reveals that further improvement on the simulated cavity extension is needed in consideration of the cavitation vortex interactions zhao et al 2016 have built a relationship between the cavitation bubble radius and vortex effects based on the zwart s cavitation model and the predictive ability of a new vortex cavitation model has been verified the above researches have achieved a certain positive effect respectively but a comprehensive evaluation for the effects of both turbulence model and cavitation model is not enough on the complicated tlv flow and cavitation the aim of this study is to evaluate the calculation models for simulating the tlv and its cavitation a referenced hydrofoil test in the single phase flow and the multiphase flow is used to validate the simulated results numerical setups are shown in section 2 in section 3 the non cavitating vortex flow is analysed by the sst cc turbulence model whose influence on predicting the cavitating tlv is analysed in section 4 in the multiphase flow the empirical coefficient in zwart s cavitation model is calibrated based on the vortex intensity and a modified cavitation model is established finally the conclusions are summarized in section 5 2 numerical setups 2 1 governing equations a commercial cfd code of ansys cfx ansys cfx 2011 is used in present work with a rans solver in the following steady state equations the bar is dropped for averaged quantities except for products of fluctuating quantities 1 ρ t x j ρ u j 0 2 t ρ u i x j ρ u i u j p x i x j μ u i x j ρ u i u j s m where u i i u v w is the velocity x i i x y z is the position t is the time p is the pressure μ is the dynamic viscosity s m is the external momentum source term the reynolds stresses ρ u i u j can be modified by a turbulence model for the multiphase flow the homogeneous one fluid model allows some simplifications with an assumption that the transported quantities are the same for all phases except for the volume fraction α the ρ is defined as the density of mixture with the following definition 3 ρ α v ρ v α l ρ l where the subscripts v and l represent the vapor and liquid phases respectively 2 2 computational domain and mesh validation referring to dreyer et al s experiment dreyer 2015 a naca0009 hydrofoil had the truncated chord c of 100 mm and its maximum thickness h was 9 9 mm which was tested in a water tunnel with a 150 mm wide cross section and 750 mm length there was a gap between the foil tip and the tunnel lateral wall and the cavity extension is different with various gap widths a non dimensional parameter τ was defined as the ratio of the absolute gap width and the foil thickness and two typical conditions with τ 0 2 and τ 1 are discussed here with different cavity extension the computational domain with boundary conditions is shown in fig 1 the inlet which is located in the upstream with about 2c distance to the foil leading edge has a velocity of v in 10 m s with low turbulence intensity below 1 the outlet has a static pressure to maintain the inlet pressure p in near 1 bar no slip walls are at the other boundaries and the foil incidence angle is 10 a structured hexahedral mesh is generated in the computational domain with fig 2 showing the local mesh near the foil tip based on the richardson extrapolation method which is currently the most reliable method available for the prediction of numerical uncertainty a grid convergence index gci fine 21 is used to validate the mesh resolution celik et al 2008 the detailed process for mesh validation has been finished in our previous work guo et al 2016 the pressure coefficient c p p p in 0 5ρv in 2 in the tlv core is chosen as a key variable when the convergence index gci fine 21 for c p is within 5 the total number of mesh cells about 4 4 million is used the averaged y is 20 and 60 for the maximum on the foil surface and both sides of the gap in the simulation the high resolution scheme is used for the advection scheme and convergence is specified as rms residuals of 10 5 3 simulation of the non cavitating tlv flow 3 1 rotation curvature correction for the eddy viscosity model the gradient diffusion hypothesis is frequently used in numerical simulations of turbulent flows involving transport equations the eddy viscosity turbulence models use this hypothesis to relate the reynolds stresses to the mean velocity gradients and the eddy viscosity μ t the μ t can be linked to the turbulence kinetic energy k and turbulent frequency ω via this relation 4 μ t ρ k ω and then many k ω models are formed the k ω sst shear stress transport model of menter 1994 accounts for the transport of the turbulent shear stress and gives highly accurate predictions of the onset and the amount of flow separation under adverse pressure gradients one of the weaknesses of eddy viscosity models is that they are not capable of capturing the rotational motion and streamline curvature which play a important role in the vortical flows the sst model modifed with a rotation curvature correction cc was presented by smirnov and menter 2009 by using a multiplier f r1 to control the production terms the first term on the right hand side of the equation in original k and ω transport equations 5 ρ k t ρ u j k x j p k f r 1 β ρ k ω x j μ e f k x j 6 ρ ω t ρ u j ω x j α ρ p k μ t f r 1 d ω c d ω x j μ e f ω x j the f r1 is slightly modified from the empirical function f rotation suggested by spalart and shur 1997 for sensitization of the one equation spalart allmaras turbulence model to the effects of streamline curvature and system rotation with the following expressions 7 f rotation 1 c r 1 2 r 1 r 1 c r 3 tan 1 c r 2 r c r 1 8 f r 1 max min f rotation 1 25 0 0 except for a couple of constants of c r1 1 0 c r2 2 0 and c r3 1 0 the variables r and r are related to the strain rate tensor s and vorticity tensor ω 9 r s ω 10 r 2 ω i k s j k d s i j d t ε i m n s j n ε j m n s i n ω m r o t 1 ω d 3 this rotation curvature correction cc is available for sst model in ansys cfx software and the calculation results from the sst cc and the original sst turbulence models will be compared in present simulation 3 2 effects of the rotation curvature correction on non cavitating tlv on the cavitation free conditions the downstream velocity field around the tlv was measured in the referenced test dreyer 2015 take the downstream plane of z c 1 for example fig 3 shows the contours of the streamwise velocity along z axial direction v z from the numerical simulations with sst and sst cc models compared with the test data overall both the simulations reflect the general features in the velocity distribution not only including the wake like or jet like profiles in the tlv region but also involving the effects of the wall boundary left hand side of the figure and the foil suction side on the velocity field the main difference between the simulations with two models is on the vortex core region where the wake like or jet like nature of the streamwise velocity is determined by the tlv intensity under the two different gap widths the sst cc model gets a lower v z at τ 0 2 and a higher v z at τ 1 within tlv compared to the sst model and the results from sst cc model agree well with the test figure in order to further validate the simulations quantitatively fig 4 demonstrates the velocity magnitude along a horizontal line as shown in fig 3 through the vortex center the value of v z is normalized by the inflow velocity v in 10 m s in the vertical coordinates compared with the referenced test data the sst model underestimates the velocity change inside the tlv core region and the sst cc model increases the velocity gradient within tlv and gets an improvement for the predictions the difference between the two models can be explained by fig 5 with showing the distribution of the eddy viscosity μ t at one condition of τ 1 it can be found that the sst cc model results in a strong suppression of the μ t in tlv region and a fast decay of the core velocity is avoided limited by the experimental devices only the downstream vortex flow features are available during the test the numerical simulation provides a great convenience to reveal the vortex features along the tlv trajectory such as the simulation results in fig 5 in general the vortex center can be determined by the maximum vorticity criterion in order to fully reveal the tlv features fig 6 shows the variation of some flow parameters along tlv trajectory including the velocity vorticity and pressure information the streamwise velocity and pressure at tlv center are normalized by the inflow conditions and a non dimensional vorticity coefficient c ω is defined as 11 c ω ω z v in c where ω z is the streamwise vorticity at the tlv center and c is the foil chord of 0 1 m in fig 6 the curves can be roughly divided into two zones along the abscissa the one zone i is within 0 5 z c 0 5 corresponding to the range from foil leading edge to the trailing edge and the other zone ii is in the downstream region of z c 0 5 fig 6 a shows that the wake like velocity feature at τ 0 2 is prominent in zone ii with an obvious difference between the two model results the effects of the rotation curvature correction cc is almost not working in zone i at τ 1 the curves with v z v in 1 represent the jet like profile and the role of the sst cc model is reflected with the development of tlv in fig 6 b and c the differences from the sst cc and sst models are not obvious for the smaller gap of τ 0 2 but the sst cc model significantly increases the c ω and decreases the c p for the larger gap of τ 1 as the vorticity is related to the vortex intensity the higher value of c ω from sst cc model means the tlv will last to far downstream with a wider gap this can be explained by the spatial form of tlv displayed in fig 7 the vortex can be identified by many methods zhang et al 2018 based on the strain rate tensor s and vorticity tensor ω a symmetric tensor s 2 ω 2 has real eigenvalues only if λ 1 λ 2 and λ 3 are eigenvalues and λ 1 λ 2 λ 3 jeong and hussain 1995 used the λ 2 0 to define the vortex core and provided the λ 2 criterion some common used vortex identification methods have been compared in present simulation and the λ 2 criterion can accurately identify the tlv core with an intuitively clear geometry the value of λ 2 determines the vortex region size and a specific value can be used for comparison like in fig 7 using a iso surface a surface of constant value for a specified variable of λ 2 7 106 s 2 to display the tlv region it shows that the streamwise length of tlv is much longer from sst cc model than the sst model at τ 1 under the same vortex identification criterion the tlv region is short at τ 1 and there is no significant difference between the two models as the vortical motion leads to a local pressure minimum the increased vorticity is corresponding to a pressure drop in fig 6 c in addition a lower c p in sst cc model will influence the cavitation region with a wider gap 4 simulation of the cavitating tlv flow 4 1 numerical method to solve the cavitating flow cavitation refers to the process by which vapor forms in a low pressure regions of a liquid flow for cavitating flow the homogeneous multiphase model in eulerian eulerian scheme is typically used because the vapor velocity field is often assumed to be the same as that of the liquid based on the mass conservation equation 1 the liquid vapor mass transfer in cavitation can be governed by the vapor transport equation 12 t α v ρ v x j α v ρ v u v j m e m c where the m e and m c are the mass transfer source terms connected to the growth and collapse of the vapor bubbles respectively the rayleigh plesset equation provides the basis for the rate equation controlling vapor generation and condensation and a simplified expression describing the growth of a bubble in a liquid is shown as 13 d r b d t 2 3 p v p ρ l where r b represents the bubble radius p v is the pressure in the bubble assumed to be the vapor pressure at the liquid temperature and p is the pressure in the liquid surrounding the bubble based on the simplified rayleigh plesset equation zwart et al 2004 derived the total interphase mass transfer rate due to cavitation per unit volume the final form of the zwart s cavitation model is 14 m e f e 3 α n u c 1 α v ρ v r b 2 3 p v p ρ l if p p v 15 m c f c 3 α v ρ v r b 2 3 p p v ρ l if p p v the following model parameters have found to work well for a variety of fluids and devices r b 1 10 6m α nuc 5 10 4 f e 50 and f c 0 01 with the increasing of the demand for the prediction accuracy more and more researches have done to calibrate the model parameters for different types of cavitation the effects of the model coefficient on the tlv cavitation will be discussed in section 4 3 and 4 4 4 2 application of the sst cc model to cavitating tlv simulation the cavitation is a convenient way to visualize the tlv as shown in fig 8 a the mean tlv trajectory is shown by the superposition of the snapshots during 11 ms the yellow marks represent the position of tlv on the downstream planes of z c 1 and z c 1 2 using the zwart s cavitation model the volume fraction for each phase in cavitating tlv can be calculated and the cavitation area can be illustrated by a low pressure p region or a region with a specific value of vapor volume fraction the 10 volume fraction α v is quite reasonable in most cases fig 8 b and c use the iso surface of α v 0 1 to show the simulated cavitation area based on the improvement of the sst cc model on predicting the non cavitating tlv a comparison for the cavitating tlv simulation is carried out between the sst cc and sst models as revealed in the test the cavitating tlv region is short with a narrow gap on the condition of τ 0 2 the predicted tlv cavitation from both turbulence models is similar with the test image the cavitation inside the gap due to the boundary layer separation is also replicated by the simulations for the larger gap condition of τ 1 the cavitating tlv develops to the far downstream compared with the test image the simulated tlv cavitation region is much shorter especially with the sst turbulence model the sst cc model can capture the cavitation in further downstream until the position of z c 1 1 this is because the sst cc model has reduced the pressure at tlv center as shown in fig 6 c overall the sst cc model could get more reasonable predictions for tlv flow both on non cavitating and cavitating conditions meanwhile the effects of sst cc model is more dramatic with a wider gap like τ 1 in present simulation so the vortex features affected by the gap width are worthy of attention in the study of the vortex cavitation 4 3 effect of cavitation model coefficient on tlv cavitation after the confirmation of the sst cc turbulence model the effects of the cavitation model on predicting the tlv cavitation will be discussed in this section as shown in fig 8 the simulated cavitation region with the improved turbulence model is still shorter than the test image in fact the original movies from the test illustrated that the cavitating tlv at least extended to the downstream position of z c 1 8 at τ 1 shown in fig 15 researches have shown that the empirical coefficients in cavitation models are determined by different flow conditions and the resemblance among any models could be achieved by adjusting the coefficients using zwart s cavitation model the appropriate coefficients for the tlv cavitation are investigated in present work based on other cavitation examples zwart et al 2004 morgut and nobile 2012 liu et al 2014 the optimal phase change coefficients in cavitation models were adjusted within the hundredth and hundredfold of the default values f e 50 and f c 0 01 according to a series of simulations for the present tlv cavitation case with different f e and f c it is found that the evaporation coefficient f e has small effect on the cavitation region and a lower condensation coefficient f c can effectively extend the cavitating tlv a reduction factor c fc is used as a multiplier c fc f c to control the decreasing degree of f c and three simulation results are shown in fig 9 the tlv cavitation develops to further downstream keeping its original trajectory with the decrease of f c it is due to a lower condensation coefficient leading to the reduction of the mass transport from vapor to liquid as described in equation 15 in consideration of the mechanism in vortex cavitation the angular momentum in vortical flow could delay the collapse of cavities and the influence of the vortex motion on the cavitation can be reflected by controlling the condensation process the scheme iii with c fc 0 01 extends the cavitating tlv to the downstream position near z c 1 86 at τ 1 which is similar to the test phenomenon in fig 15 but meanwhile the cavitating tlv is over predicted with too long cavitation region at τ 0 2 in addition some extra unreal cavitation region is introduced with the decreasing of f c it follows that the cavitation model should be adjusted concentrated in the vortex region and based on the vortex intensity with different gap widths 4 4 modification of the cavitation model based on the vortex identification the vortex can be identified by many methods zhang et al 2018 such as the swirling strength the helicity the q criterion and the λ 2 criterion used in present simulation in section 3 2 however most the vortex identification methods are sensitive to the chosen values for the vortex analysis and the captured vortex structure changes with the values of criteria in order to seek a suitable method to identify the tlv region a dimensionless function from the rotation curvature correction method attracts our attention that is the empirical function f rotation in equation 7 take two positions of z c 0 and z c 1 for example fig 10 shows the distribution of f rotation within 0 1 on the two planes with different gap widths the regions marked by the dashed circle is near the tlv it can be seen that the vortex region with highly helicity has a local low value for f rotation and the vortex center nearly satisfies the condition of f rotation 0 the lower f rotation reduces the eddy viscosity in tlv and has improved the prediction of the turbulence flow field in fig 10 the f rotation close to 0 is a roughly criterion to identify the tlv region but not an accurate method because some other regions also can be captured by f rotation 0 in order to identify the tlv region more centrally a new variable extracted from the original function of f rotation is established as 16 f 2 r 1 r the original equation 7 is simplified as the expression of r which is directly related to the strain rate tensor s and the vorticity tensor ω with the definition of r s ω the equation 16 can be transformed with the following expression 17 f 2 1 r 1 if ω s r 0 f 0 if ω s r 1 f 1 if ω s r f 2 according to a comparison for the magnitude of ω and s equation 16 can be divided into three cases in the first case if the flow has a strong rotational motion the ω is much larger than s the r is close to 0 and then the f also approaches to zero in the second case with the weakening of the rotational motion when ω is numerical equivalent to s both values for r and f are close to 1 in the third case if the rotational motion is very weak a maximum for s will result in an infinite r and the limit value for f is 2 overall if the vorticity tensor plays an important role in the flow compared to the shear stress tensor the criterion of 0 f 1 should be able to reflect the relatively stronger rotational motion in order to validate this assumption fig 11 reveals the distribution of f on the same planes as shown in fig 10 it shows that the region with lower f is more concentrated on the tlv field most of the other areas irrelevant with the cavitating vortical flow are no longer recognized by 0 f 1 although some other vortex structures are also covered by the criterion of 0 f 1 such as the small vortex near left hand side of the figure on z c 1 the tlv region processes the minimum value of f in the tip clearance field compared to the displaying results from fig 10 using the rotation curvature correction factor the new simplified variable f gets a better effect on the tlv identification fig 11 shows that the values of f change at different planes and increase from inside to outside along the radius of vortex core on one certain plane moreover the differences between the gap widths result in the different distribution of f in order to have a better understanding on the spatial distribution of f fig 12 demonstrates the variation of f along the tlv trajectory as shown in figs 7 c and 8 c the tlv core radius illustrated by the λ 2 criterion on non cavitating condition is similar with the cavitating tlv radius shown by the α v criterion so the expected cavitating tlv region can be approximately predicted through the vortex identification before calculating the cavitation for example in the simulation result of the single phase flow at τ 1 fig 12 a uses the λ 2 criterion to indicate the cavitating tlv region extending to 1 8 times the length of foil chord c in the downstream with showing the f contours on different cross sections the f has a growth trend along the vortex radius and its maximum f m on each cross section can be regarded as the limit value f f m to identify the cavitating vortex region the variation of f m along the tlv trajectory is shown in fig 12 b and the effects of the gap width are embodied apart from the condition of τ 0 2 that the tlv cavitation has a short visual extent the cavitating tlv is visible at least to the downstream position of 1 8c with a wider gap as shown in the test from fig 15 in an overall view of fig 12 b the curves of f m have a declining trend with the development of tlv based on the present simulation the zwart s cavitation model could predict the cavitating vortex from the foil leading edge to the trailing edge in the range of 0 5 z c 0 5 with different gap widths it means the default f c is effective in part a with f m being around 1 0 the deviation between the numerical simulation and the test data is focus on the far downstream with a wider gap like shown in fig 9 at τ 1 with z c 1 2 a much lower f c is needed to get an ideal prediction for this cavitation region the corresponding lower f m within 0 0 6 indicates that the vortical motion has a remarkable influence on the cavity and the phase change rate needs to be controlled in cavitation model it has been validated that the one percent of the original f c c fc 0 01 has a contribution to capturing the tlv cavitation beyond the z c 1 2 region which is corresponding to the part c in fig 12 b in the rest part b the variation pattern for c fc is uncertain in consideration of the continuity between the part a and part c the c fc should vary from 0 01 to 1 for the condition with narrow gap of τ 0 2 the c fc cannot be too low to over predict the cavitation region within f m 0 9 for the wider gap a lower c fc is needed to maintain a extending for the vortex cavitation referring to the simulation results from fig 9 the variation of c fc with the terminal position of the predicted cavitating tlv is shown in fig 13 compared to the default value when the f c falls within 10 percent the c fc has little influence on the cavitation region while the cavitation length is sensitive to the change of f c when c fc 0 1 by comparing many calculation results it is found that the variation trend for c fc similar to the pattern in fig 13 is beneficial to meet the calculation requirements of various conditions with different gap widths finally a relationship between the reduction factor c fc and the vortex identification parameter f is established as shown in fig 14 in the range of f 1 the default f c is enough in the far downstream vortex region with f 0 6 the reasonable prediction needs a much lower f c with c fc 0 01 for the middle region within 0 6 f 1 after a serious of comparisons a 3rd order polynomial is used to describe the transition of c fc from 0 01 to the default value of 1 the specific expression for the variation of c fc with the vortex identification parameter f is shown in equation 18 in the cfx software the variables of f and c fc are added by cfx expression language cel which enable cfx users to enhance their simulations without recourse to writing and linking separate external fortran routines the reduction factor c fc is used as a multiplier to modify the condensation coefficient in zwart s cavitation model then the modified cavitation model based on the vortex identification is established and it is denoted as a vortex cavitation model 18 c f c 0 01 if f 0 6 34 58 f 3 71 63 f 2 49 29 f 11 25 if 0 6 f 1 1 if f 1 4 5 simulation results by the vortex cavitation model the vortex cavitation model is used to simulate the cavitating tlv with different gap widths the calculation results are compared with the test data and the results from the zwart s cavitation model as shown in fig 15 in the referenced test some movies are available as supplementary material to show the cavitating tlv within the scope of z c 1 8 in downstream from the original movies it can be found that the cavitating tlv basically keeps its trajectory at different time and the screenshot at one time t 0 5 ms is shown in fig 15 the simulated cavitation regions with four gap widths are shown by the iso surface of α v 0 1 compared to the calculation results from zwart s cavitation model the vortex cavitation model improves the prediction of the cavitating tlv in downstream significantly with a wider gap including the conditions of τ 0 3 τ 0 5 and τ 1 in an overall view the vortex cavitation model prolongs the cavitation region for each conditions and the extended length is gradually increasing with the enlargement of the gap width although there is still room for improvement of the simulation results by the vortex cavitation model it gets a better agreement with the test phenomena for the cavitating tlv with different gap widths in addition the cavitation region inside the gap is also captured by this modified model in order to further analyse the effect of the vortex cavitation model fig 16 shows the phase change rate m between vapor and liquid in the simulations by the zwart s model and the vortex cavitation model on the condition of τ 1 for example the m is defined as the mass change rate in unit volume between two phases its positive value represents the increase of liquid corresponding to the condensation process and the negative value for m represents the reverse direction in fig 16 the contours of m are displayed in several planes along the tlv trajectory and the cavitation region is shown by the iso surface of α v 0 1 with some transparency it can be seen that the mass transform between the two phases ends in z c 1 3 with zwart s model and the vortex cavitation model extends the phase transformation to further downstream around z c 1 9 as the condensation coefficient in the vortex cavitation model is lower the reduced condensation rate results in a smaller m within tlv cavitation in fig 16 b in addition the mechanism of the vortex cavitation can be reflected by fig 17 with the distribution of pressure the pressure is measured by the saturated vapor pressure p v and the cavitation region is also illustrated by the iso surface of α v 0 1 it shows that the cavitating tlv lasts to the downstream region where the pressure is already higher than the vapor pressure in fig 17 b a similar phenomenon occurs in the cavitation inception region inside the tip vortex that the mean flow pressure is higher than the vapor pressure of the liquid oweis and ceccio 2005 this suggests that the vortex cavitation model involves the effect of the angular momentum from the vortex on the cavity and it extends the lifetime of the cavitating vortical flow based on the above analysis it can be summarised that the vortex cavitation model improves the prediction of the cavitating tlv by involving the impact of the vortical motion the different swirling strength along the tlv trajectory and among different conditions with various gap widths is identified by a rotational factor f and the phase change rate in cavitation can be adjusted by means of the vortex intensity 5 conclusions the steady state characteristics of the tip leakage vortex tlv flow and its cavitation on the naca0009 hydrofoil have been investigated numerically the turbulence model and cavitation model are validated and improved according to the referenced test some observations made as results are as follows 1 in consideration of the local rotational motion of the vortical flow a rotation curvature correction cc on the eddy viscosity model is applied to calculating the turbulent flow in the tlv both the simulation results from the sst and sst cc turbulence models are compared to the test data on the non cavitating conditions the sst cc model improves the prediction of the velocity features in tlv on the downstream measurement sections because it suppresses the eddy viscosity in the vortex region and leads to a slower velocity decay in tlv in addition the effects of the turbulence models on the vorticity and pressure characteristics along the tlv trajectory are analysed with different gap widths 2 when the zwart s cavitation model is used the sst and sst cc turbulence models have different influences on the prediction of tlv cavitation depending on the gap width compared to the cavitation phonomena in the referenced test the predicted cavitating tlv using the two turbulence models are similar with the test at τ 0 2 and the sst cc model increases the prediction accuracy at τ 1 with a longer cavitating vortex zone but it still cannot capture the cavitation region beyond 1 2 times of the foil chord in downstream with a wider gap 3 the emperical coefficients in zwart s cavitation model are calibrated by present simulation for predicting the tlv cavitation a serious of calculations validate that a lower condensation coefficient f c can effectively extend the vortex cavitation region by controlling the mass conversion rate from vapor to liquid and a reasonable prediction needs a proper allocation for f c according to the vortex strength 4 a parameter f related to strain rate tensor and the vorticity tensor is used to identify the degree of rotation in vortex and a relationship between the f and the f c in zwart s cavitation model is established to form a modified vortex cavitation model the vortex cavitation model significantly increases the prediction accuracy of the tlv cavitation with different gap widths and it is capable of capturing the cavitation inside the gap compared to the conventional zwart s cavitation model the present vortex cavitation model gets a better agreement with the referenced test results acknowledgements the authors thank the national natural science foundation of china no 51479200 for supporting this work 
23597,accurate path following control plays an important role for autonomous underwater vehicles auv in the oceanic surveys and exploration in the consideration with nonlinearity and external disturbance the dynamic model of a portable auv has been established on the basis of its actuation and control characteristics an adaptive nonlinear second order sliding mode controller has been deduced to eliminate the chattering motion through a sliding surface during the path following control on the uncertainties of external disturbances an adaptive tuning law has been selected to estimate the upper bound of disturbance in the lake experiments the proposed controller not only provides better response with faster convergence and smaller overshoot but also eliminates the chattering effect of control output in compare with the controller with linear and pid second order sliding mode surface keywords autonomous underwater vehicle sliding mode control path following 1 introduction being the focus of many marine researchers around the globe autonomous underwater vehicles auvs play an important role in underwater surveillance missions including military operation and pipeline inspection koena et al 2015 a number of missions such as target carpet searching chen 2008 seafloor terrain survey and autonomous underwater docking robert et al 2008 require auv to move within a range of depth or to maintain the boundary height of terrain to obtain high quality data hangil et al 2014 considerable researches have been performed to address precise attitude and trajectory control to obtain quality data such as pd control huang and kreuzer 2007 neural network control bagheri et al 2010 robust control divine et al 2015 and so forth ehsan peymani et al reformulated auv modeling into a constrained multi body system designed a path manoeuvring controller by using lagrange multipliers ehsan and fossen 2015 for a slender and streamlined auv various model based synthesis and controllers have been investigated chu et al 2016 he et al 2014 the auv is usually underactuated with vertical rudders and horizontal wings and it confronts with model non linearity unknown hydrodynamic coefficients and time varying disturbances with controller parameters independent to external disturbance sliding mode control possesses strong robustness in the presence of unknown disturbances and modeling error hangil joe et al has developed a second order sliding mode controller in order to compensate for the uncertainties in the hydrodynamic and unpredictable disturbance effects due to ocean currents hangil et al 2014 rongxin cui et al proposed an adaptive dynamic anti windup sliding mode attitude controller on the basis of dead zone model the controller has employed a nonlinear disturbance observer and an auxiliary dynamic compensator for the dead zone nonlinearity and rudder saturation cui et al 2016 sheng ping hsu et al proposed a modified depth control loop through pitch attitude and stern plane deflections hsub and liu 2014 however the major drawback of sliding mode controller is chattering effect ismail et al 2016 chattering is the high frequency amplitude oscillations due to the discontinuous control signal which is extremely dangerous for actuators systems adaptive concept has been utilized to minimize chattering effect zaopeng dong et al have presented a state feedback based back stepping control algorithm in the presence of constant and ocean current disturbance hangil et al 2014 with the expression of the relationship between desired heading angle and direction angle of the ocean current the controller has further been enriched through an additional integral action in order to enhance the steady state performance dong et al 2015 jian xu et al have proposed a novel adaptive dynamical sliding mode control based methodology to enhance the robustness in the presence of environmental disturbances it utilized a virtual velocity variable to represent the attitude error so as to avoid the representation singularities and simplify the analytical expression of the controller xu et al 2015 in order to reduce the chattering effect in the trajectory control of underwater vehicle soylu et al proposed an adaptive concept to replace the switching term in conventional sliding mode control soylu et al 2008 fuzzy strategy and neural network can be used to estimate uncertainty items online to reduce system chattering bessa et al 2010 in order to minimize chattering effect and improve control resolution against unknown disturbance through exercise rules bessa et al proposed an adaptive fuzzy sliding mode controller with a boundary layer to deal with the parameter uncertainties external disturbance and chattering effect shahraz and boozarjomehry 2009 xun zhang et al introduced adaptive switching law with t s fuzzy observer to estimate the auv states and reduced trajectory tracking error furthermore fuzzy strategy and neural network can be used to estimate uncertainty items online to reduce system chattering zhang et al 2014a b ming jun zhang et al have issued an adaptive sliding control method switch gain adjustment method has been employed to deal with chattering problem network has been employed to estimate unknown items online zhang and chu 2012 however the use of fuzzy control in the sliding mode controller requires many rules to achieve good performance which also reduces the robustness of the auv further the more rules are required the more energy will be consumed for a portable auv cruising underwater it tends to be affected by disturbance model uncertainty although with its inherent robustness sliding mode controller will cause chattering effect which is very dangerous for thrusters with electromechanical systems this manuscript will propose an adaptive second order sliding mode controller for the auv path following control the major contribution is the following ① the adaptive second order sliding mode controller is proposed to improve the transient performance for the auv control system ② the basic idea of proposed adaptive second order sliding mode controller is to eliminate the oscillation phenomenon through control input time derivative and signal integration ③ the estimation of external disturbance upper bound will be employed to reduce the energy consumption this study is organized into six sections following the introduction the control architecture of a portable auv is described in section 2 motion modeling for the auv is investigated in section 3 in section 4 an adaptive sliding mode controller is issued for path following control an adaptive tuning law is selected to estimate the upper bound of external disturbance in section 5 experiments are performed to verify the proposed control methodology and demonstrate its superiority in path following for the portable auv finally conclusions are drawn in section 6 2 control architecture of a portable auv an integrated portable auv has been designed for oceanic exploration with the streamlined shape like a torpedo the portable auv has been divided into three sections e g fore mid and stern see fig 1 auv s cruising diving and yawing are realized through a propeller horizontal and vertical fins navigation and position reckoning will be realized through magnetic compass depth gauge dvl through open source thrust experiments the thrust volt curves of the propeller are obtained in fig 2 a lift and draft coefficient curves of the fins are obtained through surface element algorithm in fig 2 b the software of control architecture see fig 3 is written in the c language each module subsystem works distributed and independently with independent task progress and unified communication protocol information transmission between surface industrial personal computer and cabin pc 104 module is client server in the cabin pc 104 module is employed for information interaction process 3 auv motion modeling if we establish earth fixed coordinate frame x e y e z e and auv fixed coordinate frame x v y v z v the motion model in vertical plane is shown in fig 1 where x y z and ϕ θ ψ represent auv position and orientation respectively u v ω p q r denote auv linear and angular velocities the kinematics equations of auv motion can be expressed as wadoo and kachroo 2011 1 x y z ϕ θ ψ cos ψ cos θ 0 0 0 sin ψ cos θ 0 0 0 sin θ 0 0 0 0 1 sin ϕ tan θ cos ϕ tan θ 0 0 cos ϕ sin ϕ 0 0 sin ϕ sec θ cos ϕ sec θ v p q r if yaw shake and roll can be ignored the auv motion equation in the vertical plane can be expressed as 2 x m x u u y m y v v z m z w w m i y m q q n i z n r r where m represents the mass of the auv if we set x u y v z q n r n v and m q as speed coefficient x u u y v v z q q m w w m w q n r r and m q q as the second order speed coefficient x w q x q q as second order speed correction coefficient τ t as thrust force δ s and δ r are the angle of vertical and horizontal fins respectively d 1 d 2 and d 3 are external disturbances y δ r is the coefficients of the vertical fins x δ s δ s and z δ s are effect the coefficients of the horizontal fins one has 3 x x u u x u u u u x w q w q x q q q 2 x δ s δ s u 2 δ s 2 τ t d 1 y y v v y v v v v m y r u r y δ r u 2 δ r d 2 z z q u q z q q q q z w u w z w w w w z δ s u 2 δ s d 2 m m q u q m q q q q m w w w w m w u w m w q w q z δ s l s u 2 δ s d 3 n n r u r n r r r r n v u v y δ r l r u 2 δ r d 3 the thruster usually consists a dc motor and propeller its thrust force can be obtained as omerdic and roberts 2004 4 τ t ρ d 4 k t d j 0 n n where d is the diameter of propeller ρ is water density k t d is the thrust coefficient n is the propeller shaft speed j 0 is speed related coefficient if we set u a as ambient water velocity we have j 0 u a n d for an under actuated auv motion of vertical plane is usually realized through horizontal wings and thruster while vertical rudders and thruster are responsible with the motion of horizontal plane when the wings move with the speed v and effective attack angle α they are subjected to the lift l vertical to the flow direction and the resistance d against the flow liang et al 2016 5 l c l α 1 2 ρ a r δ e v 2 d c d α 1 2 ρ a r δ e 2 v 2 where δ e is the effective angle of the fin c l α is the lift coefficient c d α is the resistance coefficient a r is the projection area of the fin profile c l α is the function of α if we set c l as the lift coefficient according to the hoerner and whicker empirical formula α 0 9 c l α and c d α can be improved as 6 c l α d c l d α 1 2 α π 1 2 π λ 1 c d α c d 0 c l α 2 a u π λ where λ is the effective span and chord ratio 7 λ b w i n g 2 s w i n g where s w i n g is the effective area b is the span of wing length a u is auxiliary value c d 0 is the resistance coefficient of the wing s shape if we set β s e as effective attack angle of the wing at zero plane the relationship between the wing s effective angle δ e and the angle δ s referenced to the vehicle hull is see fig 4 8 δ e δ s β s e if x fin y fin z fin is set as offset distance of the wings from desired installation position the effective speed u fin v fin w fin of the wings is 9 u f i n u z f i n q y f i n r v f i n v x f i n r z f i n p w f i n w y f i n p x f i n q then we have β s e t g β s e w f i n u f i n thus the applied force from the fin is 10 τ δ x δ z δ m δ x δ s δ s δ s 2 z δ s δ s z δ s l s δ s if set t e as time constant k e as control gains we obtain the model as 11 δ s 1 t e δ s k e t e δ s 4 terrain following control methodology in vertical plane 4 1 nonlinear second order sliding mode controller in order to realize path following control for precise control and regional search an adaptive sliding mode controller have been designed to create forces and moments equilibrium for simplification we take the motion of vertical plane for example in the investigation so that the motion of horizontal plane can be deduced similarly thus equations 1 and 3 can be rewritten as 12 u a 11 u a 12 q b 11 δ s 2 b 12 τ t d 1 w a 21 q a 22 w b 21 δ s d 2 where a 11 x u x u u u m x u a 12 x w q w x q q q m x u b 11 x δ s δ s u 2 m x u b 12 1 m x u d 1 d 1 m x u and a 21 z q u z q q q m z w a 22 z w u z w w w m z w b 21 z δ s l s u 2 m z w d 2 d 2 m z w if we set x u w t d d 1 d 2 as the bounded lumped uncertainty vector h z 1 0 t as the output vector and equation 12 can be written as 13 x a x b u d y z h z x where a a 11 a 12 a 21 a 22 is the system matrix x u w is the state vector u δ s τ t δ s 2 0 is the input matrix b b 11 b 12 b 21 0 is the matrix of nonlinear terms for underactuated auv the objective of the control in the vertical plane is to follow the terrain at desired speed 14 lim t t 0 y z y z d ξ where ξ is any small positive y z d u d w d t is desired state of auv longitude and vertical speed if y z e y z d y z is set as the auv cruising error in the vertical plane the linear sliding mode surface controller can be obtained as 15 s t c 1 y z e t where c 1 c 1 t in order to improve the transient performance of the auv closed loop system a nonlinear sliding surface based second order sliding mode controller is proposed on the basis of 15 the sliding surface is selected as 16 c 1 f ψ r d y a 12 p 1 t where f is a linear gain matrix p is a positive and definite matrix if we set ω as a positive definite matrix the following lyapunov criterion equation about p and f can be obtained as 17 a 11 a 12 f t p p a 11 a 12 f ω where r d is reference position value y is the controller output value from bandyopadhyay and fulwani 2009 ψ r d y is a negative and continuous nonlinear damping function it is defined as 18 ψ r d y k β exp k α y r d ψ r d y should be equal to zero when the output is far from zero while ψ r d y becomes highly negative when the output approaches desired value k α and k β are positive tuning parameters when k α is higher ψ r d y will be faster convergence to the final state k β contributes to the final damping ratio which reduces the nonlinear function from 0 to k β therefore the damping ratio of the auv controller can change from an initial low value to a higher one when the function decreases from zero to a higher negative value in order to obtain second order sliding controller equation 15 can be differentiated as 19 s t c 1 y z e t c 1 y z e t thus we obtain equations 20 and 21 20 y z e t h z a x t b u t d y z d t 21 s t c 1 h z x t y z d t c 1 h z a x t b u t d y z d t y z d t c 1 h z a x t b u t d c 1 h z a x t a a x t b u t d b u t b u t d if we suppose the uncertainties to be norm bounded i e 22 δ f d 2 c 1 h z d c 1 h z d c 1 a h z d therefore a second order sliding mode controller can be designed by using control input u t in order to keep the real path of auv in the sliding manifold 23 u t c 1 h z b 1 k 1 s t k 2 sign s t c 1 h z x t y z d t c 1 h z a x t b u t y z d t y z d t c 1 h z a x t b u t c 1 h z a x t a a x t b u t b u t from trivedi and bandyopadhyay 2010 the proportional reaching law is given by s t k 1 s t k 2 sign s t where k 1 0 k 2 δ f d are the constants sign represents the signal of 4 1 1 stability proof lyapunov function is defined as follows 24 v 1 t 1 2 s t t s t 25 v 1 t s t t s t s t t c 1 h z x t y z d t c 1 h z a x t b u t y z d t y z d t c 1 h z a x t b u t c 1 h z a x t a a x t b u t b u t b u t δ f d from the controller 23 we have 26 v 1 t s t t δ f d k 1 s t k 2 sign s t s t t δ f d k 2 s t s t t δ f d k 2 0 therefore 25 forces the second order sliding manifold to zero in finite time since k 1 0 k 2 δ f d 4 2 adaptive law for second order sliding mode controller in order to obtain the upper bound disturbance estimation of δ f d an adaptive law has been adopted for the estimation zhang et al 2014a b baek et al 2016 27 u t c 1 h z b 1 k 1 s t σ ˆ k sign s t c 1 h z x t y z d t c 1 h z a x t b u t y z d t y z d t c 1 h z a x t b u t c 1 h z a x t a a x t b u t b u t where σ ˆ k is the estimation of σ k from the adaptation law the estimation of σ ˆ k is 28 σ ˆ k k v s t s t δ 0 s t δ where k v is a positive constant δ is a small positive constant and the estimation error is σ k σ ˆ k σ k in order to prove the controller stability a lyapunov function is selected as 29 v 2 t 1 2 s t t s t 1 2 γ σ k 2 v 1 t s t t s t γ σ k σ k s t t c 1 h z x t y z d t c 1 h z a x t b u t y z d t y z d t c 1 h z a x t b u t c 1 h z a x t a a x t b u t b u t b u t δ f d σ ˆ k σ k σ ˆ k from equations 27 and 28 v 2 t s t t δ f d k 1 s t σ ˆ k sign s t γ σ ˆ k σ k k v s t s t t δ f d σ ˆ k s t σ k s t σ k s t γ σ ˆ k σ k k v s t δ f d σ k s t σ ˆ k σ k γ k v s t s t β s 2 s t 2 β v γ 2 σ ˆ k σ k γ 2 min β s 2 β v 2 γ s t 2 σ k γ 2 where β s σ ˆ k δ f d and β v s t γ k v s t from 28 if β s 0 β v 0 σ k δ f d and γ 1 k v the convergence of the controller is guaranteed thus the above adaptive second order sliding mode controller see fig 5 has not only obtained an improved controller with transient performance but eliminated the chattering effect 5 experimental results in order to verify and analyse the proposed adaptive second order sliding mode path following control methodology of this paper experiments have been made based on the portable auv of fig 1 the hydrodynamic and inertial parameters are illustrated in table 1 and table 2 all the experiments have been made in the songhua lake of jilin province china the external disturbances of song hua lake in the x y and z coordinate are obtained in fig 6 the vehicle size inertial and hydrodynamic parameters are illustrated in tables 1 and 2 respectively in order to testify the performance of proposed controller comparisons have been made including a linear sliding mode controller pid second order sliding mode controller zhang et al 2014a b and proposed adaptive nonlinear second order sliding mode controller see fig 7 in the linear sliding mode controller the tuning parameter is c 1 1 8 1 t in the pid second order sliding mode controller 30 s t k λ s t k d y z e t k p y z e t k i 0 t y z e ς d ς where k p 3 8 k i 3 8 k d 1 and k λ 1 8 the proposed adaptive nonlinear second order sliding mode controller of equation 27 consists of a linear and nonlinear term where k α 0 01 k β 10 k v 0 02 the selections of k α and k β have great effect on the convergence and damping ratio of the sliding surface and controller initially the nonlinear term is at low value state when the system gradually approaches desired state the nonlinear term decreases to a higher negative value thus an auv with the proposed controller will response with low overshoot and small settling time with the changing value of damping ratio in order to obtain low damping ratio and high settling time the linear gain matrix f is designed then p and ω can be obtained by using pole placement technique and 17 from fig 7 the second order sliding mode control provides a smooth and better performance in the implementation of control with less chattering and better convergence accuracy the max absolute depth error at stable state of the proposed controller is less than 0 1 m while the max absolute angular error at stable state of the proposed controller is less than 5 the control responses of proposed adaptive nonlinear second order sliding mode controller is much better than linear sliding mode and second order sliding mode controller with fast settling time and smaller output deviations from the path following experiments of vertical plane in fig 8 a fig 8 f the desired depth is 3 m 15 m and 30 m in sequence through the control of the horizontal wings the vehicle can follow the desired depth change accurately through the proposed adaptive second order sliding mode controller from the auv heading switch control experiments in fig 8 g fig 8 k the desired heading degrees are 50 110 and 80 respectively the changing rate of the rudder is about 1 3 per second due to the environmental disturbance the angle of the vertical rudder had to change frequently to realize the heading switch control through the control of the vertical rudders the vehicle can follow the desired heading changes accurately through the proposed adaptive second order sliding mode controller in the path following experiments of horizontal plane the desired path is illustrated in fig 9 a the coordinate of the start point is 836 194 while the coordinate of the end point is 475 164 the bottom of the lake is sampled through the portable auv with a sidescan see fig 9 b fig 9 f from the experiments the designed adaptive second order sliding mode controller can precisely follow the path and sample the lake bottom figures with sidescan 6 conclusions this paper has proposed a novel adaptive second order sliding mode controller in order to improve path following performance for a portable auv the proposed nonlinear slider surface has introduced a nonlinear function to change controller s damping ratio in compare with the linear and pid second order sliding mode controller the proposed controller not only provides better response with faster convergence and smaller overshoot but also eliminates the chattering effects of control output moreover the adopted adaptive tuning law estimated the upper bound of external disturbance in the lake experiments the proposed controller not only provides better response with faster convergence and smaller overshoot but also eliminates the chattering effect of control output in compare with the controller with linear and pid second order sliding mode surface acknowledgements this project is supported by national science foundation of china no 5129050 51579053 61633009 major national science and technology project 2015zx010411 01 the promotion funds for the national significant requirements of central universities heucfp201603 and also funded by the key basic research project of shanghai science and technology innovation plan no 15jc140 3300 all these supports are highly appreciated 
23597,accurate path following control plays an important role for autonomous underwater vehicles auv in the oceanic surveys and exploration in the consideration with nonlinearity and external disturbance the dynamic model of a portable auv has been established on the basis of its actuation and control characteristics an adaptive nonlinear second order sliding mode controller has been deduced to eliminate the chattering motion through a sliding surface during the path following control on the uncertainties of external disturbances an adaptive tuning law has been selected to estimate the upper bound of disturbance in the lake experiments the proposed controller not only provides better response with faster convergence and smaller overshoot but also eliminates the chattering effect of control output in compare with the controller with linear and pid second order sliding mode surface keywords autonomous underwater vehicle sliding mode control path following 1 introduction being the focus of many marine researchers around the globe autonomous underwater vehicles auvs play an important role in underwater surveillance missions including military operation and pipeline inspection koena et al 2015 a number of missions such as target carpet searching chen 2008 seafloor terrain survey and autonomous underwater docking robert et al 2008 require auv to move within a range of depth or to maintain the boundary height of terrain to obtain high quality data hangil et al 2014 considerable researches have been performed to address precise attitude and trajectory control to obtain quality data such as pd control huang and kreuzer 2007 neural network control bagheri et al 2010 robust control divine et al 2015 and so forth ehsan peymani et al reformulated auv modeling into a constrained multi body system designed a path manoeuvring controller by using lagrange multipliers ehsan and fossen 2015 for a slender and streamlined auv various model based synthesis and controllers have been investigated chu et al 2016 he et al 2014 the auv is usually underactuated with vertical rudders and horizontal wings and it confronts with model non linearity unknown hydrodynamic coefficients and time varying disturbances with controller parameters independent to external disturbance sliding mode control possesses strong robustness in the presence of unknown disturbances and modeling error hangil joe et al has developed a second order sliding mode controller in order to compensate for the uncertainties in the hydrodynamic and unpredictable disturbance effects due to ocean currents hangil et al 2014 rongxin cui et al proposed an adaptive dynamic anti windup sliding mode attitude controller on the basis of dead zone model the controller has employed a nonlinear disturbance observer and an auxiliary dynamic compensator for the dead zone nonlinearity and rudder saturation cui et al 2016 sheng ping hsu et al proposed a modified depth control loop through pitch attitude and stern plane deflections hsub and liu 2014 however the major drawback of sliding mode controller is chattering effect ismail et al 2016 chattering is the high frequency amplitude oscillations due to the discontinuous control signal which is extremely dangerous for actuators systems adaptive concept has been utilized to minimize chattering effect zaopeng dong et al have presented a state feedback based back stepping control algorithm in the presence of constant and ocean current disturbance hangil et al 2014 with the expression of the relationship between desired heading angle and direction angle of the ocean current the controller has further been enriched through an additional integral action in order to enhance the steady state performance dong et al 2015 jian xu et al have proposed a novel adaptive dynamical sliding mode control based methodology to enhance the robustness in the presence of environmental disturbances it utilized a virtual velocity variable to represent the attitude error so as to avoid the representation singularities and simplify the analytical expression of the controller xu et al 2015 in order to reduce the chattering effect in the trajectory control of underwater vehicle soylu et al proposed an adaptive concept to replace the switching term in conventional sliding mode control soylu et al 2008 fuzzy strategy and neural network can be used to estimate uncertainty items online to reduce system chattering bessa et al 2010 in order to minimize chattering effect and improve control resolution against unknown disturbance through exercise rules bessa et al proposed an adaptive fuzzy sliding mode controller with a boundary layer to deal with the parameter uncertainties external disturbance and chattering effect shahraz and boozarjomehry 2009 xun zhang et al introduced adaptive switching law with t s fuzzy observer to estimate the auv states and reduced trajectory tracking error furthermore fuzzy strategy and neural network can be used to estimate uncertainty items online to reduce system chattering zhang et al 2014a b ming jun zhang et al have issued an adaptive sliding control method switch gain adjustment method has been employed to deal with chattering problem network has been employed to estimate unknown items online zhang and chu 2012 however the use of fuzzy control in the sliding mode controller requires many rules to achieve good performance which also reduces the robustness of the auv further the more rules are required the more energy will be consumed for a portable auv cruising underwater it tends to be affected by disturbance model uncertainty although with its inherent robustness sliding mode controller will cause chattering effect which is very dangerous for thrusters with electromechanical systems this manuscript will propose an adaptive second order sliding mode controller for the auv path following control the major contribution is the following ① the adaptive second order sliding mode controller is proposed to improve the transient performance for the auv control system ② the basic idea of proposed adaptive second order sliding mode controller is to eliminate the oscillation phenomenon through control input time derivative and signal integration ③ the estimation of external disturbance upper bound will be employed to reduce the energy consumption this study is organized into six sections following the introduction the control architecture of a portable auv is described in section 2 motion modeling for the auv is investigated in section 3 in section 4 an adaptive sliding mode controller is issued for path following control an adaptive tuning law is selected to estimate the upper bound of external disturbance in section 5 experiments are performed to verify the proposed control methodology and demonstrate its superiority in path following for the portable auv finally conclusions are drawn in section 6 2 control architecture of a portable auv an integrated portable auv has been designed for oceanic exploration with the streamlined shape like a torpedo the portable auv has been divided into three sections e g fore mid and stern see fig 1 auv s cruising diving and yawing are realized through a propeller horizontal and vertical fins navigation and position reckoning will be realized through magnetic compass depth gauge dvl through open source thrust experiments the thrust volt curves of the propeller are obtained in fig 2 a lift and draft coefficient curves of the fins are obtained through surface element algorithm in fig 2 b the software of control architecture see fig 3 is written in the c language each module subsystem works distributed and independently with independent task progress and unified communication protocol information transmission between surface industrial personal computer and cabin pc 104 module is client server in the cabin pc 104 module is employed for information interaction process 3 auv motion modeling if we establish earth fixed coordinate frame x e y e z e and auv fixed coordinate frame x v y v z v the motion model in vertical plane is shown in fig 1 where x y z and ϕ θ ψ represent auv position and orientation respectively u v ω p q r denote auv linear and angular velocities the kinematics equations of auv motion can be expressed as wadoo and kachroo 2011 1 x y z ϕ θ ψ cos ψ cos θ 0 0 0 sin ψ cos θ 0 0 0 sin θ 0 0 0 0 1 sin ϕ tan θ cos ϕ tan θ 0 0 cos ϕ sin ϕ 0 0 sin ϕ sec θ cos ϕ sec θ v p q r if yaw shake and roll can be ignored the auv motion equation in the vertical plane can be expressed as 2 x m x u u y m y v v z m z w w m i y m q q n i z n r r where m represents the mass of the auv if we set x u y v z q n r n v and m q as speed coefficient x u u y v v z q q m w w m w q n r r and m q q as the second order speed coefficient x w q x q q as second order speed correction coefficient τ t as thrust force δ s and δ r are the angle of vertical and horizontal fins respectively d 1 d 2 and d 3 are external disturbances y δ r is the coefficients of the vertical fins x δ s δ s and z δ s are effect the coefficients of the horizontal fins one has 3 x x u u x u u u u x w q w q x q q q 2 x δ s δ s u 2 δ s 2 τ t d 1 y y v v y v v v v m y r u r y δ r u 2 δ r d 2 z z q u q z q q q q z w u w z w w w w z δ s u 2 δ s d 2 m m q u q m q q q q m w w w w m w u w m w q w q z δ s l s u 2 δ s d 3 n n r u r n r r r r n v u v y δ r l r u 2 δ r d 3 the thruster usually consists a dc motor and propeller its thrust force can be obtained as omerdic and roberts 2004 4 τ t ρ d 4 k t d j 0 n n where d is the diameter of propeller ρ is water density k t d is the thrust coefficient n is the propeller shaft speed j 0 is speed related coefficient if we set u a as ambient water velocity we have j 0 u a n d for an under actuated auv motion of vertical plane is usually realized through horizontal wings and thruster while vertical rudders and thruster are responsible with the motion of horizontal plane when the wings move with the speed v and effective attack angle α they are subjected to the lift l vertical to the flow direction and the resistance d against the flow liang et al 2016 5 l c l α 1 2 ρ a r δ e v 2 d c d α 1 2 ρ a r δ e 2 v 2 where δ e is the effective angle of the fin c l α is the lift coefficient c d α is the resistance coefficient a r is the projection area of the fin profile c l α is the function of α if we set c l as the lift coefficient according to the hoerner and whicker empirical formula α 0 9 c l α and c d α can be improved as 6 c l α d c l d α 1 2 α π 1 2 π λ 1 c d α c d 0 c l α 2 a u π λ where λ is the effective span and chord ratio 7 λ b w i n g 2 s w i n g where s w i n g is the effective area b is the span of wing length a u is auxiliary value c d 0 is the resistance coefficient of the wing s shape if we set β s e as effective attack angle of the wing at zero plane the relationship between the wing s effective angle δ e and the angle δ s referenced to the vehicle hull is see fig 4 8 δ e δ s β s e if x fin y fin z fin is set as offset distance of the wings from desired installation position the effective speed u fin v fin w fin of the wings is 9 u f i n u z f i n q y f i n r v f i n v x f i n r z f i n p w f i n w y f i n p x f i n q then we have β s e t g β s e w f i n u f i n thus the applied force from the fin is 10 τ δ x δ z δ m δ x δ s δ s δ s 2 z δ s δ s z δ s l s δ s if set t e as time constant k e as control gains we obtain the model as 11 δ s 1 t e δ s k e t e δ s 4 terrain following control methodology in vertical plane 4 1 nonlinear second order sliding mode controller in order to realize path following control for precise control and regional search an adaptive sliding mode controller have been designed to create forces and moments equilibrium for simplification we take the motion of vertical plane for example in the investigation so that the motion of horizontal plane can be deduced similarly thus equations 1 and 3 can be rewritten as 12 u a 11 u a 12 q b 11 δ s 2 b 12 τ t d 1 w a 21 q a 22 w b 21 δ s d 2 where a 11 x u x u u u m x u a 12 x w q w x q q q m x u b 11 x δ s δ s u 2 m x u b 12 1 m x u d 1 d 1 m x u and a 21 z q u z q q q m z w a 22 z w u z w w w m z w b 21 z δ s l s u 2 m z w d 2 d 2 m z w if we set x u w t d d 1 d 2 as the bounded lumped uncertainty vector h z 1 0 t as the output vector and equation 12 can be written as 13 x a x b u d y z h z x where a a 11 a 12 a 21 a 22 is the system matrix x u w is the state vector u δ s τ t δ s 2 0 is the input matrix b b 11 b 12 b 21 0 is the matrix of nonlinear terms for underactuated auv the objective of the control in the vertical plane is to follow the terrain at desired speed 14 lim t t 0 y z y z d ξ where ξ is any small positive y z d u d w d t is desired state of auv longitude and vertical speed if y z e y z d y z is set as the auv cruising error in the vertical plane the linear sliding mode surface controller can be obtained as 15 s t c 1 y z e t where c 1 c 1 t in order to improve the transient performance of the auv closed loop system a nonlinear sliding surface based second order sliding mode controller is proposed on the basis of 15 the sliding surface is selected as 16 c 1 f ψ r d y a 12 p 1 t where f is a linear gain matrix p is a positive and definite matrix if we set ω as a positive definite matrix the following lyapunov criterion equation about p and f can be obtained as 17 a 11 a 12 f t p p a 11 a 12 f ω where r d is reference position value y is the controller output value from bandyopadhyay and fulwani 2009 ψ r d y is a negative and continuous nonlinear damping function it is defined as 18 ψ r d y k β exp k α y r d ψ r d y should be equal to zero when the output is far from zero while ψ r d y becomes highly negative when the output approaches desired value k α and k β are positive tuning parameters when k α is higher ψ r d y will be faster convergence to the final state k β contributes to the final damping ratio which reduces the nonlinear function from 0 to k β therefore the damping ratio of the auv controller can change from an initial low value to a higher one when the function decreases from zero to a higher negative value in order to obtain second order sliding controller equation 15 can be differentiated as 19 s t c 1 y z e t c 1 y z e t thus we obtain equations 20 and 21 20 y z e t h z a x t b u t d y z d t 21 s t c 1 h z x t y z d t c 1 h z a x t b u t d y z d t y z d t c 1 h z a x t b u t d c 1 h z a x t a a x t b u t d b u t b u t d if we suppose the uncertainties to be norm bounded i e 22 δ f d 2 c 1 h z d c 1 h z d c 1 a h z d therefore a second order sliding mode controller can be designed by using control input u t in order to keep the real path of auv in the sliding manifold 23 u t c 1 h z b 1 k 1 s t k 2 sign s t c 1 h z x t y z d t c 1 h z a x t b u t y z d t y z d t c 1 h z a x t b u t c 1 h z a x t a a x t b u t b u t from trivedi and bandyopadhyay 2010 the proportional reaching law is given by s t k 1 s t k 2 sign s t where k 1 0 k 2 δ f d are the constants sign represents the signal of 4 1 1 stability proof lyapunov function is defined as follows 24 v 1 t 1 2 s t t s t 25 v 1 t s t t s t s t t c 1 h z x t y z d t c 1 h z a x t b u t y z d t y z d t c 1 h z a x t b u t c 1 h z a x t a a x t b u t b u t b u t δ f d from the controller 23 we have 26 v 1 t s t t δ f d k 1 s t k 2 sign s t s t t δ f d k 2 s t s t t δ f d k 2 0 therefore 25 forces the second order sliding manifold to zero in finite time since k 1 0 k 2 δ f d 4 2 adaptive law for second order sliding mode controller in order to obtain the upper bound disturbance estimation of δ f d an adaptive law has been adopted for the estimation zhang et al 2014a b baek et al 2016 27 u t c 1 h z b 1 k 1 s t σ ˆ k sign s t c 1 h z x t y z d t c 1 h z a x t b u t y z d t y z d t c 1 h z a x t b u t c 1 h z a x t a a x t b u t b u t where σ ˆ k is the estimation of σ k from the adaptation law the estimation of σ ˆ k is 28 σ ˆ k k v s t s t δ 0 s t δ where k v is a positive constant δ is a small positive constant and the estimation error is σ k σ ˆ k σ k in order to prove the controller stability a lyapunov function is selected as 29 v 2 t 1 2 s t t s t 1 2 γ σ k 2 v 1 t s t t s t γ σ k σ k s t t c 1 h z x t y z d t c 1 h z a x t b u t y z d t y z d t c 1 h z a x t b u t c 1 h z a x t a a x t b u t b u t b u t δ f d σ ˆ k σ k σ ˆ k from equations 27 and 28 v 2 t s t t δ f d k 1 s t σ ˆ k sign s t γ σ ˆ k σ k k v s t s t t δ f d σ ˆ k s t σ k s t σ k s t γ σ ˆ k σ k k v s t δ f d σ k s t σ ˆ k σ k γ k v s t s t β s 2 s t 2 β v γ 2 σ ˆ k σ k γ 2 min β s 2 β v 2 γ s t 2 σ k γ 2 where β s σ ˆ k δ f d and β v s t γ k v s t from 28 if β s 0 β v 0 σ k δ f d and γ 1 k v the convergence of the controller is guaranteed thus the above adaptive second order sliding mode controller see fig 5 has not only obtained an improved controller with transient performance but eliminated the chattering effect 5 experimental results in order to verify and analyse the proposed adaptive second order sliding mode path following control methodology of this paper experiments have been made based on the portable auv of fig 1 the hydrodynamic and inertial parameters are illustrated in table 1 and table 2 all the experiments have been made in the songhua lake of jilin province china the external disturbances of song hua lake in the x y and z coordinate are obtained in fig 6 the vehicle size inertial and hydrodynamic parameters are illustrated in tables 1 and 2 respectively in order to testify the performance of proposed controller comparisons have been made including a linear sliding mode controller pid second order sliding mode controller zhang et al 2014a b and proposed adaptive nonlinear second order sliding mode controller see fig 7 in the linear sliding mode controller the tuning parameter is c 1 1 8 1 t in the pid second order sliding mode controller 30 s t k λ s t k d y z e t k p y z e t k i 0 t y z e ς d ς where k p 3 8 k i 3 8 k d 1 and k λ 1 8 the proposed adaptive nonlinear second order sliding mode controller of equation 27 consists of a linear and nonlinear term where k α 0 01 k β 10 k v 0 02 the selections of k α and k β have great effect on the convergence and damping ratio of the sliding surface and controller initially the nonlinear term is at low value state when the system gradually approaches desired state the nonlinear term decreases to a higher negative value thus an auv with the proposed controller will response with low overshoot and small settling time with the changing value of damping ratio in order to obtain low damping ratio and high settling time the linear gain matrix f is designed then p and ω can be obtained by using pole placement technique and 17 from fig 7 the second order sliding mode control provides a smooth and better performance in the implementation of control with less chattering and better convergence accuracy the max absolute depth error at stable state of the proposed controller is less than 0 1 m while the max absolute angular error at stable state of the proposed controller is less than 5 the control responses of proposed adaptive nonlinear second order sliding mode controller is much better than linear sliding mode and second order sliding mode controller with fast settling time and smaller output deviations from the path following experiments of vertical plane in fig 8 a fig 8 f the desired depth is 3 m 15 m and 30 m in sequence through the control of the horizontal wings the vehicle can follow the desired depth change accurately through the proposed adaptive second order sliding mode controller from the auv heading switch control experiments in fig 8 g fig 8 k the desired heading degrees are 50 110 and 80 respectively the changing rate of the rudder is about 1 3 per second due to the environmental disturbance the angle of the vertical rudder had to change frequently to realize the heading switch control through the control of the vertical rudders the vehicle can follow the desired heading changes accurately through the proposed adaptive second order sliding mode controller in the path following experiments of horizontal plane the desired path is illustrated in fig 9 a the coordinate of the start point is 836 194 while the coordinate of the end point is 475 164 the bottom of the lake is sampled through the portable auv with a sidescan see fig 9 b fig 9 f from the experiments the designed adaptive second order sliding mode controller can precisely follow the path and sample the lake bottom figures with sidescan 6 conclusions this paper has proposed a novel adaptive second order sliding mode controller in order to improve path following performance for a portable auv the proposed nonlinear slider surface has introduced a nonlinear function to change controller s damping ratio in compare with the linear and pid second order sliding mode controller the proposed controller not only provides better response with faster convergence and smaller overshoot but also eliminates the chattering effects of control output moreover the adopted adaptive tuning law estimated the upper bound of external disturbance in the lake experiments the proposed controller not only provides better response with faster convergence and smaller overshoot but also eliminates the chattering effect of control output in compare with the controller with linear and pid second order sliding mode surface acknowledgements this project is supported by national science foundation of china no 5129050 51579053 61633009 major national science and technology project 2015zx010411 01 the promotion funds for the national significant requirements of central universities heucfp201603 and also funded by the key basic research project of shanghai science and technology innovation plan no 15jc140 3300 all these supports are highly appreciated 
23598,coastal hypoxia is on the rise around the world reducing secondary production and ecosystem services in estuarine and coastal regions we propose a tidal pump consisting of a 90 bend and a vertical downwelling pipe that potentially mitigates hypoxia in bottom waters downwelling kinetic head presents an approximate linear dependence on incident kinetic head experiments were carried out on a physical model at 1 80 scale covering a wide range of current speeds and density difference heads experimental findings confirm the theoretical model downwelling flow rate mainly depends on tidal current speed relative density difference the immersed length of the pump below the pycnocline and the pump geometry the latter two of which allow engineers actively regulate downwelling flow in the changjiang estuary where hypoxia frequently occurs below the pycnocline during late summers surface oxygen rich water could be pumped into a depth 15 36 m below the pycnocline at a flow rate of 0 4 m3 s for 1 2 m pipe diameter further study will focus on the deployment of the tidal pump to obtain the optimal dissolved oxygen do concentration field in bottom waters keywords tidal pump artificial downwelling coastal hypoxia 2010 msc 00 01 99 00 1 introduction in coastal and estuarine regions hypoxia occurs when the concentration of dissolved oxygen diminishes to a point harmful to aquatic organisms zillén et al 2008 reasons for coastal hypoxia are rather complicated involving both anthropogenic factors such as eutrophication and global climate change and natural conditions such as stratification and hydromorphology chen et al 2007 conley 2012 rabalais et al 2009 it is reported nowadays that major fishery areas the baltic kattegat black sea gulf of mexico and east china sea are suffering ecological degradation and loss of biomass as a result of coastal hypoxia diaz and rosenberg 2008 hard situations entail active management on hypoxic regions conley 2012 indicates that the external nutrient loads control is fundamental for coastal hypoxia restoration however several decades may be taken before effects of nutrient input management on coastal hypoxia do occur stigebrandt and gustafsson 2007 uncertainty during such a long period of time fuels the development of large scale engineering solutions that aim to help deteriorated ecosystems recover from hypoxia one concept among others is artificial downwelling where surface water of nearly saturated do concentration is driven towards hypoxic bottom layers through an erect pipe antonini et al 2016 at the pipe outlet the downwelling flow evolves into a buoyant jet with intense entrainment of surrounding water forming an expansive oxygen rich layer below the pycnocline to relieve hypoxia bendtsen et al 2013 present study focus on various approaches of artificial downwelling and their environmental effects on where they were applied ouchi and nakahara 1999 introduced a concept of density current generator dcg powered by solar energy to bring surface water down and bottom water up to an intermediate layer the wide area survey of seafloor at gokasho bay japan in 2006 where a dcg had worked for ten years confirms the dcg effects of avoiding hypoxia and improving benthos ouchi et al 2008 in the baltic sea abundant energy of wind and wave can potentially drive downwelling flow stigebrandt et al 2015 had employed a wind pump system to generate continuous downwelling flow at 2 m3 s at by fjord for two years and a half carstens 2008 concludes that 300 to 1200 breakwaters in a range of 15 60 km width would add 100 kg of oxygen per second to the subhalocline waters of the baltic sea an oxygen flux which keeps the waters well oxygenated this plan was projected to cost about 170 680 million euros recently the concept of wave utilization to pump surface well oxygenated water was proposed margheritini and claeson 2011 antonini et al 2012 antonini et al 2015 examined the performance of a wave driven device named oxyflux for artificial downwelling it is estimated that 750 000 m3 surface water corresponding to 5200 kg do could reach sea bottom during the mild season 1st may 30st sep in the northern adriatic coast potential benefits of artificial downwelling are identified by a drastic decline in the content of hydrogen sulfide and ammonia as well as biomass enrichment during the operation the development of these engineering techniques serves possibility to carry out artificial downwelling in large scale and thereafter to understand related ecological effect the changjiang estuary has become one of the largest areas suffering seasonal hypoxia in the world chen et al 2007 however hardly have engineering techniques been reported so far to change the status quo shown in fig 1 are the observation sites off the changjiang estuary during july 18 23 2006 horizontal distributions of do and density anomaly near the surface and those near the bottom zhu et al 2016 the do concentration at the bottom is 3 mg l or less in most of the measured regions and the density difference that could reach about 8 kg m3 is considered an important physical condition in formation of low content of do below the pycnocline decomposition of increasing organic matter from both fluvial input and marine origin greatly consumes oxygen in bottom waters but without replenishment from the surface where do concentration is comparatively high as a result of full air sea exchange chen et al 2007 semi diurnal tidal current widely exists in the changjiang estuary and its adjacent areas in situ observed data from tide gauge stations indicates that surface current could reach its peak in the range of 1 1 6 m s during spring tide chen et al 2003 hopefully the kinetic energy of the surface current could be utilized for driving downwelling flow to improve do condition in bottom waters the application of a 90 bend to a vertical pipe may induce downward flow and fig 2 presents the sketch the deployment of the pump requires present mooring technology a floating platform is symmetrically achored by four mooring lines to seabed and equipped with an electric winch used to launch and reclaim the pump through wireropes the pump indirectly connects to the ends of the wire ropes through a universal joint so that it can move freely under current forces on the back of the upper bend is a flow director keeping the pump consistently toward incident flow direction and deviations from this direction make the pump unbalanced subjecting to the moment of horizontal flow a ballast hanging on the lower end of the pump does utmost to keep the downwelling pipe erect if tidal current is strong enough to overcome stratification downwelling flow can be produced evolving into an oxygen rich buoyant plume below the pycnocline which offers in situ condition for experimentally studying related ecological effects of artificial downwelling the present study aims to verify the proof of concept of current induced downwelling and study the downwelling capacity of the pump while several assumptions for simplification are made at first auxiliary parts in the pump such as the flow director ballast iron handles and mooring system have little impact on downwelling flow hence not considered in the study secondly the pump can be assumed vertical by choosing a proper ballast last but not least waterbody below the pycnocline is stagnant the paper is organized as follows 1 theory modelling on the tidal pump 2 scale model experiments for different conditions of tidal current and stratification 3 validation of the theory and discussion 4 a summary of conclusions 2 theoretical model fig 3 physically describes the mechanism of the pump when passing over the upper bend inlet of the pump horizontal current decelarates because of the blocking effect according to bernoulli principle this deceleration increases static pressure at the entrance which if large enough to overcome stratification will drive downwelling flow in the pump the energy balance principle eq 1 is prevalently used in engineering analysis of turbulent pipe flows without concerning about the detailed structure of flow field also this principle has managed to be applied for artificially vertical perturbance of ocean environment fan et al 2013 antonini et al 2015 for current induced downwelling water flow in the pump tends to be reversed when surrounding dense water applys buoyancy to the water column in the pump the kinetic energy of horizontal current should be large enough to maintain continuous downwelling flow where molecular viscosity and turbulent eddies dissipate the remaining kinetic energy of downwelling flow the energy equilibrium can be written in the following head form 1 m a x h k h ρ 0 h f where h k is the incident kinetic head h ρ is the work per unit weight performed against buoyancy while downwelling surface water towards heavier deep water and h f is the total fluid motion head loss h k is given by v h 2 2 g where v h is the horizontal current velocity at the upper inlet of the pump and g is the gravity acceleration h ρ can be calculated from the integral of relative density difference along the length of the pump hsieh et al 1978 cartesian coordinate system used is depicted in fig 3 density at the pump entrance and all along the down welling pipe are equal if there is a circulation and generally different from density in the surrounding water the density difference head in downwelling flow can be expressed as follows 2 h ρ z i z o ρ z ρ i ρ i d z where z i and z o are the water depth at the pump entrance and exit respectively ρ z is the vertical density profile of surrounding waters where z represents the variable of water depth and ρ i is the water density at z z i h f is the sum of frictional loss bend loss entrance loss and exit loss 3 h f λ l d ξ c ξ i n ξ o u t h d where l and d are the downwelling pipe length and diameter respectively h d is the downwelling kinetic head given by v d 2 2 g and v d is the average flow speed in the pump for turbulent flow λ is the darcy weisbach friction factor that can be iteratively solved by the colebrook white equation 4 1 λ 2 log δ 3 7 d 2 51 r e λ where δ is the inner wall roughness of the pump affected by such processes as bio fouling and marine corrosion and r e is defined as 5 re ρ i v d d μ where μ is the dynamic viscosity of water downwelling flow in the prototype is typically turbulent since reynolds number for that ranges from 4 10 5 to 2 10 6 ξ c is the bend loss coefficient related to friction and separation of water flow in the bend crawford et al 2003 ito 1960 reported a formulas for ξ c suitable for the prototype by considering the combination of frictional and separating effect 6 ξ c 0 217 re 0 17 0 95 2 r d 0 84 17 2 2 r d 1 12 where r is the curving radius of the bend ξ i n is the entrance loss coefficient to be dismissed since there is no tendency to either distort streamlines or introduce turbulent eddies at the upper entrance the entrance edge should be parallel to the incident flow direction otherwise the pump with the flow director becomes unbalanced under the moment of horizontal current ξ o u t is the exit loss coefficient equal to 1 in stagnant bottom waters antonini et al 2015 the theoretical model can be so far written in a new form 7 m a x h k h ρ 0 h d λ l d ξ c 1 ξ t h d where ξ t is the total loss coefficient mainly related to reynolds number and the pump geometry fig 4 presents the total loss coefficient for the studied range of reynolds number in the prototype suggesting that the coefficient can be assumed constant and equals to an average value of 0 75 as reynolds number increases by five times the coefficient only increases by 5 2 as a result of weakening of viscosity force 3 experimental setup and methods 3 1 facility and setup scale model experiments were conducted in the flume at the offshore laboratory of zhejiang university china to verify the theoretical model and to experimentally study the effect of tidal current and stratification on the performance of the pump the flume is 12 m long 0 5 m wide with an available depth of 0 4 m and equipped with a closed looped system for pumping the flow pump is capable of pumping fresh water from an underground reservoir at a maximum flow rate of 120 l s the vibrant nature of the pump makes it necessary to install a honeycomb tube whose height overtops the water level to dampen fluctuation and smooth turbulence on the incoming flow during experiments flume flow rate was set up and visualized on a server fig 5 presents the experimental setup a 1 80 model was designed for the study of a 20 m long pump submerged into a 30 m deep waterbody accordingly the target water level h 0 should be invariably 37 5 cm for all the tests this setup takes fully advantage of the flume the water level was maintained by adjusting manually the opening of the tail gate and recorded by a water level gauge fixed on the flume water level fluctuation is between 37 13 cm and 38 48 cm during the experiments a two layer model was employed for simulating the basic characteristics of natural stratification salty water corresponding to sub pycnocline water was contained in an acrylic water tank two identical trapezoid platforms that have a 1 4 slope and a deck part exactly attached the front and the rear of the tank respectively in case strong flow distortion due to sudden contraction fig 5 the platform is of steel bar structure where smooth plexiglass partitions is fixed and overspread on the top the incoming flow first accelerates on the slope and then maintains its speed constant along the deck part to provide a uniform flow condition water inside the platform connected to the outside through an opening at the bottom of the platform and was nearly stagnant the salty water was prepared by the mixture of fresh water and industrial salt weighed by an electronic scale in 0 1 g accuracy the density of salty water is calculated from the equation of state for seawater where temperature and salinity were simultaneously measured by a precalibrated thermo conductivity meter 8371 az instrument corp china the tank has the same width as the flume and a length of 30 cm and was designed to be 25 cm tall removal of top lid for a pycnocline depth of 10 m the top lid of the tank is 8 mm thick and 30 mm shorter in length than the tank leaving a gap completely covered by a 50 mm long plastic membrane glued on the lid to reduce unnecessary dilution while keep pressure equilibrium in the tank everytime the salty water had been prepared in the tank it took about 3 min to recover the target water level in the flume again the membrane tightly attached to the gap prevented water exchange between the tank and the outside during this period the membrane was recovered to its natural status afterward fig 5 to keep pressure equilibrium in the tank the salty water was inevitable diluted during measurements because the downwelling flow entered into the tank and water exchange existed at the gap the dilution effect on the stratified condition will be discussed in section 4 1 the scaled pump consisting of a stainless steel bend and a transparent pvc pipe was solidly fixed on the top of the water tank through a flange plate which maintains the upper bend inlet toward the incoming flow fig 6 a the on off valve mounted on the upper bend inlet is closed if there was no need for the generation of downwelling flow the dimensions of the pump are marked in fig 6 b 3 2 flow measurements horizontal flow speeds at the bend inlet were obtained based on the velocity distribution over the bisector of the smooth rectangular open channel and its final results can be calculated by the production of an average velocity in the section and a correction factor depending on the section aspect ratio and on the position of the pump entrance sun et al 2004 experimentally attained a parabolic distribution that is suitable and used in the experiments average velocities in the section and their modified values are listed in table 2 the downwelling flow was traced by releasing ink right ahead of the bend inlet the ink released from a 5 ml syringe whose needle perpendicular to the incident flow dyed the downwelling flow in the pump traditional techniques regarding flow visualization may fail to trace because water from the underground reservoir carries large amounts of impurity that strongly interferes with tracing processes moreover the installation of velocimetries is limited by the small pipe diameter which even if did successfully would lead to an unwanted water head loss in the downwelling flow the ink instead affects scarcely the total water head of the downwelling flow and can be easily captured by cameras a high definition camera sony hdr pj675 with a sampling rate of 25 fps was mounted on one side of the flume to record a video sequence of the ink head in the downwelling pipe to counteract possible reflection and strengthen colour contrast of ink to the background a led type plane light source on the opposite side was used the average speed can be obtained by dividing the travelling distance of the ink head by the time interval during experiments a couple of images were selected when the ink head initially appeared to be visible in the pipe and the ink head reached the lower end of the pipe if the image pairs has an interval of n the time interval should be n 25 1 s the travelling distance i e the difference of positions between the two ink heads is determined by identifying a conversion factor mm pixel for the pipe region centering on the camera origin prior to the conversion process camera calibration tool box for matlab had been employed for the removal of the lens distortion effect on sampling images we took twelve photos of a 9 12 checkerboards from various camera position and orientations as presented in fig 7 all the photos were automatically detected by the processing procedure to determine the intrinsic and extrinsic camera parameters that are used to undistort raw images the comparison of a couple of raw frames with their undistorted results is fig 8 where the raw frame pair is almostly unchanged after the calibration for all the calibrated image pairs positions of ink heads was picked up from images by using data cursor in matlab finally the average downwelling flow speed is given by 8 v d 24 c f p 2 p 1 n where p 1 and p 2 are the initial and terminal longitudinal pixel coordinate of the ink head in an image couple respectively n is the frame interval and c f is the conversion factor from pixel coordinates to map coordinates equal to 0 333 mm pixel this value is calculated based on geometrical similarity where the visible part of the pipe is known as 192 mm long corresponds to 576 pixels 3 3 similarity design and test conditions similar theories and methods allow studying the downwelling capacity of the pump in practice from its physical model greatly reducing the time and expenses of experiments for the desired conditions and geometry similitude is based on characteristic dimensionless numbers that govern the dynamic of flow field fan et al 2016 geometric similarity requires scaling all the dimensions involved in the prototype at a common ratio so that no distortion of flow structure occurs in the prototype to model transform scaled dimensions include the pipe diameter d the pipe length l the bend curving radius r the mean water level h 0 the pcynocline depth h 0 h 2 and the immersed length of the pump below the pycnocline h 1 9 d r d p d m r p r m l p l m h 0 p h 0 m h 1 p h 1 m h 2 p h 2 m where the subscripts m and p refer to the model and the prototype respectively and r refers to the ratio of the model to the prototype d r is designed to be 80 1 given the limit of the water depth in the test related dimensions in the prototype and in the model are listed in table 1 in current induced artificial downwelling resistance from stratification and inertial forces are predominant whereas the remaining forces are comparatively small the ratio of these two main forces is dimensionless richardson number presenting the dynamic importance of stratification in horizontal flow condition cushman roisin and beckers 2011 10 r i δρ g h ρ u 2 where r i is the dimensionless richardson number u is the typical velocity of horizontal flow δρ ρ is the scale of relative density difference in the fluid and h is the length scale of a stratified layer in this study r i can be expressed as half the ratio of density difference head to incident kinetic head h ρ 2 h k and dynamic similarity can be attained by equaling this value for the model and the prototype 11 r i m ρ o m ρ i m g h 2 m ρ i m v h m 2 ρ o p ρ i p g h 2 p ρ i p v h p 2 r i p where v h is the horizontal flow speed where the upper bend inlet locates h 2 is the characteristic length of the dense bottom waters and ρ i and ρ o are the density of waters above and below the pycnocline respectively dynamic similarity do not necessarily requires the preservation of the relative density difference intensifying the relative density difference in the scale model will increase the scaled velocity and the model reynolds number so that the pipe flow may remain turbulent the density ratio and velocity ratio of the prototype to the model are set to be 1 5 and 4 1 respectively the final range of reynolds numbers in the model is from 1293 to 6574 where some of them are below the lower limit of the turbulent flow r e 2300 such scaled effect will be discussed in section 4 1 table 1 summarizes test conditions for the prototype and the model all the variables regarding basic characteristics of downwelling flow could be mutually transformed between the model and the prototype for instance downwelling flow rates in the prototype are simply attained by multiplying that measured in the model by the following coefficient 12 q d r v h r d r 2 3 4 test procedure experiments were performed for five density differences and ten flow speeds for every density difference measurements on downwelling flow were conducted at different flow conditions based on increasing flume flow rate with equal spacing the test procedure is described in detail as follows and specific conditions of the model test are summerized in table 2 prepare the salty water in the tank and recording the water temperature and salinity measured by the thermo salinity meter the density of the salty water can be obtained from the equation of state for sea water by using the measurement values start up the pumping system and retaining water in the flume to reach a depth of 37 5 cm this process takes about 3 min and the membrane should be tightly attached to the gap on the top of the tank to prevent unnecessary dilution in salty water during this period it is not until the water level is stable that the membrane recovers its natural status open the camera to record the whole process of the group of tests in this stage horizontal flow speeds are obtained by equal space increment of flume flow rate of 1 5 l s from 15 to 28 5 l s and downwelling flow continues a few seconds for every horizontal flow speed water level is recorded as downwelling flow is generated upon opening the on off valve ink is vertically injected in front of the bend inlet and flows into the pipe with surrounding water the on off valve should be closed when the ink flows out of the pipe avoiding that the downwelling flow intrudes into salty waters to cause further dilution repeat step 1 3 for different density difference heads of 0 0752 0 1465 0 2351 0 3122 and 0 3970 cm in the physical model 4 results and discussion 4 1 validation of the theoretical model the theoretical model is verified by comparison with experiments as presented in fig 9 the independent variable is the dimensionless richardson number r i most dynamically important for current induced downwelling and the dependent variable is the ratio of the downwelling kinetic head to the incident kinetic head illustrating the relative intensity of the downwelling flow the relationship between these two variables can be written by involving r i h ρ 2 h k into eq 7 13 h d h k 1 ξ t m a x 1 2 r i 0 where ξ t is almost a constant value of 1 33 for the prototype weakly affected by reynolds number due to similarity this relationship in the prototype should be followed in the scale model experimental results basically agree with the theory with minus deviations in principle confirming the validity of the model in prediction of current induced downwelling flow in practice the average absolute deviation is 17 3 mainly considered as a result of dilution effect during the tests and of scaled effect from non dimensional characteristics of the forcing condition in each group of tests water exchange between the tank and the outside continuously dilutes the salty water with a commitment decrease in density difference head resulting in overestimations of richardson numbers when density differences are used as before the tests the higher the horizontal velocity the more the time spent on attaining it and therefore the more the dilution in addition the experimental results of relative downwelling intensities tend to be lower than the prediction by the theory as the scaling of the prototype decreases reynolds number to increase the total loss coefficient here is how uncertainties due to the dilution were determined and involved in the final experimental results during each group of tests the density of the salty water was initially prepared and its final average value was calculated based on the measurement results of salinity and temperature of uniformly mixed salty water at the end by using the initial and terminal value of density the amount of water exchange can be subsequently inferred and divided by the horizontal section area of the tank to obtain the thickness of an equivalent fresh water layer lying on the salty water fig 6 b 14 h 3 h 2 m ρ o m ρ om ρ o m ρ i m where h 3 is the thickness of the equivalent fresh water layer ρ o m and ρ om are the initial and final density of the salty water during each group of tests respectively the final density difference head should be h 1 m h 3 h 1 m h ρ m and this value in combination with the initial density difference head h ρ m determines the range of variations of actual density difference head table 3 lists measurement results related to the dilution effect and give ranges of actual density difference head in the model further the final experimental results involving this uncertainty are shown in fig 9 the scaled effect however is too uncertain to determine and may be properly illustrated by the results of the total loss coefficient versus reynolds number as presented in fig 10 the experimental results still gives an evident decreasing tendency to increasing reynolds number and most of them is more than the assumed constant coefficient in the prototype accounting for those minus deviations of the experimental results from the theory as r i increase say the importance of stratification becomes more the relative intensity of the downwelling flow is proportionally decreased the required condition for current induced downwelling is incident kinetic head in excess of density difference head when r i equals 0 5 this is also verified by the experiments when the relative intensity of the downwelling flow h d h k tended to be zero as r i is closed to 0 5 eq 13 can be transformed into a dimensional one for better understanding of downwelling flow rate 15 q d π 4 d 2 v d π d 2 4 ξ t v h 2 2 g h ρ where h ρ if a two layer model is used can be further expressed as the production of relative density difference and the immersed length of the pump below pycnocline 16 h ρ ρ o ρ i ρ i h 1 eqs 15 and 16 indicate that horizontal current speed relative density difference the immersed length and the pump geometry directly influence downwelling flow rate 4 2 horizontal current speed and relative density difference fig 11 presents the downwelling capacity of the prototype as a function of horizontal current speed for different relative density differences downwelling flow rate at the critical point is sensitive to the variance of horizontal current speed especially when stratification becomes more intense for a relative density difference equal to 0 008 horizontal current speed only 0 1 m s higher than the critical point produces a downwelling flow rate of 0 6 m3 s continuing to increase the value of v h will increase downwelling flow rate at slower tendency that gradually converges to the constant slope of 0 98 the functional relationship between downwelling flow rate and horizontal current speed can be employed to predict potential downwelling flux of water do and other biochemical quantities in hypoxic regions in regions of semidiurnal tide horizontal current speed can be treated as the combination of various sinusoidal series with a period of 12 h to illustration fig 12 depicts the response of the prototype to current speed that varies as a sinusoidal function with a peak value of 1 6 m s the prototype could produce promising downwelling flux into the bottom whereas stratification have great damping effect for a relative density difference of 0 008 situation is still encouraging of that pumping surface oxygen rich water of 1988 m3 per day downward into hypoxic bottom waters 15 36 m deeper than the pycnocline from the observation results in 2006 zhu et al 2016 the difference of do concentration between surface waters and bottom waters off the changjiang estuary can be assumed to be 2 mg l therefore oxygen net flux supplied by the prototype is 3 98 kg per day in fig 13 downwelling flow rate in the prototype is plotted versus relative density difference and falls as the increase of the relative density difference in that greater energy demand for overcoming stratification for the given current speed downwelling flow is produced on condition that the range of relative density difference is on the left of the intersection of the corresponding theoretical curve and the transverse axis which can be used to analyse the viability of artificial downwelling off the changjiang estuary for relative density difference between the diluted surface water and the bottom sea water ranging from 0 004 to 0 008 horizontal current reaching its peak at 1 6 m s could drive downward flow in the pump at a flow rate ranging from 0 4 to 1 1 m3 s 4 3 immersed length of the pump below the pycnocline unlike variables determined by environment such as relative density difference and current speed the immersed length of the pump below the pycnocline is instead an adjustable engineering parameter appearing in eq 17 to affect the critical current speed of the prototype 17 v h m i n 2 g h 2 ρ o ρ i ρ i when extending to the eastern areas of the changjiang estuary where hypoxia frequently takes place current speed diminishes and 1 6 m s may be unattainable for most of areas moreover the current speed even if available only holds for a short time period during the spring tide but expected biochemical effect requires continuous downwelling flux into the hypoxic waters to deal with this difficulty a feasible way is to diminish the immersed length by rising the pump otherwise auxiliary power supply with greater expense is necessary to overcome stratification in fig 14 the minimum current speed required decreases as the immersed length decreases and finally becomes zero when the bottom end of the pump reach the pycnocline or shallower consequently continuous downwelling flow is possible for any current condition as long as the pump is properly deployed the immersed length also affects the development of buoyant plume evolved from the entering of downwelling flow into bottom waters the buoyant plume is expected to stay below the pycnocline with do concentration as high as possible to relieve hypoxia and the main obstacles are intense dilution by the surrounding water and re entering of buoyant plume into the surface water smaller immersed length induces more downwelling flow tending to be less diluted yet too short distance between the pump outlet and the pycnocline causes difficulty in capturing buoyant plume below the pycnocline further study should focus on how buoyant plume develops outside the pump in terms of downwelling flow rate and the immersed length the optimal immersed depth if exists would be expected to result in optimal distribution of do concentration below the pycnocline 4 4 pipe diameter and relative bend radius in present study the pump length i e the sum of the pipe length l and the bend radius r is set to be 20 m and fig 15 shows the effect of pump geometry on the total loss coefficient and downwelling flow rate one can directly increase downwelling flow rate by the application of a larger pipe diameter where the total loss coefficient decreases owing to less friction loss yet pipes with large diameter may easily suffer twist or distortion under severe conditions of horizontal current the maximum pipe diameters are supposed to be kept below safety limit for the most severe condition that horizontal current can create the relative bend radius is another parameter unconstrained to be designed too small relative bend radius has strong flow separation with tendency to cause more pressure drop in the bend increasing the total loss coefficient and therefore decreasing downwelling flow rate as relative bend radius varies from 0 5 to 4 the total loss coefficient decreases by 22 resulting in an 11 increase in downwelling flow rate as both of them tend to be constant for the remainder of their theoretical curves a relative bend radius of 1 5 2 5 may be proper for the pump design without introducing energy loss too much but more structural reliability in horizontal current 5 conclusions the tidal pump made by the connection of a 90 o bend and a vertical pipe could potentially induce artificial downwelling driven by tidal currents to mitigate hypoxia at bottom waters theoretical model of the pump indicates that downwelling kinetic head is nearly linearly dependent on incident kinetic head meanwhile the ratio of downwelling kinetic head to incident kinetic head is a monotonic decreasing function of the richardson number r i a characteristic dimensionless number showing the dynamic importance of stratification the required condition for current induced artificial downwelling is r i no more than 0 5 otherwise incident kinetic energy is not enough to overcome stratification model experiments were carried out on the prototype at scale 1 80 covering a wide range of tidal current speeds from 1 12 to 2 12 m s and of density difference heads from 1 2 to 6 4 cm final experimental findings verify the theoretical model that can be used to predict the performance and to guide the design of the pump in practical applications downwelling flow rate mainly depends on horizontal current speed relative density difference the immersed length of the pump below the pycnocline and the pump geometry the prior two are determined by environment and the latter two are instead adjustable engineering parameters either increase in horizontal current speed or decrease in relative density difference tends to provide larger downwelling flow carrying more dissolved oxygen into hypoxic bottoms over times for strong stratification when required horizontal current speed is unattainable or even if attainable yet only holds for a short time period during spring tide one can decrease the immersed length to either lower the threshold of downwelling flow or extend the duration furthermore downwelling flow rate get increased by this way increasing pipe diameter and relative bend radius can produce more downwelling flow though changing these two parameters make no sense facilitating artificial downwelling for large reynolds number the total loss coefficient is mainly affected by the pump geometry if the length of the pump is predetermined both increase in relative bend radius and pipe diameter result in a smaller total loss coefficient that tends to be constant afterward in the diluted area off the changjiang estuary surface well oxygenated water could be pumped into a depth 15 36 m below the pycnocline and at a flow rate of 0 4 m3 s when density difference is up to 8 kg m3 and a horizontal current speed of 1 6 m s exists we may conclude that the concept of downwelling flow driven by tidal currents is viable for the mitigation of hypoxia off the changjiang estuary despite uncertainty that exists in the current knowledge of artificial downwelling to counteract eutrophication a pilot field test of the pump is necessary to understand ecosystem and the evolution of related biochemical variables the problem may be rather complicated in real sea state where current speed also exists at the pump outlet to affect the performance but was not involved in present study moreover how the buoyant plume evolved from the downwelling flow develops should be further studied since its importance for the optimization of do concentration field below the pycnocline acknowledgement this research is financially funded by the national key research and development program of china no 2016yfa0601400 and the national natural science funds of china no 41776084 and no 41406084 we appreciate the reviewers for their comprehensive comments and constructive suggestions on the manuscript nomenclature c f conversion factor from pixel coordinates to map coordinates m pixel d downwelling pipe diameter m g gravity acceleration 9 81 m s2 h length scale of stratification h 1 immersed length of the pump below the pycnocline m h 3 thickness of the equivalent fresh water layer m h d downwelling kinetic head m l downwelling pipe length m n frame interval p 1 p 2 initial and terminal longitudinal pixel coordinate of the ink head in an image pair m q d downwelling flow rate in the pump m3 s r curving radius of the bend m r e reynolds number r i richardson number u typical fluid velocity v d average flow speed in the pump m s h ρ density difference head m h f total fluid motion head loss m h k incident kinetic head m v h horizontal current speed where the pump entrance locates m s z variable of water depth m z i water depth at the pump inlet m z o water depth at the pump outlet m greek symbols δ inner wall roughness of the pump m δρ ρ scale of relative density difference λ darcyweisbach friction factor μ dynamic viscosity of water 0 001 p a s ρ z water density at the depth of z kg m3 ρ i water density at the depth of z i kg m3 ξ t the total loss coefficient ρ o m final average density of the salty water during each group of tests kg m3 ξ c bend loss coefficient ξ i n entrance loss coefficient ξ o u t exit loss coefficient subscripts m referred to the physical model min referred to the minimum value p referred to the prototype r referred to the ratio of the physical model to the prototype 
23598,coastal hypoxia is on the rise around the world reducing secondary production and ecosystem services in estuarine and coastal regions we propose a tidal pump consisting of a 90 bend and a vertical downwelling pipe that potentially mitigates hypoxia in bottom waters downwelling kinetic head presents an approximate linear dependence on incident kinetic head experiments were carried out on a physical model at 1 80 scale covering a wide range of current speeds and density difference heads experimental findings confirm the theoretical model downwelling flow rate mainly depends on tidal current speed relative density difference the immersed length of the pump below the pycnocline and the pump geometry the latter two of which allow engineers actively regulate downwelling flow in the changjiang estuary where hypoxia frequently occurs below the pycnocline during late summers surface oxygen rich water could be pumped into a depth 15 36 m below the pycnocline at a flow rate of 0 4 m3 s for 1 2 m pipe diameter further study will focus on the deployment of the tidal pump to obtain the optimal dissolved oxygen do concentration field in bottom waters keywords tidal pump artificial downwelling coastal hypoxia 2010 msc 00 01 99 00 1 introduction in coastal and estuarine regions hypoxia occurs when the concentration of dissolved oxygen diminishes to a point harmful to aquatic organisms zillén et al 2008 reasons for coastal hypoxia are rather complicated involving both anthropogenic factors such as eutrophication and global climate change and natural conditions such as stratification and hydromorphology chen et al 2007 conley 2012 rabalais et al 2009 it is reported nowadays that major fishery areas the baltic kattegat black sea gulf of mexico and east china sea are suffering ecological degradation and loss of biomass as a result of coastal hypoxia diaz and rosenberg 2008 hard situations entail active management on hypoxic regions conley 2012 indicates that the external nutrient loads control is fundamental for coastal hypoxia restoration however several decades may be taken before effects of nutrient input management on coastal hypoxia do occur stigebrandt and gustafsson 2007 uncertainty during such a long period of time fuels the development of large scale engineering solutions that aim to help deteriorated ecosystems recover from hypoxia one concept among others is artificial downwelling where surface water of nearly saturated do concentration is driven towards hypoxic bottom layers through an erect pipe antonini et al 2016 at the pipe outlet the downwelling flow evolves into a buoyant jet with intense entrainment of surrounding water forming an expansive oxygen rich layer below the pycnocline to relieve hypoxia bendtsen et al 2013 present study focus on various approaches of artificial downwelling and their environmental effects on where they were applied ouchi and nakahara 1999 introduced a concept of density current generator dcg powered by solar energy to bring surface water down and bottom water up to an intermediate layer the wide area survey of seafloor at gokasho bay japan in 2006 where a dcg had worked for ten years confirms the dcg effects of avoiding hypoxia and improving benthos ouchi et al 2008 in the baltic sea abundant energy of wind and wave can potentially drive downwelling flow stigebrandt et al 2015 had employed a wind pump system to generate continuous downwelling flow at 2 m3 s at by fjord for two years and a half carstens 2008 concludes that 300 to 1200 breakwaters in a range of 15 60 km width would add 100 kg of oxygen per second to the subhalocline waters of the baltic sea an oxygen flux which keeps the waters well oxygenated this plan was projected to cost about 170 680 million euros recently the concept of wave utilization to pump surface well oxygenated water was proposed margheritini and claeson 2011 antonini et al 2012 antonini et al 2015 examined the performance of a wave driven device named oxyflux for artificial downwelling it is estimated that 750 000 m3 surface water corresponding to 5200 kg do could reach sea bottom during the mild season 1st may 30st sep in the northern adriatic coast potential benefits of artificial downwelling are identified by a drastic decline in the content of hydrogen sulfide and ammonia as well as biomass enrichment during the operation the development of these engineering techniques serves possibility to carry out artificial downwelling in large scale and thereafter to understand related ecological effect the changjiang estuary has become one of the largest areas suffering seasonal hypoxia in the world chen et al 2007 however hardly have engineering techniques been reported so far to change the status quo shown in fig 1 are the observation sites off the changjiang estuary during july 18 23 2006 horizontal distributions of do and density anomaly near the surface and those near the bottom zhu et al 2016 the do concentration at the bottom is 3 mg l or less in most of the measured regions and the density difference that could reach about 8 kg m3 is considered an important physical condition in formation of low content of do below the pycnocline decomposition of increasing organic matter from both fluvial input and marine origin greatly consumes oxygen in bottom waters but without replenishment from the surface where do concentration is comparatively high as a result of full air sea exchange chen et al 2007 semi diurnal tidal current widely exists in the changjiang estuary and its adjacent areas in situ observed data from tide gauge stations indicates that surface current could reach its peak in the range of 1 1 6 m s during spring tide chen et al 2003 hopefully the kinetic energy of the surface current could be utilized for driving downwelling flow to improve do condition in bottom waters the application of a 90 bend to a vertical pipe may induce downward flow and fig 2 presents the sketch the deployment of the pump requires present mooring technology a floating platform is symmetrically achored by four mooring lines to seabed and equipped with an electric winch used to launch and reclaim the pump through wireropes the pump indirectly connects to the ends of the wire ropes through a universal joint so that it can move freely under current forces on the back of the upper bend is a flow director keeping the pump consistently toward incident flow direction and deviations from this direction make the pump unbalanced subjecting to the moment of horizontal flow a ballast hanging on the lower end of the pump does utmost to keep the downwelling pipe erect if tidal current is strong enough to overcome stratification downwelling flow can be produced evolving into an oxygen rich buoyant plume below the pycnocline which offers in situ condition for experimentally studying related ecological effects of artificial downwelling the present study aims to verify the proof of concept of current induced downwelling and study the downwelling capacity of the pump while several assumptions for simplification are made at first auxiliary parts in the pump such as the flow director ballast iron handles and mooring system have little impact on downwelling flow hence not considered in the study secondly the pump can be assumed vertical by choosing a proper ballast last but not least waterbody below the pycnocline is stagnant the paper is organized as follows 1 theory modelling on the tidal pump 2 scale model experiments for different conditions of tidal current and stratification 3 validation of the theory and discussion 4 a summary of conclusions 2 theoretical model fig 3 physically describes the mechanism of the pump when passing over the upper bend inlet of the pump horizontal current decelarates because of the blocking effect according to bernoulli principle this deceleration increases static pressure at the entrance which if large enough to overcome stratification will drive downwelling flow in the pump the energy balance principle eq 1 is prevalently used in engineering analysis of turbulent pipe flows without concerning about the detailed structure of flow field also this principle has managed to be applied for artificially vertical perturbance of ocean environment fan et al 2013 antonini et al 2015 for current induced downwelling water flow in the pump tends to be reversed when surrounding dense water applys buoyancy to the water column in the pump the kinetic energy of horizontal current should be large enough to maintain continuous downwelling flow where molecular viscosity and turbulent eddies dissipate the remaining kinetic energy of downwelling flow the energy equilibrium can be written in the following head form 1 m a x h k h ρ 0 h f where h k is the incident kinetic head h ρ is the work per unit weight performed against buoyancy while downwelling surface water towards heavier deep water and h f is the total fluid motion head loss h k is given by v h 2 2 g where v h is the horizontal current velocity at the upper inlet of the pump and g is the gravity acceleration h ρ can be calculated from the integral of relative density difference along the length of the pump hsieh et al 1978 cartesian coordinate system used is depicted in fig 3 density at the pump entrance and all along the down welling pipe are equal if there is a circulation and generally different from density in the surrounding water the density difference head in downwelling flow can be expressed as follows 2 h ρ z i z o ρ z ρ i ρ i d z where z i and z o are the water depth at the pump entrance and exit respectively ρ z is the vertical density profile of surrounding waters where z represents the variable of water depth and ρ i is the water density at z z i h f is the sum of frictional loss bend loss entrance loss and exit loss 3 h f λ l d ξ c ξ i n ξ o u t h d where l and d are the downwelling pipe length and diameter respectively h d is the downwelling kinetic head given by v d 2 2 g and v d is the average flow speed in the pump for turbulent flow λ is the darcy weisbach friction factor that can be iteratively solved by the colebrook white equation 4 1 λ 2 log δ 3 7 d 2 51 r e λ where δ is the inner wall roughness of the pump affected by such processes as bio fouling and marine corrosion and r e is defined as 5 re ρ i v d d μ where μ is the dynamic viscosity of water downwelling flow in the prototype is typically turbulent since reynolds number for that ranges from 4 10 5 to 2 10 6 ξ c is the bend loss coefficient related to friction and separation of water flow in the bend crawford et al 2003 ito 1960 reported a formulas for ξ c suitable for the prototype by considering the combination of frictional and separating effect 6 ξ c 0 217 re 0 17 0 95 2 r d 0 84 17 2 2 r d 1 12 where r is the curving radius of the bend ξ i n is the entrance loss coefficient to be dismissed since there is no tendency to either distort streamlines or introduce turbulent eddies at the upper entrance the entrance edge should be parallel to the incident flow direction otherwise the pump with the flow director becomes unbalanced under the moment of horizontal current ξ o u t is the exit loss coefficient equal to 1 in stagnant bottom waters antonini et al 2015 the theoretical model can be so far written in a new form 7 m a x h k h ρ 0 h d λ l d ξ c 1 ξ t h d where ξ t is the total loss coefficient mainly related to reynolds number and the pump geometry fig 4 presents the total loss coefficient for the studied range of reynolds number in the prototype suggesting that the coefficient can be assumed constant and equals to an average value of 0 75 as reynolds number increases by five times the coefficient only increases by 5 2 as a result of weakening of viscosity force 3 experimental setup and methods 3 1 facility and setup scale model experiments were conducted in the flume at the offshore laboratory of zhejiang university china to verify the theoretical model and to experimentally study the effect of tidal current and stratification on the performance of the pump the flume is 12 m long 0 5 m wide with an available depth of 0 4 m and equipped with a closed looped system for pumping the flow pump is capable of pumping fresh water from an underground reservoir at a maximum flow rate of 120 l s the vibrant nature of the pump makes it necessary to install a honeycomb tube whose height overtops the water level to dampen fluctuation and smooth turbulence on the incoming flow during experiments flume flow rate was set up and visualized on a server fig 5 presents the experimental setup a 1 80 model was designed for the study of a 20 m long pump submerged into a 30 m deep waterbody accordingly the target water level h 0 should be invariably 37 5 cm for all the tests this setup takes fully advantage of the flume the water level was maintained by adjusting manually the opening of the tail gate and recorded by a water level gauge fixed on the flume water level fluctuation is between 37 13 cm and 38 48 cm during the experiments a two layer model was employed for simulating the basic characteristics of natural stratification salty water corresponding to sub pycnocline water was contained in an acrylic water tank two identical trapezoid platforms that have a 1 4 slope and a deck part exactly attached the front and the rear of the tank respectively in case strong flow distortion due to sudden contraction fig 5 the platform is of steel bar structure where smooth plexiglass partitions is fixed and overspread on the top the incoming flow first accelerates on the slope and then maintains its speed constant along the deck part to provide a uniform flow condition water inside the platform connected to the outside through an opening at the bottom of the platform and was nearly stagnant the salty water was prepared by the mixture of fresh water and industrial salt weighed by an electronic scale in 0 1 g accuracy the density of salty water is calculated from the equation of state for seawater where temperature and salinity were simultaneously measured by a precalibrated thermo conductivity meter 8371 az instrument corp china the tank has the same width as the flume and a length of 30 cm and was designed to be 25 cm tall removal of top lid for a pycnocline depth of 10 m the top lid of the tank is 8 mm thick and 30 mm shorter in length than the tank leaving a gap completely covered by a 50 mm long plastic membrane glued on the lid to reduce unnecessary dilution while keep pressure equilibrium in the tank everytime the salty water had been prepared in the tank it took about 3 min to recover the target water level in the flume again the membrane tightly attached to the gap prevented water exchange between the tank and the outside during this period the membrane was recovered to its natural status afterward fig 5 to keep pressure equilibrium in the tank the salty water was inevitable diluted during measurements because the downwelling flow entered into the tank and water exchange existed at the gap the dilution effect on the stratified condition will be discussed in section 4 1 the scaled pump consisting of a stainless steel bend and a transparent pvc pipe was solidly fixed on the top of the water tank through a flange plate which maintains the upper bend inlet toward the incoming flow fig 6 a the on off valve mounted on the upper bend inlet is closed if there was no need for the generation of downwelling flow the dimensions of the pump are marked in fig 6 b 3 2 flow measurements horizontal flow speeds at the bend inlet were obtained based on the velocity distribution over the bisector of the smooth rectangular open channel and its final results can be calculated by the production of an average velocity in the section and a correction factor depending on the section aspect ratio and on the position of the pump entrance sun et al 2004 experimentally attained a parabolic distribution that is suitable and used in the experiments average velocities in the section and their modified values are listed in table 2 the downwelling flow was traced by releasing ink right ahead of the bend inlet the ink released from a 5 ml syringe whose needle perpendicular to the incident flow dyed the downwelling flow in the pump traditional techniques regarding flow visualization may fail to trace because water from the underground reservoir carries large amounts of impurity that strongly interferes with tracing processes moreover the installation of velocimetries is limited by the small pipe diameter which even if did successfully would lead to an unwanted water head loss in the downwelling flow the ink instead affects scarcely the total water head of the downwelling flow and can be easily captured by cameras a high definition camera sony hdr pj675 with a sampling rate of 25 fps was mounted on one side of the flume to record a video sequence of the ink head in the downwelling pipe to counteract possible reflection and strengthen colour contrast of ink to the background a led type plane light source on the opposite side was used the average speed can be obtained by dividing the travelling distance of the ink head by the time interval during experiments a couple of images were selected when the ink head initially appeared to be visible in the pipe and the ink head reached the lower end of the pipe if the image pairs has an interval of n the time interval should be n 25 1 s the travelling distance i e the difference of positions between the two ink heads is determined by identifying a conversion factor mm pixel for the pipe region centering on the camera origin prior to the conversion process camera calibration tool box for matlab had been employed for the removal of the lens distortion effect on sampling images we took twelve photos of a 9 12 checkerboards from various camera position and orientations as presented in fig 7 all the photos were automatically detected by the processing procedure to determine the intrinsic and extrinsic camera parameters that are used to undistort raw images the comparison of a couple of raw frames with their undistorted results is fig 8 where the raw frame pair is almostly unchanged after the calibration for all the calibrated image pairs positions of ink heads was picked up from images by using data cursor in matlab finally the average downwelling flow speed is given by 8 v d 24 c f p 2 p 1 n where p 1 and p 2 are the initial and terminal longitudinal pixel coordinate of the ink head in an image couple respectively n is the frame interval and c f is the conversion factor from pixel coordinates to map coordinates equal to 0 333 mm pixel this value is calculated based on geometrical similarity where the visible part of the pipe is known as 192 mm long corresponds to 576 pixels 3 3 similarity design and test conditions similar theories and methods allow studying the downwelling capacity of the pump in practice from its physical model greatly reducing the time and expenses of experiments for the desired conditions and geometry similitude is based on characteristic dimensionless numbers that govern the dynamic of flow field fan et al 2016 geometric similarity requires scaling all the dimensions involved in the prototype at a common ratio so that no distortion of flow structure occurs in the prototype to model transform scaled dimensions include the pipe diameter d the pipe length l the bend curving radius r the mean water level h 0 the pcynocline depth h 0 h 2 and the immersed length of the pump below the pycnocline h 1 9 d r d p d m r p r m l p l m h 0 p h 0 m h 1 p h 1 m h 2 p h 2 m where the subscripts m and p refer to the model and the prototype respectively and r refers to the ratio of the model to the prototype d r is designed to be 80 1 given the limit of the water depth in the test related dimensions in the prototype and in the model are listed in table 1 in current induced artificial downwelling resistance from stratification and inertial forces are predominant whereas the remaining forces are comparatively small the ratio of these two main forces is dimensionless richardson number presenting the dynamic importance of stratification in horizontal flow condition cushman roisin and beckers 2011 10 r i δρ g h ρ u 2 where r i is the dimensionless richardson number u is the typical velocity of horizontal flow δρ ρ is the scale of relative density difference in the fluid and h is the length scale of a stratified layer in this study r i can be expressed as half the ratio of density difference head to incident kinetic head h ρ 2 h k and dynamic similarity can be attained by equaling this value for the model and the prototype 11 r i m ρ o m ρ i m g h 2 m ρ i m v h m 2 ρ o p ρ i p g h 2 p ρ i p v h p 2 r i p where v h is the horizontal flow speed where the upper bend inlet locates h 2 is the characteristic length of the dense bottom waters and ρ i and ρ o are the density of waters above and below the pycnocline respectively dynamic similarity do not necessarily requires the preservation of the relative density difference intensifying the relative density difference in the scale model will increase the scaled velocity and the model reynolds number so that the pipe flow may remain turbulent the density ratio and velocity ratio of the prototype to the model are set to be 1 5 and 4 1 respectively the final range of reynolds numbers in the model is from 1293 to 6574 where some of them are below the lower limit of the turbulent flow r e 2300 such scaled effect will be discussed in section 4 1 table 1 summarizes test conditions for the prototype and the model all the variables regarding basic characteristics of downwelling flow could be mutually transformed between the model and the prototype for instance downwelling flow rates in the prototype are simply attained by multiplying that measured in the model by the following coefficient 12 q d r v h r d r 2 3 4 test procedure experiments were performed for five density differences and ten flow speeds for every density difference measurements on downwelling flow were conducted at different flow conditions based on increasing flume flow rate with equal spacing the test procedure is described in detail as follows and specific conditions of the model test are summerized in table 2 prepare the salty water in the tank and recording the water temperature and salinity measured by the thermo salinity meter the density of the salty water can be obtained from the equation of state for sea water by using the measurement values start up the pumping system and retaining water in the flume to reach a depth of 37 5 cm this process takes about 3 min and the membrane should be tightly attached to the gap on the top of the tank to prevent unnecessary dilution in salty water during this period it is not until the water level is stable that the membrane recovers its natural status open the camera to record the whole process of the group of tests in this stage horizontal flow speeds are obtained by equal space increment of flume flow rate of 1 5 l s from 15 to 28 5 l s and downwelling flow continues a few seconds for every horizontal flow speed water level is recorded as downwelling flow is generated upon opening the on off valve ink is vertically injected in front of the bend inlet and flows into the pipe with surrounding water the on off valve should be closed when the ink flows out of the pipe avoiding that the downwelling flow intrudes into salty waters to cause further dilution repeat step 1 3 for different density difference heads of 0 0752 0 1465 0 2351 0 3122 and 0 3970 cm in the physical model 4 results and discussion 4 1 validation of the theoretical model the theoretical model is verified by comparison with experiments as presented in fig 9 the independent variable is the dimensionless richardson number r i most dynamically important for current induced downwelling and the dependent variable is the ratio of the downwelling kinetic head to the incident kinetic head illustrating the relative intensity of the downwelling flow the relationship between these two variables can be written by involving r i h ρ 2 h k into eq 7 13 h d h k 1 ξ t m a x 1 2 r i 0 where ξ t is almost a constant value of 1 33 for the prototype weakly affected by reynolds number due to similarity this relationship in the prototype should be followed in the scale model experimental results basically agree with the theory with minus deviations in principle confirming the validity of the model in prediction of current induced downwelling flow in practice the average absolute deviation is 17 3 mainly considered as a result of dilution effect during the tests and of scaled effect from non dimensional characteristics of the forcing condition in each group of tests water exchange between the tank and the outside continuously dilutes the salty water with a commitment decrease in density difference head resulting in overestimations of richardson numbers when density differences are used as before the tests the higher the horizontal velocity the more the time spent on attaining it and therefore the more the dilution in addition the experimental results of relative downwelling intensities tend to be lower than the prediction by the theory as the scaling of the prototype decreases reynolds number to increase the total loss coefficient here is how uncertainties due to the dilution were determined and involved in the final experimental results during each group of tests the density of the salty water was initially prepared and its final average value was calculated based on the measurement results of salinity and temperature of uniformly mixed salty water at the end by using the initial and terminal value of density the amount of water exchange can be subsequently inferred and divided by the horizontal section area of the tank to obtain the thickness of an equivalent fresh water layer lying on the salty water fig 6 b 14 h 3 h 2 m ρ o m ρ om ρ o m ρ i m where h 3 is the thickness of the equivalent fresh water layer ρ o m and ρ om are the initial and final density of the salty water during each group of tests respectively the final density difference head should be h 1 m h 3 h 1 m h ρ m and this value in combination with the initial density difference head h ρ m determines the range of variations of actual density difference head table 3 lists measurement results related to the dilution effect and give ranges of actual density difference head in the model further the final experimental results involving this uncertainty are shown in fig 9 the scaled effect however is too uncertain to determine and may be properly illustrated by the results of the total loss coefficient versus reynolds number as presented in fig 10 the experimental results still gives an evident decreasing tendency to increasing reynolds number and most of them is more than the assumed constant coefficient in the prototype accounting for those minus deviations of the experimental results from the theory as r i increase say the importance of stratification becomes more the relative intensity of the downwelling flow is proportionally decreased the required condition for current induced downwelling is incident kinetic head in excess of density difference head when r i equals 0 5 this is also verified by the experiments when the relative intensity of the downwelling flow h d h k tended to be zero as r i is closed to 0 5 eq 13 can be transformed into a dimensional one for better understanding of downwelling flow rate 15 q d π 4 d 2 v d π d 2 4 ξ t v h 2 2 g h ρ where h ρ if a two layer model is used can be further expressed as the production of relative density difference and the immersed length of the pump below pycnocline 16 h ρ ρ o ρ i ρ i h 1 eqs 15 and 16 indicate that horizontal current speed relative density difference the immersed length and the pump geometry directly influence downwelling flow rate 4 2 horizontal current speed and relative density difference fig 11 presents the downwelling capacity of the prototype as a function of horizontal current speed for different relative density differences downwelling flow rate at the critical point is sensitive to the variance of horizontal current speed especially when stratification becomes more intense for a relative density difference equal to 0 008 horizontal current speed only 0 1 m s higher than the critical point produces a downwelling flow rate of 0 6 m3 s continuing to increase the value of v h will increase downwelling flow rate at slower tendency that gradually converges to the constant slope of 0 98 the functional relationship between downwelling flow rate and horizontal current speed can be employed to predict potential downwelling flux of water do and other biochemical quantities in hypoxic regions in regions of semidiurnal tide horizontal current speed can be treated as the combination of various sinusoidal series with a period of 12 h to illustration fig 12 depicts the response of the prototype to current speed that varies as a sinusoidal function with a peak value of 1 6 m s the prototype could produce promising downwelling flux into the bottom whereas stratification have great damping effect for a relative density difference of 0 008 situation is still encouraging of that pumping surface oxygen rich water of 1988 m3 per day downward into hypoxic bottom waters 15 36 m deeper than the pycnocline from the observation results in 2006 zhu et al 2016 the difference of do concentration between surface waters and bottom waters off the changjiang estuary can be assumed to be 2 mg l therefore oxygen net flux supplied by the prototype is 3 98 kg per day in fig 13 downwelling flow rate in the prototype is plotted versus relative density difference and falls as the increase of the relative density difference in that greater energy demand for overcoming stratification for the given current speed downwelling flow is produced on condition that the range of relative density difference is on the left of the intersection of the corresponding theoretical curve and the transverse axis which can be used to analyse the viability of artificial downwelling off the changjiang estuary for relative density difference between the diluted surface water and the bottom sea water ranging from 0 004 to 0 008 horizontal current reaching its peak at 1 6 m s could drive downward flow in the pump at a flow rate ranging from 0 4 to 1 1 m3 s 4 3 immersed length of the pump below the pycnocline unlike variables determined by environment such as relative density difference and current speed the immersed length of the pump below the pycnocline is instead an adjustable engineering parameter appearing in eq 17 to affect the critical current speed of the prototype 17 v h m i n 2 g h 2 ρ o ρ i ρ i when extending to the eastern areas of the changjiang estuary where hypoxia frequently takes place current speed diminishes and 1 6 m s may be unattainable for most of areas moreover the current speed even if available only holds for a short time period during the spring tide but expected biochemical effect requires continuous downwelling flux into the hypoxic waters to deal with this difficulty a feasible way is to diminish the immersed length by rising the pump otherwise auxiliary power supply with greater expense is necessary to overcome stratification in fig 14 the minimum current speed required decreases as the immersed length decreases and finally becomes zero when the bottom end of the pump reach the pycnocline or shallower consequently continuous downwelling flow is possible for any current condition as long as the pump is properly deployed the immersed length also affects the development of buoyant plume evolved from the entering of downwelling flow into bottom waters the buoyant plume is expected to stay below the pycnocline with do concentration as high as possible to relieve hypoxia and the main obstacles are intense dilution by the surrounding water and re entering of buoyant plume into the surface water smaller immersed length induces more downwelling flow tending to be less diluted yet too short distance between the pump outlet and the pycnocline causes difficulty in capturing buoyant plume below the pycnocline further study should focus on how buoyant plume develops outside the pump in terms of downwelling flow rate and the immersed length the optimal immersed depth if exists would be expected to result in optimal distribution of do concentration below the pycnocline 4 4 pipe diameter and relative bend radius in present study the pump length i e the sum of the pipe length l and the bend radius r is set to be 20 m and fig 15 shows the effect of pump geometry on the total loss coefficient and downwelling flow rate one can directly increase downwelling flow rate by the application of a larger pipe diameter where the total loss coefficient decreases owing to less friction loss yet pipes with large diameter may easily suffer twist or distortion under severe conditions of horizontal current the maximum pipe diameters are supposed to be kept below safety limit for the most severe condition that horizontal current can create the relative bend radius is another parameter unconstrained to be designed too small relative bend radius has strong flow separation with tendency to cause more pressure drop in the bend increasing the total loss coefficient and therefore decreasing downwelling flow rate as relative bend radius varies from 0 5 to 4 the total loss coefficient decreases by 22 resulting in an 11 increase in downwelling flow rate as both of them tend to be constant for the remainder of their theoretical curves a relative bend radius of 1 5 2 5 may be proper for the pump design without introducing energy loss too much but more structural reliability in horizontal current 5 conclusions the tidal pump made by the connection of a 90 o bend and a vertical pipe could potentially induce artificial downwelling driven by tidal currents to mitigate hypoxia at bottom waters theoretical model of the pump indicates that downwelling kinetic head is nearly linearly dependent on incident kinetic head meanwhile the ratio of downwelling kinetic head to incident kinetic head is a monotonic decreasing function of the richardson number r i a characteristic dimensionless number showing the dynamic importance of stratification the required condition for current induced artificial downwelling is r i no more than 0 5 otherwise incident kinetic energy is not enough to overcome stratification model experiments were carried out on the prototype at scale 1 80 covering a wide range of tidal current speeds from 1 12 to 2 12 m s and of density difference heads from 1 2 to 6 4 cm final experimental findings verify the theoretical model that can be used to predict the performance and to guide the design of the pump in practical applications downwelling flow rate mainly depends on horizontal current speed relative density difference the immersed length of the pump below the pycnocline and the pump geometry the prior two are determined by environment and the latter two are instead adjustable engineering parameters either increase in horizontal current speed or decrease in relative density difference tends to provide larger downwelling flow carrying more dissolved oxygen into hypoxic bottoms over times for strong stratification when required horizontal current speed is unattainable or even if attainable yet only holds for a short time period during spring tide one can decrease the immersed length to either lower the threshold of downwelling flow or extend the duration furthermore downwelling flow rate get increased by this way increasing pipe diameter and relative bend radius can produce more downwelling flow though changing these two parameters make no sense facilitating artificial downwelling for large reynolds number the total loss coefficient is mainly affected by the pump geometry if the length of the pump is predetermined both increase in relative bend radius and pipe diameter result in a smaller total loss coefficient that tends to be constant afterward in the diluted area off the changjiang estuary surface well oxygenated water could be pumped into a depth 15 36 m below the pycnocline and at a flow rate of 0 4 m3 s when density difference is up to 8 kg m3 and a horizontal current speed of 1 6 m s exists we may conclude that the concept of downwelling flow driven by tidal currents is viable for the mitigation of hypoxia off the changjiang estuary despite uncertainty that exists in the current knowledge of artificial downwelling to counteract eutrophication a pilot field test of the pump is necessary to understand ecosystem and the evolution of related biochemical variables the problem may be rather complicated in real sea state where current speed also exists at the pump outlet to affect the performance but was not involved in present study moreover how the buoyant plume evolved from the downwelling flow develops should be further studied since its importance for the optimization of do concentration field below the pycnocline acknowledgement this research is financially funded by the national key research and development program of china no 2016yfa0601400 and the national natural science funds of china no 41776084 and no 41406084 we appreciate the reviewers for their comprehensive comments and constructive suggestions on the manuscript nomenclature c f conversion factor from pixel coordinates to map coordinates m pixel d downwelling pipe diameter m g gravity acceleration 9 81 m s2 h length scale of stratification h 1 immersed length of the pump below the pycnocline m h 3 thickness of the equivalent fresh water layer m h d downwelling kinetic head m l downwelling pipe length m n frame interval p 1 p 2 initial and terminal longitudinal pixel coordinate of the ink head in an image pair m q d downwelling flow rate in the pump m3 s r curving radius of the bend m r e reynolds number r i richardson number u typical fluid velocity v d average flow speed in the pump m s h ρ density difference head m h f total fluid motion head loss m h k incident kinetic head m v h horizontal current speed where the pump entrance locates m s z variable of water depth m z i water depth at the pump inlet m z o water depth at the pump outlet m greek symbols δ inner wall roughness of the pump m δρ ρ scale of relative density difference λ darcyweisbach friction factor μ dynamic viscosity of water 0 001 p a s ρ z water density at the depth of z kg m3 ρ i water density at the depth of z i kg m3 ξ t the total loss coefficient ρ o m final average density of the salty water during each group of tests kg m3 ξ c bend loss coefficient ξ i n entrance loss coefficient ξ o u t exit loss coefficient subscripts m referred to the physical model min referred to the minimum value p referred to the prototype r referred to the ratio of the physical model to the prototype 
23599,this paper proposes a distributed formation tracking controller for multiple underactuated underwater vehicles uuvs which move in three dimensional space the formation controller designing process is divided into two parts in the first part the condition which the formation controller must be satisfied is given and the controllers are designed to ensure the condition mentioned before in the second part decentralized formation controller are proposed and the stability analysis based on small gain theorem is introduced simulation results illustrate that the designed controller can track three dimensional formation trajectory accurately keywords underactuated underwater vehicle formation control small gain method nonlinear control ams subject classification 93c85 93b51 65p40 1 introduction considerable effort has focused on coordination control of underactuated underwater vehicles uuvs for the coordination control problem multiple uuvs are required to fulfill the formation requirements numerous approaches to the formation control of multiple uuvs have been reported in the literature such as behavior based control takahashi et al 2004 balch arkin 1999 the virtual structure approach anthnoy lewis tan 1997 beard et al 2001 leader following strategy chen et al 2009 consolini et al 2008 das et al 2002 decentralized coordinated control yamaguchi 2003 dong farrell 2008 dong jay 2009 sun et al 2009 graph theory based methods fax murray 2004 jadbabaie et al 2004 artificial potential mechanism leonard fiorelli 2001 and so on the aim of coordination control of multiple uuvs is to drive each uuv to converge and keep relative distance from its neighbors distributed formation control of multiple uuvs using available relative position measurements has attracted considerable attention in liu jiang 2013 a class of distributed nonlinear controllers for leader following formation of unicycle robots without global position measurements are proposed the distributed controller is robust to position measurement errors and the linear velocities of the robots can be restricted to specific bounded ranges in liu jiang 2014 the coexistence of constraints on information exchange and complex nonlinear dynamics in distributed control systems is analyzed the cyclic small gain methods are introduced to design the distributed nonlinear controllers in ghabcheloo et al 2009 the coordinated path following problem is divided into two steps first a path following control law is designed to drive each vehicle to its assigned path second the coordinated states are adjusted to their nominal values so as to achieve coordination in peng et al 2011 using nn based dynamic surface control approach a decentralized cooperative controller for underactuated autonomous surface vehicles is proposed the proposed controller can make a group of underactuated autonomous surface vehicles converge to a trajectory which is relative to a time varying reference signal since the proposed algorithm only depends on the local information from its neighbors it works in a distributed manner based on the above presented discussion distributed controllers for leader following formation control of multiple uuvs are proposed the local relative position measurements are used to design the control algorithm firstly the formation control system is transformed into a state agreement problem then the distributed control laws are developed when the linear velocity of the uuv is zero there is a singularity problem for distributed control laws this singularity problem must be taken into consideration when we design distributed coordination control laws to avoid the singularity problem the linear velocity of the uuv must satisfy a condition the closed loop distributed system is transformed into a network of input to output stable ios systems and the recently developed nonlinear network small gain theorems are employed to guarantee state agreement this paper has made the following contributions first we propose a new distributed coordination algorithm to drive multiple uuvs to the specified spatial paths in advance with desired formation second the control algorithm designed in this paper using only local relative location information which has more practical application value for underwater vehicles third the condition which the linear velocities of multiple uuvs must satisfy is developed based on the condition the actual speed of the i th uuv is less than the expected speed this paper is organized as follows section 2 presents the mathematical and dynamic models of a uuv in three dimensional space the formation error systems are deduced in this part the objective of this paper is introduced in section 3 spatial formation controller is derived and the stability analysis based on small gain method is presented in this part simulation studies are discussed in section 4 and section 5 summarizes the paper 2 model description for uuv in three dimensional space in this part the dynamic model of the i th uuv in three dimensional space is introduced i 0 1 2 n 1 the uuv with index 0 is the leader and the uuvs with indexes 1 n 1 are followers in a general case the shape of the uuv considered in this paper is shown in fig 1 if the influence of roll is ignored a group of n uuvs whose mathematical models are described as follows 1 x i u i cos ψ i cos θ i v i sin ψ i w i cos ψ i sin θ i y i u i sin ψ i cos θ i v i cos ψ i w i sin ψ i sin θ i z i u i sin θ i w i cos θ i θ i q i ψ i r i cos θ i when discussing the kinematics of the uuv we first need to determine an inertial reference frame let e be the earth fixed frame of all uuvs the earth fixed frame is used as an inertial reference frame and is also called static coordinate system the origin o of the earth fixed frame can be taken from the sea surface or at any point in the sea according to the rules the axis o z is directed toward the center of the earth and the other two axes can be selected arbitrarily in this paper the axis o x points north and the axis o y points to the east in order to facilitate the discussion of the problem the body fixed frame b i is adopted for the i th uuv the body fixed frame is attached to the body of the uuv in principle the origin of the body fixed frame and the directions of the coordinate axes can be selected arbitrarily for convenience the axis o u i can be aligned with the main axis of the uuv while the axis o v i is in alignment with the auxiliary axis of the uuv let q i be the center of gravity of the i th uuv q i is chosen to coincide with the origin of b i x i y i z i t denotes the position of the point q i in e θ i ψ i t denotes the orientation of the point q i in e u i v i w i t is the velocities of the i th uuv in b i q i r i t is the angular velocities of the i th uuv in b i the dynamic of the i th uuv is written in the actuated directions as follows 2 m 11 i u i m 22 i v i r i m 33 i w i q i d 11 i u i f 1 i m 22 i v i m 11 i u i r i d 22 i v i m 33 i w i m 11 i u i q i d 33 i w i m 55 i q i m 33 i m 11 i u i w i d 55 i q i ρ g g m l i sin θ i f 2 i m 66 i r i m 11 i m 22 i u i v i d 66 i r i f 3 i where m 11 i m i x u i m 22 i m i y v i m 33 i m i z w i m 55 i i y i m q i m 66 i i z i n r i d 11 i x u i d 22 i y v i d 33 i z w i d 55 i m q i d 66 i n r i m i and m are the mass and associated mass of the i th uuv f 1 i f 2 i and f 3 i are the force and torque signals which are provided by the actuators x y z m and n are the hydrodynamic coefficients i is the moment of inertia ρ is the density of water g is the acceleration of gravity is the volume of water g m l i is the longitudinal metacentric height remark 1 in practice the response of the actuators and thrusters is much faster than that of the uuv therefore the dynamics of the actuators and thrusters is reasonably neglected in this paper to facilitate the derivation of the controller the new variables are defined as follows 3 v x i u i cos ψ i cos θ i v i sin ψ i w i cos ψ i sin θ i 4 v y i u i sin ψ i cos θ i v i cos ψ i w i sin ψ i sin θ i 5 v z i u i sin θ i w i cos θ i then the dynamics x i v x i y i v y i and z i v z i are deduced by combining 2 with 3 5 the derivatives for v x i v y i and v z i can be calculated to simplify the problem we present dynamic systems as follows 6 v x i u x i 7 v y i u y i 8 v z i u z i where u x i u y i and u z i are seemed to be new inputs to simplify the structure of the dynamics 6 7 and 8 in this way we can get the simplified dynamic system of the i th uuv as follows 9 x i v x i v x i u x i 10 y i v y i v y i u y i 11 z i v z i v z i u z i in fact for multiple uuvs the relative position information is easier to be obtained than the absolute position information so we use the relative position information to realize the formation control objective in order to show the relative position information more clearly and concretely we first introduce the concept of the information exchange topology map let g be the directed graph induced by the multiple uuvs communication network there are n nodes each corresponding to a uuv in g if the i th uuv can get a relative position x i x j from the j th uuv there is a directed connection from node j to node i in g and the j th uuv is a neighbor of the i th uuv further let ℵ i 0 n 1 denote the set of the neighbors of the i th uuv define x i x i x 0 d x i y i y i y 0 d y i z i z i z 0 d z i v x i v x i v x 0 v y i v y i v y 0 v z i v z i v z 0 u x i u x i u x 0 u y i u y i u y 0 u z i u z i u z 0 where x 0 y 0 z 0 t denotes the absolute position of the leader uuv in e v x 0 v y 0 v z 0 t is the velocity of the leader uuv u x 0 u y 0 u z 0 t is the control input of the leader uuv d x i r d y i r and d z i r are desired distances between the i th follower and the leader uuv based on the above definitions the following dynamics will be deduced 12 x i v x i v x i u x i 13 y i v y i v y i u y i 14 z i v z i v z i u z i where the following dynamic system for the leader uuv is established x 0 v x 0 v x 0 u x 0 y 0 v y 0 v y 0 u y 0 z 0 v z 0 v z 0 u z 0 as we see from the above analysis the purpose of the formation control problem is to design the control inputs u x i u y i and u z i for system 12 14 to make the establishment of x i 0 y i 0 z i 0 as t in order to facilitate the derivation of the controller we set up the following reasonable assumptions assumption 1 for the leader uuv the derivative of the resultant velocity v 0 v x 0 2 v y 0 2 v z 0 2 exists and is bounded i e v 0 exists and is bounded on 0 for the resultant velocity v 0 there are upper and lower constant bounds v 0 v 0 0 which satisfy v 0 v 0 v 0 for all t 0 3 formation controller design and stability analysis 3 1 formation controller design generally speaking if the i th uuv can obtain the relative position information x i x j then the information x i x j can be used to construct the controller of the x i subsystem we can use the following distributed control laws to achieve the formation control objective if the communication topology g of the multiple uuvs has a node 0 rooted spanning tree 15 u x i k i 1 v x i f x i φ x i 16 u y i k i 2 v y i f y i φ y i 17 u z i k i 3 v z i f z i φ z i where the control constants k i 1 0 k i 2 0 and k i 3 0 nonlinear functions f x i f y i and f z i are bounded odd continuously differentiable and satisfying 18 k i 1 4 d f x i r d r 0 19 k i 2 4 d f y i r d r 0 20 k i 3 4 d f z i r d r 0 where r r the structure of variables φ x i φ y i and φ z i can be designed as follows 21 φ x i 1 n i j ℵ i x i x j d x i d x j 22 φ y i 1 n i j ℵ i y i y j d y i d y j 23 φ z i 1 n i j ℵ i z i z j d z i d z j where n i is the size of ℵ i j ℵ i represents that there is a directed edge from the j th uuv to the i th uuv expressions d x i d x j d y i d y j d z i d z j in 21 22 and 23 are the desired distances between the i th uuv and the j th uuv in particular d x 0 d y 0 d z 0 0 the control inputs f 1 i q i and r i are designed from 6 8 with u x i u x i u x 0 u y i u y i u y 0 u z i u z i u z 0 define 24 a 1 cos ψ i cos θ i m 11 i 25 a 2 m 33 i w i cos ψ i cos θ i m 11 i u i cos ψ i sin θ i m 11 i u i cos ψ i sin θ i m 33 i w i cos ψ i cos θ i 26 a 3 m 22 i v i cos ψ i cos θ i m 11 i u i sin ψ i m 11 i u i sin ψ i m 22 i v i cos ψ i cos θ i w i sin ψ i sin θ i cos θ i 27 a 4 d 11 i u i cos ψ i cos θ i m 11 i d 22 i v i sin ψ i m 22 i d 33 i w i cos ψ i sin θ i m 33 i 28 a 5 sin ψ i cos θ i m 11 i 29 a 6 m 33 i w i sin ψ i cos θ i m 11 i u i sin ψ i sin θ i m 11 i u i sin ψ i sin θ i m 33 i w i sin ψ i cos θ i 30 a 7 m 22 i v i sin ψ i cos θ i m 11 i u i cos ψ i m 11 i u i cos ψ i m 22 i v i sin ψ i cos θ i w i cos ψ i sin θ i cos θ i 31 a 8 d 11 i u i sin ψ i cos θ i m 11 i d 22 i v i cos ψ i m 22 i d 33 i w i sin ψ i sin θ i m 33 i 32 a 9 sin θ i m 11 i 33 a 10 m 33 i w i sin θ i m 11 i u i cos θ i m 11 i u i cos θ i m 33 i w i sin θ i 34 a 11 m 22 i v i sin θ i m 11 i 35 a 12 d 11 i u i sin θ i m 11 i d 33 i w i cos θ i m 33 i then 36 a 1 f 1 i a 2 q i a 3 r i a 4 u x i 37 a 5 f 1 i a 6 q i a 7 r i a 8 u y i 38 a 9 f 1 i a 10 q i a 11 r i a 12 u z i define a a 1 a 2 a 3 a 5 a 6 a 7 a 9 a 10 a 11 if v i u i 2 v i 2 w i 2 0 then a 0 and f 1 i q i r i a 1 u x i u y i u z i a 4 a 8 a 12 that is 39 f 1 i a 2 a 7 a 3 a 6 a 11 u x i a 3 u z i a 4 a 11 a 3 a 12 a 2 a 11 a 3 a 10 a 7 u x i a 3 u y i a 4 a 7 a 3 a 8 a 1 a 11 a 3 a 9 a 2 a 7 a 3 a 6 a 2 a 11 a 3 a 10 a 1 a 7 a 3 a 5 40 q i a 7 u x i a 3 u y i a 4 a 7 a 3 a 8 a 1 a 7 a 3 a 5 f 1 i a 2 a 7 a 3 a 6 41 r i u x i a 4 a 1 f 1 i a 2 q i a 3 in order to make the equations 39 41 effective it is necessary to ensure that the condition v i 0 is established so we can choose a positive constant b 1 satisfying 0 b 1 v 0 and a control law for the i th uuv satisfying the following condition 42 max v x i v y i v z i 3 3 v 0 b 1 3 3 v 0 b 1 then v i v x i 2 v y i 2 v z i 2 v x 0 v x i 2 v y 0 v y i 2 v z 0 v z i 2 b 1 0 is guaranteed that is v i 0 in fact the actual speed of each uuv is less than the expected speed so a constant b 2 satisfying b 2 v 0 can be found in practice if the control law are designed to satisfy the following conditions described in 43 the actual speed of each uuv is less than the constant b 2 that is v i b 2 43 max v x i v y i v z i 3 3 b 2 v 0 here a new quantity is defined as follows 44 b 3 min 3 3 v 0 b 1 3 3 b 2 v 0 where the constants b 1 b 2 v 0 and v 0 satisfies the condition 0 b 1 v 0 v 0 b 2 if equations 42 and 43 are to be set up at the same time we need to design the controller to meet the following condition 45 max v x i v y i v z i b 3 based on the above analysis we design the following control laws 46 q i f θ i θ i θ 0 q 0 47 r i f ψ i ψ i ψ 0 r 0 cos θ 0 cos θ i 48 f 1 i m 11 i f u i u i u 0 u 0 m 22 i v i r i m 33 i w i q i d 11 i u i 49 f 2 i m 55 i f q i q i q 0 q 0 m 33 i m 11 i u i w i d 55 i q i ρ g g m l i sin θ i 50 f 3 i m 66 i f r i r i r 0 r 0 m 11 i m 22 i u i v i d 66 i r i where f θ i f ψ i f u i f q i f r i r r are real valued nonlinear function define new variables as θ i θ i θ 0 ψ i ψ i ψ 0 u i u i u 0 q i q i q 0 and r i r i r 0 from equations 1 2 and 46 50 we can get the following dynamics 51 θ i f θ i θ i 52 ψ i f ψ i ψ i 53 u i f u i u i 54 q i f q i q i 55 r i f r i r i we study the system 51 firstly if θ i 0 the nonlinear function f θ i θ i 0 and θ i 0 the nonlinear function f θ i θ i 0 the system 51 is asymptotically stable the same study can be made for system 52 55 so the nonlinear functions f θ i f ψ i f u i f q i f r i should be designed to satisfy that f θ i s f θ i s f ψ i s f ψ i s f u i s f u i s f q i s f q i s f r i s f r i s are positive definite for s r we can choose positive constants k i 4 k i 5 k i 6 k i 7 k i 8 which satisfy k i 4 4 d f θ i r d r 0 k i 5 4 d f ψ i r d r 0 k i 6 4 d f u i r d r 0 k i 7 4 d f q i r d r 0 k i 8 4 d f r i r d r 0 respectively in this way the system 51 55 are asymptotically stable furthermore there are kl functions β θ i β ψ i β u i β q i β r i such that θ i t β θ i θ i 0 t ψ i t β ψ i ψ i 0 t u i t β u i u i 0 t q i t β q i q i 0 t and r i t β r i r i 0 t based on the property of continuous functions there are c θ 0 0 c ψ 0 0 c u 0 0 c v 0 0 c w 0 0 c q 0 0 and c r 0 0 such that for all v 0 v 0 v 0 θ 0 ψ 0 q 0 r 0 r c θ 0 c θ 0 c ψ 0 c ψ 0 c u 0 c u 0 c v 0 c v 0 c w 0 c w 0 c q 0 c q 0 c r 0 c r 0 56 u 0 c u 0 cos ψ 0 c ψ 0 cos θ 0 c θ 0 v 0 c v 0 sin ψ 0 c ψ 0 w 0 c w 0 cos ψ 0 c ψ 0 sin θ 0 c θ 0 u 0 cos ψ 0 cos θ 0 v 0 sin ψ 0 w 0 cos ψ 0 sin θ 0 b 3 57 u 0 c u 0 sin ψ 0 c ψ 0 cos θ 0 c θ 0 v 0 c v 0 cos ψ 0 c ψ 0 w 0 c w 0 sin ψ 0 c ψ 0 sin θ 0 c θ 0 u 0 sin ψ 0 cos θ 0 v 0 cos ψ 0 w 0 sin ψ 0 sin θ 0 b 3 58 u 0 c u 0 sin θ 0 c θ 0 w 0 c w 0 cos θ 0 c θ 0 u 0 sin θ 0 w 0 cos θ 0 b 3 based on the control laws 46 50 we can find a finite time t i 1 for the i th uuv to satisfy the conditions θ i t i 1 θ 0 t i 1 c θ 0 ψ i t i 1 ψ 0 t i 1 c ψ 0 u i t i 1 u 0 t i 1 c u 0 q i t i 1 q 0 t i 1 c q 0 r i t i 1 r 0 t i 1 c r 0 and thus condition 45 is satisfied at time t i 1 with the control law 48 and the condition v i 0 b 2 the result v i t b 2 can be got for t 0 t i 1 remark 2 controllers 39 41 do not conflict with 46 48 they belong to different control stages in the initial control stage controllers 46 50 are used to guarantee the i th uuv s velocity v i 0 at t t i 1 in the same time the errors θ i ψ i u i q i and r i tend to 0 based on controllers 46 50 when v i 0 the controllers 39 41 are validity the second control stage is using control laws 39 41 to achieve formation control objective if the condition 42 is not satisfied at the beginning of the control procedure the formation controllers 39 41 can not solely guarantee v i 0 and thus the initial control stage is necessary 3 2 main result and stability analysis in this part the small gain theorem is introduced first consider the system 59 χ 1 ℏ 1 χ 1 υ 2 υ 3 υ n κ 1 χ 2 ℏ 2 χ 2 υ 1 υ 3 υ n κ 2 χ n ℏ n χ n υ 1 υ 2 υ n 1 κ n the output of every subsystem is defined as follows 60 υ i ƛ i χ i where χ i r n i υ i r m i κ i r l i ℏ i and ƛ i are local lipschitz functions assume that the χ i subsystem of 59 is unboundedness observable and input to output stable with the input υ j j i and κ i and the output υ i specifically there exist α i o k β i kl γ i j k and γ i κ k such that 61 χ i t α i o χ i 0 j i y j 0 t κ i 0 t 62 y i t max j i β i χ i 0 t γ i j y j 0 t γ i κ κ i the cyclic small gain theorem for system 59 is given as follows the cyclic small gain theorem jiang wang 2008 it is assumed that every subsystem of 59 and 60 satisfies the conditions 61 and 62 for any simple loop if the condition 63 γ i 1 i 2 γ i 2 i 3 γ i r i 1 id holds the system 59 and 60 are unboundedness observable and input to output stable for any given κ functions γ 1 and γ 2 we say that γ 1 γ 2 id if γ 1 γ 2 r r for all r 0 id represents a unit function the v x i v y i v z i system defined in 12 14 is considered in this part based on the analysis detailed in section 3 1 the condition 45 is satisfied at time t i 1 we can choose bounded nonlinear functions f x i f y i f z i and the control laws 15 17 to guarantee the satisfaction of 45 after t i 1 define a digraph g f with n 1 nodes for i 1 n 1 define ℵ i as if there is a directed edge j i from the j th node to the i th node then j ℵ i each edge j i is assigned with a positive variable a i j for a simple loop ο of g f denote a ο as the product of the positive values assigned to the edges of the loop for i 1 n 1 denote ℓ f i as the set of simple loops of g f through the i th vertex the main result of this paper is proposed as follows theorem 1 consider the multiple uuvs kinematic and dynamic models described in 1 and 2 given the distributed control laws defined by 3 8 46 50 15 17 and 39 41 with parameters k i 1 k i 2 k i 3 satisfying 18 20 and with the assumption 1 if the position sensing digraph g has a spanning tree with node 0 as the root then the formation error variables x i t y i t z i t θ i t and ψ i t of the i th uuv asymptotically converge to zeroes with i 1 n 1 respectively proof consider the definition of b 3 in 44 and the condition 45 satisfied after t i 1 the conclusion v i 0 can be got and then the controllers 39 41 are valid for all t t i 1 denote x 0 0 y 0 0 and z 0 0 we rewrite φ x i φ y i and φ z i as follows 64 φ x i 1 n i j ℵ i x i d x i x 0 x j d x j x 0 1 n i j ℵ i x i x j x i 1 n i j ℵ i x j 65 φ y i 1 n i j ℵ i y i d y i y 0 y j d y j y 0 1 n i j ℵ i y i y j y i 1 n i j ℵ i y j 66 φ z i 1 n i j ℵ i z i d z i z 0 z j d z j z 0 1 n i j ℵ i z i z j z i 1 n i j ℵ i z j define new variables as h x i 1 n i j ℵ i x j h y i 1 n i j ℵ i y j and h z i 1 n i j ℵ i z j and thus the control laws 15 17 can be rewritten as follows 67 u x i k i 1 v x i f x i x i h x i 68 u y i k i 2 v y i f y i y i h y i 69 u z i k i 3 v z i f z i z i h z i now we denote t 0 max i 1 n 1 t i 1 for system 12 consider a control law taking the form shown in 67 with f x i satisfied condition 18 φ x i shown in 64 and based on the small gain theorem the closed loop system 12 67 and x ˆ i x i ω x i ω x i r represents an external input is unboundedness observable and is input to output stable with the following properties hold 70 x i t β x i x i 0 v x i 0 t t t 0 h x i t 0 t 71 v x i t v x i 0 α x i x i t 0 t h x i t 0 t where i 1 n 1 x i t 0 x i 0 v x i t 0 v x i 0 β x i is kl function and α x i is κ function in the same way we can conclude that the y i v y i system 13 and z i v z i system 14 with the related control laws are unboundedness observable and are input to output stable with the following properties hold 72 y i t β y i y i 0 v y i 0 t t t 0 h y i t 0 t 73 v y i t v y i 0 α y i y i t 0 t h y i t 0 t 74 z i t β z i z i 0 v z i 0 t t t 0 h z i t 0 t 75 v z i t v z i 0 α z i z i t 0 t h z i t 0 t where y i t 0 y i 0 v y i t 0 v y i 0 z i t 0 z i 0 v z i t 0 v z i 0 β y i β z i κ l and α y i α z i κ if we give n 1 constants l 1 l n 1 0 which satisfy the condition i 1 n 1 1 l i n 1 then for any constants d 1 d n 1 0 we have the conclusion i 1 n 1 1 l i l i d i n 1 max 1 i n 1 l i d i and thus the following results hold 76 h x i δ i max j ℵ i a i j x j 77 h y i δ i max j ℵ i a i j y j 78 h z i δ i max j ℵ i a i j z j if the node 0 ℵ i we will have δ i n i 1 n i ℵ i ℵ i 0 and j ℵ i 1 a i j n i 1 if 0 ℵ i we will get that δ i 1 ℵ i ℵ i and j ℵ i 1 a i j n i where ℵ i denote the set of the neighbors of the i th uuv except node 0 from the above analysis the properties 70 75 imply 79 x i t β x i x i 0 v x i 0 t t t 0 δ i max j ℵ i a i j x j t 0 t 80 v x i t v x i 0 α x i x i t 0 t δ i max j ℵ i a i j x j t 0 t 81 y i t β y i y i 0 v y i 0 t t t 0 δ i max j ℵ i a i j y j t 0 t 82 v y i t v y i 0 α y i y i t 0 t δ i max j ℵ i a i j y j t 0 t 83 z i t β z i z i 0 v z i 0 t t t 0 δ i max j ℵ i a i j z j t 0 t 84 v z i t v z i 0 α z i z i t 0 t δ i max j ℵ i a i j z j t 0 t from the explanation of ℵ i we know that ℵ i corresponds to a digraph g f which is a subgraph of g g f has n 1 nodes with indices 1 n 1 so g f represents the follower uuvs based on the definitions of ℵ i and g f we can conclude that for i 1 n 1 if j ℵ i there is a directed edge j i from the j th node to the i th node in g f consequently g f denotes the interconnection topology of the network composed of the x i v x i system 12 y i v y i system 13 and z i v z i system 14 let f 0 ℵ i 0 ℵ i i 1 n 1 be a index set if the nodes indices belong to f 0 we can define ℓ 0 ℓ 0 ℓ f as the set of all simple loops through these nodes for i 1 n 1 j ℵ i a positive value a i j can be chosen as edge for j i in g f and thus x i y i z i with i 1 n 1 can be regarded as the outputs of the network composed of the x i v x i system 12 y i v y i system 13 and z i v z i system 14 respectively if the following conditions described in 85 86 are satisfied the errors x i t y i t and z i t with i 1 n 1 will converge to the origin according to the ios small gain theorem jiang wang 2008 85 a ο n 2 n 1 1 for ο ℓ 0 86 a ο 1 for ο ℓ f ℓ 0 based on the assumption that g has a spanning tree with node 0 as the root the conditions 85 and 86 can be satisfied in this paper under above assumption g f has a spanning tree and its root nodes indices belong to f 0 and thus we can choose positive constants a i j to make the conditions 85 and 86 set up for systems 12 14 and 51 52 we can choose a lyapunov function as follows 87 v i 1 1 2 v x i 2 v y i 2 v z i 2 θ i 2 ψ i 2 by calculating we know that 88 v i 1 v x i u x i v y i u y i v z i u z i θ i f θ i θ i ψ i f ψ i ψ i subsitute 67 69 to 88 we can get that v i 1 0 89 v i 1 u x i 2 u y i 2 u z i 2 v x i u x i v y i u y i v z i u z i f θ i 2 θ i f ψ i 2 ψ i θ i d f θ i θ i d θ i ψ i d f ψ i ψ i d ψ i based on the equations 67 69 we can get that 90 u x i k i 1 v x i d f x i x i h x i d x i h x i 91 u y i k i 2 v y i d f y i y i h y i d y i h y i 92 u z i k i 3 v z i d f z i z i h z i d z i h z i subsitute 90 92 to 89 and using the conditions 18 20 the following result will be deduced 93 0 v i 1 u x i 2 u y i 2 u z i 2 f θ i 2 θ i f ψ i 2 ψ i k i 1 2 v x i 2 k i 1 2 16 k i 2 2 v y i 2 k i 2 2 16 k i 3 2 v z i 2 k i 3 2 16 θ i 2 k i 4 2 16 ψ i 2 k i 5 2 16 that is v i 1 is uniformly continuous according to the barbalat s lemma khalil 2001 we know that 94 lim t v i 1 0 lim t v x i lim t v y i lim t v z i lim t θ i lim t ψ i 0 and thus theorem 1 is proved 4 simulation analysis to illustrate that the approach is applicable to multiple uuvs system simulation study is carried out based on one leader and four follower uuvs moving in 3d space that is i 0 1 2 3 4 the uuv with index 0 is the leader the neighbor sets of the uuvs are defined as follows ℵ 1 0 4 ℵ 2 1 3 ℵ 3 2 ℵ 4 3 all of simulations are carried out using matlab software platform it is assumed that all of uuvs are equipped with propellers to provide the surge force the pitch moment and the yaw moment for this simulation the system parameters are selected as follows m 11 i 25 kg m 22 i 20 kg m 33 i 20 kg m 55 i 2 0 kgm 2 m 66 i 2 5 kgm 2 d 11 i 7 kgm s d 22 i 7 kgm s d 33 i 6 kgm s d 55 i 5 kgm s d 66 i 5 kgm s g m l i 1 m the initial positions and orientations of followers and the leader are given as follows x 1 0 20 y 1 0 10 z 1 0 1 θ 1 0 π 16 ψ 1 0 π x 2 0 10 y 2 0 10 z 2 0 1 5 θ 2 0 0 ψ 2 0 5 π 6 x 3 0 15 y 3 0 8 z 3 0 1 2 θ 3 0 π 8 ψ 3 0 2 π 3 x 4 0 12 y 4 0 9 z 4 0 1 3 θ 4 0 π 4 ψ 4 0 0 x 0 0 0 y 0 0 0 z 0 0 0 θ 0 0 π 12 ψ 0 0 π 6 the desired relative position of the follower uuvs are defined by d x 1 7 m d x 2 7 m d x 3 4 m d x 4 4 m d y 1 0 5 m d y 2 0 5 m d y 3 0 8 m d y 4 0 8 m d z 1 0 2 m d z 2 0 2 m d z 3 0 1 m d z 4 0 1 m see fig 2 based on backstepping technique the leader uuv can track a desired spatial path the control inputs of the leader uuv are detailed in heming 2012 the desired spatial path is set to 10 cos t 10 sin t 0 1 t choose v 0 3 m s v 0 3 5 m s and v 0 0 3 m s satisfies v 0 v 0 v 0 choose b 1 0 2 and b 2 7 2 the distributed control laws for the initialization stage are in the forms of 46 50 with f θ i s f ψ i s f u i s f q i s f r i s 0 5 1 exp 0 5 s 1 exp 0 5 s for i 1 2 3 4 the distributed control laws for the formation control stage are in the forms of 15 17 with k i 1 k i 2 k i 3 1 and f x i s f y i s f z i s 2 1 exp 0 5 s 1 exp 0 5 s for i 1 2 3 4 fig 3 shows the x y z plot of the leader and the followers trajectories fig 4 illustrates the formation error signals the linear velocities and the angular velocities of multiple uuvs are shown in fig 5 and fig 6 respectively as shown by these figures both of followers successfully track their desired range and bearing with respect to the leader in order to construct the desired formation fig 7 shows the control signals of the followers as depicted by fig 7 the control signals remain within a reasonable range and the actuator saturation is prevented fig 8 shows the comparison results of the coordination errors under two different control methods the leader follower formation control method based on path following xianbo 2010 requires a communication link between the leader and each follower and also needs to determine the motion path of each follower in advance which increases the condition limit for the controller as shown in fig 8 the control method proposed in this paper can make the coordination error converge faster the controller based on the small gain principle is better at dealing with nonlinear control problems with uncertainties 5 conclusion based on the nonlinear small gain method we introduced new formation system stabilizers for multiple uuvs the controller is deduced without global position measurements the designed controller can avoid the nonholonomic constraint of multiple uuvs the simple conditions are developed for practical implementation with the proposed distributed coordination controllers the formation control objective can be achieved without assuming any tree sensing structures simulation results successfully showed that the proposed controller can effectively solve the formation tracking problem further work will extend the methodology proposed to tackle complex coordination control problems namely coordinated control in the presence of stringent communication constraints that arise in the underwater world such as time delays tight energy budgets and reduced channel capacity acknowledgements this work was supported by the program in the youth elite support plan in universities of anhui province gxyq2017042 and the national natural science foundation of china 61702007 
23599,this paper proposes a distributed formation tracking controller for multiple underactuated underwater vehicles uuvs which move in three dimensional space the formation controller designing process is divided into two parts in the first part the condition which the formation controller must be satisfied is given and the controllers are designed to ensure the condition mentioned before in the second part decentralized formation controller are proposed and the stability analysis based on small gain theorem is introduced simulation results illustrate that the designed controller can track three dimensional formation trajectory accurately keywords underactuated underwater vehicle formation control small gain method nonlinear control ams subject classification 93c85 93b51 65p40 1 introduction considerable effort has focused on coordination control of underactuated underwater vehicles uuvs for the coordination control problem multiple uuvs are required to fulfill the formation requirements numerous approaches to the formation control of multiple uuvs have been reported in the literature such as behavior based control takahashi et al 2004 balch arkin 1999 the virtual structure approach anthnoy lewis tan 1997 beard et al 2001 leader following strategy chen et al 2009 consolini et al 2008 das et al 2002 decentralized coordinated control yamaguchi 2003 dong farrell 2008 dong jay 2009 sun et al 2009 graph theory based methods fax murray 2004 jadbabaie et al 2004 artificial potential mechanism leonard fiorelli 2001 and so on the aim of coordination control of multiple uuvs is to drive each uuv to converge and keep relative distance from its neighbors distributed formation control of multiple uuvs using available relative position measurements has attracted considerable attention in liu jiang 2013 a class of distributed nonlinear controllers for leader following formation of unicycle robots without global position measurements are proposed the distributed controller is robust to position measurement errors and the linear velocities of the robots can be restricted to specific bounded ranges in liu jiang 2014 the coexistence of constraints on information exchange and complex nonlinear dynamics in distributed control systems is analyzed the cyclic small gain methods are introduced to design the distributed nonlinear controllers in ghabcheloo et al 2009 the coordinated path following problem is divided into two steps first a path following control law is designed to drive each vehicle to its assigned path second the coordinated states are adjusted to their nominal values so as to achieve coordination in peng et al 2011 using nn based dynamic surface control approach a decentralized cooperative controller for underactuated autonomous surface vehicles is proposed the proposed controller can make a group of underactuated autonomous surface vehicles converge to a trajectory which is relative to a time varying reference signal since the proposed algorithm only depends on the local information from its neighbors it works in a distributed manner based on the above presented discussion distributed controllers for leader following formation control of multiple uuvs are proposed the local relative position measurements are used to design the control algorithm firstly the formation control system is transformed into a state agreement problem then the distributed control laws are developed when the linear velocity of the uuv is zero there is a singularity problem for distributed control laws this singularity problem must be taken into consideration when we design distributed coordination control laws to avoid the singularity problem the linear velocity of the uuv must satisfy a condition the closed loop distributed system is transformed into a network of input to output stable ios systems and the recently developed nonlinear network small gain theorems are employed to guarantee state agreement this paper has made the following contributions first we propose a new distributed coordination algorithm to drive multiple uuvs to the specified spatial paths in advance with desired formation second the control algorithm designed in this paper using only local relative location information which has more practical application value for underwater vehicles third the condition which the linear velocities of multiple uuvs must satisfy is developed based on the condition the actual speed of the i th uuv is less than the expected speed this paper is organized as follows section 2 presents the mathematical and dynamic models of a uuv in three dimensional space the formation error systems are deduced in this part the objective of this paper is introduced in section 3 spatial formation controller is derived and the stability analysis based on small gain method is presented in this part simulation studies are discussed in section 4 and section 5 summarizes the paper 2 model description for uuv in three dimensional space in this part the dynamic model of the i th uuv in three dimensional space is introduced i 0 1 2 n 1 the uuv with index 0 is the leader and the uuvs with indexes 1 n 1 are followers in a general case the shape of the uuv considered in this paper is shown in fig 1 if the influence of roll is ignored a group of n uuvs whose mathematical models are described as follows 1 x i u i cos ψ i cos θ i v i sin ψ i w i cos ψ i sin θ i y i u i sin ψ i cos θ i v i cos ψ i w i sin ψ i sin θ i z i u i sin θ i w i cos θ i θ i q i ψ i r i cos θ i when discussing the kinematics of the uuv we first need to determine an inertial reference frame let e be the earth fixed frame of all uuvs the earth fixed frame is used as an inertial reference frame and is also called static coordinate system the origin o of the earth fixed frame can be taken from the sea surface or at any point in the sea according to the rules the axis o z is directed toward the center of the earth and the other two axes can be selected arbitrarily in this paper the axis o x points north and the axis o y points to the east in order to facilitate the discussion of the problem the body fixed frame b i is adopted for the i th uuv the body fixed frame is attached to the body of the uuv in principle the origin of the body fixed frame and the directions of the coordinate axes can be selected arbitrarily for convenience the axis o u i can be aligned with the main axis of the uuv while the axis o v i is in alignment with the auxiliary axis of the uuv let q i be the center of gravity of the i th uuv q i is chosen to coincide with the origin of b i x i y i z i t denotes the position of the point q i in e θ i ψ i t denotes the orientation of the point q i in e u i v i w i t is the velocities of the i th uuv in b i q i r i t is the angular velocities of the i th uuv in b i the dynamic of the i th uuv is written in the actuated directions as follows 2 m 11 i u i m 22 i v i r i m 33 i w i q i d 11 i u i f 1 i m 22 i v i m 11 i u i r i d 22 i v i m 33 i w i m 11 i u i q i d 33 i w i m 55 i q i m 33 i m 11 i u i w i d 55 i q i ρ g g m l i sin θ i f 2 i m 66 i r i m 11 i m 22 i u i v i d 66 i r i f 3 i where m 11 i m i x u i m 22 i m i y v i m 33 i m i z w i m 55 i i y i m q i m 66 i i z i n r i d 11 i x u i d 22 i y v i d 33 i z w i d 55 i m q i d 66 i n r i m i and m are the mass and associated mass of the i th uuv f 1 i f 2 i and f 3 i are the force and torque signals which are provided by the actuators x y z m and n are the hydrodynamic coefficients i is the moment of inertia ρ is the density of water g is the acceleration of gravity is the volume of water g m l i is the longitudinal metacentric height remark 1 in practice the response of the actuators and thrusters is much faster than that of the uuv therefore the dynamics of the actuators and thrusters is reasonably neglected in this paper to facilitate the derivation of the controller the new variables are defined as follows 3 v x i u i cos ψ i cos θ i v i sin ψ i w i cos ψ i sin θ i 4 v y i u i sin ψ i cos θ i v i cos ψ i w i sin ψ i sin θ i 5 v z i u i sin θ i w i cos θ i then the dynamics x i v x i y i v y i and z i v z i are deduced by combining 2 with 3 5 the derivatives for v x i v y i and v z i can be calculated to simplify the problem we present dynamic systems as follows 6 v x i u x i 7 v y i u y i 8 v z i u z i where u x i u y i and u z i are seemed to be new inputs to simplify the structure of the dynamics 6 7 and 8 in this way we can get the simplified dynamic system of the i th uuv as follows 9 x i v x i v x i u x i 10 y i v y i v y i u y i 11 z i v z i v z i u z i in fact for multiple uuvs the relative position information is easier to be obtained than the absolute position information so we use the relative position information to realize the formation control objective in order to show the relative position information more clearly and concretely we first introduce the concept of the information exchange topology map let g be the directed graph induced by the multiple uuvs communication network there are n nodes each corresponding to a uuv in g if the i th uuv can get a relative position x i x j from the j th uuv there is a directed connection from node j to node i in g and the j th uuv is a neighbor of the i th uuv further let ℵ i 0 n 1 denote the set of the neighbors of the i th uuv define x i x i x 0 d x i y i y i y 0 d y i z i z i z 0 d z i v x i v x i v x 0 v y i v y i v y 0 v z i v z i v z 0 u x i u x i u x 0 u y i u y i u y 0 u z i u z i u z 0 where x 0 y 0 z 0 t denotes the absolute position of the leader uuv in e v x 0 v y 0 v z 0 t is the velocity of the leader uuv u x 0 u y 0 u z 0 t is the control input of the leader uuv d x i r d y i r and d z i r are desired distances between the i th follower and the leader uuv based on the above definitions the following dynamics will be deduced 12 x i v x i v x i u x i 13 y i v y i v y i u y i 14 z i v z i v z i u z i where the following dynamic system for the leader uuv is established x 0 v x 0 v x 0 u x 0 y 0 v y 0 v y 0 u y 0 z 0 v z 0 v z 0 u z 0 as we see from the above analysis the purpose of the formation control problem is to design the control inputs u x i u y i and u z i for system 12 14 to make the establishment of x i 0 y i 0 z i 0 as t in order to facilitate the derivation of the controller we set up the following reasonable assumptions assumption 1 for the leader uuv the derivative of the resultant velocity v 0 v x 0 2 v y 0 2 v z 0 2 exists and is bounded i e v 0 exists and is bounded on 0 for the resultant velocity v 0 there are upper and lower constant bounds v 0 v 0 0 which satisfy v 0 v 0 v 0 for all t 0 3 formation controller design and stability analysis 3 1 formation controller design generally speaking if the i th uuv can obtain the relative position information x i x j then the information x i x j can be used to construct the controller of the x i subsystem we can use the following distributed control laws to achieve the formation control objective if the communication topology g of the multiple uuvs has a node 0 rooted spanning tree 15 u x i k i 1 v x i f x i φ x i 16 u y i k i 2 v y i f y i φ y i 17 u z i k i 3 v z i f z i φ z i where the control constants k i 1 0 k i 2 0 and k i 3 0 nonlinear functions f x i f y i and f z i are bounded odd continuously differentiable and satisfying 18 k i 1 4 d f x i r d r 0 19 k i 2 4 d f y i r d r 0 20 k i 3 4 d f z i r d r 0 where r r the structure of variables φ x i φ y i and φ z i can be designed as follows 21 φ x i 1 n i j ℵ i x i x j d x i d x j 22 φ y i 1 n i j ℵ i y i y j d y i d y j 23 φ z i 1 n i j ℵ i z i z j d z i d z j where n i is the size of ℵ i j ℵ i represents that there is a directed edge from the j th uuv to the i th uuv expressions d x i d x j d y i d y j d z i d z j in 21 22 and 23 are the desired distances between the i th uuv and the j th uuv in particular d x 0 d y 0 d z 0 0 the control inputs f 1 i q i and r i are designed from 6 8 with u x i u x i u x 0 u y i u y i u y 0 u z i u z i u z 0 define 24 a 1 cos ψ i cos θ i m 11 i 25 a 2 m 33 i w i cos ψ i cos θ i m 11 i u i cos ψ i sin θ i m 11 i u i cos ψ i sin θ i m 33 i w i cos ψ i cos θ i 26 a 3 m 22 i v i cos ψ i cos θ i m 11 i u i sin ψ i m 11 i u i sin ψ i m 22 i v i cos ψ i cos θ i w i sin ψ i sin θ i cos θ i 27 a 4 d 11 i u i cos ψ i cos θ i m 11 i d 22 i v i sin ψ i m 22 i d 33 i w i cos ψ i sin θ i m 33 i 28 a 5 sin ψ i cos θ i m 11 i 29 a 6 m 33 i w i sin ψ i cos θ i m 11 i u i sin ψ i sin θ i m 11 i u i sin ψ i sin θ i m 33 i w i sin ψ i cos θ i 30 a 7 m 22 i v i sin ψ i cos θ i m 11 i u i cos ψ i m 11 i u i cos ψ i m 22 i v i sin ψ i cos θ i w i cos ψ i sin θ i cos θ i 31 a 8 d 11 i u i sin ψ i cos θ i m 11 i d 22 i v i cos ψ i m 22 i d 33 i w i sin ψ i sin θ i m 33 i 32 a 9 sin θ i m 11 i 33 a 10 m 33 i w i sin θ i m 11 i u i cos θ i m 11 i u i cos θ i m 33 i w i sin θ i 34 a 11 m 22 i v i sin θ i m 11 i 35 a 12 d 11 i u i sin θ i m 11 i d 33 i w i cos θ i m 33 i then 36 a 1 f 1 i a 2 q i a 3 r i a 4 u x i 37 a 5 f 1 i a 6 q i a 7 r i a 8 u y i 38 a 9 f 1 i a 10 q i a 11 r i a 12 u z i define a a 1 a 2 a 3 a 5 a 6 a 7 a 9 a 10 a 11 if v i u i 2 v i 2 w i 2 0 then a 0 and f 1 i q i r i a 1 u x i u y i u z i a 4 a 8 a 12 that is 39 f 1 i a 2 a 7 a 3 a 6 a 11 u x i a 3 u z i a 4 a 11 a 3 a 12 a 2 a 11 a 3 a 10 a 7 u x i a 3 u y i a 4 a 7 a 3 a 8 a 1 a 11 a 3 a 9 a 2 a 7 a 3 a 6 a 2 a 11 a 3 a 10 a 1 a 7 a 3 a 5 40 q i a 7 u x i a 3 u y i a 4 a 7 a 3 a 8 a 1 a 7 a 3 a 5 f 1 i a 2 a 7 a 3 a 6 41 r i u x i a 4 a 1 f 1 i a 2 q i a 3 in order to make the equations 39 41 effective it is necessary to ensure that the condition v i 0 is established so we can choose a positive constant b 1 satisfying 0 b 1 v 0 and a control law for the i th uuv satisfying the following condition 42 max v x i v y i v z i 3 3 v 0 b 1 3 3 v 0 b 1 then v i v x i 2 v y i 2 v z i 2 v x 0 v x i 2 v y 0 v y i 2 v z 0 v z i 2 b 1 0 is guaranteed that is v i 0 in fact the actual speed of each uuv is less than the expected speed so a constant b 2 satisfying b 2 v 0 can be found in practice if the control law are designed to satisfy the following conditions described in 43 the actual speed of each uuv is less than the constant b 2 that is v i b 2 43 max v x i v y i v z i 3 3 b 2 v 0 here a new quantity is defined as follows 44 b 3 min 3 3 v 0 b 1 3 3 b 2 v 0 where the constants b 1 b 2 v 0 and v 0 satisfies the condition 0 b 1 v 0 v 0 b 2 if equations 42 and 43 are to be set up at the same time we need to design the controller to meet the following condition 45 max v x i v y i v z i b 3 based on the above analysis we design the following control laws 46 q i f θ i θ i θ 0 q 0 47 r i f ψ i ψ i ψ 0 r 0 cos θ 0 cos θ i 48 f 1 i m 11 i f u i u i u 0 u 0 m 22 i v i r i m 33 i w i q i d 11 i u i 49 f 2 i m 55 i f q i q i q 0 q 0 m 33 i m 11 i u i w i d 55 i q i ρ g g m l i sin θ i 50 f 3 i m 66 i f r i r i r 0 r 0 m 11 i m 22 i u i v i d 66 i r i where f θ i f ψ i f u i f q i f r i r r are real valued nonlinear function define new variables as θ i θ i θ 0 ψ i ψ i ψ 0 u i u i u 0 q i q i q 0 and r i r i r 0 from equations 1 2 and 46 50 we can get the following dynamics 51 θ i f θ i θ i 52 ψ i f ψ i ψ i 53 u i f u i u i 54 q i f q i q i 55 r i f r i r i we study the system 51 firstly if θ i 0 the nonlinear function f θ i θ i 0 and θ i 0 the nonlinear function f θ i θ i 0 the system 51 is asymptotically stable the same study can be made for system 52 55 so the nonlinear functions f θ i f ψ i f u i f q i f r i should be designed to satisfy that f θ i s f θ i s f ψ i s f ψ i s f u i s f u i s f q i s f q i s f r i s f r i s are positive definite for s r we can choose positive constants k i 4 k i 5 k i 6 k i 7 k i 8 which satisfy k i 4 4 d f θ i r d r 0 k i 5 4 d f ψ i r d r 0 k i 6 4 d f u i r d r 0 k i 7 4 d f q i r d r 0 k i 8 4 d f r i r d r 0 respectively in this way the system 51 55 are asymptotically stable furthermore there are kl functions β θ i β ψ i β u i β q i β r i such that θ i t β θ i θ i 0 t ψ i t β ψ i ψ i 0 t u i t β u i u i 0 t q i t β q i q i 0 t and r i t β r i r i 0 t based on the property of continuous functions there are c θ 0 0 c ψ 0 0 c u 0 0 c v 0 0 c w 0 0 c q 0 0 and c r 0 0 such that for all v 0 v 0 v 0 θ 0 ψ 0 q 0 r 0 r c θ 0 c θ 0 c ψ 0 c ψ 0 c u 0 c u 0 c v 0 c v 0 c w 0 c w 0 c q 0 c q 0 c r 0 c r 0 56 u 0 c u 0 cos ψ 0 c ψ 0 cos θ 0 c θ 0 v 0 c v 0 sin ψ 0 c ψ 0 w 0 c w 0 cos ψ 0 c ψ 0 sin θ 0 c θ 0 u 0 cos ψ 0 cos θ 0 v 0 sin ψ 0 w 0 cos ψ 0 sin θ 0 b 3 57 u 0 c u 0 sin ψ 0 c ψ 0 cos θ 0 c θ 0 v 0 c v 0 cos ψ 0 c ψ 0 w 0 c w 0 sin ψ 0 c ψ 0 sin θ 0 c θ 0 u 0 sin ψ 0 cos θ 0 v 0 cos ψ 0 w 0 sin ψ 0 sin θ 0 b 3 58 u 0 c u 0 sin θ 0 c θ 0 w 0 c w 0 cos θ 0 c θ 0 u 0 sin θ 0 w 0 cos θ 0 b 3 based on the control laws 46 50 we can find a finite time t i 1 for the i th uuv to satisfy the conditions θ i t i 1 θ 0 t i 1 c θ 0 ψ i t i 1 ψ 0 t i 1 c ψ 0 u i t i 1 u 0 t i 1 c u 0 q i t i 1 q 0 t i 1 c q 0 r i t i 1 r 0 t i 1 c r 0 and thus condition 45 is satisfied at time t i 1 with the control law 48 and the condition v i 0 b 2 the result v i t b 2 can be got for t 0 t i 1 remark 2 controllers 39 41 do not conflict with 46 48 they belong to different control stages in the initial control stage controllers 46 50 are used to guarantee the i th uuv s velocity v i 0 at t t i 1 in the same time the errors θ i ψ i u i q i and r i tend to 0 based on controllers 46 50 when v i 0 the controllers 39 41 are validity the second control stage is using control laws 39 41 to achieve formation control objective if the condition 42 is not satisfied at the beginning of the control procedure the formation controllers 39 41 can not solely guarantee v i 0 and thus the initial control stage is necessary 3 2 main result and stability analysis in this part the small gain theorem is introduced first consider the system 59 χ 1 ℏ 1 χ 1 υ 2 υ 3 υ n κ 1 χ 2 ℏ 2 χ 2 υ 1 υ 3 υ n κ 2 χ n ℏ n χ n υ 1 υ 2 υ n 1 κ n the output of every subsystem is defined as follows 60 υ i ƛ i χ i where χ i r n i υ i r m i κ i r l i ℏ i and ƛ i are local lipschitz functions assume that the χ i subsystem of 59 is unboundedness observable and input to output stable with the input υ j j i and κ i and the output υ i specifically there exist α i o k β i kl γ i j k and γ i κ k such that 61 χ i t α i o χ i 0 j i y j 0 t κ i 0 t 62 y i t max j i β i χ i 0 t γ i j y j 0 t γ i κ κ i the cyclic small gain theorem for system 59 is given as follows the cyclic small gain theorem jiang wang 2008 it is assumed that every subsystem of 59 and 60 satisfies the conditions 61 and 62 for any simple loop if the condition 63 γ i 1 i 2 γ i 2 i 3 γ i r i 1 id holds the system 59 and 60 are unboundedness observable and input to output stable for any given κ functions γ 1 and γ 2 we say that γ 1 γ 2 id if γ 1 γ 2 r r for all r 0 id represents a unit function the v x i v y i v z i system defined in 12 14 is considered in this part based on the analysis detailed in section 3 1 the condition 45 is satisfied at time t i 1 we can choose bounded nonlinear functions f x i f y i f z i and the control laws 15 17 to guarantee the satisfaction of 45 after t i 1 define a digraph g f with n 1 nodes for i 1 n 1 define ℵ i as if there is a directed edge j i from the j th node to the i th node then j ℵ i each edge j i is assigned with a positive variable a i j for a simple loop ο of g f denote a ο as the product of the positive values assigned to the edges of the loop for i 1 n 1 denote ℓ f i as the set of simple loops of g f through the i th vertex the main result of this paper is proposed as follows theorem 1 consider the multiple uuvs kinematic and dynamic models described in 1 and 2 given the distributed control laws defined by 3 8 46 50 15 17 and 39 41 with parameters k i 1 k i 2 k i 3 satisfying 18 20 and with the assumption 1 if the position sensing digraph g has a spanning tree with node 0 as the root then the formation error variables x i t y i t z i t θ i t and ψ i t of the i th uuv asymptotically converge to zeroes with i 1 n 1 respectively proof consider the definition of b 3 in 44 and the condition 45 satisfied after t i 1 the conclusion v i 0 can be got and then the controllers 39 41 are valid for all t t i 1 denote x 0 0 y 0 0 and z 0 0 we rewrite φ x i φ y i and φ z i as follows 64 φ x i 1 n i j ℵ i x i d x i x 0 x j d x j x 0 1 n i j ℵ i x i x j x i 1 n i j ℵ i x j 65 φ y i 1 n i j ℵ i y i d y i y 0 y j d y j y 0 1 n i j ℵ i y i y j y i 1 n i j ℵ i y j 66 φ z i 1 n i j ℵ i z i d z i z 0 z j d z j z 0 1 n i j ℵ i z i z j z i 1 n i j ℵ i z j define new variables as h x i 1 n i j ℵ i x j h y i 1 n i j ℵ i y j and h z i 1 n i j ℵ i z j and thus the control laws 15 17 can be rewritten as follows 67 u x i k i 1 v x i f x i x i h x i 68 u y i k i 2 v y i f y i y i h y i 69 u z i k i 3 v z i f z i z i h z i now we denote t 0 max i 1 n 1 t i 1 for system 12 consider a control law taking the form shown in 67 with f x i satisfied condition 18 φ x i shown in 64 and based on the small gain theorem the closed loop system 12 67 and x ˆ i x i ω x i ω x i r represents an external input is unboundedness observable and is input to output stable with the following properties hold 70 x i t β x i x i 0 v x i 0 t t t 0 h x i t 0 t 71 v x i t v x i 0 α x i x i t 0 t h x i t 0 t where i 1 n 1 x i t 0 x i 0 v x i t 0 v x i 0 β x i is kl function and α x i is κ function in the same way we can conclude that the y i v y i system 13 and z i v z i system 14 with the related control laws are unboundedness observable and are input to output stable with the following properties hold 72 y i t β y i y i 0 v y i 0 t t t 0 h y i t 0 t 73 v y i t v y i 0 α y i y i t 0 t h y i t 0 t 74 z i t β z i z i 0 v z i 0 t t t 0 h z i t 0 t 75 v z i t v z i 0 α z i z i t 0 t h z i t 0 t where y i t 0 y i 0 v y i t 0 v y i 0 z i t 0 z i 0 v z i t 0 v z i 0 β y i β z i κ l and α y i α z i κ if we give n 1 constants l 1 l n 1 0 which satisfy the condition i 1 n 1 1 l i n 1 then for any constants d 1 d n 1 0 we have the conclusion i 1 n 1 1 l i l i d i n 1 max 1 i n 1 l i d i and thus the following results hold 76 h x i δ i max j ℵ i a i j x j 77 h y i δ i max j ℵ i a i j y j 78 h z i δ i max j ℵ i a i j z j if the node 0 ℵ i we will have δ i n i 1 n i ℵ i ℵ i 0 and j ℵ i 1 a i j n i 1 if 0 ℵ i we will get that δ i 1 ℵ i ℵ i and j ℵ i 1 a i j n i where ℵ i denote the set of the neighbors of the i th uuv except node 0 from the above analysis the properties 70 75 imply 79 x i t β x i x i 0 v x i 0 t t t 0 δ i max j ℵ i a i j x j t 0 t 80 v x i t v x i 0 α x i x i t 0 t δ i max j ℵ i a i j x j t 0 t 81 y i t β y i y i 0 v y i 0 t t t 0 δ i max j ℵ i a i j y j t 0 t 82 v y i t v y i 0 α y i y i t 0 t δ i max j ℵ i a i j y j t 0 t 83 z i t β z i z i 0 v z i 0 t t t 0 δ i max j ℵ i a i j z j t 0 t 84 v z i t v z i 0 α z i z i t 0 t δ i max j ℵ i a i j z j t 0 t from the explanation of ℵ i we know that ℵ i corresponds to a digraph g f which is a subgraph of g g f has n 1 nodes with indices 1 n 1 so g f represents the follower uuvs based on the definitions of ℵ i and g f we can conclude that for i 1 n 1 if j ℵ i there is a directed edge j i from the j th node to the i th node in g f consequently g f denotes the interconnection topology of the network composed of the x i v x i system 12 y i v y i system 13 and z i v z i system 14 let f 0 ℵ i 0 ℵ i i 1 n 1 be a index set if the nodes indices belong to f 0 we can define ℓ 0 ℓ 0 ℓ f as the set of all simple loops through these nodes for i 1 n 1 j ℵ i a positive value a i j can be chosen as edge for j i in g f and thus x i y i z i with i 1 n 1 can be regarded as the outputs of the network composed of the x i v x i system 12 y i v y i system 13 and z i v z i system 14 respectively if the following conditions described in 85 86 are satisfied the errors x i t y i t and z i t with i 1 n 1 will converge to the origin according to the ios small gain theorem jiang wang 2008 85 a ο n 2 n 1 1 for ο ℓ 0 86 a ο 1 for ο ℓ f ℓ 0 based on the assumption that g has a spanning tree with node 0 as the root the conditions 85 and 86 can be satisfied in this paper under above assumption g f has a spanning tree and its root nodes indices belong to f 0 and thus we can choose positive constants a i j to make the conditions 85 and 86 set up for systems 12 14 and 51 52 we can choose a lyapunov function as follows 87 v i 1 1 2 v x i 2 v y i 2 v z i 2 θ i 2 ψ i 2 by calculating we know that 88 v i 1 v x i u x i v y i u y i v z i u z i θ i f θ i θ i ψ i f ψ i ψ i subsitute 67 69 to 88 we can get that v i 1 0 89 v i 1 u x i 2 u y i 2 u z i 2 v x i u x i v y i u y i v z i u z i f θ i 2 θ i f ψ i 2 ψ i θ i d f θ i θ i d θ i ψ i d f ψ i ψ i d ψ i based on the equations 67 69 we can get that 90 u x i k i 1 v x i d f x i x i h x i d x i h x i 91 u y i k i 2 v y i d f y i y i h y i d y i h y i 92 u z i k i 3 v z i d f z i z i h z i d z i h z i subsitute 90 92 to 89 and using the conditions 18 20 the following result will be deduced 93 0 v i 1 u x i 2 u y i 2 u z i 2 f θ i 2 θ i f ψ i 2 ψ i k i 1 2 v x i 2 k i 1 2 16 k i 2 2 v y i 2 k i 2 2 16 k i 3 2 v z i 2 k i 3 2 16 θ i 2 k i 4 2 16 ψ i 2 k i 5 2 16 that is v i 1 is uniformly continuous according to the barbalat s lemma khalil 2001 we know that 94 lim t v i 1 0 lim t v x i lim t v y i lim t v z i lim t θ i lim t ψ i 0 and thus theorem 1 is proved 4 simulation analysis to illustrate that the approach is applicable to multiple uuvs system simulation study is carried out based on one leader and four follower uuvs moving in 3d space that is i 0 1 2 3 4 the uuv with index 0 is the leader the neighbor sets of the uuvs are defined as follows ℵ 1 0 4 ℵ 2 1 3 ℵ 3 2 ℵ 4 3 all of simulations are carried out using matlab software platform it is assumed that all of uuvs are equipped with propellers to provide the surge force the pitch moment and the yaw moment for this simulation the system parameters are selected as follows m 11 i 25 kg m 22 i 20 kg m 33 i 20 kg m 55 i 2 0 kgm 2 m 66 i 2 5 kgm 2 d 11 i 7 kgm s d 22 i 7 kgm s d 33 i 6 kgm s d 55 i 5 kgm s d 66 i 5 kgm s g m l i 1 m the initial positions and orientations of followers and the leader are given as follows x 1 0 20 y 1 0 10 z 1 0 1 θ 1 0 π 16 ψ 1 0 π x 2 0 10 y 2 0 10 z 2 0 1 5 θ 2 0 0 ψ 2 0 5 π 6 x 3 0 15 y 3 0 8 z 3 0 1 2 θ 3 0 π 8 ψ 3 0 2 π 3 x 4 0 12 y 4 0 9 z 4 0 1 3 θ 4 0 π 4 ψ 4 0 0 x 0 0 0 y 0 0 0 z 0 0 0 θ 0 0 π 12 ψ 0 0 π 6 the desired relative position of the follower uuvs are defined by d x 1 7 m d x 2 7 m d x 3 4 m d x 4 4 m d y 1 0 5 m d y 2 0 5 m d y 3 0 8 m d y 4 0 8 m d z 1 0 2 m d z 2 0 2 m d z 3 0 1 m d z 4 0 1 m see fig 2 based on backstepping technique the leader uuv can track a desired spatial path the control inputs of the leader uuv are detailed in heming 2012 the desired spatial path is set to 10 cos t 10 sin t 0 1 t choose v 0 3 m s v 0 3 5 m s and v 0 0 3 m s satisfies v 0 v 0 v 0 choose b 1 0 2 and b 2 7 2 the distributed control laws for the initialization stage are in the forms of 46 50 with f θ i s f ψ i s f u i s f q i s f r i s 0 5 1 exp 0 5 s 1 exp 0 5 s for i 1 2 3 4 the distributed control laws for the formation control stage are in the forms of 15 17 with k i 1 k i 2 k i 3 1 and f x i s f y i s f z i s 2 1 exp 0 5 s 1 exp 0 5 s for i 1 2 3 4 fig 3 shows the x y z plot of the leader and the followers trajectories fig 4 illustrates the formation error signals the linear velocities and the angular velocities of multiple uuvs are shown in fig 5 and fig 6 respectively as shown by these figures both of followers successfully track their desired range and bearing with respect to the leader in order to construct the desired formation fig 7 shows the control signals of the followers as depicted by fig 7 the control signals remain within a reasonable range and the actuator saturation is prevented fig 8 shows the comparison results of the coordination errors under two different control methods the leader follower formation control method based on path following xianbo 2010 requires a communication link between the leader and each follower and also needs to determine the motion path of each follower in advance which increases the condition limit for the controller as shown in fig 8 the control method proposed in this paper can make the coordination error converge faster the controller based on the small gain principle is better at dealing with nonlinear control problems with uncertainties 5 conclusion based on the nonlinear small gain method we introduced new formation system stabilizers for multiple uuvs the controller is deduced without global position measurements the designed controller can avoid the nonholonomic constraint of multiple uuvs the simple conditions are developed for practical implementation with the proposed distributed coordination controllers the formation control objective can be achieved without assuming any tree sensing structures simulation results successfully showed that the proposed controller can effectively solve the formation tracking problem further work will extend the methodology proposed to tackle complex coordination control problems namely coordinated control in the presence of stringent communication constraints that arise in the underwater world such as time delays tight energy budgets and reduced channel capacity acknowledgements this work was supported by the program in the youth elite support plan in universities of anhui province gxyq2017042 and the national natural science foundation of china 61702007 
