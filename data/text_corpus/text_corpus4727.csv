index,text
23635,oxides of nitrogen n o x are harmful to human health as such their emissions are monitored and controls are becoming increasingly stringent n o x formation is dependent on engine running conditions and therefore on ship operation there will be differences in the amount of n o x produced when a ship is travelling in a straight line compared to when manœuvring ships tend to spend more time in manoeuvring conditions around population dense areas such as inland waterways compared to when on the deep sea it is therefore important to investigate the difference that manœuvring motion has on n o x production compared to steady state running emission factors which are often given as a function of fuel oil consumption and based upon steady state conditions are frequently used to estimate engine emissions in this paper an emission factor is developed using a numerical engine model coupled with chemical kinetics computations the same model coupled to a ship manœuvring simulator is then used to compare n o x formation during manœuvring operations it is demonstrated that during manœuvres the developed simulator exhibits significant differences in n o x formation compared to the commonly used emission factor approaches keywords simulation manoeuvring emissions transient operation inland waterways nomenclature β p drift angle at propeller plane r a d δ r rudder angle r a d ρ density k g m 3 ϕ crank shaft angle r a d a h coefficient to account for interaction between the hull and rudder b ship s beam m b a r propeller s blade area ratio c o 2 carbon dioxide c h 4 methane d propeller diameter m f n force normal to the rudder from deflection of incident flow n i z z mass moment of inertia about the z axis k g m 2 j z z yaw added mass moment of inertia k g m 2 k q propeller torque coefficient k t propeller thrust coefficient l o a ship length overall m l n g liquefied natural gas m mass k g m x surge added mass k g m y sway added mass k g n h moment around midship yaw due to the ship hull s interaction with the water n m n h 0 yaw moment without added mass terms n m n r moment around midship yaw due to the action of the rudder n m n p moment around midship yaw due to action of the propeller n m n propeller s rotational speed r e v o l u t i o n s s 1 n c crankshaft rotational speed r e v o l u t i o n s s 1 n o x reference to nitrogen oxides generally n o 2 nitrogen dioxide n 2 o nitrous oxide n o nitric oxide p propeller pitch m or pressure n m 2 depending on context r yaw rate rad s 1 r c crank radius m t ship s draught m or temperature k depending on context t inside instantaneous temperature inside cylinder k t outside instantaneous temperature outside cylinder k t time s t r rudder drag correction coefficient t d f thrust deduction factor u heat transfer coefficient for conduction convection w m 2 u surge velocity m s 1 u k c under keel clearance usually given as of draught m s 1 v v resultant ship velocity m s 1 v sway velocity m s 1 v o sway velocity at midship m s 1 w p wake fraction at propeller plane x h force in the x surge direction due to the ship hull s interaction with the water n x h 0 ship resistance in calm water n x r force in the x surge direction due to the action of the rudder n x p force in the x surge direction due to action of the propeller n x h x coordinate of the point of application of the lift from the hull with respect to amidships m x p x coordinate of propeller with respect to midships m x r x coordinate of the centre of pressure of the rudder with respect to midships m y h force in the y sway direction due to the ship hull s interaction with the water n y h 0 sway force without added mass terms n y r force in the y sway direction due to the action of the rudder n y p force in the y sway direction due to action of the propeller n 1 introduction mandatory regulations from bodies such as the international maritime organisation imo restrict the amount of exhaust gas emissions produced by ships imo 2005 in order to meet these requirements of increasingly stringent regulations the maritime sector is turning to alternative fuels such as liquefied natural gas lng lng has shown to be a viable alternative to conventional diesel fuel in terms of both emissions and cost burel et al 2013 projects such as the lng masterplan seitz et al 2015 demonstrate lngs viability especially for inland waterways where the lng infrastructure for refuelling can be established with relative ease hence lng is chosen as the main propulsion fuel used in this study certain exhaust gas species are known to be harmful to human health kampa and castanas 2008 and contribute to environmental problems such as global warming and acid rain for these reasons mechanisms are required to estimate the amount of exhaust gas emissions produced from operating ships the focus of this paper is around n o x formation from transient propulsion loading not only because of its associated impact on human health and the environment but for the reason that other salient species such as carbon dioxide c o 2 or oxides of sulphur s o x can be adequately estimated using emission factors based upon stoichiometric combustion as will be shown in this study there are mechanisms currently capable of estimating the amount of n o x produced by combustion perhaps the most simple are those based upon emission factors these can either be based upon a direct relation to fuel consumption mepc 2014 or as a function of engine power and speed murphy and pazouki 2012 these methods give a rough estimate and are relevant to specific fuel and engine types emission factor based approaches provide an extremely computationally fast estimate of emissions zeldovich 1946 provides a mechanism to estimate the thermal n o formation methods based upon these approaches have a limited number of reactions and it can be challenging to estimate required oxygen atom concentration zeldovich based mechanisms are however relatively computationally fast chemical kinetics analysis can accurately model n o x formation as well as many other species and with increased modern computing power a chemical kinetics routine can be comfortably incorporated into a numerical engine model to provide estimates of emissions under varying loading conditions the use of chemical kinetics solvers allows analysis of how different conditions can influence the speed of reactions and yield details about the reaction s mechanism and transition states the reaction mechanism is a step by step sequence of elementary reactions by which overall chemical change occurs the use of a chemical kinetics solver therefore suites itself well to the study of unsteady behaviour on emissions a number of existing chemical kinetics solvers exist including chemkin reaction design 2017 cantera goodwin et al 2017 and the kinetic preprocessor damian et al 2017 in this study cantera was chosen due to its performance robustness and ease of portability into existing ship manœuvring simulator code there are currently several different perspectives on numerically modelling engines depending upon the intended application hountalas 2000 found that due to engine specification and diversity a specific software needs to be written for each application murphy et al 2015 have developed a time domain based engine simulator considering differing gas properties under full part or transient loading for particularly detailed engine models accounting for elements such as cylinder shapes or injection spray patterns computational fluid dynamic methods may be employed kilpinen 2010 these latter models require significant amounts of computing resources and engine detail which are impracticable for certain applications such as initial design or emission surveys for a stretch of water which this study aims to address among the most popular techniques used to model engine performance are the quasi steady flow models and the filling and emptying models quasi steady models predict performance characteristics from a thermodynamics based analysis calculating mass flow rates into and out of the cylinder through inlet and exhaust valves if the pressure variation with respect to time is small then such methods can be useful in the filling and emptying models manifolds are represented as finite volumes where the mass of gas can vary with time in transient conditions where engine load varies with time manifold conditions will vary it is this latter method which is utilised in this study soares et al 2015 uses an engine model in conjunction with a chemical kinetics routine to estimate exhaust emissions from a two stroke diesel engine the results of which are validated against data from real engines in order to obtain realistic service condition loading scenarios on a numerical engine model the current study uses a ship manœuvring simulator coupled to the engine model this provides the engine model with dynamic loading experienced by the propeller as the ship manœuvres and thus the basis to estimate exhaust gas emissions over a route numerous ship manœuvring simulators exist including ones which specialise in inland waterway applications and can account for phenomena such as shallow water effects eloot and vantorre 2003 they are usually based in the time domain which make them well suited for estimation of n o x formation where residence time is a critical factor ship manœuvring simulators are also coupled with engine simulators and are commonly found in full mission bridge simulators kongsberg gruppen 2017 these latter simulators are for the purposes of training crew and used to provide feedback between the engine and deck departments of a ship currently the effect of a ship s manœuvring motion is not taken into account when calculating the production of emissions this paper aims to address this and its significance by investigating the effects of manœuvring motion on n o x formation from a propulsion system fuelled by lng although the methodology is applicable to other fuels and exhaust gas species whilst applicable to ocean going vessels this study concentrates on inland waterway transport such as found on the rhine main danube canal this waterway stretches from the black sea to the north sea and navigable throughout its length by large barges the canal passes through many towns and cities where the effects of n o x emissions being toxic to humans are of interest the waterway has numerous bends which demand the propulsion system to operate away from the steady state design point whilst navigating these passages this deviation from steady state running conditions either due to environmental loading or manœuvring has strong implications for estimation of n o x emissions the transient operation can produce fuel consumption and exhaust gas emission estimates that are significantly different to averaged steady state calculations commonly used to estimate emissions significant challenges arise when obtaining an accurate numerical manœuvring simulation model in confined waters full scale ship manœuvring trials in shallow water are rare the ship s kinematics forward speed rate of turn drift angle response of propulsion and the control system are all affected by operation in restricted water the most accurate way of modelling ship manœuvring behaviour especially in shallow water is from the use of model tests vantorre 2003 the aim of this study is to obtain an initial estimate of how the magnitude of emissions changes with the unsteady state experienced when a ship is manœuvring thus at this stage rather than carry out costly and time consuming model tests this research utilises established corrections for several confined water effects a detailed overview of methods can be found in the report of ittc manoeuvring committee 2002 although the effects of muddy bottoms on ship manœuvrability are being developed delefortrie et al 2005 the effect has been excluded from this initial investigation once a realistic relationship between emissions and unsteady manœuvring behaviour is shown to be of significance then numerical models can be further refined and tuned for accuracy on particular ships and propulsion units simulation of a ship s manoeuvring motion has been examined by various people including the whole ship type approach of abkowitz 1964 and the modular approach used by hirano 1981 and oltmann and sharma 1984 an advantage of the modular approach is being able to study separate components such as rudder geometry of the ship without requiring to arrive at new manœuvring derivatives it is this approach that is used in this study these techniques solve a series of ordinary differential equations odes in the time domain which is especially suited when it comes to coupling with an engine simulator whose emission estimates are dependent on time 2 methodology in order to simulate the effects of transient manœuvring motion on n o x formation a n o x emission factor is formulated by running the developed simulator in the calm water dead ahead condition at the basis vessel s design speed the resulting emission factor is a function of fuel consumption this emission factor is then used to estimate n o x emissions throughout the time history of the vessel s manœuvre at the associated engine loading unsteady n o x emissions are also calculated by coupling the ship manœuvring and engine simulator to a chemical kinetics solver these resulting emissions account for unsteady manœuvring behaviour and the unsteady response of the engine the results from the steady state emission factor estimates are then compared to the values obtained from the chemical kinetics calculations the time resolution required for a ship manœuvring simulation is far lower than that required to model n o x formation from the engine model approximately by a factor of 10 5 to ensure fast computation times two time resolutions are used one for manœuvring another for engine simulation the engine model is called at each time step of the manœuvring model and run for the duration of the engine model s time step this assumes that the engine loading will not change significantly over the time step of the manœuvring model which is chosen to reflect this 2 1 basis vessel the basis vessel used in this analysis is a single screw inland waterway barge the main particulars of which have been chosen for passage through the rhine main danube canal and can be found in table 1 the vessel is powered by a four stroke lng fuelled diesel cycle engine 2 2 basis manœuvres the manœuvres performed by the basis vessel are part of a standard 35 rudder turning circle and a 20 20 zig zag manœuvre this ensures repeatability of the analysis whilst the turning circle manœuvre is quite severe it is not unrealistic for a ship to undergo a 180 heading change on sections of the rhine main danube canal for example near the town of hinova on the romanian serbian boarder this turning circle manœuvre will also move the operation point further away from the design point when compared to the zig zag manœuvre the zig zag manœuvre is intended to mimic manœuvres more commonly experienced on inland waterways the 35 rudder turning circle manœuvre is represented in fig 1 and the 20 20 zig zag manœuvre is represented in fig 3 the simulation for manœuvres was truncated after 350 s taking into account the induced sway and yaw motions as well as the dynamic response of the propulsion system the resulting change in ship speed can be seen in fig 2 for the turning circle and fig 4 for the 20 20 zig zag manœuvre and shows some effects associated with the confined waters of the canal 2 3 manœuvring simulation a three degree of freedom manœuvring simulator has been developed in the manoeuvring motions of surge sway and yaw and relates the dynamic loading on the propeller to the engine model trodden et al 2016 the approach taken in the development of the simulator used in this study is to solve a series of differential equations in the time domain described in the following subsections 2 3 1 equations of motion it can be shown that the equations of motion in surge sway and yaw with the origin located at the centre of gravity can be written as equation 1 1a m u r v x h x r x p surge 1b m v r u y h y r y p sway 1c i z z r n h n r n p yaw where m is the mass of the ship i z z is the mass moment of inertia around a vertical axis u and v is the ship s velocity in pure surge and sway respectively and r is the ship s rate of change of heading the subscripts h r p in equation 1 denote hull rudder and propeller respectively the methodologies used to estimate these contributions are briefly discussed next 2 3 2 hull the longitudinal force on the ship s hull x h transverse force on the ship s hull y h and the yaw moment on the ship s hull n h can be written as equation 2 2a x h m x u m y x v r v o r x h o u 2b y h m y v m x u r y h o v o r 2c n h j z z r n h o v o r the hull s manœuvring derivatives are obtained from the study of inoue et al 1981 2 3 3 rudder the calculation for the longitudinal force drag x r transverse force y r and turning yawing moment n r imposed upon the ship by the action of the rudder are expressed in the form of equation 3 3a x r 1 t r f n sin δ r 3b y r 1 a h f n cos δ r 3c n r x r a h x h f n cos δ r where f n is the force normal to the rudder t r is a rudder drag correction coefficient a h is a coefficient to account for the interaction between the hull and rudder x h is the x coordinate of the point of application of the lift from the hull with respect to amidships x r is the x coordinate of the centre of pressure of the rudder with respect to amidships δ r is the rudder s angle coefficients a h and x h are affected by water depth and are accounted for as discussed in section 2 3 6 the rudder s normal force is considerably influenced by the nature of the propeller s slip stream that is its wake contraction and velocity the scheme described by lee et al 2003 is used to calculate the effective rudder inflow velocity the electromotive oil pressure steering gear model of son 1989 is used to account for the time lag between the order given for the rudder to be put over and the machinery s response 2 3 4 engine propeller dynamics the main propulsion engine is based on a four stroke diesel cycle burning lng fuel the difference between the resisting torque of the water on the propeller and the output torque from the engine results in the acceleration of the drive chain further details of the engine dynamics can be found in section 2 4 2 3 5 propeller expressions for the thrust and torque coefficients k t and k q respectively on a b screw series propeller are obtained from the methods described in oosterveld and van oossanen 1975 the calculation scheme for the longitudinal force x p transverse force y p and yawing moment n p follows that of equation 4 4a x p 1 t d f ρ n 2 d 4 k t 4b y p 0 4c n p 0 where ρ is water density n is propeller rotational speed and d is propeller diameter the wake fraction at the propeller plane for a ship at zero drift angle w p 0 and thrust deduction factor t d f are calculated from the analysis carried out by holtrop 1984 equation 5 from the work of hirano 1981 is used to estimate the wake fraction at the propeller plane 5 w p w p 0 exp 4 0 β p 2 where the drift angle at the propeller β p is given by equation 6 6 β p arcsin v x p r v v x p is the x coordinate of the propeller with respect to amidships a negative value 0 5 l p p v is the sway velocity and v v is the resultant ship speed in this study the effective wake fraction at zero drift angle w p 0 is assumed to be a function of the thrust identity and hence advance coefficient following the method of holtrop 1984 throughout this analysis the ship is operating within the first quadrant that is an ahead rotational speed and ahead speed of advance a method to correct for the thrust deduction fraction in different quadrants can be found in harvald 1967 for container ships in shallow water the method proposed by delefortrie and vantorre 2007 may be used 2 3 6 considerations for the influence of confined water shallow water may be defined as 1 2 h t 1 5 pianc 1992 where h is water depth and t is draught shallow water significantly affects ship behaviour ittc manoeuvring committee 2002 and is accounted for using the following techniques in this study the hypothesis of schlighting 1940 is used to estimate speed resistance relations in shallow water for sub critical froude numbers with corrections from lakenby 1963 for blockage effects further adaptations from landweber 1939 are used to account for water of finite width the magnitude of the thrust deduction fraction decreases somewhat with decreasing water depth however according to yoshimura 1986 in a practical sense it can assumed to be constant in the current research this is the assumption made however there are formulations that account for variation in water depth for particular ships eg delefortrie and vantorre 2007 the wake factor which increases significantly with decreasing water depth is corrected for shallow water effects following the method of yasukawa 1998 following the work of nordco ltd 1989 the variation of roll added mass and added mass moment of inertia of the propeller with water depth are assumed to be negligible linear manœuvring derivatives are corrected following the method of kijima 1991 non linear manœuvring derivatives are corrected for water depth following methods proposed by hirano 1985 and kijima 1989 added inertia coefficients are corrected for shallow water following the method of li and wu 1990 stern flow separation increases with decreasing water depth and thus decreases the effect of the rudder on the other hand this is somewhat counterbalanced by the increase in propeller race due to shallow water in this study the effect of shallow water on rudder forces has been neglected however hull rudder interaction coefficients are obtained from kijima et al 1990 with corrections for shallow water by yumuro 1985 sinkage due to shallow water has been estimated from tuck and taylor 1970 stern trim from the effects of shallow water is estimated from the work of yoshimura 1986 the width of the rhine danube main canal is used throughout this analysis namely 55 m width the depth of the canal is 4 m however a depth of 5 1 m is used as the limits of coefficients used for sway and yaw added mass break down at a depth draught ratio of less than 1 2 sheng 1981 in fact the canal is trapezoidal in cross section however this is not accounted for in this study whilst the effects of water depth is important on inland waterways this study concentrates on differences in emissions between steady state emission factor approaches and estimates accounting for the transient nature of loading variation thus it is not considered of paramount importance at this stage to reproduce to a very high degree of accuracy the effects of shallow water on manœuvring and indeed to achieve such accuracy would ideally involve model testing vantorre 2003 beyond the scope of the current study however results published by ittc 2002 indicate encouraging results for the esso osaka fig 5 the esso osaka is one of the few full scale ships for which for which shallow water manœuvring analysis exist crane 1979 2 4 numerical engine model rather than reproducing with a high degree of fidelity the dynamics of a particular physical engine the developed model is representative of the diesel cycle and is used as a basis to provide the thermodynamics kinetics and transport solver the necessary input parameters an example indicator diagram output of the simulated cycle is given in fig 6 in the process of estimating n o x formation the numerical model is suitable for a qualitative study of comparing differences in emissions between steady state design point performance and transient behaviour the instantaneous volume within the cylinder is calculated knowing the cylinder dimensions and instantaneous piston speed the corresponding pressure and temperature are estimated using cantera goodwin et al 2017 the solver chosen to analyse the thermodynamics kinetics and transport solutions throughout the simulation essentially cantera evaluates chemical sources and their properties from established reaction mechanisms so as to satisfy the transport processes described by the continuum mechanics and the governing equations for mass momentum and energy conservation the solving of these equations allows the temporal integration of the kinetic system cantera handles this efficiently through the use of dedicated nonlinear differential algebraic equation solvers hindmarsh et al 2005 the reaction mechanism used to model the lng combustion is gri mech 3 0 smith et al 2000 this is a compilation of 325 elementary chemical reactions and associated rate coefficient expressions and thermochemical parameters for the 53 species involved in them the thermochemistry is based upon standard databases such as those from mcbride et al 1993 and kee et al 1990 and contain polynomial fits to specific heats standard state enthalpies and entropies it is a proven mechanism and efficient for simulations to calculate the thermodynamics kinetics and transport properties of the combustion process within cantera the solution class is loaded with the reaction mechanisms the reactor mechanism used for containing and controlling the chemical reactions within the cylinders is a zero dimensional model for ideal gas mixtures inlets are defined as a constant state reservoir accounting for turbocharger temperature and pressure the outlet is a constant state reservoir with ambient temperature pressure and gas composition properties inlet and outlet reservoirs are connected via the valve class whose mass flow rate is a function of the pressure drop across it as in equation 7 7 m k v p 1 p 2 where p 1 and p 2 is the pressure of reservoir and reactor respectively by choosing a suitably large value of k v very small pressure differences will result in flow between the reactor mechanism counteracting any pressure difference the injector is modelled via the massflowcontroller class maintaining a specified mass flow rate independent of upstream and downstream reactor conditions and loaded with appropriate values for p t and fuel composition the piston is modelled from the dynamics of a general crank slider mechanism as a moving wall object separating the reactor cylinder from the reservoirs valves the piston velocity is defined by equation 8 8 v 0 t r c 2 π n c s i n ϕ t where r c is the crank radius half the stroke n c is the rotational velocity of the crankshaft and ϕ is the crank angle the heat flux through the piston wall is computed from 9 q u t inside t outside ε t inside 4 t outside 4 where u is the overall heat transfer coefficient for conduction convection and ε is the emissivity t inside and t outside is the instantaneous temperature inside and outside the cylinder respectively the simulation is begun by setting initial conditions for inlet temperature pressure gas composition and outlet pressure at the appropriate crank angle of the engine cycle using pre set valve timings the relationship between mass flow rate and the pressure drop across the valves are set using a constant of proportionality k g s a relationship this also applies to injection timings where the mass flow rate k g s through the controller is set to a constant value rather than a function of time as this level of fidelity is considered excessive at this stage of development a reactornet class is created containing the cylinder and the advance function is used to simultaneously advance the state of the reactor in time ie solve the governing equations 2 5 prediction of n o x the kinetics class of cantera is used to evaluate the reaction rates and species production rates within the cylinder reactor fig 7 shows gas composition results from the simulation and illustrates how for a particular engine speed engine operating conditions play a crucial role in n o x formation when compared with c o 2 this demonstrates the non linear process of n o x formation throughout the cycle in particular during ignition this phenomenon is not taken into account in the steady state emission factor approaches commonly used to assess n o x emissions 2 6 emission factor development and usage a popular way of estimating emissions is from the use of emission factors most of which are directly related to fuel consumption such as those specified in the imo s third greenhouse gas study mepc 2014 for the marine industry most of these emission factors are based upon generic diesel engines burning medium or heavy fuel oil in order to illustrate the difference in magnitude of n o x emissions from steady state and transient operation an emission factor is developed in this study using the developed simulator the resulting emission factor is solely based upon the fuel oil consumption of the engine running at the designed operating conditions the emissions estimates which are generated from the use of emission factors are calculated by multiplying the emission factor by the fuel consumption for the particular time step during the simulation a reason for calculating an emission factor from the simulation rather than using one from the literature is that it is then possible to compare the performance of the same numerical engine model which exhibits identical characteristics over a wide range of loading conditions without an extremely elaborate engine model it would be challenging to reproduce an exact model which describes the unsteady response of an existing physical engine which is suitable for unsteady n o x evaluation at this stage of the investigation in which an estimate of the differences in emissions between commonly used steady state emission factor approaches and unsteady transient analysis such an engine model is deemed unnecessary 2 7 engine model validation it is challenging to obtain information about the n o x emissions from an lng fuelled engine in transient operation that relate in sufficient detail the rate of change of loading and the subsequent effect on emission formation in order to obtain some degree of confidence in the developed numerical model a test engine is implemented to determine its correlation with established emission factor results work conducted by stenersen and thonstad 2017 compared on board measurements of n o x emissions from ships and found the average n o x emissions for lng fuelled 4 stroke compression ignition engines to be 10 1 g k g fuel or 1 8 g k w h based upon 39 measurements as part of their study a wärtsilä 20df four stroke engine was used in their analysis of emissions it is the main dimensions of this engine that is used as a validation test engine in the current study the main particulars of the engine are listed in table 2 with some manipulation of parameters such as valve timings and inlet temperature and pressures the numerical model with the main dimensions of the wärtsilä 20df was able to produce an output of 152 k w c y l at a mean effective pressure of 24 b a r the corresponding n o x emissions were 8 61 g k g this value is considered accurate enough to be useful especially considering the spread in results from stenersen and thonstad 2017 the authors stress that the results from this analysis may not be indicative of this actual engine s emissions as there are numerous factors such as piston geometry that are not accounted for in this analysis which do have an effect on emission production 3 results and discussion of ship manœuvring operation on exhaust gas emissions for the simulations of the confined water turning circle and zig zag manœuvres outlined in section 2 2 figs 8 and 9 show a graphical representation of how the percentage differences between the unsteady chemical kinetics based estimates and the steady state emission factor based approach vary with time figs 10 and 11 show results for maximum and mean percentage differences for n o x and c o 2 emissions for the confined water turning circle and zig zag manœuvres respectively as described in section 2 2 as expected the c o 2 discrepancy between the two methods is low indicating that c o 2 can be adequately modelled based upon stoichiometric combustion referring to figs 10 and 11 as an example the value of n o 2 formation calculated using the method illustrated in this research for the transient operation is nearly four times that of the steady state estimate the interrelated properties of the combustion process and transient engine loading from ship manœuvres indicates that a time domain simulation lends itself especially well to prediction of n o x emissions when used in conjunction with a chemical kinetics solver this method can provide increased realism and accuracy in the prediction of exhaust gas emissions compared to commonly used steady state operation independent emission factor approaches whose only dependency is fuel consumption an emission factor based upon speed and power could potentially be developed using the proposed method this emission factor can subsequently be utilised in fast efficient simulations in a manner suitable for multiple runs for example in scenarios for conducting emission compliance over different speeds or routes this can be used to bring awareness to operators regarding n o x production when used on bridge simulators akin to a speed over ground indicator the magnitude in the difference of n o x formation between steady state estimates and analysis of transient operation suggests that it would be prudent for future regulations to account for transient operation especially in areas where a significant amount of manœuvring occurs when comparing the differences between the commonly used emission factor approach and the transient analysis for the turning circle and zig zag manœuvres it can be seen that the magnitude of n 2 o is markedly different this indicates that n 2 o is more susceptible to transient operation compared to n o and n o 2 and reflects the generally higher residence time associated with the turning circle manœuvre to proceed along these lines of analysis it is suggested that the development of the engine model is refined to reflect a higher degree of fidelity the current engine model serves to illustrate the magnitude in differences of n o x formation between steady state and transient operation 4 conclusions n o x production is predominantly a function of engine speed or residence time and loading a time domain based manœuvring simulator coupled with an engine model and chemical kinetics solver offers a well suited solution for estimation of n o x formation a manœuvring simulator is used to produce the unsteady loading on the propeller and engine it is demonstrated that due to the attitude of a ship travelling through the water differences in predicted required power arise compared to that of the steady state dead ahead calm water estimate it is the latter case that is often used when predicting exhaust gas emission estimates it is shown that manœuvring motion has a significant effect on n o x formation estimates which are substantially different to the common practice based on the steady state design point during a simulation in confined water to manœuvre the basis vessel over a turning circle described in section 2 2 the mean difference between steady state and transient estimates for n o n o 2 and n 2 o are 76 5 195 1 74 4 respectively during the zig zag manœuvre the mean differences n o n o 2 and n 2 o are 55 7 191 5 10 0 respectively caution should therefore be employed if using steady state emission factors when estimating n o x emissions especially in areas where manœuvring occurs frequently the difference in c o 2 formation is found to be 3 6 and 0 69 for the confined water turning circle and zig zag manœuvres respectively indicating that stoichiometric combustion based approaches are able to adequately predict c o 2 formation it is shown that n 2 o is more susceptible to transient loading compared with n o and n o 2 the presented methodology allows scenarios to be conducted highlighting areas of a shipping route that are in danger of exceeding permitted limits or providing solutions for operating strategies to comply with emission regulations 
23635,oxides of nitrogen n o x are harmful to human health as such their emissions are monitored and controls are becoming increasingly stringent n o x formation is dependent on engine running conditions and therefore on ship operation there will be differences in the amount of n o x produced when a ship is travelling in a straight line compared to when manœuvring ships tend to spend more time in manoeuvring conditions around population dense areas such as inland waterways compared to when on the deep sea it is therefore important to investigate the difference that manœuvring motion has on n o x production compared to steady state running emission factors which are often given as a function of fuel oil consumption and based upon steady state conditions are frequently used to estimate engine emissions in this paper an emission factor is developed using a numerical engine model coupled with chemical kinetics computations the same model coupled to a ship manœuvring simulator is then used to compare n o x formation during manœuvring operations it is demonstrated that during manœuvres the developed simulator exhibits significant differences in n o x formation compared to the commonly used emission factor approaches keywords simulation manoeuvring emissions transient operation inland waterways nomenclature β p drift angle at propeller plane r a d δ r rudder angle r a d ρ density k g m 3 ϕ crank shaft angle r a d a h coefficient to account for interaction between the hull and rudder b ship s beam m b a r propeller s blade area ratio c o 2 carbon dioxide c h 4 methane d propeller diameter m f n force normal to the rudder from deflection of incident flow n i z z mass moment of inertia about the z axis k g m 2 j z z yaw added mass moment of inertia k g m 2 k q propeller torque coefficient k t propeller thrust coefficient l o a ship length overall m l n g liquefied natural gas m mass k g m x surge added mass k g m y sway added mass k g n h moment around midship yaw due to the ship hull s interaction with the water n m n h 0 yaw moment without added mass terms n m n r moment around midship yaw due to the action of the rudder n m n p moment around midship yaw due to action of the propeller n m n propeller s rotational speed r e v o l u t i o n s s 1 n c crankshaft rotational speed r e v o l u t i o n s s 1 n o x reference to nitrogen oxides generally n o 2 nitrogen dioxide n 2 o nitrous oxide n o nitric oxide p propeller pitch m or pressure n m 2 depending on context r yaw rate rad s 1 r c crank radius m t ship s draught m or temperature k depending on context t inside instantaneous temperature inside cylinder k t outside instantaneous temperature outside cylinder k t time s t r rudder drag correction coefficient t d f thrust deduction factor u heat transfer coefficient for conduction convection w m 2 u surge velocity m s 1 u k c under keel clearance usually given as of draught m s 1 v v resultant ship velocity m s 1 v sway velocity m s 1 v o sway velocity at midship m s 1 w p wake fraction at propeller plane x h force in the x surge direction due to the ship hull s interaction with the water n x h 0 ship resistance in calm water n x r force in the x surge direction due to the action of the rudder n x p force in the x surge direction due to action of the propeller n x h x coordinate of the point of application of the lift from the hull with respect to amidships m x p x coordinate of propeller with respect to midships m x r x coordinate of the centre of pressure of the rudder with respect to midships m y h force in the y sway direction due to the ship hull s interaction with the water n y h 0 sway force without added mass terms n y r force in the y sway direction due to the action of the rudder n y p force in the y sway direction due to action of the propeller n 1 introduction mandatory regulations from bodies such as the international maritime organisation imo restrict the amount of exhaust gas emissions produced by ships imo 2005 in order to meet these requirements of increasingly stringent regulations the maritime sector is turning to alternative fuels such as liquefied natural gas lng lng has shown to be a viable alternative to conventional diesel fuel in terms of both emissions and cost burel et al 2013 projects such as the lng masterplan seitz et al 2015 demonstrate lngs viability especially for inland waterways where the lng infrastructure for refuelling can be established with relative ease hence lng is chosen as the main propulsion fuel used in this study certain exhaust gas species are known to be harmful to human health kampa and castanas 2008 and contribute to environmental problems such as global warming and acid rain for these reasons mechanisms are required to estimate the amount of exhaust gas emissions produced from operating ships the focus of this paper is around n o x formation from transient propulsion loading not only because of its associated impact on human health and the environment but for the reason that other salient species such as carbon dioxide c o 2 or oxides of sulphur s o x can be adequately estimated using emission factors based upon stoichiometric combustion as will be shown in this study there are mechanisms currently capable of estimating the amount of n o x produced by combustion perhaps the most simple are those based upon emission factors these can either be based upon a direct relation to fuel consumption mepc 2014 or as a function of engine power and speed murphy and pazouki 2012 these methods give a rough estimate and are relevant to specific fuel and engine types emission factor based approaches provide an extremely computationally fast estimate of emissions zeldovich 1946 provides a mechanism to estimate the thermal n o formation methods based upon these approaches have a limited number of reactions and it can be challenging to estimate required oxygen atom concentration zeldovich based mechanisms are however relatively computationally fast chemical kinetics analysis can accurately model n o x formation as well as many other species and with increased modern computing power a chemical kinetics routine can be comfortably incorporated into a numerical engine model to provide estimates of emissions under varying loading conditions the use of chemical kinetics solvers allows analysis of how different conditions can influence the speed of reactions and yield details about the reaction s mechanism and transition states the reaction mechanism is a step by step sequence of elementary reactions by which overall chemical change occurs the use of a chemical kinetics solver therefore suites itself well to the study of unsteady behaviour on emissions a number of existing chemical kinetics solvers exist including chemkin reaction design 2017 cantera goodwin et al 2017 and the kinetic preprocessor damian et al 2017 in this study cantera was chosen due to its performance robustness and ease of portability into existing ship manœuvring simulator code there are currently several different perspectives on numerically modelling engines depending upon the intended application hountalas 2000 found that due to engine specification and diversity a specific software needs to be written for each application murphy et al 2015 have developed a time domain based engine simulator considering differing gas properties under full part or transient loading for particularly detailed engine models accounting for elements such as cylinder shapes or injection spray patterns computational fluid dynamic methods may be employed kilpinen 2010 these latter models require significant amounts of computing resources and engine detail which are impracticable for certain applications such as initial design or emission surveys for a stretch of water which this study aims to address among the most popular techniques used to model engine performance are the quasi steady flow models and the filling and emptying models quasi steady models predict performance characteristics from a thermodynamics based analysis calculating mass flow rates into and out of the cylinder through inlet and exhaust valves if the pressure variation with respect to time is small then such methods can be useful in the filling and emptying models manifolds are represented as finite volumes where the mass of gas can vary with time in transient conditions where engine load varies with time manifold conditions will vary it is this latter method which is utilised in this study soares et al 2015 uses an engine model in conjunction with a chemical kinetics routine to estimate exhaust emissions from a two stroke diesel engine the results of which are validated against data from real engines in order to obtain realistic service condition loading scenarios on a numerical engine model the current study uses a ship manœuvring simulator coupled to the engine model this provides the engine model with dynamic loading experienced by the propeller as the ship manœuvres and thus the basis to estimate exhaust gas emissions over a route numerous ship manœuvring simulators exist including ones which specialise in inland waterway applications and can account for phenomena such as shallow water effects eloot and vantorre 2003 they are usually based in the time domain which make them well suited for estimation of n o x formation where residence time is a critical factor ship manœuvring simulators are also coupled with engine simulators and are commonly found in full mission bridge simulators kongsberg gruppen 2017 these latter simulators are for the purposes of training crew and used to provide feedback between the engine and deck departments of a ship currently the effect of a ship s manœuvring motion is not taken into account when calculating the production of emissions this paper aims to address this and its significance by investigating the effects of manœuvring motion on n o x formation from a propulsion system fuelled by lng although the methodology is applicable to other fuels and exhaust gas species whilst applicable to ocean going vessels this study concentrates on inland waterway transport such as found on the rhine main danube canal this waterway stretches from the black sea to the north sea and navigable throughout its length by large barges the canal passes through many towns and cities where the effects of n o x emissions being toxic to humans are of interest the waterway has numerous bends which demand the propulsion system to operate away from the steady state design point whilst navigating these passages this deviation from steady state running conditions either due to environmental loading or manœuvring has strong implications for estimation of n o x emissions the transient operation can produce fuel consumption and exhaust gas emission estimates that are significantly different to averaged steady state calculations commonly used to estimate emissions significant challenges arise when obtaining an accurate numerical manœuvring simulation model in confined waters full scale ship manœuvring trials in shallow water are rare the ship s kinematics forward speed rate of turn drift angle response of propulsion and the control system are all affected by operation in restricted water the most accurate way of modelling ship manœuvring behaviour especially in shallow water is from the use of model tests vantorre 2003 the aim of this study is to obtain an initial estimate of how the magnitude of emissions changes with the unsteady state experienced when a ship is manœuvring thus at this stage rather than carry out costly and time consuming model tests this research utilises established corrections for several confined water effects a detailed overview of methods can be found in the report of ittc manoeuvring committee 2002 although the effects of muddy bottoms on ship manœuvrability are being developed delefortrie et al 2005 the effect has been excluded from this initial investigation once a realistic relationship between emissions and unsteady manœuvring behaviour is shown to be of significance then numerical models can be further refined and tuned for accuracy on particular ships and propulsion units simulation of a ship s manoeuvring motion has been examined by various people including the whole ship type approach of abkowitz 1964 and the modular approach used by hirano 1981 and oltmann and sharma 1984 an advantage of the modular approach is being able to study separate components such as rudder geometry of the ship without requiring to arrive at new manœuvring derivatives it is this approach that is used in this study these techniques solve a series of ordinary differential equations odes in the time domain which is especially suited when it comes to coupling with an engine simulator whose emission estimates are dependent on time 2 methodology in order to simulate the effects of transient manœuvring motion on n o x formation a n o x emission factor is formulated by running the developed simulator in the calm water dead ahead condition at the basis vessel s design speed the resulting emission factor is a function of fuel consumption this emission factor is then used to estimate n o x emissions throughout the time history of the vessel s manœuvre at the associated engine loading unsteady n o x emissions are also calculated by coupling the ship manœuvring and engine simulator to a chemical kinetics solver these resulting emissions account for unsteady manœuvring behaviour and the unsteady response of the engine the results from the steady state emission factor estimates are then compared to the values obtained from the chemical kinetics calculations the time resolution required for a ship manœuvring simulation is far lower than that required to model n o x formation from the engine model approximately by a factor of 10 5 to ensure fast computation times two time resolutions are used one for manœuvring another for engine simulation the engine model is called at each time step of the manœuvring model and run for the duration of the engine model s time step this assumes that the engine loading will not change significantly over the time step of the manœuvring model which is chosen to reflect this 2 1 basis vessel the basis vessel used in this analysis is a single screw inland waterway barge the main particulars of which have been chosen for passage through the rhine main danube canal and can be found in table 1 the vessel is powered by a four stroke lng fuelled diesel cycle engine 2 2 basis manœuvres the manœuvres performed by the basis vessel are part of a standard 35 rudder turning circle and a 20 20 zig zag manœuvre this ensures repeatability of the analysis whilst the turning circle manœuvre is quite severe it is not unrealistic for a ship to undergo a 180 heading change on sections of the rhine main danube canal for example near the town of hinova on the romanian serbian boarder this turning circle manœuvre will also move the operation point further away from the design point when compared to the zig zag manœuvre the zig zag manœuvre is intended to mimic manœuvres more commonly experienced on inland waterways the 35 rudder turning circle manœuvre is represented in fig 1 and the 20 20 zig zag manœuvre is represented in fig 3 the simulation for manœuvres was truncated after 350 s taking into account the induced sway and yaw motions as well as the dynamic response of the propulsion system the resulting change in ship speed can be seen in fig 2 for the turning circle and fig 4 for the 20 20 zig zag manœuvre and shows some effects associated with the confined waters of the canal 2 3 manœuvring simulation a three degree of freedom manœuvring simulator has been developed in the manoeuvring motions of surge sway and yaw and relates the dynamic loading on the propeller to the engine model trodden et al 2016 the approach taken in the development of the simulator used in this study is to solve a series of differential equations in the time domain described in the following subsections 2 3 1 equations of motion it can be shown that the equations of motion in surge sway and yaw with the origin located at the centre of gravity can be written as equation 1 1a m u r v x h x r x p surge 1b m v r u y h y r y p sway 1c i z z r n h n r n p yaw where m is the mass of the ship i z z is the mass moment of inertia around a vertical axis u and v is the ship s velocity in pure surge and sway respectively and r is the ship s rate of change of heading the subscripts h r p in equation 1 denote hull rudder and propeller respectively the methodologies used to estimate these contributions are briefly discussed next 2 3 2 hull the longitudinal force on the ship s hull x h transverse force on the ship s hull y h and the yaw moment on the ship s hull n h can be written as equation 2 2a x h m x u m y x v r v o r x h o u 2b y h m y v m x u r y h o v o r 2c n h j z z r n h o v o r the hull s manœuvring derivatives are obtained from the study of inoue et al 1981 2 3 3 rudder the calculation for the longitudinal force drag x r transverse force y r and turning yawing moment n r imposed upon the ship by the action of the rudder are expressed in the form of equation 3 3a x r 1 t r f n sin δ r 3b y r 1 a h f n cos δ r 3c n r x r a h x h f n cos δ r where f n is the force normal to the rudder t r is a rudder drag correction coefficient a h is a coefficient to account for the interaction between the hull and rudder x h is the x coordinate of the point of application of the lift from the hull with respect to amidships x r is the x coordinate of the centre of pressure of the rudder with respect to amidships δ r is the rudder s angle coefficients a h and x h are affected by water depth and are accounted for as discussed in section 2 3 6 the rudder s normal force is considerably influenced by the nature of the propeller s slip stream that is its wake contraction and velocity the scheme described by lee et al 2003 is used to calculate the effective rudder inflow velocity the electromotive oil pressure steering gear model of son 1989 is used to account for the time lag between the order given for the rudder to be put over and the machinery s response 2 3 4 engine propeller dynamics the main propulsion engine is based on a four stroke diesel cycle burning lng fuel the difference between the resisting torque of the water on the propeller and the output torque from the engine results in the acceleration of the drive chain further details of the engine dynamics can be found in section 2 4 2 3 5 propeller expressions for the thrust and torque coefficients k t and k q respectively on a b screw series propeller are obtained from the methods described in oosterveld and van oossanen 1975 the calculation scheme for the longitudinal force x p transverse force y p and yawing moment n p follows that of equation 4 4a x p 1 t d f ρ n 2 d 4 k t 4b y p 0 4c n p 0 where ρ is water density n is propeller rotational speed and d is propeller diameter the wake fraction at the propeller plane for a ship at zero drift angle w p 0 and thrust deduction factor t d f are calculated from the analysis carried out by holtrop 1984 equation 5 from the work of hirano 1981 is used to estimate the wake fraction at the propeller plane 5 w p w p 0 exp 4 0 β p 2 where the drift angle at the propeller β p is given by equation 6 6 β p arcsin v x p r v v x p is the x coordinate of the propeller with respect to amidships a negative value 0 5 l p p v is the sway velocity and v v is the resultant ship speed in this study the effective wake fraction at zero drift angle w p 0 is assumed to be a function of the thrust identity and hence advance coefficient following the method of holtrop 1984 throughout this analysis the ship is operating within the first quadrant that is an ahead rotational speed and ahead speed of advance a method to correct for the thrust deduction fraction in different quadrants can be found in harvald 1967 for container ships in shallow water the method proposed by delefortrie and vantorre 2007 may be used 2 3 6 considerations for the influence of confined water shallow water may be defined as 1 2 h t 1 5 pianc 1992 where h is water depth and t is draught shallow water significantly affects ship behaviour ittc manoeuvring committee 2002 and is accounted for using the following techniques in this study the hypothesis of schlighting 1940 is used to estimate speed resistance relations in shallow water for sub critical froude numbers with corrections from lakenby 1963 for blockage effects further adaptations from landweber 1939 are used to account for water of finite width the magnitude of the thrust deduction fraction decreases somewhat with decreasing water depth however according to yoshimura 1986 in a practical sense it can assumed to be constant in the current research this is the assumption made however there are formulations that account for variation in water depth for particular ships eg delefortrie and vantorre 2007 the wake factor which increases significantly with decreasing water depth is corrected for shallow water effects following the method of yasukawa 1998 following the work of nordco ltd 1989 the variation of roll added mass and added mass moment of inertia of the propeller with water depth are assumed to be negligible linear manœuvring derivatives are corrected following the method of kijima 1991 non linear manœuvring derivatives are corrected for water depth following methods proposed by hirano 1985 and kijima 1989 added inertia coefficients are corrected for shallow water following the method of li and wu 1990 stern flow separation increases with decreasing water depth and thus decreases the effect of the rudder on the other hand this is somewhat counterbalanced by the increase in propeller race due to shallow water in this study the effect of shallow water on rudder forces has been neglected however hull rudder interaction coefficients are obtained from kijima et al 1990 with corrections for shallow water by yumuro 1985 sinkage due to shallow water has been estimated from tuck and taylor 1970 stern trim from the effects of shallow water is estimated from the work of yoshimura 1986 the width of the rhine danube main canal is used throughout this analysis namely 55 m width the depth of the canal is 4 m however a depth of 5 1 m is used as the limits of coefficients used for sway and yaw added mass break down at a depth draught ratio of less than 1 2 sheng 1981 in fact the canal is trapezoidal in cross section however this is not accounted for in this study whilst the effects of water depth is important on inland waterways this study concentrates on differences in emissions between steady state emission factor approaches and estimates accounting for the transient nature of loading variation thus it is not considered of paramount importance at this stage to reproduce to a very high degree of accuracy the effects of shallow water on manœuvring and indeed to achieve such accuracy would ideally involve model testing vantorre 2003 beyond the scope of the current study however results published by ittc 2002 indicate encouraging results for the esso osaka fig 5 the esso osaka is one of the few full scale ships for which for which shallow water manœuvring analysis exist crane 1979 2 4 numerical engine model rather than reproducing with a high degree of fidelity the dynamics of a particular physical engine the developed model is representative of the diesel cycle and is used as a basis to provide the thermodynamics kinetics and transport solver the necessary input parameters an example indicator diagram output of the simulated cycle is given in fig 6 in the process of estimating n o x formation the numerical model is suitable for a qualitative study of comparing differences in emissions between steady state design point performance and transient behaviour the instantaneous volume within the cylinder is calculated knowing the cylinder dimensions and instantaneous piston speed the corresponding pressure and temperature are estimated using cantera goodwin et al 2017 the solver chosen to analyse the thermodynamics kinetics and transport solutions throughout the simulation essentially cantera evaluates chemical sources and their properties from established reaction mechanisms so as to satisfy the transport processes described by the continuum mechanics and the governing equations for mass momentum and energy conservation the solving of these equations allows the temporal integration of the kinetic system cantera handles this efficiently through the use of dedicated nonlinear differential algebraic equation solvers hindmarsh et al 2005 the reaction mechanism used to model the lng combustion is gri mech 3 0 smith et al 2000 this is a compilation of 325 elementary chemical reactions and associated rate coefficient expressions and thermochemical parameters for the 53 species involved in them the thermochemistry is based upon standard databases such as those from mcbride et al 1993 and kee et al 1990 and contain polynomial fits to specific heats standard state enthalpies and entropies it is a proven mechanism and efficient for simulations to calculate the thermodynamics kinetics and transport properties of the combustion process within cantera the solution class is loaded with the reaction mechanisms the reactor mechanism used for containing and controlling the chemical reactions within the cylinders is a zero dimensional model for ideal gas mixtures inlets are defined as a constant state reservoir accounting for turbocharger temperature and pressure the outlet is a constant state reservoir with ambient temperature pressure and gas composition properties inlet and outlet reservoirs are connected via the valve class whose mass flow rate is a function of the pressure drop across it as in equation 7 7 m k v p 1 p 2 where p 1 and p 2 is the pressure of reservoir and reactor respectively by choosing a suitably large value of k v very small pressure differences will result in flow between the reactor mechanism counteracting any pressure difference the injector is modelled via the massflowcontroller class maintaining a specified mass flow rate independent of upstream and downstream reactor conditions and loaded with appropriate values for p t and fuel composition the piston is modelled from the dynamics of a general crank slider mechanism as a moving wall object separating the reactor cylinder from the reservoirs valves the piston velocity is defined by equation 8 8 v 0 t r c 2 π n c s i n ϕ t where r c is the crank radius half the stroke n c is the rotational velocity of the crankshaft and ϕ is the crank angle the heat flux through the piston wall is computed from 9 q u t inside t outside ε t inside 4 t outside 4 where u is the overall heat transfer coefficient for conduction convection and ε is the emissivity t inside and t outside is the instantaneous temperature inside and outside the cylinder respectively the simulation is begun by setting initial conditions for inlet temperature pressure gas composition and outlet pressure at the appropriate crank angle of the engine cycle using pre set valve timings the relationship between mass flow rate and the pressure drop across the valves are set using a constant of proportionality k g s a relationship this also applies to injection timings where the mass flow rate k g s through the controller is set to a constant value rather than a function of time as this level of fidelity is considered excessive at this stage of development a reactornet class is created containing the cylinder and the advance function is used to simultaneously advance the state of the reactor in time ie solve the governing equations 2 5 prediction of n o x the kinetics class of cantera is used to evaluate the reaction rates and species production rates within the cylinder reactor fig 7 shows gas composition results from the simulation and illustrates how for a particular engine speed engine operating conditions play a crucial role in n o x formation when compared with c o 2 this demonstrates the non linear process of n o x formation throughout the cycle in particular during ignition this phenomenon is not taken into account in the steady state emission factor approaches commonly used to assess n o x emissions 2 6 emission factor development and usage a popular way of estimating emissions is from the use of emission factors most of which are directly related to fuel consumption such as those specified in the imo s third greenhouse gas study mepc 2014 for the marine industry most of these emission factors are based upon generic diesel engines burning medium or heavy fuel oil in order to illustrate the difference in magnitude of n o x emissions from steady state and transient operation an emission factor is developed in this study using the developed simulator the resulting emission factor is solely based upon the fuel oil consumption of the engine running at the designed operating conditions the emissions estimates which are generated from the use of emission factors are calculated by multiplying the emission factor by the fuel consumption for the particular time step during the simulation a reason for calculating an emission factor from the simulation rather than using one from the literature is that it is then possible to compare the performance of the same numerical engine model which exhibits identical characteristics over a wide range of loading conditions without an extremely elaborate engine model it would be challenging to reproduce an exact model which describes the unsteady response of an existing physical engine which is suitable for unsteady n o x evaluation at this stage of the investigation in which an estimate of the differences in emissions between commonly used steady state emission factor approaches and unsteady transient analysis such an engine model is deemed unnecessary 2 7 engine model validation it is challenging to obtain information about the n o x emissions from an lng fuelled engine in transient operation that relate in sufficient detail the rate of change of loading and the subsequent effect on emission formation in order to obtain some degree of confidence in the developed numerical model a test engine is implemented to determine its correlation with established emission factor results work conducted by stenersen and thonstad 2017 compared on board measurements of n o x emissions from ships and found the average n o x emissions for lng fuelled 4 stroke compression ignition engines to be 10 1 g k g fuel or 1 8 g k w h based upon 39 measurements as part of their study a wärtsilä 20df four stroke engine was used in their analysis of emissions it is the main dimensions of this engine that is used as a validation test engine in the current study the main particulars of the engine are listed in table 2 with some manipulation of parameters such as valve timings and inlet temperature and pressures the numerical model with the main dimensions of the wärtsilä 20df was able to produce an output of 152 k w c y l at a mean effective pressure of 24 b a r the corresponding n o x emissions were 8 61 g k g this value is considered accurate enough to be useful especially considering the spread in results from stenersen and thonstad 2017 the authors stress that the results from this analysis may not be indicative of this actual engine s emissions as there are numerous factors such as piston geometry that are not accounted for in this analysis which do have an effect on emission production 3 results and discussion of ship manœuvring operation on exhaust gas emissions for the simulations of the confined water turning circle and zig zag manœuvres outlined in section 2 2 figs 8 and 9 show a graphical representation of how the percentage differences between the unsteady chemical kinetics based estimates and the steady state emission factor based approach vary with time figs 10 and 11 show results for maximum and mean percentage differences for n o x and c o 2 emissions for the confined water turning circle and zig zag manœuvres respectively as described in section 2 2 as expected the c o 2 discrepancy between the two methods is low indicating that c o 2 can be adequately modelled based upon stoichiometric combustion referring to figs 10 and 11 as an example the value of n o 2 formation calculated using the method illustrated in this research for the transient operation is nearly four times that of the steady state estimate the interrelated properties of the combustion process and transient engine loading from ship manœuvres indicates that a time domain simulation lends itself especially well to prediction of n o x emissions when used in conjunction with a chemical kinetics solver this method can provide increased realism and accuracy in the prediction of exhaust gas emissions compared to commonly used steady state operation independent emission factor approaches whose only dependency is fuel consumption an emission factor based upon speed and power could potentially be developed using the proposed method this emission factor can subsequently be utilised in fast efficient simulations in a manner suitable for multiple runs for example in scenarios for conducting emission compliance over different speeds or routes this can be used to bring awareness to operators regarding n o x production when used on bridge simulators akin to a speed over ground indicator the magnitude in the difference of n o x formation between steady state estimates and analysis of transient operation suggests that it would be prudent for future regulations to account for transient operation especially in areas where a significant amount of manœuvring occurs when comparing the differences between the commonly used emission factor approach and the transient analysis for the turning circle and zig zag manœuvres it can be seen that the magnitude of n 2 o is markedly different this indicates that n 2 o is more susceptible to transient operation compared to n o and n o 2 and reflects the generally higher residence time associated with the turning circle manœuvre to proceed along these lines of analysis it is suggested that the development of the engine model is refined to reflect a higher degree of fidelity the current engine model serves to illustrate the magnitude in differences of n o x formation between steady state and transient operation 4 conclusions n o x production is predominantly a function of engine speed or residence time and loading a time domain based manœuvring simulator coupled with an engine model and chemical kinetics solver offers a well suited solution for estimation of n o x formation a manœuvring simulator is used to produce the unsteady loading on the propeller and engine it is demonstrated that due to the attitude of a ship travelling through the water differences in predicted required power arise compared to that of the steady state dead ahead calm water estimate it is the latter case that is often used when predicting exhaust gas emission estimates it is shown that manœuvring motion has a significant effect on n o x formation estimates which are substantially different to the common practice based on the steady state design point during a simulation in confined water to manœuvre the basis vessel over a turning circle described in section 2 2 the mean difference between steady state and transient estimates for n o n o 2 and n 2 o are 76 5 195 1 74 4 respectively during the zig zag manœuvre the mean differences n o n o 2 and n 2 o are 55 7 191 5 10 0 respectively caution should therefore be employed if using steady state emission factors when estimating n o x emissions especially in areas where manœuvring occurs frequently the difference in c o 2 formation is found to be 3 6 and 0 69 for the confined water turning circle and zig zag manœuvres respectively indicating that stoichiometric combustion based approaches are able to adequately predict c o 2 formation it is shown that n 2 o is more susceptible to transient loading compared with n o and n o 2 the presented methodology allows scenarios to be conducted highlighting areas of a shipping route that are in danger of exceeding permitted limits or providing solutions for operating strategies to comply with emission regulations 
23636,time domain rankine source method incorporated with hobem is developed and applied to solve motion of ship advancing with steady forward speed in waves steady ship wave sw potential is solved beforehand and is applied in both boundary conditions of free surface and ship hull for solving time domain ship motion m j terms in body boundary condition are computed with ship wave potential time domain free surface conditions of radiation and diffraction problems are derived by use of ship wave potential since steady incoming flow has significant influences on ship motions the two simplified steady flow models of uniform stream us and double body flow db are also applied in time domain simulations for the comparative studies in addition nonlinear froude krylov and restoring forces are used in ship motions equation a numerical program is originally coded by fortran and is used to solve motions of four types of hulls which are series60 ship wigley 1 s 175 container ship and a full formed tanker at various speeds the results of added mass damping coefficients wave exciting forces and ship motions are in generally good agreement with related model tests data it shows that both hydrodynamic coefficients and ship motions obtained by sw and db are apparently more accurate than by us the accuracy of motions is improved for ships with complex and full formed hulls by the present method which takes sw as steady flow numerical results of ship motions are affected by both the different free surface conditions due to different steady flow models and m j terms while added mass and damping coefficients are mainly influenced by m j terms more physical phenomenon are detailedly investigated and discussed keywords time domain ship motion in waves forward speed steady ship wave weakly nonlinear higher order boundary element method nomenclature a i j h i j influence coefficients a 0 i j b 0 i j c 0 i j local added mass damping and restoring coefficients c w wave drag coefficient c i j restoring coefficient f f k f l f m f r force vectors subscripts denote froude krylov force time local memory and restoring components respectively f n froude number i n d p k global index of k th node in p th panel j ξ η jacobi matrix k wave number k yy radius of inertia for pitch l ship length m mass matrix n b n f number of nodes on body and on free surface n k ξ η bi quadratic shape function n j m j normal vector and m term in j th mode p hydrodynamic pressure s b s b instantaneous and mean wetted body surface s f free surface u sail speed ξ ship motion vector ψ 1 j ψ 2 j canonical potentials ζ a λ β incident wave amplitude wave length wave angle ω ω e circular frequency encounter frequency ϕ ζ total velocity potential and wave elevation ϕ i ζ i incident wave potential and wave elevation ϕ d ζ d disturbance potential and wave elevation of unsteady flow φ steady flow potential ζ s steady wave elevation δ i j kronerker delta function α i solid angle 1 introduction seakeeping analysis is significant in ship design prediction results of ship motions and hydrodynamic pressure are vital for hull form design optimization and for structural strength checking potential flow method for zero speed seakeeping computation has been developed a lot since hess and smith 1967 came up with panel method until now a variety of commercial software such as wamit hydrod aqwa and etc have been developed to solve wave body interactions without forward speed when it comes to the situation of forward speed case numerical computation will be more complicated great efforts have been paid by researches in developing corresponding numerical methods among those strip theory was proposed in early stage ogilvie and tuck 1969 the theory has merit of high efficiency while its applicability is limited by the low speed and high frequency assumption as well as slender hull restriction therefore the more advanced three dimensional method has been gradually developed with the development of computing hardware 3d potential flow theory is usually classified into free surface green s function method and rankine source method with free surface green s function method the green s function which satisfies neumann kelvin uniform stream linearized free surface condition and radiation condition is used as the solution of laplace s equation so singularities are only required to be distributed on ship hull zero speed pulsating source green s function with speed correction is first applied to analyze seakeeping problem with forward speed while this approach is only applicable in cases of low froude numbers to overcome the limitation scholars including kim and shin 2007 hong et al 2016 used translating and pulsating source green s function in place of zero speed pulsating source green s function and more accurate results were obtained however peak values of motions response amplitude operators rao are usually overestimated with respect to time domain analysis bingham 1994 zhu 2009 sengupta et al 2016 studied on transient green s function method and applied the method to compute hydrodynamic coefficients forces and motions of ship numerical results in relatively high froude numbers are also not quite satisfactory it indicates forward speed effects are significant for unsteady seakeeping computation nuemann kelvin linearized free surface condition adopted in the derivation of green s function restricts steady incoming flow to be uniform stream thus in order to concern influences of steady flow on unsteady flow more precisely researchers imposed complex m j term in body boundary condition to replace simplified ones numerical results of added mass damping coefficients and motions are obviously improved to solve m j term many researches like nakos 1990 kring 1994 kim and shin 2007 song et al 2011 kim et al 2011 and etc used double body flow potential kim and shin 2007 in further employed more reliable steady ship wave potential to compute m j term numerical evaluation of free surface green s function is difficult and time consuming green s function oscillates severely near free surface chen and wu 2001 for ship with large flare integral of green s function on panel would be singular near free surface rankine source method can avoid these obstacles as elementary solution 1 r of laplace equation is used as green s function this method can also be applied to any form of free surface condition for problem with forward speed the method will not be restricted with neumann kelvin linearized free surface condition based on rankine source method nakos 1990 kring 1994 kim and kim 2010 zhang et al 2010 song et al 2011 and so many other researchers applied double body linearized free surface condition to compute ship motions in waves of both frequency domain and time domain generally the predicted results would agree well with experiments liu and papanikolaou 2011 solved ship motions with forward speed in earth fixed coordinate to avoid computing spatial differential of velocity potential and m j terms while the moving mesh should be used in their method and consequently computational cost would increase a lot huang 1997 kim et al 2011 developed a nonlinear method according to weak scatter assumption and double body flow is also employed as steady flow in the theory body boundary condition is satisfied on instantaneous wetted hull under incident wave surface so m j terms are avoided while computation time increases a lot as coefficient matrix of boundary integral equation should be reassembled and solved at each time step although double body flow linearized method has been successfully used in computation of ship seakeeping for a long time double body flow is actually an approximation of steady flow as froude number approaches to zero so the method is just applicable for slow ships in this paper three dimensional time domain rankine source method is applied to compute ship seakeeping with forward speed ship wave is evaluated and is taken as steady flow in hydrodynamic calculation accordingly free surface condition of time domain radiation and diffraction problems is derived by taking into consideration of ship wave potential and m j term in body boundary condition is also computed with ship wave potential further comparative studies are conducted by applying the two conventional steady flow models of uniform stream us and double body flow db in time domain simulations for that steady incoming flow has significant influences on unsteady ship motion high order boundary element method hobem based on bi quadratic isoparametric elements is employed to discretize the boundary integral equation by applying the high order panel second order derivatives of velocity potential and m j term shall be solved directly in addition nonlinear froude krylov and restoring forces which are computed with exact wetted ship hull are used in ship motion equations considering body nonlinearity instantaneous wetted hull mesh is obtained by b spline interpolation at each time step a fortran program is originally developed for validation study computations of wave ship interactions are carried out for series60 ship wigley 1 s 175 container ship and a tanker over a wide range of frequencies and speeds present numerical results of added mass damping coefficients wave exciting forces and ship motions are in good agreements with experimental data the respective effects of m j term and different types of free surface conditions due to the steady flow models on hydrodynamic coefficients and ship motions are detailedly investigated in this work 2 mathematical formulation 2 1 governing equations and boundary conditions of the global boundary value problem considering a ship advancing in regular wave with constant speed u an inertial coordinate system o xyz translating with ship is defined as shown in fig 1 the xoy plane is fixed on calm water with x axis directing to bow and y axis pointing portside origin point o locates on midship and z axis points upwards assuming the fluid is invicid and incompressible and the flow is irrotational velocity potential can be introduced and it satisfies laplace equation 1 2 ϕ 0 global velocity potential ϕ shall satisfy both the kinematic and dynamic free surface conditions on z ζ x y t 2 t u ϕ z ζ x y t 0 kinematic t u ϕ ϕ 1 2 ϕ ϕ g ζ dynamic in addition the following body boundary condition should be imposed on instantaneous wetted body surface to ensure that fluid particles cannot penetrate ship hull 3 ϕ n u n 1 δ t n where δ is generalized unsteady ship motion vector δ ξ t ξ r x ξ t and ξ r are translational and rotational ship motions normal vector n is 4 n 1 n 2 n 3 n n 4 n 5 n 6 x n total velocity potential ϕ contains steady and time varying parts the latter term can further be decomposed into incident wave potential and unsteady disturbance potential which includes both radiation and diffraction components 5 ϕ x y z t φ x y z ϕ i x y z t ϕ d x y z t where regular incident wave potential is 6 ϕ i g ζ a ω e k z sin k x u t cos β k y sin β ω t accordingly total wave elevation also has the following decomposition form 7 ζ x y z t ζ s x y z ζ i x y z t ζ d x y z t detailed mathematical formulations of boundary value problems for each flow components are shown in the following sections 2 2 boundary conditions of steady ship wave problem fig 2 shows steady ship wave flow around a ship which satisfies the following free surface conditions 8 u φ x ζ s x φ y ζ s y φ z 0 kinematic u φ x g ζ s 1 2 φ φ 0 dynamic where subscripts x y z denote spatial derivatives the free surface condition is nonlinear equations about velocity potential and wave elevation and in this study a linearized form as the following is actually used 9 φ x x g u 2 φ z 0 ship wave problem is solved by source distribution method and detailed description can be found in reference of chen et al 2016 two simplified steady flow models uniform stream and double body flow are usually adopted in previous research as illustrated in fig 3 uniform stream is on assumption that there is no disturbances on steady flow by contrast double body flow can reflect the disturbance effect but it restricts the free surface to be rigid corresponding boundary conditions of the two steady flow models are expressed as equation 10 without loss of generality together with steady ship wave φ is named as steady flow potential 10 uniform stream φ 0 in fluid domain double body flow φ n u n 1 on s b φ n 0 on s f 2 3 boundary conditions of unsteady disturbance potential in view of numerical stability unsteady disturbance potential ϕ d is further decomposed into time local and memory potentials which follows the strategy of kring 1994 11 ϕ d x y z t ϕ l x y z t ϕ m x y z t the local flow potential ϕ l represents the instantaneous fluid response it is used to take out the impulsive part of the problem which would bring instability in solving motion equations after further mathematical derivations as shown in the next section hydrodynamic force associated with local flow can be expressed by proportion of ship displacement velocity and acceleration without solving by numerical differential consequently stability and accuracy would be improved the memory potential ϕ m denotes the wave flow which is the remaining part of total unsteady disturbance potential local flow potential is solution of pressure release problem which follows the boundary conditions below 12 ϕ l n j 1 6 ξ j n j ξ j m j s b ϕ l 0 s f the above body boundary condition is derived by perturbation expansion liu and miao 1986 on exact body boundary condition 3 and is satisfied on mean body position as a result an extra term the so called m j term is appear the term implies interactions of steady flow on unsteady flow in body boundary condition and is defined by 13 m 1 m 2 m 3 n u φ m 4 m 3 y m 2 z φ y n 3 φ z n 2 m 5 m 1 z m 3 x φ z n 1 φ x u n 3 m 6 m 2 x m 1 y φ x u n 2 φ y n 1 memory potential satisfies the remaining boundary conditions body boundary condition of memory potential is 14 ϕ m n ϕ i n on s b by applying taylor s expansion on equation 2 and neglecting higher order small quantities linearized free surface condition of memory potential is derived 15 t u φ ζ m ϕ l ϕ m φ z 2 φ z 2 ζ m kinematic φ ζ i u φ ζ s t u φ ϕ m g ζ m ζ s φ ϕ i dynamic u φ 1 2 φ φ where terms related to steady flow implying steady flow effects on unsteady flow are observed in the time domain free surface condition it is seen that the equation contains term ϕ l z which represents unsteady forcing due to body condition are transferred to the free surface condition of memory flow moreover an artificial damping term should be added in the kinematic free surface condition in order to satisfy the radiation condition the damping term is defined as 2 υ ζ υ 2 g ϕ where υ is cooling strength by considering different steady flow models the above boundary value problems of time domain radiation and diffraction can be recognized as ship wave double body flow and uniform stream linearization respectively 2 4 unsteady hydrodynamic force and equations of ship motion applying newton s second law equation of ship motions can be derived 16 m ξ f f k f l f m f r where the hydro forces are 17 f l m i s b p l m n i d s f f k i s b p i n i d s nonlinear s b p i n i d s linear f r i s b s b ρ g z n i d s nonlinear j 1 6 c i j ξ j linear nonlinear froude krylov force and restoring force are included in ship motions equation in weakly nonlinear calculation to compute nonlinear f f k and f r ship instantaneous wetted hull under incident wave surface is required at each time step exact ship mesh are obtained by cubic b spline interpolation hydrodynamic pressures in equation 17 is computed by bernoulli s equation 18 p l m i ρ t u φ ϕ l m i where ϕ i t has analytical solution ϕ m t is solved by the forth order backward differential scheme with respect to ϕ l t it is reported by kring 1994 and shao 2010 that this term would bring instability to numerical calculation fortunately there is an indirect way to evaluate f l without solving ϕ l t making a modal decomposition of time local flow potential arrives at 19 ϕ l j 1 6 ψ 1 j ξ j ψ 2 j ξ j where ψ 1 and ψ 2 follow the boundary conditions 20 ψ 1 j n n j ψ 2 j n m j o n s b ψ 1 j ψ 2 j 0 o n s f substituting equation 18 into equation 17 and replacing ϕ l with equation 19 time local force can be expressed by 21 f l i j 1 6 a 0 i j ξ j b 0 i j ξ j c 0 i j ξ j where 22 a 0 i j ρ s b ψ 1 j n i d s b 0 i j ρ s b ψ 2 j u φ ψ 1 j n i d s c 0 i j ρ s b u φ ψ 2 j n i d s it can be found that ϕ l t vanishes in the expression of f l substituting equation 21 into ship motions equation 16 and moving f l to the left hand side of the equation ship motions equation can then be written as the following expression 23 m a 0 ξ b 0 ξ c 0 ξ f f k i f m i f r i the forth order adams method is used to solve the above differential equation 3 numerical implementation 3 1 boundary integral equation and hobem applying green s second identity yields the following boundary integral equation bie which is used to compute memory potential ϕ m and canonical potentials ψ 1 and ψ 2 24 α i ϕ i s ϕ n g r i r d s s ϕ g r i r n d s where g is rankine source green s function i represents field point ϕ stands for ϕ m ψ 1 j ψ 2 j the bi quadratic shape function based hobem is applied to discretize the bie fig 4 displays 9 nodes panel in physical and parametric space values of variable in panel can be expressed as a linear combination of product of nodal value and shape function 25 θ k 1 9 θ k n k ξ η where variable θ represents location vector velocity potential or normal velocity ξ and η are parametric variables range from 1 to 1 k is nodal number in panel shape function is found in reference chen et al 2016 substituting equation 25 into equation 24 yields the discrete form of bie 26 i 1 n b h i j ϕ j i n b 1 n b n f a i j ϕ n j i n b 1 n b n f h i j ϕ j i 1 n b a i j ϕ n j note that ϕ n on body and ϕ on free surface are known quantities obtained by hull boundary conditions and free surface conditions as shown in equation 14 15 20 to solve the bie one can either use lu factorization or iterative methods like gmres for linear problem with fixed boundaries the lu factorization is more efficient and is adopted in this study influence coefficients in bie are computed by following equations 27 a i j p 1 n p b n p f k 1 9 δ i n d p k j 1 1 1 1 g r i r n k ξ η j ξ η d ξ d η h i j p 1 n p b n p f k 1 9 δ i n d p k j 1 1 1 1 g r i r n n k ξ η j ξ η d ξ d η δ i j α i note that solid angles in the above equations are not constant over panels when using hobem and they are evaluated directly at each node by formulas in reference of shao 2010 3 2 solving for mj term difficulty for evaluating m j term lies in solving second order derivatives of steady flow potential some researchers used alternative methods such as employing stokes theorem in which numerical computation of second order derivatives can be avoided zhao and faltinsen 1989 nakos 1990 song et al 2011 however the theorem is on rigid free surface assumption and hull form is required to be wall sided at waterline so it is not suitable for ship with large flare and is inconformity with steady ship wave used in this paper consequently a direct method for solving m j term based on high order panel is utilized by using bi quadratic shape function first and second order spatial derivatives of velocity potential can be calculated directly according to chain rule first order derivatives are 28 ϕ x ϕ y ϕ z x ξ y ξ z ξ x η y η z η n 1 n 2 n 3 1 ϕ ξ ϕ η ϕ n where subscripts ξ and η represent tangential derivatives in parametric plane they can be computed with 29 θ ξ η k 1 9 θ k n k ξ η ξ η substituting θ in equation 29 with ϕ x ϕ y and ϕ z tangential derivatives of flow velocity along ξ and η are then computed again using chain rule and considering laplace equation arrives at the following expression shao 2010 30 ϕ x ξ ϕ x η ϕ y ξ ϕ y η ϕ z ξ ϕ z η x ξ y ξ z ξ 0 0 x η y η z η 0 0 0 x ξ 0 y ξ z ξ 0 x η 0 y η z η z ξ 0 x ξ z ξ y ξ z η 0 x η z η y η ϕ x x ϕ x y ϕ x z ϕ y y ϕ y z applying least square method to solve the above overdetermined set unique solution of second order spatial derivatives of velocity potential are obtained then m j term shall be computed with equation 13 for verification the numerical method is applied to compute second order derivatives of velocity potential and m j term for the problem of flow around a sphere in infinite fluid domain fig 5 shows second order derivatives and m j term obtained by the present computation in comparison to analytical solutions and they are in excellent accordance 3 3 time marching of free surface and numerical filter the fourth order adams bashforth moulton method is applied for time marching of free surface condition as shown in equation 15 at each time step wave elevation ζ m is computed at first by kinematic condition then a corrector is employed to evaluate ϕ m by dynamic condition through an iterative process until convergence for problem with forward speed saw tooth waves on free surface would appear during time domain simulation therefore a low pass numerical filter must be introduced to overcome the numerical instability in this paper the seven point scheme of filter is implemented to smooth the free surface wave the filter is applied on ζ m in both x and y directions 31 ζ j w j ζ j w j 1 ζ j 1 w j 2 ζ j 2 w j 3 ζ j 3 where values of weight function w can be found in reference of huang 1997 3 4 automatic generation of instantaneous wetted ship hull as mentioned in section 2 4 weakly nonlinear computations need pressure integrations on wetted ship hull under wavy free surface to automatically generate instantaneous hull mesh at each time step the third order b spline interpolation is employed b spline interpolation formula is expressed as the following 32 x u i 0 n n i p u p i detailed expression of base functions n i p u and description of method to compute control points p i can be found in many books of numerical computational methods in the present computation ship hull is divided into bulbous bow main hull and stern and interpolations are applied respectively on each region as shown in fig 6 a fortran program is developed based on the approach figs 7 and 8 show test results of generated exact wetted ship hull of s 175 and a tanker at some moment 4 numerical results and discussions for verification study a fortran code is developed four types of ships are used in numerical analysis and their principle dimensions are listed in table 1 rectangle type of free surface is employed in computation and panel arrangement of computational boundaries are shown in fig 9 in view of starboard and portside symmetry only half of computational domain is used in numerical calculation for steady ship wave computation free surface is extended to 2 0l downstream 0 8l upstream and 1 5l in width while in unsteady seakeeping computation free surface range varies with incident wavelength λ the criterion in this case is that free surface extension downstream upstream and in width are 3 0λ 1 2λ and 1 5λ respectively when wavelength is larger than ship length the range of free surface becomes 3 0l 1 2l and 1 5l downstream upstream and in width to avoid too large of free surface extension in long wavelength cases it should be noted that free surface mesh density in ship wave computation is higher than unsteady ship motion computation a cubic spline interpolation is conducted after ship wave is solved to obtain values of steady flow velocity potentials and their derivatives on free surface grid of seakeeping computation to improve free surface mesh property in the vicinity of ship a stretch function that shall control mesh scale is imposed on free surface take one dimensional grid as shown in fig 10 for example stretch function is defined by equation 33 ξ i ξ e f a c i 1 n 1 1 e f a c 1 where fac 1 is a constant factor to control the stretch scale number of nodes distributed on half of computational domain boundary for case studies are listed in table 2 4 1 steady ship wave computation before solving time domain ship motions a brief validation study for steady ship wave is carried out to show that the present numerical model is reliable series 60 hull cb 0 6 is taken as numerical example computed results including wave pattern wave profiles and wave drags at various froude numbers are presented in figs 11 13 wave drag is computed by the following formula 34 c w s b p s n 1 d s 0 5 ρ u 2 s b where the steady ship wave pressure p s is computed by bernoulli s equation 35 p s ρ u φ x 1 2 φ φ where ϕ denotes ship wave potential free surface elevation is computed by the dynamic free surface condition as shown below 36 ζ s 1 g u φ x 1 2 φ φ the exp data in these figures is obtained from experiments conducted by institutes of soul national university snu akishima laboratories al1 3 university of tokyo ut1 4 it is seen from these figures that the present method has good accuracy in solving steady ship wave 4 2 hydrodynamic coefficients and motions of wigley 1 hull form of the wigley 1 is defined by formula in the reference journée 1992 incident wave amplitude in calculation is set as 0 018 m 4 2 1 comparison of steady flow results of different models figs 14 and 15 show contours of m 3 and m 5 term of wigley 1 hull evaluated by steady ship wave double body flow and uniform stream potentials at fn 0 3 in comparison m j terms of ship wave are in consistence with double body flow except slight deviations at bow and stern area while results of uniform stream are very different figs 16 and 17 display the disturbance potential φ of steady flow on z 0 at fn 0 3 and 0 4 contours of ship wave potential conforms to the realistic physical phenomenon interestingly patterns of double body potential are in accordance with ship wave potential in area near ship this may explain why m j term computed by the two models are comparable to each other however as speed goes higher for instance at fn 0 4 differences in magnitudes of velocity potential will become larger due to the rigid free surface assumption of double body flow 4 2 2 wave radiation and diffraction results non dimensional vertical wave exciting forces and moments are computed and results are plotted in figs 18 and 19 the amplitude frequency curves are obtained by fourier series expansion on time history results fourier series expansion is defined by 37 f t f 0 2 n 1 n f n cos n ω e t ε n where 38 a n 2 t 0 t f t cos n ω e t d t b n 2 t 0 t f t sin n ω e t d t and 39 f n a n 2 b n 2 ε n arctan b n a n in these figures labels nonlin f k and lin f k mean that nonlinear and linear froude krylov forces and restoring forces are considered in the computation the accordance of numerical results by different methods shows that different steady flow models would not have evident influence on wave exciting forces this is due to the irrelevance of m j term with wave diffraction and dominance of froude krylov forces in wave exciting force numerical and experimental results of added mass and damping coefficients of wigley 1 are shown in figs 20 22 results computed by three dimensional translating and pulsating 3dtp source green s function method are also presented for comparison code of 3dtp method is provide by dr hong and mathematical and numerical formulations of the method are in reference hong et al 2016 it is observed from figures that added mass and damping coefficients of present computation by considering steady ship wave are obviously in better agreement with model test data than results of uniform stream linearization and 3dtp method large deviations are found especially in low frequency region since the proportion of steady components in boundary conditions becomes relative larger slight difference between results of ship wave and double body flow linearization are found only in cases of high speeds such as fn 0 4 to investigate the separated contribution of m j terms and different free surface conditions due to steady flow models to hydrodynamic coefficients computations by applying m j terms computed with ship wave potential and uniform stream linearized unsteady free surface usl fs conditions are carried out the corresponding results are marked as ship wave usl fs comparative analysis shows m j terms have dominant effects on both added mass and damping coefficients different free surface condition have only slight influences on coupling terms of damping coefficients 4 2 3 ship motions in head waves numerical results of heave and pitch motions rao of wigley 1 moving at fn 0 3 and 0 4 in head waves comparing with experiments are shown in figs 23 and 24 as seen from figures methods by considering steady flow models of ship wave and double body flow can provide more accurate results than uniform stream linearized method which yields much higher peak values in comparison to model tests data evident distinctions between ship wave and double body flow linearization are observed in pitch motion at fn 0 4 and results of ship wave linearization are in slightly better agreement with experiments if only the complex m j terms are considered in computation and free surface condition remains to be uniform stream linearized form the legend ship wave usl fs crest of computed heave and pitch motions would become higher in addition since wigley 1 hull is thin and wall sided near free surface numerical results of nonlinear and linear computations show little difference 4 3 motions of s 175 in head waves body plan of s 175 ship is plotted in fig 25 in computation incident wave amplitude is set as 1 5 percent of ship length time histories of non dimensional heave and pitch motions of s 175 at fn 0 275 and λ l 1 2 are shown in fig 26 it is seen that the curves are very smooth which demonstrates the numerical program has good numerical stability figs 27 and 28 are comparisons of amplitudes and phase angles of s 175 heave and pitch rao at fn 0 275 in the present computation and experimental data ittc 1978 it is obvious that uniform stream linearization gives the worst predictions of motion amplitudes motions computed by ship wave linearized method are in generally better agreement with measured data than other methods since the generated steady waves are significant for s 175 with complex forms and uniform stream and double body flow are in fact assumptions of non and small disturbance of ships on steady incoming flow moreover due to its large flare influences of nonlinear froude krylov forces and restoring forces on motions of s 175 are more apparent than wigley 1 weakly nonlinear results of motions show better agreement with experimental data than results by linear computation the computed phase angles of motions rao are also in excellent accordance with experimental results 4 4 motions of 50 500 tanker in head waves the last case considers a more full formed hull of which the block coefficient is cb 0 76 the ship named as 50 500 tanker is a tanker designed by shanghai ship shipping research institute the body plan and 3d geometry model is shown in figs 29 and 30 ship speeds are 12 8kn and 14 8kn in the numerical analysis wave amplitude is 1 0 percent of ship length which is consistent with experimental condition figs 32 35 depict the computed and measured heave and pitch motions rao present results obtained by ship wave linearized method are more accurate than double body flow linearized and 3dtp method in comparison to experimental data comparing the results computed with different free surface conditions ship wave and uniform stream linearized and the same body boundary condition containing ship wave m j terms labeled as ship wave lin f k and ship wave lin f k usl fs respectively it is found that steady flow effects contributed from both m j terms and different free surface conditions are evident on ship motions in this case ship speeds of 12 8kn and 14 8kn are relatively slow and in conventional view the double body flow linearized method which is recognized as slow ship theory is applicable but the computed motions by double body linearized method are not satisfactory this is because double body flow only represents a kind of local flow containing no waves and is an approximation of the actual steady ship wave fig 31 also manifests that steady disturbance potentials on z 0 of ship wave and double body flow are quite different for the full formed ship even at low speed while fortunately in seakeeping analysis only components of unsteady potential and the according linearized boundary conditions about the steady flow are concerned therefore as double body flow shall to some extent represent disturbance of hull on uniform stream the according linearized method may have good accuracy in most cases however as speed goes high or hull form becomes full and complex numerical method by considering effects of steady ship wave would provide better results comparisons of unsteady free surface elevations obtained by different methods are also carried out and wave contours are plotted in fig 36 results of ship wave and double body flow linearized method look similar and they have differences with the result of uniform stream linearized computation in the vicinity of ship 5 concluding remarks in the present paper a weakly nonlinear time domain rankine source method with high order boundary element discretization is proposed to compute motions of ship advancing with steady forward speed in waves in this study steady ship wave is evaluated and taken account into time domain simulations a fortran program is developed and is applied to compute ship motions hydrodynamic coefficients and forces of wigley 1 hull s 175 container ship and 50 500 tanker at different speeds and wave frequencies by numerical analysis the following conclusions can be drawn 1 the computed motions hydrodynamic coefficients and wave exciting forces of different hulls over a wide range of frequencies are in quite good agreement with related experimental data it indicates the present method has good accuracy and extensive applicability 2 different steady flow models have significant influences on added mass damping coefficients and motions in case with forward speed whereas the effects on wave exciting forces are negligible hydrodynamic coefficients and unsteady motions computed by considering ship wave and double body flow are comparable for ships with simple types of hulls and both of them are obviously more accurate than results of uniform stream linearization ship motions computed by double body flow linearized method are satisfactory in most cases however for ships with full and complex hulls taking actual ship wave into account can improve results of ship motions as the generated steady waves become more significant 3 both the different free surface conditions due to steady flow models and m j terms have apparent effects on the numerical results of ship motions while added mass and damping coefficients are mainly affected by m j terms 4 it can improve accuracy of numerical results of motions for ships with large flare like s 175 and in conditions of medium and high froude numbers by considering nonlinear froude krylov and restoring forces 5 the present work has potential to be extended to fully nonlinear computations of wave ship interactions and can be applied to other ship seakeeping problems like prediction of added wave resistance these would be our further study in the future acknowledgement this work has been jointly supported by national natural science foundation of china nsfc grant no 51479117 51579147 and national key basic research program of china 973 program grant no 2014cb046203 
23636,time domain rankine source method incorporated with hobem is developed and applied to solve motion of ship advancing with steady forward speed in waves steady ship wave sw potential is solved beforehand and is applied in both boundary conditions of free surface and ship hull for solving time domain ship motion m j terms in body boundary condition are computed with ship wave potential time domain free surface conditions of radiation and diffraction problems are derived by use of ship wave potential since steady incoming flow has significant influences on ship motions the two simplified steady flow models of uniform stream us and double body flow db are also applied in time domain simulations for the comparative studies in addition nonlinear froude krylov and restoring forces are used in ship motions equation a numerical program is originally coded by fortran and is used to solve motions of four types of hulls which are series60 ship wigley 1 s 175 container ship and a full formed tanker at various speeds the results of added mass damping coefficients wave exciting forces and ship motions are in generally good agreement with related model tests data it shows that both hydrodynamic coefficients and ship motions obtained by sw and db are apparently more accurate than by us the accuracy of motions is improved for ships with complex and full formed hulls by the present method which takes sw as steady flow numerical results of ship motions are affected by both the different free surface conditions due to different steady flow models and m j terms while added mass and damping coefficients are mainly influenced by m j terms more physical phenomenon are detailedly investigated and discussed keywords time domain ship motion in waves forward speed steady ship wave weakly nonlinear higher order boundary element method nomenclature a i j h i j influence coefficients a 0 i j b 0 i j c 0 i j local added mass damping and restoring coefficients c w wave drag coefficient c i j restoring coefficient f f k f l f m f r force vectors subscripts denote froude krylov force time local memory and restoring components respectively f n froude number i n d p k global index of k th node in p th panel j ξ η jacobi matrix k wave number k yy radius of inertia for pitch l ship length m mass matrix n b n f number of nodes on body and on free surface n k ξ η bi quadratic shape function n j m j normal vector and m term in j th mode p hydrodynamic pressure s b s b instantaneous and mean wetted body surface s f free surface u sail speed ξ ship motion vector ψ 1 j ψ 2 j canonical potentials ζ a λ β incident wave amplitude wave length wave angle ω ω e circular frequency encounter frequency ϕ ζ total velocity potential and wave elevation ϕ i ζ i incident wave potential and wave elevation ϕ d ζ d disturbance potential and wave elevation of unsteady flow φ steady flow potential ζ s steady wave elevation δ i j kronerker delta function α i solid angle 1 introduction seakeeping analysis is significant in ship design prediction results of ship motions and hydrodynamic pressure are vital for hull form design optimization and for structural strength checking potential flow method for zero speed seakeeping computation has been developed a lot since hess and smith 1967 came up with panel method until now a variety of commercial software such as wamit hydrod aqwa and etc have been developed to solve wave body interactions without forward speed when it comes to the situation of forward speed case numerical computation will be more complicated great efforts have been paid by researches in developing corresponding numerical methods among those strip theory was proposed in early stage ogilvie and tuck 1969 the theory has merit of high efficiency while its applicability is limited by the low speed and high frequency assumption as well as slender hull restriction therefore the more advanced three dimensional method has been gradually developed with the development of computing hardware 3d potential flow theory is usually classified into free surface green s function method and rankine source method with free surface green s function method the green s function which satisfies neumann kelvin uniform stream linearized free surface condition and radiation condition is used as the solution of laplace s equation so singularities are only required to be distributed on ship hull zero speed pulsating source green s function with speed correction is first applied to analyze seakeeping problem with forward speed while this approach is only applicable in cases of low froude numbers to overcome the limitation scholars including kim and shin 2007 hong et al 2016 used translating and pulsating source green s function in place of zero speed pulsating source green s function and more accurate results were obtained however peak values of motions response amplitude operators rao are usually overestimated with respect to time domain analysis bingham 1994 zhu 2009 sengupta et al 2016 studied on transient green s function method and applied the method to compute hydrodynamic coefficients forces and motions of ship numerical results in relatively high froude numbers are also not quite satisfactory it indicates forward speed effects are significant for unsteady seakeeping computation nuemann kelvin linearized free surface condition adopted in the derivation of green s function restricts steady incoming flow to be uniform stream thus in order to concern influences of steady flow on unsteady flow more precisely researchers imposed complex m j term in body boundary condition to replace simplified ones numerical results of added mass damping coefficients and motions are obviously improved to solve m j term many researches like nakos 1990 kring 1994 kim and shin 2007 song et al 2011 kim et al 2011 and etc used double body flow potential kim and shin 2007 in further employed more reliable steady ship wave potential to compute m j term numerical evaluation of free surface green s function is difficult and time consuming green s function oscillates severely near free surface chen and wu 2001 for ship with large flare integral of green s function on panel would be singular near free surface rankine source method can avoid these obstacles as elementary solution 1 r of laplace equation is used as green s function this method can also be applied to any form of free surface condition for problem with forward speed the method will not be restricted with neumann kelvin linearized free surface condition based on rankine source method nakos 1990 kring 1994 kim and kim 2010 zhang et al 2010 song et al 2011 and so many other researchers applied double body linearized free surface condition to compute ship motions in waves of both frequency domain and time domain generally the predicted results would agree well with experiments liu and papanikolaou 2011 solved ship motions with forward speed in earth fixed coordinate to avoid computing spatial differential of velocity potential and m j terms while the moving mesh should be used in their method and consequently computational cost would increase a lot huang 1997 kim et al 2011 developed a nonlinear method according to weak scatter assumption and double body flow is also employed as steady flow in the theory body boundary condition is satisfied on instantaneous wetted hull under incident wave surface so m j terms are avoided while computation time increases a lot as coefficient matrix of boundary integral equation should be reassembled and solved at each time step although double body flow linearized method has been successfully used in computation of ship seakeeping for a long time double body flow is actually an approximation of steady flow as froude number approaches to zero so the method is just applicable for slow ships in this paper three dimensional time domain rankine source method is applied to compute ship seakeeping with forward speed ship wave is evaluated and is taken as steady flow in hydrodynamic calculation accordingly free surface condition of time domain radiation and diffraction problems is derived by taking into consideration of ship wave potential and m j term in body boundary condition is also computed with ship wave potential further comparative studies are conducted by applying the two conventional steady flow models of uniform stream us and double body flow db in time domain simulations for that steady incoming flow has significant influences on unsteady ship motion high order boundary element method hobem based on bi quadratic isoparametric elements is employed to discretize the boundary integral equation by applying the high order panel second order derivatives of velocity potential and m j term shall be solved directly in addition nonlinear froude krylov and restoring forces which are computed with exact wetted ship hull are used in ship motion equations considering body nonlinearity instantaneous wetted hull mesh is obtained by b spline interpolation at each time step a fortran program is originally developed for validation study computations of wave ship interactions are carried out for series60 ship wigley 1 s 175 container ship and a tanker over a wide range of frequencies and speeds present numerical results of added mass damping coefficients wave exciting forces and ship motions are in good agreements with experimental data the respective effects of m j term and different types of free surface conditions due to the steady flow models on hydrodynamic coefficients and ship motions are detailedly investigated in this work 2 mathematical formulation 2 1 governing equations and boundary conditions of the global boundary value problem considering a ship advancing in regular wave with constant speed u an inertial coordinate system o xyz translating with ship is defined as shown in fig 1 the xoy plane is fixed on calm water with x axis directing to bow and y axis pointing portside origin point o locates on midship and z axis points upwards assuming the fluid is invicid and incompressible and the flow is irrotational velocity potential can be introduced and it satisfies laplace equation 1 2 ϕ 0 global velocity potential ϕ shall satisfy both the kinematic and dynamic free surface conditions on z ζ x y t 2 t u ϕ z ζ x y t 0 kinematic t u ϕ ϕ 1 2 ϕ ϕ g ζ dynamic in addition the following body boundary condition should be imposed on instantaneous wetted body surface to ensure that fluid particles cannot penetrate ship hull 3 ϕ n u n 1 δ t n where δ is generalized unsteady ship motion vector δ ξ t ξ r x ξ t and ξ r are translational and rotational ship motions normal vector n is 4 n 1 n 2 n 3 n n 4 n 5 n 6 x n total velocity potential ϕ contains steady and time varying parts the latter term can further be decomposed into incident wave potential and unsteady disturbance potential which includes both radiation and diffraction components 5 ϕ x y z t φ x y z ϕ i x y z t ϕ d x y z t where regular incident wave potential is 6 ϕ i g ζ a ω e k z sin k x u t cos β k y sin β ω t accordingly total wave elevation also has the following decomposition form 7 ζ x y z t ζ s x y z ζ i x y z t ζ d x y z t detailed mathematical formulations of boundary value problems for each flow components are shown in the following sections 2 2 boundary conditions of steady ship wave problem fig 2 shows steady ship wave flow around a ship which satisfies the following free surface conditions 8 u φ x ζ s x φ y ζ s y φ z 0 kinematic u φ x g ζ s 1 2 φ φ 0 dynamic where subscripts x y z denote spatial derivatives the free surface condition is nonlinear equations about velocity potential and wave elevation and in this study a linearized form as the following is actually used 9 φ x x g u 2 φ z 0 ship wave problem is solved by source distribution method and detailed description can be found in reference of chen et al 2016 two simplified steady flow models uniform stream and double body flow are usually adopted in previous research as illustrated in fig 3 uniform stream is on assumption that there is no disturbances on steady flow by contrast double body flow can reflect the disturbance effect but it restricts the free surface to be rigid corresponding boundary conditions of the two steady flow models are expressed as equation 10 without loss of generality together with steady ship wave φ is named as steady flow potential 10 uniform stream φ 0 in fluid domain double body flow φ n u n 1 on s b φ n 0 on s f 2 3 boundary conditions of unsteady disturbance potential in view of numerical stability unsteady disturbance potential ϕ d is further decomposed into time local and memory potentials which follows the strategy of kring 1994 11 ϕ d x y z t ϕ l x y z t ϕ m x y z t the local flow potential ϕ l represents the instantaneous fluid response it is used to take out the impulsive part of the problem which would bring instability in solving motion equations after further mathematical derivations as shown in the next section hydrodynamic force associated with local flow can be expressed by proportion of ship displacement velocity and acceleration without solving by numerical differential consequently stability and accuracy would be improved the memory potential ϕ m denotes the wave flow which is the remaining part of total unsteady disturbance potential local flow potential is solution of pressure release problem which follows the boundary conditions below 12 ϕ l n j 1 6 ξ j n j ξ j m j s b ϕ l 0 s f the above body boundary condition is derived by perturbation expansion liu and miao 1986 on exact body boundary condition 3 and is satisfied on mean body position as a result an extra term the so called m j term is appear the term implies interactions of steady flow on unsteady flow in body boundary condition and is defined by 13 m 1 m 2 m 3 n u φ m 4 m 3 y m 2 z φ y n 3 φ z n 2 m 5 m 1 z m 3 x φ z n 1 φ x u n 3 m 6 m 2 x m 1 y φ x u n 2 φ y n 1 memory potential satisfies the remaining boundary conditions body boundary condition of memory potential is 14 ϕ m n ϕ i n on s b by applying taylor s expansion on equation 2 and neglecting higher order small quantities linearized free surface condition of memory potential is derived 15 t u φ ζ m ϕ l ϕ m φ z 2 φ z 2 ζ m kinematic φ ζ i u φ ζ s t u φ ϕ m g ζ m ζ s φ ϕ i dynamic u φ 1 2 φ φ where terms related to steady flow implying steady flow effects on unsteady flow are observed in the time domain free surface condition it is seen that the equation contains term ϕ l z which represents unsteady forcing due to body condition are transferred to the free surface condition of memory flow moreover an artificial damping term should be added in the kinematic free surface condition in order to satisfy the radiation condition the damping term is defined as 2 υ ζ υ 2 g ϕ where υ is cooling strength by considering different steady flow models the above boundary value problems of time domain radiation and diffraction can be recognized as ship wave double body flow and uniform stream linearization respectively 2 4 unsteady hydrodynamic force and equations of ship motion applying newton s second law equation of ship motions can be derived 16 m ξ f f k f l f m f r where the hydro forces are 17 f l m i s b p l m n i d s f f k i s b p i n i d s nonlinear s b p i n i d s linear f r i s b s b ρ g z n i d s nonlinear j 1 6 c i j ξ j linear nonlinear froude krylov force and restoring force are included in ship motions equation in weakly nonlinear calculation to compute nonlinear f f k and f r ship instantaneous wetted hull under incident wave surface is required at each time step exact ship mesh are obtained by cubic b spline interpolation hydrodynamic pressures in equation 17 is computed by bernoulli s equation 18 p l m i ρ t u φ ϕ l m i where ϕ i t has analytical solution ϕ m t is solved by the forth order backward differential scheme with respect to ϕ l t it is reported by kring 1994 and shao 2010 that this term would bring instability to numerical calculation fortunately there is an indirect way to evaluate f l without solving ϕ l t making a modal decomposition of time local flow potential arrives at 19 ϕ l j 1 6 ψ 1 j ξ j ψ 2 j ξ j where ψ 1 and ψ 2 follow the boundary conditions 20 ψ 1 j n n j ψ 2 j n m j o n s b ψ 1 j ψ 2 j 0 o n s f substituting equation 18 into equation 17 and replacing ϕ l with equation 19 time local force can be expressed by 21 f l i j 1 6 a 0 i j ξ j b 0 i j ξ j c 0 i j ξ j where 22 a 0 i j ρ s b ψ 1 j n i d s b 0 i j ρ s b ψ 2 j u φ ψ 1 j n i d s c 0 i j ρ s b u φ ψ 2 j n i d s it can be found that ϕ l t vanishes in the expression of f l substituting equation 21 into ship motions equation 16 and moving f l to the left hand side of the equation ship motions equation can then be written as the following expression 23 m a 0 ξ b 0 ξ c 0 ξ f f k i f m i f r i the forth order adams method is used to solve the above differential equation 3 numerical implementation 3 1 boundary integral equation and hobem applying green s second identity yields the following boundary integral equation bie which is used to compute memory potential ϕ m and canonical potentials ψ 1 and ψ 2 24 α i ϕ i s ϕ n g r i r d s s ϕ g r i r n d s where g is rankine source green s function i represents field point ϕ stands for ϕ m ψ 1 j ψ 2 j the bi quadratic shape function based hobem is applied to discretize the bie fig 4 displays 9 nodes panel in physical and parametric space values of variable in panel can be expressed as a linear combination of product of nodal value and shape function 25 θ k 1 9 θ k n k ξ η where variable θ represents location vector velocity potential or normal velocity ξ and η are parametric variables range from 1 to 1 k is nodal number in panel shape function is found in reference chen et al 2016 substituting equation 25 into equation 24 yields the discrete form of bie 26 i 1 n b h i j ϕ j i n b 1 n b n f a i j ϕ n j i n b 1 n b n f h i j ϕ j i 1 n b a i j ϕ n j note that ϕ n on body and ϕ on free surface are known quantities obtained by hull boundary conditions and free surface conditions as shown in equation 14 15 20 to solve the bie one can either use lu factorization or iterative methods like gmres for linear problem with fixed boundaries the lu factorization is more efficient and is adopted in this study influence coefficients in bie are computed by following equations 27 a i j p 1 n p b n p f k 1 9 δ i n d p k j 1 1 1 1 g r i r n k ξ η j ξ η d ξ d η h i j p 1 n p b n p f k 1 9 δ i n d p k j 1 1 1 1 g r i r n n k ξ η j ξ η d ξ d η δ i j α i note that solid angles in the above equations are not constant over panels when using hobem and they are evaluated directly at each node by formulas in reference of shao 2010 3 2 solving for mj term difficulty for evaluating m j term lies in solving second order derivatives of steady flow potential some researchers used alternative methods such as employing stokes theorem in which numerical computation of second order derivatives can be avoided zhao and faltinsen 1989 nakos 1990 song et al 2011 however the theorem is on rigid free surface assumption and hull form is required to be wall sided at waterline so it is not suitable for ship with large flare and is inconformity with steady ship wave used in this paper consequently a direct method for solving m j term based on high order panel is utilized by using bi quadratic shape function first and second order spatial derivatives of velocity potential can be calculated directly according to chain rule first order derivatives are 28 ϕ x ϕ y ϕ z x ξ y ξ z ξ x η y η z η n 1 n 2 n 3 1 ϕ ξ ϕ η ϕ n where subscripts ξ and η represent tangential derivatives in parametric plane they can be computed with 29 θ ξ η k 1 9 θ k n k ξ η ξ η substituting θ in equation 29 with ϕ x ϕ y and ϕ z tangential derivatives of flow velocity along ξ and η are then computed again using chain rule and considering laplace equation arrives at the following expression shao 2010 30 ϕ x ξ ϕ x η ϕ y ξ ϕ y η ϕ z ξ ϕ z η x ξ y ξ z ξ 0 0 x η y η z η 0 0 0 x ξ 0 y ξ z ξ 0 x η 0 y η z η z ξ 0 x ξ z ξ y ξ z η 0 x η z η y η ϕ x x ϕ x y ϕ x z ϕ y y ϕ y z applying least square method to solve the above overdetermined set unique solution of second order spatial derivatives of velocity potential are obtained then m j term shall be computed with equation 13 for verification the numerical method is applied to compute second order derivatives of velocity potential and m j term for the problem of flow around a sphere in infinite fluid domain fig 5 shows second order derivatives and m j term obtained by the present computation in comparison to analytical solutions and they are in excellent accordance 3 3 time marching of free surface and numerical filter the fourth order adams bashforth moulton method is applied for time marching of free surface condition as shown in equation 15 at each time step wave elevation ζ m is computed at first by kinematic condition then a corrector is employed to evaluate ϕ m by dynamic condition through an iterative process until convergence for problem with forward speed saw tooth waves on free surface would appear during time domain simulation therefore a low pass numerical filter must be introduced to overcome the numerical instability in this paper the seven point scheme of filter is implemented to smooth the free surface wave the filter is applied on ζ m in both x and y directions 31 ζ j w j ζ j w j 1 ζ j 1 w j 2 ζ j 2 w j 3 ζ j 3 where values of weight function w can be found in reference of huang 1997 3 4 automatic generation of instantaneous wetted ship hull as mentioned in section 2 4 weakly nonlinear computations need pressure integrations on wetted ship hull under wavy free surface to automatically generate instantaneous hull mesh at each time step the third order b spline interpolation is employed b spline interpolation formula is expressed as the following 32 x u i 0 n n i p u p i detailed expression of base functions n i p u and description of method to compute control points p i can be found in many books of numerical computational methods in the present computation ship hull is divided into bulbous bow main hull and stern and interpolations are applied respectively on each region as shown in fig 6 a fortran program is developed based on the approach figs 7 and 8 show test results of generated exact wetted ship hull of s 175 and a tanker at some moment 4 numerical results and discussions for verification study a fortran code is developed four types of ships are used in numerical analysis and their principle dimensions are listed in table 1 rectangle type of free surface is employed in computation and panel arrangement of computational boundaries are shown in fig 9 in view of starboard and portside symmetry only half of computational domain is used in numerical calculation for steady ship wave computation free surface is extended to 2 0l downstream 0 8l upstream and 1 5l in width while in unsteady seakeeping computation free surface range varies with incident wavelength λ the criterion in this case is that free surface extension downstream upstream and in width are 3 0λ 1 2λ and 1 5λ respectively when wavelength is larger than ship length the range of free surface becomes 3 0l 1 2l and 1 5l downstream upstream and in width to avoid too large of free surface extension in long wavelength cases it should be noted that free surface mesh density in ship wave computation is higher than unsteady ship motion computation a cubic spline interpolation is conducted after ship wave is solved to obtain values of steady flow velocity potentials and their derivatives on free surface grid of seakeeping computation to improve free surface mesh property in the vicinity of ship a stretch function that shall control mesh scale is imposed on free surface take one dimensional grid as shown in fig 10 for example stretch function is defined by equation 33 ξ i ξ e f a c i 1 n 1 1 e f a c 1 where fac 1 is a constant factor to control the stretch scale number of nodes distributed on half of computational domain boundary for case studies are listed in table 2 4 1 steady ship wave computation before solving time domain ship motions a brief validation study for steady ship wave is carried out to show that the present numerical model is reliable series 60 hull cb 0 6 is taken as numerical example computed results including wave pattern wave profiles and wave drags at various froude numbers are presented in figs 11 13 wave drag is computed by the following formula 34 c w s b p s n 1 d s 0 5 ρ u 2 s b where the steady ship wave pressure p s is computed by bernoulli s equation 35 p s ρ u φ x 1 2 φ φ where ϕ denotes ship wave potential free surface elevation is computed by the dynamic free surface condition as shown below 36 ζ s 1 g u φ x 1 2 φ φ the exp data in these figures is obtained from experiments conducted by institutes of soul national university snu akishima laboratories al1 3 university of tokyo ut1 4 it is seen from these figures that the present method has good accuracy in solving steady ship wave 4 2 hydrodynamic coefficients and motions of wigley 1 hull form of the wigley 1 is defined by formula in the reference journée 1992 incident wave amplitude in calculation is set as 0 018 m 4 2 1 comparison of steady flow results of different models figs 14 and 15 show contours of m 3 and m 5 term of wigley 1 hull evaluated by steady ship wave double body flow and uniform stream potentials at fn 0 3 in comparison m j terms of ship wave are in consistence with double body flow except slight deviations at bow and stern area while results of uniform stream are very different figs 16 and 17 display the disturbance potential φ of steady flow on z 0 at fn 0 3 and 0 4 contours of ship wave potential conforms to the realistic physical phenomenon interestingly patterns of double body potential are in accordance with ship wave potential in area near ship this may explain why m j term computed by the two models are comparable to each other however as speed goes higher for instance at fn 0 4 differences in magnitudes of velocity potential will become larger due to the rigid free surface assumption of double body flow 4 2 2 wave radiation and diffraction results non dimensional vertical wave exciting forces and moments are computed and results are plotted in figs 18 and 19 the amplitude frequency curves are obtained by fourier series expansion on time history results fourier series expansion is defined by 37 f t f 0 2 n 1 n f n cos n ω e t ε n where 38 a n 2 t 0 t f t cos n ω e t d t b n 2 t 0 t f t sin n ω e t d t and 39 f n a n 2 b n 2 ε n arctan b n a n in these figures labels nonlin f k and lin f k mean that nonlinear and linear froude krylov forces and restoring forces are considered in the computation the accordance of numerical results by different methods shows that different steady flow models would not have evident influence on wave exciting forces this is due to the irrelevance of m j term with wave diffraction and dominance of froude krylov forces in wave exciting force numerical and experimental results of added mass and damping coefficients of wigley 1 are shown in figs 20 22 results computed by three dimensional translating and pulsating 3dtp source green s function method are also presented for comparison code of 3dtp method is provide by dr hong and mathematical and numerical formulations of the method are in reference hong et al 2016 it is observed from figures that added mass and damping coefficients of present computation by considering steady ship wave are obviously in better agreement with model test data than results of uniform stream linearization and 3dtp method large deviations are found especially in low frequency region since the proportion of steady components in boundary conditions becomes relative larger slight difference between results of ship wave and double body flow linearization are found only in cases of high speeds such as fn 0 4 to investigate the separated contribution of m j terms and different free surface conditions due to steady flow models to hydrodynamic coefficients computations by applying m j terms computed with ship wave potential and uniform stream linearized unsteady free surface usl fs conditions are carried out the corresponding results are marked as ship wave usl fs comparative analysis shows m j terms have dominant effects on both added mass and damping coefficients different free surface condition have only slight influences on coupling terms of damping coefficients 4 2 3 ship motions in head waves numerical results of heave and pitch motions rao of wigley 1 moving at fn 0 3 and 0 4 in head waves comparing with experiments are shown in figs 23 and 24 as seen from figures methods by considering steady flow models of ship wave and double body flow can provide more accurate results than uniform stream linearized method which yields much higher peak values in comparison to model tests data evident distinctions between ship wave and double body flow linearization are observed in pitch motion at fn 0 4 and results of ship wave linearization are in slightly better agreement with experiments if only the complex m j terms are considered in computation and free surface condition remains to be uniform stream linearized form the legend ship wave usl fs crest of computed heave and pitch motions would become higher in addition since wigley 1 hull is thin and wall sided near free surface numerical results of nonlinear and linear computations show little difference 4 3 motions of s 175 in head waves body plan of s 175 ship is plotted in fig 25 in computation incident wave amplitude is set as 1 5 percent of ship length time histories of non dimensional heave and pitch motions of s 175 at fn 0 275 and λ l 1 2 are shown in fig 26 it is seen that the curves are very smooth which demonstrates the numerical program has good numerical stability figs 27 and 28 are comparisons of amplitudes and phase angles of s 175 heave and pitch rao at fn 0 275 in the present computation and experimental data ittc 1978 it is obvious that uniform stream linearization gives the worst predictions of motion amplitudes motions computed by ship wave linearized method are in generally better agreement with measured data than other methods since the generated steady waves are significant for s 175 with complex forms and uniform stream and double body flow are in fact assumptions of non and small disturbance of ships on steady incoming flow moreover due to its large flare influences of nonlinear froude krylov forces and restoring forces on motions of s 175 are more apparent than wigley 1 weakly nonlinear results of motions show better agreement with experimental data than results by linear computation the computed phase angles of motions rao are also in excellent accordance with experimental results 4 4 motions of 50 500 tanker in head waves the last case considers a more full formed hull of which the block coefficient is cb 0 76 the ship named as 50 500 tanker is a tanker designed by shanghai ship shipping research institute the body plan and 3d geometry model is shown in figs 29 and 30 ship speeds are 12 8kn and 14 8kn in the numerical analysis wave amplitude is 1 0 percent of ship length which is consistent with experimental condition figs 32 35 depict the computed and measured heave and pitch motions rao present results obtained by ship wave linearized method are more accurate than double body flow linearized and 3dtp method in comparison to experimental data comparing the results computed with different free surface conditions ship wave and uniform stream linearized and the same body boundary condition containing ship wave m j terms labeled as ship wave lin f k and ship wave lin f k usl fs respectively it is found that steady flow effects contributed from both m j terms and different free surface conditions are evident on ship motions in this case ship speeds of 12 8kn and 14 8kn are relatively slow and in conventional view the double body flow linearized method which is recognized as slow ship theory is applicable but the computed motions by double body linearized method are not satisfactory this is because double body flow only represents a kind of local flow containing no waves and is an approximation of the actual steady ship wave fig 31 also manifests that steady disturbance potentials on z 0 of ship wave and double body flow are quite different for the full formed ship even at low speed while fortunately in seakeeping analysis only components of unsteady potential and the according linearized boundary conditions about the steady flow are concerned therefore as double body flow shall to some extent represent disturbance of hull on uniform stream the according linearized method may have good accuracy in most cases however as speed goes high or hull form becomes full and complex numerical method by considering effects of steady ship wave would provide better results comparisons of unsteady free surface elevations obtained by different methods are also carried out and wave contours are plotted in fig 36 results of ship wave and double body flow linearized method look similar and they have differences with the result of uniform stream linearized computation in the vicinity of ship 5 concluding remarks in the present paper a weakly nonlinear time domain rankine source method with high order boundary element discretization is proposed to compute motions of ship advancing with steady forward speed in waves in this study steady ship wave is evaluated and taken account into time domain simulations a fortran program is developed and is applied to compute ship motions hydrodynamic coefficients and forces of wigley 1 hull s 175 container ship and 50 500 tanker at different speeds and wave frequencies by numerical analysis the following conclusions can be drawn 1 the computed motions hydrodynamic coefficients and wave exciting forces of different hulls over a wide range of frequencies are in quite good agreement with related experimental data it indicates the present method has good accuracy and extensive applicability 2 different steady flow models have significant influences on added mass damping coefficients and motions in case with forward speed whereas the effects on wave exciting forces are negligible hydrodynamic coefficients and unsteady motions computed by considering ship wave and double body flow are comparable for ships with simple types of hulls and both of them are obviously more accurate than results of uniform stream linearization ship motions computed by double body flow linearized method are satisfactory in most cases however for ships with full and complex hulls taking actual ship wave into account can improve results of ship motions as the generated steady waves become more significant 3 both the different free surface conditions due to steady flow models and m j terms have apparent effects on the numerical results of ship motions while added mass and damping coefficients are mainly affected by m j terms 4 it can improve accuracy of numerical results of motions for ships with large flare like s 175 and in conditions of medium and high froude numbers by considering nonlinear froude krylov and restoring forces 5 the present work has potential to be extended to fully nonlinear computations of wave ship interactions and can be applied to other ship seakeeping problems like prediction of added wave resistance these would be our further study in the future acknowledgement this work has been jointly supported by national natural science foundation of china nsfc grant no 51479117 51579147 and national key basic research program of china 973 program grant no 2014cb046203 
23637,in this study the resistance and self propulsion analyses of the benchmark darpa suboff with e1619 propeller have been done using computational fluid dynamics cfd method single phase analyses have been carried out by assuming 3 d turbulent incompressible and steady flow thus the governing equations rans equations have been discretized with finite volume method fvm first verification and validation studies have been carried out in order to determine the optimum grid numbers for resistance analyses of bare and appended forms and then for open water propeller analyses the numerical studies have been done by taking the propeller hull interaction into consideration by two methods for different velocities first the propeller has been modeled as an actuator disc based on body force method coupled with the experimental open water data the propeller itself has later been modeled behind the hull with a rotating region performance analyses have been carried out at the self propulsion points determined by these two methods self propulsion characteristics have been estimated using thrust identity method finally a comprehensive investigation of wake has been carried out by comparing the present results with those of other studies and the applicability of cfd on self propulsion prediction of the underwater vehicles has been discussed keywords cfd darpa suboff e1619 propeller propeller hull interaction rans self propulsion 1 introduction one of the main goals of submarine designers and researchers is to estimate the resistance and self propulsion characteristics for different velocities satisfactorily for this purpose cfd methods have been widely used for simulating the flow around the submarines including the interactions between the hull and the propeller the complexity of the work being done the variability and the difficulty of environmental conditions is gaining importance in the design phase of the vehicle vaz et al 2010 hydrodynamic design of submarine propellers has also been an important issue for the designers a submarine propeller has to be designed and optimized by considering the propeller hull interaction finite volume method based commercial cfd codes solving rans equations are now widely used for the estimation of propeller performance it is possible to simulate the propeller flow not only for open water condition but also with modelling the interaction between the propeller and the hull and even the rudder in the past some studies have been made about estimating the hydrodynamic signature of the propeller performance in the presence of surface hulls using numerical and experimental methods stern et al 1994 have made a study in order to validate viscous flow method solving the flow around a propeller in the presence of a hull the numerical results have been compared with those of an inviscid method the viscous flow method has shown that the inviscid methods will be abandoned with the advance in viscous methods tahara et al 2006 have later carried out steady flow analyses for the kcs model using two different rans solvers the numerical results have been presented for towing and self propulsion tests and then compared with the available experimental results ghassemi et al ghassemi and ghadimi 2008 have developed a computational approach based on panel method in order to predict the hydrodynamic performance of a propeller rudder system and an azimuthing podded drive system the calculations have been made for three propeller models with three steering systems in uniform and non uniform conditions the results have been compared with the experimental results with and without rudder the results of the panel method have been in good agreement with the experiments for propeller rudder system zhang 2010 has investigated the well known benchmark case kcs model numerically the viscous flow around the model ship has been simulated by a rans solver for three different grid sets then the viscous flow around kcs model has been investigated with an operating propeller by applying body force and sliding mesh approaches the results of these approaches have been compared with the experimental ones it has been found that cfd method is feasible for prediction of propeller hull interaction another numerical study has been conducted for resistance open water propeller and self propulsion performance prediction for kcs model using a rans solver by seo et al 2010 local mesh refinements have been employed in order to gain a convenient mesh structure sliding mesh technique has been chosen for open water propeller tests numerical results have then been compared with the existing available data in the research of choi et al 2010 numerical analyses have been carried out to simulate the flow around eight different commercial ship types for investigation of streamlines on the hull wave pattern around hull and wake field on the propeller plane in order to consider the self propulsion a potential flow solver has been employed and the propeller characteristics have been implemented into the rans solver uncertainty assessment has been used for viscous resistance with different grid numbers the paper of carrica et al 2010 has presented a method for the self propulsion calculation of surface ships the method has been based on controlling the propeller rotation speed to find the self propulsion point while trying to reach the target froude number this approach reduces the necessary computational time significantly by performing only one analysis using the controller the method has been applied to three different forms kvlcc1 onr tumblehome and kcs berger et al 2011 have focused on the propeller hull interaction with a coupled method the numerical study has been carried out for kcs the velocity field gathered from the rans solver has been given as an input to the potential solver after the new calculated velocity field has been applied to the rans solver the flow has been solved by taking the propeller hull interaction into account the numerical results of the model propeller have been compared with those of a fully rans computation by this approach the computational time has been decreased significantly and the thrust force has been predicted quickly a numerical investigation has been carried out using an in house developed cfd solver based on rans and des in another study by carrica et al 2011 self propulsion of kcs model has been analyzed in head wave and calm water conditions by taking sinkage and trim into account the numerical results have been compared with the experimental ones e g sinkage trim and revolution rate of the propeller villa et al villa and brizzolara 2012 have made a numerical simulation of the flow around a ship with self propulsion analyses by rans solver the coupled method has been applied first solve the viscous flow around kcs model and then compute the performance of kp505 propeller by an unsteady panel method the research of win et al 2013 has focused on the interaction between series 60 hull and a five bladed fixed pitch propeller using a cfd code coupled with a quasi steady blade element theory the analyses have been carried out with and without propeller and both results have been compared with the available experimental data the comparison has shown that the developed blade propeller model with blade element theory is in fair agreement with the experiments rijpkema et al 2013 have studied the propeller hull interaction by simulating the steady viscous flow around kcs model with rans method and unsteady propeller flow with bem boundary element method the numerical analyses have been carried out by a hybrid method the coupled rans bem approach has given accurate results for thrust compared with the experimental data the total resistance has been estimated by a commercial cfd program for dtc post panamax container ship in another study of kinaci et al 2013 they have also carried out a self propulsion analysis without taking free surface effect into account abbas et al 2015 have offered a hybrid method in order to estimate the propeller forces behind the ship a hybrid urans les model has been applied to compute the unsteady loadings on marine propellers behind the kvlcc2 tanker model the numerical results have been compared with different empirical estimations it has been found that the hybrid computations overestimate the thrust loading and it can simulate transversal effects in addition to the bilge vortices in the ship stern region in bare hull condition ponkratov et al ponkratov and zegos 2015 have focused on the full scale cfd simulations for self propulsion analyses the numerical analyses have been conducted using k ω sst turbulence model moving reference frame mrf has been employed in the first stage in order to get quick results later rigid body motion rbm has been applied with lower time step size in order to obtain the self propulsion point in another study of kinaci et al 2016 cfd analyses have been carried out for resistance prediction of kriso container ship experimental and numerical calculations have also been carried out for a fully submerged body and a validation study has been done all above studies have been made for surface types of ships on the other hand self propulsion studies have also been carried out for underwater vehicles by considering the propeller hull interaction the work of philips et al 2008 focused on the coupling of blade element momentum theory with rans method for an autonomous underwater vehicle uncertainty analysis has been carried out for the grid structure chase 2012 has studied the self propulsion performance of the well known darpa suboff a custom developed cfd solver has been employed for open water analyses at various advance coefficients the effects of the turbulence models on the results have been investigated the wake field has been compared with the experimental data for a constant advance coefficient chase 2012 a seven bladed insean e1619 model propeller has been studied in the presence of darpa suboff submarine model by chase et al chase and carrica 2013 the numerical analyses have been made by employing delayed detached eddy simulation ddes approach the results have been compared with different turbulence models using four grids and three time steps for one advance coefficient the results showed that the present approach is applicable in self propulsion performance prediction of submarines zhang et al zhang and zhang 2014 have carried out a study involving the interaction between propeller and a submarine hull the analyses have been made by taking the free surface effects into account the results showed a good agreement with the experiments it has been highlighted that the free surface has significant effect on total resistance budak et al have investigated the effect of bow and stern geometries on resistance of bared darpa suboff via cfd method budak and beji 2016 in another study delen et al delen et al 2017 have investigated the hull propeller interaction of darpa suboff vehicle using body force method hydrodynamic performance of darpa suboff has been estimated both numerically and empirically the numerical results are more accurate than those of empirical method when compared with the experimental data in this study open water performance of e1619 model propeller and resistance of darpa suboff aff 1 and aff 8 forms have been predicted using computational fluid dynamics cfd method aff 1 is the bare form while aff 8 has the appendages including the sail and rudder fins verification and validation studies have been conducted for both open water propeller analyses and resistance analyses to determine the optimum grid number the self propulsion point of the submarine has been found where the propeller thrust is equal to the submarine total resistance two techniques have been employed for self propulsion performance prediction i the body force method and ii the model propeller itself modeled behind the submarine hull moving reference frame mrf method has been used for open water and self propulsion analyses the mrf method for the submarine might work as long as there are no objects in the propeller wake ponkratov and zegos 2015 the self propulsion performance has been computed by thrust identity method a detailed wake survey has also been done numerically and the results have been compared with available experimental and numerical data 2 theoretical background 2 1 mathematical formulation the governing equations are the continuity equation and the rans equations for the unsteady three dimensional incompressible flow the continuity can be given as 1 u i x i 0 velocity u can be decomposed into mean velocity part and fluctuating velocity part respectively 2 u i u i u i the momentum equations are expressed as 3 u t u i u j x j 1 ρ p x i x j ν u i x j u j x i u i u j x j in this study because all analyses have been run in steady state the first term has not been taken into account in momentum equations u i states the mean velocity while u i states the fluctuation velocity components in the direction of the cartesian coordinate x i p expresses the mean pressure ρ the density and ν the kinematic viscosity of the fluid the k ε turbulence model is applied in order to simulate the turbulent flow around the submarine precisely this turbulence model is applicable when there are no high pressure changes along the hull and separation on and or near the hull in this case k ε turbulence model is used because the vessel is submerged and there are no free surface effects during the analyses reynolds stress tensor is calculated as follow 4 u i u j ν t u i x j u j x i 2 3 δ i j k here ν t is the eddy viscosity and expressed as ν t c μ k 2 ε while c μ is an empirical constant c μ 0 09 k is the turbulent kinetic energy and ε is the turbulent dissipation rate in addition to the continuity and momentum equations two transport equations are solved for k and ε 5 k t k u j x j x j ν ν t σ k k x j p k ε 6 ε t k u j x j x j ν ν t σ ε ε x j c ε 1 p k ε k c ε 2 ε 2 k further explanations for the k ε turbulence model may be found in wilcox 2006 2 2 uncertainty assessment in this study uncertainty assessment has been carried out via grid convergence index gci as recommended in the ittc procedure for cfd verification ittc 2011a this method firstly was proposed by roache 1998 and then improved with different other studies the procedure implemented in this study has briefly been explained below celik et al 2008 let h1 h2 and h3 are grid lengths and h 1 h 2 h 3 the refinement factors are as follows 7 r 21 h 2 h 1 r 32 h 3 h 2 refinement factors should be greater than 1 3 in accordance with the experiments celik et al 2008 grid lengths refinement has been selected as 2 as in the studies of tezdogan et al 2015 and ozdemir et al 2016 because of the mesh algorithm grid number has been taken into account during the calculation of the refinement factors this choice is crucial in uncertainty analyses especially for unstructured mesh system therefore these values have been differentiated 8 r 21 n 1 n 2 1 3 r 32 n 2 n 3 1 3 difference between generated grid numbers can be calculated as below 9 ε 21 x 2 x 1 ε 32 x 3 x 2 at this point convergence condition r can be examined as 10 r ε 21 ε 32 the solution has an oscillating convergence when 1 r 0 while the solution is monotonically convergent if 0 r 1 3 numerical method 3 1 grid structure and boundary conditions the computational domain has been selected to be adequate in dimensions to simulate the ship flow properly for resistance and self propulsion analyses which is identical to the recommended dimensions of ittc guideline ittc 2011b fig 1 shows the main dimensions of the computational domain and the boundary conditions applied on the surfaces in order to have proper cfd analyses the initial and boundary conditions should be defined carefully depending on the flow problem correct boundary conditions lead the analysis to accurate results and prevent the unnecessary computational costs also the boundary conditions should be chosen to ensure that they have no influence on the numerical solution date and turnock 1999 the right side of the computational domain is defined as velocity inlet and the left side is defined as pressure outlet fig 1 the submarine boundary is to be taken as no slip wall which indicates that the velocity components and the total velocity are zero on the hull surface the propeller blades are also set to be wall with no slip condition in addition the surrounding surfaces are defined as symmetrical ones in order to establish a numerical towing tank more detailed information on boundary conditions can be obtained from the theory guide of the commercial cfd software star ccm documentation 2015 the computational domain is discretized by three dimensional finite volumes in compliance with finite volume method for resistance analyses proper mesh structure has been created around the submarine hull using hexahedral elements in order to create the control volume to be solved trimmer meshing is employed the trimmer meshing algorithm provides a fully hexahedral mesh structure avoiding the tetrahedral elements the computational domain is represented by hexahedral elements while finer elements are employed on the submarine surface a finer mesh is also employed near the stern region in order to well capture the interaction between the propeller and the submarine hull a mesh refinement is made in the bow region to capture the flow details as well unstructured mesh around the submarine is given in figs 2 and 3 mesh size of the hull surface and the growth rate is adjusted in order to keep wall y values in an acceptable range 30 300 average wall y value of the submarine hull is between 60 and 175 for all velocities fig 4 shows the computational domain with the assigned boundary conditions on the surfaces of propeller working in open water condition the left side of the computational domain is defined as pressure outlet while the right side is to be velocity inlet fig 4 the propeller blades and the shaft are considered as no slip wall that indicates that the velocity components hence total velocity are zero on the propeller blades the surrounding surfaces are defined as symmetrical ones in this study single phase analyses are carried out without taking free surface effects into account by simulating the flow around the submarine hull with or without the appendages for open water propeller and propulsion both actuator disc and self propelled cases analyses hexahedral mesh structure has been employed using trimmer mesh algorithm also a fine mesh region has been created around the propeller disc in order to model the interaction of the hull and the propeller more accurately fig 5 shows the fine mesh applied on the e1619 model propeller blades in both open water and self propelled cases average wall y value of the propeller blade in open water condition is between 90 and 115 for all advance coefficients 3 2 solution strategy k ε turbulence model is used in the numerical analyses which has been extensively used for industrial applications star ccm documentation 2015 also querard et al have stated that the k ε model is quite economical in terms of cpu time when compared to the sst turbulence model which increases the required cpu time by nearly 25 quérard et al 2008 the k ε turbulence model has also been used in many other studies performed in the same area such as tezdogan et al 2015 kim and lee 2011 enger et al 2010 ozdemir et al ozdemir et al 2016 2014 the pressure field is solved by using simple algorithm which is based on pressure velocity coupling simple is a commonly used algorithm for calculating pressure and velocity fields in an iterative manner especially for steady state analyses it reduces the computational time quickly versteeg and malalasekera 2007 all governing equations are discretized using a cell based finite volume method and the advection terms are discretized with a first order upwind interpolation scheme because of the flow characteristics the analyses have been made via single phase assumption free surface effects are not taken into account either in resistance or propulsion analyses viscous effects near the submarine are taken into account by modelling the boundary layer with an appropriate grid structure keeping wall y values of the hull in a reasonable range 30 300 barlas 2000 rotational flow analyses have been done using moving reference frame mrf technique for open water and self propulsion analyses with propeller by this technique the governing equations are transformed into a rotating frame to get a steady state solution moussa 2014 for self propulsion analyses an actuator disc has first been modeled using body force theorem distribution of body forces has been applied in this actuator disc region here actuator disc region represents an infinite number of blades of propeller the hydrodynamic performance characteristics of model propeller have been defined in this region the actuator disc and the model propeller have the same diameter and identical distributions of elemental thrust along the radius krasilnikov 2013 4 verification and validation in this study three different grid sizes have been used as given in table 1 for resistance and open water propeller analyses in the table aff 1 is the bare submarine form and aff 8 is the submarine with appendages including the sail and rudder fins detailed information of the submarine geometries can be found in the following section 5 1 according to wilson et al 2001 the most important source of uncertainty of the numerical results is coming from grid different grid numbers have been used for modelling the computational domain for resistance and propulsion analyses after verification and validation study the optimum grid number has been implemented for the rest of the analyses including actuator disc and self propulsion cases for different velocities as given in table 1 computational domain has been created with different grid numbers for uncertainty analyses one may see that the grid number increases for aff 8 because of the appendages and local mesh refinements around the appendages the free stream velocity has been considered as 3 046 m s for aff 1 and 3 051 for aff 8 during the uncertainty analyses advance coefficient j is taken as 0 4625 in open water propeller analyses in this study convergence condition r is calculated as 0 244 for aff 1 which means that the solution is converged monotonically for aff 8 r is calculated as 0 649 which means that the solution has an oscillating convergence detailed information about grid convergence index gci can be found in the study of roache 1998 table 2 presents the uncertainty values of resistance analyses and open water analyses the uncertainty percentage is higher for the appended submarine hull than that of bare hull the appendages on the geometry make the problem more complex which results in a higher uncertainty the numerical results are also compared with the experimental results in order to validate the numerical method as given in table 3 the numerical results are of the optimum grid number the uncertainty analyses have been made for resistance analyses for total ship resistance while it has been carried out for open water test for thrust fine mesh algorithm has been chosen as the optimum one for resistance analyses while medium grid has been selected the optimum one for open water propeller analyses attention has been paid in order to validate the numerical method with the experiments the optimum grid number has been obtained and the analyses have been validated with the available experimental data the rest of the analyses have been performed using the optimum grid numbers for resistance open water actuator disc and self propulsion analyses 5 results and discussions in this section the flow is simulated around darpa suboff geometry for bare and appended hulls using the optimum grid number found after verification and validation processes in addition open water flow analyses have been carried out for e1619 model propeller following the resistance and open water analyses self propulsion tests have been done by two different methods first the open water propeller results have been coupled with rans solver using body force propeller method this method assumes an actuator disc behind the hull to represent the propeller second self propulsion tests have been conducted by modeling the propeller itself behind the hull for both methods the self propulsion points have been determined for different velocities these two methods have been compared by means of self propulsion characteristics the positive and negative features of these methods have been discussed 5 1 geometrical dimensions darpa suboff is a widely used benchmark form the 3 d geometry of the submarine is shown in fig 6 geometrical features of the submarine are also given in table 4 the submarine models used in this study are entitled as aff 1 for bare form and aff 8 for appended form groves et al 1989 table 5 and fig 7 show the main particulars of the benchmark propeller e1619 and 3 d geometry respectively as can be seen from fig 7 the propeller has a highly skewed form 5 2 resistance analyses total resistance of the model submarine darpa suboff has been computed by cfd for bare hull aff 1 and for appended hull aff 8 the resistance analyses have been carried out for different velocities and all numerical results have been compared with the experimental data given in liu and huang 1998 it is also found that the effect of the appendages on total resistance can be predicted precisely by cfd method figs 8 and 9 show total resistance of darpa suboff aff 1 and aff 8 for different velocities respectively one can see that the numerical results are in a good agreement with the experiments for both cases tables 6 and 7 also show the relative error between the numerical and experimental results both for aff 1 and aff 8 in addition a validation study has been made for darpa suboff aff 8 in terms of non dimensional pressure and skin friction coefficients at reynolds number of 1 4 107 both non dimensional parameters have been compared with those of another numerical study yang and löhner 2003 and experimental study huang and liu 1994 liu and huang 1998 toxopeus 2008 available in the literature for v 3 34 m s these parameters have been calculated along the submarine surface figs 10 and 11 show clearly that the non dimensional pressure distribution by the present cfd study is well matched with other numerical and experimental results although there are some discrepancies for the skin friction coefficients between the experiments and present cfd methodology for x l 0 9 the overall skin friction coefficients of present cfd are closer to experiments the non dimensional pressure coefficient and skin friction coefficients are computed by the following equations 11 c p p 0 p ρ u 2 12 c f τ w ρ u 2 averaged values of axial velocity on different locations behind the submarine have also been computed fig 12 shows the locations behind submarine for bare and appended forms the nearest location to the submarine is the propeller plane at this location x l 0 978 average velocity distribution in the axial direction can be used to derive the nominal wake coefficient as can be seen from fig 12 the axial velocity increases in far downstream location and finally it becomes almost equal to the freestream velocity v 2 75 m s the effects of appendages can be seen in the velocity distributions especially in the propeller plane fig 13 shows the comparison of present numerical results with experimental and another numerical results available in the literature for v 2 75 m s by wake profiles both experimental and numerical results show the effect of the appendages clearly k w sst urans results of bhushan et al 2013 does not give the v shaped carving as seen in the experimental results although the present study based on rans method produces a similar shape the sail of the submarine causes this v shape in velocity distribution the wake of the sail accelerates the flow slightly in the propeller plane on the other hand both numerical results of sst urans and present rans give similar results near the trailing edges of the fins appended on the submarine stern the differences between experimental results and numerical results of bhushan et al 2013 and of present study are due to the hub diameter the hub diameter ratio in experimental study has not been explained clearly in this study the hub diameter ratio is considered as 0 226 as given in bhushan et al 2013 a detailed comparison of present numerical results with those of experiments chase 2012 for v 2 75 m s can be seen in figs 14 16 more clearly the effect of appendages can also be seen clearly it can be noted that the appendages affect the velocity distribution significantly on the propeller plane while there is a symmetrical velocity distribution for bare form far away in the downstream direction from the submarine the effect on the velocity values due to appendages are decreasing 5 3 analyses of propeller in open water propeller analyses in open water have been carried out by cfd method the optimum grid number has first been determined for open water analyses e1619 model propeller has then been validated with the experimental data provided by insean in fig 17 it has been found that for j numbers higher than 0 6 j 0 6 the deviation between cfd and experimental results is increasing on the other hand the agreement of efficiency is acceptable except for j 1 5 4 self propulsion analyses with body force method the self propulsion points have been found by searching the velocities at which the propeller thrust overcomes the submarine total resistance during the computations the thrust identity method has been used the thrust and torque coefficients have been calculated from thrust and torque values obtained from self propulsion analyses in order to obtain the advance coefficient at the self propulsion point of the submarine thrust coefficient value has been used in open water curve self propulsion points have been computed for both bare hull and appended hull without modeling the actual propeller behind the submarine for different velocities instead body force method has been applied and open water performance characteristics of e1619 model propeller has been used on the actuator disc as expected the appended form causes an increase in revolution rate for the same speed as compared with that of bare hull form fig 18 shows the self propulsion points of darpa suboff with actuator disc for a range of velocities 5 5 self propulsion analyses with model propeller the self propulsion analyses with model propeller is similar to that of body force method the self propulsion points have also been found by searching the velocities at which the propeller thrust overcomes the submarine total resistance during the computations the thrust identity method has been used self propulsion analyses of darpa suboff with e1619 model propeller have been carried out for bare hull and appended hull e1619 model propeller has also been modeled behind the submarine within a rotating region fig 19 shows the self propulsion points of darpa suboff with model propeller at different velocities 5 6 characteristics of self propulsion the self propulsion interaction between hull and propeller characteristics of a bare form is briefly described below ittc 1978 the nominal wake coefficient here is calculated as follow 13 w 1 v a v s here va is the average flow velocity in the propeller plane vs is the submarine velocity or incoming flow velocity towards the stationary hull va is calculated using 14 j v a n d here j is the advance coefficient d is the propeller diameter and n is the propeller rotation speed the thrust deduction factor on the other hand can be calculated by 15 t 1 r t t non dimensional thrust and torque coefficients of the propeller can be derived with the equations given below here t is the thrust force and q is the torque value 16 k t t ρ n 2 d 4 17 k q q ρ n 2 d 5 the hull efficiency is the ratio of effective power to propeller thrust power it can be expressed as follows 18 η h 1 t 1 w the relative rotation efficiency is the ratio of the open water propeller torque to the torque of the propeller working behind the hull 19 η r q o q the open water propeller efficiency is calculated by the following equation 20 η o t v a 2 π n q o the propulsion efficiency can then be expressed as follows 21 η d η h η o η r effective power is the power required to pull the hull at constant speed vs 22 p e r t v s the power delivered to the propeller is then calculated as 23 p d p e η d thrust loading factor in momentum theory can be computed as below 24 c t h t ρ v a 2 d 2 π 8 the ideal efficiency of propeller in momentum theory can be expressed as below bertram 2014 25 η i 2 1 1 c t h tables 6 8 show the self propulsion characteristics of darpa suboff with body force method and e1619 model propeller during the calculations thrust identity method has been used the thrust and torque coefficients have been calculated from thrust and torque values gained from self propulsion analyses in order to obtain the advance coefficient at the self propulsion point of the submarine thrust coefficient has been entered in open water curve owc and corresponding advance coefficient has been obtained here experimental and numerical owc can be used in this study experimental owc has been used in order to calculate advance coefficient in the self propulsion point however a comparison of numerical and experimental owc is given in table 8 for aff 8 at v 2 75 m s the results have also been compared with those of chase 2012 the results of both owc methods are quite promising the difference in cfd owc between present study and chase 2012 is because the relative difference between numerical and experimental results in open water performance characteristics of e1619 model propeller in the present study although the open water propeller efficiencies are different propulsive efficiency and delivered power values have been computed as equal this is due to the hull efficiency and the relative rotative efficiency values 6 conclusions a comprehensive study has been done using cfd method in order to predict self propulsion performance of darpa suboff aff 1 and aff 8 forms open water analyses have been carried out for e1619 submarine propeller total resistance of the submarine bare and appended forms have been computed at different velocities the numerical analyses have been done using the optimum grid number determined by verification and validation processes the results non dimensional pressure and skin friction coefficients are in good agreement with the experimental data and other numerical result a detailed wake survey has been done for bare and appended forms of darpa suboff the results have been compared with available experimental and numerical results and it has been found that the results are matching well with each other self propulsion performance analyses have been carried out at different velocities using body force method and by modeling the propeller itself behind the submarine self propulsion points of the submarine aff 1 and aff 8 forms have been predicted numerically for one velocity self propulsion characteristics of aff 8 have been compared with the study of chase 2012 thrust identity method applied here has been found satisfying for both experimental and numerical open water curves finally body force method and self propelled case have been compared with each other in terms of self propulsion characteristics body force method has estimated lower propulsive efficiency and higher delivered power as compared with the self propelled case it is found that the hull efficiency is higher in self propelled case this can be due to positive propeller hull interaction acknowledgement the authors wish to thank mr francesco salvatore and insean for their support in providing the 3 d geometry of the propeller e1619 and open water experimental data for use in our academic researches the authors also thank mr emre kahramanoglu for his valuable help throughout this study nomenclature u i mean velocity ui fluctuation velocity component p mean pressure ρ fluid density k turbulent kinetic energy ε turbulent dissipation rate rt ship total resistance loa length overall lbp length between perpendiculars dmax submarine maximum diameter s submarine wetted surface area submarine displacement d propeller diameter p d propeller pitch ratio z number of blades ae a0 propeller blade expansion ratio c p non dimensional pressure coefficient c f non dimensional skin friction coefficient τ w wall shear stress w nominal wake coefficient va the mean flow velocity at the propeller plane vs incoming flow velocity n propeller rotation speed j advance ratio t thrust deduction factor t propeller thrust force q propeller torque kt non dimensional thrust coefficient kq non dimensional torque coefficient η h hull efficiency η r relative rotation efficiency η o open water propeller efficiency η d propulsion efficiency pe effective power pd delivered power c t h thrust loading factor η i ideal efficiency of the propeller 
23637,in this study the resistance and self propulsion analyses of the benchmark darpa suboff with e1619 propeller have been done using computational fluid dynamics cfd method single phase analyses have been carried out by assuming 3 d turbulent incompressible and steady flow thus the governing equations rans equations have been discretized with finite volume method fvm first verification and validation studies have been carried out in order to determine the optimum grid numbers for resistance analyses of bare and appended forms and then for open water propeller analyses the numerical studies have been done by taking the propeller hull interaction into consideration by two methods for different velocities first the propeller has been modeled as an actuator disc based on body force method coupled with the experimental open water data the propeller itself has later been modeled behind the hull with a rotating region performance analyses have been carried out at the self propulsion points determined by these two methods self propulsion characteristics have been estimated using thrust identity method finally a comprehensive investigation of wake has been carried out by comparing the present results with those of other studies and the applicability of cfd on self propulsion prediction of the underwater vehicles has been discussed keywords cfd darpa suboff e1619 propeller propeller hull interaction rans self propulsion 1 introduction one of the main goals of submarine designers and researchers is to estimate the resistance and self propulsion characteristics for different velocities satisfactorily for this purpose cfd methods have been widely used for simulating the flow around the submarines including the interactions between the hull and the propeller the complexity of the work being done the variability and the difficulty of environmental conditions is gaining importance in the design phase of the vehicle vaz et al 2010 hydrodynamic design of submarine propellers has also been an important issue for the designers a submarine propeller has to be designed and optimized by considering the propeller hull interaction finite volume method based commercial cfd codes solving rans equations are now widely used for the estimation of propeller performance it is possible to simulate the propeller flow not only for open water condition but also with modelling the interaction between the propeller and the hull and even the rudder in the past some studies have been made about estimating the hydrodynamic signature of the propeller performance in the presence of surface hulls using numerical and experimental methods stern et al 1994 have made a study in order to validate viscous flow method solving the flow around a propeller in the presence of a hull the numerical results have been compared with those of an inviscid method the viscous flow method has shown that the inviscid methods will be abandoned with the advance in viscous methods tahara et al 2006 have later carried out steady flow analyses for the kcs model using two different rans solvers the numerical results have been presented for towing and self propulsion tests and then compared with the available experimental results ghassemi et al ghassemi and ghadimi 2008 have developed a computational approach based on panel method in order to predict the hydrodynamic performance of a propeller rudder system and an azimuthing podded drive system the calculations have been made for three propeller models with three steering systems in uniform and non uniform conditions the results have been compared with the experimental results with and without rudder the results of the panel method have been in good agreement with the experiments for propeller rudder system zhang 2010 has investigated the well known benchmark case kcs model numerically the viscous flow around the model ship has been simulated by a rans solver for three different grid sets then the viscous flow around kcs model has been investigated with an operating propeller by applying body force and sliding mesh approaches the results of these approaches have been compared with the experimental ones it has been found that cfd method is feasible for prediction of propeller hull interaction another numerical study has been conducted for resistance open water propeller and self propulsion performance prediction for kcs model using a rans solver by seo et al 2010 local mesh refinements have been employed in order to gain a convenient mesh structure sliding mesh technique has been chosen for open water propeller tests numerical results have then been compared with the existing available data in the research of choi et al 2010 numerical analyses have been carried out to simulate the flow around eight different commercial ship types for investigation of streamlines on the hull wave pattern around hull and wake field on the propeller plane in order to consider the self propulsion a potential flow solver has been employed and the propeller characteristics have been implemented into the rans solver uncertainty assessment has been used for viscous resistance with different grid numbers the paper of carrica et al 2010 has presented a method for the self propulsion calculation of surface ships the method has been based on controlling the propeller rotation speed to find the self propulsion point while trying to reach the target froude number this approach reduces the necessary computational time significantly by performing only one analysis using the controller the method has been applied to three different forms kvlcc1 onr tumblehome and kcs berger et al 2011 have focused on the propeller hull interaction with a coupled method the numerical study has been carried out for kcs the velocity field gathered from the rans solver has been given as an input to the potential solver after the new calculated velocity field has been applied to the rans solver the flow has been solved by taking the propeller hull interaction into account the numerical results of the model propeller have been compared with those of a fully rans computation by this approach the computational time has been decreased significantly and the thrust force has been predicted quickly a numerical investigation has been carried out using an in house developed cfd solver based on rans and des in another study by carrica et al 2011 self propulsion of kcs model has been analyzed in head wave and calm water conditions by taking sinkage and trim into account the numerical results have been compared with the experimental ones e g sinkage trim and revolution rate of the propeller villa et al villa and brizzolara 2012 have made a numerical simulation of the flow around a ship with self propulsion analyses by rans solver the coupled method has been applied first solve the viscous flow around kcs model and then compute the performance of kp505 propeller by an unsteady panel method the research of win et al 2013 has focused on the interaction between series 60 hull and a five bladed fixed pitch propeller using a cfd code coupled with a quasi steady blade element theory the analyses have been carried out with and without propeller and both results have been compared with the available experimental data the comparison has shown that the developed blade propeller model with blade element theory is in fair agreement with the experiments rijpkema et al 2013 have studied the propeller hull interaction by simulating the steady viscous flow around kcs model with rans method and unsteady propeller flow with bem boundary element method the numerical analyses have been carried out by a hybrid method the coupled rans bem approach has given accurate results for thrust compared with the experimental data the total resistance has been estimated by a commercial cfd program for dtc post panamax container ship in another study of kinaci et al 2013 they have also carried out a self propulsion analysis without taking free surface effect into account abbas et al 2015 have offered a hybrid method in order to estimate the propeller forces behind the ship a hybrid urans les model has been applied to compute the unsteady loadings on marine propellers behind the kvlcc2 tanker model the numerical results have been compared with different empirical estimations it has been found that the hybrid computations overestimate the thrust loading and it can simulate transversal effects in addition to the bilge vortices in the ship stern region in bare hull condition ponkratov et al ponkratov and zegos 2015 have focused on the full scale cfd simulations for self propulsion analyses the numerical analyses have been conducted using k ω sst turbulence model moving reference frame mrf has been employed in the first stage in order to get quick results later rigid body motion rbm has been applied with lower time step size in order to obtain the self propulsion point in another study of kinaci et al 2016 cfd analyses have been carried out for resistance prediction of kriso container ship experimental and numerical calculations have also been carried out for a fully submerged body and a validation study has been done all above studies have been made for surface types of ships on the other hand self propulsion studies have also been carried out for underwater vehicles by considering the propeller hull interaction the work of philips et al 2008 focused on the coupling of blade element momentum theory with rans method for an autonomous underwater vehicle uncertainty analysis has been carried out for the grid structure chase 2012 has studied the self propulsion performance of the well known darpa suboff a custom developed cfd solver has been employed for open water analyses at various advance coefficients the effects of the turbulence models on the results have been investigated the wake field has been compared with the experimental data for a constant advance coefficient chase 2012 a seven bladed insean e1619 model propeller has been studied in the presence of darpa suboff submarine model by chase et al chase and carrica 2013 the numerical analyses have been made by employing delayed detached eddy simulation ddes approach the results have been compared with different turbulence models using four grids and three time steps for one advance coefficient the results showed that the present approach is applicable in self propulsion performance prediction of submarines zhang et al zhang and zhang 2014 have carried out a study involving the interaction between propeller and a submarine hull the analyses have been made by taking the free surface effects into account the results showed a good agreement with the experiments it has been highlighted that the free surface has significant effect on total resistance budak et al have investigated the effect of bow and stern geometries on resistance of bared darpa suboff via cfd method budak and beji 2016 in another study delen et al delen et al 2017 have investigated the hull propeller interaction of darpa suboff vehicle using body force method hydrodynamic performance of darpa suboff has been estimated both numerically and empirically the numerical results are more accurate than those of empirical method when compared with the experimental data in this study open water performance of e1619 model propeller and resistance of darpa suboff aff 1 and aff 8 forms have been predicted using computational fluid dynamics cfd method aff 1 is the bare form while aff 8 has the appendages including the sail and rudder fins verification and validation studies have been conducted for both open water propeller analyses and resistance analyses to determine the optimum grid number the self propulsion point of the submarine has been found where the propeller thrust is equal to the submarine total resistance two techniques have been employed for self propulsion performance prediction i the body force method and ii the model propeller itself modeled behind the submarine hull moving reference frame mrf method has been used for open water and self propulsion analyses the mrf method for the submarine might work as long as there are no objects in the propeller wake ponkratov and zegos 2015 the self propulsion performance has been computed by thrust identity method a detailed wake survey has also been done numerically and the results have been compared with available experimental and numerical data 2 theoretical background 2 1 mathematical formulation the governing equations are the continuity equation and the rans equations for the unsteady three dimensional incompressible flow the continuity can be given as 1 u i x i 0 velocity u can be decomposed into mean velocity part and fluctuating velocity part respectively 2 u i u i u i the momentum equations are expressed as 3 u t u i u j x j 1 ρ p x i x j ν u i x j u j x i u i u j x j in this study because all analyses have been run in steady state the first term has not been taken into account in momentum equations u i states the mean velocity while u i states the fluctuation velocity components in the direction of the cartesian coordinate x i p expresses the mean pressure ρ the density and ν the kinematic viscosity of the fluid the k ε turbulence model is applied in order to simulate the turbulent flow around the submarine precisely this turbulence model is applicable when there are no high pressure changes along the hull and separation on and or near the hull in this case k ε turbulence model is used because the vessel is submerged and there are no free surface effects during the analyses reynolds stress tensor is calculated as follow 4 u i u j ν t u i x j u j x i 2 3 δ i j k here ν t is the eddy viscosity and expressed as ν t c μ k 2 ε while c μ is an empirical constant c μ 0 09 k is the turbulent kinetic energy and ε is the turbulent dissipation rate in addition to the continuity and momentum equations two transport equations are solved for k and ε 5 k t k u j x j x j ν ν t σ k k x j p k ε 6 ε t k u j x j x j ν ν t σ ε ε x j c ε 1 p k ε k c ε 2 ε 2 k further explanations for the k ε turbulence model may be found in wilcox 2006 2 2 uncertainty assessment in this study uncertainty assessment has been carried out via grid convergence index gci as recommended in the ittc procedure for cfd verification ittc 2011a this method firstly was proposed by roache 1998 and then improved with different other studies the procedure implemented in this study has briefly been explained below celik et al 2008 let h1 h2 and h3 are grid lengths and h 1 h 2 h 3 the refinement factors are as follows 7 r 21 h 2 h 1 r 32 h 3 h 2 refinement factors should be greater than 1 3 in accordance with the experiments celik et al 2008 grid lengths refinement has been selected as 2 as in the studies of tezdogan et al 2015 and ozdemir et al 2016 because of the mesh algorithm grid number has been taken into account during the calculation of the refinement factors this choice is crucial in uncertainty analyses especially for unstructured mesh system therefore these values have been differentiated 8 r 21 n 1 n 2 1 3 r 32 n 2 n 3 1 3 difference between generated grid numbers can be calculated as below 9 ε 21 x 2 x 1 ε 32 x 3 x 2 at this point convergence condition r can be examined as 10 r ε 21 ε 32 the solution has an oscillating convergence when 1 r 0 while the solution is monotonically convergent if 0 r 1 3 numerical method 3 1 grid structure and boundary conditions the computational domain has been selected to be adequate in dimensions to simulate the ship flow properly for resistance and self propulsion analyses which is identical to the recommended dimensions of ittc guideline ittc 2011b fig 1 shows the main dimensions of the computational domain and the boundary conditions applied on the surfaces in order to have proper cfd analyses the initial and boundary conditions should be defined carefully depending on the flow problem correct boundary conditions lead the analysis to accurate results and prevent the unnecessary computational costs also the boundary conditions should be chosen to ensure that they have no influence on the numerical solution date and turnock 1999 the right side of the computational domain is defined as velocity inlet and the left side is defined as pressure outlet fig 1 the submarine boundary is to be taken as no slip wall which indicates that the velocity components and the total velocity are zero on the hull surface the propeller blades are also set to be wall with no slip condition in addition the surrounding surfaces are defined as symmetrical ones in order to establish a numerical towing tank more detailed information on boundary conditions can be obtained from the theory guide of the commercial cfd software star ccm documentation 2015 the computational domain is discretized by three dimensional finite volumes in compliance with finite volume method for resistance analyses proper mesh structure has been created around the submarine hull using hexahedral elements in order to create the control volume to be solved trimmer meshing is employed the trimmer meshing algorithm provides a fully hexahedral mesh structure avoiding the tetrahedral elements the computational domain is represented by hexahedral elements while finer elements are employed on the submarine surface a finer mesh is also employed near the stern region in order to well capture the interaction between the propeller and the submarine hull a mesh refinement is made in the bow region to capture the flow details as well unstructured mesh around the submarine is given in figs 2 and 3 mesh size of the hull surface and the growth rate is adjusted in order to keep wall y values in an acceptable range 30 300 average wall y value of the submarine hull is between 60 and 175 for all velocities fig 4 shows the computational domain with the assigned boundary conditions on the surfaces of propeller working in open water condition the left side of the computational domain is defined as pressure outlet while the right side is to be velocity inlet fig 4 the propeller blades and the shaft are considered as no slip wall that indicates that the velocity components hence total velocity are zero on the propeller blades the surrounding surfaces are defined as symmetrical ones in this study single phase analyses are carried out without taking free surface effects into account by simulating the flow around the submarine hull with or without the appendages for open water propeller and propulsion both actuator disc and self propelled cases analyses hexahedral mesh structure has been employed using trimmer mesh algorithm also a fine mesh region has been created around the propeller disc in order to model the interaction of the hull and the propeller more accurately fig 5 shows the fine mesh applied on the e1619 model propeller blades in both open water and self propelled cases average wall y value of the propeller blade in open water condition is between 90 and 115 for all advance coefficients 3 2 solution strategy k ε turbulence model is used in the numerical analyses which has been extensively used for industrial applications star ccm documentation 2015 also querard et al have stated that the k ε model is quite economical in terms of cpu time when compared to the sst turbulence model which increases the required cpu time by nearly 25 quérard et al 2008 the k ε turbulence model has also been used in many other studies performed in the same area such as tezdogan et al 2015 kim and lee 2011 enger et al 2010 ozdemir et al ozdemir et al 2016 2014 the pressure field is solved by using simple algorithm which is based on pressure velocity coupling simple is a commonly used algorithm for calculating pressure and velocity fields in an iterative manner especially for steady state analyses it reduces the computational time quickly versteeg and malalasekera 2007 all governing equations are discretized using a cell based finite volume method and the advection terms are discretized with a first order upwind interpolation scheme because of the flow characteristics the analyses have been made via single phase assumption free surface effects are not taken into account either in resistance or propulsion analyses viscous effects near the submarine are taken into account by modelling the boundary layer with an appropriate grid structure keeping wall y values of the hull in a reasonable range 30 300 barlas 2000 rotational flow analyses have been done using moving reference frame mrf technique for open water and self propulsion analyses with propeller by this technique the governing equations are transformed into a rotating frame to get a steady state solution moussa 2014 for self propulsion analyses an actuator disc has first been modeled using body force theorem distribution of body forces has been applied in this actuator disc region here actuator disc region represents an infinite number of blades of propeller the hydrodynamic performance characteristics of model propeller have been defined in this region the actuator disc and the model propeller have the same diameter and identical distributions of elemental thrust along the radius krasilnikov 2013 4 verification and validation in this study three different grid sizes have been used as given in table 1 for resistance and open water propeller analyses in the table aff 1 is the bare submarine form and aff 8 is the submarine with appendages including the sail and rudder fins detailed information of the submarine geometries can be found in the following section 5 1 according to wilson et al 2001 the most important source of uncertainty of the numerical results is coming from grid different grid numbers have been used for modelling the computational domain for resistance and propulsion analyses after verification and validation study the optimum grid number has been implemented for the rest of the analyses including actuator disc and self propulsion cases for different velocities as given in table 1 computational domain has been created with different grid numbers for uncertainty analyses one may see that the grid number increases for aff 8 because of the appendages and local mesh refinements around the appendages the free stream velocity has been considered as 3 046 m s for aff 1 and 3 051 for aff 8 during the uncertainty analyses advance coefficient j is taken as 0 4625 in open water propeller analyses in this study convergence condition r is calculated as 0 244 for aff 1 which means that the solution is converged monotonically for aff 8 r is calculated as 0 649 which means that the solution has an oscillating convergence detailed information about grid convergence index gci can be found in the study of roache 1998 table 2 presents the uncertainty values of resistance analyses and open water analyses the uncertainty percentage is higher for the appended submarine hull than that of bare hull the appendages on the geometry make the problem more complex which results in a higher uncertainty the numerical results are also compared with the experimental results in order to validate the numerical method as given in table 3 the numerical results are of the optimum grid number the uncertainty analyses have been made for resistance analyses for total ship resistance while it has been carried out for open water test for thrust fine mesh algorithm has been chosen as the optimum one for resistance analyses while medium grid has been selected the optimum one for open water propeller analyses attention has been paid in order to validate the numerical method with the experiments the optimum grid number has been obtained and the analyses have been validated with the available experimental data the rest of the analyses have been performed using the optimum grid numbers for resistance open water actuator disc and self propulsion analyses 5 results and discussions in this section the flow is simulated around darpa suboff geometry for bare and appended hulls using the optimum grid number found after verification and validation processes in addition open water flow analyses have been carried out for e1619 model propeller following the resistance and open water analyses self propulsion tests have been done by two different methods first the open water propeller results have been coupled with rans solver using body force propeller method this method assumes an actuator disc behind the hull to represent the propeller second self propulsion tests have been conducted by modeling the propeller itself behind the hull for both methods the self propulsion points have been determined for different velocities these two methods have been compared by means of self propulsion characteristics the positive and negative features of these methods have been discussed 5 1 geometrical dimensions darpa suboff is a widely used benchmark form the 3 d geometry of the submarine is shown in fig 6 geometrical features of the submarine are also given in table 4 the submarine models used in this study are entitled as aff 1 for bare form and aff 8 for appended form groves et al 1989 table 5 and fig 7 show the main particulars of the benchmark propeller e1619 and 3 d geometry respectively as can be seen from fig 7 the propeller has a highly skewed form 5 2 resistance analyses total resistance of the model submarine darpa suboff has been computed by cfd for bare hull aff 1 and for appended hull aff 8 the resistance analyses have been carried out for different velocities and all numerical results have been compared with the experimental data given in liu and huang 1998 it is also found that the effect of the appendages on total resistance can be predicted precisely by cfd method figs 8 and 9 show total resistance of darpa suboff aff 1 and aff 8 for different velocities respectively one can see that the numerical results are in a good agreement with the experiments for both cases tables 6 and 7 also show the relative error between the numerical and experimental results both for aff 1 and aff 8 in addition a validation study has been made for darpa suboff aff 8 in terms of non dimensional pressure and skin friction coefficients at reynolds number of 1 4 107 both non dimensional parameters have been compared with those of another numerical study yang and löhner 2003 and experimental study huang and liu 1994 liu and huang 1998 toxopeus 2008 available in the literature for v 3 34 m s these parameters have been calculated along the submarine surface figs 10 and 11 show clearly that the non dimensional pressure distribution by the present cfd study is well matched with other numerical and experimental results although there are some discrepancies for the skin friction coefficients between the experiments and present cfd methodology for x l 0 9 the overall skin friction coefficients of present cfd are closer to experiments the non dimensional pressure coefficient and skin friction coefficients are computed by the following equations 11 c p p 0 p ρ u 2 12 c f τ w ρ u 2 averaged values of axial velocity on different locations behind the submarine have also been computed fig 12 shows the locations behind submarine for bare and appended forms the nearest location to the submarine is the propeller plane at this location x l 0 978 average velocity distribution in the axial direction can be used to derive the nominal wake coefficient as can be seen from fig 12 the axial velocity increases in far downstream location and finally it becomes almost equal to the freestream velocity v 2 75 m s the effects of appendages can be seen in the velocity distributions especially in the propeller plane fig 13 shows the comparison of present numerical results with experimental and another numerical results available in the literature for v 2 75 m s by wake profiles both experimental and numerical results show the effect of the appendages clearly k w sst urans results of bhushan et al 2013 does not give the v shaped carving as seen in the experimental results although the present study based on rans method produces a similar shape the sail of the submarine causes this v shape in velocity distribution the wake of the sail accelerates the flow slightly in the propeller plane on the other hand both numerical results of sst urans and present rans give similar results near the trailing edges of the fins appended on the submarine stern the differences between experimental results and numerical results of bhushan et al 2013 and of present study are due to the hub diameter the hub diameter ratio in experimental study has not been explained clearly in this study the hub diameter ratio is considered as 0 226 as given in bhushan et al 2013 a detailed comparison of present numerical results with those of experiments chase 2012 for v 2 75 m s can be seen in figs 14 16 more clearly the effect of appendages can also be seen clearly it can be noted that the appendages affect the velocity distribution significantly on the propeller plane while there is a symmetrical velocity distribution for bare form far away in the downstream direction from the submarine the effect on the velocity values due to appendages are decreasing 5 3 analyses of propeller in open water propeller analyses in open water have been carried out by cfd method the optimum grid number has first been determined for open water analyses e1619 model propeller has then been validated with the experimental data provided by insean in fig 17 it has been found that for j numbers higher than 0 6 j 0 6 the deviation between cfd and experimental results is increasing on the other hand the agreement of efficiency is acceptable except for j 1 5 4 self propulsion analyses with body force method the self propulsion points have been found by searching the velocities at which the propeller thrust overcomes the submarine total resistance during the computations the thrust identity method has been used the thrust and torque coefficients have been calculated from thrust and torque values obtained from self propulsion analyses in order to obtain the advance coefficient at the self propulsion point of the submarine thrust coefficient value has been used in open water curve self propulsion points have been computed for both bare hull and appended hull without modeling the actual propeller behind the submarine for different velocities instead body force method has been applied and open water performance characteristics of e1619 model propeller has been used on the actuator disc as expected the appended form causes an increase in revolution rate for the same speed as compared with that of bare hull form fig 18 shows the self propulsion points of darpa suboff with actuator disc for a range of velocities 5 5 self propulsion analyses with model propeller the self propulsion analyses with model propeller is similar to that of body force method the self propulsion points have also been found by searching the velocities at which the propeller thrust overcomes the submarine total resistance during the computations the thrust identity method has been used self propulsion analyses of darpa suboff with e1619 model propeller have been carried out for bare hull and appended hull e1619 model propeller has also been modeled behind the submarine within a rotating region fig 19 shows the self propulsion points of darpa suboff with model propeller at different velocities 5 6 characteristics of self propulsion the self propulsion interaction between hull and propeller characteristics of a bare form is briefly described below ittc 1978 the nominal wake coefficient here is calculated as follow 13 w 1 v a v s here va is the average flow velocity in the propeller plane vs is the submarine velocity or incoming flow velocity towards the stationary hull va is calculated using 14 j v a n d here j is the advance coefficient d is the propeller diameter and n is the propeller rotation speed the thrust deduction factor on the other hand can be calculated by 15 t 1 r t t non dimensional thrust and torque coefficients of the propeller can be derived with the equations given below here t is the thrust force and q is the torque value 16 k t t ρ n 2 d 4 17 k q q ρ n 2 d 5 the hull efficiency is the ratio of effective power to propeller thrust power it can be expressed as follows 18 η h 1 t 1 w the relative rotation efficiency is the ratio of the open water propeller torque to the torque of the propeller working behind the hull 19 η r q o q the open water propeller efficiency is calculated by the following equation 20 η o t v a 2 π n q o the propulsion efficiency can then be expressed as follows 21 η d η h η o η r effective power is the power required to pull the hull at constant speed vs 22 p e r t v s the power delivered to the propeller is then calculated as 23 p d p e η d thrust loading factor in momentum theory can be computed as below 24 c t h t ρ v a 2 d 2 π 8 the ideal efficiency of propeller in momentum theory can be expressed as below bertram 2014 25 η i 2 1 1 c t h tables 6 8 show the self propulsion characteristics of darpa suboff with body force method and e1619 model propeller during the calculations thrust identity method has been used the thrust and torque coefficients have been calculated from thrust and torque values gained from self propulsion analyses in order to obtain the advance coefficient at the self propulsion point of the submarine thrust coefficient has been entered in open water curve owc and corresponding advance coefficient has been obtained here experimental and numerical owc can be used in this study experimental owc has been used in order to calculate advance coefficient in the self propulsion point however a comparison of numerical and experimental owc is given in table 8 for aff 8 at v 2 75 m s the results have also been compared with those of chase 2012 the results of both owc methods are quite promising the difference in cfd owc between present study and chase 2012 is because the relative difference between numerical and experimental results in open water performance characteristics of e1619 model propeller in the present study although the open water propeller efficiencies are different propulsive efficiency and delivered power values have been computed as equal this is due to the hull efficiency and the relative rotative efficiency values 6 conclusions a comprehensive study has been done using cfd method in order to predict self propulsion performance of darpa suboff aff 1 and aff 8 forms open water analyses have been carried out for e1619 submarine propeller total resistance of the submarine bare and appended forms have been computed at different velocities the numerical analyses have been done using the optimum grid number determined by verification and validation processes the results non dimensional pressure and skin friction coefficients are in good agreement with the experimental data and other numerical result a detailed wake survey has been done for bare and appended forms of darpa suboff the results have been compared with available experimental and numerical results and it has been found that the results are matching well with each other self propulsion performance analyses have been carried out at different velocities using body force method and by modeling the propeller itself behind the submarine self propulsion points of the submarine aff 1 and aff 8 forms have been predicted numerically for one velocity self propulsion characteristics of aff 8 have been compared with the study of chase 2012 thrust identity method applied here has been found satisfying for both experimental and numerical open water curves finally body force method and self propelled case have been compared with each other in terms of self propulsion characteristics body force method has estimated lower propulsive efficiency and higher delivered power as compared with the self propelled case it is found that the hull efficiency is higher in self propelled case this can be due to positive propeller hull interaction acknowledgement the authors wish to thank mr francesco salvatore and insean for their support in providing the 3 d geometry of the propeller e1619 and open water experimental data for use in our academic researches the authors also thank mr emre kahramanoglu for his valuable help throughout this study nomenclature u i mean velocity ui fluctuation velocity component p mean pressure ρ fluid density k turbulent kinetic energy ε turbulent dissipation rate rt ship total resistance loa length overall lbp length between perpendiculars dmax submarine maximum diameter s submarine wetted surface area submarine displacement d propeller diameter p d propeller pitch ratio z number of blades ae a0 propeller blade expansion ratio c p non dimensional pressure coefficient c f non dimensional skin friction coefficient τ w wall shear stress w nominal wake coefficient va the mean flow velocity at the propeller plane vs incoming flow velocity n propeller rotation speed j advance ratio t thrust deduction factor t propeller thrust force q propeller torque kt non dimensional thrust coefficient kq non dimensional torque coefficient η h hull efficiency η r relative rotation efficiency η o open water propeller efficiency η d propulsion efficiency pe effective power pd delivered power c t h thrust loading factor η i ideal efficiency of the propeller 
23638,a numerical model for the determination of the deformed shape of nets fixed in a stiff frame is presented the tension element method is able to predict the steady state solution of a net in a prescribed flow under consideration of hydrodynamic loads and elastic twines it is based on a discretisation of the net in mass points connected with straight bars the successive approximation is applied to the system which leads to a significant reduction of the resulting system size in comparison to the matrix of a newton raphson method this is caused by the ability to solve the system for unit bar vectors and not for knots thus the inverse can be calculated faster and more stable so far the advantage of high accuracy and physical comprehensibility by taking geometrical constraints into account is balanced by the difficulties in defining the essential directions of unit vectors properly the new implementation provides this information using an efficient technique which is adapted from finite volume methods measurements are provided in order to validated the method at the end of this paper a comparison shows the principal working of the code as well as the high accuracy of the method for steady state problems keywords numerical simulation net structure tension element method efficient implementation 1 introduction in the course of improving complex calculations by an accelerated growth of the available computational resources the question about the cost benefit ratio is often neglected coupled simulations of the flow and deformation of flexible structures in the application of ocean engineering as mooring systems and nets using high level computational fluid dynamics cfd techniques provide steady improved results but are still computationally intensive recently yao et al 2016 state the deviation of their cfd simulations for the flow around a net cage to experiments as 5 even though this is an appropriate result the method is not suitable for practical design processes here the fluid structure interaction is commonly neglected which results in the task of calculating the deformation of the structure from the inflow condition the steady state solution is furthermore sufficient in most cases for which reasons accelerations can be neglected the underlying system of equations is highly non linear even for single ropes hence analytical solutions such as the catenary can just be found under particular conditions for more complex systems such as nets it is reasonable to calculate the solution using a numerical approach different approaches exist for the discretisation of the physical models tronstad 2000 and lader and fredheim 2001 introduced a finite element method fem applying super elements for describing aquaculture cages which was generalized by priour 1999 using triangular elements both approaches are elaborated just for nets so they were not applied to ropes or complemented by mooring systems yet alternatively analogous models consisting of truss or spring elements were developed by marichal 2003 fredheim 2005 huang et al 2006 and zhao et al 2007 the physical model is represented by mass points which are connected through massless elastic bars hence the discretised model may consist of physically existing elements which is in contrast to fem approaches a system of equations is generated from force equilibria at each mass knot and the solution is found for the knot positions even though these methods show accurate results for dynamic and static problems they lack a mechanism to prevent unphysical correlation of tension forces and twine deformations at this point the tension element method tem of leitzke 1983 presents a suitable alternative because it incorporates this correlation by including geometrical constraints these are formulated using the necessary connection of the meshes at any time despite this tem is also based on a discretisation in a finite number of mass points which are connected by straight but elastic bars and is suitable for different physical systems such as ropes or nets as it will be derived later the solution matrix of the system of equations contains the unit vectors of the bars this simplifies the interpretation of both the theoretical approach and the evaluation of the physical results because the length of the bars tension forces in the bars and the displacement of the knots are direct solutions of the calculations paschen et al 2004 further the system can be solved by applying successive approximation here the unknowns are separated and the system is corrected iteratively using the intermediate results until convergence has been reached leitzke 1983 shows the conversion of the system for using a newton raphson method which is though more expensive in runtime it is caused by an increase of the matrix size because all unknowns have to be written into the solution vector instead of splitting them so far tem is limited to steady state cases but a principal approach of unsteady deformations is provided by leitzke 1983 as well the mathematical basis at least for inductile ropes is proven by hackmann 1982 1983 previous attempts to implement tem in an efficient manner were provided by niedzwiedz and hopp 1998 their implementation was not described in detail and lack a large number of meshes at which they showed the principal working of the method for complicated physical systems therefore this work aims at the derivation of an efficient implementation of tem for nets under consideration of recent developments in cfd and a validation using measurements of deformed nets with a laser rangefinder the following assumptions are taken into account in accordance to the theory of tem the relative acceleration between structure and surrounding fluid equals zero resulting in a steady state solution the fluid is infinite expanded homogeneous viscous and incompressible bars are mounted moment free and the structure is ideal flexible at the knots respectively acting forces are hydrodynamic gravity and tension forces all forces on the bars are concentrated on the corresponding knots for the sake of simplicity the hydrodynamic forces at knots are neglected which correlates to small relations between knot and bar diameter fluid structure interaction is neglected so the inflow is not distorted by the structure corresponding relations of the net are identified by koritzky 1974 and respected in the later calculations in section 2 the numerical method is presented here the determination of the forces the derivation of the system of equations and the solution procedure using successive approximation are described in detail afterwards the detailed implementation is discussed in section 3 section 4 is dedicated to the experimental validation of the method for this purpose different weights are connected to the net in a static fluid resulting in different net shapes which are compared to measurements finally a conclusion can be found in section 5 2 numerical approach the numerical approach of the tension element method is presented for nets it is fixed to a stiff frame as boundary condition an extension to arbitrary supports can be reached in a similar way analogously easier structures as ropes can be modelled too interested readers are referred to leitzke 1983 for further details on this topic we assume a frame of length l and breadth b forming a plane in an arbitrary direction of an inertial cartesian reference system with z pointing upwards the frame does not have to be planar as it is shown in the calculations below but provides a more convenient description the discretised net is represented by a finite number of massless bars with length a and a corresponding number of mass points knots p where all acting forces are concentrated these are the gravity force f g and a hydrodynamic force f h arising from the relative motion between structure and surrounding fluid further no moments occur at the knots since a flexible system is assumed the inner tension forces with magnitude f t act at p in the direction of the adjacent bars denoted by the unit vectors f an exemplary discretisation is shown in fig 1 the elasticity of the material can additionally be respected by replacing a by a functional of tension forces leitzke 1983 states that the linear dependency of hook s law is not sufficient for textile nets instead he proposes polynomials of higher order such as 1 a k 1 a k ε 1 ε 2 f t k ε 3 f t k 2 here ε i i 1 2 3 are constants which depend on the material and type of the net and k represents the later artificial time stepping in the following this indication shall be omitted for the sake of clarity all properties have to be updated in each iterative step as it is also described below 2 1 external forces the mass of the bars are distributed uniformly on the bordered knots which results in an approximated gravity force f g ν at any knot p ν according to 2 f g ν q g μ 1 n b a μ 2 with n b the number of bars connected to p ν q the specific material weight per length in the fluid and g an unit vector pointing in negative z direction under consideration of the assumptions in section 1 the hydrodynamic force acting on a bar μ in one of the global directions i can be written as the partial sum of hydrodynamic drag lift and shear forces 3 f h i μ ρ 2 v μ 2 d μ a μ c d μ e d i μ c q μ e q i μ c l μ e l i μ i 1 2 3 with ρ the density of the fluid v the relative velocity vector between fluid and structure and d the thickness of the bar the coefficients c d c l and c q depend on the roughness of the material the reynolds number and the local angle of attack θ in order to obtain these coefficients a local reference system whose axes are the unit vectors e d e l and e q is defined the directions are calculated from the bar unit vector f as 4 θ μ arccos e v μ f μ with the local velocity unit vector e v 5 e v μ v μ v μ the unit vector e d represents the direction of the drag which points towards the local velocity vector 6 e d μ e v μ the direction of the shear force is calculated from the cross product of the directions of local velocity and bar unit vector 7 e q i μ ϕ i μ ϕ j μ ϕ j μ i j 1 2 3 8 ϕ i μ ε i j k f j μ e v k μ i j k 1 2 3 with ε i j k the levi civita symbol in 7 the summation notation of einstein is applied finally the hydrodynamic lift force acts in the resulting direction from the shear and drag forces which yields equation 9 in einstein s notation 9 e l i μ ψ i μ ψ j μ ψ j μ i j 1 2 3 10 ψ i μ δ i l δ j m δ i m δ j l e v j μ e v m μ f l μ i j l m 1 2 3 for practical calculations the values of the coefficients can be provided from experiments as polynomials depending on θ since the dependency on reynolds number is small in typical applications stengel and fridman 1977 simple analytical determinations of the coefficients are based on morison s equation see e g moe et al 2010 whereas kristiansen and faltinsen 2012 showed superior results of their screen type force model in case of highly deformed nets 2 2 derivation of the resulting system of equations the solution of the calculation should particularly be the steady state shape of the net and the distribution of tension forces in the bars both properties relate to the unknown bar unit vectors since the frame is fixed the sought properties are the directions of inner bar unit vectors f μ the magnitude of the tension forces in these directions f t μ the length of the bars a μ and the hydrodynamic forces hence an iterative method has to be considered for solving this problem the system of equations is filled using force equilibria for inner knots and geometrical constraints viz geometrical connections for inner and edge meshes assuming time independence and negligence of interactions between different bars and knots a static equation of force equilibrium yields for each inner knot of the net p ν see also fig 2 11 μ 1 n b f μ f t μ 1 2 f h μ f g ν 0 ν 1 n k with n k the number of inner knots and the forces defined above see 2 and 3 it is only considered one half of the hydrodynamic forces for a smooth distribution on the net correlating to the chosen distribution of f g as can be seen from 3 f h just depends on f for which reason it can be taken as a known force in each iterative step a proper rearrangement of 11 then results in 12 μ 1 n b f μ f t μ μ 1 n b 1 2 f h μ f g ν ν 1 n k the number of bars exceeds the number of knots in general thus the system is undetermined and has to be closed by adding geometrical constraints these equations accomplish the coherence of the net during the deformation in a physical way they are determined by considering a closed string of four bars and knots in case of inner meshes resulting in see also fig 3 13 τ 1 4 f τ a τ 0 with f τ the unit vectors of the bars of mesh τ by definition the summand is taken positive if f τ points clockwise in contrast a mesh near the frame consist of three bars and three knots at which the bar on the frame is known the modified equation 13 reads then compare fig 4 14 τ 1 2 f τ a τ β with β the vector between two neighboured knots on the frame assuming a constant a in the initial position β can be determined from the overall length of the net in longitudinal and transversal direction and the known number of meshes in these directions in general the model provides a spillover of mesh equations for which reason it has to be paid attention to preserve the uniqueness of the system s solution the resulting linear system of equations can be written in an appropriate way for obtaining the matrix of unit bar vectors ℱ using 12 13 and 14 as 15 a ℱ ℬ with a containing the sub matrices of unknown tension forces t and the lengths of the bars ℒ 16 a t ℒ on the right hand side ℬ yields 17 ℬ ℋ g r with ℋ and g the sub matrices of hydrodynamic and static forces r is filled with zeros in case of inner mesh equations and with the known frame vectors β else a is a square matrix with the size of the unknown bar unit vectors n b whereas ℱ and ℬ are matrices of size 3 n b taking the net of fig 1 as an example the system matrix reduces from 123 123 to 100 100 due to the transition from the newton raphson method to the successive approximation it yields a significant reduction of runtime under consideration of multiple inversions 2 3 solving the system of equations using successive approximation in system 15 both a and ℬ depend on the solution matrix ℱ therefore appropriate initial values have to be chosen for the tension forces and bar unit vectors afterwards the hydrodynamic force matrix h can be initialised using 3 and 1 yields the initial lengths of the bars the solution of 15 at any iterative step k results as 18 ℱ k a k 1 1 ℬ k 1 however the lengths of bar vectors have to equal one by definition at the end of each step 19 l ℱ k 1 this cannot be guaranteed by 18 for which reason a correction step according to 20 f μ k f μ k f μ k μ 1 n b has to be performed before the loop proceeds in order to conserve consistency the columns of a have to be multiplied by the euclidean norm of the corresponding line of ℱ k as a matter of course geometrical constraints are excluded from this correction the next step k 1 can then be calculated by correcting the bar lengths in a using 1 determining ℬ using ℱ k and 18 typically convergence of ℬ can be achieved after few iterations while the convergence of the tension forces takes some more steps the algorithm stops in case of reaching a predefined criterion for the residuals of the norm such as 21 l ℱ k 1 κ which corresponds to the conservation of all bar unit vectors within the tolerance κ as indicated above the method of successive approximation with correction of the unit vectors gives the opportunity to interpret the solution process physically if the unit vector of any bar is stretched by the assumed acting forces the correction 20 reduces the length again which corresponds to an increase of tension forces this increase is respected by the additional correction step in a taking this explanation into account the tem offers an elegant way of solving the relation between tension forces and net deformation accurately which makes it highly suitable for practical purposes in industrial applications 3 remarks regarding an efficient implementation the described method of calculating the dynamics of flexible systems in the application of ocean engineering was up to now limited by the inefficient determination of the direction of f in order to improve the method an efficient implementation with an automatic discretisation of the physical model will be presented it is achieved in analogy to the mesh handling of unstructured grids which is typically known from finite volume methods see e g jasak 1996 there the fluxes of the flow have to be evaluated at the faces of each cell as initial condition the field values are known in the two connected cells of each face the aim is to find a suitable value at the face from these known values using any kind of interpolation the most efficient way of calculation is clearly iterating through the faces and not through the cells because it would have to be stored all neighbours of each cell for the latter list in comparison it just needs to store the two adjacent cells if face lists are considered these face lists are then divided in an array of so called owners and neighbours since the direction of the face represented by a face normal vector has to be clarified on an unstructured grid hence it is assumed that this vector always points from the owner to the neighbour cell this has to be executed just once in preprocessing in order to adapt this idea to our method we just have to define the knots as cells and the face normal vectors as the unit bar vectors in doing so we can easily find the knot ids and the direction of the vectors which is necessary for assembling the mesh equations see also fig 5 the following description is at first limited to the case of rigid bars and missing hydrodynamic loads in order to explain the principal procedure the necessary modifications for including these features are given at the end of this section as a starting point the dimensions of the net and the number of meshes in the longitudinal n l and transversal direction n t are given from input data as described in section 2 the calculation of the acting forces needs information about velocity and density of the fluid as well as length and diameter of the bars in case of a skewed frame the angles of the frame in the inertial reference system have to be predefined it has to be ensured that the angle of attack between structure and fluid is in a range where no flow around the structure appears if the angle between net and fluid is larger than some critical angle lift forces arise from the fluid flow around the frame see koritzky 1974 for further details based on these information the number of inner bars n b can be evaluated as follows 22 n b 2 n l 2 n t 4 n l n t corresponding to the number of unknown the number of known frame vectors n β is given by 23 n β 2 n l 2 n t which equals the number of frame mesh equations the number of inner knots n k and the number of force equilibrium equations respectively is calculated as 24 n k n l n t n t 1 n l 1 finally the number of knots on the frame n f results from 25 2 n l 1 2 n t 1 as a next step all knots are indicated by an unique id together with the information of their position inner or outer knot afterwards the owner and neighbour lists for evaluating the direction of bar unit vectors can be prepared in order to guarantee an unique assignment both lists have the size of the unknown calculated from 22 we propose to start with a transformation of the net to a skewed grid in a principal plane with unit distances between the knots as can be seen in fig 6 it evolves from shifting each second y row of knots in negative y direction in this shape the grid consists of straight rows with unit distances in x direction which can then be utilized for the initialisation of inner bars all bars along the x direction can be directly defined by searching for the knot id with the necessary coordinates in the transformed grid thus no special id assignment has to be existing in a similar way the diagonal bars and frame vectors can be found afterwards the knots on the frame are transformed back into the physical coordinates of the frame and for the inner knots reasonable initial position are chosen the resulting discretised model is shown in fig 1 the initial coordinates of the inner knots are not critical since the convergence of the numerical approach is usually reached irrespectively to the chosen positions in order to add the force equilibria to the system of equations the owner and neighbour lists are scanned for the id of each inner knot if any bar has the considered knot as its owner the corresponding entry in a is a positive initial force analogously if the knot is the neighbour of the bar the entry consists of a negative initial force the initial values should be near the final tension forces for reaching a fast convergence but can also be assumed as 1 n if a priori unknown due to the robustness of the solution algorithm after the four involved bars are indicated the corresponding line in ℬ has to be filled with the gravity and initial hydrodynamic forces afterwards the geometric equations for outer meshes have to be determined which will be exemplary presented for the mesh in fig 4 considering any frame vector β with its owner knot p 3 and its neighbour knot p 1 two adjacent inner bars exist which form a closed mesh together with β in case of fig 4 f 1 and f 2 these bars are indicated from the owner and neighbour lists as before the distinction between the necessary bar and other inner bars connected to the knot could be accomplished by comparing the second knot id which is connected to the bar this id has to be the same for both involved bars finally inner geometric equations are added to the system until the necessary number of equations is reached we propose an iterative search for inner meshes starting from any inner knot which has already been used for the definition of the outer meshes in fig 7 a typical situation of the algorithm is shown we assume that the yellow knot represents the initial knot of the current iteration first all neighbour knots are indicated using the connection via the owner and neighbour lists red bars and knots and stored in a separate list l 1 for each member of l 1 the same indication is repeated at which the initial knot will be skipped this leads to the blue knots in fig 7 which are stored in another list l 2 together with the information of the related red knot in a list l 2 l 2 contains at least one knot id twice which corresponds to a potential new inner mesh thus l 2 should be compared component wise to find all twin id s a new inner mesh can then be found by considering a twin id the related knots from l 1 which are known through l 2 and the initial yellow knot the directions of the bars within this mesh are found from the owner neighbour lists as described above since this procedure does not automatically exclude existing meshes an additional check has to be performed in order to avoid linear dependency of a after all inner meshes of the current iteration are found the next iteration can be started with the blue knots which are not represented twice in l 2 as the new initial knots in fig 7 this corresponds to the green knots once the system is complete the converged solution of the system of equations can be attended as described in section 2 and an appropriate solution algorithm such as gaussian elimination with pivoting the deformed net can be visualised from the known directions of f and length of the bars a an exemplary result of a calculation can be found in fig 8 in case of a significant difference of the velocity between structure and fluid hydrodynamic forces should be included it results in a non constant right hand side for the force equilibria equations which therefore has to be updated after each iteration using the corrected unit vectors f the advantageous structure of a which is characterised by all lines are filled with zeros except of the entries of the involved bars simplifies the recalculation of ℬ after f h is calculated for all bars using 3 one half of the values from bars with a non zero entry in a line in a can be added to the same line in ℬ according to 12 in a similar way the elongation of the bars is updated each column of a contains in one of the first n k lines the current tension force of the corresponding bar and below the current length of it taking these two non zero entries into account the new bar length is simple calculated from 1 4 experimental validation a detailed description of a modern implementation of the tension element method is given in the last section in the following the implementation of the code using the open source project gnu octave is validated by a comparison to measurements from the laboratory of the chair of ocean engineering the considered case is restricted to a deformed net in a fixed frame in a static fluid thus high quality measurements are ensured for the comparison and the potential errors of inaccurate hydrodynamic force coefficients are excluded the experimental setup consists of a net firmly clamped in a rigid frame of 556 m m 520 m m the considered net is made of knotted nylon filaments with a diameter of d 2 1 m m and a mesh size of a 22 m m compare fig 9 and has a weight of 0 493 k g m 2 the meshes are rotated by 45 in the frame resulting in a half mesh opening angle γ 45 a laser rangefinder which is used for sampling the deformations properly is fixed to a traverse above the structure the traverse moves with a constant velocity of 0 04 m s in preset paths along the x and y axis in intervals of 50 m m at the same time the rangefinder measures the distance to the net in z direction with a sampling rate of 0 001 s considering the known velocity and path of the traverse the net deformation is evaluated using the z deflections of the sampling signal an exemplary result from this procedure can be found in fig 10 three configurations which are generated by adding different weights to the net are compared all weights and their locations in the net can be found in table 1 the validation is mainly performed by comparing contour plots of the local deflection of the net see figs 11 and 12 both the physical and numerical net consist of 19 16 rhombic meshes and a small amount of elasticity is taken into account in accordance to the used material further the physical frame has a depression on the right side which can be respected in the numerical model easily for the configuration without additional weights fig 11a and b both the numerical model and the measurements predict a small deflection of the net due to its tare weight the depressed frame results in a small asymmetry which is accurately reproduced from the model as can be seen in table 2 the relative error of the average deflection is about 20 it is mainly caused by inaccurate measures of the net s weight and bar s lengths because small changes have a significant effect on the results here further the stiffness of the unloaded twines can cause an irregular depression of the net which is not respected in the numerical model in accordance to this result the maximal deflection is about 17 larger than in the measurements see table 3 in comparison the addition of a weight figs 11b and 12b yields a more distinctive deflection in the middle of the net the results of the tension element method coincide much better with the experiments which is confirmed by a relative error of 14 and a deviation of 4 for the maximal deflection the remaining error might especially reasoned by the approximated elongation of the net an appropriate correction of the coefficients in 1 could improve the results in fig 13 a a slice through the net at y 0 25 m is shown the reference predict the maximal deflection on this slice for which reason its distribution tapers at x 0 29 m the numerical calculation mainly coincides with the measurements but has a slightly wider aperture which is caused by the neglected moments at knots as a result of friction forces finally the configuration using two additional weights is presented in figs 11c and 12c respectively the deflections at the two points of application are underpredicted by about 20 see table 3 which presents a reliable result under consideration of the mentioned uncertainties and the complexity of the task the accurate performance is confirmed by a just 3 increased average error in comparison to the previous configuration compare table 2 additionally the comparison of the slices at y 0 25 m in fig 13b shows a similar distribution of the saddle with a local minimum of circa z 0 033 m at x 0 26 m as stated above the numerical distribution cannot exactly reproduce the funnel form of the physical net 5 conclusion this article provided a detailed derivation of the tension element method and showed its capability for practical purposes in design processes the validation process indicates converged solutions with deviations less than 20 for all configurations as an advantage of this method the physical net structures can be reproduced in comparison to finite element approaches therefore it cannot only be analysed the deflection of the net but also force peaks in all existing twines as an exemplary result the design process of nets can already consider the maximal allowed strain of the material without additional verification the solving process is physical reliable which simplifies the evaluation of both the calculation and interpretation of the results in practise additionally the method provides a single approach for both ropes and nets resulting in the possibility of calculating not just single elements but complete unions of nets including mooring systems however it should be noticed that this model lacks in the course of zero tension forces if all tension forces acting on a knot become zero the system gets underdetermined and a solution cannot be found in the presented calculations this problem does not occur particularly due to the acting gravity considering typical applications e g in aquaculture the increased buoyancy can lead to such situations if no additional weights or hydrodynamic loads act a further limitation to consider is the assumption of stiff bars hence folding of the twines cannot be modelled accurately in case of slack nets other methods like the spring element method benefit here from their possibility to add additional knots to the bars zhao et al 2007 marichal 2003 during further research the validation of the methods under consideration of hydrodynamic loads has to be executed the theoretical and practical implementation of an appropriate approach is already provided in this article as a remaining task accurate measurements of nets in steady flow conditions and force coefficients for twines have to be given finally the extension of the method for unsteady conditions would result in a suitable approach for coupled simulations of fluid and structure with the advantage of smaller systems of equations in comparison to competitive methods 
23638,a numerical model for the determination of the deformed shape of nets fixed in a stiff frame is presented the tension element method is able to predict the steady state solution of a net in a prescribed flow under consideration of hydrodynamic loads and elastic twines it is based on a discretisation of the net in mass points connected with straight bars the successive approximation is applied to the system which leads to a significant reduction of the resulting system size in comparison to the matrix of a newton raphson method this is caused by the ability to solve the system for unit bar vectors and not for knots thus the inverse can be calculated faster and more stable so far the advantage of high accuracy and physical comprehensibility by taking geometrical constraints into account is balanced by the difficulties in defining the essential directions of unit vectors properly the new implementation provides this information using an efficient technique which is adapted from finite volume methods measurements are provided in order to validated the method at the end of this paper a comparison shows the principal working of the code as well as the high accuracy of the method for steady state problems keywords numerical simulation net structure tension element method efficient implementation 1 introduction in the course of improving complex calculations by an accelerated growth of the available computational resources the question about the cost benefit ratio is often neglected coupled simulations of the flow and deformation of flexible structures in the application of ocean engineering as mooring systems and nets using high level computational fluid dynamics cfd techniques provide steady improved results but are still computationally intensive recently yao et al 2016 state the deviation of their cfd simulations for the flow around a net cage to experiments as 5 even though this is an appropriate result the method is not suitable for practical design processes here the fluid structure interaction is commonly neglected which results in the task of calculating the deformation of the structure from the inflow condition the steady state solution is furthermore sufficient in most cases for which reasons accelerations can be neglected the underlying system of equations is highly non linear even for single ropes hence analytical solutions such as the catenary can just be found under particular conditions for more complex systems such as nets it is reasonable to calculate the solution using a numerical approach different approaches exist for the discretisation of the physical models tronstad 2000 and lader and fredheim 2001 introduced a finite element method fem applying super elements for describing aquaculture cages which was generalized by priour 1999 using triangular elements both approaches are elaborated just for nets so they were not applied to ropes or complemented by mooring systems yet alternatively analogous models consisting of truss or spring elements were developed by marichal 2003 fredheim 2005 huang et al 2006 and zhao et al 2007 the physical model is represented by mass points which are connected through massless elastic bars hence the discretised model may consist of physically existing elements which is in contrast to fem approaches a system of equations is generated from force equilibria at each mass knot and the solution is found for the knot positions even though these methods show accurate results for dynamic and static problems they lack a mechanism to prevent unphysical correlation of tension forces and twine deformations at this point the tension element method tem of leitzke 1983 presents a suitable alternative because it incorporates this correlation by including geometrical constraints these are formulated using the necessary connection of the meshes at any time despite this tem is also based on a discretisation in a finite number of mass points which are connected by straight but elastic bars and is suitable for different physical systems such as ropes or nets as it will be derived later the solution matrix of the system of equations contains the unit vectors of the bars this simplifies the interpretation of both the theoretical approach and the evaluation of the physical results because the length of the bars tension forces in the bars and the displacement of the knots are direct solutions of the calculations paschen et al 2004 further the system can be solved by applying successive approximation here the unknowns are separated and the system is corrected iteratively using the intermediate results until convergence has been reached leitzke 1983 shows the conversion of the system for using a newton raphson method which is though more expensive in runtime it is caused by an increase of the matrix size because all unknowns have to be written into the solution vector instead of splitting them so far tem is limited to steady state cases but a principal approach of unsteady deformations is provided by leitzke 1983 as well the mathematical basis at least for inductile ropes is proven by hackmann 1982 1983 previous attempts to implement tem in an efficient manner were provided by niedzwiedz and hopp 1998 their implementation was not described in detail and lack a large number of meshes at which they showed the principal working of the method for complicated physical systems therefore this work aims at the derivation of an efficient implementation of tem for nets under consideration of recent developments in cfd and a validation using measurements of deformed nets with a laser rangefinder the following assumptions are taken into account in accordance to the theory of tem the relative acceleration between structure and surrounding fluid equals zero resulting in a steady state solution the fluid is infinite expanded homogeneous viscous and incompressible bars are mounted moment free and the structure is ideal flexible at the knots respectively acting forces are hydrodynamic gravity and tension forces all forces on the bars are concentrated on the corresponding knots for the sake of simplicity the hydrodynamic forces at knots are neglected which correlates to small relations between knot and bar diameter fluid structure interaction is neglected so the inflow is not distorted by the structure corresponding relations of the net are identified by koritzky 1974 and respected in the later calculations in section 2 the numerical method is presented here the determination of the forces the derivation of the system of equations and the solution procedure using successive approximation are described in detail afterwards the detailed implementation is discussed in section 3 section 4 is dedicated to the experimental validation of the method for this purpose different weights are connected to the net in a static fluid resulting in different net shapes which are compared to measurements finally a conclusion can be found in section 5 2 numerical approach the numerical approach of the tension element method is presented for nets it is fixed to a stiff frame as boundary condition an extension to arbitrary supports can be reached in a similar way analogously easier structures as ropes can be modelled too interested readers are referred to leitzke 1983 for further details on this topic we assume a frame of length l and breadth b forming a plane in an arbitrary direction of an inertial cartesian reference system with z pointing upwards the frame does not have to be planar as it is shown in the calculations below but provides a more convenient description the discretised net is represented by a finite number of massless bars with length a and a corresponding number of mass points knots p where all acting forces are concentrated these are the gravity force f g and a hydrodynamic force f h arising from the relative motion between structure and surrounding fluid further no moments occur at the knots since a flexible system is assumed the inner tension forces with magnitude f t act at p in the direction of the adjacent bars denoted by the unit vectors f an exemplary discretisation is shown in fig 1 the elasticity of the material can additionally be respected by replacing a by a functional of tension forces leitzke 1983 states that the linear dependency of hook s law is not sufficient for textile nets instead he proposes polynomials of higher order such as 1 a k 1 a k ε 1 ε 2 f t k ε 3 f t k 2 here ε i i 1 2 3 are constants which depend on the material and type of the net and k represents the later artificial time stepping in the following this indication shall be omitted for the sake of clarity all properties have to be updated in each iterative step as it is also described below 2 1 external forces the mass of the bars are distributed uniformly on the bordered knots which results in an approximated gravity force f g ν at any knot p ν according to 2 f g ν q g μ 1 n b a μ 2 with n b the number of bars connected to p ν q the specific material weight per length in the fluid and g an unit vector pointing in negative z direction under consideration of the assumptions in section 1 the hydrodynamic force acting on a bar μ in one of the global directions i can be written as the partial sum of hydrodynamic drag lift and shear forces 3 f h i μ ρ 2 v μ 2 d μ a μ c d μ e d i μ c q μ e q i μ c l μ e l i μ i 1 2 3 with ρ the density of the fluid v the relative velocity vector between fluid and structure and d the thickness of the bar the coefficients c d c l and c q depend on the roughness of the material the reynolds number and the local angle of attack θ in order to obtain these coefficients a local reference system whose axes are the unit vectors e d e l and e q is defined the directions are calculated from the bar unit vector f as 4 θ μ arccos e v μ f μ with the local velocity unit vector e v 5 e v μ v μ v μ the unit vector e d represents the direction of the drag which points towards the local velocity vector 6 e d μ e v μ the direction of the shear force is calculated from the cross product of the directions of local velocity and bar unit vector 7 e q i μ ϕ i μ ϕ j μ ϕ j μ i j 1 2 3 8 ϕ i μ ε i j k f j μ e v k μ i j k 1 2 3 with ε i j k the levi civita symbol in 7 the summation notation of einstein is applied finally the hydrodynamic lift force acts in the resulting direction from the shear and drag forces which yields equation 9 in einstein s notation 9 e l i μ ψ i μ ψ j μ ψ j μ i j 1 2 3 10 ψ i μ δ i l δ j m δ i m δ j l e v j μ e v m μ f l μ i j l m 1 2 3 for practical calculations the values of the coefficients can be provided from experiments as polynomials depending on θ since the dependency on reynolds number is small in typical applications stengel and fridman 1977 simple analytical determinations of the coefficients are based on morison s equation see e g moe et al 2010 whereas kristiansen and faltinsen 2012 showed superior results of their screen type force model in case of highly deformed nets 2 2 derivation of the resulting system of equations the solution of the calculation should particularly be the steady state shape of the net and the distribution of tension forces in the bars both properties relate to the unknown bar unit vectors since the frame is fixed the sought properties are the directions of inner bar unit vectors f μ the magnitude of the tension forces in these directions f t μ the length of the bars a μ and the hydrodynamic forces hence an iterative method has to be considered for solving this problem the system of equations is filled using force equilibria for inner knots and geometrical constraints viz geometrical connections for inner and edge meshes assuming time independence and negligence of interactions between different bars and knots a static equation of force equilibrium yields for each inner knot of the net p ν see also fig 2 11 μ 1 n b f μ f t μ 1 2 f h μ f g ν 0 ν 1 n k with n k the number of inner knots and the forces defined above see 2 and 3 it is only considered one half of the hydrodynamic forces for a smooth distribution on the net correlating to the chosen distribution of f g as can be seen from 3 f h just depends on f for which reason it can be taken as a known force in each iterative step a proper rearrangement of 11 then results in 12 μ 1 n b f μ f t μ μ 1 n b 1 2 f h μ f g ν ν 1 n k the number of bars exceeds the number of knots in general thus the system is undetermined and has to be closed by adding geometrical constraints these equations accomplish the coherence of the net during the deformation in a physical way they are determined by considering a closed string of four bars and knots in case of inner meshes resulting in see also fig 3 13 τ 1 4 f τ a τ 0 with f τ the unit vectors of the bars of mesh τ by definition the summand is taken positive if f τ points clockwise in contrast a mesh near the frame consist of three bars and three knots at which the bar on the frame is known the modified equation 13 reads then compare fig 4 14 τ 1 2 f τ a τ β with β the vector between two neighboured knots on the frame assuming a constant a in the initial position β can be determined from the overall length of the net in longitudinal and transversal direction and the known number of meshes in these directions in general the model provides a spillover of mesh equations for which reason it has to be paid attention to preserve the uniqueness of the system s solution the resulting linear system of equations can be written in an appropriate way for obtaining the matrix of unit bar vectors ℱ using 12 13 and 14 as 15 a ℱ ℬ with a containing the sub matrices of unknown tension forces t and the lengths of the bars ℒ 16 a t ℒ on the right hand side ℬ yields 17 ℬ ℋ g r with ℋ and g the sub matrices of hydrodynamic and static forces r is filled with zeros in case of inner mesh equations and with the known frame vectors β else a is a square matrix with the size of the unknown bar unit vectors n b whereas ℱ and ℬ are matrices of size 3 n b taking the net of fig 1 as an example the system matrix reduces from 123 123 to 100 100 due to the transition from the newton raphson method to the successive approximation it yields a significant reduction of runtime under consideration of multiple inversions 2 3 solving the system of equations using successive approximation in system 15 both a and ℬ depend on the solution matrix ℱ therefore appropriate initial values have to be chosen for the tension forces and bar unit vectors afterwards the hydrodynamic force matrix h can be initialised using 3 and 1 yields the initial lengths of the bars the solution of 15 at any iterative step k results as 18 ℱ k a k 1 1 ℬ k 1 however the lengths of bar vectors have to equal one by definition at the end of each step 19 l ℱ k 1 this cannot be guaranteed by 18 for which reason a correction step according to 20 f μ k f μ k f μ k μ 1 n b has to be performed before the loop proceeds in order to conserve consistency the columns of a have to be multiplied by the euclidean norm of the corresponding line of ℱ k as a matter of course geometrical constraints are excluded from this correction the next step k 1 can then be calculated by correcting the bar lengths in a using 1 determining ℬ using ℱ k and 18 typically convergence of ℬ can be achieved after few iterations while the convergence of the tension forces takes some more steps the algorithm stops in case of reaching a predefined criterion for the residuals of the norm such as 21 l ℱ k 1 κ which corresponds to the conservation of all bar unit vectors within the tolerance κ as indicated above the method of successive approximation with correction of the unit vectors gives the opportunity to interpret the solution process physically if the unit vector of any bar is stretched by the assumed acting forces the correction 20 reduces the length again which corresponds to an increase of tension forces this increase is respected by the additional correction step in a taking this explanation into account the tem offers an elegant way of solving the relation between tension forces and net deformation accurately which makes it highly suitable for practical purposes in industrial applications 3 remarks regarding an efficient implementation the described method of calculating the dynamics of flexible systems in the application of ocean engineering was up to now limited by the inefficient determination of the direction of f in order to improve the method an efficient implementation with an automatic discretisation of the physical model will be presented it is achieved in analogy to the mesh handling of unstructured grids which is typically known from finite volume methods see e g jasak 1996 there the fluxes of the flow have to be evaluated at the faces of each cell as initial condition the field values are known in the two connected cells of each face the aim is to find a suitable value at the face from these known values using any kind of interpolation the most efficient way of calculation is clearly iterating through the faces and not through the cells because it would have to be stored all neighbours of each cell for the latter list in comparison it just needs to store the two adjacent cells if face lists are considered these face lists are then divided in an array of so called owners and neighbours since the direction of the face represented by a face normal vector has to be clarified on an unstructured grid hence it is assumed that this vector always points from the owner to the neighbour cell this has to be executed just once in preprocessing in order to adapt this idea to our method we just have to define the knots as cells and the face normal vectors as the unit bar vectors in doing so we can easily find the knot ids and the direction of the vectors which is necessary for assembling the mesh equations see also fig 5 the following description is at first limited to the case of rigid bars and missing hydrodynamic loads in order to explain the principal procedure the necessary modifications for including these features are given at the end of this section as a starting point the dimensions of the net and the number of meshes in the longitudinal n l and transversal direction n t are given from input data as described in section 2 the calculation of the acting forces needs information about velocity and density of the fluid as well as length and diameter of the bars in case of a skewed frame the angles of the frame in the inertial reference system have to be predefined it has to be ensured that the angle of attack between structure and fluid is in a range where no flow around the structure appears if the angle between net and fluid is larger than some critical angle lift forces arise from the fluid flow around the frame see koritzky 1974 for further details based on these information the number of inner bars n b can be evaluated as follows 22 n b 2 n l 2 n t 4 n l n t corresponding to the number of unknown the number of known frame vectors n β is given by 23 n β 2 n l 2 n t which equals the number of frame mesh equations the number of inner knots n k and the number of force equilibrium equations respectively is calculated as 24 n k n l n t n t 1 n l 1 finally the number of knots on the frame n f results from 25 2 n l 1 2 n t 1 as a next step all knots are indicated by an unique id together with the information of their position inner or outer knot afterwards the owner and neighbour lists for evaluating the direction of bar unit vectors can be prepared in order to guarantee an unique assignment both lists have the size of the unknown calculated from 22 we propose to start with a transformation of the net to a skewed grid in a principal plane with unit distances between the knots as can be seen in fig 6 it evolves from shifting each second y row of knots in negative y direction in this shape the grid consists of straight rows with unit distances in x direction which can then be utilized for the initialisation of inner bars all bars along the x direction can be directly defined by searching for the knot id with the necessary coordinates in the transformed grid thus no special id assignment has to be existing in a similar way the diagonal bars and frame vectors can be found afterwards the knots on the frame are transformed back into the physical coordinates of the frame and for the inner knots reasonable initial position are chosen the resulting discretised model is shown in fig 1 the initial coordinates of the inner knots are not critical since the convergence of the numerical approach is usually reached irrespectively to the chosen positions in order to add the force equilibria to the system of equations the owner and neighbour lists are scanned for the id of each inner knot if any bar has the considered knot as its owner the corresponding entry in a is a positive initial force analogously if the knot is the neighbour of the bar the entry consists of a negative initial force the initial values should be near the final tension forces for reaching a fast convergence but can also be assumed as 1 n if a priori unknown due to the robustness of the solution algorithm after the four involved bars are indicated the corresponding line in ℬ has to be filled with the gravity and initial hydrodynamic forces afterwards the geometric equations for outer meshes have to be determined which will be exemplary presented for the mesh in fig 4 considering any frame vector β with its owner knot p 3 and its neighbour knot p 1 two adjacent inner bars exist which form a closed mesh together with β in case of fig 4 f 1 and f 2 these bars are indicated from the owner and neighbour lists as before the distinction between the necessary bar and other inner bars connected to the knot could be accomplished by comparing the second knot id which is connected to the bar this id has to be the same for both involved bars finally inner geometric equations are added to the system until the necessary number of equations is reached we propose an iterative search for inner meshes starting from any inner knot which has already been used for the definition of the outer meshes in fig 7 a typical situation of the algorithm is shown we assume that the yellow knot represents the initial knot of the current iteration first all neighbour knots are indicated using the connection via the owner and neighbour lists red bars and knots and stored in a separate list l 1 for each member of l 1 the same indication is repeated at which the initial knot will be skipped this leads to the blue knots in fig 7 which are stored in another list l 2 together with the information of the related red knot in a list l 2 l 2 contains at least one knot id twice which corresponds to a potential new inner mesh thus l 2 should be compared component wise to find all twin id s a new inner mesh can then be found by considering a twin id the related knots from l 1 which are known through l 2 and the initial yellow knot the directions of the bars within this mesh are found from the owner neighbour lists as described above since this procedure does not automatically exclude existing meshes an additional check has to be performed in order to avoid linear dependency of a after all inner meshes of the current iteration are found the next iteration can be started with the blue knots which are not represented twice in l 2 as the new initial knots in fig 7 this corresponds to the green knots once the system is complete the converged solution of the system of equations can be attended as described in section 2 and an appropriate solution algorithm such as gaussian elimination with pivoting the deformed net can be visualised from the known directions of f and length of the bars a an exemplary result of a calculation can be found in fig 8 in case of a significant difference of the velocity between structure and fluid hydrodynamic forces should be included it results in a non constant right hand side for the force equilibria equations which therefore has to be updated after each iteration using the corrected unit vectors f the advantageous structure of a which is characterised by all lines are filled with zeros except of the entries of the involved bars simplifies the recalculation of ℬ after f h is calculated for all bars using 3 one half of the values from bars with a non zero entry in a line in a can be added to the same line in ℬ according to 12 in a similar way the elongation of the bars is updated each column of a contains in one of the first n k lines the current tension force of the corresponding bar and below the current length of it taking these two non zero entries into account the new bar length is simple calculated from 1 4 experimental validation a detailed description of a modern implementation of the tension element method is given in the last section in the following the implementation of the code using the open source project gnu octave is validated by a comparison to measurements from the laboratory of the chair of ocean engineering the considered case is restricted to a deformed net in a fixed frame in a static fluid thus high quality measurements are ensured for the comparison and the potential errors of inaccurate hydrodynamic force coefficients are excluded the experimental setup consists of a net firmly clamped in a rigid frame of 556 m m 520 m m the considered net is made of knotted nylon filaments with a diameter of d 2 1 m m and a mesh size of a 22 m m compare fig 9 and has a weight of 0 493 k g m 2 the meshes are rotated by 45 in the frame resulting in a half mesh opening angle γ 45 a laser rangefinder which is used for sampling the deformations properly is fixed to a traverse above the structure the traverse moves with a constant velocity of 0 04 m s in preset paths along the x and y axis in intervals of 50 m m at the same time the rangefinder measures the distance to the net in z direction with a sampling rate of 0 001 s considering the known velocity and path of the traverse the net deformation is evaluated using the z deflections of the sampling signal an exemplary result from this procedure can be found in fig 10 three configurations which are generated by adding different weights to the net are compared all weights and their locations in the net can be found in table 1 the validation is mainly performed by comparing contour plots of the local deflection of the net see figs 11 and 12 both the physical and numerical net consist of 19 16 rhombic meshes and a small amount of elasticity is taken into account in accordance to the used material further the physical frame has a depression on the right side which can be respected in the numerical model easily for the configuration without additional weights fig 11a and b both the numerical model and the measurements predict a small deflection of the net due to its tare weight the depressed frame results in a small asymmetry which is accurately reproduced from the model as can be seen in table 2 the relative error of the average deflection is about 20 it is mainly caused by inaccurate measures of the net s weight and bar s lengths because small changes have a significant effect on the results here further the stiffness of the unloaded twines can cause an irregular depression of the net which is not respected in the numerical model in accordance to this result the maximal deflection is about 17 larger than in the measurements see table 3 in comparison the addition of a weight figs 11b and 12b yields a more distinctive deflection in the middle of the net the results of the tension element method coincide much better with the experiments which is confirmed by a relative error of 14 and a deviation of 4 for the maximal deflection the remaining error might especially reasoned by the approximated elongation of the net an appropriate correction of the coefficients in 1 could improve the results in fig 13 a a slice through the net at y 0 25 m is shown the reference predict the maximal deflection on this slice for which reason its distribution tapers at x 0 29 m the numerical calculation mainly coincides with the measurements but has a slightly wider aperture which is caused by the neglected moments at knots as a result of friction forces finally the configuration using two additional weights is presented in figs 11c and 12c respectively the deflections at the two points of application are underpredicted by about 20 see table 3 which presents a reliable result under consideration of the mentioned uncertainties and the complexity of the task the accurate performance is confirmed by a just 3 increased average error in comparison to the previous configuration compare table 2 additionally the comparison of the slices at y 0 25 m in fig 13b shows a similar distribution of the saddle with a local minimum of circa z 0 033 m at x 0 26 m as stated above the numerical distribution cannot exactly reproduce the funnel form of the physical net 5 conclusion this article provided a detailed derivation of the tension element method and showed its capability for practical purposes in design processes the validation process indicates converged solutions with deviations less than 20 for all configurations as an advantage of this method the physical net structures can be reproduced in comparison to finite element approaches therefore it cannot only be analysed the deflection of the net but also force peaks in all existing twines as an exemplary result the design process of nets can already consider the maximal allowed strain of the material without additional verification the solving process is physical reliable which simplifies the evaluation of both the calculation and interpretation of the results in practise additionally the method provides a single approach for both ropes and nets resulting in the possibility of calculating not just single elements but complete unions of nets including mooring systems however it should be noticed that this model lacks in the course of zero tension forces if all tension forces acting on a knot become zero the system gets underdetermined and a solution cannot be found in the presented calculations this problem does not occur particularly due to the acting gravity considering typical applications e g in aquaculture the increased buoyancy can lead to such situations if no additional weights or hydrodynamic loads act a further limitation to consider is the assumption of stiff bars hence folding of the twines cannot be modelled accurately in case of slack nets other methods like the spring element method benefit here from their possibility to add additional knots to the bars zhao et al 2007 marichal 2003 during further research the validation of the methods under consideration of hydrodynamic loads has to be executed the theoretical and practical implementation of an appropriate approach is already provided in this article as a remaining task accurate measurements of nets in steady flow conditions and force coefficients for twines have to be given finally the extension of the method for unsteady conditions would result in a suitable approach for coupled simulations of fluid and structure with the advantage of smaller systems of equations in comparison to competitive methods 
23639,in order to reduce the structural failure and accident occurrence of the offshore wind turbine the researches on structural operational safety of offshore wind turbine based on the measured data during the operation periods should be carried out and considered as the key way to solve these problems however the current researches are only focused on numerical simulation model experiment and theoretical analysis and ignore the structural vibration characteristics analyzed from condition monitoring and prototype observation data from the actual wind turbine structure to compensate for this study defect the structural vibration displacement signals of one chinese offshore wind power prototype under different conditions were obtained based on a long term prototype observation in order to achieve the comprehensive and systematic research on vibration response characteristics and operational modal analysis of measured structure considering the complicated operational environment of offshore wind turbines the structural response regular pattern and vibration safety are also discussed emphatically under different conditions such as standstill normal operational startup shutdown and extreme typhoon status simultaneously the integral operational modal identification method of offshore wind turbine in the range of full power is proposed based on traditional and modified stochastic subspace identification technologies and further the modal identification results and the relationship between structural modal parameters and environmental operational factors are also illustrated in this paper the researches on the structural vibration characteristics and operational modal analysis of offshore wind turbine not only provide powerful data and technology support for the operation safety evaluation but also provide the necessary theoretical and practical bases for the design and maintenance of wind turbine structures keywords offshore wind turbine prototype observation structural vibration characteristics operational factors operational modal analysis 1 introduction the offshore wind power project has developed rapidly in recent years with the advantages of high wind speed low turbulence large output and long service life with the quick development of wind power the complexity of the structure greatly increases the operation safety risk of wind turbine because of larger capacity higher towers and bigger blades rodrigues et al 2015 especially in recent years the global safety accidents of wind turbine structures occurred frequently with the number of nearly 1000 only in 2014 seyr and muskulus 2016 the issues on operational behavior and structural safety of offshore wind turbine under different working conditions have begun to attract universal attention as we all known structural vibration monitoring and operational modal analysis are important means to master the operational behavior and structural safety of offshore wind turbine effectively with the development of modern measurement technology the researchers began to be interested in understanding the vibration characteristics of offshore wind turbine based on the measured data and try to obtain the operational behaviors bassett et al 2010 dynamic parameters ozbek et al 2010 2013 and structural safety benedetti et al 2011a 2011b by the feedback analysis in recent years firstly the monitoring systems applied to practical engineering were established improved and optimized based on existing system according to the dynamic characteristics of the wind turbine structure the environment and operational conditions with a view to more accurate and efficient collection processing analysis of prototype observation data yang 2013 schlechtingen et al 2013 schlechtingen and santos 2014 for example gokhan kilic and unluturk 2015 took the supervised event server health monitoring system seshms as a relatively simple economical wireless system for use within the arena of structural health assessment secondly the intuitive comprehensive and systematic researches on dynamic response characteristics change law the relationship between the operational parameters and vibration were carried on the basis of measured data kusiak and zhang 2010 hu hu et al 2015a 2015b focused on a resonance phenomenon environmental and operational influences on structural dynamic properties under normal operational conditions of a wind turbine system in 5 mw wind turbine on the basis of dynamic signals acquired continuously from the tubular tower under normal operational conditions during two years thirdly it is also necessary to carry out the feedback identification on the operational parameters and dynamic indexes of the wind turbine structure further the structural operational safety under different working conditions and long term monitoring can be evaluated by using these analysis indexes and the real time change rules andrew swartz et al 2010 bang et al 2012 a typical example is that moritz w hackell and rofles 2013 took one 5 mw offshore wind turbine structure as the research object the extraction of modal parameters and the estimation of condition parameters of wind turbine were implemented respectively by data driven stochastic subspace identification method and vector auto regressive var models finally the above mentioned research results on dynamic characteristics and work performance indicators can be utilized to establish the early warning or control system of wind turbine structure in order to ensure the operational safety of offshore wind turbine structure in the complex conditions currie et al 2015 iliopoulos a iliopoulos et al 2015 made use of a modal decomposition and expansion algorithm in order to predict the unknown position responses of offshore wind turbine structures with limited condition measured data however the present researches were also limited to the monitoring and analysis of single unit such as fan unit hackell and rofles 2013 tower kilic and unluturk 2015 foundation currie et al 2015 lacking of the consideration on the coupling vibration measurement of multiple structural components simultaneously the detailed interpretation on vibration characteristics and vibration mechanism of the whole offshore wind turbine structure should be completed further the most critical problem is how to deal with the interference of harmonic components in the modal analysis of offshore wind turbine structure in the current study jacobsen jacobsen et al 2007 and peeters peeters et al 2007 both tried to eliminate the harmonic components ahead of identifying modal frequencies so that the measured vibration signals are completely composed of the structural modal information nevertheless choosing an unsuitable filter will result in the easy loss of useful component because the frequencies of operational modes and harmonic modal frequencies may be close to each other gade gade et al 2009 jacobsen jacobsen 2006 jacobsen et al and modak modak et al 2010 modak 2013 considered that there are differences in statistical properties such as kurtosis and probability density function between random signals and harmonic signals and distinguished the real structural modes among the identification results from the unknown harmonic modes respectively using the frequency domain decomposition method singular value decomposition method and random decrement technique but the unavoidable deficiency is that the actual modal parameters cannot be obtained properly when the structural information completely submerges in the harmonic components in addition the new theories of transmissibility function hilbert huang transform and optimized spectral kurtosis have been applied successively to differentiating the actual structural and harmonic modes by devriendt devriendt et al 2009 weijtjens et al 2014 agneni agneni et al 2012 and dion dion et al 2012 however the ability of these methods to extract the natural modal information under the disturbances of strong harmonic energy has not been known to solve this difficult problem originated from harmonic disturbance p mohanty mohanty and rixen 2004a 2004b 2004c 2006 had modified several classic modal identification methods including lcse itd era and sstd method to obtain the actual modal information considering the influence of the harmonics on the characteristic matrix of structural system however it has a limitation in engineering application for the above modified methods because of the unstable identification resulted from the defect of the algorithm itself and their poor noise resistance on the basis of p mohanty s ideas dong et al 2014 introduced the strong harmonic interference information obtained from measurement data into the traditional stochastic subspace identification method ssi possessed stronger anti noise and better recognition stability subsequently a new modal identification method called harmonic modified stochastic subspace identification hm ssi method was proposed to successfully complete the studies on operational modal identification and operational safety evaluation of offshore wind turbine structure and the superiority of the method and engineering applicability were also verified in this paper the structural operational modal identification of tested offshore wind turbine affected by the strong harmonic excitations will be implemented based on the above method in summary it can be seen that it is lack of the vibration safety monitoring of the whole wind turbine and the support structure at the same time the field observation data of the offshore wind power project is extremely scarce the basic vibration characteristics of the offshore wind turbine structure and the operational modal analysis of the wind turbine under different conditions are lacking in comprehensive in depth and systematic research therefore the structural vibration characteristics of offshore wind turbines under different conditions such as standstill normal startup shutdown and extreme typhoon status were deeply analyzed to further illustrate the influence regularity resulted from operational factors and subsequently the vibration safety of the wind turbine structure under different operational conditions was fully discussed combined with a new modal analysis method called hm ssi method dong et al 2014 firstly the project overview of the measured offshore wind turbine is introduced in section 2 secondly the operational conditions of offshore wind turbine are proposed in section 3 to understand the characteristics and relationship between operational conditions and environmental factors additionally a detailed and comprehensive study on the vibration response characteristics of the offshore wind turbine structure under typical operational conditions is achieved in section 4 lastly the operational modal analysis of offshore wind turbine in the range of full power structural operational safety assessment and influence on modal identification from environment and operational factors are demonstrated systematically in section 5 based on the measured vibration responses the framework of this paper was shown in fig 1 2 prototype observation of offshore wind turbine structure the offshore wind turbine of this measurement is located in the yellow sea area adjacent to nantong city in jiangsu province of china a new foundation form of offshore wind turbine called the composite bucket foundation jijian et al 2012 lian et al 2011 was applied as the first prototype in the wind turbine experiment globally with 30 0 m in diameter 18 0 m in height and 2500t in the total weight a three blade direct drive wind turbine generator with rated power of 2 5 mw and the rotor rated speed of 18 rpm were selected simultaneously the cut in rated and cut out wind speed is 3 0 m s 12 0 m s and 25 0 m s respectively the 80 m tall tower which has working platforms between two adjacent parts of steel tower was installed in three parts zhang et al 2014 as described in fig 2 five observed points located at 1 5 m from each platform were instrumented inside the tower along the height direction three vibration displacement sensors with the frequency range of 0 1 200 hz in each measured location were used to acquire low frequency and multi directional structural vibration response signals the x tangential direction of cylinder wall and z vertical direction of cylinder wall directions are horizontal and y vertical ground direction direction is vertical besides the total testing time was more than one month and sampling frequency was chosen as 200 hz in this field measurement specially four typhoons saola damrey haikui and bolaven had passed this test area in august 2012 and saola and damrey landed at the same time which produced the double typhoons effect fig 2 presents the location of geographical position of offshore wind turbine prototype arrangement of the measured points vibration displacement sensors and signal acquisition system arranged in the offshore wind turbine 3 environment and operational conditions of offshore wind turbine from 26rd july to 1st september in 2012 the variables such as operational wind speed rotation speed power pitch angle of blades and orientation angle of nacelle were also recorded in every 10 min in order to study conveniently the environmental and operational influences on the dynamic properties of the offshore wind turbine structure the mean values of above variables in every 10 min were considered and the measured wind speed was divided into four scopes representing levelⅰ less than 5 5 m s levelⅱ 5 5 8 0 m s levelⅲ 8 0 10 8 m s and levelⅳ more than 10 8 m s the corresponding time history and probabilistic histogram curves of five environmental and operational factors described in figs 3 7 as shown in fig 3 the measured mean wind speeds change from 0 12 m s to 15 70 m s and most of them are distributed around the 5 0 8 0 m s range three peaks appear at the dates those are from 2nd to 4th 7th to 9th and 27th to 29th in august because the typhoons saola damrey haikui and bolaven passed with the average wind speed of 13 78 m s 15 70 m s and 14 88 m s respectively it is observed that the average rotation speed fluctuates stably and the maximum value is 17 89 rpm close to rated factor as 18 0 rpm in fig 4 except for the conditions of 1 rpm or less the distribution of rotation speed keeps substantially constant from 7 rpm to 16 rpm with a maximum peak in the range of 13 rpm 14 rpm due to the more standstill conditions during typhoons three data aggregations emerge near to rotation speed of 0 rpm inspection of fig 5 describes that more than 51 98 of the average power change from 0 5 mw to 1 5 mw and only 3 39 of those operational factors surpass 2 0 mw with the maximum value of 2 43 mw in fig 6 it is illustrated that the offshore wind turbine runs well because most of the measured pitch angles emerge less than 5 simultaneously there are three obvious peaks at the range form 0 to 20 because of the same reason of typhoons it also can be seen that the angle of nacelle changed cyclically from 0 to 180 before august 15th and no obvious rule can be followed when the field measurement continued from fig 7 the main wind direction of this experiment was determined as southeast se shown as the wind rose chart further the relationship between wind speed and power rotation speed pitch angle is described in fig 8 a b c d e show the change rule of pitch angle and power with the variation of rotation speed in four wind speed levels represented respectively by black red yellow and blue circles as shown in fig 8 a the theoretical data and curve of power for the offshore wind turbine are also described with a similar change trend to measure mean data of power when the wind speed increases four obvious distribution lines can be found easily stable at 0 mw 0 5 mw 1 0 mw and 1 5 mw corresponding to the standstill condition and three stable output conditions though the wind speed become larger constantly it appears that the rotation speed rises generally and almost linearly with increase of the wind speed from 0 0 to 15 7 m s and reaches near the maximum rotation speed of 17 89 rpm when the wind speed surpass 10 0 m s in fig 8 b meantime it is worth noting that the rotation speed seems to jump to a higher value when approaching 10 rpm and 14 rpm which represents the larger occurrence percentage of rotation speed in fig 4 b the relationship between pitch angle and wind speed is described in fig 8 c it can be found that the pitch angle decrease from nearly 98 18 to about 0 when the wind speed is below 10 0 m s on the contrary it increases gradually from 0 to 20 when the wind speed rises and the rotation speed is steady around 15 7 rpm as shown in fig 8 c fig 8 d indicates that the pitch angle decreases with rising rotation speed and increase slightly again as rotation speeds reaches 15 7 rpm it is explained that the power increases quickly to the rated value of 2 50 mw with the variation of rotation speed especially when the measured factor changes from 7 rpm to 17 89 rpm as described in fig 8 e using various colors to represent the different levels of the power as depicted in fig 9 the relationship between the wind speed rotation speed and power can be represented where the wind turbine operational unit demonstrates a clear increasing trend as the wind speed and rotational speed increase simultaneously it is also declared that there is a strictly positive correlation between the measured wind speed and the rotation speed and this phenomenon maintains the characteristics of the direct drive wind turbine 4 structural vibration characteristics of offshore wind turbine 4 1 standstill conditions as described in fig 10 the root mean square rms values of the observed response signals in x direction and z direction from 1 5 measurement points are chosen to analyze the vibration characteristics of the wind turbine structure under the standstill conditions it is illustrated that the structural vibration shows a positive correlation with the wind speed when only subjected to the environment excitations because the rms values of vibration displacement signals both in two directions rise obviously with the variation of environmental wind speed at the range from 2 0 m s to 14 0 m s taking the measured signals in x direction from 1 observation point as an example the vibration amplitude increases rapidly when the wind speed exceeds 10 0 m s and reaches a maximum of 19 78 mm at the average wind speed of 13 5 m s simultaneously the same rms values from other four measured points calculated to be 8 49 mm 1 35 mm 0 34 mm and 0 096 mm fig 10 b depicts the similar regular pattern among the responses of five testing points and greater vibration amplitude in z direction with the maximum values of 33 09 mm 13 73 mm 1 51 mm 0 48 mm and 0 216 mm further the normalized power spectrums of structural horizontal vibration response signals at 1 measured point under typical standstill conditions with the wind speed of 2 2 m s 5 0 m s 7 5 m s 10 0 m s were drawn in fig 11 it is shown that the peak frequencies of four vibration responses in both two directions concentrated at 0 33 hz which can be considered as the first structural modal frequency dong et al 2014 the similar results are also found in the dominant frequencies of vibration responses with the range of 0 317 hz 0 344 hz under the standstill conditions at all 5 measured points it is illustrated that vibration responses reflecting the frequency closed to low order modal information can be produced under the standstill conditions because the offshore wind turbine structure may be only influenced by environment excitations including wind wave 4 2 normal operational conditions hundreds of measured operational conditions were selected to reflect better the vibration characteristics of offshore wind turbine and the influence on vibration resulted from the operational factors such as wind speed and rotation speed hence the rms value is chosen as the research value and trend of structural vibration displacements at 1 measured point with the change of wind speed and rotation speed are described in fig 12 overall both of two factors made an obvious positive correlation with horizontal vibration amplitudes asymptotically two extreme points with the rms values of 30 18 mm and 41 61 mm in x direction can be found corresponding to the conditions at wind speed of 14 6 m s and 10 9 m s rotation speed of 16 rpm and 8 rpm respectively as shown in fig 12 a the maximum vibration in z direction was calculated to be 57 38 mm under the condition of wind speed of 11 3 m s and rotation speed of 18 rpm fig 13 show the normalized power spectrums of structural horizontal vibration responses at 1 measured point under six typical operational conditions with the wind speed of 4 0 m s 6 0 m s 7 2 m s 9 3 m s 10 0 m s 12 1 m s and rotation speed of 9 rpm 11 rpm 11 rpm 13 rpm 16 rpm 18 rpm it is explained that the vibration of wind turbine reflects the natural modal frequency characteristic close to 0 33 hz represented by black and red lines because of the weaker effect on the dynamic responses originated from rotating impeller under the conditions with lower environment factors with the increase of rotation speed the harmonic components occupies the most of vibration energy and the similar dominant frequencies equivalent to the rotation frequencies of 0 20 hz 0 22 hz 0 26 hz and 0 30 hz appear in the power spectrums of both horizontal directions it is further explained that the dominant vibration form of wind turbine change from the random vibration reflecting modal frequency induced environmental loads to forced vibration in rotation frequencies resulted from operating impeller when the operational factors rise the same regular pattern is also found in fig 14 4 3 transition conditions 4 3 1 startup conditions the startup condition of offshore wind turbine involves a transition process that the generator changes from the quiescent state into the operational status three different conditions with the wind speed of 4 0 m s 5 5 m s 8 4 m s were measured lasting the testing time of 150s the wind power generator starts to operate at 60s in every measurement the vibration time histories structural vibration characteristics and time frequency spectrums in both time and frequency domains of measured vibration responses in z direction at 1 observed point are described in fig 15 as shown in fig 15 the whole startup process can be divided into four typical stages including standstill transition startup and operation generally speaking the poorer structural vibration with the natural modal frequency of 0 33 hz excited only by environmental load occurs at standstill status in the transition process the structural vibration amplitude will change weakly with the lower increase of unit torque and rotation speed of impeller hereafter the structural vibration of wind turbine increases rapidly and runs stably until it gets the maximum value because of the continued increase of rotation speed in the startup and operational process meanwhile the information at rotational frequencies at 0 20 hz 0 23 hz and 0 27 hz occupy most of vibration energy as also described in fig 13 the structural vibration displacements of the offshore wind turbine in the startup process show obviously higher than those in the operational conditions with the increases of 17 04 42 00 33 82 in x direction and 32 89 35 19 24 14 in z direction at the wind speed of 4 0 m s 5 5 m s and 8 4 m s respectively 4 3 2 shutdown conditions the shutdown condition of offshore wind turbine involves a transition process that the generator changes from the working status into standstill condition without the operational excitations four different conditions with the wind speed of 5 0 m s 7 6 m s 9 0 m s and 10 7 m s were measured lasting the testing time of 150s the wind power generator starts to rest at a reasonable time in every measurement the time histories structural vibration characteristics and waterfall map in both time and frequency domains of measured vibration responses in z direction at 1 observed point are described in fig 16 as shown in fig 16 four typical stages called respectively operation shutdown transition and standstill are drawn in the entire time history of vibration signal it is found that the vibration responses reflect the harmonic frequency information corresponding to the rotational frequencies of 0 22 hz 0 22 hz 0 25 hz and 0 30 hz at four measured conditions firstly due to the sudden brake impact of the generator the vibration amplitude will significantly increase in a short time without the external continuous excitations the offshore wind turbine structure may not vibrate gradually to become stable by the follow effect of its own inertia until the machine completely stops operating at this time vibration displacements of wind turbine structure become relatively smaller because of the alone effect originated from the external environment and show the all of four dominant frequencies at 0 33 hz meantime the significant large amplitude multi period characteristics of the vibration signals before shutdown can be found compared to the properties of single cycle and small amplitude under the standstill condition the vibration displacements of wind turbine structure during the shutdown process increase obviously comparing to the amplitudes in the operational conditions the magnification of structural vibration is calculated as 10 76 256 72 130 87 5 21 in x direction and 2 58 83 61 114 47 30 37 in z direction under the condition of wind speed at 5 0 m s 7 6 m s 9 m s and 10 7 m s 4 4 typhoon conditions in this field measurement the nearest distance between the location of offshore wind turbine prototype and typhoon eye are about 216 82 km 230 77 km and 316 62 km respectively further the distance ranges of 7 level typhoons are 200 km 400 km and 350 km therefore it can be found that the measured offshore wind turbine structure was affected dominantly by 7 level typhoons fig 17 shows the time history curves of structural vibration in x z directions and the variation curves of operational wind speed and rotation speed during the three typhoon measurements with the numbers 1 to 5 representing the different operating stages of offshore wind turbine it is illustrated that the offshore wind turbine structure can remain stable under the affection of 7 level typhoons with the maximum vibration displacement of 20 60 cm 12 58 cm 27 42 cm corresponding to the maximum instantaneous wind speed as 17 0 m s 26 0 m s 20 0 m s here are some further analyses on typical vibration type and characteristics of the wind turbine structure during the typhoons as described in figs 17 a 3 b 2 c 2 the wind turbine transfer into enclosed shut down status with basically zero rotor speed to decrease the structural damage resulted from the larger instantaneous wind speed which may exceed 9 0 m s in that period hence the lower structural vibration displacements in both x and z directions will occur only affected by environment excitations moreover the generator does not start up and remained standstill condition with the cut in wind speed lower than 3 0 m s and the rotation speed at zero as shown in figs 17 a 1 b 4 c 4 fig 17 a 2 b 1 c 3 5 illustrate that an obvious synchronization excited between the rotation speed and operational wind speed of offshore wind turbine under the measured operational conditions it is further explained that the rotation speed totally depends on the instantaneous wind speed which mainly distributes in the range of 3 0 m s 10 0 m s and generally reflects lower than rated wind speed 12 5 m s therefore the vibration of wind turbine is effected by the rotation of impeller and environment loads in a normal operational status without interference in the extreme typhoon conditions the increase of the wind speed might bring out potential danger to the wind turbine structure especially when the rotation speed reaches the rated speed usually speaking the power should be limited to control the rotation speed in order to reduce the structural vibration in fig 17 a 4 5 b 3 c 1 the rotation speeds do not synchronize with wind speed which already exceeded than rated wind speed comparing to fig 18 which shows the rotation speed versus power during the test period of typhoon saola damrey haikui and bolaven the phenomenon that the rotation speed is depended on power rather than wind speed condition can be found firstly figs 17 a 4 shows a typical condition that rotation speed is controlled by fixing power in addition the sudden increase of power close to 2 5 mw leads to an obvious increment of structural vibration even though the wind speed of typhoon and the hidden danger reduces shown in figs 17 a 5 furthermore it can be seen in figs 17 b 3 that the structural vibration amplitude changes with the increase of rotation speed under the different fixed load operational conditions because the power of wind turbine is selected lower than 1 5 mw fig 17 c 1 gives the result that the vibration of wind turbine gradually weakens with the decrease of rotation speed resulted from the limited power even if the operational wind speed obviously increases it is elaborated that the structural vibration is mainly effected by rotation speed compared to wind speed meantime the vibration maximum value of wind turbine structure during the typhoon saola damrey and bolaven appears at the rated operational conditions respectively as described in figs 17 a 5 c 1 however the same index of typhoon haikui can be found under the operational condition without interference at fig 17 b 1 it is illustrated that the operation at rated speed of wind turbine makes a severe influence on structural vibration during the typhoon period contrast to the weak vibration effect under the standstill condition with large wind speed 5 operational modal analysis of offshore wind turbine in the range of full power 5 1 operational modal identification theory in order to achieve the operational modal identification of offshore wind turbine in the range of power the research on frequency domain characteristics of measured vibration responses should be carried out to determine the dominant frequency information reflected from structural vibration firstly hereafter the operational modal parameter identification problem can be divided into two directions according to the frequency characteristics of the vibration responses 1 in direction 1 the traditional ssi method can be used to complete the studies on structural modal analysis when the vibration responses only reflect the natural modal information in the frequency domain or the difference can be clearly found between the structural modal and harmonic modal information with the assume of zero damping feature as we all known the basic idea of ssi method is that the eigenmatrix of structural dynamic system is constructed with measured responses and the modal information can be obtained using eigenvalue decomposition method based on the hankel matrix supposing the number of observed points on the offshore wind turbine structure is m and the measured data length of each point is j a 2 m i j dimension hankel matrix containing 2 i block rows and j columns is composed of measured response data according to eq 1 de roeck 1999 1 y 0 2 i 1 1 j y 0 y 1 y 2 y j 1 y 1 y i 1 y 2 y i y 3 y i 1 y j y i j 2 y i y i 1 y i 2 y i j 1 y i 1 y i 2 y i 3 y i j y 2 i 1 y 2 i y 2 i 1 y 2 i j 2 2 m i j y 0 i 1 y i 2 i 1 y p y f where y i represents responses of all measured points at time i y 0 i 1 and y i 2 i 1 are the matrix representing the first i block and the second i block respectively y p and y f are defined by splitting the hankel matrix into two parts of i block rows the subscripts p and f stand for past and future based on the theory of ssi method de roeck 1999 the system matrix can be obtained by the least squares sense and the structural modal parameters can be also calculated easily 2 if the harmonic components resulted from the rotating impeller occupy the most energy of measured vibration signals the modal identification research will enter in direction 2 and a new process called hm ssi method dong et al 2014 may be applied in order to solve the problem that the structural natural modal information had been completely submerged in the harmonic frequency band assuming the harmonic components are present in the measured responses the harmonic modes with zero damping ratios in the system eigenmatrix can be obtained as successfully as the actual structural modes by classic ssi method when however the frequencies of both modes are close enough to each other and the harmonic energy is large confusion will be caused between the actual and harmonic modal information in the diagonal of the eigenvalue matrix produced by decomposing the system matrix so that false modes may emerge the hm ssi method was hence proposed so that there will be 2 h number of exact roots for h harmonics with known frequencies in the identification system matrix this modified algorithm will not only obtain the undamped known harmonic modes accurately but also separate the actual structural modal information from the harmonic modal components in the system matrix based on the harmonic frequencies in the responses the extension of harmonic hankel matrix to the past and future row space respectively will be constructed as eqs 2 and 3 due to an i time data delay at the corresponding location between the matrix y p and y f in eq 1 dong et al 2014 2 y p h 0 sin ω 1 δ t sin j 1 ω 1 δ t 1 cos ω 1 δ t cos j 1 ω 1 δ t 0 1 sin ω h δ t cos ω h δ t sin j 1 ω h δ t cos j 1 ω h δ t 2 h j 3 y f h sin i ω 1 δ t sin i 1 ω 1 δ t sin j i 1 ω 1 δ t cos i ω 1 δ t cos i 1 ω 1 δ t cos j i 1 ω 1 δ t sin i ω h δ t cos i ω h δ t sin i 1 ω h δ t cos i 1 ω h δ t sin j i 1 ω h δ t cos j i 1 ω h δ t 2 h j where y p h y f h are the harmonic extension matrices of row space which represent the past and the future respectively in the hankel matrix h is the number of harmonic components in response ω h is the circular frequency of the h th harmonic the past and future row spaces of the extended hankel can be defined as 4 y p e y p h y p m i 2 h j y f e y f h y f m i 2 h j hence the entire hankel correction matrix can be represented as follows 5 y e y p e y f e 2 m i 4 h j further the hankel correction matrix shown in eq 5 is the base of reconstruction of the proposed hm ssi method simultaneously the hankel matrix and the extension hankel matrices at time i 1 considering the harmonic components in responses can be also defined by eq 1 5 the new hm ssi method based on traditional ssi method can be reconstructed as proposed in ref 35 and the state space equation can be defined as 6 x ˆ i 1 e y i i a r e c r e x ˆ i e w i v i the new system eigenmatrix a r e and output matrix c r e can be solved by eq 4 7 x ˆ i 1 e y i i a r e c r e x ˆ i e or a r e c r e x ˆ i 1 e y i i x ˆ i e after obtaining the matrix a r e the extension system eigenmatrix can be decomposed using eigenvalue decomposition method to extract the exact structural modal information a part of the specific roots of the extension system matrix represent the added harmonic components and obviously the other parts will include the structural natural modal information of the system after the researches on modal identification completed by the traditional ssi and hm ssi method in two directions both the structural modal parameters and harmonic modal information can be obtained hence one modal resolution criterion such as modal assurance criterion mac method should be used to distinguish between real structural modes and false modes resulted from harmonic excitations and environment noise the operational modal parameter identification method technology of offshore wind turbine structure in the range of full power was described in fig 19 5 2 modal analysis in the range of full power in order to illustrate the engineering applicability of the operational modal identification method proposed in section 5 1 330 normal operational conditions in testing time of 60s were chosen and divided into four scopes as described in section 3 firstly four operational conditions of wind turbine in above four scopes of which include the rotating speed of 7 rpm 11 rpm 16 rpm 18 rpm and the power of 300 kw 600 kw 1400 kw 2400 kw respectively were selected to achieve the operational modal identification in both x and z directions as we all known the rotation frequency 1p frequency and 3p rotation frequency components make a great influence on the structural operational safety of offshore wind turbine in the resonance analysis because they are too close to the first order modal frequency hence only the first modal frequency will be chosen to achieve the modal identification and operational safety evaluation on one hand figs 20 and 21 describe the first modal frequencies computed only by the classic ssi method as a function of the system truncation order it is seen that the structural modal information can be distinguished through the traditional algorithm because the solid lines in the response spectrums of the different measured points reflect clearly the peaks at the first modal frequency which can be differentiated from the weak harmonic information as 0 183 hz specially obtained from fig 21 as shown in two curves the structural first modal frequencies under these conditions have an obvious dominant distribution in the range of 0 33 hz 0 34 hz and 0 34hz 0 37 hz with the corresponding damping ranges of 0 66 3 84 and 2 83 4 97 respectively on the other hand both the classic ssi method and hm ssi method were used to deal with the modal identification problem resulted from strong harmonic excitations when the rotating speed reaches 16 rpm and 18 rpm as described in figs 22 and 23 further the solid lines with different color in the response spectrums of the different measured points show clearly the peaks at the modal the corresponding rotation excitation frequencies of 0 267 hz and 0 30 hz induced by the structural forced vibration with the structural modal frequency of 0 33 hz in the curves owing to the influence induced by strong rotating frequencies the modal frequencies identified by the classic ssi method are close to the harmonic components and far from the actual structural modal frequency however the hm ssi method is more effective to distinguish between the structural and the harmonic modal information in the measured vibration responses when the wind turbine is operating with high rotation speed it is shown that the identified first operational modal frequencies in the range of 0 33hz 0 35 hz and 0 35hz 0 37 hz with the associated damping ranges of 3 02 6 54 and 1 73 8 15 respectively marked by the black square symbols has a great agreement with the value of 0 33 hz with the increase of system truncation order hence the proposed operational modal analysis process of offshore wind turbine in the range of full power should be carried out according to the frequency domain property of measured response data hereafter the structural modal analysis results in both two directions under other 26 typical operational conditions in the range of full power were listed in tables 1 and 2 it is shown that the first order identified modal frequencies of offshore wind turbine structure mainly concentrated in the range of 0 33 hz 0 37 hz with the damping ratio changing from 0 87 to 9 98 it can be seen that a slightly obvious increase trend in modal frequencies with the average value of 0 342 hz in first column 50 1200 kw and 0 355 hz in second column 1300 2500 kw corresponding to the average damping ratios of 3 62 and 6 58 in both x and z directions it is further illustrated that the identification results of the modal parameters should be correct and reasonable as the calculated modal assurance criterion mac values reflecting the correlation between the theoretical modal shapes and identified ones are all close to 1 0 regardless of the different excitation conditions in addition the variation law of identified modal frequencies and harmonic frequencies with the change of power is described in fig 24 as observed in fig 24 the 1p frequencies represented by black squares and 3p frequencies represented by black circles show an obvious increase trend with the variation of power because of the synchronization effect between the power and rotation speed meantime the identified harmonic interference frequencies shown by dark yellow circles may be consistent with the rotation frequencies 1p frequencies the identified structural modal frequencies in both x and z direction represented respectively by blue and red circles under all 330 operational conditions are relatively stable distributing mainly in the range of 0 33 hz 0 36 hz which decelerates the structural operational modal frequencies to obviously stay away from the danger area of structure resonance except for the power range less than 250 kw it is illustrated that the operational safety of the offshore wind turbine structure in the higher power range of rotating speeds of blades can be ensured and the operation in low wind speed and power should be reduced or strictly prohibited in order to avoid the resonance occur of power segment in the actual project 5 3 influence on modal identification from environment and operational factors figs 25 28 show the relationship between the identified modal results and environmental operational factors including wind speed rotation speed pitch angle and angle of nacelle it is observed that the modal frequency and damping ratio estimates gradually increase with the rising wind speed and rotation speed of blades in figs 25 and 26 this conclusion can be confirmed based on the average calculated results on structural modal frequencies of 0 337 hz 0 343 hz 0 350 hz and 0 355 hz with the corresponding damping ratios of 3 24 4 45 5 40 and 6 50 respectively in four wind speed scopes called levelⅰ levelⅱ levelⅲ and levelⅳ simultaneously the average value of identified modal frequencies as 0 352 hz in the rotation speed range of 15 rpm 18 rpm is larger than the same indexes of 0 341 hz and 0 346 hz at 6 rpm 10 rpm and 11 rpm 14 rpm the corresponding average damping ratio show 3 98 4 81 and 5 83 in above three ranges from low rotation speeds to high ones the operational modal identification trend with the change of wind speed and rotating speed is similar to the research results proposed by hansen in the hansen et al 2006 it is also illustrated that the increase of wind speed and rotating speed may lead to the change in whole system stiffness or mass matrix of offshore wind turbine structure so that it has certain influence on the operational modal frequencies in addition the total structural modal damping ratio is always consisted of the structural damping and the aerodynamic damping hu et al 2015b the former damping can be considered as a constant value ignoring the effect resulted from the rising wind speed and rotation speed however the aerodynamic damping generated by interaction between rotating blades and the changing wind field may vary positively with the increase of wind speed and rotation speed hence it is shown that the identified total structural damping ratios rise obviously when above the environmental operational factors become larger further the other factors including pitch angle and angle of nacelle could not make a positive influence on the modal estimates figs 27 and 28 prove that the identified modal frequencies and damping ratios are insensitive with the pitch angle and angle of nacelle and reflect a stable and concentrated distribution respectively in the range of 0 20 and 240 360 6 conclusion in this research the first chinese offshore wind turbine prototype with a new foundation called the composite bucket was selected and the structural vibration characteristics under different conditions such as standstill status normal status startup shutdown status and extreme typhoon status were deeply and systematically analyzed based on the observed vibration response data to further illustrate the influence regularity resulted from operational factors subsequently the vibration safety of the wind turbine structure under different operational conditions was also accurately fed back and fully discussed combined with a new modal analysis method called hm ssi method firstly there is a strictly positive correlation among the measured wind speed rotational speed power and the measured vibration amplitudes of the offshore wind turbine structure meet the limited safety standards under the different operational conditions with the increase of wind speed the offshore wind turbine structure which is only affected by the environmental excitations vibrates with the first natural modal frequency of 0 33 hz more and more severely under the standstill conditions however the increasing rotation speed leads to harmonic excitations which force the structure to vibrate at corresponding rotating frequencies after the generator starts running and the larger structural vibration exceeds the indexes when the wind turbine stops the familiar phenomenon in time and frequency domain can both be obviously found especially under the conditions of startup and shutdown secondly the increase of the wind speed may bring out potential danger to the wind turbine structure especially when the rotation speed reaches the rated speed in the extreme typhoon condition it makes a severe influence on structural vibration during the typhoon period contrast to the weak vibration effect under the standstill condition with large wind speed thirdly the integral operational modal identification method of offshore wind turbine in the range of full power was proposed based on traditional and modified ssi technologies and effective for practical engineering simultaneously it is also illustrated that the increase of wind speed and rotating speed has certain influence on the operational modal parameters finally the proposed research is not only beneficial to accurately master the structural vibration characteristics and operational behaviors of offshore wind turbine but also provides structural overall design with practical reference in the future the more researches may be implemented in order to achieve the real time vibration monitoring and operational safety evaluation of offshore wind turbine particularly under the extreme conditions acknowledgements the authors would like to acknowledge innovation method fund of china 2016im030100 the national natural science foundation of china 51709202 program of introducing talents of discipline to universities b14012 tianjin science and technology program 16ptgccx00160 and open foundation of state key laboratory of hydraulic engineering simulation and safety of tianjin university hess 1716 all workers from the state key laboratory of hydraulic engineering simulation and safety of tianjin university are also acknowledged the writers also acknowledge the assistance of anonymous reviewers 
23639,in order to reduce the structural failure and accident occurrence of the offshore wind turbine the researches on structural operational safety of offshore wind turbine based on the measured data during the operation periods should be carried out and considered as the key way to solve these problems however the current researches are only focused on numerical simulation model experiment and theoretical analysis and ignore the structural vibration characteristics analyzed from condition monitoring and prototype observation data from the actual wind turbine structure to compensate for this study defect the structural vibration displacement signals of one chinese offshore wind power prototype under different conditions were obtained based on a long term prototype observation in order to achieve the comprehensive and systematic research on vibration response characteristics and operational modal analysis of measured structure considering the complicated operational environment of offshore wind turbines the structural response regular pattern and vibration safety are also discussed emphatically under different conditions such as standstill normal operational startup shutdown and extreme typhoon status simultaneously the integral operational modal identification method of offshore wind turbine in the range of full power is proposed based on traditional and modified stochastic subspace identification technologies and further the modal identification results and the relationship between structural modal parameters and environmental operational factors are also illustrated in this paper the researches on the structural vibration characteristics and operational modal analysis of offshore wind turbine not only provide powerful data and technology support for the operation safety evaluation but also provide the necessary theoretical and practical bases for the design and maintenance of wind turbine structures keywords offshore wind turbine prototype observation structural vibration characteristics operational factors operational modal analysis 1 introduction the offshore wind power project has developed rapidly in recent years with the advantages of high wind speed low turbulence large output and long service life with the quick development of wind power the complexity of the structure greatly increases the operation safety risk of wind turbine because of larger capacity higher towers and bigger blades rodrigues et al 2015 especially in recent years the global safety accidents of wind turbine structures occurred frequently with the number of nearly 1000 only in 2014 seyr and muskulus 2016 the issues on operational behavior and structural safety of offshore wind turbine under different working conditions have begun to attract universal attention as we all known structural vibration monitoring and operational modal analysis are important means to master the operational behavior and structural safety of offshore wind turbine effectively with the development of modern measurement technology the researchers began to be interested in understanding the vibration characteristics of offshore wind turbine based on the measured data and try to obtain the operational behaviors bassett et al 2010 dynamic parameters ozbek et al 2010 2013 and structural safety benedetti et al 2011a 2011b by the feedback analysis in recent years firstly the monitoring systems applied to practical engineering were established improved and optimized based on existing system according to the dynamic characteristics of the wind turbine structure the environment and operational conditions with a view to more accurate and efficient collection processing analysis of prototype observation data yang 2013 schlechtingen et al 2013 schlechtingen and santos 2014 for example gokhan kilic and unluturk 2015 took the supervised event server health monitoring system seshms as a relatively simple economical wireless system for use within the arena of structural health assessment secondly the intuitive comprehensive and systematic researches on dynamic response characteristics change law the relationship between the operational parameters and vibration were carried on the basis of measured data kusiak and zhang 2010 hu hu et al 2015a 2015b focused on a resonance phenomenon environmental and operational influences on structural dynamic properties under normal operational conditions of a wind turbine system in 5 mw wind turbine on the basis of dynamic signals acquired continuously from the tubular tower under normal operational conditions during two years thirdly it is also necessary to carry out the feedback identification on the operational parameters and dynamic indexes of the wind turbine structure further the structural operational safety under different working conditions and long term monitoring can be evaluated by using these analysis indexes and the real time change rules andrew swartz et al 2010 bang et al 2012 a typical example is that moritz w hackell and rofles 2013 took one 5 mw offshore wind turbine structure as the research object the extraction of modal parameters and the estimation of condition parameters of wind turbine were implemented respectively by data driven stochastic subspace identification method and vector auto regressive var models finally the above mentioned research results on dynamic characteristics and work performance indicators can be utilized to establish the early warning or control system of wind turbine structure in order to ensure the operational safety of offshore wind turbine structure in the complex conditions currie et al 2015 iliopoulos a iliopoulos et al 2015 made use of a modal decomposition and expansion algorithm in order to predict the unknown position responses of offshore wind turbine structures with limited condition measured data however the present researches were also limited to the monitoring and analysis of single unit such as fan unit hackell and rofles 2013 tower kilic and unluturk 2015 foundation currie et al 2015 lacking of the consideration on the coupling vibration measurement of multiple structural components simultaneously the detailed interpretation on vibration characteristics and vibration mechanism of the whole offshore wind turbine structure should be completed further the most critical problem is how to deal with the interference of harmonic components in the modal analysis of offshore wind turbine structure in the current study jacobsen jacobsen et al 2007 and peeters peeters et al 2007 both tried to eliminate the harmonic components ahead of identifying modal frequencies so that the measured vibration signals are completely composed of the structural modal information nevertheless choosing an unsuitable filter will result in the easy loss of useful component because the frequencies of operational modes and harmonic modal frequencies may be close to each other gade gade et al 2009 jacobsen jacobsen 2006 jacobsen et al and modak modak et al 2010 modak 2013 considered that there are differences in statistical properties such as kurtosis and probability density function between random signals and harmonic signals and distinguished the real structural modes among the identification results from the unknown harmonic modes respectively using the frequency domain decomposition method singular value decomposition method and random decrement technique but the unavoidable deficiency is that the actual modal parameters cannot be obtained properly when the structural information completely submerges in the harmonic components in addition the new theories of transmissibility function hilbert huang transform and optimized spectral kurtosis have been applied successively to differentiating the actual structural and harmonic modes by devriendt devriendt et al 2009 weijtjens et al 2014 agneni agneni et al 2012 and dion dion et al 2012 however the ability of these methods to extract the natural modal information under the disturbances of strong harmonic energy has not been known to solve this difficult problem originated from harmonic disturbance p mohanty mohanty and rixen 2004a 2004b 2004c 2006 had modified several classic modal identification methods including lcse itd era and sstd method to obtain the actual modal information considering the influence of the harmonics on the characteristic matrix of structural system however it has a limitation in engineering application for the above modified methods because of the unstable identification resulted from the defect of the algorithm itself and their poor noise resistance on the basis of p mohanty s ideas dong et al 2014 introduced the strong harmonic interference information obtained from measurement data into the traditional stochastic subspace identification method ssi possessed stronger anti noise and better recognition stability subsequently a new modal identification method called harmonic modified stochastic subspace identification hm ssi method was proposed to successfully complete the studies on operational modal identification and operational safety evaluation of offshore wind turbine structure and the superiority of the method and engineering applicability were also verified in this paper the structural operational modal identification of tested offshore wind turbine affected by the strong harmonic excitations will be implemented based on the above method in summary it can be seen that it is lack of the vibration safety monitoring of the whole wind turbine and the support structure at the same time the field observation data of the offshore wind power project is extremely scarce the basic vibration characteristics of the offshore wind turbine structure and the operational modal analysis of the wind turbine under different conditions are lacking in comprehensive in depth and systematic research therefore the structural vibration characteristics of offshore wind turbines under different conditions such as standstill normal startup shutdown and extreme typhoon status were deeply analyzed to further illustrate the influence regularity resulted from operational factors and subsequently the vibration safety of the wind turbine structure under different operational conditions was fully discussed combined with a new modal analysis method called hm ssi method dong et al 2014 firstly the project overview of the measured offshore wind turbine is introduced in section 2 secondly the operational conditions of offshore wind turbine are proposed in section 3 to understand the characteristics and relationship between operational conditions and environmental factors additionally a detailed and comprehensive study on the vibration response characteristics of the offshore wind turbine structure under typical operational conditions is achieved in section 4 lastly the operational modal analysis of offshore wind turbine in the range of full power structural operational safety assessment and influence on modal identification from environment and operational factors are demonstrated systematically in section 5 based on the measured vibration responses the framework of this paper was shown in fig 1 2 prototype observation of offshore wind turbine structure the offshore wind turbine of this measurement is located in the yellow sea area adjacent to nantong city in jiangsu province of china a new foundation form of offshore wind turbine called the composite bucket foundation jijian et al 2012 lian et al 2011 was applied as the first prototype in the wind turbine experiment globally with 30 0 m in diameter 18 0 m in height and 2500t in the total weight a three blade direct drive wind turbine generator with rated power of 2 5 mw and the rotor rated speed of 18 rpm were selected simultaneously the cut in rated and cut out wind speed is 3 0 m s 12 0 m s and 25 0 m s respectively the 80 m tall tower which has working platforms between two adjacent parts of steel tower was installed in three parts zhang et al 2014 as described in fig 2 five observed points located at 1 5 m from each platform were instrumented inside the tower along the height direction three vibration displacement sensors with the frequency range of 0 1 200 hz in each measured location were used to acquire low frequency and multi directional structural vibration response signals the x tangential direction of cylinder wall and z vertical direction of cylinder wall directions are horizontal and y vertical ground direction direction is vertical besides the total testing time was more than one month and sampling frequency was chosen as 200 hz in this field measurement specially four typhoons saola damrey haikui and bolaven had passed this test area in august 2012 and saola and damrey landed at the same time which produced the double typhoons effect fig 2 presents the location of geographical position of offshore wind turbine prototype arrangement of the measured points vibration displacement sensors and signal acquisition system arranged in the offshore wind turbine 3 environment and operational conditions of offshore wind turbine from 26rd july to 1st september in 2012 the variables such as operational wind speed rotation speed power pitch angle of blades and orientation angle of nacelle were also recorded in every 10 min in order to study conveniently the environmental and operational influences on the dynamic properties of the offshore wind turbine structure the mean values of above variables in every 10 min were considered and the measured wind speed was divided into four scopes representing levelⅰ less than 5 5 m s levelⅱ 5 5 8 0 m s levelⅲ 8 0 10 8 m s and levelⅳ more than 10 8 m s the corresponding time history and probabilistic histogram curves of five environmental and operational factors described in figs 3 7 as shown in fig 3 the measured mean wind speeds change from 0 12 m s to 15 70 m s and most of them are distributed around the 5 0 8 0 m s range three peaks appear at the dates those are from 2nd to 4th 7th to 9th and 27th to 29th in august because the typhoons saola damrey haikui and bolaven passed with the average wind speed of 13 78 m s 15 70 m s and 14 88 m s respectively it is observed that the average rotation speed fluctuates stably and the maximum value is 17 89 rpm close to rated factor as 18 0 rpm in fig 4 except for the conditions of 1 rpm or less the distribution of rotation speed keeps substantially constant from 7 rpm to 16 rpm with a maximum peak in the range of 13 rpm 14 rpm due to the more standstill conditions during typhoons three data aggregations emerge near to rotation speed of 0 rpm inspection of fig 5 describes that more than 51 98 of the average power change from 0 5 mw to 1 5 mw and only 3 39 of those operational factors surpass 2 0 mw with the maximum value of 2 43 mw in fig 6 it is illustrated that the offshore wind turbine runs well because most of the measured pitch angles emerge less than 5 simultaneously there are three obvious peaks at the range form 0 to 20 because of the same reason of typhoons it also can be seen that the angle of nacelle changed cyclically from 0 to 180 before august 15th and no obvious rule can be followed when the field measurement continued from fig 7 the main wind direction of this experiment was determined as southeast se shown as the wind rose chart further the relationship between wind speed and power rotation speed pitch angle is described in fig 8 a b c d e show the change rule of pitch angle and power with the variation of rotation speed in four wind speed levels represented respectively by black red yellow and blue circles as shown in fig 8 a the theoretical data and curve of power for the offshore wind turbine are also described with a similar change trend to measure mean data of power when the wind speed increases four obvious distribution lines can be found easily stable at 0 mw 0 5 mw 1 0 mw and 1 5 mw corresponding to the standstill condition and three stable output conditions though the wind speed become larger constantly it appears that the rotation speed rises generally and almost linearly with increase of the wind speed from 0 0 to 15 7 m s and reaches near the maximum rotation speed of 17 89 rpm when the wind speed surpass 10 0 m s in fig 8 b meantime it is worth noting that the rotation speed seems to jump to a higher value when approaching 10 rpm and 14 rpm which represents the larger occurrence percentage of rotation speed in fig 4 b the relationship between pitch angle and wind speed is described in fig 8 c it can be found that the pitch angle decrease from nearly 98 18 to about 0 when the wind speed is below 10 0 m s on the contrary it increases gradually from 0 to 20 when the wind speed rises and the rotation speed is steady around 15 7 rpm as shown in fig 8 c fig 8 d indicates that the pitch angle decreases with rising rotation speed and increase slightly again as rotation speeds reaches 15 7 rpm it is explained that the power increases quickly to the rated value of 2 50 mw with the variation of rotation speed especially when the measured factor changes from 7 rpm to 17 89 rpm as described in fig 8 e using various colors to represent the different levels of the power as depicted in fig 9 the relationship between the wind speed rotation speed and power can be represented where the wind turbine operational unit demonstrates a clear increasing trend as the wind speed and rotational speed increase simultaneously it is also declared that there is a strictly positive correlation between the measured wind speed and the rotation speed and this phenomenon maintains the characteristics of the direct drive wind turbine 4 structural vibration characteristics of offshore wind turbine 4 1 standstill conditions as described in fig 10 the root mean square rms values of the observed response signals in x direction and z direction from 1 5 measurement points are chosen to analyze the vibration characteristics of the wind turbine structure under the standstill conditions it is illustrated that the structural vibration shows a positive correlation with the wind speed when only subjected to the environment excitations because the rms values of vibration displacement signals both in two directions rise obviously with the variation of environmental wind speed at the range from 2 0 m s to 14 0 m s taking the measured signals in x direction from 1 observation point as an example the vibration amplitude increases rapidly when the wind speed exceeds 10 0 m s and reaches a maximum of 19 78 mm at the average wind speed of 13 5 m s simultaneously the same rms values from other four measured points calculated to be 8 49 mm 1 35 mm 0 34 mm and 0 096 mm fig 10 b depicts the similar regular pattern among the responses of five testing points and greater vibration amplitude in z direction with the maximum values of 33 09 mm 13 73 mm 1 51 mm 0 48 mm and 0 216 mm further the normalized power spectrums of structural horizontal vibration response signals at 1 measured point under typical standstill conditions with the wind speed of 2 2 m s 5 0 m s 7 5 m s 10 0 m s were drawn in fig 11 it is shown that the peak frequencies of four vibration responses in both two directions concentrated at 0 33 hz which can be considered as the first structural modal frequency dong et al 2014 the similar results are also found in the dominant frequencies of vibration responses with the range of 0 317 hz 0 344 hz under the standstill conditions at all 5 measured points it is illustrated that vibration responses reflecting the frequency closed to low order modal information can be produced under the standstill conditions because the offshore wind turbine structure may be only influenced by environment excitations including wind wave 4 2 normal operational conditions hundreds of measured operational conditions were selected to reflect better the vibration characteristics of offshore wind turbine and the influence on vibration resulted from the operational factors such as wind speed and rotation speed hence the rms value is chosen as the research value and trend of structural vibration displacements at 1 measured point with the change of wind speed and rotation speed are described in fig 12 overall both of two factors made an obvious positive correlation with horizontal vibration amplitudes asymptotically two extreme points with the rms values of 30 18 mm and 41 61 mm in x direction can be found corresponding to the conditions at wind speed of 14 6 m s and 10 9 m s rotation speed of 16 rpm and 8 rpm respectively as shown in fig 12 a the maximum vibration in z direction was calculated to be 57 38 mm under the condition of wind speed of 11 3 m s and rotation speed of 18 rpm fig 13 show the normalized power spectrums of structural horizontal vibration responses at 1 measured point under six typical operational conditions with the wind speed of 4 0 m s 6 0 m s 7 2 m s 9 3 m s 10 0 m s 12 1 m s and rotation speed of 9 rpm 11 rpm 11 rpm 13 rpm 16 rpm 18 rpm it is explained that the vibration of wind turbine reflects the natural modal frequency characteristic close to 0 33 hz represented by black and red lines because of the weaker effect on the dynamic responses originated from rotating impeller under the conditions with lower environment factors with the increase of rotation speed the harmonic components occupies the most of vibration energy and the similar dominant frequencies equivalent to the rotation frequencies of 0 20 hz 0 22 hz 0 26 hz and 0 30 hz appear in the power spectrums of both horizontal directions it is further explained that the dominant vibration form of wind turbine change from the random vibration reflecting modal frequency induced environmental loads to forced vibration in rotation frequencies resulted from operating impeller when the operational factors rise the same regular pattern is also found in fig 14 4 3 transition conditions 4 3 1 startup conditions the startup condition of offshore wind turbine involves a transition process that the generator changes from the quiescent state into the operational status three different conditions with the wind speed of 4 0 m s 5 5 m s 8 4 m s were measured lasting the testing time of 150s the wind power generator starts to operate at 60s in every measurement the vibration time histories structural vibration characteristics and time frequency spectrums in both time and frequency domains of measured vibration responses in z direction at 1 observed point are described in fig 15 as shown in fig 15 the whole startup process can be divided into four typical stages including standstill transition startup and operation generally speaking the poorer structural vibration with the natural modal frequency of 0 33 hz excited only by environmental load occurs at standstill status in the transition process the structural vibration amplitude will change weakly with the lower increase of unit torque and rotation speed of impeller hereafter the structural vibration of wind turbine increases rapidly and runs stably until it gets the maximum value because of the continued increase of rotation speed in the startup and operational process meanwhile the information at rotational frequencies at 0 20 hz 0 23 hz and 0 27 hz occupy most of vibration energy as also described in fig 13 the structural vibration displacements of the offshore wind turbine in the startup process show obviously higher than those in the operational conditions with the increases of 17 04 42 00 33 82 in x direction and 32 89 35 19 24 14 in z direction at the wind speed of 4 0 m s 5 5 m s and 8 4 m s respectively 4 3 2 shutdown conditions the shutdown condition of offshore wind turbine involves a transition process that the generator changes from the working status into standstill condition without the operational excitations four different conditions with the wind speed of 5 0 m s 7 6 m s 9 0 m s and 10 7 m s were measured lasting the testing time of 150s the wind power generator starts to rest at a reasonable time in every measurement the time histories structural vibration characteristics and waterfall map in both time and frequency domains of measured vibration responses in z direction at 1 observed point are described in fig 16 as shown in fig 16 four typical stages called respectively operation shutdown transition and standstill are drawn in the entire time history of vibration signal it is found that the vibration responses reflect the harmonic frequency information corresponding to the rotational frequencies of 0 22 hz 0 22 hz 0 25 hz and 0 30 hz at four measured conditions firstly due to the sudden brake impact of the generator the vibration amplitude will significantly increase in a short time without the external continuous excitations the offshore wind turbine structure may not vibrate gradually to become stable by the follow effect of its own inertia until the machine completely stops operating at this time vibration displacements of wind turbine structure become relatively smaller because of the alone effect originated from the external environment and show the all of four dominant frequencies at 0 33 hz meantime the significant large amplitude multi period characteristics of the vibration signals before shutdown can be found compared to the properties of single cycle and small amplitude under the standstill condition the vibration displacements of wind turbine structure during the shutdown process increase obviously comparing to the amplitudes in the operational conditions the magnification of structural vibration is calculated as 10 76 256 72 130 87 5 21 in x direction and 2 58 83 61 114 47 30 37 in z direction under the condition of wind speed at 5 0 m s 7 6 m s 9 m s and 10 7 m s 4 4 typhoon conditions in this field measurement the nearest distance between the location of offshore wind turbine prototype and typhoon eye are about 216 82 km 230 77 km and 316 62 km respectively further the distance ranges of 7 level typhoons are 200 km 400 km and 350 km therefore it can be found that the measured offshore wind turbine structure was affected dominantly by 7 level typhoons fig 17 shows the time history curves of structural vibration in x z directions and the variation curves of operational wind speed and rotation speed during the three typhoon measurements with the numbers 1 to 5 representing the different operating stages of offshore wind turbine it is illustrated that the offshore wind turbine structure can remain stable under the affection of 7 level typhoons with the maximum vibration displacement of 20 60 cm 12 58 cm 27 42 cm corresponding to the maximum instantaneous wind speed as 17 0 m s 26 0 m s 20 0 m s here are some further analyses on typical vibration type and characteristics of the wind turbine structure during the typhoons as described in figs 17 a 3 b 2 c 2 the wind turbine transfer into enclosed shut down status with basically zero rotor speed to decrease the structural damage resulted from the larger instantaneous wind speed which may exceed 9 0 m s in that period hence the lower structural vibration displacements in both x and z directions will occur only affected by environment excitations moreover the generator does not start up and remained standstill condition with the cut in wind speed lower than 3 0 m s and the rotation speed at zero as shown in figs 17 a 1 b 4 c 4 fig 17 a 2 b 1 c 3 5 illustrate that an obvious synchronization excited between the rotation speed and operational wind speed of offshore wind turbine under the measured operational conditions it is further explained that the rotation speed totally depends on the instantaneous wind speed which mainly distributes in the range of 3 0 m s 10 0 m s and generally reflects lower than rated wind speed 12 5 m s therefore the vibration of wind turbine is effected by the rotation of impeller and environment loads in a normal operational status without interference in the extreme typhoon conditions the increase of the wind speed might bring out potential danger to the wind turbine structure especially when the rotation speed reaches the rated speed usually speaking the power should be limited to control the rotation speed in order to reduce the structural vibration in fig 17 a 4 5 b 3 c 1 the rotation speeds do not synchronize with wind speed which already exceeded than rated wind speed comparing to fig 18 which shows the rotation speed versus power during the test period of typhoon saola damrey haikui and bolaven the phenomenon that the rotation speed is depended on power rather than wind speed condition can be found firstly figs 17 a 4 shows a typical condition that rotation speed is controlled by fixing power in addition the sudden increase of power close to 2 5 mw leads to an obvious increment of structural vibration even though the wind speed of typhoon and the hidden danger reduces shown in figs 17 a 5 furthermore it can be seen in figs 17 b 3 that the structural vibration amplitude changes with the increase of rotation speed under the different fixed load operational conditions because the power of wind turbine is selected lower than 1 5 mw fig 17 c 1 gives the result that the vibration of wind turbine gradually weakens with the decrease of rotation speed resulted from the limited power even if the operational wind speed obviously increases it is elaborated that the structural vibration is mainly effected by rotation speed compared to wind speed meantime the vibration maximum value of wind turbine structure during the typhoon saola damrey and bolaven appears at the rated operational conditions respectively as described in figs 17 a 5 c 1 however the same index of typhoon haikui can be found under the operational condition without interference at fig 17 b 1 it is illustrated that the operation at rated speed of wind turbine makes a severe influence on structural vibration during the typhoon period contrast to the weak vibration effect under the standstill condition with large wind speed 5 operational modal analysis of offshore wind turbine in the range of full power 5 1 operational modal identification theory in order to achieve the operational modal identification of offshore wind turbine in the range of power the research on frequency domain characteristics of measured vibration responses should be carried out to determine the dominant frequency information reflected from structural vibration firstly hereafter the operational modal parameter identification problem can be divided into two directions according to the frequency characteristics of the vibration responses 1 in direction 1 the traditional ssi method can be used to complete the studies on structural modal analysis when the vibration responses only reflect the natural modal information in the frequency domain or the difference can be clearly found between the structural modal and harmonic modal information with the assume of zero damping feature as we all known the basic idea of ssi method is that the eigenmatrix of structural dynamic system is constructed with measured responses and the modal information can be obtained using eigenvalue decomposition method based on the hankel matrix supposing the number of observed points on the offshore wind turbine structure is m and the measured data length of each point is j a 2 m i j dimension hankel matrix containing 2 i block rows and j columns is composed of measured response data according to eq 1 de roeck 1999 1 y 0 2 i 1 1 j y 0 y 1 y 2 y j 1 y 1 y i 1 y 2 y i y 3 y i 1 y j y i j 2 y i y i 1 y i 2 y i j 1 y i 1 y i 2 y i 3 y i j y 2 i 1 y 2 i y 2 i 1 y 2 i j 2 2 m i j y 0 i 1 y i 2 i 1 y p y f where y i represents responses of all measured points at time i y 0 i 1 and y i 2 i 1 are the matrix representing the first i block and the second i block respectively y p and y f are defined by splitting the hankel matrix into two parts of i block rows the subscripts p and f stand for past and future based on the theory of ssi method de roeck 1999 the system matrix can be obtained by the least squares sense and the structural modal parameters can be also calculated easily 2 if the harmonic components resulted from the rotating impeller occupy the most energy of measured vibration signals the modal identification research will enter in direction 2 and a new process called hm ssi method dong et al 2014 may be applied in order to solve the problem that the structural natural modal information had been completely submerged in the harmonic frequency band assuming the harmonic components are present in the measured responses the harmonic modes with zero damping ratios in the system eigenmatrix can be obtained as successfully as the actual structural modes by classic ssi method when however the frequencies of both modes are close enough to each other and the harmonic energy is large confusion will be caused between the actual and harmonic modal information in the diagonal of the eigenvalue matrix produced by decomposing the system matrix so that false modes may emerge the hm ssi method was hence proposed so that there will be 2 h number of exact roots for h harmonics with known frequencies in the identification system matrix this modified algorithm will not only obtain the undamped known harmonic modes accurately but also separate the actual structural modal information from the harmonic modal components in the system matrix based on the harmonic frequencies in the responses the extension of harmonic hankel matrix to the past and future row space respectively will be constructed as eqs 2 and 3 due to an i time data delay at the corresponding location between the matrix y p and y f in eq 1 dong et al 2014 2 y p h 0 sin ω 1 δ t sin j 1 ω 1 δ t 1 cos ω 1 δ t cos j 1 ω 1 δ t 0 1 sin ω h δ t cos ω h δ t sin j 1 ω h δ t cos j 1 ω h δ t 2 h j 3 y f h sin i ω 1 δ t sin i 1 ω 1 δ t sin j i 1 ω 1 δ t cos i ω 1 δ t cos i 1 ω 1 δ t cos j i 1 ω 1 δ t sin i ω h δ t cos i ω h δ t sin i 1 ω h δ t cos i 1 ω h δ t sin j i 1 ω h δ t cos j i 1 ω h δ t 2 h j where y p h y f h are the harmonic extension matrices of row space which represent the past and the future respectively in the hankel matrix h is the number of harmonic components in response ω h is the circular frequency of the h th harmonic the past and future row spaces of the extended hankel can be defined as 4 y p e y p h y p m i 2 h j y f e y f h y f m i 2 h j hence the entire hankel correction matrix can be represented as follows 5 y e y p e y f e 2 m i 4 h j further the hankel correction matrix shown in eq 5 is the base of reconstruction of the proposed hm ssi method simultaneously the hankel matrix and the extension hankel matrices at time i 1 considering the harmonic components in responses can be also defined by eq 1 5 the new hm ssi method based on traditional ssi method can be reconstructed as proposed in ref 35 and the state space equation can be defined as 6 x ˆ i 1 e y i i a r e c r e x ˆ i e w i v i the new system eigenmatrix a r e and output matrix c r e can be solved by eq 4 7 x ˆ i 1 e y i i a r e c r e x ˆ i e or a r e c r e x ˆ i 1 e y i i x ˆ i e after obtaining the matrix a r e the extension system eigenmatrix can be decomposed using eigenvalue decomposition method to extract the exact structural modal information a part of the specific roots of the extension system matrix represent the added harmonic components and obviously the other parts will include the structural natural modal information of the system after the researches on modal identification completed by the traditional ssi and hm ssi method in two directions both the structural modal parameters and harmonic modal information can be obtained hence one modal resolution criterion such as modal assurance criterion mac method should be used to distinguish between real structural modes and false modes resulted from harmonic excitations and environment noise the operational modal parameter identification method technology of offshore wind turbine structure in the range of full power was described in fig 19 5 2 modal analysis in the range of full power in order to illustrate the engineering applicability of the operational modal identification method proposed in section 5 1 330 normal operational conditions in testing time of 60s were chosen and divided into four scopes as described in section 3 firstly four operational conditions of wind turbine in above four scopes of which include the rotating speed of 7 rpm 11 rpm 16 rpm 18 rpm and the power of 300 kw 600 kw 1400 kw 2400 kw respectively were selected to achieve the operational modal identification in both x and z directions as we all known the rotation frequency 1p frequency and 3p rotation frequency components make a great influence on the structural operational safety of offshore wind turbine in the resonance analysis because they are too close to the first order modal frequency hence only the first modal frequency will be chosen to achieve the modal identification and operational safety evaluation on one hand figs 20 and 21 describe the first modal frequencies computed only by the classic ssi method as a function of the system truncation order it is seen that the structural modal information can be distinguished through the traditional algorithm because the solid lines in the response spectrums of the different measured points reflect clearly the peaks at the first modal frequency which can be differentiated from the weak harmonic information as 0 183 hz specially obtained from fig 21 as shown in two curves the structural first modal frequencies under these conditions have an obvious dominant distribution in the range of 0 33 hz 0 34 hz and 0 34hz 0 37 hz with the corresponding damping ranges of 0 66 3 84 and 2 83 4 97 respectively on the other hand both the classic ssi method and hm ssi method were used to deal with the modal identification problem resulted from strong harmonic excitations when the rotating speed reaches 16 rpm and 18 rpm as described in figs 22 and 23 further the solid lines with different color in the response spectrums of the different measured points show clearly the peaks at the modal the corresponding rotation excitation frequencies of 0 267 hz and 0 30 hz induced by the structural forced vibration with the structural modal frequency of 0 33 hz in the curves owing to the influence induced by strong rotating frequencies the modal frequencies identified by the classic ssi method are close to the harmonic components and far from the actual structural modal frequency however the hm ssi method is more effective to distinguish between the structural and the harmonic modal information in the measured vibration responses when the wind turbine is operating with high rotation speed it is shown that the identified first operational modal frequencies in the range of 0 33hz 0 35 hz and 0 35hz 0 37 hz with the associated damping ranges of 3 02 6 54 and 1 73 8 15 respectively marked by the black square symbols has a great agreement with the value of 0 33 hz with the increase of system truncation order hence the proposed operational modal analysis process of offshore wind turbine in the range of full power should be carried out according to the frequency domain property of measured response data hereafter the structural modal analysis results in both two directions under other 26 typical operational conditions in the range of full power were listed in tables 1 and 2 it is shown that the first order identified modal frequencies of offshore wind turbine structure mainly concentrated in the range of 0 33 hz 0 37 hz with the damping ratio changing from 0 87 to 9 98 it can be seen that a slightly obvious increase trend in modal frequencies with the average value of 0 342 hz in first column 50 1200 kw and 0 355 hz in second column 1300 2500 kw corresponding to the average damping ratios of 3 62 and 6 58 in both x and z directions it is further illustrated that the identification results of the modal parameters should be correct and reasonable as the calculated modal assurance criterion mac values reflecting the correlation between the theoretical modal shapes and identified ones are all close to 1 0 regardless of the different excitation conditions in addition the variation law of identified modal frequencies and harmonic frequencies with the change of power is described in fig 24 as observed in fig 24 the 1p frequencies represented by black squares and 3p frequencies represented by black circles show an obvious increase trend with the variation of power because of the synchronization effect between the power and rotation speed meantime the identified harmonic interference frequencies shown by dark yellow circles may be consistent with the rotation frequencies 1p frequencies the identified structural modal frequencies in both x and z direction represented respectively by blue and red circles under all 330 operational conditions are relatively stable distributing mainly in the range of 0 33 hz 0 36 hz which decelerates the structural operational modal frequencies to obviously stay away from the danger area of structure resonance except for the power range less than 250 kw it is illustrated that the operational safety of the offshore wind turbine structure in the higher power range of rotating speeds of blades can be ensured and the operation in low wind speed and power should be reduced or strictly prohibited in order to avoid the resonance occur of power segment in the actual project 5 3 influence on modal identification from environment and operational factors figs 25 28 show the relationship between the identified modal results and environmental operational factors including wind speed rotation speed pitch angle and angle of nacelle it is observed that the modal frequency and damping ratio estimates gradually increase with the rising wind speed and rotation speed of blades in figs 25 and 26 this conclusion can be confirmed based on the average calculated results on structural modal frequencies of 0 337 hz 0 343 hz 0 350 hz and 0 355 hz with the corresponding damping ratios of 3 24 4 45 5 40 and 6 50 respectively in four wind speed scopes called levelⅰ levelⅱ levelⅲ and levelⅳ simultaneously the average value of identified modal frequencies as 0 352 hz in the rotation speed range of 15 rpm 18 rpm is larger than the same indexes of 0 341 hz and 0 346 hz at 6 rpm 10 rpm and 11 rpm 14 rpm the corresponding average damping ratio show 3 98 4 81 and 5 83 in above three ranges from low rotation speeds to high ones the operational modal identification trend with the change of wind speed and rotating speed is similar to the research results proposed by hansen in the hansen et al 2006 it is also illustrated that the increase of wind speed and rotating speed may lead to the change in whole system stiffness or mass matrix of offshore wind turbine structure so that it has certain influence on the operational modal frequencies in addition the total structural modal damping ratio is always consisted of the structural damping and the aerodynamic damping hu et al 2015b the former damping can be considered as a constant value ignoring the effect resulted from the rising wind speed and rotation speed however the aerodynamic damping generated by interaction between rotating blades and the changing wind field may vary positively with the increase of wind speed and rotation speed hence it is shown that the identified total structural damping ratios rise obviously when above the environmental operational factors become larger further the other factors including pitch angle and angle of nacelle could not make a positive influence on the modal estimates figs 27 and 28 prove that the identified modal frequencies and damping ratios are insensitive with the pitch angle and angle of nacelle and reflect a stable and concentrated distribution respectively in the range of 0 20 and 240 360 6 conclusion in this research the first chinese offshore wind turbine prototype with a new foundation called the composite bucket was selected and the structural vibration characteristics under different conditions such as standstill status normal status startup shutdown status and extreme typhoon status were deeply and systematically analyzed based on the observed vibration response data to further illustrate the influence regularity resulted from operational factors subsequently the vibration safety of the wind turbine structure under different operational conditions was also accurately fed back and fully discussed combined with a new modal analysis method called hm ssi method firstly there is a strictly positive correlation among the measured wind speed rotational speed power and the measured vibration amplitudes of the offshore wind turbine structure meet the limited safety standards under the different operational conditions with the increase of wind speed the offshore wind turbine structure which is only affected by the environmental excitations vibrates with the first natural modal frequency of 0 33 hz more and more severely under the standstill conditions however the increasing rotation speed leads to harmonic excitations which force the structure to vibrate at corresponding rotating frequencies after the generator starts running and the larger structural vibration exceeds the indexes when the wind turbine stops the familiar phenomenon in time and frequency domain can both be obviously found especially under the conditions of startup and shutdown secondly the increase of the wind speed may bring out potential danger to the wind turbine structure especially when the rotation speed reaches the rated speed in the extreme typhoon condition it makes a severe influence on structural vibration during the typhoon period contrast to the weak vibration effect under the standstill condition with large wind speed thirdly the integral operational modal identification method of offshore wind turbine in the range of full power was proposed based on traditional and modified ssi technologies and effective for practical engineering simultaneously it is also illustrated that the increase of wind speed and rotating speed has certain influence on the operational modal parameters finally the proposed research is not only beneficial to accurately master the structural vibration characteristics and operational behaviors of offshore wind turbine but also provides structural overall design with practical reference in the future the more researches may be implemented in order to achieve the real time vibration monitoring and operational safety evaluation of offshore wind turbine particularly under the extreme conditions acknowledgements the authors would like to acknowledge innovation method fund of china 2016im030100 the national natural science foundation of china 51709202 program of introducing talents of discipline to universities b14012 tianjin science and technology program 16ptgccx00160 and open foundation of state key laboratory of hydraulic engineering simulation and safety of tianjin university hess 1716 all workers from the state key laboratory of hydraulic engineering simulation and safety of tianjin university are also acknowledged the writers also acknowledge the assistance of anonymous reviewers 
