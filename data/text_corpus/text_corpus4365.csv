index,text
21825,this paper presents a study for investigating and identifying features of oscillation patterns induced by vessel motions in the context of statistical pattern recognition on the basis of time domain oscillation series in addition to traditional frequency domain analysis numerical simulations are carried out for a semi enclosed harbor of variable depth with different vessel motions as external agitation sources and the oscillation responses are measured at multiple locations along the backwall in the longshore direction and along one sidewall in the offshore direction vector autoregressive type models are proposed and applied on the recorded oscillation time series from clustering of the selected vector autoregressive model coefficients fitted to the oscillation responses both the influences of a changing bathymetry and those of various vessel motions can be recognized although some of them are insensitive to frequency domain analysis and cannot be revealed with the amplitude spectra with mahalanobis distances calculated from the spatially distributed measurements at observation points within the harbor an insight into the internal structure and energy distribution of the vessel induced oscillations can be achieved by extracting the probability density distributions and the occurrence or absence of certain oscillation components or modes can be analyzed with the proposed pattern recognition approach keywords harbor oscillations vector autoregressive model statistical pattern recognition numerical experiments 1 introduction oscillations due to the trapping and amplifying effects of a semi enclosed area with variable water depth such as a bay or a harbor may cause transient destructive effects with their non trapped modes or long lasting detrimental effects with their trapped modes by inducing intolerable vessel motions and inacceptable wave force upon the marine structures within the semi enclosed area harbor oscillations may lead to severe problems such as interruption of cargo operations excessive forces within mooring ropes overturning of vessels and even damage or failure of marine structures while the oscillation events as a suffering of many harbors around the world are reported in continuance chen et al 2004 gonzález marco et al 2008 kofoed hansen et al 2005 kumar 2017 kumar et al 2014 2016 investigations about their associated hydrodynamic phenomena and wave patterns are worth further concerns in both engineering and scientific aspects research efforts have been made in the first place for harbor oscillations generated by external forcing coming from the open sea outside of the semi enclosed harbor area and both stationary and transient ones have been studied chen et al 2006 de girolamo 1996 dong et al 2010a gao et al 2019b losada et al 2008 mei and agnon 1989 vanoni and carr 1950 investigations have also been carried out for the oscillations induced with the occurrence of inner harbor agitation forces including submarine landslides seafloor movements atmospheric pressures water surface disturbance etc gao et al 2018b kulikov et al 1996 shao et al 2016 2017b wang et al 2011 yalciner and pelinovsky 2007 for harbor oscillations induced by various external forces or on different bathymetries frequency domain approaches such as spectra analysis are widely employed in the investigations based on the assumption of a quasi linear expansion of the stochastic moving water surface of the oscillations as a system of independent random variables bellotti 2007 dong et al 2010a gao et al 2017 2018a 2019a kakinuma et al 2009 kumar et al 2016 rabinovich 2010 shao et al 2017b thotagamuwage and pattiaratchi 2014a wang et al 2011 with field observations or simulations utilizing well developed numerical models water level measurements of harbor oscillations have been extracted at a certain number of observation points as basic data for analysis in general the frequency domain analysis is carried out based on the records of the oscillating water surface when it turns into a quasi steady state together with the frequency domain analysis some time domain attempts have also been made in analyzing harbor oscillation series for their evolution over time by mainly taking advantage of wavelet analysis or even artificial intelligence methods dong et al 2010b gao et al 2016 kankal and yüksek 2012 2014 londhe and deo 2004 thotagamuwage and pattiaratchi 2014b for the time series analysis autoregressive models have been successfully applied to the structural mechanics in the first place and then to hydrodynamics with vibration based structure detections coefficients of autoregressive models have been used for the extraction of structural features in different conditions including damaged and undamaged ones carden and brownjohn 2008 das et al 2016 gul and catbas 2011 hoell and omenzetter 2016 sohn et al 2000 zhang et al 2018 spatial information about the features can also be provided with an analysis of the vibration response of the structure measured at multiple locations and in this regard vector autoregressive models and moving average ones may have the potential to be used in the spatial identification of the features bodeux and golinval 2003 carden and brownjohn 2008 gul and catbas 2009 heyns 1997 jayawardhana et al 2015 owen et al 2001 yao and pakzad 2012 in addition to the success of the autoregressive models in structural analysis the same kinds of time series models have also been applied in hydrodynamic domain and utilized for representing and analyzing metocean variables together with floating body dynamics including the motions of ships and wave energy converters degtyarev and gankevich 2015 2019 degtyarev et al 2019 fusco and ringwood 2010 gankevich and degtyarev 2018 jäger et al 2019 reed et al 2016 vanem and walker 2013 hydrodynamic features in both spatial and temporal aspects can be extracted with the application of autoregressive models and on account of that predictions can be made in a data driven manner instead of time consuming numerical simulations an analysis applied directly on the instantaneously recorded harbor oscillation patterns in time domain may be profitable to investigate the time series mostly with non stationary nature and extricate us from the limitations of assumed stationarity and small amplitude wave theory which are generally the basis of frequency domain analysis of wave patterns as the autoregressive kind models have been proved to be able to capture the characteristics of propagating wave profiles and their evolutions they may present an efficient tool for the time series analysis of the harbor oscillation problems with their computational performance this paper presents a comprehensive study to investigate the harbor oscillations induced by vessel motions with bathymetry effects taken into account with conventional analysis in frequency domain for the induced harbor oscillations an analysis method for the time domain harbor oscillation behavior is proposed in the context of a pattern recognition problem an overview of the vector autoregressive model is presented in section 2 together with the proposed diagnosis scheme theoretical formulations of harbor oscillations with variable water depth are briefly reviewed in section 3 before the numerical model simulating the vessel induced oscillations the numerical results are compared with theoretical solutions as a validation more detailed numerical investigations are presented in the following section with considerations of the effects of variations in both regard to the harbor bathymetry and vessel motions multivariate autoregressive models are used to predict the oscillation time series recorded from multiple locations within the harbor features for different locations are extracted and analyzed with mahalanobis distances by measuring the amount of variations in the coefficients of vector autoregressive models conclusions are drawn in the last section 2 pattern recognition procedure the vector autoregressive moving average model v a r m a p q is employed in the analysis procedure of the oscillations induced by vessel motions within the semi enclosed harbor area described in the following sections the form of the model can be written as 1 y t i 1 p φ i y t i j 1 q θ j ε t j ε t where y t y 1 t y 2 t y n t t corresponds to as the vector of dependent response variables and ε t ε 1 t ε 2 t ε n t t is referred to the vector white noise process here the parameters p and q represent orders of the autoregressive and moving average parts of the varma model respectively with n representing the number of dependent response variables used in estimating the varma model in this study n will be the number of observation points where oscillation time history responses have been measured within the harbor the interpretation of this model is that the response variables which are water surface responses at different locations are not only contemporaneously correlated to each other but also correlated to each other s past values the model coefficients in eq 1 φ i and θ j include implicitly information about physical properties of the harbor and the moving vessel the φ i coefficients define the ar function of order p and can be used to determine the natural frequencies mode profiles and damping ratios while θ j coefficients define the ma function of order q and include information about power of the response in different modes pandit and wu 1983 therefore if only modal properties of the harbor oscillation patterns are required the water surface response can be modeled exclusively by the ar part of the model and besides which it is possible to express all varma models with ar models of infinite order theoretically nevertheless in a practical account they may be modeled adequately by a finite order series box et al 1994 there are several different criteria such as the akaike information criterion aic ljung 1987 and schwarz s bayesian criterion sbc schwarz 1978 that can be checked to suggest the required order of the ar model by checking the randomness and gaussianity of the prediction errors through trial and error the order of the ar model is determined in this study in parallel with these criteria the var model coefficients are estimated with least squares regression and for each set of the harbor oscillation time histories p matrices will be obtained as components of φ φ 1 φ 2 φ i φ p where φ i can be given in matrix form as 2 φ i φ 11 i φ 12 i φ 1 n i φ 21 i φ 22 i φ 2 n i φ n 1 i φ n 2 i φ m n i while they are related to the mode profiles and modal frequencies andersen 1997 andersen and brincker 1998 the relation between these coefficients and the modal parameters can be expressed by 3 0 i 0 0 0 0 i 0 0 0 0 i φ p φ p 1 φ p 2 φ 1 ψ μ ψ 1 with μ and ψ indicating respectively the eigenvalues and the mode profiles whereas m equals to n p 4 μ diag μ i 5 ψ ψ 1 ψ m μ 1 ψ 1 μ n p ψ m μ 1 p 1 ψ 1 μ n p p 1 ψ m for the pattern recognition procedure the diagnosis approach can be divided into several steps during which the oscillation responses of the harbor obtained at a variety of conditions are indirectly compared to each other by extracting sensitive features revealed by the application of the chosen varma models to the observation data and by statistically measuring the deviations that occur in the estimated coefficients of the models due to the underlying mechanisms coefficients of the varma model include spatiotemporal information about the vessel induced oscillations and the amount of deviation observed for different harbor or vessel motion conditions may potentially reveal information about the oscillation characteristics the details are discussed in the following three steps for the pattern recognition procedure of the harbor oscillations induced by vessel motions 1 formation of the observed oscillation sample the recorded oscillation data at different conditions are divided into smaller data samples in this diagnosis scheme which leads to obtaining a number of different varma models representing the oscillation response of the harbor in smaller data samples rather than fitting one single model to the entire recorded oscillation time history with this step the effect of uncertainty in predicting the parameters of varma models can be indirectly included in the diagnosis scheme and the generation of a statistical distribution for the extracted features can be generated 2 oscillation data reduction in this step of the proposed damage diagnosis scheme the point of importance consists of estimating the parameters of the varma models for each data sample generated from the measured data sets within the chosen models the matrix coefficients particularly the diagonal terms φ j j 1 and φ j j 2 from matrices φ 1 and φ 2 in eq 2 can be used to extract features at different conditions for the harbor affected by vessel induced bores since coefficients for recent time lags like φ 1 and φ 2 are the most informative about different modes of the oscillations of the free surface within the harbor whereas other terms in the coefficient matrix may include mixed information pandit and wu 1983 the φ j j 1 and φ j j 2 terms calculated from different data samples can be plotted against each other for comparison the number of data points is equal to the number of segments in the recorded oscillation data in their corresponding condition 3 oscillation feature extraction and statistical evaluation a statistical measure called mahalanobis distance was employed to recognize the variation patterns in the selected terms of the varma models by measuring the distance between the selected terms corresponding to a condition of interest and thence used to extract the features of oscillations induced by vessel motions generally the mahalanobis distance of a multivariate potential outlier vector x x 1 x 2 x n t from a group with mean μ and covariance matrix s is given by 6 d m x x μ t s 1 x μ statistical evaluation can be carried out on the calculated features in order to identify patterns of the induced harbor oscillations and the evaluation is performed by comparison between the features calculated for a variety of conditions of interest with both the mean and the variance values of the features taken into account the selected terms of the fitted varma models should experience more or less important deviations within the harbor under different conditions since these coefficients are directly related to the oscillation properties according to eq 3 5 the deviations in the fitted model coefficients are captured by taking advantage of mahalanobis distances with quantifications of the magnitude of the calculated mahalanobis distances or the variations in the varma coefficients for a brief verification of the described analysis method the varma models are in the first place applied onto analytical curves and those with gaussian white noise signals to test their capability in capturing the characteristics of time series it can be seen in fig 1 a that a white noise sequence is well generated with the ar function of the first order with φ 0 and the autocorrelation of the process in fig 1 b is shown to be validated for the gaussian white noise with a kronecker delta at the zero lag and a small tail remaining within the upper and lower confidence bounds presented with dashed lines in fig 2 a sinusoidal curve and another one with damping are perfectly captured by the varma models with orders less than five when a tiny gaussian white noise sequence is superposed upon the analytical curves the characteristics of the artificial curves are also well captured with a fitness over 90 with the model orders within one digit 3 numerical study and model validation the numerical investigations of oscillations induced by vessel motions are conducted within relatively idealized bathymetries with a rectangular semi enclosed harbor geometry and a piecewise seabed consisted of two slopes to better fitting natural coastal conditions simulations are carried out with the well tested funwave tvd package developed at the university of delaware kirby et al 1998 funwave tvd is a fully nonlinear boussinesq wave model with a godunov type riemann solver shi et al 2012b and developed based on a complete set of fully nonlinear boussinesq equations with the vertical vorticity correction derived by chen 2006 and a time varying reference elevation introduced by kennedy et al 2001 the governing equations of the numerical model are organized in a conservative form to facilitate a hybrid numerical scheme including third order runge kutta time stepping gottlieb et al 2001 and muscl tvd scheme of fourth order accuracy erduran et al 2005 within the riemann solver the model has been validated against a suite of benchmark test data in coastal applications kirby 2016 kirby et al 2013 lynett et al 2017 shi et al 2012a tehranirad et al 2011 the mass conservation equations are expressed in the following form 8 η t m 0 9 m h u a u 2 with η representing the wave surface elevation and m the mass flux u α and u 2 denote the velocity at a reference elevation and the depth averaged o μ 2 respectively where dimensionless parameter characterizing frequency dispersion μ is the ratio of the characteristic water depth to a horizontal length the total depth h h η with h the still water depth the conservative form of the depth integrated horizontal momentum equations is given as 10 m t m m h 1 2 g η 2 2 h η v d i s g η h g h p a s brk in which the dispersive terms are contained in v d i s shi et al 2012a and the pressure source term generating the ship wake is presented with the third term on the right hand side the last term s brk on rhs is the dissipation term related to the artificial eddy viscosity in the same form of kennedy et al 2001 in addition to the shallow water equation based shock capturing breaker the eddy viscosity is described by 11 ν b δ 2 h η η t with δ the mixing length coefficient equivalent to one in this work for numerical stability b may vary smoothly from 0 to 1 however with the inherent stability of the tvd numerical scheme no numerical instability has been found during the simulations in this study without any smooth transition by adding or flagging out different terms within the source code funwave tvd can be applied as a linear water wave transformation model or to simulate water wave propagations with different levels of boussinesq approximations with nonlinear terms the sponge layers of the model package are well validated and can effectively damp the energy of outgoing waves with different frequencies and directions which is essential for harbor oscillation studies in a numerical manner in our work the spongy layers are placed around the boards of the computational domain at a certain distance away from the outlet of the harbor to ensure an open sea condition the vessel motions are considered with pressure source for ship wakes ertekin et al 1986 torsvik et al 2008 wu 1987 which may be given as 12 p a x y t p f x t q y t where p a x y t is the static depression around the vessel and p controls the surface displacements which can be interpreted as the inverse barometer effect corresponding to the static surface depression for a stationary vessel the coordinate system for the pressure source may be rotated by an angle relative to the boussinesq coordinate system if necessary with a center point of the pressure located at x y f x t and q y t can be expressed respectively as 13 f x t cos 2 π x x t 1 2 α l 1 α l 1 2 α l x x t 1 2 l 1 x x t 1 2 α l 14 q y t cos 2 π y y t 1 2 β r 1 β r 1 2 β r y y t 1 2 r 1 y y t 1 2 β r inside the area l 2 x x t l 2 and r 2 y y t r 2 and their values diminish to zero outside with l and r representing the length and width of the pressure source the shape of the draft region is determined by the parameters α and β with 0 α β 1 when the static draft of the vessel is denoted with d the values of the shape parameters can be evaluated by adjusting them to match the submerged volume of the vessel with a given block coefficient with c b v s u b l r d p a d x d y l r d the block coefficient can be given as c b 0 5 and the shape parameters are often assumed to be equal with α β in real calculations in order to carry out investigations of the vessel induced harbor oscillations the fidelity of the numerical model in simulating the wave patterns generated by moving vessel in depth limited waters is in the first place validated with analytical solution derived by havelock et al havelock 1908 as an enhancement of the formulations for kelvin wake in deep water illustrated in fig 3 a the virtual open sea area extends 840 m and 408 m in the longitudinal and the transverse direction respectively with a water depth of 5 m the vessel moves along the middle axe of the area in the longitudinal direction the half angles θ k of the ship wake simulated with havelock s model setup are compared with the analytical solution with regard to the froude number f r h in fig 3 b and the wedges behind the moving vessel are shown to be well captured by the above described numerical model for the fidelity of the boussinesq type numerical model in the investigation of harbor oscillation problems induced by the vessel induce bores the oscillations generated by a moving vessel on two kinds of harbor bathymetries are simulated and compared with the analytical solutions of shao et al 2017a including a constant slope and a two slope piecewise seabed within the harbor the computational domain is set up following the usual practice in harbor oscillation researches as shown in fig 4 the backwall of the harbor running in the y direction is situated at x 0 and x increases offshore the axis z is positive upward from the still water level a rectangular harbor of constant slope is located between x 0 and x l the seafloor of the open sea outside the harbor is horizontal the length of the harbor is relatively long compared with its width 2 b as evident oscillations frequently occur in long and narrow harbors in the meantime as the transverse oscillations may appear in a harbor destabilized by things like small or local disturbances the harbor width 2 b may not be too small to restrain their occurrence with these considerations an l 2 5 k m long and 2 b 0 5 k m wide rectangular harbor of conventional dimension is chosen in the numerical simulations for the model validation since in a practical account the speeds of vessels in entering and leaving the harbor are limited according to regulations mainly with security concerns and the vessels may travel at a speed between 5 and 6 n m i h nautical mile per hour for conventional port waters a vessel of typical hull form of 20 m long and 10 m wide with α v 0 5 and β v 0 5 is set to moving at 5 83 n m i h 10 8 k m h from the backwall to the mouth of the harbor namely in the outward direction which may consequently generate ship induced bores within the harbor with results of previous researches of this kind of harbor oscillation problems carried out in recent years as it is known that an external disturbance located at or along sidewall of the semi enclosed harbor area may excite as numerous oscillation modes as possible the motion path of the vessel is chosen to be along one sidewall of the harbor described above oscillations are simulated for the harbor on two kinds of bottom including a constant slope s 0 02 and another one of two slope piecewise bottom s 1 0 02 s 2 0 03 with the same water depth at the back wall h 1 5 m as validation tests the piecewise bottom is given by 15 h x y s 1 x h 1 0 x x 1 s 2 x h 2 x 1 x l h p l x where s 1 is the slope of the first part of the bottom and s 2 is that of the second one with h 2 h 1 s 1 s 2 x 1 the water depth at the point of inflection the computational domain is 0 x 3 5 km and 1 25 km y 1 25 km which dimension the ranges in the longshore and offshore directions in fig 4 the grid size is δ x δ y 5 m and the time step is δ t 0 05 s three sponge layers of 0 5 km width are placed outside the harbor at a certain distance in the three seaward directions to absorb the energy radiated by the water motion at the entrance the model is run for sufficiently long time for each simulation as the oscillations within the harbor reach their stable state as oscillations of relatively small amplitudes due to the vessel moving with limited speed are focused in this work the nonlinear interactions between different components can be neglected in the quasi steady state inside the harbor in assuming the independence of each oscillation component following the methods used by shao et al 2017b in analyzing the oscillations induced by submerged sliding masses along the seabed surface the oscillation components are detected with the amplitude spectra at the corner of the harbor where the amplitude factor of oscillations may attain its maximum the spatial direction of the oscillations longitudinal or transverse is revealed mainly from their profiles in the offshore direction as indicated in numerous analytical investigations of harbor oscillation the longitudinal ones have no variation across the harbor but vary along the sidewall whereas the transverse ones have m node lines in parallel with the sidewall and n node lines in parallel with the backwall for the mode m n the spatial structure of each component along the backwall is used to confirm it as longitudinal or transverse if the motion is transverse it is further used to identify the value of m corresponding to mode m n the profile of the components along the sidewall is used to identify the mode of the longitudinal oscillation or the offshore node number n of the transverse mode m n space gauges are installed right at the entrance of the harbor to monitor the energy leaks outside and when it is lower than 0 1 of that contained in the oscillations at the backwall a quasi steady state is deemed to be attained with numerous numerical tests the oscillations caused by vessel motions are found to be able to reach their quasi steady state faster for relatively mild seabed than for slightly steeper sloping seabed the spectra analysis of the simulated free surface elevations is carried out with the time segment after the stabilization of the oscillations with a very large total number of temporal points the frequency components within the harbor for both the two kinds of bottom are revealed by the amplitude spectrum shown in fig 5 and their properties can be further identified from their spatial structure it can be seen that very weak longitudinal resonances of very low frequency present within the harbor and the wave patterns are controlled by transverse oscillations of different modes the numerically simulated components frequencies of relatively important intensity and their corresponding theoretical ones calculated from formulations 16 are listed in table 1 for each case 16 u α 1 1 τ 11 u α 2 1 τ 21 u α 2 1 τ 21 u α 1 1 τ 11 2 m α 1 1 τ 10 m α 1 1 τ 10 u α 2 1 τ 21 m α 1 1 τ 11 u α 2 1 τ 21 m α 1 1 τ 11 2 u α 1 1 τ 10 u α 1 1 τ 10 0 where u and m are the two linearly independent confluent hypergeometric functions and 17 α j 1 2 1 ω 2 g k m n s j j 1 2 18 τ j 1 2 k m n s j s j x 1 h j j 1 2 19 τ 10 2 k m n s 1 h 1 with ω the angular frequency and k m n m π 2 b m 1 2 3 indicating the eigenvalue of the m t h transverse oscillation mode the constant slope bottom can be theoretically regarded as a special case of the two slope piecewise one when s 1 s 2 it can be seen theoretically that the transverse oscillation components on a constant slope s and on a piecewise bottom with s 1 s share nearly the same theoretical frequencies for relatively low modes with the values listed in the table it is observed that the numerically calculated frequencies of the components are very close to the analytical ones especially for the modes with both small m and small n for the modes with larger n as the corresponding wave profiles extend farther in the offshore direction they may be subjected to a greater influence of the deepening of the water and the errors f t f n f t may reasonably become slightly larger well captured by the analytical solutions the offshore profiles of the several principal components trapped within the harbor on each slope are represented in fig 6 and compared with those of the corresponding theoretical modes with the same amplitude at the backwall it can be revealed from the comparisons of the seaward wave profiles that for the oscillations induced by vessel moving from the backwall all the way to the mouth of the harbor higher modes in the offshore direction with larger n can be more easily exited than those in the longshore direction with larger m as the vessel itinerary traverse more antinodes of these higher offshore modes for the mode with larger m 2 0 the appearance of traces of very small antinodes makes it deviate slightly from the theoretical curve at a certain distance away from the backwall and this may be imputed to the disturbances from the higher offshore modes oscillating at tightly surrounding frequencies 4 analysis of oscillations induced by vessel motions from the frequency domain analysis of numerical results presented in the validation cases for the harbor oscillations induced by vessel motions on two kinds of bottom it is generally revealed that similar to the oscillations generated by submerged sliding masses or other external disturbances transverse oscillations occur as the principle components containing most of the oscillation energy inside the harbor with relatively weak longitudinal components situating in low frequency region of the spectra while the vessel moves right along one sidewall of the harbor from the backwall all the way to the entrance the occurrence of the components as numerous as possible can be observed and as the transverse components are trapped modes their oscillation energy may be maintained within the harbor whereas the longitudinal ones dissipate with the passage of time with the model settings indicated in the previous section a range of numerical experiments are carried out to investigate the oscillations induced by various vessel motions with different harbor bathymetries by means of the conventional frequency domain analysis method and in addition to which the pattern recognition procedure proposed in section 2 is employed onto the time series of the numerical simulations and thereby further examines the spatiotemporal characteristics of the oscillation behavior 4 1 the effects of the changing vessel motions and harbor bathymetry in frequency domain the analysis of the effects of the changing vessel motions and harbor bathymetry are in the first place carried out in frequency domain with the same vessel motions as external excitation generating oscillations within the semi enclosed harbor the frequencies of the principle oscillation components with one or two nodes in the longshore direction which may contain most of the oscillation energy are reported in fig 7 for a variation of the bottom slope and water depth of the harbor it is revealed that with an increasing water depth for the whole inner harbor area either due to a steeper bottom slope shown in fig 7 a or a deeper backwall water depth shown in fig 7 b the frequencies of the oscillation components with different longshore and offshore mode number shift to larger values note that in case b as the changing backwall water depth may lead to an evenly changing water depth over the whole range of the harbor the change of the frequencies of different offshore oscillation modes appears also nearly homogeneous when the backwall water depth increases from 5 m to 20 m which conforms to the possible water depth for this kind of bathymetry in reality on the other hand while the bottom slope turns steeper shown in case a a more significant deepening may occur farther away from the backwall and in consequence the oscillation components with larger offshore mode number are subjected to influence of greater importance on the vessel side it can be seen from fig 8 that the frequency domain behavior of the oscillations is in general insensitive to the variation of the moving speed of the vessel and also to the direction of the movement within the harbor with merely infinitesimal change in the distribution of energy on the occurring oscillation modes shown by their relative amplitudes almost all these oscillation modes keep their frequencies when the outgoing vessel along one sidewall of the harbor speeds up from 2 m s to 10 m s following the same path most of the oscillation modes remain stable when the moving vessel changes its direction from outward to inward especially the ones with lower frequencies which embody a best part of the total oscillation energy within the harbor when the oscillations are induced by vessel moving outside of the harbor at a certain distance from the entrance following a path parallel to the shoreline their behaviors in frequency domain are quite different in comparison with those induced by the aforementioned outgoing vessel inside the harbor relatively important longitudinal modes occur over lower frequency range together with several transverse modes with larger offshore mode number since the external disturbances come from outside of the harbor and the higher offshore modes may take precedence to be generated over lower ones whose oscillation energy is concentrated near the backwall of the harbor farther away from the entrance 4 2 pattern recognition for the oscillation time series it is revealed in the previous subsections that the changing vessel motions or harbor bathymetries can to some extent affect the frequency domain behavior of the induced oscillations however with their assumptions or approximations the frequency domain analysis may sometimes fail to capture some characteristics of the oscillations which are in essence time series more or less unstable and it may also be interesting to know the time domain behavior on its own and the proposed pattern recognition procedure is applied onto the recorded time series under different conditions following precedent threads of thought the influencing factors on both the vessel side and the harbor side are examined and discussed as what has been done in the previous subsection on the harbor side attention is focused on the slope and water depth of the harbor bathymetry in the aspect of vessel motions in addition to the effects of various moving speed those of the itinerary of the vessel are also analyzed including comparisons between the vessel moving inwards or outwards the harbor and the itinerary being located within or outside of the harbor shown in fig 8 the corresponding var coefficients of the oscillation time series with these changing conditions on the vessel side are plotted in fig 9 fig 9 a shows a distinct amount of variation in the var coefficients with a changing constant slope of the harbor bottom and the distinction seems mainly controlled by the first coefficient of the applied vector autoregressive moving average model while the chosen values of the slope are mild and consistent with the realistic coastal bathymetries it can be regarded that slight variations of the mild slopes may lead to a relatively apparent clustering of the var results of the recorded time series and thus the time domain oscillation characteristics of the water surface within the semi enclosed harbor for a variation of water depth at the backwall of the harbor in fig 9 b which can exist in reality for this kind of bathymetry although the clustering seems less distinct than that for the bottom slope a monotonic trend of the var results with regard to the first coefficient can be observed as shifting to smaller values when the water within the harbor becomes deeper it is to a certain degree physically reasonable that the scatter points for different bottom slope disaggregate more intensively into groups than those for different backwall water depth since a varying bottom slope may change not only the inclination of the bottom surface itself but also the overall water depth within the harbor in the meantime which can consequently change both resonance frequencies and amplitude profiles of the oscillation components induced by vessel motions a similar monotonic trend can also be seen in the subplot c for the changing velocity of the vessel motions and the values of the first var coefficient are found to increase with a faster moving vessel as the changing vessel speed mainly controls the agitation intensity of the ship wake which may merely influence the induced oscillation amplitudes therewith and the frequencies of almost of the oscillation modes remain the same as reported in the previous subsection with frequency domain analysis relatively limited clustering trends are observed in addition as the vessel may travel in both directions in entering and leaving the semi enclosed harbor simplified cases are considered the vessel follows an inward and outward straight line as its moving path and the consequent var results shown in fig 9 d form two clusters which can be practically separated by a simple oblique line placed between them which indicates that the time domain oscillation patterns induced by the vessel motions in the two directions may differ from each other to a considerable extent this observation is only captured with the pattern recognition presented here but fails to be found in the preceding frequency domain analysis with a clear separation observed in fig 9 e between the aggregation of the scatter points in red representing the var coefficients calculated for the oscillation time series induced by a seaward moving vessel departing from the backwall within the semi enclosed harbor and that of the vessels traveling in the longshore direction outside of the harbor marked in other colors obvious difference between the time domain patterns of the oscillations generated in the two different manners can be deduced similar to what has been captured by the previous frequency domain analysis fig 8 e as the moving vessel not only pushes the water in front of the stem but also forms a region of recirculating flow immediately behind the stern with the wave front of the wake patterns at a certain angle from the moving path the direction and relative location of the vessel path or itinerary with regard to the spatial layout of the harbor may carry weight in the generation of the surrounding wave patterns within the harbor however for the three vessels traveling outside of the harbor entrance with their paths located parallel to each other at different exterior spacing practically no distinct clustering can be found among the induced oscillations as different parallel paths of the vessel motions may have little impact on the propagation of the generated wave patterns an observation also coinciding with the frequency domain results as the time series of the oscillation surface are measured at a variety of locations within the harbor a clustering can also be seen in comparing the patterns from different locations and this kind of clustering can be more quantitatively illustrated by taking advantage of the distribution of probability density of the calculated mahalanobis distances for the time series measured at different observation locations since it can be revealed from the analytical solutions shao et al 2017a that for the spatial profiles of different transverse oscillation modes nodes and antinodes succeed each other in both the longshore and offshore directions the time series recorded right at the nodes of a certain oscillation mode may not contain its information whereas those recorded at the antinodes can theoretically carry the information of this mode to its maximum while all the oscillation modes may have their largest antinode right at the backwall of the semi enclosed harbor in the offshore direction the water surface time history at the backwall is chosen as a reference for the comparisons for the modes with different n similarly for the longshore direction as the largest antinodes of all the modes with different m occur right at the sidewall where the water surface history can be chosen for comparisons in the longshore direction within the observed oscillations close attention is given to the four lowest components with non zero offshore nodes with n from 1 to 4 as they may contain most of the perceptible resonance energy for these oscillation components induced by a vessel moving outwards along one sidewall of the harbor on a constant slope s 0 02 the positions of the nodes are listed in table 2 which are extracted from the wave profiles in the results of the numerical simulations and these positions can also be well captured by theoretical solutions amplitude spectra in frequency domain obtained from the time series recorded at the nodes of these four components are shown in fig 10 in comparison with those obtained right at the backwall of the harbor and the deletions of the pic of corresponding mode are illustrated within the spectra a reduction of the intensity of a certain lower oscillation modes can merely be seen with the attenuation of their pics when the oscillation time series are observed farther away from the backwall of the harbor on certain nodes of higher offshore modes with larger mode number n and from the superficial frequency domain analysis and comparisons little information can be further extracted the probability density of the calculated mahalanobis distance for the first node the only node of mode n 1 at 185 m the second node of mode n 2 at 530 m the third node of mode n 3 at 875 m and the fourth node of mode n 4 at 1210 m are presented in fig 11 a in general the calculated probability densities can be fitted closely to normal distribution as can be seen from all the dotted fitting curves for the four oscillation modes the probability densities are concentrated towards larger mahalanobis distance with nearly the same distribution width when the time series are recorded on nodes of higher offshore oscillation modes as these chosen positions of the nodes recede from the backwall of the harbor one after another it seems in a superficial manner that the concentration of the probability density tends to shift larger when they are recorded farther away in the offshore direction however when the mahalanobis distances are calculated for mode n 2 with the time history measured on the first node of this mode at only 130 m away from the backwall closer than the second node at 530 m the median of the fitted probability density bell curve blue dotted curve in fig 11 b moves on the contrary to larger mahalanobis distance and tightly close to the medians of those for mode n 3 and 4 respectively fitted by green and purple dotted curves as it can be seen from table 3 that the first node of mode n 2 at 130 m is situated in the proximity of the first node of mode n 3 and 4 it is reasonable that the mahalanobis distances calculated from the time history here are significantly influenced by these two higher modes and may carry characteristics of these two modes similar phenomenon is revealed within the harbor of constant slope with s 0 03 and the probability densities of the calculated mahalanobis distance for the four principle offshore oscillation modes are shown in fig 12 a and fig 12 b the mean values and variances corresponding to the mahalanobis distances of the time histories measured at the mentioned locations are listed in table 3 in the meantime another feature of the distribution of the probability density of the mahalanobis distances may also be drawn from figs 11 and 12 for both bathymetries with different slope s 0 02 and s 0 03 which refers to a relative stagnation or stability of the bell shape of the fitted curves when the observation points move onto the nodes of higher offshore oscillation modes farther away seawards in order to further elucidate this observation the means and variances of the mahalanobis distance calculated with regard to the reference for the time histories measured at the 250 observation points arranged in the manner as the ops shown in fig 4 in the offshore direction from the backwall all the way to the harbor entrance are illustrated in fig 13 it is revealed that the mean values of the calculated mahalanobis distances do not show a growing or downward trend but begin to level off at a certain distance away from the backwall the means begin to converge towards a relatively fixe value of 1 5 in the second half of the harbor together with the variances approaching a value of 0 2 in addition in the vicinity of the backwall a monotonic tendency can neither be seen for the mean values nor for the variances from fig 13 the fluctuations in this part of the harbor together with the subsequent convergences near the mouth of harbor may to some extent show a conformity to the feature observed within the bell shape curve in figs 11 and 12 5 conclusion this study presents a novel sensitive harbor oscillation feature in the context of statistical pattern recognition to analyze the spatiotemporal oscillation behaviors induced by vessel motions within a harbor of variable water depth by taking advantage of the time domain oscillation series in addition to frequency domain analysis in order to capture the vessel induced oscillation behaviors from this perspective vector autoregressive model is proposed to examine the recorded oscillation time histories of the water surface within the semi enclosed harbor at different observation points and from which features are extracted by measuring the amount of deviations calculated with the selected varma coefficients as both the harbor bathymetry and the movements of the vessel may change the oscillation behavior time series of the water surface induced on a variation of harbor bottom slope and inner harbor water depth are investigated together with those generated with changing vessel motions with different velocity traveling direction and location of the movements frequency domain analysis show that the changing conditions in harbor bathymetry including the slope and water depth may have influence on the oscillation frequencies of different modes whereas a changing vessel direction or velocity may neither affect the mode frequencies nor the occurrence of different modes however the pattern recognition results on the basis of the time domain series demonstrate that more or less distinct clustering of the varma coefficients can be observed not only for the time series with the changing conditions affecting a priori the frequency domain behavior but also for those with the changing conditions of little importance in frequency domain analysis among all the conditions being investigated a changing bottom slope may have the most significant influence on the time domain behavior of the oscillations as it modifies both the water depth distribution and bottom profile within the harbor for the vessel side it is interestingly to note that palpable separation can be observed between the time domain oscillation behaviors induced by a vessel traveling in different direction the same kind of separation can also be found for those induced by a vessel moving inside or outside the harbor in addition to the responses of the harbor oscillations induced by vessel motions to variations of external conditions the information of internal structure of the induced oscillations can also be revealed with the pattern recognition approach on account of the recorded time series at different observation locations as a further step than the clustering analysis of the varma coefficients mahalanobis distances of them with regard to a reference and their probability density distribution are employed to investigate the spatial behavior of the oscillations in which the energy is contributed by different internal components the resonance modes while the profile of probability density distribution of the calculated mahalanobis distances remains generally unchanged the mean of these distances may to some extent illustrate the occurrence or absence of certain resonance components or modes in the internal structure of the oscillations within the harbor the proposed pattern recognition procedure in this study can be potentially applied to other nearshore hydrodynamic analysis especially for wave propagations or resonances and on more realistic coastal bathymetries it should also be mentioned that the characteristics of the internal structure of the wave patterns may be revealed by a successful implementation of the proposed procedure in the requirement of time domain measurements at multiple locations which are spatiotemporally correlated to each other in an intrinsic manner in addition although the investigations have been carried out in this study on the oscillations induced by vessel motions different behaviors of oscillations or other wave patterns induced by other types of external forcing sources such as meteorological events and submerge landslides may also be potentially identified by implementing the proposed procedure credit authorship contribution statement dong shao conceptualization methodology formal analysis software investigation writing original draft writing review editing yun xing methodology validation supervision writing original draft writing review editing visualization funding acquisition zirui zheng methodology software formal analysis investigation validation writing review editing gang jiang supervision writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported financially by the natural science foundation of jiangsu province china bk20171468 the authors are also grateful for the discussions and suggestions given by the professors carrying out researches in the domain of structure health monitoring from which the inspiration of this study is drawn 
21825,this paper presents a study for investigating and identifying features of oscillation patterns induced by vessel motions in the context of statistical pattern recognition on the basis of time domain oscillation series in addition to traditional frequency domain analysis numerical simulations are carried out for a semi enclosed harbor of variable depth with different vessel motions as external agitation sources and the oscillation responses are measured at multiple locations along the backwall in the longshore direction and along one sidewall in the offshore direction vector autoregressive type models are proposed and applied on the recorded oscillation time series from clustering of the selected vector autoregressive model coefficients fitted to the oscillation responses both the influences of a changing bathymetry and those of various vessel motions can be recognized although some of them are insensitive to frequency domain analysis and cannot be revealed with the amplitude spectra with mahalanobis distances calculated from the spatially distributed measurements at observation points within the harbor an insight into the internal structure and energy distribution of the vessel induced oscillations can be achieved by extracting the probability density distributions and the occurrence or absence of certain oscillation components or modes can be analyzed with the proposed pattern recognition approach keywords harbor oscillations vector autoregressive model statistical pattern recognition numerical experiments 1 introduction oscillations due to the trapping and amplifying effects of a semi enclosed area with variable water depth such as a bay or a harbor may cause transient destructive effects with their non trapped modes or long lasting detrimental effects with their trapped modes by inducing intolerable vessel motions and inacceptable wave force upon the marine structures within the semi enclosed area harbor oscillations may lead to severe problems such as interruption of cargo operations excessive forces within mooring ropes overturning of vessels and even damage or failure of marine structures while the oscillation events as a suffering of many harbors around the world are reported in continuance chen et al 2004 gonzález marco et al 2008 kofoed hansen et al 2005 kumar 2017 kumar et al 2014 2016 investigations about their associated hydrodynamic phenomena and wave patterns are worth further concerns in both engineering and scientific aspects research efforts have been made in the first place for harbor oscillations generated by external forcing coming from the open sea outside of the semi enclosed harbor area and both stationary and transient ones have been studied chen et al 2006 de girolamo 1996 dong et al 2010a gao et al 2019b losada et al 2008 mei and agnon 1989 vanoni and carr 1950 investigations have also been carried out for the oscillations induced with the occurrence of inner harbor agitation forces including submarine landslides seafloor movements atmospheric pressures water surface disturbance etc gao et al 2018b kulikov et al 1996 shao et al 2016 2017b wang et al 2011 yalciner and pelinovsky 2007 for harbor oscillations induced by various external forces or on different bathymetries frequency domain approaches such as spectra analysis are widely employed in the investigations based on the assumption of a quasi linear expansion of the stochastic moving water surface of the oscillations as a system of independent random variables bellotti 2007 dong et al 2010a gao et al 2017 2018a 2019a kakinuma et al 2009 kumar et al 2016 rabinovich 2010 shao et al 2017b thotagamuwage and pattiaratchi 2014a wang et al 2011 with field observations or simulations utilizing well developed numerical models water level measurements of harbor oscillations have been extracted at a certain number of observation points as basic data for analysis in general the frequency domain analysis is carried out based on the records of the oscillating water surface when it turns into a quasi steady state together with the frequency domain analysis some time domain attempts have also been made in analyzing harbor oscillation series for their evolution over time by mainly taking advantage of wavelet analysis or even artificial intelligence methods dong et al 2010b gao et al 2016 kankal and yüksek 2012 2014 londhe and deo 2004 thotagamuwage and pattiaratchi 2014b for the time series analysis autoregressive models have been successfully applied to the structural mechanics in the first place and then to hydrodynamics with vibration based structure detections coefficients of autoregressive models have been used for the extraction of structural features in different conditions including damaged and undamaged ones carden and brownjohn 2008 das et al 2016 gul and catbas 2011 hoell and omenzetter 2016 sohn et al 2000 zhang et al 2018 spatial information about the features can also be provided with an analysis of the vibration response of the structure measured at multiple locations and in this regard vector autoregressive models and moving average ones may have the potential to be used in the spatial identification of the features bodeux and golinval 2003 carden and brownjohn 2008 gul and catbas 2009 heyns 1997 jayawardhana et al 2015 owen et al 2001 yao and pakzad 2012 in addition to the success of the autoregressive models in structural analysis the same kinds of time series models have also been applied in hydrodynamic domain and utilized for representing and analyzing metocean variables together with floating body dynamics including the motions of ships and wave energy converters degtyarev and gankevich 2015 2019 degtyarev et al 2019 fusco and ringwood 2010 gankevich and degtyarev 2018 jäger et al 2019 reed et al 2016 vanem and walker 2013 hydrodynamic features in both spatial and temporal aspects can be extracted with the application of autoregressive models and on account of that predictions can be made in a data driven manner instead of time consuming numerical simulations an analysis applied directly on the instantaneously recorded harbor oscillation patterns in time domain may be profitable to investigate the time series mostly with non stationary nature and extricate us from the limitations of assumed stationarity and small amplitude wave theory which are generally the basis of frequency domain analysis of wave patterns as the autoregressive kind models have been proved to be able to capture the characteristics of propagating wave profiles and their evolutions they may present an efficient tool for the time series analysis of the harbor oscillation problems with their computational performance this paper presents a comprehensive study to investigate the harbor oscillations induced by vessel motions with bathymetry effects taken into account with conventional analysis in frequency domain for the induced harbor oscillations an analysis method for the time domain harbor oscillation behavior is proposed in the context of a pattern recognition problem an overview of the vector autoregressive model is presented in section 2 together with the proposed diagnosis scheme theoretical formulations of harbor oscillations with variable water depth are briefly reviewed in section 3 before the numerical model simulating the vessel induced oscillations the numerical results are compared with theoretical solutions as a validation more detailed numerical investigations are presented in the following section with considerations of the effects of variations in both regard to the harbor bathymetry and vessel motions multivariate autoregressive models are used to predict the oscillation time series recorded from multiple locations within the harbor features for different locations are extracted and analyzed with mahalanobis distances by measuring the amount of variations in the coefficients of vector autoregressive models conclusions are drawn in the last section 2 pattern recognition procedure the vector autoregressive moving average model v a r m a p q is employed in the analysis procedure of the oscillations induced by vessel motions within the semi enclosed harbor area described in the following sections the form of the model can be written as 1 y t i 1 p φ i y t i j 1 q θ j ε t j ε t where y t y 1 t y 2 t y n t t corresponds to as the vector of dependent response variables and ε t ε 1 t ε 2 t ε n t t is referred to the vector white noise process here the parameters p and q represent orders of the autoregressive and moving average parts of the varma model respectively with n representing the number of dependent response variables used in estimating the varma model in this study n will be the number of observation points where oscillation time history responses have been measured within the harbor the interpretation of this model is that the response variables which are water surface responses at different locations are not only contemporaneously correlated to each other but also correlated to each other s past values the model coefficients in eq 1 φ i and θ j include implicitly information about physical properties of the harbor and the moving vessel the φ i coefficients define the ar function of order p and can be used to determine the natural frequencies mode profiles and damping ratios while θ j coefficients define the ma function of order q and include information about power of the response in different modes pandit and wu 1983 therefore if only modal properties of the harbor oscillation patterns are required the water surface response can be modeled exclusively by the ar part of the model and besides which it is possible to express all varma models with ar models of infinite order theoretically nevertheless in a practical account they may be modeled adequately by a finite order series box et al 1994 there are several different criteria such as the akaike information criterion aic ljung 1987 and schwarz s bayesian criterion sbc schwarz 1978 that can be checked to suggest the required order of the ar model by checking the randomness and gaussianity of the prediction errors through trial and error the order of the ar model is determined in this study in parallel with these criteria the var model coefficients are estimated with least squares regression and for each set of the harbor oscillation time histories p matrices will be obtained as components of φ φ 1 φ 2 φ i φ p where φ i can be given in matrix form as 2 φ i φ 11 i φ 12 i φ 1 n i φ 21 i φ 22 i φ 2 n i φ n 1 i φ n 2 i φ m n i while they are related to the mode profiles and modal frequencies andersen 1997 andersen and brincker 1998 the relation between these coefficients and the modal parameters can be expressed by 3 0 i 0 0 0 0 i 0 0 0 0 i φ p φ p 1 φ p 2 φ 1 ψ μ ψ 1 with μ and ψ indicating respectively the eigenvalues and the mode profiles whereas m equals to n p 4 μ diag μ i 5 ψ ψ 1 ψ m μ 1 ψ 1 μ n p ψ m μ 1 p 1 ψ 1 μ n p p 1 ψ m for the pattern recognition procedure the diagnosis approach can be divided into several steps during which the oscillation responses of the harbor obtained at a variety of conditions are indirectly compared to each other by extracting sensitive features revealed by the application of the chosen varma models to the observation data and by statistically measuring the deviations that occur in the estimated coefficients of the models due to the underlying mechanisms coefficients of the varma model include spatiotemporal information about the vessel induced oscillations and the amount of deviation observed for different harbor or vessel motion conditions may potentially reveal information about the oscillation characteristics the details are discussed in the following three steps for the pattern recognition procedure of the harbor oscillations induced by vessel motions 1 formation of the observed oscillation sample the recorded oscillation data at different conditions are divided into smaller data samples in this diagnosis scheme which leads to obtaining a number of different varma models representing the oscillation response of the harbor in smaller data samples rather than fitting one single model to the entire recorded oscillation time history with this step the effect of uncertainty in predicting the parameters of varma models can be indirectly included in the diagnosis scheme and the generation of a statistical distribution for the extracted features can be generated 2 oscillation data reduction in this step of the proposed damage diagnosis scheme the point of importance consists of estimating the parameters of the varma models for each data sample generated from the measured data sets within the chosen models the matrix coefficients particularly the diagonal terms φ j j 1 and φ j j 2 from matrices φ 1 and φ 2 in eq 2 can be used to extract features at different conditions for the harbor affected by vessel induced bores since coefficients for recent time lags like φ 1 and φ 2 are the most informative about different modes of the oscillations of the free surface within the harbor whereas other terms in the coefficient matrix may include mixed information pandit and wu 1983 the φ j j 1 and φ j j 2 terms calculated from different data samples can be plotted against each other for comparison the number of data points is equal to the number of segments in the recorded oscillation data in their corresponding condition 3 oscillation feature extraction and statistical evaluation a statistical measure called mahalanobis distance was employed to recognize the variation patterns in the selected terms of the varma models by measuring the distance between the selected terms corresponding to a condition of interest and thence used to extract the features of oscillations induced by vessel motions generally the mahalanobis distance of a multivariate potential outlier vector x x 1 x 2 x n t from a group with mean μ and covariance matrix s is given by 6 d m x x μ t s 1 x μ statistical evaluation can be carried out on the calculated features in order to identify patterns of the induced harbor oscillations and the evaluation is performed by comparison between the features calculated for a variety of conditions of interest with both the mean and the variance values of the features taken into account the selected terms of the fitted varma models should experience more or less important deviations within the harbor under different conditions since these coefficients are directly related to the oscillation properties according to eq 3 5 the deviations in the fitted model coefficients are captured by taking advantage of mahalanobis distances with quantifications of the magnitude of the calculated mahalanobis distances or the variations in the varma coefficients for a brief verification of the described analysis method the varma models are in the first place applied onto analytical curves and those with gaussian white noise signals to test their capability in capturing the characteristics of time series it can be seen in fig 1 a that a white noise sequence is well generated with the ar function of the first order with φ 0 and the autocorrelation of the process in fig 1 b is shown to be validated for the gaussian white noise with a kronecker delta at the zero lag and a small tail remaining within the upper and lower confidence bounds presented with dashed lines in fig 2 a sinusoidal curve and another one with damping are perfectly captured by the varma models with orders less than five when a tiny gaussian white noise sequence is superposed upon the analytical curves the characteristics of the artificial curves are also well captured with a fitness over 90 with the model orders within one digit 3 numerical study and model validation the numerical investigations of oscillations induced by vessel motions are conducted within relatively idealized bathymetries with a rectangular semi enclosed harbor geometry and a piecewise seabed consisted of two slopes to better fitting natural coastal conditions simulations are carried out with the well tested funwave tvd package developed at the university of delaware kirby et al 1998 funwave tvd is a fully nonlinear boussinesq wave model with a godunov type riemann solver shi et al 2012b and developed based on a complete set of fully nonlinear boussinesq equations with the vertical vorticity correction derived by chen 2006 and a time varying reference elevation introduced by kennedy et al 2001 the governing equations of the numerical model are organized in a conservative form to facilitate a hybrid numerical scheme including third order runge kutta time stepping gottlieb et al 2001 and muscl tvd scheme of fourth order accuracy erduran et al 2005 within the riemann solver the model has been validated against a suite of benchmark test data in coastal applications kirby 2016 kirby et al 2013 lynett et al 2017 shi et al 2012a tehranirad et al 2011 the mass conservation equations are expressed in the following form 8 η t m 0 9 m h u a u 2 with η representing the wave surface elevation and m the mass flux u α and u 2 denote the velocity at a reference elevation and the depth averaged o μ 2 respectively where dimensionless parameter characterizing frequency dispersion μ is the ratio of the characteristic water depth to a horizontal length the total depth h h η with h the still water depth the conservative form of the depth integrated horizontal momentum equations is given as 10 m t m m h 1 2 g η 2 2 h η v d i s g η h g h p a s brk in which the dispersive terms are contained in v d i s shi et al 2012a and the pressure source term generating the ship wake is presented with the third term on the right hand side the last term s brk on rhs is the dissipation term related to the artificial eddy viscosity in the same form of kennedy et al 2001 in addition to the shallow water equation based shock capturing breaker the eddy viscosity is described by 11 ν b δ 2 h η η t with δ the mixing length coefficient equivalent to one in this work for numerical stability b may vary smoothly from 0 to 1 however with the inherent stability of the tvd numerical scheme no numerical instability has been found during the simulations in this study without any smooth transition by adding or flagging out different terms within the source code funwave tvd can be applied as a linear water wave transformation model or to simulate water wave propagations with different levels of boussinesq approximations with nonlinear terms the sponge layers of the model package are well validated and can effectively damp the energy of outgoing waves with different frequencies and directions which is essential for harbor oscillation studies in a numerical manner in our work the spongy layers are placed around the boards of the computational domain at a certain distance away from the outlet of the harbor to ensure an open sea condition the vessel motions are considered with pressure source for ship wakes ertekin et al 1986 torsvik et al 2008 wu 1987 which may be given as 12 p a x y t p f x t q y t where p a x y t is the static depression around the vessel and p controls the surface displacements which can be interpreted as the inverse barometer effect corresponding to the static surface depression for a stationary vessel the coordinate system for the pressure source may be rotated by an angle relative to the boussinesq coordinate system if necessary with a center point of the pressure located at x y f x t and q y t can be expressed respectively as 13 f x t cos 2 π x x t 1 2 α l 1 α l 1 2 α l x x t 1 2 l 1 x x t 1 2 α l 14 q y t cos 2 π y y t 1 2 β r 1 β r 1 2 β r y y t 1 2 r 1 y y t 1 2 β r inside the area l 2 x x t l 2 and r 2 y y t r 2 and their values diminish to zero outside with l and r representing the length and width of the pressure source the shape of the draft region is determined by the parameters α and β with 0 α β 1 when the static draft of the vessel is denoted with d the values of the shape parameters can be evaluated by adjusting them to match the submerged volume of the vessel with a given block coefficient with c b v s u b l r d p a d x d y l r d the block coefficient can be given as c b 0 5 and the shape parameters are often assumed to be equal with α β in real calculations in order to carry out investigations of the vessel induced harbor oscillations the fidelity of the numerical model in simulating the wave patterns generated by moving vessel in depth limited waters is in the first place validated with analytical solution derived by havelock et al havelock 1908 as an enhancement of the formulations for kelvin wake in deep water illustrated in fig 3 a the virtual open sea area extends 840 m and 408 m in the longitudinal and the transverse direction respectively with a water depth of 5 m the vessel moves along the middle axe of the area in the longitudinal direction the half angles θ k of the ship wake simulated with havelock s model setup are compared with the analytical solution with regard to the froude number f r h in fig 3 b and the wedges behind the moving vessel are shown to be well captured by the above described numerical model for the fidelity of the boussinesq type numerical model in the investigation of harbor oscillation problems induced by the vessel induce bores the oscillations generated by a moving vessel on two kinds of harbor bathymetries are simulated and compared with the analytical solutions of shao et al 2017a including a constant slope and a two slope piecewise seabed within the harbor the computational domain is set up following the usual practice in harbor oscillation researches as shown in fig 4 the backwall of the harbor running in the y direction is situated at x 0 and x increases offshore the axis z is positive upward from the still water level a rectangular harbor of constant slope is located between x 0 and x l the seafloor of the open sea outside the harbor is horizontal the length of the harbor is relatively long compared with its width 2 b as evident oscillations frequently occur in long and narrow harbors in the meantime as the transverse oscillations may appear in a harbor destabilized by things like small or local disturbances the harbor width 2 b may not be too small to restrain their occurrence with these considerations an l 2 5 k m long and 2 b 0 5 k m wide rectangular harbor of conventional dimension is chosen in the numerical simulations for the model validation since in a practical account the speeds of vessels in entering and leaving the harbor are limited according to regulations mainly with security concerns and the vessels may travel at a speed between 5 and 6 n m i h nautical mile per hour for conventional port waters a vessel of typical hull form of 20 m long and 10 m wide with α v 0 5 and β v 0 5 is set to moving at 5 83 n m i h 10 8 k m h from the backwall to the mouth of the harbor namely in the outward direction which may consequently generate ship induced bores within the harbor with results of previous researches of this kind of harbor oscillation problems carried out in recent years as it is known that an external disturbance located at or along sidewall of the semi enclosed harbor area may excite as numerous oscillation modes as possible the motion path of the vessel is chosen to be along one sidewall of the harbor described above oscillations are simulated for the harbor on two kinds of bottom including a constant slope s 0 02 and another one of two slope piecewise bottom s 1 0 02 s 2 0 03 with the same water depth at the back wall h 1 5 m as validation tests the piecewise bottom is given by 15 h x y s 1 x h 1 0 x x 1 s 2 x h 2 x 1 x l h p l x where s 1 is the slope of the first part of the bottom and s 2 is that of the second one with h 2 h 1 s 1 s 2 x 1 the water depth at the point of inflection the computational domain is 0 x 3 5 km and 1 25 km y 1 25 km which dimension the ranges in the longshore and offshore directions in fig 4 the grid size is δ x δ y 5 m and the time step is δ t 0 05 s three sponge layers of 0 5 km width are placed outside the harbor at a certain distance in the three seaward directions to absorb the energy radiated by the water motion at the entrance the model is run for sufficiently long time for each simulation as the oscillations within the harbor reach their stable state as oscillations of relatively small amplitudes due to the vessel moving with limited speed are focused in this work the nonlinear interactions between different components can be neglected in the quasi steady state inside the harbor in assuming the independence of each oscillation component following the methods used by shao et al 2017b in analyzing the oscillations induced by submerged sliding masses along the seabed surface the oscillation components are detected with the amplitude spectra at the corner of the harbor where the amplitude factor of oscillations may attain its maximum the spatial direction of the oscillations longitudinal or transverse is revealed mainly from their profiles in the offshore direction as indicated in numerous analytical investigations of harbor oscillation the longitudinal ones have no variation across the harbor but vary along the sidewall whereas the transverse ones have m node lines in parallel with the sidewall and n node lines in parallel with the backwall for the mode m n the spatial structure of each component along the backwall is used to confirm it as longitudinal or transverse if the motion is transverse it is further used to identify the value of m corresponding to mode m n the profile of the components along the sidewall is used to identify the mode of the longitudinal oscillation or the offshore node number n of the transverse mode m n space gauges are installed right at the entrance of the harbor to monitor the energy leaks outside and when it is lower than 0 1 of that contained in the oscillations at the backwall a quasi steady state is deemed to be attained with numerous numerical tests the oscillations caused by vessel motions are found to be able to reach their quasi steady state faster for relatively mild seabed than for slightly steeper sloping seabed the spectra analysis of the simulated free surface elevations is carried out with the time segment after the stabilization of the oscillations with a very large total number of temporal points the frequency components within the harbor for both the two kinds of bottom are revealed by the amplitude spectrum shown in fig 5 and their properties can be further identified from their spatial structure it can be seen that very weak longitudinal resonances of very low frequency present within the harbor and the wave patterns are controlled by transverse oscillations of different modes the numerically simulated components frequencies of relatively important intensity and their corresponding theoretical ones calculated from formulations 16 are listed in table 1 for each case 16 u α 1 1 τ 11 u α 2 1 τ 21 u α 2 1 τ 21 u α 1 1 τ 11 2 m α 1 1 τ 10 m α 1 1 τ 10 u α 2 1 τ 21 m α 1 1 τ 11 u α 2 1 τ 21 m α 1 1 τ 11 2 u α 1 1 τ 10 u α 1 1 τ 10 0 where u and m are the two linearly independent confluent hypergeometric functions and 17 α j 1 2 1 ω 2 g k m n s j j 1 2 18 τ j 1 2 k m n s j s j x 1 h j j 1 2 19 τ 10 2 k m n s 1 h 1 with ω the angular frequency and k m n m π 2 b m 1 2 3 indicating the eigenvalue of the m t h transverse oscillation mode the constant slope bottom can be theoretically regarded as a special case of the two slope piecewise one when s 1 s 2 it can be seen theoretically that the transverse oscillation components on a constant slope s and on a piecewise bottom with s 1 s share nearly the same theoretical frequencies for relatively low modes with the values listed in the table it is observed that the numerically calculated frequencies of the components are very close to the analytical ones especially for the modes with both small m and small n for the modes with larger n as the corresponding wave profiles extend farther in the offshore direction they may be subjected to a greater influence of the deepening of the water and the errors f t f n f t may reasonably become slightly larger well captured by the analytical solutions the offshore profiles of the several principal components trapped within the harbor on each slope are represented in fig 6 and compared with those of the corresponding theoretical modes with the same amplitude at the backwall it can be revealed from the comparisons of the seaward wave profiles that for the oscillations induced by vessel moving from the backwall all the way to the mouth of the harbor higher modes in the offshore direction with larger n can be more easily exited than those in the longshore direction with larger m as the vessel itinerary traverse more antinodes of these higher offshore modes for the mode with larger m 2 0 the appearance of traces of very small antinodes makes it deviate slightly from the theoretical curve at a certain distance away from the backwall and this may be imputed to the disturbances from the higher offshore modes oscillating at tightly surrounding frequencies 4 analysis of oscillations induced by vessel motions from the frequency domain analysis of numerical results presented in the validation cases for the harbor oscillations induced by vessel motions on two kinds of bottom it is generally revealed that similar to the oscillations generated by submerged sliding masses or other external disturbances transverse oscillations occur as the principle components containing most of the oscillation energy inside the harbor with relatively weak longitudinal components situating in low frequency region of the spectra while the vessel moves right along one sidewall of the harbor from the backwall all the way to the entrance the occurrence of the components as numerous as possible can be observed and as the transverse components are trapped modes their oscillation energy may be maintained within the harbor whereas the longitudinal ones dissipate with the passage of time with the model settings indicated in the previous section a range of numerical experiments are carried out to investigate the oscillations induced by various vessel motions with different harbor bathymetries by means of the conventional frequency domain analysis method and in addition to which the pattern recognition procedure proposed in section 2 is employed onto the time series of the numerical simulations and thereby further examines the spatiotemporal characteristics of the oscillation behavior 4 1 the effects of the changing vessel motions and harbor bathymetry in frequency domain the analysis of the effects of the changing vessel motions and harbor bathymetry are in the first place carried out in frequency domain with the same vessel motions as external excitation generating oscillations within the semi enclosed harbor the frequencies of the principle oscillation components with one or two nodes in the longshore direction which may contain most of the oscillation energy are reported in fig 7 for a variation of the bottom slope and water depth of the harbor it is revealed that with an increasing water depth for the whole inner harbor area either due to a steeper bottom slope shown in fig 7 a or a deeper backwall water depth shown in fig 7 b the frequencies of the oscillation components with different longshore and offshore mode number shift to larger values note that in case b as the changing backwall water depth may lead to an evenly changing water depth over the whole range of the harbor the change of the frequencies of different offshore oscillation modes appears also nearly homogeneous when the backwall water depth increases from 5 m to 20 m which conforms to the possible water depth for this kind of bathymetry in reality on the other hand while the bottom slope turns steeper shown in case a a more significant deepening may occur farther away from the backwall and in consequence the oscillation components with larger offshore mode number are subjected to influence of greater importance on the vessel side it can be seen from fig 8 that the frequency domain behavior of the oscillations is in general insensitive to the variation of the moving speed of the vessel and also to the direction of the movement within the harbor with merely infinitesimal change in the distribution of energy on the occurring oscillation modes shown by their relative amplitudes almost all these oscillation modes keep their frequencies when the outgoing vessel along one sidewall of the harbor speeds up from 2 m s to 10 m s following the same path most of the oscillation modes remain stable when the moving vessel changes its direction from outward to inward especially the ones with lower frequencies which embody a best part of the total oscillation energy within the harbor when the oscillations are induced by vessel moving outside of the harbor at a certain distance from the entrance following a path parallel to the shoreline their behaviors in frequency domain are quite different in comparison with those induced by the aforementioned outgoing vessel inside the harbor relatively important longitudinal modes occur over lower frequency range together with several transverse modes with larger offshore mode number since the external disturbances come from outside of the harbor and the higher offshore modes may take precedence to be generated over lower ones whose oscillation energy is concentrated near the backwall of the harbor farther away from the entrance 4 2 pattern recognition for the oscillation time series it is revealed in the previous subsections that the changing vessel motions or harbor bathymetries can to some extent affect the frequency domain behavior of the induced oscillations however with their assumptions or approximations the frequency domain analysis may sometimes fail to capture some characteristics of the oscillations which are in essence time series more or less unstable and it may also be interesting to know the time domain behavior on its own and the proposed pattern recognition procedure is applied onto the recorded time series under different conditions following precedent threads of thought the influencing factors on both the vessel side and the harbor side are examined and discussed as what has been done in the previous subsection on the harbor side attention is focused on the slope and water depth of the harbor bathymetry in the aspect of vessel motions in addition to the effects of various moving speed those of the itinerary of the vessel are also analyzed including comparisons between the vessel moving inwards or outwards the harbor and the itinerary being located within or outside of the harbor shown in fig 8 the corresponding var coefficients of the oscillation time series with these changing conditions on the vessel side are plotted in fig 9 fig 9 a shows a distinct amount of variation in the var coefficients with a changing constant slope of the harbor bottom and the distinction seems mainly controlled by the first coefficient of the applied vector autoregressive moving average model while the chosen values of the slope are mild and consistent with the realistic coastal bathymetries it can be regarded that slight variations of the mild slopes may lead to a relatively apparent clustering of the var results of the recorded time series and thus the time domain oscillation characteristics of the water surface within the semi enclosed harbor for a variation of water depth at the backwall of the harbor in fig 9 b which can exist in reality for this kind of bathymetry although the clustering seems less distinct than that for the bottom slope a monotonic trend of the var results with regard to the first coefficient can be observed as shifting to smaller values when the water within the harbor becomes deeper it is to a certain degree physically reasonable that the scatter points for different bottom slope disaggregate more intensively into groups than those for different backwall water depth since a varying bottom slope may change not only the inclination of the bottom surface itself but also the overall water depth within the harbor in the meantime which can consequently change both resonance frequencies and amplitude profiles of the oscillation components induced by vessel motions a similar monotonic trend can also be seen in the subplot c for the changing velocity of the vessel motions and the values of the first var coefficient are found to increase with a faster moving vessel as the changing vessel speed mainly controls the agitation intensity of the ship wake which may merely influence the induced oscillation amplitudes therewith and the frequencies of almost of the oscillation modes remain the same as reported in the previous subsection with frequency domain analysis relatively limited clustering trends are observed in addition as the vessel may travel in both directions in entering and leaving the semi enclosed harbor simplified cases are considered the vessel follows an inward and outward straight line as its moving path and the consequent var results shown in fig 9 d form two clusters which can be practically separated by a simple oblique line placed between them which indicates that the time domain oscillation patterns induced by the vessel motions in the two directions may differ from each other to a considerable extent this observation is only captured with the pattern recognition presented here but fails to be found in the preceding frequency domain analysis with a clear separation observed in fig 9 e between the aggregation of the scatter points in red representing the var coefficients calculated for the oscillation time series induced by a seaward moving vessel departing from the backwall within the semi enclosed harbor and that of the vessels traveling in the longshore direction outside of the harbor marked in other colors obvious difference between the time domain patterns of the oscillations generated in the two different manners can be deduced similar to what has been captured by the previous frequency domain analysis fig 8 e as the moving vessel not only pushes the water in front of the stem but also forms a region of recirculating flow immediately behind the stern with the wave front of the wake patterns at a certain angle from the moving path the direction and relative location of the vessel path or itinerary with regard to the spatial layout of the harbor may carry weight in the generation of the surrounding wave patterns within the harbor however for the three vessels traveling outside of the harbor entrance with their paths located parallel to each other at different exterior spacing practically no distinct clustering can be found among the induced oscillations as different parallel paths of the vessel motions may have little impact on the propagation of the generated wave patterns an observation also coinciding with the frequency domain results as the time series of the oscillation surface are measured at a variety of locations within the harbor a clustering can also be seen in comparing the patterns from different locations and this kind of clustering can be more quantitatively illustrated by taking advantage of the distribution of probability density of the calculated mahalanobis distances for the time series measured at different observation locations since it can be revealed from the analytical solutions shao et al 2017a that for the spatial profiles of different transverse oscillation modes nodes and antinodes succeed each other in both the longshore and offshore directions the time series recorded right at the nodes of a certain oscillation mode may not contain its information whereas those recorded at the antinodes can theoretically carry the information of this mode to its maximum while all the oscillation modes may have their largest antinode right at the backwall of the semi enclosed harbor in the offshore direction the water surface time history at the backwall is chosen as a reference for the comparisons for the modes with different n similarly for the longshore direction as the largest antinodes of all the modes with different m occur right at the sidewall where the water surface history can be chosen for comparisons in the longshore direction within the observed oscillations close attention is given to the four lowest components with non zero offshore nodes with n from 1 to 4 as they may contain most of the perceptible resonance energy for these oscillation components induced by a vessel moving outwards along one sidewall of the harbor on a constant slope s 0 02 the positions of the nodes are listed in table 2 which are extracted from the wave profiles in the results of the numerical simulations and these positions can also be well captured by theoretical solutions amplitude spectra in frequency domain obtained from the time series recorded at the nodes of these four components are shown in fig 10 in comparison with those obtained right at the backwall of the harbor and the deletions of the pic of corresponding mode are illustrated within the spectra a reduction of the intensity of a certain lower oscillation modes can merely be seen with the attenuation of their pics when the oscillation time series are observed farther away from the backwall of the harbor on certain nodes of higher offshore modes with larger mode number n and from the superficial frequency domain analysis and comparisons little information can be further extracted the probability density of the calculated mahalanobis distance for the first node the only node of mode n 1 at 185 m the second node of mode n 2 at 530 m the third node of mode n 3 at 875 m and the fourth node of mode n 4 at 1210 m are presented in fig 11 a in general the calculated probability densities can be fitted closely to normal distribution as can be seen from all the dotted fitting curves for the four oscillation modes the probability densities are concentrated towards larger mahalanobis distance with nearly the same distribution width when the time series are recorded on nodes of higher offshore oscillation modes as these chosen positions of the nodes recede from the backwall of the harbor one after another it seems in a superficial manner that the concentration of the probability density tends to shift larger when they are recorded farther away in the offshore direction however when the mahalanobis distances are calculated for mode n 2 with the time history measured on the first node of this mode at only 130 m away from the backwall closer than the second node at 530 m the median of the fitted probability density bell curve blue dotted curve in fig 11 b moves on the contrary to larger mahalanobis distance and tightly close to the medians of those for mode n 3 and 4 respectively fitted by green and purple dotted curves as it can be seen from table 3 that the first node of mode n 2 at 130 m is situated in the proximity of the first node of mode n 3 and 4 it is reasonable that the mahalanobis distances calculated from the time history here are significantly influenced by these two higher modes and may carry characteristics of these two modes similar phenomenon is revealed within the harbor of constant slope with s 0 03 and the probability densities of the calculated mahalanobis distance for the four principle offshore oscillation modes are shown in fig 12 a and fig 12 b the mean values and variances corresponding to the mahalanobis distances of the time histories measured at the mentioned locations are listed in table 3 in the meantime another feature of the distribution of the probability density of the mahalanobis distances may also be drawn from figs 11 and 12 for both bathymetries with different slope s 0 02 and s 0 03 which refers to a relative stagnation or stability of the bell shape of the fitted curves when the observation points move onto the nodes of higher offshore oscillation modes farther away seawards in order to further elucidate this observation the means and variances of the mahalanobis distance calculated with regard to the reference for the time histories measured at the 250 observation points arranged in the manner as the ops shown in fig 4 in the offshore direction from the backwall all the way to the harbor entrance are illustrated in fig 13 it is revealed that the mean values of the calculated mahalanobis distances do not show a growing or downward trend but begin to level off at a certain distance away from the backwall the means begin to converge towards a relatively fixe value of 1 5 in the second half of the harbor together with the variances approaching a value of 0 2 in addition in the vicinity of the backwall a monotonic tendency can neither be seen for the mean values nor for the variances from fig 13 the fluctuations in this part of the harbor together with the subsequent convergences near the mouth of harbor may to some extent show a conformity to the feature observed within the bell shape curve in figs 11 and 12 5 conclusion this study presents a novel sensitive harbor oscillation feature in the context of statistical pattern recognition to analyze the spatiotemporal oscillation behaviors induced by vessel motions within a harbor of variable water depth by taking advantage of the time domain oscillation series in addition to frequency domain analysis in order to capture the vessel induced oscillation behaviors from this perspective vector autoregressive model is proposed to examine the recorded oscillation time histories of the water surface within the semi enclosed harbor at different observation points and from which features are extracted by measuring the amount of deviations calculated with the selected varma coefficients as both the harbor bathymetry and the movements of the vessel may change the oscillation behavior time series of the water surface induced on a variation of harbor bottom slope and inner harbor water depth are investigated together with those generated with changing vessel motions with different velocity traveling direction and location of the movements frequency domain analysis show that the changing conditions in harbor bathymetry including the slope and water depth may have influence on the oscillation frequencies of different modes whereas a changing vessel direction or velocity may neither affect the mode frequencies nor the occurrence of different modes however the pattern recognition results on the basis of the time domain series demonstrate that more or less distinct clustering of the varma coefficients can be observed not only for the time series with the changing conditions affecting a priori the frequency domain behavior but also for those with the changing conditions of little importance in frequency domain analysis among all the conditions being investigated a changing bottom slope may have the most significant influence on the time domain behavior of the oscillations as it modifies both the water depth distribution and bottom profile within the harbor for the vessel side it is interestingly to note that palpable separation can be observed between the time domain oscillation behaviors induced by a vessel traveling in different direction the same kind of separation can also be found for those induced by a vessel moving inside or outside the harbor in addition to the responses of the harbor oscillations induced by vessel motions to variations of external conditions the information of internal structure of the induced oscillations can also be revealed with the pattern recognition approach on account of the recorded time series at different observation locations as a further step than the clustering analysis of the varma coefficients mahalanobis distances of them with regard to a reference and their probability density distribution are employed to investigate the spatial behavior of the oscillations in which the energy is contributed by different internal components the resonance modes while the profile of probability density distribution of the calculated mahalanobis distances remains generally unchanged the mean of these distances may to some extent illustrate the occurrence or absence of certain resonance components or modes in the internal structure of the oscillations within the harbor the proposed pattern recognition procedure in this study can be potentially applied to other nearshore hydrodynamic analysis especially for wave propagations or resonances and on more realistic coastal bathymetries it should also be mentioned that the characteristics of the internal structure of the wave patterns may be revealed by a successful implementation of the proposed procedure in the requirement of time domain measurements at multiple locations which are spatiotemporally correlated to each other in an intrinsic manner in addition although the investigations have been carried out in this study on the oscillations induced by vessel motions different behaviors of oscillations or other wave patterns induced by other types of external forcing sources such as meteorological events and submerge landslides may also be potentially identified by implementing the proposed procedure credit authorship contribution statement dong shao conceptualization methodology formal analysis software investigation writing original draft writing review editing yun xing methodology validation supervision writing original draft writing review editing visualization funding acquisition zirui zheng methodology software formal analysis investigation validation writing review editing gang jiang supervision writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported financially by the natural science foundation of jiangsu province china bk20171468 the authors are also grateful for the discussions and suggestions given by the professors carrying out researches in the domain of structure health monitoring from which the inspiration of this study is drawn 
21826,a new and efficient model for calculation of the unsteady hydrodynamic loads on an oscillating plate in two dimensional flow is proposed in order to compute the hydrodynamic loads an unsteady hydrodynamic model is derived using the boundary element method along with the potential flow assumption to this aim the steady boundary of cavity is determined by a full nonlinear iterative procedure thereafter assuming that amplitude and frequency of oscillations are so that the length of cavity in unsteady flow remains intact simulation of the unsteady hydrodynamic flow is performed by imposing some velocity perturbations over the steady cavity solutions consequently based on this formulation a system identification method is used to obtain a linear model for determination of the applied forces on the plate in unsteady flow results obtained using the proposed algorithm are verified keywords supercavitation potential flow boundary element method system identification nomenclature ϕ steady flow total potential η cavity thickness γ wake vortex strength circulation ϕ ˆ steady flow perturbed potential ω frequency of cavitator excitation ϕ flow total potential ϕ potential of unit source σ cavitation number θ cavitator s angle ϕ unsteady flow perturbed potential p perturbed pressure g s moment transfer function m perturbed moment action on the cavitator p v vapor pressure inside the cavity q normal velocity flux s farfield surface s b plate surface s c cavity surface s w wake surface l c supercavity length n b e total number of elements on the fluid boundary r c supercavity maximum diameter r n cavitator width ϕ ˆ 0 perturbed potential of steady flow at cavity detachment point ϕ ˆ w perturbed potential of steady flow at wake j j jacobian matrix v 0 steady flow velocity v inflow velocity ϕ uniform flow potential v n normal component of velocity v s tangential component of velocity 1 introduction cavitation phenomenon occurs over the surfaces of an immersed body at high speeds at points where the pressure drops below the fluid vapor pressure if the cavitation number is low enough due to high speed or low vapor pressure cavity expands to finally surround the whole body referred to as supercavitation due to its negative erosive vibrational and acoustic effects cavitation used to be known as a destructive phenomenon to be avoided due to reduction in surface frictional drag and accordingly increase of the underwater vehicle s speed supercavitation phenomenon has drawn a lot of attention in the recent decades serebryakov et al 2009 kirschner et al 2001 in order to model supercavitating flows various methods are proposed analytical and semi analytical approaches well suited to linear and simple simulations pellone et al 2004 kirschner et al 2002 methods based on potential flow assumptions nouri and eslamdoost 2009 celik et al 2014 as well as those based on the solution to navier stokes equation lindau et al 2002 chen et al 2011 wang et al 2015 are some of the available approaches due to its simplicity and desired accuracy many researchers have applied the potential flow assumption to model both steady and unsteady supercavitating flows among various approaches for solving the supercavitating potential flow such as slender body theory tulin 1953 chou 1974 kirschner et al 2009 finite element and boundary element methods alavi et al 2018 the latter is more commonly utilized due to its higher ability specifically in solving the potential equations uhlman applied the nonlinear velocity based boundary element method for the first time to solve the problems of partially cavitating flow over hydrofoils uhlman 1987 and supercavitating hydrofoils uhlman 1989 kinnas and fine 1991 proposed a fully nonlinear potential based bem to solve partially and supercavitating flows this approach was more preferred to uhlman s 1987 1989 velocity based method from the convergence rate point of view they applied the pressure recovery method that has an acceptable accuracy for cavity termination model assuming a compressible potential flow and applying the modified riabouchinsky cavity termination model kirschner et al 1995 suggested a model to determine axisymmetric supercavitation in subsonic flow dang and kuiper applied re entrant jet model at the end of the cavity and a full nonlinear approach to model a partially cavitating flow around 2d dang and kuiper 1999a and 3d dang and kuiper 1999b hydrofoils uhlman et al fine et al 2001 proposed a linearized model assuming potential flow to calculate the unsteady forces applied on the supercavity in terms of added mass and damping value vaz 2005 categorized the existing cavitation models and delineated the advantages and disadvantages of all models the full and partial nonlinear models with the two approaches of re entrant jet and pressure recovery for cavity termination are compared in terms of accuracy simplicity efficiency and convergence rate uhlman 2006 derived a fully nonlinear potential based bem to calculate axisymmetric supercavitation comparing results of the two termination methods of re entrant jet and riabouchinsky it is found that both approaches are in a good agreement except for the short supercavities despite the decent performance of nonlinear models in predicting partial and supercavities the estimated surface displacement for the cavity at each step and therefore the need for recalculating the coefficients increases the computational costs dang 2001 recently behbahani nejad and changizian 2013a have suggested a non iterative solution algorithm based on bem to calculate the partial unsteady cavitation accordingly a reduced order model is later proposed to predict the behavior of 2d and 3d unsteady partial cavitation behbahani nejad and changizian 2013b 2015 reduced order model significantly decreases the required calculations by reduction of the degrees of freedom and considering the most effective mode shapes derivation of a hydrodynamic model of supercavity is important to design a proper controller as well as structural analysis of the immersed body the dynamic model should provide reasonable swiftness and accuracy simultaneously rand et al 1997 considered the motion dynamics of a supercavitating body and the effects of tail impact to the supercavity wall in order to determine forces applied to the nose existing experimental results were used using semi analytical relations kirschner et al 2002 obtained the forces applied to cavitators and fins and proposed a 6 degree of freedom dynamical model to simulate the motion of a projectile in fluid choi et al 2004 developed a model for dynamic vibration and stability response analysis of a flexible supercavitating body inside a supercavitation to control surface excitation and specific maneuvers the modal element method is used to model the behavior of a flexible body along with the empirical relations for determination of the cavity configuration and hydrodynamic loading assuming an elastic beam as the supercavitating body ruzzene and soranna 2004 suggested a model for motion dynamics and vibration analysis of the body considering the tail impact effects for applications in structural analyses and design of stiffened bodies afterwards applying the resulted hydrodynamic model as well as structural analysis in multi disciplinary design optimization method a structure with minimized vibration mass and cost as well as maximized safety factor is obtained kirschner et al 2006 discussed the motion dynamics of the body in different phases from the cavity forming initiation to partial and finally supercavitation proposing a simplified single degree of freedom spring mass model they considered the vibrational stability of the body under various conditions lin et al 2008 studied the motion dynamics and control of a supercavitating body considering the nonlinear effects due to planing force they suggested the two approaches of linear feedback control and switching control for robust vibration control of the body inside the supercavity and investigated the efficiency of the two methods unlike the previous researches nguyen and balachandran 2011 considered the effects of the cavitator angle of attack on cavity shape and provided a model to study the motion dynamics of a projectile inside a nonsymmetric and noncylindrical supercavity and indicated the significant effect of the cavity shape over the system dynamics they applied semi empirical relations to model the cavity geometry and investigate the effect of angle of attack on cavity axis deformation hassouneh et al 2012 and li et al 2014 developed a more accurate model to determine the forces acting on the supercavitating body as well as its motion dynamics by adding the time delay effect or namely the cavity memory effect to the previous models consideration of the time delay is of significant importance due to its effect on the supercavity shape and also the induced delay for the changes in the cavitator to approach the back of the supercavity for implementation of control logic kim and kim 2015 proposed a 6 degree of freedom model for analysis of motion dynamics of a body within a supercavity based on the previous researches and considering the various effective parameters over the cavity shape such as gravity as well as different forces applied to the body like cavitator force fin force planing force and the applied force on the immersed part of the body and thereafter investigated the stability of the body motion for different values of the effective factors considering the effect of nonlinear force caused by tail impact and using the experimental results sanabria and arndt 2018 developed a low order nonlinear model for longitudinal motion of the vehicle based on which a method to design a controller in the presence of nonlinear and indeterminate planing force is proposed they employed analytical relations based on drag coefficient for calculating the forces applied to the cavitators and fins in a supercavitating body only small parts of the body are in contact with the fluid and can act as the control surfaces also the interactions of the control surfaces and supercavity dynamics is nonlinear and complicated control system design and choosing appropriate actuators require an accurate calculation of the applied forces over the control surfaces large variations in control surface angles can result in development of large planing forces and instability of the body kim 2018 designed a controller based on an impact input to produce slight changes in pitch angle calculation of the applied forces on the cavitator is essential to design a controller for body motion within the fluid also it is important to find the applied moments and forces on the cavitator for a proper actuator choice accurate and real time calculation of hydrodynamic forces acting on the marin vessel is important in the design of high performance model based control systems for steering of marine vessels among the proposed methods for solving the supercavitating flow and calculating dynamic forces those based on semi analytical and analytical relations have acceptable accuracy for small cavitation numbers only despite being fast and thus are not suitable for artificial supercavitating flows with relatively high cavitation numbers semenenko 2001 on the other hand although the methods based on solution to potential flow have an acceptable accuracy level they are not preferred for implementation at control logics due to iterative solution approach and low speed system identification si and it s application in control of marine vessels has been a topic of interest since the 1970s and its importance has attracted the attention of many researchers in the past decades researchers have developed and applied various modeling methods based on si for dynamic modeling of surface ships and underwater vehicles such as least square method extended kalman filter recursive prediction error method and maximum likelihood method but these methods have drawbacks such as initial values dependency and ill conditioned solutions xu et al 2013 to overcome these defects a great deal of work has been reported in the literature proposing the use of different algorithms such as frequency domain identification method perez and fossen 2011 neural network mahfouz and haddara 2003 and support vector machines however a comparison between the proposed methods to address the identification problem in both time and frequency domains has highlighted the superiority of the frequency domain methods perez and fossen 2011 the main innovation in this study is the application of the system identification method for modeling and calculation of the applied forces on the cavitator in unsteady flow utilization of the system identification method has the advantage of providing a simple and at the same time accurate model these key characteristics make the model obtained from the algorithm suggested in the present study ideal to be used in the control loop of the controller actuator of control and lift fins controllable cavitators and submerged and partially submerged fins are widely used in high speed underwater and overwater vehicles in which the control or lifting surfaces are fully or partially cavitated the angle control actuator controls the vehicle by giving dynamic commands to the control and lifting surfaces according to the input signals in order to determine the appropriate angle a simple but accurate model is required which can predict the dynamic loads applied to fin in different conditions and send proper commands to the actuator given the need for a real time and minimized lag between receiving the input signal and sending the command a simple linear and accurate load transfer function plays a key role the controllable variable pitch propellers of ships are a modern application of the model extracted from the suggested algorithm in these propellers the controller controls the hydrostatic forces by changing propeller pitch angle for optimum performance of the controller a quick and accurate model is required to predict the relationship between the changes in the pitch angle and hydrostatic forces furthermore another application of the suggested model is in controlling the lifting and control surfaces of racing and recreational speedboats in modern designs of these boats their hulls are usually separated from the water surface at high speeds and only the control and lifting fins are inside water due to the high speed of boats in such conditions the quick and precise calculation of their control and lifting surfaces angle is crucial to maintain their proper performance cavitators are also used in conceptual designs of modern high speed submarines by using a cavitator in front of the hull and creating supercavity the friction drag can be markedly reduced moreover the maneuverability of vehicles can be improved by controlling the angle of cavitator by using the algorithm suggested in the present study a suitable model can be obtained to predict the dynamic loads applied to the cavitator under dynamic control commands and used to determine the proper angle of cavitator the present research proposes a noniterative model to determine the unsteady supercavitation assuming potential flow as the first step in this model the unsteady solution is simulated assuming small changes in the potential field around the steady flow the steady solution is also found by applying the nonlinear boundary element method based on potential flow using the frequency response method a generic model for calculation of the dynamic forces applied to the cavitator is developed 2 hydrodynamic modeling consider a plate in a supercavitating flow as shown in fig 1 the flow around the supercavity can be assumed as non viscous non rotational and incompressible with an acceptable accuracy vaz 2005 the governing equation of the potential flow is derived in the form of laplace s equation as 1 2 ϕ 0 according to the potential flow assumptions navier stokes momentum equation may be written in to following form of unsteady bernoulli s equation 2 ϕ t 1 2 ϕ 2 p r e f ρ ϕ t 1 2 ϕ 2 p ρ g z where p ρ and p r e f represent the pressure fluid density and reference pressure respectively the reference pressure is the flow pressure upstream moreover assuming a steady uniform flow far away ϕ v unsteady bernoulli s equation is recast to the following format 3 1 2 v 2 p r e f ρ ϕ t 1 2 ϕ 2 p ρ g z 2 1 boundary conditions bcs in order to solve the laplace equation are given in eq 1 at the external domain the boundary conditions on each boundary shown in fig 1 should be specified domain boundary is divided into the following surfaces plate surface s b cavity surface s c wake surface s w farfield surface s 2 1 1 plate bcs on the cavitator surface no penetration boundary condition is valid the no penetration boundary condition is written in form of a neumann s boundary condition as below 4 ϕ n 0 2 1 2 cavity bcs since the cavity surface is not determined at the beginning of the solution process two types of dynamic and kinematic boundary conditions are defined on its surface cavity surface is one of the flow streamlines and according to definition the flow velocity over streamlines is tangent to the surface therefore the kinematic boundary condition on the cavity surface is written in the following form vaz 2005 5 v s η s v n η t in which v s ϕ s is the tangential component of velocity v n ϕ n is the normal component of velocity s and n are the unit vectors of the orthogonal coordinate system and η is the cavity thickness parameter shown in fig 2 dynamic boundary condition implies that the pressure on the supercavity boundary is constant and equal to the vapor pressure inside the cavity p p v substituting p p v into the bernoulli equation as given in eq 3 dynamic boundary condition is derived as the following nonlinear relation 6 ϕ 2 v 2 1 σ 2 g z 2 ϕ t 0 where σ is the dimensionless cavitation number defined as 7 σ p r e f p v 1 2 ρ v 2 using the gradient definition in the normal tangential coordinate system shown in fig 2 in eq 6 dynamic boundary condition can be shown in the following form 8 ϕ s v 2 1 σ 2 g z 2 ϕ t v n 2 neglecting the vertical velocity component in the above relation vaz et al 2003 9 ϕ s v 2 1 σ 2 g z 2 ϕ t 2 1 3 wake bcs in the present study the prescribed wake method as indicated in fig 1 is applied as can be seen the wake surface is divided into two sections the upper surface s w u and the lower surface s w l the wake surface should also comply with the dynamic and kinematic boundary conditions according to the conservation law the flux passing through the upper and lower surfaces should be equal therefore the kinematic boundary condition is defined as 10 q w u q w l 0 where q w u and q w l are the passing fluxes through the wake s upper and lower surfaces respectively dynamic boundary condition implies that the flow pressure at the wake s upper and lower surfaces should be equal 11 p w u p w l applying bernoulli s eq 3 to the wake s upper and lower surfaces and subtracting the results vaz 2005 12 δ ϕ t v w δ ϕ x 0 in which v w is the flow velocity on wake and in the wake direction and δ ϕ ϕ w u ϕ w l 2 1 4 farfield bcs far field boundary condition implies that at the far field potential flow is equal to free flow potential 13 s ϕ ϕ 2 2 steady hydrodynamic model in steady solution potential at each point within the fluid can be written as the summation of incoming uniform flow potential and perturbed potential due to the presence of the plate in the flow as follows 14 ϕ ϕ ϕ ˆ where ϕ is the total steady potential and ϕ ˆ is the steady disturbance potential substituting eq 14 into eq 1 the governing equation of steady disturbance potential is derived as 15 2 ϕ ˆ 0 also the steady bernoulli s equation is resulted from eliminating the unsteady terms in eq 3 as 16 1 2 v 2 p r e f ρ 1 2 ϕ 2 p ρ g z 2 2 1 plate bcs substituting definition eq 14 into eq 4 the boundary condition on the plate is obtained as 17 ϕ ˆ n v n 2 2 2 cavity bcs kinematic boundary condition is derived from deleting unsteady terms in eq 5 as 18 η s v n v s for steady dynamic boundary condition eliminating the unsteady term in eq 8 and using the disturbance potential definition eq 14 the following is derived for the derivative term ϕ s 19 ϕ ˆ s v 2 1 σ 2 g z v s integrating the above relation in s direction from the cavity start point s s 0 and with potential ϕ ˆ 0 the above equation is written in the form of dirichlet steady disturbance potential as 20 ϕ ˆ ϕ ˆ 0 s 0 s v 2 1 σ 2 g z v s d s 2 2 3 wake bcs in the steady state potential is constant and does not depend on time and therefore potential for the wake shown in fig 1 is constant from the wake start point to infinity eliminating the unsteady term in eq 12 and substituting definition eq 14 steady flow boundary condition is obtained as 21 δ ϕ ˆ w c o n s t in the present paper morino kutta condition is used as follows to define the vortex elements potential and satisfying eq 21 22 δ ϕ ˆ w ϕ ˆ c u ϕ ˆ c l in which ϕ ˆ c u is the disturbance potential at the cavity upper end and ϕ ˆ c l is the disturbance potential at the cavity lower end at the wake start point 2 2 4 farfield bcs at the far field flow disturbances are eliminated and the disturbance velocity at the far field flow tends to zero 23 s lim r ϕ ˆ 0 2 3 unsteady hydrodynamic model in unsteady solution it is assumed that the plate oscillates at high frequency and low amplitude in a steady fluid and therefore the potential at each point in the fluid can be written as the summation of steady potential and disturbance potential due to oscillations of the plate in the flow 24 ϕ ϕ ϕ in which ϕ is the total steady potential and ϕ is the unsteady disturbance potential substituting eq 24 into eq 1 it can be shown that laplace s equation is valid for the unsteady disturbance potential 25 2 ϕ 0 moreover unsteady bernoulli s equation in terms of unsteady disturbance potential is obtained by substituting eq 24 into eq 3 26 1 2 v 2 p r e f ρ ϕ t 1 2 ϕ 2 p ρ g z 2 3 1 plate bcs the no penetration boundary condition on the plate implies that 27 ϕ n q b where q b is the normal component of the plate oscillation velocity to the plate inserting eq 24 into eq 27 the boundary condition on the plate for unsteady disturbance potential is derived as 28 ϕ n q b 2 3 2 cavity bcs in this study assuming the plate oscillations with low amplitude and high frequency as a result of which the cavity does not have enough time to respond to the changes it also is assumed that the changes in the cavity length and shape are small and therefore neglected thus it can be presumed that the kinematic boundary condition eq 5 always holds on the cavity unsteady dynamic boundary condition can be derived by writing unsteady bernoulli s eq 26 and inserting p p v in the form of 29 1 2 v 2 p r e f ρ ϕ t 1 2 ϕ 2 p v ρ g z substituting eq 24 into eq 29 and neglecting the nonlinear terms 30 1 2 v 2 p r e f ρ ϕ t 1 2 ϕ 2 ϕ ϕ p v ρ g z cavity dynamic boundary condition is resulted from subtracting steady bernoulli s eq 16 from eq 30 31 ϕ t v 0 ϕ 0 in which v 0 ϕ is the steady flow velocity vector 2 3 3 wake bcs boundary conditions on the wake are derived in a similar way to eq 12 32 δ ϕ t v 0 δ ϕ x 0 2 3 4 farfield bcs in the far field flow disturbances are neglected and the disturbance velocity in the far field flow tends to zero 33 s lim r ϕ 0 3 boundary element model in the present study boundary element method is applied to solve the laplace equation potential field produced by a unit source which is known as the basic solution to laplace equation is defined in 2d as the following 34 ϕ 1 2 π ln r where r is the distance to the source applying the second green s theorem in a fluid region with external boundary of c except for a circle with the radius of ε about an arbitrary point of p as indicated in fig 3 one obtains 35 s s ε ϕ 2 ϕ ϕ 2 ϕ d s c ϕ q q ϕ d c c ε ϕ q q ϕ d c 0 with q ϕ n and q ϕ n simplifying and assuming that ϕ and q are well behaved functions it can be shown that 36 c p ϕ p c ϕ q q ϕ d c 0 37 c p χ 2 π where χ is the internal spatial angle seen from point p if point p is located on the boundary curve c p equals to 0 5 and 1 0 if located within the fluid domain the boundary integral eq 36 can be solved numerically by dividing the fluid boundary into small boundary elements the integral is calculated at each boundary element and the values are added to finally obtain the integral eq 36 38 c i ϕ i j 1 n b e c j ϕ j q i q j ϕ i d c j 0 with n b e being the number of elements on the fluid boundary potential density and flux at each point inside the element can be found by choosing proper interpolation functions between node values 39 ϕ n i ϕ i 40 q n i q i in which n i is the matrix row including the mode shapes of the ith element and ϕ i and q i are vectors including the potential density and flux values of the element inserting eqs 39 40 into eq 38 and transforming the resulted integrals to the local coordinate system of the element x 1 firouz abadi et al 2008 41 c i ϕ i j 1 n b e h i j ϕ j g i j q j 0 and 42 h i j 1 1 q i n j j j d x 1 43 g i j 1 1 ϕ i n j j j d x 1 and j j is the determinant of the transformation jacobian matrix from the general coordinate system to the element coordinates using the point collocation method and calculating eq 41 at all boundary points the following matrix form is obtained firouz abadi et al 2008 44 a ϕ bq 0 with a and b being the influence matrices and ϕ and q the values of potential density and flux at boundary element nodes respectively applying the boundary conditions to the system of algebraic eq 44 values of potential density and flux can be calculated 4 solution algorithm in this section the applied algorithms for calculation of steady and unsteady supercavities are described 4 1 steady solution algorithm the fully nonlinear algorithm shown in fig 4 is applied to derive the steady supercavitation and steady flow parameters dang 2001 for the cavity closure condition the pressure recovery model described in kinnas and fine 1993 is used since the supervacity s geometry is unknown at the initiation of the solution an iterative method shall be used first an arbitrary defined boundary is assumed at the beginning of each iteration potential on the cavitator and cavity as well as cavity flux is unknown thereafter the governing equation given in eq 15 with the boundary conditions expressed in eqs 17 22 and 20 is solved finding the values of ϕ ˆ tangential and normal velocity components on supercavity are derived finally the shape of supercavity is updated by the kinematic boundary condition in eq 18 which can be considered as a streamline tracing procedure the solution is repeated until a reasonable convergence occurs for the shape of supercavity and the vertical velocity component vanishes 4 2 unsteady solution algorithm for unsteady solution the steady flow around the plate should be solved first and the steady supercavity shape and steady potential values are then calculated cavitator and the wake are divided into elements to solve the unsteady flow equation given in eq 25 and find the distribution of ϕ element distribution over the cavity is cosinusoidal moreover the distribution of ϕ and ϕ n is assumed to be constant and uniform for each element accordingly the influence coefficients in eq 44 are determined for the resulting elements on the other hand according to the kinematic boundary condition eq 28 the value of ϕ n is known on the surface of the cavitator additionally due to the fact that the supercavity s boundary is a streamline it is concluded that ϕ n 0 it is worth mentioning that the value of ϕ on the surface of cavity is determined by utilizing the dynamic boundary condition eq 31 on the wake using the first order forward difference approximation in eq 32 and applying kutta s condition 45 γ o w γ o w c ϕ c 0 with γ δ ϕ being the wake vortex strength and o w and o w c the matrix operators as 46 q w i j 1 i j 1 v 0 w i j 1 v 0 w o t h e r w i s e 47 q w c i j 1 i j 1 1 i 1 j n c 0 o t h e r w i s e where δ w is the wake element length and n c is the total number of elements on the supercavity s upper and lower edges in a similar manner for boundary condition eq 31 48 ϕ c o c ϕ c o c b ϕ b 0 in which matrix operators o c and o c b are derived similar to eq 45 except for using the potential equality condition at the attachment point to plate instead of kutta s condition at the upper and lower edges it is assumed that the cavitator oscillates about its center with a low amplitude and high frequency assuming that the variations of the cavitator s angle about its steady state is θ t and the kinematic boundary condition on the cavitator from eq 28 is found as 49 ϕ n θ t k r where r is the distance vector from the center to the point on the cavitator putting all the differential equations in eqs 44 45 48 49 together the following general system of equation is obtained 50 c ϕ k ϕ q where c 0 0 0 0 i 0 0 0 i k a b a c a w o c b o c 0 0 o w c o w q b q b 0 0 ϕ ϕ b ϕ c γ w temporal solution to the above mentioned system of equations gives the distribution of ϕ with respect to time consequently utilizing the bernoulli equation as stated in the following relation variation of the perturbed pressure with respect to time is determined 51 p ρ ϕ t ρ v 0 ϕ perturbed moment acting on the cavitator is also determined by integrating the perturbed pressure over the cavitator s surface 52 m h 2 h 2 p r d r 5 dynamic loading model the model presented in the previous section is intended to determine the hydrodynamic loads acting on a flat plate in a supercavitating flow while in the present section a model is developed to relate the cavitator excitation θ to the dynamic moment acting on the cavitator the model is determined via system identification and frequency response the input is assumed to be changes of angle and the output is the exerted moment to the cavitator therefore according to the definition of the transfer function of the plate supercavity hydrodynamic system g s the following relation holds 53 θ s 1 g s m s according to the nature of the problem a transfer function g s in the following form is suggested 54 g s m s 2 c s k i a i s b i i d i s e i s 2 f i s g i where coefficients m c and k are associated with mass damping and stiffness respectively and the coefficients in the remaining two fractions define the dynamic behavior of the system all being functions of the cavitation number frequency representation of the transfer function g is obtained by replacing s with i ω in the transfer function as 55 g i ω m ω 2 i c ω k i a i i ω b i i i d i ω e i ω 2 i f i ω g i frequency representation of the transfer function g i ω can be described in the form of amplitude phase difference 56 g i ω m e i ψ m ψ in order to determine coefficients of the transfer function g i ω by means of the previously mentioned hydrodynamic model amplitude and phase of the steady moment response exerting on cavitator are calculated for various cavitation numbers and different frequencies of a sinusoidal excitation afterwards analyzing the amplitude frequency and phase frequency curves coefficients of the transfer function are determined for various cavitation numbers subsequently fitting curves to the trend of variations of any of the coefficients with respect to cavitation number a relation is obtained in terms of σ for each coefficient after defining the system transfer function coefficients the applied moment to the cavitator for an arbitrary excitation can be found by inverse laplace s transform of eq 53 to this aim inserting the definition of g s from eq 55 into eq 53 and defining two variables of α and β in the following forms 57 α i s a i s b i θ s 58 β i s d i s e i s 2 f i s g i θ s and applying inverse laplace s transform thereafter time response moment relation for an arbitrary excitation θ is obtained as 59 m t m θ c θ k θ i α i i β i 60 α i b i α i a i θ t 61 β i f i β i g i β i d i θ t e i θ t to simplify the curve fitting process in this study only the first term of expansions in eq 54 is used using this single term in expansion of eq 55 amplitude and phase difference are found 62 m ℜ g 2 ℑ g 2 63 ψ tan 1 ℑ g ℜ g where 64 ℜ m ω 2 k a b b 2 ω 2 e g ω 2 d f ω 2 g ω 2 2 f 2 ω 2 65 ℑ c ω a ω b 2 ω 2 d g ω 2 ω e f ω g ω 2 2 f 2 ω 2 6 verification and numerical results verification studies for supercavity hydrodynamic and dynamic loading models are presented moreover the dynamic loading model is applied to an example and the exerted moment on the cavitator is determined for a step and rectangular excitation for steady hydrodynamic model convergence with the number of panels on the cavity is shown for the cavity length and maximum diameter in fig 5 in order to verify the obtained results from implementation of the steady hydrodynamic model two main geometrical parameters of supercavity being its length l c and maximum diameter r c are compared with the values calculated by semi empirical relations in savchenko et al 1999 and garabedian 1956 and the experimental results in semenenko 2001 results are depicted in figs 6 7 dimensionless results are obtained with the aid of the cavitator width r n results are in good agreement with experimental and semi experimental results also in order to verify the steady supercavity shape the obtained results are compared with the values calculated by semi empirical relations in savchenko et al 1999 fig 8 shows the obtained cavity shape for σ 0 01 and 0 1 the obtained results demonstrate the validity of this approach fig 9 indicates the obtained supercavity for different cavitation numbers the pressure distribution on the plate for steady flow is obtained using the presented model and compared with experimental results in fage and johansen 1927 fig 10 shows the calculated results at σ 1 38 to find the cavitator dynamic loading model a plate with the width of r n 10 0 cm in a supercavitating flow is considered first the supercavity steady response including the geometry and velocity distribution on the cavitator and supercavity for various cavitation numbers are derived then the dynamic loading applied on the cavitator is determined using the steady solution and sinusoidal excitation of the cavitator with an amplitude of 1 d e g as a result amplitude and phase difference are derived fig 11 shows the amplitude excitation frequency and fig 12 indicates the phase difference excitation frequency for different cavitation numbers accompanied by fitted curves the results show that the excitation frequency can affect the amplitude and phase change of the response which will be used for identification of dynamics of the hydrodynamic system transfer function coefficients are determined from curve fitting to amplitude phase in terms of cavitation number as presented in table 1 also the fitted curves and raw data are indicated in figs 13 and 14 as obvious from the relations almost all transfer function coefficients can be obtained with an acceptable accuracy with linear or at most polynomial functions of third degree in order to verify the developed dynamic loading model results from the suggested model are compared with the dynamic simulation results in response to unit step and unit rectangular excitation in form of the function eq 66 in fig 15 and fig 16 respectively 66 θ t 0 t 0 1 0 t 5 0 t 5 7 conclusion in the present study a model for calculating the applied loads on a plate in a supercavitating flow is developed by system identification and applying the potential flow theory in this approach assuming a high frequency and low amplitude plate angle change the cavity geometry is considered to be constant accordingly the unsteady supercavitating flow is analyzed by adding the perturbed potential terms to the steady flow using the resulted unsteady model and system identification theory a method for determining the applied forces to the flat plate and under any arbitrary excitation is proposed for this means the unsteady loads acting on the plate are calculated for different cavitation numbers and under oscillating excitation with various frequencies and then using the curve fitting techniques for phase amplitude curves the coefficients of the excitation load function are found the proposed approach has the advantage of simply calculating the unsteady forces acting on plate under any arbitrary excitation using one single linear transfer function the obtained results for the transfer function coefficients indicate that their dependency on the cavitation number is almost linear and can be calculated in term of cavitation number with a significant accuracy with polynomials of at most 3 rd order therefore these coefficients can be well used to estimate the required loads for modification of the plate angle by the actuator in dynamic and control models loads acting on the plate under step and rectangular excitations are then determined and results are compared with the unsteady perturbed analysis of the supercavity which shows a good compatibility to summarize an algorithm is suggested to obtain the unsteady loads applied to a plate in a supercavitating flow based on system identification theory using potential flow method if higher accuracy levels in transfer function are required the applied tools in this algorithm can be replaced with more accurate methods such as computational fluid dynamics or other approaches credit authorship contribution statement m a tehrani conceptualization methodology software validation writing original draft visualization r d firouz abadi conceptualization methodology supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
21826,a new and efficient model for calculation of the unsteady hydrodynamic loads on an oscillating plate in two dimensional flow is proposed in order to compute the hydrodynamic loads an unsteady hydrodynamic model is derived using the boundary element method along with the potential flow assumption to this aim the steady boundary of cavity is determined by a full nonlinear iterative procedure thereafter assuming that amplitude and frequency of oscillations are so that the length of cavity in unsteady flow remains intact simulation of the unsteady hydrodynamic flow is performed by imposing some velocity perturbations over the steady cavity solutions consequently based on this formulation a system identification method is used to obtain a linear model for determination of the applied forces on the plate in unsteady flow results obtained using the proposed algorithm are verified keywords supercavitation potential flow boundary element method system identification nomenclature ϕ steady flow total potential η cavity thickness γ wake vortex strength circulation ϕ ˆ steady flow perturbed potential ω frequency of cavitator excitation ϕ flow total potential ϕ potential of unit source σ cavitation number θ cavitator s angle ϕ unsteady flow perturbed potential p perturbed pressure g s moment transfer function m perturbed moment action on the cavitator p v vapor pressure inside the cavity q normal velocity flux s farfield surface s b plate surface s c cavity surface s w wake surface l c supercavity length n b e total number of elements on the fluid boundary r c supercavity maximum diameter r n cavitator width ϕ ˆ 0 perturbed potential of steady flow at cavity detachment point ϕ ˆ w perturbed potential of steady flow at wake j j jacobian matrix v 0 steady flow velocity v inflow velocity ϕ uniform flow potential v n normal component of velocity v s tangential component of velocity 1 introduction cavitation phenomenon occurs over the surfaces of an immersed body at high speeds at points where the pressure drops below the fluid vapor pressure if the cavitation number is low enough due to high speed or low vapor pressure cavity expands to finally surround the whole body referred to as supercavitation due to its negative erosive vibrational and acoustic effects cavitation used to be known as a destructive phenomenon to be avoided due to reduction in surface frictional drag and accordingly increase of the underwater vehicle s speed supercavitation phenomenon has drawn a lot of attention in the recent decades serebryakov et al 2009 kirschner et al 2001 in order to model supercavitating flows various methods are proposed analytical and semi analytical approaches well suited to linear and simple simulations pellone et al 2004 kirschner et al 2002 methods based on potential flow assumptions nouri and eslamdoost 2009 celik et al 2014 as well as those based on the solution to navier stokes equation lindau et al 2002 chen et al 2011 wang et al 2015 are some of the available approaches due to its simplicity and desired accuracy many researchers have applied the potential flow assumption to model both steady and unsteady supercavitating flows among various approaches for solving the supercavitating potential flow such as slender body theory tulin 1953 chou 1974 kirschner et al 2009 finite element and boundary element methods alavi et al 2018 the latter is more commonly utilized due to its higher ability specifically in solving the potential equations uhlman applied the nonlinear velocity based boundary element method for the first time to solve the problems of partially cavitating flow over hydrofoils uhlman 1987 and supercavitating hydrofoils uhlman 1989 kinnas and fine 1991 proposed a fully nonlinear potential based bem to solve partially and supercavitating flows this approach was more preferred to uhlman s 1987 1989 velocity based method from the convergence rate point of view they applied the pressure recovery method that has an acceptable accuracy for cavity termination model assuming a compressible potential flow and applying the modified riabouchinsky cavity termination model kirschner et al 1995 suggested a model to determine axisymmetric supercavitation in subsonic flow dang and kuiper applied re entrant jet model at the end of the cavity and a full nonlinear approach to model a partially cavitating flow around 2d dang and kuiper 1999a and 3d dang and kuiper 1999b hydrofoils uhlman et al fine et al 2001 proposed a linearized model assuming potential flow to calculate the unsteady forces applied on the supercavity in terms of added mass and damping value vaz 2005 categorized the existing cavitation models and delineated the advantages and disadvantages of all models the full and partial nonlinear models with the two approaches of re entrant jet and pressure recovery for cavity termination are compared in terms of accuracy simplicity efficiency and convergence rate uhlman 2006 derived a fully nonlinear potential based bem to calculate axisymmetric supercavitation comparing results of the two termination methods of re entrant jet and riabouchinsky it is found that both approaches are in a good agreement except for the short supercavities despite the decent performance of nonlinear models in predicting partial and supercavities the estimated surface displacement for the cavity at each step and therefore the need for recalculating the coefficients increases the computational costs dang 2001 recently behbahani nejad and changizian 2013a have suggested a non iterative solution algorithm based on bem to calculate the partial unsteady cavitation accordingly a reduced order model is later proposed to predict the behavior of 2d and 3d unsteady partial cavitation behbahani nejad and changizian 2013b 2015 reduced order model significantly decreases the required calculations by reduction of the degrees of freedom and considering the most effective mode shapes derivation of a hydrodynamic model of supercavity is important to design a proper controller as well as structural analysis of the immersed body the dynamic model should provide reasonable swiftness and accuracy simultaneously rand et al 1997 considered the motion dynamics of a supercavitating body and the effects of tail impact to the supercavity wall in order to determine forces applied to the nose existing experimental results were used using semi analytical relations kirschner et al 2002 obtained the forces applied to cavitators and fins and proposed a 6 degree of freedom dynamical model to simulate the motion of a projectile in fluid choi et al 2004 developed a model for dynamic vibration and stability response analysis of a flexible supercavitating body inside a supercavitation to control surface excitation and specific maneuvers the modal element method is used to model the behavior of a flexible body along with the empirical relations for determination of the cavity configuration and hydrodynamic loading assuming an elastic beam as the supercavitating body ruzzene and soranna 2004 suggested a model for motion dynamics and vibration analysis of the body considering the tail impact effects for applications in structural analyses and design of stiffened bodies afterwards applying the resulted hydrodynamic model as well as structural analysis in multi disciplinary design optimization method a structure with minimized vibration mass and cost as well as maximized safety factor is obtained kirschner et al 2006 discussed the motion dynamics of the body in different phases from the cavity forming initiation to partial and finally supercavitation proposing a simplified single degree of freedom spring mass model they considered the vibrational stability of the body under various conditions lin et al 2008 studied the motion dynamics and control of a supercavitating body considering the nonlinear effects due to planing force they suggested the two approaches of linear feedback control and switching control for robust vibration control of the body inside the supercavity and investigated the efficiency of the two methods unlike the previous researches nguyen and balachandran 2011 considered the effects of the cavitator angle of attack on cavity shape and provided a model to study the motion dynamics of a projectile inside a nonsymmetric and noncylindrical supercavity and indicated the significant effect of the cavity shape over the system dynamics they applied semi empirical relations to model the cavity geometry and investigate the effect of angle of attack on cavity axis deformation hassouneh et al 2012 and li et al 2014 developed a more accurate model to determine the forces acting on the supercavitating body as well as its motion dynamics by adding the time delay effect or namely the cavity memory effect to the previous models consideration of the time delay is of significant importance due to its effect on the supercavity shape and also the induced delay for the changes in the cavitator to approach the back of the supercavity for implementation of control logic kim and kim 2015 proposed a 6 degree of freedom model for analysis of motion dynamics of a body within a supercavity based on the previous researches and considering the various effective parameters over the cavity shape such as gravity as well as different forces applied to the body like cavitator force fin force planing force and the applied force on the immersed part of the body and thereafter investigated the stability of the body motion for different values of the effective factors considering the effect of nonlinear force caused by tail impact and using the experimental results sanabria and arndt 2018 developed a low order nonlinear model for longitudinal motion of the vehicle based on which a method to design a controller in the presence of nonlinear and indeterminate planing force is proposed they employed analytical relations based on drag coefficient for calculating the forces applied to the cavitators and fins in a supercavitating body only small parts of the body are in contact with the fluid and can act as the control surfaces also the interactions of the control surfaces and supercavity dynamics is nonlinear and complicated control system design and choosing appropriate actuators require an accurate calculation of the applied forces over the control surfaces large variations in control surface angles can result in development of large planing forces and instability of the body kim 2018 designed a controller based on an impact input to produce slight changes in pitch angle calculation of the applied forces on the cavitator is essential to design a controller for body motion within the fluid also it is important to find the applied moments and forces on the cavitator for a proper actuator choice accurate and real time calculation of hydrodynamic forces acting on the marin vessel is important in the design of high performance model based control systems for steering of marine vessels among the proposed methods for solving the supercavitating flow and calculating dynamic forces those based on semi analytical and analytical relations have acceptable accuracy for small cavitation numbers only despite being fast and thus are not suitable for artificial supercavitating flows with relatively high cavitation numbers semenenko 2001 on the other hand although the methods based on solution to potential flow have an acceptable accuracy level they are not preferred for implementation at control logics due to iterative solution approach and low speed system identification si and it s application in control of marine vessels has been a topic of interest since the 1970s and its importance has attracted the attention of many researchers in the past decades researchers have developed and applied various modeling methods based on si for dynamic modeling of surface ships and underwater vehicles such as least square method extended kalman filter recursive prediction error method and maximum likelihood method but these methods have drawbacks such as initial values dependency and ill conditioned solutions xu et al 2013 to overcome these defects a great deal of work has been reported in the literature proposing the use of different algorithms such as frequency domain identification method perez and fossen 2011 neural network mahfouz and haddara 2003 and support vector machines however a comparison between the proposed methods to address the identification problem in both time and frequency domains has highlighted the superiority of the frequency domain methods perez and fossen 2011 the main innovation in this study is the application of the system identification method for modeling and calculation of the applied forces on the cavitator in unsteady flow utilization of the system identification method has the advantage of providing a simple and at the same time accurate model these key characteristics make the model obtained from the algorithm suggested in the present study ideal to be used in the control loop of the controller actuator of control and lift fins controllable cavitators and submerged and partially submerged fins are widely used in high speed underwater and overwater vehicles in which the control or lifting surfaces are fully or partially cavitated the angle control actuator controls the vehicle by giving dynamic commands to the control and lifting surfaces according to the input signals in order to determine the appropriate angle a simple but accurate model is required which can predict the dynamic loads applied to fin in different conditions and send proper commands to the actuator given the need for a real time and minimized lag between receiving the input signal and sending the command a simple linear and accurate load transfer function plays a key role the controllable variable pitch propellers of ships are a modern application of the model extracted from the suggested algorithm in these propellers the controller controls the hydrostatic forces by changing propeller pitch angle for optimum performance of the controller a quick and accurate model is required to predict the relationship between the changes in the pitch angle and hydrostatic forces furthermore another application of the suggested model is in controlling the lifting and control surfaces of racing and recreational speedboats in modern designs of these boats their hulls are usually separated from the water surface at high speeds and only the control and lifting fins are inside water due to the high speed of boats in such conditions the quick and precise calculation of their control and lifting surfaces angle is crucial to maintain their proper performance cavitators are also used in conceptual designs of modern high speed submarines by using a cavitator in front of the hull and creating supercavity the friction drag can be markedly reduced moreover the maneuverability of vehicles can be improved by controlling the angle of cavitator by using the algorithm suggested in the present study a suitable model can be obtained to predict the dynamic loads applied to the cavitator under dynamic control commands and used to determine the proper angle of cavitator the present research proposes a noniterative model to determine the unsteady supercavitation assuming potential flow as the first step in this model the unsteady solution is simulated assuming small changes in the potential field around the steady flow the steady solution is also found by applying the nonlinear boundary element method based on potential flow using the frequency response method a generic model for calculation of the dynamic forces applied to the cavitator is developed 2 hydrodynamic modeling consider a plate in a supercavitating flow as shown in fig 1 the flow around the supercavity can be assumed as non viscous non rotational and incompressible with an acceptable accuracy vaz 2005 the governing equation of the potential flow is derived in the form of laplace s equation as 1 2 ϕ 0 according to the potential flow assumptions navier stokes momentum equation may be written in to following form of unsteady bernoulli s equation 2 ϕ t 1 2 ϕ 2 p r e f ρ ϕ t 1 2 ϕ 2 p ρ g z where p ρ and p r e f represent the pressure fluid density and reference pressure respectively the reference pressure is the flow pressure upstream moreover assuming a steady uniform flow far away ϕ v unsteady bernoulli s equation is recast to the following format 3 1 2 v 2 p r e f ρ ϕ t 1 2 ϕ 2 p ρ g z 2 1 boundary conditions bcs in order to solve the laplace equation are given in eq 1 at the external domain the boundary conditions on each boundary shown in fig 1 should be specified domain boundary is divided into the following surfaces plate surface s b cavity surface s c wake surface s w farfield surface s 2 1 1 plate bcs on the cavitator surface no penetration boundary condition is valid the no penetration boundary condition is written in form of a neumann s boundary condition as below 4 ϕ n 0 2 1 2 cavity bcs since the cavity surface is not determined at the beginning of the solution process two types of dynamic and kinematic boundary conditions are defined on its surface cavity surface is one of the flow streamlines and according to definition the flow velocity over streamlines is tangent to the surface therefore the kinematic boundary condition on the cavity surface is written in the following form vaz 2005 5 v s η s v n η t in which v s ϕ s is the tangential component of velocity v n ϕ n is the normal component of velocity s and n are the unit vectors of the orthogonal coordinate system and η is the cavity thickness parameter shown in fig 2 dynamic boundary condition implies that the pressure on the supercavity boundary is constant and equal to the vapor pressure inside the cavity p p v substituting p p v into the bernoulli equation as given in eq 3 dynamic boundary condition is derived as the following nonlinear relation 6 ϕ 2 v 2 1 σ 2 g z 2 ϕ t 0 where σ is the dimensionless cavitation number defined as 7 σ p r e f p v 1 2 ρ v 2 using the gradient definition in the normal tangential coordinate system shown in fig 2 in eq 6 dynamic boundary condition can be shown in the following form 8 ϕ s v 2 1 σ 2 g z 2 ϕ t v n 2 neglecting the vertical velocity component in the above relation vaz et al 2003 9 ϕ s v 2 1 σ 2 g z 2 ϕ t 2 1 3 wake bcs in the present study the prescribed wake method as indicated in fig 1 is applied as can be seen the wake surface is divided into two sections the upper surface s w u and the lower surface s w l the wake surface should also comply with the dynamic and kinematic boundary conditions according to the conservation law the flux passing through the upper and lower surfaces should be equal therefore the kinematic boundary condition is defined as 10 q w u q w l 0 where q w u and q w l are the passing fluxes through the wake s upper and lower surfaces respectively dynamic boundary condition implies that the flow pressure at the wake s upper and lower surfaces should be equal 11 p w u p w l applying bernoulli s eq 3 to the wake s upper and lower surfaces and subtracting the results vaz 2005 12 δ ϕ t v w δ ϕ x 0 in which v w is the flow velocity on wake and in the wake direction and δ ϕ ϕ w u ϕ w l 2 1 4 farfield bcs far field boundary condition implies that at the far field potential flow is equal to free flow potential 13 s ϕ ϕ 2 2 steady hydrodynamic model in steady solution potential at each point within the fluid can be written as the summation of incoming uniform flow potential and perturbed potential due to the presence of the plate in the flow as follows 14 ϕ ϕ ϕ ˆ where ϕ is the total steady potential and ϕ ˆ is the steady disturbance potential substituting eq 14 into eq 1 the governing equation of steady disturbance potential is derived as 15 2 ϕ ˆ 0 also the steady bernoulli s equation is resulted from eliminating the unsteady terms in eq 3 as 16 1 2 v 2 p r e f ρ 1 2 ϕ 2 p ρ g z 2 2 1 plate bcs substituting definition eq 14 into eq 4 the boundary condition on the plate is obtained as 17 ϕ ˆ n v n 2 2 2 cavity bcs kinematic boundary condition is derived from deleting unsteady terms in eq 5 as 18 η s v n v s for steady dynamic boundary condition eliminating the unsteady term in eq 8 and using the disturbance potential definition eq 14 the following is derived for the derivative term ϕ s 19 ϕ ˆ s v 2 1 σ 2 g z v s integrating the above relation in s direction from the cavity start point s s 0 and with potential ϕ ˆ 0 the above equation is written in the form of dirichlet steady disturbance potential as 20 ϕ ˆ ϕ ˆ 0 s 0 s v 2 1 σ 2 g z v s d s 2 2 3 wake bcs in the steady state potential is constant and does not depend on time and therefore potential for the wake shown in fig 1 is constant from the wake start point to infinity eliminating the unsteady term in eq 12 and substituting definition eq 14 steady flow boundary condition is obtained as 21 δ ϕ ˆ w c o n s t in the present paper morino kutta condition is used as follows to define the vortex elements potential and satisfying eq 21 22 δ ϕ ˆ w ϕ ˆ c u ϕ ˆ c l in which ϕ ˆ c u is the disturbance potential at the cavity upper end and ϕ ˆ c l is the disturbance potential at the cavity lower end at the wake start point 2 2 4 farfield bcs at the far field flow disturbances are eliminated and the disturbance velocity at the far field flow tends to zero 23 s lim r ϕ ˆ 0 2 3 unsteady hydrodynamic model in unsteady solution it is assumed that the plate oscillates at high frequency and low amplitude in a steady fluid and therefore the potential at each point in the fluid can be written as the summation of steady potential and disturbance potential due to oscillations of the plate in the flow 24 ϕ ϕ ϕ in which ϕ is the total steady potential and ϕ is the unsteady disturbance potential substituting eq 24 into eq 1 it can be shown that laplace s equation is valid for the unsteady disturbance potential 25 2 ϕ 0 moreover unsteady bernoulli s equation in terms of unsteady disturbance potential is obtained by substituting eq 24 into eq 3 26 1 2 v 2 p r e f ρ ϕ t 1 2 ϕ 2 p ρ g z 2 3 1 plate bcs the no penetration boundary condition on the plate implies that 27 ϕ n q b where q b is the normal component of the plate oscillation velocity to the plate inserting eq 24 into eq 27 the boundary condition on the plate for unsteady disturbance potential is derived as 28 ϕ n q b 2 3 2 cavity bcs in this study assuming the plate oscillations with low amplitude and high frequency as a result of which the cavity does not have enough time to respond to the changes it also is assumed that the changes in the cavity length and shape are small and therefore neglected thus it can be presumed that the kinematic boundary condition eq 5 always holds on the cavity unsteady dynamic boundary condition can be derived by writing unsteady bernoulli s eq 26 and inserting p p v in the form of 29 1 2 v 2 p r e f ρ ϕ t 1 2 ϕ 2 p v ρ g z substituting eq 24 into eq 29 and neglecting the nonlinear terms 30 1 2 v 2 p r e f ρ ϕ t 1 2 ϕ 2 ϕ ϕ p v ρ g z cavity dynamic boundary condition is resulted from subtracting steady bernoulli s eq 16 from eq 30 31 ϕ t v 0 ϕ 0 in which v 0 ϕ is the steady flow velocity vector 2 3 3 wake bcs boundary conditions on the wake are derived in a similar way to eq 12 32 δ ϕ t v 0 δ ϕ x 0 2 3 4 farfield bcs in the far field flow disturbances are neglected and the disturbance velocity in the far field flow tends to zero 33 s lim r ϕ 0 3 boundary element model in the present study boundary element method is applied to solve the laplace equation potential field produced by a unit source which is known as the basic solution to laplace equation is defined in 2d as the following 34 ϕ 1 2 π ln r where r is the distance to the source applying the second green s theorem in a fluid region with external boundary of c except for a circle with the radius of ε about an arbitrary point of p as indicated in fig 3 one obtains 35 s s ε ϕ 2 ϕ ϕ 2 ϕ d s c ϕ q q ϕ d c c ε ϕ q q ϕ d c 0 with q ϕ n and q ϕ n simplifying and assuming that ϕ and q are well behaved functions it can be shown that 36 c p ϕ p c ϕ q q ϕ d c 0 37 c p χ 2 π where χ is the internal spatial angle seen from point p if point p is located on the boundary curve c p equals to 0 5 and 1 0 if located within the fluid domain the boundary integral eq 36 can be solved numerically by dividing the fluid boundary into small boundary elements the integral is calculated at each boundary element and the values are added to finally obtain the integral eq 36 38 c i ϕ i j 1 n b e c j ϕ j q i q j ϕ i d c j 0 with n b e being the number of elements on the fluid boundary potential density and flux at each point inside the element can be found by choosing proper interpolation functions between node values 39 ϕ n i ϕ i 40 q n i q i in which n i is the matrix row including the mode shapes of the ith element and ϕ i and q i are vectors including the potential density and flux values of the element inserting eqs 39 40 into eq 38 and transforming the resulted integrals to the local coordinate system of the element x 1 firouz abadi et al 2008 41 c i ϕ i j 1 n b e h i j ϕ j g i j q j 0 and 42 h i j 1 1 q i n j j j d x 1 43 g i j 1 1 ϕ i n j j j d x 1 and j j is the determinant of the transformation jacobian matrix from the general coordinate system to the element coordinates using the point collocation method and calculating eq 41 at all boundary points the following matrix form is obtained firouz abadi et al 2008 44 a ϕ bq 0 with a and b being the influence matrices and ϕ and q the values of potential density and flux at boundary element nodes respectively applying the boundary conditions to the system of algebraic eq 44 values of potential density and flux can be calculated 4 solution algorithm in this section the applied algorithms for calculation of steady and unsteady supercavities are described 4 1 steady solution algorithm the fully nonlinear algorithm shown in fig 4 is applied to derive the steady supercavitation and steady flow parameters dang 2001 for the cavity closure condition the pressure recovery model described in kinnas and fine 1993 is used since the supervacity s geometry is unknown at the initiation of the solution an iterative method shall be used first an arbitrary defined boundary is assumed at the beginning of each iteration potential on the cavitator and cavity as well as cavity flux is unknown thereafter the governing equation given in eq 15 with the boundary conditions expressed in eqs 17 22 and 20 is solved finding the values of ϕ ˆ tangential and normal velocity components on supercavity are derived finally the shape of supercavity is updated by the kinematic boundary condition in eq 18 which can be considered as a streamline tracing procedure the solution is repeated until a reasonable convergence occurs for the shape of supercavity and the vertical velocity component vanishes 4 2 unsteady solution algorithm for unsteady solution the steady flow around the plate should be solved first and the steady supercavity shape and steady potential values are then calculated cavitator and the wake are divided into elements to solve the unsteady flow equation given in eq 25 and find the distribution of ϕ element distribution over the cavity is cosinusoidal moreover the distribution of ϕ and ϕ n is assumed to be constant and uniform for each element accordingly the influence coefficients in eq 44 are determined for the resulting elements on the other hand according to the kinematic boundary condition eq 28 the value of ϕ n is known on the surface of the cavitator additionally due to the fact that the supercavity s boundary is a streamline it is concluded that ϕ n 0 it is worth mentioning that the value of ϕ on the surface of cavity is determined by utilizing the dynamic boundary condition eq 31 on the wake using the first order forward difference approximation in eq 32 and applying kutta s condition 45 γ o w γ o w c ϕ c 0 with γ δ ϕ being the wake vortex strength and o w and o w c the matrix operators as 46 q w i j 1 i j 1 v 0 w i j 1 v 0 w o t h e r w i s e 47 q w c i j 1 i j 1 1 i 1 j n c 0 o t h e r w i s e where δ w is the wake element length and n c is the total number of elements on the supercavity s upper and lower edges in a similar manner for boundary condition eq 31 48 ϕ c o c ϕ c o c b ϕ b 0 in which matrix operators o c and o c b are derived similar to eq 45 except for using the potential equality condition at the attachment point to plate instead of kutta s condition at the upper and lower edges it is assumed that the cavitator oscillates about its center with a low amplitude and high frequency assuming that the variations of the cavitator s angle about its steady state is θ t and the kinematic boundary condition on the cavitator from eq 28 is found as 49 ϕ n θ t k r where r is the distance vector from the center to the point on the cavitator putting all the differential equations in eqs 44 45 48 49 together the following general system of equation is obtained 50 c ϕ k ϕ q where c 0 0 0 0 i 0 0 0 i k a b a c a w o c b o c 0 0 o w c o w q b q b 0 0 ϕ ϕ b ϕ c γ w temporal solution to the above mentioned system of equations gives the distribution of ϕ with respect to time consequently utilizing the bernoulli equation as stated in the following relation variation of the perturbed pressure with respect to time is determined 51 p ρ ϕ t ρ v 0 ϕ perturbed moment acting on the cavitator is also determined by integrating the perturbed pressure over the cavitator s surface 52 m h 2 h 2 p r d r 5 dynamic loading model the model presented in the previous section is intended to determine the hydrodynamic loads acting on a flat plate in a supercavitating flow while in the present section a model is developed to relate the cavitator excitation θ to the dynamic moment acting on the cavitator the model is determined via system identification and frequency response the input is assumed to be changes of angle and the output is the exerted moment to the cavitator therefore according to the definition of the transfer function of the plate supercavity hydrodynamic system g s the following relation holds 53 θ s 1 g s m s according to the nature of the problem a transfer function g s in the following form is suggested 54 g s m s 2 c s k i a i s b i i d i s e i s 2 f i s g i where coefficients m c and k are associated with mass damping and stiffness respectively and the coefficients in the remaining two fractions define the dynamic behavior of the system all being functions of the cavitation number frequency representation of the transfer function g is obtained by replacing s with i ω in the transfer function as 55 g i ω m ω 2 i c ω k i a i i ω b i i i d i ω e i ω 2 i f i ω g i frequency representation of the transfer function g i ω can be described in the form of amplitude phase difference 56 g i ω m e i ψ m ψ in order to determine coefficients of the transfer function g i ω by means of the previously mentioned hydrodynamic model amplitude and phase of the steady moment response exerting on cavitator are calculated for various cavitation numbers and different frequencies of a sinusoidal excitation afterwards analyzing the amplitude frequency and phase frequency curves coefficients of the transfer function are determined for various cavitation numbers subsequently fitting curves to the trend of variations of any of the coefficients with respect to cavitation number a relation is obtained in terms of σ for each coefficient after defining the system transfer function coefficients the applied moment to the cavitator for an arbitrary excitation can be found by inverse laplace s transform of eq 53 to this aim inserting the definition of g s from eq 55 into eq 53 and defining two variables of α and β in the following forms 57 α i s a i s b i θ s 58 β i s d i s e i s 2 f i s g i θ s and applying inverse laplace s transform thereafter time response moment relation for an arbitrary excitation θ is obtained as 59 m t m θ c θ k θ i α i i β i 60 α i b i α i a i θ t 61 β i f i β i g i β i d i θ t e i θ t to simplify the curve fitting process in this study only the first term of expansions in eq 54 is used using this single term in expansion of eq 55 amplitude and phase difference are found 62 m ℜ g 2 ℑ g 2 63 ψ tan 1 ℑ g ℜ g where 64 ℜ m ω 2 k a b b 2 ω 2 e g ω 2 d f ω 2 g ω 2 2 f 2 ω 2 65 ℑ c ω a ω b 2 ω 2 d g ω 2 ω e f ω g ω 2 2 f 2 ω 2 6 verification and numerical results verification studies for supercavity hydrodynamic and dynamic loading models are presented moreover the dynamic loading model is applied to an example and the exerted moment on the cavitator is determined for a step and rectangular excitation for steady hydrodynamic model convergence with the number of panels on the cavity is shown for the cavity length and maximum diameter in fig 5 in order to verify the obtained results from implementation of the steady hydrodynamic model two main geometrical parameters of supercavity being its length l c and maximum diameter r c are compared with the values calculated by semi empirical relations in savchenko et al 1999 and garabedian 1956 and the experimental results in semenenko 2001 results are depicted in figs 6 7 dimensionless results are obtained with the aid of the cavitator width r n results are in good agreement with experimental and semi experimental results also in order to verify the steady supercavity shape the obtained results are compared with the values calculated by semi empirical relations in savchenko et al 1999 fig 8 shows the obtained cavity shape for σ 0 01 and 0 1 the obtained results demonstrate the validity of this approach fig 9 indicates the obtained supercavity for different cavitation numbers the pressure distribution on the plate for steady flow is obtained using the presented model and compared with experimental results in fage and johansen 1927 fig 10 shows the calculated results at σ 1 38 to find the cavitator dynamic loading model a plate with the width of r n 10 0 cm in a supercavitating flow is considered first the supercavity steady response including the geometry and velocity distribution on the cavitator and supercavity for various cavitation numbers are derived then the dynamic loading applied on the cavitator is determined using the steady solution and sinusoidal excitation of the cavitator with an amplitude of 1 d e g as a result amplitude and phase difference are derived fig 11 shows the amplitude excitation frequency and fig 12 indicates the phase difference excitation frequency for different cavitation numbers accompanied by fitted curves the results show that the excitation frequency can affect the amplitude and phase change of the response which will be used for identification of dynamics of the hydrodynamic system transfer function coefficients are determined from curve fitting to amplitude phase in terms of cavitation number as presented in table 1 also the fitted curves and raw data are indicated in figs 13 and 14 as obvious from the relations almost all transfer function coefficients can be obtained with an acceptable accuracy with linear or at most polynomial functions of third degree in order to verify the developed dynamic loading model results from the suggested model are compared with the dynamic simulation results in response to unit step and unit rectangular excitation in form of the function eq 66 in fig 15 and fig 16 respectively 66 θ t 0 t 0 1 0 t 5 0 t 5 7 conclusion in the present study a model for calculating the applied loads on a plate in a supercavitating flow is developed by system identification and applying the potential flow theory in this approach assuming a high frequency and low amplitude plate angle change the cavity geometry is considered to be constant accordingly the unsteady supercavitating flow is analyzed by adding the perturbed potential terms to the steady flow using the resulted unsteady model and system identification theory a method for determining the applied forces to the flat plate and under any arbitrary excitation is proposed for this means the unsteady loads acting on the plate are calculated for different cavitation numbers and under oscillating excitation with various frequencies and then using the curve fitting techniques for phase amplitude curves the coefficients of the excitation load function are found the proposed approach has the advantage of simply calculating the unsteady forces acting on plate under any arbitrary excitation using one single linear transfer function the obtained results for the transfer function coefficients indicate that their dependency on the cavitation number is almost linear and can be calculated in term of cavitation number with a significant accuracy with polynomials of at most 3 rd order therefore these coefficients can be well used to estimate the required loads for modification of the plate angle by the actuator in dynamic and control models loads acting on the plate under step and rectangular excitations are then determined and results are compared with the unsteady perturbed analysis of the supercavity which shows a good compatibility to summarize an algorithm is suggested to obtain the unsteady loads applied to a plate in a supercavitating flow based on system identification theory using potential flow method if higher accuracy levels in transfer function are required the applied tools in this algorithm can be replaced with more accurate methods such as computational fluid dynamics or other approaches credit authorship contribution statement m a tehrani conceptualization methodology software validation writing original draft visualization r d firouz abadi conceptualization methodology supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
21827,this article explores possible uses of marine unmanned surface vehicles usv for the fully automatic deployment of containment booms along quayside mooring ships the task of the usv is to tow the boom along adequate trajectories the target is the prevention of contaminant spills in harbors or near the coast for example during crude transfers surrounding ships with booms is becoming a common practice this scenario belongs to the target of our research to transfer robotic techniques to marine applications the article experimentally shows that the usv based automatic deployment can be done in accordance with a suitable planning in terms of waypoints actually the article presents a successful automatic deployment with a scale usv and a 50 m long experimental light boom for the purposes of the research a set of models of the boom cables and the usv dynamics have been established based on these models a simulation platform has been developed the platform has been employed for analyzing and planning of experiments and for the simulation of a real scale boom deployment scenario described in the article some recommendations are included in the final section keywords oil spill response environment protection harbor safety unmanned surface vehicles usv boom towing boom simulation marine robot navigation 1 introduction public perception is becoming more and more sensible to sea contamination issues like in the case of pollutant spilling near the coast or in harbors an increasing awareness of its detrimental effects is taking place chang et al 2014 related to ecosystems hampton et al 2003 itopf 2013 health eykelbosh 2014 walker 2017 fisheries marine industries and other socio economic aspects itopf 2012 feria domínguez et al 2016 a manifestation of this concern is the growing number of publications on associated topics so that for instance a survey of the oil spill literature from 1968 to 2015 murphy et al 2016 detected over 11 000 related publications historical records of pollutant spills usually pay attention to major incidents itopf 2017 cedre 2017 in particular the deepwater horizon disaster had a significant impact adams 2015 lichtveld et al 2016 graham et al 2016 however there are other spills that occur in harbors usually smaller but more frequent many regional institutions and ports have prepared contingency plans which contemplate preventive measures to avoid the spilling of pollutants in harbor facilities frequently the use of containment booms is recommended in fact a common practice is to place booms around tankers or other types of ships during charge or discharge operations that might cause spills this article explores the possibility of an automatic deployment of containment booms around ships using unmanned surface vehicles usvs for boom towing although this could correspond to situations in the open sea the article focuses on scenarios with ships moored to a dock the main point of the research is analyzing and planning of the deployment there are several possible procedures for boom deployment along quayside mooring ships in this article the deployment from a reel on shore has been chosen other alternatives could also be subject of study in the future the automatic behavior considered in this article corresponds to a first level of autonomy and so it belongs to a general research trend which is the introduction of autonomous robotized vehicles this is entering on daily life with the self driving car as a clear example indeed this kind of vehicles would also come to the marine scene like surface vehicles for applications such as harbor surveillance hydrographic monitoring or even autonomous cargo ships levander 2017 in our case after some years devoted to the development of autonomous surface vehicles usvs recas et al 2004 environmental applications were deemed of great interest most probably it was due to the impact in our country of the prestige disaster gonzalez et al 2006 many volunteers tried to help including fishermen towing booms hence our research aimed to environmental operations involving the use of booms and usvs jimenez et al 2005 some similar recent initiatives from industry can be mentioned like seamachines 2019 our general criterion is to achieve complete operations in fully automatic ways giron sierra et al 2015 one of the reasons for this approach is that it could be difficult to have when needed people with pertinent expertise while an automatic system would alleviate such need other advantages of robotized systems is that they can be used day and night under most weather conditions repetitively and with no risk for humans in case of dangerous substances or burning our research proceeded with two main activities in parallel computer simulations and scale experiments in order to provide a computer environment for operation planning and analysis a mathematical model of the boom dynamics combined with models of the usv and the towing cable has been developed jimenez and giron sierra 2018 and a simulation tool has been built the experimental work was done using scaled boats and booms these boats have on board miniaturized computers for automatic it is not remote control operation in some experiments part of the shape of the boom tends to a catenary curve which could be colloquially described as a u shape it should be said that model ships are frequently used in automatic control studies when they include experimental work skjetne et al 2005 do and pan 2006 the typical application scenario would be the case of a tanker being desired to prevent the escape of any leakage during crude transfers see fig 1 in certain circumstances this could be an emergency response that should be accomplished as fast as possible at first sight the deployment planning could be regarded as trivial however a basic analysis shows that currents and wind are important implying significant changes in the usv maneuvering and in the plan itself in particular one of the examples suggested by experts which is contemplated in this article was the case of a dock by the bank of a river near the sea so the influence of tide is relevant having in mind that the harbor operations envisaged in this article would be in general carried on by conventional usvs not only our usv simple waypoint steered navigation has been chosen it is open for our future research to include a more intelligent navigation control since the on board software of our usv can be easily accessed and modified the article has been organized as follows section 2 is devoted to the research background section 3 introduces the mathematical models of interest which refer to the dynamics of the ship the boom and the towing cables section 4 describes the experimental framework which is based on scaled usvs section 5 includes a brief preliminary study of the boom deployment around a ship then section 6 presents a complete trial scenario in which a boom is deployed around a zone in order to prevent the escape of pollutants it is supposed that a ship is inside the zone the scenario is reproduced both in simulation and with the experimental system section 7 is devoted to real scale simulation analysis involving the planning of the usv path in the presence of currents finally section 8 draws some conclusions including comments on other alternatives for automatic operation and some ideas for future research 2 background 2 1 booms for contaminant spills booms are typical components of the equipment for marine pollution response they can be used in several ways itopf 2014 for example a boom can be statically placed as a kind of floating wall or the boom can be dynamically operated like in the case of towing it with two ships usually the booms have ballast for example a chain at the bottom to maintain a vertical posture part of the boom is on the surface while most of the boom is submerged most booms are composed of a series of connected segments like the one shown in fig 2 there are many models of booms with different combinations of freeboard and draft sizes in case of having to withstand currents or being towed the tensile strength specification is important in order to avoid oil escape low speeds about 1 knot are recommended for towing itopf 2014 the weight of light booms could be less than 2 kg m while heavy booms could have more than 17 kg m draft dimension ranges approximately from 30 cm to 100 cm for the application considered in this article an easy to extend curtain light boom would be appropriate actually some of our initial experiments were done with a 30 cm draft and 3 kg m real scale boom in order to obtain data on towing force for modeling purposes the deployment of a boom could be more or less a matter of routine in certain emergencies it should be fast there are boom reels to be used on the shoreline or on board special ships it also would be possible to have the boom folded in a suitable way during the deployment in addition to a ship towing the boom if this is the case other ships or boats would be helpful for lateral pushing of the boom in order to place it along a convenient curve it would require coordination of activities from the people involved in the deployment the length of tankers could be as much as 415 m although there are many in the range 100 m 200 m in an interesting account of what happened with the deepwater horizon spill hall et al 2011 it is mentioned that vessels of opportunity were recruited and fishermen s expertise was important this was also the case with the prestige oil spill in 2002 gonzalez et al 2006 clearly people accustomed to trawling would be good for boom towing actually parson and majors 2011 proposes an effective oil response system based on fishing vessels as it will be cited later on opportune information on towing and required forces can be obtained from the fishing context with respect to literature on oil pollution response a synthesis of major oil response methods and materials was presented in ventikos et al 2004 the book fingas 2012 covers current oil spill cleanup techniques a short review of other information sources is contained in giron sierra et al 2015 2 2 usv navigation control the course control of ships is a classic research topic reference books on it are fossen 1994 2002 2011 a review of course keeping control of usvs by azzeri et al 2015 has recently appeared for the usv to tow a boom around a ship a suitable path should be specified and then the usv should follow the path this is a question belonging to the mobile robots context a most cited book on path planning is lavalle 2006 a number of path following control methods have been introduced some of these methods were evaluated by sujit et al 2013 it was particularly useful for our work the contributions of breivik and fossen 2004 for paths composed of circles and lines both the trajectory planning and the path following control of usvs is studied in liao et al 2014 an overview of usv status can be found in liu et al 2016 some surveys of available unmanned surface vehicles can be easily reached in internet let us mention in particular bertram 2008 motwani 2012 liu et al 2016 3 mathematical modeling this section is devoted to introduce a model of the boom dynamics a maneuvering model of a usv and a model of the towing cables based on these models a simulation environment has been implemented with the simulation tool it is possible to observe the dynamic behavior of the boom the evolution of its shape during deployment to estimate tensions and forces and to take into account currents and winds needless to say the models try to be simple and sufficiently approximate in the actual form the models in special the model of the boom require moderate computational efforts the models are open enough as to be changed if necessary 3 1 boom model let us concisely introduce the boom model a more extended description of this model and some possible applications can be found in jimenez and giron sierra 2018 it is assumed that the boom is composed of a series of interconnected links each link has a length 2 l and inertial mass m l fig 3 shows a schematic view of the boom with the links represented as line segments the bold dots correspond to the center of mass of each link the central part of the figure focuses on two consecutive links for those links the figure depicts the normal n i and parallel p i unitary vectors which are employed in the boom equations also the position vectors r i r i 1 of the center of mass of those two links are shown the total mass of a link is represented on the x y system as the following diagonal matrix 1 m ai m l m a cos θ i 0 0 m l m a sin θ i where m a is the added mass in the direction normal to the link suppose that the boom has a total number of m links the dynamics of the i th link is described as follows 2 t i i 1 t i 1 i f r i m ai a i 3 t i i 1 n i t i 1 i n i l a ω i i α i where f r i represents the linear and quadratic resistance forces against the link velocity v i using the coefficients s s 2 q and q 2 4 f r i v i n i s v i p i q v i v i v i n i s 2 v i p i q 2 v i and a ω i represents a resistance momentum proportional to the link angular velocity the linear motion of the link center of mass is described by eq 2 while the link rotational motion around its center of mass is described by eq 3 notice that the strains were denoted by pairs of indexes i i 1 corresponding to the strain in the hinge that joints link i with link i 1 eqs 2 and 3 are valid for all links except for those located at the ends of the boom the ends of the boom will be connected to external towing forces therefore for the last link on the left of the boom 5 t 1 2 f l e f t f r 1 m a1 a 1 6 t 1 2 n 1 f l e f t n 1 l a ω 1 i α 1 and for the link located at the right end 7 f r i g h t t m 1 m f r m m am a m 8 f r i g h t n m t m 1 m n m l a ω m i α m the equations above do not form a complete set it is necessary to add a closing condition such a condition can be that the links should remain connected not separated therefore 9 r i l p i l p i 1 r i 1 0 for any consecutive pair of links by taking derivatives twice an expression was obtained that combines linear and angular acceleration supplying the additional equation needed 10 a i l p i ω i 2 l n i α i l p i 1 ω i 1 2 l n i 1 α i 1 a i 1 0 in order to solve the equations set from eq 2 to eq 10 first split them into x y coordinates and remove linear and angular accelerations then rewrite the equations grouping on the right hand side those terms with strain components in this way the system can be expressed in matrix format as 11 h t b where h is a sparse matrix that depends on link poses and parameters inertial mass and moment the non zero entries are located in the six central diagonals the main diagonal the three upper diagonals and the two lower diagonals t is a vector of strain components 12 t i 1 i x t i 1 i y t i i 1 x t i i 1 y t i 1 i 2 x t i 1 i 2 y t the right hand side term b represents a vector of independent terms containing resistance and inertial forces the iterative solution of the equations starts by an initial disposition of the links and forces acting on the boom tips then the strains are computed then the linear and angular accelerations can be obtained the links at ends of the booms require another calculation way since they are attached to the boom only by one side it may happen that the left tip of the boom was attached to a boat or a bollard or be free etc and similarly with the right tip 3 2 towing cables assume that the boom is attached to the usv by means of cables it is possible to consider the cable stress as a function of its stretching δ d d d 0 over its nominal length d 0 13 t c b l 0 i f δ d 0 e d 0 δ d i f δ d 0 where e represents the young s elasticity module the distance between the tip of the boom and the center of mass of the usv is given by eq 14 if the usv is on the left side of the boom or by eq 15 if it is on the right side 14 d l r c m l s 2 r 1 l p 1 2 sol ship on the left 15 d r r m l p m r c m l s 2 2 sor ship on the right fig 4 shows the definition of variables for the usv of length l s it is supposed that the boom is attached to the usv aft the δ d is obtained by subtracting d 0 from the proper expression above d l or d r the direction of the cable stress is 16 u c b l r c m l s 2 r 1 l p 1 d l sol 17 u c b l r m l p m r c m l s 2 d r sor based on these expressions the forces on the ship s stern and the boom tips can be computed 18 f e t c b l u c b l sol f e t c b l u c b l sor f l e f t t c b l u c b l f r i g h t t c b l u c b l the equations introduced so far can be used to get the instantaneous values of the strains acting on the boom links from these values linear and angular accelerations can be obtained speeds can be computed by numerical integration of accelerations and from numerical integration of speeds positions and orientations can also be calculated the approach already introduced could be characterized as newtonian jimenez et al 2005 other approaches could be also possible like in bhattacharya et al 2011 kim et al 2013 3 3 usv model the mathematical model considers a usv with inertial mass m s and inertial moment about the usv center of mass i s a propulsion force f s and a bearing moment t s are applied to the center of mass the model is generic for several types of vessels the accelerations would be 19 m a s f s f r f e 20 i s α s t s t r t e where the terms f e and m e correspond to towing action and the terms f r and m r correspond to resistance against ship motion given the inertial components of the usv velocity v s the corresponding components in body axes can be obtained with 21 v s l v s p t r θ 1 v s x v s y t being r θ a standard 2d rotation matrix the components of the resistance force f r in body axes are modeled as follows 22 f r l μ l v s l 23 f r p μ p v s p then the components of the resistance force f r in inertial axes can be obtained with 24 f r x f r y t r θ f r l f r p t finally the resistance to rotation has been modeled as the following momentum 25 t r μ a ω s were ω s is the angular velocity of the ship and μ a is a resistance coefficient 4 experimental framework this research involved frequent experimentation along severalyears as the weather permitted it initial experiments were devoted to develop and test the experimental system which includes equipment and software afterwards the experimental work focused on modeling needs concerning the usv model and the booms as said before once the mathematical models were established a simulation environment was built based on this environment it was possible to prepare new experimental scenarios with boom towing in order to investigate path planning the experiments were also important for observation of dynamical behaviors and phenomena which in certain situations were somewhat surprising in turn experiments have been useful as a validation reference for the simulation 4 1 details of the usv a common scene you can see in harbors is a ship being towed by a tug what it is wanted from a tug is propulsion power and good maneuvering capabilities taking into account the needs of experiments related to towing a small twin hull catamaran type usv has been built in our laboratory each hull has an associated propeller with 34 8 n maximum propulsion force quite more of what is needed for our boom towing experiments both propellers are independently controlled the ships course is governed by differences in propeller forces denote as f r the propulsion force of the propeller on the right side f l the propulsion force of the propeller on the left side the sum of these forces gives the total propulsion force f s their difference would be f d i f f r f l there is a slip angle that can be approximated with 26 s i n β f d i f f s see pandey and hasegawa 2015 for a more detailed modeling in body axes there would be two forces caused by propulsion 27 f s l f s c o s β 28 f s p f s s i n β the length of the usv hulls is 80 cm the bridge is 70 cm wide and 50 cm long in order to provide large torques for usv spinning the propellers are placed by the external side of the hulls figs 5 6 show an schematic top view of the boat design and a photograph of the usv the digital radio antenna is mounted on the ship superstructure a more detailed view of one of the two propellers is shown in fig 7 the propellers chosen for the boat are the t200 thrusters from blue robotics robotics 2018 the t200 thruster has been modeled in nielsen et al 2018 by means of a rc electronic speed control esc device the propulsion force of the thrusters is controllable with conventional pulse width modulated pwm signals this kind of signals is widely used in the radio control community in fact the same pwm signals that are used for our small ship could be used at any ship scale even large sizes for governing the propulsion power through adequate electronic interfaces one of the initial activities of the research has been to test the behavior of the usv under manual control from a rc console measuring the usv position and speed with an on board gps speeds well over 2 m s can be easily reached with low energy consumption for the boom towing experiments this speed can be lowered by just using pwm signals with narrower width notice that the recommended speed at real scale for boom towing is around 0 5 m s the miniature digital computer is based on a stm nucleo board by stmicroelectronics stm 2018 this board has an arm cortex 4m digital microcontroller and many input output pins some of these pins have been selected for including in the control system miniature devices for gps digital compass and a digital radio link the on board control software is written in c the main task of this software is to compute the suitable propulsion forces according to the information from sensors about current heading location and velocity desired forces are transmitted to the esc devices via pwm signals generated by the arm microcontroller the on board navigation control includes implemented in software a digital proportional integral derivative pid controller fig 8 shows the block diagram of the course control this control is handled by a higher level algorithm which regularly updates the heading setpoint for waypoint based steering 4 2 the ground station a ground station gs has been developed as part of the experimental system it is used before experiments to transmit to the usv setup data like speed desired trajectory and pid parameters the desired trajectory is specified by waypoints the gs has start stop commands to begin stop the experiments during experiments the gs remains passive with no intervention on the usv behavior the only task of the gs during experiments is to gather digital radio data sent by the usv for real time monitoring these data are also saved in a file for off line study of results while moving the usv sends to the gs her compass and gps data and the pwm values generated for speed and course control it is always possible to take manual control of the usv using a joystick fig 9 shows one of ground station screens during an experiment this screen can be used for formation experiments with several usvs but in this case it is used for a single vehicle the left panel shows the desired path in green and the usv motion as a white trail the gs program has been developed in c using the gtk environment for gui implementation the gs hardware is a conventional portable computer coupled through usb to a digital radio chip another xbee unit digi 2018 which in turn is connected to an antenna 4 3 usv model parameters a series of experiments were done for estimation of the usv model parameters the first experiments were done following a straight path at different speeds in order to estimate the usv friction coefficient in the direction of surge a second series of experiments were devised to make the usv follow circular paths of specified radii and measuring period times the friction coefficients of the model in the sway direction were estimated also the spinning friction coefficient was estimated as a result of these experiments the parameters of the usv model were estimated to be as given by table 1 4 4 boom towing estimation of forces in theory itopf 2014 the towing force in n is given by 29 f t q v 2 with q 1000 a a is the area perpendicular to the flow when towing a boom with two ships the boom takes a catenary form the area perpendicular to the flow will depend on the distance between boom tips or in other words how wide is the mouth a first experimental light boom 15 m long was made by chaining a series of cylindrical floats the boom cable is a conventional polypropylene rope flexible and light based on experiments towing the boom with two scaled boats that were used years ago in another research giron sierra et al 2015 and comparing velocities with and without towing it was estimated that the drag of the boom is in the order of conventional booms considering equivalences from scale 1 15 to real scale see lloyd 1989 for scaling from initial experiments on boom towing it was noticed that if the usv tries to turn while towing the boom the boom opposes to it it could be regarded as a course stabilization influence from the boom it was also experimentally noticed that the boom was quite sensitive to wind gusts 4 5 automatic navigation experiments most of our experiments were carried out in a 100 m 70 m pond near our university fig 10 shows a picture of the pond the border of the pond is not a vertical wall but instead a kind of beach with a soft slope a top view google maps of the pond was chosen and saved as an image fig 11 the ground station displays the real time gps data from the usv as color traces on this image besides the gps data obtained from experiments are saved by the ground station as a file and can be retrieved afterwards for analysis and display using matlab before using any boom it is convenient to check the automatic behavior of the usv alone the preparation of an experiment involves the specification of a path in terms of waypoints the usv will turn around waypoints following curved trajectories not necessarily touching the waypoints some tolerance is allowed based on the mathematical model of the usv dynamics these trajectories can be predicted and displayed by our simulation environment the simulation is also useful for the tuning of the pid course controller several paths from simple to more complicated were planned and the corresponding usv trajectories were predicted for the usv not towing any boom subsequent experiments in the pond confirmed a satisfactory automatic navigation of the usv in reasonable agreement with the simulation predictions for instance fig 12 shows the gps trace of the usv motion red curve with triangles in an experiment with a cross of four waypoints marked as black diamonds the curve in blue is the usv trajectory prediction based on the mathematical model of course the prediction does not know the actual perturbations found by the usv this day in particular there is some underwater pumping machinery near north west of the pond and close to the surface for water filtering 5 preliminary analysis of the boom deployment the scenario being studied in this article is a boom to be towed from shore near the tanker the boom could be folded or contained in a reel the usv has to tow the boom and deploy the boom around the tanker fig 13 shows a picture that gives an example of on shore reel with a boom recently a similar system with a reel a toboggan and an usv has been introduced with the usv coming from the reel to a receiving station spmarine 2019 at first sight the boom deployment could be judged a simple task however if one does not want the boom to brush against the tanker during the deployment things become more complicated in absence of auxiliary boats or devices that could help to separate the boom from the tanker it would be required to pull completely the boom from shore towing the boom relatively far from the tanker after the complete boom has been put on the water it may be necessary to adapt the boom geometry to the tanker fig 14 illustrates how the first step of the deployment could be before matching the boom to the tanker then it becomes pertinent to think about what can be expected from wind and currents this environmental part of the situation might be convenient as far as it helps to get a suitable shape for the boom being towed fig 15 illustrates a favorable case the usv moves from right to left counterclockwise towing the boom taking as reference fig 15 suppose that the current takes the opposite sense this would throw the boom against the tanker unless the usv tried to harness the situation which could become quite difficult in such a case it would be recommended to have another boom near the bow of the tanker and try the boom deployment from bow to stern there is an important remark to do although it is evident towing a boom longitudinally takes much less force than towing it transversely in particular as soon you have a u shape towing forces would become larger depending on the mouth dimension let us consider the possible size of involved forces the information from shipbuilders usually gives data on engine power how this power transforms into propulsion force depends on gears and propellers for instance a 1000 kg weight rescue zodiac with a 44 74 kw engine could have 3 53 kn propulsion force or with a gearbox 4 71 kn propulsion force for a boom with a mouth 100 m wide and draft 0 30 m and a velocity relative to the water of 1 m s the required towing force would be 30 02 kn looking at the usual ships for towing tasks there are river tugs 13 m long with 34 32 kn bollard pull manor marine 2017 high seas tugs could have from 88 26 kn to 882 59 kn bollard pull damen 2017 latest trends in harbor tugs were described by artyszuk 2013 fishing ships offer another context with experience in towing it is estimated prado and drémière 1990 that 74 57 kw trawlers would have about 9 80 kn bollard pull this last reference also says that trawlers with 15 20 m length and 74 57 149 13 kw would be used for nets with 20 30 m mouth opening the speed of net hauling in coastal waters is in the range 15 40 m min indeed nets and booms are not the same concerning resistance to motion 6 scaled experiments of boom deployment around a ship a basic study has been made with our usv towing a experimental boom the scenario considered was a simple deployment around a supposed ship fig 16 shows how it was conceived the first part is devoted to tow the boom away from the coast while the boom moves the u shape builds up and so taking the boom towards the coast could mean a larger effort for this reason the last part of the trajectory tries an oblique approach to the border since our experiments are done in a pond it is assumed that there are no currents however wind could have a significant effect the plan itself is expressed as a series of four waypoints the curve depicted on the figure corresponds to the usv trajectory as predicted by simulation based on the usv model one of the main targets of the experiment is to confirm the predictions from our simulation system videos and pictures were taken and the gps traces of the usv during boom towing were acquired and saved another important target is to provide an opportunity of direct observation of what may happen during the boom deployment a light experimental boom was made especially for this experiment the boom was 50 m long supposing that the boom draws a perfect semi circle with a 10 m radius it is only necessary 31 4 m of boom however more length should be allowed for other usv trajectories the experiment was made several times with a fixed pwm setpoint fig 8 fig 17 shows a picture of the result after one of the experiments the usv should not approach the border by the end of the experiment in order not to run aground on the submerged beach the gps trace of the usv along the deployment experiment is shown in fig 18 with respect to the satellite view of the pond fig 19 shows two photographs taken along one experiment the first photograph fig 19 a was taken with the camera pointing to east side of the pond it corresponds to the usv starting to pull the boom from shore heading left from the pond jet which means a danger for the usv as the usv passes by the first waypoint the u shape starts to develop the second photograph fig 19 b now with the camera pointing north east was taken after some time near the end of boom deployment and shows the usv driving towards the shore a video of the experiment is available the link is given at the end of the article fig 20 compares the predicted motion of the usv while towing the boom simulation and what happened in reality usv gps trace there was some south east wind during the experiment by using the simulation it is possible to compute the evolution of the cable tension along the boom deployment which is shown in fig 21 the maximum value gives an important information on what tensile performance the cable should have there is a significant tension growth near the end of the experiment as the length of the deployed boom comes near its 50 m limit notice that the information on cable tension obtained with our simulation tool is important for determining what propulsion force the usv should provide for adequate boom towing the sharp peak in tension by the end of deployment suggests that adding a tension sensor would be welcome since it would give opportunities for extending the on board control to take care of speed and thrust along the deployment table 2 gives the boom parameters that have been used for the boom dynamics simulation 7 real scale simulation experiments for boom deployment planning a clear advantage of simulation is that many different experiments perhaps difficult to achieve in reality can be done just with some computational effort another added value is that simulation can provide a lot of data otherwise difficult to acquire in real time an example of this second aspect is that with simulation it is possible to follow in detail as a sequence of snapshots the changing shape of the boom as the deployment progress of course videos can be taken during real experiments but numerical data would be really cumbersome to get perhaps using gps devices in each link of the boom this section is mainly devoted to boom deployment planning with results at real scale obtained in simulation the objective is to establish an adequate sequence of waypoints for the usv in order to have an acceptable boom deployment around the target tanker in order to simplify the boom deployment planning it could be assumed that when the usv turns around a waypoint it follows approximately a circular arc therefore usv paths can be built by connecting two types of pieces arcs of circles or straight line segments in his pioneering work dubins showed that a car like mobile robot with a given initial position and heading can arrive to a target final position and heading with exactly three sequentially connected such pieces dubins 1957 the dubins paths are the shortest paths for the car like case a nonholonomic vehicle there are many papers focusing on this approach for several applications like for example breivik and fossen 2004 yong and barth 2006 fossen et al 2015 the result of a path planning for a certain experiment real or simulated is a list of waypoints in the case of a real experiment this list is given to the ground station which in turn transmit it to the usv the usv navigation control takes care of going along the specified path from one to another waypoint in a scenario with a long tanker and a relatively narrow river it could be not possible to try the plan used in our scale experimental study previous section another basic planning for our boom deployment is sketched in fig 22 the idea is to have a narrow u mouth also keeping the usv far from the farthest bank of the river the first waypoint is placed near the tanker s stern the second waypoint is relatively far at right side of the figure this waypoint is placed there in order to completely deploy the boom the usv would have the hardest towing work when going from the third to the fourth waypoint which marks the end of the operation the figure shows the prescribed path and captures one of the instants of the boom deployment once the plan was specified a deployment simulation was run the results are presented in figs 23 and 24 fig 23 shows the evolution of towing cable tension at the tip of the boom nearer to the usv the turnings around waypoints can be easily identified since tension decreases there after the third waypoint tension increases sharply because the usv effort on the boom becomes more perpendicular to the boom the first part of the cable tension evolution has a jagged profile the simulation takes into account as specified in the scenario definition that the boom was folded at the initial point on shore the link by link unfolding due to usv towing means a complicated dynamics that translates to brisk changes in resistance to towing it is even possible with the simulation to study in detail the unfolding process if required for any reason for the pond scaled study the experiments and simulation started with the boom already extended on the border so the initial part of tension curve was smooth the complete evolution of the boom deployment is shown in fig 24 the parameters of the usv model being used in the simulation were the following see table 3 table 4 gives the parameters of the boom model the simulation was developed in the python language the simulation code is available from internet it should be said that it requires large computation work taking around one day for scenarios like the one selected in this section 8 conclusion and comments in this article the automatic boom deployment around a quayside moored ship has been explored the deployment was done by means of an usv towing the boom and following an adequate path considering that in real applications the boom deployment would be done with a conventional usv this article adhered to a basic usv waypoint steering navigation several aspects of the planning were been considered including forces and sizes dynamic behavior of the boom usv trajectories etc the research involved the development of a experimental system with a ground station usvs scale booms and measurement devices a series of experiments were made to show the successive steps of the research a main result of the research was to experimentally show that the automatic boom deployment with an usv can actually be done the article included the modeling of the boom dynamics that together with a model of the usv and a model of the towing cable which provided a comprehensive simulation environment this environment was shown to be a useful tool for boom deployment planning in different scenarios exemplified by a tanker moored in a river section 7 of the article part of the research activity has been oriented to provide experimental confirmation of the simulation prediction capabilities both wind and currents can be considered by the simulation given a particular application case with specific location boundaries and a concrete type of usv and boom a series of plans could be established for different currents winds and tanker sizes the results could be expressed in tabular format with waypoint lists for each case from experimental observation it would be recommended for the development of a real scale usv to incorporate the type of thrust vectoring available on tugs likewise it would convenient to add auxiliary lateral maneuvering thrusters for instance near the bow it would be preferred to use propellers for low speed high torque operation another point is that adequate support should be given for human supervision and intervention when needed in our case it was easy to visually follow the experiments however in real scale it would be advisable to add cameras perhaps drones and real time visualization on the ground station probably rather than deploying the boom from an off shore reel it would be better to design the usv for having a reel on board or at least a platform for a folded boom and deploy the boom from the usv this would represent a new research problem from the usv control point of view since the dynamic characteristics of the usv would change along the deployment concerning future research since our usv is open for on board software changing more intelligent usv control can be investigated for instance optimization of trajectories use of a tension sensor for thrust control and control actions for avoiding deviations with respect to the prescribed path large perturbations could appear during deployment we have in mind to use an aerial unmanned vehicle for looking at the boom shape from above as it is deployed in case of having actually an oil spill this would be convenient for suitable guidance of the usv in order to encircle the spill that is an interesting scenario for cooperative robotics future work on the scenario treated in this article will focus on automatic planning flexibility for tackling changes of tanker size and wind and current conditions perhaps re planning if these conditions change these are steps towards increased level of autonomy the simulation code can be accessed at git https github com juanjimenez pyships two videos of experiments at the pond are available from https www youtu be e2xqjvh71y0 https www youtu be p5uz f aky credit authorship contribution statement juan f jimenez conceptualization formal analysis software methodology jose m giron sierra conceptualization investigation resources validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors would like to thank the support of the cicyt spanish committee projects dpi2009 14552 c02 01 dpi2013 46665 c1 1 r 
21827,this article explores possible uses of marine unmanned surface vehicles usv for the fully automatic deployment of containment booms along quayside mooring ships the task of the usv is to tow the boom along adequate trajectories the target is the prevention of contaminant spills in harbors or near the coast for example during crude transfers surrounding ships with booms is becoming a common practice this scenario belongs to the target of our research to transfer robotic techniques to marine applications the article experimentally shows that the usv based automatic deployment can be done in accordance with a suitable planning in terms of waypoints actually the article presents a successful automatic deployment with a scale usv and a 50 m long experimental light boom for the purposes of the research a set of models of the boom cables and the usv dynamics have been established based on these models a simulation platform has been developed the platform has been employed for analyzing and planning of experiments and for the simulation of a real scale boom deployment scenario described in the article some recommendations are included in the final section keywords oil spill response environment protection harbor safety unmanned surface vehicles usv boom towing boom simulation marine robot navigation 1 introduction public perception is becoming more and more sensible to sea contamination issues like in the case of pollutant spilling near the coast or in harbors an increasing awareness of its detrimental effects is taking place chang et al 2014 related to ecosystems hampton et al 2003 itopf 2013 health eykelbosh 2014 walker 2017 fisheries marine industries and other socio economic aspects itopf 2012 feria domínguez et al 2016 a manifestation of this concern is the growing number of publications on associated topics so that for instance a survey of the oil spill literature from 1968 to 2015 murphy et al 2016 detected over 11 000 related publications historical records of pollutant spills usually pay attention to major incidents itopf 2017 cedre 2017 in particular the deepwater horizon disaster had a significant impact adams 2015 lichtveld et al 2016 graham et al 2016 however there are other spills that occur in harbors usually smaller but more frequent many regional institutions and ports have prepared contingency plans which contemplate preventive measures to avoid the spilling of pollutants in harbor facilities frequently the use of containment booms is recommended in fact a common practice is to place booms around tankers or other types of ships during charge or discharge operations that might cause spills this article explores the possibility of an automatic deployment of containment booms around ships using unmanned surface vehicles usvs for boom towing although this could correspond to situations in the open sea the article focuses on scenarios with ships moored to a dock the main point of the research is analyzing and planning of the deployment there are several possible procedures for boom deployment along quayside mooring ships in this article the deployment from a reel on shore has been chosen other alternatives could also be subject of study in the future the automatic behavior considered in this article corresponds to a first level of autonomy and so it belongs to a general research trend which is the introduction of autonomous robotized vehicles this is entering on daily life with the self driving car as a clear example indeed this kind of vehicles would also come to the marine scene like surface vehicles for applications such as harbor surveillance hydrographic monitoring or even autonomous cargo ships levander 2017 in our case after some years devoted to the development of autonomous surface vehicles usvs recas et al 2004 environmental applications were deemed of great interest most probably it was due to the impact in our country of the prestige disaster gonzalez et al 2006 many volunteers tried to help including fishermen towing booms hence our research aimed to environmental operations involving the use of booms and usvs jimenez et al 2005 some similar recent initiatives from industry can be mentioned like seamachines 2019 our general criterion is to achieve complete operations in fully automatic ways giron sierra et al 2015 one of the reasons for this approach is that it could be difficult to have when needed people with pertinent expertise while an automatic system would alleviate such need other advantages of robotized systems is that they can be used day and night under most weather conditions repetitively and with no risk for humans in case of dangerous substances or burning our research proceeded with two main activities in parallel computer simulations and scale experiments in order to provide a computer environment for operation planning and analysis a mathematical model of the boom dynamics combined with models of the usv and the towing cable has been developed jimenez and giron sierra 2018 and a simulation tool has been built the experimental work was done using scaled boats and booms these boats have on board miniaturized computers for automatic it is not remote control operation in some experiments part of the shape of the boom tends to a catenary curve which could be colloquially described as a u shape it should be said that model ships are frequently used in automatic control studies when they include experimental work skjetne et al 2005 do and pan 2006 the typical application scenario would be the case of a tanker being desired to prevent the escape of any leakage during crude transfers see fig 1 in certain circumstances this could be an emergency response that should be accomplished as fast as possible at first sight the deployment planning could be regarded as trivial however a basic analysis shows that currents and wind are important implying significant changes in the usv maneuvering and in the plan itself in particular one of the examples suggested by experts which is contemplated in this article was the case of a dock by the bank of a river near the sea so the influence of tide is relevant having in mind that the harbor operations envisaged in this article would be in general carried on by conventional usvs not only our usv simple waypoint steered navigation has been chosen it is open for our future research to include a more intelligent navigation control since the on board software of our usv can be easily accessed and modified the article has been organized as follows section 2 is devoted to the research background section 3 introduces the mathematical models of interest which refer to the dynamics of the ship the boom and the towing cables section 4 describes the experimental framework which is based on scaled usvs section 5 includes a brief preliminary study of the boom deployment around a ship then section 6 presents a complete trial scenario in which a boom is deployed around a zone in order to prevent the escape of pollutants it is supposed that a ship is inside the zone the scenario is reproduced both in simulation and with the experimental system section 7 is devoted to real scale simulation analysis involving the planning of the usv path in the presence of currents finally section 8 draws some conclusions including comments on other alternatives for automatic operation and some ideas for future research 2 background 2 1 booms for contaminant spills booms are typical components of the equipment for marine pollution response they can be used in several ways itopf 2014 for example a boom can be statically placed as a kind of floating wall or the boom can be dynamically operated like in the case of towing it with two ships usually the booms have ballast for example a chain at the bottom to maintain a vertical posture part of the boom is on the surface while most of the boom is submerged most booms are composed of a series of connected segments like the one shown in fig 2 there are many models of booms with different combinations of freeboard and draft sizes in case of having to withstand currents or being towed the tensile strength specification is important in order to avoid oil escape low speeds about 1 knot are recommended for towing itopf 2014 the weight of light booms could be less than 2 kg m while heavy booms could have more than 17 kg m draft dimension ranges approximately from 30 cm to 100 cm for the application considered in this article an easy to extend curtain light boom would be appropriate actually some of our initial experiments were done with a 30 cm draft and 3 kg m real scale boom in order to obtain data on towing force for modeling purposes the deployment of a boom could be more or less a matter of routine in certain emergencies it should be fast there are boom reels to be used on the shoreline or on board special ships it also would be possible to have the boom folded in a suitable way during the deployment in addition to a ship towing the boom if this is the case other ships or boats would be helpful for lateral pushing of the boom in order to place it along a convenient curve it would require coordination of activities from the people involved in the deployment the length of tankers could be as much as 415 m although there are many in the range 100 m 200 m in an interesting account of what happened with the deepwater horizon spill hall et al 2011 it is mentioned that vessels of opportunity were recruited and fishermen s expertise was important this was also the case with the prestige oil spill in 2002 gonzalez et al 2006 clearly people accustomed to trawling would be good for boom towing actually parson and majors 2011 proposes an effective oil response system based on fishing vessels as it will be cited later on opportune information on towing and required forces can be obtained from the fishing context with respect to literature on oil pollution response a synthesis of major oil response methods and materials was presented in ventikos et al 2004 the book fingas 2012 covers current oil spill cleanup techniques a short review of other information sources is contained in giron sierra et al 2015 2 2 usv navigation control the course control of ships is a classic research topic reference books on it are fossen 1994 2002 2011 a review of course keeping control of usvs by azzeri et al 2015 has recently appeared for the usv to tow a boom around a ship a suitable path should be specified and then the usv should follow the path this is a question belonging to the mobile robots context a most cited book on path planning is lavalle 2006 a number of path following control methods have been introduced some of these methods were evaluated by sujit et al 2013 it was particularly useful for our work the contributions of breivik and fossen 2004 for paths composed of circles and lines both the trajectory planning and the path following control of usvs is studied in liao et al 2014 an overview of usv status can be found in liu et al 2016 some surveys of available unmanned surface vehicles can be easily reached in internet let us mention in particular bertram 2008 motwani 2012 liu et al 2016 3 mathematical modeling this section is devoted to introduce a model of the boom dynamics a maneuvering model of a usv and a model of the towing cables based on these models a simulation environment has been implemented with the simulation tool it is possible to observe the dynamic behavior of the boom the evolution of its shape during deployment to estimate tensions and forces and to take into account currents and winds needless to say the models try to be simple and sufficiently approximate in the actual form the models in special the model of the boom require moderate computational efforts the models are open enough as to be changed if necessary 3 1 boom model let us concisely introduce the boom model a more extended description of this model and some possible applications can be found in jimenez and giron sierra 2018 it is assumed that the boom is composed of a series of interconnected links each link has a length 2 l and inertial mass m l fig 3 shows a schematic view of the boom with the links represented as line segments the bold dots correspond to the center of mass of each link the central part of the figure focuses on two consecutive links for those links the figure depicts the normal n i and parallel p i unitary vectors which are employed in the boom equations also the position vectors r i r i 1 of the center of mass of those two links are shown the total mass of a link is represented on the x y system as the following diagonal matrix 1 m ai m l m a cos θ i 0 0 m l m a sin θ i where m a is the added mass in the direction normal to the link suppose that the boom has a total number of m links the dynamics of the i th link is described as follows 2 t i i 1 t i 1 i f r i m ai a i 3 t i i 1 n i t i 1 i n i l a ω i i α i where f r i represents the linear and quadratic resistance forces against the link velocity v i using the coefficients s s 2 q and q 2 4 f r i v i n i s v i p i q v i v i v i n i s 2 v i p i q 2 v i and a ω i represents a resistance momentum proportional to the link angular velocity the linear motion of the link center of mass is described by eq 2 while the link rotational motion around its center of mass is described by eq 3 notice that the strains were denoted by pairs of indexes i i 1 corresponding to the strain in the hinge that joints link i with link i 1 eqs 2 and 3 are valid for all links except for those located at the ends of the boom the ends of the boom will be connected to external towing forces therefore for the last link on the left of the boom 5 t 1 2 f l e f t f r 1 m a1 a 1 6 t 1 2 n 1 f l e f t n 1 l a ω 1 i α 1 and for the link located at the right end 7 f r i g h t t m 1 m f r m m am a m 8 f r i g h t n m t m 1 m n m l a ω m i α m the equations above do not form a complete set it is necessary to add a closing condition such a condition can be that the links should remain connected not separated therefore 9 r i l p i l p i 1 r i 1 0 for any consecutive pair of links by taking derivatives twice an expression was obtained that combines linear and angular acceleration supplying the additional equation needed 10 a i l p i ω i 2 l n i α i l p i 1 ω i 1 2 l n i 1 α i 1 a i 1 0 in order to solve the equations set from eq 2 to eq 10 first split them into x y coordinates and remove linear and angular accelerations then rewrite the equations grouping on the right hand side those terms with strain components in this way the system can be expressed in matrix format as 11 h t b where h is a sparse matrix that depends on link poses and parameters inertial mass and moment the non zero entries are located in the six central diagonals the main diagonal the three upper diagonals and the two lower diagonals t is a vector of strain components 12 t i 1 i x t i 1 i y t i i 1 x t i i 1 y t i 1 i 2 x t i 1 i 2 y t the right hand side term b represents a vector of independent terms containing resistance and inertial forces the iterative solution of the equations starts by an initial disposition of the links and forces acting on the boom tips then the strains are computed then the linear and angular accelerations can be obtained the links at ends of the booms require another calculation way since they are attached to the boom only by one side it may happen that the left tip of the boom was attached to a boat or a bollard or be free etc and similarly with the right tip 3 2 towing cables assume that the boom is attached to the usv by means of cables it is possible to consider the cable stress as a function of its stretching δ d d d 0 over its nominal length d 0 13 t c b l 0 i f δ d 0 e d 0 δ d i f δ d 0 where e represents the young s elasticity module the distance between the tip of the boom and the center of mass of the usv is given by eq 14 if the usv is on the left side of the boom or by eq 15 if it is on the right side 14 d l r c m l s 2 r 1 l p 1 2 sol ship on the left 15 d r r m l p m r c m l s 2 2 sor ship on the right fig 4 shows the definition of variables for the usv of length l s it is supposed that the boom is attached to the usv aft the δ d is obtained by subtracting d 0 from the proper expression above d l or d r the direction of the cable stress is 16 u c b l r c m l s 2 r 1 l p 1 d l sol 17 u c b l r m l p m r c m l s 2 d r sor based on these expressions the forces on the ship s stern and the boom tips can be computed 18 f e t c b l u c b l sol f e t c b l u c b l sor f l e f t t c b l u c b l f r i g h t t c b l u c b l the equations introduced so far can be used to get the instantaneous values of the strains acting on the boom links from these values linear and angular accelerations can be obtained speeds can be computed by numerical integration of accelerations and from numerical integration of speeds positions and orientations can also be calculated the approach already introduced could be characterized as newtonian jimenez et al 2005 other approaches could be also possible like in bhattacharya et al 2011 kim et al 2013 3 3 usv model the mathematical model considers a usv with inertial mass m s and inertial moment about the usv center of mass i s a propulsion force f s and a bearing moment t s are applied to the center of mass the model is generic for several types of vessels the accelerations would be 19 m a s f s f r f e 20 i s α s t s t r t e where the terms f e and m e correspond to towing action and the terms f r and m r correspond to resistance against ship motion given the inertial components of the usv velocity v s the corresponding components in body axes can be obtained with 21 v s l v s p t r θ 1 v s x v s y t being r θ a standard 2d rotation matrix the components of the resistance force f r in body axes are modeled as follows 22 f r l μ l v s l 23 f r p μ p v s p then the components of the resistance force f r in inertial axes can be obtained with 24 f r x f r y t r θ f r l f r p t finally the resistance to rotation has been modeled as the following momentum 25 t r μ a ω s were ω s is the angular velocity of the ship and μ a is a resistance coefficient 4 experimental framework this research involved frequent experimentation along severalyears as the weather permitted it initial experiments were devoted to develop and test the experimental system which includes equipment and software afterwards the experimental work focused on modeling needs concerning the usv model and the booms as said before once the mathematical models were established a simulation environment was built based on this environment it was possible to prepare new experimental scenarios with boom towing in order to investigate path planning the experiments were also important for observation of dynamical behaviors and phenomena which in certain situations were somewhat surprising in turn experiments have been useful as a validation reference for the simulation 4 1 details of the usv a common scene you can see in harbors is a ship being towed by a tug what it is wanted from a tug is propulsion power and good maneuvering capabilities taking into account the needs of experiments related to towing a small twin hull catamaran type usv has been built in our laboratory each hull has an associated propeller with 34 8 n maximum propulsion force quite more of what is needed for our boom towing experiments both propellers are independently controlled the ships course is governed by differences in propeller forces denote as f r the propulsion force of the propeller on the right side f l the propulsion force of the propeller on the left side the sum of these forces gives the total propulsion force f s their difference would be f d i f f r f l there is a slip angle that can be approximated with 26 s i n β f d i f f s see pandey and hasegawa 2015 for a more detailed modeling in body axes there would be two forces caused by propulsion 27 f s l f s c o s β 28 f s p f s s i n β the length of the usv hulls is 80 cm the bridge is 70 cm wide and 50 cm long in order to provide large torques for usv spinning the propellers are placed by the external side of the hulls figs 5 6 show an schematic top view of the boat design and a photograph of the usv the digital radio antenna is mounted on the ship superstructure a more detailed view of one of the two propellers is shown in fig 7 the propellers chosen for the boat are the t200 thrusters from blue robotics robotics 2018 the t200 thruster has been modeled in nielsen et al 2018 by means of a rc electronic speed control esc device the propulsion force of the thrusters is controllable with conventional pulse width modulated pwm signals this kind of signals is widely used in the radio control community in fact the same pwm signals that are used for our small ship could be used at any ship scale even large sizes for governing the propulsion power through adequate electronic interfaces one of the initial activities of the research has been to test the behavior of the usv under manual control from a rc console measuring the usv position and speed with an on board gps speeds well over 2 m s can be easily reached with low energy consumption for the boom towing experiments this speed can be lowered by just using pwm signals with narrower width notice that the recommended speed at real scale for boom towing is around 0 5 m s the miniature digital computer is based on a stm nucleo board by stmicroelectronics stm 2018 this board has an arm cortex 4m digital microcontroller and many input output pins some of these pins have been selected for including in the control system miniature devices for gps digital compass and a digital radio link the on board control software is written in c the main task of this software is to compute the suitable propulsion forces according to the information from sensors about current heading location and velocity desired forces are transmitted to the esc devices via pwm signals generated by the arm microcontroller the on board navigation control includes implemented in software a digital proportional integral derivative pid controller fig 8 shows the block diagram of the course control this control is handled by a higher level algorithm which regularly updates the heading setpoint for waypoint based steering 4 2 the ground station a ground station gs has been developed as part of the experimental system it is used before experiments to transmit to the usv setup data like speed desired trajectory and pid parameters the desired trajectory is specified by waypoints the gs has start stop commands to begin stop the experiments during experiments the gs remains passive with no intervention on the usv behavior the only task of the gs during experiments is to gather digital radio data sent by the usv for real time monitoring these data are also saved in a file for off line study of results while moving the usv sends to the gs her compass and gps data and the pwm values generated for speed and course control it is always possible to take manual control of the usv using a joystick fig 9 shows one of ground station screens during an experiment this screen can be used for formation experiments with several usvs but in this case it is used for a single vehicle the left panel shows the desired path in green and the usv motion as a white trail the gs program has been developed in c using the gtk environment for gui implementation the gs hardware is a conventional portable computer coupled through usb to a digital radio chip another xbee unit digi 2018 which in turn is connected to an antenna 4 3 usv model parameters a series of experiments were done for estimation of the usv model parameters the first experiments were done following a straight path at different speeds in order to estimate the usv friction coefficient in the direction of surge a second series of experiments were devised to make the usv follow circular paths of specified radii and measuring period times the friction coefficients of the model in the sway direction were estimated also the spinning friction coefficient was estimated as a result of these experiments the parameters of the usv model were estimated to be as given by table 1 4 4 boom towing estimation of forces in theory itopf 2014 the towing force in n is given by 29 f t q v 2 with q 1000 a a is the area perpendicular to the flow when towing a boom with two ships the boom takes a catenary form the area perpendicular to the flow will depend on the distance between boom tips or in other words how wide is the mouth a first experimental light boom 15 m long was made by chaining a series of cylindrical floats the boom cable is a conventional polypropylene rope flexible and light based on experiments towing the boom with two scaled boats that were used years ago in another research giron sierra et al 2015 and comparing velocities with and without towing it was estimated that the drag of the boom is in the order of conventional booms considering equivalences from scale 1 15 to real scale see lloyd 1989 for scaling from initial experiments on boom towing it was noticed that if the usv tries to turn while towing the boom the boom opposes to it it could be regarded as a course stabilization influence from the boom it was also experimentally noticed that the boom was quite sensitive to wind gusts 4 5 automatic navigation experiments most of our experiments were carried out in a 100 m 70 m pond near our university fig 10 shows a picture of the pond the border of the pond is not a vertical wall but instead a kind of beach with a soft slope a top view google maps of the pond was chosen and saved as an image fig 11 the ground station displays the real time gps data from the usv as color traces on this image besides the gps data obtained from experiments are saved by the ground station as a file and can be retrieved afterwards for analysis and display using matlab before using any boom it is convenient to check the automatic behavior of the usv alone the preparation of an experiment involves the specification of a path in terms of waypoints the usv will turn around waypoints following curved trajectories not necessarily touching the waypoints some tolerance is allowed based on the mathematical model of the usv dynamics these trajectories can be predicted and displayed by our simulation environment the simulation is also useful for the tuning of the pid course controller several paths from simple to more complicated were planned and the corresponding usv trajectories were predicted for the usv not towing any boom subsequent experiments in the pond confirmed a satisfactory automatic navigation of the usv in reasonable agreement with the simulation predictions for instance fig 12 shows the gps trace of the usv motion red curve with triangles in an experiment with a cross of four waypoints marked as black diamonds the curve in blue is the usv trajectory prediction based on the mathematical model of course the prediction does not know the actual perturbations found by the usv this day in particular there is some underwater pumping machinery near north west of the pond and close to the surface for water filtering 5 preliminary analysis of the boom deployment the scenario being studied in this article is a boom to be towed from shore near the tanker the boom could be folded or contained in a reel the usv has to tow the boom and deploy the boom around the tanker fig 13 shows a picture that gives an example of on shore reel with a boom recently a similar system with a reel a toboggan and an usv has been introduced with the usv coming from the reel to a receiving station spmarine 2019 at first sight the boom deployment could be judged a simple task however if one does not want the boom to brush against the tanker during the deployment things become more complicated in absence of auxiliary boats or devices that could help to separate the boom from the tanker it would be required to pull completely the boom from shore towing the boom relatively far from the tanker after the complete boom has been put on the water it may be necessary to adapt the boom geometry to the tanker fig 14 illustrates how the first step of the deployment could be before matching the boom to the tanker then it becomes pertinent to think about what can be expected from wind and currents this environmental part of the situation might be convenient as far as it helps to get a suitable shape for the boom being towed fig 15 illustrates a favorable case the usv moves from right to left counterclockwise towing the boom taking as reference fig 15 suppose that the current takes the opposite sense this would throw the boom against the tanker unless the usv tried to harness the situation which could become quite difficult in such a case it would be recommended to have another boom near the bow of the tanker and try the boom deployment from bow to stern there is an important remark to do although it is evident towing a boom longitudinally takes much less force than towing it transversely in particular as soon you have a u shape towing forces would become larger depending on the mouth dimension let us consider the possible size of involved forces the information from shipbuilders usually gives data on engine power how this power transforms into propulsion force depends on gears and propellers for instance a 1000 kg weight rescue zodiac with a 44 74 kw engine could have 3 53 kn propulsion force or with a gearbox 4 71 kn propulsion force for a boom with a mouth 100 m wide and draft 0 30 m and a velocity relative to the water of 1 m s the required towing force would be 30 02 kn looking at the usual ships for towing tasks there are river tugs 13 m long with 34 32 kn bollard pull manor marine 2017 high seas tugs could have from 88 26 kn to 882 59 kn bollard pull damen 2017 latest trends in harbor tugs were described by artyszuk 2013 fishing ships offer another context with experience in towing it is estimated prado and drémière 1990 that 74 57 kw trawlers would have about 9 80 kn bollard pull this last reference also says that trawlers with 15 20 m length and 74 57 149 13 kw would be used for nets with 20 30 m mouth opening the speed of net hauling in coastal waters is in the range 15 40 m min indeed nets and booms are not the same concerning resistance to motion 6 scaled experiments of boom deployment around a ship a basic study has been made with our usv towing a experimental boom the scenario considered was a simple deployment around a supposed ship fig 16 shows how it was conceived the first part is devoted to tow the boom away from the coast while the boom moves the u shape builds up and so taking the boom towards the coast could mean a larger effort for this reason the last part of the trajectory tries an oblique approach to the border since our experiments are done in a pond it is assumed that there are no currents however wind could have a significant effect the plan itself is expressed as a series of four waypoints the curve depicted on the figure corresponds to the usv trajectory as predicted by simulation based on the usv model one of the main targets of the experiment is to confirm the predictions from our simulation system videos and pictures were taken and the gps traces of the usv during boom towing were acquired and saved another important target is to provide an opportunity of direct observation of what may happen during the boom deployment a light experimental boom was made especially for this experiment the boom was 50 m long supposing that the boom draws a perfect semi circle with a 10 m radius it is only necessary 31 4 m of boom however more length should be allowed for other usv trajectories the experiment was made several times with a fixed pwm setpoint fig 8 fig 17 shows a picture of the result after one of the experiments the usv should not approach the border by the end of the experiment in order not to run aground on the submerged beach the gps trace of the usv along the deployment experiment is shown in fig 18 with respect to the satellite view of the pond fig 19 shows two photographs taken along one experiment the first photograph fig 19 a was taken with the camera pointing to east side of the pond it corresponds to the usv starting to pull the boom from shore heading left from the pond jet which means a danger for the usv as the usv passes by the first waypoint the u shape starts to develop the second photograph fig 19 b now with the camera pointing north east was taken after some time near the end of boom deployment and shows the usv driving towards the shore a video of the experiment is available the link is given at the end of the article fig 20 compares the predicted motion of the usv while towing the boom simulation and what happened in reality usv gps trace there was some south east wind during the experiment by using the simulation it is possible to compute the evolution of the cable tension along the boom deployment which is shown in fig 21 the maximum value gives an important information on what tensile performance the cable should have there is a significant tension growth near the end of the experiment as the length of the deployed boom comes near its 50 m limit notice that the information on cable tension obtained with our simulation tool is important for determining what propulsion force the usv should provide for adequate boom towing the sharp peak in tension by the end of deployment suggests that adding a tension sensor would be welcome since it would give opportunities for extending the on board control to take care of speed and thrust along the deployment table 2 gives the boom parameters that have been used for the boom dynamics simulation 7 real scale simulation experiments for boom deployment planning a clear advantage of simulation is that many different experiments perhaps difficult to achieve in reality can be done just with some computational effort another added value is that simulation can provide a lot of data otherwise difficult to acquire in real time an example of this second aspect is that with simulation it is possible to follow in detail as a sequence of snapshots the changing shape of the boom as the deployment progress of course videos can be taken during real experiments but numerical data would be really cumbersome to get perhaps using gps devices in each link of the boom this section is mainly devoted to boom deployment planning with results at real scale obtained in simulation the objective is to establish an adequate sequence of waypoints for the usv in order to have an acceptable boom deployment around the target tanker in order to simplify the boom deployment planning it could be assumed that when the usv turns around a waypoint it follows approximately a circular arc therefore usv paths can be built by connecting two types of pieces arcs of circles or straight line segments in his pioneering work dubins showed that a car like mobile robot with a given initial position and heading can arrive to a target final position and heading with exactly three sequentially connected such pieces dubins 1957 the dubins paths are the shortest paths for the car like case a nonholonomic vehicle there are many papers focusing on this approach for several applications like for example breivik and fossen 2004 yong and barth 2006 fossen et al 2015 the result of a path planning for a certain experiment real or simulated is a list of waypoints in the case of a real experiment this list is given to the ground station which in turn transmit it to the usv the usv navigation control takes care of going along the specified path from one to another waypoint in a scenario with a long tanker and a relatively narrow river it could be not possible to try the plan used in our scale experimental study previous section another basic planning for our boom deployment is sketched in fig 22 the idea is to have a narrow u mouth also keeping the usv far from the farthest bank of the river the first waypoint is placed near the tanker s stern the second waypoint is relatively far at right side of the figure this waypoint is placed there in order to completely deploy the boom the usv would have the hardest towing work when going from the third to the fourth waypoint which marks the end of the operation the figure shows the prescribed path and captures one of the instants of the boom deployment once the plan was specified a deployment simulation was run the results are presented in figs 23 and 24 fig 23 shows the evolution of towing cable tension at the tip of the boom nearer to the usv the turnings around waypoints can be easily identified since tension decreases there after the third waypoint tension increases sharply because the usv effort on the boom becomes more perpendicular to the boom the first part of the cable tension evolution has a jagged profile the simulation takes into account as specified in the scenario definition that the boom was folded at the initial point on shore the link by link unfolding due to usv towing means a complicated dynamics that translates to brisk changes in resistance to towing it is even possible with the simulation to study in detail the unfolding process if required for any reason for the pond scaled study the experiments and simulation started with the boom already extended on the border so the initial part of tension curve was smooth the complete evolution of the boom deployment is shown in fig 24 the parameters of the usv model being used in the simulation were the following see table 3 table 4 gives the parameters of the boom model the simulation was developed in the python language the simulation code is available from internet it should be said that it requires large computation work taking around one day for scenarios like the one selected in this section 8 conclusion and comments in this article the automatic boom deployment around a quayside moored ship has been explored the deployment was done by means of an usv towing the boom and following an adequate path considering that in real applications the boom deployment would be done with a conventional usv this article adhered to a basic usv waypoint steering navigation several aspects of the planning were been considered including forces and sizes dynamic behavior of the boom usv trajectories etc the research involved the development of a experimental system with a ground station usvs scale booms and measurement devices a series of experiments were made to show the successive steps of the research a main result of the research was to experimentally show that the automatic boom deployment with an usv can actually be done the article included the modeling of the boom dynamics that together with a model of the usv and a model of the towing cable which provided a comprehensive simulation environment this environment was shown to be a useful tool for boom deployment planning in different scenarios exemplified by a tanker moored in a river section 7 of the article part of the research activity has been oriented to provide experimental confirmation of the simulation prediction capabilities both wind and currents can be considered by the simulation given a particular application case with specific location boundaries and a concrete type of usv and boom a series of plans could be established for different currents winds and tanker sizes the results could be expressed in tabular format with waypoint lists for each case from experimental observation it would be recommended for the development of a real scale usv to incorporate the type of thrust vectoring available on tugs likewise it would convenient to add auxiliary lateral maneuvering thrusters for instance near the bow it would be preferred to use propellers for low speed high torque operation another point is that adequate support should be given for human supervision and intervention when needed in our case it was easy to visually follow the experiments however in real scale it would be advisable to add cameras perhaps drones and real time visualization on the ground station probably rather than deploying the boom from an off shore reel it would be better to design the usv for having a reel on board or at least a platform for a folded boom and deploy the boom from the usv this would represent a new research problem from the usv control point of view since the dynamic characteristics of the usv would change along the deployment concerning future research since our usv is open for on board software changing more intelligent usv control can be investigated for instance optimization of trajectories use of a tension sensor for thrust control and control actions for avoiding deviations with respect to the prescribed path large perturbations could appear during deployment we have in mind to use an aerial unmanned vehicle for looking at the boom shape from above as it is deployed in case of having actually an oil spill this would be convenient for suitable guidance of the usv in order to encircle the spill that is an interesting scenario for cooperative robotics future work on the scenario treated in this article will focus on automatic planning flexibility for tackling changes of tanker size and wind and current conditions perhaps re planning if these conditions change these are steps towards increased level of autonomy the simulation code can be accessed at git https github com juanjimenez pyships two videos of experiments at the pond are available from https www youtu be e2xqjvh71y0 https www youtu be p5uz f aky credit authorship contribution statement juan f jimenez conceptualization formal analysis software methodology jose m giron sierra conceptualization investigation resources validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgment the authors would like to thank the support of the cicyt spanish committee projects dpi2009 14552 c02 01 dpi2013 46665 c1 1 r 
21828,in a present experiment a solid sphere with a density of 2 64 103 kg m3 and diameter of 25 4 mm was launched vertically upward in water toward the air water interface the submergence depth was changed and the launch velocity was adjusted so that the reynolds number of the sphere immediately after passing the air water interface was almost equal at each submergence depth the effects of the submergence depth on the motion of the sphere and behavior of the air water interface were investigated which indicated that the reynolds number immediately after the sphere passed through the air water interface was r e w 1 3000 at all submergence depths 1 0 d h 6 0 d d is the diameter of the sphere and h is the submergence depth the experimental values of the maximum displacement position were always smaller than the theoretical values owing to the energy dispersion caused by the water droplets entrained around the sphere when the submergence depth was h d 3 the higher the submergence depth the smaller was the rise of the sphere after passing through the air water interface however when the submergence depth was h d 3 the temporal changes in the vertical trajectory of the sphere were approximately equal the energy ratio e p e k was defined as the ratio of the kinetic energy e k of the sphere immediately after it passed through the air water interface to the potential energy e p when the sphere reached the maximum displacement position e p e k decreased when the submergence depth was h d 3 however it had a constant value of e p e k 0 57 0 05 when the submergence depth was h d 3 in addition when the submergence depth was h d 3 the ratio of each energy kinetic energy potential energy and interfacial energy became similar immediately after passing through the water surface this indicated that each energy distribution had reached the equilibrium state these findings contribute to the determination of variable parameters when modeling the water exit problem keywords gas liquid solid three phase flow deformation of air water interface visualization 1 introduction the situation in which an object in water is released to air is known as the water exit problem greenhow 1988 korobkin et al 2017 nguyen et al 2013 when an object moves from water to air the water surface shows a unique behavior specifically when an object moving in water passes through the water surface the water surface is deformed and a water column is entrained behind the object in addition the water mass entrained by the sphere leaves the surface of the sphere while rising in air and eventually scattering around the sphere as countless water droplets such a series of phenomena continues to act while the sphere is in contact with the water mass or water column in this series of phenomena the interaction between the sphere and the water mass or water column also affects their behavior these are unique phenomena that are not observed in the water entry problem huera huarte et al 2011 panciroli et al 2015 tveitnes et al 2008 stenius et al 2013 yang and qiu 2012 xu et al 2008 iranmanesh and passandideh fard 2017 abraham et al 2014 lee et al 2010 therefore the water exit problem continues to attract much scientific interest owing to the abundance of physical phenomena that forms the basis of mutual interference at the air water interface and the formation of water columns water exit is known to be a very complicated problem with nonlinear fluid deformation to understand these complicated flow phenomena relatively simple shape models such as cylinders and spheres have been used greenhow and lin 1983 conducted an experiment in which a cylinder in water was moved vertically upward at constant velocity and passed through the air water interface and discussed the peculiarities of the displacement and velocity of the free surface caused by the moving object interference truscott et al 2016 investigated the water exit dynamics of buoyancy spheres with increasing reynolds numbers between 4 0 1 0 4 and 6 0 1 0 5 this study clarified the relationship between sphere motion and reynolds number as the sphere passes through the air water interface in addition truscott et al 2016 captured the flow phenomenon by the particle image velocity technique and observed unsteady vortex shedding in the wake of the sphere in the experiment of wu et al 2017 high speed photographic technology was used to capture the free surface deformation at the air water interface in their study the influence of sphere velocity or froude number was investigated from both forced movement and free rise of the sphere by an external force as a result it was clarified that when the sphere was lifted from the water at a constant velocity the higher the sphere lifting velocity was the longer the water column was stretched however the duration of the water column was inversely proportional to the sphere velocity when a sphere passes through the air water interface the behavior of interface is affected by the fluid entrained surrounded the sphere known as added mass truscott et al 2016 when the motion of the sphere is in an unsteady state it is known that the effect of the added mass depends significantly on the distance that the sphere moves in water the submergence depth sasaki 2014 however studies about changing submergence depths are currently limited to the case of free rising by a buoyant sphere truscott et al 2016 guo et al 2019 or constant velocity wu et al 2017 the absence of sufficient research into the interface details of the water exit problem limit the ability of engineering simulations to adequately model this aspect which may result in sub optimal performance and errors in simulation in this study spheres with densities higher than water were used the sphere was launched vertically upward in water in this case the sphere reaches the maximum velocity immediately after being launched and then passes through the air water interface while decelerating the effect of added mass should be affected by acceleration from the viewpoint of potential theory newman 2018 when launching a sphere the acceleration is different from the case of free rising or moving a constant velocity of the sphere this suggests that the behavior of the air water interface when launching the sphere may be different from the knowledge obtained from previous water exit studies in this study we varied the submergence depths to investigate this aspect of the problem at this time the launch velocity was adjusted so that the velocities of the sphere immediately before and after passing through the air water interface were equal the characteristics of the sphere and the air water interface after passing through the interface was discussed from the viewpoint of visualization and energy balance 2 experimental setup and method an illustration of the experimental equipment is presented in fig 1 the experimental equipment consists of a transparent acrylic tank 0 4 m wide 0 4 m deep 0 4 m tall and a pedestal supporting the tank the acrylic board has a thickness of 8 mm water is stored in the tank and a sphere launcher is installed at the center of the bottom of the tank the experimental equipment is supported by a total of eight adjuster feet and the parallelism of the tank is maintained by adjusting the height of each foot the area circled by the blue dashed line in fig 1 shows the launcher system consisting of a cylinder coil spring trigger and iron rod fig 2 shows the cross sectional structure of the launcher fig 2 a indicates the scenario when the sphere is installed on the launch pad before pulling the trigger a cylinder 67 mm long with an internal diameter of 19 3 mm is located at the center of the launcher and a sphere of diameter d is placed at the top of the cylinder a cylindrical iron rod 170 mm long and 19 1 mm in diameter is placed inside the cylinder the lower end of the iron rod and the coil spring are connected in series the tip of the iron rod is 4 mm high and 6 mm wide when the iron rod is on standby the distance between the projection and the bottom of the sphere is 16 6 mm the iron rod is pressed down vertically to compress the coil spring and is fixed with a trigger when pulling the trigger to release the coil spring the iron rod moves upward in the cylinder and the sphere is launched into the water at time t 0 because the upper end of the iron rod strikes the sphere the lower end of the coil spring is connected to an adjustment table with changeable height the height is changed by rotating the adjustment table in the direction of the arrow shown in fig 2 while the coil spring is compressed in this way the launching velocity of the sphere can be controlled by the compression displacement of the coil spring fig 2 b shows the scenario immediately after the sphere is ejected from the launcher after pulling the trigger after pulling out the trigger the cylinder is pushed up 26 mm by the coil spring in this study solid spheres with density of ρ p 2 64 1 0 3 kg m 3 were used when the maximum radial distance between the smallest sphere is circumscribed to the surface of the sphere and each point on the surface of the sphere is defined as δ d the surface roughness is δ d d 2 0 1 0 4 the contact angle of each sphere was measured using the sessile drop method each sphere was measured at ten different measurement points purified water was used as the probe solution and 0 5 μ l of hanging drop volume was used for each measurement the average value of the contact angle obtained by ten measurements was θ 84 3 and the standard deviation of θ was θ 2 7 3 the rising characteristics of the sphere after passing through the air water interface are expected to depend on the ratio ρ ρ p ρ w of the sphere density ρ p to the water density ρ w the archimedes number and the bond number the archimedes number and bond number are defined as a r ρ p ρ w ρ w g d 3 μ 2 and b o ρ p ρ w g d 2 σ respectively where μ is dynamic viscosity g is gravitational acceleration and σ is surface tension during the experiment the air temperature in the laboratory was kept at 20 c the temperature of water in the tank ranged from 19 c to 22 c and the average temperature was 20 c therefore all results of this study assumed that the water temperature was 20 c and ρ w μ and σ were set to ρ w 998 2 kg m 3 μ 1 002 1 0 3 kg m and σ 0 0728 n m respectively considering the above the density ratio is ρ 2 64 the archimedes number is a r 2 62 1 0 8 and the bond number is b o 143 fig 3 shows the positional relationship between the acrylic tank test section and the launcher the coordinate origin x y z 0 0 0 is at the center of the sphere at time t 0 the coordinate system has an x y axis in the horizontal direction and a z axis in the vertical direction the distance between the coordinate origin and the air water interface is set to h in this study h ranged from 1 0 d h 6 0 d fig 4 shows a top view of the experimental setup the inside of the acrylic tank is illuminated by a light fixture godox with 32 32 leds arranged in a plane of 0 34 m 0 34 m to equalize the light intensity inside the acrylic tank a vinyl chloride translucent diffuser sheet is attached to the wall of the tank on the lighting side the motion of the launched sphere and behavior of the air water interface are photographed by two high speed cameras nac mx 5 the effective pixel count of the camera is 1920 1080 dpi and the frame rate is 2000 fps the position coordinates of the sphere were obtained by reference to the image processing method proposed by chen and chung 2001 the outline of the sphere was detected using an extraction method sobel operator gonzales and woods 2002 that identified the area where the luminance difference between adjacent pixels was as large as the edge of the image the sphere was detected by performing a hough transform on the image obtained by the sobel operator chen and chung 2001 the position of the sphere was calculated using images taken from two directions using two cameras respectively and the averaged value of the two cameras was used the error of the vertical position obtained from each camera was δ z d 0 05 and the accuracy was sufficiently ensured note that when the sphere was completely covered by the water mass in a certain direction only one direction imaging result was used in this study several reference points were set in the vertical direction as shown in fig 5 the vertical position of the center of the sphere was defined as z p and the vertical velocity at that time is defined as w p the vertical velocity of the sphere immediately after it was launched from the launcher at time t 0 and the vertical position of the sphere z p 0 was defined as w 0 when the bottom of the sphere coincides with the air water interface height h at the initial time t 0 the position of the sphere the time and vertical velocity are defined as z p z 1 t t 1 and w p w 1 respectively the maximum displacement position reached by the sphere in air is defined as z p z 2 and the corresponding time as t t 2 in the present work a total of 126 trials were performed previous studies have shown that the fluid must be still for up to 30 min before release for consistent and repeatable results truscott et al 2016 therefore a 30 min wait time was used throughout the study 3 results in this study the effect of the submergence depth h was investigated in the range of 1 0 d h 6 0 d the launch velocity of the sphere was adjusted in all cases so that the reynolds number was r e w 1 3000 table 1 shows the ensemble averaged properties of the sphere motion at reference points defined in fig 5 here the superscript bar z p and w p identifies the ensemble average the reynolds numbers at heights z 0 and r e w 0 were calculated using the kinematic viscosity coefficient in water ν 1 003 1 0 6 m 2 s and the reynolds number at the height of z 1 and r e w 1 was calculated using the kinematic viscosity coefficient of air ν 1 512 1 0 5 m 2 s f r 1 and w e 1 are the froude number and weber number at the height of z 1 respectively and they are calculated by 1 f r 1 w 1 d g 2 w e 1 ρ w d w 1 2 σ fig 6 shows the ensemble averaged reynolds number r e w 1 at the moment when the sphere passes the position of z 1 the error bar in fig 6 shows the standard deviation of the variability obtained by repeated measurements for all cases the reynolds number at the moment when the sphere passes the position of z 1 was r e w 1 3000 however the magnitude of the error bar increases with increasing h d this is because the longer the sphere travels in water the more unstable its behavior becomes due to resistance frictional and external forces for h d 1 2 5 and 4 the error bars for r e w 1 are approximately 2 3 and 8 respectively fig 7 shows the magnitude x p 2 y p 2 0 5 d of the deviation from the center axis of the sphere from the time immediately after launch to reaching the maximum displacement position for h d 1 and 2 x p 2 y p 2 0 5 d increases monotonically with the rise of the sphere at this time the magnitude of the error also increases as the sphere rises the trends for h d 2 5 to 6 0 are similar in water the peaks of the deviation for h d 2 5 to 6 0 appear between z p d 1 5 and 3 0 respectively which appears to be due to the sphere oscillating at a constant amplitude under the influence of the wake truscott et al 2016 horowitz and williamson 2010 in an experiment conducted by truscott et al 2016 on the free rise of a buoyant sphere the behavior of the sphere changed to the oscillatory regime after the wake vortex was induced characteristics of spheres in the oscillatory regime are similar to those in water in this study however the magnitude of the deviation from the central axis is approximately 1 10 of the result of truscott et al in this study it is considered that the fluctuation of the sphere is suppressed because a large inertial force acts on the sphere due to the applied external force after passing through the air water interface indicated by the region above the dashed line in fig 7 x p 2 y p 2 0 5 d increases monotonically as the sphere rises the magnitude x p 2 y p 2 0 5 d of the deviation from the center axis of the sphere when the sphere passes z 1 and z 2 is shown in fig 8 when the sphere reaches the position of z 1 and z 2 the error bar of x p 2 y p 2 0 5 d increases as h d increases in each case the magnitude of the deviation from the central sphere axis was less than 10 of the diameter of the sphere therefore it is assumed that the sphere movement is one dimensional in the vertical direction the experimental and theoretical values of the vertical sphere position are compared here the theoretical value of the sphere motion is derived from the equation of motion of the sphere rising in air the one dimensional equation of sphere motion that rises vertically in air is expressed as following equation 3 m d w p t d t m g 1 2 c d ρ a a w p t 2 where the density of air is ρ a the mass of the sphere is m the projected area of the sphere is a the gravitational acceleration is g and the drag coefficient is c d at w p t 0 eq 3 can be rewritten as 4 w p t 2 m g c d ρ a a tan c d ρ a a g 2 m t w 1 from eq 4 the position z p of the sphere is expressed by 5 z p t 0 t 2 m g c d ρ a a tan c d ρ a a g 2 m t w 1 d t it is known that the drag coefficient c d depends on the reynolds number and the flow fields dennis and walker 1971 brown and lawler 2003 chen et al 2006 generally the drag coefficient of a sphere fixed in steady flow takes c d 0 44 over a wide range of 1 0 3 r e 1 0 5 since r e w 1 in the present study is within the range of 1 0 3 r e 1 0 5 c d in air was set to c d 0 44 fig 9 compares the experimental results of the time variation in z p until the sphere reaches z 2 and the results obtained from eq 5 here fig 9 is shifted so that z 1 and t 1 take the origin and the time t t 1 is normalized by t 1 d w 1 at z p z 1 d 0 the experimental value is always smaller than the theoretical value this is because in the experiment although the sphere induces a water column as it passes through the air water interface and entrains water droplets eq 5 does not consider the loss of these energies the rise rate of the sphere decreases as h d increases indicating that the higher the submergence depth the more kinetic energy of the sphere is lost at the air water interface these graphs approximately collapse at h d 3 0 hence it is assumed that the influence of the air water interface reaches an equilibrium state when the submergence depth is higher than a certain position in this study the certain position corresponds to h d 3 fig 10 shows an example of the visualized images at h d 1 2 3 and 5 to investigate the submergence depth dependence of the air water interface behavior the figure is a snapshot taken from the upper side of the water surface at t t 1 t 1 0 2 6 and 5 8 from the left here at t t 1 t 1 0 left figure in fig 10 the image taken at the same time by the camera installed horizontal to the air water interface is shown in the upper right at t t 1 t 1 0 the larger the h d the more water was entrained behind the sphere at t t 1 t 1 2 6 a water column is formed between the sphere and the air water interface at h d 1 0 but no water droplet is observed around the sphere as h d increases more water mass is entrained around the sphere in addition the vertical position of the sphere at the same time t t 1 t 1 2 6 decreases as h d increases at t t 1 t 1 5 8 the width of the water column widens as h d increases only at h d 5 0 was the sphere covered with a water sheet and water column could not be identified between the sphere and the air water interface guo et al 2019 showed that spontaneous destruction of the water column occurs at high weber numbers w e 2 05 1 0 5 although weber number was only w e 1100 in all cases there is a difference in the development of the water column as shown in fig 10 after the sphere has passed the air water interface the sphere continues to rise under the influence of the water mass and self entrained water column from this fact the kinetic energy of the sphere immediately after passing through the interface is distributed to the potential energy due to the rise of the sphere and surface free energy due to the air water interface behavior here the kinetic energy of the sphere when it passes z 1 was defined as e k z 1 and the potential energy when the sphere reaches the maximum displacement position z 2 was defined as e p z 2 in this study the ratio e p z 2 e k z 1 was taken and indicates the proportion of total kinetic energy converted to potential energy here the kinetic energy and potential energy are defined as e k z p 1 2 m w p z p 2 and e p z p m g z p respectively fig 11 shows the dependence of e p z 2 e k z 1 on the submergence depth at h d 3 e p z 2 e k z 1 decreased with the slope of e p z 2 e k z 1 0 126 h as h d increased this indicates that the kinetic energy of the sphere is consumed by a factor other than the potential energy depending on the submergence depth the main energy consumption other than potential energy is the energy consumption related to air resistance and water entrainment behind the sphere note that the air resistance acting on an object moving at low velocity is very small hence it is supposed that the main factor of energy consumption is the water entrainment near the air water interface at h d 3 e p z 2 e k z 1 is constant at approximately 0 57 0 05 this result indicates that the energy has reached an equilibrium state however in the visualization shown in fig 10 the behaviors of the water mass and water column around the sphere differ significantly between h d 3 and h d 5 according to previous studies it is shown that the information obtained from the visualization of the instantaneous field does not always agree with the statistical characteristics because it looks at the external structure of the flow field takamure et al 2018 2019 thus although visualization is important for imaging phenomena statistics are also important to accurately grasp the motion characteristics of a sphere to investigate the energy transition from immediately after the sphere passes through the air water interface to the maximum displacement position a model equation of the energy conservation law is devised as expressed by 6 1 e k z 1 e k z p e p z p e o z p 1 here e o z p indicates the energy consumed by the water mass and water column entrained by the sphere and is called interfacial containing energy in this study the interfacial containing energy is calculated as e o z p e k z 1 e k z p e p z p fig 12 shows the result at h d 1 3 and 5 the horizontal axis in fig 12 is normalized by z 2 z 1 in each case the percentage of potential energy e p increases as the sphere rises for h d 1 fig 12 a immediately after the sphere passes above the air water interface the interfacial containing energy increases slowly with the sphere rise but becomes almost constant at z p z 1 z 2 z 1 0 8 for h d 3 and 5 the interfacial containing energy continues to increase until the sphere reaches the maximum displacement position in addition as the energy distribution tendencies of h d 3 and h d 5 are similar it is considered that the energy transport reaches a universal state at h d 3 that is the results of this study suggest that in a field where a sphere passes through the air water interface the energy distribution characteristics become universal when the submergence depth is larger than a certain position 4 conclusions an experiment was conducted in which a solid sphere with density of 2 64 1 0 3 kg m 3 and diameter of 25 4 mm was launched vertically upward in water toward the air water interface in the present study the submergence depth was varied and the launch velocity was adjusted so that the reynolds numbers of the spheres immediately after passing the air water interface were equal the effects of submergence depth on the sphere motion and the air water interface behavior were investigated the results are summarized as follows 1 the reynolds number immediately after the sphere passed through the air water interface was r e w 1 3000 at all submergence depths 2 the experimental values of the maximum displacement position were always smaller than the theoretical value due to the energy dispersion caused by the water droplets entrained around the sphere when the submergence depth is h d 3 the higher the submergence depth the smaller the rise of the sphere after passing through the air water interface however when the submergence depth is h d 3 the temporal changes in the vertical trajectory of the sphere are approximately the same 3 the energy ratio e p z 2 e k z 1 was defined as the ratio of the kinetic energy e k z 1 of the sphere immediately after the sphere passed through the air water interface and the potential energy e p z 2 when the sphere reached the maximum displacement position e p z 2 e k z 1 decreases when the submergence depth is h d 3 but is a constant value of e p z 2 e k z 1 0 57 0 05 when the submergence depth is h d 3 in addition when the submergence depth is h d 3 the ratio of each energy kinetic energy potential energy interfacial energy becomes similar immediately after passing through the water surface this suggests that each energy distribution has reached equilibrium state 4 three dimensions simulation where the air water interface is greatly deformed such as the water exit problem require enormous computational costs these findings obtained in this study suggests that the energy distribution of the water exit problem reaches a equilibrium state depending on the submergence depth this fact contributes to the determination of variable parameters in numerical modeling and helpful to simplification of 3d models and improvement of accuracy credit authorship contribution statement k takamure conceptualization data curation formal analysis investigation validation visualization writing original draft writing review editing t uchiyama methodology project administration resources supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
21828,in a present experiment a solid sphere with a density of 2 64 103 kg m3 and diameter of 25 4 mm was launched vertically upward in water toward the air water interface the submergence depth was changed and the launch velocity was adjusted so that the reynolds number of the sphere immediately after passing the air water interface was almost equal at each submergence depth the effects of the submergence depth on the motion of the sphere and behavior of the air water interface were investigated which indicated that the reynolds number immediately after the sphere passed through the air water interface was r e w 1 3000 at all submergence depths 1 0 d h 6 0 d d is the diameter of the sphere and h is the submergence depth the experimental values of the maximum displacement position were always smaller than the theoretical values owing to the energy dispersion caused by the water droplets entrained around the sphere when the submergence depth was h d 3 the higher the submergence depth the smaller was the rise of the sphere after passing through the air water interface however when the submergence depth was h d 3 the temporal changes in the vertical trajectory of the sphere were approximately equal the energy ratio e p e k was defined as the ratio of the kinetic energy e k of the sphere immediately after it passed through the air water interface to the potential energy e p when the sphere reached the maximum displacement position e p e k decreased when the submergence depth was h d 3 however it had a constant value of e p e k 0 57 0 05 when the submergence depth was h d 3 in addition when the submergence depth was h d 3 the ratio of each energy kinetic energy potential energy and interfacial energy became similar immediately after passing through the water surface this indicated that each energy distribution had reached the equilibrium state these findings contribute to the determination of variable parameters when modeling the water exit problem keywords gas liquid solid three phase flow deformation of air water interface visualization 1 introduction the situation in which an object in water is released to air is known as the water exit problem greenhow 1988 korobkin et al 2017 nguyen et al 2013 when an object moves from water to air the water surface shows a unique behavior specifically when an object moving in water passes through the water surface the water surface is deformed and a water column is entrained behind the object in addition the water mass entrained by the sphere leaves the surface of the sphere while rising in air and eventually scattering around the sphere as countless water droplets such a series of phenomena continues to act while the sphere is in contact with the water mass or water column in this series of phenomena the interaction between the sphere and the water mass or water column also affects their behavior these are unique phenomena that are not observed in the water entry problem huera huarte et al 2011 panciroli et al 2015 tveitnes et al 2008 stenius et al 2013 yang and qiu 2012 xu et al 2008 iranmanesh and passandideh fard 2017 abraham et al 2014 lee et al 2010 therefore the water exit problem continues to attract much scientific interest owing to the abundance of physical phenomena that forms the basis of mutual interference at the air water interface and the formation of water columns water exit is known to be a very complicated problem with nonlinear fluid deformation to understand these complicated flow phenomena relatively simple shape models such as cylinders and spheres have been used greenhow and lin 1983 conducted an experiment in which a cylinder in water was moved vertically upward at constant velocity and passed through the air water interface and discussed the peculiarities of the displacement and velocity of the free surface caused by the moving object interference truscott et al 2016 investigated the water exit dynamics of buoyancy spheres with increasing reynolds numbers between 4 0 1 0 4 and 6 0 1 0 5 this study clarified the relationship between sphere motion and reynolds number as the sphere passes through the air water interface in addition truscott et al 2016 captured the flow phenomenon by the particle image velocity technique and observed unsteady vortex shedding in the wake of the sphere in the experiment of wu et al 2017 high speed photographic technology was used to capture the free surface deformation at the air water interface in their study the influence of sphere velocity or froude number was investigated from both forced movement and free rise of the sphere by an external force as a result it was clarified that when the sphere was lifted from the water at a constant velocity the higher the sphere lifting velocity was the longer the water column was stretched however the duration of the water column was inversely proportional to the sphere velocity when a sphere passes through the air water interface the behavior of interface is affected by the fluid entrained surrounded the sphere known as added mass truscott et al 2016 when the motion of the sphere is in an unsteady state it is known that the effect of the added mass depends significantly on the distance that the sphere moves in water the submergence depth sasaki 2014 however studies about changing submergence depths are currently limited to the case of free rising by a buoyant sphere truscott et al 2016 guo et al 2019 or constant velocity wu et al 2017 the absence of sufficient research into the interface details of the water exit problem limit the ability of engineering simulations to adequately model this aspect which may result in sub optimal performance and errors in simulation in this study spheres with densities higher than water were used the sphere was launched vertically upward in water in this case the sphere reaches the maximum velocity immediately after being launched and then passes through the air water interface while decelerating the effect of added mass should be affected by acceleration from the viewpoint of potential theory newman 2018 when launching a sphere the acceleration is different from the case of free rising or moving a constant velocity of the sphere this suggests that the behavior of the air water interface when launching the sphere may be different from the knowledge obtained from previous water exit studies in this study we varied the submergence depths to investigate this aspect of the problem at this time the launch velocity was adjusted so that the velocities of the sphere immediately before and after passing through the air water interface were equal the characteristics of the sphere and the air water interface after passing through the interface was discussed from the viewpoint of visualization and energy balance 2 experimental setup and method an illustration of the experimental equipment is presented in fig 1 the experimental equipment consists of a transparent acrylic tank 0 4 m wide 0 4 m deep 0 4 m tall and a pedestal supporting the tank the acrylic board has a thickness of 8 mm water is stored in the tank and a sphere launcher is installed at the center of the bottom of the tank the experimental equipment is supported by a total of eight adjuster feet and the parallelism of the tank is maintained by adjusting the height of each foot the area circled by the blue dashed line in fig 1 shows the launcher system consisting of a cylinder coil spring trigger and iron rod fig 2 shows the cross sectional structure of the launcher fig 2 a indicates the scenario when the sphere is installed on the launch pad before pulling the trigger a cylinder 67 mm long with an internal diameter of 19 3 mm is located at the center of the launcher and a sphere of diameter d is placed at the top of the cylinder a cylindrical iron rod 170 mm long and 19 1 mm in diameter is placed inside the cylinder the lower end of the iron rod and the coil spring are connected in series the tip of the iron rod is 4 mm high and 6 mm wide when the iron rod is on standby the distance between the projection and the bottom of the sphere is 16 6 mm the iron rod is pressed down vertically to compress the coil spring and is fixed with a trigger when pulling the trigger to release the coil spring the iron rod moves upward in the cylinder and the sphere is launched into the water at time t 0 because the upper end of the iron rod strikes the sphere the lower end of the coil spring is connected to an adjustment table with changeable height the height is changed by rotating the adjustment table in the direction of the arrow shown in fig 2 while the coil spring is compressed in this way the launching velocity of the sphere can be controlled by the compression displacement of the coil spring fig 2 b shows the scenario immediately after the sphere is ejected from the launcher after pulling the trigger after pulling out the trigger the cylinder is pushed up 26 mm by the coil spring in this study solid spheres with density of ρ p 2 64 1 0 3 kg m 3 were used when the maximum radial distance between the smallest sphere is circumscribed to the surface of the sphere and each point on the surface of the sphere is defined as δ d the surface roughness is δ d d 2 0 1 0 4 the contact angle of each sphere was measured using the sessile drop method each sphere was measured at ten different measurement points purified water was used as the probe solution and 0 5 μ l of hanging drop volume was used for each measurement the average value of the contact angle obtained by ten measurements was θ 84 3 and the standard deviation of θ was θ 2 7 3 the rising characteristics of the sphere after passing through the air water interface are expected to depend on the ratio ρ ρ p ρ w of the sphere density ρ p to the water density ρ w the archimedes number and the bond number the archimedes number and bond number are defined as a r ρ p ρ w ρ w g d 3 μ 2 and b o ρ p ρ w g d 2 σ respectively where μ is dynamic viscosity g is gravitational acceleration and σ is surface tension during the experiment the air temperature in the laboratory was kept at 20 c the temperature of water in the tank ranged from 19 c to 22 c and the average temperature was 20 c therefore all results of this study assumed that the water temperature was 20 c and ρ w μ and σ were set to ρ w 998 2 kg m 3 μ 1 002 1 0 3 kg m and σ 0 0728 n m respectively considering the above the density ratio is ρ 2 64 the archimedes number is a r 2 62 1 0 8 and the bond number is b o 143 fig 3 shows the positional relationship between the acrylic tank test section and the launcher the coordinate origin x y z 0 0 0 is at the center of the sphere at time t 0 the coordinate system has an x y axis in the horizontal direction and a z axis in the vertical direction the distance between the coordinate origin and the air water interface is set to h in this study h ranged from 1 0 d h 6 0 d fig 4 shows a top view of the experimental setup the inside of the acrylic tank is illuminated by a light fixture godox with 32 32 leds arranged in a plane of 0 34 m 0 34 m to equalize the light intensity inside the acrylic tank a vinyl chloride translucent diffuser sheet is attached to the wall of the tank on the lighting side the motion of the launched sphere and behavior of the air water interface are photographed by two high speed cameras nac mx 5 the effective pixel count of the camera is 1920 1080 dpi and the frame rate is 2000 fps the position coordinates of the sphere were obtained by reference to the image processing method proposed by chen and chung 2001 the outline of the sphere was detected using an extraction method sobel operator gonzales and woods 2002 that identified the area where the luminance difference between adjacent pixels was as large as the edge of the image the sphere was detected by performing a hough transform on the image obtained by the sobel operator chen and chung 2001 the position of the sphere was calculated using images taken from two directions using two cameras respectively and the averaged value of the two cameras was used the error of the vertical position obtained from each camera was δ z d 0 05 and the accuracy was sufficiently ensured note that when the sphere was completely covered by the water mass in a certain direction only one direction imaging result was used in this study several reference points were set in the vertical direction as shown in fig 5 the vertical position of the center of the sphere was defined as z p and the vertical velocity at that time is defined as w p the vertical velocity of the sphere immediately after it was launched from the launcher at time t 0 and the vertical position of the sphere z p 0 was defined as w 0 when the bottom of the sphere coincides with the air water interface height h at the initial time t 0 the position of the sphere the time and vertical velocity are defined as z p z 1 t t 1 and w p w 1 respectively the maximum displacement position reached by the sphere in air is defined as z p z 2 and the corresponding time as t t 2 in the present work a total of 126 trials were performed previous studies have shown that the fluid must be still for up to 30 min before release for consistent and repeatable results truscott et al 2016 therefore a 30 min wait time was used throughout the study 3 results in this study the effect of the submergence depth h was investigated in the range of 1 0 d h 6 0 d the launch velocity of the sphere was adjusted in all cases so that the reynolds number was r e w 1 3000 table 1 shows the ensemble averaged properties of the sphere motion at reference points defined in fig 5 here the superscript bar z p and w p identifies the ensemble average the reynolds numbers at heights z 0 and r e w 0 were calculated using the kinematic viscosity coefficient in water ν 1 003 1 0 6 m 2 s and the reynolds number at the height of z 1 and r e w 1 was calculated using the kinematic viscosity coefficient of air ν 1 512 1 0 5 m 2 s f r 1 and w e 1 are the froude number and weber number at the height of z 1 respectively and they are calculated by 1 f r 1 w 1 d g 2 w e 1 ρ w d w 1 2 σ fig 6 shows the ensemble averaged reynolds number r e w 1 at the moment when the sphere passes the position of z 1 the error bar in fig 6 shows the standard deviation of the variability obtained by repeated measurements for all cases the reynolds number at the moment when the sphere passes the position of z 1 was r e w 1 3000 however the magnitude of the error bar increases with increasing h d this is because the longer the sphere travels in water the more unstable its behavior becomes due to resistance frictional and external forces for h d 1 2 5 and 4 the error bars for r e w 1 are approximately 2 3 and 8 respectively fig 7 shows the magnitude x p 2 y p 2 0 5 d of the deviation from the center axis of the sphere from the time immediately after launch to reaching the maximum displacement position for h d 1 and 2 x p 2 y p 2 0 5 d increases monotonically with the rise of the sphere at this time the magnitude of the error also increases as the sphere rises the trends for h d 2 5 to 6 0 are similar in water the peaks of the deviation for h d 2 5 to 6 0 appear between z p d 1 5 and 3 0 respectively which appears to be due to the sphere oscillating at a constant amplitude under the influence of the wake truscott et al 2016 horowitz and williamson 2010 in an experiment conducted by truscott et al 2016 on the free rise of a buoyant sphere the behavior of the sphere changed to the oscillatory regime after the wake vortex was induced characteristics of spheres in the oscillatory regime are similar to those in water in this study however the magnitude of the deviation from the central axis is approximately 1 10 of the result of truscott et al in this study it is considered that the fluctuation of the sphere is suppressed because a large inertial force acts on the sphere due to the applied external force after passing through the air water interface indicated by the region above the dashed line in fig 7 x p 2 y p 2 0 5 d increases monotonically as the sphere rises the magnitude x p 2 y p 2 0 5 d of the deviation from the center axis of the sphere when the sphere passes z 1 and z 2 is shown in fig 8 when the sphere reaches the position of z 1 and z 2 the error bar of x p 2 y p 2 0 5 d increases as h d increases in each case the magnitude of the deviation from the central sphere axis was less than 10 of the diameter of the sphere therefore it is assumed that the sphere movement is one dimensional in the vertical direction the experimental and theoretical values of the vertical sphere position are compared here the theoretical value of the sphere motion is derived from the equation of motion of the sphere rising in air the one dimensional equation of sphere motion that rises vertically in air is expressed as following equation 3 m d w p t d t m g 1 2 c d ρ a a w p t 2 where the density of air is ρ a the mass of the sphere is m the projected area of the sphere is a the gravitational acceleration is g and the drag coefficient is c d at w p t 0 eq 3 can be rewritten as 4 w p t 2 m g c d ρ a a tan c d ρ a a g 2 m t w 1 from eq 4 the position z p of the sphere is expressed by 5 z p t 0 t 2 m g c d ρ a a tan c d ρ a a g 2 m t w 1 d t it is known that the drag coefficient c d depends on the reynolds number and the flow fields dennis and walker 1971 brown and lawler 2003 chen et al 2006 generally the drag coefficient of a sphere fixed in steady flow takes c d 0 44 over a wide range of 1 0 3 r e 1 0 5 since r e w 1 in the present study is within the range of 1 0 3 r e 1 0 5 c d in air was set to c d 0 44 fig 9 compares the experimental results of the time variation in z p until the sphere reaches z 2 and the results obtained from eq 5 here fig 9 is shifted so that z 1 and t 1 take the origin and the time t t 1 is normalized by t 1 d w 1 at z p z 1 d 0 the experimental value is always smaller than the theoretical value this is because in the experiment although the sphere induces a water column as it passes through the air water interface and entrains water droplets eq 5 does not consider the loss of these energies the rise rate of the sphere decreases as h d increases indicating that the higher the submergence depth the more kinetic energy of the sphere is lost at the air water interface these graphs approximately collapse at h d 3 0 hence it is assumed that the influence of the air water interface reaches an equilibrium state when the submergence depth is higher than a certain position in this study the certain position corresponds to h d 3 fig 10 shows an example of the visualized images at h d 1 2 3 and 5 to investigate the submergence depth dependence of the air water interface behavior the figure is a snapshot taken from the upper side of the water surface at t t 1 t 1 0 2 6 and 5 8 from the left here at t t 1 t 1 0 left figure in fig 10 the image taken at the same time by the camera installed horizontal to the air water interface is shown in the upper right at t t 1 t 1 0 the larger the h d the more water was entrained behind the sphere at t t 1 t 1 2 6 a water column is formed between the sphere and the air water interface at h d 1 0 but no water droplet is observed around the sphere as h d increases more water mass is entrained around the sphere in addition the vertical position of the sphere at the same time t t 1 t 1 2 6 decreases as h d increases at t t 1 t 1 5 8 the width of the water column widens as h d increases only at h d 5 0 was the sphere covered with a water sheet and water column could not be identified between the sphere and the air water interface guo et al 2019 showed that spontaneous destruction of the water column occurs at high weber numbers w e 2 05 1 0 5 although weber number was only w e 1100 in all cases there is a difference in the development of the water column as shown in fig 10 after the sphere has passed the air water interface the sphere continues to rise under the influence of the water mass and self entrained water column from this fact the kinetic energy of the sphere immediately after passing through the interface is distributed to the potential energy due to the rise of the sphere and surface free energy due to the air water interface behavior here the kinetic energy of the sphere when it passes z 1 was defined as e k z 1 and the potential energy when the sphere reaches the maximum displacement position z 2 was defined as e p z 2 in this study the ratio e p z 2 e k z 1 was taken and indicates the proportion of total kinetic energy converted to potential energy here the kinetic energy and potential energy are defined as e k z p 1 2 m w p z p 2 and e p z p m g z p respectively fig 11 shows the dependence of e p z 2 e k z 1 on the submergence depth at h d 3 e p z 2 e k z 1 decreased with the slope of e p z 2 e k z 1 0 126 h as h d increased this indicates that the kinetic energy of the sphere is consumed by a factor other than the potential energy depending on the submergence depth the main energy consumption other than potential energy is the energy consumption related to air resistance and water entrainment behind the sphere note that the air resistance acting on an object moving at low velocity is very small hence it is supposed that the main factor of energy consumption is the water entrainment near the air water interface at h d 3 e p z 2 e k z 1 is constant at approximately 0 57 0 05 this result indicates that the energy has reached an equilibrium state however in the visualization shown in fig 10 the behaviors of the water mass and water column around the sphere differ significantly between h d 3 and h d 5 according to previous studies it is shown that the information obtained from the visualization of the instantaneous field does not always agree with the statistical characteristics because it looks at the external structure of the flow field takamure et al 2018 2019 thus although visualization is important for imaging phenomena statistics are also important to accurately grasp the motion characteristics of a sphere to investigate the energy transition from immediately after the sphere passes through the air water interface to the maximum displacement position a model equation of the energy conservation law is devised as expressed by 6 1 e k z 1 e k z p e p z p e o z p 1 here e o z p indicates the energy consumed by the water mass and water column entrained by the sphere and is called interfacial containing energy in this study the interfacial containing energy is calculated as e o z p e k z 1 e k z p e p z p fig 12 shows the result at h d 1 3 and 5 the horizontal axis in fig 12 is normalized by z 2 z 1 in each case the percentage of potential energy e p increases as the sphere rises for h d 1 fig 12 a immediately after the sphere passes above the air water interface the interfacial containing energy increases slowly with the sphere rise but becomes almost constant at z p z 1 z 2 z 1 0 8 for h d 3 and 5 the interfacial containing energy continues to increase until the sphere reaches the maximum displacement position in addition as the energy distribution tendencies of h d 3 and h d 5 are similar it is considered that the energy transport reaches a universal state at h d 3 that is the results of this study suggest that in a field where a sphere passes through the air water interface the energy distribution characteristics become universal when the submergence depth is larger than a certain position 4 conclusions an experiment was conducted in which a solid sphere with density of 2 64 1 0 3 kg m 3 and diameter of 25 4 mm was launched vertically upward in water toward the air water interface in the present study the submergence depth was varied and the launch velocity was adjusted so that the reynolds numbers of the spheres immediately after passing the air water interface were equal the effects of submergence depth on the sphere motion and the air water interface behavior were investigated the results are summarized as follows 1 the reynolds number immediately after the sphere passed through the air water interface was r e w 1 3000 at all submergence depths 2 the experimental values of the maximum displacement position were always smaller than the theoretical value due to the energy dispersion caused by the water droplets entrained around the sphere when the submergence depth is h d 3 the higher the submergence depth the smaller the rise of the sphere after passing through the air water interface however when the submergence depth is h d 3 the temporal changes in the vertical trajectory of the sphere are approximately the same 3 the energy ratio e p z 2 e k z 1 was defined as the ratio of the kinetic energy e k z 1 of the sphere immediately after the sphere passed through the air water interface and the potential energy e p z 2 when the sphere reached the maximum displacement position e p z 2 e k z 1 decreases when the submergence depth is h d 3 but is a constant value of e p z 2 e k z 1 0 57 0 05 when the submergence depth is h d 3 in addition when the submergence depth is h d 3 the ratio of each energy kinetic energy potential energy interfacial energy becomes similar immediately after passing through the water surface this suggests that each energy distribution has reached equilibrium state 4 three dimensions simulation where the air water interface is greatly deformed such as the water exit problem require enormous computational costs these findings obtained in this study suggests that the energy distribution of the water exit problem reaches a equilibrium state depending on the submergence depth this fact contributes to the determination of variable parameters in numerical modeling and helpful to simplification of 3d models and improvement of accuracy credit authorship contribution statement k takamure conceptualization data curation formal analysis investigation validation visualization writing original draft writing review editing t uchiyama methodology project administration resources supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
21829,this article explores the concepts of ocean wave multivariate multistep forecasting reconstruction and feature selection we introduce recurrent neural network frameworks integrated with bayesian hyperparameter optimization and elastic net methods we consider both short and long term forecasts and reconstruction for significant wave height and output power of the ocean waves sequence to sequence neural networks are being developed for the first time to reconstruct the missing characteristics of ocean waves based on information from nearby wave sensors for the case of significant wave height reconstruction we show the superiority of the proposed methods on a well studied dataset considering several error metrics we design a new case study based on measurement stations along the east coast of the united states and investigate the integration of feature selection concept into the presented models comparisons substantiate the benefit of utilizing elastic net moreover case study results indicate that when the number of features is considerable having deeper structures improves the performance keywords sequence to sequence deep networks multivariate multistep forecasting ocean wave feature selection spearmint bayesian optimization ocean energy flux forecasting 1 introduction the intricate and ever changing character of irregular ocean waves necessitates the existence of a framework to estimate wave features in advance bringing the energy generated by ocean waves into the consumer energy portfolio requires a consistent system capable of predicting ocean wave uncertainties most research on ocean wave prediction has focused on model based approaches for example physics based models ibarra berastegi et al 2015 that attempt to reproduce the frequency spectra of ocean waves and then to predict the resulting wave energy however these models are difficult to generalize the accuracy of a physics based model behavior in a general arbitrary system heavily depends on the physical conditions from which the method has been derived at the first place in wave ocean feature selection and prediction physical conditions such as the water depth steele and mettlach 1993 and the wind speed zheng et al 2019 may dramatically alter an ocean model parameter machine learning ml techniques allow model free predictions of ocean wave characteristics to become practical and computationally efficient via monitoring of the huge amount of records taken in diverse bodies of water all around the world we introduce recurrent networks integrated with bayesian optimization snoek et al 2012 and elastic net zou and hastie 2005 techniques to forecast future wave features and reconstruct missing data simultaneously there is a substantial literature on significant wave height swh forecasting see section 2 for a review these papers investigate short to long term predictions of swh at coastal and offshore sites with different water depths although there are marine applications solely based on swh estimation in most cases swh is used as an input to evaluate other characteristics of an ocean wave such as energy flux energy flux is the expected total sum of the wave energy available at a given location and it plays a major role in designing marine structures from at least two broad perspectives first by modeling the energy flux of any potential location one may identify remote locations where wave energy converters wec can be installed second renewable energy of all sorts is well known to be less reliable and less resilient against disruptions compared to energy produced by thermal power plants although wave energy is more predictable than wind or solar it still suffers from randomness having a concrete framework to forecast significant wave height and ocean energy flux may directly improve the resiliency of electricity produced by this green source statistical properties of the ocean surface suggest that for a given time and location ocean waves may be viewed as the summation of a considerable amount of independent regular waves caused by wind sources or wave interactions donelan et al 1985 therefore the ocean surface can be modeled as a zero mean gaussian stochastic process considering all these waves rychlik et al 1997 buoys that contain wave measurement sensors take a large number of samples from this process over time and then one may recover the spectral wave density s w which is the fast fourier transform of the covariance matrix of the sea surface elevation steele and mettlach 1993 once s w of a surface wave has been estimated from the measurements collected the spectral density momentum sdm of order r is calculated as 1 sdm r 0 w r s w d w by definition the significant wave height is the average height of the highest one third of all waves measured and given by h s 4 0 s w d w 4 sdm 0 1 2 in meters average wave period is defined as the average wave period seconds of all waves during the 20 minute period and given by a sdm 1 sdm 0 in seconds also known as t e the period of energy the energy flux of the deep water p is then calculated as follows cornejo bueno et al 2016 2 p ρ g 2 4 π 0 s w w d w ρ g 2 64 π h s 2 a where ρ is the ocean density 1025 kg m 3 and g is the gravity constant 9 81 m 2 s which results in p 0 485 h s 2 a kw m 1 1 one may rewrite the energy flux formula considering the mean period t m sdm 0 sdm 1 or the zero crossing period t z sdm 0 sdm 2 we propose a model that uses neural networks nn to forecast wave characteristics most studies such as deo et al 2001 that have used nns to forecast or reconstruct wave characteristics use fully connected networks receiving inputs such as significant wave height h s and or average wave period a and outputs such as power p and or h s recurrent neural networks rnn lipton et al 2015 which contain natural temporal properties have been considered in a few cases as well the majority of these cases solely focus on predicting h s to the best of our knowledge no studies have used sequence to sequence nns to predict energy flux or reconstruct features in this paper we investigate the concept of multi step ahead univariate for the case of predicting h s and multivariate for the case of predicting p forecasting and feature reconstruction we aim to report predictions up to 48 steps into the unknown our contributions are as follows to do the forecasting we introduce two main networks the first one is a simple long short term memory including fully connected layers at the end lstm the lstm part can be single or multi layered structures the second network is a sequence to sequence seqtoseq sutskever et al 2014 method containing two lstms as its encoder and decoder we expand the framework to tackle the problem of reconstructing missing ocean wave data and feature selection based on information from their nearby buoys we perform a detailed comparison between our models and the state of the art papers on wave feature reconstruction cornejo bueno et al 2016 2018 and demonstrate that our approach outperforms those in the literature in terms of capturing missing h s information we modify an epoch scheduled training scheme that is suitable for time series analysis in general as well as an elastic net concept and we train the models based on these proposed schemes a comparison between single and multi layered rnn lstm and seqtoseq methods is conducted we conduct spearmint bayesian optimization gp ei to hypertune the models parameters throughout the paper we indicate the i th parameter that must be tuned as i we design a case study from the sensor measurements located at east coast of the united states the dataset is general and can be used for any feature selection and or multivariate regression purposes 2 2 data can be found at github repository https github com mamadpierre noaa refined stations the remainder of this paper is structured as follows in section 2 we discuss the necessary background on ocean waves and we provide a concise literature review then we introduce the lstm and seqtoseq models and epoch schedule training in section 3 section 4 is dedicated to several comparisons including long term forecasts the reconstruction framework is addressed in section 5 in section 6 we discuss feature selection with the elastic net technique the paper concludes in section 7 2 literature review first we provide a concise review of the literature about forecasting ocean wave characteristics second we explore the novel work on oceanic wave feature hindcasting and reconstruction third we discuss seqtoseq models from a machine learning point of view 2 1 ocean characteristic forecasting wave forecasting models can be categorized into model based and model free frameworks model based approaches aim to use physical concepts such as climatic pressure frictional dissipation and environmental interactions to find precise equations mimicking the behavior of wind waves these methods are further classified based on their efforts to explicitly parameterize ocean wave interactions tolman 1991 into first second and third generations first generation models try to construct the spectral wave structure solely based on the linear wave interactions these models overestimate the power generated by water because of linear simplification and instead ignore any nonlinear transfer the wamdi group 1988 second generation models such as jonswap hasselmann et al 1973 examine coupled discrete spectral structures in such a way that the wave nonlinearities can be parameterized perrie et al 1989 the most mature models are third generation wave models such as wam simulating waves nearshore swan booij et al 1999 and wavewatch iii by tolman et al 2009 which consider all possible generation dissipation and nonlinear wave wave interactions the wamdi group 1988 along with current wave interactions tolman 1991 in contrast data driven model free approaches have become more popular recently with the advent of ml techniques fuzzy systems fs hashim et al 2016 evolutionary algorithms ea cornejo bueno et al 2016 support vector machines svm mahjoobi and mosabbeb 2009 and deep neural networks abhigna et al 2017 are so called soft computing techniques which focus on the data structure in order to investigate possible relations and dependencies to forecast uncertain future events neural networks are among the most powerful tools to approximate almost any nonlinear and complex functional relation recurrent neural networks rnns a subclass of neural networks exploit their internal memories to express temporal dynamic behavior which makes them a suitable framework for forecasting complex systems malekmohamadi et al 2011 explore the efficacy of several ml methods in terms of their accuracy in forecasting the significant wave height the general goal of any forecasting method is to find an accurate short or long term forecast of the variable under study azencott et al 2019 however there exist ml approaches particularly designed for forecasting wave characteristics for more thorough discussion of the literature on ocean power and significant wave height forecasting one may refer to the review paper lehmann et al 2017 a nonlinear autoregressive nar neural network is presented by hatalis et al 2014 to forecast exponentially smoothed ocean wave power using irish marine institute data a minimal resource allocation network mran and a growing and pruning radial basis function gap rbf network are implemented and tested on three geographical locations by savitha et al 2017 the significance of a node in the gap rbf network is measured as its contribution to the network output and the node is added or pruned accordingly cascade forward and feed forward neural networks are implemented in mahmoodi et al 2017 to predict the wave power itself in the absence of spectral wave data an ensemble of extreme learning machines elm is presented in kumar et al 2017 to predict the daily wave height the authors use the previous hours wave heights along with features such as air to sea temperature difference atmospheric pressure and wind speed to predict the next 6 hour wave height two computationally efficient supervised ml approaches are introduced by james et al 2017 and compared with the swan model team 2014 an integrated numerical and ann approach is introduced by londhe et al 2016 to predict waves 24 h in advance at different buoys along the indian coastline nonlinear and non stationary significant wave heights are studied in duan et al 2016 based on integrated empirical model decomposition support vector regression emd svr forecasting of extreme events such as hurricanes is examined by dixit and londhe 2016 via a neuro wavelet technique nwt the authors introduce separate neural networks for different decomposition which results in powerful forecasting tool a recent work prahlada and deka 2015 aims at predicting h s 48 h into the future utilizing a hybrid model combining neural network with wavelets wlnn as mentioned before none of these works take into consideration sequence to sequence networks to investigate their short to long term forecasting performance as we do let alone their combination with spearmint bayesian optimization and the elastic net techniques 2 2 hindcasting of ocean characteristics in contrast to forecasting frameworks in which the goal is typically to estimate wave features such as h s and p in the future based on historical data reconstruction models aim to use available information about wave features to reconstruct h s p or other usually missing features here the assumption is that the model has access to up to date measurements of the wave features except for the one s they want to reconstruct this is commonly due to missing measurement data therefore the prediction continues one step ahead or a few steps ahead into the future hence the aim is to tackle the problem of extracting the ocean wave information of a location purely based on other available features the framework is useful for estimating the missing data of a station using the knowledge obtained from its neighbors but any available information of the same station can be utilized as well missing significant wave heights are reconstructed londhe and panchang 2007 londhe 2008 by using artificial neural networks the hindcasting is conducted by 3 layered feedforward neural network cornejo bueno et al 2016 in their first paper and its subsequent improvement cornejo bueno et al 2018 reconstruct ocean waves based on evolutionary algorithms ea the authors address the problem primarily via a grouping genetic algorithm gga and bayesian optimization grouping genetic algorithm bo gga they utilize gga and or bo gga to select the wave features of nearby stations suitable to predict the desired wave feature of the location with missing data and then obtain their predictions via simple elm or svm the paper reconstructs the significant wave height of noaa buoy 46069 for the year 2010 solely based upon the information provided from two adjacent buoys 2 3 sequence to sequence neural networks deep neural networks lecun et al 2015 dnn are among the most successful tools for classification and regression although a simple feed forward dnn can be applied in many systems they require the system to have fixed input and output size recurrent neural networks such as long short term memory lstm networks tackle this limitation in the sense that they do not need a fixed input size hochreiter and schmidhuber 1997 lstms can observe an input sequence of arbitrary size sequentially one time step at a time to provide the rest of the network with a large fixed sized vector representing the input lipton et al 2015 mobiny and najarian 2018 furthermore lstms remember long range feature propagation based on a sigmoid layer called forget gate seqtoseq models use two separate recurrent structures they differ from basic recurrent networks in the sense that the network fully reads the input sequences before it generates any outputs the first network is usually an lstm which reads encodes the input of any size and maps them to a fixed sized output the second structure generally receives the fixed sized output vector of the first lstm and maps decodes them to a desirable output space sutskever et al 2014 having encoding and decoding as separate steps gives the model flexibility and stability when handling complex sequence structures chiu et al 2017 an important technique for training recurrent networks is teacher forcing tf williams and zipser 1989 which forces the network to observe the previous ground truth output instead of the one it already predicted in other words tf keeping the complex network structure converts any long term prediction structures to one step ahead forecasts this can greatly increase the network s ability to learn thereby reducing its learning time williams and zipser 1989 lamb et al 2016 on the other hand one can argue that the new model is not solving the same problem anymore therefore there often exists a large gap between the testing error and training error for the models trained by tf that is the model encounters a major overfitting problem hence bengio et al 2015 introduces a modification of scheduled training that captures the benefit of tf while avoiding overfitting scheduled training is a soft technique that is it starts with a tf scheme and after the model passes the warm up stage and the network s weights have gone in the correct update direction it alters the original network with a specified scheme therefore the model enjoys stability and the probability of overfitting decreases in our work we revisit scheduled training and introduce epoch scheduled training for forecasting 3 the models 3 1 overview in this section we discuss the proposed models we denote an input sequence to the model as x 1 x t and its output sequence as y 1 y t where t and t need not be equal in the case of predicting p we have x t h s t a t and y t p t the purpose of the models is to calculate the conditional distribution p y 1 y t x 1 x t t indicates how far into the future the forecast should go for example for hourly resolution data if the model is a day ahead energy flux forecast then t 24 t on the other hand is a model parameter and must be tuned 1 3 3 recall that we use i to denote the i th tunable parameter t can be interpreted as the number of recurrent loops in the structure seqtoseq structures contain two independent recurrent networks encoder and decoder we use the lstm network as an encoder consisting of input i cell state s output o and forget f gates nodes gers et al 1999 the standard lstm equations lipton et al 2015 hochreiter and schmidhuber 1997 are provided in appendix a 1 in energy flux forecasting d 2 and h refers to the hidden vector size which needs to be tuned 2 the purpose of the encoder is to find a representation of the x 1 x t sequence as a fixed sized vector v for the lstm network we create a single fully connected layer that receives a fixed sized vector v as its input and outputs y t p t for the seqtoseq network we have another recurrent network as the decoder the decoder considers vector v as its input and the last encoder hidden state h t as its initial hidden state h t 0 and runs a similar recurrent construction to decode the output sequence we omit the equations as they are similar to those above furthermore we let the decoder update its weight parameters independently in other words the encoder and decoder do not share parameters this doubles the number of parameters to be tuned and multiplies the training time by a constant but we allow this in the hope of achieving better performance the decoder operates a static recurrent structure rather than a dynamic one that is the decoder creates an unrolled computational graph of fixed length due to the fixed sized input vector v in addition both encoder and decoder can be deep structures that is the number of stacked lstm layers 3 for each of them can vary the seqtoseq model attempts to find the output sequence distribution as follows 3 p y 1 y t x 1 x t w p y 1 y t v w 4 p y 1 v w t 1 t p y t 1 v l y 1 y t w where w represents all the model weights to be tuned and l is a binary indicator representing whether the model sees the actual previous measurements or their predictions the first equality 3 relies on the encoder and emphasizes once again that the model encodes the whole input x 1 x t into the vector v before starting to decode and drops the input thereafter the concept of multiplying conditional probabilities in the second equality 4 comes from the recurrent structure of the decoder in other words based on the trained weights and the vector v the model tries to forecast the first token element of the output sequence in general at time step t 1 the model has access to l y 1 y t of the output sequence in the tf strategy williams and zipser 1989 lamb et al 2016 the model has access to the actual true outputs at training time i e l y 1 y t y 1 y t and then to the predicted ones i e l y 1 y t y ˆ 1 y ˆ t at testing time in the scheduled strategy however one may flip a coin bengio et al 2015 with probability ϵ t for all t 1 t 1 to decide whether to use the actual output with probability ϵ t or its prediction by the model itself with probability 1 ϵ t for instance the probability of having all true outputs y 1 y t during training is ϵ 1 ϵ 2 ϵ t this scheme has been introduced for machine translation mt tasks where the number of possible output tokens is as large as the dictionary size furthermore in the mt framework the model faces embedded input and sequence in contrast in a forecasting framework each output token belongs to r therefore using ϵ t for each token t may result in a combination of true outputs along with predicted ones which is not particularly useful instead we flip a coin at the beginning of each epoch and stick to the plan for the entire epoch so from now on we denote the sequence as ϵ e p where e p is the training epoch number intuitively the sequence ϵ e p should be decreasing which encourages the model to use the predicted output towards the end of the training linear exponential and inverse sigmoid decay sequences are introduced by bengio et al 2015 we modify the inverse sigmoid decay to use for epoch scheduled training as follows ϵ e p k k e e p k where k is a parameter to tune 4 increasing k increases the probability of receiving true values for example for a training scheme of size 20 epochs k 20 means that we receive the true outputs with at least 0 86 probability hence in the tuning process we compare the magnitude of k with the number of epochs 4 4 however we manually force the model to use the predicted values for the last two epochs fig 1 illustrates a schematic of the epoch scheduled training sequence to sequence network an expanded view of a single lstm cell structure is presented in fig 8 of appendix a 1 hidden and state cells propagate through the encoder and decoder networks in fig 1 ϵ e p expresses the probability that a given decoder cell sees the actual outputs where e p index iterates over all epochs 3 2 loss function optimizer and error metrics we use mean squared error mse plus a 2 norm regularizer as the loss function for the whole network 5 mse 1 n i 1 n y i y ˆ i 2 where n is the size of the measurements and y ˆ i is a vector of size t representing the model s prediction of y i which is the actual power output the data however is chopped up and fed via mini batches the size of which is tunable 5 as a power of 2 which is a common practice in optimization algorithms regardless of the algorithm used mse is clearly convex with respect to y ˆ i but we do not have direct control over y ˆ i instead y ˆ i n x i w where n is the seqtoseq network structure and x i is the i th network input the loss function is generally non convex with respect to w which justifies our use of a 2 norm regularizer nie et al 2010 liu et al 2009 hence a term λ w 2 2 is added to the loss function where w is a vector that stacks all the trainable parameters within the weight matrices and λ 6 is a regularization parameter to be tuned therefore the loss function equals f w x 1 n i 1 n y i n x i w 2 λ w 2 2 through backpropagation we calculate the gradient of the loss function and update the weights via a first order optimization algorithm we consider four different optimization algorithms to compare their performance on real measurement ocean data stochastic gradient descent robbins and monro 1951 sgd root mean square prop tieleman and hinton 2012 rmsprop adaptive moment estimation adam kingma and ba 2014 and its improvement amsgrad reddi et al 2018 for details on these schemes visit appendix a 2 in the following section we first compare the efficiency of the sgd rmsprop adam and amsgrad algorithms and then optimize the energy flux forecasting model mostly with adam and amsgrad in this study we consider root mean square error rmse huber pearson correlation coefficient cc and mean arctangent absolute percentage error maape as error metrics to look at their definitions see appendix a 3 3 3 data satellite altimeters and buoy measurements are the two most common sources of data for wave feature forecasting cuadra et al 2016 in this study we primarily use buoy measurements from the national oceanic and atmospheric administration noaa each buoy provides measurements of significant wave height wind speed wind direction average wave period a sea level pressure gust speed air temperature and sea surface temperature at resolutions of 10 min to 1 h the national data buoy center ndbc maintains three major data sets consisting of moored buoys drifting buoys and coastal marine automated network c man stations which are located alongside u s coastal structures along with other air and water features they monitor wave energy spectra from which h s and a can be obtained via eq 1 each site has an identifier id ids are in the form of five digits except for c man stations which have alphanumeric ids the first two digits are assigned to a continental region and the last three indicate a specific location for instance 41001 41002 and 41004 are atlantic ocean sites near the southeastern u s the sites typically have hourly resolution which produces 8760 h s and a data points per year the data sets use 99 00 to indicate missing measurements some sites however aimed to report 10 minute resolution data in 2017 for instance among the above mentioned stations 41002 continues to provide hourly data while 41001 and 41004 try to provide 10 minute resolution data but for the most part their data is still hourly with the non hourly values filled by 99 00 quite a few refined stations have been collected for this study we consider a buoy to be a refined station when it is active and has a year with at least 1000 meaningful data points approximately 11 4 we calculate energy flux p via equation 2 for the datasets that remain after this process table 1 displays the buoys investigated in this research along with some information about them the locations are chosen from nearshore south pacific ocean the gulf of mexico and the north atlantic ocean where the water depths range from approximately 100 m to 5 km we divided the data into 3 parts 60 for training 20 for hyperparameter tuning and 20 for testing unless we are comparing with alternative approaches and they used another division the model has no access to the testing data in any manner table 1 indicates the training and testing data sizes as well the validation tuning data set is similar to testing hence we did not show it we argue that some of the studies in the literature are insufficient from a data point of view in two broad senses first for papers that use real buoy measurements there is usually extensive data manipulation and preprocessing sometimes the proposed models see only subsamples of measurements in order to produce smaller forecasting metric errors for example kumar et al 2018 choose a subsample of 50 daily points out of 8 months of data jan 1 aug 30 2015 and report root mean squared error rmse as an error measurement metric not only is this metric scale dependent and can be changed by shrinking the data size but this selection of points can break the temporal notion of the data as well therefore it has a direct effect on the nonlinear functional relation that we aim to predict moreover hatalis et al 2014 produce the data using the power matrix method hence the accuracy of the method heavily depends on the accuracy of the data producing procedure in our study after selecting a buoy we do not conduct any data manipulation or preprocessing other than cleaning not a number nan values from the noaa data otherwise the input to the model is the raw data collected from noaa see https www ndbc noaa gov wave shtml to see how spectral wave data are derived from buoy motion measurements 3 4 hyperparameter tuning in previous sections we identified tunable parameters i i 1 2 7 here we use spearmint bayesian optimization snoek et al 2012 as a tuning tool the algorithm is capable of handling integer parameters as in our case swersky et al 2013 the algorithm treats the seqtoseq forecasting model as a random black box function and places a gaussian process gp prior over it after collecting function evaluations it extracts posterior information based on the expected improvement ei observed hence gp ei optchooser with monte carlo approximation is selected which tells spearmint which of the candidates to execute next the values of each parameter that we consider are listed in table 2 spearmint only has access to the validation dataset and the model that has already been trained on the training dataset any hyperparameter tuning algorithm such as spearmint can have its own objective function that is spearmint s objective function during validation can be separate from the seqtoseq model s during training which recall is mse plus a 2 norm regularizer therefore the model enjoys mse plus 2 norm regularization convergence properties in training while also using maape scale independency and upper bound π 2 during the tuning process fig 2 illustrates the process of using spearmint for hyperparameter tuning we call the number of function evaluations the algorithm budget 4 experimental results in this section we first report on the model s performance utilizing several optimization algorithms and compare them to those of standard neural networks on buoy measurements next we demonstrate the performance of our model for long term forecasting 48 steps ahead of h s finally we tackle the problem of constructing wave characteristics such as h s for unknown locations based on information from known locations we wrote the code for our method and its alternatives in python 3 6 using the tensorflow package running on a geforce 1050 gtx gpu except the code for hyperparameter tuning via spearmint whose most stable version for our framework is written in python 2 7 4 1 comparison of optimization algorithms in this section we conduct optimization algorithms comparison to find the most robust scheme for our framework in order to continue with this regime for more complex tasks in following sections and to further suggest this scheme for wave energy optimization tasks we aim to compare the effectiveness of the sgd robbins and monro 1951 rmsprop tieleman and hinton 2012 adam kingma and ba 2014 and amsgrad reddi et al 2018 optimization schemes therefore for this experiment we consider only one step ahead naive forecasting of the ocean wave energy flux at four of the refined buoy locations 41049 42056 41060 and 32012 another reason for this section comparison is to realize more interpretable and suitable metric errors hence we report all five error metrics introduced earlier and present an argument about their results interpretability fig 3 displays the algorithm test errors versus the number of training epochs for the cases of rmse and huber losses the values on the y axis do not carry a clear meaning in other words we only hope to reach the smallest possible values for these two loss functions but the actual values do not tell us much one can observe that even at the end of the training epochs rmse and huber losses are not negligible note that the error we experience during the calculation of p is of the third power of the error we encounter forecasting h s a similar difference has been pointed out by cornejo bueno et al 2018 moreover rmse and huber are both scale dependent and the test sets include years of data which may result in errors piling up over time in contrast mape and maape are scale independent and therefore their values have more intuitive meaning in addition their behavior is similar to each other considering that maape values are consistently lower than those of mape therefore we mainly focus on mape and maape for subsequent experiments sgd and in a few cases amsgrad require more epochs to reach their best test accuracy while adam usually reaches its peak faster rmsprop and adam perform similarly with adam experiencing a marginal lead amsgrad and adam exhibit excellent performance in terms of rmse error we used a learning rate of α 0 001 with a decay of 0 9 for all the algorithms this is to make the algorithms more stable otherwise having a fixed learning rate would cause most algorithms especially sgd to encounter drastic changes towards the end of the optimization process huber losses are the most challenging loss functions to deal with one can see sizable fluctuations even near the end of the training for stations 41049 and 32012 sgd shows inferiority in terms of test error however based on its simple update it enjoys the best results in terms of time needed for training the algorithms sgd is especially sensitive with respect to its parameters adam however expresses stability and is among the first algorithms to converge to its best result usually within its first 10 training epochs although rmsprop performs particularly well for station 42056 there are cases where the algorithm cannot reach the desired test error based on these results from now on we use either adam or amsgrad as the optimizer 4 2 network comparison in this section we conduct an experiment to evaluate the performance of different neural network structures on the performance of the algorithm we compare single multi layered rnn single multi layered lstm and epoch scheduled seqtoseq model with adam and amsgrad optimization algorithms rnn and lstm networks contain a fully connected last layer we consider seqtoseq model with both adam and amsgrad optimization algorithms tables 3 and 4 demonstrate the performance of these neural network structures for 5 and 10 step ahead forecasting of energy flux over data gathered from 5 refined buoys collected from table 1 using mape and maape as the error metrics to evaluate the networks fairly during hyperparameter tuning we used the same budget in spearmint for each network we set this budget equal to 100 function evaluations one may argue that this experimental design favors the alternate i e non seqtoseq networks because they have many fewer hyperparameters to tune whereas for the seqtoseq framework spearmint must extract information from a more complex function but is only allowed the same number of function evaluations the multi layered networks consist of four layers the first three layers are recurrent of structure time steps time steps hidden size with rectified linear unit relu activation functions and the last layer is a fully connected one attaching the previous output to a layer containing the last node the training process is done with a budget of at most 15 epochs in other words if a structure reaches its best performance any time before the 15th epoch that would be collected the best parameters for epoch scheduled seqtoseq are 10 64 1 0 4 epochs 16 0 001 0 001 in the same order as shown in table 2 from table 3 one can see that the seqtoseq networks result in smaller mape and maape values but single layered lstm plus a fully connected last layer also performs very well we believe a fully connected last layer assists lstm and simple rnn networks in capturing all learned features and translating them into superior forecasting in addition multi layered structures are not superior to single layered ones this happens in the spearmint tuning process as well spearmint mostly prefers single or double layer structures for energy flux forecasting of any structures hence when we force the stacked layers to be four we can see a tiny reduction in the performance of the models moreover adam and amsgrad perform closely to each other and one cannot claim the superiority of either recall that for each buoy the error metrics are calculated for the test sets whose sizes are listed in table 1 for instance the test set size for buoy 46013 is 54980 meaning maape has been calculated for 54980 points in table 4 we can observe that when we move from 5 to 10 step ahead forecasting epoch scheduled seqtoseq fits the actual outputs even more accurately for instance at station 41048 seqtoseq provides a 0 308 0 217 0 217 41 9 improvement over the best alternative method in terms of mape for 5 step ahead forecasting whereas for 10 step ahead the improvement is 0 459 0 299 0 299 53 5 similarly for maape the 5 and 10 step improvements are 0 259 0 205 0 205 26 3 and 0 333 0 278 0 278 33 2 respectively these extra improvements may be a direct result of scheduled training managing deeper forecasting horizons 4 3 long term forecasting next we investigate 2 day ahead forecasting of h s as noted bydixit and londhe 2016 2 days can be considered an acceptable range for long term forecasting of h s table 5 presents 48 step ahead test error comparison over 5 refined buoys for h s forecasting using the seqtoseq model note the large gap between rmse and huber losses that the model experiences when it predicts energy flux compared to significant wave height the reason is the difference in the value range of output power and significant wave height p is on the order of 10 kw m while h s is usually on the order of 1 m hence we focus on maape the results indicate that the model is robust for long term prediction the values presented in table 5 are comparable to those for 5 and 10 step ahead predictions for p in section 4 2 further by definition the huber metric should behave robustly with regard to outliers the results support this fact and the model enjoys minimal huber loss values from the table it is clear that adam and amsgrad produce very similar errors therefore we conclude that one will not miss useful details by considering only the adam optimization algorithm hence in the last section we optimize the models using adam 5 reconstruction of significant wave height our framework on its surface is not designed to reconstruct missing measurements of a station based on information from other stations rather it uses historical data at the same station therefore to address this goal we modify the input of the neural networks in such a way that the models will no longer require historical data fig 4 illustrates three buoys 46069 46025 and 46042 that are close to one another for more details on the buoys see table 1 similar to existing methods cornejo bueno et al 2016 2018 we aim to reconstruct the significant wave height of buoy 46069 at different time steps treating them as missing data networks have access to all information from the two adjacent buoys 46025 and 46042 as their input as well as buoy 46069 s swh as their labels in the training process which consists of data from the entire year 2009 then the networks predict the entire 2010 year swh of buoy 46069 based on the inputs from the adjacent buoys in other words at time step t each model is allowed to see the first t measurements of h s at the two nearby buoys table 6 compares the performance of our seqtoseq and sl lstm networks with that of benchmark methods from the literature the methods are cornejo bueno et al 2016 2018 1 all featured extreme learning machine elm 2 all featured support vector regression svr 3 grouping genetic algorithm extreme learning machine with final prediction with elm gga elm elm 4 grouping genetic algorithm extreme learning machine with final prediction with svr gga elm svr 5 bayesian optimization grouping genetic algorithm extreme learning machine with final prediction of elm bo gga elm elm 6 bayesian optimization grouping genetic algorithm extreme learning machine with final prediction of svr bo gga elm svr and 7 a feedforward fully connected network londhe and panchang 2007 londhe 2008 the table reports the rmse mean absolute error mae and r 2 which is cc 2 as error metrics these are the metrics used in the benchmark papers note that cornejo bueno et al 2016 2018 uses buoys 46025 46042 and 46069 and claims that the noaa dataset has no missing measurements for these buoys in the years 2009 10 however we found this to be untrue first there are significant gaps in the 46069 station data which result in fewer than 5000 data points instead of the 8760 hourly points that should be present in a given year second like the other refined stations roughly 1 2 of the h s values contain 99 00 which indicates missing data therefore we carefully cleaned the missing data points from all three stations in such a way as to preserve the position of each time step that is if there is a missing point in a station measurement we exclude that time step from all stations the resulting data set has 9263 data points for each buoy where 4687 points are for training 2009 and 4576 are for testing 2010 we consider a three layered neural network similar but not identical to londhe and panchang 2007 londhe 2008 as an alternative method we optimize the three layered network with sgd and use relu activation instead of levenberg marquardt optimization algorithm and log sigmoid activation which have been used in the original papers as can be seen in table 6 the simple feedforward three layered network performs better than some of the alternatives such as all features elm and all features svr this emphasizes the fact that neural networks are very strong tools for the hindcasting procedure of the ocean wave characteristics one can also observe better performance from our proposed frameworks compared with the three layered network which justifies to a great extent the reason behind introducing the more advanced structure from the table it is clear that the performance of the seqtoseq network is very promising as it obtains the best r 2 values among the methods moreover lstm significantly outperforms all the alternatives and even the seqtoseq network in terms of rmse and mae simultaneously it is worth mentioning that both of our methods have access only to h s of the stations while the benchmark methods use more measurements for example the gaa methods obtain their best performance using wind speed significant wave height average wave period air temperature and the atmospheric pressure at buoy 46025 and the significant wave height and average wave period of buoy 46042 cornejo bueno et al 2016 this makes the superiority of our methods even clearer but brings about another question as well namely would using proper feature selection improve the performance of deep networks even further we conducted some preliminary experiments to answer this question considering combinations of the features that the gaa approaches use and found an inferior accuracy compared to solely using h s in section 6 we discuss a more efficient approach for feature selection fig 5 illustrates the performance of both the lstm and seqtoseq networks in reconstructing the significant wave height for buoy 46069 note that the models never saw the solid green line which is the year 2010 data i e the test data we also illustrate the rmse behavior of lstm and seqtoseq fig 6 displays the rmse test errors based on the number of training epochs up to 50 both networks reach their best performance around the tenth epoch with sequence to sequence reaching it slightly faster this happens even though there are more weights in the sequence to sequence model we argue that epoch scheduling training may be responsible for this quicker training performance because by definition it allows the network to see ground truth outputs to update the parameters better while simultaneously avoiding excessive overfitting 6 feature selection in this section we introduce a new case study considering measurement data collected from noaa sensors and modify the proposed framework to investigate feature selection via elastic net en zou and hastie 2005 methodology we alter the loss function to include two separate regularizers ℓ 1 norm and ℓ 2 norm as follows f w x 1 n i 1 n y i n x i w 2 λ 1 w 2 2 λ 2 w 1 where w 1 w w i and w is the set of all the network weights the ℓ 1 norm inherits a naturally sparse collection of variables w 1 has its minimum when all the weights are zero uncollected so every single nonzero weight should improve the first term of the objective function hence the model chooses only those weights for which the decrease in the first term outweighs the increase in the last term using only the ℓ 1 norm regularizer would result in instability among the multiple solutions because a tiny change in the parameters may change some weights from zero to nonzero values or vice versa ng 2004 therefore the ℓ 2 norm is used in the objective one important difference between our feature selection method and those used in the wave energy literature e g cornejo bueno et al 2018 is that the models in the literature either use all of the data related to a specific feature like h s from a nearby buoy or decide to ignore that feature entirely however our model allows us to partially utilize any of the features based on nonzero weights resulting in the optimal solution to investigate the performance of our proposed framework for feature collection we design a new experiment which has been recently explored for feature selection via ensemble structures as well pirhooshyaran et al 2020 fig 7 illustrates six stations 44007 44008 44009 44013 44014 and 44017 from the east coast of the united states to see their exact locations and water depths refer to table 1 we reconstruct the significant wave height and power output of buoy 44008 based on available features of the other nearby buoys we chose these buoys for two main reasons first on average they are rich in features with usable data second the resolution and the data collection times for these stations are the same up to 1 minute accuracy this is crucial when we want to reconstruct a feature of a buoy based on others we consider wind direction wdir wind speed wspd gust speed gst significant wave height wvht dominant wave period dpd average wave period apd direction of dominant period waves mwd sea level pressure pres air temperature atmp sea surface temperature wtmp and dewpoint temperature dewp the datasets are for the year 2018 we include all the features for all the buoys except dewp for buoys 44009 and 44013 because those data are unusable we exclude a measurement for all the stations only if a feature is missing in at least one of them in the end the dataset consists of 3422 measurements of 53 features we divide the dataset into train 60 validation 20 and test 20 we do not change the real measurements in any way in addition the methods never see the test set during training and validation in this experiment for both the lstm and seqtoseq networks we have one more parameter to tune namely the coefficient of the ℓ 1 during the validation table 7 compares the performance of all of the methods along with an alternative method random forest algorithm breiman 2001 for reconstructing both h s and p wave features there is a column dedicated to the percentage of non zero trainable variables we consider a single weight or bias variable to be non zero if its absolute value exceeds the threshold of 0 0001 and we report the result as the percentage of non zero variables among all trainable variables when we use the elastic net concept for selecting weights and biases we observe a significant drop in the non zero values this means exactly what we discussed at the beginning of this section the models invest only in those variables which are beneficial to the objective value here we report the best results found for each measurement error rmse huber and maape independently in other words the reported values of rmse huber or maape are not necessarily gathered from a single experiment but instead they are the best ones for the training epochs less than or equal to 50 as seen in table 7 en generally improves the performance of each method for instance en aids single layered lstm significantly for reconstructing h s and reduces rmse and huber losses by 29 and 54 respectively similarly it helps the seqtoseq network slightly and reduces the measurement errors by around 5 another interesting finding is the comparison between multi layered lstm and single layered ones unlike in predictions in section 4 2 here the performance of multi layered lstm is satisfactory and even superior in many cases therefore we argue that for feature selection when the number of features is considerable compared to forecasting having deeper structures improves the performance in addition we observe that networks with more variables such as multi layered lstm or seqtoseq retain more non zeros in particular in the process of tuning they choose the ℓ 1 coefficient to be smaller hence the effect of the ℓ 1 is lessened this may be due to the fact that the more advanced structures can find hidden relations among features and set their corresponding weights to non zero values whereas single layered models are unable to discover some hidden relations so they set the weights equal to zero the random forest is known to be very efficient and accurate in ranking the importance of variables in addition we already compared the method with svr and elm in previous section to have a fair comparison we hypertune its major parameters such as maximum depth for h s reconstruction it finds the best rmse and huber losses but for p reconstruction it fails to provide similar performance the seqtoseq en framework is the most robust and promising one it attains the best performance for half the measurements and is generally among the top methods for the rest we observe that λ i 0 001 0 01 i 1 2 results in the leading performance for the seqtoseq network 7 conclusion this paper focuses on the reconstruction feature selection and multivariate multistep forecasting of ocean wave characteristics based on real data obtained from noaa buoy measurements around the globe this paper is among the first to propose the use of sequence to sequence and other novel recurrent networks for these objectives moreover the epoch scheduled training concept has been introduced as a soft technique so that the model enjoys the consistency of teacher forcing methods while avoiding overfitting we tested various optimization algorithms on the networks that we introduced amsgrad and adam present robust and promising performance compared with sgd and rmsprop we compared several recurrent networks all of the parameters are tuned with spearmint bayesian optimization under the same budget one observes that spearmint favors single layered networks as opposed to multi layered networks for multivariate forecasting this can be observed in our numerical studies as well the sl lstm and seqtoseq models demonstrate superior performance compared to the other networks furthermore we explore the problem of reconstructing wave features which has been well studied in the literature the results suggest the superiority of our proposed networks compared to existing techniques our findings emphasize the fact that using only significant wave heights of adjacent buoys is sufficient to construct h s of a nearby station proper feature selection however necessitates more analysis we design a new experiment using noaa data from the east coast of the united states the dataset can be used for any feature selection and multivariate regression research we incorporated the elastic net concept into our proposed neural networks to handle 53 features of the dataset we evaluate the performance with and without the en and with the random forest algorithm the results indicate that the seqtoseq network has a consistent and reliable performance in addition for feature selection deeper recurrent structures are more promising compared to single layered ones we suggest the use of different parameter tuning algorithms such as derivative free optimization instead of spearmint as one promising future direction moreover utilizing other neural network techniques such as attention mechanism in particular for wave feature selection and reconstruction can be another area for future study credit authorship contribution statement mohammad pirhooshyaran conceptualization methodology software validation formal analysis data curation writing original draft visualization lawrence v snyder investigation resources writing review editing supervision project administration funding acquisition declaration of competing interest no author associated with this paper has disclosed any potential or pertinent conflicts which may be perceived to have impending conflict with this work for full disclosure statements refer to https doi org 10 1016 j oceaneng 2020 107424 acknowledgments this research was partially supported by the national science foundation nsf united states of america through the cybersees grant 1442858 the authors are responsible for the results presented in the paper these results have not been endorsed by the sponsoring agency appendices a 1 lstm network the standard lstm equations lipton et al 2015 hochreiter and schmidhuber 1997 for time step t are as follows 6 f t sigm w f x x t w f h h t 1 7 i t sigm w i x x t w i h h t 1 8 o t sigm w o x x t w o h h t 1 9 s t tanh w s x x t w s h h t 1 10 s t f t s t 1 i t s t 11 h t o t tanh s t where x t r d h t r h f t r h i t r h o t r h s t r h and s t r h for all t 1 t are the input hidden state forget activation input activation output activation cell state and auxiliary cell state vectors respectively for the lstm network w i j is the weight matrices corresponding to the dimensions of the gate vectors i and j the sigmoid function is given by sigm x 1 1 e x x r its return value is monotonically increasing in the open interval 0 1 the notation indicates element wise hadamard matrix product which exists only if the matrix dimensions are the same the weight matrices can be initialized randomly with a gaussian distribution further h 0 and s 0 are initialized by zero vectors the biases are omitted in the formulas because one may incorporate them easily through the weight matrices by adding one extra element to each vector mentioned a forget gate responds to the question which data should the model keep from the previous cell state vector in 6 the sigmoid function outputs a number between 0 and 1 which indicates the importance of the previous plus current inputs this value is directly multiplied with the cell state vector of the previous cell state in the first term of 9 the input gate 7 decides which new information should be collected the second term of 9 updates this new information the updated cell state vector is ready to go through the next part of the network furthermore the hidden state is merged into the cell state through 11 a 2 network weight updates by different algorithms stochastic gradient descent robbins and monro 1951 sgd directly updates w in the direction of the negative of the mini batches gradient in an iterative manner that is if b i is the i th mini batch then we have w i 1 w i α i w f w x where f w x 1 b i b i y i n x i w 2 λ w 2 2 and α i is the learning rate 7 at step i which needs to be tuned there exist several modifications of sgd such as root mean square prop rmsprop tieleman and hinton 2012 adaptive moment estimation adam kingma and ba 2014 has been successfully implemented as another first order method in adam the model s weight is updated as follows 12 w i 1 w i α i v ˆ i ϵ m ˆ i where 13 m ˆ i m i 1 β 1 i 14 v ˆ i v i 1 β 2 i 15 m i β 1 m i 1 1 β 1 w f w x 16 v i β 2 m i 1 1 β 2 w 2 f w x β 1 and β 2 are momentum like parameters and ϵ serves to reduce numerical issues adam aims to update each element of w with respect to its size adaptively it stores only an exponentially decaying average of past squared gradients the authors of kingma and ba 2014 propose β 1 0 9 β 2 0 99 and ϵ 1 e 8 to be efficient in some cases such as machine translation in which we are dealing with rnn structures similar to our forecasting context adam suffers from using exponential averaging over the past squared gradients amsgrad reddi et al 2018 has been proposed to tackle this issue by simply using the maximum of the past squared gradients iteratively in other words we update v ˆ i max v ˆ i 1 v i the schematic view of the lstm cell is shown in fig 8 a 3 error metrics we use the following forecasting error metrics root mean square error rmse is one of the most commonly used regression error metrics it equals the square root of the mse given in 5 and it provides a useful measure of forecasting quality the closer the rmse gets to 0 the better the fit the prediction gives in general it is difficult to choose an appropriate threshold such that the prediction is deemed accurate if the rmse is less than that threshold because the rmse is scale dependent and not robust to outliers the dimension of rmse is equal to the dimension of its under study variable in our case when we use rmse error for p and h s the reported errors are in m and kw m respectively huber loss given two sets of points y and y ˆ is defined as 17 h δ 1 n i 1 n l δ y i y ˆ i where 18 l δ y i y ˆ i 1 2 y i y ˆ i 2 for y i y ˆ i δ δ y i y ˆ i 1 2 δ 2 otherwise generally δ 1 is an acceptable threshold huber loss is scale dependent but is less sensitive to outliers than rmse is as one can realize the dimension of the huber loss can be equal to dimension of the y or its square pearson correlation coefficient cc is defined as 19 ρ y y ˆ cov y y ˆ σ y σ y ˆ where cov is covariance we have 1 c c 1 although cc captures linear similarities of its inputs very well several characteristics of nonlinear relations are ignored the correlation coefficient metric is dimensionless mean arctangent absolute percentage error maape kim and kim 2016 given two sets of points y and y ˆ is defined as 20 1 n i 1 n arctan y i y ˆ i y i maape is scale independent and unlike mape overcomes problematic cases as y i goes to zero for all i 1 n both mape and maape are dimensionless 
21829,this article explores the concepts of ocean wave multivariate multistep forecasting reconstruction and feature selection we introduce recurrent neural network frameworks integrated with bayesian hyperparameter optimization and elastic net methods we consider both short and long term forecasts and reconstruction for significant wave height and output power of the ocean waves sequence to sequence neural networks are being developed for the first time to reconstruct the missing characteristics of ocean waves based on information from nearby wave sensors for the case of significant wave height reconstruction we show the superiority of the proposed methods on a well studied dataset considering several error metrics we design a new case study based on measurement stations along the east coast of the united states and investigate the integration of feature selection concept into the presented models comparisons substantiate the benefit of utilizing elastic net moreover case study results indicate that when the number of features is considerable having deeper structures improves the performance keywords sequence to sequence deep networks multivariate multistep forecasting ocean wave feature selection spearmint bayesian optimization ocean energy flux forecasting 1 introduction the intricate and ever changing character of irregular ocean waves necessitates the existence of a framework to estimate wave features in advance bringing the energy generated by ocean waves into the consumer energy portfolio requires a consistent system capable of predicting ocean wave uncertainties most research on ocean wave prediction has focused on model based approaches for example physics based models ibarra berastegi et al 2015 that attempt to reproduce the frequency spectra of ocean waves and then to predict the resulting wave energy however these models are difficult to generalize the accuracy of a physics based model behavior in a general arbitrary system heavily depends on the physical conditions from which the method has been derived at the first place in wave ocean feature selection and prediction physical conditions such as the water depth steele and mettlach 1993 and the wind speed zheng et al 2019 may dramatically alter an ocean model parameter machine learning ml techniques allow model free predictions of ocean wave characteristics to become practical and computationally efficient via monitoring of the huge amount of records taken in diverse bodies of water all around the world we introduce recurrent networks integrated with bayesian optimization snoek et al 2012 and elastic net zou and hastie 2005 techniques to forecast future wave features and reconstruct missing data simultaneously there is a substantial literature on significant wave height swh forecasting see section 2 for a review these papers investigate short to long term predictions of swh at coastal and offshore sites with different water depths although there are marine applications solely based on swh estimation in most cases swh is used as an input to evaluate other characteristics of an ocean wave such as energy flux energy flux is the expected total sum of the wave energy available at a given location and it plays a major role in designing marine structures from at least two broad perspectives first by modeling the energy flux of any potential location one may identify remote locations where wave energy converters wec can be installed second renewable energy of all sorts is well known to be less reliable and less resilient against disruptions compared to energy produced by thermal power plants although wave energy is more predictable than wind or solar it still suffers from randomness having a concrete framework to forecast significant wave height and ocean energy flux may directly improve the resiliency of electricity produced by this green source statistical properties of the ocean surface suggest that for a given time and location ocean waves may be viewed as the summation of a considerable amount of independent regular waves caused by wind sources or wave interactions donelan et al 1985 therefore the ocean surface can be modeled as a zero mean gaussian stochastic process considering all these waves rychlik et al 1997 buoys that contain wave measurement sensors take a large number of samples from this process over time and then one may recover the spectral wave density s w which is the fast fourier transform of the covariance matrix of the sea surface elevation steele and mettlach 1993 once s w of a surface wave has been estimated from the measurements collected the spectral density momentum sdm of order r is calculated as 1 sdm r 0 w r s w d w by definition the significant wave height is the average height of the highest one third of all waves measured and given by h s 4 0 s w d w 4 sdm 0 1 2 in meters average wave period is defined as the average wave period seconds of all waves during the 20 minute period and given by a sdm 1 sdm 0 in seconds also known as t e the period of energy the energy flux of the deep water p is then calculated as follows cornejo bueno et al 2016 2 p ρ g 2 4 π 0 s w w d w ρ g 2 64 π h s 2 a where ρ is the ocean density 1025 kg m 3 and g is the gravity constant 9 81 m 2 s which results in p 0 485 h s 2 a kw m 1 1 one may rewrite the energy flux formula considering the mean period t m sdm 0 sdm 1 or the zero crossing period t z sdm 0 sdm 2 we propose a model that uses neural networks nn to forecast wave characteristics most studies such as deo et al 2001 that have used nns to forecast or reconstruct wave characteristics use fully connected networks receiving inputs such as significant wave height h s and or average wave period a and outputs such as power p and or h s recurrent neural networks rnn lipton et al 2015 which contain natural temporal properties have been considered in a few cases as well the majority of these cases solely focus on predicting h s to the best of our knowledge no studies have used sequence to sequence nns to predict energy flux or reconstruct features in this paper we investigate the concept of multi step ahead univariate for the case of predicting h s and multivariate for the case of predicting p forecasting and feature reconstruction we aim to report predictions up to 48 steps into the unknown our contributions are as follows to do the forecasting we introduce two main networks the first one is a simple long short term memory including fully connected layers at the end lstm the lstm part can be single or multi layered structures the second network is a sequence to sequence seqtoseq sutskever et al 2014 method containing two lstms as its encoder and decoder we expand the framework to tackle the problem of reconstructing missing ocean wave data and feature selection based on information from their nearby buoys we perform a detailed comparison between our models and the state of the art papers on wave feature reconstruction cornejo bueno et al 2016 2018 and demonstrate that our approach outperforms those in the literature in terms of capturing missing h s information we modify an epoch scheduled training scheme that is suitable for time series analysis in general as well as an elastic net concept and we train the models based on these proposed schemes a comparison between single and multi layered rnn lstm and seqtoseq methods is conducted we conduct spearmint bayesian optimization gp ei to hypertune the models parameters throughout the paper we indicate the i th parameter that must be tuned as i we design a case study from the sensor measurements located at east coast of the united states the dataset is general and can be used for any feature selection and or multivariate regression purposes 2 2 data can be found at github repository https github com mamadpierre noaa refined stations the remainder of this paper is structured as follows in section 2 we discuss the necessary background on ocean waves and we provide a concise literature review then we introduce the lstm and seqtoseq models and epoch schedule training in section 3 section 4 is dedicated to several comparisons including long term forecasts the reconstruction framework is addressed in section 5 in section 6 we discuss feature selection with the elastic net technique the paper concludes in section 7 2 literature review first we provide a concise review of the literature about forecasting ocean wave characteristics second we explore the novel work on oceanic wave feature hindcasting and reconstruction third we discuss seqtoseq models from a machine learning point of view 2 1 ocean characteristic forecasting wave forecasting models can be categorized into model based and model free frameworks model based approaches aim to use physical concepts such as climatic pressure frictional dissipation and environmental interactions to find precise equations mimicking the behavior of wind waves these methods are further classified based on their efforts to explicitly parameterize ocean wave interactions tolman 1991 into first second and third generations first generation models try to construct the spectral wave structure solely based on the linear wave interactions these models overestimate the power generated by water because of linear simplification and instead ignore any nonlinear transfer the wamdi group 1988 second generation models such as jonswap hasselmann et al 1973 examine coupled discrete spectral structures in such a way that the wave nonlinearities can be parameterized perrie et al 1989 the most mature models are third generation wave models such as wam simulating waves nearshore swan booij et al 1999 and wavewatch iii by tolman et al 2009 which consider all possible generation dissipation and nonlinear wave wave interactions the wamdi group 1988 along with current wave interactions tolman 1991 in contrast data driven model free approaches have become more popular recently with the advent of ml techniques fuzzy systems fs hashim et al 2016 evolutionary algorithms ea cornejo bueno et al 2016 support vector machines svm mahjoobi and mosabbeb 2009 and deep neural networks abhigna et al 2017 are so called soft computing techniques which focus on the data structure in order to investigate possible relations and dependencies to forecast uncertain future events neural networks are among the most powerful tools to approximate almost any nonlinear and complex functional relation recurrent neural networks rnns a subclass of neural networks exploit their internal memories to express temporal dynamic behavior which makes them a suitable framework for forecasting complex systems malekmohamadi et al 2011 explore the efficacy of several ml methods in terms of their accuracy in forecasting the significant wave height the general goal of any forecasting method is to find an accurate short or long term forecast of the variable under study azencott et al 2019 however there exist ml approaches particularly designed for forecasting wave characteristics for more thorough discussion of the literature on ocean power and significant wave height forecasting one may refer to the review paper lehmann et al 2017 a nonlinear autoregressive nar neural network is presented by hatalis et al 2014 to forecast exponentially smoothed ocean wave power using irish marine institute data a minimal resource allocation network mran and a growing and pruning radial basis function gap rbf network are implemented and tested on three geographical locations by savitha et al 2017 the significance of a node in the gap rbf network is measured as its contribution to the network output and the node is added or pruned accordingly cascade forward and feed forward neural networks are implemented in mahmoodi et al 2017 to predict the wave power itself in the absence of spectral wave data an ensemble of extreme learning machines elm is presented in kumar et al 2017 to predict the daily wave height the authors use the previous hours wave heights along with features such as air to sea temperature difference atmospheric pressure and wind speed to predict the next 6 hour wave height two computationally efficient supervised ml approaches are introduced by james et al 2017 and compared with the swan model team 2014 an integrated numerical and ann approach is introduced by londhe et al 2016 to predict waves 24 h in advance at different buoys along the indian coastline nonlinear and non stationary significant wave heights are studied in duan et al 2016 based on integrated empirical model decomposition support vector regression emd svr forecasting of extreme events such as hurricanes is examined by dixit and londhe 2016 via a neuro wavelet technique nwt the authors introduce separate neural networks for different decomposition which results in powerful forecasting tool a recent work prahlada and deka 2015 aims at predicting h s 48 h into the future utilizing a hybrid model combining neural network with wavelets wlnn as mentioned before none of these works take into consideration sequence to sequence networks to investigate their short to long term forecasting performance as we do let alone their combination with spearmint bayesian optimization and the elastic net techniques 2 2 hindcasting of ocean characteristics in contrast to forecasting frameworks in which the goal is typically to estimate wave features such as h s and p in the future based on historical data reconstruction models aim to use available information about wave features to reconstruct h s p or other usually missing features here the assumption is that the model has access to up to date measurements of the wave features except for the one s they want to reconstruct this is commonly due to missing measurement data therefore the prediction continues one step ahead or a few steps ahead into the future hence the aim is to tackle the problem of extracting the ocean wave information of a location purely based on other available features the framework is useful for estimating the missing data of a station using the knowledge obtained from its neighbors but any available information of the same station can be utilized as well missing significant wave heights are reconstructed londhe and panchang 2007 londhe 2008 by using artificial neural networks the hindcasting is conducted by 3 layered feedforward neural network cornejo bueno et al 2016 in their first paper and its subsequent improvement cornejo bueno et al 2018 reconstruct ocean waves based on evolutionary algorithms ea the authors address the problem primarily via a grouping genetic algorithm gga and bayesian optimization grouping genetic algorithm bo gga they utilize gga and or bo gga to select the wave features of nearby stations suitable to predict the desired wave feature of the location with missing data and then obtain their predictions via simple elm or svm the paper reconstructs the significant wave height of noaa buoy 46069 for the year 2010 solely based upon the information provided from two adjacent buoys 2 3 sequence to sequence neural networks deep neural networks lecun et al 2015 dnn are among the most successful tools for classification and regression although a simple feed forward dnn can be applied in many systems they require the system to have fixed input and output size recurrent neural networks such as long short term memory lstm networks tackle this limitation in the sense that they do not need a fixed input size hochreiter and schmidhuber 1997 lstms can observe an input sequence of arbitrary size sequentially one time step at a time to provide the rest of the network with a large fixed sized vector representing the input lipton et al 2015 mobiny and najarian 2018 furthermore lstms remember long range feature propagation based on a sigmoid layer called forget gate seqtoseq models use two separate recurrent structures they differ from basic recurrent networks in the sense that the network fully reads the input sequences before it generates any outputs the first network is usually an lstm which reads encodes the input of any size and maps them to a fixed sized output the second structure generally receives the fixed sized output vector of the first lstm and maps decodes them to a desirable output space sutskever et al 2014 having encoding and decoding as separate steps gives the model flexibility and stability when handling complex sequence structures chiu et al 2017 an important technique for training recurrent networks is teacher forcing tf williams and zipser 1989 which forces the network to observe the previous ground truth output instead of the one it already predicted in other words tf keeping the complex network structure converts any long term prediction structures to one step ahead forecasts this can greatly increase the network s ability to learn thereby reducing its learning time williams and zipser 1989 lamb et al 2016 on the other hand one can argue that the new model is not solving the same problem anymore therefore there often exists a large gap between the testing error and training error for the models trained by tf that is the model encounters a major overfitting problem hence bengio et al 2015 introduces a modification of scheduled training that captures the benefit of tf while avoiding overfitting scheduled training is a soft technique that is it starts with a tf scheme and after the model passes the warm up stage and the network s weights have gone in the correct update direction it alters the original network with a specified scheme therefore the model enjoys stability and the probability of overfitting decreases in our work we revisit scheduled training and introduce epoch scheduled training for forecasting 3 the models 3 1 overview in this section we discuss the proposed models we denote an input sequence to the model as x 1 x t and its output sequence as y 1 y t where t and t need not be equal in the case of predicting p we have x t h s t a t and y t p t the purpose of the models is to calculate the conditional distribution p y 1 y t x 1 x t t indicates how far into the future the forecast should go for example for hourly resolution data if the model is a day ahead energy flux forecast then t 24 t on the other hand is a model parameter and must be tuned 1 3 3 recall that we use i to denote the i th tunable parameter t can be interpreted as the number of recurrent loops in the structure seqtoseq structures contain two independent recurrent networks encoder and decoder we use the lstm network as an encoder consisting of input i cell state s output o and forget f gates nodes gers et al 1999 the standard lstm equations lipton et al 2015 hochreiter and schmidhuber 1997 are provided in appendix a 1 in energy flux forecasting d 2 and h refers to the hidden vector size which needs to be tuned 2 the purpose of the encoder is to find a representation of the x 1 x t sequence as a fixed sized vector v for the lstm network we create a single fully connected layer that receives a fixed sized vector v as its input and outputs y t p t for the seqtoseq network we have another recurrent network as the decoder the decoder considers vector v as its input and the last encoder hidden state h t as its initial hidden state h t 0 and runs a similar recurrent construction to decode the output sequence we omit the equations as they are similar to those above furthermore we let the decoder update its weight parameters independently in other words the encoder and decoder do not share parameters this doubles the number of parameters to be tuned and multiplies the training time by a constant but we allow this in the hope of achieving better performance the decoder operates a static recurrent structure rather than a dynamic one that is the decoder creates an unrolled computational graph of fixed length due to the fixed sized input vector v in addition both encoder and decoder can be deep structures that is the number of stacked lstm layers 3 for each of them can vary the seqtoseq model attempts to find the output sequence distribution as follows 3 p y 1 y t x 1 x t w p y 1 y t v w 4 p y 1 v w t 1 t p y t 1 v l y 1 y t w where w represents all the model weights to be tuned and l is a binary indicator representing whether the model sees the actual previous measurements or their predictions the first equality 3 relies on the encoder and emphasizes once again that the model encodes the whole input x 1 x t into the vector v before starting to decode and drops the input thereafter the concept of multiplying conditional probabilities in the second equality 4 comes from the recurrent structure of the decoder in other words based on the trained weights and the vector v the model tries to forecast the first token element of the output sequence in general at time step t 1 the model has access to l y 1 y t of the output sequence in the tf strategy williams and zipser 1989 lamb et al 2016 the model has access to the actual true outputs at training time i e l y 1 y t y 1 y t and then to the predicted ones i e l y 1 y t y ˆ 1 y ˆ t at testing time in the scheduled strategy however one may flip a coin bengio et al 2015 with probability ϵ t for all t 1 t 1 to decide whether to use the actual output with probability ϵ t or its prediction by the model itself with probability 1 ϵ t for instance the probability of having all true outputs y 1 y t during training is ϵ 1 ϵ 2 ϵ t this scheme has been introduced for machine translation mt tasks where the number of possible output tokens is as large as the dictionary size furthermore in the mt framework the model faces embedded input and sequence in contrast in a forecasting framework each output token belongs to r therefore using ϵ t for each token t may result in a combination of true outputs along with predicted ones which is not particularly useful instead we flip a coin at the beginning of each epoch and stick to the plan for the entire epoch so from now on we denote the sequence as ϵ e p where e p is the training epoch number intuitively the sequence ϵ e p should be decreasing which encourages the model to use the predicted output towards the end of the training linear exponential and inverse sigmoid decay sequences are introduced by bengio et al 2015 we modify the inverse sigmoid decay to use for epoch scheduled training as follows ϵ e p k k e e p k where k is a parameter to tune 4 increasing k increases the probability of receiving true values for example for a training scheme of size 20 epochs k 20 means that we receive the true outputs with at least 0 86 probability hence in the tuning process we compare the magnitude of k with the number of epochs 4 4 however we manually force the model to use the predicted values for the last two epochs fig 1 illustrates a schematic of the epoch scheduled training sequence to sequence network an expanded view of a single lstm cell structure is presented in fig 8 of appendix a 1 hidden and state cells propagate through the encoder and decoder networks in fig 1 ϵ e p expresses the probability that a given decoder cell sees the actual outputs where e p index iterates over all epochs 3 2 loss function optimizer and error metrics we use mean squared error mse plus a 2 norm regularizer as the loss function for the whole network 5 mse 1 n i 1 n y i y ˆ i 2 where n is the size of the measurements and y ˆ i is a vector of size t representing the model s prediction of y i which is the actual power output the data however is chopped up and fed via mini batches the size of which is tunable 5 as a power of 2 which is a common practice in optimization algorithms regardless of the algorithm used mse is clearly convex with respect to y ˆ i but we do not have direct control over y ˆ i instead y ˆ i n x i w where n is the seqtoseq network structure and x i is the i th network input the loss function is generally non convex with respect to w which justifies our use of a 2 norm regularizer nie et al 2010 liu et al 2009 hence a term λ w 2 2 is added to the loss function where w is a vector that stacks all the trainable parameters within the weight matrices and λ 6 is a regularization parameter to be tuned therefore the loss function equals f w x 1 n i 1 n y i n x i w 2 λ w 2 2 through backpropagation we calculate the gradient of the loss function and update the weights via a first order optimization algorithm we consider four different optimization algorithms to compare their performance on real measurement ocean data stochastic gradient descent robbins and monro 1951 sgd root mean square prop tieleman and hinton 2012 rmsprop adaptive moment estimation adam kingma and ba 2014 and its improvement amsgrad reddi et al 2018 for details on these schemes visit appendix a 2 in the following section we first compare the efficiency of the sgd rmsprop adam and amsgrad algorithms and then optimize the energy flux forecasting model mostly with adam and amsgrad in this study we consider root mean square error rmse huber pearson correlation coefficient cc and mean arctangent absolute percentage error maape as error metrics to look at their definitions see appendix a 3 3 3 data satellite altimeters and buoy measurements are the two most common sources of data for wave feature forecasting cuadra et al 2016 in this study we primarily use buoy measurements from the national oceanic and atmospheric administration noaa each buoy provides measurements of significant wave height wind speed wind direction average wave period a sea level pressure gust speed air temperature and sea surface temperature at resolutions of 10 min to 1 h the national data buoy center ndbc maintains three major data sets consisting of moored buoys drifting buoys and coastal marine automated network c man stations which are located alongside u s coastal structures along with other air and water features they monitor wave energy spectra from which h s and a can be obtained via eq 1 each site has an identifier id ids are in the form of five digits except for c man stations which have alphanumeric ids the first two digits are assigned to a continental region and the last three indicate a specific location for instance 41001 41002 and 41004 are atlantic ocean sites near the southeastern u s the sites typically have hourly resolution which produces 8760 h s and a data points per year the data sets use 99 00 to indicate missing measurements some sites however aimed to report 10 minute resolution data in 2017 for instance among the above mentioned stations 41002 continues to provide hourly data while 41001 and 41004 try to provide 10 minute resolution data but for the most part their data is still hourly with the non hourly values filled by 99 00 quite a few refined stations have been collected for this study we consider a buoy to be a refined station when it is active and has a year with at least 1000 meaningful data points approximately 11 4 we calculate energy flux p via equation 2 for the datasets that remain after this process table 1 displays the buoys investigated in this research along with some information about them the locations are chosen from nearshore south pacific ocean the gulf of mexico and the north atlantic ocean where the water depths range from approximately 100 m to 5 km we divided the data into 3 parts 60 for training 20 for hyperparameter tuning and 20 for testing unless we are comparing with alternative approaches and they used another division the model has no access to the testing data in any manner table 1 indicates the training and testing data sizes as well the validation tuning data set is similar to testing hence we did not show it we argue that some of the studies in the literature are insufficient from a data point of view in two broad senses first for papers that use real buoy measurements there is usually extensive data manipulation and preprocessing sometimes the proposed models see only subsamples of measurements in order to produce smaller forecasting metric errors for example kumar et al 2018 choose a subsample of 50 daily points out of 8 months of data jan 1 aug 30 2015 and report root mean squared error rmse as an error measurement metric not only is this metric scale dependent and can be changed by shrinking the data size but this selection of points can break the temporal notion of the data as well therefore it has a direct effect on the nonlinear functional relation that we aim to predict moreover hatalis et al 2014 produce the data using the power matrix method hence the accuracy of the method heavily depends on the accuracy of the data producing procedure in our study after selecting a buoy we do not conduct any data manipulation or preprocessing other than cleaning not a number nan values from the noaa data otherwise the input to the model is the raw data collected from noaa see https www ndbc noaa gov wave shtml to see how spectral wave data are derived from buoy motion measurements 3 4 hyperparameter tuning in previous sections we identified tunable parameters i i 1 2 7 here we use spearmint bayesian optimization snoek et al 2012 as a tuning tool the algorithm is capable of handling integer parameters as in our case swersky et al 2013 the algorithm treats the seqtoseq forecasting model as a random black box function and places a gaussian process gp prior over it after collecting function evaluations it extracts posterior information based on the expected improvement ei observed hence gp ei optchooser with monte carlo approximation is selected which tells spearmint which of the candidates to execute next the values of each parameter that we consider are listed in table 2 spearmint only has access to the validation dataset and the model that has already been trained on the training dataset any hyperparameter tuning algorithm such as spearmint can have its own objective function that is spearmint s objective function during validation can be separate from the seqtoseq model s during training which recall is mse plus a 2 norm regularizer therefore the model enjoys mse plus 2 norm regularization convergence properties in training while also using maape scale independency and upper bound π 2 during the tuning process fig 2 illustrates the process of using spearmint for hyperparameter tuning we call the number of function evaluations the algorithm budget 4 experimental results in this section we first report on the model s performance utilizing several optimization algorithms and compare them to those of standard neural networks on buoy measurements next we demonstrate the performance of our model for long term forecasting 48 steps ahead of h s finally we tackle the problem of constructing wave characteristics such as h s for unknown locations based on information from known locations we wrote the code for our method and its alternatives in python 3 6 using the tensorflow package running on a geforce 1050 gtx gpu except the code for hyperparameter tuning via spearmint whose most stable version for our framework is written in python 2 7 4 1 comparison of optimization algorithms in this section we conduct optimization algorithms comparison to find the most robust scheme for our framework in order to continue with this regime for more complex tasks in following sections and to further suggest this scheme for wave energy optimization tasks we aim to compare the effectiveness of the sgd robbins and monro 1951 rmsprop tieleman and hinton 2012 adam kingma and ba 2014 and amsgrad reddi et al 2018 optimization schemes therefore for this experiment we consider only one step ahead naive forecasting of the ocean wave energy flux at four of the refined buoy locations 41049 42056 41060 and 32012 another reason for this section comparison is to realize more interpretable and suitable metric errors hence we report all five error metrics introduced earlier and present an argument about their results interpretability fig 3 displays the algorithm test errors versus the number of training epochs for the cases of rmse and huber losses the values on the y axis do not carry a clear meaning in other words we only hope to reach the smallest possible values for these two loss functions but the actual values do not tell us much one can observe that even at the end of the training epochs rmse and huber losses are not negligible note that the error we experience during the calculation of p is of the third power of the error we encounter forecasting h s a similar difference has been pointed out by cornejo bueno et al 2018 moreover rmse and huber are both scale dependent and the test sets include years of data which may result in errors piling up over time in contrast mape and maape are scale independent and therefore their values have more intuitive meaning in addition their behavior is similar to each other considering that maape values are consistently lower than those of mape therefore we mainly focus on mape and maape for subsequent experiments sgd and in a few cases amsgrad require more epochs to reach their best test accuracy while adam usually reaches its peak faster rmsprop and adam perform similarly with adam experiencing a marginal lead amsgrad and adam exhibit excellent performance in terms of rmse error we used a learning rate of α 0 001 with a decay of 0 9 for all the algorithms this is to make the algorithms more stable otherwise having a fixed learning rate would cause most algorithms especially sgd to encounter drastic changes towards the end of the optimization process huber losses are the most challenging loss functions to deal with one can see sizable fluctuations even near the end of the training for stations 41049 and 32012 sgd shows inferiority in terms of test error however based on its simple update it enjoys the best results in terms of time needed for training the algorithms sgd is especially sensitive with respect to its parameters adam however expresses stability and is among the first algorithms to converge to its best result usually within its first 10 training epochs although rmsprop performs particularly well for station 42056 there are cases where the algorithm cannot reach the desired test error based on these results from now on we use either adam or amsgrad as the optimizer 4 2 network comparison in this section we conduct an experiment to evaluate the performance of different neural network structures on the performance of the algorithm we compare single multi layered rnn single multi layered lstm and epoch scheduled seqtoseq model with adam and amsgrad optimization algorithms rnn and lstm networks contain a fully connected last layer we consider seqtoseq model with both adam and amsgrad optimization algorithms tables 3 and 4 demonstrate the performance of these neural network structures for 5 and 10 step ahead forecasting of energy flux over data gathered from 5 refined buoys collected from table 1 using mape and maape as the error metrics to evaluate the networks fairly during hyperparameter tuning we used the same budget in spearmint for each network we set this budget equal to 100 function evaluations one may argue that this experimental design favors the alternate i e non seqtoseq networks because they have many fewer hyperparameters to tune whereas for the seqtoseq framework spearmint must extract information from a more complex function but is only allowed the same number of function evaluations the multi layered networks consist of four layers the first three layers are recurrent of structure time steps time steps hidden size with rectified linear unit relu activation functions and the last layer is a fully connected one attaching the previous output to a layer containing the last node the training process is done with a budget of at most 15 epochs in other words if a structure reaches its best performance any time before the 15th epoch that would be collected the best parameters for epoch scheduled seqtoseq are 10 64 1 0 4 epochs 16 0 001 0 001 in the same order as shown in table 2 from table 3 one can see that the seqtoseq networks result in smaller mape and maape values but single layered lstm plus a fully connected last layer also performs very well we believe a fully connected last layer assists lstm and simple rnn networks in capturing all learned features and translating them into superior forecasting in addition multi layered structures are not superior to single layered ones this happens in the spearmint tuning process as well spearmint mostly prefers single or double layer structures for energy flux forecasting of any structures hence when we force the stacked layers to be four we can see a tiny reduction in the performance of the models moreover adam and amsgrad perform closely to each other and one cannot claim the superiority of either recall that for each buoy the error metrics are calculated for the test sets whose sizes are listed in table 1 for instance the test set size for buoy 46013 is 54980 meaning maape has been calculated for 54980 points in table 4 we can observe that when we move from 5 to 10 step ahead forecasting epoch scheduled seqtoseq fits the actual outputs even more accurately for instance at station 41048 seqtoseq provides a 0 308 0 217 0 217 41 9 improvement over the best alternative method in terms of mape for 5 step ahead forecasting whereas for 10 step ahead the improvement is 0 459 0 299 0 299 53 5 similarly for maape the 5 and 10 step improvements are 0 259 0 205 0 205 26 3 and 0 333 0 278 0 278 33 2 respectively these extra improvements may be a direct result of scheduled training managing deeper forecasting horizons 4 3 long term forecasting next we investigate 2 day ahead forecasting of h s as noted bydixit and londhe 2016 2 days can be considered an acceptable range for long term forecasting of h s table 5 presents 48 step ahead test error comparison over 5 refined buoys for h s forecasting using the seqtoseq model note the large gap between rmse and huber losses that the model experiences when it predicts energy flux compared to significant wave height the reason is the difference in the value range of output power and significant wave height p is on the order of 10 kw m while h s is usually on the order of 1 m hence we focus on maape the results indicate that the model is robust for long term prediction the values presented in table 5 are comparable to those for 5 and 10 step ahead predictions for p in section 4 2 further by definition the huber metric should behave robustly with regard to outliers the results support this fact and the model enjoys minimal huber loss values from the table it is clear that adam and amsgrad produce very similar errors therefore we conclude that one will not miss useful details by considering only the adam optimization algorithm hence in the last section we optimize the models using adam 5 reconstruction of significant wave height our framework on its surface is not designed to reconstruct missing measurements of a station based on information from other stations rather it uses historical data at the same station therefore to address this goal we modify the input of the neural networks in such a way that the models will no longer require historical data fig 4 illustrates three buoys 46069 46025 and 46042 that are close to one another for more details on the buoys see table 1 similar to existing methods cornejo bueno et al 2016 2018 we aim to reconstruct the significant wave height of buoy 46069 at different time steps treating them as missing data networks have access to all information from the two adjacent buoys 46025 and 46042 as their input as well as buoy 46069 s swh as their labels in the training process which consists of data from the entire year 2009 then the networks predict the entire 2010 year swh of buoy 46069 based on the inputs from the adjacent buoys in other words at time step t each model is allowed to see the first t measurements of h s at the two nearby buoys table 6 compares the performance of our seqtoseq and sl lstm networks with that of benchmark methods from the literature the methods are cornejo bueno et al 2016 2018 1 all featured extreme learning machine elm 2 all featured support vector regression svr 3 grouping genetic algorithm extreme learning machine with final prediction with elm gga elm elm 4 grouping genetic algorithm extreme learning machine with final prediction with svr gga elm svr 5 bayesian optimization grouping genetic algorithm extreme learning machine with final prediction of elm bo gga elm elm 6 bayesian optimization grouping genetic algorithm extreme learning machine with final prediction of svr bo gga elm svr and 7 a feedforward fully connected network londhe and panchang 2007 londhe 2008 the table reports the rmse mean absolute error mae and r 2 which is cc 2 as error metrics these are the metrics used in the benchmark papers note that cornejo bueno et al 2016 2018 uses buoys 46025 46042 and 46069 and claims that the noaa dataset has no missing measurements for these buoys in the years 2009 10 however we found this to be untrue first there are significant gaps in the 46069 station data which result in fewer than 5000 data points instead of the 8760 hourly points that should be present in a given year second like the other refined stations roughly 1 2 of the h s values contain 99 00 which indicates missing data therefore we carefully cleaned the missing data points from all three stations in such a way as to preserve the position of each time step that is if there is a missing point in a station measurement we exclude that time step from all stations the resulting data set has 9263 data points for each buoy where 4687 points are for training 2009 and 4576 are for testing 2010 we consider a three layered neural network similar but not identical to londhe and panchang 2007 londhe 2008 as an alternative method we optimize the three layered network with sgd and use relu activation instead of levenberg marquardt optimization algorithm and log sigmoid activation which have been used in the original papers as can be seen in table 6 the simple feedforward three layered network performs better than some of the alternatives such as all features elm and all features svr this emphasizes the fact that neural networks are very strong tools for the hindcasting procedure of the ocean wave characteristics one can also observe better performance from our proposed frameworks compared with the three layered network which justifies to a great extent the reason behind introducing the more advanced structure from the table it is clear that the performance of the seqtoseq network is very promising as it obtains the best r 2 values among the methods moreover lstm significantly outperforms all the alternatives and even the seqtoseq network in terms of rmse and mae simultaneously it is worth mentioning that both of our methods have access only to h s of the stations while the benchmark methods use more measurements for example the gaa methods obtain their best performance using wind speed significant wave height average wave period air temperature and the atmospheric pressure at buoy 46025 and the significant wave height and average wave period of buoy 46042 cornejo bueno et al 2016 this makes the superiority of our methods even clearer but brings about another question as well namely would using proper feature selection improve the performance of deep networks even further we conducted some preliminary experiments to answer this question considering combinations of the features that the gaa approaches use and found an inferior accuracy compared to solely using h s in section 6 we discuss a more efficient approach for feature selection fig 5 illustrates the performance of both the lstm and seqtoseq networks in reconstructing the significant wave height for buoy 46069 note that the models never saw the solid green line which is the year 2010 data i e the test data we also illustrate the rmse behavior of lstm and seqtoseq fig 6 displays the rmse test errors based on the number of training epochs up to 50 both networks reach their best performance around the tenth epoch with sequence to sequence reaching it slightly faster this happens even though there are more weights in the sequence to sequence model we argue that epoch scheduling training may be responsible for this quicker training performance because by definition it allows the network to see ground truth outputs to update the parameters better while simultaneously avoiding excessive overfitting 6 feature selection in this section we introduce a new case study considering measurement data collected from noaa sensors and modify the proposed framework to investigate feature selection via elastic net en zou and hastie 2005 methodology we alter the loss function to include two separate regularizers ℓ 1 norm and ℓ 2 norm as follows f w x 1 n i 1 n y i n x i w 2 λ 1 w 2 2 λ 2 w 1 where w 1 w w i and w is the set of all the network weights the ℓ 1 norm inherits a naturally sparse collection of variables w 1 has its minimum when all the weights are zero uncollected so every single nonzero weight should improve the first term of the objective function hence the model chooses only those weights for which the decrease in the first term outweighs the increase in the last term using only the ℓ 1 norm regularizer would result in instability among the multiple solutions because a tiny change in the parameters may change some weights from zero to nonzero values or vice versa ng 2004 therefore the ℓ 2 norm is used in the objective one important difference between our feature selection method and those used in the wave energy literature e g cornejo bueno et al 2018 is that the models in the literature either use all of the data related to a specific feature like h s from a nearby buoy or decide to ignore that feature entirely however our model allows us to partially utilize any of the features based on nonzero weights resulting in the optimal solution to investigate the performance of our proposed framework for feature collection we design a new experiment which has been recently explored for feature selection via ensemble structures as well pirhooshyaran et al 2020 fig 7 illustrates six stations 44007 44008 44009 44013 44014 and 44017 from the east coast of the united states to see their exact locations and water depths refer to table 1 we reconstruct the significant wave height and power output of buoy 44008 based on available features of the other nearby buoys we chose these buoys for two main reasons first on average they are rich in features with usable data second the resolution and the data collection times for these stations are the same up to 1 minute accuracy this is crucial when we want to reconstruct a feature of a buoy based on others we consider wind direction wdir wind speed wspd gust speed gst significant wave height wvht dominant wave period dpd average wave period apd direction of dominant period waves mwd sea level pressure pres air temperature atmp sea surface temperature wtmp and dewpoint temperature dewp the datasets are for the year 2018 we include all the features for all the buoys except dewp for buoys 44009 and 44013 because those data are unusable we exclude a measurement for all the stations only if a feature is missing in at least one of them in the end the dataset consists of 3422 measurements of 53 features we divide the dataset into train 60 validation 20 and test 20 we do not change the real measurements in any way in addition the methods never see the test set during training and validation in this experiment for both the lstm and seqtoseq networks we have one more parameter to tune namely the coefficient of the ℓ 1 during the validation table 7 compares the performance of all of the methods along with an alternative method random forest algorithm breiman 2001 for reconstructing both h s and p wave features there is a column dedicated to the percentage of non zero trainable variables we consider a single weight or bias variable to be non zero if its absolute value exceeds the threshold of 0 0001 and we report the result as the percentage of non zero variables among all trainable variables when we use the elastic net concept for selecting weights and biases we observe a significant drop in the non zero values this means exactly what we discussed at the beginning of this section the models invest only in those variables which are beneficial to the objective value here we report the best results found for each measurement error rmse huber and maape independently in other words the reported values of rmse huber or maape are not necessarily gathered from a single experiment but instead they are the best ones for the training epochs less than or equal to 50 as seen in table 7 en generally improves the performance of each method for instance en aids single layered lstm significantly for reconstructing h s and reduces rmse and huber losses by 29 and 54 respectively similarly it helps the seqtoseq network slightly and reduces the measurement errors by around 5 another interesting finding is the comparison between multi layered lstm and single layered ones unlike in predictions in section 4 2 here the performance of multi layered lstm is satisfactory and even superior in many cases therefore we argue that for feature selection when the number of features is considerable compared to forecasting having deeper structures improves the performance in addition we observe that networks with more variables such as multi layered lstm or seqtoseq retain more non zeros in particular in the process of tuning they choose the ℓ 1 coefficient to be smaller hence the effect of the ℓ 1 is lessened this may be due to the fact that the more advanced structures can find hidden relations among features and set their corresponding weights to non zero values whereas single layered models are unable to discover some hidden relations so they set the weights equal to zero the random forest is known to be very efficient and accurate in ranking the importance of variables in addition we already compared the method with svr and elm in previous section to have a fair comparison we hypertune its major parameters such as maximum depth for h s reconstruction it finds the best rmse and huber losses but for p reconstruction it fails to provide similar performance the seqtoseq en framework is the most robust and promising one it attains the best performance for half the measurements and is generally among the top methods for the rest we observe that λ i 0 001 0 01 i 1 2 results in the leading performance for the seqtoseq network 7 conclusion this paper focuses on the reconstruction feature selection and multivariate multistep forecasting of ocean wave characteristics based on real data obtained from noaa buoy measurements around the globe this paper is among the first to propose the use of sequence to sequence and other novel recurrent networks for these objectives moreover the epoch scheduled training concept has been introduced as a soft technique so that the model enjoys the consistency of teacher forcing methods while avoiding overfitting we tested various optimization algorithms on the networks that we introduced amsgrad and adam present robust and promising performance compared with sgd and rmsprop we compared several recurrent networks all of the parameters are tuned with spearmint bayesian optimization under the same budget one observes that spearmint favors single layered networks as opposed to multi layered networks for multivariate forecasting this can be observed in our numerical studies as well the sl lstm and seqtoseq models demonstrate superior performance compared to the other networks furthermore we explore the problem of reconstructing wave features which has been well studied in the literature the results suggest the superiority of our proposed networks compared to existing techniques our findings emphasize the fact that using only significant wave heights of adjacent buoys is sufficient to construct h s of a nearby station proper feature selection however necessitates more analysis we design a new experiment using noaa data from the east coast of the united states the dataset can be used for any feature selection and multivariate regression research we incorporated the elastic net concept into our proposed neural networks to handle 53 features of the dataset we evaluate the performance with and without the en and with the random forest algorithm the results indicate that the seqtoseq network has a consistent and reliable performance in addition for feature selection deeper recurrent structures are more promising compared to single layered ones we suggest the use of different parameter tuning algorithms such as derivative free optimization instead of spearmint as one promising future direction moreover utilizing other neural network techniques such as attention mechanism in particular for wave feature selection and reconstruction can be another area for future study credit authorship contribution statement mohammad pirhooshyaran conceptualization methodology software validation formal analysis data curation writing original draft visualization lawrence v snyder investigation resources writing review editing supervision project administration funding acquisition declaration of competing interest no author associated with this paper has disclosed any potential or pertinent conflicts which may be perceived to have impending conflict with this work for full disclosure statements refer to https doi org 10 1016 j oceaneng 2020 107424 acknowledgments this research was partially supported by the national science foundation nsf united states of america through the cybersees grant 1442858 the authors are responsible for the results presented in the paper these results have not been endorsed by the sponsoring agency appendices a 1 lstm network the standard lstm equations lipton et al 2015 hochreiter and schmidhuber 1997 for time step t are as follows 6 f t sigm w f x x t w f h h t 1 7 i t sigm w i x x t w i h h t 1 8 o t sigm w o x x t w o h h t 1 9 s t tanh w s x x t w s h h t 1 10 s t f t s t 1 i t s t 11 h t o t tanh s t where x t r d h t r h f t r h i t r h o t r h s t r h and s t r h for all t 1 t are the input hidden state forget activation input activation output activation cell state and auxiliary cell state vectors respectively for the lstm network w i j is the weight matrices corresponding to the dimensions of the gate vectors i and j the sigmoid function is given by sigm x 1 1 e x x r its return value is monotonically increasing in the open interval 0 1 the notation indicates element wise hadamard matrix product which exists only if the matrix dimensions are the same the weight matrices can be initialized randomly with a gaussian distribution further h 0 and s 0 are initialized by zero vectors the biases are omitted in the formulas because one may incorporate them easily through the weight matrices by adding one extra element to each vector mentioned a forget gate responds to the question which data should the model keep from the previous cell state vector in 6 the sigmoid function outputs a number between 0 and 1 which indicates the importance of the previous plus current inputs this value is directly multiplied with the cell state vector of the previous cell state in the first term of 9 the input gate 7 decides which new information should be collected the second term of 9 updates this new information the updated cell state vector is ready to go through the next part of the network furthermore the hidden state is merged into the cell state through 11 a 2 network weight updates by different algorithms stochastic gradient descent robbins and monro 1951 sgd directly updates w in the direction of the negative of the mini batches gradient in an iterative manner that is if b i is the i th mini batch then we have w i 1 w i α i w f w x where f w x 1 b i b i y i n x i w 2 λ w 2 2 and α i is the learning rate 7 at step i which needs to be tuned there exist several modifications of sgd such as root mean square prop rmsprop tieleman and hinton 2012 adaptive moment estimation adam kingma and ba 2014 has been successfully implemented as another first order method in adam the model s weight is updated as follows 12 w i 1 w i α i v ˆ i ϵ m ˆ i where 13 m ˆ i m i 1 β 1 i 14 v ˆ i v i 1 β 2 i 15 m i β 1 m i 1 1 β 1 w f w x 16 v i β 2 m i 1 1 β 2 w 2 f w x β 1 and β 2 are momentum like parameters and ϵ serves to reduce numerical issues adam aims to update each element of w with respect to its size adaptively it stores only an exponentially decaying average of past squared gradients the authors of kingma and ba 2014 propose β 1 0 9 β 2 0 99 and ϵ 1 e 8 to be efficient in some cases such as machine translation in which we are dealing with rnn structures similar to our forecasting context adam suffers from using exponential averaging over the past squared gradients amsgrad reddi et al 2018 has been proposed to tackle this issue by simply using the maximum of the past squared gradients iteratively in other words we update v ˆ i max v ˆ i 1 v i the schematic view of the lstm cell is shown in fig 8 a 3 error metrics we use the following forecasting error metrics root mean square error rmse is one of the most commonly used regression error metrics it equals the square root of the mse given in 5 and it provides a useful measure of forecasting quality the closer the rmse gets to 0 the better the fit the prediction gives in general it is difficult to choose an appropriate threshold such that the prediction is deemed accurate if the rmse is less than that threshold because the rmse is scale dependent and not robust to outliers the dimension of rmse is equal to the dimension of its under study variable in our case when we use rmse error for p and h s the reported errors are in m and kw m respectively huber loss given two sets of points y and y ˆ is defined as 17 h δ 1 n i 1 n l δ y i y ˆ i where 18 l δ y i y ˆ i 1 2 y i y ˆ i 2 for y i y ˆ i δ δ y i y ˆ i 1 2 δ 2 otherwise generally δ 1 is an acceptable threshold huber loss is scale dependent but is less sensitive to outliers than rmse is as one can realize the dimension of the huber loss can be equal to dimension of the y or its square pearson correlation coefficient cc is defined as 19 ρ y y ˆ cov y y ˆ σ y σ y ˆ where cov is covariance we have 1 c c 1 although cc captures linear similarities of its inputs very well several characteristics of nonlinear relations are ignored the correlation coefficient metric is dimensionless mean arctangent absolute percentage error maape kim and kim 2016 given two sets of points y and y ˆ is defined as 20 1 n i 1 n arctan y i y ˆ i y i maape is scale independent and unlike mape overcomes problematic cases as y i goes to zero for all i 1 n both mape and maape are dimensionless 
