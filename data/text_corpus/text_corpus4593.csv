index,text
22965,ocean mining emerges as a way of meeting future demands for valuable minerals risers conveying ore from the seabed to the surface must withstand large wave and current loads in addition vortex induced vibrations viv are an important source of fatigue however the viv of mining risers may be affected by particles flowing inside in this paper a novel framework for coupled analysis of risers with internal flow is utilized to study viv of a mining riser focus is on the effect of time varying internal slurry flows and the associated density waves traveling along the riser simulated viv response and fatigue damage are reported in detail to illuminate the effect of the period wavelength of the internal flow it is found that the internal flow produces significant changes to the viv fatigue damage if the wavelength of the internal density wave is close to λ c r l n where l is the riser length and n is the dominating viv mode the results suggest that careful analysis is necessary when designing a mining riser where internal density waves are expected to occur with a wavelength near or above the critical value in such cases the numerical method presented here is a useful tool keywords ocean mining vortex induced vibrations risers density waves fatigue 1 introduction the global demand for minerals is rising and traditional land based mines may struggle to meet future demands ali et al 2017 as a result various companies and organizations direct their attention towards the large mineral deposits in the deep ocean such as sea floor massive sulfides sms and manganese nodules sharma 2017 sms deposits are formed around black smokers on the ridges of tectonic plates and are characterized by high grades of metals such as copper zinc silver and gold petersen et al 2016 manganese nodules are found on deep abyssal plains and contain manganese nickel cobalt and copper much research about deep sea mining was conducted already in the 1970 s and commercial consortia such as the ocean minerals company omco carried out large scale tests of deep sea mining systems chung 2010 even though this pioneering work showed that deep sea mining is technologically feasible the interest declined due to sufficient supply from mines on land however this interest has recently been renewed and commercial mining is now planned to commence outside the coast of papua new guinea in 2019 nautilus minerals 2016 in spite of decades of research efforts there are many associated uncertainties and challenges in commercializing deep sea mining environmental issues are particularly important as the ecosystem around targeted resources may be vulnerable miller et al 2018 when it comes to technical challenges some of these are energy supply extraction vertical transportation from seabed to surface and mineral processing different alternatives have been suggested for the vertical transportation of ore such as mechanical lifting using a continuous bucket system or hydraulic lifting using slurry pumps another possibility is to lift the minerals by injecting compressed air into the liquid solid mixture a procedure called airlift schulte 2013 the slurry and airlift methods require a vertical pipe i e a riser for conveying the ore water mixture the riser is a critical component for such an ocean mining system and designers must be able to predict stresses and fatigue for the entire operation these extremely slender structures are subjected to large wave and current loads and numerical methods are required for computing the dynamic response see e g chung et al 1981 since risers are used extensively in the offshore industry for transportation of oil and gas much research has been carried out regarding their dynamic response see e g patel and seyed 1995 one important response type is the vortex induced vibrations viv that occur as a result of the oscillating fluid forces caused by flow separation and shedding of vortices because viv is of both practical importance and academic interest due to complicated fluid structure interaction the research on viv has been considerable as reflected by several reviews bearman 1984 williamson and govardhan 2004 wu et al 2012 although the basic vortex shedding process for stationary cylinders is reasonably well understood sumer and fredsøe 1997 the complexity increases as the cylinder is allowed to oscillate which may lead to unsteady chaotic response modarres sadeghi et al 2011 and higher harmonic forces that may be detrimental to the fatigue life modarres sadeghi et al 2010 a flexible cylinder will in general oscillate both in the cross flow cf and in line il directions and it has been found that the phase angle between the cf and il response has a significant effect on the forces wu et al 2016 although the displacements associated with viv are moderate the fatigue damage may in some cases be significant due to high modes of vibration combined with a relatively high frequency baarholm et al 2006 prediction of fatigue damage caused by viv is an important part of riser design although it is possible to predict viv based on first principles using computational fluid dynamics bourguet et al 2011 the required computing resources are still too large for a design tool as a result the offshore industry relies on empirical models such as shear7 viva and vivana vandiver and li 2005 triantafyllou et al 1999 larsen et al 2009 these tools operate in the frequency domain which means that non linear effects such as time varying mass and stiffness cannot be accounted for to deal with these effects the solution must be carried out in the time domain using a step by step integration of the equations of motion several empirical time domain methods have been proposed such as the wake oscillator models kurushina et al 2018 the artificial neural network approach by mainçon 2011 and the phase coupled synchronization model by thorsen et al 2017 a common challenge with all empirical models is to find parameters suitable for all flow regimes and cylinder configurations of practical importance although most of the knowledge about viv from the offshore industry can be directly applied to ocean mining there is at least one important difference which is the internal flow the density of the mineral ore is high up to around 3000 kg m3 and the presence of heavy particles may affect the dynamics of the riser in addition the density of the water particle mixture will probably not be constant along the riser density variations are likely to occur as particles of different size will have different velocities van wijk 2016 other sources of density variations can be changes in the production process start up shut down or that the mining machines are unable to deliver the ore at a constant rate no matter how or why density variations may occur it is of interest to study how such variations affect riser viv the published literature contains very few reports about viv in ocean mining risers wang et al 2017a studied vessel motion induced viv of a free hanging riser but did not account for any internal flow or density variations verichev et al 2011 discussed various excitation mechanisms relevant for mining risers and described how the internal flow may affect viv but focused on the instability buckling that occurs when the slurry velocity exceeds the critical value boomsma and blanken 2014 describe recent developments of vertical transportation technology including a simulation tool for riser dynamics that may include slurry density variations however no quantitative results were presented knudsen et al 2016 carried out numerical simulations of riser viv accounting for the time varying inertia and centrifugal forces caused by an internal flow of water and stone this study showed that the internal flow is capable of changing the maximum curvature of the riser but the effect on riser fatigue was not investigated thorsen and sævik 2018 assumed a sinusoidal density variation and used a simplified analytical model to predict the wavelength that would give the largest disturbance on viv the analytical model is however not capable of determining if the fatigue damage will increase or decrease as a result of the internal density wave based on previous work on the topic it seems clear that internal density variations may occur during vertical transportation of minerals and that this may affect the viv response of the riser however the actual effect is still unclear the goal of the present paper is to give new insight into how slurry density variations affect the fatigue life of ocean mining risers this is done by utilizing a novel framework for fully coupled simulation of the internal flow and riser viv the simulation tool consists of the following parts 1 1 d dynamic multi phase flow model including water and particles 2 non linear dynamic riser analysis including viv loads in time domain 3 data exchange between the structural analysis and the internal flow codes the numerical models are presented in the next section then simulations of an ocean mining riser undergoing viv are carried out and the fatigue damage associated with different slurry density variations is reported the effect of riser weight tension and top vessel motion is also investigated it should be noted that uncertainties are present in the model particularly related to the choice of empirical parameters however the model is expected to give a realistic picture of how internal density waves affect riser viv which is useful for determining if riser fatigue life decreases or increases as a result of density variations in the internal flow 2 numerical models 2 1 internal flow model the internal flow model adopted in this study is a one dimensional two fluid model originally developed for gas liquid two phase flows which is based on a finite volume lagrangian slug tracking model concept first tested by nydal 2012 and later extended and modified in several phd studies smith 2017 the simulation code is written in c using object oriented programming in the present work solid particles and water phases are treated as a part of liquid mixture for every control volume the continuity or mass equation for subfield f reads 1 m f t a b f ρ f u f u b n d a m f s r c where a b f is the boundary area u f the velocity of the subfield u b the velocity of the boundary and n a unit vector pointing out of the control volume mass sources and sinks are represented by the term m f s r c the subfield mass m f is defined as 2 m f ρ f α f v where the terms ρ f α f and v represents the subfield density phase fraction and total cell volume respectively the momentum equation is solved for the mixture field indicated by a subscript m t v m ρ m u m d v a m ρ m u m u b u m d a v m p x d v v m ρ m g h m cos θ x d v a m τ i d a 3 a m τ m w a l l d a v m ρ m g sin θ d v v m ρ m s r c u m s r c d v here p is the internal pressure θ the pipe inclination θ 0 for horizontal h m is the fluid height of the mixture and τ is shear stresses the terms on the right hand side of eq 3 represent pressure gradient hydraulic level gradient interface and wall friction gravity and finally a contribution from sources and sinks the wall shear stress τ m w a l l is computed based on assumption that the large particles tend to migrate away from the wall due to hydrodynamic lift and the near wall velocity profile is only slightly affected by the presence of particles engelmann 1978 hong et al 2002 ravelet et al 2013 the wall shear stress is modeled by water flowing at the mixture liquid velocity 4 τ m w a l l 1 8 λ m ρ m u m u m for the wall friction factor λ m we use haaland 1983 and the hagen poiseuille friction factors white 2011 for turbulent and laminar flow respectively the complete details of the internal flow model can be found in the work by smith 2017 subfield particle velocity u s and water velocity u f are computed from the liquid mixture velocity using slip velocity correlations van wijk 2016 5 u f u m α p ρ s ρ m w h 6 u s u m α p ρ s ρ m w h w h where α p is the local particle concentration and w h is the hindered particle settling velocity given by the correlation richardson and zaki 1954 7 w h 10 d d i w t 1 α p n where d is the particle diameter and d i is the internal diameter of the pipe the terminal velocity for a single particle is given as 8 w t 4 g d 3 c d ρ s ρ f 1 in eq 7 the single particle terminal velocity w t is corrected for relatively large particles by the factor 10 d d i and the local particle concentration the exponent n 2 4 and particle drag coefficient c d 0 44 are used in the present work ravelet et al 2013 2 2 riser dynamics the structural analysis is performed by the finite element program riflex marintek 2014 which is tailor made for dynamic analysis of slender marine structures the riser is modeled using beam elements formulated using a co rotated reference frame to account for large displacements and rotations in 3d space the non linear dynamic analysis is based on the incremental form of the dynamic equilibrium equation which is solved by the newmark β method and a newton raphson iteration procedure the external hydrodynamic loads per unit length at any point along the riser are calculated as 9 f c m ρ π d o 2 4 u n c m 1 ρ π d o 2 4 x n 1 2 ρ d o c d v n v n 1 2 ρ d o c v v n j 3 v n cos ϕ exc the three first terms make up morison s equation faltinsen 1993 while the final term represents the oscillating force due to vortex shedding as proposed by thorsen et al 2017 c m and c d are the inertia and drag coefficients while c v determines the strength of the vortex shedding force furthermore u n is the normal component i e perpendicular to the cylinder axis of the fluid particle acceleration x n is the normal component of the cylinder acceleration and v n is the normal component of the relative fluid velocity the relative flow velocity is given as v u x where u is the incoming flow velocity and x is the velocity of the cylinder cross section ρ is the seawater density and d o is the outer diameter of the cross section j 3 is a unit vector pointing in the direction of the cylinder axis which means the cross product in eq 9 ensures that the vortex shedding force is acting perpendicular to the instantaneous relative velocity v n in reality there will also be vortex shedding forces parallel to v n causing in line viv and an in line excitation term was implemented in eq 9 by ulveseter et al 2018 the displacements associated with in line viv are however significantly smaller than the cross flow although stresses can be of similar magnitude and the in line excitation term is omitted in this study a study on in line viv of mining risers remains to be done in the future the oscillations of the vortex shedding force are described through the time varying phase ϕ exc the evolution in time is given by eqs 10 11a and 11b 10 d ϕ exc d t 2 π f ˆ exc v n d o 11 f ˆ exc f ˆ 0 f ˆ max f ˆ 0 sin ϕ y r e l ϕ exc ϕ y r e l ϕ exc 0 f ˆ 0 f ˆ 0 f ˆ min sin ϕ y r e l ϕ exc ϕ y r e l ϕ exc 0 eq 10 gives the relationship between the dimensionless and the actual frequency while eqs 11a and 11b models the synchronization between the vortex shedding and the cylinder motion here ϕ y r e l is the instantaneous phase of the relative cross flow velocity of the cylinder such that the argument of the sine function represents the phase difference between the cylinder cross flow velocity and the vortex shedding force the essential feature of the synchronization model is that it makes it possible for the vortex shedding force to vary its instantaneous dimensionless frequency between f ˆ min and f ˆ max and lock on to the frequency of vibration for more details see thorsen et al 2017 the empirical parameters used for the external hydrodynamic loads in the present study are given in table 1 the dimensionless frequency parameters are chosen such that the excitation region coincides with experimental observations by gopalkrishnan 1993 i e extending from f ˆ 0 125 to f ˆ 0 3 with maximum energy transfer around f ˆ 0 17 2 3 effect of internal flow on structural dynamics the effect of the internal flow on the structural dynamics is presented in the following first of all the weight of the internal fluid will contribute to the effective submerged weight of the pipe 12 w s w p i p e w f ρ e g a e where w p i p e is the dry weight of the empty pipe w f is the weight of fluid inside including water and particles and the last term is the buoyancy during viv the riser is curved and the deformation changes over time as a result the fluid particles inside will follow a time varying curved path to illustrate this consider a beam element in a deformed state as shown in fig 1 assuming the pipe deformations are small in the co rotated frame of reference the time dependent position of an internal fluid particle can be expressed as 13 r f t v t j 3 u j 1 v j 2 where v is the internal slurry velocity while u and v are the lateral displacements of the beam in the local x and y directions respectively j 1 j 2 and j 3 are orthogonal unit vectors as shown in fig 1 and t is some arbitrary instant of time the velocity of a fluid particle is found as the material derivative of the position 14 v f d r f d t r f t v r f z v j 3 u t j 1 v t j 2 v u z j 1 v z j 2 the fluid particle acceleration is found through similar differentiation of the velocity 15 a f d v f d t v f t v v f z 2 u t 2 2 v 2 u t z v 2 2 u z 2 j 1 2 v t 2 2 v 2 v t z v 2 2 v z 2 j 2 according to newton s laws a lateral force on the fluid must be present to cause this acceleration an equal and opposing force will act on the pipe element and this force per unit length must be equal to m f a f where m f is the internal slurry mass per unit length hence the following three force components will act on the pipe as a result of the internal fluid see also paıdoussis and li 1993 16 f inertia m f 2 u t 2 j 1 m f 2 v t 2 j 2 17 f coriolis 2 m f v 2 u t z j 1 2 m f v 2 v t z j 2 18 f centrifugal m f v 2 2 u z 2 j 1 m f v 2 2 v z 2 j 2 the inertia term is independent of the internal flow velocity and is accounted for in the numerical model by adding the mass m f to the element mass matrix for the degrees of freedom corresponding to lateral motion the coriolis and centrifugal forces are added to the element load vector in the structural dynamics code it should also be mentioned that the internal pressure will induce stresses in the pipe wall that may change the unstressed element length for a mining riser with a free lower end this will not influence the effective tension and hence the global dynamics are unaffected the pressure effect is therefore ignored in the present study 2 4 effect of structural dynamics on internal flow the structural dynamics affects the internal flow for two reasons firstly the geometry changes with time and secondly the acceleration of the pipe causes fictitious forces on the fluid inside the combined effect of time varying geometry and acceleration is captured using an effective gravity concept the acceleration of gravity and the acceleration of the pipe with negative sign is added and treated as an effective gravity vector and an effective inclination when these quantities are applied in the solution of the momentum equation for the internal flow the effect of the pipe acceleration and time varying geometry are taken into account as the internal flow model only considers forces and motion in the axial direction the effect of lateral acceleration is not accounted for 3 viv case study 3 1 overview the numerical model described above is used to study the viv and fatigue of an example mining riser compared to traditional oil and gas risers the essential difference is the internal flow a hydraulic lift method is assumed where the internal flow consists of water and ore particles the goal of this study is to investigate if and how the internal flow affects the viv and associated fatigue damage of the riser although viv of risers used for oil and gas transportation is well studied a complete understanding of the phenomenon is still lacking with the exception of cfd based prediction methods all available viv analysis tools including the present viv load model are empirical and unable to replicate the true complexity of viv where frequencies and amplitudes can vary randomly in time and space nevertheless such models are effective when it comes to predicting average quantities such as the dominating frequency mode and fatigue damage over time with this in mind the results presented in this paper must be seen as approximations towards the actual riser dynamics that can be expected in a real mining scenario however the applied viv model has been proven accurate in a wide variety of cases including current oscillating flow and irregular waves ulveseter et al 2018 thorsen et al 2016 it is therefore expected that the model will provide a realistic picture of the effects of internal flow on riser viv as an example a water depth of 2350 m and a steel riser with a length of 2300 m is chosen see fig 2 this corresponds approximately to the depth at loki s castle which is an active hydrothermal vent field located along the arctic mid atlantic ridge pedersen et al 2010 the inner riser diameter is taken as 0 4 m and the riser wall thickness is set to 20 mm a clump weight of 100 tonnes is attached to the free lower end to avoid excessive drift off and this also represents the mass and weight of a slurry pump remaining mechanical properties of the riser are given in table 2 the applied environmental load is a linearly sheared current with a magnitude of 1 m s at the surface and 0 5 m s at the seabed the conveyed ore is modeled as particles with a density of 2540 kg m3 and a uniform diameter of 10 mm in reality the particle size will vary over some range depending on the method of crushing and or filtering the riser is discretized into 460 beam elements and the time step in the structural analysis is set to 0 025 s corresponding to roughly 100 time steps per viv period it was checked that element and time step size are sufficiently small for convergence in space and time in the internal flow model the minimum and maximum section length is set to 2 m and 4 m respectively the communication between the structural and internal flow simulation occurs for every time step in the structural analysis while the time step in the internal flow simulation is dynamic i e controlled by the simulation itself according to the cfl criterion structural damping is included through the proportional damping formulation c a 1 m a 2 k where m and k are the global mass and stiffness matrices the values used for the damping parameters are a 1 0 and a 2 7 10 3 giving a damping ratio of approximately 1 at the viv frequency note that the structural damping is small compared to the hydrodynamic damping which is represented by the drag term in eq 9 3 2 base case steady state internal flow a steady state flow meaning a constant mass flow rate of water and particles at the inlet lower end is used as a base case the selected flow rates are 400 kg s of water and 200 kg s of particles this results in a mixture with an average density of 1275 kg m3 where the average water velocity is 4 m s and the average particle velocity is 3 55 m s the external current is activated and the simulation progresses for 1000 s the first 700 s are discarded to ensure that a steady state has been reached the flow rate chosen for this study is close to what can be expected in an actual ocean mining operation frimanslund 2016 the importance of the flow velocity can be seen from eqs 16 18 which shows that the inertia force is independent of flow rate while the coriolis and centrifugal terms increase with the flow velocity it is well known that the centrifugal term causes instabilities for high flow velocities but this does not occur at the moderate velocities considered here hence in the present study the dominating internal flow effect is the mass variations the riser experiences a mean displacement in the x direction due to the drag forces as shown in fig 3 a as stated previously the fluctuating drag and in line viv is not included in the present analysis snapshots of the cross flow displacements are shown in fig 3b together with the maximum and minimum envelopes it is seen that the amplitude of vibration is slightly below 0 5 m which is close to the outer diameter of the riser d o 0 44 m this is in good agreement with observations from model tests during fully developed steady state viv see e g trim et al 2005 it is also noted that the response seems to be well organized and regular in the upper part of the riser and more irregular towards the lower end in general the response is comparable to standard viv without internal flow assuming the average mass is identical the main difference between a steady state internal flow and no internal flow are the centrifugal force see eq 18 which acts as a negative stiffness for moderate flow velocities this term is insignificant compared to the riser tension to provide more understanding of the viv response along the riser time series and fourier transforms are studied more closely the cross flow displacement at z 1000 m is shown in fig 4 and the fft shows there is a single dominating frequency at 0 39 hz this correspond to the expected vortex shedding frequency f 0 17 u t o p d o where 0 17 is the dimensionless frequency where the vortex shedding provides the largest energy input see also section 2 2 and description of empirical hydrodynamic parameters this single constant frequency explains why the response looks regular in the upper part of the riser as seen in fig 3b the cross flow displacement at z 2250 m is shown in fig 5 the time series fig 5a looks chaotic which is confirmed by the broad banded response found in the fft fig 5b which includes two distinct peaks the peak with the highest frequency is at 0 39 hz which is the same as observed higher up on the riser this frequency peak is likely caused by viv in the upper part of the riser spreading downwards as traveling waves the next peak is found around 0 25 hz which is excited by the local vortex shedding in the lower part of the riser because the current velocity reduces towards the seabed the local vortex shedding frequency will also reduce the mixture of a high frequency caused by traveling waves from the upper part and lower frequencies excited locally explains why the response is more chaotic towards the bottom which was also seen in fig 3b the dynamic stresses in the riser are of large interest due to their potential for causing material fatigue in the present study focus is on the stresses caused by cross flow viv these are found from the cross flow bending moment as 19 σ c f m c f i d o 2 where i is the second moment of area for the riser cross section and d o is the outer steel diameter the standard deviation of σ c f along the riser is shown in fig 6 a which shows that the highest stresses are found close to the middle and at the lower end time series of the cross flow stresses are shown in fig 6b at the position z 1000 m top and z 2250 m bottom the stress at the middle of the riser is highly regular with a constant amplitude and frequency which is in agreement with the previous observations at the lower end the stress amplitude varies strongly with the largest amplitudes up to 20 mpa this can be explained by the superposition of high frequency stresses caused by traveling waves from the upper part and lower frequency stresses generated by the local vortex shedding 3 3 regular density waves the riser was subjected to a time varying internal flow to investigate how this affects the viv a regular density wave was generated by turning the inflow of particles on and off with a specified period the inflow of water was kept constant at 400 kg s like in the steady internal flow case while the inflow of particles varied between 0 and 400 kg s this means that the average density along the riser was the same as before around 1275 kg m3 this lead to a traveling density wave and the distribution along the riser is shown in fig 7 for two different flow periods it is seen that the particles tend to disperse as they are carried upwards such that the density variations are smaller towards the upper end this effect is largest for the short periods simulations were carried out with internal flow periods ranging from 10 to 100 s the density wavelength taken as the distance between the fronts of consecutive particle batches increases linearly with the period an overview of all the cases and the corresponding wavelengths is given in table 3 the internal flow wavelength has in previous work been identified as an important parameter with respect to the effect on riser viv thorsen and sævik 2018 and the critical length is λ c r l n where n is the dominating mode number for the viv for the present case with a complicated response type it is not straightforward to point out a single dominating mode instead l n is estimated by measuring the distance between points of maximum dynamic bending moment along the riser this results in a critical wavelength of λ c r 98 m the standard deviation of the cross flow bending stresses along the riser with an internal density wave with t 30 s are shown in fig 8 a compared to the results from the steady internal flow case fig 6a the stress values are slightly reduced the actual time series of bending stress are shown in fig 8b with z 1000 m at the top and z 2250 m at the bottom looking at the top figure first it is seen that the maximum stress is almost unchanged compared to the case with steady state flow however the amplitude is no longer constant and at some point around t 950 s the viv is clearly disrupted moving on to the stress close to the bottom this looks irregular like in the case with steady internal flow the fatigue damage along the riser is calculated in three steps first rainflow counting brodtkorb et al 2000 of the stress time series is performed to find stress cycles then the damage for each cycle is computed based on an s n curve of the form n a δ σ m where n is the number of cycles to failure for a stress range δ σ the selected curve is taken from dnv gl 2010 b2 in seawater with cathodic protection with log a 14 685 and m 4 the change in slope occurring for n 10 6 is disregarded for simplicity finally the total damage is found by summing the contributions from each cycle according to the miner palmgren rule the annual fatigue damage is found by multiplying with the number of seconds per year and dividing by the number of seconds in the simulation the fatigue analysis results from the different simulations are shown in fig 9 the results from the base case steady state flow is shown as a dotted line the fatigue damage is seen to be largest close to the middle of the riser and also close to the lower end which is because these are the locations with the highest dynamic stresses with reference to the base case the fatigue damage distribution changes very little for the cases with t 10 s and t 20 s however when the period of the internal flow is increased to t 30 s the fatigue damage is significantly decreased this confirms that the internal flow may affect viv when the length of the density wave is close to λ c r as suggested by previous work thorsen and sævik 2018 another interesting finding is that the fatigue damage at the lower end is less affected which means that for some of the cases the point of maximum fatigue changes from the middle to the lower end when the period is increased further the fatigue damage is still reduced compared to the base case but the largest reduction is for t 30 s to illustrate the importance of the internal flow period the maximum fatigue damage along the riser is plotted as a function of the internal flow period in fig 10 the figure indicates that the fatigue damage is virtually unaffected by the density wave for t 20 s and stabilizes around 70 of the base case damage for periods larger than 50 s it should be noted that the present study cannot cover all possible periods and it is conceivable that the fatigue damage will increase compared to the base case for some periods which are not included here 3 4 effect of weight reduction an actual mining riser may have a different mass per unit length than in the previous example for instance if the pipe has a smaller wall thickness changing the mass will have an effect on riser dynamics for several reasons firstly reducing the mass increases the natural frequencies but reduced mass means lower weight which in turn means less tension and because tension is the main contribution to lateral stiffness a reduction in tension will lead to lower natural frequencies hence there are two opposing effects on the natural frequencies another result of a reduction in riser mass is that the internal fluid particle mixture becomes a larger portion of the total mass assuming that the inner riser diameter and the flow itself is unchanged this may lead to a more prominent effect from the internal density wave to investigate this the riser in the present case study is modified as follows wall thickness is reduced to t 15 mm clump weight mass lower end is reduced to 50 tonnes compared to the original riser the top tension is reduced from 5720 kn to 4100 kn in addition the riser steel mass per unit length is reduced from 206 kg m to 156 kg m for comparison the mass of the slurry is approximately 182 kg m when the density is at its maximum for the cases with time varying density the base case simulation steady state internal flow was repeated with the modified riser and the resulting cross flow bending stresses are shown in fig 11 both at z 1000 m and z 2250 m the stresses show no significant changes compared to the original riser fig 6 however the dominating viv mode has increased slightly and the critical wavelength is now estimated as λ c r 82 5 m based on the bending moment variation along the riser not shown an internal flow period of t 20 s should now give a wavelength very close to the critical value see table 3 therefore simulations with this internal flow period are carried out with the modified riser and the resulting stresses are shown in fig 12 looking at the top figure first which shows the stresses close to the middle of the riser it is seen that the maximum amplitude is almost unchanged however the stable viv response is at some point interrupted which was also observed for the original riser see fig 8 the middle part of the riser is in the viv excitation zone where synchronized vortex shedding is feeding energy into the oscillating system the amplitude in this region is large and because the hydrodynamic damping increases strongly with amplitude a further increase in amplitude would require large amounts of energy therefore it is impossible for the internal flow to increase the viv response in this region on the other hand this stable type of viv may be disturbed by changes in the natural frequencies as the vortex shedding continuously strives to synchronize with the motion of the riser this seems to be what happens e g around t 800 s fig 12 moving on to the stresses close to the bottom of the riser something interesting is seen the stress signal is still irregular like in fig 8 but large amplitude bursts are now clearly seen which were less visible before these large amplitude bursts are found to be associated with short periods of almost steady state viv i e less irregular motion this is likely to be caused by changes in the natural frequency of the riser associated with the internal density variations a closer look at fig 12 shows that when the largest amplitudes occur the dominating frequency at the bottom is lower than at the middle of the riser this suggests that the large amplitude vibrations are caused by local vortex shedding at the bottom where the current velocity is low said differently continous changes in the mass distribution trigger sporadic synchronization between one of the natural frequencies and the vortex shedding at the lower end the annual fatigue damage along the modified riser with the two different internal flows are shown in fig 13 the curve for the steady state internal flow looks similar to the original fig 9 although the maximum fatigue damage is slightly higher than before moving on to the case with the internal density wave t 20 s two interesting aspects should be pointed out firstly the fatigue damage close to the middle of the riser decreases this is because the steady state viv is sometimes interrupted which was also seen in the stress signal fig 12 secondly the fatigue damage close to the bottom does not decrease as it did for the original riser but instead increases by a factor of 2 8 this means the maximum fatigue damage along the riser increases significantly when going from a steady state internal flow to a time varying flow with t 20 s the increase in fatigue close to the bottom is caused by the large amplitude bursts seen in fig 12 4 vessel motion induced viv the case study presented in section 3 considered viv caused by a steady current when the upper riser end was fixed in reality there will be waves on the sea surface causing vessel motions and wave loads along the riser the heave and surge motions of the vessel may be transferred to the riser causing a relative oscillatory flow similarly as for the stationary current vortex shedding and viv may also occur in an oscillating flow depending on the velocity of the relative flow and the keulegan carpenter number defined as k c u m a x t d o a low kc number means few vortex sheddings per flow reversal which gives little time for stable viv to develop for higher kc numbers the response may look more like viv in steady flow but the response will build up and die out every time the flow direction changes viv of risers in oscillating flow has previously been studied by e g lyons and patel 1986 and fu et al 2014 the purpose of this section is to investigate the cross flow viv of the example mining riser caused by regular sinusoidal excitation at the top end as the oscillating flow is associated with a different type of viv the effect of the internal flow is not necessarily the same as in the previous cases with a constant current to study this the original riser presented in section 3 was subjected to prescribed top end motions corresponding to a regular wave with h 3 m and t 10 s vessel motions are prescribed in surge and heave such that the motions of the riser top end is given as x t o p x 0 sin ω t φ x and z t o p z 0 sin ω t φ z using a representative transfer function rao the amplitudes and phases angles are x 0 0 36 m φ x 154 z 0 1 14 m and φ z 17 to get a clear picture of the vessel motion induced viv only the current velocity is set to zero simulations were performed both with and without wave induced water particle velocities and accelerations but it was found that the wave forces gave a negligible effect on the response this is because the water particle motions associated with the wave decay rapidly with depth and the wave induced velocity was reduced to 1 before 120 m depth wave forces were therefore omitted which means the viv response presented in the following is caused by prescribed top end oscillations in still water 4 1 results snapshots of the displacements caused by the prescribed top end motion and the steady state internal flow are shown in fig 14 the in line displacement a is caused directly by the top end motion as the disturbance travels down the riser despite of the hydrodynamic damping the in line motion near the lower end is around the same magnitude as the prescribed motion at the top this means the riser will experience a significant oscillating flow along the whole length with the potential to excite viv in the cross flow direction at the top end the maximum relative velocity is u m a x 2 π x 0 t 2 π 0 36 m 10 s 0 23 m s this corresponds to a kc number slightly above 5 which means we are in the low kc number range where the viv frequency is expected to be close to the oscillating flow frequency sumer and fredsøe 1988 the predicted cross flow viv caused by the relative oscillating flow and the steady state internal flow is shown in fig 14b vibrations are clearly present although the amplitude is small compared to the viv caused by a stationary current ref fig 3 the low amplitude can be understood from the fact that a number of vortex shedding cycles are necessary to reach a stable maximum amplitude however due to the low kc number in this case fully developed viv is not possible the predicted amplitude is in good agreement with results by wang et al 2017a b who performed experimental and numerical studies on viv of a free hanging riser at low kc numbers this strengthens the confidence in the present viv analysis method for low kc number flows the time series and fft of cross flow displacement at z 2000 m is shown in fig 15 again for the riser with a steady state internal flow the time series is irregular as the viv is unable to reach a steady state before the oscillating flow reverses the fft reveals two peaks where the lowest frequency is close to the expected frequency of vortex shedding which is seen from the relationship f f ˆ u m a x d o 0 07 hz assuming a dimensionless frequency of f ˆ 0 14 which was found suitable for oscillating flow by wang et al 2017a the smaller peak at a higher frequency is associated with a sum frequency effect caused by the time varying amplitude of the vortex shedding force due to the oscillating flow the riser with top end oscillations was also subjected to an internal time varying flow based on the variations in bending moment along the riser the dominating cross flow mode was estimated to be n 9 this is also possible to see from the displacements shown in fig 14b based on this the critical length of the internal density wave is λ c r 2300 m 9 255 6 m an internal flow period of t 66 s was selected as this gives a wavelength very close to the critical according to table 3 the effect of the internal density wave is illustrated in fig 16 which shows the bending stress at the location where the stresses are largest which was found to be z 2225 m the top figure shows the results from the simulation with steady state internal flow while the bottom figure is for a density wave with t 66 s from visual inspection the results look very much the same although the amplitude varies marginally more for the case with time varying internal flow the reason why the effect of the internal flow is so small in this case may be the low frequency and mode of vibration induced by the oscillating relative flow it is known from experiments that low mode viv is more stable which means the response is not so easily disturbed by the internal flow the cross flow fatigue damage along the riser for the cases with top end motion is shown in fig 17 for the steady state internal flow as well as the case with an internal density wave the fatigue damage is found to be largest close to the bottom which is reasonable because this is where the tension is lowest thereby favoring higher modes and curvatures compared to further up on the riser comparing the two different cases it is seen that the maximum fatigue damage is 14 higher for the case with the internal density wave this small difference is caused by slightly higher stress ranges which are amplified by the exponent m 4 in the s n curve for both cases the annual fatigue damage is found to be very low this is a result of the low relative velocities induced by the riser oscillations and it does not mean that vessel motion induced viv will never cause significant fatigue damage larger top end motions will give larger flow velocities which in turn will increase the viv frequency and mode thereby strongly increasing the fatigue damage 5 conclusions in this work a novel framework for coupled riser dynamics internal flow analysis was utilized to investigate the viv behavior of an ocean mining riser focus was on density variations in the internal slurry flow and the effects this may have on riser fatigue which has previously received little attention a case study was carried out where an example riser was subjected to viv caused by a steady current along with different types of internal slurry flows the internal flows considered were a steady state flow with a constant mixture density and time varying flows generated by turning the inflow of particles on and off with periods ranging from 10 to 100 s the time varying flows were associated with density waves of different wavelengths moving up the riser the viv response in steady current and with different internal flows were studied in detail in terms of displacements stresses and fatigue along the riser with a steady state internal flow the viv response was characterized as regular in the upper part and irregular at the bottom due to the mixing of frequencies from local vortex shedding and vibrations excited higher up on the riser with a time varying internal flow no significant changes in the viv response was seen when the wavelength of the density wave was less than λ c r l n however the stable viv at the middle of the riser was clearly disturbed when λ was close to λ c r leading to a decrease in fatigue damage simulations of a modified riser with reduced weight were also carried out to investigate what may happen when the internal flow makes up a larger portion of the total mass similarly to the original riser these simulations indicate a significant disturbance of the regular type of viv occurring in the upper middle part of the riser when λ λ c r on the other hand the irregular viv at the lower end was enhanced causing an overall increase in the maximum fatigue damage compared to the case with steady state internal flow finally simulations of vessel motion induced viv was performed and analyzed in these simulation the current velocity was set to zero and the riser top end was subjected to prescribed sinusoidal oscillations in heave and surge this created a low kc number oscillating flow which induced irregular cross flow viv with moderate amplitudes fatigue damage associated with a steady state internal flow and internal density waves with λ λ c r were compared and it was found that the density wave may increase the fatigue damage slightly the effect of the internal flow was however much smaller for vessel motion induced viv than in steady current to summarize the work presented here confirms that internal density waves in the conveyed slurry may influence viv of ocean mining risers it is difficult to find general guidelines as the fatigue damage was in most cases reduced but could also increase as a result of the internal flow however it appears clear that the internal density wave has a negligible effect on viv when λ λ c r this is reasonable because the riser can only feel the average density when the wavelength is very short on the other hand when λ λ c r riser viv may be affected although the actual effect is difficult to anticipate without resorting to numerical simulations e g using the present method or experiments acknowledgments this work was made possible through the centre for research based innovation move financially supported by the norwegian research council nfr project no 237929 and the consortium partners http www ntnu edu move 
22965,ocean mining emerges as a way of meeting future demands for valuable minerals risers conveying ore from the seabed to the surface must withstand large wave and current loads in addition vortex induced vibrations viv are an important source of fatigue however the viv of mining risers may be affected by particles flowing inside in this paper a novel framework for coupled analysis of risers with internal flow is utilized to study viv of a mining riser focus is on the effect of time varying internal slurry flows and the associated density waves traveling along the riser simulated viv response and fatigue damage are reported in detail to illuminate the effect of the period wavelength of the internal flow it is found that the internal flow produces significant changes to the viv fatigue damage if the wavelength of the internal density wave is close to λ c r l n where l is the riser length and n is the dominating viv mode the results suggest that careful analysis is necessary when designing a mining riser where internal density waves are expected to occur with a wavelength near or above the critical value in such cases the numerical method presented here is a useful tool keywords ocean mining vortex induced vibrations risers density waves fatigue 1 introduction the global demand for minerals is rising and traditional land based mines may struggle to meet future demands ali et al 2017 as a result various companies and organizations direct their attention towards the large mineral deposits in the deep ocean such as sea floor massive sulfides sms and manganese nodules sharma 2017 sms deposits are formed around black smokers on the ridges of tectonic plates and are characterized by high grades of metals such as copper zinc silver and gold petersen et al 2016 manganese nodules are found on deep abyssal plains and contain manganese nickel cobalt and copper much research about deep sea mining was conducted already in the 1970 s and commercial consortia such as the ocean minerals company omco carried out large scale tests of deep sea mining systems chung 2010 even though this pioneering work showed that deep sea mining is technologically feasible the interest declined due to sufficient supply from mines on land however this interest has recently been renewed and commercial mining is now planned to commence outside the coast of papua new guinea in 2019 nautilus minerals 2016 in spite of decades of research efforts there are many associated uncertainties and challenges in commercializing deep sea mining environmental issues are particularly important as the ecosystem around targeted resources may be vulnerable miller et al 2018 when it comes to technical challenges some of these are energy supply extraction vertical transportation from seabed to surface and mineral processing different alternatives have been suggested for the vertical transportation of ore such as mechanical lifting using a continuous bucket system or hydraulic lifting using slurry pumps another possibility is to lift the minerals by injecting compressed air into the liquid solid mixture a procedure called airlift schulte 2013 the slurry and airlift methods require a vertical pipe i e a riser for conveying the ore water mixture the riser is a critical component for such an ocean mining system and designers must be able to predict stresses and fatigue for the entire operation these extremely slender structures are subjected to large wave and current loads and numerical methods are required for computing the dynamic response see e g chung et al 1981 since risers are used extensively in the offshore industry for transportation of oil and gas much research has been carried out regarding their dynamic response see e g patel and seyed 1995 one important response type is the vortex induced vibrations viv that occur as a result of the oscillating fluid forces caused by flow separation and shedding of vortices because viv is of both practical importance and academic interest due to complicated fluid structure interaction the research on viv has been considerable as reflected by several reviews bearman 1984 williamson and govardhan 2004 wu et al 2012 although the basic vortex shedding process for stationary cylinders is reasonably well understood sumer and fredsøe 1997 the complexity increases as the cylinder is allowed to oscillate which may lead to unsteady chaotic response modarres sadeghi et al 2011 and higher harmonic forces that may be detrimental to the fatigue life modarres sadeghi et al 2010 a flexible cylinder will in general oscillate both in the cross flow cf and in line il directions and it has been found that the phase angle between the cf and il response has a significant effect on the forces wu et al 2016 although the displacements associated with viv are moderate the fatigue damage may in some cases be significant due to high modes of vibration combined with a relatively high frequency baarholm et al 2006 prediction of fatigue damage caused by viv is an important part of riser design although it is possible to predict viv based on first principles using computational fluid dynamics bourguet et al 2011 the required computing resources are still too large for a design tool as a result the offshore industry relies on empirical models such as shear7 viva and vivana vandiver and li 2005 triantafyllou et al 1999 larsen et al 2009 these tools operate in the frequency domain which means that non linear effects such as time varying mass and stiffness cannot be accounted for to deal with these effects the solution must be carried out in the time domain using a step by step integration of the equations of motion several empirical time domain methods have been proposed such as the wake oscillator models kurushina et al 2018 the artificial neural network approach by mainçon 2011 and the phase coupled synchronization model by thorsen et al 2017 a common challenge with all empirical models is to find parameters suitable for all flow regimes and cylinder configurations of practical importance although most of the knowledge about viv from the offshore industry can be directly applied to ocean mining there is at least one important difference which is the internal flow the density of the mineral ore is high up to around 3000 kg m3 and the presence of heavy particles may affect the dynamics of the riser in addition the density of the water particle mixture will probably not be constant along the riser density variations are likely to occur as particles of different size will have different velocities van wijk 2016 other sources of density variations can be changes in the production process start up shut down or that the mining machines are unable to deliver the ore at a constant rate no matter how or why density variations may occur it is of interest to study how such variations affect riser viv the published literature contains very few reports about viv in ocean mining risers wang et al 2017a studied vessel motion induced viv of a free hanging riser but did not account for any internal flow or density variations verichev et al 2011 discussed various excitation mechanisms relevant for mining risers and described how the internal flow may affect viv but focused on the instability buckling that occurs when the slurry velocity exceeds the critical value boomsma and blanken 2014 describe recent developments of vertical transportation technology including a simulation tool for riser dynamics that may include slurry density variations however no quantitative results were presented knudsen et al 2016 carried out numerical simulations of riser viv accounting for the time varying inertia and centrifugal forces caused by an internal flow of water and stone this study showed that the internal flow is capable of changing the maximum curvature of the riser but the effect on riser fatigue was not investigated thorsen and sævik 2018 assumed a sinusoidal density variation and used a simplified analytical model to predict the wavelength that would give the largest disturbance on viv the analytical model is however not capable of determining if the fatigue damage will increase or decrease as a result of the internal density wave based on previous work on the topic it seems clear that internal density variations may occur during vertical transportation of minerals and that this may affect the viv response of the riser however the actual effect is still unclear the goal of the present paper is to give new insight into how slurry density variations affect the fatigue life of ocean mining risers this is done by utilizing a novel framework for fully coupled simulation of the internal flow and riser viv the simulation tool consists of the following parts 1 1 d dynamic multi phase flow model including water and particles 2 non linear dynamic riser analysis including viv loads in time domain 3 data exchange between the structural analysis and the internal flow codes the numerical models are presented in the next section then simulations of an ocean mining riser undergoing viv are carried out and the fatigue damage associated with different slurry density variations is reported the effect of riser weight tension and top vessel motion is also investigated it should be noted that uncertainties are present in the model particularly related to the choice of empirical parameters however the model is expected to give a realistic picture of how internal density waves affect riser viv which is useful for determining if riser fatigue life decreases or increases as a result of density variations in the internal flow 2 numerical models 2 1 internal flow model the internal flow model adopted in this study is a one dimensional two fluid model originally developed for gas liquid two phase flows which is based on a finite volume lagrangian slug tracking model concept first tested by nydal 2012 and later extended and modified in several phd studies smith 2017 the simulation code is written in c using object oriented programming in the present work solid particles and water phases are treated as a part of liquid mixture for every control volume the continuity or mass equation for subfield f reads 1 m f t a b f ρ f u f u b n d a m f s r c where a b f is the boundary area u f the velocity of the subfield u b the velocity of the boundary and n a unit vector pointing out of the control volume mass sources and sinks are represented by the term m f s r c the subfield mass m f is defined as 2 m f ρ f α f v where the terms ρ f α f and v represents the subfield density phase fraction and total cell volume respectively the momentum equation is solved for the mixture field indicated by a subscript m t v m ρ m u m d v a m ρ m u m u b u m d a v m p x d v v m ρ m g h m cos θ x d v a m τ i d a 3 a m τ m w a l l d a v m ρ m g sin θ d v v m ρ m s r c u m s r c d v here p is the internal pressure θ the pipe inclination θ 0 for horizontal h m is the fluid height of the mixture and τ is shear stresses the terms on the right hand side of eq 3 represent pressure gradient hydraulic level gradient interface and wall friction gravity and finally a contribution from sources and sinks the wall shear stress τ m w a l l is computed based on assumption that the large particles tend to migrate away from the wall due to hydrodynamic lift and the near wall velocity profile is only slightly affected by the presence of particles engelmann 1978 hong et al 2002 ravelet et al 2013 the wall shear stress is modeled by water flowing at the mixture liquid velocity 4 τ m w a l l 1 8 λ m ρ m u m u m for the wall friction factor λ m we use haaland 1983 and the hagen poiseuille friction factors white 2011 for turbulent and laminar flow respectively the complete details of the internal flow model can be found in the work by smith 2017 subfield particle velocity u s and water velocity u f are computed from the liquid mixture velocity using slip velocity correlations van wijk 2016 5 u f u m α p ρ s ρ m w h 6 u s u m α p ρ s ρ m w h w h where α p is the local particle concentration and w h is the hindered particle settling velocity given by the correlation richardson and zaki 1954 7 w h 10 d d i w t 1 α p n where d is the particle diameter and d i is the internal diameter of the pipe the terminal velocity for a single particle is given as 8 w t 4 g d 3 c d ρ s ρ f 1 in eq 7 the single particle terminal velocity w t is corrected for relatively large particles by the factor 10 d d i and the local particle concentration the exponent n 2 4 and particle drag coefficient c d 0 44 are used in the present work ravelet et al 2013 2 2 riser dynamics the structural analysis is performed by the finite element program riflex marintek 2014 which is tailor made for dynamic analysis of slender marine structures the riser is modeled using beam elements formulated using a co rotated reference frame to account for large displacements and rotations in 3d space the non linear dynamic analysis is based on the incremental form of the dynamic equilibrium equation which is solved by the newmark β method and a newton raphson iteration procedure the external hydrodynamic loads per unit length at any point along the riser are calculated as 9 f c m ρ π d o 2 4 u n c m 1 ρ π d o 2 4 x n 1 2 ρ d o c d v n v n 1 2 ρ d o c v v n j 3 v n cos ϕ exc the three first terms make up morison s equation faltinsen 1993 while the final term represents the oscillating force due to vortex shedding as proposed by thorsen et al 2017 c m and c d are the inertia and drag coefficients while c v determines the strength of the vortex shedding force furthermore u n is the normal component i e perpendicular to the cylinder axis of the fluid particle acceleration x n is the normal component of the cylinder acceleration and v n is the normal component of the relative fluid velocity the relative flow velocity is given as v u x where u is the incoming flow velocity and x is the velocity of the cylinder cross section ρ is the seawater density and d o is the outer diameter of the cross section j 3 is a unit vector pointing in the direction of the cylinder axis which means the cross product in eq 9 ensures that the vortex shedding force is acting perpendicular to the instantaneous relative velocity v n in reality there will also be vortex shedding forces parallel to v n causing in line viv and an in line excitation term was implemented in eq 9 by ulveseter et al 2018 the displacements associated with in line viv are however significantly smaller than the cross flow although stresses can be of similar magnitude and the in line excitation term is omitted in this study a study on in line viv of mining risers remains to be done in the future the oscillations of the vortex shedding force are described through the time varying phase ϕ exc the evolution in time is given by eqs 10 11a and 11b 10 d ϕ exc d t 2 π f ˆ exc v n d o 11 f ˆ exc f ˆ 0 f ˆ max f ˆ 0 sin ϕ y r e l ϕ exc ϕ y r e l ϕ exc 0 f ˆ 0 f ˆ 0 f ˆ min sin ϕ y r e l ϕ exc ϕ y r e l ϕ exc 0 eq 10 gives the relationship between the dimensionless and the actual frequency while eqs 11a and 11b models the synchronization between the vortex shedding and the cylinder motion here ϕ y r e l is the instantaneous phase of the relative cross flow velocity of the cylinder such that the argument of the sine function represents the phase difference between the cylinder cross flow velocity and the vortex shedding force the essential feature of the synchronization model is that it makes it possible for the vortex shedding force to vary its instantaneous dimensionless frequency between f ˆ min and f ˆ max and lock on to the frequency of vibration for more details see thorsen et al 2017 the empirical parameters used for the external hydrodynamic loads in the present study are given in table 1 the dimensionless frequency parameters are chosen such that the excitation region coincides with experimental observations by gopalkrishnan 1993 i e extending from f ˆ 0 125 to f ˆ 0 3 with maximum energy transfer around f ˆ 0 17 2 3 effect of internal flow on structural dynamics the effect of the internal flow on the structural dynamics is presented in the following first of all the weight of the internal fluid will contribute to the effective submerged weight of the pipe 12 w s w p i p e w f ρ e g a e where w p i p e is the dry weight of the empty pipe w f is the weight of fluid inside including water and particles and the last term is the buoyancy during viv the riser is curved and the deformation changes over time as a result the fluid particles inside will follow a time varying curved path to illustrate this consider a beam element in a deformed state as shown in fig 1 assuming the pipe deformations are small in the co rotated frame of reference the time dependent position of an internal fluid particle can be expressed as 13 r f t v t j 3 u j 1 v j 2 where v is the internal slurry velocity while u and v are the lateral displacements of the beam in the local x and y directions respectively j 1 j 2 and j 3 are orthogonal unit vectors as shown in fig 1 and t is some arbitrary instant of time the velocity of a fluid particle is found as the material derivative of the position 14 v f d r f d t r f t v r f z v j 3 u t j 1 v t j 2 v u z j 1 v z j 2 the fluid particle acceleration is found through similar differentiation of the velocity 15 a f d v f d t v f t v v f z 2 u t 2 2 v 2 u t z v 2 2 u z 2 j 1 2 v t 2 2 v 2 v t z v 2 2 v z 2 j 2 according to newton s laws a lateral force on the fluid must be present to cause this acceleration an equal and opposing force will act on the pipe element and this force per unit length must be equal to m f a f where m f is the internal slurry mass per unit length hence the following three force components will act on the pipe as a result of the internal fluid see also paıdoussis and li 1993 16 f inertia m f 2 u t 2 j 1 m f 2 v t 2 j 2 17 f coriolis 2 m f v 2 u t z j 1 2 m f v 2 v t z j 2 18 f centrifugal m f v 2 2 u z 2 j 1 m f v 2 2 v z 2 j 2 the inertia term is independent of the internal flow velocity and is accounted for in the numerical model by adding the mass m f to the element mass matrix for the degrees of freedom corresponding to lateral motion the coriolis and centrifugal forces are added to the element load vector in the structural dynamics code it should also be mentioned that the internal pressure will induce stresses in the pipe wall that may change the unstressed element length for a mining riser with a free lower end this will not influence the effective tension and hence the global dynamics are unaffected the pressure effect is therefore ignored in the present study 2 4 effect of structural dynamics on internal flow the structural dynamics affects the internal flow for two reasons firstly the geometry changes with time and secondly the acceleration of the pipe causes fictitious forces on the fluid inside the combined effect of time varying geometry and acceleration is captured using an effective gravity concept the acceleration of gravity and the acceleration of the pipe with negative sign is added and treated as an effective gravity vector and an effective inclination when these quantities are applied in the solution of the momentum equation for the internal flow the effect of the pipe acceleration and time varying geometry are taken into account as the internal flow model only considers forces and motion in the axial direction the effect of lateral acceleration is not accounted for 3 viv case study 3 1 overview the numerical model described above is used to study the viv and fatigue of an example mining riser compared to traditional oil and gas risers the essential difference is the internal flow a hydraulic lift method is assumed where the internal flow consists of water and ore particles the goal of this study is to investigate if and how the internal flow affects the viv and associated fatigue damage of the riser although viv of risers used for oil and gas transportation is well studied a complete understanding of the phenomenon is still lacking with the exception of cfd based prediction methods all available viv analysis tools including the present viv load model are empirical and unable to replicate the true complexity of viv where frequencies and amplitudes can vary randomly in time and space nevertheless such models are effective when it comes to predicting average quantities such as the dominating frequency mode and fatigue damage over time with this in mind the results presented in this paper must be seen as approximations towards the actual riser dynamics that can be expected in a real mining scenario however the applied viv model has been proven accurate in a wide variety of cases including current oscillating flow and irregular waves ulveseter et al 2018 thorsen et al 2016 it is therefore expected that the model will provide a realistic picture of the effects of internal flow on riser viv as an example a water depth of 2350 m and a steel riser with a length of 2300 m is chosen see fig 2 this corresponds approximately to the depth at loki s castle which is an active hydrothermal vent field located along the arctic mid atlantic ridge pedersen et al 2010 the inner riser diameter is taken as 0 4 m and the riser wall thickness is set to 20 mm a clump weight of 100 tonnes is attached to the free lower end to avoid excessive drift off and this also represents the mass and weight of a slurry pump remaining mechanical properties of the riser are given in table 2 the applied environmental load is a linearly sheared current with a magnitude of 1 m s at the surface and 0 5 m s at the seabed the conveyed ore is modeled as particles with a density of 2540 kg m3 and a uniform diameter of 10 mm in reality the particle size will vary over some range depending on the method of crushing and or filtering the riser is discretized into 460 beam elements and the time step in the structural analysis is set to 0 025 s corresponding to roughly 100 time steps per viv period it was checked that element and time step size are sufficiently small for convergence in space and time in the internal flow model the minimum and maximum section length is set to 2 m and 4 m respectively the communication between the structural and internal flow simulation occurs for every time step in the structural analysis while the time step in the internal flow simulation is dynamic i e controlled by the simulation itself according to the cfl criterion structural damping is included through the proportional damping formulation c a 1 m a 2 k where m and k are the global mass and stiffness matrices the values used for the damping parameters are a 1 0 and a 2 7 10 3 giving a damping ratio of approximately 1 at the viv frequency note that the structural damping is small compared to the hydrodynamic damping which is represented by the drag term in eq 9 3 2 base case steady state internal flow a steady state flow meaning a constant mass flow rate of water and particles at the inlet lower end is used as a base case the selected flow rates are 400 kg s of water and 200 kg s of particles this results in a mixture with an average density of 1275 kg m3 where the average water velocity is 4 m s and the average particle velocity is 3 55 m s the external current is activated and the simulation progresses for 1000 s the first 700 s are discarded to ensure that a steady state has been reached the flow rate chosen for this study is close to what can be expected in an actual ocean mining operation frimanslund 2016 the importance of the flow velocity can be seen from eqs 16 18 which shows that the inertia force is independent of flow rate while the coriolis and centrifugal terms increase with the flow velocity it is well known that the centrifugal term causes instabilities for high flow velocities but this does not occur at the moderate velocities considered here hence in the present study the dominating internal flow effect is the mass variations the riser experiences a mean displacement in the x direction due to the drag forces as shown in fig 3 a as stated previously the fluctuating drag and in line viv is not included in the present analysis snapshots of the cross flow displacements are shown in fig 3b together with the maximum and minimum envelopes it is seen that the amplitude of vibration is slightly below 0 5 m which is close to the outer diameter of the riser d o 0 44 m this is in good agreement with observations from model tests during fully developed steady state viv see e g trim et al 2005 it is also noted that the response seems to be well organized and regular in the upper part of the riser and more irregular towards the lower end in general the response is comparable to standard viv without internal flow assuming the average mass is identical the main difference between a steady state internal flow and no internal flow are the centrifugal force see eq 18 which acts as a negative stiffness for moderate flow velocities this term is insignificant compared to the riser tension to provide more understanding of the viv response along the riser time series and fourier transforms are studied more closely the cross flow displacement at z 1000 m is shown in fig 4 and the fft shows there is a single dominating frequency at 0 39 hz this correspond to the expected vortex shedding frequency f 0 17 u t o p d o where 0 17 is the dimensionless frequency where the vortex shedding provides the largest energy input see also section 2 2 and description of empirical hydrodynamic parameters this single constant frequency explains why the response looks regular in the upper part of the riser as seen in fig 3b the cross flow displacement at z 2250 m is shown in fig 5 the time series fig 5a looks chaotic which is confirmed by the broad banded response found in the fft fig 5b which includes two distinct peaks the peak with the highest frequency is at 0 39 hz which is the same as observed higher up on the riser this frequency peak is likely caused by viv in the upper part of the riser spreading downwards as traveling waves the next peak is found around 0 25 hz which is excited by the local vortex shedding in the lower part of the riser because the current velocity reduces towards the seabed the local vortex shedding frequency will also reduce the mixture of a high frequency caused by traveling waves from the upper part and lower frequencies excited locally explains why the response is more chaotic towards the bottom which was also seen in fig 3b the dynamic stresses in the riser are of large interest due to their potential for causing material fatigue in the present study focus is on the stresses caused by cross flow viv these are found from the cross flow bending moment as 19 σ c f m c f i d o 2 where i is the second moment of area for the riser cross section and d o is the outer steel diameter the standard deviation of σ c f along the riser is shown in fig 6 a which shows that the highest stresses are found close to the middle and at the lower end time series of the cross flow stresses are shown in fig 6b at the position z 1000 m top and z 2250 m bottom the stress at the middle of the riser is highly regular with a constant amplitude and frequency which is in agreement with the previous observations at the lower end the stress amplitude varies strongly with the largest amplitudes up to 20 mpa this can be explained by the superposition of high frequency stresses caused by traveling waves from the upper part and lower frequency stresses generated by the local vortex shedding 3 3 regular density waves the riser was subjected to a time varying internal flow to investigate how this affects the viv a regular density wave was generated by turning the inflow of particles on and off with a specified period the inflow of water was kept constant at 400 kg s like in the steady internal flow case while the inflow of particles varied between 0 and 400 kg s this means that the average density along the riser was the same as before around 1275 kg m3 this lead to a traveling density wave and the distribution along the riser is shown in fig 7 for two different flow periods it is seen that the particles tend to disperse as they are carried upwards such that the density variations are smaller towards the upper end this effect is largest for the short periods simulations were carried out with internal flow periods ranging from 10 to 100 s the density wavelength taken as the distance between the fronts of consecutive particle batches increases linearly with the period an overview of all the cases and the corresponding wavelengths is given in table 3 the internal flow wavelength has in previous work been identified as an important parameter with respect to the effect on riser viv thorsen and sævik 2018 and the critical length is λ c r l n where n is the dominating mode number for the viv for the present case with a complicated response type it is not straightforward to point out a single dominating mode instead l n is estimated by measuring the distance between points of maximum dynamic bending moment along the riser this results in a critical wavelength of λ c r 98 m the standard deviation of the cross flow bending stresses along the riser with an internal density wave with t 30 s are shown in fig 8 a compared to the results from the steady internal flow case fig 6a the stress values are slightly reduced the actual time series of bending stress are shown in fig 8b with z 1000 m at the top and z 2250 m at the bottom looking at the top figure first it is seen that the maximum stress is almost unchanged compared to the case with steady state flow however the amplitude is no longer constant and at some point around t 950 s the viv is clearly disrupted moving on to the stress close to the bottom this looks irregular like in the case with steady internal flow the fatigue damage along the riser is calculated in three steps first rainflow counting brodtkorb et al 2000 of the stress time series is performed to find stress cycles then the damage for each cycle is computed based on an s n curve of the form n a δ σ m where n is the number of cycles to failure for a stress range δ σ the selected curve is taken from dnv gl 2010 b2 in seawater with cathodic protection with log a 14 685 and m 4 the change in slope occurring for n 10 6 is disregarded for simplicity finally the total damage is found by summing the contributions from each cycle according to the miner palmgren rule the annual fatigue damage is found by multiplying with the number of seconds per year and dividing by the number of seconds in the simulation the fatigue analysis results from the different simulations are shown in fig 9 the results from the base case steady state flow is shown as a dotted line the fatigue damage is seen to be largest close to the middle of the riser and also close to the lower end which is because these are the locations with the highest dynamic stresses with reference to the base case the fatigue damage distribution changes very little for the cases with t 10 s and t 20 s however when the period of the internal flow is increased to t 30 s the fatigue damage is significantly decreased this confirms that the internal flow may affect viv when the length of the density wave is close to λ c r as suggested by previous work thorsen and sævik 2018 another interesting finding is that the fatigue damage at the lower end is less affected which means that for some of the cases the point of maximum fatigue changes from the middle to the lower end when the period is increased further the fatigue damage is still reduced compared to the base case but the largest reduction is for t 30 s to illustrate the importance of the internal flow period the maximum fatigue damage along the riser is plotted as a function of the internal flow period in fig 10 the figure indicates that the fatigue damage is virtually unaffected by the density wave for t 20 s and stabilizes around 70 of the base case damage for periods larger than 50 s it should be noted that the present study cannot cover all possible periods and it is conceivable that the fatigue damage will increase compared to the base case for some periods which are not included here 3 4 effect of weight reduction an actual mining riser may have a different mass per unit length than in the previous example for instance if the pipe has a smaller wall thickness changing the mass will have an effect on riser dynamics for several reasons firstly reducing the mass increases the natural frequencies but reduced mass means lower weight which in turn means less tension and because tension is the main contribution to lateral stiffness a reduction in tension will lead to lower natural frequencies hence there are two opposing effects on the natural frequencies another result of a reduction in riser mass is that the internal fluid particle mixture becomes a larger portion of the total mass assuming that the inner riser diameter and the flow itself is unchanged this may lead to a more prominent effect from the internal density wave to investigate this the riser in the present case study is modified as follows wall thickness is reduced to t 15 mm clump weight mass lower end is reduced to 50 tonnes compared to the original riser the top tension is reduced from 5720 kn to 4100 kn in addition the riser steel mass per unit length is reduced from 206 kg m to 156 kg m for comparison the mass of the slurry is approximately 182 kg m when the density is at its maximum for the cases with time varying density the base case simulation steady state internal flow was repeated with the modified riser and the resulting cross flow bending stresses are shown in fig 11 both at z 1000 m and z 2250 m the stresses show no significant changes compared to the original riser fig 6 however the dominating viv mode has increased slightly and the critical wavelength is now estimated as λ c r 82 5 m based on the bending moment variation along the riser not shown an internal flow period of t 20 s should now give a wavelength very close to the critical value see table 3 therefore simulations with this internal flow period are carried out with the modified riser and the resulting stresses are shown in fig 12 looking at the top figure first which shows the stresses close to the middle of the riser it is seen that the maximum amplitude is almost unchanged however the stable viv response is at some point interrupted which was also observed for the original riser see fig 8 the middle part of the riser is in the viv excitation zone where synchronized vortex shedding is feeding energy into the oscillating system the amplitude in this region is large and because the hydrodynamic damping increases strongly with amplitude a further increase in amplitude would require large amounts of energy therefore it is impossible for the internal flow to increase the viv response in this region on the other hand this stable type of viv may be disturbed by changes in the natural frequencies as the vortex shedding continuously strives to synchronize with the motion of the riser this seems to be what happens e g around t 800 s fig 12 moving on to the stresses close to the bottom of the riser something interesting is seen the stress signal is still irregular like in fig 8 but large amplitude bursts are now clearly seen which were less visible before these large amplitude bursts are found to be associated with short periods of almost steady state viv i e less irregular motion this is likely to be caused by changes in the natural frequency of the riser associated with the internal density variations a closer look at fig 12 shows that when the largest amplitudes occur the dominating frequency at the bottom is lower than at the middle of the riser this suggests that the large amplitude vibrations are caused by local vortex shedding at the bottom where the current velocity is low said differently continous changes in the mass distribution trigger sporadic synchronization between one of the natural frequencies and the vortex shedding at the lower end the annual fatigue damage along the modified riser with the two different internal flows are shown in fig 13 the curve for the steady state internal flow looks similar to the original fig 9 although the maximum fatigue damage is slightly higher than before moving on to the case with the internal density wave t 20 s two interesting aspects should be pointed out firstly the fatigue damage close to the middle of the riser decreases this is because the steady state viv is sometimes interrupted which was also seen in the stress signal fig 12 secondly the fatigue damage close to the bottom does not decrease as it did for the original riser but instead increases by a factor of 2 8 this means the maximum fatigue damage along the riser increases significantly when going from a steady state internal flow to a time varying flow with t 20 s the increase in fatigue close to the bottom is caused by the large amplitude bursts seen in fig 12 4 vessel motion induced viv the case study presented in section 3 considered viv caused by a steady current when the upper riser end was fixed in reality there will be waves on the sea surface causing vessel motions and wave loads along the riser the heave and surge motions of the vessel may be transferred to the riser causing a relative oscillatory flow similarly as for the stationary current vortex shedding and viv may also occur in an oscillating flow depending on the velocity of the relative flow and the keulegan carpenter number defined as k c u m a x t d o a low kc number means few vortex sheddings per flow reversal which gives little time for stable viv to develop for higher kc numbers the response may look more like viv in steady flow but the response will build up and die out every time the flow direction changes viv of risers in oscillating flow has previously been studied by e g lyons and patel 1986 and fu et al 2014 the purpose of this section is to investigate the cross flow viv of the example mining riser caused by regular sinusoidal excitation at the top end as the oscillating flow is associated with a different type of viv the effect of the internal flow is not necessarily the same as in the previous cases with a constant current to study this the original riser presented in section 3 was subjected to prescribed top end motions corresponding to a regular wave with h 3 m and t 10 s vessel motions are prescribed in surge and heave such that the motions of the riser top end is given as x t o p x 0 sin ω t φ x and z t o p z 0 sin ω t φ z using a representative transfer function rao the amplitudes and phases angles are x 0 0 36 m φ x 154 z 0 1 14 m and φ z 17 to get a clear picture of the vessel motion induced viv only the current velocity is set to zero simulations were performed both with and without wave induced water particle velocities and accelerations but it was found that the wave forces gave a negligible effect on the response this is because the water particle motions associated with the wave decay rapidly with depth and the wave induced velocity was reduced to 1 before 120 m depth wave forces were therefore omitted which means the viv response presented in the following is caused by prescribed top end oscillations in still water 4 1 results snapshots of the displacements caused by the prescribed top end motion and the steady state internal flow are shown in fig 14 the in line displacement a is caused directly by the top end motion as the disturbance travels down the riser despite of the hydrodynamic damping the in line motion near the lower end is around the same magnitude as the prescribed motion at the top this means the riser will experience a significant oscillating flow along the whole length with the potential to excite viv in the cross flow direction at the top end the maximum relative velocity is u m a x 2 π x 0 t 2 π 0 36 m 10 s 0 23 m s this corresponds to a kc number slightly above 5 which means we are in the low kc number range where the viv frequency is expected to be close to the oscillating flow frequency sumer and fredsøe 1988 the predicted cross flow viv caused by the relative oscillating flow and the steady state internal flow is shown in fig 14b vibrations are clearly present although the amplitude is small compared to the viv caused by a stationary current ref fig 3 the low amplitude can be understood from the fact that a number of vortex shedding cycles are necessary to reach a stable maximum amplitude however due to the low kc number in this case fully developed viv is not possible the predicted amplitude is in good agreement with results by wang et al 2017a b who performed experimental and numerical studies on viv of a free hanging riser at low kc numbers this strengthens the confidence in the present viv analysis method for low kc number flows the time series and fft of cross flow displacement at z 2000 m is shown in fig 15 again for the riser with a steady state internal flow the time series is irregular as the viv is unable to reach a steady state before the oscillating flow reverses the fft reveals two peaks where the lowest frequency is close to the expected frequency of vortex shedding which is seen from the relationship f f ˆ u m a x d o 0 07 hz assuming a dimensionless frequency of f ˆ 0 14 which was found suitable for oscillating flow by wang et al 2017a the smaller peak at a higher frequency is associated with a sum frequency effect caused by the time varying amplitude of the vortex shedding force due to the oscillating flow the riser with top end oscillations was also subjected to an internal time varying flow based on the variations in bending moment along the riser the dominating cross flow mode was estimated to be n 9 this is also possible to see from the displacements shown in fig 14b based on this the critical length of the internal density wave is λ c r 2300 m 9 255 6 m an internal flow period of t 66 s was selected as this gives a wavelength very close to the critical according to table 3 the effect of the internal density wave is illustrated in fig 16 which shows the bending stress at the location where the stresses are largest which was found to be z 2225 m the top figure shows the results from the simulation with steady state internal flow while the bottom figure is for a density wave with t 66 s from visual inspection the results look very much the same although the amplitude varies marginally more for the case with time varying internal flow the reason why the effect of the internal flow is so small in this case may be the low frequency and mode of vibration induced by the oscillating relative flow it is known from experiments that low mode viv is more stable which means the response is not so easily disturbed by the internal flow the cross flow fatigue damage along the riser for the cases with top end motion is shown in fig 17 for the steady state internal flow as well as the case with an internal density wave the fatigue damage is found to be largest close to the bottom which is reasonable because this is where the tension is lowest thereby favoring higher modes and curvatures compared to further up on the riser comparing the two different cases it is seen that the maximum fatigue damage is 14 higher for the case with the internal density wave this small difference is caused by slightly higher stress ranges which are amplified by the exponent m 4 in the s n curve for both cases the annual fatigue damage is found to be very low this is a result of the low relative velocities induced by the riser oscillations and it does not mean that vessel motion induced viv will never cause significant fatigue damage larger top end motions will give larger flow velocities which in turn will increase the viv frequency and mode thereby strongly increasing the fatigue damage 5 conclusions in this work a novel framework for coupled riser dynamics internal flow analysis was utilized to investigate the viv behavior of an ocean mining riser focus was on density variations in the internal slurry flow and the effects this may have on riser fatigue which has previously received little attention a case study was carried out where an example riser was subjected to viv caused by a steady current along with different types of internal slurry flows the internal flows considered were a steady state flow with a constant mixture density and time varying flows generated by turning the inflow of particles on and off with periods ranging from 10 to 100 s the time varying flows were associated with density waves of different wavelengths moving up the riser the viv response in steady current and with different internal flows were studied in detail in terms of displacements stresses and fatigue along the riser with a steady state internal flow the viv response was characterized as regular in the upper part and irregular at the bottom due to the mixing of frequencies from local vortex shedding and vibrations excited higher up on the riser with a time varying internal flow no significant changes in the viv response was seen when the wavelength of the density wave was less than λ c r l n however the stable viv at the middle of the riser was clearly disturbed when λ was close to λ c r leading to a decrease in fatigue damage simulations of a modified riser with reduced weight were also carried out to investigate what may happen when the internal flow makes up a larger portion of the total mass similarly to the original riser these simulations indicate a significant disturbance of the regular type of viv occurring in the upper middle part of the riser when λ λ c r on the other hand the irregular viv at the lower end was enhanced causing an overall increase in the maximum fatigue damage compared to the case with steady state internal flow finally simulations of vessel motion induced viv was performed and analyzed in these simulation the current velocity was set to zero and the riser top end was subjected to prescribed sinusoidal oscillations in heave and surge this created a low kc number oscillating flow which induced irregular cross flow viv with moderate amplitudes fatigue damage associated with a steady state internal flow and internal density waves with λ λ c r were compared and it was found that the density wave may increase the fatigue damage slightly the effect of the internal flow was however much smaller for vessel motion induced viv than in steady current to summarize the work presented here confirms that internal density waves in the conveyed slurry may influence viv of ocean mining risers it is difficult to find general guidelines as the fatigue damage was in most cases reduced but could also increase as a result of the internal flow however it appears clear that the internal density wave has a negligible effect on viv when λ λ c r this is reasonable because the riser can only feel the average density when the wavelength is very short on the other hand when λ λ c r riser viv may be affected although the actual effect is difficult to anticipate without resorting to numerical simulations e g using the present method or experiments acknowledgments this work was made possible through the centre for research based innovation move financially supported by the norwegian research council nfr project no 237929 and the consortium partners http www ntnu edu move 
22966,this paper addresses the design of an improved line of sight los based adaptive trajectory tracking controller for an under actuated auv subjects to highly coupled nonlinearities ocean currents induced uncertainties and input saturation the influences of ocean currents on the auv are expressed in a comprehensive way such that both the kinematic and dynamic models of auv are established with ocean currents extended disturbance observers edo are utilized to estimate the ocean currents induced uncertainties as well as their time derivatives an improved los guidance law is designed by introducing an auxiliary variable to the conventional los and utilizing extended disturbance observers to estimate the ocean current induced disturbances in the kinematic model edo based adaptive terminal sliding mode control method is employed for dynamic control to improve the tracking performance and converging rate in addition the influence of actuator saturation is weakened by anti windup compensator rigorous theoretical analysis and extensive simulation studies demonstrate that the proposed approach has good tracking accuracy stability and anti jamming ability thus leading to satisfying trajectory tracking control keywords auv trajectory tracking ocean currents improved los guidance extended disturbance observer adaptive terminal sliding mode control input saturation 1 introduction autonomous underwater vehicles auvs have received significant attention in the past several decades due to the widespread applications across diverse fields wynn et al 2014 zhang et al 2015a 2018b to complete underwater tasks perfectly it is critical to design an efficient and robust motion control system however performing precise motion control of an auv is a formidable task considering the complex model nonlinearities unknown hydrodynamic coefficients and time varying ocean currents induced disturbances the basic motion control tasks of auv include point stabilization path following and trajectory tracking lapierre and soetanto 2007 point stabilization refers to the problem of steering a vehicle to a final target point with a desired orientation path following control aims at regulating a vehicle to converge to and follow a desired path without any temporal specifications trajectory tracking requires a vehicle to track a time parameterized reference trajectory since trajectory tracking is more complicated compared with point stabilization and path following the trajectory tracking of an auv in horizontal plane will be studied in this paper time varying ocean current is a huge obstacle to achieving accurate trajectory tracking since it brings great difficulties to precise modeling and controller design for an auv moreover huge ocean currents can even cause instability and affect the safety of auv an increasing number of papers have addressed the topic of auv control under ocean currents patre et al 2018 zhang et al 2015b however in some papers the influence of the ocean current is only considered in the dynamic model yu et al 2018 or kinematic model bi et al 2010 but not considered completely in this paper to design a trajectory tracking controller that can deal with various ocean currents the influences of ocean currents on an under actuated auv are investigated in a comprehensive way both kinematic and dynamic models of auv are established with ocean currents where the kinematic model is developed in terms of the relative velocity with respect to the ocean current disturbances and the dynamic model is developed to include the influences of ocean currents induced uncertainties after auv modeling the trajectory tracking problem is divided into two sub problems namely kinematic control and dynamic control and both the kinematic and dynamic controllers are designed considering the influences of ocean currents the performance of trajectory tracking is largely dependent on the guidance system a popular and effective way to achieve kinematic guidance control is to implement a line of sight los guidance law mimicking an experienced sailor fossen and pettersen 2014 nie and feng 2016 the uniform semi global exponential stability usges was proved to be achievable for a class of proportional los guidance laws used for vehicle path following control fossen and pettersen 2014 a narmax self tuning controller was designed for waypoint tracking for an auv based on line of sight guidance law rout and subudhi 2017 in xiang et al 2018 the research of fuzzy logic control based los guidance and control in marine robotic vehicle is reviewed however the traditional los guidance law has exhibited limitations in the case when the vehicle is exposed to unknown external disturbances to improve the adaptability and tracking performance plenty of improved los guidance laws have been proposed in liu et al 2016 a novel predictor based line of sight plos guidance law was proposed for the marine surface vehicles where a predictor was developed for the estimation of vehicle sideslip due to environmental disturbances two nonlinear adaptive path following algorithms were tested for both rectilinear and curvilinear path following problems and showed effective compensation for time varying drift forces due to waves wind and ocean currents fossen and lekkas 2017 in bibuli et al 2014 an ilos guidance law was applied to an under actuated unmanned semi submersible vehicle ussv for path following of straight lines which added integral action to increase robustness with respect to environmental disturbances such as sea currents wind and waves that unavoidably affect maritime operations in miao et al 2017a an improved compound line of sight clos guidance law was proposed based on the time delay control method and the reduced order linear extended state observer lesos technique which can estimate the unknown sideslip angle and can compensate for the influences of time varying ocean currents in liu et al 2017 an eso based line of sight guidance law was proposed for path following of under actuated marine surface vehicles with exact sideslip compensation in caharija et al 2016 an integral line of sight ilos guidance method was proposed for path following tasks of underactuated marine vehicles operating on and below the sea surface where the vehicles were regulated to follow straight lines by compensating for the drift effect of environmental disturbances such as currents wind and waves inspired by above considerations an improved line of sight ilos guidance law is employed in this paper which introduces an auxiliary variable to the conventional los guidance law and utilizes extended disturbance observers to estimate the ocean current induced disturbances in the kinematic model dynamic control of auv is another challenging subject of trajectory tracking considering the complex model nonlinearities unknown parameter uncertainties ocean currents induced disturbances and actuator saturations two problems are usually encountered when achieving accurate and robust dynamic control the first one is how to improve the system robustness despite the complex unknown external disturbances zhang et al 2018a which could severely degrade the closed loop system performance the second one is how to solve the problem of actuator saturation which may cause control effect reduction and even instability sarhadi et al 2016 zheng and sun 2016 in recent decades a number of significant robust control methods have been developed for dynamic control including but not limited to h infinity control roche et al 2011 adaptive control rezazadegan et al 2015 sliding mode control patre et al 2018 xiang et al 2017a fuzzy logic control chen et al 2016 backstepping control miao et al 2017b neural network method wang et al 2015 chu et al 2017 xiang et al 2017b optimal control qiao et al 2018 and deep learning carlucho et al 2018 in shen et al 2018 a novel lyapunov based model predictive control lmpc framework was developed to utilize computational resource online optimization to improve the trajectory tracking performance an anti disturbance constrained controller is developed by designing a command governor and a disturbance observer where the disturbance observer is developed to estimate the lumped disturbance composed of parametric model uncertainties modeling errors and unknown environmental forces peng et al 2018 in cui et al 2017 an adaptive neural network control was developed for a fully actuated autonomous underwater vehicle in the horizontal plane which employs two neural networks nns to evaluate the long time performance of the designed control and compensate for the unknown dynamics in kim et al 2016 an enhanced time delay controller tdc was proposed for the position control of an autonomous underwater vehicle auv under disturbances where an integral sliding mode controller was supplemented to the conventional tdc to improve the control precision and robustness in chu et al 2016 a new adaptive neural network control was developed for underwater vehicles where local recurrent neural network is used to approximate the unknown nonlinear functions and an adaptive observer is introduced for state estimation in fischer et al 2014 a novel method was proposed to compensate for bounded external disturbances and model uncertainties where the integral of the error sign control structure was presented in peng and wang 2018 an output feedback path following controller was designed for auv based on an extended state observer and projection neural networks where an extended state observer eso is developed to recover the unmeasured velocities as well as to estimate total uncertainty induced by internal model uncertainty and external disturbance input saturation caused by physical actuators is another technical challenge for dynamic control designing a controller without taking into account the input saturation may lead to failure of control or even instability of the auv an increasing number of papers have addressed the problem of input saturation liang and jia 2017 ellenrieder 2018 an anti windup compensator was utilized in cui et al 2016 to solve the problem of attitude control subjected to actuator saturation in shojaei 2016 multi layer neural networks were combined with an adaptive robust control strategy to deal with the actuator saturation and model uncertainties including unknown vehicle parameters approximation errors and constant or time varying environmental disturbances induced by waves and ocean currents in li et al 2015 disturbance observers were designed to compensate for the disturbance caused by unknown input saturation fuzzy approximation errors and other uncertain disturbances motivated by the afore mentioned analyses this paper proposes an improved line of sight based adaptive trajectory tracking controller for an under actuated auv subjects to ocean currents and input saturation the main contributions are summarized as follows 1 extended disturbance observers are employed to deal with the ocean currents induced uncertainties in both kinematic and dynamic models which estimate not only the uncertainties but also the time derivatives of uncertainties 2 an improved los guidance law is utilized to steer the vehicle towards the desired trajectory where an auxiliary variable is introduced to the conventional los guidance law and extended disturbance observers are utilized to estimate the ocean current induced disturbances in the kinematic model 3 an adaptive robust dynamic controller is designed which employs terminal sliding mode control to improve system robustness and asymptotic convergence and applies an anti windup compensator to weaken the influence of actuator saturation 4 the uniformly ultimately bounded convergence of all closed loop signals is guaranteed by lyapunov analysis and the robustness and effectiveness of the proposed control method are tested and validated through plenty of numerical simulations the remainder of this paper is organized as follows section 2 presents the auv models with ocean currents derives the tracking error dynamics in horizontal plane and formulates the trajectory tracking control problem section 3 proposes the improved line of sight based adaptive trajectory tracking control scheme and presents the detailed deriving and proving process section 4 validates the previous analysis and design through plenty of simulation cases and discussions section 5 demonstrates the conclusions of this work 2 auv modeling and problem formulation 2 1 auv model considering ocean currents the auv considered in this paper is assumed to be neutrally buoyant following standard practice the kinematic and dynamic model of the auv in horizontal plane can be described by the motion components in surge sway and yaw degrees of freedom the definitions of the main parameters of the auv model used in this paper are presented in appendix a considering the influences of ocean currents the kinematic model of auv can be expressed in terms of relative surge and sway velocities as follows 1 ψ r x u r cos ψ v r sin ψ v x y u r sin ψ v r cos ψ v y where v x and v y are velocity components of the time varying ocean currents expressed in the x and y directions of inertial reference frame u r v r and r are the relative surge sway and yaw velocities with respect to the water neglecting the motions in heave roll and pitch directions the 3 dof dynamic model of auv in horizontal plane is simplified as 2 u r f u u r v r r g u x t d u v r f v u r v r r d v r f r u r v r r g r δ d r where d u d v and d r denote compound uncertainties with unknown upper bounds x t is the propeller thrust force along the vehicle s surge motion δ is the angle of the yaw rudder f u u r v r r f v u r v r r f r u r v r r g u and g r are known nonlinear functions as shown in 3 3 f u u r v r r m v r r m x g r 2 m y g r x u u u r u r x u u r x v r v r r x r r r 2 m x u g u 1 m x u f v u r v r r m u r r m y g r 2 m x g r y v v v r v r y r r r r y v v r y r r y u r u r r y u v u r v r m y v f r u r v r r m x g v r u r r m y g u r v r r n v v v r v r n r r r r n v v r n r r n u r u r r n u v u r v r i z z n r g r n u u δ r u 2 i z z n r remark 1 as shown in dynamic model 2 the auv discussed in this paper has three degrees of freedom whereas the number of independent control inputs is two due to no actuator in sway direction therefore the auv is a second order under actuated system remark 2 the influences of ocean currents are fully taken into account in this paper the kinematic model 1 is expressed in terms of relative surge and sway velocities and the ocean current forces of dynamic model 2 are implemented by replacing the generalized velocity vector in the hydrodynamic terms with relative velocities remark 3 for marine vehicles there exists inherent actuator saturation naik and singh 2007 zheng et al 2017 therefore the propeller thrust and the yaw rudder angle of the auv discussed here should be bounded viz x t x t max and δ δ max where x t max and δ max are known positive constants 2 2 trajectory tracking error dynamics the trajectory tracking problem is described in fig 1 where i b and f designate the inertial reference frame the body fixed frame and the frenet serret frame respectively the auv is required to track the desired trajectory in horizontal plane p is a moving point acting as a virtual target on the trajectory to be tracked associated with p on the desired trajectory f is built and the axes of which are tangent and normal to the trajectory let x y t be the actual position vector of the auv in i x d y d t the desired position vector of the moving virtual target on the trajectory in i the trajectory tracking error vector built in the inertial frame can be described as 4 x e i x x d y e i y y d subsequently the trajectory tracking error vector built in f is derived as 5 x e y e cos ψ f sin ψ f sin ψ f cos ψ f x e i y e i where ψ f arctan y d x d differentiating 5 and utilizing 1 yields 6 x e x x d cos ψ f x e i ψ f sin ψ f y y d sin ψ f y e i ψ f cos ψ f u r cos ψ v r sin ψ v x x d cos ψ f ψ f sin ψ f x x d u r sin ψ v r cos ψ v y y d sin ψ f ψ f cos ψ f y y d u r cos ψ β r ψ f cos β r u c cos β c ψ f u d 1 κ y e 7 y e x x d sin ψ f x e i ψ f cos ψ f y y d cos ψ f y e i ψ f sin ψ f u r cos ψ v r sin ψ v x x d sin ψ f ψ f cos ψ f x x d u r sin ψ v r cos ψ v y y d cos ψ f ψ f sin ψ f y y d u r sin ψ β r ψ f cos β r u c sin β c ψ f κ u d x e where u c v x 2 v y 2 is the resultant velocity of ocean currents u d x d 2 y d 2 is the velocity of the point p on the desired trajectory κ is the curvature of the point p on the desired trajectory and κ ψ f u d β c arctan v y v x β r arctan v r u r hence the trajectory tracking error dynamics in frenet serret frame f is given by 8 x e u r cos ψ β r ψ f θ x u d 1 κ y e y e u r sin ψ β r ψ f θ y κ u d x e where θ x and θ y are the ocean currents induced components and θ x u c cos β c ψ f θ y u c sin β c ψ f u r is the resultant velocity of the vehicle and u r u r cos β r 2 3 problem formulation our objective is to develop a controller to regulate the auv tracking the desired trajectory in horizontal plane regardless of highly coupled system nonlinearities time varying ocean currents and input saturations the objective can be divided into two control problems as shown below 1 kinematic control given a desired trajectory and the trajectory tracking error dynamics 8 design a kinematic guidance and control law to generate the desired surge velocity u r d desired heading angle ψ d and desired yaw velocity r d so that all the trajectory tracking error vectors in 8 can converge uniformly and asymptotically to an arbitrarily small neighborhood around zero as t goes to despite the time varying ocean currents 2 dynamic control given the desired surge velocity u r d yaw velocity r d and the under actuated dynamic model 2 derive an effective dynamic control law to generate the control input x t and δ so that the tracking errors u r u r d and r r d can converge uniformly and asymptotically to an arbitrarily small neighborhood around zero as t goes to despite the highly coupled system nonlinearities ocean currents induced disturbances and input saturations to facilitate the trajectory tracking controller design in the next section following assumptions are required assumption 1 the predefined trajectory are finite such that x d y d x d and y d are bounded assumption 2 for the system s uncertainties in 8 there exist positive constants θ x θ x θ x θ y θ y θ y such that θ x and θ y satisfy the following conditions θ x θ x θ x θ x θ x θ x θ y θ y θ y θ y θ y θ y assumption 3 for the system s uncertainties in 2 there exist positive constants d u d u d u d v d v d v d r d r d r such that d u d v and d r satisfy the following conditions d u d u d u d u d u d u d v d v d v d v d v d v d r d r d r d r d r d r 3 controller design 3 1 structure of the proposed control scheme as analyzed before the under actuated auv discussed in this paper subjects to highly coupled nonlinearities ocean currents induced uncertainties and input saturation in addition the influences of ocean currents are considered in a comprehensive way such that both the kinematic and dynamic models are established with ocean currents in order to achieve satisfying trajectory tracking the proposed controller not only needs to have good kinematic guidance performance under ocean currents but also has to conduct accurate and robust dynamic control against the highly coupled nonlinearities unknown disturbances and input saturation considering the aforementioned problems an improved los guidance law based adaptive terminal sliding mode controller is proposed in this section as shown in fig 2 a successive control structure is adopted where the proposed trajectory tracking controller is divided in two subsystems namely kinematic control and dynamic control the first subsystem mainly consists of improved los guidance law and kinematic controller design to achieve good guidance control against ocean currents an improved los guidance law is employed by introducing an auxiliary variable to the conventional los guidance law and utilizing extended disturbance observers to estimate the ocean current induced disturbances in the kinematic model compared with conventional los guidance law the proposed edo based improved los guidance law has better guidance ability since the influences of ocean currents have been estimated by the extended disturbance observers and compensated by the auxiliary variable therefore the proposed improved los guidance law is more suitable than conventional los method when facing with ocean currents in addition to track the desired heading angle derived by the improved los guidance law an edo based kinematic tracking control law is designed and the desired surge and yaw velocity are obtained for the dynamic control subsystem the second subsystem addresses the dynamic controller design in the presence of highly coupled nonlinearities unknown external disturbances and input saturation both velocity tracking and attitude tracking are considered in dynamic controller design adaptive terminal sliding mode control is utilized as the main control algorithm and extended disturbance observer is utilized for the current induced disturbance estimation and compensation compared with the conventional sliding mode control the proposed edo based terminal sliding mode control has better robustness and converging rate as well as better anti jamming ability in addition anti windup compensator is utilized to weaken the influence of actuator saturation based on the proposed kinematic and dynamic control the trajectory tracking control objective can be achieved in the presence of complex nonlinearities ocean currents induced uncertainties and input saturation 3 2 nonlinear extended disturbance observers design to estimate the unknown uncertainties in kinematic model 2 and dynamic model 8 following second order extended disturbance observers are utilized ginoya et al 2014 9 θ ˆ x p x 1 l x 1 x e p x 1 l x 1 u r cos ψ β r ψ f cos β r u d 1 κ y e θ ˆ x θ ˆ x θ ˆ x p x 2 l x 2 x e p x 2 l x 2 u r cos ψ β r ψ f cos β r u d 1 κ y e θ ˆ x 10 θ ˆ y p y 1 l y 1 y e p y 1 l y 1 u r sin ψ β r ψ f cos β r κ u d x e θ ˆ y θ ˆ y θ ˆ y p y 2 l y 2 y e p y 2 l y 2 u r sin ψ β r ψ f cos β r κ u d x e θ ˆ y 11 d ˆ u p u 1 l u 1 u r p u 1 l u 1 f u u r v r r g u x t d ˆ u d ˆ u d ˆ u p u 2 l u 2 u r p u 2 l u 2 f u u r v r r g u x t d ˆ u 12 d ˆ r p r 1 l r 1 r p r 1 l r 1 f r u r v r r g r δ d ˆ r d ˆ r d ˆ r p r 2 l r 2 r p r 2 l r 2 f r u r v r r g r δ d ˆ r where θ ˆ and d ˆ are the estimations of the uncertainties θ ˆ and d ˆ are time derivative estimations of the uncertainties p 1 and p 2 are the observer auxiliary states l 1 and l 2 are the observer gains which need to be determined remark 4 compared with conventional disturbance observer the second order disturbance observer employed in this paper estimates not only the uncertainties but also the time derivatives of uncertainties remark 5 the estimate values of second order disturbance observer will be utilized in the kinematic and dynamic controller design therefore the disturbance d v is not estimated since there is no actuator in sway direction on the contrary the influence of d v is indirectly eliminated by employing the improved los guidance law theorem 1 utilizing the proposed second order disturbance observers 9 12 the estimation errors of uncertainties are guaranteed to converge to a specified compact set around the origin proof for convenience the proposed second order disturbance observers in 9 12 are rewritten in a compact form as follows 13 d ˆ c p 1 l 1 x c 14 p 1 l 1 x c d c d ˆ c d ˆ c 15 d ˆ c p 2 l 2 x c 16 p 2 l 2 x c d c d ˆ c where d c θ x θ y d u d r t x c x e y e u r t l 1 l x 1 l y 1 l u 1 l r 1 t l 2 l x 2 l y 2 l u 2 l r 2 t p 1 p x 1 p y 1 p u 1 p r 1 t p 2 p x 2 p y 2 p u 2 p r 2 t the proving process is illustrated in the following two steps step 1 observer error dynamics derivation from 13 14 one can obtain 17 d ˆ c p 1 l 1 x c l 1 x c d c d ˆ c d ˆ c l 1 x c l 1 d c d ˆ c where d c d c d ˆ c subtracting both sides of 17 from d c one can obtain 18 d c l 1 d c d c d ˆ c l 1 d c d c where d c d c d ˆ c similarly based on 15 16 one can obtain 19 d c l 2 d c d c differentiating 18 and utilizing 19 yields 20 d c l 1 d c l 2 d c d c since d c is bounded according to assumption 2 and assumption 3 it is clearly that d c is stable if l 1 0 and l 2 0 define the estimation error vector as e 1 d c d c t then the observer error dynamics can be expressed as 21 e 1 l c e 1 e c d c 22 l c l 1 1 l 2 0 e c 0 1 step 2 stability analysis the eigenvalue equation of l c can be described as 23 λ i l c λ l 1 1 l 2 λ 0 from 23 one can obtain 24 λ 2 l 1 λ l 2 0 obviously it is always possible to select l 1 and l 2 such that the eigenvalue of l c can be placed arbitrarily assume l 1 and l 2 are selected that the eigenvalues of l c are in the lhp then it is always possible to find a positive definite matrix p c such that 25 l c t p c p c l c q c where q c denotes arbitrary positive definite matrix and the smallest eigenvalue of which is λ m consider the following lyapunov function candidate 26 v c e 1 t p c e 1 differentiating 26 and utilizing 25 yields 27 v c e 1 t l c t p c p c l c e 1 2 e 1 t p c e c d c e 1 t q c e 1 2 e 1 p c e c d c e 1 λ m e 1 2 p c e c d c it can be concluded from 27 that v c 0 as long as e 1 2 p c e c d c λ m consequently the decrease of v c will drive e 1 into the compact set e 1 2 p c e c d c λ m therefore both d c and d c are proved to be bounded moreover the parameters can be chosen to ensure the estimation errors converge to a specified compact set around the origin end proof 3 3 kinematic controller design 3 3 1 improved los guidance law design line of sight los is a popular heading guidance method applied in the marine vehicle systems the main idea of los guidance is to mimic the actions of a helmsman which steer the vehicle towards a look ahead distance ahead of the projection point of the vehicle along the trajectory to compensate for the ocean currents and steer the vehicle towards the desired trajectory an improved los guidance law is employed as miao et al 2017a 28 ψ d ψ f β r arctan y e α y δ where ψ d is the desired heading angle δ is a positive constant the auxiliary variable is designed to compensate for the influences of ocean currents and takes the following form 29 α y y e θ ˆ y u r 2 θ ˆ y u r δ 2 1 θ ˆ y u r 2 y e 2 1 θ ˆ y u r 2 where θ ˆ y is the estimation of θ y remark 6 the above los guidance law changes with the time varying trajectory tracking error y e which transforms the position error into the orientation error consequently the tracking error in the under actuated sway degree of freedom can be indirectly eliminated remark 7 compared with conventional los guidance law an auxiliary variable is introduced here which helps compensate for the influences of ocean currents remark 8 the selection of δ affects the approaching guidance performance for instance a large δ brings a mild approaching guidance whereas a small δ brings an aggressive approaching guidance in this paper δ is chosen as two vehicle s length 3 3 2 kinematic control law design to achieve kinematic control following edo based tracking control law is designed 30 u r d k 1 x e u d θ ˆ x cos β r δ 2 y e α y 2 δ r d ψ d k 2 ψ ψ d where k 1 and k 2 are the designed positive parameters ψ d is the desired heading angle generated by improved los guidance law theorem 2 utilizing improved los guidance law 28 and edo based kinematic tracking control law 30 the tracking errors vectors of heading angle and position are guaranteed to converge to a specified compact set around the origin proof the proving process is illustrated in the following two steps step 1 convergence proof of heading angle tracking define the tracking error of heading angle as 31 ψ e ψ ψ d consider the following lyapunov function candidate 32 v 1 1 2 ψ e 2 differentiating 32 yields 33 v 1 ψ e ψ e ψ e r ψ d substituting 30 into 33 one can obtain 34 v 1 k 2 ψ e 2 that means v 1 0 anywhere except the origin hence it is proved that utilizing the designed virtual control law r d the tracking error ψ e can converge to a specified compact set around the origin step 2 convergence proof of position tracking based on 28 and 8 the trajectory tracking error dynamics can be further expressed as 35 x e u r δ δ 2 y e α y 2 u r ψ e ϕ x y e ψ e θ x u d 1 κ y e y e u r y e α y δ 2 y e α y 2 u r ψ e ϕ y y e ψ e θ y κ u d x e where ϕ x y e ψ e and ϕ y y e ψ e are two auxiliary functions which take following forms 36 ϕ x y e ψ e cos ψ e 1 ψ e δ δ 2 y e α y 2 sin ψ e ψ e y e α y δ 2 y e α y 2 ϕ y y e ψ e sin ψ e ψ e δ δ 2 y e α y 2 cos ψ e 1 ψ e y e α y δ 2 y e α y 2 since cos ψ e 1 ψ e 0 73 sin ψ e ψ e 1 δ δ 2 y e α y 2 1 y e α y δ 2 y e α y 2 1 the upper bounds of ϕ x y e ψ e and ϕ y y e ψ e are determined to be 1 73 consider the following lyapunov function candidate 37 v 2 1 2 x e 2 1 2 y e 2 1 2 θ x 2 1 2 l x 2 θ x 2 1 2 θ y 2 1 2 l y 2 θ y 2 where θ x θ x θ ˆ x θ x θ x θ ˆ x θ y θ y θ ˆ y θ y θ y θ ˆ y differentiating 37 yields 38 v 2 x e x e y e y e θ x θ x 1 l x 2 θ x θ x θ y θ y 1 l y 2 θ y θ y x e u r δ δ 2 y e α y 2 u r ψ e ϕ x y e ψ e θ x u d 1 κ y e y e u r y e α y δ 2 y e α y 2 u r ψ e ϕ y y e ψ e θ y κ u d x e θ x l x 1 θ x θ x 1 l x 2 θ x l x 2 θ x θ x θ y l y 1 θ y θ y 1 l y 2 θ y l y 2 θ y θ y x e u r δ δ 2 y e α y 2 u r ψ e ϕ x y e ψ e θ x u d y e u r y e α y δ 2 y e α y 2 u r ψ e ϕ y y e ψ e θ y l x 1 θ x 2 1 l x 2 θ x θ x l y 1 θ y 2 1 l y 2 θ y θ y based on 29 one can obtain 39 u r α y δ 2 y e α y 2 θ ˆ y substituting 39 into 38 one can obtain 40 v 2 x e u r δ δ 2 y e α y 2 u r ψ e ϕ x y e ψ e θ x u d y e u r y e δ 2 y e α y 2 u r ψ e ϕ y y e ψ e θ y l x 1 θ x 2 1 l x 2 θ x θ x l y 1 θ y 2 1 l y 2 θ y θ y based on 30 the virtual control resultant velocity of the vehicle can be obtained as 41 u r d u r d cos β r k 1 x e u d θ ˆ x δ 2 y e α y 2 δ substituting 41 into 40 one can obtain 42 v 2 k 1 x e 2 x e u r ψ e ϕ x y e ψ e x e θ x u r y e 2 δ 2 y e α y 2 y e u r ψ e ϕ y y e ψ e y e θ y l x 1 θ x 2 1 l x 2 θ x θ x l y 1 θ y 2 1 l y 2 θ y θ y x e y e k 1 0 0 u r δ 2 y e α y 2 x e y e t x e y e u r ψ e ϕ x y e ψ e θ x u r ψ e ϕ y y e ψ e θ y l x 1 θ x 2 1 l x 2 θ x θ x l y 1 θ y 2 1 l y 2 θ y θ y x e y e k 1 0 0 u r δ 2 y e α y 2 x e y e t x e y e u r ψ e ϕ x y e ψ e θ x u r ψ e ϕ y y e ψ e θ y 1 l x 2 θ x θ x 1 l y 2 θ y θ y since it has been proved in theorem 1 that the estimation errors of edo are bounded it is proper to suppose that θ x μ x θ y μ y besides according to assumption 2 one can obtain that θ x θ x and θ y θ y therefore 1 l x 2 θ x θ x 1 l y 2 θ y θ y is bounded and assume the upper bound of 1 l x 2 θ x θ x 1 l y 2 θ y θ y is γ 1 define e 2 x e y e t m k 1 0 0 u r δ 2 y e α y 2 and n u r ψ e ϕ x y e ψ e θ x u r ψ e ϕ y y e ψ e θ y 42 can be further derived as 43 v 2 e 2 t m e 2 e 2 t n γ 1 m e 2 n 2 m 2 γ 1 n 2 4 m m e 2 n 2 m 2 γ 2 where γ 2 γ 1 n 2 4 m obviously it can be concluded from 43 that v 2 0 as long as e 2 n 2 m 2 γ 2 m consequently the decrease of v 2 will drive the tracking errors into the boundary e 2 n 2 m γ 2 m moreover the parameters can be chosen to ensure the tracking error vector e 2 converge to a specified compact set around the origin end proof 3 4 dynamic controller design the dynamic controller is divided into two subsystems namely attitude tracking control and velocity tracking control to improve tracking performance and converging rate despite the uncertainties with unknown upper bounds edo based adaptive terminal sliding mode control is employed meanwhile an anti windup compensator is utilized to eliminate the influence of input saturation the detailed designing and deriving process are presented as follows 3 4 1 attitude tracking controller design the designing process of attitude tracking controller is illustrated in two sections in section 3 4 1 1 an adaptive terminal sliding mode attitude controller is designed without input saturation in section 3 4 1 2 the input saturation existing in practical application for auv is considered and the attitude controller is redesigned 3 4 1 1 unconstrained adaptive attitude tracking controller design without input saturation define the attitude tracking error as 44 z r r r d choose the following integral sliding mode surface 45 s r z r c r 0 t z r d t where c r 0 differentiating 45 and utilizing 2 yields 46 s r f r g r δ d r r d c r z r where f r is the abbreviation of f r u r v r r similarly hereinafter the accessibility of the sliding mode condition guarantees that the system can reach the sliding mode surface in finite time whereas it has no restriction during the approach course to improve the convergence efficiency and system dynamic response following terminal reaching law is employed 47 s r τ r s r σ r s r r r s i g n s r where τ r 0 σ r 0 0 r r 1 the control input δ is selected as follows 48 δ τ r s r σ r s r r r s i g n s r c r z r r d f r d ˆ r g r where d ˆ r is the second order disturbance observer employed to estimate d r as shown in 12 theorem 3 under the proposed control input 48 and second order extended disturbance observer 12 the tracking error z r is guaranteed to converge to a specified compact set around the origin proof consider the following lyapunov function candidate 49 v r 1 1 2 s r 2 1 2 d r 2 1 2 l r 2 d r 2 substituting 48 into 46 yields 50 s r τ r s r σ r s r r r s i g n s r d r differentiating 49 utilizing 18 19 and 50 one can obtain 51 v r 1 s r s r d r d r 1 l r 2 d r d r s r τ r s r σ r s r r r s i g n s r d r d r l r 1 d r d r 1 l r 2 d r l r 2 d r d r τ r s r 2 σ r s r r r 1 s r d r l r 1 d r 2 1 l r 2 d r d r τ r s r 2 σ r s r r r 1 s r d r l r 1 d r 2 1 l r 2 d r d r τ r 1 2 σ 4 s r 2 σ r s r r r 1 l r 1 σ 4 2 d r 2 1 l r 2 d r d r where σ 4 is a user defined positive constant since it has been proved by theorem 1 that d r is converged it is proper to assume the upper bound of d r is μ r if σ 4 is selected to guarantee l r 1 σ 4 2 0 then 51 is further derived as 52 v r 1 τ r 1 2 σ 4 s r 2 σ r s r r r 1 1 l r 2 μ r d r where d r is the upper bound of d r according to assumption 2 obviously it can be concluded from 52 that v r 1 0 as long as s r 2 μ r d r l r 2 τ r 1 2 σ 4 or s r r r 1 μ r d r l r 2 σ r consequently the decrease of v r 1 will drive s r into the boundary s r μ r d r l r 2 τ r 1 2 σ 4 or s r μ r d r l r 2 σ r r r 1 therefore it is proved that under the proposed unconstrained attitude tracking control law 48 the system states are forced towards the given sliding manifold and the sliding mode surface s r is bounded to a specified compact set described by 53 ω s r s r r s r ζ r where ζ r min μ r d r l r 2 τ r 1 2 σ 4 μ r d r l r 2 σ r r r 1 moreover by solving 45 following equation can be obtained 54 z r t s r t c r e c r t 0 t s r ϖ e c r ϖ d ϖ considering the boundary of s r presented in 53 one can obtain 55 z r s r c r e c r t 0 t s r ϖ e c r ϖ d ϖ ζ r c r e c r t 0 t ζ r e c r ϖ d ϖ ζ r 1 c r e c r t 0 t e c r ϖ d ϖ ζ r 2 e c r t 2 ζ r therefore it is proved that under the proposed unconstrained attitude tracking control law 48 the tracking error z r is bounded to a specified compact set described by 56 ω z r z r r z r 2 ζ r moreover the parameters can be chosen to ensure the attitude tracking error converge to a specified compact set around the origin end proof 3 4 1 2 constrained adaptive attitude tracking controller design with input saturation now we consider the attitude tracking case with input saturation due to the existence of actuator saturation the actual control input can be expressed as 57 δ 1 s a t δ δ m s i g n δ δ δ m δ δ δ m where δ m denote the known magnitude of the saturation limit s a t and s i g n denote the saturation and unit sign function respectively to eliminate the influence of input saturation we employ the anti windup compensator galeani et al 2009 cui et al 2016 as 58 w r k r w r g r s r δ δ 1 2 δ δ 2 w r 2 w r δ δ w r μ r 0 w r μ r where δ δ δ 1 δ w r is the state of the auxiliary design system k r 0 is a design parameter μ r is a small positive design parameter the constrained attitude tracking controller is redesigned as 59 δ τ r s r w r σ r s r r r s i g n s r c r z r r d f r d ˆ r g r where d ˆ r is the second order disturbance observer employed to estimate d r as shown in 12 theorem 4 under the proposed constrained attitude tracking control law 59 anti windup compensator 58 and second order disturbance observer 12 the tracking error z r is guaranteed to converge to a specified compact set around the origin proof considering the input saturation a new equivalent attitude tracking model is expressed as follows 60 r f r g r δ δ δ d r the definitions of tracking error z r and sliding mode surface s r are the same with 44 45 differentiating 45 and utilizing 60 yields 61 s r f r g r δ g r δ δ d r r d c r z r consider the following lyapunov function candidate 62 v r 2 1 2 s r 2 1 2 d r 2 1 2 l r 2 d r 2 1 2 w r 2 where d r d r d ˆ r d r d r d ˆ r differentiating 62 utilizing 18 19 and 61 one can obtain 63 v r 2 s r s r d r d r 1 l r 2 d r d r w r w r s r f r g r δ g r δ δ d r r d c r z r d r l r 1 d r d r 1 l r 2 d r l r 2 d r d r w r k r w r g r s r δ δ 1 2 δ δ 2 w r 2 w r δ δ substituting 59 into 63 yields 64 v r 2 s r τ r s r τ r w r σ r s r r r s i g n s r g r δ δ d r l r 1 d r 2 1 l r 2 d r d r k r w r 2 g r s r δ δ 1 2 δ δ 2 w r δ δ τ r s r 2 σ r s r r r 1 τ r s r w r s r d r l r 1 d r 2 1 l r 2 μ r d r k r w r 2 1 2 δ δ 2 w r δ δ there exist following facts 65 s r w r s r 2 2 σ 5 σ 5 w r 2 2 66 s r d r s r 2 2 σ 6 σ 6 d r 2 2 67 w r δ δ w r 2 2 σ 7 σ 7 δ δ 2 2 where σ 5 σ 6 σ 7 are positive designed parameters substituting 65 67 into 64 one can obtain 68 v r 2 τ r τ r 2 σ 5 1 2 σ 6 s r 2 σ r s r r r 1 l r 1 σ 6 2 d r 2 k r τ r σ 5 2 1 2 σ 7 w r 2 1 2 σ 7 2 δ δ 2 1 l r 2 μ r d r τ r τ r 2 σ 5 1 2 σ 6 s r 2 σ r s r r r 1 1 l r 2 μ r d r where the design parameters are chosen to satisfy the conditions l r 1 σ 6 2 0 k r τ r σ 5 2 1 2 σ 7 0 and 1 2 σ 7 2 0 adopting the same deriving method as theorem 3 following conclusion can be made under the proposed constrained attitude tracking control law 59 anti windup compensator 58 and second order disturbance observer 12 the tracking error z r is bounded to a specified compact set described by 69 ω z r z r r z r 2 ζ r where ζ r min μ r d r l r 2 τ r τ r 2 σ 5 1 2 σ 6 μ r d r l r 2 σ r r r 1 moreover the parameters can be chosen to ensure the attitude tracking error converge to a specified compact set around the origin end proof 3 4 2 velocity tracking controller design as shown in 2 the velocity tracking subsystem has the same structure as attitude tracking subsystem therefore the same control method will be utilized to achieve velocity tracking as in section 3 4 1 the velocity tracking error is defined as 70 z u u r u r d choose the following integral sliding mode surface 71 s u z u c u 0 t z u d t where c u 0 due to the existence of actuator saturation the actual control input can be expressed as 72 x t 1 s a t x t x t m s i g n x t x t x t m x t x t x t m where x t m denote the known magnitude of the saturation limit s a t and s i g n denote the saturation and unit sign function respectively to eliminate the influence of input saturation a similar anti windup compensator is utilized as 73 w u k u w u g u s u δ x t 1 2 δ x t 2 w u 2 w u δ x t w u μ u 0 w u μ u where δ x t x t 1 x t w u is the state of the auxiliary design system k u 0 is a design parameter μ u is a small positive design parameter a new equivalent velocity tracking model with input saturation is expressed as follows 74 u r f u g u x t δ x t d u where f u is the abbreviation of f u u r v r r similarly hereinafter differentiating 71 utilizing 60 and 73 one can obtain 75 s u f u g u x t g u δ x t d u u r d c u z u to improve the convergence efficiency and system dynamic response following terminal reaching law is employed 76 s u τ u s u σ u s u r u s i g n s u where τ u 0 σ u 0 0 r u 1 the constrained velocity tracking controller is redesigned as 77 x t τ u s u w u σ u s u r u s i g n s u c u z u u r d f u d ˆ u g u where d ˆ u is the second order disturbance observer employed to estimate d u as shown in 11 remark 9 adopting the same deriving method as theorem 3 and theorem 4 it can be proved that under the proposed constrained velocity tracking control law 77 anti windup compensator 73 and second order disturbance observer 11 the velocity tracking error z u is guaranteed to converge to a specified compact set around the origin for the sake of brevity the specific deriving and proving process will not be presented again here 4 simulation results 4 1 simulation preparation in order to verify the effectiveness and robustness of the proposed trajectory tracking controller numerical simulations are carried out with a well known remus auv prestero 2011 the parameters of auv model are shown in table 1 and the parameters of proposed controller are presented in table 2 four simulation cases are carried out case 1 and case 2 are implemented to verify the trajectory tracking performance and adaptability of the proposed control scheme under different desired trajectories and different initial conditions but without ocean currents case 3 and case 4 are carried out to illustrate the disturbance estimation capability anti jamming ability and trajectory tracking performance of proposed control scheme under different kinds of environmental disturbances besides in order to prove the superiority of the proposed control algorithm simulation results of the other three control algorithms are presented in case 3 and case 4 for comparison 4 2 case 1 2 adaptability analysis of different trajectories tracking without ocean currents to verify the trajectory tracking performance and adaptability of the proposed controller two simulation cases are carried out under different desired trajectories and different initial conditions a straight line is chosen as the desired trajectory in case 1 which can be parameterized by x d 1 5 t m and y d 10 m whereas a curvilinear trajectory is selected as the desired trajectory in case 2 parameterized by x d 1 5 t m and y d 10 sin 0 2 t m moreover to further verify the adaptability of our approach case 1 and case 2 are both carried out with the following two different initial conditions 1 initial condition 1 x 0 y 0 ψ 0 0 m 0 m 0 rad 2 initial condition 2 x 0 y 0 ψ 0 0 m 15 m 0 rad the two different initial positions of the auv are specially selected on different sides of the desired trajectory therefore the tracking ability of the proposed controller form different directions can be verified the trajectory tracking result of case 1 under two different initial conditions is shown in fig 3 and the kinematic tracking errors are shown in fig 4 it can be seen that under the proposed control scheme the auv can converge to and move along the desired trajectory with almost no tracking errors under the two different initial conditions tracking velocities of case 1 are illustrated in fig 5 which shows the velocities of auv is smooth and stable dynamic tracking errors of case 1 are shown in fig 6 which shows that under the adaptive terminal sliding mode dynamic control the dynamic tracking errors converge to zero quickly the control inputs are presented in fig 7 where the values of the control inputs are proved to be within the limits during the whole time domain note that the values of the control inputs have briefly reached the limits in the initial tracking stage since the tracking errors in the initial tracking stage are relatively large and the controller needs to rapidly generate large control inputs the simulation results of case 2 under two different initial conditions are shown in figs 8 12 including the tracking trajectory kinematic tracking errors tracking velocities dynamic tracking errors and control inputs the overall performance of case 2 is consistent with case 1 except that slight fluctuations are observed in the steady value of tracking velocities and control inputs note that this phenomenon is normal since a curvilinear trajectory is selected as the desired trajectory in case 2 and the course angle of auv needs to be adjusted according to the demands according to the simulation results of case 1 and case 2 the proposed control scheme is proved to have good tracking performance for both straight line and curvilinear trajectories and the controller can regulate the auv to the desired trajectory under different initial conditions therefore the tracking performance and adaptability of proposed controller are validated 4 3 case 3 comparative analysis for trajectory tracking with simple ocean currents to verify the disturbance handling ability and robustness of the proposed controller trajectory tracking simulation is carried out with simple ocean currents in this section the same curvilinear trajectory with case 2 is selected as the desired trajectory and the initial condition is set as x 0 y 0 ψ 0 0 m 0 m 0 rad the ocean currents are considered with constant velocity and constant direction and the currents induced uncertainties are selected as v x 0 1 m s v y 0 1 m s d u 0 1 sin 0 3 t d v 0 1 sin 0 3 t d r 0 1 cos 0 3 t for comparison purpose four control algorithms are utilized in the simulation viz 1 method 1 los edosmc conventional los guidance law is utilized for kinematic control and edo based sliding mode control is utilized for dynamic control 2 method 2 edolos smc edo based improved los guidance law is utilized for kinematic control and conventional sliding mode control is employed for dynamic control 3 method 3 an existing esolos esosmc method which utilizes extended state observer based los guidance law esolos for kinematic control and employs eso based sliding mode control for dynamic control 4 the proposed control method the trajectory tracking result of case 3 is shown in fig 13 it is seen that under the proposed control scheme the auv can converge to and move along the desired trajectory with almost no tracking errors whereas bigger tracking errors are observed in the trajectories of the other three control methods to further demonstrate the control performance of the four methods the kinematic tracking errors are shown in fig 14 and the dynamic tracking errors are shown in fig 15 from fig 14 it is easily observed that the tracking errors x e and y e of method 1 are bigger than the other three methods the oscillation of method 2 is the most significant and the performance of method 3 is closer to the proposed control scheme than the other two methods similar conclusions can be drawn from the dynamic tracking errors in fig 15 where significant oscillations can be observed in the performance of method 2 to analyze the tracking performance more clearly and quantitatively data analyses of the steady state kinematic and dynamic tracking errors are carried out three kinds of parameters are calculated to evaluate the steady state tracking accuracy and stability viz 1 ave average value of the absolute tracking errors 2 max maximum value of the absolute tracking errors 3 stdev standard derivation of the tracking errors the analysis results are shown in the bar graphs in fig 16 and fig 17 of the three kinds of parameters stdev directly reflects the tracking stability and ave directly reflects the tracking accuracy as shown in fig 16 the proposed controller performs best with the smallest ave and stdev whereas method 1 exhibits worst kinematic tracking accuracy and method 2 exhibits worst kinematic tracking stability similarly it can be seen form fig 17 that the proposed controller exhibits best dynamic tracking accuracy and stability whereas method 2 exhibits worst dynamic tracking stability according to the above analyses it is easy to find out that compared with method 1 the proposed controller has better tracking control accuracy and compared with method 2 the stability of proposed controller is better besides compared with an existing esolos esosmc method the proposed controller exhibits better trajectory tracking performance in the simulation case 3 moreover to illustrate the disturbance estimation capability the estimation values of the currents induced uncertainties as well as their time derivatives are shown in figs 18 21 it is seen that both the uncertainties and their time derivatives can be well estimated by the proposed extended disturbance observer hence the effectiveness of the extended disturbance observer and the trajectory tracking performance of the proposed control scheme under simple ocean currents are validated 4 4 case 4 comparative analysis for trajectory tracking with complex ocean currents to further verify the trajectory tracking performance and robustness of the proposed controller trajectory tracking simulation is carried out with complex ocean currents in this section the desired trajectory and initial conditions chosen in case 4 is the same as that in case 3 the ocean currents induced uncertainties considered here are time varying state dependent and piecewise as shown below v x 0 1 cos 0 1 t t 150 s 0 2 cos 0 2 t t 150 s v y 0 1 sin 0 1 t t 150 s 0 2 sin 0 2 t t 150 s d u 0 1 sin 0 3 t t 150 s 0 05 sin 0 15 t t 150 s d v 0 1 sin 0 3 t t 150 s 0 05 sin 0 15 t t 150 s d r 0 1 r cos 0 3 t t 150 s 0 2 r cos 0 5 t t 150 s for comparison purposes the four control algorithms utilized in case 4 are the same as that in case 3 the trajectory tracking results and tracking errors of case 4 are shown in figs 22 24 the data analyses of the steady state tracking errors are shown in figs 25 26 similar overall conclusions can be drawn from case 4 that the proposed controller exhibits better tracking accuracy and stability than the other three control methods moreover as shown in fig 22 when the ocean currents increase after 150 s the tracking errors of method 1 and method 2 have experienced significant increases whereas for method 3 and the proposed method only a brief increase emerges and the trajectory converges rapidly to the ideal state therefore it is proved that method 3 and the proposed method have better robustness than method 1 and method 2 besides compared with case 3 the data analysis of steady state kinematic tracking errors in case 4 shows a little different properties in case 3 method 2 exhibits the worst kinematic tracking stability with biggest stdev whereas in case 4 the kinematic tracking stability of method 1 is the worst among the four control algorithms this phenomenon indicates that the influence of kinematic guidance law on the stability of auv trajectory increases with the increase of the ocean currents therefore when facing with the ocean currents in case 4 the poor kinematic guidance capability of the los law in method 1 exacerbates the oscillation of auv trajectory the estimation values of the currents induced uncertainties as well as their time derivatives are shown in figs 27 30 it is also seen that both the uncertainties and their time derivatives can be well estimated by the proposed extended disturbance observer note that even though a big break occurs at 150 s of the actual time derivative value of the uncertainties the estimation value can still track the actual value after that based on the above analyses the effectiveness of the proposed control scheme under time varying and piecewise complex ocean currents is validated 4 5 discussions and future works from the simulation results and aforementioned analyses following conclusions can be drawn 1 based on case 1 and case 2 the proposed control scheme is proved to have good tracking performance and adaptability under different tracking targets and different initial conditions 2 compared with method 1 the proposed controller performs better in tracking accuracy which shows that the proposed edo based improved los law has better kinematic guidance ability than conventional los law when facing with ocean currents 3 compared with method 2 the proposed controller performs better in tracking stability which means that the proposed edo helps improving the robustness and anti jamming ability of dynamic control when facing with ocean currents 4 in the simulation cases of this paper the proposed controller exhibits better trajectory tracking performance than an existing esolos esosmc method compared with eso the structure of proposed edo is more complex but it can estimate not only the disturbances but also the time derivatives of the disturbances however their performances in real ocean environments need further validation and comparison which will be addressed in our future works 5 based on the four simulation cases the proposed controller is proved to have good tracking accuracy stability robustness and anti jamming ability therefore it is able to achieve satisfying trajectory tracking control despite the highly coupled nonlinearities complex ocean currents induced uncertainties and input saturation however in order to promote the practical application of the proposed controller in a real ocean environment following future works are to be implemented 1 various constraints exist in a real auv system including input constraints state constraints and output constraints peng et al 2018 violating system constraints may degrade control performance and even result in instability in some circumstances yan and wang 2012 however in this paper only the input saturation problem is tackled in our future works more effective methods will be designed to deal with various constraints 2 the real ocean environment is very harsh and complex which may bring more serious parameter perturbations model uncertainties and external disturbances to promote the practical application the adaptability of the proposed controller in the real ocean environment needs further verification in our future works 5 conclusion in this paper trajectory tracking control of an under actuated auv is investigated in the presence of highly coupled system nonlinearities ocean currents induced uncertainties and input saturation the influences of ocean currents are considered in both the dynamic models and the kinematic models under an adaptive successive control frame the trajectory tracking system is decoupled as kinematic control and dynamic control an edo based improved los guidance law is utilized for kinematic control where an auxiliary variable is introduced to the conventional los guidance law and extended disturbance observers are utilized to estimate the ocean current induced disturbances in the kinematic model the proposed dynamic controller employs adaptive terminal sliding mode control to improve the tracking performance and converging rate utilizes an extended disturbance observer to improve the system robustness and introduces an anti windup compensator to deal with the actuator saturation lyapunov analysis is performed to prove the stability and performance of the proposed controller moreover the robustness and effectiveness of the controller are tested and validated through numerical simulations and some future works are introduced acknowledgement this work was supported in part by thousand talents program national natural science foundation of china grant numbers 51479114 51579111 51761135012 and the post doctoral fund of china grant number 2018m632117 the platform construction of ocean energy comprehensive supporting service grant number ghme2014zc01 and high tech ship research projects sponsored by miitc floating support platform project grant number 201622 appendix a definitions of the main parameters of the auv model in this paper no parameter definition 1 i inertial reference frame 2 b body fixed frame 3 f frenet serret frame 4 x y ψ t position and orientation vectors 5 u r v r r t relative surge sway and yaw velocities 6 m mass of the vehicle 7 x g y g t locations of the vehicle center of gravity 8 x hydrodynamic coefficients of surge direction 9 y hydrodynamic coefficients of sway direction 10 n hydrodynamic coefficients of yaw direction 11 i z z diagonal inertia tensor 12 x t propeller thrust 13 δ rudder angle 14 x t max the upper limit of propeller thrust 15 δ max the upper limit of rudder angle 16 d u d v d r compound uncertainties in dynamic model 17 v x v y velocity components of the ocean currents 18 β r side slip angle 19 u c resultant velocity of ocean currents 20 u r resultant velocity of the vehicle 21 u d velocity of point p on the desired trajectory 22 κ curvature of the point p on the desired trajectory 23 x d y d t desired position vector 24 x e i y e i t trajectory tracking error vector in the inertial frame 25 x e y e t trajectory tracking error vector in the frenet serret frame 26 θ x θ y ocean current induced components in tracking error dynamics 
22966,this paper addresses the design of an improved line of sight los based adaptive trajectory tracking controller for an under actuated auv subjects to highly coupled nonlinearities ocean currents induced uncertainties and input saturation the influences of ocean currents on the auv are expressed in a comprehensive way such that both the kinematic and dynamic models of auv are established with ocean currents extended disturbance observers edo are utilized to estimate the ocean currents induced uncertainties as well as their time derivatives an improved los guidance law is designed by introducing an auxiliary variable to the conventional los and utilizing extended disturbance observers to estimate the ocean current induced disturbances in the kinematic model edo based adaptive terminal sliding mode control method is employed for dynamic control to improve the tracking performance and converging rate in addition the influence of actuator saturation is weakened by anti windup compensator rigorous theoretical analysis and extensive simulation studies demonstrate that the proposed approach has good tracking accuracy stability and anti jamming ability thus leading to satisfying trajectory tracking control keywords auv trajectory tracking ocean currents improved los guidance extended disturbance observer adaptive terminal sliding mode control input saturation 1 introduction autonomous underwater vehicles auvs have received significant attention in the past several decades due to the widespread applications across diverse fields wynn et al 2014 zhang et al 2015a 2018b to complete underwater tasks perfectly it is critical to design an efficient and robust motion control system however performing precise motion control of an auv is a formidable task considering the complex model nonlinearities unknown hydrodynamic coefficients and time varying ocean currents induced disturbances the basic motion control tasks of auv include point stabilization path following and trajectory tracking lapierre and soetanto 2007 point stabilization refers to the problem of steering a vehicle to a final target point with a desired orientation path following control aims at regulating a vehicle to converge to and follow a desired path without any temporal specifications trajectory tracking requires a vehicle to track a time parameterized reference trajectory since trajectory tracking is more complicated compared with point stabilization and path following the trajectory tracking of an auv in horizontal plane will be studied in this paper time varying ocean current is a huge obstacle to achieving accurate trajectory tracking since it brings great difficulties to precise modeling and controller design for an auv moreover huge ocean currents can even cause instability and affect the safety of auv an increasing number of papers have addressed the topic of auv control under ocean currents patre et al 2018 zhang et al 2015b however in some papers the influence of the ocean current is only considered in the dynamic model yu et al 2018 or kinematic model bi et al 2010 but not considered completely in this paper to design a trajectory tracking controller that can deal with various ocean currents the influences of ocean currents on an under actuated auv are investigated in a comprehensive way both kinematic and dynamic models of auv are established with ocean currents where the kinematic model is developed in terms of the relative velocity with respect to the ocean current disturbances and the dynamic model is developed to include the influences of ocean currents induced uncertainties after auv modeling the trajectory tracking problem is divided into two sub problems namely kinematic control and dynamic control and both the kinematic and dynamic controllers are designed considering the influences of ocean currents the performance of trajectory tracking is largely dependent on the guidance system a popular and effective way to achieve kinematic guidance control is to implement a line of sight los guidance law mimicking an experienced sailor fossen and pettersen 2014 nie and feng 2016 the uniform semi global exponential stability usges was proved to be achievable for a class of proportional los guidance laws used for vehicle path following control fossen and pettersen 2014 a narmax self tuning controller was designed for waypoint tracking for an auv based on line of sight guidance law rout and subudhi 2017 in xiang et al 2018 the research of fuzzy logic control based los guidance and control in marine robotic vehicle is reviewed however the traditional los guidance law has exhibited limitations in the case when the vehicle is exposed to unknown external disturbances to improve the adaptability and tracking performance plenty of improved los guidance laws have been proposed in liu et al 2016 a novel predictor based line of sight plos guidance law was proposed for the marine surface vehicles where a predictor was developed for the estimation of vehicle sideslip due to environmental disturbances two nonlinear adaptive path following algorithms were tested for both rectilinear and curvilinear path following problems and showed effective compensation for time varying drift forces due to waves wind and ocean currents fossen and lekkas 2017 in bibuli et al 2014 an ilos guidance law was applied to an under actuated unmanned semi submersible vehicle ussv for path following of straight lines which added integral action to increase robustness with respect to environmental disturbances such as sea currents wind and waves that unavoidably affect maritime operations in miao et al 2017a an improved compound line of sight clos guidance law was proposed based on the time delay control method and the reduced order linear extended state observer lesos technique which can estimate the unknown sideslip angle and can compensate for the influences of time varying ocean currents in liu et al 2017 an eso based line of sight guidance law was proposed for path following of under actuated marine surface vehicles with exact sideslip compensation in caharija et al 2016 an integral line of sight ilos guidance method was proposed for path following tasks of underactuated marine vehicles operating on and below the sea surface where the vehicles were regulated to follow straight lines by compensating for the drift effect of environmental disturbances such as currents wind and waves inspired by above considerations an improved line of sight ilos guidance law is employed in this paper which introduces an auxiliary variable to the conventional los guidance law and utilizes extended disturbance observers to estimate the ocean current induced disturbances in the kinematic model dynamic control of auv is another challenging subject of trajectory tracking considering the complex model nonlinearities unknown parameter uncertainties ocean currents induced disturbances and actuator saturations two problems are usually encountered when achieving accurate and robust dynamic control the first one is how to improve the system robustness despite the complex unknown external disturbances zhang et al 2018a which could severely degrade the closed loop system performance the second one is how to solve the problem of actuator saturation which may cause control effect reduction and even instability sarhadi et al 2016 zheng and sun 2016 in recent decades a number of significant robust control methods have been developed for dynamic control including but not limited to h infinity control roche et al 2011 adaptive control rezazadegan et al 2015 sliding mode control patre et al 2018 xiang et al 2017a fuzzy logic control chen et al 2016 backstepping control miao et al 2017b neural network method wang et al 2015 chu et al 2017 xiang et al 2017b optimal control qiao et al 2018 and deep learning carlucho et al 2018 in shen et al 2018 a novel lyapunov based model predictive control lmpc framework was developed to utilize computational resource online optimization to improve the trajectory tracking performance an anti disturbance constrained controller is developed by designing a command governor and a disturbance observer where the disturbance observer is developed to estimate the lumped disturbance composed of parametric model uncertainties modeling errors and unknown environmental forces peng et al 2018 in cui et al 2017 an adaptive neural network control was developed for a fully actuated autonomous underwater vehicle in the horizontal plane which employs two neural networks nns to evaluate the long time performance of the designed control and compensate for the unknown dynamics in kim et al 2016 an enhanced time delay controller tdc was proposed for the position control of an autonomous underwater vehicle auv under disturbances where an integral sliding mode controller was supplemented to the conventional tdc to improve the control precision and robustness in chu et al 2016 a new adaptive neural network control was developed for underwater vehicles where local recurrent neural network is used to approximate the unknown nonlinear functions and an adaptive observer is introduced for state estimation in fischer et al 2014 a novel method was proposed to compensate for bounded external disturbances and model uncertainties where the integral of the error sign control structure was presented in peng and wang 2018 an output feedback path following controller was designed for auv based on an extended state observer and projection neural networks where an extended state observer eso is developed to recover the unmeasured velocities as well as to estimate total uncertainty induced by internal model uncertainty and external disturbance input saturation caused by physical actuators is another technical challenge for dynamic control designing a controller without taking into account the input saturation may lead to failure of control or even instability of the auv an increasing number of papers have addressed the problem of input saturation liang and jia 2017 ellenrieder 2018 an anti windup compensator was utilized in cui et al 2016 to solve the problem of attitude control subjected to actuator saturation in shojaei 2016 multi layer neural networks were combined with an adaptive robust control strategy to deal with the actuator saturation and model uncertainties including unknown vehicle parameters approximation errors and constant or time varying environmental disturbances induced by waves and ocean currents in li et al 2015 disturbance observers were designed to compensate for the disturbance caused by unknown input saturation fuzzy approximation errors and other uncertain disturbances motivated by the afore mentioned analyses this paper proposes an improved line of sight based adaptive trajectory tracking controller for an under actuated auv subjects to ocean currents and input saturation the main contributions are summarized as follows 1 extended disturbance observers are employed to deal with the ocean currents induced uncertainties in both kinematic and dynamic models which estimate not only the uncertainties but also the time derivatives of uncertainties 2 an improved los guidance law is utilized to steer the vehicle towards the desired trajectory where an auxiliary variable is introduced to the conventional los guidance law and extended disturbance observers are utilized to estimate the ocean current induced disturbances in the kinematic model 3 an adaptive robust dynamic controller is designed which employs terminal sliding mode control to improve system robustness and asymptotic convergence and applies an anti windup compensator to weaken the influence of actuator saturation 4 the uniformly ultimately bounded convergence of all closed loop signals is guaranteed by lyapunov analysis and the robustness and effectiveness of the proposed control method are tested and validated through plenty of numerical simulations the remainder of this paper is organized as follows section 2 presents the auv models with ocean currents derives the tracking error dynamics in horizontal plane and formulates the trajectory tracking control problem section 3 proposes the improved line of sight based adaptive trajectory tracking control scheme and presents the detailed deriving and proving process section 4 validates the previous analysis and design through plenty of simulation cases and discussions section 5 demonstrates the conclusions of this work 2 auv modeling and problem formulation 2 1 auv model considering ocean currents the auv considered in this paper is assumed to be neutrally buoyant following standard practice the kinematic and dynamic model of the auv in horizontal plane can be described by the motion components in surge sway and yaw degrees of freedom the definitions of the main parameters of the auv model used in this paper are presented in appendix a considering the influences of ocean currents the kinematic model of auv can be expressed in terms of relative surge and sway velocities as follows 1 ψ r x u r cos ψ v r sin ψ v x y u r sin ψ v r cos ψ v y where v x and v y are velocity components of the time varying ocean currents expressed in the x and y directions of inertial reference frame u r v r and r are the relative surge sway and yaw velocities with respect to the water neglecting the motions in heave roll and pitch directions the 3 dof dynamic model of auv in horizontal plane is simplified as 2 u r f u u r v r r g u x t d u v r f v u r v r r d v r f r u r v r r g r δ d r where d u d v and d r denote compound uncertainties with unknown upper bounds x t is the propeller thrust force along the vehicle s surge motion δ is the angle of the yaw rudder f u u r v r r f v u r v r r f r u r v r r g u and g r are known nonlinear functions as shown in 3 3 f u u r v r r m v r r m x g r 2 m y g r x u u u r u r x u u r x v r v r r x r r r 2 m x u g u 1 m x u f v u r v r r m u r r m y g r 2 m x g r y v v v r v r y r r r r y v v r y r r y u r u r r y u v u r v r m y v f r u r v r r m x g v r u r r m y g u r v r r n v v v r v r n r r r r n v v r n r r n u r u r r n u v u r v r i z z n r g r n u u δ r u 2 i z z n r remark 1 as shown in dynamic model 2 the auv discussed in this paper has three degrees of freedom whereas the number of independent control inputs is two due to no actuator in sway direction therefore the auv is a second order under actuated system remark 2 the influences of ocean currents are fully taken into account in this paper the kinematic model 1 is expressed in terms of relative surge and sway velocities and the ocean current forces of dynamic model 2 are implemented by replacing the generalized velocity vector in the hydrodynamic terms with relative velocities remark 3 for marine vehicles there exists inherent actuator saturation naik and singh 2007 zheng et al 2017 therefore the propeller thrust and the yaw rudder angle of the auv discussed here should be bounded viz x t x t max and δ δ max where x t max and δ max are known positive constants 2 2 trajectory tracking error dynamics the trajectory tracking problem is described in fig 1 where i b and f designate the inertial reference frame the body fixed frame and the frenet serret frame respectively the auv is required to track the desired trajectory in horizontal plane p is a moving point acting as a virtual target on the trajectory to be tracked associated with p on the desired trajectory f is built and the axes of which are tangent and normal to the trajectory let x y t be the actual position vector of the auv in i x d y d t the desired position vector of the moving virtual target on the trajectory in i the trajectory tracking error vector built in the inertial frame can be described as 4 x e i x x d y e i y y d subsequently the trajectory tracking error vector built in f is derived as 5 x e y e cos ψ f sin ψ f sin ψ f cos ψ f x e i y e i where ψ f arctan y d x d differentiating 5 and utilizing 1 yields 6 x e x x d cos ψ f x e i ψ f sin ψ f y y d sin ψ f y e i ψ f cos ψ f u r cos ψ v r sin ψ v x x d cos ψ f ψ f sin ψ f x x d u r sin ψ v r cos ψ v y y d sin ψ f ψ f cos ψ f y y d u r cos ψ β r ψ f cos β r u c cos β c ψ f u d 1 κ y e 7 y e x x d sin ψ f x e i ψ f cos ψ f y y d cos ψ f y e i ψ f sin ψ f u r cos ψ v r sin ψ v x x d sin ψ f ψ f cos ψ f x x d u r sin ψ v r cos ψ v y y d cos ψ f ψ f sin ψ f y y d u r sin ψ β r ψ f cos β r u c sin β c ψ f κ u d x e where u c v x 2 v y 2 is the resultant velocity of ocean currents u d x d 2 y d 2 is the velocity of the point p on the desired trajectory κ is the curvature of the point p on the desired trajectory and κ ψ f u d β c arctan v y v x β r arctan v r u r hence the trajectory tracking error dynamics in frenet serret frame f is given by 8 x e u r cos ψ β r ψ f θ x u d 1 κ y e y e u r sin ψ β r ψ f θ y κ u d x e where θ x and θ y are the ocean currents induced components and θ x u c cos β c ψ f θ y u c sin β c ψ f u r is the resultant velocity of the vehicle and u r u r cos β r 2 3 problem formulation our objective is to develop a controller to regulate the auv tracking the desired trajectory in horizontal plane regardless of highly coupled system nonlinearities time varying ocean currents and input saturations the objective can be divided into two control problems as shown below 1 kinematic control given a desired trajectory and the trajectory tracking error dynamics 8 design a kinematic guidance and control law to generate the desired surge velocity u r d desired heading angle ψ d and desired yaw velocity r d so that all the trajectory tracking error vectors in 8 can converge uniformly and asymptotically to an arbitrarily small neighborhood around zero as t goes to despite the time varying ocean currents 2 dynamic control given the desired surge velocity u r d yaw velocity r d and the under actuated dynamic model 2 derive an effective dynamic control law to generate the control input x t and δ so that the tracking errors u r u r d and r r d can converge uniformly and asymptotically to an arbitrarily small neighborhood around zero as t goes to despite the highly coupled system nonlinearities ocean currents induced disturbances and input saturations to facilitate the trajectory tracking controller design in the next section following assumptions are required assumption 1 the predefined trajectory are finite such that x d y d x d and y d are bounded assumption 2 for the system s uncertainties in 8 there exist positive constants θ x θ x θ x θ y θ y θ y such that θ x and θ y satisfy the following conditions θ x θ x θ x θ x θ x θ x θ y θ y θ y θ y θ y θ y assumption 3 for the system s uncertainties in 2 there exist positive constants d u d u d u d v d v d v d r d r d r such that d u d v and d r satisfy the following conditions d u d u d u d u d u d u d v d v d v d v d v d v d r d r d r d r d r d r 3 controller design 3 1 structure of the proposed control scheme as analyzed before the under actuated auv discussed in this paper subjects to highly coupled nonlinearities ocean currents induced uncertainties and input saturation in addition the influences of ocean currents are considered in a comprehensive way such that both the kinematic and dynamic models are established with ocean currents in order to achieve satisfying trajectory tracking the proposed controller not only needs to have good kinematic guidance performance under ocean currents but also has to conduct accurate and robust dynamic control against the highly coupled nonlinearities unknown disturbances and input saturation considering the aforementioned problems an improved los guidance law based adaptive terminal sliding mode controller is proposed in this section as shown in fig 2 a successive control structure is adopted where the proposed trajectory tracking controller is divided in two subsystems namely kinematic control and dynamic control the first subsystem mainly consists of improved los guidance law and kinematic controller design to achieve good guidance control against ocean currents an improved los guidance law is employed by introducing an auxiliary variable to the conventional los guidance law and utilizing extended disturbance observers to estimate the ocean current induced disturbances in the kinematic model compared with conventional los guidance law the proposed edo based improved los guidance law has better guidance ability since the influences of ocean currents have been estimated by the extended disturbance observers and compensated by the auxiliary variable therefore the proposed improved los guidance law is more suitable than conventional los method when facing with ocean currents in addition to track the desired heading angle derived by the improved los guidance law an edo based kinematic tracking control law is designed and the desired surge and yaw velocity are obtained for the dynamic control subsystem the second subsystem addresses the dynamic controller design in the presence of highly coupled nonlinearities unknown external disturbances and input saturation both velocity tracking and attitude tracking are considered in dynamic controller design adaptive terminal sliding mode control is utilized as the main control algorithm and extended disturbance observer is utilized for the current induced disturbance estimation and compensation compared with the conventional sliding mode control the proposed edo based terminal sliding mode control has better robustness and converging rate as well as better anti jamming ability in addition anti windup compensator is utilized to weaken the influence of actuator saturation based on the proposed kinematic and dynamic control the trajectory tracking control objective can be achieved in the presence of complex nonlinearities ocean currents induced uncertainties and input saturation 3 2 nonlinear extended disturbance observers design to estimate the unknown uncertainties in kinematic model 2 and dynamic model 8 following second order extended disturbance observers are utilized ginoya et al 2014 9 θ ˆ x p x 1 l x 1 x e p x 1 l x 1 u r cos ψ β r ψ f cos β r u d 1 κ y e θ ˆ x θ ˆ x θ ˆ x p x 2 l x 2 x e p x 2 l x 2 u r cos ψ β r ψ f cos β r u d 1 κ y e θ ˆ x 10 θ ˆ y p y 1 l y 1 y e p y 1 l y 1 u r sin ψ β r ψ f cos β r κ u d x e θ ˆ y θ ˆ y θ ˆ y p y 2 l y 2 y e p y 2 l y 2 u r sin ψ β r ψ f cos β r κ u d x e θ ˆ y 11 d ˆ u p u 1 l u 1 u r p u 1 l u 1 f u u r v r r g u x t d ˆ u d ˆ u d ˆ u p u 2 l u 2 u r p u 2 l u 2 f u u r v r r g u x t d ˆ u 12 d ˆ r p r 1 l r 1 r p r 1 l r 1 f r u r v r r g r δ d ˆ r d ˆ r d ˆ r p r 2 l r 2 r p r 2 l r 2 f r u r v r r g r δ d ˆ r where θ ˆ and d ˆ are the estimations of the uncertainties θ ˆ and d ˆ are time derivative estimations of the uncertainties p 1 and p 2 are the observer auxiliary states l 1 and l 2 are the observer gains which need to be determined remark 4 compared with conventional disturbance observer the second order disturbance observer employed in this paper estimates not only the uncertainties but also the time derivatives of uncertainties remark 5 the estimate values of second order disturbance observer will be utilized in the kinematic and dynamic controller design therefore the disturbance d v is not estimated since there is no actuator in sway direction on the contrary the influence of d v is indirectly eliminated by employing the improved los guidance law theorem 1 utilizing the proposed second order disturbance observers 9 12 the estimation errors of uncertainties are guaranteed to converge to a specified compact set around the origin proof for convenience the proposed second order disturbance observers in 9 12 are rewritten in a compact form as follows 13 d ˆ c p 1 l 1 x c 14 p 1 l 1 x c d c d ˆ c d ˆ c 15 d ˆ c p 2 l 2 x c 16 p 2 l 2 x c d c d ˆ c where d c θ x θ y d u d r t x c x e y e u r t l 1 l x 1 l y 1 l u 1 l r 1 t l 2 l x 2 l y 2 l u 2 l r 2 t p 1 p x 1 p y 1 p u 1 p r 1 t p 2 p x 2 p y 2 p u 2 p r 2 t the proving process is illustrated in the following two steps step 1 observer error dynamics derivation from 13 14 one can obtain 17 d ˆ c p 1 l 1 x c l 1 x c d c d ˆ c d ˆ c l 1 x c l 1 d c d ˆ c where d c d c d ˆ c subtracting both sides of 17 from d c one can obtain 18 d c l 1 d c d c d ˆ c l 1 d c d c where d c d c d ˆ c similarly based on 15 16 one can obtain 19 d c l 2 d c d c differentiating 18 and utilizing 19 yields 20 d c l 1 d c l 2 d c d c since d c is bounded according to assumption 2 and assumption 3 it is clearly that d c is stable if l 1 0 and l 2 0 define the estimation error vector as e 1 d c d c t then the observer error dynamics can be expressed as 21 e 1 l c e 1 e c d c 22 l c l 1 1 l 2 0 e c 0 1 step 2 stability analysis the eigenvalue equation of l c can be described as 23 λ i l c λ l 1 1 l 2 λ 0 from 23 one can obtain 24 λ 2 l 1 λ l 2 0 obviously it is always possible to select l 1 and l 2 such that the eigenvalue of l c can be placed arbitrarily assume l 1 and l 2 are selected that the eigenvalues of l c are in the lhp then it is always possible to find a positive definite matrix p c such that 25 l c t p c p c l c q c where q c denotes arbitrary positive definite matrix and the smallest eigenvalue of which is λ m consider the following lyapunov function candidate 26 v c e 1 t p c e 1 differentiating 26 and utilizing 25 yields 27 v c e 1 t l c t p c p c l c e 1 2 e 1 t p c e c d c e 1 t q c e 1 2 e 1 p c e c d c e 1 λ m e 1 2 p c e c d c it can be concluded from 27 that v c 0 as long as e 1 2 p c e c d c λ m consequently the decrease of v c will drive e 1 into the compact set e 1 2 p c e c d c λ m therefore both d c and d c are proved to be bounded moreover the parameters can be chosen to ensure the estimation errors converge to a specified compact set around the origin end proof 3 3 kinematic controller design 3 3 1 improved los guidance law design line of sight los is a popular heading guidance method applied in the marine vehicle systems the main idea of los guidance is to mimic the actions of a helmsman which steer the vehicle towards a look ahead distance ahead of the projection point of the vehicle along the trajectory to compensate for the ocean currents and steer the vehicle towards the desired trajectory an improved los guidance law is employed as miao et al 2017a 28 ψ d ψ f β r arctan y e α y δ where ψ d is the desired heading angle δ is a positive constant the auxiliary variable is designed to compensate for the influences of ocean currents and takes the following form 29 α y y e θ ˆ y u r 2 θ ˆ y u r δ 2 1 θ ˆ y u r 2 y e 2 1 θ ˆ y u r 2 where θ ˆ y is the estimation of θ y remark 6 the above los guidance law changes with the time varying trajectory tracking error y e which transforms the position error into the orientation error consequently the tracking error in the under actuated sway degree of freedom can be indirectly eliminated remark 7 compared with conventional los guidance law an auxiliary variable is introduced here which helps compensate for the influences of ocean currents remark 8 the selection of δ affects the approaching guidance performance for instance a large δ brings a mild approaching guidance whereas a small δ brings an aggressive approaching guidance in this paper δ is chosen as two vehicle s length 3 3 2 kinematic control law design to achieve kinematic control following edo based tracking control law is designed 30 u r d k 1 x e u d θ ˆ x cos β r δ 2 y e α y 2 δ r d ψ d k 2 ψ ψ d where k 1 and k 2 are the designed positive parameters ψ d is the desired heading angle generated by improved los guidance law theorem 2 utilizing improved los guidance law 28 and edo based kinematic tracking control law 30 the tracking errors vectors of heading angle and position are guaranteed to converge to a specified compact set around the origin proof the proving process is illustrated in the following two steps step 1 convergence proof of heading angle tracking define the tracking error of heading angle as 31 ψ e ψ ψ d consider the following lyapunov function candidate 32 v 1 1 2 ψ e 2 differentiating 32 yields 33 v 1 ψ e ψ e ψ e r ψ d substituting 30 into 33 one can obtain 34 v 1 k 2 ψ e 2 that means v 1 0 anywhere except the origin hence it is proved that utilizing the designed virtual control law r d the tracking error ψ e can converge to a specified compact set around the origin step 2 convergence proof of position tracking based on 28 and 8 the trajectory tracking error dynamics can be further expressed as 35 x e u r δ δ 2 y e α y 2 u r ψ e ϕ x y e ψ e θ x u d 1 κ y e y e u r y e α y δ 2 y e α y 2 u r ψ e ϕ y y e ψ e θ y κ u d x e where ϕ x y e ψ e and ϕ y y e ψ e are two auxiliary functions which take following forms 36 ϕ x y e ψ e cos ψ e 1 ψ e δ δ 2 y e α y 2 sin ψ e ψ e y e α y δ 2 y e α y 2 ϕ y y e ψ e sin ψ e ψ e δ δ 2 y e α y 2 cos ψ e 1 ψ e y e α y δ 2 y e α y 2 since cos ψ e 1 ψ e 0 73 sin ψ e ψ e 1 δ δ 2 y e α y 2 1 y e α y δ 2 y e α y 2 1 the upper bounds of ϕ x y e ψ e and ϕ y y e ψ e are determined to be 1 73 consider the following lyapunov function candidate 37 v 2 1 2 x e 2 1 2 y e 2 1 2 θ x 2 1 2 l x 2 θ x 2 1 2 θ y 2 1 2 l y 2 θ y 2 where θ x θ x θ ˆ x θ x θ x θ ˆ x θ y θ y θ ˆ y θ y θ y θ ˆ y differentiating 37 yields 38 v 2 x e x e y e y e θ x θ x 1 l x 2 θ x θ x θ y θ y 1 l y 2 θ y θ y x e u r δ δ 2 y e α y 2 u r ψ e ϕ x y e ψ e θ x u d 1 κ y e y e u r y e α y δ 2 y e α y 2 u r ψ e ϕ y y e ψ e θ y κ u d x e θ x l x 1 θ x θ x 1 l x 2 θ x l x 2 θ x θ x θ y l y 1 θ y θ y 1 l y 2 θ y l y 2 θ y θ y x e u r δ δ 2 y e α y 2 u r ψ e ϕ x y e ψ e θ x u d y e u r y e α y δ 2 y e α y 2 u r ψ e ϕ y y e ψ e θ y l x 1 θ x 2 1 l x 2 θ x θ x l y 1 θ y 2 1 l y 2 θ y θ y based on 29 one can obtain 39 u r α y δ 2 y e α y 2 θ ˆ y substituting 39 into 38 one can obtain 40 v 2 x e u r δ δ 2 y e α y 2 u r ψ e ϕ x y e ψ e θ x u d y e u r y e δ 2 y e α y 2 u r ψ e ϕ y y e ψ e θ y l x 1 θ x 2 1 l x 2 θ x θ x l y 1 θ y 2 1 l y 2 θ y θ y based on 30 the virtual control resultant velocity of the vehicle can be obtained as 41 u r d u r d cos β r k 1 x e u d θ ˆ x δ 2 y e α y 2 δ substituting 41 into 40 one can obtain 42 v 2 k 1 x e 2 x e u r ψ e ϕ x y e ψ e x e θ x u r y e 2 δ 2 y e α y 2 y e u r ψ e ϕ y y e ψ e y e θ y l x 1 θ x 2 1 l x 2 θ x θ x l y 1 θ y 2 1 l y 2 θ y θ y x e y e k 1 0 0 u r δ 2 y e α y 2 x e y e t x e y e u r ψ e ϕ x y e ψ e θ x u r ψ e ϕ y y e ψ e θ y l x 1 θ x 2 1 l x 2 θ x θ x l y 1 θ y 2 1 l y 2 θ y θ y x e y e k 1 0 0 u r δ 2 y e α y 2 x e y e t x e y e u r ψ e ϕ x y e ψ e θ x u r ψ e ϕ y y e ψ e θ y 1 l x 2 θ x θ x 1 l y 2 θ y θ y since it has been proved in theorem 1 that the estimation errors of edo are bounded it is proper to suppose that θ x μ x θ y μ y besides according to assumption 2 one can obtain that θ x θ x and θ y θ y therefore 1 l x 2 θ x θ x 1 l y 2 θ y θ y is bounded and assume the upper bound of 1 l x 2 θ x θ x 1 l y 2 θ y θ y is γ 1 define e 2 x e y e t m k 1 0 0 u r δ 2 y e α y 2 and n u r ψ e ϕ x y e ψ e θ x u r ψ e ϕ y y e ψ e θ y 42 can be further derived as 43 v 2 e 2 t m e 2 e 2 t n γ 1 m e 2 n 2 m 2 γ 1 n 2 4 m m e 2 n 2 m 2 γ 2 where γ 2 γ 1 n 2 4 m obviously it can be concluded from 43 that v 2 0 as long as e 2 n 2 m 2 γ 2 m consequently the decrease of v 2 will drive the tracking errors into the boundary e 2 n 2 m γ 2 m moreover the parameters can be chosen to ensure the tracking error vector e 2 converge to a specified compact set around the origin end proof 3 4 dynamic controller design the dynamic controller is divided into two subsystems namely attitude tracking control and velocity tracking control to improve tracking performance and converging rate despite the uncertainties with unknown upper bounds edo based adaptive terminal sliding mode control is employed meanwhile an anti windup compensator is utilized to eliminate the influence of input saturation the detailed designing and deriving process are presented as follows 3 4 1 attitude tracking controller design the designing process of attitude tracking controller is illustrated in two sections in section 3 4 1 1 an adaptive terminal sliding mode attitude controller is designed without input saturation in section 3 4 1 2 the input saturation existing in practical application for auv is considered and the attitude controller is redesigned 3 4 1 1 unconstrained adaptive attitude tracking controller design without input saturation define the attitude tracking error as 44 z r r r d choose the following integral sliding mode surface 45 s r z r c r 0 t z r d t where c r 0 differentiating 45 and utilizing 2 yields 46 s r f r g r δ d r r d c r z r where f r is the abbreviation of f r u r v r r similarly hereinafter the accessibility of the sliding mode condition guarantees that the system can reach the sliding mode surface in finite time whereas it has no restriction during the approach course to improve the convergence efficiency and system dynamic response following terminal reaching law is employed 47 s r τ r s r σ r s r r r s i g n s r where τ r 0 σ r 0 0 r r 1 the control input δ is selected as follows 48 δ τ r s r σ r s r r r s i g n s r c r z r r d f r d ˆ r g r where d ˆ r is the second order disturbance observer employed to estimate d r as shown in 12 theorem 3 under the proposed control input 48 and second order extended disturbance observer 12 the tracking error z r is guaranteed to converge to a specified compact set around the origin proof consider the following lyapunov function candidate 49 v r 1 1 2 s r 2 1 2 d r 2 1 2 l r 2 d r 2 substituting 48 into 46 yields 50 s r τ r s r σ r s r r r s i g n s r d r differentiating 49 utilizing 18 19 and 50 one can obtain 51 v r 1 s r s r d r d r 1 l r 2 d r d r s r τ r s r σ r s r r r s i g n s r d r d r l r 1 d r d r 1 l r 2 d r l r 2 d r d r τ r s r 2 σ r s r r r 1 s r d r l r 1 d r 2 1 l r 2 d r d r τ r s r 2 σ r s r r r 1 s r d r l r 1 d r 2 1 l r 2 d r d r τ r 1 2 σ 4 s r 2 σ r s r r r 1 l r 1 σ 4 2 d r 2 1 l r 2 d r d r where σ 4 is a user defined positive constant since it has been proved by theorem 1 that d r is converged it is proper to assume the upper bound of d r is μ r if σ 4 is selected to guarantee l r 1 σ 4 2 0 then 51 is further derived as 52 v r 1 τ r 1 2 σ 4 s r 2 σ r s r r r 1 1 l r 2 μ r d r where d r is the upper bound of d r according to assumption 2 obviously it can be concluded from 52 that v r 1 0 as long as s r 2 μ r d r l r 2 τ r 1 2 σ 4 or s r r r 1 μ r d r l r 2 σ r consequently the decrease of v r 1 will drive s r into the boundary s r μ r d r l r 2 τ r 1 2 σ 4 or s r μ r d r l r 2 σ r r r 1 therefore it is proved that under the proposed unconstrained attitude tracking control law 48 the system states are forced towards the given sliding manifold and the sliding mode surface s r is bounded to a specified compact set described by 53 ω s r s r r s r ζ r where ζ r min μ r d r l r 2 τ r 1 2 σ 4 μ r d r l r 2 σ r r r 1 moreover by solving 45 following equation can be obtained 54 z r t s r t c r e c r t 0 t s r ϖ e c r ϖ d ϖ considering the boundary of s r presented in 53 one can obtain 55 z r s r c r e c r t 0 t s r ϖ e c r ϖ d ϖ ζ r c r e c r t 0 t ζ r e c r ϖ d ϖ ζ r 1 c r e c r t 0 t e c r ϖ d ϖ ζ r 2 e c r t 2 ζ r therefore it is proved that under the proposed unconstrained attitude tracking control law 48 the tracking error z r is bounded to a specified compact set described by 56 ω z r z r r z r 2 ζ r moreover the parameters can be chosen to ensure the attitude tracking error converge to a specified compact set around the origin end proof 3 4 1 2 constrained adaptive attitude tracking controller design with input saturation now we consider the attitude tracking case with input saturation due to the existence of actuator saturation the actual control input can be expressed as 57 δ 1 s a t δ δ m s i g n δ δ δ m δ δ δ m where δ m denote the known magnitude of the saturation limit s a t and s i g n denote the saturation and unit sign function respectively to eliminate the influence of input saturation we employ the anti windup compensator galeani et al 2009 cui et al 2016 as 58 w r k r w r g r s r δ δ 1 2 δ δ 2 w r 2 w r δ δ w r μ r 0 w r μ r where δ δ δ 1 δ w r is the state of the auxiliary design system k r 0 is a design parameter μ r is a small positive design parameter the constrained attitude tracking controller is redesigned as 59 δ τ r s r w r σ r s r r r s i g n s r c r z r r d f r d ˆ r g r where d ˆ r is the second order disturbance observer employed to estimate d r as shown in 12 theorem 4 under the proposed constrained attitude tracking control law 59 anti windup compensator 58 and second order disturbance observer 12 the tracking error z r is guaranteed to converge to a specified compact set around the origin proof considering the input saturation a new equivalent attitude tracking model is expressed as follows 60 r f r g r δ δ δ d r the definitions of tracking error z r and sliding mode surface s r are the same with 44 45 differentiating 45 and utilizing 60 yields 61 s r f r g r δ g r δ δ d r r d c r z r consider the following lyapunov function candidate 62 v r 2 1 2 s r 2 1 2 d r 2 1 2 l r 2 d r 2 1 2 w r 2 where d r d r d ˆ r d r d r d ˆ r differentiating 62 utilizing 18 19 and 61 one can obtain 63 v r 2 s r s r d r d r 1 l r 2 d r d r w r w r s r f r g r δ g r δ δ d r r d c r z r d r l r 1 d r d r 1 l r 2 d r l r 2 d r d r w r k r w r g r s r δ δ 1 2 δ δ 2 w r 2 w r δ δ substituting 59 into 63 yields 64 v r 2 s r τ r s r τ r w r σ r s r r r s i g n s r g r δ δ d r l r 1 d r 2 1 l r 2 d r d r k r w r 2 g r s r δ δ 1 2 δ δ 2 w r δ δ τ r s r 2 σ r s r r r 1 τ r s r w r s r d r l r 1 d r 2 1 l r 2 μ r d r k r w r 2 1 2 δ δ 2 w r δ δ there exist following facts 65 s r w r s r 2 2 σ 5 σ 5 w r 2 2 66 s r d r s r 2 2 σ 6 σ 6 d r 2 2 67 w r δ δ w r 2 2 σ 7 σ 7 δ δ 2 2 where σ 5 σ 6 σ 7 are positive designed parameters substituting 65 67 into 64 one can obtain 68 v r 2 τ r τ r 2 σ 5 1 2 σ 6 s r 2 σ r s r r r 1 l r 1 σ 6 2 d r 2 k r τ r σ 5 2 1 2 σ 7 w r 2 1 2 σ 7 2 δ δ 2 1 l r 2 μ r d r τ r τ r 2 σ 5 1 2 σ 6 s r 2 σ r s r r r 1 1 l r 2 μ r d r where the design parameters are chosen to satisfy the conditions l r 1 σ 6 2 0 k r τ r σ 5 2 1 2 σ 7 0 and 1 2 σ 7 2 0 adopting the same deriving method as theorem 3 following conclusion can be made under the proposed constrained attitude tracking control law 59 anti windup compensator 58 and second order disturbance observer 12 the tracking error z r is bounded to a specified compact set described by 69 ω z r z r r z r 2 ζ r where ζ r min μ r d r l r 2 τ r τ r 2 σ 5 1 2 σ 6 μ r d r l r 2 σ r r r 1 moreover the parameters can be chosen to ensure the attitude tracking error converge to a specified compact set around the origin end proof 3 4 2 velocity tracking controller design as shown in 2 the velocity tracking subsystem has the same structure as attitude tracking subsystem therefore the same control method will be utilized to achieve velocity tracking as in section 3 4 1 the velocity tracking error is defined as 70 z u u r u r d choose the following integral sliding mode surface 71 s u z u c u 0 t z u d t where c u 0 due to the existence of actuator saturation the actual control input can be expressed as 72 x t 1 s a t x t x t m s i g n x t x t x t m x t x t x t m where x t m denote the known magnitude of the saturation limit s a t and s i g n denote the saturation and unit sign function respectively to eliminate the influence of input saturation a similar anti windup compensator is utilized as 73 w u k u w u g u s u δ x t 1 2 δ x t 2 w u 2 w u δ x t w u μ u 0 w u μ u where δ x t x t 1 x t w u is the state of the auxiliary design system k u 0 is a design parameter μ u is a small positive design parameter a new equivalent velocity tracking model with input saturation is expressed as follows 74 u r f u g u x t δ x t d u where f u is the abbreviation of f u u r v r r similarly hereinafter differentiating 71 utilizing 60 and 73 one can obtain 75 s u f u g u x t g u δ x t d u u r d c u z u to improve the convergence efficiency and system dynamic response following terminal reaching law is employed 76 s u τ u s u σ u s u r u s i g n s u where τ u 0 σ u 0 0 r u 1 the constrained velocity tracking controller is redesigned as 77 x t τ u s u w u σ u s u r u s i g n s u c u z u u r d f u d ˆ u g u where d ˆ u is the second order disturbance observer employed to estimate d u as shown in 11 remark 9 adopting the same deriving method as theorem 3 and theorem 4 it can be proved that under the proposed constrained velocity tracking control law 77 anti windup compensator 73 and second order disturbance observer 11 the velocity tracking error z u is guaranteed to converge to a specified compact set around the origin for the sake of brevity the specific deriving and proving process will not be presented again here 4 simulation results 4 1 simulation preparation in order to verify the effectiveness and robustness of the proposed trajectory tracking controller numerical simulations are carried out with a well known remus auv prestero 2011 the parameters of auv model are shown in table 1 and the parameters of proposed controller are presented in table 2 four simulation cases are carried out case 1 and case 2 are implemented to verify the trajectory tracking performance and adaptability of the proposed control scheme under different desired trajectories and different initial conditions but without ocean currents case 3 and case 4 are carried out to illustrate the disturbance estimation capability anti jamming ability and trajectory tracking performance of proposed control scheme under different kinds of environmental disturbances besides in order to prove the superiority of the proposed control algorithm simulation results of the other three control algorithms are presented in case 3 and case 4 for comparison 4 2 case 1 2 adaptability analysis of different trajectories tracking without ocean currents to verify the trajectory tracking performance and adaptability of the proposed controller two simulation cases are carried out under different desired trajectories and different initial conditions a straight line is chosen as the desired trajectory in case 1 which can be parameterized by x d 1 5 t m and y d 10 m whereas a curvilinear trajectory is selected as the desired trajectory in case 2 parameterized by x d 1 5 t m and y d 10 sin 0 2 t m moreover to further verify the adaptability of our approach case 1 and case 2 are both carried out with the following two different initial conditions 1 initial condition 1 x 0 y 0 ψ 0 0 m 0 m 0 rad 2 initial condition 2 x 0 y 0 ψ 0 0 m 15 m 0 rad the two different initial positions of the auv are specially selected on different sides of the desired trajectory therefore the tracking ability of the proposed controller form different directions can be verified the trajectory tracking result of case 1 under two different initial conditions is shown in fig 3 and the kinematic tracking errors are shown in fig 4 it can be seen that under the proposed control scheme the auv can converge to and move along the desired trajectory with almost no tracking errors under the two different initial conditions tracking velocities of case 1 are illustrated in fig 5 which shows the velocities of auv is smooth and stable dynamic tracking errors of case 1 are shown in fig 6 which shows that under the adaptive terminal sliding mode dynamic control the dynamic tracking errors converge to zero quickly the control inputs are presented in fig 7 where the values of the control inputs are proved to be within the limits during the whole time domain note that the values of the control inputs have briefly reached the limits in the initial tracking stage since the tracking errors in the initial tracking stage are relatively large and the controller needs to rapidly generate large control inputs the simulation results of case 2 under two different initial conditions are shown in figs 8 12 including the tracking trajectory kinematic tracking errors tracking velocities dynamic tracking errors and control inputs the overall performance of case 2 is consistent with case 1 except that slight fluctuations are observed in the steady value of tracking velocities and control inputs note that this phenomenon is normal since a curvilinear trajectory is selected as the desired trajectory in case 2 and the course angle of auv needs to be adjusted according to the demands according to the simulation results of case 1 and case 2 the proposed control scheme is proved to have good tracking performance for both straight line and curvilinear trajectories and the controller can regulate the auv to the desired trajectory under different initial conditions therefore the tracking performance and adaptability of proposed controller are validated 4 3 case 3 comparative analysis for trajectory tracking with simple ocean currents to verify the disturbance handling ability and robustness of the proposed controller trajectory tracking simulation is carried out with simple ocean currents in this section the same curvilinear trajectory with case 2 is selected as the desired trajectory and the initial condition is set as x 0 y 0 ψ 0 0 m 0 m 0 rad the ocean currents are considered with constant velocity and constant direction and the currents induced uncertainties are selected as v x 0 1 m s v y 0 1 m s d u 0 1 sin 0 3 t d v 0 1 sin 0 3 t d r 0 1 cos 0 3 t for comparison purpose four control algorithms are utilized in the simulation viz 1 method 1 los edosmc conventional los guidance law is utilized for kinematic control and edo based sliding mode control is utilized for dynamic control 2 method 2 edolos smc edo based improved los guidance law is utilized for kinematic control and conventional sliding mode control is employed for dynamic control 3 method 3 an existing esolos esosmc method which utilizes extended state observer based los guidance law esolos for kinematic control and employs eso based sliding mode control for dynamic control 4 the proposed control method the trajectory tracking result of case 3 is shown in fig 13 it is seen that under the proposed control scheme the auv can converge to and move along the desired trajectory with almost no tracking errors whereas bigger tracking errors are observed in the trajectories of the other three control methods to further demonstrate the control performance of the four methods the kinematic tracking errors are shown in fig 14 and the dynamic tracking errors are shown in fig 15 from fig 14 it is easily observed that the tracking errors x e and y e of method 1 are bigger than the other three methods the oscillation of method 2 is the most significant and the performance of method 3 is closer to the proposed control scheme than the other two methods similar conclusions can be drawn from the dynamic tracking errors in fig 15 where significant oscillations can be observed in the performance of method 2 to analyze the tracking performance more clearly and quantitatively data analyses of the steady state kinematic and dynamic tracking errors are carried out three kinds of parameters are calculated to evaluate the steady state tracking accuracy and stability viz 1 ave average value of the absolute tracking errors 2 max maximum value of the absolute tracking errors 3 stdev standard derivation of the tracking errors the analysis results are shown in the bar graphs in fig 16 and fig 17 of the three kinds of parameters stdev directly reflects the tracking stability and ave directly reflects the tracking accuracy as shown in fig 16 the proposed controller performs best with the smallest ave and stdev whereas method 1 exhibits worst kinematic tracking accuracy and method 2 exhibits worst kinematic tracking stability similarly it can be seen form fig 17 that the proposed controller exhibits best dynamic tracking accuracy and stability whereas method 2 exhibits worst dynamic tracking stability according to the above analyses it is easy to find out that compared with method 1 the proposed controller has better tracking control accuracy and compared with method 2 the stability of proposed controller is better besides compared with an existing esolos esosmc method the proposed controller exhibits better trajectory tracking performance in the simulation case 3 moreover to illustrate the disturbance estimation capability the estimation values of the currents induced uncertainties as well as their time derivatives are shown in figs 18 21 it is seen that both the uncertainties and their time derivatives can be well estimated by the proposed extended disturbance observer hence the effectiveness of the extended disturbance observer and the trajectory tracking performance of the proposed control scheme under simple ocean currents are validated 4 4 case 4 comparative analysis for trajectory tracking with complex ocean currents to further verify the trajectory tracking performance and robustness of the proposed controller trajectory tracking simulation is carried out with complex ocean currents in this section the desired trajectory and initial conditions chosen in case 4 is the same as that in case 3 the ocean currents induced uncertainties considered here are time varying state dependent and piecewise as shown below v x 0 1 cos 0 1 t t 150 s 0 2 cos 0 2 t t 150 s v y 0 1 sin 0 1 t t 150 s 0 2 sin 0 2 t t 150 s d u 0 1 sin 0 3 t t 150 s 0 05 sin 0 15 t t 150 s d v 0 1 sin 0 3 t t 150 s 0 05 sin 0 15 t t 150 s d r 0 1 r cos 0 3 t t 150 s 0 2 r cos 0 5 t t 150 s for comparison purposes the four control algorithms utilized in case 4 are the same as that in case 3 the trajectory tracking results and tracking errors of case 4 are shown in figs 22 24 the data analyses of the steady state tracking errors are shown in figs 25 26 similar overall conclusions can be drawn from case 4 that the proposed controller exhibits better tracking accuracy and stability than the other three control methods moreover as shown in fig 22 when the ocean currents increase after 150 s the tracking errors of method 1 and method 2 have experienced significant increases whereas for method 3 and the proposed method only a brief increase emerges and the trajectory converges rapidly to the ideal state therefore it is proved that method 3 and the proposed method have better robustness than method 1 and method 2 besides compared with case 3 the data analysis of steady state kinematic tracking errors in case 4 shows a little different properties in case 3 method 2 exhibits the worst kinematic tracking stability with biggest stdev whereas in case 4 the kinematic tracking stability of method 1 is the worst among the four control algorithms this phenomenon indicates that the influence of kinematic guidance law on the stability of auv trajectory increases with the increase of the ocean currents therefore when facing with the ocean currents in case 4 the poor kinematic guidance capability of the los law in method 1 exacerbates the oscillation of auv trajectory the estimation values of the currents induced uncertainties as well as their time derivatives are shown in figs 27 30 it is also seen that both the uncertainties and their time derivatives can be well estimated by the proposed extended disturbance observer note that even though a big break occurs at 150 s of the actual time derivative value of the uncertainties the estimation value can still track the actual value after that based on the above analyses the effectiveness of the proposed control scheme under time varying and piecewise complex ocean currents is validated 4 5 discussions and future works from the simulation results and aforementioned analyses following conclusions can be drawn 1 based on case 1 and case 2 the proposed control scheme is proved to have good tracking performance and adaptability under different tracking targets and different initial conditions 2 compared with method 1 the proposed controller performs better in tracking accuracy which shows that the proposed edo based improved los law has better kinematic guidance ability than conventional los law when facing with ocean currents 3 compared with method 2 the proposed controller performs better in tracking stability which means that the proposed edo helps improving the robustness and anti jamming ability of dynamic control when facing with ocean currents 4 in the simulation cases of this paper the proposed controller exhibits better trajectory tracking performance than an existing esolos esosmc method compared with eso the structure of proposed edo is more complex but it can estimate not only the disturbances but also the time derivatives of the disturbances however their performances in real ocean environments need further validation and comparison which will be addressed in our future works 5 based on the four simulation cases the proposed controller is proved to have good tracking accuracy stability robustness and anti jamming ability therefore it is able to achieve satisfying trajectory tracking control despite the highly coupled nonlinearities complex ocean currents induced uncertainties and input saturation however in order to promote the practical application of the proposed controller in a real ocean environment following future works are to be implemented 1 various constraints exist in a real auv system including input constraints state constraints and output constraints peng et al 2018 violating system constraints may degrade control performance and even result in instability in some circumstances yan and wang 2012 however in this paper only the input saturation problem is tackled in our future works more effective methods will be designed to deal with various constraints 2 the real ocean environment is very harsh and complex which may bring more serious parameter perturbations model uncertainties and external disturbances to promote the practical application the adaptability of the proposed controller in the real ocean environment needs further verification in our future works 5 conclusion in this paper trajectory tracking control of an under actuated auv is investigated in the presence of highly coupled system nonlinearities ocean currents induced uncertainties and input saturation the influences of ocean currents are considered in both the dynamic models and the kinematic models under an adaptive successive control frame the trajectory tracking system is decoupled as kinematic control and dynamic control an edo based improved los guidance law is utilized for kinematic control where an auxiliary variable is introduced to the conventional los guidance law and extended disturbance observers are utilized to estimate the ocean current induced disturbances in the kinematic model the proposed dynamic controller employs adaptive terminal sliding mode control to improve the tracking performance and converging rate utilizes an extended disturbance observer to improve the system robustness and introduces an anti windup compensator to deal with the actuator saturation lyapunov analysis is performed to prove the stability and performance of the proposed controller moreover the robustness and effectiveness of the controller are tested and validated through numerical simulations and some future works are introduced acknowledgement this work was supported in part by thousand talents program national natural science foundation of china grant numbers 51479114 51579111 51761135012 and the post doctoral fund of china grant number 2018m632117 the platform construction of ocean energy comprehensive supporting service grant number ghme2014zc01 and high tech ship research projects sponsored by miitc floating support platform project grant number 201622 appendix a definitions of the main parameters of the auv model in this paper no parameter definition 1 i inertial reference frame 2 b body fixed frame 3 f frenet serret frame 4 x y ψ t position and orientation vectors 5 u r v r r t relative surge sway and yaw velocities 6 m mass of the vehicle 7 x g y g t locations of the vehicle center of gravity 8 x hydrodynamic coefficients of surge direction 9 y hydrodynamic coefficients of sway direction 10 n hydrodynamic coefficients of yaw direction 11 i z z diagonal inertia tensor 12 x t propeller thrust 13 δ rudder angle 14 x t max the upper limit of propeller thrust 15 δ max the upper limit of rudder angle 16 d u d v d r compound uncertainties in dynamic model 17 v x v y velocity components of the ocean currents 18 β r side slip angle 19 u c resultant velocity of ocean currents 20 u r resultant velocity of the vehicle 21 u d velocity of point p on the desired trajectory 22 κ curvature of the point p on the desired trajectory 23 x d y d t desired position vector 24 x e i y e i t trajectory tracking error vector in the inertial frame 25 x e y e t trajectory tracking error vector in the frenet serret frame 26 θ x θ y ocean current induced components in tracking error dynamics 
22967,the jet fish pump is a potentially valuable tool for fish transport though jet fish pumps have been shown to cause the least damage to fish cavitation as a commonly encountered flow phenomenon can lead to injury or death of fish experiments were conducted to investigate damage to tissue of carassius auratus caused by different cavitation stages in a jet fish pump mortality was assessed for 48 h after the fish passed through the device tissues from swim bladders livers and gills were examined fish were also examined for several important enzymes that are indicators of tissue injury the results showed that cumulative mortalities of fish in cavitation operating conditions were higher than those in non cavitation operating conditions at each sampling time the cumulative mortality in the stable cavitation condition reached 55 within 48 h after the experiment two types of swim bladder damage crumpling and rupturing were found in 60 of the dead fish the damage rate of swim bladders rose with the increase of cavitation and broken swim bladders were found only in cavitation operating conditions in addition liver damage was found in those dead fish experiencing intensive cavitation operating conditions and significantly high serum alt and ast activity verified this damage free bubbles an essential symptom of the gas bubble disease were found in the gill filament of those fish experiencing intensive cavitation operating conditions the significantly high serum ldh activity indicated that fish experienced intense anaerobic respiration during intensive cavitation operating conditions judging from the significant serum cr content cavitation in the jet fish pump also posed a potential risk for the kidneys of fish moreover a pressure damage experiment showed that rupturing of swim bladders occurred in the recompression process environmental pressure between 40 kpa and 58 kpa was a transition area for pressure damage to swim bladders in vitro swim bladders in vitro were safe when environmental pressure was above 58 kpa yet they were broken when environmental pressure was less than 40 kpa this study illustrates that intensive cavitation is a dangerous flow phenomenon for fish in a jet fish pump and should be avoided in practical applications keywords jet fish pump cavitation carassius auratus swim bladders nomenclature a t throat cross sectional area alt alanine aminotransferase cr creatinine d p primary duct diameter d t throat diameter ldh lactic dehydrogenase q j volumetric flow rate of primary stream v t velocity at the throat entrance h pressure ratio p e minimum pressure in the pressure vessel p s total pressure of secondary stream p v vapor pressure of water t c recovery time β diffuser inclination angle δ displacement of bubbles a j annular nozzle cross sectional area ast aspartate aminotransferase d d outlet pipe diameter d s secondary duct diameter h lift l t throat length q s volumetric flow rate of secondary stream m area ratio p c total pressure of mixed stream p j total pressure of primary stream p t static pressure at the throat entrance q flow rate ratio α suction chamber inclination angle ρ water density η jet fish pump efficiency 1 introduction with the significant increase of capture fisheries the fish pump as an important piece of auxiliary equipment reduces both the injury rate of fish and the intensity of human labor in fish transportation valdemarsen 2001 based on operating principles traditional fish pumps are usually classified into three types impeller fish pumps pressure vacuum p v fish pumps and jet fish pumps the impeller fish pump has high transport rate by specially designed high speed rotating blades but these blades probably hit fish and lead to a high mortality the p v fish pump treats fish more gently but its discontinuous operation of suction and discharge does not make full use of the input power as a sort of annular jet pump the jet fish pump works by transferring momentum from a high velocity primary stream to a secondary stream long et al 2016 the jet fish pump has a better comprehensive performance than other types of fish pumps due to non rotating parts and continuous operation even so several potential risks for fish in the jet fish pump cannot be ignored such as rapid change of pressure shear flows recirculation zones and cavitation long et al 2016 decompression and recompression cannot be avoided due to the structure of contraction and expansion shear flows also inevitably appear in the mixing process of primary and secondary streams due to the velocity difference however the occurrence of recirculation and cavitation can be controlled recirculation forms when flow ratio is considerably low in annular jet pumps xiao et al 2013 elger et al 1994 confirmed the onset and disappearance of recirculation and investigated the size and position of recirculation zones in annular jet pumps cavitation as a mass transfer phenomenon is generally defined as the inception growth and subsequent collapse of micro bubbles or cavities due to very low local pressure or high pressure fluctuations in a liquid ji et al 2013 2014a xiao and long 2015 scholars have seriatim discussed impacts of the above flow characteristics on fish the decompression can result in the injury of swim bladders tytler and blaxter 1977 tested the ability of saithe to discriminate small pressure increases above atmospheric pressure and checked states of the swim bladders during these experiments by x ray photography brown et al 2009 investigated the mortality and injury to juvenile chinook salmon oncorhynchus tshawytscha exposed to simulated pressure changes and identified sublethal barotrauma injuries that may increase susceptibility to predation rummer and bennett 2005 used lateral and dorsal x ray imaging in combination with anatomy to investigate swim bladder overexpansion on red snapper decompressed at a rate of 10 1 kpa s 1 and observed the inflation of swim bladders in a predictable manner however proper recompression may cure the swim bladder overexpansion parker et al 2006 conducted simulated capture experiments to investigate the relationship between capture in a fishery barotrauma from pressure change and survival after release and they found that a quick return to depth could be used to minimize mortality of discarded black rockfish in nearshore fisheries compared with the pressure change the shear flow may be a fatal factor to fish neitzel et al 2000 specified strain rate as an index describing the hydraulic force that fish experience when subjected to a shear environment and indicated that fish entering a shear environment may be killed injured or their experience may cause increased susceptibility to predation guensch et al 2002 conducted a study where several other types of fish were released into a submerged water jet to quantify injuries caused by shear stresses and turbulence and found that the inertial stresses of tumbling may cause temporary or even permanent vestibular and neurological injuries of fish however exposure time in the shear environment is a key factor to the mortality of fish an extremely short exposure time in jet fish pumps can effectively decrease the injury rate and mortality long et al 2016 cavitation is generally defined as the inception growth and subsequent collapse of micro bubbles the collapse of micro bubbles or cavities results in a great fluctuating pressure this great fluctuating pressure is likely to damage fish frenkel et al 1999 used transmission electron microscopy to show the effects of therapeutic ultrasound on the external epithelia of fish skin and illustrated that a controlled level of microdamage may be induced to the outer layers of the biological tissues xiao et al 2015 found that cavitation was easy to generate near the head of the fish in jet fish pump and it was a potential harm to the fish s eyes furthermore long et al 2016 studied external injuries of fish caused by cavitation in a jet fish pump and observed potential injuries of eye operculum and scale by high speed photography in addition cavitation probably leads to tissue injuries some injuries on organs such as livers and swim bladders can be directly checked based on anatomy other tissue injuries can be reflected by the variation of relative serum enzymes alanine aminotransferase alt and aspartate aminotransferase ast are common liver function indicators their activities in the blood have a positive correlation with the condition of live cells paulino et al 2017 because most alt and ast are in the liver and some would be released into the blood when liver cells are damaged slavík et al 2017 sancho et al 2017 creatinine cr is used to measure the degree of kidney damage because the filtration capacity of the kidney controls cr content in the serum abdel tawwab et al 2016 the rise of its activity indicates the weakness of filtration capacity and this activity will exceed normal levels when the kidney is damaged lactic dehydrogenase ldh is a key enzyme in anaerobic respiration and its activity can be promoted by stress jin et al 2017 atef et al 2016 because ldh is an essential enzyme in the metabolism of glucose catalyzing pyruvic acid and transforming into lactic acid in the present study we experimentally investigated the mortality and tissue injuries of fish under different cavitation stages in a jet fish pump specifically we measured changes in serum levels of alt ast cr and ldh in fish at selected time intervals after they had passed through the device in addition we checked the tissue injuries in dead fish and designed a pressure vessel to analyze the different impacts of cavitation and pressure change on swim bladders 2 materials and methods 2 1 experimental sample carassius auratus c auratus for short commonly known as the chinese goldfish were treated as experimental samples in this experiment their body length width and weight were 102 10 6 mm 31 4 3 mm and 32 7 6 g mean sem n 100 n is sample size respectively in order to allow c auratus to adapt to the experiment environment fish were kept in an experimental pool 9 0 4 7 1 6 m for 2 weeks before the experiment the average water temperature ph and dissolved oxygen were 25 11 c 8 25 and 8 32 mg l 1 respectively 2 2 experimental device the jet fish pump is comprised of a primary duct a suction duct an annular nozzle a suction chamber a throat and a diffuser as shown in fig 1 a the high pressure primary stream accelerates and exerts an entrainment effect on the secondary stream these two streams mix intensively in the suction chamber and in the throat and then flow out through the diffuser with the outlet pressure recovery shimizu et al 1987 as with our previous studies long et al 2008 2010 a jet fish pump with an area ratio of m 1 75 m a t a j with a t and a j as the cross sectional areas of the throat and annular nozzle respectively mm2 was designed for this experiment the main structural parameters were set as follows the throat diameter d t 60 mm the primary duct diameter d p 100 mm the secondary duct diameter d s 80 mm the outlet pipe diameter d d 125 mm the throat length l t 180 mm the contraction angle α 20 and the diffuser angle β 6 thirteen pressure transducers cy3011bcp30n made by chaoyu co ltd china were installed in the jet fish pump three of them were used to measure the pressures of the primary stream p j the secondary flow p s and the mixed flow p c the other ten pressure transducers were used to capture wall pressures with four in the throat and six in the diffuser the volumetric flow rates of the primary stream q j and the mixed flow q c were measured by electromagnetic flowmeters ifs4000f made by krohne co ltd germany the flow ratio is calculated as q q s q j where q s and q j are volumetric flow rates of the secondary and primary streams m3 h 1 the pressure ratio is calculated as h p c p s p j p c where p c p s and p j are total pressure of mixed secondary and primary streams respectively kpa the jet fish pump efficiency is calculated as η q h 100 in order to decrease mechanical injury to the fish only one valve was installed in the device to control volumetric flow rate of primary stream q j as shown in fig 1 b lift h controlled total pressure of mixed streams p c and it remained unchanged with 2 24 m in the experiment there are significant pressure gradients in a jet fish pump due to its special structure the change of pressure directly affects the state of swim bladders shown as inflation or shrinkage pressure changes when cavitation happens in a jet fish pump therefore a pressure vessel was designed to assess damage to swim bladders caused by pressure changes as shown in fig 1 c its operating principle is simple the primary stream water entrains the secondary stream air in the suction chamber when it soars out of the nozzle which triggers the decrease of pressure in the pressure vessel this pressure will return to 101 kpa ambient pressure absolute pressure when the primary stream is stopped and the check valve is opened two pressure transducers were installed in the primary duct and the pressure vessel respectively the pressure in this pressure vessel could change from 101 kpa to 11 kpa and the reverse process could also be realized in addition this pressure vessel was made of pmma polymethyl methacrylate so that the change of swim bladders could be captured by high speed photography 2 3 experimental procedures before transporting the fish the jet fish pump was prepared by pumping water without fish to obtain the initial operating condition parameters for each cavitation stage five cases were designed and they were controlled by the primary stream rate q j the jet fish pump had the highest efficiency in case 1 the jet fish pump had the maximum non cavitation q j in case 2 a small thin sheet of bubbles generated at the intersection of the suction chamber and the throat with some small bubbles separating and collapsing immediately in case 3 a fluctuating cavity cloud became considerably unstable in the throat in case 4 and the throat was full of cavity clouds in case 5 case 1 and 2 were non cavitation operating conditions case 3 was a slight cavitation operating condition cases 4 and 5 were intensive cavitation operating conditions in order to assess the cavitation degree in each case a cavitation number ji et al 2014b long et al 2016 was defined as σ p t p v 0 5 ρ v t 2 where p v is the vapor pressure of water p t is the static pressure at the throat entrance ρ is the density of water and v t is the velocity at the throat entrance 2 3 1 cumulative mortality and tissue injury in each case the primary stream rate was first regulated per the corresponding value after the device operated for 5 min 40 fish were gently placed into the inlet chute the jet fish pump then pumped the mixture of water and fish into a recycling tank 1 0 1 0 1 0 m the centrifugal pump was stopped thereafter and the fish were gently harvested from the recycling tank the fish were gently placed into a cage 1 0 1 0 1 6 m after they had passed through the device the number of death was recorded every 6 h from 0 h to 48 h the tissue of the swim bladders livers and gill filaments of the dead fish was checked 40 unharvested fish those not handled by the jet fish pump were also were gently placed into another cage 1 0 1 0 1 6 m and the dead of them were also checked as the control group 2 3 2 effect of pressure on swim bladders from 38 kpa to 62 kpa 13 groups of the minimum pressure in the pressure vessel p e were designed at intervals of 2 kpa in each group 10 unharvested fish were gently moved into a barrel with ms 222 tricaine methanesulfonate at 200 mg l 1 when respiration ceased fish were gently moved to the worktable their swim bladders were taken thereafter and then the swim bladders were placed into the pressure vessel the pressure in the pressure vessel decreased and then maintained p e for 20 s after this the pressure recovered to 101 kpa high speed photography recorded the state of swim bladders during the whole process of decompression and recompression the swim bladders were checked after they were taken from the pressure vessel 2 3 3 serum sample cases 1 3 and 5 were non cavitation slight cavitation and intensive cavitation cases respectively so they were selected as the operating condition to study the variation of serum samples in different cavitation stages in cases 1 3 and 5 the primary stream rate was first regulated according to the corresponding value and then 80 fish were gently placed into the inlet chute they were immediately harvested from the recycling tank gently placed into four identical tanks 20 fish per tank and randomly assigned a sampling interval of 0 1 6 or 24 h when the time came to sample fish fish were gently moved into the barrel with ms 222 at 200 mg l 1 they were then gently moved to the worktable once respiration ceased blood samples were taken from the caudal vasculature the blood was placed on ice until all sampling was completed the blood was centrifuged for 15 min at a rotational speed of 4000 rpm serum was suctioned from the blood and then conserved at 80 c for later analysis serum enzymes including alt ast cr and ldh were measured by automatic biochemical analyzer siemens advida 2400 the same experimental procedure was used for 20 unharvested fish that served as the control group 3 results 3 1 characteristics of cases fig 2 shows the basic performance of the jet fish pump and initial operating conditions for each case before transporting the fish time averaged wall pressure at different axial positions are shown for each case in fig 3 trends of average wall pressure were similar in each case the pressure decreased sharply from the nozzle to the throat inlet and increased slightly in the front of throat then it dropped in the rear of the throat and gradually rose until the diffuser exit however amplitudes of wall pressure were different with the increase of primary stream rate q j the minimum wall pressure decreased yet this difference was narrow when q j was high especially for the minimum wall pressures in cases 3 4 and 5 3 2 cumulative mortality and tissue injury cumulative mortalities during a 48 h period were calculated for 5 cases as shown in fig 4 the trends of curves for all cases are similar that cumulative mortalities increased with recovery time t c even in the control group note that the number of cumulative mortalities in intensive cavitation cases cases 4 and 5 was higher than those in slight cavitation case case 3 and non cavitation cases cases 1 and 2 at every sampling time in the non cavitation cases no fish died after they passed through the device in addition the number of cumulative mortalities in slight cavitation and non cavitation cases became stable at the 30th or 36th h but it took more time for the number of cumulative mortalities to stabilize in intensive cavitation cases the swim bladders and livers of dead fish were checked and their gill filaments were observed via microscope olympus ix73 observations found tissue injuries on them namely disseminated hemorrhages 2 9 free bubbles in the gill filament 5 7 and damaged swim bladders 60 as shown in fig 5 diffuse hemorrhages were found in the damaged liver tissues in case 5 as shown in fig 5 a as shown in fig 5 b the microscope revealed some free bubbles on gill filaments in case 5 and these bubbles moved around shrunk and even disappeared as time passed swim bladder damage was the main type of injury to the dead fish including crumpling and rupturing of swim bladders as shown in fig 5 c unlike healthy swim bladders the surface of crumpled swim bladders was loose and there was a significant hole on the broken swim bladder the rate of damage rate to swim bladders is shown in fig 6 the rate in cavitation cases was significantly higher than that in non cavitation cases and it increased with the drop of cavitation number σ it is worth noting that swim bladder damage was found in more than 90 of fish in stable cavitation condition case 5 moreover the rupturing of swim bladders was only found in the dead fish which experienced the cavitation in the jet fish pump 3 3 pressure damage on swim bladders swim bladders were in different states ruptured crumpled or plump after experiencing pressure changes in the pressure vessel fig 7 indicates the rate of swim bladder state after different pressure levels with the decrease of the minimum pressure in the pressure vessel p e the plump swim bladders became crumpled and they finally broke when p e became low enough the shape of swim bladders resisted the effects of pressure when p e was above 60 kpa all swim bladders were broken when p e was less than 40 kpa there was a transitional pressure region between 40 kpa and 60 kpa in which swim bladders were in different states in addition high speed photography revealed that swim bladders inflated when pressure dropped yet they cracked 45 4 6 ms n 10 as soon as pressure rose above the minimum 3 4 responses of biochemical parameters serum levels of alt ast cr and ldh in c auratus at different times after passing through the jet fish pump are shown in fig 8 serum levels of alt and ast increased in cases 1 3 and 5 and the increase of alt and ast are statistically significant after 6 h in case 3 and 0 h in case 5 respectively in case 1 serum levels of cr in the treatment group were different from the control group but this difference was not significant in cases 3 and 5 serum levels of cr were slightly higher in the treatment group than that in the control group and they were statistically significant at 24 h serum levels of ldh changed a little in cases 1 and 3 but they were significantly high at 0 h and 1 h in case 5 4 discussion complex flow phenomenon in the jet fish pump including recirculation flow shear flows cavitation and pressure gradients can result in external injuries to fish long et al 2016 however only cavitation and pressure gradient are potential risks for tissue injuries essentially cavitation damage is a kind of pressure damage to fish cavitation is a mass transfer phenomenon and is generally defined as the inception growth and subsequent collapse of micro bubbles or cavities due to very low local pressures or high pressure fluctuations in a liquid ji et al 2013 2014a the collapse of micro bubbles or cavities results in a great fluctuating pressure brujan et al 2008 used high speed photography with 200 million frames per second to study shock wave emission upon the collapse of a cavitation bubble and found shock pressure to be 1 3 0 3 gpa at a distance of 68 μm from the bubble wall they also estimated the peak pressure at the bubble wall to be about 8 gpa as shown in fig 3 the average minimum wall pressure in intensive cavitation operating conditions case 5 and in non cavitation operating conditions case 2 can reach 8 45 kpa and 19 49 kpa respectively though the difference between these two average minimum wall pressures was small the mortality and injury of fish in cavitation and in non cavitation operating conditions were different the cumulative mortalities in cavitation operating conditions were higher than those in non cavitation operating conditions at each time especially in intensive cavitation operating conditions cases 4 and 5 this is because more fish tissues are heavily damaged in cavitation operating conditions than in non cavitation operating conditions as shown in fig 5 disseminated hemorrhages in the liver and free bubbles in the gill filament were only found in case 5 in addition more damaged swim bladders in the dead fish were found in cavitation operating conditions than in non cavitation operating conditions and broken swim bladders were only found in cavitation operating conditions 4 1 damage to livers the disseminated hemorrhages indicated that blood vessels were broken a condition which can be dangerous or even fatal for fish when fish cross the cavitation regions the pressure in the fish decreases with the drop of local pressure in the jet fish pump a vapor cavity is generated when pressure drops to the saturation vapor pressure of fish body fluid e g blood even though the fish were exposed to the cavitation region for a limited time the bubbles generated in the blood most likely still formed emboli to block the flow of the blood in the capillaries and even leading to the bursting of these blood vessels the blood then flows out of the capillaries and is distributed on the surface of the tissue moreover serum alt and ast activities of the treatment group were significantly higher than those of the control group in intensive cavitation operating conditions case 5 yet those in the non cavitation case 1 and slight cavitation case 3 operating conditions did not show this significance due to the annular nozzle of the jet fish pump the fish rarely touched cavity clouds in case 3 however they were entirely enfolded by cavity clouds in case 5 when fish crossed cavity clouds so bubbles were hardly generated in the blood in case 3 therefore only intensive cavitation in the jet fish pump results in liver damage to fish 4 2 damage in gills free bubbles in the gill filament are an essential symptom of gas bubble disease don et al 2003 which has a high mortality rate and is difficult to control by means of the microscope several free bubbles were found in the gill filaments a displacement δ of a bubble is seen in fig 5 b this bubble became smaller and even disappeared which indicates that the gas in the bubble dissolved this gas is usually dissolved in the water or in the body fluids of fish however gas is released when fish cross a low pressure region the gas is dissolved again when environmental pressure rises in addition it is difficult for fish to obtain oxygen in water when fish cross the cavitation region because a mass of gas is released from the water causing fish to be surrounded by gas and cavity bubbles the significantly high serum ldh activity shows that the cavity clouds affected fish respiration and that they shifted from aerobic to anaerobic respiration in case 5 as shown in fig 8 even though bubbles may also have been released in cases 1 and 3 the number and size of bubbles in case 5 were the greatest and lasted for a longer time thus it can be concluded that intensive cavitation affects fish respiration and even most likely results in gas bubble disease 4 3 damage to swim bladders when a swim bladder is badly damaged the fish would lose the ability to balance and would not live for long taoka et al 2010 compared with the proportion of other tissue injuries damage to swim bladders accounted for a sizeable proportion of the dead fish which indicates that swim bladders were the most vulnerable organ for the dead fish in the experiment due to the special structure of the jet fish pump the fish in it would experience a decompression stage and then a recompression stage the swim bladder would inflate in the decompression stage because the external pressure surrounding the swim bladder suddenly decreases while its internal pressure changes more slowly due to this pressure difference the swim bladder would have to inflate and deform to reduce internal pressure and adapt to the external pressure in the recompression stage external pressure would rise sharply while internal pressure remains less resulting in the shrinkage of the swim bladder the degree of inflation and shrinkage is critical to the condition of the swim bladder the swim bladder would seem unchanged and healthy when the changing amplitude of it is small however the swim bladder would crumple when the degree of change is great enough finally the swim bladder would burst when this degree exceeds its limits of endurance the results of the pressure damage experiment show that swim bladders in vitro became crumpled when the minimum pressure in the pressure vessel p e was below 58 kpa and that rupturing occurred when p e was below 56 kpa when p e reached 40 kpa all swim bladders were broken so the pressure between 40 kpa and 58 kpa is the transition area for pressure damage on swim bladders in vitro the average minimum wall pressure in all cases was less than 40 kpa but no damaged swim bladders were found in the control group and case 2 and only a few crumpled swim bladders were found in dead fish in case 1 due to the protection of organs and bones swim bladders in fresh fish can bear lower pressure than those in vitro however damage rates in cavitation operating conditions were significantly higher than those in non cavitation operating conditions based on the observations via high speed photography swim bladders were broken in the recompression process so the increase of pressure is an essential reason for this rupturing as mentioned above the collapse of cavity results in a huge pressure increase therefore in the jet fish pump cavitation is an important cause for the injury of swim bladders and its rate of occurrence increases when the cavitation becomes more intensive moreover judging from the significant serum cr content in cavitation operating conditions as shown in fig 8 cavitation poses a potential risk for the kidneys of fish the thrombus caused by the cavitation is a probable reason for damage to the kidneys 5 conclusions considering different cavitation stages in a jet fish pump the cavitation damage on tissue of carassius auratus was systematically studied and the pressure damage on swim bladders was also analyzed the following conclusions are obtained 1 the cumulative mortalities of fish in cavitation operating conditions were higher than those in non cavitation operating conditions at each sampling time the cumulative mortality in the stable cavitation condition reached 55 within 48 h after the experiment 2 two types of swim bladder damage crumpling and rupturing were found in 60 of the dead fish the damage rate of swim bladders rose with the increase of cavitation and broken swim bladders were found only in cavitation operating conditions 3 liver damage was found in those dead fish experiencing intensive cavitation operating conditions and significantly high serum alt and ast activity verified this damage free bubbles an essential symptom of the gas bubble disease were found in the gill filament of those fish experiencing intensive cavitation operating conditions the significantly high serum ldh activity indicated that fish experienced intense anaerobic respiration during intensive cavitation operating conditions judging from the significant serum cr content cavitation in the jet fish pump also posed a potential risk for the kidneys of fish 4 environmental pressure between 40 kpa and 58 kpa was a transition area for pressure damage to swim bladders in vitro swim bladders in vitro were safe when environmental pressure was above 58 kpa yet they were broken when environmental pressure was less than 40 kpa acknowledgements this work was financially supported by the national natural science foundation of china project nos 51179134 and no 11472197 and china postdoctoral science foundation project no 2018m642477 
22967,the jet fish pump is a potentially valuable tool for fish transport though jet fish pumps have been shown to cause the least damage to fish cavitation as a commonly encountered flow phenomenon can lead to injury or death of fish experiments were conducted to investigate damage to tissue of carassius auratus caused by different cavitation stages in a jet fish pump mortality was assessed for 48 h after the fish passed through the device tissues from swim bladders livers and gills were examined fish were also examined for several important enzymes that are indicators of tissue injury the results showed that cumulative mortalities of fish in cavitation operating conditions were higher than those in non cavitation operating conditions at each sampling time the cumulative mortality in the stable cavitation condition reached 55 within 48 h after the experiment two types of swim bladder damage crumpling and rupturing were found in 60 of the dead fish the damage rate of swim bladders rose with the increase of cavitation and broken swim bladders were found only in cavitation operating conditions in addition liver damage was found in those dead fish experiencing intensive cavitation operating conditions and significantly high serum alt and ast activity verified this damage free bubbles an essential symptom of the gas bubble disease were found in the gill filament of those fish experiencing intensive cavitation operating conditions the significantly high serum ldh activity indicated that fish experienced intense anaerobic respiration during intensive cavitation operating conditions judging from the significant serum cr content cavitation in the jet fish pump also posed a potential risk for the kidneys of fish moreover a pressure damage experiment showed that rupturing of swim bladders occurred in the recompression process environmental pressure between 40 kpa and 58 kpa was a transition area for pressure damage to swim bladders in vitro swim bladders in vitro were safe when environmental pressure was above 58 kpa yet they were broken when environmental pressure was less than 40 kpa this study illustrates that intensive cavitation is a dangerous flow phenomenon for fish in a jet fish pump and should be avoided in practical applications keywords jet fish pump cavitation carassius auratus swim bladders nomenclature a t throat cross sectional area alt alanine aminotransferase cr creatinine d p primary duct diameter d t throat diameter ldh lactic dehydrogenase q j volumetric flow rate of primary stream v t velocity at the throat entrance h pressure ratio p e minimum pressure in the pressure vessel p s total pressure of secondary stream p v vapor pressure of water t c recovery time β diffuser inclination angle δ displacement of bubbles a j annular nozzle cross sectional area ast aspartate aminotransferase d d outlet pipe diameter d s secondary duct diameter h lift l t throat length q s volumetric flow rate of secondary stream m area ratio p c total pressure of mixed stream p j total pressure of primary stream p t static pressure at the throat entrance q flow rate ratio α suction chamber inclination angle ρ water density η jet fish pump efficiency 1 introduction with the significant increase of capture fisheries the fish pump as an important piece of auxiliary equipment reduces both the injury rate of fish and the intensity of human labor in fish transportation valdemarsen 2001 based on operating principles traditional fish pumps are usually classified into three types impeller fish pumps pressure vacuum p v fish pumps and jet fish pumps the impeller fish pump has high transport rate by specially designed high speed rotating blades but these blades probably hit fish and lead to a high mortality the p v fish pump treats fish more gently but its discontinuous operation of suction and discharge does not make full use of the input power as a sort of annular jet pump the jet fish pump works by transferring momentum from a high velocity primary stream to a secondary stream long et al 2016 the jet fish pump has a better comprehensive performance than other types of fish pumps due to non rotating parts and continuous operation even so several potential risks for fish in the jet fish pump cannot be ignored such as rapid change of pressure shear flows recirculation zones and cavitation long et al 2016 decompression and recompression cannot be avoided due to the structure of contraction and expansion shear flows also inevitably appear in the mixing process of primary and secondary streams due to the velocity difference however the occurrence of recirculation and cavitation can be controlled recirculation forms when flow ratio is considerably low in annular jet pumps xiao et al 2013 elger et al 1994 confirmed the onset and disappearance of recirculation and investigated the size and position of recirculation zones in annular jet pumps cavitation as a mass transfer phenomenon is generally defined as the inception growth and subsequent collapse of micro bubbles or cavities due to very low local pressure or high pressure fluctuations in a liquid ji et al 2013 2014a xiao and long 2015 scholars have seriatim discussed impacts of the above flow characteristics on fish the decompression can result in the injury of swim bladders tytler and blaxter 1977 tested the ability of saithe to discriminate small pressure increases above atmospheric pressure and checked states of the swim bladders during these experiments by x ray photography brown et al 2009 investigated the mortality and injury to juvenile chinook salmon oncorhynchus tshawytscha exposed to simulated pressure changes and identified sublethal barotrauma injuries that may increase susceptibility to predation rummer and bennett 2005 used lateral and dorsal x ray imaging in combination with anatomy to investigate swim bladder overexpansion on red snapper decompressed at a rate of 10 1 kpa s 1 and observed the inflation of swim bladders in a predictable manner however proper recompression may cure the swim bladder overexpansion parker et al 2006 conducted simulated capture experiments to investigate the relationship between capture in a fishery barotrauma from pressure change and survival after release and they found that a quick return to depth could be used to minimize mortality of discarded black rockfish in nearshore fisheries compared with the pressure change the shear flow may be a fatal factor to fish neitzel et al 2000 specified strain rate as an index describing the hydraulic force that fish experience when subjected to a shear environment and indicated that fish entering a shear environment may be killed injured or their experience may cause increased susceptibility to predation guensch et al 2002 conducted a study where several other types of fish were released into a submerged water jet to quantify injuries caused by shear stresses and turbulence and found that the inertial stresses of tumbling may cause temporary or even permanent vestibular and neurological injuries of fish however exposure time in the shear environment is a key factor to the mortality of fish an extremely short exposure time in jet fish pumps can effectively decrease the injury rate and mortality long et al 2016 cavitation is generally defined as the inception growth and subsequent collapse of micro bubbles the collapse of micro bubbles or cavities results in a great fluctuating pressure this great fluctuating pressure is likely to damage fish frenkel et al 1999 used transmission electron microscopy to show the effects of therapeutic ultrasound on the external epithelia of fish skin and illustrated that a controlled level of microdamage may be induced to the outer layers of the biological tissues xiao et al 2015 found that cavitation was easy to generate near the head of the fish in jet fish pump and it was a potential harm to the fish s eyes furthermore long et al 2016 studied external injuries of fish caused by cavitation in a jet fish pump and observed potential injuries of eye operculum and scale by high speed photography in addition cavitation probably leads to tissue injuries some injuries on organs such as livers and swim bladders can be directly checked based on anatomy other tissue injuries can be reflected by the variation of relative serum enzymes alanine aminotransferase alt and aspartate aminotransferase ast are common liver function indicators their activities in the blood have a positive correlation with the condition of live cells paulino et al 2017 because most alt and ast are in the liver and some would be released into the blood when liver cells are damaged slavík et al 2017 sancho et al 2017 creatinine cr is used to measure the degree of kidney damage because the filtration capacity of the kidney controls cr content in the serum abdel tawwab et al 2016 the rise of its activity indicates the weakness of filtration capacity and this activity will exceed normal levels when the kidney is damaged lactic dehydrogenase ldh is a key enzyme in anaerobic respiration and its activity can be promoted by stress jin et al 2017 atef et al 2016 because ldh is an essential enzyme in the metabolism of glucose catalyzing pyruvic acid and transforming into lactic acid in the present study we experimentally investigated the mortality and tissue injuries of fish under different cavitation stages in a jet fish pump specifically we measured changes in serum levels of alt ast cr and ldh in fish at selected time intervals after they had passed through the device in addition we checked the tissue injuries in dead fish and designed a pressure vessel to analyze the different impacts of cavitation and pressure change on swim bladders 2 materials and methods 2 1 experimental sample carassius auratus c auratus for short commonly known as the chinese goldfish were treated as experimental samples in this experiment their body length width and weight were 102 10 6 mm 31 4 3 mm and 32 7 6 g mean sem n 100 n is sample size respectively in order to allow c auratus to adapt to the experiment environment fish were kept in an experimental pool 9 0 4 7 1 6 m for 2 weeks before the experiment the average water temperature ph and dissolved oxygen were 25 11 c 8 25 and 8 32 mg l 1 respectively 2 2 experimental device the jet fish pump is comprised of a primary duct a suction duct an annular nozzle a suction chamber a throat and a diffuser as shown in fig 1 a the high pressure primary stream accelerates and exerts an entrainment effect on the secondary stream these two streams mix intensively in the suction chamber and in the throat and then flow out through the diffuser with the outlet pressure recovery shimizu et al 1987 as with our previous studies long et al 2008 2010 a jet fish pump with an area ratio of m 1 75 m a t a j with a t and a j as the cross sectional areas of the throat and annular nozzle respectively mm2 was designed for this experiment the main structural parameters were set as follows the throat diameter d t 60 mm the primary duct diameter d p 100 mm the secondary duct diameter d s 80 mm the outlet pipe diameter d d 125 mm the throat length l t 180 mm the contraction angle α 20 and the diffuser angle β 6 thirteen pressure transducers cy3011bcp30n made by chaoyu co ltd china were installed in the jet fish pump three of them were used to measure the pressures of the primary stream p j the secondary flow p s and the mixed flow p c the other ten pressure transducers were used to capture wall pressures with four in the throat and six in the diffuser the volumetric flow rates of the primary stream q j and the mixed flow q c were measured by electromagnetic flowmeters ifs4000f made by krohne co ltd germany the flow ratio is calculated as q q s q j where q s and q j are volumetric flow rates of the secondary and primary streams m3 h 1 the pressure ratio is calculated as h p c p s p j p c where p c p s and p j are total pressure of mixed secondary and primary streams respectively kpa the jet fish pump efficiency is calculated as η q h 100 in order to decrease mechanical injury to the fish only one valve was installed in the device to control volumetric flow rate of primary stream q j as shown in fig 1 b lift h controlled total pressure of mixed streams p c and it remained unchanged with 2 24 m in the experiment there are significant pressure gradients in a jet fish pump due to its special structure the change of pressure directly affects the state of swim bladders shown as inflation or shrinkage pressure changes when cavitation happens in a jet fish pump therefore a pressure vessel was designed to assess damage to swim bladders caused by pressure changes as shown in fig 1 c its operating principle is simple the primary stream water entrains the secondary stream air in the suction chamber when it soars out of the nozzle which triggers the decrease of pressure in the pressure vessel this pressure will return to 101 kpa ambient pressure absolute pressure when the primary stream is stopped and the check valve is opened two pressure transducers were installed in the primary duct and the pressure vessel respectively the pressure in this pressure vessel could change from 101 kpa to 11 kpa and the reverse process could also be realized in addition this pressure vessel was made of pmma polymethyl methacrylate so that the change of swim bladders could be captured by high speed photography 2 3 experimental procedures before transporting the fish the jet fish pump was prepared by pumping water without fish to obtain the initial operating condition parameters for each cavitation stage five cases were designed and they were controlled by the primary stream rate q j the jet fish pump had the highest efficiency in case 1 the jet fish pump had the maximum non cavitation q j in case 2 a small thin sheet of bubbles generated at the intersection of the suction chamber and the throat with some small bubbles separating and collapsing immediately in case 3 a fluctuating cavity cloud became considerably unstable in the throat in case 4 and the throat was full of cavity clouds in case 5 case 1 and 2 were non cavitation operating conditions case 3 was a slight cavitation operating condition cases 4 and 5 were intensive cavitation operating conditions in order to assess the cavitation degree in each case a cavitation number ji et al 2014b long et al 2016 was defined as σ p t p v 0 5 ρ v t 2 where p v is the vapor pressure of water p t is the static pressure at the throat entrance ρ is the density of water and v t is the velocity at the throat entrance 2 3 1 cumulative mortality and tissue injury in each case the primary stream rate was first regulated per the corresponding value after the device operated for 5 min 40 fish were gently placed into the inlet chute the jet fish pump then pumped the mixture of water and fish into a recycling tank 1 0 1 0 1 0 m the centrifugal pump was stopped thereafter and the fish were gently harvested from the recycling tank the fish were gently placed into a cage 1 0 1 0 1 6 m after they had passed through the device the number of death was recorded every 6 h from 0 h to 48 h the tissue of the swim bladders livers and gill filaments of the dead fish was checked 40 unharvested fish those not handled by the jet fish pump were also were gently placed into another cage 1 0 1 0 1 6 m and the dead of them were also checked as the control group 2 3 2 effect of pressure on swim bladders from 38 kpa to 62 kpa 13 groups of the minimum pressure in the pressure vessel p e were designed at intervals of 2 kpa in each group 10 unharvested fish were gently moved into a barrel with ms 222 tricaine methanesulfonate at 200 mg l 1 when respiration ceased fish were gently moved to the worktable their swim bladders were taken thereafter and then the swim bladders were placed into the pressure vessel the pressure in the pressure vessel decreased and then maintained p e for 20 s after this the pressure recovered to 101 kpa high speed photography recorded the state of swim bladders during the whole process of decompression and recompression the swim bladders were checked after they were taken from the pressure vessel 2 3 3 serum sample cases 1 3 and 5 were non cavitation slight cavitation and intensive cavitation cases respectively so they were selected as the operating condition to study the variation of serum samples in different cavitation stages in cases 1 3 and 5 the primary stream rate was first regulated according to the corresponding value and then 80 fish were gently placed into the inlet chute they were immediately harvested from the recycling tank gently placed into four identical tanks 20 fish per tank and randomly assigned a sampling interval of 0 1 6 or 24 h when the time came to sample fish fish were gently moved into the barrel with ms 222 at 200 mg l 1 they were then gently moved to the worktable once respiration ceased blood samples were taken from the caudal vasculature the blood was placed on ice until all sampling was completed the blood was centrifuged for 15 min at a rotational speed of 4000 rpm serum was suctioned from the blood and then conserved at 80 c for later analysis serum enzymes including alt ast cr and ldh were measured by automatic biochemical analyzer siemens advida 2400 the same experimental procedure was used for 20 unharvested fish that served as the control group 3 results 3 1 characteristics of cases fig 2 shows the basic performance of the jet fish pump and initial operating conditions for each case before transporting the fish time averaged wall pressure at different axial positions are shown for each case in fig 3 trends of average wall pressure were similar in each case the pressure decreased sharply from the nozzle to the throat inlet and increased slightly in the front of throat then it dropped in the rear of the throat and gradually rose until the diffuser exit however amplitudes of wall pressure were different with the increase of primary stream rate q j the minimum wall pressure decreased yet this difference was narrow when q j was high especially for the minimum wall pressures in cases 3 4 and 5 3 2 cumulative mortality and tissue injury cumulative mortalities during a 48 h period were calculated for 5 cases as shown in fig 4 the trends of curves for all cases are similar that cumulative mortalities increased with recovery time t c even in the control group note that the number of cumulative mortalities in intensive cavitation cases cases 4 and 5 was higher than those in slight cavitation case case 3 and non cavitation cases cases 1 and 2 at every sampling time in the non cavitation cases no fish died after they passed through the device in addition the number of cumulative mortalities in slight cavitation and non cavitation cases became stable at the 30th or 36th h but it took more time for the number of cumulative mortalities to stabilize in intensive cavitation cases the swim bladders and livers of dead fish were checked and their gill filaments were observed via microscope olympus ix73 observations found tissue injuries on them namely disseminated hemorrhages 2 9 free bubbles in the gill filament 5 7 and damaged swim bladders 60 as shown in fig 5 diffuse hemorrhages were found in the damaged liver tissues in case 5 as shown in fig 5 a as shown in fig 5 b the microscope revealed some free bubbles on gill filaments in case 5 and these bubbles moved around shrunk and even disappeared as time passed swim bladder damage was the main type of injury to the dead fish including crumpling and rupturing of swim bladders as shown in fig 5 c unlike healthy swim bladders the surface of crumpled swim bladders was loose and there was a significant hole on the broken swim bladder the rate of damage rate to swim bladders is shown in fig 6 the rate in cavitation cases was significantly higher than that in non cavitation cases and it increased with the drop of cavitation number σ it is worth noting that swim bladder damage was found in more than 90 of fish in stable cavitation condition case 5 moreover the rupturing of swim bladders was only found in the dead fish which experienced the cavitation in the jet fish pump 3 3 pressure damage on swim bladders swim bladders were in different states ruptured crumpled or plump after experiencing pressure changes in the pressure vessel fig 7 indicates the rate of swim bladder state after different pressure levels with the decrease of the minimum pressure in the pressure vessel p e the plump swim bladders became crumpled and they finally broke when p e became low enough the shape of swim bladders resisted the effects of pressure when p e was above 60 kpa all swim bladders were broken when p e was less than 40 kpa there was a transitional pressure region between 40 kpa and 60 kpa in which swim bladders were in different states in addition high speed photography revealed that swim bladders inflated when pressure dropped yet they cracked 45 4 6 ms n 10 as soon as pressure rose above the minimum 3 4 responses of biochemical parameters serum levels of alt ast cr and ldh in c auratus at different times after passing through the jet fish pump are shown in fig 8 serum levels of alt and ast increased in cases 1 3 and 5 and the increase of alt and ast are statistically significant after 6 h in case 3 and 0 h in case 5 respectively in case 1 serum levels of cr in the treatment group were different from the control group but this difference was not significant in cases 3 and 5 serum levels of cr were slightly higher in the treatment group than that in the control group and they were statistically significant at 24 h serum levels of ldh changed a little in cases 1 and 3 but they were significantly high at 0 h and 1 h in case 5 4 discussion complex flow phenomenon in the jet fish pump including recirculation flow shear flows cavitation and pressure gradients can result in external injuries to fish long et al 2016 however only cavitation and pressure gradient are potential risks for tissue injuries essentially cavitation damage is a kind of pressure damage to fish cavitation is a mass transfer phenomenon and is generally defined as the inception growth and subsequent collapse of micro bubbles or cavities due to very low local pressures or high pressure fluctuations in a liquid ji et al 2013 2014a the collapse of micro bubbles or cavities results in a great fluctuating pressure brujan et al 2008 used high speed photography with 200 million frames per second to study shock wave emission upon the collapse of a cavitation bubble and found shock pressure to be 1 3 0 3 gpa at a distance of 68 μm from the bubble wall they also estimated the peak pressure at the bubble wall to be about 8 gpa as shown in fig 3 the average minimum wall pressure in intensive cavitation operating conditions case 5 and in non cavitation operating conditions case 2 can reach 8 45 kpa and 19 49 kpa respectively though the difference between these two average minimum wall pressures was small the mortality and injury of fish in cavitation and in non cavitation operating conditions were different the cumulative mortalities in cavitation operating conditions were higher than those in non cavitation operating conditions at each time especially in intensive cavitation operating conditions cases 4 and 5 this is because more fish tissues are heavily damaged in cavitation operating conditions than in non cavitation operating conditions as shown in fig 5 disseminated hemorrhages in the liver and free bubbles in the gill filament were only found in case 5 in addition more damaged swim bladders in the dead fish were found in cavitation operating conditions than in non cavitation operating conditions and broken swim bladders were only found in cavitation operating conditions 4 1 damage to livers the disseminated hemorrhages indicated that blood vessels were broken a condition which can be dangerous or even fatal for fish when fish cross the cavitation regions the pressure in the fish decreases with the drop of local pressure in the jet fish pump a vapor cavity is generated when pressure drops to the saturation vapor pressure of fish body fluid e g blood even though the fish were exposed to the cavitation region for a limited time the bubbles generated in the blood most likely still formed emboli to block the flow of the blood in the capillaries and even leading to the bursting of these blood vessels the blood then flows out of the capillaries and is distributed on the surface of the tissue moreover serum alt and ast activities of the treatment group were significantly higher than those of the control group in intensive cavitation operating conditions case 5 yet those in the non cavitation case 1 and slight cavitation case 3 operating conditions did not show this significance due to the annular nozzle of the jet fish pump the fish rarely touched cavity clouds in case 3 however they were entirely enfolded by cavity clouds in case 5 when fish crossed cavity clouds so bubbles were hardly generated in the blood in case 3 therefore only intensive cavitation in the jet fish pump results in liver damage to fish 4 2 damage in gills free bubbles in the gill filament are an essential symptom of gas bubble disease don et al 2003 which has a high mortality rate and is difficult to control by means of the microscope several free bubbles were found in the gill filaments a displacement δ of a bubble is seen in fig 5 b this bubble became smaller and even disappeared which indicates that the gas in the bubble dissolved this gas is usually dissolved in the water or in the body fluids of fish however gas is released when fish cross a low pressure region the gas is dissolved again when environmental pressure rises in addition it is difficult for fish to obtain oxygen in water when fish cross the cavitation region because a mass of gas is released from the water causing fish to be surrounded by gas and cavity bubbles the significantly high serum ldh activity shows that the cavity clouds affected fish respiration and that they shifted from aerobic to anaerobic respiration in case 5 as shown in fig 8 even though bubbles may also have been released in cases 1 and 3 the number and size of bubbles in case 5 were the greatest and lasted for a longer time thus it can be concluded that intensive cavitation affects fish respiration and even most likely results in gas bubble disease 4 3 damage to swim bladders when a swim bladder is badly damaged the fish would lose the ability to balance and would not live for long taoka et al 2010 compared with the proportion of other tissue injuries damage to swim bladders accounted for a sizeable proportion of the dead fish which indicates that swim bladders were the most vulnerable organ for the dead fish in the experiment due to the special structure of the jet fish pump the fish in it would experience a decompression stage and then a recompression stage the swim bladder would inflate in the decompression stage because the external pressure surrounding the swim bladder suddenly decreases while its internal pressure changes more slowly due to this pressure difference the swim bladder would have to inflate and deform to reduce internal pressure and adapt to the external pressure in the recompression stage external pressure would rise sharply while internal pressure remains less resulting in the shrinkage of the swim bladder the degree of inflation and shrinkage is critical to the condition of the swim bladder the swim bladder would seem unchanged and healthy when the changing amplitude of it is small however the swim bladder would crumple when the degree of change is great enough finally the swim bladder would burst when this degree exceeds its limits of endurance the results of the pressure damage experiment show that swim bladders in vitro became crumpled when the minimum pressure in the pressure vessel p e was below 58 kpa and that rupturing occurred when p e was below 56 kpa when p e reached 40 kpa all swim bladders were broken so the pressure between 40 kpa and 58 kpa is the transition area for pressure damage on swim bladders in vitro the average minimum wall pressure in all cases was less than 40 kpa but no damaged swim bladders were found in the control group and case 2 and only a few crumpled swim bladders were found in dead fish in case 1 due to the protection of organs and bones swim bladders in fresh fish can bear lower pressure than those in vitro however damage rates in cavitation operating conditions were significantly higher than those in non cavitation operating conditions based on the observations via high speed photography swim bladders were broken in the recompression process so the increase of pressure is an essential reason for this rupturing as mentioned above the collapse of cavity results in a huge pressure increase therefore in the jet fish pump cavitation is an important cause for the injury of swim bladders and its rate of occurrence increases when the cavitation becomes more intensive moreover judging from the significant serum cr content in cavitation operating conditions as shown in fig 8 cavitation poses a potential risk for the kidneys of fish the thrombus caused by the cavitation is a probable reason for damage to the kidneys 5 conclusions considering different cavitation stages in a jet fish pump the cavitation damage on tissue of carassius auratus was systematically studied and the pressure damage on swim bladders was also analyzed the following conclusions are obtained 1 the cumulative mortalities of fish in cavitation operating conditions were higher than those in non cavitation operating conditions at each sampling time the cumulative mortality in the stable cavitation condition reached 55 within 48 h after the experiment 2 two types of swim bladder damage crumpling and rupturing were found in 60 of the dead fish the damage rate of swim bladders rose with the increase of cavitation and broken swim bladders were found only in cavitation operating conditions 3 liver damage was found in those dead fish experiencing intensive cavitation operating conditions and significantly high serum alt and ast activity verified this damage free bubbles an essential symptom of the gas bubble disease were found in the gill filament of those fish experiencing intensive cavitation operating conditions the significantly high serum ldh activity indicated that fish experienced intense anaerobic respiration during intensive cavitation operating conditions judging from the significant serum cr content cavitation in the jet fish pump also posed a potential risk for the kidneys of fish 4 environmental pressure between 40 kpa and 58 kpa was a transition area for pressure damage to swim bladders in vitro swim bladders in vitro were safe when environmental pressure was above 58 kpa yet they were broken when environmental pressure was less than 40 kpa acknowledgements this work was financially supported by the national natural science foundation of china project nos 51179134 and no 11472197 and china postdoctoral science foundation project no 2018m642477 
22968,the hydrodynamic interactions between successive two dimensional 2d solitons and structures have been investigated based on velocity potential theory successive solitons are generated by a moving horizontal elliptic cylinder at critical speed in shallow water as a submerged cylinder or a rectangular floating barge encounters the solitons it drifts with the wave induced flow the interactions of solitons and structures are simulated using the mixed euler lagrangian method mel through a time stepping scheme the auxiliary functions are introduced to analyse the coupled motions the responses of structures have been analyzed and the velocity fields have been examined keywords successive solitons coupled motion drift motion boundary elements 1 introduction solitary waves or the so called solitons can be usually observed in restricted water zone it was firstly observed by scott russell as a canal boat stopped suddenly and the wave profile remained unchanged after it travelled a long distance similarly thews and landweber 1935 reported that a ship model in a towing tank caused such solitary wave they found that the resistance of the model became unstable in the coastal area of shallow water depth the solitons would impact on sea beach and they would cause erosion to the coastal line hamer 1999 li and sclavounos 2002 when solitons are coming it would be risky to handle cargos or conduct other operations ships or floating bodies may suffer from the attack of solitons it becomes necessary to understand the behavior of structures when incident solitary waves emerge a moving body or pressure patch will induce solitons when the travelling speed approaches the supercritical speed u g h 1 0 where u h and g are the velocity water depth and gravitational acceleration respectively wu and wu 1982 first simulated the generation of solitons through generalized boussinesq model a series of ship model experiments and theoretical studies about the generation of solitons have been carried out by huang et al 1982 ertekin et al 1984 simulated the 2d solitons through green naghdi s direct sheet model they reported that the predominant condition for the generation of solitons is the blockage coefficient which is defined as the ratio of the section area of the body over the section area of the channel three dimensional 3d simulations of the solitons at trans critical speed were later performed by ertekin et al 1986 using green naghdi s theory following studies include wu 1987 by forced korteweg de vries fkdv equations pedersen 1988 by 3d boussinesq equations lee et al 1989 and li and sclavounos 2002 by the generalized boussinesq equations xu and meng 2016 by boundary integral method among them the generation of solitons at the vicinity of trans critical speed has been highlighted li and sclavounos 2002 chang and wang 2011 and xu and meng 2016 have further reported the steady solitons moving along with the body at hyper critical speed where the resistance of the body decrease significantly and become stable the fluid flow of a solitary wave moves towards its propagating direction and the velocity magnitude is analogue to its wave elevation duan et al 2018 the solitary waves would cause the damage of structures wu and hsiao 2013 chang et al 2018 wang et al 2018 investigated the interactions of solitary wave with submerged wave breaker or obstacle numerically and or experimentally the vortex flow on the back side near the sharp corner has been observed sun et al 2015 lu and wang 2015 zarruk et al 2015 studied the wave transmission and reflection on a fixed floating body extensively chen et al 2017 investigated the interaction of solitary wave with a group of eleven cylinders and the diffraction of waves has been simulated for free floating cylinder the solitary wave can induce large translational motions zhou et al 2016 comparing with the fixed body the amplitudes of the force decrease significantly when a train of solitons emerges in a channel the free floating body may suffer from the incident solitons its motion would be violent and risky for the operation present study concerned the 2d hydrodynamic interactions of a train of solitons with a submerged horizontal cylinder and a floating barge since the effects of viscosity are less significant the potential flow theory is introduced to describe the fluid flow the wave reflection on a wall the responses of a submerged cylinder and a floating barge to the successive solitons are simulated through the mixed euler lagrangian method mel the nonlinear free surface boundary conditions are satisfied when updating the free surface auxiliary functions which were proposed by wu and taylor 1996 2003 are introduced to decouple the motion of bodies it is found that the solitons result in large amplitude translational motion and the heave and roll motions of the barge are eased as its breath increases 2 formulations 2 1 governing equations we consider a train of 2d solitons caused by a submerged elliptic cylinder in shallow water the bottom is flat and the free surface is initially quiescent there will be solitons when the travelling speed u of the elliptic cylinder approaches critical speed g h as the solitons pass submerged or floating bodies their behavior in response to solitons can be modeled using the inviscid theory two right handed cartesian coordinate systems are defined the space fixed coordinate system xoz is located on the initial calm water surface with its x axis paralleling with the initial water surface and z axis pointing upwards the other is body fixed coordinate system o x z with its origin o locates at the gravity center of the body which is located initially at x 0 x 0 z 0 in the space fixed coordinate system and we have x c x 0 ξ subsequently here ξ ξ 1 ξ 2 is introduced to denote the translational displacements in x and z directions respectively and ξ 3 is used to illustrate the rotation of the body the relationships between the two coordinate systems can be written as 1 x z x 0 z 0 ξ 1 ξ 2 cos ξ 3 sin ξ 3 sin ξ 3 cos ξ 3 x z since the fluid is assumed incompressible and the flow is irrotational the velocity potential ϕ is introduced to describe the flow field in the fluid domain the continuity equation is written as 2 2 ϕ 2 ϕ x 2 2 ϕ z 2 0 the velocity of the structure a cylinder or a barge is denoted as u v ω where u and v are the horizontal and vertical velocity and ω is the angular velocity the non penetration condition on the body surface s 0 is written as 3 ϕ n u ω z n x v ω x n z where n n x n z is the inward normal vector and x x z x x c z z c the boundary conditions on the bottom s b and the far field control surface s c of the water zone satisfy 4 ϕ n 0 to trace the free surface the nonlinear free surface boundary conditions on s f are imposed in the framework of lagrangian the dynamic and kinematic free surface boundary conditions are written as 5 d ϕ d t 1 2 ϕ ϕ g z 6 d x d t ϕ x d z d t ϕ z 2 2 coupled motions of the barge and the hydrodynamic forces the motion of structures and the hydrodynamic forces are inter dependent from the newton s second law the motion can be written as 7 m b a f f e where m b m 0 0 0 m 0 0 0 i z z a a 1 a 2 a 3 f f 1 f 2 f 3 f e 0 m g 0 where m is the mass of the body i z z is the inertia moment a 1 a 2 a 3 u v ω is the accelerations and f 1 f 2 f 3 f x f z m is the hydrodynamic forces the hydrodynamic forces on the body surface can be calculated through the integration of pressure we have 8 f ρ s 0 ϕ t 1 2 ϕ ϕ g z n d s where ρ is the density of water to calculate the force moment on the structure the term ϕ t could be calculated through numerical differentiation against time however the finite difference scheme is usually less accurate and the accumulated error would lead to unstable results an insightful discussion on the solution of an ordinary differential equation ode like eq 7 has been discussed in section 4 4 of shao 2010 the solution can be found through iteration alternatively the decomposition method proposed by kring 1994 can circumvent the instability problem of ode kim et al 2008 also obtained stable motion of the structure by simply adding the added mass force at infinite frequency on both sides of eq 7 here we adopted the auxiliary functions method wu and eatock taylor 1996 2003 to find out the accelerations of the body directly since the two dimensional problems are concerned this approach would not lead to much computational efforts the auxiliary functions χ i i 1 2 3 are introduced they satisfy the laplace equation in the fluid domain the boundary value problems are formulated as 9 χ i 0 on free surface s f 10 χ i n n i on body surface s 0 11 χ i n 0 on s b and s c the accelerations of the body can be solved from the equations below 12 m i j c i j a i q i m g δ i 2 where 13 c i j ρ s 0 χ i n j d s 14 q i ρ s 0 u n x v n z ω z n x ω x n z χ i x ϕ x u ω z χ i z ϕ z v ω x χ i ω v n x u n z d s ρ s 0 s f χ i n 1 2 ϕ ϕ g z d s where m i j c i j is the mass matrixes without calculating the pressure and the hydrodynamic forces the accelerations of the body can be obtained directly when the velocity potential is solved by using these auxiliary functions the nonlinear fluid structure interaction is decoupled 2 3 the boundary integral equation and velocity field the boundary element method is an efficient tool to solve the wave body interaction problems ning et al 2017 huang et al 2016 to solve the boundary value problem bvp numerically we have green s boundary integral equation 15 α p ϕ p s 0 s f s b s c ln r p q n q ϕ q ln r p q ϕ q n q d l q where α p is the solid angle at point p x z q ξ η is the point on the integral boundary and r p q x ξ 2 z η 2 the integral boundary is discretized into small elements the linear distribution of velocity potential and its normal derivative over each element are assumed the algebraic equations can be obtained when eq 15 is applied to each node of the elements the velocity fields can be obtained once the bvp is solved and we can calculate the velocity at any point in the flow field xu and xu 2017 xu et al 2017 16 2 π ϕ p x s 0 s f s b s c ϕ q s z η x ξ 2 z η 2 d s s 0 s f s b s c ϕ q n x ξ x ξ 2 z η 2 d s 17 2 π ϕ p z s 0 s f s b s c ϕ q s x ξ x ξ 2 z η 2 d s s 0 s f s b s c ϕ q n z η x ξ 2 z η 2 d s the potential is assumed linear distributed on the boundary the term ϕ q s and ϕ q n can be treated as constants and can be moved out of the integration 3 results and discussions 3 1 validation and verification 3 1 1 wave propagation of single solitary wave the numerical code is firstly validated by the propagation of single solitary wave the wave profile should remain the same as the initial wave profile as it propagates in the work of zhao et al 2014 the trailing waves developed when the initial free surface conditions are prescribed with the linear soliton this shall be due to the inconsistence of the initial linear free surface and the nonlinear numerical scheme zhou et al 2016 here the initial solution of soliton is obtained from the fully nonlinear theory developed by clamond and dutykh 2013 we consider a single solitary wave with wave amplitude a h 0 3 where the water depth h 2 0 m its peak locates at x 0 when t 0 the left and right control surfaces s c are treated as a rigid wall and the non penetration boundary condition ϕ n 0 is satisfied the simulations with various element sizes δ l and non dimensional time step intervals δ τ δ t g h are carried out the single solitary wave propagates forward and the wave profile remains the same after travelling a distance s 100 m fig 1 a shows that the wave profiles agree well with each other when the element sizes δ l 0 12 0 24 0 36 are used as shown in fig 1 b no visible discrepancy can be seen when time step intervals δ τ 0 01 0 02 0 04 are adopted the numerical results suggest that the numerical results are converged 3 1 2 running up of single solitary wave on a vertical wall the reflection of single solitary wave on a vertical wall has been further simulated it is the benchmark in the study of soliton body interactions the wall is placed at x 0 and the solitary wave propagates from left hand side again the initial incident wave profiles are obtained from the fully nonlinear theory by clamond and dutykh 2013 the reflections of solitary waves with various wave heights on the wall have been simulated fig 2 a shows the maximum wave elevations against the wave heights they agree well with the results of zhou et al 2016 cooker et al 1997 and chambarel et al 2009 the maximum free surface elevation is twice higher than the original wave crest when a h 0 4 the instantaneous wave profile of the highest wave elevation is shown in fig 2 b the wave elevation rises and the kinetic energy transforms into the potential energy the data in fig 2 indicates that present time stepping scheme can give accurate numerical results 3 2 interactions of structures and a train of solitons a train of solitons is generated by a horizontal elliptic cylinder moving forward at supercritical speed u g h where the water depth h 2 0 m the cylinder s long radius a h 0 5 and short radius b h 0 05 the distance of the center of elliptic cylinder to the quiescent water surface is h h 0 5 the travelling distance is defined as s the boundary condition on the surface of elliptic cylinder s 0 is given by 18 ϕ n u n x the wave generated by the elliptic cylinder at s a 600 is shown in fig 3 the induced solitons are in front of the elliptic cylinder followed by a depressed water zone and regular gravity waves four solitons are truncated from the front crests smoothing has been applied at the trough of the fourth soliton when it links a flat water surface these solitons will be used as the incident wave in the study of wave body interactions 3 2 1 the reflection of solitons against a vertical wall the reflection of solitons against a vertical wall is firstly simulated as shown in fig 4 the solitons propagate towards a vertical wall typical wave profiles have been shown in fig 5 as the first solitary wave meets the wall the free surface rises up when the peak is achieved the wave elevation is twice higher than the original wave height at τ 11 02 then the highest wave crest falls due to gravity and merges into the coming second solitary wave a new large wave crest is found at τ 16 83 again this large wave crest falls and divides into two solitons moving in opposite directions the solitons further merge with up coming solitons on the left and form large wave crests there are two large wave crests at τ 27 63 each of these large crests splits into two smaller solitons the left soliton propagates away from the wall and the right soliton runs up the wall the two solitons in the middle further merge into a large wave crest at τ 32 61 after four reflections on the wall the solitons propagate away from the wall the reflected wave profile remains similar with the original solitons the reflection processes appear as the run up reflection and fusion of waves the typical velocity fields during wave reflection have been shown in fig 6 as the solitons run up the wall the velocity of the fluid decreases and the kinetic energy of the fluid converts into potential energy when the wave crest reaches its highest position the velocity declines to a negligible value as shown in fig 6 b then the wave crest falls and forms a soliton propagating in the opposite direction this solitary wave merges into upcoming soliton and then forms a large wave crest the free surface continues to rise as the velocity of the fluid particles decreases the kinetic energy is transformed into potential energy the merging of solitons and the splitting of large wave crest are essentially the results of conversion between kinetic energy and potential energy the reflections of solitons on the wall and the transmission of waves represent the law of energy conservation and dynamic balance between kinetic energy and potential energy 3 2 2 the interactions of solitons with a submerged cylinder the interactions of successive solitons with a 2d submerged circular cylinder are considered as shown in fig 7 the radius of the cylinder r h 0 25 and the initial submergence referring to gravity center h h 0 6 the truncated solitons in fig 3 are adopted as the incident wave the initial longitudinal distance s 0 h measuring from the center of the cylinder to the first wave crest is 39 1 to verify the coupled numerical procedure the convergence studies against element size and time step interval are performed the element sizes δ l 0 2 0 3 0 4 are used on the free surface and the non dimensional time step interval δ τ 0 01 0 02 0 04 are used the time histories of acceleration of the cylinder are shown in fig 8 we can see that the results are converged with various element sizes and time step intervals in the following simulations δ l 0 3 and δ τ 0 02 are used as the solitons propagate towards the cylinder the cylinder oscillates as the solitons pass the motions of the cylinder have been presented in fig 9 the horizontal and vertical accelerations of the cylinder experience four oscillations and the acceleration resembles the acceleration of the local flow specifically we compare the motion induced by a single solitary wave of same wave height the curve of horizontal acceleration induced by a single soliton is anti symmetrical while the vertical acceleration is symmetrical as shown in the figure the train of solitons results successive oscillations which resemble those by single soliton the acceleration velocity and the displacement of the cylinder behave in the same manner as a soliton passes the horizontal velocity is always positive and the horizontal displacement ξ 1 increases as the solitons pass the curve of vertical displacement ξ 2 is similar to the wave profile but with some increments after each soliton passes this could be due to the effects of nonlinear free surface and the bottom a minor suction force results the rise of the cylinder after the solitons pass the cylinder the horizontal velocity declines and eventually becomes zero the cylinder has been moved forward a distance much larger than the diameter of the cylinder the typical velocity fields have been shown in fig 10 the scale of the horizontal axis to vertical axis is 5 the horizontal velocity components of fluid particles are proportional to the wave height and the vertical velocity components are bounded by the bottom the cylinder has no significant disturbance to the velocity fields it drifts with the flow induced by the solitons the variation of the velocity is consistent with the local flow 3 2 3 the interactions of solitons and a free floating barge the interaction of solitons and a floating barge as shown in fig 11 is concerned the breath and draft are denoted as b and d respectively various breaths b d 2 6 10 and 15 are considered the initial center of gravity is located at 0 0 4 d the mass and inertia moment of the barges are calculated as follow 19 m ρ b d 20 i z z 1 4 m b 2 when the solitons approach the barge the floating barge would experience large translational motion when update the free surface the elements on the free surface would be stretched or reduced significantly a re mesh scheme is adopted when the element is larger than 1 5δx δx is the size of a basic element the element is split into two equal elements when the element is smaller than 0 4δx it merges into its neighboring element to avoid the saw teeth behavior of the free surface a five points smooth scheme has been applied every 4 time steps maruo and song 1994 the motions of barges are shown in fig 12 it is observed that the amplitudes of horizontal acceleration decrease significantly as the increase of breath since the mass of the barge is proportional to the breath the variation of acceleration has been delayed when breath increases the horizontal accelerations with b d 2 and 6 have four oscillations corresponding to the passage of the four solitons however the horizontal accelerations with b d 10 and 15 have two oscillations as each soliton passes we note that the length between the neighboring crests of solitons is around 24 5 as one soliton is leaving the barge the next soliton interacts with the barge and therefore results the second oscillation the horizontal velocity experiences large amplitude fluctuations when b d is smaller its amplitude decreases significantly as b d increases as shown in fig 12 b however the magnitude of the average horizontal velocity is similar as a result the horizontal displacements are close when different breaths are considered the curve of horizontal displacement with smaller breath is an oblique waving line it becomes a straight line as the breath increases as shown in fig 12 c fig 12 d gives the vertical accelerations of the barges these curves of vertical acceleration have four major oscillations and the fluctuating amplitude decreases significantly as the breath increases similar to that of the submerged cylinder the vertical acceleration and velocity have a second oscillation in response to each soliton when b d 2 it suggests that the barge oscillates in the same manner of solitons the vertical displacements of these barges resemble the wave elevation and the motion amplitude decreases as b d increases we further present the rotational angle of the barge in fig 13 due to the wave radiation the roll motion has been damped out in the perspective of stability the metacentric radius of the barge r b 2 12 d lewis 1988 this suggests that the restoring moment of roll motion increases in the manner of the square of the breath the roll motion of the barge decreases significantly as breath increases after the solitons pass the rotational motion declines quickly except the barge with b d 2 the curves indicate that a barge with smaller b d has smaller wave damping coefficient due to wave radiation we note that present numerical theory ignores the viscosity and the vortex shedding at the edges of the barge the roll motion would be reduced when the damping of the vortex flow is included fig 14 shows the velocity fields when the solitons pass the barge with b d 6 as the first soliton approaches the barge the local flow velocity below the barge increases due to the narrow gap between the barge and bottom the fluid is partially blocked by the barge and forms reflecting wave as shown in fig 14 b and c after the first soliton passes the barge the barge drifts with the flow its vertical velocity drops and induces a back flow this behaves as the wave radiation following this the second soliton approaches and the barge experiences the second oscillation as can be seen in fig 14 d after these four solitons pass the barge the wave profiles at τ 66 44 are shown in fig 15 the amplitudes of the reflecting waves increase significantly as the breath increases the wave profile becomes irregular as the breath increases it is the superposition of reflecting waves and radiating waves 4 conclusions the interactions of a train of 2d solitons with structures in shallow water have been investigated based on the velocity potential theory the solitons are generated by a moving horizontal elliptic cylinder at super critical speed the wave reflection on a wall interactions with a submerged cylinder and floating barges have been simulated based on a time stepping scheme through boundary element method when the solitons encounter a vertical wall the wave run up the wall and propagate in opposite direction after reflection the reflected solitons merge with the upcoming solitons large wave crest can be seen as the kinetic energy is transformed into potential energy it further splits into two solitons the two solitons continue to run up the wall or merge with the upcoming solitons after four reflections the solitons propagate away from the wall and the wave profile remains similar with origin solitons the process of the reflection is the results of the balance between kinetic energy and potential energy we further study the motions of a submerged cylinder the cylinder experiences oscillations resemble the motion of the solitons the acceleration velocity and displacement represent the motion of local fluid particles although a suction effect has been observed the responses of free floating barges to a train of solitons are simulated the behavior of the barge subjected to solitons is different from that in periodic wave the barge with small breath draft ratio experiences similar translational motion of a submerged cylinder the barge experience large amplitude drift motion as there is no restoring force the horizontal displacements with various b d are similar as the breath increases the heave motions become complex due to the balance of inertia force and the restoring force the heave and roll motion amplitude decreases and the reflections of wave become significant the viscosity of the flow has been ignored the roll motion could be reduced when the vortex shedding at the edges of the barge is included this is beyond the scope of present study and requires further investigations acknowledgement the authors gratefully acknowledge the financial support from the national science foundation of china 51490671 11602067 51479044 51679043 the first author would like to express the support of the fundamental research fund for central universities heucf18018 hosted by harbin engineering university 
22968,the hydrodynamic interactions between successive two dimensional 2d solitons and structures have been investigated based on velocity potential theory successive solitons are generated by a moving horizontal elliptic cylinder at critical speed in shallow water as a submerged cylinder or a rectangular floating barge encounters the solitons it drifts with the wave induced flow the interactions of solitons and structures are simulated using the mixed euler lagrangian method mel through a time stepping scheme the auxiliary functions are introduced to analyse the coupled motions the responses of structures have been analyzed and the velocity fields have been examined keywords successive solitons coupled motion drift motion boundary elements 1 introduction solitary waves or the so called solitons can be usually observed in restricted water zone it was firstly observed by scott russell as a canal boat stopped suddenly and the wave profile remained unchanged after it travelled a long distance similarly thews and landweber 1935 reported that a ship model in a towing tank caused such solitary wave they found that the resistance of the model became unstable in the coastal area of shallow water depth the solitons would impact on sea beach and they would cause erosion to the coastal line hamer 1999 li and sclavounos 2002 when solitons are coming it would be risky to handle cargos or conduct other operations ships or floating bodies may suffer from the attack of solitons it becomes necessary to understand the behavior of structures when incident solitary waves emerge a moving body or pressure patch will induce solitons when the travelling speed approaches the supercritical speed u g h 1 0 where u h and g are the velocity water depth and gravitational acceleration respectively wu and wu 1982 first simulated the generation of solitons through generalized boussinesq model a series of ship model experiments and theoretical studies about the generation of solitons have been carried out by huang et al 1982 ertekin et al 1984 simulated the 2d solitons through green naghdi s direct sheet model they reported that the predominant condition for the generation of solitons is the blockage coefficient which is defined as the ratio of the section area of the body over the section area of the channel three dimensional 3d simulations of the solitons at trans critical speed were later performed by ertekin et al 1986 using green naghdi s theory following studies include wu 1987 by forced korteweg de vries fkdv equations pedersen 1988 by 3d boussinesq equations lee et al 1989 and li and sclavounos 2002 by the generalized boussinesq equations xu and meng 2016 by boundary integral method among them the generation of solitons at the vicinity of trans critical speed has been highlighted li and sclavounos 2002 chang and wang 2011 and xu and meng 2016 have further reported the steady solitons moving along with the body at hyper critical speed where the resistance of the body decrease significantly and become stable the fluid flow of a solitary wave moves towards its propagating direction and the velocity magnitude is analogue to its wave elevation duan et al 2018 the solitary waves would cause the damage of structures wu and hsiao 2013 chang et al 2018 wang et al 2018 investigated the interactions of solitary wave with submerged wave breaker or obstacle numerically and or experimentally the vortex flow on the back side near the sharp corner has been observed sun et al 2015 lu and wang 2015 zarruk et al 2015 studied the wave transmission and reflection on a fixed floating body extensively chen et al 2017 investigated the interaction of solitary wave with a group of eleven cylinders and the diffraction of waves has been simulated for free floating cylinder the solitary wave can induce large translational motions zhou et al 2016 comparing with the fixed body the amplitudes of the force decrease significantly when a train of solitons emerges in a channel the free floating body may suffer from the incident solitons its motion would be violent and risky for the operation present study concerned the 2d hydrodynamic interactions of a train of solitons with a submerged horizontal cylinder and a floating barge since the effects of viscosity are less significant the potential flow theory is introduced to describe the fluid flow the wave reflection on a wall the responses of a submerged cylinder and a floating barge to the successive solitons are simulated through the mixed euler lagrangian method mel the nonlinear free surface boundary conditions are satisfied when updating the free surface auxiliary functions which were proposed by wu and taylor 1996 2003 are introduced to decouple the motion of bodies it is found that the solitons result in large amplitude translational motion and the heave and roll motions of the barge are eased as its breath increases 2 formulations 2 1 governing equations we consider a train of 2d solitons caused by a submerged elliptic cylinder in shallow water the bottom is flat and the free surface is initially quiescent there will be solitons when the travelling speed u of the elliptic cylinder approaches critical speed g h as the solitons pass submerged or floating bodies their behavior in response to solitons can be modeled using the inviscid theory two right handed cartesian coordinate systems are defined the space fixed coordinate system xoz is located on the initial calm water surface with its x axis paralleling with the initial water surface and z axis pointing upwards the other is body fixed coordinate system o x z with its origin o locates at the gravity center of the body which is located initially at x 0 x 0 z 0 in the space fixed coordinate system and we have x c x 0 ξ subsequently here ξ ξ 1 ξ 2 is introduced to denote the translational displacements in x and z directions respectively and ξ 3 is used to illustrate the rotation of the body the relationships between the two coordinate systems can be written as 1 x z x 0 z 0 ξ 1 ξ 2 cos ξ 3 sin ξ 3 sin ξ 3 cos ξ 3 x z since the fluid is assumed incompressible and the flow is irrotational the velocity potential ϕ is introduced to describe the flow field in the fluid domain the continuity equation is written as 2 2 ϕ 2 ϕ x 2 2 ϕ z 2 0 the velocity of the structure a cylinder or a barge is denoted as u v ω where u and v are the horizontal and vertical velocity and ω is the angular velocity the non penetration condition on the body surface s 0 is written as 3 ϕ n u ω z n x v ω x n z where n n x n z is the inward normal vector and x x z x x c z z c the boundary conditions on the bottom s b and the far field control surface s c of the water zone satisfy 4 ϕ n 0 to trace the free surface the nonlinear free surface boundary conditions on s f are imposed in the framework of lagrangian the dynamic and kinematic free surface boundary conditions are written as 5 d ϕ d t 1 2 ϕ ϕ g z 6 d x d t ϕ x d z d t ϕ z 2 2 coupled motions of the barge and the hydrodynamic forces the motion of structures and the hydrodynamic forces are inter dependent from the newton s second law the motion can be written as 7 m b a f f e where m b m 0 0 0 m 0 0 0 i z z a a 1 a 2 a 3 f f 1 f 2 f 3 f e 0 m g 0 where m is the mass of the body i z z is the inertia moment a 1 a 2 a 3 u v ω is the accelerations and f 1 f 2 f 3 f x f z m is the hydrodynamic forces the hydrodynamic forces on the body surface can be calculated through the integration of pressure we have 8 f ρ s 0 ϕ t 1 2 ϕ ϕ g z n d s where ρ is the density of water to calculate the force moment on the structure the term ϕ t could be calculated through numerical differentiation against time however the finite difference scheme is usually less accurate and the accumulated error would lead to unstable results an insightful discussion on the solution of an ordinary differential equation ode like eq 7 has been discussed in section 4 4 of shao 2010 the solution can be found through iteration alternatively the decomposition method proposed by kring 1994 can circumvent the instability problem of ode kim et al 2008 also obtained stable motion of the structure by simply adding the added mass force at infinite frequency on both sides of eq 7 here we adopted the auxiliary functions method wu and eatock taylor 1996 2003 to find out the accelerations of the body directly since the two dimensional problems are concerned this approach would not lead to much computational efforts the auxiliary functions χ i i 1 2 3 are introduced they satisfy the laplace equation in the fluid domain the boundary value problems are formulated as 9 χ i 0 on free surface s f 10 χ i n n i on body surface s 0 11 χ i n 0 on s b and s c the accelerations of the body can be solved from the equations below 12 m i j c i j a i q i m g δ i 2 where 13 c i j ρ s 0 χ i n j d s 14 q i ρ s 0 u n x v n z ω z n x ω x n z χ i x ϕ x u ω z χ i z ϕ z v ω x χ i ω v n x u n z d s ρ s 0 s f χ i n 1 2 ϕ ϕ g z d s where m i j c i j is the mass matrixes without calculating the pressure and the hydrodynamic forces the accelerations of the body can be obtained directly when the velocity potential is solved by using these auxiliary functions the nonlinear fluid structure interaction is decoupled 2 3 the boundary integral equation and velocity field the boundary element method is an efficient tool to solve the wave body interaction problems ning et al 2017 huang et al 2016 to solve the boundary value problem bvp numerically we have green s boundary integral equation 15 α p ϕ p s 0 s f s b s c ln r p q n q ϕ q ln r p q ϕ q n q d l q where α p is the solid angle at point p x z q ξ η is the point on the integral boundary and r p q x ξ 2 z η 2 the integral boundary is discretized into small elements the linear distribution of velocity potential and its normal derivative over each element are assumed the algebraic equations can be obtained when eq 15 is applied to each node of the elements the velocity fields can be obtained once the bvp is solved and we can calculate the velocity at any point in the flow field xu and xu 2017 xu et al 2017 16 2 π ϕ p x s 0 s f s b s c ϕ q s z η x ξ 2 z η 2 d s s 0 s f s b s c ϕ q n x ξ x ξ 2 z η 2 d s 17 2 π ϕ p z s 0 s f s b s c ϕ q s x ξ x ξ 2 z η 2 d s s 0 s f s b s c ϕ q n z η x ξ 2 z η 2 d s the potential is assumed linear distributed on the boundary the term ϕ q s and ϕ q n can be treated as constants and can be moved out of the integration 3 results and discussions 3 1 validation and verification 3 1 1 wave propagation of single solitary wave the numerical code is firstly validated by the propagation of single solitary wave the wave profile should remain the same as the initial wave profile as it propagates in the work of zhao et al 2014 the trailing waves developed when the initial free surface conditions are prescribed with the linear soliton this shall be due to the inconsistence of the initial linear free surface and the nonlinear numerical scheme zhou et al 2016 here the initial solution of soliton is obtained from the fully nonlinear theory developed by clamond and dutykh 2013 we consider a single solitary wave with wave amplitude a h 0 3 where the water depth h 2 0 m its peak locates at x 0 when t 0 the left and right control surfaces s c are treated as a rigid wall and the non penetration boundary condition ϕ n 0 is satisfied the simulations with various element sizes δ l and non dimensional time step intervals δ τ δ t g h are carried out the single solitary wave propagates forward and the wave profile remains the same after travelling a distance s 100 m fig 1 a shows that the wave profiles agree well with each other when the element sizes δ l 0 12 0 24 0 36 are used as shown in fig 1 b no visible discrepancy can be seen when time step intervals δ τ 0 01 0 02 0 04 are adopted the numerical results suggest that the numerical results are converged 3 1 2 running up of single solitary wave on a vertical wall the reflection of single solitary wave on a vertical wall has been further simulated it is the benchmark in the study of soliton body interactions the wall is placed at x 0 and the solitary wave propagates from left hand side again the initial incident wave profiles are obtained from the fully nonlinear theory by clamond and dutykh 2013 the reflections of solitary waves with various wave heights on the wall have been simulated fig 2 a shows the maximum wave elevations against the wave heights they agree well with the results of zhou et al 2016 cooker et al 1997 and chambarel et al 2009 the maximum free surface elevation is twice higher than the original wave crest when a h 0 4 the instantaneous wave profile of the highest wave elevation is shown in fig 2 b the wave elevation rises and the kinetic energy transforms into the potential energy the data in fig 2 indicates that present time stepping scheme can give accurate numerical results 3 2 interactions of structures and a train of solitons a train of solitons is generated by a horizontal elliptic cylinder moving forward at supercritical speed u g h where the water depth h 2 0 m the cylinder s long radius a h 0 5 and short radius b h 0 05 the distance of the center of elliptic cylinder to the quiescent water surface is h h 0 5 the travelling distance is defined as s the boundary condition on the surface of elliptic cylinder s 0 is given by 18 ϕ n u n x the wave generated by the elliptic cylinder at s a 600 is shown in fig 3 the induced solitons are in front of the elliptic cylinder followed by a depressed water zone and regular gravity waves four solitons are truncated from the front crests smoothing has been applied at the trough of the fourth soliton when it links a flat water surface these solitons will be used as the incident wave in the study of wave body interactions 3 2 1 the reflection of solitons against a vertical wall the reflection of solitons against a vertical wall is firstly simulated as shown in fig 4 the solitons propagate towards a vertical wall typical wave profiles have been shown in fig 5 as the first solitary wave meets the wall the free surface rises up when the peak is achieved the wave elevation is twice higher than the original wave height at τ 11 02 then the highest wave crest falls due to gravity and merges into the coming second solitary wave a new large wave crest is found at τ 16 83 again this large wave crest falls and divides into two solitons moving in opposite directions the solitons further merge with up coming solitons on the left and form large wave crests there are two large wave crests at τ 27 63 each of these large crests splits into two smaller solitons the left soliton propagates away from the wall and the right soliton runs up the wall the two solitons in the middle further merge into a large wave crest at τ 32 61 after four reflections on the wall the solitons propagate away from the wall the reflected wave profile remains similar with the original solitons the reflection processes appear as the run up reflection and fusion of waves the typical velocity fields during wave reflection have been shown in fig 6 as the solitons run up the wall the velocity of the fluid decreases and the kinetic energy of the fluid converts into potential energy when the wave crest reaches its highest position the velocity declines to a negligible value as shown in fig 6 b then the wave crest falls and forms a soliton propagating in the opposite direction this solitary wave merges into upcoming soliton and then forms a large wave crest the free surface continues to rise as the velocity of the fluid particles decreases the kinetic energy is transformed into potential energy the merging of solitons and the splitting of large wave crest are essentially the results of conversion between kinetic energy and potential energy the reflections of solitons on the wall and the transmission of waves represent the law of energy conservation and dynamic balance between kinetic energy and potential energy 3 2 2 the interactions of solitons with a submerged cylinder the interactions of successive solitons with a 2d submerged circular cylinder are considered as shown in fig 7 the radius of the cylinder r h 0 25 and the initial submergence referring to gravity center h h 0 6 the truncated solitons in fig 3 are adopted as the incident wave the initial longitudinal distance s 0 h measuring from the center of the cylinder to the first wave crest is 39 1 to verify the coupled numerical procedure the convergence studies against element size and time step interval are performed the element sizes δ l 0 2 0 3 0 4 are used on the free surface and the non dimensional time step interval δ τ 0 01 0 02 0 04 are used the time histories of acceleration of the cylinder are shown in fig 8 we can see that the results are converged with various element sizes and time step intervals in the following simulations δ l 0 3 and δ τ 0 02 are used as the solitons propagate towards the cylinder the cylinder oscillates as the solitons pass the motions of the cylinder have been presented in fig 9 the horizontal and vertical accelerations of the cylinder experience four oscillations and the acceleration resembles the acceleration of the local flow specifically we compare the motion induced by a single solitary wave of same wave height the curve of horizontal acceleration induced by a single soliton is anti symmetrical while the vertical acceleration is symmetrical as shown in the figure the train of solitons results successive oscillations which resemble those by single soliton the acceleration velocity and the displacement of the cylinder behave in the same manner as a soliton passes the horizontal velocity is always positive and the horizontal displacement ξ 1 increases as the solitons pass the curve of vertical displacement ξ 2 is similar to the wave profile but with some increments after each soliton passes this could be due to the effects of nonlinear free surface and the bottom a minor suction force results the rise of the cylinder after the solitons pass the cylinder the horizontal velocity declines and eventually becomes zero the cylinder has been moved forward a distance much larger than the diameter of the cylinder the typical velocity fields have been shown in fig 10 the scale of the horizontal axis to vertical axis is 5 the horizontal velocity components of fluid particles are proportional to the wave height and the vertical velocity components are bounded by the bottom the cylinder has no significant disturbance to the velocity fields it drifts with the flow induced by the solitons the variation of the velocity is consistent with the local flow 3 2 3 the interactions of solitons and a free floating barge the interaction of solitons and a floating barge as shown in fig 11 is concerned the breath and draft are denoted as b and d respectively various breaths b d 2 6 10 and 15 are considered the initial center of gravity is located at 0 0 4 d the mass and inertia moment of the barges are calculated as follow 19 m ρ b d 20 i z z 1 4 m b 2 when the solitons approach the barge the floating barge would experience large translational motion when update the free surface the elements on the free surface would be stretched or reduced significantly a re mesh scheme is adopted when the element is larger than 1 5δx δx is the size of a basic element the element is split into two equal elements when the element is smaller than 0 4δx it merges into its neighboring element to avoid the saw teeth behavior of the free surface a five points smooth scheme has been applied every 4 time steps maruo and song 1994 the motions of barges are shown in fig 12 it is observed that the amplitudes of horizontal acceleration decrease significantly as the increase of breath since the mass of the barge is proportional to the breath the variation of acceleration has been delayed when breath increases the horizontal accelerations with b d 2 and 6 have four oscillations corresponding to the passage of the four solitons however the horizontal accelerations with b d 10 and 15 have two oscillations as each soliton passes we note that the length between the neighboring crests of solitons is around 24 5 as one soliton is leaving the barge the next soliton interacts with the barge and therefore results the second oscillation the horizontal velocity experiences large amplitude fluctuations when b d is smaller its amplitude decreases significantly as b d increases as shown in fig 12 b however the magnitude of the average horizontal velocity is similar as a result the horizontal displacements are close when different breaths are considered the curve of horizontal displacement with smaller breath is an oblique waving line it becomes a straight line as the breath increases as shown in fig 12 c fig 12 d gives the vertical accelerations of the barges these curves of vertical acceleration have four major oscillations and the fluctuating amplitude decreases significantly as the breath increases similar to that of the submerged cylinder the vertical acceleration and velocity have a second oscillation in response to each soliton when b d 2 it suggests that the barge oscillates in the same manner of solitons the vertical displacements of these barges resemble the wave elevation and the motion amplitude decreases as b d increases we further present the rotational angle of the barge in fig 13 due to the wave radiation the roll motion has been damped out in the perspective of stability the metacentric radius of the barge r b 2 12 d lewis 1988 this suggests that the restoring moment of roll motion increases in the manner of the square of the breath the roll motion of the barge decreases significantly as breath increases after the solitons pass the rotational motion declines quickly except the barge with b d 2 the curves indicate that a barge with smaller b d has smaller wave damping coefficient due to wave radiation we note that present numerical theory ignores the viscosity and the vortex shedding at the edges of the barge the roll motion would be reduced when the damping of the vortex flow is included fig 14 shows the velocity fields when the solitons pass the barge with b d 6 as the first soliton approaches the barge the local flow velocity below the barge increases due to the narrow gap between the barge and bottom the fluid is partially blocked by the barge and forms reflecting wave as shown in fig 14 b and c after the first soliton passes the barge the barge drifts with the flow its vertical velocity drops and induces a back flow this behaves as the wave radiation following this the second soliton approaches and the barge experiences the second oscillation as can be seen in fig 14 d after these four solitons pass the barge the wave profiles at τ 66 44 are shown in fig 15 the amplitudes of the reflecting waves increase significantly as the breath increases the wave profile becomes irregular as the breath increases it is the superposition of reflecting waves and radiating waves 4 conclusions the interactions of a train of 2d solitons with structures in shallow water have been investigated based on the velocity potential theory the solitons are generated by a moving horizontal elliptic cylinder at super critical speed the wave reflection on a wall interactions with a submerged cylinder and floating barges have been simulated based on a time stepping scheme through boundary element method when the solitons encounter a vertical wall the wave run up the wall and propagate in opposite direction after reflection the reflected solitons merge with the upcoming solitons large wave crest can be seen as the kinetic energy is transformed into potential energy it further splits into two solitons the two solitons continue to run up the wall or merge with the upcoming solitons after four reflections the solitons propagate away from the wall and the wave profile remains similar with origin solitons the process of the reflection is the results of the balance between kinetic energy and potential energy we further study the motions of a submerged cylinder the cylinder experiences oscillations resemble the motion of the solitons the acceleration velocity and displacement represent the motion of local fluid particles although a suction effect has been observed the responses of free floating barges to a train of solitons are simulated the behavior of the barge subjected to solitons is different from that in periodic wave the barge with small breath draft ratio experiences similar translational motion of a submerged cylinder the barge experience large amplitude drift motion as there is no restoring force the horizontal displacements with various b d are similar as the breath increases the heave motions become complex due to the balance of inertia force and the restoring force the heave and roll motion amplitude decreases and the reflections of wave become significant the viscosity of the flow has been ignored the roll motion could be reduced when the vortex shedding at the edges of the barge is included this is beyond the scope of present study and requires further investigations acknowledgement the authors gratefully acknowledge the financial support from the national science foundation of china 51490671 11602067 51479044 51679043 the first author would like to express the support of the fundamental research fund for central universities heucf18018 hosted by harbin engineering university 
22969,one trend in ship development is low noise characteristics as one of the major noise sources of ship underwater radiated noise is the power equipment it is critical to predict the ship underwater radiated noise caused by power equipment during the design phase in this study the incentive spectrums of power plants were obtained by testing on an oil tanker ship and the hull vibration was calculated and measured in the middle and low frequency the results show that the calculation model satisfies the accuracy requirement to calculate the ship underwater radiated noise in the middle and low frequency the finite element and boundary element method fe bem finite element and infinite element method fe ifem and finite element and automatic matching layer fe aml were used respectively it is found that the fe bem is the preferred method for calculating ship underwater radiated noise in modeling scale and computational efficiency the calculation of hull vibration and underwater radiated noise in the high frequency were performed by using the statistical energy analysis sea full frequency underwater radiated noise prediction of the oil tanker was completed in the end the far field of ship underwater sound radiation was studied the far field can be determined when the sound radiation directivity of the ship no longer changes with distance keywords full frequency ship underwater radiated noise fe bem fe ifem fe aml sea far field criterion 1 introduction during the voyage of a ship its main power plants will cause vibration of the hull which can induce the movement of the surrounding fluid to generate underwater acoustic radiation that may further cause adverse effects on marine organisms and damage the marine ecological balance nowacek d p et al 2007 williams r et al 2015 farcas a et al 2015 in the past years the subject of ship noise emission has been identified and the eu has funded the fp7 silenv ship innovative solutions to reduce noise and vibrations project that runs from 2010 to 2012 borelli d et al 2016 in addition for military ships the most important indicator to measure the ship acoustic stealth performance is the ship underwater radiated noise level the navies of various countries are currently vigorously developing sonar detection technology which in turn has led to the acoustic stealth performance requirements of naval ships have become more stringent the underwater noise forecast during the design stage can grasp the ship noise level in advance and provide the basis for the subsequent vibration and noise reduction design the ship underwater noise sources usually have three types mechanical noise propeller noise and hydrodynamic noise among which the mechanical noise and propeller noise are the most important there are various studies have investigated the ship underwater radiated noise caused by the propeller gaggero s et al 2016 dealt with the side effects of propellers cavitation i e pressure pulses and radiated noise they presented a survey of a specific test case represented by a single screw research vessel in the framework of the project aquo achieve quieter oceans by shipping noise footprint reduction which was analyzed with three different strategies numerical calculations model scale investigations and full scale measurements seol h et al 2005 used a time domain acoustic analogy to calculate underwater propeller noise the potential based panel method was used to analyze the flow field and then the pressure and other data in the time domain was substituted into the ffowcs williams and hawkings fwh equation to calculate the ship underwater far field radiated noise kellett p et al 2013 and özden m c et al 2016 adopted cfd software and ffowcs williams and hawkings fwh equation to calculate ship underwater radiated noise generated by propeller under different flow conditions and discussed the improvement of the calculation method lidtke a k et al 2016 further studied the modeling methods of propeller and cavitation model and the cavitation induced noise was calculated by large eddy simulation and fwh acoustic analogy the calculation of propeller radiated noise has been relatively mature this study mainly focuses on the ship underwater radiated noise caused by the power plants however not only the structure of a ship is complicated but also the excitation is complex in addition only the numerical method is available for solving its vibration and radiated noise there are various numerical methods for calculating underwater vibration and radiated noise of complex structure such as finite element method fem boundary element method bem wave superposition method wsm infinite element method ifem automatic matching layer aml statistical energy analysis sea and finite element statistical energy analysis hybrid method fe sea xiang y 2017 wu s w 2018 zhou m s et al 2017 tang z y 2011 and peng x 2003 applied fe bem to calculate the ship underwater radiated noise in the middle and low frequency and obtained good results qiu z h liu s et al 2013 used the ifem to calculate the low frequency underwater radiated noise of the ship and studied the influence of damping on the underwater radiated noise in high frequency region structures usually exhibit short wave and high modality characteristics in order to calculate the structure high frequency acoustic and vibration response statistical energy analysis sea was proposed yao d y et al 1995 morrow c t 2013 liu k et al 2010 and li x m et al 2013 used sea to predict the ship underwater radiated noise and the results showed that the sea can be well applied to the calculation of high frequency vibration and radiated noise of ship however there are still deficiencies in the prediction of ship underwater radiated noise caused by power plants ① in the middle and low frequency region fe bem or fe ifem has been used to calculate the ship underwater radiated noise it is rare to use different methods to calculate the ship underwater radiated noise and compare the calculation methods differences ② there are few comparisons between the hull vibration measured values and simulation values ③ there is less research on the far field criteria of ship underwater acoustic radiation in this study an oil tanker was used to study the full frequency underwater radiated noise by different numerical methods and the method for judging ship acoustic radiation far field was developed the flow diagram of this study is shown in fig 1 2 middle and low frequency underwater radiated noise prediction of an oil tanker 2 1 frequency band division to calculate ship underwater radiated noise different methods should be used for different analysis frequency bands therefore dividing the frequency interval reasonably is important in calculating the ship underwater radiated noise within the full frequency the modal number n has often been used to divide the frequency band yao d y et al 1995 which can be calculated by 1 n n ω δ f where n ω is the structure modal density and δ f is the frequency bandwidth the modal density is an important parameter to measure the storage capacity of subsystem vibration energy according to the statistical energy theory when the modal density of the substructure is larger the modality of the substructure within the bandwidth is more dense and the calculation result has statistical significance the modal density of one dimensional beam structure can be got by 2 n ω 1 ω 1 2 ρ a e i 1 4 where ω is the frequency a is the cross sectional area of the beam structure ρ is the mass density e i is the structural bending stiffness the modal density of two dimensional flat structure can be got by 3 n ω 3 a h c l where h and a are the thickness and area of plate structure respectively c l is the structure bending wave velocity in engineering the low middle and high frequency regions are divided by n 1 1 n 5 and n 5 respectively yao d y et al 1995 the modal number n is calculated according to the narrowband spectrum and then the integral operation is performed according to the upper and lower limits of the octave the 1 3 octave is chosen to calculate the oil tanker substructures modal number n to reduce the calculation scale but this does not affect the division result of the frequency band the modal number n of the hull structures were calculated based on equation 1 3 and plotted in fig 2 according to the modal numbers of the different hull structure subsystems in fig 2 the low middle and high frequency regions of ship underwater radiated noise calculation can be divided as 20 50 hz less than 1 below 50 hz 50 200 hz and 200 8000 hz greater than 5 above 200 hz respectively 2 2 vibration wet mode calculation and harmonic response analysis the ship is sailing in an infinite fluid domain the coupling with the surrounding fluids should be taken into consideration the hull structure vibration characteristics in vacuum can be expressed by the n order matrix differential equation li 2016 4 m x c x k x f t where m c k are the hull structures mass damping and stiffness matrices respectively x x x are the hull structures vibration displacement velocity and acceleration matrices respectively f t is the excitation load considering the fluid coupling effect equation 4 can be rewritten as 5 m x c x k x f t f w where f w r t p r is the coupling matrix and p is the node sound pressure vector the relationship between r and p is obtained by equation 6 6 m w p c w p k w p ρ r x 0 where m w k w c w are the fluid mass stiffness and damping matrices respectively p is the first derivative of the node sound pressure vector p is the second derivative of the node sound pressure vector and ρ is the seawater density the differential equation of hull fluid coupling vibration matrix can be obtained by combining equations 5 and 6 7 m 0 ρ r m w x p c 0 0 c w x p k r t 0 k w x p f t 0 considering that the hull is undamped free vibration equation 7 can be rewritten as 8 m 0 ρ r m w x p k r t 0 k w x p 0 the ship vibration wet mode can be obtained by solving equation 8 the study object is an offshore oil tanker with a total length of 101 60 m as shown in fig 3 based on the ship drawings the oil tanker and fluid finite element models were established and the fluid structure interaction fsi was used to define the fluid structure coupling surface between the hull wet surface and the fluid as shown in fig 4 the asymmetric method was used to calculate the ship vibration wet mode the first 200 steps were extracted and the frequency range was 0 200 hz among the obtained mode results only the four overall modes are found as shown in fig 5 and the rest are hull partial modes the natural frequencies of the first 2 orders of the overall vertical vibration of the ship were estimated based on the ship type parameters and todd s formula f h todd 1948 the estimated results are shown in table 1 the todd s formula is 9 n v 1 0 0167 α b d e 3 δ v l 3 β where α β are ship type correction factor for oil tanker α 94900 β 28 δ v is the total mass of the ship including the surrounding seawater δ v 12933 8 t b is the ship type width b 14 2 m d e is the ship equivalent type deep d e 7 5 m l is the ship vertical line length l 95 6 m the todd s formula is used to calculate the natural frequency of the first order overall vertical vibration and the natural frequency of the second order vertical vibration is given by 10 n v 2 c n v 1 where c is a dimensionless coefficient c 2 02 the formula for estimating the horizontal vibration mode is 11 f h b h k h i h δ h l 3 a h 0 0167 where f h is the first horizontal vibration natural frequency hz a h b h are ship type correction factors i h is the moment of inertia of the ship vertical axis m4 δ h is the total mass of the hull and the attached seawater t l is the length between the hull vertical lines m k h is the correction coefficient of the hull profile moment of inertia since there is a lack of i h the estimated value of the hull first horizontal vibration is temporarily unavailable in engineering the overall vertical vibration of the hull is more concerned as it has the greatest impact on the acoustic and vibration response of the ship weng c j 1985 in fig 5 the oil tanker overall vibration mode can be divided into two major categories vertical vibration mode and horizontal vibration mode which appear alternately the twisting or torsional modes usually occur in ships with large openings in the deck such as container ships from table 1 the error is within 10 of the simulation values and estimated values of the first 2 vertical overall vibration natural frequency which shows that the simulation model is credible through the study of the overall vibration of the hull the basic dynamic characteristics of the ship can be more effectively grasped the excitation frequency of the hull can be staggered from the natural frequency at the design stage thus avoiding the occurrence of the overall resonance of the hull which is of great significance in improving the quality and service life of the ship only the underwater radiated noise caused by the power plants is considered in this paper the hull vibration response under the excitation of the main power plants was calculated the main power plants in the engine room include the main diesel engine gearbox and diesel generator unit the power plants specific parameters are shown in table 2 and table 3 the foot vibration accelerations of the power plants were obtained through real ship testing considering the test instruments the sampling frequency is set to 16 khz and the sampling time is set to 2 s the measurement site is shown in fig 6 and the measured results are shown in fig 7 in engineering the calculation of ship acoustic and vibration response is usually carried out under 1 3 octave to study the ship underwater radiated noise characteristics of the middle and low frequency more accurately normal spectrum density is chosen in middle and low frequency the calculation frequency range is 20 200 hz and the frequency interval is 2 hz the vibration acceleration test was performed on the local parts of the oil tanker and compared with the simulation results the comparison results are shown in fig 8 the simulation overall values and measured overall values obtained by synthesizing the vibration acceleration in the bandwidth are shown in table 4 from fig 8 the vibration calculation values of each measuring point have a good consistency with the measured values the difference in amplitude is caused by factors such as modeling error and neglect of other auxiliary mechanical equipment incentives in table 4 the maximum error between the simulation values and the measured values of the overall vibration acceleration level is 6 2 db the mean absolute percentage error mape is a measure of prediction accuracy of a forecasting method in statistics and is defined by the formula 12 m 100 n t 1 n a t f t a t where a t is the measured value f t is the simulation value the mape for each one of the measuring points was calculated by using every frequency value of the spectra between 20 and 200 hz the full spectrum mapes of these measuring points are shown in table 4 the maximum mape value is 16 0 which satisfies the general engineering requirements and the hull vibration simulation values have good reliability and accuracy 2 3 middle and low frequency underwater radiated noise calculation of oil tanker the bem ifem and aml are common numerical methods for calculating structure radiated noise in the middle and low frequency the bem combines classical integral equations and finite element theory the integral equation may be regarded as an exact solution of the governing partial differential equation the bem attempts to use the given boundary conditions to fit boundary values into the integral equation once this is done in the post processing stage the integral equation can be used again to calculate numerically the solution directly at any desired point in the interior of the solution domain the infinite element method is a modification of the finite element method the method divides the domain concerned into infinitely many sections the structure of the acoustic ifem is composed of two parts the finite inner region of the envelope structure model and the semi infinite outer region the limited inner region is dispersed by finite elements the semi infinite outer region is dispersed by divergent infinite elements and the nodes are coupled at the interface to ensure continuity in the process of outward propagation of sound pressure the aml is a new type of finite element method the calculation principle is to artificially set a finite thickness medium layer to absorb sound waves at the acoustic finite element boundary the absorption layer makes sound waves decay rapidly in exponential form therefore the sound wave at the boundary of the medium layer is substantially zero there are also differences among the three methods the bem requires a surface mesh but the ifem and the aml require a volume mesh of the external sound field three methods are also different in acoustic boundary processing the bem directly takes the vibration displacement of the hull as the acoustic boundary condition but the ifem and the aml not only use the vibration displacement as the boundary condition but also assign the infinite element attribute and the matching layer attribute respectively to the external sound field boundary the bem ifem and aml were used to calculate the middle and low frequency underwater radiated noise of the oil tanker respectively the differences in the modeling scale computational accuracy and computational time consuming of the three methods were explored the calculated frequency band was 20 200 hz with 2 hz interval it should be noted that the ship has a free liquid surface in the bem the free liquid surface is simulated by setting anti symmetric boundary condition but in the ifem and aml the air impedance is defined at the free liquid surface the acoustic boundary and free liquid surface processing of three methods are shown in fig 9 the calculated result of the oil tanker radiated sound power is shown in fig 10 in fig 10 in the range of 20 170 hz the radiated sound power curves obtained from the three methods agree well with each other in the range of 170 200 hz the radiated sound power obtained by the fe bem is slightly larger in amplitude than that of the fe ifem and fe aml however the calculation results of the three methods still maintain a good consistency in the trend the overall underwater radiated sound power levels of oil tankers obtained from fe bem fe ifem and fe aml are 139 0 db 135 4 db and 135 8 db respectively and the maximum difference is 3 6 db most of the sound power peak frequencies are consistent with the excitation of the power plants peaks at other frequencies such as 112 hz and 120 hz may be related to the vibration transmission path and the impedance characteristics of the radiated medium the structure acoustic radiated characteristics are not only related to the excitation source but also related to the transmission path and the radiated medium the radiated sound pressure cloud pictures of the field points obtained by the three methods are shown in fig 11 in fig 11 at different frequencies the radiated sound pressure levels near the excitation source are relatively large at 22 hz the sound radiation of the oil tanker is mainly manifested as overall radiation and as the frequency increases the sound radiation gradually becomes local radiation there are discrepancies in sound pressure distribution among the three methods which may be due to several reasons ① bem calculates the sound pressure of the external sound field by surface mesh integration while aml and ifem calculate the sound pressure of the external sound field by volume mesh integration ② the three methods are different in boundary processing ③ in the bem the free liquid surface is simulated by setting anti symmetric boundary condition but in the ifem and aml the air impedance is defined at the free liquid surface to study the sound pressure levels of certain specific locations three different field points are established respectively at the horizontal 100 m on the ship both sides and 100 m underwater at the center of the ship bottom the sound pressure levels of these field points were calculated and the results are shown in fig 12 in fig 12 the radiated sound pressure spectrums are basically consistent with the ship radiated sound power spectrum the sound pressure peak frequencies are basically the same in the range of 20 200 hz the radiated sound pressure level curves obtained by the three methods agree well with each other the sound pressure level in the ship vertical direction is greater than the horizontal direction sound pressure level at the same distance ifem has many limitations in the calculation of ship underwater radiated noise for example the acoustic finite element boundary must be drawn as an ellipse or a sphere and the infinite element layer thickness must satisfy 1 2 acoustic wavelengths which will result in an increase in the number of model meshes and a reduction in computational speed at the same time the calculation accuracy of ifem is related to the chosen order higher orders ensure high computational accuracy but also result in poor convergence of the numerical solution aml has no specific requirements for the boundary shape of the acoustic finite element and the thickness of the finite element layer the acoustic calculation element numbers are much less than the ifem and the calculation efficiency is higher compared to bem aml needs to divide the sound field model into a volume mesh for large models such as ships the number of sound field grids is usually more but bem only needs to extract the wet surface grid of the hull structure the bem calculation speed is better than aml therefore in engineering the fem bem method is recommended for ship underwater radiated noise calculation in the middle and low frequency the differences in the modeling scale computational accuracy and computational time consuming of the three methods are shown in table 5 the coefficient matrix of the linear equations formed by the traditional bem is an asymmetric dense matrix which leads to its shortcomings of high computation and high memory consumption according to engineering experience when the boundary element model degree of freedom n exceeds 15000 the traditional bem will consume a lot of computer resources and a long solution time fast multipole bem replaces the direct connection between the source point and the field point with the indirect connection by introducing the multipole expansion of the kernel function the interaction between particles is replaced with the interaction between set elements the fast multipole algorithm speeds up the multiplication of matrix and vector and reduces the computation and memory consumption from o n 3 to o n which increases the solution speed 3 high frequency underwater radiated noise prediction for oil tanker in the high frequency region the statistical energy method was used to calculate the ship underwater radiated noise the sea is a statistical method in space and frequency domain which takes energy as a variable under the premise of satisfying the modal density requirement it is of practical significance to using the sea to predict the high frequency underwater vibration and noise of ships the energy balance equation of a conservative acoustic structure weakly coupled system consisting of n subsystems is yao d y et al 1995 13 ω η e ω p i n ω where ω is the frequency η is the system coupling loss factor matrix e ω is the subsystem energy matrix and p in ω is the subsystem input power matrix in the high frequency the structure radiated sound power is yao d y et al 1995 14 p r r ξ 2 where r is the real part of the structure radiated sound impedance ξ 2 is the hull mean square vibration velocity 15 r η r ω m where η r is the acoustic radiated loss factor ω is the frequency and m is the structure mass matrix in the high frequency band 200 8000 hz if the normal spectrum density is also selected to calculate ship underwater vibration and radiated noise this would lead to a sharp increase in the number of calculation frequency points and a sharp increase in the calculation scale generally there are enough frequency points between 200 and 8000 hz in 1 3 octave to reflect the ship high frequency acoustic and vibration characteristics the statistical energy model of the oil tankers is established as shown in fig 13 the measured vibration acceleration levels of the power plants are shown in fig 14 the calculated frequency range is 200 8000 hz at 1 3 octave frequency the calculated hull vibration velocity cloud pictures are shown in fig 15 in fig 15 the hull vibration velocity near the excitation source is the largest as the distance increases the vibration velocity of the hull gradually decreases from the viewpoint of the amplitude as the frequency increases the vibration velocity of the hull structure becomes smaller gradually the mathematical average of the radiated sound power of the field points at three different locations are shown in fig 16 the radiated sound pressure levels of the three field points in the model are shown in fig 17 where field point 1 and field point 3 are the semi infinite fluids on both sides of the ship and the field point 2 is the ship bottom semi infinite fluid in fig 16 the radiated sound power of the oil tanker in the range of 200 800 hz increases slowly with frequency increasing in the range of 800 4000 hz the radiated sound power starts to decrease with frequency increasing after 4000 hz the radiated sound power starts to rise slowly again in fig 17 the variation trend of the radiated sound pressure level curve of the three field points is basically the same as the radiated sound power curve the field point 1 and the field point 3 are geometrically symmetrical but the radiated sound pressure level at the field point 3 is greater than that at the field point 1 due to the fact that only the starboard diesel generator is turned on in the actual sailing condition 4 study on the far field criterion of underwater acoustic radiation of ship the ship underwater radiation sound field has far field and near field and the sound pressure has large fluctuations in the near field for general sound sources the radiated sound pressure decreases with distance in the far field for a structure sound source the sound pressure satisfies the following conditions in the far field 16 p r θ φ p e q u θ φ r where r is the distance from the field point to the equivalent sound source and p e q u is the equivalent sound pressure amplitude θ is the azimuth angle φ is the elevation angle the far field sound pressure directivity function is 17 θ r θ φ p e q u θ φ max p e q u θ φ r r p e q u θ φ max p e q u θ φ so the far field radiation sound pressure directivity function is not related to r the far field location can be determined when the ship sound radiation directivity does not change with distance the 50 m below the center of geometry of the ship is taken as the center four different planes of sound radiation directivity parallel to the xy plane horizontal middle section were established with a radius of 30 m 50 m 80 m and 100 m the bem was used to calculate the underwater sound pressure directionality of the ship and the results are shown in fig 18 the 0 90 180 and 270 respectively represent the bow the port side the poop and the starboard side of the oil tanker in fig 18 at all given frequencies when the horizontal radiation radius reaches 80 m the number of radiated sound pressure directivity side lobes no longer changes and the directivity change laws are basically the same in other words after the radius of radiation reaches 80 m the directivity of the ship radiated sound pressure no longer changes with distance therefore for the oil tanker at the underwater depth of 50 m when the horizontal radiation radius reaches 80 m it is already the far field of the ship underwater sound radiation 4 conclusion for a certain type of oil tanker this study firstly compares the hull vibration simulation results with the experimental results to validate the ship calculation model then the fe bem fe aml and fe ifem were used to calculate the middle and low frequency underwater radiated noise of the oil tanker respectively the differences among the three methods were explored in the modeling scale calculation accuracy and calculation expensiveness the sea was used to calculate the high frequency vibration and underwater radiated noise of the oil tanker so that the full frequency underwater radiated noise calculation and characteristics research of the oil tanker were realized last the ship sound radiation far field criterion was studied based on sound radiation directivity the main conclusions are summarized as follows 1 the oil tanker vibration calculated values agree well with the measured values the simulation model and vibration calculation method are reliable and the peak frequencies of the vibration response of the hull are mostly consistent with the peak frequencies of the excitation sources 2 the radiated sound power and sound pressure of the oil tanker obtained by the three different calculation methods are relatively consistent based on the analysis fe bem shows a smaller modeling scale better calculation accuracy and shorter solution time 3 using ship sound radiation directivity as a far field criterion method is relatively intuitive the far field location of sound radiation can be determined when the sound radiation directivity no longer changes with distance acknowledgment this work was supported by the national nature science foundation of china p r china grant nos 51079118 5129148 and defense pre research project of china p r china grant nos 10204010410 
22969,one trend in ship development is low noise characteristics as one of the major noise sources of ship underwater radiated noise is the power equipment it is critical to predict the ship underwater radiated noise caused by power equipment during the design phase in this study the incentive spectrums of power plants were obtained by testing on an oil tanker ship and the hull vibration was calculated and measured in the middle and low frequency the results show that the calculation model satisfies the accuracy requirement to calculate the ship underwater radiated noise in the middle and low frequency the finite element and boundary element method fe bem finite element and infinite element method fe ifem and finite element and automatic matching layer fe aml were used respectively it is found that the fe bem is the preferred method for calculating ship underwater radiated noise in modeling scale and computational efficiency the calculation of hull vibration and underwater radiated noise in the high frequency were performed by using the statistical energy analysis sea full frequency underwater radiated noise prediction of the oil tanker was completed in the end the far field of ship underwater sound radiation was studied the far field can be determined when the sound radiation directivity of the ship no longer changes with distance keywords full frequency ship underwater radiated noise fe bem fe ifem fe aml sea far field criterion 1 introduction during the voyage of a ship its main power plants will cause vibration of the hull which can induce the movement of the surrounding fluid to generate underwater acoustic radiation that may further cause adverse effects on marine organisms and damage the marine ecological balance nowacek d p et al 2007 williams r et al 2015 farcas a et al 2015 in the past years the subject of ship noise emission has been identified and the eu has funded the fp7 silenv ship innovative solutions to reduce noise and vibrations project that runs from 2010 to 2012 borelli d et al 2016 in addition for military ships the most important indicator to measure the ship acoustic stealth performance is the ship underwater radiated noise level the navies of various countries are currently vigorously developing sonar detection technology which in turn has led to the acoustic stealth performance requirements of naval ships have become more stringent the underwater noise forecast during the design stage can grasp the ship noise level in advance and provide the basis for the subsequent vibration and noise reduction design the ship underwater noise sources usually have three types mechanical noise propeller noise and hydrodynamic noise among which the mechanical noise and propeller noise are the most important there are various studies have investigated the ship underwater radiated noise caused by the propeller gaggero s et al 2016 dealt with the side effects of propellers cavitation i e pressure pulses and radiated noise they presented a survey of a specific test case represented by a single screw research vessel in the framework of the project aquo achieve quieter oceans by shipping noise footprint reduction which was analyzed with three different strategies numerical calculations model scale investigations and full scale measurements seol h et al 2005 used a time domain acoustic analogy to calculate underwater propeller noise the potential based panel method was used to analyze the flow field and then the pressure and other data in the time domain was substituted into the ffowcs williams and hawkings fwh equation to calculate the ship underwater far field radiated noise kellett p et al 2013 and özden m c et al 2016 adopted cfd software and ffowcs williams and hawkings fwh equation to calculate ship underwater radiated noise generated by propeller under different flow conditions and discussed the improvement of the calculation method lidtke a k et al 2016 further studied the modeling methods of propeller and cavitation model and the cavitation induced noise was calculated by large eddy simulation and fwh acoustic analogy the calculation of propeller radiated noise has been relatively mature this study mainly focuses on the ship underwater radiated noise caused by the power plants however not only the structure of a ship is complicated but also the excitation is complex in addition only the numerical method is available for solving its vibration and radiated noise there are various numerical methods for calculating underwater vibration and radiated noise of complex structure such as finite element method fem boundary element method bem wave superposition method wsm infinite element method ifem automatic matching layer aml statistical energy analysis sea and finite element statistical energy analysis hybrid method fe sea xiang y 2017 wu s w 2018 zhou m s et al 2017 tang z y 2011 and peng x 2003 applied fe bem to calculate the ship underwater radiated noise in the middle and low frequency and obtained good results qiu z h liu s et al 2013 used the ifem to calculate the low frequency underwater radiated noise of the ship and studied the influence of damping on the underwater radiated noise in high frequency region structures usually exhibit short wave and high modality characteristics in order to calculate the structure high frequency acoustic and vibration response statistical energy analysis sea was proposed yao d y et al 1995 morrow c t 2013 liu k et al 2010 and li x m et al 2013 used sea to predict the ship underwater radiated noise and the results showed that the sea can be well applied to the calculation of high frequency vibration and radiated noise of ship however there are still deficiencies in the prediction of ship underwater radiated noise caused by power plants ① in the middle and low frequency region fe bem or fe ifem has been used to calculate the ship underwater radiated noise it is rare to use different methods to calculate the ship underwater radiated noise and compare the calculation methods differences ② there are few comparisons between the hull vibration measured values and simulation values ③ there is less research on the far field criteria of ship underwater acoustic radiation in this study an oil tanker was used to study the full frequency underwater radiated noise by different numerical methods and the method for judging ship acoustic radiation far field was developed the flow diagram of this study is shown in fig 1 2 middle and low frequency underwater radiated noise prediction of an oil tanker 2 1 frequency band division to calculate ship underwater radiated noise different methods should be used for different analysis frequency bands therefore dividing the frequency interval reasonably is important in calculating the ship underwater radiated noise within the full frequency the modal number n has often been used to divide the frequency band yao d y et al 1995 which can be calculated by 1 n n ω δ f where n ω is the structure modal density and δ f is the frequency bandwidth the modal density is an important parameter to measure the storage capacity of subsystem vibration energy according to the statistical energy theory when the modal density of the substructure is larger the modality of the substructure within the bandwidth is more dense and the calculation result has statistical significance the modal density of one dimensional beam structure can be got by 2 n ω 1 ω 1 2 ρ a e i 1 4 where ω is the frequency a is the cross sectional area of the beam structure ρ is the mass density e i is the structural bending stiffness the modal density of two dimensional flat structure can be got by 3 n ω 3 a h c l where h and a are the thickness and area of plate structure respectively c l is the structure bending wave velocity in engineering the low middle and high frequency regions are divided by n 1 1 n 5 and n 5 respectively yao d y et al 1995 the modal number n is calculated according to the narrowband spectrum and then the integral operation is performed according to the upper and lower limits of the octave the 1 3 octave is chosen to calculate the oil tanker substructures modal number n to reduce the calculation scale but this does not affect the division result of the frequency band the modal number n of the hull structures were calculated based on equation 1 3 and plotted in fig 2 according to the modal numbers of the different hull structure subsystems in fig 2 the low middle and high frequency regions of ship underwater radiated noise calculation can be divided as 20 50 hz less than 1 below 50 hz 50 200 hz and 200 8000 hz greater than 5 above 200 hz respectively 2 2 vibration wet mode calculation and harmonic response analysis the ship is sailing in an infinite fluid domain the coupling with the surrounding fluids should be taken into consideration the hull structure vibration characteristics in vacuum can be expressed by the n order matrix differential equation li 2016 4 m x c x k x f t where m c k are the hull structures mass damping and stiffness matrices respectively x x x are the hull structures vibration displacement velocity and acceleration matrices respectively f t is the excitation load considering the fluid coupling effect equation 4 can be rewritten as 5 m x c x k x f t f w where f w r t p r is the coupling matrix and p is the node sound pressure vector the relationship between r and p is obtained by equation 6 6 m w p c w p k w p ρ r x 0 where m w k w c w are the fluid mass stiffness and damping matrices respectively p is the first derivative of the node sound pressure vector p is the second derivative of the node sound pressure vector and ρ is the seawater density the differential equation of hull fluid coupling vibration matrix can be obtained by combining equations 5 and 6 7 m 0 ρ r m w x p c 0 0 c w x p k r t 0 k w x p f t 0 considering that the hull is undamped free vibration equation 7 can be rewritten as 8 m 0 ρ r m w x p k r t 0 k w x p 0 the ship vibration wet mode can be obtained by solving equation 8 the study object is an offshore oil tanker with a total length of 101 60 m as shown in fig 3 based on the ship drawings the oil tanker and fluid finite element models were established and the fluid structure interaction fsi was used to define the fluid structure coupling surface between the hull wet surface and the fluid as shown in fig 4 the asymmetric method was used to calculate the ship vibration wet mode the first 200 steps were extracted and the frequency range was 0 200 hz among the obtained mode results only the four overall modes are found as shown in fig 5 and the rest are hull partial modes the natural frequencies of the first 2 orders of the overall vertical vibration of the ship were estimated based on the ship type parameters and todd s formula f h todd 1948 the estimated results are shown in table 1 the todd s formula is 9 n v 1 0 0167 α b d e 3 δ v l 3 β where α β are ship type correction factor for oil tanker α 94900 β 28 δ v is the total mass of the ship including the surrounding seawater δ v 12933 8 t b is the ship type width b 14 2 m d e is the ship equivalent type deep d e 7 5 m l is the ship vertical line length l 95 6 m the todd s formula is used to calculate the natural frequency of the first order overall vertical vibration and the natural frequency of the second order vertical vibration is given by 10 n v 2 c n v 1 where c is a dimensionless coefficient c 2 02 the formula for estimating the horizontal vibration mode is 11 f h b h k h i h δ h l 3 a h 0 0167 where f h is the first horizontal vibration natural frequency hz a h b h are ship type correction factors i h is the moment of inertia of the ship vertical axis m4 δ h is the total mass of the hull and the attached seawater t l is the length between the hull vertical lines m k h is the correction coefficient of the hull profile moment of inertia since there is a lack of i h the estimated value of the hull first horizontal vibration is temporarily unavailable in engineering the overall vertical vibration of the hull is more concerned as it has the greatest impact on the acoustic and vibration response of the ship weng c j 1985 in fig 5 the oil tanker overall vibration mode can be divided into two major categories vertical vibration mode and horizontal vibration mode which appear alternately the twisting or torsional modes usually occur in ships with large openings in the deck such as container ships from table 1 the error is within 10 of the simulation values and estimated values of the first 2 vertical overall vibration natural frequency which shows that the simulation model is credible through the study of the overall vibration of the hull the basic dynamic characteristics of the ship can be more effectively grasped the excitation frequency of the hull can be staggered from the natural frequency at the design stage thus avoiding the occurrence of the overall resonance of the hull which is of great significance in improving the quality and service life of the ship only the underwater radiated noise caused by the power plants is considered in this paper the hull vibration response under the excitation of the main power plants was calculated the main power plants in the engine room include the main diesel engine gearbox and diesel generator unit the power plants specific parameters are shown in table 2 and table 3 the foot vibration accelerations of the power plants were obtained through real ship testing considering the test instruments the sampling frequency is set to 16 khz and the sampling time is set to 2 s the measurement site is shown in fig 6 and the measured results are shown in fig 7 in engineering the calculation of ship acoustic and vibration response is usually carried out under 1 3 octave to study the ship underwater radiated noise characteristics of the middle and low frequency more accurately normal spectrum density is chosen in middle and low frequency the calculation frequency range is 20 200 hz and the frequency interval is 2 hz the vibration acceleration test was performed on the local parts of the oil tanker and compared with the simulation results the comparison results are shown in fig 8 the simulation overall values and measured overall values obtained by synthesizing the vibration acceleration in the bandwidth are shown in table 4 from fig 8 the vibration calculation values of each measuring point have a good consistency with the measured values the difference in amplitude is caused by factors such as modeling error and neglect of other auxiliary mechanical equipment incentives in table 4 the maximum error between the simulation values and the measured values of the overall vibration acceleration level is 6 2 db the mean absolute percentage error mape is a measure of prediction accuracy of a forecasting method in statistics and is defined by the formula 12 m 100 n t 1 n a t f t a t where a t is the measured value f t is the simulation value the mape for each one of the measuring points was calculated by using every frequency value of the spectra between 20 and 200 hz the full spectrum mapes of these measuring points are shown in table 4 the maximum mape value is 16 0 which satisfies the general engineering requirements and the hull vibration simulation values have good reliability and accuracy 2 3 middle and low frequency underwater radiated noise calculation of oil tanker the bem ifem and aml are common numerical methods for calculating structure radiated noise in the middle and low frequency the bem combines classical integral equations and finite element theory the integral equation may be regarded as an exact solution of the governing partial differential equation the bem attempts to use the given boundary conditions to fit boundary values into the integral equation once this is done in the post processing stage the integral equation can be used again to calculate numerically the solution directly at any desired point in the interior of the solution domain the infinite element method is a modification of the finite element method the method divides the domain concerned into infinitely many sections the structure of the acoustic ifem is composed of two parts the finite inner region of the envelope structure model and the semi infinite outer region the limited inner region is dispersed by finite elements the semi infinite outer region is dispersed by divergent infinite elements and the nodes are coupled at the interface to ensure continuity in the process of outward propagation of sound pressure the aml is a new type of finite element method the calculation principle is to artificially set a finite thickness medium layer to absorb sound waves at the acoustic finite element boundary the absorption layer makes sound waves decay rapidly in exponential form therefore the sound wave at the boundary of the medium layer is substantially zero there are also differences among the three methods the bem requires a surface mesh but the ifem and the aml require a volume mesh of the external sound field three methods are also different in acoustic boundary processing the bem directly takes the vibration displacement of the hull as the acoustic boundary condition but the ifem and the aml not only use the vibration displacement as the boundary condition but also assign the infinite element attribute and the matching layer attribute respectively to the external sound field boundary the bem ifem and aml were used to calculate the middle and low frequency underwater radiated noise of the oil tanker respectively the differences in the modeling scale computational accuracy and computational time consuming of the three methods were explored the calculated frequency band was 20 200 hz with 2 hz interval it should be noted that the ship has a free liquid surface in the bem the free liquid surface is simulated by setting anti symmetric boundary condition but in the ifem and aml the air impedance is defined at the free liquid surface the acoustic boundary and free liquid surface processing of three methods are shown in fig 9 the calculated result of the oil tanker radiated sound power is shown in fig 10 in fig 10 in the range of 20 170 hz the radiated sound power curves obtained from the three methods agree well with each other in the range of 170 200 hz the radiated sound power obtained by the fe bem is slightly larger in amplitude than that of the fe ifem and fe aml however the calculation results of the three methods still maintain a good consistency in the trend the overall underwater radiated sound power levels of oil tankers obtained from fe bem fe ifem and fe aml are 139 0 db 135 4 db and 135 8 db respectively and the maximum difference is 3 6 db most of the sound power peak frequencies are consistent with the excitation of the power plants peaks at other frequencies such as 112 hz and 120 hz may be related to the vibration transmission path and the impedance characteristics of the radiated medium the structure acoustic radiated characteristics are not only related to the excitation source but also related to the transmission path and the radiated medium the radiated sound pressure cloud pictures of the field points obtained by the three methods are shown in fig 11 in fig 11 at different frequencies the radiated sound pressure levels near the excitation source are relatively large at 22 hz the sound radiation of the oil tanker is mainly manifested as overall radiation and as the frequency increases the sound radiation gradually becomes local radiation there are discrepancies in sound pressure distribution among the three methods which may be due to several reasons ① bem calculates the sound pressure of the external sound field by surface mesh integration while aml and ifem calculate the sound pressure of the external sound field by volume mesh integration ② the three methods are different in boundary processing ③ in the bem the free liquid surface is simulated by setting anti symmetric boundary condition but in the ifem and aml the air impedance is defined at the free liquid surface to study the sound pressure levels of certain specific locations three different field points are established respectively at the horizontal 100 m on the ship both sides and 100 m underwater at the center of the ship bottom the sound pressure levels of these field points were calculated and the results are shown in fig 12 in fig 12 the radiated sound pressure spectrums are basically consistent with the ship radiated sound power spectrum the sound pressure peak frequencies are basically the same in the range of 20 200 hz the radiated sound pressure level curves obtained by the three methods agree well with each other the sound pressure level in the ship vertical direction is greater than the horizontal direction sound pressure level at the same distance ifem has many limitations in the calculation of ship underwater radiated noise for example the acoustic finite element boundary must be drawn as an ellipse or a sphere and the infinite element layer thickness must satisfy 1 2 acoustic wavelengths which will result in an increase in the number of model meshes and a reduction in computational speed at the same time the calculation accuracy of ifem is related to the chosen order higher orders ensure high computational accuracy but also result in poor convergence of the numerical solution aml has no specific requirements for the boundary shape of the acoustic finite element and the thickness of the finite element layer the acoustic calculation element numbers are much less than the ifem and the calculation efficiency is higher compared to bem aml needs to divide the sound field model into a volume mesh for large models such as ships the number of sound field grids is usually more but bem only needs to extract the wet surface grid of the hull structure the bem calculation speed is better than aml therefore in engineering the fem bem method is recommended for ship underwater radiated noise calculation in the middle and low frequency the differences in the modeling scale computational accuracy and computational time consuming of the three methods are shown in table 5 the coefficient matrix of the linear equations formed by the traditional bem is an asymmetric dense matrix which leads to its shortcomings of high computation and high memory consumption according to engineering experience when the boundary element model degree of freedom n exceeds 15000 the traditional bem will consume a lot of computer resources and a long solution time fast multipole bem replaces the direct connection between the source point and the field point with the indirect connection by introducing the multipole expansion of the kernel function the interaction between particles is replaced with the interaction between set elements the fast multipole algorithm speeds up the multiplication of matrix and vector and reduces the computation and memory consumption from o n 3 to o n which increases the solution speed 3 high frequency underwater radiated noise prediction for oil tanker in the high frequency region the statistical energy method was used to calculate the ship underwater radiated noise the sea is a statistical method in space and frequency domain which takes energy as a variable under the premise of satisfying the modal density requirement it is of practical significance to using the sea to predict the high frequency underwater vibration and noise of ships the energy balance equation of a conservative acoustic structure weakly coupled system consisting of n subsystems is yao d y et al 1995 13 ω η e ω p i n ω where ω is the frequency η is the system coupling loss factor matrix e ω is the subsystem energy matrix and p in ω is the subsystem input power matrix in the high frequency the structure radiated sound power is yao d y et al 1995 14 p r r ξ 2 where r is the real part of the structure radiated sound impedance ξ 2 is the hull mean square vibration velocity 15 r η r ω m where η r is the acoustic radiated loss factor ω is the frequency and m is the structure mass matrix in the high frequency band 200 8000 hz if the normal spectrum density is also selected to calculate ship underwater vibration and radiated noise this would lead to a sharp increase in the number of calculation frequency points and a sharp increase in the calculation scale generally there are enough frequency points between 200 and 8000 hz in 1 3 octave to reflect the ship high frequency acoustic and vibration characteristics the statistical energy model of the oil tankers is established as shown in fig 13 the measured vibration acceleration levels of the power plants are shown in fig 14 the calculated frequency range is 200 8000 hz at 1 3 octave frequency the calculated hull vibration velocity cloud pictures are shown in fig 15 in fig 15 the hull vibration velocity near the excitation source is the largest as the distance increases the vibration velocity of the hull gradually decreases from the viewpoint of the amplitude as the frequency increases the vibration velocity of the hull structure becomes smaller gradually the mathematical average of the radiated sound power of the field points at three different locations are shown in fig 16 the radiated sound pressure levels of the three field points in the model are shown in fig 17 where field point 1 and field point 3 are the semi infinite fluids on both sides of the ship and the field point 2 is the ship bottom semi infinite fluid in fig 16 the radiated sound power of the oil tanker in the range of 200 800 hz increases slowly with frequency increasing in the range of 800 4000 hz the radiated sound power starts to decrease with frequency increasing after 4000 hz the radiated sound power starts to rise slowly again in fig 17 the variation trend of the radiated sound pressure level curve of the three field points is basically the same as the radiated sound power curve the field point 1 and the field point 3 are geometrically symmetrical but the radiated sound pressure level at the field point 3 is greater than that at the field point 1 due to the fact that only the starboard diesel generator is turned on in the actual sailing condition 4 study on the far field criterion of underwater acoustic radiation of ship the ship underwater radiation sound field has far field and near field and the sound pressure has large fluctuations in the near field for general sound sources the radiated sound pressure decreases with distance in the far field for a structure sound source the sound pressure satisfies the following conditions in the far field 16 p r θ φ p e q u θ φ r where r is the distance from the field point to the equivalent sound source and p e q u is the equivalent sound pressure amplitude θ is the azimuth angle φ is the elevation angle the far field sound pressure directivity function is 17 θ r θ φ p e q u θ φ max p e q u θ φ r r p e q u θ φ max p e q u θ φ so the far field radiation sound pressure directivity function is not related to r the far field location can be determined when the ship sound radiation directivity does not change with distance the 50 m below the center of geometry of the ship is taken as the center four different planes of sound radiation directivity parallel to the xy plane horizontal middle section were established with a radius of 30 m 50 m 80 m and 100 m the bem was used to calculate the underwater sound pressure directionality of the ship and the results are shown in fig 18 the 0 90 180 and 270 respectively represent the bow the port side the poop and the starboard side of the oil tanker in fig 18 at all given frequencies when the horizontal radiation radius reaches 80 m the number of radiated sound pressure directivity side lobes no longer changes and the directivity change laws are basically the same in other words after the radius of radiation reaches 80 m the directivity of the ship radiated sound pressure no longer changes with distance therefore for the oil tanker at the underwater depth of 50 m when the horizontal radiation radius reaches 80 m it is already the far field of the ship underwater sound radiation 4 conclusion for a certain type of oil tanker this study firstly compares the hull vibration simulation results with the experimental results to validate the ship calculation model then the fe bem fe aml and fe ifem were used to calculate the middle and low frequency underwater radiated noise of the oil tanker respectively the differences among the three methods were explored in the modeling scale calculation accuracy and calculation expensiveness the sea was used to calculate the high frequency vibration and underwater radiated noise of the oil tanker so that the full frequency underwater radiated noise calculation and characteristics research of the oil tanker were realized last the ship sound radiation far field criterion was studied based on sound radiation directivity the main conclusions are summarized as follows 1 the oil tanker vibration calculated values agree well with the measured values the simulation model and vibration calculation method are reliable and the peak frequencies of the vibration response of the hull are mostly consistent with the peak frequencies of the excitation sources 2 the radiated sound power and sound pressure of the oil tanker obtained by the three different calculation methods are relatively consistent based on the analysis fe bem shows a smaller modeling scale better calculation accuracy and shorter solution time 3 using ship sound radiation directivity as a far field criterion method is relatively intuitive the far field location of sound radiation can be determined when the sound radiation directivity no longer changes with distance acknowledgment this work was supported by the national nature science foundation of china p r china grant nos 51079118 5129148 and defense pre research project of china p r china grant nos 10204010410 
