index,text
23420,we perform numerical simulations using immersed boundary methods for flow over fish single and in tandem arrangements performing traveling wave like motion we analyze nonlinear mechanics of hydrodynamic lateral side force and drag thrust coefficients we compute their fourier spectra and find that lateral side force carries fundamental and odd harmonics while drag is composed of even harmonics when single fish swim in free stream for tandem arrangement we set the phase speed of downstream fish as 0 75 times that of upstream fish fourier spectra of lateral force for both upstream and downstream fish are composed of forcing frequencies of both the fish even harmonics of forcing frequencies along with combined modes at sum and difference of these frequencies appear in their drag spectra we also investigate the symmetric or antisymmetric nature of the fundamental and combined modes using the conventional symmetry principles and proper orthogonal decomposition technique we show that the results obtained from both of these techniques agree well with each other however we also find some anomalies in case of fish swimming in tandem configuration keywords fish schooling nonlinear interaction undulatory motion wake symmetry 1 introduction when an aerodynamic hydrodynamic body is provided with an excitation through forcing its oscillation causes instability in the surrounding fluid medium as a result fluid applies unsteady forces on the body through complex interaction between the body and its wake problems related to fluid structure interaction fsi pose a great challenge to the researchers as quantification of the excitation instability and the response of both the body and fluid is a complex task when a body starts oscillating in a fluid shear layer around it gets destabilized and rolls over and detaches itself from the trailing edge to traverse downstream in the form of clockwise or anticlockwise rotating vortices knoller 1909 betz 1912 these vortices form typical patterns of von karman street or reverse von karman street to produce drag or thrust force respectively in this situation solid structure and fluid medium exchange energy with each other at various frequencies as a canonical problem in the field of fsi flow over a cylinder gained much attention of many researchers previously nayfeh et al 2003 marzouk et al 2007 akhtar et al 2009 these studies help gain insight for the wake development and instability mechanisms to investigate nonlinear interaction between fluid and the body with the advent of micro unmanned swimming and flying robots and in quest for achieving their efficient designs scientists have also been focussing towards complex coupling of oscillating wings fins of birds insects and fishes with their respective flow environment young and lai 2007 heathcote and gursul 2007 cleaver et al 2012 khalid et al 2015 it inspires the investigators to study how these species employ their body parts to destabilize the flow around them and produce necessary forces for their motion these engineering problems become even more challenging when interaction among different individuals initiates and these bodies start taking advantage of each other to produce essential forces without consuming much power for activating their muscles these groups of birds and fishes flying or swimming together are generally termed as schools leaders of these groups use to disturb the flow and causes emergence of energetic vortical flows in their wake rear animals find it useful to move in those flow environments as it demands less expenditure of their muscle energy fish 1999 few studies have focused on the hydrodynamic analysis of flapping foils in single and tandem configurations to compare the advantages of this setting for application in autonomous underwater vehicles akhtar et al 2007 akhtar and mittal 2005 mittal et al 2003 taking advantage of this phenomenon is more pronounced in fish swimming various researchers have reported the results of their investigations to enhance our understanding about the level of advantage in these fish schools for leader and followers when a follower fish experiences lesser drag force than a single fish swimming in similar free stream and kinematic conditions it is known as drafting in case of leading fish finding beneficial to swim in front of a fish school it is known as inverse drafting in both of these phenomenon fishes interact with the surrounding fluid through highly nonlinear mechanisms to study this hydrodynamic advantage in terms of drag force and swimming power experienced or consumed by the individuals in these fish schools remained the major area of research in this field dong and lu 2007 deng et al 2007 a few studies zhang and zheng 2009 zhu et al 2014 could be found in literature regarding nonlinear analysis of coupling mechanisms between the fish or body and fluid to generate the respective response it is also interesting to study here whether the interaction of various frequency components present in the spectra of hydrodynamic drag and lateral side force produce new components along with this it is also insightful to know about the nature of these harmonics modes in terms of their symmetry through this approach it may provide an understanding to look for the resemblance of wake characteristics of fish swimming and the canonical cylinder problem in the field of fsi in this study we focus on nonlinear aspects of fish swimming we numerically simulate flow over single or two fish in tandem configuration while modeling their kinematics as traveling wave like motion along their body we quantify the response of these fish through temporal histories of unsteady forces fourier spectra phase maps and higher order spectral analysis we observe that swimming of one fish in the vicinity of another causes production of new modes to study the spatial symmetry properties of these modes we employ the technique and principles introduced by mansy and williams 1991 and williams et al 1992 for the wake modes of flow over stationary cylinders kim and williams 2006 applied those principles for flow over cylinders performing inline and cross flow oscillations and found that wake of oscillating cylinder also followed the same symmetry rules our present study is motivated from these earlier investigations all of these afore mentioned studies were performed for bluff bodies only it is yet to be investigated whether these symmetry principles are valid for wakes of oscillating aerodynamic hydrodynamic bodies or not where neutral and thrust producing vortex streets are also observed we employ the same techniques to apply the symmetry principles williams et al 1992 for fish performing traveling wave like motion often known as undulation it portraits a scenario where all the points along the body surface oscillate about one symmetry axis but amplitude of their oscillation varies along the length we analyze the suitability of these principles for a complex yet a commonly observed physical phenomenon present results may be applicable not only to fish swimming but also to oscillating wings of birds and fins tails of fish we also employ proper orthogonal decomposition technique to investigate the nature of spatial modes and compare our findings with those from the traditional symmetry rules we organize the manuscript as follows in section 2 we provide details of our numerical methodology where we employ immersed boundary method for solution of incompressible navier stokes equations section 3 presents temporal and spectral analysis of the results obtained from numerical simulations in section 4 we discuss nonlinear coupling of forces nature of various parent and combined wake modes and energy level variation carried by these modes for different parameters to elaborate interaction between hydrodynamic forces of a single fish and two fish in tandem formation finally we present summary and conclusion of the current work in section 5 2 numerical methodology 2 1 fish kinematics we employ a naca0012 airfoil as the representative of a fish body in the state of static equilibrium i e when it does not perform undulatory motion considering chord of the airfoil as the fish backbone amplitude a along the length of the fish for lateral traveling wave like motion is modeled by quadratic polynomial of the form 1 a x l a a 1 x l a 2 x l 2 0 x l 1 where x is a streamwise position and l shows length of the fish body taken as a constant we assume that the fish performs undulation in lateral direction only coefficients a a 1 and a 2 are computed using kinematics of a steadily swimming saithe fish videler 1993 from that data we obtain a 0 0 02 a 0 2 0 01 and a 1 0 10 lateral oscillation of the fish to model its undulatory motion is defined as 2 y x l t a x l cos 2 π x l c t where y is the lateral coordinate for any position along the fish body at a time instant t and c 2 π f indicates the phase speed of the traveling wave with f as oscillation frequency 2 2 flow solver in our present work we use the ibm mittal and iaccarino 2005 to solve incompressible navier stokes equations for computing flow properties around an undulating fish complete details of the algorithm are available in ref dong et al 2006 mittal et al 2008 the incompressible continuity and navier stokes equations are mentioned in tensor notation as follows 3 u j x j 0 4 u i t x j u i u j 1 ρ p x i ν 2 u i x j x j where i j 1 2 the u i are the cartesian velocity components and p is the pressure the fluid properties ρ and ν represent fluid density and kinematic viscosity respectively the reynolds number is defined as re l u ν the governing equations are discretized by a cell centered collocated non staggered arrangement all the variables are calculated using a multi dimensional ghost cell methodology inside the body so that the boundary conditions may be treated accurately the convective term is numerically approximated through a second order adams bashforth scheme and an implicit crank nicolson scheme is employed for the diffusive term here then these equations are integrated with respect to time through the fractional step method we present a schematic of the tandem arrangement and their associated parameters in fig 1 we show the flow domain and the grid to numerically simulate flow over the fish bodies in fig 2 where the upstream fish lies at a distance of 10 l from the in flow boundary we employ dirichlet conditions on the left hand side boundary as in flow and upper and lower boundaries to represent free stream conditions neumann condition is employed at the right hand side that acts as outflow lengths of the domain sides along the streamwise and lateral directions are 30 l and 20 l respectively we nondimensionalize the streamwise displacement d between leading edges of the two fish in tandem using their body length l and define it as l x d l drag f d and side force f y are computed by integrating pressure and shear stress on the surface of the fish body we calculate c y and c d by dividing the corresponding hydrodynamic forces by 1 2 ρ u 2 l using the time period τ 1 f of an undulation cycle corresponding time averaged coefficients are computed using the following relation 5 c 1 τ t t τ c t d t to characterize the unsteady aerodynamics hydrodynamics a non dimensional parameter strouhal number st is usually found in the literature it is defined as st f a t a i l u where a t a i l is twice the maximum amplitude of tail of the body khalid et al 2016 a t a i l quantifies the wake width and u is the free stream velocity as shown by arrows at inflow boundary in fig 2 we increase st through variation in the phase speed only for all numerical simulations here we take re 500 based on the conclusion of our grid convergence and time step independence studies we run all the simulations using grid size of 1750 1200 and at least 1600 time steps per period of undulatory motion for each fish details on these studies and validation cases for our numerical methodology can be seen in ref khalid et al 2016 we observe that numerical solution achieves steady state after 4 or 5 oscillation cycles we compute and report all the time averaged quantities for at least 10 oscillation cycles 3 temporal spectral analysis of numerical results when fish starts performing undulatory motion alternate vortices starts shedding from its trailing edge these vortices rotating clockwise or anti clockwise traverse downstream form typical wakes due to these wakes fish experiences unsteady hydrodynamic forces here in this section we analyze these unsteady forces lateral force and drag thrust produced by a single fish and a fish school composed of two fish in tandem configuration we perform temporal and fourier analysis to investigate about their nature here to look for the nature of instability mechanisms for wake generation by undulating fish we apply symmetry principles defined earlier for the wake of bluff bodies williams et al 1992 kim and williams 2006 for flow over a single fish we perform numerical simulations for 0 05 st 0 80 while for two fish in tandem we carry out our numerical experimentation for st 0 40 0 60 and 0 80 for tandem cases we define st based on the free stream velocity and oscillation frequency of the upstream fish fishes are generally found to swim with 0 25 st 0 40 triantafyllou et al 2004 in our case we keep st to a higher side to compensate for greater viscosity at re 500 we present temporal lateral side force coefficient c y and drag force coefficient c d in fig 3 for st 0 40 and 0 80 it also shows the respective fourier spectra of c y and c d along side their temporal profiles we observe periodic solutions both for c y and c d within the whole range of phase speeds chosen for the present study for st 0 40 body experiences a positive drag force we observe the production of negative drag usually termed as the thrust force for st 0 80 also more number of oscillation cycles appears in c d profiles than those in c y histories we perform fourier spectral analysis to identify the most energetic harmonics in c y and c d fundamental harmonics are present at the vortex shedding frequency f in c y spectra for all st while 2 f is the strongest harmonic in c d spectra odd harmonics appear at 3 f and 5 f in c y spectra while even harmonics are at 4 f and 6 f in c d spectra it resembles the lift and drag thrust spectra of cylinders marzouk et al 2007 akhtar et al 2009 and oscillating airfoils khalid et al 2015 we also see harmonics of minimal or lesser energy at f in c d spectra at lower st but it gains strength for higher st it shows linear coupling between these two hydrodynamic force coefficients at frequency f we also plot phase maps using c y and c d as the dynamical states of this system and show in fig 4 for st 0 40 here we use time histories of these coefficients for eight oscillation cycles after the system achieves steady state periodic response we see two loops here that determines that c d drives with double the frequency of c y for tandem configuration two fish make a coupled dynamical system and start interacting with each other fig 5 shows response of such a system in terms of time histories and fourier spectra of c y and c d we see that now no dynamical state of these fish shows period 1 solution here and their response becomes seemingly quasi periodic this observation is based on the fact that the amplitude spectra of the aerodynamic forces is no more composed of the fundamental frequency and its harmonics only it contains subharmonics also which shows the appearance of frequencies lesser than the fundamental one in the amplitude spectra the ratio between the frequencies of these subharmonics with the fundamental one does not come out as a rational number in fourier spectra of c y for the upstream fish fundamental harmonic is present at f 1 along with its odd harmonic at 3 f 1 and a subharmonic at f 2 similarly c y spectrum for downstream fish carries an odd harmonic at 3 f 2 along with a superharmonic at f 1 these spectra shows transfer of energy from both the fish to each other even harmonics of f 1 and f 2 appear in c d spectra for upstream and downstream fish respectively along with those harmonics combined modes are also present at f 1 f 2 for upstream fish and at f 1 f 2 f 1 f 2 and 2 f 1 for downstream fish in c d earlier studies qin 2003 kim and williams 2006 akhtar and elyyan 2018 show that lift and drag forces are quadratically coupled for stationary and oscillating cylinders observing the similar nature of frequency components in c y and c d for fish swimming we perform higher order spectral analysis to determine the level of quadratic coupling between unsteady hydrodynamic forces for both single and tandem cases if two modes at frequencies f i and f j in one signal e g c y interact to produce other modes at frequency f i f j or f i f j in another signal e g c d c y and c d are said to be quadratically phase coupled here we call f i and f j as the parent modes modes at f i f j and f i f j are the combined modes we compute cross bispectrum represented as b y y d for hydrodynamic coefficients it is defined as 6 b y y d lim t 1 t e x d f 1 f 2 x y f 1 x y f 2 where x f denotes the fourier spectra of a signal and x f shows its complex conjugate if value of b y y d is large through the statistical averaging process it shows strong quadratic phase coupling between c y and c d if it has a value nearly equal to zero there exists no phase coupling between these two signals and the signals will be uncorrelated in quadratic sense as afore mentioned for hydrodynamic coefficients of single fish for all st considered here we see a strong quadratic coupling for both the drag and thrust producing regimes we present cross bispectra between c y and c d of a single fish undulating at st 0 40 and 0 80 in fig 6 a and b respectively we see that at lower st b y y d has low order of magnitude but strong enough to show quadratic phase coupling between hydrodynamic forces as we increase st this quadratic interaction also becomes stronger in all the cases interaction of harmonic components at f 1 in c y results in 2 f 1 frequency in c d we also compute cross bispectra for c y and c d of both the upstream and the downstream fish in tandem configuration for a range of st as a representative case we present cross bispectra for hydrodynamic force coefficients of the upstream and downstream fish in fig 7 a and b respectively at st 0 80 and l x 1 75 for the upstream fish harmonic components at the oscillation frequency f 1 in c y interact with each other resulting in 2 f 1 component in c d but in case of the downstream fish we observe a range of frequency components coupling with each other to produce new components these newly produced components also include harmonics at f 1 f 2 and f 1 f 2 it indicates that these two fish undulating in tandem configuration have strong quadratic interaction with each other 4 discussion 4 1 spatial symmetry of wake modes previous studies mansy and williams 1991 williams et al 1992 kim and williams 2006 found certain symmetry rules for wakes of stationary and oscillating cylinders these symmetry principles follow the quadratic interaction of modes in the wake for generation of unsteady forces according to these symmetry principles a combined mode will be symmetric if its parent modes are similar i e both are symmetric or antisymmetric if two dissimilar modes interact with each other the resultant combined mode will be antisymmetric we check the applicability of these rules on the wakes produced by single fish and two fish in tandem performing traveling wave like motion our study also provides insight about the combined modes for both drag and thrust producing wakes for this purpose we compute and record temporal variations in the horizontal velocity at 21 locations symmetrically distributed about the y 0 axis along a vertical line in the wake as shown in fig 8 we then decompose these velocity signals into their odd and even components marasli et al 1989 used this technique to show agreement between the linear instability theory and varicose mode of instability for a plain turbulent wake in hydrodynamic stability theory sinuous modes at fundamental frequencies are antisymmetric while varicose modes at frequencies of first harmonics are symmetric sato 1970 a series of time varying signals may be decomposed into its odd and even parts about a certain symmetry axis or point in the present case of fish swimming we define these odd and even components as follows kim and williams 2006 7 γ f y i γ o d d f y i γ e v e n f y i γ o d d f y i γ f y i γ f y i 2 γ e v e n f y i γ f y i γ f y i 2 where γ f y i indicates complex fourier transform of velocity signal at location y i to observe the symmetry properties of a mode at any frequency f we compute energy in the odd and even components using the following integral quantities 8 o f i 1 n γ o d d f y i γ o d d f y i δ y e f i 1 n γ e v e n f y i γ e v e n f y i δ y where n denotes the total number of points where we compute the fluctuations in the wake γ represents the complex conjugate the fourier transform we define a ratio o e to compute relative energy of modes if o e becomes less than one symmetric varicose mode is dominant while antisymmetric odd mode is relatively stronger for o e greater than one fig 9 shows the spatial distribution of amplitude γ and phase ψ for original velocity fluctuations and their even and odd components we report these quantities for the velocity fluctuations computed along a vertical axis at a distance of 0 375 l from the trailing edge of the single fish for fundamental vortex shedding frequency f and its second harmonic at 3 f odd mode is more dominant and its amplitudes almost match those for the original while energy in the even modes is minimal energy in the even components is nearly equal to that of the original while in the odd component the energy has very small amplitudes for first harmonic at 2 f we compute o e for these three modes and present their values in table 1 we find that fundamental and its second harmonic modes are antisymmetric modes with o e equal to 598 4054 and 216 9661 respectively while first harmonic at 2 f is a symmetric mode with o e 0 0139 these observations are consistent with those for a flat plate sato 1970 stationary cylinder mansy and williams 1991 williams et al 1992 and oscillating cylinder kim and williams 2006 a symmetric mode at 2 f results from the coupling of the anti symmetric forcing or vortex shedding mode at f with itself similarly interaction of anti symmetric fundamental mode with symmetric mode at 2 f results in formation of an anti symmetric odd mode at 3 f in phase plots of fig 9 we observe a phase shift of 180 for fundamental mode at the point lying on y 0 axis that is a property of antisymmetric mode kim and williams 2006 similarly nearly 180 phase shift can also be seen for odd component of the mode at 3 f for mode at 2 f transition along y 0 axis is smooth but at y l 0 15 there is a shift of nearly 120 in the even component for symmetric wakes of circular cylinders kim et al kim and williams 2006 observed a phase shift of 90 a higher phase shift can be justified due to the formation of vortices having asymmetric shape khalid et al 2016 about the y 0 axis in case of undulating fish phase of dominated modes show fluctuating behavior for all the frequencies table 1 also shows o e values for st 0 80 where thrust is produced we find that the wake with reverse von karman vortex street also follows the afore mentioned symmetry rules for st 0 80 contribution by odd component in the energy of forcing mode has tremendously increased than that for st 0 40 it confirms the general nature of the principles used to define symmetry of the combined modes in the wakes of single bluff or hydrodynamic bodies when fish start swimming in tandem configuration they affect each other s hydrodynamic performance through wake body interaction in our earlier study khalid et al 2016 we quantified the effect of l x on the hydrodynamic performance of both the upstream and the downstream fish it was concluded that the hydrodynamic performance of the upstream fish had been almost independent of the undulation frequency of the rear fish moreover the drafting effect was observed to be negligible for l x 3 in our current study we have both the fish having equal body lengths considering a mother calf model tian et al 2016 quantified the hydrodynamic performance of both the larger and smaller fish for a range of parameters however saadat et al 2017 argued that the strouhal numbers and the tail beat amplitudes nondimensionalized by the body length were the governing parameters for swimming performance of fish and other aquatic species in the region between these two fish for smaller l x transitional wake may be expected for higher l x wake establishes itself before interacting with the downstream body we apply the symmetry rules on these wakes as well we show amplitudes and phase of original velocity fluctuations and their odd and even components for wake of upstream fish for st 0 40 in fig 10 we consider modes at f 1 and f 2 as the parent modes because these represent the forcing frequencies of the upstream and the downstream fish respectively vortex shedding also occurs with these frequencies in the respective wake of two fish as given in table 2 for the upstream fish these modes have energy ratios of 528 02 and 301 04 odd components are also dominant in their respective amplitude plots that proves their anti symmetric nature these two modes also interact to produce combined difference and sum modes at f 1 f 2 and f 1 f 2 having o e 0 1676 and 1 1624 respectively symmetric nature of the difference mode is in agreement with the symmetry rules but antisymmetric sum mode shows an anomaly we also notice that production of 2 f 2 mode does not follow these principles however the mode at 2 f 1 does for downstream fish parent modes are antisymmetric in their nature and all of the combined modes are symmetric having see fig 11 o e 1 table 2 also provides the relative energy ratio for these modes at st 0 80 at this st both fish experience thrust force due to formation of reverse von karman vortex street in their respective wakes in this case we find anomalies for a combined modes at 2 f 2 in the wake of upstream fish and at 2 f 1 for rear fish except these modes all other combined modes are symmetric as they are produced by the interaction of antisymmetric parent modes at f 1 and f 2 4 2 proper orthogonal decomposition we also analyze symmetry of the wake modes through decomposition of velocity data into spatial and temporal part using a technique known as proper orthogonal decomposition pod for this purpose velocity data can be approximated through galerkin expansion of the form 9 u x t i 1 m ϕ i x q i t we take snapshots at different time instances t 1 t 2 t n 0 t and ensemble these snapshots into a larger matrix we consider ensemble of snapshots as 10 w span u t 1 u t 2 u t n the dimensions of w is n d s where n is the number of time steps and d s is the number of probes the pod seeks a low dimensional modes φ 1 φ 2 φ m with m d s which optimally approximates the input matrix w as 11 min φ j 1 n i 1 n u t i j 1 m u t i φ j ℋ φ j ℋ 2 subjected to the condition φ i φ j ℋ δ i j 1 i j m let the time step δ t t n 1 and the time instances t k k δ t k 1 2 n we compute the pod modes using singular value decomposition svd as w s σ v t where s σ and v contain the pod modes singular values of w and eigenvectors of w respectively we also project each snapshot onto the pod modes to compute the temporal coefficient q i t referred to as the velocity coefficients as q i t ϕ i x u x t d x we present the validation of our pod technique by approximating the horizontal velocity at three probes located at symmetry axis y 0 and on its upper and lower sides in the wake of a single fish undulating at st 0 40 we present this comparison in fig 12 it shows accuracy of the currently employed decomposition procedure for flow features around the undulating fish to compare our results for the wake modes through pod and traditional symmetry principles we use velocity data in the wake of single fish at st 0 40 and two fish in tandem configuration at st 0 80 γ 0 75 and l x 1 50 to construct w matrix for the wake of a single fish we consider velocity date for 10 oscillation cycles and collect 1600 snapshots we project the pod modes onto the snapshots matrix and compute temporal coefficients q i where i 1 2 6 fig 13 shows power spectra of these q s dominant frequency in power spectra of q 1 and q 3 is f while that for q 2 q 4 and q 6 is 2 f 3 f is the most dominant frequency in the power spectrum of q 5 next we plot the spatial distribution of respective ϕ s it is evident that mode shapes ϕ 1 and ϕ 3 having frequency f are anti symmetric about y 0 axis ϕ 2 ϕ 4 and ϕ 6 with frequency 2 f show symmetric distribution while mode ϕ 5 with frequency 3 f is anti symmetric these results are consistent with our findings tabulated in table 1 for the wake modes of the upstream fish in tandem configuration we consider 16 oscillation cycles and collect 2560 snapshots we compute first eight pod modes using snapshot matrix and also temporal coefficients q i i 1 2 8 by projecting the snapshots data onto the pod modes fig 14 presents mode shapes ϕ s for both the upstream and the rear fish for the upstream fish dominant frequency spectra not shown here of q 1 and q 3 is f 1 2 hz other dominant frequencies in power spectra are 2 f 1 for q 2 q 4 and q 6 f 2 for q 5 and q 7 f 1 f 2 for q 8 we notice that wake modes ϕ 1 and ϕ 3 with frequency f 1 are anti symmetric ϕ 5 and ϕ 7 with frequency f 2 are anti symmetric ϕ 2 ϕ 4 and ϕ 6 having 2 f 2 are symmetric and ϕ 8 with frequency f 1 f 2 is almost symmetric about y 0 line for velocities in the wake of rear fish we observe that mode shapes ϕ 1 ϕ 3 and ϕ 7 with corresponding q s having dominant frequency at 2 f 2 3 0 hz are symmetric ϕ 2 and ϕ 5 are antisymmetric in their nature while q 1 and q 5 oscillate with most powerful harmonic at f 2 1 5 hz temporal coefficient q 8 carries the most energetic frequency component at f 1 2 hz and ϕ 8 is antisymmetric we observe an anomaly for f 1 f 2 frequency here in case of mode shape ϕ 4 according to the symmetry principles it should be symmetric as also shown in table 2 these investigation clearly show the validity of traditional symmetry principles not only for drag producing wake but also for thrust producing wakes we also observe few contradictions to these symmetry principles in the results obtained through pod in case of tandem fish which may originate due to complex wake body interaction 4 3 energy in parent and combined modes although coupling of the parent modes does not assure the transfer of energy between these modes yet it is interesting to see the variation in their respective spectral energy levels as the present study is motivated from ref kim and williams 2006 we discuss the trend in energy levels for various modes of lateral side and drag forces fig 15 presents the variation in energy of fundamental mode and its first and second harmonics in the wake of the single fish for a range of st as expected energy of the fundamental vortex shedding forcing mode and its second harmonic enhances smoothly with increasing st even mode at 2 f gets minimal energy for st 0 20 and starts increasing but its trend is not as smooth as for other harmonics these plots show that higher forcing frequency channel more energy in the fundamental modes and then its interaction with itself generate mode at 2 f interaction of f and 2 f produce the second harmonic at 3 f due to their high energy magnitudes for larger st the mode at 3 f also carries more energy we also show variations in energy of the parent and the combined modes in the wakes of the upstream and the downstream fish in figs 16 and 17 respectively we plot these energy levels as a function of the nondimensional distance between the leading edges of the two fish we compute magnitude of the spectral energy for the parent modes using c y spectra and we use c d spectra for energy of the combined modes as l x increases energy of the vortex shedding or forcing mode for the upstream fish decreases and gets saturated for l x 2 0 we observe a similar trend in the modal energy in the wake of the upstream fish caused by the forcing of the rear fish combined modes have lower energy magnitudes but variations are visible in these cases too difference mode at frequency f 1 f 2 carries same amount of energy for almost the whole range of l x and remains saturated except l x 2 00 sum mode at f 1 f 2 gets increasing energy levels for most of values in l x hence for upstream fish the parent modes and difference mode saturates or keep their energy levels same in fig 17 we observe decreasing trend of the energy levels in the wake of the rear fish for all the modes with increasing l x small fluctuations are observed in the forcing mode at f 2 the parent mode at f 1 and the difference mode achieves a steady state value for l x 3 0 based on these measurements it may be stated that the sum mode in the region between two fish absorbs energy from both the forcing modes at f 1 and f 2 despite an increasing distance between the fish bodies this absorption of energy at the sum mode may cause inverted drafting where the upstream fish takes advantage of the rear fish and it experiences lesser drag than that of a single fish swimming in same free stream with similar kinematics ristroph and zhang 2008 the tendency of absorbing energy in the combined modes in the wake of the rear fish seems deteriorating with increasing l x because the vortices emerging from trailing edge of the upstream fish dissipate while traversing greater distance before they transfer energy to the upstream fish 5 conclusions using immersed boundary method we numerically solve incompressible navier stokes equations for flow over single fish and two fish in tandem we keep different phase speeds of upstream and downstream fish so that contribution of various harmonic components may be distinguished in fourier spectra in case of flow over single fish we find that c y contains the fundamental harmonic and its odd harmonics where vortex shedding occurs at the forcing frequency for undulatory fish motion even harmonics exist in c d spectra it means that frequency of c d is double the frequency of c y we perform higher order spectral analysis to find the strength of quadratic phase coupling between c y and c d for the whole range of strouhal number considered presently magnitudes of the cross bispectrum between c y and c d are very high for tandem configuration c y of upstream fish carries a harmonic at f 2 with minimal strength along with stronger component at f 1 but we do not observe a harmonic at 2 f 2 in its c d but hydrodynamic coefficients of the downstream fish has prominent harmonics at f 1 and 2 f 1 along with those at f 2 and 2 f 2 hence quadratic coupling between two forcing frequencies is weaker in the wake of upstream fish b y y d has large values due to strong interaction of f 1 and f 2 in the vicinity of downstream fish quadratic nonlinear interaction of parent modes at forcing frequencies f 1 and f 2 produce combined modes with sum or difference of those frequencies f 1 f 2 or f 1 f 2 we apply the symmetry principles defined in literature for the wakes of bluff bodies here we find that those principles are also applicable to the drag or thrust producing wake behind undulating fish we also employ proper orthogonal decomposition technique to approximate the velocity data in the wake of swimming fish and to obtain the pod modes we conclude that information related symmetric asymmetric nature of pod modes is in agreement with that obtained from the application of conventional symmetry principles we also show that some anomalies exist for wakes of upstream and downstream fish while swimming in tandem formation it may occur due to complex vortex body interaction in the vicinity of undulating fish acknowledgments dr khalid is thankful to the higher education commission government of pakistan to provide funding for the presented research under international research support initiative program irsip dr dong would like to acknowledge the support from the office of naval research onr muri grant n00014 14 1 0533 and the national science foundation grant cbet 1313217 
23420,we perform numerical simulations using immersed boundary methods for flow over fish single and in tandem arrangements performing traveling wave like motion we analyze nonlinear mechanics of hydrodynamic lateral side force and drag thrust coefficients we compute their fourier spectra and find that lateral side force carries fundamental and odd harmonics while drag is composed of even harmonics when single fish swim in free stream for tandem arrangement we set the phase speed of downstream fish as 0 75 times that of upstream fish fourier spectra of lateral force for both upstream and downstream fish are composed of forcing frequencies of both the fish even harmonics of forcing frequencies along with combined modes at sum and difference of these frequencies appear in their drag spectra we also investigate the symmetric or antisymmetric nature of the fundamental and combined modes using the conventional symmetry principles and proper orthogonal decomposition technique we show that the results obtained from both of these techniques agree well with each other however we also find some anomalies in case of fish swimming in tandem configuration keywords fish schooling nonlinear interaction undulatory motion wake symmetry 1 introduction when an aerodynamic hydrodynamic body is provided with an excitation through forcing its oscillation causes instability in the surrounding fluid medium as a result fluid applies unsteady forces on the body through complex interaction between the body and its wake problems related to fluid structure interaction fsi pose a great challenge to the researchers as quantification of the excitation instability and the response of both the body and fluid is a complex task when a body starts oscillating in a fluid shear layer around it gets destabilized and rolls over and detaches itself from the trailing edge to traverse downstream in the form of clockwise or anticlockwise rotating vortices knoller 1909 betz 1912 these vortices form typical patterns of von karman street or reverse von karman street to produce drag or thrust force respectively in this situation solid structure and fluid medium exchange energy with each other at various frequencies as a canonical problem in the field of fsi flow over a cylinder gained much attention of many researchers previously nayfeh et al 2003 marzouk et al 2007 akhtar et al 2009 these studies help gain insight for the wake development and instability mechanisms to investigate nonlinear interaction between fluid and the body with the advent of micro unmanned swimming and flying robots and in quest for achieving their efficient designs scientists have also been focussing towards complex coupling of oscillating wings fins of birds insects and fishes with their respective flow environment young and lai 2007 heathcote and gursul 2007 cleaver et al 2012 khalid et al 2015 it inspires the investigators to study how these species employ their body parts to destabilize the flow around them and produce necessary forces for their motion these engineering problems become even more challenging when interaction among different individuals initiates and these bodies start taking advantage of each other to produce essential forces without consuming much power for activating their muscles these groups of birds and fishes flying or swimming together are generally termed as schools leaders of these groups use to disturb the flow and causes emergence of energetic vortical flows in their wake rear animals find it useful to move in those flow environments as it demands less expenditure of their muscle energy fish 1999 few studies have focused on the hydrodynamic analysis of flapping foils in single and tandem configurations to compare the advantages of this setting for application in autonomous underwater vehicles akhtar et al 2007 akhtar and mittal 2005 mittal et al 2003 taking advantage of this phenomenon is more pronounced in fish swimming various researchers have reported the results of their investigations to enhance our understanding about the level of advantage in these fish schools for leader and followers when a follower fish experiences lesser drag force than a single fish swimming in similar free stream and kinematic conditions it is known as drafting in case of leading fish finding beneficial to swim in front of a fish school it is known as inverse drafting in both of these phenomenon fishes interact with the surrounding fluid through highly nonlinear mechanisms to study this hydrodynamic advantage in terms of drag force and swimming power experienced or consumed by the individuals in these fish schools remained the major area of research in this field dong and lu 2007 deng et al 2007 a few studies zhang and zheng 2009 zhu et al 2014 could be found in literature regarding nonlinear analysis of coupling mechanisms between the fish or body and fluid to generate the respective response it is also interesting to study here whether the interaction of various frequency components present in the spectra of hydrodynamic drag and lateral side force produce new components along with this it is also insightful to know about the nature of these harmonics modes in terms of their symmetry through this approach it may provide an understanding to look for the resemblance of wake characteristics of fish swimming and the canonical cylinder problem in the field of fsi in this study we focus on nonlinear aspects of fish swimming we numerically simulate flow over single or two fish in tandem configuration while modeling their kinematics as traveling wave like motion along their body we quantify the response of these fish through temporal histories of unsteady forces fourier spectra phase maps and higher order spectral analysis we observe that swimming of one fish in the vicinity of another causes production of new modes to study the spatial symmetry properties of these modes we employ the technique and principles introduced by mansy and williams 1991 and williams et al 1992 for the wake modes of flow over stationary cylinders kim and williams 2006 applied those principles for flow over cylinders performing inline and cross flow oscillations and found that wake of oscillating cylinder also followed the same symmetry rules our present study is motivated from these earlier investigations all of these afore mentioned studies were performed for bluff bodies only it is yet to be investigated whether these symmetry principles are valid for wakes of oscillating aerodynamic hydrodynamic bodies or not where neutral and thrust producing vortex streets are also observed we employ the same techniques to apply the symmetry principles williams et al 1992 for fish performing traveling wave like motion often known as undulation it portraits a scenario where all the points along the body surface oscillate about one symmetry axis but amplitude of their oscillation varies along the length we analyze the suitability of these principles for a complex yet a commonly observed physical phenomenon present results may be applicable not only to fish swimming but also to oscillating wings of birds and fins tails of fish we also employ proper orthogonal decomposition technique to investigate the nature of spatial modes and compare our findings with those from the traditional symmetry rules we organize the manuscript as follows in section 2 we provide details of our numerical methodology where we employ immersed boundary method for solution of incompressible navier stokes equations section 3 presents temporal and spectral analysis of the results obtained from numerical simulations in section 4 we discuss nonlinear coupling of forces nature of various parent and combined wake modes and energy level variation carried by these modes for different parameters to elaborate interaction between hydrodynamic forces of a single fish and two fish in tandem formation finally we present summary and conclusion of the current work in section 5 2 numerical methodology 2 1 fish kinematics we employ a naca0012 airfoil as the representative of a fish body in the state of static equilibrium i e when it does not perform undulatory motion considering chord of the airfoil as the fish backbone amplitude a along the length of the fish for lateral traveling wave like motion is modeled by quadratic polynomial of the form 1 a x l a a 1 x l a 2 x l 2 0 x l 1 where x is a streamwise position and l shows length of the fish body taken as a constant we assume that the fish performs undulation in lateral direction only coefficients a a 1 and a 2 are computed using kinematics of a steadily swimming saithe fish videler 1993 from that data we obtain a 0 0 02 a 0 2 0 01 and a 1 0 10 lateral oscillation of the fish to model its undulatory motion is defined as 2 y x l t a x l cos 2 π x l c t where y is the lateral coordinate for any position along the fish body at a time instant t and c 2 π f indicates the phase speed of the traveling wave with f as oscillation frequency 2 2 flow solver in our present work we use the ibm mittal and iaccarino 2005 to solve incompressible navier stokes equations for computing flow properties around an undulating fish complete details of the algorithm are available in ref dong et al 2006 mittal et al 2008 the incompressible continuity and navier stokes equations are mentioned in tensor notation as follows 3 u j x j 0 4 u i t x j u i u j 1 ρ p x i ν 2 u i x j x j where i j 1 2 the u i are the cartesian velocity components and p is the pressure the fluid properties ρ and ν represent fluid density and kinematic viscosity respectively the reynolds number is defined as re l u ν the governing equations are discretized by a cell centered collocated non staggered arrangement all the variables are calculated using a multi dimensional ghost cell methodology inside the body so that the boundary conditions may be treated accurately the convective term is numerically approximated through a second order adams bashforth scheme and an implicit crank nicolson scheme is employed for the diffusive term here then these equations are integrated with respect to time through the fractional step method we present a schematic of the tandem arrangement and their associated parameters in fig 1 we show the flow domain and the grid to numerically simulate flow over the fish bodies in fig 2 where the upstream fish lies at a distance of 10 l from the in flow boundary we employ dirichlet conditions on the left hand side boundary as in flow and upper and lower boundaries to represent free stream conditions neumann condition is employed at the right hand side that acts as outflow lengths of the domain sides along the streamwise and lateral directions are 30 l and 20 l respectively we nondimensionalize the streamwise displacement d between leading edges of the two fish in tandem using their body length l and define it as l x d l drag f d and side force f y are computed by integrating pressure and shear stress on the surface of the fish body we calculate c y and c d by dividing the corresponding hydrodynamic forces by 1 2 ρ u 2 l using the time period τ 1 f of an undulation cycle corresponding time averaged coefficients are computed using the following relation 5 c 1 τ t t τ c t d t to characterize the unsteady aerodynamics hydrodynamics a non dimensional parameter strouhal number st is usually found in the literature it is defined as st f a t a i l u where a t a i l is twice the maximum amplitude of tail of the body khalid et al 2016 a t a i l quantifies the wake width and u is the free stream velocity as shown by arrows at inflow boundary in fig 2 we increase st through variation in the phase speed only for all numerical simulations here we take re 500 based on the conclusion of our grid convergence and time step independence studies we run all the simulations using grid size of 1750 1200 and at least 1600 time steps per period of undulatory motion for each fish details on these studies and validation cases for our numerical methodology can be seen in ref khalid et al 2016 we observe that numerical solution achieves steady state after 4 or 5 oscillation cycles we compute and report all the time averaged quantities for at least 10 oscillation cycles 3 temporal spectral analysis of numerical results when fish starts performing undulatory motion alternate vortices starts shedding from its trailing edge these vortices rotating clockwise or anti clockwise traverse downstream form typical wakes due to these wakes fish experiences unsteady hydrodynamic forces here in this section we analyze these unsteady forces lateral force and drag thrust produced by a single fish and a fish school composed of two fish in tandem configuration we perform temporal and fourier analysis to investigate about their nature here to look for the nature of instability mechanisms for wake generation by undulating fish we apply symmetry principles defined earlier for the wake of bluff bodies williams et al 1992 kim and williams 2006 for flow over a single fish we perform numerical simulations for 0 05 st 0 80 while for two fish in tandem we carry out our numerical experimentation for st 0 40 0 60 and 0 80 for tandem cases we define st based on the free stream velocity and oscillation frequency of the upstream fish fishes are generally found to swim with 0 25 st 0 40 triantafyllou et al 2004 in our case we keep st to a higher side to compensate for greater viscosity at re 500 we present temporal lateral side force coefficient c y and drag force coefficient c d in fig 3 for st 0 40 and 0 80 it also shows the respective fourier spectra of c y and c d along side their temporal profiles we observe periodic solutions both for c y and c d within the whole range of phase speeds chosen for the present study for st 0 40 body experiences a positive drag force we observe the production of negative drag usually termed as the thrust force for st 0 80 also more number of oscillation cycles appears in c d profiles than those in c y histories we perform fourier spectral analysis to identify the most energetic harmonics in c y and c d fundamental harmonics are present at the vortex shedding frequency f in c y spectra for all st while 2 f is the strongest harmonic in c d spectra odd harmonics appear at 3 f and 5 f in c y spectra while even harmonics are at 4 f and 6 f in c d spectra it resembles the lift and drag thrust spectra of cylinders marzouk et al 2007 akhtar et al 2009 and oscillating airfoils khalid et al 2015 we also see harmonics of minimal or lesser energy at f in c d spectra at lower st but it gains strength for higher st it shows linear coupling between these two hydrodynamic force coefficients at frequency f we also plot phase maps using c y and c d as the dynamical states of this system and show in fig 4 for st 0 40 here we use time histories of these coefficients for eight oscillation cycles after the system achieves steady state periodic response we see two loops here that determines that c d drives with double the frequency of c y for tandem configuration two fish make a coupled dynamical system and start interacting with each other fig 5 shows response of such a system in terms of time histories and fourier spectra of c y and c d we see that now no dynamical state of these fish shows period 1 solution here and their response becomes seemingly quasi periodic this observation is based on the fact that the amplitude spectra of the aerodynamic forces is no more composed of the fundamental frequency and its harmonics only it contains subharmonics also which shows the appearance of frequencies lesser than the fundamental one in the amplitude spectra the ratio between the frequencies of these subharmonics with the fundamental one does not come out as a rational number in fourier spectra of c y for the upstream fish fundamental harmonic is present at f 1 along with its odd harmonic at 3 f 1 and a subharmonic at f 2 similarly c y spectrum for downstream fish carries an odd harmonic at 3 f 2 along with a superharmonic at f 1 these spectra shows transfer of energy from both the fish to each other even harmonics of f 1 and f 2 appear in c d spectra for upstream and downstream fish respectively along with those harmonics combined modes are also present at f 1 f 2 for upstream fish and at f 1 f 2 f 1 f 2 and 2 f 1 for downstream fish in c d earlier studies qin 2003 kim and williams 2006 akhtar and elyyan 2018 show that lift and drag forces are quadratically coupled for stationary and oscillating cylinders observing the similar nature of frequency components in c y and c d for fish swimming we perform higher order spectral analysis to determine the level of quadratic coupling between unsteady hydrodynamic forces for both single and tandem cases if two modes at frequencies f i and f j in one signal e g c y interact to produce other modes at frequency f i f j or f i f j in another signal e g c d c y and c d are said to be quadratically phase coupled here we call f i and f j as the parent modes modes at f i f j and f i f j are the combined modes we compute cross bispectrum represented as b y y d for hydrodynamic coefficients it is defined as 6 b y y d lim t 1 t e x d f 1 f 2 x y f 1 x y f 2 where x f denotes the fourier spectra of a signal and x f shows its complex conjugate if value of b y y d is large through the statistical averaging process it shows strong quadratic phase coupling between c y and c d if it has a value nearly equal to zero there exists no phase coupling between these two signals and the signals will be uncorrelated in quadratic sense as afore mentioned for hydrodynamic coefficients of single fish for all st considered here we see a strong quadratic coupling for both the drag and thrust producing regimes we present cross bispectra between c y and c d of a single fish undulating at st 0 40 and 0 80 in fig 6 a and b respectively we see that at lower st b y y d has low order of magnitude but strong enough to show quadratic phase coupling between hydrodynamic forces as we increase st this quadratic interaction also becomes stronger in all the cases interaction of harmonic components at f 1 in c y results in 2 f 1 frequency in c d we also compute cross bispectra for c y and c d of both the upstream and the downstream fish in tandem configuration for a range of st as a representative case we present cross bispectra for hydrodynamic force coefficients of the upstream and downstream fish in fig 7 a and b respectively at st 0 80 and l x 1 75 for the upstream fish harmonic components at the oscillation frequency f 1 in c y interact with each other resulting in 2 f 1 component in c d but in case of the downstream fish we observe a range of frequency components coupling with each other to produce new components these newly produced components also include harmonics at f 1 f 2 and f 1 f 2 it indicates that these two fish undulating in tandem configuration have strong quadratic interaction with each other 4 discussion 4 1 spatial symmetry of wake modes previous studies mansy and williams 1991 williams et al 1992 kim and williams 2006 found certain symmetry rules for wakes of stationary and oscillating cylinders these symmetry principles follow the quadratic interaction of modes in the wake for generation of unsteady forces according to these symmetry principles a combined mode will be symmetric if its parent modes are similar i e both are symmetric or antisymmetric if two dissimilar modes interact with each other the resultant combined mode will be antisymmetric we check the applicability of these rules on the wakes produced by single fish and two fish in tandem performing traveling wave like motion our study also provides insight about the combined modes for both drag and thrust producing wakes for this purpose we compute and record temporal variations in the horizontal velocity at 21 locations symmetrically distributed about the y 0 axis along a vertical line in the wake as shown in fig 8 we then decompose these velocity signals into their odd and even components marasli et al 1989 used this technique to show agreement between the linear instability theory and varicose mode of instability for a plain turbulent wake in hydrodynamic stability theory sinuous modes at fundamental frequencies are antisymmetric while varicose modes at frequencies of first harmonics are symmetric sato 1970 a series of time varying signals may be decomposed into its odd and even parts about a certain symmetry axis or point in the present case of fish swimming we define these odd and even components as follows kim and williams 2006 7 γ f y i γ o d d f y i γ e v e n f y i γ o d d f y i γ f y i γ f y i 2 γ e v e n f y i γ f y i γ f y i 2 where γ f y i indicates complex fourier transform of velocity signal at location y i to observe the symmetry properties of a mode at any frequency f we compute energy in the odd and even components using the following integral quantities 8 o f i 1 n γ o d d f y i γ o d d f y i δ y e f i 1 n γ e v e n f y i γ e v e n f y i δ y where n denotes the total number of points where we compute the fluctuations in the wake γ represents the complex conjugate the fourier transform we define a ratio o e to compute relative energy of modes if o e becomes less than one symmetric varicose mode is dominant while antisymmetric odd mode is relatively stronger for o e greater than one fig 9 shows the spatial distribution of amplitude γ and phase ψ for original velocity fluctuations and their even and odd components we report these quantities for the velocity fluctuations computed along a vertical axis at a distance of 0 375 l from the trailing edge of the single fish for fundamental vortex shedding frequency f and its second harmonic at 3 f odd mode is more dominant and its amplitudes almost match those for the original while energy in the even modes is minimal energy in the even components is nearly equal to that of the original while in the odd component the energy has very small amplitudes for first harmonic at 2 f we compute o e for these three modes and present their values in table 1 we find that fundamental and its second harmonic modes are antisymmetric modes with o e equal to 598 4054 and 216 9661 respectively while first harmonic at 2 f is a symmetric mode with o e 0 0139 these observations are consistent with those for a flat plate sato 1970 stationary cylinder mansy and williams 1991 williams et al 1992 and oscillating cylinder kim and williams 2006 a symmetric mode at 2 f results from the coupling of the anti symmetric forcing or vortex shedding mode at f with itself similarly interaction of anti symmetric fundamental mode with symmetric mode at 2 f results in formation of an anti symmetric odd mode at 3 f in phase plots of fig 9 we observe a phase shift of 180 for fundamental mode at the point lying on y 0 axis that is a property of antisymmetric mode kim and williams 2006 similarly nearly 180 phase shift can also be seen for odd component of the mode at 3 f for mode at 2 f transition along y 0 axis is smooth but at y l 0 15 there is a shift of nearly 120 in the even component for symmetric wakes of circular cylinders kim et al kim and williams 2006 observed a phase shift of 90 a higher phase shift can be justified due to the formation of vortices having asymmetric shape khalid et al 2016 about the y 0 axis in case of undulating fish phase of dominated modes show fluctuating behavior for all the frequencies table 1 also shows o e values for st 0 80 where thrust is produced we find that the wake with reverse von karman vortex street also follows the afore mentioned symmetry rules for st 0 80 contribution by odd component in the energy of forcing mode has tremendously increased than that for st 0 40 it confirms the general nature of the principles used to define symmetry of the combined modes in the wakes of single bluff or hydrodynamic bodies when fish start swimming in tandem configuration they affect each other s hydrodynamic performance through wake body interaction in our earlier study khalid et al 2016 we quantified the effect of l x on the hydrodynamic performance of both the upstream and the downstream fish it was concluded that the hydrodynamic performance of the upstream fish had been almost independent of the undulation frequency of the rear fish moreover the drafting effect was observed to be negligible for l x 3 in our current study we have both the fish having equal body lengths considering a mother calf model tian et al 2016 quantified the hydrodynamic performance of both the larger and smaller fish for a range of parameters however saadat et al 2017 argued that the strouhal numbers and the tail beat amplitudes nondimensionalized by the body length were the governing parameters for swimming performance of fish and other aquatic species in the region between these two fish for smaller l x transitional wake may be expected for higher l x wake establishes itself before interacting with the downstream body we apply the symmetry rules on these wakes as well we show amplitudes and phase of original velocity fluctuations and their odd and even components for wake of upstream fish for st 0 40 in fig 10 we consider modes at f 1 and f 2 as the parent modes because these represent the forcing frequencies of the upstream and the downstream fish respectively vortex shedding also occurs with these frequencies in the respective wake of two fish as given in table 2 for the upstream fish these modes have energy ratios of 528 02 and 301 04 odd components are also dominant in their respective amplitude plots that proves their anti symmetric nature these two modes also interact to produce combined difference and sum modes at f 1 f 2 and f 1 f 2 having o e 0 1676 and 1 1624 respectively symmetric nature of the difference mode is in agreement with the symmetry rules but antisymmetric sum mode shows an anomaly we also notice that production of 2 f 2 mode does not follow these principles however the mode at 2 f 1 does for downstream fish parent modes are antisymmetric in their nature and all of the combined modes are symmetric having see fig 11 o e 1 table 2 also provides the relative energy ratio for these modes at st 0 80 at this st both fish experience thrust force due to formation of reverse von karman vortex street in their respective wakes in this case we find anomalies for a combined modes at 2 f 2 in the wake of upstream fish and at 2 f 1 for rear fish except these modes all other combined modes are symmetric as they are produced by the interaction of antisymmetric parent modes at f 1 and f 2 4 2 proper orthogonal decomposition we also analyze symmetry of the wake modes through decomposition of velocity data into spatial and temporal part using a technique known as proper orthogonal decomposition pod for this purpose velocity data can be approximated through galerkin expansion of the form 9 u x t i 1 m ϕ i x q i t we take snapshots at different time instances t 1 t 2 t n 0 t and ensemble these snapshots into a larger matrix we consider ensemble of snapshots as 10 w span u t 1 u t 2 u t n the dimensions of w is n d s where n is the number of time steps and d s is the number of probes the pod seeks a low dimensional modes φ 1 φ 2 φ m with m d s which optimally approximates the input matrix w as 11 min φ j 1 n i 1 n u t i j 1 m u t i φ j ℋ φ j ℋ 2 subjected to the condition φ i φ j ℋ δ i j 1 i j m let the time step δ t t n 1 and the time instances t k k δ t k 1 2 n we compute the pod modes using singular value decomposition svd as w s σ v t where s σ and v contain the pod modes singular values of w and eigenvectors of w respectively we also project each snapshot onto the pod modes to compute the temporal coefficient q i t referred to as the velocity coefficients as q i t ϕ i x u x t d x we present the validation of our pod technique by approximating the horizontal velocity at three probes located at symmetry axis y 0 and on its upper and lower sides in the wake of a single fish undulating at st 0 40 we present this comparison in fig 12 it shows accuracy of the currently employed decomposition procedure for flow features around the undulating fish to compare our results for the wake modes through pod and traditional symmetry principles we use velocity data in the wake of single fish at st 0 40 and two fish in tandem configuration at st 0 80 γ 0 75 and l x 1 50 to construct w matrix for the wake of a single fish we consider velocity date for 10 oscillation cycles and collect 1600 snapshots we project the pod modes onto the snapshots matrix and compute temporal coefficients q i where i 1 2 6 fig 13 shows power spectra of these q s dominant frequency in power spectra of q 1 and q 3 is f while that for q 2 q 4 and q 6 is 2 f 3 f is the most dominant frequency in the power spectrum of q 5 next we plot the spatial distribution of respective ϕ s it is evident that mode shapes ϕ 1 and ϕ 3 having frequency f are anti symmetric about y 0 axis ϕ 2 ϕ 4 and ϕ 6 with frequency 2 f show symmetric distribution while mode ϕ 5 with frequency 3 f is anti symmetric these results are consistent with our findings tabulated in table 1 for the wake modes of the upstream fish in tandem configuration we consider 16 oscillation cycles and collect 2560 snapshots we compute first eight pod modes using snapshot matrix and also temporal coefficients q i i 1 2 8 by projecting the snapshots data onto the pod modes fig 14 presents mode shapes ϕ s for both the upstream and the rear fish for the upstream fish dominant frequency spectra not shown here of q 1 and q 3 is f 1 2 hz other dominant frequencies in power spectra are 2 f 1 for q 2 q 4 and q 6 f 2 for q 5 and q 7 f 1 f 2 for q 8 we notice that wake modes ϕ 1 and ϕ 3 with frequency f 1 are anti symmetric ϕ 5 and ϕ 7 with frequency f 2 are anti symmetric ϕ 2 ϕ 4 and ϕ 6 having 2 f 2 are symmetric and ϕ 8 with frequency f 1 f 2 is almost symmetric about y 0 line for velocities in the wake of rear fish we observe that mode shapes ϕ 1 ϕ 3 and ϕ 7 with corresponding q s having dominant frequency at 2 f 2 3 0 hz are symmetric ϕ 2 and ϕ 5 are antisymmetric in their nature while q 1 and q 5 oscillate with most powerful harmonic at f 2 1 5 hz temporal coefficient q 8 carries the most energetic frequency component at f 1 2 hz and ϕ 8 is antisymmetric we observe an anomaly for f 1 f 2 frequency here in case of mode shape ϕ 4 according to the symmetry principles it should be symmetric as also shown in table 2 these investigation clearly show the validity of traditional symmetry principles not only for drag producing wake but also for thrust producing wakes we also observe few contradictions to these symmetry principles in the results obtained through pod in case of tandem fish which may originate due to complex wake body interaction 4 3 energy in parent and combined modes although coupling of the parent modes does not assure the transfer of energy between these modes yet it is interesting to see the variation in their respective spectral energy levels as the present study is motivated from ref kim and williams 2006 we discuss the trend in energy levels for various modes of lateral side and drag forces fig 15 presents the variation in energy of fundamental mode and its first and second harmonics in the wake of the single fish for a range of st as expected energy of the fundamental vortex shedding forcing mode and its second harmonic enhances smoothly with increasing st even mode at 2 f gets minimal energy for st 0 20 and starts increasing but its trend is not as smooth as for other harmonics these plots show that higher forcing frequency channel more energy in the fundamental modes and then its interaction with itself generate mode at 2 f interaction of f and 2 f produce the second harmonic at 3 f due to their high energy magnitudes for larger st the mode at 3 f also carries more energy we also show variations in energy of the parent and the combined modes in the wakes of the upstream and the downstream fish in figs 16 and 17 respectively we plot these energy levels as a function of the nondimensional distance between the leading edges of the two fish we compute magnitude of the spectral energy for the parent modes using c y spectra and we use c d spectra for energy of the combined modes as l x increases energy of the vortex shedding or forcing mode for the upstream fish decreases and gets saturated for l x 2 0 we observe a similar trend in the modal energy in the wake of the upstream fish caused by the forcing of the rear fish combined modes have lower energy magnitudes but variations are visible in these cases too difference mode at frequency f 1 f 2 carries same amount of energy for almost the whole range of l x and remains saturated except l x 2 00 sum mode at f 1 f 2 gets increasing energy levels for most of values in l x hence for upstream fish the parent modes and difference mode saturates or keep their energy levels same in fig 17 we observe decreasing trend of the energy levels in the wake of the rear fish for all the modes with increasing l x small fluctuations are observed in the forcing mode at f 2 the parent mode at f 1 and the difference mode achieves a steady state value for l x 3 0 based on these measurements it may be stated that the sum mode in the region between two fish absorbs energy from both the forcing modes at f 1 and f 2 despite an increasing distance between the fish bodies this absorption of energy at the sum mode may cause inverted drafting where the upstream fish takes advantage of the rear fish and it experiences lesser drag than that of a single fish swimming in same free stream with similar kinematics ristroph and zhang 2008 the tendency of absorbing energy in the combined modes in the wake of the rear fish seems deteriorating with increasing l x because the vortices emerging from trailing edge of the upstream fish dissipate while traversing greater distance before they transfer energy to the upstream fish 5 conclusions using immersed boundary method we numerically solve incompressible navier stokes equations for flow over single fish and two fish in tandem we keep different phase speeds of upstream and downstream fish so that contribution of various harmonic components may be distinguished in fourier spectra in case of flow over single fish we find that c y contains the fundamental harmonic and its odd harmonics where vortex shedding occurs at the forcing frequency for undulatory fish motion even harmonics exist in c d spectra it means that frequency of c d is double the frequency of c y we perform higher order spectral analysis to find the strength of quadratic phase coupling between c y and c d for the whole range of strouhal number considered presently magnitudes of the cross bispectrum between c y and c d are very high for tandem configuration c y of upstream fish carries a harmonic at f 2 with minimal strength along with stronger component at f 1 but we do not observe a harmonic at 2 f 2 in its c d but hydrodynamic coefficients of the downstream fish has prominent harmonics at f 1 and 2 f 1 along with those at f 2 and 2 f 2 hence quadratic coupling between two forcing frequencies is weaker in the wake of upstream fish b y y d has large values due to strong interaction of f 1 and f 2 in the vicinity of downstream fish quadratic nonlinear interaction of parent modes at forcing frequencies f 1 and f 2 produce combined modes with sum or difference of those frequencies f 1 f 2 or f 1 f 2 we apply the symmetry principles defined in literature for the wakes of bluff bodies here we find that those principles are also applicable to the drag or thrust producing wake behind undulating fish we also employ proper orthogonal decomposition technique to approximate the velocity data in the wake of swimming fish and to obtain the pod modes we conclude that information related symmetric asymmetric nature of pod modes is in agreement with that obtained from the application of conventional symmetry principles we also show that some anomalies exist for wakes of upstream and downstream fish while swimming in tandem formation it may occur due to complex vortex body interaction in the vicinity of undulating fish acknowledgments dr khalid is thankful to the higher education commission government of pakistan to provide funding for the presented research under international research support initiative program irsip dr dong would like to acknowledge the support from the office of naval research onr muri grant n00014 14 1 0533 and the national science foundation grant cbet 1313217 
23421,the purpose of the present study is the investigation of the hydrodynamic interactions induced by arrays of elliptical cylinders subjected to regular waves the solution methodology employs linear potential theory and is based on pure analytic considerations the interaction phenomena are approached using the mathieu functions addition theorem which converts elliptical harmonics from one elliptic coordinate system to a remote elliptic coordinate system the followed approach resembles the direct solution methodology which is used for the analytical solution of the diffraction problem by arrays of circular cylinders the direct approach allows among others the construction of a linear matrix equation for the calculation of the expansion coefficients of the diffraction component s which accordingly is used to trace the wavenumber s under which trapped modes may be stimulated to induce wave trapping in the array and reduction of the energy radiated to the far field the numerous computations which are performed specifically verify that any array of elliptical cylinders in accord with arrays of circular cylinders is potentially a wave trapping configuration which is connected mainly i with sharp amplifications in all modes of hydrodynamic loading both forces and moments and ii strong free surface elevations in the liquid regions between the cylinders and on the cylinders surfaces accordingly keywords diffraction trapping and near trapping effects elliptical cylinder arrays mathieu functions addition theorem 1 introduction when arrays of multiple bodies are subject to incident waves very interesting hydrodynamic phenomena arise multi body arrangements subjected to the action of propagating waves induce by default continuous reflections of the incoming waves yielding intriguing phenomena such as rather complicated variations of the hydrodynamic loading and hydrodynamic resonances which are reflected as peaks in loading and strong free surface elevations between the cylinders and also on the wetted surfaces of the bodies with regard to the former the complications in hydrodynamic loading are caused mainly because additional parameters are incorporated into the problem namely the number arrangement orientation and size s of the bodies in connection with the water depth as far as the hydrodynamic resonances are concerned these are also due to the hydrodynamic interactions and they are encountered when the geometry of the arrangement allows open liquid spaces between the bodies those effects are commonly referred as trapped and near trapped modes and they are detected at specific wavenumbers which eventually depend on all parameters involved in the problem such problems have been considered by researchers for several decades indeed multi body arrangements are detected in a series of engineering designs for example sea bridges piers are an array of usually circular bodies another application is floating islands that are designed as plates supported above the water surface by many floating bodies and are used for example as airports the most common example is however the columns of tension leg or bottom seated offshore structures these multi column platforms can exhibit extreme wave loading also due to the occurrence of trapped modes furthermore the increased surface elevation that is also very often associated with trapped modes can lead to the damage of the lower deck of such structures due to a false air gap design these effects have been also observed experimentally see for example swan et al 1997 on the other hand wave trapping is by all means not always something we need to avoid for example the energy that multi body configurations can trap in certain cases while interacting with surface waves can be exploited by wave power devices in order to increase their productiveness and efficiency any geometry or arrangement that creates a liquid space between walls i e surfaces where a neumann condition applies is a potentially trapped mode structure a notable single body geometry that induces trapped modes is the elliptical torus mciver and porter 2002 which is referred often as the mciver toroid newman 1999 a circular toroidal structure approximated by ring elements was investigated by mavrakos 1997 who reported the existence of peaks in the transfer functions of both the exciting forces and the hydrodynamic coefficients other examples of wave trapping structural arrangements are the moonpools which were examined for instance by molin 2001 and mavrakos and chatjigeorgiou 2009 clearly wave trapping may also be induced by multi body arrangements in that respect the only geometry that has been considered at least analytically is that of the circular cylinder arrays of cylinders have been studied by several authors without focusing always on wave trapping phenomena in that respect the proper methodology known as the direct method was first derived by záviška 1913 and was rediscovered by spring and monkmeyer 1974 mingde and yu 1987 literally re employed spring and monkmeyer s 1974 approach for a pair of bottom seated cylinders mciver and evans 1984 based their work on the study of simon 1982 they used an approximated method assuming large spacing between the cylinders and reported favourable agreement with the results presented by spring and monkmeyer 1974 linton and evans 1990 elaborated the method further by introducing the linear system that provides the unknown expansion coefficients of the diffraction potential s into the formulae of the potential s yielding an elegant compact form the hydrodynamics of arrays of cylinders have been also studied through an alternative approach known as the method of multiple scattering the foundations of which were provided by twersky 1952 in hydrodynamics it was first employed by ohkusu 1974 examples of studies by this method are those due to kagemoto and yue 1986 who employed the physical idea of ohkusu 1974 but algebraically used simon s 1982 matrix formulation and the works of mavrakos and koumoutsakos 1987 kagemoto and yue 1993 mavrakos and kalofonos 1997 yilmaz and incecik 1998 yilmaz 2004 and child and venugopal 2010 evans and porter 1997a 1999 as well as meylan and eatock taylor 2009 investigated possible trapping and near trapping effects by means of the method of linton and evans 1990 maniar and newman 1997 based a great part of their study on the wave trapping by a long array of cylinders nine in particular on the concerned direct method as well evans and porter 1997b extended their efforts to trace possible trapped modes in multiple cylinders in a channel wave trapping effects in arrays of cylinders under random wave spectra were investigated by walker and eatock taylor 2005 and grice et al 2013 while malenica et al 1999 extended the investigation on wave trapping for an array of equally spaced identical circular cylinders to second order in wave steepness the wave trapping by an array of truncated cylinders was considered by siddorn and eatock taylor 2008 and wolgamot et al 2015 independently of the theoretical studies the fact that wave trapping may occur in multi body arrangements was observed in laboratory experiments by ohl et al 2001 the above discussion evinces that wave trapping effects by arrays of circular cylinders using analytical models are well treated in the literature admittedly the same does not hold for different geometries such for example multiple elliptical cylinders although it should be mentioned that for more complex geometries such as multi column gravity platforms semisubmersibles or tension leg platforms and other trapping structures numerical diffraction codes have been employed by several researchers the development of an analytical solution methodology for the water wave diffraction problem by arrays of elliptical cylinders and accordingly the investigation of potential wave trapping phenomena is feasible due to the existence of separable solutions of the laplace equation in elliptic coordinates however relevant studies are scarce in the literature and mostly concern isolated bodies chen and mei 1971 solved the scattering and radiation problems of water waves by a bottom seated surface piercing elliptical cylinder using the separable solutions of the laplace equation later on chen and mei 1973 investigated the hydrodynamic loading on a stationary platform of elliptical shape partially immersed in the free surface williams 1985a presented two approximate solutions to the scattering problem one based on the extension of the exact solution of chen and mei 1971 for small values of the elliptic eccentricity the other based on the integral equation technique involving the application of green s theorem the same author williams 1985b extended his method to include the case of a submerged elliptical structure resting on the sea bed williams and darwiche 1988 1990 used exact solutions to investigate respectively the scattering and radiation problems by truncated elliptical cylinders while zhang and williams 1996a 1996b tackled the same problems by a fully submerged elliptical disk the hydrodynamic interactions by arrays of elliptical cylinders were first considered by chatjigeorgiou and mavrakos 2010 who achieved an analytical solution by employing the so called addition theorem for mathieu functions numerical results for the exciting forces were presented only for a pair of cylinders accordingly chatjigeorgiou 2011 presented an analytical solution for groups of elliptical and circular cylinders while in the later study of chatjigeorgiou 2013 the methodology was enhanced to account for cylinders truncation chatjigeorgiou and mavrakos 2010 results were accordingly used by chen and lee 2012 to validate their own calculations obtained via a boundary integral equation approach the same numerical approach was used to trace near trapping occurrences induced by arrays of four cylinders chen and lee 2013 the primary task of the present study is the investigation of the wave trapping phenomena due to the hydrodynamic interactions by arrays of elliptical cylinders the boundary value problem defined by multi body arrangements is further elaborated to provide compact elegant formulae for the potential and all hydrodynamic loading components i e surge sway forces roll pitch and yaw moments three different arrays are considered composed by four five and nine cylinders respectively in the latter case two different orientations of the semimajor axes relatively to the wave propagation were considered one perpendicular and one collinear attention is paid to situations of in phase and out of phase loading which may occur in cases of specific orientations in terms of the direction of the incoming waves special consideration is given to wave trapping phenomena and their correlation with peaks in hydrodynamic loading and strong free surface elevations in the open liquid space between the elliptical cylinders in critical wavenumbers the occurrence of the trapped modes is verified through the homogeneous solution of the linear matrix equation that is constructed to provide the even and odd expansion coefficients of the components of the diffraction potential s 2 the hydrodynamic problem a group of elliptical cylinders which are fixed on the bottom and exceed the free surface is considered the array is subjected to the action of regular waves of amplitude a and circular frequency ω the bottom is considered flat and horizontal while the water depth is equal to h the fluid is inviscid and incompressible and the flow irrotational allowing the use of the linear potential theory the flow field in the three dimensional euclidean space is governed by the linear velocity potential φ x y z t which is written as 1 φ x y z t r e ϕ x y z e i ω t where r e denotes the real part of component in the brackets and t is time as usual the spatial complex potential ϕ x y z should satisfy the laplace equation 2 2 ϕ 0 everywhere in the fluid domain the linearized free surface boundary condition 3 k ϕ ϕ z 0 z h and the zero velocity condition on the bottom 4 ϕ z 0 z 0 in eq 3 k ω 2 g where g is the gravitational acceleration clearly the x y z coordinate system has been assumed fixed on the bottom with the vertical z coordinate pointing upwards the total velocity potential should satisfy the neumann condition on the surfaces of all bodies in the array i e 5 ϕ n 0 where n denotes the unit normal on the surface of each body here the convention is made that n is directed into the liquid domain within the realm of the linear hydrodynamic problem we can assume that the total velocity potential is composed by the incident wave and the diffraction components coined in the sequel as ϕ i and ϕ d accordingly it is understood that the diffraction potential should satisfy the proper radiation condition for outgoing waves at infinity sommerfeld condition 6 lim r r 1 2 r i k 0 ϕ d 0 where r x 2 y 2 and k 0 is the wavenumber 3 solution in terms of elliptical harmonics in order to make the present study self contained we start from the very beginning namely the separable solutions of the laplace equation in elliptic coordinates the products of these solutions are called harmonics and in this particular case elliptical harmonics details on elliptical harmonics their properties and their use can be found in the books of mclachlan 1947 and meixner and schäfke 1954 summaries are contained in the handbooks of abramowitz and stegun 1970 and olver et al 2010 while moon and spencer 1971 provide only elementary information the main goal of using solutions of the laplace equation adapted to an elliptic coordinate system is the easiness of employing the neumann boundary condition mavrakos and chatjigeorgiou 2009 let us start from the transformation between the cartesian x y z and elliptic cylindrical or simply elliptic coordinates u v z this is 7 x c cosh u cos v y c sinh u sin v z z where u constant v constant are orthogonally intersecting families of confocal ellipses and hyperbolae respectively while c is the half distance between the foci the laplace equation in elliptic coordinates takes the form moon and spencer 1971 8 2 c 2 cosh 2 u cos 2 v 2 ϕ u 2 2 ϕ v 2 2 ϕ z 2 0 there are two types of separable solutions of the laplace equation in elliptic coordinates namely the even and the odd solutions which are written herein as 9 ϕ m n c u v z c m n m c m j u q n c e m v q n z n z 10 ϕ m n s u v z s m n m s m j u q n s e m v q n z n z where q n is the so called mathieu parameter which is associated with the eigenvalues of the separable solutions z n z in z further c e m v q n and s e m v q n are the even and the odd periodic mathieu functions respectively where m ℕ is a nonnegative integer likewise m c m j u q and m s m j u q denote the even and the odd modified or radial mathieu functions m c m j u q and m s m j u q for j 1 2 3 4 mathieu 1868 the indices m and j denote the order and the kind of the modified mathieu functions in fact the modified mathieu functions for j 1 2 3 4 are expressed as infinite expansions of bessel functions j and y and hankel functions h 1 and h 2 analytic relations for the periodic and the modified mathieu functions for a positive mathieu parameter are given in appendix a of the present it is noted herein that there is a general disagreement in the admittedly limited literature as regards the notations used for the separation constants and the modified mathieu functions this remark refers to all known books that treat the concerned special functions mclachlan 1947 meixner and schäfke 1954 abramowitz and stegun 1970 olver et al 2010 erdélyi et al 1955 strutt 1932 whittaker and watson 1927 throughout this paper we will use the notations adopted by abramowitz and stegun 1970 in particular it holds that 11 m c m 3 4 u q n m c m 1 u q n i m c m 2 u q n m s m 3 4 u q n m s m 1 u q n i m s m 2 u q n where the minus sign corresponds to the mathieu functions of the fourth kind finally c m n and s m n in eqs 9 and 10 denote arbitrary constants coefficients associated with the order m and the eigenvalues n the eigenfunctions z n z which satisfy the bottom and the free surface boundary conditions of eqs 3 and 4 are given by 12 z n z n 0 1 2 cosh k 0 z n 0 n n 1 2 cos a n z n 1 2 3 where 13 n n 1 2 1 sinh 2 k 0 h 2 k 0 h n 0 1 2 1 sin 2 α n h 2 α n h n 1 2 3 the wavenumber k 0 is obtained by the celebrated linear dispersion relation for finite water depth 14 k 0 tanh k 0 h k while the eigenvalues a n are the solutions of the transcendental formula 15 a n tan a n h k 0 n 1 2 3 using the convention a 0 i k 0 we are allowed to use a uniform notation for all possible eigensolutions it is noted that the eigenfunctions z n z have been properly normalized in order to satisfy the convenient relation of orthogonality 0 h z n z z m z d z h δ n m where δ n m is the kroneker s delta function subsequently the mathieu parameters q n in eqs 9 11 associated with the eigenvalues a n will be given by 16 q 0 k 0 c 2 2 q n α n c 2 2 n 1 2 3 and we note that for n 1 2 3 they are all negative when the mathieu parameter is negative the computation of the modified mathieu functions should be done with special care in the present study this case will not be encountered and therefore for the special formulae that provide the modified mathieu functions for negative parameters we refer the reader to equation 20 8 8 20 8 11 of abramowitz and stegun 1970 4 general formulations for the diffraction and the incident wave potentials let us assume that the incident wave propagates at angle β relatively to the horizontal x axis in the x y plane accordingly the incident wave potential will be given by 17 ϕ i i g a ω z 0 z z 0 h e i k 0 x cos β y sin β in order to express eq 17 in terms of elliptic coordinates we must transform the involved exponential term we note that exp i k 0 x cos β y sin β exp 2 i q 0 w where w cosh u cos v cos β sinh u sin v sin β next we arbitrarily define 18 e 2 i q 0 w m 0 f m c e m v q 0 m 1 f m s e m v q 0 use of the orthogonality relations satisfied by the periodic mathieu functions see appendix a immediately yields 19 f m 1 π 0 2 π e 2 i q 0 w c e m v q 0 d v f m 1 π 0 2 π e 2 i q 0 w s e m v q 0 d v it also holds that see abramowitz and stegun 1970 p 738 equation 20 7 34 20 7 35 20 0 2 π e 2 i q 0 w c e m v q 0 d v 2 π 1 s i p c e m β q 0 m c m 1 u q 0 0 2 π e 2 i q 0 w s e m v q 0 d v 2 π 1 s i p s e m β q 0 m s m 1 u q 0 with m 2 s p p 0 1 thus by substituting eqs 18 20 into eq 17 we can transform the incident wave potential into elliptic coordinates according to 21 ϕ i u v z 2 i g a ω z 0 z z 0 h m 0 i m m c m 1 u q 0 c e m v q 0 c e m β q 0 m 1 i m m s m 1 u q 0 s e m v q 0 s e m β q 0 the next step is to effectively determine the diffraction potential which should be constructed by means of the linear superposition of elliptical harmonics hence we can write 22 ϕ d u v z i ω a h m 0 n 0 ϕ m n c m 1 n 0 ϕ m n s i ω a h m 0 n 0 c m n m c m j u q n c e m v q n z n z m 1 n 0 s m n m s m j u q n s e m v q n z n z in this study we consider the special case of bottom seated elliptical cylinders hence in accord with the datum of the circular cylinders case only the zeroth order eigenfunction z 0 z shall participate in the solution in fact this is proven by applying the neumann condition along the complete height of the cylinder in the interval 0 z h nevertheless this is used as a fact from the beginning in order to simplify the notations of the analysis that follows in addition the diffraction potential should satisfy the radiation condition of eq 6 which in elliptical coordinates is transformed into 23 lim u c cosh u 1 2 1 c sinh u u i k 0 ϕ d 0 it turns out that only the modified mathieu functions of the third kind are well behaved at infinity and accordingly the diffraction potential is simplified further admitting the following form 24 ϕ d u v z i ω a h z 0 z m 0 c m m c m 3 u q 0 c e m v q 0 m 1 s m m s m 3 u q 0 s e m v q 0 5 hydrodynamic interactions by arrays of multiple elliptical cylinders let us now assume a group of n elliptical cylinders which are all subjected to the action of monochromatic incident waves with the obvious consequence of inducing hydrodynamic interactions between each other hence each cylinder is affected by the incident waves as well as the waves radiated by the rest of the cylinders in the array let us further assume a global coordinate system x y set on the free surface and accordingly determine the angle of propagation β as the angle which is formed between the direction of the regular propagating waves and the horizontal axis x the centre of each cylinder k 1 2 n is situated at the point x k y k with respect to the global system x y if x k y k defines the plane of the free surface with respect to the local cartesian coordinate system fixed on the centre of the body k then the ambient potential of eqs 17 and 21 expressed with respect to the same system will be given by 25 ϕ i 2 i g a ω z 0 z z 0 h λ k m 0 i m m c m 1 u q k c e m v q k c e m β q k m 1 i m m s m 1 u q k s e m v q k s e m β q k λ k e i k 0 x k cos β y k sin β where q k k 0 c k 2 2 denotes the zeroth order mathieu parameter associated with the dimensions of the body k and c k a k 2 b k 2 1 2 ε k a k is the half distance between the foci of the cylinder k while a k b k and ε k denote respectively the semimajor and semiminor axes and the elliptic eccentricity of the elliptical cylinder k the diffraction potential of body k is now denoted by ϕ d k this will be expressed with respect to the local coordinate system x k y k z z is common for all bodies or equivalently with respect to the local elliptic coordinate system u k v k z hence we can write 26 ϕ d k u k v k z 2 i g a ω z 0 z z 0 h m 0 i m c m k k c m k m c m 3 u k q k c e m v k q k m 1 i m s m k k s m k m s m 3 u k q k s e m v k q k where c m k and s m k denote the unknown expansion coefficients associated with the body k and 27 k c m k m c m 1 u k 0 q k m c m 3 u k 0 q k k s m k m s m 1 u k 0 q k m s m 3 u k 0 q k in which u k 0 tanh 1 b k a k denotes the elliptical boundary of the body k the primes denote differentiation with respect to u the total velocity potential that consists of the ambient potential and the diffraction components by all bodies in the array will be given by their linear superposition we chose to write it as 28 ϕ ϕ i ϕ d k j k n ϕ d j we can assume that ϕ i is given by eq 25 assuming further that ϕ d k ϕ d j are given using eq 26 we obtain an equation in which we have the incident wave and the diffraction potential induced by the reference body k being expressed with respect to the local coordinate system u k v k z while all the other diffraction components ϕ d j j 1 2 n j k are expressed with respect to different local coordinate systems u j v j z the main challenge therefore is to transform properly ϕ d j in order to be expressed with respect to u k v k z that would allow describing the total velocity potential with respect to a single coordinate system and immediately employ the neumann condition which is now written as 29 ϕ k u k 0 u k u k 0 0 v k 2 π 0 z h where ϕ k is the total velocity potential given with respect to u k v k z indeed we can find an appropriate expression to write ϕ d j as a function of u k v k z to this end we must use the so called addition theorem for mathieu functions and in particular the addition theorem which interchanges elliptical coordinate systems addition theorems provide important connections between mathieu functions with different parameters and in different coordinate systems they are analogous to the addition theorems for bessel functions e g graf s gegenbauer s and neumann s theorems it appears that they have been considered only by meixner and schäfke 1954 see also schäfke 1953 surprisingly mclahlan 1947 has no information while the resent nist handbook by olver et al 2010 refers the reader to the book of meixner and schäfke 1954 and the lecture notes due to meixner et al 1980 særmark 1959 developed an addition theorem alternative to that shown by meixner and schäfke 1954 which admittedly is much easier and comprehensible to use a review on the addition theorems for the transformation of harmonics between various coordinate systems can be found in the book of martin 2006 with reference to fig 1 særmark s 1959 formula reads 30 m m l u j q j m e m v j q j r q r m l m r 1 u k q k m e r v k q k l 1 2 3 4 with 31 q r m l s p d r p p q k z p s l k 0 r j k d s m m q j e i s p ψ j k e i s β j k l 1 2 3 4 and 32 z m 1 k 0 r j k j m k 0 r j k z m 2 k 0 r j k y m k 0 r j k z m 3 k 0 r j k h m 1 k 0 r j k z m 4 k 0 r j k h m 2 k 0 r j k note that j m y m denote the bessel functions of the first and the second kind respectively while h m 1 2 k 0 r j k are the hankel functions again of the first and the second kind in eq 30 m m l and m e m denote the global notation of the modified and the periodic mathieu functions which incorporate both even and odd counterparts the interrelations between those and the even and odd mathieu functions are given in appendix a of the present in addition the coefficients d n p q and d n p q in eq 31 are associated with the expansion coefficients of the periodic mathieu functions m e m their connections with the expansion coefficients of the even and odd periodic mathieu functions are also given in appendix a as noted by særmark 1959 the addition theorem eq 30 will be valid outside a circle with centre at b and r j c j a j ε j but inside the circle with centre at a and r k r j k this region is shown in fig 1 we are particularly interested only in the modified mathieu functions of the third kind i e for l 3 in eqs 30 and 31 the associated addition theorem can be effectively split into even and odd terms according to 33 m c m 3 u j q j c e m v j q j r 0 q r m 3 m c r 1 u k q k c e r v k q k i r 1 1 r q r m 3 m s r 1 u k q k s e r v k q k 34 m s m 3 u j q j s e m v j q j i 1 m r 0 q r m 3 m c r 1 u k q k c e r v k q k r 1 1 m r q r m 3 m s r 1 u k q k s e r v k q k next using eqs 25 26 28 33 and 34 we obtain the following analytic form for the total velocity potential in normalized form according to ϕ k 2 i g a ω z 0 z z 0 h φ k 35 φ k λ k m 0 i m m c m 1 u q k c e m v q k c e m β q k m 1 i m m s m 1 u q k s e m v q k s e m β q k m 0 i m c m k k c m k m c m 3 u k q k c e m v k q k m 1 i m s m k k s m k m s m 3 u k q k s e m v k q k j k n m 0 i m c m j k c m j r 0 q r m 3 m c r 1 u k q k c e r v k q k i r 1 1 r q r m 3 m s r 1 u k q k s e r v k q k j k n m 0 i m s m j k s m j i 1 m r 0 q r m 3 m c r 1 u k q k c e r v k q k r 1 1 m r q r m 3 m s r 1 u k q k s e r v k q k using further the neumann condition eq 29 and employing the orthogonality relations of the periodic mathieu functions see appendix a the following linear system in terms of the unknown expansion coefficients c m j and s m j j 1 2 n immediately yields 36 c m k j k n r 0 i r m c r j k c r j q m r 3 i j k n r 1 i r m 1 r s r j k s r j q m r 3 λ k c e m β q k 37 s m k i 1 m j k n r 0 i r m c r j k c r j q m r 3 j k n r 1 i r m 1 r m s r j k s r j q m r 3 λ k s e m β q k the pair of eqs 36 and 37 represents a complex algebraic system the system must be truncated to a finite number of orders which must be sufficient to achieve convergence although complicated the system is linear and can be solved using standard matrix techniques introducing next eqs 36 and 37 into the total velocity potential for body k which is given in normalized form by eq 35 the following compact form for ϕ k immediately yields 38 ϕ k u k v k z 2 i g a ω z 0 z z 0 h m 0 i m c m k c e m v k q k k c m k m c m 3 u k q k m c m 1 u k q k m 1 i m s m k s e m v k q k k s m k m s m 3 u k q k m s m 1 u k q k equation 38 can be further simplified if we calculate ϕ k precisely on the elliptical boundary of body k on u k u k 0 in this case the total velocity potential will read 39 ϕ k u k 0 v k z 4 π g a ω z 0 z z 0 h m 0 i m c m k c e m v k q k m c m 3 u k 0 q k m 1 i m s m k s e m v k q k m s m 3 u k 0 q k for the derivation of eq 39 we used the following wronskian relations mclachlan 1947 40 m c m 1 u k 0 q k m c m 3 u k q k m c m 3 u k 0 q k m c m 1 u k q k m s m 1 u k 0 q k m s m 3 u k q k m s m 3 u k 0 q k m s m 1 u k q k 2 i π 6 hydrodynamic loading the linear hydrodynamic loading forces and moments are obtained by integrating the hydrodynamic pressure on the wetted surface of each body in the array using only the linear term in bernoulli s equation the surge sway forces roll pitch and yaw moments will be given by 41 f x k i ω ρ b k 0 h 0 2 π ϕ k u k 0 v k z cos v k d v k d z 42 f y k i ω ρ a k 0 h 0 2 π ϕ k u k 0 v k z sin v k d v k d z 43 m x k i ω ρ a k 0 h 0 2 π z ϕ k u k 0 v k z sin v k d v k d z 44 m y k i ω ρ b k 0 h 0 2 π z ϕ k u k 0 v k z cos v k d v k d z 45 m z k i ω ρ c k 2 2 0 h 0 2 π ϕ k u k 0 v k z sin 2 v k d v k d z the roll and pitch moments are taken with respect to the foundation at z 0 substituting eq 39 into eqs 41 45 and performing the integrations we obtain the following normalized forms of the various components of the hydrodynamic loading 46 f x k ρ g a a k 2 4 i k 0 b k k 0 a k 2 tanh k 0 h m 0 i m a 1 m q k c m k m c m 3 u k 0 q k 47 f y k ρ g a a k 2 4 i 1 k 0 a k tanh k 0 h m 1 i m b 1 m q k s m k m s m 3 u k 0 q k 48 m x k ρ g a a k 3 4 i 1 k 0 a k 2 1 cosh k 0 h k h 1 m 1 i m b 1 m q k s m k m s m 3 u k 0 q k 49 m y k ρ g a a k 3 4 i k 0 b k k 0 a k 3 1 cosh k 0 h k h 1 m 0 i m a 1 m q k c m k m c m 3 u k 0 q k 50 m z k ρ g a a k 3 2 i k 0 c k 2 k 0 a k 3 tanh k 0 h m 1 i m b 2 m q k s m k m s m 3 u k 0 q k where a n m q k and b n m q k denote the expansion coefficients of the even and odd periodic mathieu functions see appendix a the results for the hydrodynamic loading presented in the sequel concern four different arrays the in line array of five cylinders of fig 2 a and the similar in line array with nine cylinders fig 2 c the same nine cylinder array with reversed slenderness radio fig 2 d and finally the square array of fig 2 b in all cases considered the cylinders are surface piercing and their freeboard is sufficiently high and no overtopping is allowed the cylinders are identical having a slenderness ratio b a 0 4 the array of fig 2 c is used to investigate the trapped modes of elliptical cylinders against the trapped modes of circular cylinders it is also used as an additional means of validation using the in line array of circular cylinders suggested for investigation by maniar and newman 1997 the square array of fig 2 b serves as a subject to investigate in phase and out of phase loading particulars the water depth to semimajor axis ratio is h a 0 8 for fig 2 a and b and equal to h a 1 0 for fig 2 c and d the in line array of nine cylinders of fig 2 c was also used to check the convergence of the analytical method developed and employed herein given that the problem is considered within the realm of the linear theory it should be anticipated that only a few number of modes orders of products of periodic and radial mathieu functions elliptical harmonics are sufficient to achieve tolerable convergence such a convergence study relative to the truncation of the infinite sums is conducted in fig 3 showing the normalized sway force for all normalizations used herein see the legends of the axes under beam seas β 90 o in total results are presented for three cylinders the outer cylinders and the middle one it is immediately evident that convergence is achieved rapidly with only a few number of modes letting the truncation be m 5 a convergence up to the third significant digit is achieved while additional modes are required as expected for higher wave frequencies nevertheless use of additional modes does not compromise the robustness and the celerity of the present analytical method the case considered in fig 3 is revisited in section 8 utilising a different normalization for the wave frequency the particulars of the hydrodynamic loading exerted on the five cylinders array of fig 2 a are examined herein with the aid of figs 4 12 which investigate all modes of the linear hydrodynamic loading i e surge and sway forces and roll pitch and yaw moments it should be noted that surge and sway forces literally provide the patterns for pitch and roll overturning moments respectively results are shown for three different angles of heading namely β 0 o 45 o and 90 o with respect to the horizontal x axis of the global x y system that is always fixed on the centre of the body no 1 b1 for the limiting case of β 0 o the surge forces fig 4 on the pairs of cylinders b1 b5 and b2 b4 are the same due to symmetry the surge force on the middle cylinder is different but overall the results are comparable for the complete interval of wave frequencies a maximum occurs at approximately k 0 a 1 but otherwise the hydrodynamic interactions although evident are not that strong as expected the pattern for the pitch moments fig 7 is provided by the surge forces fig 4 and by analogy the pattern for the roll moments fig 6 is provided by the sway forces fig 5 again due to symmetry the sway forces and roll moments for the pairs of cylinders b1 b5 and b2 b4 are equal whereas the hydrodynamic interactions cancel f y and m x in the middle cylinder the sway force exhibit sharp amplifications fig 5 and by analogy such is the case for the roll moment as well these amplifications occur in the form of repeated peaks in the associated curves the specific phenomenon is tightly correlated with strong hydrodynamic interactions which aside from the increase in loading induce strong free surface elevations between the cylinders as well this is a clear evidence of wave trapping between the cylinders which will be encountered many times in the discussion of the computations as expected for the specific wave heading angle and the particular inline arrangement the yaw moment is zero for the middle cylinder although it appears that the yaw moment is not directly connected with any other mode of loading a careful inspection of fig 8 reveals that it exhibits local maxima at approximately the same wave frequencies detected for the sharp peaks of the sway force and roll moment the occurrence of peaks in loading is more evident when the angle of heading is 90 o fig 9 here only the sway force and hence the roll moment that was omitted for brevity is non zero sharp peaks occur at the same wave frequencies as for β 0 o which however are more profound the maximum loading corresponds to the middle elliptical cylinder similar conclusions analogous to those for β 0 o and 90 o can be drawn for the oblique heading of β 45 o see figs 10 12 the placement of the cylinders in connection with the wave heading cancels any type of symmetry and accordingly no mode of loading is zero to any module of the array here the hydrodynamic interactions are more effective while it is very important to observe the occurrence of sharp peaks in the sway force and roll moment again precisely at the same wave frequencies which have been already detected for β 0 o and 90 o next the square array shown in fig 2 b is considered the magnitudes of the hydrodynamic loading components are shown in figs 13 19 for three heading angles i e β 0 o 45 o and 90 o the centres of the elliptical cylinders are situated at the corners of a 3 a 3 a square aside from the evident strong hydrodynamic interactions incurred by the bodies the general conclusions drawn previously for the in line arrangement are valid for the square arrangement as well a brief list of the general observations that could be made is i the surge forces provide the pattern for the pitch moments and the sway forces provide the patterns for the roll moments as expected and highlighted previously ii the symmetrical placement of the bodies leads to symmetric loading in pairs of cylinders for β 0 o and 90 o iii it is very interesting to observe the strong wavy trend of the sway forces and roll moments for the oblique heading of β 45 o and 90 o iv the variation of the linear hydrodynamic loading is in general rather unpredictable and strongly depends of the geometry of the array v peaks in loading are also evident which are again connected with hydrodynamic resonances the sharp amplifications associated with the peaks correspond to different wave frequencies compared to the in line arrangement here k 0 a 3 and 5 5 e g figs 13 and 14 and can be said that they are independent of β therefore their occurrence is literally a function of the layout of the array and apparently the size s of the cylinders indeed other layouts of four elliptical cylinders examined previously by chen and lee 2013 led to no observation of trapped modes for β 0 o supporting the observations of the present that the layout of the cylinders pay a leading role to the development of trapped modes the specific array of four cylinders fig 2 b is used to provide further insight in a particular feature of the hydrodynamic loading which is the loading phase bai et al 2014 examined an array of four circular cylinders placed in a similar square configuration and they concluded that the loading on some bodies are in phase whereas it is out of phase on others here the situation is much more complicated as the cylinders are elliptical in phase or out of phase occurrences are related only with some kind of symmetry in impact and therefore we restrict our attention only on the limiting cases of β 0 o and 90 o here results are presented only for the former case of wave heading figs 20 and 21 for β 0 o in particular the sway force roll and yaw moments on the pairs of cylinders b1 b4 and b2 b3 are out of phase while on the same pairs the surge force and the pitch moment are in phase it must be noted that for the wave heading of 90 o the surge force and pitch moment on the pairs of cylinders b1 b2 and b3 b4 are out of phase while in phase are the sway force and roll moment for the same pairs of cylinders the yaw moment is out of phase indicative results that depict the specific behaviour are given in figs 20 and 21 and they concern the out of phase feature of the sway force and yaw moment for β 0 o note that results are presented only for the pair b1 b4 as the results for the pair b2 b3 are similar and would not add more to the argument 7 wave trapping in the array among the various important characteristics associated with the hydrodynamics and the loading exerted on arrays of elliptical cylinders admittedly the most intriguing feature is connected with the resonance behaviour that occurs at specific and repeated wave frequencies those resonances which were observed for both arrays investigated in the present independently on the particulars of the incoming waves i e the excitation and the mode of the hydrodynamic loading s are better shown in fig 9 for the sway forces and roll moments on the modules of the inline configuration of fig 2 a two peaks are evident while one could assume positively the occurrence of smaller resonances at higher wave frequencies a careful inspection of the magnitudes of the sway forces and the roll moments exerted on the elliptical cylinders will verify that the maximum value corresponds to the middle body of the array of five bodies this finding is somehow peculiar as the middle body had to be protected given the fact that the body that faces the propagating wave train is b1 in addition even the last body b5 experiences the action of a sharp amplification in loading in this context a rational explanation for the behaviour under consideration could be that at the specific wave frequencies waves are trapped in the liquid region between the bodies which accordingly induce peaks in the exciting forces and moments clearly these resonances and the trapping of waves should be reflected as strong free surface elevations between the cylinders and on the wetted surfaces of the cylinders analogous sharp increases in hydrodynamic loading are observed in arrays of circular cylinders it is noted that to the authors best knowledge arrays of multiple bodies other than circular cylinders were never investigated so far in the study of maniar and newman 1997 the authors investigated the water wave diffraction by an inline array of nine circular cylinders and they observed similar resonance results captured as peaks in the transfer functions of the linear exciting forces according to maniar and newman 1997 this phenomenon is related to the existence of trapped waves in a channel in particular the first peak first trapped mode corresponds to a neumann condition on the walls of the channel while the second peak second trapped mode corresponds to a dirichlet condition and is attributed to a non physical channel where the velocity potential rather than its normal derivative vanishes on the walls dirichlet type trapped modes are known to exist in the acoustic context subsequent peaks in loading were associated with nearly trapped waves where radiation is weak but non zero as noted by evans and porter 1999 only for infinite arrays there are pure trapping of waves known as rayleigh bloch or edge waves which for particular dominant wavenumbers reduce to well known trapped mode solutions for a cylinder between two parallel walls having either neumann or dirichlet boundary conditions upon them for a finite number of cylinders such as in the present study as well as for all studies reported in the literature that consider only arrays of circular cylinders a trapped mode literally means near wave trapping associated however with small but non zero transmission of energy radiated to infinity hence in order to avoid possible confusions it is made clear that all trapped mode and wave trapping cases including neumann and dirichlet discussed in the sequel actually refer to near trapping phenomena trapped modes namely the resonance wavenumbers are determined by the homogeneous solutions of the matrix equation that provides the expansion coefficients of the diffraction component of the potential according to the present approach the matrix equation is constructed by the linear eqs 36 and 37 and can be written as 51 b f i or s 1 l b n s f s i n where l is explicitly defined by the truncation used for the order of the mathieu functions and the number of bodies in the array let us assume that the indices j k 1 n denote the number of the body the indices r m 0 1 m denote the modes of the mathieu functions which are taken into account and the indices p l 1 2 denote even expansion coefficients for p l 1 and odd expansion coefficients for p l 2 therefore assuming n bodies in the array and m orders for the mathieu functions b will be a 2 m 1 n 2 m 1 n square matrix the elements of the matrix b are determined by letting n 2 k 1 m 1 m l and s 2 j 1 m 1 r p further for p 1 f s c r j c r 1 j while for p 2 f s s r j c r 2 j where c r p j p 1 2 is a global notation of either c r j or s r j following chatjigeorgiou and mavrakos 2010 the elements of the matrix b will be given by 52 b n s δ k j δ m r δ l p g m r l p k j n 2 k 1 m 1 m l s 2 j 1 m 1 r p where 53 g m r 1 1 k j 1 δ k j i r m k c r j q m r j g m r 1 2 k j 1 δ k j 1 δ 0 r i r m 1 1 r k s r j q m r j g m r 2 1 k j 1 δ k j i r m 1 1 m 1 k c r j q m r j g m r 2 2 k j 1 δ k j 1 δ 0 r i r m 1 r m k s r j q m r j the right hand side term of eq 51 is written as 54 i n λ k c e m β q k i n 1 δ 0 m λ k s e m β q k l 1 l 2 n 2 k 1 m 1 m l pure wave trapping in the array namely zero energy radiation to the far field is achieved when the determinant of b is explicitly zero nevertheless for a finite array a trapped mode actually a near trapped mode is detected by the minimization of the determinant which accordingly ensures maximum expansion coefficients and through the compact formulae of eqs 46 50 sharp amplifications of the hydrodynamic loading components in the present analysis the computation of the wavenumbers that secure det b 0 is by no means an easy task due to the extremely complicated structure of the square matrix b this is noted in contrast to the relatively easy way to compute the trapped modes for an array of circular cylinders as implemented for instance by evans and porter 1999 here in order to show the connection between the peaks in loading and the homogeneous solution of the matrix εq 51 we have calculated the determinant of b throughout the investigated frequency range nevertheless we emphasize in small intervals around the peaks in loading figs 22 and 23 show exactly the minimum values of det b which are associated with the wavenumbers that lead to sharp amplifications in loading clearly the minima correspond to the first two peaks that can be easily detected in fig 9 eventually a trapped mode essentially a near trapped mode is literally a property of the array assuming a given geometry placement orientation of the cylinders and apparently dimensions including the water depth in other words a trapped mode is independent of the excitation a hydrodynamic resonance in the form of wave trapping is excited when the wavenumber i e the frequency of the incoming waves falls in the vicinity of a homogeneous solution of the matrix εq 51 that eventually explains the peaks in loading which are easily observed for all heading angles 8 free surface elevation at trapping modes in the array the free surface elevation at the leading linear order for an arbitrary cylinder k can be calculated by the generic formula 55 η k i ω g ϕ k letting z h thus using eq 38 one gets 56 η k u k v k a 2 m 0 i m c m k c e m v k q k k c m k m c m 3 u k q k m c m 1 u k q k m 1 i m s m k s e m v k q k k s m k m s m 3 u k q k m s m 1 u k q k accordingly using eq 39 the surface elevation on the boundary of the cylinder k becomes 57 η k u k 0 v k a 4 i π m 0 i m c m k c e m v k q k m c m 3 u k 0 q k m 1 i m s m k s e m v k q k m s m 3 u k 0 q k the free surface elevation is typically expressed normalized by the wave amplitude as indicated in eqs 56 and 57 it is very important to note that those expressions provide the free surface elevation everywhere with respect to the local coordinate system of the specifically chosen body k this fact is underlined as the mathieu functions addition theorem is not valid everywhere as noted by særmark 1959 see also fig 1 the area where the addition theorem and accordingly the potential and the free surface elevation is valid is explicitly determined by the separation distance between the centres of the cylinders and their half foci distances as a general rule eqs 56 and 57 are valid around the cylinder k but they may fail close to another cylinder therefore special attention must be paid in the separation distances when designing the array the strong variations in hydrodynamic loading see e g figs 9 12 imply that analogous profound phenomena should be expected in the free surface elevation in the liquid regions between the cylinders figs 24 and 25 depict such occurrences that explicitly correspond to the hydrodynamic resonance frequencies of figs 22 and 23 in fact the direction of the propagating waves is immediately detected by the maximum values of the depicted contours for the higher wave frequency the contours as expected are denser for the oblique heading fig 24 the elevation has no regularity several maxima occur at positions which are difficult to be anticipated without solving the problem in contrast for beam seas fig 25 the contours are symmetrical with respect to x 0 axis it is interesting to observe that the maximum elevation occurs in internal regions demonstrating the occurrence of wave trapping in the specific example the wave trapping causes strong free surface elevations up to 3 5 a and 5 5 a for the two investigated heading angles 9 arrays of elliptical cylinders against arrays of circular cylinders in the context of the present study we have made computations on several body arrangements clearly each arrangement features its own characteristics in terms of the hydrodynamic interactions it is important however to highlight particular findings associated with the long in line configuration shown in fig 2 c and d the specific array was extended to include up to nine elliptical cylinders the mutual feature in all cases was that the maximum loading was undertaken by the body ies located in the middle of the array as expected the maximum loading was connected with severe free surface elevation wave trapping it is also interesting to note that the magnitudes of the exciting forces are increased as well for example the peak in sway force under 90 o of heading on the dirichlet trapped mode and on the middle body fifth in the array of nine bodies was found to be nearly double the sway force under the same angle on the middle body third in the array of five bodies see e g figs 9 and 26 note also the difference in the representation of the normalized wave frequency the peaks in neumann trapped modes however are comparable one could rationally deduce that extending the array with more bodies the wave trapping phenomena become more profound reducing the amount of energy radiated to the far field concentrating energy between the bodies accordingly leads to increased loading as using more bodies one could claim that approaches to some extend apparently pure trapping the analysis that is conducted in the present is completed by contrasting the hydrodynamic interaction characteristics induced by arrays of circular and elliptical cylinders that is performed with the aid of figs 26 and 28 which shows the sway force in the middle bodies fifth of two arrays of only elliptical and only circular cylinders in both cases the heading angle was taken equal to 90 o the case studies were taken from the work of maniar and newman 1997 who investigated a long array of nine circular cylinders in an inline arrangement with equal spacing between subsequent bodies between centres 2 d with a d 1 2 and a d 1 4 respectively see also fig 2 c and d figs 26 29 use the wavenumber normalization and the radius to depth ratio a h 1 adopted by maniar and newman 1997 for obtaining the results shown for the array of the circular cylinders we used the analytical method outlined in the present assuming simply that b a semi minor to semi major axis is equal to 0 99 the load on a single cylinder has been also included the relevant computations were performed using again the present analytical method assuming very large distances between two bodies d furthermore figs 27 and 29 demonstrate the effect of b a in order to highlight the effects of the different symmetry properties of an ellipse compared to a circle it should be noted here that according to the notation given in fig 1 the semi major axis is a and the semi minor axis is b hence it always stands that a b for simplicity we have changed this notation for clarity purposes only for the discussion of figs 27 and 29 b a 1 referring to the layout presented in fig 2 c and b a 1 referring to the layout presented in fig 2 d concerning figs 26 and 28 which correspond to two discrete separation distances the array of the elliptical cylinders was designed onto the array of the circular cylinders by simply letting b a 0 4 those figures can be used as additional means of validation of the outlined methodology although its efficacy has been already demonstrated independently in the past see for instance chen and lee 2012 who validated their own numerical method against the results reported by chatjigeorgiou and mavrakos 2010 the computations depicted in figs 26 and 28 explicitly coincide with those reported by maniar and newman 1997 the magnitudes of peaks being precisely equal and occurring at explicitly the same wavenumbers as noted by maniar and newman 1997 the connection of the circular cylinders array with trapped waves may seem surprising since the peaks in loading arise from the diffraction of waves past a finite array in an otherwise unbounded fluid domain again as indicated in maniar and newman 1997 the diffraction of waves β 90 o past an infinite array is equivalent to that of a single cylinder in a channel in accordance with the method of images and this explains the first peak in figs 26 and 28 this occurs below the critical cut off value k 0 d π 2 implying a neumann trapped mode which is also associated with singular added mass in sway the second peak implies a dirichlet trapped mode which occurs below the critical cut off value k 0 d π the subsequent peaks in figs 26 and 28 are associated with nearly trapped waves where the radiation of energy is weak but not zero maniar and newman 1997 figs 26 and 28 reveal a pronounced differentiation between the small and the large spacing cases in the former case shown in fig 26 aside from the fundamental neumann and the dirichlet trapped modes there is no indication for the occurrence of near trapped modes in larger frequencies there are some insignificant singularities which could be attributed to other weak near trapped mode effects e g standing waves between the cylinders in contrast wider open liquid spaces between cylinders allow stimulation of nearly wave trapping singularities as implied in fig 28 for the elliptical cylinders array trapped mode occurrences are indeed observed which in addition appear to be more effective in fact the neumann trapped mode coincides with that of the circular cylinders implying that it depends only on the separation distance this allegation is also supported by figs 27 and 29 which demonstrate the effect of slenderness in addition to the change in the orientation of the semi major axes relative to the wave propagation for the small spacing fig 26 the largest peak is not the neumann mode as is the case for the circular cylinders but the second peak dirichlet mode indeed this peak is about four times the sway force on a single elliptical cylinder as shown in fig 27 where the sway force is plotted for several slendernesses in the interval 0 2 b a 2 5 the magnitude of the peak loading increases as b a 0 for the large spacing case fig 28 the second peak corresponding to the dirichlet trapped mode falls in the same wavenumber for both geometries this however is not the case for the small spacing arrangement fig 26 in the particular case of large spacing one can observe near trapped mode occurrences along the whole range of interest in terms of the wavenumber values the nature of these trapped modes in particular whether they could be interpreted as neumann or dirichlet near trapped modes is left for a future endeavour however it can be said that near trapped modes depend on the spacing between the cylinders and it is more possible to occur for larger open liquid areas this assertion is implied by the fact that elliptical cylinders compared to circular cylinders allow lengthier liquid regions between adjacent bodies for the large spacing case figs 28 and 29 the first and second peak neumann and dirichlet appear larger for the circular geometry while the third peak which is similar in magnitude to the second is larger for small values of b a in this case and for b a 1 both the neumann and the dirichlet trapped modes appear to be independent of b a and occur in k 0 d π 0 47 0 5 and in k 0 d π 0 94 1 respectively which are not the same frequencies as for the small spacing case but comparable to sum up one should notice from figs 27 and 29 that both the magnitudes and occurrences of the trapped modes are dependent on three parameters i the distance between the bodies a d ii the slenderness of the body b a and iii the orientation of the body whether b a 1 fig 2 c or b a 1 fig 2 d in both spacing cases the neumann mode occurs always at the same frequency and definitely below the first cut off point k 0 d π 0 5 while for the cases that involve larger spacing the dirichlet mode also occurs at almost the same frequency and definitely below the associated cut off point k 0 d π 1 0 furthermore in some cases larger open fluid spaces lead to larger magnitudes but that depends on the b a ratio of the body with b a 1 circular cylinder always describing a threshold this limit defines the orientation of the bodies and accordingly there is strong indication that for b a 1 trapping and near trapping becomes weak and hence the phenomenon much less profound indeed it is shown for both spacing cases that when b a 2 5 the largest sway force exerted in an array of elliptical cylinders is only marginally larger than the same force on a single elliptical cylinder indications of which are shown in fig 29 this finding is a possible explanation for the observations made by chen and lee 2013 where no observation of near trapped modes was made for certain layouts of the elliptical cylinders they considered based on the present calculations the circular cylinder appears to constitute a threshold this is also apparent in the study of mciver et al 2001 who examined near trapped mode effects above the cut off frequency k 0 d π 0 5 for ellipses in the middle of a channel the slendernesses they considered varied in the interval 0 2 b a 2 5 in the latter work the above i iii combined effects also appear to affect the development and occurrence of trapped modes 10 conclusions the problem of the hydrodynamic diffraction by arrays of elliptical cylinders was considered the solution of the problem was achieved completely analytically by employing the mathieu functions addition theorem that converts one elliptic coordinate system to another which are separated by a distance between them the solution provided is multi task as elliptical cylinders can approximate effectively circular cylinders or plates in the two limiting cases several numerical results were presented focusing on two characteristic arrangements i e an inline configuration and a square configuration the presented data considered all modes of hydrodynamic loading i e surge sway forces and roll pitch and yaw moments extending the available data in the existing literature that concern only forces chatjigeorgiou and mavrakos 2010 chatjigeorgiou 2011 2013 chen and lee 2012 2013 the developed analytical method was proven to be robust and efficient requiring limited cpu time for the computations the computations demonstrated the stimulation of hydrodynamic resonances in the form s of the so called trapped modes the concerned resonances were reflected as sharp peaks in loading at specific wave frequencies which were independent from the particulars of the propagating wave train those hydrodynamic resonances were rationally associated with the occurrence of the wave trapping phenomenon in the liquid region s between the bodies trapping and near trapping phenomena are well treated in the literature for circular cylinders and the present study extends the gained knowledge on the topic by containing elliptical cylinders as well wave trapping phenomena were connected with the homogeneous solution of the linear matrix equation that provides the expansion coefficients of the diffraction component s besides the hydrodynamic loading the strong effect of the trapped modes to the free surface elevation between the cylinders and accordingly to drastic reduction of the amount of energy radiated to the far field was shown through free surface elevation contours which reached up to more than five times the amplitude of the incoming waves further comparisons between circular and elliptical cylinder arrays showed that elliptical cylinders are more effective as wave trapping arrangements allowing additional near trapped modes to develop the last aspect of the complicated interaction phenomenon considered in the present was the in phase and the out of phase loading on the cylinders which could occur under specific conditions of symmetry it can be said that the stimulation of near trapped modes strongly depends on the spacing between adjacent cylinders the slenderness of the ellipse and the orientation of the body in particular the neumann trapped mode appears to be explicitly dependent on the spacing between adjacent cylinders which is not the case for the dirichlet trapped mode and other near trapped modes of higher frequency where the slenderness of the ellipse and the orientation of the body affects their appearance and magnitude additionally for the dirichlet trapped mode and other near trapped modes the case of the circular cylinder appears as a threshold to the stimulation of trapped and near trapped modes finally it should be mentioned that phenomena of increased surface elevations due to resonance such as trapping will involve also nonlinear effects and the increase in crest elevation may be much larger acknowledgements the authors are grateful to professor j n newman for the stimulating discussions concerning this research this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors appendix a formulae for the periodic and the modified mathieu functions a 1 even and odd periodic mathieu functions a 1 c e 2 r v q k 0 a 2 k 2 r q cos 2 k v a 2 c e 2 r 1 v q k 0 a 2 k 1 2 r 1 q cos 2 k 1 v a 3 s e 2 r 1 v q k 0 b 2 k 1 2 r 1 q sin 2 k 1 v a 4 s e 2 r 2 v q k 0 b 2 k 2 2 r 2 q sin 2 k 2 v where a 2 k 2 r a 2 k 1 2 r 1 b 2 k 1 2 r 1 and b 2 k 2 2 r 2 are the expansion coefficients of the periodic mathieu functions which are functions of the mathieu parameter q a 2 even and odd modified mathieu functions the modified mathieu functions can be expressed as series of bessel functions according to abramowitz and stegun 1970 a 5 c e 2 r u q c e 2 r π 2 q a 0 2 r q k 0 1 k a 2 k 2 r q j 2 k 2 q cosh u c e 2 r 0 q a 0 2 r q k 0 1 k a 2 k 2 r q j 2 k 2 q sinh u a 6 c e 2 r 1 u q c e 2 r 1 π 2 q q a 1 2 r 1 q k 0 1 k 1 a 2 k 1 2 r 1 q j 2 k 1 2 q cosh u c e 2 r 1 0 q q a 1 2 r 1 q coth u k 0 2 k 1 a 2 k 1 2 r 1 q j 2 k 1 2 q sinh u a 7 s e 2 r 1 u q s e 2 r 1 π 2 q q b 1 2 r 1 q tanh u k 0 1 k 2 k 1 b 2 k 1 2 r 1 q j 2 k 1 2 q cosh u s e 2 r 1 0 q q b 1 2 r 1 q k 0 b 2 k 1 2 r 1 q j 2 k 1 2 q sinh u a 8 s e 2 r 2 u q s e 2 r 2 π 2 q q b 2 2 r 2 q tanh u k 0 1 k 1 2 k 2 b 2 k 2 2 r 2 q j 2 k 2 2 q cosh u s e 2 r 2 0 q q b 2 2 r 2 q coth u k 0 2 k 2 b 2 k 2 2 r 2 q j 2 k 2 2 q sinh u also as series of products of bessel functions are given by mclachlan 1947 a 9 c e 2 r u q c e 2 r 0 q c e 2 r π 2 q a 0 2 r q 2 k 0 1 k a 2 k 2 r q j k u 1 j k u 2 a 10 c e 2 r 1 u q c e 2 r 1 0 q c e 2 r 1 π 2 q q a 1 2 r 1 q 2 k 0 1 k 1 a 2 k 1 2 r 1 q j k u 1 j k 1 u 2 j k 1 u 1 j k u 2 a 11 s e 2 r 1 u q s e 2 r 1 0 q s e 2 r 1 π 2 q q b 1 2 r 1 q 2 k 0 1 k b 2 k 1 2 r 1 q j k u 1 j k 1 u 2 j k 1 u 1 j k u 2 a 12 s e 2 r 2 u q s e 2 r 2 0 q s e 2 r 2 π 2 q q b 2 2 r 2 q 2 k 0 1 k 1 b 2 k 2 2 r 2 q j k u 1 j k 2 u 2 j k 2 u 1 j k u 2 where u 1 q e u and u 2 q e u alternative forms of the modified mathieu functions also referred as radial mathieu functions are meixner and schäfke 1954 a 13 m c 2 r j u q 1 c e 2 r 0 q k 0 1 k r a 2 k 2 r q z 2 k j 2 q cosh u 1 r c e 2 r π 2 q k 0 a 2 k 2 r q z 2 k j 2 q sinh u a 14 m c 2 r 1 j u q 1 c e 2 r 1 0 q k 0 1 k r a 2 k 1 2 r 1 q z 2 k 1 j 2 q cosh u 1 r 1 coth u c e 2 r 1 π 2 q k 0 2 k 1 a 2 k 1 2 r 1 q z 2 k 1 j 2 q sinh u a 15 m s 2 r 1 j u q tanh u s e 2 r 1 0 q k 0 1 k r 2 k 1 b 2 k 1 2 r 1 q z 2 k 1 j 2 q cosh u 1 r s e 2 r 1 π 2 q k 0 b 2 k 1 2 r 1 q z 2 k 1 j 2 q sinh u a 16 m s 2 r 2 j u q tanh u s e 2 r 2 0 q k 0 1 k r 2 k 2 b 2 k 2 2 r 2 q z 2 k 2 j 2 q cosh u 1 r 1 coth u s e 2 r 2 π 2 q k 0 2 k 2 b 2 k 2 2 r 2 q z 2 k 2 j 2 q sinh u where j 1 2 3 4 denotes the kind of the radial mathieu function while the correspondence between z m j functions and the bessel and hankel functions is z m 1 j m z m 2 y m z m 3 h m 1 and z m 4 h m 2 the radial mathieu functions eq a 13 a 16 can also be expressed as series of bessel function products meixner and schäfke 1954 the associated formulae read a 17 m c 2 r j u q 1 a 0 2 r q k 0 1 k r a 2 k 2 r q j k u 1 z k j u 2 a 18 m c 2 r 1 j u q 1 a 1 2 r 1 q k 0 1 k r a 2 k 1 2 r 1 q j k u 1 z k 1 j u 2 j k 1 u 1 z k j u 2 a 19 m s 2 r 1 j u q 1 b 1 2 r 1 q k 0 1 k r b 2 k 1 2 r 1 q j k u 1 z k 1 j u 2 j k 1 u 1 z k j u 2 a 20 m s 2 r 2 j u q 1 b 2 2 r 1 q k 0 1 k r b 2 k 2 2 r 2 q j k u 1 z k 2 j u 2 j k 2 u 1 z k j u 2 a 3 orthogonality of periodic mathieu functions the periodic mathieu functions satisfy the following orthogonality relations abramowitz and stegun 1970 a 21 0 2 π c e r v q c e m v q d v 0 2 π s e r v q s e m v q d v π δ r m a 4 global notation of the periodic and the radial mathieu functions meixner and schäfke 1954 provide the following compact notations for the periodic and radial mathieu functions a 22 c e r v q 2 1 2 m e r v q r 0 1 2 a 23 s e r v q i 2 1 2 m e r v q r 1 2 a 24 m r j u q m c r j u q r 0 1 2 a 25 1 r m r j u q m s r j u q r 0 1 2 a 5 expansion coefficients for the periodic mathieu functions m e r v q the periodic mathieu functions m e r v q can be expanded as a 26 m e r v q s c 2 s r q e i r 2 s v with a 27 d 2 s r q 1 s c 2 s r q d 2 s 1 r q 0 a 28 d 2 s r q 1 s c 2 s r 2 s q d 2 s 1 r q 0 the relations between the expansion coefficients d and d and the expansion coefficients of the even and odd periodic mathieu functions are chatjigeorgiou and mavrakos 2010 a 29 d s r r q 2 1 2 1 s r 2 a r s q s 0 1 2 d s r r q 2 1 2 1 s r 2 b r s q s 1 2 d 2 s 0 q 2 1 2 1 s a 0 2 s q r 0 a 30 d s r r q 2 1 2 1 s r 2 a s r q r 0 1 2 d s r r q 2 1 2 1 s r 2 b s r q r 1 2 d 2 r 2 r q 2 1 2 1 r a 0 2 r q s 0 
23421,the purpose of the present study is the investigation of the hydrodynamic interactions induced by arrays of elliptical cylinders subjected to regular waves the solution methodology employs linear potential theory and is based on pure analytic considerations the interaction phenomena are approached using the mathieu functions addition theorem which converts elliptical harmonics from one elliptic coordinate system to a remote elliptic coordinate system the followed approach resembles the direct solution methodology which is used for the analytical solution of the diffraction problem by arrays of circular cylinders the direct approach allows among others the construction of a linear matrix equation for the calculation of the expansion coefficients of the diffraction component s which accordingly is used to trace the wavenumber s under which trapped modes may be stimulated to induce wave trapping in the array and reduction of the energy radiated to the far field the numerous computations which are performed specifically verify that any array of elliptical cylinders in accord with arrays of circular cylinders is potentially a wave trapping configuration which is connected mainly i with sharp amplifications in all modes of hydrodynamic loading both forces and moments and ii strong free surface elevations in the liquid regions between the cylinders and on the cylinders surfaces accordingly keywords diffraction trapping and near trapping effects elliptical cylinder arrays mathieu functions addition theorem 1 introduction when arrays of multiple bodies are subject to incident waves very interesting hydrodynamic phenomena arise multi body arrangements subjected to the action of propagating waves induce by default continuous reflections of the incoming waves yielding intriguing phenomena such as rather complicated variations of the hydrodynamic loading and hydrodynamic resonances which are reflected as peaks in loading and strong free surface elevations between the cylinders and also on the wetted surfaces of the bodies with regard to the former the complications in hydrodynamic loading are caused mainly because additional parameters are incorporated into the problem namely the number arrangement orientation and size s of the bodies in connection with the water depth as far as the hydrodynamic resonances are concerned these are also due to the hydrodynamic interactions and they are encountered when the geometry of the arrangement allows open liquid spaces between the bodies those effects are commonly referred as trapped and near trapped modes and they are detected at specific wavenumbers which eventually depend on all parameters involved in the problem such problems have been considered by researchers for several decades indeed multi body arrangements are detected in a series of engineering designs for example sea bridges piers are an array of usually circular bodies another application is floating islands that are designed as plates supported above the water surface by many floating bodies and are used for example as airports the most common example is however the columns of tension leg or bottom seated offshore structures these multi column platforms can exhibit extreme wave loading also due to the occurrence of trapped modes furthermore the increased surface elevation that is also very often associated with trapped modes can lead to the damage of the lower deck of such structures due to a false air gap design these effects have been also observed experimentally see for example swan et al 1997 on the other hand wave trapping is by all means not always something we need to avoid for example the energy that multi body configurations can trap in certain cases while interacting with surface waves can be exploited by wave power devices in order to increase their productiveness and efficiency any geometry or arrangement that creates a liquid space between walls i e surfaces where a neumann condition applies is a potentially trapped mode structure a notable single body geometry that induces trapped modes is the elliptical torus mciver and porter 2002 which is referred often as the mciver toroid newman 1999 a circular toroidal structure approximated by ring elements was investigated by mavrakos 1997 who reported the existence of peaks in the transfer functions of both the exciting forces and the hydrodynamic coefficients other examples of wave trapping structural arrangements are the moonpools which were examined for instance by molin 2001 and mavrakos and chatjigeorgiou 2009 clearly wave trapping may also be induced by multi body arrangements in that respect the only geometry that has been considered at least analytically is that of the circular cylinder arrays of cylinders have been studied by several authors without focusing always on wave trapping phenomena in that respect the proper methodology known as the direct method was first derived by záviška 1913 and was rediscovered by spring and monkmeyer 1974 mingde and yu 1987 literally re employed spring and monkmeyer s 1974 approach for a pair of bottom seated cylinders mciver and evans 1984 based their work on the study of simon 1982 they used an approximated method assuming large spacing between the cylinders and reported favourable agreement with the results presented by spring and monkmeyer 1974 linton and evans 1990 elaborated the method further by introducing the linear system that provides the unknown expansion coefficients of the diffraction potential s into the formulae of the potential s yielding an elegant compact form the hydrodynamics of arrays of cylinders have been also studied through an alternative approach known as the method of multiple scattering the foundations of which were provided by twersky 1952 in hydrodynamics it was first employed by ohkusu 1974 examples of studies by this method are those due to kagemoto and yue 1986 who employed the physical idea of ohkusu 1974 but algebraically used simon s 1982 matrix formulation and the works of mavrakos and koumoutsakos 1987 kagemoto and yue 1993 mavrakos and kalofonos 1997 yilmaz and incecik 1998 yilmaz 2004 and child and venugopal 2010 evans and porter 1997a 1999 as well as meylan and eatock taylor 2009 investigated possible trapping and near trapping effects by means of the method of linton and evans 1990 maniar and newman 1997 based a great part of their study on the wave trapping by a long array of cylinders nine in particular on the concerned direct method as well evans and porter 1997b extended their efforts to trace possible trapped modes in multiple cylinders in a channel wave trapping effects in arrays of cylinders under random wave spectra were investigated by walker and eatock taylor 2005 and grice et al 2013 while malenica et al 1999 extended the investigation on wave trapping for an array of equally spaced identical circular cylinders to second order in wave steepness the wave trapping by an array of truncated cylinders was considered by siddorn and eatock taylor 2008 and wolgamot et al 2015 independently of the theoretical studies the fact that wave trapping may occur in multi body arrangements was observed in laboratory experiments by ohl et al 2001 the above discussion evinces that wave trapping effects by arrays of circular cylinders using analytical models are well treated in the literature admittedly the same does not hold for different geometries such for example multiple elliptical cylinders although it should be mentioned that for more complex geometries such as multi column gravity platforms semisubmersibles or tension leg platforms and other trapping structures numerical diffraction codes have been employed by several researchers the development of an analytical solution methodology for the water wave diffraction problem by arrays of elliptical cylinders and accordingly the investigation of potential wave trapping phenomena is feasible due to the existence of separable solutions of the laplace equation in elliptic coordinates however relevant studies are scarce in the literature and mostly concern isolated bodies chen and mei 1971 solved the scattering and radiation problems of water waves by a bottom seated surface piercing elliptical cylinder using the separable solutions of the laplace equation later on chen and mei 1973 investigated the hydrodynamic loading on a stationary platform of elliptical shape partially immersed in the free surface williams 1985a presented two approximate solutions to the scattering problem one based on the extension of the exact solution of chen and mei 1971 for small values of the elliptic eccentricity the other based on the integral equation technique involving the application of green s theorem the same author williams 1985b extended his method to include the case of a submerged elliptical structure resting on the sea bed williams and darwiche 1988 1990 used exact solutions to investigate respectively the scattering and radiation problems by truncated elliptical cylinders while zhang and williams 1996a 1996b tackled the same problems by a fully submerged elliptical disk the hydrodynamic interactions by arrays of elliptical cylinders were first considered by chatjigeorgiou and mavrakos 2010 who achieved an analytical solution by employing the so called addition theorem for mathieu functions numerical results for the exciting forces were presented only for a pair of cylinders accordingly chatjigeorgiou 2011 presented an analytical solution for groups of elliptical and circular cylinders while in the later study of chatjigeorgiou 2013 the methodology was enhanced to account for cylinders truncation chatjigeorgiou and mavrakos 2010 results were accordingly used by chen and lee 2012 to validate their own calculations obtained via a boundary integral equation approach the same numerical approach was used to trace near trapping occurrences induced by arrays of four cylinders chen and lee 2013 the primary task of the present study is the investigation of the wave trapping phenomena due to the hydrodynamic interactions by arrays of elliptical cylinders the boundary value problem defined by multi body arrangements is further elaborated to provide compact elegant formulae for the potential and all hydrodynamic loading components i e surge sway forces roll pitch and yaw moments three different arrays are considered composed by four five and nine cylinders respectively in the latter case two different orientations of the semimajor axes relatively to the wave propagation were considered one perpendicular and one collinear attention is paid to situations of in phase and out of phase loading which may occur in cases of specific orientations in terms of the direction of the incoming waves special consideration is given to wave trapping phenomena and their correlation with peaks in hydrodynamic loading and strong free surface elevations in the open liquid space between the elliptical cylinders in critical wavenumbers the occurrence of the trapped modes is verified through the homogeneous solution of the linear matrix equation that is constructed to provide the even and odd expansion coefficients of the components of the diffraction potential s 2 the hydrodynamic problem a group of elliptical cylinders which are fixed on the bottom and exceed the free surface is considered the array is subjected to the action of regular waves of amplitude a and circular frequency ω the bottom is considered flat and horizontal while the water depth is equal to h the fluid is inviscid and incompressible and the flow irrotational allowing the use of the linear potential theory the flow field in the three dimensional euclidean space is governed by the linear velocity potential φ x y z t which is written as 1 φ x y z t r e ϕ x y z e i ω t where r e denotes the real part of component in the brackets and t is time as usual the spatial complex potential ϕ x y z should satisfy the laplace equation 2 2 ϕ 0 everywhere in the fluid domain the linearized free surface boundary condition 3 k ϕ ϕ z 0 z h and the zero velocity condition on the bottom 4 ϕ z 0 z 0 in eq 3 k ω 2 g where g is the gravitational acceleration clearly the x y z coordinate system has been assumed fixed on the bottom with the vertical z coordinate pointing upwards the total velocity potential should satisfy the neumann condition on the surfaces of all bodies in the array i e 5 ϕ n 0 where n denotes the unit normal on the surface of each body here the convention is made that n is directed into the liquid domain within the realm of the linear hydrodynamic problem we can assume that the total velocity potential is composed by the incident wave and the diffraction components coined in the sequel as ϕ i and ϕ d accordingly it is understood that the diffraction potential should satisfy the proper radiation condition for outgoing waves at infinity sommerfeld condition 6 lim r r 1 2 r i k 0 ϕ d 0 where r x 2 y 2 and k 0 is the wavenumber 3 solution in terms of elliptical harmonics in order to make the present study self contained we start from the very beginning namely the separable solutions of the laplace equation in elliptic coordinates the products of these solutions are called harmonics and in this particular case elliptical harmonics details on elliptical harmonics their properties and their use can be found in the books of mclachlan 1947 and meixner and schäfke 1954 summaries are contained in the handbooks of abramowitz and stegun 1970 and olver et al 2010 while moon and spencer 1971 provide only elementary information the main goal of using solutions of the laplace equation adapted to an elliptic coordinate system is the easiness of employing the neumann boundary condition mavrakos and chatjigeorgiou 2009 let us start from the transformation between the cartesian x y z and elliptic cylindrical or simply elliptic coordinates u v z this is 7 x c cosh u cos v y c sinh u sin v z z where u constant v constant are orthogonally intersecting families of confocal ellipses and hyperbolae respectively while c is the half distance between the foci the laplace equation in elliptic coordinates takes the form moon and spencer 1971 8 2 c 2 cosh 2 u cos 2 v 2 ϕ u 2 2 ϕ v 2 2 ϕ z 2 0 there are two types of separable solutions of the laplace equation in elliptic coordinates namely the even and the odd solutions which are written herein as 9 ϕ m n c u v z c m n m c m j u q n c e m v q n z n z 10 ϕ m n s u v z s m n m s m j u q n s e m v q n z n z where q n is the so called mathieu parameter which is associated with the eigenvalues of the separable solutions z n z in z further c e m v q n and s e m v q n are the even and the odd periodic mathieu functions respectively where m ℕ is a nonnegative integer likewise m c m j u q and m s m j u q denote the even and the odd modified or radial mathieu functions m c m j u q and m s m j u q for j 1 2 3 4 mathieu 1868 the indices m and j denote the order and the kind of the modified mathieu functions in fact the modified mathieu functions for j 1 2 3 4 are expressed as infinite expansions of bessel functions j and y and hankel functions h 1 and h 2 analytic relations for the periodic and the modified mathieu functions for a positive mathieu parameter are given in appendix a of the present it is noted herein that there is a general disagreement in the admittedly limited literature as regards the notations used for the separation constants and the modified mathieu functions this remark refers to all known books that treat the concerned special functions mclachlan 1947 meixner and schäfke 1954 abramowitz and stegun 1970 olver et al 2010 erdélyi et al 1955 strutt 1932 whittaker and watson 1927 throughout this paper we will use the notations adopted by abramowitz and stegun 1970 in particular it holds that 11 m c m 3 4 u q n m c m 1 u q n i m c m 2 u q n m s m 3 4 u q n m s m 1 u q n i m s m 2 u q n where the minus sign corresponds to the mathieu functions of the fourth kind finally c m n and s m n in eqs 9 and 10 denote arbitrary constants coefficients associated with the order m and the eigenvalues n the eigenfunctions z n z which satisfy the bottom and the free surface boundary conditions of eqs 3 and 4 are given by 12 z n z n 0 1 2 cosh k 0 z n 0 n n 1 2 cos a n z n 1 2 3 where 13 n n 1 2 1 sinh 2 k 0 h 2 k 0 h n 0 1 2 1 sin 2 α n h 2 α n h n 1 2 3 the wavenumber k 0 is obtained by the celebrated linear dispersion relation for finite water depth 14 k 0 tanh k 0 h k while the eigenvalues a n are the solutions of the transcendental formula 15 a n tan a n h k 0 n 1 2 3 using the convention a 0 i k 0 we are allowed to use a uniform notation for all possible eigensolutions it is noted that the eigenfunctions z n z have been properly normalized in order to satisfy the convenient relation of orthogonality 0 h z n z z m z d z h δ n m where δ n m is the kroneker s delta function subsequently the mathieu parameters q n in eqs 9 11 associated with the eigenvalues a n will be given by 16 q 0 k 0 c 2 2 q n α n c 2 2 n 1 2 3 and we note that for n 1 2 3 they are all negative when the mathieu parameter is negative the computation of the modified mathieu functions should be done with special care in the present study this case will not be encountered and therefore for the special formulae that provide the modified mathieu functions for negative parameters we refer the reader to equation 20 8 8 20 8 11 of abramowitz and stegun 1970 4 general formulations for the diffraction and the incident wave potentials let us assume that the incident wave propagates at angle β relatively to the horizontal x axis in the x y plane accordingly the incident wave potential will be given by 17 ϕ i i g a ω z 0 z z 0 h e i k 0 x cos β y sin β in order to express eq 17 in terms of elliptic coordinates we must transform the involved exponential term we note that exp i k 0 x cos β y sin β exp 2 i q 0 w where w cosh u cos v cos β sinh u sin v sin β next we arbitrarily define 18 e 2 i q 0 w m 0 f m c e m v q 0 m 1 f m s e m v q 0 use of the orthogonality relations satisfied by the periodic mathieu functions see appendix a immediately yields 19 f m 1 π 0 2 π e 2 i q 0 w c e m v q 0 d v f m 1 π 0 2 π e 2 i q 0 w s e m v q 0 d v it also holds that see abramowitz and stegun 1970 p 738 equation 20 7 34 20 7 35 20 0 2 π e 2 i q 0 w c e m v q 0 d v 2 π 1 s i p c e m β q 0 m c m 1 u q 0 0 2 π e 2 i q 0 w s e m v q 0 d v 2 π 1 s i p s e m β q 0 m s m 1 u q 0 with m 2 s p p 0 1 thus by substituting eqs 18 20 into eq 17 we can transform the incident wave potential into elliptic coordinates according to 21 ϕ i u v z 2 i g a ω z 0 z z 0 h m 0 i m m c m 1 u q 0 c e m v q 0 c e m β q 0 m 1 i m m s m 1 u q 0 s e m v q 0 s e m β q 0 the next step is to effectively determine the diffraction potential which should be constructed by means of the linear superposition of elliptical harmonics hence we can write 22 ϕ d u v z i ω a h m 0 n 0 ϕ m n c m 1 n 0 ϕ m n s i ω a h m 0 n 0 c m n m c m j u q n c e m v q n z n z m 1 n 0 s m n m s m j u q n s e m v q n z n z in this study we consider the special case of bottom seated elliptical cylinders hence in accord with the datum of the circular cylinders case only the zeroth order eigenfunction z 0 z shall participate in the solution in fact this is proven by applying the neumann condition along the complete height of the cylinder in the interval 0 z h nevertheless this is used as a fact from the beginning in order to simplify the notations of the analysis that follows in addition the diffraction potential should satisfy the radiation condition of eq 6 which in elliptical coordinates is transformed into 23 lim u c cosh u 1 2 1 c sinh u u i k 0 ϕ d 0 it turns out that only the modified mathieu functions of the third kind are well behaved at infinity and accordingly the diffraction potential is simplified further admitting the following form 24 ϕ d u v z i ω a h z 0 z m 0 c m m c m 3 u q 0 c e m v q 0 m 1 s m m s m 3 u q 0 s e m v q 0 5 hydrodynamic interactions by arrays of multiple elliptical cylinders let us now assume a group of n elliptical cylinders which are all subjected to the action of monochromatic incident waves with the obvious consequence of inducing hydrodynamic interactions between each other hence each cylinder is affected by the incident waves as well as the waves radiated by the rest of the cylinders in the array let us further assume a global coordinate system x y set on the free surface and accordingly determine the angle of propagation β as the angle which is formed between the direction of the regular propagating waves and the horizontal axis x the centre of each cylinder k 1 2 n is situated at the point x k y k with respect to the global system x y if x k y k defines the plane of the free surface with respect to the local cartesian coordinate system fixed on the centre of the body k then the ambient potential of eqs 17 and 21 expressed with respect to the same system will be given by 25 ϕ i 2 i g a ω z 0 z z 0 h λ k m 0 i m m c m 1 u q k c e m v q k c e m β q k m 1 i m m s m 1 u q k s e m v q k s e m β q k λ k e i k 0 x k cos β y k sin β where q k k 0 c k 2 2 denotes the zeroth order mathieu parameter associated with the dimensions of the body k and c k a k 2 b k 2 1 2 ε k a k is the half distance between the foci of the cylinder k while a k b k and ε k denote respectively the semimajor and semiminor axes and the elliptic eccentricity of the elliptical cylinder k the diffraction potential of body k is now denoted by ϕ d k this will be expressed with respect to the local coordinate system x k y k z z is common for all bodies or equivalently with respect to the local elliptic coordinate system u k v k z hence we can write 26 ϕ d k u k v k z 2 i g a ω z 0 z z 0 h m 0 i m c m k k c m k m c m 3 u k q k c e m v k q k m 1 i m s m k k s m k m s m 3 u k q k s e m v k q k where c m k and s m k denote the unknown expansion coefficients associated with the body k and 27 k c m k m c m 1 u k 0 q k m c m 3 u k 0 q k k s m k m s m 1 u k 0 q k m s m 3 u k 0 q k in which u k 0 tanh 1 b k a k denotes the elliptical boundary of the body k the primes denote differentiation with respect to u the total velocity potential that consists of the ambient potential and the diffraction components by all bodies in the array will be given by their linear superposition we chose to write it as 28 ϕ ϕ i ϕ d k j k n ϕ d j we can assume that ϕ i is given by eq 25 assuming further that ϕ d k ϕ d j are given using eq 26 we obtain an equation in which we have the incident wave and the diffraction potential induced by the reference body k being expressed with respect to the local coordinate system u k v k z while all the other diffraction components ϕ d j j 1 2 n j k are expressed with respect to different local coordinate systems u j v j z the main challenge therefore is to transform properly ϕ d j in order to be expressed with respect to u k v k z that would allow describing the total velocity potential with respect to a single coordinate system and immediately employ the neumann condition which is now written as 29 ϕ k u k 0 u k u k 0 0 v k 2 π 0 z h where ϕ k is the total velocity potential given with respect to u k v k z indeed we can find an appropriate expression to write ϕ d j as a function of u k v k z to this end we must use the so called addition theorem for mathieu functions and in particular the addition theorem which interchanges elliptical coordinate systems addition theorems provide important connections between mathieu functions with different parameters and in different coordinate systems they are analogous to the addition theorems for bessel functions e g graf s gegenbauer s and neumann s theorems it appears that they have been considered only by meixner and schäfke 1954 see also schäfke 1953 surprisingly mclahlan 1947 has no information while the resent nist handbook by olver et al 2010 refers the reader to the book of meixner and schäfke 1954 and the lecture notes due to meixner et al 1980 særmark 1959 developed an addition theorem alternative to that shown by meixner and schäfke 1954 which admittedly is much easier and comprehensible to use a review on the addition theorems for the transformation of harmonics between various coordinate systems can be found in the book of martin 2006 with reference to fig 1 særmark s 1959 formula reads 30 m m l u j q j m e m v j q j r q r m l m r 1 u k q k m e r v k q k l 1 2 3 4 with 31 q r m l s p d r p p q k z p s l k 0 r j k d s m m q j e i s p ψ j k e i s β j k l 1 2 3 4 and 32 z m 1 k 0 r j k j m k 0 r j k z m 2 k 0 r j k y m k 0 r j k z m 3 k 0 r j k h m 1 k 0 r j k z m 4 k 0 r j k h m 2 k 0 r j k note that j m y m denote the bessel functions of the first and the second kind respectively while h m 1 2 k 0 r j k are the hankel functions again of the first and the second kind in eq 30 m m l and m e m denote the global notation of the modified and the periodic mathieu functions which incorporate both even and odd counterparts the interrelations between those and the even and odd mathieu functions are given in appendix a of the present in addition the coefficients d n p q and d n p q in eq 31 are associated with the expansion coefficients of the periodic mathieu functions m e m their connections with the expansion coefficients of the even and odd periodic mathieu functions are also given in appendix a as noted by særmark 1959 the addition theorem eq 30 will be valid outside a circle with centre at b and r j c j a j ε j but inside the circle with centre at a and r k r j k this region is shown in fig 1 we are particularly interested only in the modified mathieu functions of the third kind i e for l 3 in eqs 30 and 31 the associated addition theorem can be effectively split into even and odd terms according to 33 m c m 3 u j q j c e m v j q j r 0 q r m 3 m c r 1 u k q k c e r v k q k i r 1 1 r q r m 3 m s r 1 u k q k s e r v k q k 34 m s m 3 u j q j s e m v j q j i 1 m r 0 q r m 3 m c r 1 u k q k c e r v k q k r 1 1 m r q r m 3 m s r 1 u k q k s e r v k q k next using eqs 25 26 28 33 and 34 we obtain the following analytic form for the total velocity potential in normalized form according to ϕ k 2 i g a ω z 0 z z 0 h φ k 35 φ k λ k m 0 i m m c m 1 u q k c e m v q k c e m β q k m 1 i m m s m 1 u q k s e m v q k s e m β q k m 0 i m c m k k c m k m c m 3 u k q k c e m v k q k m 1 i m s m k k s m k m s m 3 u k q k s e m v k q k j k n m 0 i m c m j k c m j r 0 q r m 3 m c r 1 u k q k c e r v k q k i r 1 1 r q r m 3 m s r 1 u k q k s e r v k q k j k n m 0 i m s m j k s m j i 1 m r 0 q r m 3 m c r 1 u k q k c e r v k q k r 1 1 m r q r m 3 m s r 1 u k q k s e r v k q k using further the neumann condition eq 29 and employing the orthogonality relations of the periodic mathieu functions see appendix a the following linear system in terms of the unknown expansion coefficients c m j and s m j j 1 2 n immediately yields 36 c m k j k n r 0 i r m c r j k c r j q m r 3 i j k n r 1 i r m 1 r s r j k s r j q m r 3 λ k c e m β q k 37 s m k i 1 m j k n r 0 i r m c r j k c r j q m r 3 j k n r 1 i r m 1 r m s r j k s r j q m r 3 λ k s e m β q k the pair of eqs 36 and 37 represents a complex algebraic system the system must be truncated to a finite number of orders which must be sufficient to achieve convergence although complicated the system is linear and can be solved using standard matrix techniques introducing next eqs 36 and 37 into the total velocity potential for body k which is given in normalized form by eq 35 the following compact form for ϕ k immediately yields 38 ϕ k u k v k z 2 i g a ω z 0 z z 0 h m 0 i m c m k c e m v k q k k c m k m c m 3 u k q k m c m 1 u k q k m 1 i m s m k s e m v k q k k s m k m s m 3 u k q k m s m 1 u k q k equation 38 can be further simplified if we calculate ϕ k precisely on the elliptical boundary of body k on u k u k 0 in this case the total velocity potential will read 39 ϕ k u k 0 v k z 4 π g a ω z 0 z z 0 h m 0 i m c m k c e m v k q k m c m 3 u k 0 q k m 1 i m s m k s e m v k q k m s m 3 u k 0 q k for the derivation of eq 39 we used the following wronskian relations mclachlan 1947 40 m c m 1 u k 0 q k m c m 3 u k q k m c m 3 u k 0 q k m c m 1 u k q k m s m 1 u k 0 q k m s m 3 u k q k m s m 3 u k 0 q k m s m 1 u k q k 2 i π 6 hydrodynamic loading the linear hydrodynamic loading forces and moments are obtained by integrating the hydrodynamic pressure on the wetted surface of each body in the array using only the linear term in bernoulli s equation the surge sway forces roll pitch and yaw moments will be given by 41 f x k i ω ρ b k 0 h 0 2 π ϕ k u k 0 v k z cos v k d v k d z 42 f y k i ω ρ a k 0 h 0 2 π ϕ k u k 0 v k z sin v k d v k d z 43 m x k i ω ρ a k 0 h 0 2 π z ϕ k u k 0 v k z sin v k d v k d z 44 m y k i ω ρ b k 0 h 0 2 π z ϕ k u k 0 v k z cos v k d v k d z 45 m z k i ω ρ c k 2 2 0 h 0 2 π ϕ k u k 0 v k z sin 2 v k d v k d z the roll and pitch moments are taken with respect to the foundation at z 0 substituting eq 39 into eqs 41 45 and performing the integrations we obtain the following normalized forms of the various components of the hydrodynamic loading 46 f x k ρ g a a k 2 4 i k 0 b k k 0 a k 2 tanh k 0 h m 0 i m a 1 m q k c m k m c m 3 u k 0 q k 47 f y k ρ g a a k 2 4 i 1 k 0 a k tanh k 0 h m 1 i m b 1 m q k s m k m s m 3 u k 0 q k 48 m x k ρ g a a k 3 4 i 1 k 0 a k 2 1 cosh k 0 h k h 1 m 1 i m b 1 m q k s m k m s m 3 u k 0 q k 49 m y k ρ g a a k 3 4 i k 0 b k k 0 a k 3 1 cosh k 0 h k h 1 m 0 i m a 1 m q k c m k m c m 3 u k 0 q k 50 m z k ρ g a a k 3 2 i k 0 c k 2 k 0 a k 3 tanh k 0 h m 1 i m b 2 m q k s m k m s m 3 u k 0 q k where a n m q k and b n m q k denote the expansion coefficients of the even and odd periodic mathieu functions see appendix a the results for the hydrodynamic loading presented in the sequel concern four different arrays the in line array of five cylinders of fig 2 a and the similar in line array with nine cylinders fig 2 c the same nine cylinder array with reversed slenderness radio fig 2 d and finally the square array of fig 2 b in all cases considered the cylinders are surface piercing and their freeboard is sufficiently high and no overtopping is allowed the cylinders are identical having a slenderness ratio b a 0 4 the array of fig 2 c is used to investigate the trapped modes of elliptical cylinders against the trapped modes of circular cylinders it is also used as an additional means of validation using the in line array of circular cylinders suggested for investigation by maniar and newman 1997 the square array of fig 2 b serves as a subject to investigate in phase and out of phase loading particulars the water depth to semimajor axis ratio is h a 0 8 for fig 2 a and b and equal to h a 1 0 for fig 2 c and d the in line array of nine cylinders of fig 2 c was also used to check the convergence of the analytical method developed and employed herein given that the problem is considered within the realm of the linear theory it should be anticipated that only a few number of modes orders of products of periodic and radial mathieu functions elliptical harmonics are sufficient to achieve tolerable convergence such a convergence study relative to the truncation of the infinite sums is conducted in fig 3 showing the normalized sway force for all normalizations used herein see the legends of the axes under beam seas β 90 o in total results are presented for three cylinders the outer cylinders and the middle one it is immediately evident that convergence is achieved rapidly with only a few number of modes letting the truncation be m 5 a convergence up to the third significant digit is achieved while additional modes are required as expected for higher wave frequencies nevertheless use of additional modes does not compromise the robustness and the celerity of the present analytical method the case considered in fig 3 is revisited in section 8 utilising a different normalization for the wave frequency the particulars of the hydrodynamic loading exerted on the five cylinders array of fig 2 a are examined herein with the aid of figs 4 12 which investigate all modes of the linear hydrodynamic loading i e surge and sway forces and roll pitch and yaw moments it should be noted that surge and sway forces literally provide the patterns for pitch and roll overturning moments respectively results are shown for three different angles of heading namely β 0 o 45 o and 90 o with respect to the horizontal x axis of the global x y system that is always fixed on the centre of the body no 1 b1 for the limiting case of β 0 o the surge forces fig 4 on the pairs of cylinders b1 b5 and b2 b4 are the same due to symmetry the surge force on the middle cylinder is different but overall the results are comparable for the complete interval of wave frequencies a maximum occurs at approximately k 0 a 1 but otherwise the hydrodynamic interactions although evident are not that strong as expected the pattern for the pitch moments fig 7 is provided by the surge forces fig 4 and by analogy the pattern for the roll moments fig 6 is provided by the sway forces fig 5 again due to symmetry the sway forces and roll moments for the pairs of cylinders b1 b5 and b2 b4 are equal whereas the hydrodynamic interactions cancel f y and m x in the middle cylinder the sway force exhibit sharp amplifications fig 5 and by analogy such is the case for the roll moment as well these amplifications occur in the form of repeated peaks in the associated curves the specific phenomenon is tightly correlated with strong hydrodynamic interactions which aside from the increase in loading induce strong free surface elevations between the cylinders as well this is a clear evidence of wave trapping between the cylinders which will be encountered many times in the discussion of the computations as expected for the specific wave heading angle and the particular inline arrangement the yaw moment is zero for the middle cylinder although it appears that the yaw moment is not directly connected with any other mode of loading a careful inspection of fig 8 reveals that it exhibits local maxima at approximately the same wave frequencies detected for the sharp peaks of the sway force and roll moment the occurrence of peaks in loading is more evident when the angle of heading is 90 o fig 9 here only the sway force and hence the roll moment that was omitted for brevity is non zero sharp peaks occur at the same wave frequencies as for β 0 o which however are more profound the maximum loading corresponds to the middle elliptical cylinder similar conclusions analogous to those for β 0 o and 90 o can be drawn for the oblique heading of β 45 o see figs 10 12 the placement of the cylinders in connection with the wave heading cancels any type of symmetry and accordingly no mode of loading is zero to any module of the array here the hydrodynamic interactions are more effective while it is very important to observe the occurrence of sharp peaks in the sway force and roll moment again precisely at the same wave frequencies which have been already detected for β 0 o and 90 o next the square array shown in fig 2 b is considered the magnitudes of the hydrodynamic loading components are shown in figs 13 19 for three heading angles i e β 0 o 45 o and 90 o the centres of the elliptical cylinders are situated at the corners of a 3 a 3 a square aside from the evident strong hydrodynamic interactions incurred by the bodies the general conclusions drawn previously for the in line arrangement are valid for the square arrangement as well a brief list of the general observations that could be made is i the surge forces provide the pattern for the pitch moments and the sway forces provide the patterns for the roll moments as expected and highlighted previously ii the symmetrical placement of the bodies leads to symmetric loading in pairs of cylinders for β 0 o and 90 o iii it is very interesting to observe the strong wavy trend of the sway forces and roll moments for the oblique heading of β 45 o and 90 o iv the variation of the linear hydrodynamic loading is in general rather unpredictable and strongly depends of the geometry of the array v peaks in loading are also evident which are again connected with hydrodynamic resonances the sharp amplifications associated with the peaks correspond to different wave frequencies compared to the in line arrangement here k 0 a 3 and 5 5 e g figs 13 and 14 and can be said that they are independent of β therefore their occurrence is literally a function of the layout of the array and apparently the size s of the cylinders indeed other layouts of four elliptical cylinders examined previously by chen and lee 2013 led to no observation of trapped modes for β 0 o supporting the observations of the present that the layout of the cylinders pay a leading role to the development of trapped modes the specific array of four cylinders fig 2 b is used to provide further insight in a particular feature of the hydrodynamic loading which is the loading phase bai et al 2014 examined an array of four circular cylinders placed in a similar square configuration and they concluded that the loading on some bodies are in phase whereas it is out of phase on others here the situation is much more complicated as the cylinders are elliptical in phase or out of phase occurrences are related only with some kind of symmetry in impact and therefore we restrict our attention only on the limiting cases of β 0 o and 90 o here results are presented only for the former case of wave heading figs 20 and 21 for β 0 o in particular the sway force roll and yaw moments on the pairs of cylinders b1 b4 and b2 b3 are out of phase while on the same pairs the surge force and the pitch moment are in phase it must be noted that for the wave heading of 90 o the surge force and pitch moment on the pairs of cylinders b1 b2 and b3 b4 are out of phase while in phase are the sway force and roll moment for the same pairs of cylinders the yaw moment is out of phase indicative results that depict the specific behaviour are given in figs 20 and 21 and they concern the out of phase feature of the sway force and yaw moment for β 0 o note that results are presented only for the pair b1 b4 as the results for the pair b2 b3 are similar and would not add more to the argument 7 wave trapping in the array among the various important characteristics associated with the hydrodynamics and the loading exerted on arrays of elliptical cylinders admittedly the most intriguing feature is connected with the resonance behaviour that occurs at specific and repeated wave frequencies those resonances which were observed for both arrays investigated in the present independently on the particulars of the incoming waves i e the excitation and the mode of the hydrodynamic loading s are better shown in fig 9 for the sway forces and roll moments on the modules of the inline configuration of fig 2 a two peaks are evident while one could assume positively the occurrence of smaller resonances at higher wave frequencies a careful inspection of the magnitudes of the sway forces and the roll moments exerted on the elliptical cylinders will verify that the maximum value corresponds to the middle body of the array of five bodies this finding is somehow peculiar as the middle body had to be protected given the fact that the body that faces the propagating wave train is b1 in addition even the last body b5 experiences the action of a sharp amplification in loading in this context a rational explanation for the behaviour under consideration could be that at the specific wave frequencies waves are trapped in the liquid region between the bodies which accordingly induce peaks in the exciting forces and moments clearly these resonances and the trapping of waves should be reflected as strong free surface elevations between the cylinders and on the wetted surfaces of the cylinders analogous sharp increases in hydrodynamic loading are observed in arrays of circular cylinders it is noted that to the authors best knowledge arrays of multiple bodies other than circular cylinders were never investigated so far in the study of maniar and newman 1997 the authors investigated the water wave diffraction by an inline array of nine circular cylinders and they observed similar resonance results captured as peaks in the transfer functions of the linear exciting forces according to maniar and newman 1997 this phenomenon is related to the existence of trapped waves in a channel in particular the first peak first trapped mode corresponds to a neumann condition on the walls of the channel while the second peak second trapped mode corresponds to a dirichlet condition and is attributed to a non physical channel where the velocity potential rather than its normal derivative vanishes on the walls dirichlet type trapped modes are known to exist in the acoustic context subsequent peaks in loading were associated with nearly trapped waves where radiation is weak but non zero as noted by evans and porter 1999 only for infinite arrays there are pure trapping of waves known as rayleigh bloch or edge waves which for particular dominant wavenumbers reduce to well known trapped mode solutions for a cylinder between two parallel walls having either neumann or dirichlet boundary conditions upon them for a finite number of cylinders such as in the present study as well as for all studies reported in the literature that consider only arrays of circular cylinders a trapped mode literally means near wave trapping associated however with small but non zero transmission of energy radiated to infinity hence in order to avoid possible confusions it is made clear that all trapped mode and wave trapping cases including neumann and dirichlet discussed in the sequel actually refer to near trapping phenomena trapped modes namely the resonance wavenumbers are determined by the homogeneous solutions of the matrix equation that provides the expansion coefficients of the diffraction component of the potential according to the present approach the matrix equation is constructed by the linear eqs 36 and 37 and can be written as 51 b f i or s 1 l b n s f s i n where l is explicitly defined by the truncation used for the order of the mathieu functions and the number of bodies in the array let us assume that the indices j k 1 n denote the number of the body the indices r m 0 1 m denote the modes of the mathieu functions which are taken into account and the indices p l 1 2 denote even expansion coefficients for p l 1 and odd expansion coefficients for p l 2 therefore assuming n bodies in the array and m orders for the mathieu functions b will be a 2 m 1 n 2 m 1 n square matrix the elements of the matrix b are determined by letting n 2 k 1 m 1 m l and s 2 j 1 m 1 r p further for p 1 f s c r j c r 1 j while for p 2 f s s r j c r 2 j where c r p j p 1 2 is a global notation of either c r j or s r j following chatjigeorgiou and mavrakos 2010 the elements of the matrix b will be given by 52 b n s δ k j δ m r δ l p g m r l p k j n 2 k 1 m 1 m l s 2 j 1 m 1 r p where 53 g m r 1 1 k j 1 δ k j i r m k c r j q m r j g m r 1 2 k j 1 δ k j 1 δ 0 r i r m 1 1 r k s r j q m r j g m r 2 1 k j 1 δ k j i r m 1 1 m 1 k c r j q m r j g m r 2 2 k j 1 δ k j 1 δ 0 r i r m 1 r m k s r j q m r j the right hand side term of eq 51 is written as 54 i n λ k c e m β q k i n 1 δ 0 m λ k s e m β q k l 1 l 2 n 2 k 1 m 1 m l pure wave trapping in the array namely zero energy radiation to the far field is achieved when the determinant of b is explicitly zero nevertheless for a finite array a trapped mode actually a near trapped mode is detected by the minimization of the determinant which accordingly ensures maximum expansion coefficients and through the compact formulae of eqs 46 50 sharp amplifications of the hydrodynamic loading components in the present analysis the computation of the wavenumbers that secure det b 0 is by no means an easy task due to the extremely complicated structure of the square matrix b this is noted in contrast to the relatively easy way to compute the trapped modes for an array of circular cylinders as implemented for instance by evans and porter 1999 here in order to show the connection between the peaks in loading and the homogeneous solution of the matrix εq 51 we have calculated the determinant of b throughout the investigated frequency range nevertheless we emphasize in small intervals around the peaks in loading figs 22 and 23 show exactly the minimum values of det b which are associated with the wavenumbers that lead to sharp amplifications in loading clearly the minima correspond to the first two peaks that can be easily detected in fig 9 eventually a trapped mode essentially a near trapped mode is literally a property of the array assuming a given geometry placement orientation of the cylinders and apparently dimensions including the water depth in other words a trapped mode is independent of the excitation a hydrodynamic resonance in the form of wave trapping is excited when the wavenumber i e the frequency of the incoming waves falls in the vicinity of a homogeneous solution of the matrix εq 51 that eventually explains the peaks in loading which are easily observed for all heading angles 8 free surface elevation at trapping modes in the array the free surface elevation at the leading linear order for an arbitrary cylinder k can be calculated by the generic formula 55 η k i ω g ϕ k letting z h thus using eq 38 one gets 56 η k u k v k a 2 m 0 i m c m k c e m v k q k k c m k m c m 3 u k q k m c m 1 u k q k m 1 i m s m k s e m v k q k k s m k m s m 3 u k q k m s m 1 u k q k accordingly using eq 39 the surface elevation on the boundary of the cylinder k becomes 57 η k u k 0 v k a 4 i π m 0 i m c m k c e m v k q k m c m 3 u k 0 q k m 1 i m s m k s e m v k q k m s m 3 u k 0 q k the free surface elevation is typically expressed normalized by the wave amplitude as indicated in eqs 56 and 57 it is very important to note that those expressions provide the free surface elevation everywhere with respect to the local coordinate system of the specifically chosen body k this fact is underlined as the mathieu functions addition theorem is not valid everywhere as noted by særmark 1959 see also fig 1 the area where the addition theorem and accordingly the potential and the free surface elevation is valid is explicitly determined by the separation distance between the centres of the cylinders and their half foci distances as a general rule eqs 56 and 57 are valid around the cylinder k but they may fail close to another cylinder therefore special attention must be paid in the separation distances when designing the array the strong variations in hydrodynamic loading see e g figs 9 12 imply that analogous profound phenomena should be expected in the free surface elevation in the liquid regions between the cylinders figs 24 and 25 depict such occurrences that explicitly correspond to the hydrodynamic resonance frequencies of figs 22 and 23 in fact the direction of the propagating waves is immediately detected by the maximum values of the depicted contours for the higher wave frequency the contours as expected are denser for the oblique heading fig 24 the elevation has no regularity several maxima occur at positions which are difficult to be anticipated without solving the problem in contrast for beam seas fig 25 the contours are symmetrical with respect to x 0 axis it is interesting to observe that the maximum elevation occurs in internal regions demonstrating the occurrence of wave trapping in the specific example the wave trapping causes strong free surface elevations up to 3 5 a and 5 5 a for the two investigated heading angles 9 arrays of elliptical cylinders against arrays of circular cylinders in the context of the present study we have made computations on several body arrangements clearly each arrangement features its own characteristics in terms of the hydrodynamic interactions it is important however to highlight particular findings associated with the long in line configuration shown in fig 2 c and d the specific array was extended to include up to nine elliptical cylinders the mutual feature in all cases was that the maximum loading was undertaken by the body ies located in the middle of the array as expected the maximum loading was connected with severe free surface elevation wave trapping it is also interesting to note that the magnitudes of the exciting forces are increased as well for example the peak in sway force under 90 o of heading on the dirichlet trapped mode and on the middle body fifth in the array of nine bodies was found to be nearly double the sway force under the same angle on the middle body third in the array of five bodies see e g figs 9 and 26 note also the difference in the representation of the normalized wave frequency the peaks in neumann trapped modes however are comparable one could rationally deduce that extending the array with more bodies the wave trapping phenomena become more profound reducing the amount of energy radiated to the far field concentrating energy between the bodies accordingly leads to increased loading as using more bodies one could claim that approaches to some extend apparently pure trapping the analysis that is conducted in the present is completed by contrasting the hydrodynamic interaction characteristics induced by arrays of circular and elliptical cylinders that is performed with the aid of figs 26 and 28 which shows the sway force in the middle bodies fifth of two arrays of only elliptical and only circular cylinders in both cases the heading angle was taken equal to 90 o the case studies were taken from the work of maniar and newman 1997 who investigated a long array of nine circular cylinders in an inline arrangement with equal spacing between subsequent bodies between centres 2 d with a d 1 2 and a d 1 4 respectively see also fig 2 c and d figs 26 29 use the wavenumber normalization and the radius to depth ratio a h 1 adopted by maniar and newman 1997 for obtaining the results shown for the array of the circular cylinders we used the analytical method outlined in the present assuming simply that b a semi minor to semi major axis is equal to 0 99 the load on a single cylinder has been also included the relevant computations were performed using again the present analytical method assuming very large distances between two bodies d furthermore figs 27 and 29 demonstrate the effect of b a in order to highlight the effects of the different symmetry properties of an ellipse compared to a circle it should be noted here that according to the notation given in fig 1 the semi major axis is a and the semi minor axis is b hence it always stands that a b for simplicity we have changed this notation for clarity purposes only for the discussion of figs 27 and 29 b a 1 referring to the layout presented in fig 2 c and b a 1 referring to the layout presented in fig 2 d concerning figs 26 and 28 which correspond to two discrete separation distances the array of the elliptical cylinders was designed onto the array of the circular cylinders by simply letting b a 0 4 those figures can be used as additional means of validation of the outlined methodology although its efficacy has been already demonstrated independently in the past see for instance chen and lee 2012 who validated their own numerical method against the results reported by chatjigeorgiou and mavrakos 2010 the computations depicted in figs 26 and 28 explicitly coincide with those reported by maniar and newman 1997 the magnitudes of peaks being precisely equal and occurring at explicitly the same wavenumbers as noted by maniar and newman 1997 the connection of the circular cylinders array with trapped waves may seem surprising since the peaks in loading arise from the diffraction of waves past a finite array in an otherwise unbounded fluid domain again as indicated in maniar and newman 1997 the diffraction of waves β 90 o past an infinite array is equivalent to that of a single cylinder in a channel in accordance with the method of images and this explains the first peak in figs 26 and 28 this occurs below the critical cut off value k 0 d π 2 implying a neumann trapped mode which is also associated with singular added mass in sway the second peak implies a dirichlet trapped mode which occurs below the critical cut off value k 0 d π the subsequent peaks in figs 26 and 28 are associated with nearly trapped waves where the radiation of energy is weak but not zero maniar and newman 1997 figs 26 and 28 reveal a pronounced differentiation between the small and the large spacing cases in the former case shown in fig 26 aside from the fundamental neumann and the dirichlet trapped modes there is no indication for the occurrence of near trapped modes in larger frequencies there are some insignificant singularities which could be attributed to other weak near trapped mode effects e g standing waves between the cylinders in contrast wider open liquid spaces between cylinders allow stimulation of nearly wave trapping singularities as implied in fig 28 for the elliptical cylinders array trapped mode occurrences are indeed observed which in addition appear to be more effective in fact the neumann trapped mode coincides with that of the circular cylinders implying that it depends only on the separation distance this allegation is also supported by figs 27 and 29 which demonstrate the effect of slenderness in addition to the change in the orientation of the semi major axes relative to the wave propagation for the small spacing fig 26 the largest peak is not the neumann mode as is the case for the circular cylinders but the second peak dirichlet mode indeed this peak is about four times the sway force on a single elliptical cylinder as shown in fig 27 where the sway force is plotted for several slendernesses in the interval 0 2 b a 2 5 the magnitude of the peak loading increases as b a 0 for the large spacing case fig 28 the second peak corresponding to the dirichlet trapped mode falls in the same wavenumber for both geometries this however is not the case for the small spacing arrangement fig 26 in the particular case of large spacing one can observe near trapped mode occurrences along the whole range of interest in terms of the wavenumber values the nature of these trapped modes in particular whether they could be interpreted as neumann or dirichlet near trapped modes is left for a future endeavour however it can be said that near trapped modes depend on the spacing between the cylinders and it is more possible to occur for larger open liquid areas this assertion is implied by the fact that elliptical cylinders compared to circular cylinders allow lengthier liquid regions between adjacent bodies for the large spacing case figs 28 and 29 the first and second peak neumann and dirichlet appear larger for the circular geometry while the third peak which is similar in magnitude to the second is larger for small values of b a in this case and for b a 1 both the neumann and the dirichlet trapped modes appear to be independent of b a and occur in k 0 d π 0 47 0 5 and in k 0 d π 0 94 1 respectively which are not the same frequencies as for the small spacing case but comparable to sum up one should notice from figs 27 and 29 that both the magnitudes and occurrences of the trapped modes are dependent on three parameters i the distance between the bodies a d ii the slenderness of the body b a and iii the orientation of the body whether b a 1 fig 2 c or b a 1 fig 2 d in both spacing cases the neumann mode occurs always at the same frequency and definitely below the first cut off point k 0 d π 0 5 while for the cases that involve larger spacing the dirichlet mode also occurs at almost the same frequency and definitely below the associated cut off point k 0 d π 1 0 furthermore in some cases larger open fluid spaces lead to larger magnitudes but that depends on the b a ratio of the body with b a 1 circular cylinder always describing a threshold this limit defines the orientation of the bodies and accordingly there is strong indication that for b a 1 trapping and near trapping becomes weak and hence the phenomenon much less profound indeed it is shown for both spacing cases that when b a 2 5 the largest sway force exerted in an array of elliptical cylinders is only marginally larger than the same force on a single elliptical cylinder indications of which are shown in fig 29 this finding is a possible explanation for the observations made by chen and lee 2013 where no observation of near trapped modes was made for certain layouts of the elliptical cylinders they considered based on the present calculations the circular cylinder appears to constitute a threshold this is also apparent in the study of mciver et al 2001 who examined near trapped mode effects above the cut off frequency k 0 d π 0 5 for ellipses in the middle of a channel the slendernesses they considered varied in the interval 0 2 b a 2 5 in the latter work the above i iii combined effects also appear to affect the development and occurrence of trapped modes 10 conclusions the problem of the hydrodynamic diffraction by arrays of elliptical cylinders was considered the solution of the problem was achieved completely analytically by employing the mathieu functions addition theorem that converts one elliptic coordinate system to another which are separated by a distance between them the solution provided is multi task as elliptical cylinders can approximate effectively circular cylinders or plates in the two limiting cases several numerical results were presented focusing on two characteristic arrangements i e an inline configuration and a square configuration the presented data considered all modes of hydrodynamic loading i e surge sway forces and roll pitch and yaw moments extending the available data in the existing literature that concern only forces chatjigeorgiou and mavrakos 2010 chatjigeorgiou 2011 2013 chen and lee 2012 2013 the developed analytical method was proven to be robust and efficient requiring limited cpu time for the computations the computations demonstrated the stimulation of hydrodynamic resonances in the form s of the so called trapped modes the concerned resonances were reflected as sharp peaks in loading at specific wave frequencies which were independent from the particulars of the propagating wave train those hydrodynamic resonances were rationally associated with the occurrence of the wave trapping phenomenon in the liquid region s between the bodies trapping and near trapping phenomena are well treated in the literature for circular cylinders and the present study extends the gained knowledge on the topic by containing elliptical cylinders as well wave trapping phenomena were connected with the homogeneous solution of the linear matrix equation that provides the expansion coefficients of the diffraction component s besides the hydrodynamic loading the strong effect of the trapped modes to the free surface elevation between the cylinders and accordingly to drastic reduction of the amount of energy radiated to the far field was shown through free surface elevation contours which reached up to more than five times the amplitude of the incoming waves further comparisons between circular and elliptical cylinder arrays showed that elliptical cylinders are more effective as wave trapping arrangements allowing additional near trapped modes to develop the last aspect of the complicated interaction phenomenon considered in the present was the in phase and the out of phase loading on the cylinders which could occur under specific conditions of symmetry it can be said that the stimulation of near trapped modes strongly depends on the spacing between adjacent cylinders the slenderness of the ellipse and the orientation of the body in particular the neumann trapped mode appears to be explicitly dependent on the spacing between adjacent cylinders which is not the case for the dirichlet trapped mode and other near trapped modes of higher frequency where the slenderness of the ellipse and the orientation of the body affects their appearance and magnitude additionally for the dirichlet trapped mode and other near trapped modes the case of the circular cylinder appears as a threshold to the stimulation of trapped and near trapped modes finally it should be mentioned that phenomena of increased surface elevations due to resonance such as trapping will involve also nonlinear effects and the increase in crest elevation may be much larger acknowledgements the authors are grateful to professor j n newman for the stimulating discussions concerning this research this research did not receive any specific grant from funding agencies in the public commercial or not for profit sectors appendix a formulae for the periodic and the modified mathieu functions a 1 even and odd periodic mathieu functions a 1 c e 2 r v q k 0 a 2 k 2 r q cos 2 k v a 2 c e 2 r 1 v q k 0 a 2 k 1 2 r 1 q cos 2 k 1 v a 3 s e 2 r 1 v q k 0 b 2 k 1 2 r 1 q sin 2 k 1 v a 4 s e 2 r 2 v q k 0 b 2 k 2 2 r 2 q sin 2 k 2 v where a 2 k 2 r a 2 k 1 2 r 1 b 2 k 1 2 r 1 and b 2 k 2 2 r 2 are the expansion coefficients of the periodic mathieu functions which are functions of the mathieu parameter q a 2 even and odd modified mathieu functions the modified mathieu functions can be expressed as series of bessel functions according to abramowitz and stegun 1970 a 5 c e 2 r u q c e 2 r π 2 q a 0 2 r q k 0 1 k a 2 k 2 r q j 2 k 2 q cosh u c e 2 r 0 q a 0 2 r q k 0 1 k a 2 k 2 r q j 2 k 2 q sinh u a 6 c e 2 r 1 u q c e 2 r 1 π 2 q q a 1 2 r 1 q k 0 1 k 1 a 2 k 1 2 r 1 q j 2 k 1 2 q cosh u c e 2 r 1 0 q q a 1 2 r 1 q coth u k 0 2 k 1 a 2 k 1 2 r 1 q j 2 k 1 2 q sinh u a 7 s e 2 r 1 u q s e 2 r 1 π 2 q q b 1 2 r 1 q tanh u k 0 1 k 2 k 1 b 2 k 1 2 r 1 q j 2 k 1 2 q cosh u s e 2 r 1 0 q q b 1 2 r 1 q k 0 b 2 k 1 2 r 1 q j 2 k 1 2 q sinh u a 8 s e 2 r 2 u q s e 2 r 2 π 2 q q b 2 2 r 2 q tanh u k 0 1 k 1 2 k 2 b 2 k 2 2 r 2 q j 2 k 2 2 q cosh u s e 2 r 2 0 q q b 2 2 r 2 q coth u k 0 2 k 2 b 2 k 2 2 r 2 q j 2 k 2 2 q sinh u also as series of products of bessel functions are given by mclachlan 1947 a 9 c e 2 r u q c e 2 r 0 q c e 2 r π 2 q a 0 2 r q 2 k 0 1 k a 2 k 2 r q j k u 1 j k u 2 a 10 c e 2 r 1 u q c e 2 r 1 0 q c e 2 r 1 π 2 q q a 1 2 r 1 q 2 k 0 1 k 1 a 2 k 1 2 r 1 q j k u 1 j k 1 u 2 j k 1 u 1 j k u 2 a 11 s e 2 r 1 u q s e 2 r 1 0 q s e 2 r 1 π 2 q q b 1 2 r 1 q 2 k 0 1 k b 2 k 1 2 r 1 q j k u 1 j k 1 u 2 j k 1 u 1 j k u 2 a 12 s e 2 r 2 u q s e 2 r 2 0 q s e 2 r 2 π 2 q q b 2 2 r 2 q 2 k 0 1 k 1 b 2 k 2 2 r 2 q j k u 1 j k 2 u 2 j k 2 u 1 j k u 2 where u 1 q e u and u 2 q e u alternative forms of the modified mathieu functions also referred as radial mathieu functions are meixner and schäfke 1954 a 13 m c 2 r j u q 1 c e 2 r 0 q k 0 1 k r a 2 k 2 r q z 2 k j 2 q cosh u 1 r c e 2 r π 2 q k 0 a 2 k 2 r q z 2 k j 2 q sinh u a 14 m c 2 r 1 j u q 1 c e 2 r 1 0 q k 0 1 k r a 2 k 1 2 r 1 q z 2 k 1 j 2 q cosh u 1 r 1 coth u c e 2 r 1 π 2 q k 0 2 k 1 a 2 k 1 2 r 1 q z 2 k 1 j 2 q sinh u a 15 m s 2 r 1 j u q tanh u s e 2 r 1 0 q k 0 1 k r 2 k 1 b 2 k 1 2 r 1 q z 2 k 1 j 2 q cosh u 1 r s e 2 r 1 π 2 q k 0 b 2 k 1 2 r 1 q z 2 k 1 j 2 q sinh u a 16 m s 2 r 2 j u q tanh u s e 2 r 2 0 q k 0 1 k r 2 k 2 b 2 k 2 2 r 2 q z 2 k 2 j 2 q cosh u 1 r 1 coth u s e 2 r 2 π 2 q k 0 2 k 2 b 2 k 2 2 r 2 q z 2 k 2 j 2 q sinh u where j 1 2 3 4 denotes the kind of the radial mathieu function while the correspondence between z m j functions and the bessel and hankel functions is z m 1 j m z m 2 y m z m 3 h m 1 and z m 4 h m 2 the radial mathieu functions eq a 13 a 16 can also be expressed as series of bessel function products meixner and schäfke 1954 the associated formulae read a 17 m c 2 r j u q 1 a 0 2 r q k 0 1 k r a 2 k 2 r q j k u 1 z k j u 2 a 18 m c 2 r 1 j u q 1 a 1 2 r 1 q k 0 1 k r a 2 k 1 2 r 1 q j k u 1 z k 1 j u 2 j k 1 u 1 z k j u 2 a 19 m s 2 r 1 j u q 1 b 1 2 r 1 q k 0 1 k r b 2 k 1 2 r 1 q j k u 1 z k 1 j u 2 j k 1 u 1 z k j u 2 a 20 m s 2 r 2 j u q 1 b 2 2 r 1 q k 0 1 k r b 2 k 2 2 r 2 q j k u 1 z k 2 j u 2 j k 2 u 1 z k j u 2 a 3 orthogonality of periodic mathieu functions the periodic mathieu functions satisfy the following orthogonality relations abramowitz and stegun 1970 a 21 0 2 π c e r v q c e m v q d v 0 2 π s e r v q s e m v q d v π δ r m a 4 global notation of the periodic and the radial mathieu functions meixner and schäfke 1954 provide the following compact notations for the periodic and radial mathieu functions a 22 c e r v q 2 1 2 m e r v q r 0 1 2 a 23 s e r v q i 2 1 2 m e r v q r 1 2 a 24 m r j u q m c r j u q r 0 1 2 a 25 1 r m r j u q m s r j u q r 0 1 2 a 5 expansion coefficients for the periodic mathieu functions m e r v q the periodic mathieu functions m e r v q can be expanded as a 26 m e r v q s c 2 s r q e i r 2 s v with a 27 d 2 s r q 1 s c 2 s r q d 2 s 1 r q 0 a 28 d 2 s r q 1 s c 2 s r 2 s q d 2 s 1 r q 0 the relations between the expansion coefficients d and d and the expansion coefficients of the even and odd periodic mathieu functions are chatjigeorgiou and mavrakos 2010 a 29 d s r r q 2 1 2 1 s r 2 a r s q s 0 1 2 d s r r q 2 1 2 1 s r 2 b r s q s 1 2 d 2 s 0 q 2 1 2 1 s a 0 2 s q r 0 a 30 d s r r q 2 1 2 1 s r 2 a s r q r 0 1 2 d s r r q 2 1 2 1 s r 2 b s r q r 1 2 d 2 r 2 r q 2 1 2 1 r a 0 2 r q s 0 
23422,the main objective of the present study is to establish a practical design strategy of air balloons for a suppression of the propeller cavitation induced hull pressures at multi frequencies theoretical foundation is initiated with the existing modal series solution of a multiple scattering problem an approximated form is then derived by a monopole regime which is valid in a low frequency range subsequent parametric analysis with a variation of the separation distance between the balloons provides an analytical evidence that the mutual interaction can be neglected unless they are too close to each other hence it is addressed that the individual balloon can be designed separately without a consideration of their coupling characteristics finally the water tunnel test with two balloons demonstrates noticeable vibration reductions at the first and second order of blade passing frequencies by 72 and 59 respectively keywords propeller cavitation multi frequency excitation air balloon destructive interference glossary a radius of spherical balloon m c speed of sound m s c q q th order scattering amplitude of an isolated air balloon d separation distance between the balloons m f frequency hz ϕ azimuthal angle rad g relative density ρ a ρ w h relative sound speed c a c w h q q th order spherical hankel function i 1 j q q th order spherical bessel function λ wavelength m k wavenumber rad m n q q th order spherical neumann function n number of spheres or balloons p pressure pa p 0 amplitude of incident plane wave pa p total total pressure p inc p scat pa p q p q th order associated legendre function p tunnel pressure in tunnel bar q order of wave q truncation order q pqpm translational coefficient θ polar angle rad r radial distance from the origin of sphere m ρ density kg m3 t time s v t water flow speed in tunnel m s ω frequency rad s z impedance rayls kg m3 m s subscripts a air des destructive interference eq equivalent inc incident wave res resonance scat scattered wave total total wave w seawater 1 introduction the previous single nozzle air injection scheme lee et al 2014 discovered a possibility to suppress propeller cavity induced hull exciting pressure by means of an acoustic phenomenon known as the destructive interference when a pressure wave generated by cavitating propeller strikes on the injected air whose acoustical impedance i e a product of density and sound speed is much less than that of water the phase of scattered or reflected wave becomes totally reversed this results in a cancellation of the incident and the scattered pressure in the total field as shown in table 1 similar acoustic impedance between rubber and water motivated our recent work lee et al 2015a in this approach a rubber layer at water to air interface appears to be acoustically transparent it was shown that the air filled rubber membrane hereinafter the balloon plays a specific role of air packing without any influence on the desired destructive interference accordingly an effort of the air injection could be made unnecessary by attaching such a simple air balloon on the stern hull surface as shown in fig 1 a for verifications in the full scale ship lee et al 2015b presented sea trial measurements by manufacturing 1 1 m 1 1 m sized inflatable balloon the balloon showed its effectiveness by attaining a noticeable hull vibration reduction of 65 at the exciting frequency of interest based on the ideal gas law a method of how to inflate the balloon to the design size and to keep it constant despite draught changes was treated as well the authors would like to emphasize that the phenomenon of acoustic cancellation takes place only at a certain frequency however it is the so called the frequency of destructive interference which is inversely proportional to the balloon size in other words once a single balloon is tuned to a specific size it alone has no choice but to counteract an excitation at a particular frequency the marine propeller operating in a non uniform wake field generates vibratory hull exciting pressures at several orders of blade passing frequency bpf carlton 2007 weitendorf 1981 the pressure amplitudes are normally descending with the order but we often encounter an occurrence of large pressure amplitudes at higher harmonics for example an excessive tip vortex cavitation may provoke high harmonic amplitudes to be of the same level with that of the lowest order or even higher friesch 1995 1998 hämäläinen and van heerd 1998 then multi balloons shown in fig 1 b can be a natural measure to control such excitations at several frequencies as they are anticipated to make destructive interferences at different frequencies the scope of this research is interested in reaching a design methodology for the balloons using the multiple scattering theory when two or more spherical 1 1 the balloon objects in this study will be idealized to spheres for a mathematical convenience its reasoning will be given in section 2 1 bodies are in close proximity to the others there exist mutual interactions between them the solution of multiple scattering requires satisfactions of appropriate boundary conditions on the surfaces of all spheres brunning and lo 1971 for this purpose the so called addition theorem is inevitable to expand spherical wave solutions of the helmholtz equation centered about a given origin into the ones centered about a shifted origin felderhof and jones 1987 applying boundary conditions on each sphere yields a set of simultaneous equations where unknown scattering coefficients are coupled the resulting equations for a general number of spheres are so complicated that it is difficult to get even a numerical solution alternatively a reasonable approach to tackle is to focus on the two spheres problem which was treated in a large volume of published studies twersky 1962 brunning and lo 1971 domany et al 1984 gaunaurd et al 1995 gabrielli and mercier finidori 2001 gumerov and duraiswami 2002 2005 roumeliotis and kotsis 2007 and more the very fundamental problem deserves a thorough investigation because it permits not only an opportunity to explore characteristics of the mutual interaction but also an insight to attain a solution for the case of several spheres more than two to propose a practical design strategy this paper begins with the simplest case of two interacting spherical balloons by employing the formulation of gaunaurd et al 1995 rather than working with the exact solution to the problem we derive its monopole approximation based on a low frequency assumption subsequent parametric study varying the distance between the balloons offers a critical clue that the interaction becomes weak for a large separation this allows the solution even for the general case to be expressible by an algebraic sum of isolated balloon consequently it is addressed that the design strategy for the individual balloon exactly follows the single case this paper takes a structure of four sections including this introductory section section 2 lays out the theoretical formulation and presents the findings of the research it goes on with experimental verifications in section 3 wherein the propeller cavitation test with two balloons exhibits considerable vibration suppressions at the two target frequencies finally this paper closes with conclusions in section 4 2 theory of acoustic scattering for two spherical balloons 2 1 problem formulation and analytic solution as detailed in our previous studies lee et al 2015a 2015b we are concerning for a low frequency range up to several multiples of blade rates so that the corresponding wavelengths can be assumed to be large enough compared to the size of balloon for such an acoustically small object a spherical like wavefront can be approximated as a plane wave across the body s aperture this enables to regard the pressure fluctuation from a cavitating propeller as a plane wave excitation the second assumption is to model the complicated shape of balloon as an ideal sphere scattering by an acoustically small object is insensitive to the shape because details of the geometry are not resolved that is the scattering in the low frequency range is mainly affected by an effective volume of the balloon rather than by its shape weston 1967 unless the aspect ratio of the balloon is too high strasberg 1953 hence the analysis for a spherical balloon would hold for a non spherical case as well owing to the acoustically transparent nature of rubber material we will also not consider the rubber layer necessarily employed for an air packing even if there is a slight difference of the acoustic impedance as usual the resultant effect was found to be insignificant provided that the frequency range of interest is low further discussions on this matter can be found in the introduction part of lee et al 2015a finally the hull plate to which the balloon is attached will not be taken into account for simplicity the presence of rigid wall is equivalent to the presence of a mirror balloon oscillating in phase with the true balloon feuillade 1995 the in phase motion induces a positive mass loading to the external field and lets the attached balloon resonate at a lower frequency than the same balloon in an unbounded medium the amount of frequency shifting is about 17 strasberg 1953 which is obtainable just by the two body multiple scattering model with zero separation distance this only makes the problem at hand more complicated the number of balloons we should deal with is four even for the simplest case of two balloons moreover it does not allow for the solution to be expressed as a closed form that is extremely useful in the subsequent design stage neglecting the presence of hull plate in the current acoustic model would lead to an over prediction for both the resonance frequency and the frequency of destructive interference in some degree a simple tuning for such discrepancy is to inflate the balloon a bit more by supplying an additional air because the key frequency points are expected to move toward a lower range details on this method are elaborated in lee et al 2015b based on the four assumptions in the above we are left with two spherical air balloons immersed in the water as shown in fig 2 the spherical balloons a and b separated by a distance d have the radius a 1 and a 2 a 1 a 2 respectively two spherical coordinate systems o 1 and o 2 can be assumed to lie along the z 1 axis thus a point in the three dimensional space has the coordinates r 1 θ 1 ϕ 1 or r 2 θ 2 ϕ 1 the acoustic impedance of a fluid like medium is given by a multiplication of the density ρ and the longitudinal sound speed c also k ω c denotes the wavenumber where ω 2πf is the angular frequency in radians per second subscripts w and a designate water and air respectively with no loss in generality let there be an incident plane wave of strength p 0 whose propagating direction is lying in x 1 z 1 or x 2 z 1 plane and makes an angle α with respect to the axis of the two balloons it acoustically excites the balloons by which the external scattered wave p scat as well as the internal waves are generated our interest is to investigate the total pressure p total p inc p scat with the solution of p scat proposed by gaunaurd et al 1995 the incident field has the following modal expansion in terms of the spherical harmonics 1 p i n c p 0 q 0 p q q a p q re h q k w r 1 p q p cos θ 1 e i p ϕ 1 where q is the order of wave h q j q in q the q th order spherical hankel function of the first kind j q the spherical bessel function n q the spherical neumann function and p q p p q q 0 the associated legendre function for compactness the time factor e iωt will be omitted throughout this study the coefficient a pq is defined as 2 a p q i q 2 q 1 q p q p p q p cos α note that the expansion 1 of p inc was made about o 1 of the coordinate r 1 θ 1 ϕ 1 for the expansion about o 2 of r 2 θ 2 ϕ 1 the coordinate subscript 1 on the right of equation 1 is changed to 2 where the coefficient a pq in equation 2 differs only by multiplicative phase factor exp ikd cosα obviously the solution p scat can be expressible in the two coordinate systems which is alternately translated to the other coordinate by the use of the addition theorem next the scattered field p scat is composed of the contributions from each balloon 3 p s c a t q 0 p q q b p q 1 h q k w r 1 p q p cos θ 1 b p q 2 h q k w r 2 p q p cos θ 2 e i p ϕ 1 the coefficient b pq 1 or b pq 2 represents the scattering amplitude from balloon a or b in the presence of balloon b or a two coupled linear equations for these unknowns could be derived by enforcing the continuities of acoustic pressures and normal components of the particle velocity on both balloons 4 b p q 1 c q a 1 a p q m p q p q p m b p m 2 b p q 2 c q a 2 a p q e i k d cos α m p 1 q m q p q p m b p m 1 where 5 c q a n g h j q k w a n j q k a a n j q k w a n j q k a a n g h h q k w a n j q k a a n h q k w a n j q k a a n n 1 2 the prime symbol represents derivative with respect to the argument g ρ a ρ w and h c a c w are the relative density and sound speed respectively it is noteworthy that c q a n is consistent with the scattering amplitude of the n th isolated air bubble anderson 1950 thus the second terms in equation 4 account for the mutual interaction between the balloons the translational coefficient q pqpm in the coupled equation was necessarily employed by use of the scalar addition theorem 6 q p q p m i m q 2 q 1 q p q p σ q m q m b σ q p m p h σ k w d where the summation index σ varies from q m to q m by steps of 2 the b σ b σ qpmp coefficient was formally written in terms of a product of two wigner 3 j or clebsch gordan coefficients felderhof and jones 1987 which involved an extensive computation of factorials when the translation is confined to the z 1 axis as our case the recursion formulas in the following can be conveniently adopted without calculating the 3 j coefficient xu 1997 7 b σ 4 a σ 2 a σ 1 4 σ 2 b σ 2 a σ b σ a σ 3 where 8 a σ q n σ 1 q n σ q n σ 1 q n σ 1 2 σ 1 2 σ the two starting values are 9 b q m 2 q 1 2 m 1 2 q 2 m 1 q m q p m p 10 b q m 2 2 q 2 m 3 2 q 1 2 m 1 q m m q 2 q 2 m 1 p 2 b q m now equations from 3 to 10 constitute an analytic expression for the scattered wave p scat estimation of the exact solution requires an evaluation of the coupled coefficients b pq 1 and b pq 2 at each frequency k w by solving the system of linear equations equation 4 however they are infinite a truncation at some point needs to be considered for an actual computation once the truncation wave order q the number of terms used in the summations from q 0 to q is specified equation 4 can be casted into a standard matrix vector form with the order of 2 q 1 2 2 q 1 2 even though the resulting system can be solved by a numerical routine such as lu decomposition sufficient value of q obviously increases with the frequency and so does the required numbers of computation to lessen such a cruel scheme gaunaurd et al 1995 considered the symmetry of translation coefficient q pqpm with respect to the sign of the degree p i e q pqpm q pq pm which is valid for the coaxial arrangement of the balloons in other words the unknowns b pq 1 and b pq 2 need to be computed only for non negative values of p and q then it was possible to break down huge sized problem into solving the matrices of orders 2 q p 1 2 q p 1 for q times in fact gaunaurd et al 1995 reported just the resulting matrix order without giving a detail explanation on the symmetricity of the translation coefficient for further discussions on the related computation the readers are suggested to refer section 15 of gumerov and duraiswami 2001 2 2 monopole approximation in a low frequency range despite of its exactness for a wide range of frequencies the benchmark modal series solution in the previous section is not easy to explore the behavior of scattered waves we need to arrive at a simpler form by an approximation for the concerned low frequencies the dominant term in the series is that with the zeroth order q 0 i e monopole mode that is the balloons are assumed to pulsate in the radial direction only equation 4 then can be free from a tedious summation but just left with zero indices 11 b 00 1 c 0 a 1 1 h 0 k w d b 00 2 b 00 2 c 0 a 2 e i k d cos α h 0 k w d b 00 1 it is also possible for any non dimensional frequencies k i a n and k i d i w a and n 1 2 to be far less than unity in the low frequencies this leads to asymptotic expressions for the incidence angle phase factor exp ikdcos α 1 and for the spherical bessel and hankel functions with small argument morse and ingard 1987 12 j 0 x 1 j 0 x x 3 h 0 x i x h 0 x i x 2 plugging equation 12 into equation 5 and some straightforward algebra produce an approximation of c 0 a n 13 c 0 a n i k w a n k r e s n k w 2 1 where 14 k r e s n 3 g h 2 a n f r e s n c w 2 π 3 g h 2 a n is the resonance frequency of a spherical balloon whose radius is a n and also identical to the one derived by minnaert 1933 with the use of identity of zeroth order legendre function p 0 0 x 1 we proceed to an algebraic form of p scat 15 p s c a t p 0 b 00 1 h 0 k w r 1 b 00 2 h 0 k w r 2 c 0 a 1 1 i c 0 a 2 k w d 1 c 0 a 1 c 0 a 2 k w d 2 i k w r 1 c 0 a 2 1 i c 0 a 1 k w d 1 c 0 a 1 c 0 a 2 k w d 2 i k w r 2 in which the radial function h 0 x was replaced with i x under a near field assumption i e k w r 1 1 and k w r 2 1 lee et al 2015a note that the dependence on the angular variables has disappeared in p scat during the monopole approximation examining the parenthesized terms in equation 15 reveals that the mutual interaction effect dissipates with an increase of the separation distance d thus we can further approximate p scat for a large separation 16 p s c a t p 0 k w a 1 k r e s 1 k w 2 1 1 k w r 1 k w a 2 k r e s 2 k w 2 1 1 k w r 2 the above can be interpreted as a summation of contributions from two isolated balloons hence without loss of generality one can conveniently extend equation 16 to the general case of n balloons 17 p s c a t p 0 n 1 n k w a n k r e s n k w 2 1 1 k w r n where a n is the radius of the n th balloon and r n the distance from its center to the observation point another practical implication of equation 16 is that well separated balloons can be treated independently in the design stage while the interaction does not need to be minded details on the design will be continued after a validation of the proposed approximation to this end we will examine the pressure responses by the following three analytic models i modal series solution in equation 1 ii monopole approximation in equation 15 and iii monopole approximation without the interaction in equation 16 which are designated as exact monopole and non interactive model respectively by keeping the ratio of balloon radius a 1 a 2 as 2 a parametric variation of the separation is taken into account the impedances of water ρ w c w and air ρ a c a are set as 1 5 106 rayls 1000 1500kg m2s and 340 rayls 1 340kg m2s respectively so the resonance frequencies of each balloon are positioned at 0 0125 and 0 0250 respectively on the normalized frequency axis k w a 1 for a computation of the exact model summing the first ten mode for the series q 9 is considered to obtain five digits accuracy as well all the responses are evaluated at the mid point of the balloons i e r 1 r 2 d 2 upper row of fig 3 presents comparisons of amplitude of p scat irrespective of the separation distance the monopole model in the low frequencies i e k w a 1 1 agrees well with the exact except the amplitudes at resonances at the moment it is noteworthy that the role of damping is to describe energy dissipation away from a bubble leighton 1994 but would be significant only around the resonance frequencies crandall 1970 the approximation of spherical function made in equation 12 is essentially equivalent to a negligence of the prescribed damping that is why the sharp peaks are displayed in the monopole model fortunately it would be appropriate to disregard the limitation in describing the peak amplitude in a sense that the balloon design is involved with the frequency points of resonance and destructive interference not with the associated amplitudes the non interactive model wherein the undamped peaks are also apparent proves a good approximation according to a growth of the separation at a small separation the first resonance frequency is slightly over estimated while the tendency for the second is much more pronounced with a reverse manner fig 4 shows a detail on the change of estimation error along the separation we can observe that the discrepancies become clear as the balloons approach to each other to clarify a physical reasoning for this intuitive explanations by feuillade 1995 can be adopted as follows in fig 5 contributions of each balloon to p scat were investigated with the exact model at the first resonance where the contribution of the big balloon is dominant there is no phase difference between the balloons so that they pulsate in phase with each other in other word the two balloons simultaneously expand or contract whilst accelerating or decelerating the fluid water around them thus there occurs a positive added mass effect to the big balloon making its corresponding resonance frequency lower than that of the non interactive one on the other hand out of phased oscillation at the second mode relieves the inertia load producing a negative added mass effect to the small balloon naturally it resonates at a higher frequency the mass loading arisen by the mutual interaction would be decreased with an increase of the separation by which the coupled resonance frequencies converge to the uncoupled provided that the relative separation d a 1 is larger than 5 the non interactive model predicts the exact resonance frequencies within 2 error bound thus in a practical aspect we may neglect the mutual interaction effect unless the balloons are very close to each other 2 3 design of balloons what we are eventually interested in is the total pressure in the next 18 p t o t a l p 0 k w a 1 k r e s 1 k w 2 1 1 k w r 1 k w a 2 k r e s 2 k w 2 1 1 k w r 2 1 which could be derived from the non interactive model in equation 16 this is plotted in the lower row of fig 3 as also shown in fig 6 their schematic behaviors represent two couples of peak and under peak overall response of p total resembles a linear superposition of the incident plus the contribution of each balloon in the range k w k res 1 because the denominator of the first term k res 1 k w 2 1 is smaller than that of the second term p total in this range is dominated by the response of big balloon or the first mode after encountering the resonance at k res 1 the first term in equation 18 becomes negative while the response is still dominated by the first mode the sign change implying the onset of phase reversal reflection from the big balloon induces a cancellation of the first term with the remaining two terms this is the so called the destructive interference yielding a decrement of the total pressure recognized as the first sharp notch in fig 6 there exists a frequency of maximum destructive interference k des 1 where the first term is perfectly cancelled out by the others analytic expression of k des 1 would be tedious since we must find the condition that p total is vanished if the size difference between the balloons is more than twice we can ignore the contribution of the small balloon for a derivation of a neat expression 19 k d e s 1 k r e s 1 1 a 1 r 1 f d e s 1 c w 2 π a 1 3 g h 2 1 a 1 r 1 as the frequency is further increased the second mode by the small balloon now begins to dominate the response the same reasoning in the above supports an existence of another set of important features the resonance at k res 2 and the destructive interference at 20 k d e s 2 k r e s 2 1 a 2 r 2 f d e s 2 c w 2 π a 2 3 g h 2 1 a 2 r 2 thus it can be deduced that each balloon provokes a pair of the resonance and the destructive interference extending to the case of general n balloons we can further expect the maximum destructive interferences to occur at n different frequencies as follows 21 k d e s n k r e s n 1 a n r n f d e s n c w 2 π a n 3 g h 2 1 a n r n in the single balloon design lee et al 2015a the frequency of maximum destructive interference f des is tuned at the target exciting frequency f target to exploit the benefit of destructive interference as much as possible as well the size of balloon can be chosen as the key design parameter to adjust f des the same strategy holds for the design of multi balloons since the separations in normal practices are large enough to ignore the interaction for a given n target frequencies f target n n 1 to n that is the design can be simply done by coinciding f des n with f target n for each n in accordance with the single case the size of each balloon a n can be regarded as the main parameter in achieving the desired f des n before we close this design section the amplifications of the pressure amplitude around the resonance frequencies should be clarified if the frequency contents of the excitation are broad enough to cover the key frequencies of the balloon f des n and f res n a rapid increase of the input pressure and consequently the vibration of the host structure can be pronounced by the balloons however the excitation from the cavitating propeller generally consists of two major spectral ingredients tonal component in low frequencies and broadband noise in high frequencies pereira et al 2016 what we are targeting at is the former i e hull pressure fluctuations which occurs at very discrete frequencies that is the bandwidth of each tonal component is much narrower than that between the resonance and destructive interference once the tuning matching the frequency of destructive interference f des n with the exciting frequency f target n is done no frequency content is left to be amplified by the balloon hence the raised issue would be indiscernible as far as mitigation of the tonal excitations in the low frequencies is concerned to make clear however it is mentioned that the balloon technique is not suitable for the latter components due to the broadness noise in some band tends to be accentuated by the balloon moreover for example if a noise of several kilohertz is targeted a very small balloon with the size of a few millimeters will be necessary this is not desirable in terms of the fabrication 3 experimental measurements 3 1 test set up and procedure as shown in fig 7 the complete ship model with a five bladed propeller is installed at the water tunnel in samsung ship model basin ssmb detail specifications of the tunnel and the test ship can be found in our previous work lee et al 2015a in brief the wooden ship model is mounted in the tunnel according to its scaled design draught on even keel the free surface is covered by fairing plates suppressing the water wave system by the model a watertight dynamometer aligned with an underwater motor gauges thrust torque and rotational shaft speed of the model propeller to measure pressure pulses from the propeller cavitation four pressure pick ups model kulite xtl 190 p1 p4 shown in fig 8 are flush mounted on the hull surface above the propeller in addition a water proof accelerometer model b k 5958a is stud mounted on the transom area to evaluate a vibration reduction with the balloons the demonstration in this study will cover a suppression of excitations at the first two orders of bpfs fig 9 shows the two balloons fabricated for this purpose the outer layer composed of epdm rubber poses a streamlined shape after inflation the equivalent radius a eq of the balloon can be estimated by equation 22 under the assumption that such a non spherical body is approximated to an ideal sphere 22 v 4 π 3 a e q 3 a e q 3 v 4 π 3 where v is the measurement of displaced water volume after submerging the balloon into a water filled bucket table 2 summarizes the estimated sizes and resonance frequencies the balloons need to be attached around the area of high incident pressure in order to make the reflected wave strong enough for the right handed propeller employed in this test prior measurements without the balloons showed the maximum pressure fluctuation at p1 the big balloon was fixed at this location to the outer hull surface with stainless steel strips positioning both balloons in the same place was hindered by a limitation in space the next highest incident pressure suggests the opposite side around p3 as the location of small balloon the interaction effect for the specified locations would be insignificant because the relative separation d a 1 is approximately 10 5 main parameters for a cavitation test in the water tunnel are the water flow speed v t the propeller rps revolution per second n and the tunnel pressure p tunnel to evaluate the performance in the frequency domain varying the propeller rps within interested frequency range is conducted while keeping both v t and p tunnel as constant the test conditions summarized in table 3 were chosen so that the ranges of exciting frequency can cover the key frequency values of designed balloons due to an inherent flexibility of rubber material the balloon can be easily expanded or contracted with the surrounding pressure which may cause a size deviation from the estimated a eq that was made at the nearly atmospheric pressure hence the tunnel was not depressurized to prevent a volume expansion of the balloons one may argue that the test without depressurization may produce no cavities on the propeller causing a low signal to noise ratio yet the photos shown in fig 10 exhibit a well developed cavity patterns even in the moderate condition while carrying out the tests without and with the balloons signals from the transducers are passed through a signal conditioner and logged into a computer based data recorder model b k pulse platform module 3050 with a sampling frequency of 2048 hz they are then post processed to attain the amplitude spectrum with the following parameters bendat and piersol 2010 time window boxcar number of ensemble averages 20 times overlapping 75 and frequency resolution 0 5 hz 3 2 results fig 11 shows raw frequency spectrums for two specific rps conditions those two rps were chosen to represent the mistuned n 27 9 hz and the tuned n 33 7 hz cases respectively without the balloons the discrete tonal components are apparent at the orders of bpfs regardless of the test rps nearly the same values are marked at the first and second order whereas the higher order pressure amplitudes are not significant even though abundant contents up to the several orders were produced for a higher rps condition that led to a developed tip vortex cavitation the energy associated with the cavitation was largely dominated by the lowest two order components attaching the balloons results in a variation of the pressure amplitude highly dependent upon whether they are tuned or not what stands out in fig 11 a is that the mistuned balloons can amplify the pressure amplitudes at the first two bpfs when tuned fig 11 b yet those excitations are significantly attenuated this assures that the properly tuned balloons can be employed as an inexpensive alternative for neutralizing the propeller cavitation induced hull excitation fig 12 depicts the readings at the first and second order bpfs repeated for other test rps cases as expected exciting pressure amplitudes for an absence of the balloons generally increase within both frequency ranges this tendency is consistent with the test results obtained by lowering the cavitation number lee and seo 2013 pereira et al 2016 however considerable variations over the frequency are found for the responses with the balloons their behaviors can be comprehended by a comparison with the theoretical prediction to end this the spectral readings with the balloons were divided by those without the balloons which eliminates the frequency dependent characteristics of exciting pressures as well as the dynamic characteristics of the model ship the normalized representations for the whole measurements are in fig 13 and their comparisons with the theoretical model are in fig 14 the frequencies of resonances and of destructive interference are summarized in table 4 and table 5 general behaviors of pressure fluctuations depend on whether the measurement location is outside the balloons or not for the outside measurements p2 and p4 we observe two consecutive pairs of resonance and destructive interference it is straightforward to infer that the first and second pairs are originated from the big and small balloons respectively the resonances frequencies identified at 148 hz and 283 hz do not vary with the measurement locations on the other hand the frequencies of destructive interference move slightly to a lower range as we are apart from the balloon p2 p4 which copes with equations 19 and 20 the pressure measurements at the balloon boundaries p1 and p3 attract our interest as well compared to the outside measurements one of the two destructive interferences is deficient in this regard equations 19 and 20 again account for non existence of the destructive interference when the observation point r approaches to the boundary if there was only one balloon resulting total pressures beyond a resonance would show a gradual decrement with the frequency and eventually resemble the response of a simple vibration isolator lee and kim 2007 2009 existence of another balloon in the neighborhood imposes an additional pair of peak and under peak because the boundary of original balloon inevitably lies outside the nearby balloon for instance the location of p3 lies at the boundary of the small balloon and simultaneously outside the big balloon thus the relevant measurement contains only the destructive interference by the big balloon but finds no cancellation effect by the small in the same manner we can be familiar with the behaviors shown in the measurement at p1 it can be debated that the broad range of amplifications around the resonance frequencies may be an adverse impact on the hull vibration reduction following well the measurements at p2 and p4 rather than p1 and p3 the vibration measurement demonstrates distinct reductions in two frequency bands by reading the minimum values of normalized acceleration in fig 13 the maximum reductions are found as 72 1 0 28 and 59 1 0 41 for ranges of the first and second order bpfs respectively thus the amplification issue is considered to be discernible only around the area of balloon locations fig 14 provides an acceptable agreement between the theoretical predictions and the experimental measurements the over estimations of pressure amplitude in the vicinities of resonances were arisen by ignoring the damping it is reminded that the design of multiple balloons was concerned with the frequency points of resonances and destructive interferences rather than their associated amplitudes although the potential based theoretical model in this study copes well with our primary concern it has a definite limitation in qualitatively describing how much resulting pressure would be at those frequencies inclusion of several damping factors from the reradiation the viscosity and etc medwin 2005 to the model may alleviate the observed discrepancies numerical approaches using cfd computational fluid dynamics or fem finite element approach can be alternatives however this will be remained as the scope of the future study contrary to our prior expectations tables 4 and 5 interestingly show small but consistent prediction errors for the frequencies of resonance and destructive interference ranging from 4 1 to 6 8 a possible reasoning can be attributed to the negligence of the hull plate mentioned in section 2 1 if the test ship was made of an acoustically rigid material like steel there would have been far more difference between the prediction and the measurement the hull plate in our test cannot be regarded as perfectly rigid because the wooden ship model possesses comparatively lower acoustic impedance than the steel ship i e z steel 46 2 106 rayls z wood 1 8 106 rayls this supports why all the key frequencies are predicted with rather small positive errors that is not to say that the error level will be preserved in the full ship the steel hull that is acoustically rigid like would cause a relatively large error about 17 strasberg 1953 therefore for an actual application it should be emphasized that the proposed method needs be utilized as an initial design guide and that the subsequent fine tuning is essential 4 concluding remarks our concern was the propeller cavity induced hull excitations at the orders of blade frequency and their mitigation using a set of air balloons relevant theoretical study for the multiple scattering was based on the existing series solution but in a highly complicated form the monopole approximation in the low frequency range readily proved an existence of the resonance and the destructive interference pair per each balloon through the parametric analysis we could justify the negligence of mutual interaction making the design strategy extremely simple that is the design of individual balloon exactly follows the way of the single balloon unless the separation is too small the proposed scheme in the current discussion could be validated by experimental measurements in the water tunnel for an ease of the demonstration the present work was confined to suppression of the sole first two bpfs components with two balloons the cavitation can trigger and amplify orders as high as 10 bpfs depending on the forms of cavitation in a moderate cavitation however the propeller produces pressure amplitudes that normally descend with the order even if this is not the case the associated energy is mostly dominated by the lowest few orders thus most ship builders are practically interested in the first two or three orders or up to fifth order at best to make ship s vibration level below an allowable limit despite the simplicity outcomes of this study are considered sufficient to support our major finding that each balloon can be designed separately without a consideration of their mutual interaction for a large separation d a 1 5 as a consequence the proposed scheme can be naturally extended to suppression of n exciting frequency components with n properly tuned balloons however the generalizability of the theoretical model is subjected to certain restrictions for instance the presence of hull plate was not rigorously reflected in the model the associated errors were fortuitously negligible in the test with wooden model ship this would not be the case of the full scale ship either a subsequent fine tuning mentioned earlier or a development of more complicated model is necessary for the remedy besides we witnessed large disagreement of the pressure amplitudes around the resonance frequencies originated by ignorance of the damping description future research attempting a numerical method should therefore include this factor appropriately as a final comment the present effort concentrated on the hull vibration reduction with the balloons without considering its adverse effect on the hydrodynamic performance the ship equipped with balloons has low exciting pressure pulses coming from the cavitating propeller but may be suffered from increased frictional resistance hence another possible area of future study would be to investigate the noted impact for actual applications acknowledgements this work was supported by the national research foundation of kores nrf grant funded by the korea government ministry of science ict future planning no 2017r1c1b5016831 
23422,the main objective of the present study is to establish a practical design strategy of air balloons for a suppression of the propeller cavitation induced hull pressures at multi frequencies theoretical foundation is initiated with the existing modal series solution of a multiple scattering problem an approximated form is then derived by a monopole regime which is valid in a low frequency range subsequent parametric analysis with a variation of the separation distance between the balloons provides an analytical evidence that the mutual interaction can be neglected unless they are too close to each other hence it is addressed that the individual balloon can be designed separately without a consideration of their coupling characteristics finally the water tunnel test with two balloons demonstrates noticeable vibration reductions at the first and second order of blade passing frequencies by 72 and 59 respectively keywords propeller cavitation multi frequency excitation air balloon destructive interference glossary a radius of spherical balloon m c speed of sound m s c q q th order scattering amplitude of an isolated air balloon d separation distance between the balloons m f frequency hz ϕ azimuthal angle rad g relative density ρ a ρ w h relative sound speed c a c w h q q th order spherical hankel function i 1 j q q th order spherical bessel function λ wavelength m k wavenumber rad m n q q th order spherical neumann function n number of spheres or balloons p pressure pa p 0 amplitude of incident plane wave pa p total total pressure p inc p scat pa p q p q th order associated legendre function p tunnel pressure in tunnel bar q order of wave q truncation order q pqpm translational coefficient θ polar angle rad r radial distance from the origin of sphere m ρ density kg m3 t time s v t water flow speed in tunnel m s ω frequency rad s z impedance rayls kg m3 m s subscripts a air des destructive interference eq equivalent inc incident wave res resonance scat scattered wave total total wave w seawater 1 introduction the previous single nozzle air injection scheme lee et al 2014 discovered a possibility to suppress propeller cavity induced hull exciting pressure by means of an acoustic phenomenon known as the destructive interference when a pressure wave generated by cavitating propeller strikes on the injected air whose acoustical impedance i e a product of density and sound speed is much less than that of water the phase of scattered or reflected wave becomes totally reversed this results in a cancellation of the incident and the scattered pressure in the total field as shown in table 1 similar acoustic impedance between rubber and water motivated our recent work lee et al 2015a in this approach a rubber layer at water to air interface appears to be acoustically transparent it was shown that the air filled rubber membrane hereinafter the balloon plays a specific role of air packing without any influence on the desired destructive interference accordingly an effort of the air injection could be made unnecessary by attaching such a simple air balloon on the stern hull surface as shown in fig 1 a for verifications in the full scale ship lee et al 2015b presented sea trial measurements by manufacturing 1 1 m 1 1 m sized inflatable balloon the balloon showed its effectiveness by attaining a noticeable hull vibration reduction of 65 at the exciting frequency of interest based on the ideal gas law a method of how to inflate the balloon to the design size and to keep it constant despite draught changes was treated as well the authors would like to emphasize that the phenomenon of acoustic cancellation takes place only at a certain frequency however it is the so called the frequency of destructive interference which is inversely proportional to the balloon size in other words once a single balloon is tuned to a specific size it alone has no choice but to counteract an excitation at a particular frequency the marine propeller operating in a non uniform wake field generates vibratory hull exciting pressures at several orders of blade passing frequency bpf carlton 2007 weitendorf 1981 the pressure amplitudes are normally descending with the order but we often encounter an occurrence of large pressure amplitudes at higher harmonics for example an excessive tip vortex cavitation may provoke high harmonic amplitudes to be of the same level with that of the lowest order or even higher friesch 1995 1998 hämäläinen and van heerd 1998 then multi balloons shown in fig 1 b can be a natural measure to control such excitations at several frequencies as they are anticipated to make destructive interferences at different frequencies the scope of this research is interested in reaching a design methodology for the balloons using the multiple scattering theory when two or more spherical 1 1 the balloon objects in this study will be idealized to spheres for a mathematical convenience its reasoning will be given in section 2 1 bodies are in close proximity to the others there exist mutual interactions between them the solution of multiple scattering requires satisfactions of appropriate boundary conditions on the surfaces of all spheres brunning and lo 1971 for this purpose the so called addition theorem is inevitable to expand spherical wave solutions of the helmholtz equation centered about a given origin into the ones centered about a shifted origin felderhof and jones 1987 applying boundary conditions on each sphere yields a set of simultaneous equations where unknown scattering coefficients are coupled the resulting equations for a general number of spheres are so complicated that it is difficult to get even a numerical solution alternatively a reasonable approach to tackle is to focus on the two spheres problem which was treated in a large volume of published studies twersky 1962 brunning and lo 1971 domany et al 1984 gaunaurd et al 1995 gabrielli and mercier finidori 2001 gumerov and duraiswami 2002 2005 roumeliotis and kotsis 2007 and more the very fundamental problem deserves a thorough investigation because it permits not only an opportunity to explore characteristics of the mutual interaction but also an insight to attain a solution for the case of several spheres more than two to propose a practical design strategy this paper begins with the simplest case of two interacting spherical balloons by employing the formulation of gaunaurd et al 1995 rather than working with the exact solution to the problem we derive its monopole approximation based on a low frequency assumption subsequent parametric study varying the distance between the balloons offers a critical clue that the interaction becomes weak for a large separation this allows the solution even for the general case to be expressible by an algebraic sum of isolated balloon consequently it is addressed that the design strategy for the individual balloon exactly follows the single case this paper takes a structure of four sections including this introductory section section 2 lays out the theoretical formulation and presents the findings of the research it goes on with experimental verifications in section 3 wherein the propeller cavitation test with two balloons exhibits considerable vibration suppressions at the two target frequencies finally this paper closes with conclusions in section 4 2 theory of acoustic scattering for two spherical balloons 2 1 problem formulation and analytic solution as detailed in our previous studies lee et al 2015a 2015b we are concerning for a low frequency range up to several multiples of blade rates so that the corresponding wavelengths can be assumed to be large enough compared to the size of balloon for such an acoustically small object a spherical like wavefront can be approximated as a plane wave across the body s aperture this enables to regard the pressure fluctuation from a cavitating propeller as a plane wave excitation the second assumption is to model the complicated shape of balloon as an ideal sphere scattering by an acoustically small object is insensitive to the shape because details of the geometry are not resolved that is the scattering in the low frequency range is mainly affected by an effective volume of the balloon rather than by its shape weston 1967 unless the aspect ratio of the balloon is too high strasberg 1953 hence the analysis for a spherical balloon would hold for a non spherical case as well owing to the acoustically transparent nature of rubber material we will also not consider the rubber layer necessarily employed for an air packing even if there is a slight difference of the acoustic impedance as usual the resultant effect was found to be insignificant provided that the frequency range of interest is low further discussions on this matter can be found in the introduction part of lee et al 2015a finally the hull plate to which the balloon is attached will not be taken into account for simplicity the presence of rigid wall is equivalent to the presence of a mirror balloon oscillating in phase with the true balloon feuillade 1995 the in phase motion induces a positive mass loading to the external field and lets the attached balloon resonate at a lower frequency than the same balloon in an unbounded medium the amount of frequency shifting is about 17 strasberg 1953 which is obtainable just by the two body multiple scattering model with zero separation distance this only makes the problem at hand more complicated the number of balloons we should deal with is four even for the simplest case of two balloons moreover it does not allow for the solution to be expressed as a closed form that is extremely useful in the subsequent design stage neglecting the presence of hull plate in the current acoustic model would lead to an over prediction for both the resonance frequency and the frequency of destructive interference in some degree a simple tuning for such discrepancy is to inflate the balloon a bit more by supplying an additional air because the key frequency points are expected to move toward a lower range details on this method are elaborated in lee et al 2015b based on the four assumptions in the above we are left with two spherical air balloons immersed in the water as shown in fig 2 the spherical balloons a and b separated by a distance d have the radius a 1 and a 2 a 1 a 2 respectively two spherical coordinate systems o 1 and o 2 can be assumed to lie along the z 1 axis thus a point in the three dimensional space has the coordinates r 1 θ 1 ϕ 1 or r 2 θ 2 ϕ 1 the acoustic impedance of a fluid like medium is given by a multiplication of the density ρ and the longitudinal sound speed c also k ω c denotes the wavenumber where ω 2πf is the angular frequency in radians per second subscripts w and a designate water and air respectively with no loss in generality let there be an incident plane wave of strength p 0 whose propagating direction is lying in x 1 z 1 or x 2 z 1 plane and makes an angle α with respect to the axis of the two balloons it acoustically excites the balloons by which the external scattered wave p scat as well as the internal waves are generated our interest is to investigate the total pressure p total p inc p scat with the solution of p scat proposed by gaunaurd et al 1995 the incident field has the following modal expansion in terms of the spherical harmonics 1 p i n c p 0 q 0 p q q a p q re h q k w r 1 p q p cos θ 1 e i p ϕ 1 where q is the order of wave h q j q in q the q th order spherical hankel function of the first kind j q the spherical bessel function n q the spherical neumann function and p q p p q q 0 the associated legendre function for compactness the time factor e iωt will be omitted throughout this study the coefficient a pq is defined as 2 a p q i q 2 q 1 q p q p p q p cos α note that the expansion 1 of p inc was made about o 1 of the coordinate r 1 θ 1 ϕ 1 for the expansion about o 2 of r 2 θ 2 ϕ 1 the coordinate subscript 1 on the right of equation 1 is changed to 2 where the coefficient a pq in equation 2 differs only by multiplicative phase factor exp ikd cosα obviously the solution p scat can be expressible in the two coordinate systems which is alternately translated to the other coordinate by the use of the addition theorem next the scattered field p scat is composed of the contributions from each balloon 3 p s c a t q 0 p q q b p q 1 h q k w r 1 p q p cos θ 1 b p q 2 h q k w r 2 p q p cos θ 2 e i p ϕ 1 the coefficient b pq 1 or b pq 2 represents the scattering amplitude from balloon a or b in the presence of balloon b or a two coupled linear equations for these unknowns could be derived by enforcing the continuities of acoustic pressures and normal components of the particle velocity on both balloons 4 b p q 1 c q a 1 a p q m p q p q p m b p m 2 b p q 2 c q a 2 a p q e i k d cos α m p 1 q m q p q p m b p m 1 where 5 c q a n g h j q k w a n j q k a a n j q k w a n j q k a a n g h h q k w a n j q k a a n h q k w a n j q k a a n n 1 2 the prime symbol represents derivative with respect to the argument g ρ a ρ w and h c a c w are the relative density and sound speed respectively it is noteworthy that c q a n is consistent with the scattering amplitude of the n th isolated air bubble anderson 1950 thus the second terms in equation 4 account for the mutual interaction between the balloons the translational coefficient q pqpm in the coupled equation was necessarily employed by use of the scalar addition theorem 6 q p q p m i m q 2 q 1 q p q p σ q m q m b σ q p m p h σ k w d where the summation index σ varies from q m to q m by steps of 2 the b σ b σ qpmp coefficient was formally written in terms of a product of two wigner 3 j or clebsch gordan coefficients felderhof and jones 1987 which involved an extensive computation of factorials when the translation is confined to the z 1 axis as our case the recursion formulas in the following can be conveniently adopted without calculating the 3 j coefficient xu 1997 7 b σ 4 a σ 2 a σ 1 4 σ 2 b σ 2 a σ b σ a σ 3 where 8 a σ q n σ 1 q n σ q n σ 1 q n σ 1 2 σ 1 2 σ the two starting values are 9 b q m 2 q 1 2 m 1 2 q 2 m 1 q m q p m p 10 b q m 2 2 q 2 m 3 2 q 1 2 m 1 q m m q 2 q 2 m 1 p 2 b q m now equations from 3 to 10 constitute an analytic expression for the scattered wave p scat estimation of the exact solution requires an evaluation of the coupled coefficients b pq 1 and b pq 2 at each frequency k w by solving the system of linear equations equation 4 however they are infinite a truncation at some point needs to be considered for an actual computation once the truncation wave order q the number of terms used in the summations from q 0 to q is specified equation 4 can be casted into a standard matrix vector form with the order of 2 q 1 2 2 q 1 2 even though the resulting system can be solved by a numerical routine such as lu decomposition sufficient value of q obviously increases with the frequency and so does the required numbers of computation to lessen such a cruel scheme gaunaurd et al 1995 considered the symmetry of translation coefficient q pqpm with respect to the sign of the degree p i e q pqpm q pq pm which is valid for the coaxial arrangement of the balloons in other words the unknowns b pq 1 and b pq 2 need to be computed only for non negative values of p and q then it was possible to break down huge sized problem into solving the matrices of orders 2 q p 1 2 q p 1 for q times in fact gaunaurd et al 1995 reported just the resulting matrix order without giving a detail explanation on the symmetricity of the translation coefficient for further discussions on the related computation the readers are suggested to refer section 15 of gumerov and duraiswami 2001 2 2 monopole approximation in a low frequency range despite of its exactness for a wide range of frequencies the benchmark modal series solution in the previous section is not easy to explore the behavior of scattered waves we need to arrive at a simpler form by an approximation for the concerned low frequencies the dominant term in the series is that with the zeroth order q 0 i e monopole mode that is the balloons are assumed to pulsate in the radial direction only equation 4 then can be free from a tedious summation but just left with zero indices 11 b 00 1 c 0 a 1 1 h 0 k w d b 00 2 b 00 2 c 0 a 2 e i k d cos α h 0 k w d b 00 1 it is also possible for any non dimensional frequencies k i a n and k i d i w a and n 1 2 to be far less than unity in the low frequencies this leads to asymptotic expressions for the incidence angle phase factor exp ikdcos α 1 and for the spherical bessel and hankel functions with small argument morse and ingard 1987 12 j 0 x 1 j 0 x x 3 h 0 x i x h 0 x i x 2 plugging equation 12 into equation 5 and some straightforward algebra produce an approximation of c 0 a n 13 c 0 a n i k w a n k r e s n k w 2 1 where 14 k r e s n 3 g h 2 a n f r e s n c w 2 π 3 g h 2 a n is the resonance frequency of a spherical balloon whose radius is a n and also identical to the one derived by minnaert 1933 with the use of identity of zeroth order legendre function p 0 0 x 1 we proceed to an algebraic form of p scat 15 p s c a t p 0 b 00 1 h 0 k w r 1 b 00 2 h 0 k w r 2 c 0 a 1 1 i c 0 a 2 k w d 1 c 0 a 1 c 0 a 2 k w d 2 i k w r 1 c 0 a 2 1 i c 0 a 1 k w d 1 c 0 a 1 c 0 a 2 k w d 2 i k w r 2 in which the radial function h 0 x was replaced with i x under a near field assumption i e k w r 1 1 and k w r 2 1 lee et al 2015a note that the dependence on the angular variables has disappeared in p scat during the monopole approximation examining the parenthesized terms in equation 15 reveals that the mutual interaction effect dissipates with an increase of the separation distance d thus we can further approximate p scat for a large separation 16 p s c a t p 0 k w a 1 k r e s 1 k w 2 1 1 k w r 1 k w a 2 k r e s 2 k w 2 1 1 k w r 2 the above can be interpreted as a summation of contributions from two isolated balloons hence without loss of generality one can conveniently extend equation 16 to the general case of n balloons 17 p s c a t p 0 n 1 n k w a n k r e s n k w 2 1 1 k w r n where a n is the radius of the n th balloon and r n the distance from its center to the observation point another practical implication of equation 16 is that well separated balloons can be treated independently in the design stage while the interaction does not need to be minded details on the design will be continued after a validation of the proposed approximation to this end we will examine the pressure responses by the following three analytic models i modal series solution in equation 1 ii monopole approximation in equation 15 and iii monopole approximation without the interaction in equation 16 which are designated as exact monopole and non interactive model respectively by keeping the ratio of balloon radius a 1 a 2 as 2 a parametric variation of the separation is taken into account the impedances of water ρ w c w and air ρ a c a are set as 1 5 106 rayls 1000 1500kg m2s and 340 rayls 1 340kg m2s respectively so the resonance frequencies of each balloon are positioned at 0 0125 and 0 0250 respectively on the normalized frequency axis k w a 1 for a computation of the exact model summing the first ten mode for the series q 9 is considered to obtain five digits accuracy as well all the responses are evaluated at the mid point of the balloons i e r 1 r 2 d 2 upper row of fig 3 presents comparisons of amplitude of p scat irrespective of the separation distance the monopole model in the low frequencies i e k w a 1 1 agrees well with the exact except the amplitudes at resonances at the moment it is noteworthy that the role of damping is to describe energy dissipation away from a bubble leighton 1994 but would be significant only around the resonance frequencies crandall 1970 the approximation of spherical function made in equation 12 is essentially equivalent to a negligence of the prescribed damping that is why the sharp peaks are displayed in the monopole model fortunately it would be appropriate to disregard the limitation in describing the peak amplitude in a sense that the balloon design is involved with the frequency points of resonance and destructive interference not with the associated amplitudes the non interactive model wherein the undamped peaks are also apparent proves a good approximation according to a growth of the separation at a small separation the first resonance frequency is slightly over estimated while the tendency for the second is much more pronounced with a reverse manner fig 4 shows a detail on the change of estimation error along the separation we can observe that the discrepancies become clear as the balloons approach to each other to clarify a physical reasoning for this intuitive explanations by feuillade 1995 can be adopted as follows in fig 5 contributions of each balloon to p scat were investigated with the exact model at the first resonance where the contribution of the big balloon is dominant there is no phase difference between the balloons so that they pulsate in phase with each other in other word the two balloons simultaneously expand or contract whilst accelerating or decelerating the fluid water around them thus there occurs a positive added mass effect to the big balloon making its corresponding resonance frequency lower than that of the non interactive one on the other hand out of phased oscillation at the second mode relieves the inertia load producing a negative added mass effect to the small balloon naturally it resonates at a higher frequency the mass loading arisen by the mutual interaction would be decreased with an increase of the separation by which the coupled resonance frequencies converge to the uncoupled provided that the relative separation d a 1 is larger than 5 the non interactive model predicts the exact resonance frequencies within 2 error bound thus in a practical aspect we may neglect the mutual interaction effect unless the balloons are very close to each other 2 3 design of balloons what we are eventually interested in is the total pressure in the next 18 p t o t a l p 0 k w a 1 k r e s 1 k w 2 1 1 k w r 1 k w a 2 k r e s 2 k w 2 1 1 k w r 2 1 which could be derived from the non interactive model in equation 16 this is plotted in the lower row of fig 3 as also shown in fig 6 their schematic behaviors represent two couples of peak and under peak overall response of p total resembles a linear superposition of the incident plus the contribution of each balloon in the range k w k res 1 because the denominator of the first term k res 1 k w 2 1 is smaller than that of the second term p total in this range is dominated by the response of big balloon or the first mode after encountering the resonance at k res 1 the first term in equation 18 becomes negative while the response is still dominated by the first mode the sign change implying the onset of phase reversal reflection from the big balloon induces a cancellation of the first term with the remaining two terms this is the so called the destructive interference yielding a decrement of the total pressure recognized as the first sharp notch in fig 6 there exists a frequency of maximum destructive interference k des 1 where the first term is perfectly cancelled out by the others analytic expression of k des 1 would be tedious since we must find the condition that p total is vanished if the size difference between the balloons is more than twice we can ignore the contribution of the small balloon for a derivation of a neat expression 19 k d e s 1 k r e s 1 1 a 1 r 1 f d e s 1 c w 2 π a 1 3 g h 2 1 a 1 r 1 as the frequency is further increased the second mode by the small balloon now begins to dominate the response the same reasoning in the above supports an existence of another set of important features the resonance at k res 2 and the destructive interference at 20 k d e s 2 k r e s 2 1 a 2 r 2 f d e s 2 c w 2 π a 2 3 g h 2 1 a 2 r 2 thus it can be deduced that each balloon provokes a pair of the resonance and the destructive interference extending to the case of general n balloons we can further expect the maximum destructive interferences to occur at n different frequencies as follows 21 k d e s n k r e s n 1 a n r n f d e s n c w 2 π a n 3 g h 2 1 a n r n in the single balloon design lee et al 2015a the frequency of maximum destructive interference f des is tuned at the target exciting frequency f target to exploit the benefit of destructive interference as much as possible as well the size of balloon can be chosen as the key design parameter to adjust f des the same strategy holds for the design of multi balloons since the separations in normal practices are large enough to ignore the interaction for a given n target frequencies f target n n 1 to n that is the design can be simply done by coinciding f des n with f target n for each n in accordance with the single case the size of each balloon a n can be regarded as the main parameter in achieving the desired f des n before we close this design section the amplifications of the pressure amplitude around the resonance frequencies should be clarified if the frequency contents of the excitation are broad enough to cover the key frequencies of the balloon f des n and f res n a rapid increase of the input pressure and consequently the vibration of the host structure can be pronounced by the balloons however the excitation from the cavitating propeller generally consists of two major spectral ingredients tonal component in low frequencies and broadband noise in high frequencies pereira et al 2016 what we are targeting at is the former i e hull pressure fluctuations which occurs at very discrete frequencies that is the bandwidth of each tonal component is much narrower than that between the resonance and destructive interference once the tuning matching the frequency of destructive interference f des n with the exciting frequency f target n is done no frequency content is left to be amplified by the balloon hence the raised issue would be indiscernible as far as mitigation of the tonal excitations in the low frequencies is concerned to make clear however it is mentioned that the balloon technique is not suitable for the latter components due to the broadness noise in some band tends to be accentuated by the balloon moreover for example if a noise of several kilohertz is targeted a very small balloon with the size of a few millimeters will be necessary this is not desirable in terms of the fabrication 3 experimental measurements 3 1 test set up and procedure as shown in fig 7 the complete ship model with a five bladed propeller is installed at the water tunnel in samsung ship model basin ssmb detail specifications of the tunnel and the test ship can be found in our previous work lee et al 2015a in brief the wooden ship model is mounted in the tunnel according to its scaled design draught on even keel the free surface is covered by fairing plates suppressing the water wave system by the model a watertight dynamometer aligned with an underwater motor gauges thrust torque and rotational shaft speed of the model propeller to measure pressure pulses from the propeller cavitation four pressure pick ups model kulite xtl 190 p1 p4 shown in fig 8 are flush mounted on the hull surface above the propeller in addition a water proof accelerometer model b k 5958a is stud mounted on the transom area to evaluate a vibration reduction with the balloons the demonstration in this study will cover a suppression of excitations at the first two orders of bpfs fig 9 shows the two balloons fabricated for this purpose the outer layer composed of epdm rubber poses a streamlined shape after inflation the equivalent radius a eq of the balloon can be estimated by equation 22 under the assumption that such a non spherical body is approximated to an ideal sphere 22 v 4 π 3 a e q 3 a e q 3 v 4 π 3 where v is the measurement of displaced water volume after submerging the balloon into a water filled bucket table 2 summarizes the estimated sizes and resonance frequencies the balloons need to be attached around the area of high incident pressure in order to make the reflected wave strong enough for the right handed propeller employed in this test prior measurements without the balloons showed the maximum pressure fluctuation at p1 the big balloon was fixed at this location to the outer hull surface with stainless steel strips positioning both balloons in the same place was hindered by a limitation in space the next highest incident pressure suggests the opposite side around p3 as the location of small balloon the interaction effect for the specified locations would be insignificant because the relative separation d a 1 is approximately 10 5 main parameters for a cavitation test in the water tunnel are the water flow speed v t the propeller rps revolution per second n and the tunnel pressure p tunnel to evaluate the performance in the frequency domain varying the propeller rps within interested frequency range is conducted while keeping both v t and p tunnel as constant the test conditions summarized in table 3 were chosen so that the ranges of exciting frequency can cover the key frequency values of designed balloons due to an inherent flexibility of rubber material the balloon can be easily expanded or contracted with the surrounding pressure which may cause a size deviation from the estimated a eq that was made at the nearly atmospheric pressure hence the tunnel was not depressurized to prevent a volume expansion of the balloons one may argue that the test without depressurization may produce no cavities on the propeller causing a low signal to noise ratio yet the photos shown in fig 10 exhibit a well developed cavity patterns even in the moderate condition while carrying out the tests without and with the balloons signals from the transducers are passed through a signal conditioner and logged into a computer based data recorder model b k pulse platform module 3050 with a sampling frequency of 2048 hz they are then post processed to attain the amplitude spectrum with the following parameters bendat and piersol 2010 time window boxcar number of ensemble averages 20 times overlapping 75 and frequency resolution 0 5 hz 3 2 results fig 11 shows raw frequency spectrums for two specific rps conditions those two rps were chosen to represent the mistuned n 27 9 hz and the tuned n 33 7 hz cases respectively without the balloons the discrete tonal components are apparent at the orders of bpfs regardless of the test rps nearly the same values are marked at the first and second order whereas the higher order pressure amplitudes are not significant even though abundant contents up to the several orders were produced for a higher rps condition that led to a developed tip vortex cavitation the energy associated with the cavitation was largely dominated by the lowest two order components attaching the balloons results in a variation of the pressure amplitude highly dependent upon whether they are tuned or not what stands out in fig 11 a is that the mistuned balloons can amplify the pressure amplitudes at the first two bpfs when tuned fig 11 b yet those excitations are significantly attenuated this assures that the properly tuned balloons can be employed as an inexpensive alternative for neutralizing the propeller cavitation induced hull excitation fig 12 depicts the readings at the first and second order bpfs repeated for other test rps cases as expected exciting pressure amplitudes for an absence of the balloons generally increase within both frequency ranges this tendency is consistent with the test results obtained by lowering the cavitation number lee and seo 2013 pereira et al 2016 however considerable variations over the frequency are found for the responses with the balloons their behaviors can be comprehended by a comparison with the theoretical prediction to end this the spectral readings with the balloons were divided by those without the balloons which eliminates the frequency dependent characteristics of exciting pressures as well as the dynamic characteristics of the model ship the normalized representations for the whole measurements are in fig 13 and their comparisons with the theoretical model are in fig 14 the frequencies of resonances and of destructive interference are summarized in table 4 and table 5 general behaviors of pressure fluctuations depend on whether the measurement location is outside the balloons or not for the outside measurements p2 and p4 we observe two consecutive pairs of resonance and destructive interference it is straightforward to infer that the first and second pairs are originated from the big and small balloons respectively the resonances frequencies identified at 148 hz and 283 hz do not vary with the measurement locations on the other hand the frequencies of destructive interference move slightly to a lower range as we are apart from the balloon p2 p4 which copes with equations 19 and 20 the pressure measurements at the balloon boundaries p1 and p3 attract our interest as well compared to the outside measurements one of the two destructive interferences is deficient in this regard equations 19 and 20 again account for non existence of the destructive interference when the observation point r approaches to the boundary if there was only one balloon resulting total pressures beyond a resonance would show a gradual decrement with the frequency and eventually resemble the response of a simple vibration isolator lee and kim 2007 2009 existence of another balloon in the neighborhood imposes an additional pair of peak and under peak because the boundary of original balloon inevitably lies outside the nearby balloon for instance the location of p3 lies at the boundary of the small balloon and simultaneously outside the big balloon thus the relevant measurement contains only the destructive interference by the big balloon but finds no cancellation effect by the small in the same manner we can be familiar with the behaviors shown in the measurement at p1 it can be debated that the broad range of amplifications around the resonance frequencies may be an adverse impact on the hull vibration reduction following well the measurements at p2 and p4 rather than p1 and p3 the vibration measurement demonstrates distinct reductions in two frequency bands by reading the minimum values of normalized acceleration in fig 13 the maximum reductions are found as 72 1 0 28 and 59 1 0 41 for ranges of the first and second order bpfs respectively thus the amplification issue is considered to be discernible only around the area of balloon locations fig 14 provides an acceptable agreement between the theoretical predictions and the experimental measurements the over estimations of pressure amplitude in the vicinities of resonances were arisen by ignoring the damping it is reminded that the design of multiple balloons was concerned with the frequency points of resonances and destructive interferences rather than their associated amplitudes although the potential based theoretical model in this study copes well with our primary concern it has a definite limitation in qualitatively describing how much resulting pressure would be at those frequencies inclusion of several damping factors from the reradiation the viscosity and etc medwin 2005 to the model may alleviate the observed discrepancies numerical approaches using cfd computational fluid dynamics or fem finite element approach can be alternatives however this will be remained as the scope of the future study contrary to our prior expectations tables 4 and 5 interestingly show small but consistent prediction errors for the frequencies of resonance and destructive interference ranging from 4 1 to 6 8 a possible reasoning can be attributed to the negligence of the hull plate mentioned in section 2 1 if the test ship was made of an acoustically rigid material like steel there would have been far more difference between the prediction and the measurement the hull plate in our test cannot be regarded as perfectly rigid because the wooden ship model possesses comparatively lower acoustic impedance than the steel ship i e z steel 46 2 106 rayls z wood 1 8 106 rayls this supports why all the key frequencies are predicted with rather small positive errors that is not to say that the error level will be preserved in the full ship the steel hull that is acoustically rigid like would cause a relatively large error about 17 strasberg 1953 therefore for an actual application it should be emphasized that the proposed method needs be utilized as an initial design guide and that the subsequent fine tuning is essential 4 concluding remarks our concern was the propeller cavity induced hull excitations at the orders of blade frequency and their mitigation using a set of air balloons relevant theoretical study for the multiple scattering was based on the existing series solution but in a highly complicated form the monopole approximation in the low frequency range readily proved an existence of the resonance and the destructive interference pair per each balloon through the parametric analysis we could justify the negligence of mutual interaction making the design strategy extremely simple that is the design of individual balloon exactly follows the way of the single balloon unless the separation is too small the proposed scheme in the current discussion could be validated by experimental measurements in the water tunnel for an ease of the demonstration the present work was confined to suppression of the sole first two bpfs components with two balloons the cavitation can trigger and amplify orders as high as 10 bpfs depending on the forms of cavitation in a moderate cavitation however the propeller produces pressure amplitudes that normally descend with the order even if this is not the case the associated energy is mostly dominated by the lowest few orders thus most ship builders are practically interested in the first two or three orders or up to fifth order at best to make ship s vibration level below an allowable limit despite the simplicity outcomes of this study are considered sufficient to support our major finding that each balloon can be designed separately without a consideration of their mutual interaction for a large separation d a 1 5 as a consequence the proposed scheme can be naturally extended to suppression of n exciting frequency components with n properly tuned balloons however the generalizability of the theoretical model is subjected to certain restrictions for instance the presence of hull plate was not rigorously reflected in the model the associated errors were fortuitously negligible in the test with wooden model ship this would not be the case of the full scale ship either a subsequent fine tuning mentioned earlier or a development of more complicated model is necessary for the remedy besides we witnessed large disagreement of the pressure amplitudes around the resonance frequencies originated by ignorance of the damping description future research attempting a numerical method should therefore include this factor appropriately as a final comment the present effort concentrated on the hull vibration reduction with the balloons without considering its adverse effect on the hydrodynamic performance the ship equipped with balloons has low exciting pressure pulses coming from the cavitating propeller but may be suffered from increased frictional resistance hence another possible area of future study would be to investigate the noted impact for actual applications acknowledgements this work was supported by the national research foundation of kores nrf grant funded by the korea government ministry of science ict future planning no 2017r1c1b5016831 
23423,the harmonic balance method applied to fully nonlinear viscous temporally periodic free surface flows is presented in this paper the harmonic balance approach is used to project a transient periodic two phase flow into multiple coupled steady state problems discretising the periodic time interval the numerical framework is based on finite volume method for computational fluid dynamics in the open source software foamextend the disability of the harmonic balance method to simulate flows with zero or close to zero mean velocity is overcome by coupling the harmonic balance steady state equations implicitly presenting a novelty in the field von neumann stability analysis is performed for the governing harmonic balance equations to mathematically prove that zero mean velocity can be simulated using the proposed implicit coupling the method is validated and verified on a periodic free surface flow over a ramp and regular surface wave propagation with current both including grid convergence studies and spectral resolution sensitivity studies all results are compared to fully transient computations a detailed study is performed for wave propagation without current confirming that convergence of free surface elevation can be achieved without mean velocity the approach proved accurate and applicable for twophase flows opening a new research field keywords periodic free surface flows cfd harmonic balance naval hydrodynamics foam extend 1 introduction this work presents the development implementation and validation of the time spectral method for simulating fully nonlinear viscous temporally periodic large scale two phase flows based on an existing two phase numerical model developed within a finite volume fv computational fluid dynamics cfd software foam extend jasak 2009 the method is specifically intended for general two phase flows where the boundary conditions have a temporally periodic nature with low or zero mean velocity resulting in a periodic flow field in the domain of interest such flows are often encountered in problems regarding surface waves which are important in the field of naval offshore and ocean hydrodynamics the frequency domain methods are very common in the naval hydrodynamics but mainly within the potential flow approach the simplest example is the evaluation of the linear transfer functions so called response amplitude operator rao which is the basic ingredient of the linear spectral analysis which allows for very quick assessment of the floating body response for any particular sea conditions the main drawback of the frequency domain approach within the potential flow assumptions is associated with the difficulties related to the inclusion of the different nonlinear effects indeed within the classical approach the resulting boundary value problems for higher order velocity potentials quickly become very complex leading to many numerical difficulties e g see ferrant et al 1999 malenica and molin 1995 consequently the common practice within the potential flow approach is to resolve up to the second order in frequency domain and apply the fully nonlinear time domain approach for highly nonlinear problems however it is well known that the potential flow approach has very limited use for fully nonlinear wave body interactions because of the difficulties associated with the proper treatment of the complex free surface boundary conditions that is why there is still no efficient fully nonlinear wave body interaction solver based on potential flow theory which has been proposed in the literature only some relatively simple nonlinear wave body interaction problems such as one discussed in ferrant et al 1999 were efficiently solved within the potential flow approach viscous cfd methods are an obvious alternative since they offer reliable results as shown in numerous validation publications vukčević et al 2015 2016a vukčević and jasak 2015a gatin et al 2015 larsson et al 2013 consequently in the recent years a number of publications dealing with the application of viscous cfd on the problems of wave induced motions and loads in naval hydrodynamics have emerged silva et al 2017 hashimoto et al 2016 wu et al 2011 thilleul et al 2011 kim et al 2012 chen et al 2014 windén et al 2012 mousaviraad et al 2015 carrica et al 2011 kim 2011 qiu et al 2014 carrica et al 2008 seng et al 2014 el moctar et al 2017 time domain simulations prevail when it comes to viscous naval hydrodynamic cfd calculations however in the field of turbomachinery spectral cfd methods present an active area of research nonlinear harmonic method applied to navier stokes equations was first presented by he and ning 1998 for simulating unsteady viscous flow around turbomachinery blades the nonlinear harmonic method also called harmonic balance hb takes advantage of the temporally periodic nature of the flow with a known dominant frequency of oscillation by transforming a transient problem into a number of coupled steady state problems the main drawback of simulating periodic flows with viscous cfd using transient time marching techniques is the requirement for large number of simulated periods before reaching fully developed periodical flow simonsen et al 2013a vukčević and jasak 2015a larsson et al 2015a 2015b hb alleviates this problem while additionally accelerating the calculation by considering steady state problems which are generally faster to perform the advantages of hb were soon recognized in the cfd community resulting in a large number of publications mostly related to turbomachinery applications maple et al 2004 developed an adaptive hb method where the number of resolved harmonics is varied in the domain depending on the required spectral resolution applied to a supersonic subsonic diverging nozzle mcmullen and jameson 2005 investigated the acceleration techniques for solving the coupled set of steady state problems where they reported 8 19 times acceleration in terms of computational time comparing with the transient code ekici et al 2008 used euler equations based hb method to simulate helicopter rotor blade flow while guédeney et al guedeney et al 2013 extended the method for turbomachinery flows with multiple frequencies in order to capture rotor stator interaction effects apart from being easier and faster to calculate steady state equations provide the ability of automatic optimisation in case of hb method objectives for optimisation can be related to periodic quantities huang huang and ekici 2014 used hb method in conjunction with discrete adjoint optimisation method to optimise turbomachinery blades in the field of naval hydrodynamics minimisation of added wave resistance or ship motion could be achieved to the authors knowledge no attempt has been made to develop a hb method for nonlinear two phase viscous and turbulent free surface flows with low or zero mean flow velocity in this work hb method is employed for the calculation of periodic free surface flows where implicit coupling of steady state equations is performed by solving the equations in a block matrix form implicit coupling enables running simulations at large reduced frequency numbers hall et al 2013 which is the stability criteria stemming from the von neumann stability analysis of the hb equations in practice this enables low and zero mean flow velocities and coarser spatial grids the implicit coupling presents a novelty with respect to existing publications regarding the hb method the development is based on the previously performed implementation by cvijetić et al 2016 where single phase explicit hb method is described for turbomachinery applications the targeted practical applications of the presented hb method are associated with the evaluation of the transfer functions of ship s response in waves at different orders of approximation linear quadratic higher order etc and for assessing added resistance in waves these transfer functions are then used in combination with the body operating conditions to derive the long term design values e g see journée and massie journeé and massie 2001 even though the real sea state is irregular and composed of very large number of individual waves with different amplitude and frequencies design methods exist which are based on the use of the so called equivalent regular design waves soares et al 2015 hence having the efficient numerical tool for the evaluation of the wave body interactions in regular waves can be very useful in practice this paper is organised as follows first the mathematical model is presented comprising the governing equations in the swense spectral wave explicit navier stokes equations decomposed form as described by vukčević et al 2016b and the hb treatment of the time derivative term next an overview of the numerical method is given including the implicit coupling of the hb source term followed by brief notes on implementation of the ghost fluid method gfm in foam extend vukčević et al 2017 in order to assess the new model two validation test cases are presented a two phase periodic flow over a ramp and regular wave propagation with uniform current additionally the implicit method is compared to explicitly coupled hb method for the wave propagation case with current next a stability study is performed on a wave propagation case without current finally concluding remarks are given 2 mathematical model in this section a brief overview of the mathematical model describing two phase nonlinear and viscous flow is given presenting the governing equations in the swense vukčević et al 2016b ducrozet et al 2014 ferrant et al 2002 decomposed form and briefly outlining the formulation of dynamic pressure and density jump at the interface using the gfm huang et al 2007 vukčević et al 2017 furthermore a description of governing equations in the time spectral hb form is given 2 1 governing equations two phase incompressible viscous flow is governed by the momentum conservation equation mass conservation equation and an interface capturing equation in the appropriate form the equations below are given in the swense decomposed form vukčević et al 2016b where an arbitrary field q is written as q q i q p index i denotes the incident component typically corresponding to a solution obtained by potential flow while index p denotes the perturbation component being solved for via equation set the incident terms are treated explicitly as they are assumed to be known at each time instant formally this decomposition is arbitrary but it is assumed that the incident field provides a good estimate of the final nonlinear solution i e that the component q i is smaller than q p reader is directed to vukčević et al 2017 for detailed derivation of the following equation set for incompressible flow the conservation of mass reads 1 u p u i where u denotes the velocity field although the potential flow solution is formally divergence free u i 0 mapping this field to a discretised volume mesh generally introduces continuity errors vukčević et al 2016b which are resolved in eqn 1 the swense decomposed momentum equation reads 2 u p t u u p ν e f f u p u i t u u i ν e f f u i 1 ρ p d u ν e f f where ν e f f stands for effective kinematic viscosity including the turbulent viscosity ρ is the density which has a discontinuity at the interface while p d stands for dynamic pressure p d p ρ g x where p denotes total pressure g represents constant gravitational acceleration and x is the radii vector the velocity in the last term on the right hand side is not decomposed since it is treated explicitly more details regarding decomposition of the pressure term are given in vukčević et al 2016b in this study level set ls method derived from the phase field pf equation sun and beckermann 2007 2008 is used for interface capturing due to its suitability for swense decomposition vukčević et al 2016b since signed distance function is unbounded the decomposed ls equation reads 3 ψ p t c ψ p ψ p c b ψ p ψ i t c ψ i ψ i c b ψ i b 2 ε tanh ψ ε 2 where ψ denotes the ls field decomposed into incident ψ i and perturbed component ψ p while b and ε stand for numerical parameters diffusion coefficient and width parameter respectively c is the modified convective velocity defined as 4 c u b 2 ε tanh ψ ε 2 ψ b κ ψ ψ where κ denotes the mean interface curvature for additional details the reader is referred to vukčević et al 2016b 2 2 harmonic balance method in this section the time spectral form of hb transformation is applied to all governing equations only a brief overview of the hb method is given here while for detailed derivation of the implemented model the reader is referred to cvijetić et al 2016 using hb method the transient equations are transformed into a set of steady state equations coupled via source term that represents the time derivative terms in the spectral domain the hb method is based on the assumption of temporally periodic flow where each variable is expanded into a fourier series with a finite number of harmonics n 5 q t x q 0 l 1 n q s l sin l ω t q c l cos l ω t where q t x represents a general field variable in time while q denotes the fourier coefficient of the variable in frequency domain ω is the known base frequency of q and indices s l and c l denote the sine and cosine fourier coefficient respectively in time domain the standard transport equation for general variable q can be written as 6 q t ℛ 0 where ℛ stands for convection diffusion and source sink terms note that ℛ f q t x however it is considered here as one term for the sake of clarity ℛ is also expanded into fourier series analogous to eqn 5 inserting the fourier expansion of q and ℛ into eqn 6 and equating the corresponding trigonometric terms yields 7 ω a q r 0 where a presents the 2 n 1 2 n 1 coefficient matrix while q and r are vectors containing 2 n 1 fourier coefficients of q and ℛ respectively the fourier series expansion eqn 5 can be regarded as a discrete fourier transform which can be viewed as a matrix multiplication q e q where q presents a vector of discrete time values of q t x thus eqn 7 can be written in terms of time domain variables as 8 ω a e q e r 0 which is simplified by multiplying by e 1 from the left yielding a time spectral form 9 ω e 1 a e q r 0 eqn 9 presents a set of quasi steady state equations coupled by the off diagonal elements of the matrix e 1 a e hence comparing eqn 9 and eqn 6 indicates that the time derivative term is replaced by a source term which can be written as 10 s q ω e 1 a e q s l q 2 ω 2 n 1 k 1 2 n p k l q t k l 1 2 n 1 where s q stands for the hb temporal coupling source vector s l being the l th element while t k stands for the k th discrete time instant p denotes a constant periodic coupling matrix defined as 11 p r m 1 n r sin r m ω δ t for r n n where δ t t 2 n 1 t being the base period of oscillation corresponding to ω to summarize the harmonic balance method transforms one transient problem into a set of 2 n 1 quasi steady state problems each describing one equidistantly spaced time instant of period t the steady equations are coupled through the source term defined by eqn 10 convection diffusion and source terms from the transient equation remain unchanged for more details on the hb method the reader is referred to hall et al 2002 while the detailed derivation with implementation in foam extend can be found in cvijetić et al 2016 in the following text the governing equations described in section 2 1 are rewritten in the hb form 2 2 1 conservation of mass and momentum equations in case of incompressible flow the conservation of mass eqn 1 has no rate of change term and hence remains unchanged this results in 2 n 1 mass conservation equations which are mutually independent 12 u p l u i l l 1 2 n 1 the momentum equation eqn 2 has two time derivative terms in the swense decomposed form hence two hb source terms are introduced 13 s l u p u l u p l ν e f f l u p l s l u i u l u i l ν e f f l u i l 1 ρ l p d l u l ν e f f l l 1 2 n 1 note that each quasi steady state equation has corresponding density ρ l and effective kinematic viscosity ν e f f l fields it is emphasised here that although the two hb source terms in eqn 13 could be combined into a single term since they are linear operators this is not performed in order to allow implicit treatment of the source term for the perturbation velocity field u p while explicitly accounting for the hb source term of the incident velocity field u i as stated earlier convection diffusion and source terms from the original momentum equation eqn 2 remain unchanged apart from the fact that they are solved for the corresponding velocity field u l 2 2 2 level set transport equation the ls equation eqn 3 is transformed in a similar manner as the momentum equation 14 s l ψ p l c l ψ p l ψ p l c l b ψ p l s l ψ i l c l ψ i l ψ i l c l b ψ i l b 2 ε tanh ψ l ε 2 similar to eqn 13 the hb source term is separated for the incident and perturbation parts of the solution to enable implicit treatment of the perturbation source coupling 3 numerical model in this section an overview of the numerical model is presented with detailed remarks on the implicit coupling of the hb source term and a brief description of the implicit treatment of the dynamic pressure and density discontinuities at the free surface using the gfm huang et al 2007 in addition notes on the fv discretisation used in this study are given jasak 1996 3 1 implicit coupling of hb source terms in the present model the source coupling between the quasi steady state equations is performed implicitly in a block matrix for details on the block matrix see saad 2003 each diagonal entry of the block matrix is a matrix of size 2 n 1 2 n 1 containing the diagonal coefficients of all steady state equations and their coupling in the off diagonal coefficients the entries of the solution and source vectors are 2 n 1 vectors note that velocity pressure and surface capturing equation are still solved in a segregated manner while only the coupling arising from hb method is resolved in a block matrix in order to show the benefits of implicit coupling the von neumann stability analysis is performed on a one dimensional convection problem in the hb form 15 q τ s q u q x where q τ presents the quasi temporal term which is introduced to facilitate marching towards the steady state solution while u denotes the vector field of velocities at individual discrete time instants for the sake of analysis we shell here depart from the formulation of hb method used in this work cvijetić et al 2016 and adhere to the more general form with the complex fourier series hall et al 2013 instead of truncating the fourier series to the real part eqn 5 the complete complex fourier series is used producing an imaginary unit in the temporal derivative hence eqn 15 assumes the following form 16 q τ i ω e 1 a e q u q x where i denotes the imaginary unit i 1 in order to examine an individual equation in the stability analysis eqn 16 has to be written in a decoupled manner in order to diagonalize eqn 16 expression q e 1 q is used and the equation is multiplied by e from the left furthermore velocity is linearised as u u i δ u and only first order convection term is retained u represents the mean convective velocity i is the identity vector and δ u is the perturbation of velocity eqn 16 takes the following form 17 q τ i ω a q u q x note that q represents the transformed variable in frequency domain since matrix a can easily be written as a diagonal matrix cvijetić et al 2016 the system of equations described by eqn 17 is decoupled hence each l th equation can be observed independently 18 q l τ i ω l q l u q l x for the sake of brevity the first order upwind scheme is used for discretisation of the convection term while the first order accurate euler scheme is used for the discretisation of the quasi temporal term implicit treatment is assumed for the convection since it is used throughout this work first explicit coupling of the hb source term will be examined followed by the analysis of the implicit approach superscript n denotes the new time step value while o denotes the old time step value for explicit coupling of hb source term the discretised form of eqn 18 states 19 q l p n q l p o δ τ i ω l q l p o u q l p n q l p 1 n δ x where p stands for the p th grid point i e cell centre in the von neumann analysis fourier transform is used to present the distribution of the variable in space 20 q l p q n c n c v l q e i p q π n c p 1 n c where n c stands for the total number of cells grid points and v l q is the vector of q th fourier amplitudes for the system to be stable the magnitude of the amplification factor g v l q n v l q o must always be smaller than one for every q since this condition has to be valid for each fourier coefficient index q is excluded from this point on and an arbitrary fourier coefficient is used 21 q l p v l e i p α where α represents a general phase angle substituting eqn 21 into eqn 19 yields 22 v l n e i p α v l o e i p α δ τ i ω l v l o e i p α u v l n e i p α v l n e i p 1 α δ x by simplifying eqn 22 the amplification factor is obtained 23 v l n v l o 1 i δ τ ω l 1 u δ τ δ x 1 e i α which can be written in a more suitable form by introducing the courant friedrichs lewy number c o u δ τ δ x 24 v l n v l o 1 i c o δ x ω l u 1 c o 1 e i α from eqn 24 it follows that the solution is conditionally stable by observing the numerator the solution is less stable the magnitude of the amplification factor increases for high base frequencies coarse grid large δ x and small convective velocity the convective velocity poses a serious limit for practical applications since the mean velocity cannot be small or zero furthermore the stability deteriorates for larger number of harmonics which can limit the spectral resolution of the simulation in case of implicit hb source coupling the discretised form of eqn 15 reads 25 q l p n q l p o δ τ i ω l q l p n u q l p n q l p 1 n δ x from which by analogy with eqn 22 eqn 23 and eqn 24 follows 26 v l n v l o 1 1 i c o δ x ω l u c o 1 e i α hence the implicit hb source term coupling leads to an unconditionally stable solution furthermore eqn 26 implies the opposite of eqn 24 here the stability increases with coarser spatial grid higher base frequency smaller velocity and larger number of harmonics hence implicit coupling enables stable simulations with low computational demands and more importantly it enables simulating flows with low mean velocity this is crucial for naval hydrodynamic applications since surface wave related problems often have close to zero or zero mean velocity it should be noted that the von neumann stability is performed on a linearised equation set where the convective velocity does not change from time step to time step hence it gives a limited but valuable insight into the stability behaviour of the approach in this paper it will be shown that not all observations arising from the stability analysis hold entirely however the general difference between the implicit and explicit approach are well predicted the discretised quasi steady state equations are solved in a single block system to allow implicit coupling of the hb source term four block matrices are assembled one for each component of the vectorial momentum equation eqn 13 and one for the level set equation eqn 14 the mass conservation equation eqn 1 is not solved in a block system since it does not contain coupling terms between the quasi steady state equations in addition to these equations a general two equation turbulence model can be used with explicit or implicit coupling of the hb source term given the steady state nature of the method procedure based on simple algorithm is used the solution algorithm is organised as follows image 1 3 2 notes on the ghost fluid method the gfm implicitly accounts for the discontinuity of the pressure gradient and density at the free surface by satisfying the kinematic and dynamic free surface boundary conditions the kinematic free surface boundary condition states that the velocity is continuous across the interface while the dynamic boundary condition requires the stresses at the interface to be in equilibrium stress at the free surface is usually divided into normal and tangential parts where the normal part is mainly due to pressure while the tangential originates from viscous stresses the gfm used in this work vukčević et al 2017 takes into account the jump in pressure gradient due to density jump while neglecting the surface tension effects the tangential stress is approximated using linearly interpolated kinematic viscosity at the interface this assumption is considered justified for large scale free surface flows huang et al 2007 considered in this work reader is referred to vukčević vukčević et al 2017 for the detailed derivation of gfm within arbitrary polyhedral fv framework since the pressure field is not decomposed via swense nor affected with the hb approach there is no need for special treatment of the jump conditions in the present model 3 3 finite volume discretisation second order accurate fv method is used for spatial discretisation of the governing equations eqn 12 eqn 13 and eqn 14 with arbitrary polyhedral cell support jasak and gosman 2001 in the transient simulations implicit euler scheme is used for the temporal derivative terms in the momentum equation eqn 13 implicit upwind scheme with deferred second order correction is used to discretise the convection term second order scheme with explicit limited non orthogonal correction is used for the discretisation of the diffusion term and the pressure equation jasak 1996 3 4 relaxation zones same as in the transient simulations the wave reflection can occur in hb quasi steady state simulations as well the reflected waves would pollute the results since they are periodic with a base frequency corresponding to the incident wave to prevent reflection of free surface waves against the domain boundaries the perturbed components of velocity and level set fields are artificially damped towards the boundaries the gradual diminishing of the perturbed components is performed in the relaxation zones which are described by vukčević et al 2016b and jasak et al 2015 4 verification and validation detailed verification and validation is performed on two test cases a periodic flow over a ramp and a regular wave propagation with uniform current the validation is performed by comparing the hb results to transient simulation results transient simulation results obtained using the present numerical framework are considered referent since they have been thoroughly verified and validated in numerous publications vukčević et al 2016a vukčević and jasak 2015a 2015b gatin et al 2015 jasak et al 2015 verification is performed by conducting a grid refinement study uncertainties are assessed following stern et al 2001 and roache 1997 additionally a spectral resolution sensitivity study is performed by changing the number of resolved harmonics n next comparison with the explicit hb method is shown for the wave propagation case confirming the stability analysis finally comparison of computational time between hb and transient method is shown to determine the type of convergence the discriminating ratio is calculated based on a specified refinement ratio r of at least three solutions eça and hoekstra 2014 27 r ε f m ε m c s f s m s m s c where s denotes the solution obtained with the fine f medium m or coarse c resolution the final solutions are determined as the average of converged solution in the last two hundreds of nonlinear iterations uncertainty assessment procedure depends on the convergence type which is established using the discriminating ratio r eça and hoekstra 2014 monotone convergence mc for 0 r 1 uncertainty is assessed using the achieved order of convergence p 28 u f s ε f m r p 1 where f s 1 5 denotes the safety factor used throughout this study achieved order of convergence p is determined by richardson extrapolation 29 p ln ε f m ε m c ln r oscillatory convergence oc for r 0 and r 1 following stern et al 2001 the uncertainty is calculated as 30 u f s 0 5 s u s l where s u denotes the maximum value of the result while s l stands for the minimum value among the three solutions monotone divergence md for r 1 and oscillatory divergence od for r 0 and r 1 although uncertainty cannot be determined for divergence simonsen et al 2013b suggest expressing uncertainty as the maximum deviation multiplied with the safety factor 31 u f s s u s l in the spectral convergence study iterative uncertainty is also presented to asses the stability of convergence with respect to the resolved number of harmonics the iterative uncertainty is determined as the largest amplitude of oscillation of the converged solution stern et al 2001 32 u i 0 5 s u c s l c where s u c and s l c present the lowest and highest value of the converged solution in the same simulation for both test cases grid convergence study is performed with the refinement ratio r 2 where two harmonics are used for the grid refinement study in order to investigate the sensitivity of the result on the resolved number of harmonics results using 1 to 8 harmonics are presented and compared with transient simulation result 4 1 periodic free surface flow over a ramp two phase inviscid flow over a ramp fig 1 is simulated using a periodic inlet velocity resulting in nonlinear periodically oscillating free surface particulars of the geometry can be seen on fig 2 the two phases are water with ρ 1000 kg m3 and air with ρ 1 2 kg m3 while the kinematic viscosity is set to zero for both phases making the present gfm exact for this simulation since there are no tangential stresses at the free surface incident velocity is constant in all quasi steady state simulations u i 6 0 0 m s while calm free surface is imposed at h 1 m as shown in fig 1 where the arrows indicate the incident velocity field no relaxation zones are used in this test case the domain is 9 m long and 2 m high at t 0 the perturbation velocity u p level set ψ p and dynamic pressure field p d are set to zero oscillating velocity inlet boundary condition is imposed by prescribing the perturbation u p component values that describe a sinusoidal oscillation in time 33 u p i n l e t t u a sin ω t where u a 1 0 0 m s is the amplitude of the oscillation resulting in total inlet velocity u oscillating between 5 0 0 and 7 0 0 m s the frequency of oscillation is set to ω π rad s yielding the period of oscillation t 2 s since the inviscid flow is considered slip boundary conditions for velocity are used at the bottom and top boundaries while zero gradient is used at the outlet for dynamic pressure zero gradient boundary condition is used at the bottom inlet and outlet boundary while fixed value is set at the top boundary for perturbation level set fixed value is set to zero at the inlet boundary while incident level set define the calm water initial condition zero gradient is set on the outlet bottom and top boundary 4 1 1 reference transient simulation transient simulation is performed using a grid with 13 000 cells with a periodic inlet velocity boundary condition corresponding to eqn 33 in order to ensure periodic convergence 20 periods are simulated zeroth η a 0 and first η a 1 order harmonic amplitudes of free surface elevation are obtained with fast fourier transform fft of the wave elevation signal in time which is measured 0 5 m from the outlet boundary moving window is used for the input of the fft where the width of the window corresponds to the period t successive moving window fft s are used to determine the periodic convergence of the zeroth and first order harmonic amplitudes fig 3 presents the time series of the free surface elevation while the corresponding periodic convergence obtained using the moving window fft is shown in fig 4 where the convergence of zeroth first and second order can be seen with respect to number of simulated periods the convergence is achieved after approximately 5 wave periods i e 10 s of simulated time the converged zeroth first and second order free surface elevation amplitudes are shown in table 1 and will be used for comparison with the hb simulation 4 1 2 grid refinement study the grid refinement study for the hb approach presented in this work is performed using three grids with 3 250 13 000 and 52 000 cells yielding refinement ratio r 2 since two harmonics are used the grid uncertainty is assessed for the zeroth first and second orders of the free surface elevation near the outlet boundary fig 5 sequentially shows the dynamic pressure in converged hb and transient simulations corresponding to the time instants t 5 2 t 5 3 t 5 4 t 5 and t note that the period t is discretised using 5 time instants since two harmonics are used see eqn 10 the location of the interface can be recognized by the sharp dynamic pressure jump obtained by the gfm in all three simulations 3000 iterations are performed to ensure convergence as shown in fig 6 where convergence of zeroth first and second order harmonic amplitudes of the surface elevation η a is presented for all three grids note that the convergence is faster for coarser grids as indicated by the stability analysis see eqn 26 the results of the grid convergence study are summarised in table 2 where type of convergence achieved order of accuracy and grid uncertainty in percentages is shown for zeroth first and second order all three harmonics exhibit monotone convergence with uncertainties below 0 1 for zeroth and first order and below 2 for the second order the higher uncertainty of the second order is expected since it is most likely to contain the truncation error caused by the finite fourier series and it has a relatively small absolute value approximately 10 of the first order amplitude the achieved order of accuracy ranging from 1 75 to 2 9 shows that the convergence is not perfect however second order accuracy of the fv method is generally achieved in the hb approach 4 1 3 spectral resolution sensitivity study in order to establish the sensitivity of the result with respect to resolved number of harmonics results with 1 3 5 6 and 7 harmonics are presented as was the case in the grid convergence study 3000 iterations are performed to ensure convergence convergence of the zeroth first and second order harmonic amplitudes of surface elevation η a is shown on fig 7 for 2 4 and 8 harmonics although it is predicted in the stability analysis improvement of convergence is not observed with increasing the number of harmonics in this case fig 8 shows the solution of the zeroth first and second order harmonic amplitudes with respect to the resolved number of harmonics although accurate results can be obtained with 4 harmonics the convergence is reached after 7 harmonics indicating that this case requires large spectral resolution for the second order harmonic amplitude small change in result is observed between 7 and 8 harmonics as well table 3 shows the results of the zeroth η a 0 first η a 1 and second η a 2 harmonic of the surface elevation for different spectral resolutions i e number of harmonics and relative difference with respect to transient simulation the relative difference ε s t s h b s t between hb and transient simulation results is given in percentages where s t denotes the transient solution while s h b denotes the harmonic balance solution ε 0 ε 1 and ε 2 denote the relative difference of the zeroth first and second order harmonic amplitudes of the free surface elevation respectively the relative difference of the zeroth order amplitude with the transient simulation is 1 64 with one resolved harmonic reducing to approximately 0 2 with the increase of resolved harmonics the relative difference for the first order exhibits larger dependence on the number of resolved harmonics reducing from 15 with one harmonic to 2 1 with eight resolved harmonics for the second order the trend with increasing number of harmonics crosses the transient result and converges to around 15 difference 4 2 regular wave propagation with current viscous 2d simulations of regular wave propagation with uniform current are performed as a second test case a mildly steep wave is used with t 4 s and h 0 3 m with a current of 4 m s aligned with direction of wave propagation resulting in wave length λ 43 6 m and wave steepness k a 0 0216 the domain is four wave lengths long with half wave length relaxation zones at the inlet and outlet boundaries leaving three wave lengths of unaffected computation domain surface elevation is measured in the middle of domain at x 87 2 m water depth is set to 6 m while the top boundary is set 1 m above the mean free surface level unlike the ramp test case free surface and velocity are initialised using the nonlinear stream function wave theory rienecker and fenton 1981 solution at given time instances thus the initial condition for free surface elevation and velocity field should be very close to the final solution initial condition for t t is presented in fig 9 where the magnitude of the initial velocity field is shown along with clearly visible position of the free surface the perturbation components of velocity u p and level set ψ p as well as dynamic pressure are initialised to zero 4 2 1 reference transient simulation transient simulation is performed using the fine grid with 36 540 cells from the grid refinement study of hb method below 400 time steps per wave period are used while 50 wave periods have been simulated to ensure periodic convergence zeroth first and second order harmonic amplitudes of the free surface elevation η a are obtained using the moving window fft as described in the previous test case fig 10 shows the time signal of the free surface elevation while fig 11 shows the periodic convergence of zeroth first and second order harmonic amplitudes of the free surface obtained using moving window fft on successive wave periods where it can be seen that acceptable convergence is obtained the converged values of zeroth first and second harmonic amplitudes are given in table 4 which are later used to validate the present approach by comparing the same grid refinement level 4 2 2 grid refinement study constant grid refinement ratio r 2 is used therefore the three used grids have 2 284 9 135 and 36 540 cells the number of cells per wave height is 15 30 and 60 respectively same as in the ramp test case zeroth first and second order harmonic amplitudes of the free surface elevation are considered fig 12 shows the converged solution corresponding to t t as an example where dynamic pressure p d is shown 5000 time steps are performed in all cases to ensure convergence fig 13 shows convergence of zeroth first and second order using different grids where it can be seen that all items converge grid uncertainties are presented in table 5 with the type of convergence and assessed order of accuracy p note that grid uncertainties are presented in absolute values rather than in percentages since the zeroth order harmonic amplitude is close to zero all items exhibited monotone convergence with the order of accuracy of 1 6 for the first and 2 1 for the second order harmonic the zeroth order has a very low order of accuracy which could indicate that the refinement study is not within the asymptotic range for the zeroth order the uncertainty for the first order is 1 29 in respect to the fine grid solution while the second order exhibited 7 74 uncertainty 4 2 3 spectral resolution sensitivity study same as in the ramp test case spectral resolution sensitivity study is performed using 1 to 8 harmonics on the fine grid with comparison to transient results following the grid convergence study 5000 time steps are performed to ensure convergence which is shown on fig 14 for the zeroth first and second order harmonic amplitudes of the free surface elevation η a i using 2 4 and 8 resolved harmonics it can be observed that increasing the number of harmonics accelerates and enhances the convergence of both zeroth and first order amplitudes which is in accordance with the stability analysis presented in section 3 1 the zeroth first and second order harmonic amplitudes of free surface elevation with respect to number of harmonics are shown in fig 15 where it can be seen that zeroth and first order converge rapidly with the increase of resolved harmonics it can be concluded that 2 harmonics will give satisfactory results when simulating waves with small steepness for the second order the convergence is not as pronounced however for all harmonics the second order solution is within 0 00578 and 0 00606 which corresponds to an uncertainty interval of 4 6 for solutions obtained using four or more harmonics the uncertainty interval is 1 7 which is acceptable for second harmonic of linear wave that has a small amplitude results obtained with 1 2 3 4 5 6 7 and 8 resolved harmonics are presented in table 6 with corresponding differences with the transient solution the solution is taken as average over the last one hundred iterations where the iterative uncertainty remains below 1 for all items with increasing the number of harmonics the iterative uncertainty reduces as indicated in fig 14 difference for the zeroth order amplitude is given as absolute value instead of relative due to a close to zero absolute values of the zeroth order amplitude differences between the hb simulation and the transient simulation are very small below 1 for the first order in all cases as opposed to the ramp test case it is evident that here the higher order harmonic amplitudes have minor influence since the differences for the first order do not decrease with the increasing number of resolved harmonics i e one resolved harmonic is sufficient as expected for a linear wave k a 0 0216 this is also true for the second order where the difference stays below 10 except with three harmonics note that since truncation of the fourier series is always present in hb the hb solution can never be exactly the same as the transient solution due to the truncation error 4 2 4 comparison of computational time in this section computational time is compared between the transient and hb simulations table 7 shows the computational time needed for simulation on the fine grid level for both hb and transient approach t c p u stands for computational time while t c p u c stands for the computational time elapsed until convergence for the transient simulation the solution is considered converged after 10 periods at which point first and second order harmonic amplitudes converged while zeroth order still experiences oscillations however the oscillations of the zeroth order are relatively small and the mean value does not change considerably see fig 11 hb simulations are considered converged after 3 000 iterations after which zeroth first and second order harmonic amplitudes converged see fig 14 hb simulations take more computational time to converge even with only one resolved harmonic hence the savings in time is not exhibited for the case of wave propagation savings in computational time reported in related publications e g mcmullen and jameson 2005 is not reproduced here due to more numerically expensive implicit coupling of hb equations solving a system using block matrices demands more computational time due to more time consuming numerical inversion of resulting block matrix 5 comparison with explicit hb source coupling in order to confirm that implicit coupling is necessary for surface waves related problems explicit hb approach is used to simulate the regular wave described in section 4 2 where two and three harmonics and three grid refinements are used fig 16 shows the convergence of the first order surface elevation harmonic amplitudes with three grid resolutions used in section 4 2 2 where explicit coupling between hb steady state simulations is used as the stability study indicated refining the grid enhances the convergence for explicit coupling notwithstanding all of the simulations eventually diverged regardless of the number of harmonics and grid refinement similar behaviour is exhibited for other harmonics which are not shown for brevity fig 17 shows the convergence comparison between simulations where two and three harmonics have been used as indicated by the stability analysis increasing number of harmonics deteriorates the convergence for explicit coupling presented results obtained using explicit coupling of hb source terms confirm that implicit coupling is necessary for marine hydrodynamic applications of hb method even at moderate current of 4 m s explicit coupling fails to converge 6 regular wave propagation without current in this section the main assumption behind the reasoning for implicit coupling of hb source terms is tested regular wave propagation simulations are performed with no current i e zero mean flow velocity which cannot be performed using the explicit approach a test matrix with all combinations of grid resolutions and number of resolved harmonics is conducted in order to investigate the stability limits of the approach hence simulations using three grids are conducted with 1 8 resolved harmonics i e 24 simulations altogether same regular wave characteristics are used as in the above studies it is shown that with zero mean velocity the method has more difficulties to converge and requires larger spectral resolution compared to the simulations with current for each grid level a separate table is given showing zeroth first and second order harmonic amplitudes of the free surface elevation the results are given in table 8 table 9 and table 10 iterative uncertainty is given as a convergence indicator calculated according to eqn 32 where the last 1000 iterations are considered 10 000 iterations are performed in each simulation to ensure convergence the dashed line in the tables divides the converged and diverged simulations where the later are above the line on the coarse grid level the simulation where one harmonic was used failed to converge as can be seen in table 8 from the unrealistic values of zeroth and first harmonic amplitudes and from high iterative uncertainties increasing the number of harmonics reduces the iterative uncertainty which is expected according to the stability analysis first order harmonic amplitude shows convergence with increasing number of harmonics while the zeroth order oscillates second order harmonic converges with increasing harmonics except for the case where 7 harmonics are used which should be investigated further refining the grid deteriorates the convergence on the medium grid at least four harmonics are needed to obtain a stable result where large iterative uncertainties are exhibited for the zeroth and second order amplitudes with the fine grid 6 harmonics are required for convergence while 7 and 8 produce acceptably low numerical uncertainties for first order amplitude as expected refining the grid requires higher spectral resolution in order to ensure convergence which is in accordance with the stability analysis however the stability analysis showed that at zero mean velocity the method should be unconditionally stable which is not the case instead the tests presented in this section show that the method is conditionally stable as stated before the von neumann stability analysis is performed by introducing assumptions for linearisation of governing equations thus giving limited insight into the stability of the actual method nonetheless it is proven here that implicit coupling enables simulations with zero mean velocity in order to quantify the stability conditions reduced frequency ω is introduced 34 ω δ x ω n u which appears in the denominator of eqn 26 ω can be calculated for every cell in the fv domain in which case u represents the local velocity in the cell centre larger ω means better stability meaning that the minimum of ω in the computational domain presents a stability criterion note that the c o number is not considered here since it ranged from 0 2 to 1 2 having minor influence on the change of stability between the grid levels this is confirmed since refining the grid increases the c o which should enhance the stability of the simulation however increasing the grid resolution deteriorates the convergence leading to a conclusion that reduced frequency is dominant table 11 shows the minimum reduced frequency ω m i n for simulations with every combination of grid resolution and number of harmonics as well as convergence status which is indicated for clarity c stands for converged and d stands for diverged the same data is presented graphically in fig 18 the relation between ω m i n and convergence is consistent there is no overlapping interval of ω m i n where both convergence and divergence is exhibited rendering ω m i n a good measure of stability minimal ω m i n which yielded a converged solution is 0 241 while the maximum that failed to converge equals to 0 162 hence the stability limit is somewhere in between these two values 7 conclusion a viscous spectral fully nonlinear numerical method for two phase flow simulations is presented in this paper the method is based on the harmonic balance approach applied to an existing transient viscous two phase numerical method the disability of the hb method to simulate flows with zero or close to zero mean flow velocities is overcome by coupling the hb equations implicitly benefits of implicit coupling are proved mathematically using von neumann stability analysis which showed that implicit coupling provides unconditional stability with respect to the number of resolved harmonics grid resolution and mean flow velocity verification and validation is performed on two test cases where grid refinement studies and spectral resolution sensitivity studies have been carried out the results are compared to a referent transient simulation for validation verification study showed monotone grid convergence for all items with low grid uncertainties while the order of accuracy ranges from 1 6 to 2 86 the results agree well with the transient simulation with the majority of items having the relative difference below 1 comparing the computational time of hb method with the transient simulation revealed that hb simulations require more time to converge which is contrary to the findings shown in previous publications larger computational time is caused by implicit coupling of hb equations using block matrix which is necessary for naval hydrodynamic applications next the inadequacy of explicit hb coupling approach for low mean velocity is demonstrated on a wave propagation test case with current to test the hypothesis that zero mean velocities can be simulated using implicit hb coupling detailed study is performed for wave propagation without current number of resolved harmonics are varied as well as grid resolution confirming that the stability enhances with increasing spectral resolution and decreasing grid resolution which is predicted by the von neumann stability analysis however it is shown that the method is conditionally stable contrary to the prediction of the stability analysis nonetheless the method proved to be applicable for wave propagation with zero mean flow rendering the approach feasible for naval hydrodynamic applications the present model proved to be applicable in the field of naval hydrodynamics and generally for periodic viscous nonlinear large scale two phase flows acceptable accuracy can be achieved in the comparison with the transient approach while attaining the stationary character of equations the ability to transform a periodic transient flow into steady state opens a possibility for automatic optimisation of hull geometry with respect to wave related objectives such as added wave resistance or ship motion this is a new opportunity which will be investigated in the future the next step is to perform realistic simulations where wave hull interaction will be involved including wave induced ship motion acknowledgements the author š malenica acknowledges the support from a national research foundation of korea nrf grant funded by the korean government msip through gcrc sop grant no 2011 0030013 
23423,the harmonic balance method applied to fully nonlinear viscous temporally periodic free surface flows is presented in this paper the harmonic balance approach is used to project a transient periodic two phase flow into multiple coupled steady state problems discretising the periodic time interval the numerical framework is based on finite volume method for computational fluid dynamics in the open source software foamextend the disability of the harmonic balance method to simulate flows with zero or close to zero mean velocity is overcome by coupling the harmonic balance steady state equations implicitly presenting a novelty in the field von neumann stability analysis is performed for the governing harmonic balance equations to mathematically prove that zero mean velocity can be simulated using the proposed implicit coupling the method is validated and verified on a periodic free surface flow over a ramp and regular surface wave propagation with current both including grid convergence studies and spectral resolution sensitivity studies all results are compared to fully transient computations a detailed study is performed for wave propagation without current confirming that convergence of free surface elevation can be achieved without mean velocity the approach proved accurate and applicable for twophase flows opening a new research field keywords periodic free surface flows cfd harmonic balance naval hydrodynamics foam extend 1 introduction this work presents the development implementation and validation of the time spectral method for simulating fully nonlinear viscous temporally periodic large scale two phase flows based on an existing two phase numerical model developed within a finite volume fv computational fluid dynamics cfd software foam extend jasak 2009 the method is specifically intended for general two phase flows where the boundary conditions have a temporally periodic nature with low or zero mean velocity resulting in a periodic flow field in the domain of interest such flows are often encountered in problems regarding surface waves which are important in the field of naval offshore and ocean hydrodynamics the frequency domain methods are very common in the naval hydrodynamics but mainly within the potential flow approach the simplest example is the evaluation of the linear transfer functions so called response amplitude operator rao which is the basic ingredient of the linear spectral analysis which allows for very quick assessment of the floating body response for any particular sea conditions the main drawback of the frequency domain approach within the potential flow assumptions is associated with the difficulties related to the inclusion of the different nonlinear effects indeed within the classical approach the resulting boundary value problems for higher order velocity potentials quickly become very complex leading to many numerical difficulties e g see ferrant et al 1999 malenica and molin 1995 consequently the common practice within the potential flow approach is to resolve up to the second order in frequency domain and apply the fully nonlinear time domain approach for highly nonlinear problems however it is well known that the potential flow approach has very limited use for fully nonlinear wave body interactions because of the difficulties associated with the proper treatment of the complex free surface boundary conditions that is why there is still no efficient fully nonlinear wave body interaction solver based on potential flow theory which has been proposed in the literature only some relatively simple nonlinear wave body interaction problems such as one discussed in ferrant et al 1999 were efficiently solved within the potential flow approach viscous cfd methods are an obvious alternative since they offer reliable results as shown in numerous validation publications vukčević et al 2015 2016a vukčević and jasak 2015a gatin et al 2015 larsson et al 2013 consequently in the recent years a number of publications dealing with the application of viscous cfd on the problems of wave induced motions and loads in naval hydrodynamics have emerged silva et al 2017 hashimoto et al 2016 wu et al 2011 thilleul et al 2011 kim et al 2012 chen et al 2014 windén et al 2012 mousaviraad et al 2015 carrica et al 2011 kim 2011 qiu et al 2014 carrica et al 2008 seng et al 2014 el moctar et al 2017 time domain simulations prevail when it comes to viscous naval hydrodynamic cfd calculations however in the field of turbomachinery spectral cfd methods present an active area of research nonlinear harmonic method applied to navier stokes equations was first presented by he and ning 1998 for simulating unsteady viscous flow around turbomachinery blades the nonlinear harmonic method also called harmonic balance hb takes advantage of the temporally periodic nature of the flow with a known dominant frequency of oscillation by transforming a transient problem into a number of coupled steady state problems the main drawback of simulating periodic flows with viscous cfd using transient time marching techniques is the requirement for large number of simulated periods before reaching fully developed periodical flow simonsen et al 2013a vukčević and jasak 2015a larsson et al 2015a 2015b hb alleviates this problem while additionally accelerating the calculation by considering steady state problems which are generally faster to perform the advantages of hb were soon recognized in the cfd community resulting in a large number of publications mostly related to turbomachinery applications maple et al 2004 developed an adaptive hb method where the number of resolved harmonics is varied in the domain depending on the required spectral resolution applied to a supersonic subsonic diverging nozzle mcmullen and jameson 2005 investigated the acceleration techniques for solving the coupled set of steady state problems where they reported 8 19 times acceleration in terms of computational time comparing with the transient code ekici et al 2008 used euler equations based hb method to simulate helicopter rotor blade flow while guédeney et al guedeney et al 2013 extended the method for turbomachinery flows with multiple frequencies in order to capture rotor stator interaction effects apart from being easier and faster to calculate steady state equations provide the ability of automatic optimisation in case of hb method objectives for optimisation can be related to periodic quantities huang huang and ekici 2014 used hb method in conjunction with discrete adjoint optimisation method to optimise turbomachinery blades in the field of naval hydrodynamics minimisation of added wave resistance or ship motion could be achieved to the authors knowledge no attempt has been made to develop a hb method for nonlinear two phase viscous and turbulent free surface flows with low or zero mean flow velocity in this work hb method is employed for the calculation of periodic free surface flows where implicit coupling of steady state equations is performed by solving the equations in a block matrix form implicit coupling enables running simulations at large reduced frequency numbers hall et al 2013 which is the stability criteria stemming from the von neumann stability analysis of the hb equations in practice this enables low and zero mean flow velocities and coarser spatial grids the implicit coupling presents a novelty with respect to existing publications regarding the hb method the development is based on the previously performed implementation by cvijetić et al 2016 where single phase explicit hb method is described for turbomachinery applications the targeted practical applications of the presented hb method are associated with the evaluation of the transfer functions of ship s response in waves at different orders of approximation linear quadratic higher order etc and for assessing added resistance in waves these transfer functions are then used in combination with the body operating conditions to derive the long term design values e g see journée and massie journeé and massie 2001 even though the real sea state is irregular and composed of very large number of individual waves with different amplitude and frequencies design methods exist which are based on the use of the so called equivalent regular design waves soares et al 2015 hence having the efficient numerical tool for the evaluation of the wave body interactions in regular waves can be very useful in practice this paper is organised as follows first the mathematical model is presented comprising the governing equations in the swense spectral wave explicit navier stokes equations decomposed form as described by vukčević et al 2016b and the hb treatment of the time derivative term next an overview of the numerical method is given including the implicit coupling of the hb source term followed by brief notes on implementation of the ghost fluid method gfm in foam extend vukčević et al 2017 in order to assess the new model two validation test cases are presented a two phase periodic flow over a ramp and regular wave propagation with uniform current additionally the implicit method is compared to explicitly coupled hb method for the wave propagation case with current next a stability study is performed on a wave propagation case without current finally concluding remarks are given 2 mathematical model in this section a brief overview of the mathematical model describing two phase nonlinear and viscous flow is given presenting the governing equations in the swense vukčević et al 2016b ducrozet et al 2014 ferrant et al 2002 decomposed form and briefly outlining the formulation of dynamic pressure and density jump at the interface using the gfm huang et al 2007 vukčević et al 2017 furthermore a description of governing equations in the time spectral hb form is given 2 1 governing equations two phase incompressible viscous flow is governed by the momentum conservation equation mass conservation equation and an interface capturing equation in the appropriate form the equations below are given in the swense decomposed form vukčević et al 2016b where an arbitrary field q is written as q q i q p index i denotes the incident component typically corresponding to a solution obtained by potential flow while index p denotes the perturbation component being solved for via equation set the incident terms are treated explicitly as they are assumed to be known at each time instant formally this decomposition is arbitrary but it is assumed that the incident field provides a good estimate of the final nonlinear solution i e that the component q i is smaller than q p reader is directed to vukčević et al 2017 for detailed derivation of the following equation set for incompressible flow the conservation of mass reads 1 u p u i where u denotes the velocity field although the potential flow solution is formally divergence free u i 0 mapping this field to a discretised volume mesh generally introduces continuity errors vukčević et al 2016b which are resolved in eqn 1 the swense decomposed momentum equation reads 2 u p t u u p ν e f f u p u i t u u i ν e f f u i 1 ρ p d u ν e f f where ν e f f stands for effective kinematic viscosity including the turbulent viscosity ρ is the density which has a discontinuity at the interface while p d stands for dynamic pressure p d p ρ g x where p denotes total pressure g represents constant gravitational acceleration and x is the radii vector the velocity in the last term on the right hand side is not decomposed since it is treated explicitly more details regarding decomposition of the pressure term are given in vukčević et al 2016b in this study level set ls method derived from the phase field pf equation sun and beckermann 2007 2008 is used for interface capturing due to its suitability for swense decomposition vukčević et al 2016b since signed distance function is unbounded the decomposed ls equation reads 3 ψ p t c ψ p ψ p c b ψ p ψ i t c ψ i ψ i c b ψ i b 2 ε tanh ψ ε 2 where ψ denotes the ls field decomposed into incident ψ i and perturbed component ψ p while b and ε stand for numerical parameters diffusion coefficient and width parameter respectively c is the modified convective velocity defined as 4 c u b 2 ε tanh ψ ε 2 ψ b κ ψ ψ where κ denotes the mean interface curvature for additional details the reader is referred to vukčević et al 2016b 2 2 harmonic balance method in this section the time spectral form of hb transformation is applied to all governing equations only a brief overview of the hb method is given here while for detailed derivation of the implemented model the reader is referred to cvijetić et al 2016 using hb method the transient equations are transformed into a set of steady state equations coupled via source term that represents the time derivative terms in the spectral domain the hb method is based on the assumption of temporally periodic flow where each variable is expanded into a fourier series with a finite number of harmonics n 5 q t x q 0 l 1 n q s l sin l ω t q c l cos l ω t where q t x represents a general field variable in time while q denotes the fourier coefficient of the variable in frequency domain ω is the known base frequency of q and indices s l and c l denote the sine and cosine fourier coefficient respectively in time domain the standard transport equation for general variable q can be written as 6 q t ℛ 0 where ℛ stands for convection diffusion and source sink terms note that ℛ f q t x however it is considered here as one term for the sake of clarity ℛ is also expanded into fourier series analogous to eqn 5 inserting the fourier expansion of q and ℛ into eqn 6 and equating the corresponding trigonometric terms yields 7 ω a q r 0 where a presents the 2 n 1 2 n 1 coefficient matrix while q and r are vectors containing 2 n 1 fourier coefficients of q and ℛ respectively the fourier series expansion eqn 5 can be regarded as a discrete fourier transform which can be viewed as a matrix multiplication q e q where q presents a vector of discrete time values of q t x thus eqn 7 can be written in terms of time domain variables as 8 ω a e q e r 0 which is simplified by multiplying by e 1 from the left yielding a time spectral form 9 ω e 1 a e q r 0 eqn 9 presents a set of quasi steady state equations coupled by the off diagonal elements of the matrix e 1 a e hence comparing eqn 9 and eqn 6 indicates that the time derivative term is replaced by a source term which can be written as 10 s q ω e 1 a e q s l q 2 ω 2 n 1 k 1 2 n p k l q t k l 1 2 n 1 where s q stands for the hb temporal coupling source vector s l being the l th element while t k stands for the k th discrete time instant p denotes a constant periodic coupling matrix defined as 11 p r m 1 n r sin r m ω δ t for r n n where δ t t 2 n 1 t being the base period of oscillation corresponding to ω to summarize the harmonic balance method transforms one transient problem into a set of 2 n 1 quasi steady state problems each describing one equidistantly spaced time instant of period t the steady equations are coupled through the source term defined by eqn 10 convection diffusion and source terms from the transient equation remain unchanged for more details on the hb method the reader is referred to hall et al 2002 while the detailed derivation with implementation in foam extend can be found in cvijetić et al 2016 in the following text the governing equations described in section 2 1 are rewritten in the hb form 2 2 1 conservation of mass and momentum equations in case of incompressible flow the conservation of mass eqn 1 has no rate of change term and hence remains unchanged this results in 2 n 1 mass conservation equations which are mutually independent 12 u p l u i l l 1 2 n 1 the momentum equation eqn 2 has two time derivative terms in the swense decomposed form hence two hb source terms are introduced 13 s l u p u l u p l ν e f f l u p l s l u i u l u i l ν e f f l u i l 1 ρ l p d l u l ν e f f l l 1 2 n 1 note that each quasi steady state equation has corresponding density ρ l and effective kinematic viscosity ν e f f l fields it is emphasised here that although the two hb source terms in eqn 13 could be combined into a single term since they are linear operators this is not performed in order to allow implicit treatment of the source term for the perturbation velocity field u p while explicitly accounting for the hb source term of the incident velocity field u i as stated earlier convection diffusion and source terms from the original momentum equation eqn 2 remain unchanged apart from the fact that they are solved for the corresponding velocity field u l 2 2 2 level set transport equation the ls equation eqn 3 is transformed in a similar manner as the momentum equation 14 s l ψ p l c l ψ p l ψ p l c l b ψ p l s l ψ i l c l ψ i l ψ i l c l b ψ i l b 2 ε tanh ψ l ε 2 similar to eqn 13 the hb source term is separated for the incident and perturbation parts of the solution to enable implicit treatment of the perturbation source coupling 3 numerical model in this section an overview of the numerical model is presented with detailed remarks on the implicit coupling of the hb source term and a brief description of the implicit treatment of the dynamic pressure and density discontinuities at the free surface using the gfm huang et al 2007 in addition notes on the fv discretisation used in this study are given jasak 1996 3 1 implicit coupling of hb source terms in the present model the source coupling between the quasi steady state equations is performed implicitly in a block matrix for details on the block matrix see saad 2003 each diagonal entry of the block matrix is a matrix of size 2 n 1 2 n 1 containing the diagonal coefficients of all steady state equations and their coupling in the off diagonal coefficients the entries of the solution and source vectors are 2 n 1 vectors note that velocity pressure and surface capturing equation are still solved in a segregated manner while only the coupling arising from hb method is resolved in a block matrix in order to show the benefits of implicit coupling the von neumann stability analysis is performed on a one dimensional convection problem in the hb form 15 q τ s q u q x where q τ presents the quasi temporal term which is introduced to facilitate marching towards the steady state solution while u denotes the vector field of velocities at individual discrete time instants for the sake of analysis we shell here depart from the formulation of hb method used in this work cvijetić et al 2016 and adhere to the more general form with the complex fourier series hall et al 2013 instead of truncating the fourier series to the real part eqn 5 the complete complex fourier series is used producing an imaginary unit in the temporal derivative hence eqn 15 assumes the following form 16 q τ i ω e 1 a e q u q x where i denotes the imaginary unit i 1 in order to examine an individual equation in the stability analysis eqn 16 has to be written in a decoupled manner in order to diagonalize eqn 16 expression q e 1 q is used and the equation is multiplied by e from the left furthermore velocity is linearised as u u i δ u and only first order convection term is retained u represents the mean convective velocity i is the identity vector and δ u is the perturbation of velocity eqn 16 takes the following form 17 q τ i ω a q u q x note that q represents the transformed variable in frequency domain since matrix a can easily be written as a diagonal matrix cvijetić et al 2016 the system of equations described by eqn 17 is decoupled hence each l th equation can be observed independently 18 q l τ i ω l q l u q l x for the sake of brevity the first order upwind scheme is used for discretisation of the convection term while the first order accurate euler scheme is used for the discretisation of the quasi temporal term implicit treatment is assumed for the convection since it is used throughout this work first explicit coupling of the hb source term will be examined followed by the analysis of the implicit approach superscript n denotes the new time step value while o denotes the old time step value for explicit coupling of hb source term the discretised form of eqn 18 states 19 q l p n q l p o δ τ i ω l q l p o u q l p n q l p 1 n δ x where p stands for the p th grid point i e cell centre in the von neumann analysis fourier transform is used to present the distribution of the variable in space 20 q l p q n c n c v l q e i p q π n c p 1 n c where n c stands for the total number of cells grid points and v l q is the vector of q th fourier amplitudes for the system to be stable the magnitude of the amplification factor g v l q n v l q o must always be smaller than one for every q since this condition has to be valid for each fourier coefficient index q is excluded from this point on and an arbitrary fourier coefficient is used 21 q l p v l e i p α where α represents a general phase angle substituting eqn 21 into eqn 19 yields 22 v l n e i p α v l o e i p α δ τ i ω l v l o e i p α u v l n e i p α v l n e i p 1 α δ x by simplifying eqn 22 the amplification factor is obtained 23 v l n v l o 1 i δ τ ω l 1 u δ τ δ x 1 e i α which can be written in a more suitable form by introducing the courant friedrichs lewy number c o u δ τ δ x 24 v l n v l o 1 i c o δ x ω l u 1 c o 1 e i α from eqn 24 it follows that the solution is conditionally stable by observing the numerator the solution is less stable the magnitude of the amplification factor increases for high base frequencies coarse grid large δ x and small convective velocity the convective velocity poses a serious limit for practical applications since the mean velocity cannot be small or zero furthermore the stability deteriorates for larger number of harmonics which can limit the spectral resolution of the simulation in case of implicit hb source coupling the discretised form of eqn 15 reads 25 q l p n q l p o δ τ i ω l q l p n u q l p n q l p 1 n δ x from which by analogy with eqn 22 eqn 23 and eqn 24 follows 26 v l n v l o 1 1 i c o δ x ω l u c o 1 e i α hence the implicit hb source term coupling leads to an unconditionally stable solution furthermore eqn 26 implies the opposite of eqn 24 here the stability increases with coarser spatial grid higher base frequency smaller velocity and larger number of harmonics hence implicit coupling enables stable simulations with low computational demands and more importantly it enables simulating flows with low mean velocity this is crucial for naval hydrodynamic applications since surface wave related problems often have close to zero or zero mean velocity it should be noted that the von neumann stability is performed on a linearised equation set where the convective velocity does not change from time step to time step hence it gives a limited but valuable insight into the stability behaviour of the approach in this paper it will be shown that not all observations arising from the stability analysis hold entirely however the general difference between the implicit and explicit approach are well predicted the discretised quasi steady state equations are solved in a single block system to allow implicit coupling of the hb source term four block matrices are assembled one for each component of the vectorial momentum equation eqn 13 and one for the level set equation eqn 14 the mass conservation equation eqn 1 is not solved in a block system since it does not contain coupling terms between the quasi steady state equations in addition to these equations a general two equation turbulence model can be used with explicit or implicit coupling of the hb source term given the steady state nature of the method procedure based on simple algorithm is used the solution algorithm is organised as follows image 1 3 2 notes on the ghost fluid method the gfm implicitly accounts for the discontinuity of the pressure gradient and density at the free surface by satisfying the kinematic and dynamic free surface boundary conditions the kinematic free surface boundary condition states that the velocity is continuous across the interface while the dynamic boundary condition requires the stresses at the interface to be in equilibrium stress at the free surface is usually divided into normal and tangential parts where the normal part is mainly due to pressure while the tangential originates from viscous stresses the gfm used in this work vukčević et al 2017 takes into account the jump in pressure gradient due to density jump while neglecting the surface tension effects the tangential stress is approximated using linearly interpolated kinematic viscosity at the interface this assumption is considered justified for large scale free surface flows huang et al 2007 considered in this work reader is referred to vukčević vukčević et al 2017 for the detailed derivation of gfm within arbitrary polyhedral fv framework since the pressure field is not decomposed via swense nor affected with the hb approach there is no need for special treatment of the jump conditions in the present model 3 3 finite volume discretisation second order accurate fv method is used for spatial discretisation of the governing equations eqn 12 eqn 13 and eqn 14 with arbitrary polyhedral cell support jasak and gosman 2001 in the transient simulations implicit euler scheme is used for the temporal derivative terms in the momentum equation eqn 13 implicit upwind scheme with deferred second order correction is used to discretise the convection term second order scheme with explicit limited non orthogonal correction is used for the discretisation of the diffusion term and the pressure equation jasak 1996 3 4 relaxation zones same as in the transient simulations the wave reflection can occur in hb quasi steady state simulations as well the reflected waves would pollute the results since they are periodic with a base frequency corresponding to the incident wave to prevent reflection of free surface waves against the domain boundaries the perturbed components of velocity and level set fields are artificially damped towards the boundaries the gradual diminishing of the perturbed components is performed in the relaxation zones which are described by vukčević et al 2016b and jasak et al 2015 4 verification and validation detailed verification and validation is performed on two test cases a periodic flow over a ramp and a regular wave propagation with uniform current the validation is performed by comparing the hb results to transient simulation results transient simulation results obtained using the present numerical framework are considered referent since they have been thoroughly verified and validated in numerous publications vukčević et al 2016a vukčević and jasak 2015a 2015b gatin et al 2015 jasak et al 2015 verification is performed by conducting a grid refinement study uncertainties are assessed following stern et al 2001 and roache 1997 additionally a spectral resolution sensitivity study is performed by changing the number of resolved harmonics n next comparison with the explicit hb method is shown for the wave propagation case confirming the stability analysis finally comparison of computational time between hb and transient method is shown to determine the type of convergence the discriminating ratio is calculated based on a specified refinement ratio r of at least three solutions eça and hoekstra 2014 27 r ε f m ε m c s f s m s m s c where s denotes the solution obtained with the fine f medium m or coarse c resolution the final solutions are determined as the average of converged solution in the last two hundreds of nonlinear iterations uncertainty assessment procedure depends on the convergence type which is established using the discriminating ratio r eça and hoekstra 2014 monotone convergence mc for 0 r 1 uncertainty is assessed using the achieved order of convergence p 28 u f s ε f m r p 1 where f s 1 5 denotes the safety factor used throughout this study achieved order of convergence p is determined by richardson extrapolation 29 p ln ε f m ε m c ln r oscillatory convergence oc for r 0 and r 1 following stern et al 2001 the uncertainty is calculated as 30 u f s 0 5 s u s l where s u denotes the maximum value of the result while s l stands for the minimum value among the three solutions monotone divergence md for r 1 and oscillatory divergence od for r 0 and r 1 although uncertainty cannot be determined for divergence simonsen et al 2013b suggest expressing uncertainty as the maximum deviation multiplied with the safety factor 31 u f s s u s l in the spectral convergence study iterative uncertainty is also presented to asses the stability of convergence with respect to the resolved number of harmonics the iterative uncertainty is determined as the largest amplitude of oscillation of the converged solution stern et al 2001 32 u i 0 5 s u c s l c where s u c and s l c present the lowest and highest value of the converged solution in the same simulation for both test cases grid convergence study is performed with the refinement ratio r 2 where two harmonics are used for the grid refinement study in order to investigate the sensitivity of the result on the resolved number of harmonics results using 1 to 8 harmonics are presented and compared with transient simulation result 4 1 periodic free surface flow over a ramp two phase inviscid flow over a ramp fig 1 is simulated using a periodic inlet velocity resulting in nonlinear periodically oscillating free surface particulars of the geometry can be seen on fig 2 the two phases are water with ρ 1000 kg m3 and air with ρ 1 2 kg m3 while the kinematic viscosity is set to zero for both phases making the present gfm exact for this simulation since there are no tangential stresses at the free surface incident velocity is constant in all quasi steady state simulations u i 6 0 0 m s while calm free surface is imposed at h 1 m as shown in fig 1 where the arrows indicate the incident velocity field no relaxation zones are used in this test case the domain is 9 m long and 2 m high at t 0 the perturbation velocity u p level set ψ p and dynamic pressure field p d are set to zero oscillating velocity inlet boundary condition is imposed by prescribing the perturbation u p component values that describe a sinusoidal oscillation in time 33 u p i n l e t t u a sin ω t where u a 1 0 0 m s is the amplitude of the oscillation resulting in total inlet velocity u oscillating between 5 0 0 and 7 0 0 m s the frequency of oscillation is set to ω π rad s yielding the period of oscillation t 2 s since the inviscid flow is considered slip boundary conditions for velocity are used at the bottom and top boundaries while zero gradient is used at the outlet for dynamic pressure zero gradient boundary condition is used at the bottom inlet and outlet boundary while fixed value is set at the top boundary for perturbation level set fixed value is set to zero at the inlet boundary while incident level set define the calm water initial condition zero gradient is set on the outlet bottom and top boundary 4 1 1 reference transient simulation transient simulation is performed using a grid with 13 000 cells with a periodic inlet velocity boundary condition corresponding to eqn 33 in order to ensure periodic convergence 20 periods are simulated zeroth η a 0 and first η a 1 order harmonic amplitudes of free surface elevation are obtained with fast fourier transform fft of the wave elevation signal in time which is measured 0 5 m from the outlet boundary moving window is used for the input of the fft where the width of the window corresponds to the period t successive moving window fft s are used to determine the periodic convergence of the zeroth and first order harmonic amplitudes fig 3 presents the time series of the free surface elevation while the corresponding periodic convergence obtained using the moving window fft is shown in fig 4 where the convergence of zeroth first and second order can be seen with respect to number of simulated periods the convergence is achieved after approximately 5 wave periods i e 10 s of simulated time the converged zeroth first and second order free surface elevation amplitudes are shown in table 1 and will be used for comparison with the hb simulation 4 1 2 grid refinement study the grid refinement study for the hb approach presented in this work is performed using three grids with 3 250 13 000 and 52 000 cells yielding refinement ratio r 2 since two harmonics are used the grid uncertainty is assessed for the zeroth first and second orders of the free surface elevation near the outlet boundary fig 5 sequentially shows the dynamic pressure in converged hb and transient simulations corresponding to the time instants t 5 2 t 5 3 t 5 4 t 5 and t note that the period t is discretised using 5 time instants since two harmonics are used see eqn 10 the location of the interface can be recognized by the sharp dynamic pressure jump obtained by the gfm in all three simulations 3000 iterations are performed to ensure convergence as shown in fig 6 where convergence of zeroth first and second order harmonic amplitudes of the surface elevation η a is presented for all three grids note that the convergence is faster for coarser grids as indicated by the stability analysis see eqn 26 the results of the grid convergence study are summarised in table 2 where type of convergence achieved order of accuracy and grid uncertainty in percentages is shown for zeroth first and second order all three harmonics exhibit monotone convergence with uncertainties below 0 1 for zeroth and first order and below 2 for the second order the higher uncertainty of the second order is expected since it is most likely to contain the truncation error caused by the finite fourier series and it has a relatively small absolute value approximately 10 of the first order amplitude the achieved order of accuracy ranging from 1 75 to 2 9 shows that the convergence is not perfect however second order accuracy of the fv method is generally achieved in the hb approach 4 1 3 spectral resolution sensitivity study in order to establish the sensitivity of the result with respect to resolved number of harmonics results with 1 3 5 6 and 7 harmonics are presented as was the case in the grid convergence study 3000 iterations are performed to ensure convergence convergence of the zeroth first and second order harmonic amplitudes of surface elevation η a is shown on fig 7 for 2 4 and 8 harmonics although it is predicted in the stability analysis improvement of convergence is not observed with increasing the number of harmonics in this case fig 8 shows the solution of the zeroth first and second order harmonic amplitudes with respect to the resolved number of harmonics although accurate results can be obtained with 4 harmonics the convergence is reached after 7 harmonics indicating that this case requires large spectral resolution for the second order harmonic amplitude small change in result is observed between 7 and 8 harmonics as well table 3 shows the results of the zeroth η a 0 first η a 1 and second η a 2 harmonic of the surface elevation for different spectral resolutions i e number of harmonics and relative difference with respect to transient simulation the relative difference ε s t s h b s t between hb and transient simulation results is given in percentages where s t denotes the transient solution while s h b denotes the harmonic balance solution ε 0 ε 1 and ε 2 denote the relative difference of the zeroth first and second order harmonic amplitudes of the free surface elevation respectively the relative difference of the zeroth order amplitude with the transient simulation is 1 64 with one resolved harmonic reducing to approximately 0 2 with the increase of resolved harmonics the relative difference for the first order exhibits larger dependence on the number of resolved harmonics reducing from 15 with one harmonic to 2 1 with eight resolved harmonics for the second order the trend with increasing number of harmonics crosses the transient result and converges to around 15 difference 4 2 regular wave propagation with current viscous 2d simulations of regular wave propagation with uniform current are performed as a second test case a mildly steep wave is used with t 4 s and h 0 3 m with a current of 4 m s aligned with direction of wave propagation resulting in wave length λ 43 6 m and wave steepness k a 0 0216 the domain is four wave lengths long with half wave length relaxation zones at the inlet and outlet boundaries leaving three wave lengths of unaffected computation domain surface elevation is measured in the middle of domain at x 87 2 m water depth is set to 6 m while the top boundary is set 1 m above the mean free surface level unlike the ramp test case free surface and velocity are initialised using the nonlinear stream function wave theory rienecker and fenton 1981 solution at given time instances thus the initial condition for free surface elevation and velocity field should be very close to the final solution initial condition for t t is presented in fig 9 where the magnitude of the initial velocity field is shown along with clearly visible position of the free surface the perturbation components of velocity u p and level set ψ p as well as dynamic pressure are initialised to zero 4 2 1 reference transient simulation transient simulation is performed using the fine grid with 36 540 cells from the grid refinement study of hb method below 400 time steps per wave period are used while 50 wave periods have been simulated to ensure periodic convergence zeroth first and second order harmonic amplitudes of the free surface elevation η a are obtained using the moving window fft as described in the previous test case fig 10 shows the time signal of the free surface elevation while fig 11 shows the periodic convergence of zeroth first and second order harmonic amplitudes of the free surface obtained using moving window fft on successive wave periods where it can be seen that acceptable convergence is obtained the converged values of zeroth first and second harmonic amplitudes are given in table 4 which are later used to validate the present approach by comparing the same grid refinement level 4 2 2 grid refinement study constant grid refinement ratio r 2 is used therefore the three used grids have 2 284 9 135 and 36 540 cells the number of cells per wave height is 15 30 and 60 respectively same as in the ramp test case zeroth first and second order harmonic amplitudes of the free surface elevation are considered fig 12 shows the converged solution corresponding to t t as an example where dynamic pressure p d is shown 5000 time steps are performed in all cases to ensure convergence fig 13 shows convergence of zeroth first and second order using different grids where it can be seen that all items converge grid uncertainties are presented in table 5 with the type of convergence and assessed order of accuracy p note that grid uncertainties are presented in absolute values rather than in percentages since the zeroth order harmonic amplitude is close to zero all items exhibited monotone convergence with the order of accuracy of 1 6 for the first and 2 1 for the second order harmonic the zeroth order has a very low order of accuracy which could indicate that the refinement study is not within the asymptotic range for the zeroth order the uncertainty for the first order is 1 29 in respect to the fine grid solution while the second order exhibited 7 74 uncertainty 4 2 3 spectral resolution sensitivity study same as in the ramp test case spectral resolution sensitivity study is performed using 1 to 8 harmonics on the fine grid with comparison to transient results following the grid convergence study 5000 time steps are performed to ensure convergence which is shown on fig 14 for the zeroth first and second order harmonic amplitudes of the free surface elevation η a i using 2 4 and 8 resolved harmonics it can be observed that increasing the number of harmonics accelerates and enhances the convergence of both zeroth and first order amplitudes which is in accordance with the stability analysis presented in section 3 1 the zeroth first and second order harmonic amplitudes of free surface elevation with respect to number of harmonics are shown in fig 15 where it can be seen that zeroth and first order converge rapidly with the increase of resolved harmonics it can be concluded that 2 harmonics will give satisfactory results when simulating waves with small steepness for the second order the convergence is not as pronounced however for all harmonics the second order solution is within 0 00578 and 0 00606 which corresponds to an uncertainty interval of 4 6 for solutions obtained using four or more harmonics the uncertainty interval is 1 7 which is acceptable for second harmonic of linear wave that has a small amplitude results obtained with 1 2 3 4 5 6 7 and 8 resolved harmonics are presented in table 6 with corresponding differences with the transient solution the solution is taken as average over the last one hundred iterations where the iterative uncertainty remains below 1 for all items with increasing the number of harmonics the iterative uncertainty reduces as indicated in fig 14 difference for the zeroth order amplitude is given as absolute value instead of relative due to a close to zero absolute values of the zeroth order amplitude differences between the hb simulation and the transient simulation are very small below 1 for the first order in all cases as opposed to the ramp test case it is evident that here the higher order harmonic amplitudes have minor influence since the differences for the first order do not decrease with the increasing number of resolved harmonics i e one resolved harmonic is sufficient as expected for a linear wave k a 0 0216 this is also true for the second order where the difference stays below 10 except with three harmonics note that since truncation of the fourier series is always present in hb the hb solution can never be exactly the same as the transient solution due to the truncation error 4 2 4 comparison of computational time in this section computational time is compared between the transient and hb simulations table 7 shows the computational time needed for simulation on the fine grid level for both hb and transient approach t c p u stands for computational time while t c p u c stands for the computational time elapsed until convergence for the transient simulation the solution is considered converged after 10 periods at which point first and second order harmonic amplitudes converged while zeroth order still experiences oscillations however the oscillations of the zeroth order are relatively small and the mean value does not change considerably see fig 11 hb simulations are considered converged after 3 000 iterations after which zeroth first and second order harmonic amplitudes converged see fig 14 hb simulations take more computational time to converge even with only one resolved harmonic hence the savings in time is not exhibited for the case of wave propagation savings in computational time reported in related publications e g mcmullen and jameson 2005 is not reproduced here due to more numerically expensive implicit coupling of hb equations solving a system using block matrices demands more computational time due to more time consuming numerical inversion of resulting block matrix 5 comparison with explicit hb source coupling in order to confirm that implicit coupling is necessary for surface waves related problems explicit hb approach is used to simulate the regular wave described in section 4 2 where two and three harmonics and three grid refinements are used fig 16 shows the convergence of the first order surface elevation harmonic amplitudes with three grid resolutions used in section 4 2 2 where explicit coupling between hb steady state simulations is used as the stability study indicated refining the grid enhances the convergence for explicit coupling notwithstanding all of the simulations eventually diverged regardless of the number of harmonics and grid refinement similar behaviour is exhibited for other harmonics which are not shown for brevity fig 17 shows the convergence comparison between simulations where two and three harmonics have been used as indicated by the stability analysis increasing number of harmonics deteriorates the convergence for explicit coupling presented results obtained using explicit coupling of hb source terms confirm that implicit coupling is necessary for marine hydrodynamic applications of hb method even at moderate current of 4 m s explicit coupling fails to converge 6 regular wave propagation without current in this section the main assumption behind the reasoning for implicit coupling of hb source terms is tested regular wave propagation simulations are performed with no current i e zero mean flow velocity which cannot be performed using the explicit approach a test matrix with all combinations of grid resolutions and number of resolved harmonics is conducted in order to investigate the stability limits of the approach hence simulations using three grids are conducted with 1 8 resolved harmonics i e 24 simulations altogether same regular wave characteristics are used as in the above studies it is shown that with zero mean velocity the method has more difficulties to converge and requires larger spectral resolution compared to the simulations with current for each grid level a separate table is given showing zeroth first and second order harmonic amplitudes of the free surface elevation the results are given in table 8 table 9 and table 10 iterative uncertainty is given as a convergence indicator calculated according to eqn 32 where the last 1000 iterations are considered 10 000 iterations are performed in each simulation to ensure convergence the dashed line in the tables divides the converged and diverged simulations where the later are above the line on the coarse grid level the simulation where one harmonic was used failed to converge as can be seen in table 8 from the unrealistic values of zeroth and first harmonic amplitudes and from high iterative uncertainties increasing the number of harmonics reduces the iterative uncertainty which is expected according to the stability analysis first order harmonic amplitude shows convergence with increasing number of harmonics while the zeroth order oscillates second order harmonic converges with increasing harmonics except for the case where 7 harmonics are used which should be investigated further refining the grid deteriorates the convergence on the medium grid at least four harmonics are needed to obtain a stable result where large iterative uncertainties are exhibited for the zeroth and second order amplitudes with the fine grid 6 harmonics are required for convergence while 7 and 8 produce acceptably low numerical uncertainties for first order amplitude as expected refining the grid requires higher spectral resolution in order to ensure convergence which is in accordance with the stability analysis however the stability analysis showed that at zero mean velocity the method should be unconditionally stable which is not the case instead the tests presented in this section show that the method is conditionally stable as stated before the von neumann stability analysis is performed by introducing assumptions for linearisation of governing equations thus giving limited insight into the stability of the actual method nonetheless it is proven here that implicit coupling enables simulations with zero mean velocity in order to quantify the stability conditions reduced frequency ω is introduced 34 ω δ x ω n u which appears in the denominator of eqn 26 ω can be calculated for every cell in the fv domain in which case u represents the local velocity in the cell centre larger ω means better stability meaning that the minimum of ω in the computational domain presents a stability criterion note that the c o number is not considered here since it ranged from 0 2 to 1 2 having minor influence on the change of stability between the grid levels this is confirmed since refining the grid increases the c o which should enhance the stability of the simulation however increasing the grid resolution deteriorates the convergence leading to a conclusion that reduced frequency is dominant table 11 shows the minimum reduced frequency ω m i n for simulations with every combination of grid resolution and number of harmonics as well as convergence status which is indicated for clarity c stands for converged and d stands for diverged the same data is presented graphically in fig 18 the relation between ω m i n and convergence is consistent there is no overlapping interval of ω m i n where both convergence and divergence is exhibited rendering ω m i n a good measure of stability minimal ω m i n which yielded a converged solution is 0 241 while the maximum that failed to converge equals to 0 162 hence the stability limit is somewhere in between these two values 7 conclusion a viscous spectral fully nonlinear numerical method for two phase flow simulations is presented in this paper the method is based on the harmonic balance approach applied to an existing transient viscous two phase numerical method the disability of the hb method to simulate flows with zero or close to zero mean flow velocities is overcome by coupling the hb equations implicitly benefits of implicit coupling are proved mathematically using von neumann stability analysis which showed that implicit coupling provides unconditional stability with respect to the number of resolved harmonics grid resolution and mean flow velocity verification and validation is performed on two test cases where grid refinement studies and spectral resolution sensitivity studies have been carried out the results are compared to a referent transient simulation for validation verification study showed monotone grid convergence for all items with low grid uncertainties while the order of accuracy ranges from 1 6 to 2 86 the results agree well with the transient simulation with the majority of items having the relative difference below 1 comparing the computational time of hb method with the transient simulation revealed that hb simulations require more time to converge which is contrary to the findings shown in previous publications larger computational time is caused by implicit coupling of hb equations using block matrix which is necessary for naval hydrodynamic applications next the inadequacy of explicit hb coupling approach for low mean velocity is demonstrated on a wave propagation test case with current to test the hypothesis that zero mean velocities can be simulated using implicit hb coupling detailed study is performed for wave propagation without current number of resolved harmonics are varied as well as grid resolution confirming that the stability enhances with increasing spectral resolution and decreasing grid resolution which is predicted by the von neumann stability analysis however it is shown that the method is conditionally stable contrary to the prediction of the stability analysis nonetheless the method proved to be applicable for wave propagation with zero mean flow rendering the approach feasible for naval hydrodynamic applications the present model proved to be applicable in the field of naval hydrodynamics and generally for periodic viscous nonlinear large scale two phase flows acceptable accuracy can be achieved in the comparison with the transient approach while attaining the stationary character of equations the ability to transform a periodic transient flow into steady state opens a possibility for automatic optimisation of hull geometry with respect to wave related objectives such as added wave resistance or ship motion this is a new opportunity which will be investigated in the future the next step is to perform realistic simulations where wave hull interaction will be involved including wave induced ship motion acknowledgements the author š malenica acknowledges the support from a national research foundation of korea nrf grant funded by the korean government msip through gcrc sop grant no 2011 0030013 
23424,the newly developed node based partly smoothed point interpolation method nps pim and immersed technique are coupled to simulate fluid structure interaction fsi problems associated with largely deformable solid structure under the framework of immersed method the governing equations can be decomposed into three components based on fictitious fluid assumption i e equations for incompressible viscous fluid fsi conditions and nonlinear solid the semi implicit characteristic based split algorithm is used to solve the navier stokes equation of incompressible viscous fluid and the fictitious fluid domain can be used to calculate the fsi force owing to the properly softened stiffness by the node based partly strain smoothing operation nps pim can effectively solve the large deformation problem of solids discretized with the simplest linear triangular mesh the immersed framework makes the present method avoid the troublesome re meshing process and the triangular mesh further simplifies the preprocessing operation in comparison with the models using fem and node based smoothed point interpolation method ns pim as solid solver numerical results have shown that the present method using nps pim can provide more accurate solutions for both steady and transient problems with regard to large displacement fsi problems keywords immersed methods smoothed point interpolation method fluid structure interaction large deformation 1 introduction to simulate the fluid structure interaction fsi phenomenon involving large deformable solids structures numerically is considered to be an extremely challenging work numerical methods have been viewed as a powerful tool in light of continual improvements of both the methods themselves and computer hardware the grid based numerical methods have been widely used for the majority of these fsi problems and the meshfree and particle methods generally work well for the extreme distortion problems hu et al 2014 liu and li 2016 liu and liu 2015 liu et al 2014 long et al 2016 tang et al 2016 zhang et al 2016 2017 for those grid based numerical methods the treats for fluid structure interfaces bring about constantly improvement and development for numerical techniques the moving mesh techniques were successfully used to impose the coupling condition for fsi simulation when coping with the varying interfaces such as arbitrary lagrangian eulerian ale hu et al 2001 liu et al 1988 liu and ma 1982 nordanger et al 2016 and space time st methods bazilevs et al 2008 takizawa and tezduyar 2011 tezduyar et al 1994 2008 for ale based on body fitted mesh methods the fluid mesh conforms to the solid boundary and deforms with moving boundary which makes the methods to provide accurate solution for high reynolds number configuration where the capture of the turbulent boundary layer is crucial however the feature of body fitted mesh may make the method encounter challenges when simulating problems with large deformation and body contact configuration and generally for this case mesh regeneration is needed during the process then a series of immersed typed methods using non conforming mesh have been developed which can avoid the troublesome mesh regeneration initially the immersed boundary ib methods were proposed by peskin peskin 1977 2002 and have been successfully applied to analyze the blood flow problem in the scheme of ib methods the solid boundary is considered to cover the fluid with the same properties as the real fluid and the values of velocity and force for the interface can be numerically obtained through an interpolation operation eulerian grids are used to distribute the fluid and the solid placed in the fluid domain is described in lagrangian form generally the immersed boundary methods are categorized as two groups i e continuous forcing approach and discrete forcing approach mittal and iaccarino 2005 toja silva et al 2014 for the continuous forcing approach a forcing term is added into the governing equations before discretization which accounts for the effect of immersed boundary and numerous simulations have been achieved associated with rigid or elastic boundaries by this kind of methods beyer and leveque 1992 goldstein et al 1993 lai and peskin 2000a peskin 1977 on the other hand if the equations are discretized firstly and a body force is introduced to enforce the desired velocity on the boundary it is the framework of discrete forcing approach or direct forcing approach liao et al 2010a there are also two categories on the basis of the imposition for boundary condition indirectly fadlun et al 2000 gilmanov and sotiropoulos 2005 uhlmann 2005 or directly clarke et al 1986 ye et al 1999 the present method can be considered as a discrete forcing approach with indirect boundary condition imposition in most of ib methods the solid is assumed as fiber like immersed elastic structure which restrains realistic modeling of structures with nonlinear constitutive laws and the structure only carries mass but does not occupy volume then the immersed finite element methods ifem lee et al 2007 zhang and gay 2007 zhang et al 2004 were successfully proposed which can establish realistic material model by introducing the fictitious fluid to cover the whole solid domain by introducing the newly smoothed finite element method s fem into the scheme of ifem the immersed smoothed finite element methods is fem zhang and liu 2011 zhang et al 2012a b were proposed which can further improve the solid solver performance for largely deformable problems in many fsi analysis we are primarily interested in the structural response especially for large displacement or deformable nonlinear solids structures conventionally the dynamic analysis of solids is conducted by the fem procedure it is well known that a standard galerkin fem model is fully compatible behaves overly stiff and provides a lower bound in energy norm of numerical results to soften stiffness by introducing the generalized gradient smoothing operation smoothed finite element methods s fem liu and nguyen thoi 2010 liu et al 2009a and smoothed point interpolation methods s pim liu et al 2009b 2009c liu and zhang 2013 have been proposed in the schemes of fem and meshfree methods respectively as one important member of s pim modes the node based smoothed point interpolation method ns pim has been found behave overly soft and proved to be able of provide upper bound solutions in energy norm for elasticity problems liu and zhang 2008 liu et al 2011 wu et al 2009 so consider the overly stiff fem and the overly soft ns pim a combination of these two method called node based partly smoothed interpolation method nps pim has been proposed lu et al 2017 which possesses properly softened model stiffness and provides nearly exact solutions for solid problems for the proposed method the immersed type framework in ifem is adopted in which the nps pim is used for solving solid problems the incompressible navier stokes fluid flow is solved by the semi implicit characteristic based split cbs algorithm which allows same interpolation shape functions for fluid velocity and pressure therefore linear triangular background elements can be used for efficient preprocessing in both fluid and solid domains 2 the decomposition of governing equations in fsi systems the governing equations for fsi system and boundary conditions can be expressed as follows 1 ρ f d v f d t div σ f ρ f g x ω f ρ s d v s d t div σ s ρ s g x ω s v f v s on γ fs f s fsi f f fsi on γ fs where ρ f and ρ s are the densities of fluid and solid v f and v s are the velocities of fluid and solid g denotes gravity acceleration σ f and σ s are the cauchy stresses ω f and ω s are the fluid and solid domain respectively γ fs denotes fsi interface and f f fsi and f s fsi are the fsi force on the interface the fictitious fluid is introduced which overlaps with the solid domain and is viewed as the homogeneous material with the real fluid besides nodes in the fictitious fluid are supposed to be in consistency with the solid nodes as illustrated in fig 1 the solid domain ω s which is substituted by fictitious fluid domain ω fc can be separated from the fluid domain based on the fictitious fluid assumptions and we can obtain ω s ω fc and γ fc γ s the whole fluid domain ω f ω f ω fc can be described as eulerian mesh and the solid domain can adopt lagrangian mesh the motion equation for fictitious fluid is similar as equation 1 2 ρ fc d v fc d t div σ fc ρ fc g f fc x fc ω fc where an additional body force f fc is used to compel the fictitious fluid nodes to be consistent with solid nodes therefore a pair of action and reaction force f f fsi and f s fsi arise and denote fsi force exerted on the fictitious fluid and solid on the volume respectively f f fsi functions as a body force replacing f fc and satisfies the momentum balance 3 f f fsi ρ fc d v fc d t div σ fc ρ fc g with v fc v s in ω fc the integral form of equation 3 leads to 4 ω fc ρ f d v fc d t d ω ω fc div σ fc d ω ω fc ρ f g d ω f f fsi v fc v s in ω fc where 5 f f fsi ω fc f f fsi d ω and the fsi force exerted on the solid as reaction force can be expressed as follows 6 f s fsi f f fsi ω f c f f fsi d ω the global form f s fsi applied on the solid defines the drag and lift forces which are often used in computational fluid dynamics fields see details in equation 16 it reveals that the proposed fsi force on the solid is equivalent to the real fsi force only exerted on the fluid structure interface this demonstrates that the physical fsi force is applied on the solid it can be explained that the boundary integral is converted into field integral with regard to the solution of coupling force in a conservative field combined equation 4 with the integral form of motion equation for real fluid in equation 1 we can obtain 7 ω f ρ f d v f d t d ω ω fc ρ f d v fc d t d ω ω f div σ f d ω ω fc div σ fc d ω ω f ρ f g d ω ω fc ρ f g d ω f f fsi because the whole fluid domain ω f is filled with homogeneous fluid in the fixed euler grid the integral form equation 7 can be written as follows 8 ω f ρ f d v f d t d ω ω f div σ f d ω ω f ρ f g d ω f f fsi v f v s in ω fc using the fictitious fluid the fsi force can be obtained 9 f f fsi ρ f d v f d t div σ f ρ f g i with v f v s in ω f c eventually the governing equations can be decomposed into three components 1 nonlinear solid equations 2 incompressible viscous fluid equations 3 equations for fsi conditions and we can simplify the superscript f with f in the following text 1 solid 10 ρ s u s p s x s ρ s g boundary conditions n s σ s t s on γ t s v s v s on γ v s initial conditions p s p s 0 v s v s 0 t 0 where u s is the displacement of solid p s denotes the first piola kirchhoff stress n s denotes outward surface normal t s and v s are the solid force and velocity of boundary and p s 0 and v s 0 are the initial piola kirchhoff stress and velocity respectively 2 incompressible viscous fluid 11 ρ f v f t ρ f v f v f p f μ 2 v f ρ f g v f 0 boundary conditions g vbc f v v f v f 0 on γ v f g pbc f p p f p f 0 on γ p f initial conditions v f v f 0 p f p f 0 t 0 where p f is the pressure of fluid v f denotes the boundary velocity p f denotes the boundary pressure g vbc f v and g pbc f p denote boundary conditions of fluid velocity and pressure γ v f and γ p f denote the boundary of calculation domain and v f 0 and p f 0 are the initial velocity and pressure 3 fsi conditions 12 fsi velocity condition v f v s in ω fc 13 fsi forcing condition f s fsi f f fsi in ω s 14 f f fsi ρ f v f t ρ f v f v f p f μ 2 v f ρ f g in ω fc where ω fc denotes the fictitious domain and μ denotes dynamic viscosity the fsi force in equation 14 can be also expressed in its component form as follows 15 f i f fsi ρ f v i f t ρ f x j f v i f v j f p f x i f τ i j f x j f ρ f g i in ω fc where τ i j denotes deviatoric stress the fsi force exerted on the solid in integral form can be converted with regard to the divergence theorem if the gravity is neglected or included in the pressure term since the fluid density ρ f is constant 16 f i s fsi ω fc ρ f v i f t d ω ω fc ρ f v j f v i f x j f d ω ω fc τ i j f x j f d ω ω fc p f x j f d ω ω fc ρ f v i f t d ω γ fc ρ f v i f v j f n j fc d γ γ fc τ i j f n j f c d γ γ fc p f n j fc d γ where n j fc is the normal of outward surface γ fc the component forms f i s fsi of the fsi force in cartesian coordinates are the same as the drag and lift force defined in computational fluid dynamics fields lai and peskin 2000b liao et al 2010b 3 nps pim for dynamics analysis of solids 3 1 brief introduction on fem procedure if a group of n n s nodes and n e l e s triangular background cells are used to discretize the solid domain ω s 0 the displacement u s velocity v s and acceleration a s can be interpolated by the proper shape function φ i s 0 17 u s i φ i s 0 u i s v s i φ i s 0 v i s a s i φ i s 0 a i s the motion equation of solids can be written as following by substituting equation 17 into equation 10 and implementing the galerkin procedure 18 m i j s a j s f i ext f i int where m i j s is the lumped mass matrix a j s denotes acceleration vector f i int is the internal force vector and f i ext is the external force vector including gravity and fsi force the second piola kirchhoff pk2 stress s can be used to calculate the internal force 19 f i int ω s 0 b i t 0 s d ω where b i 0 is the strain displacement matrix which can be written as 20 b i 0 b i 0 0 b i 1 0 we can see that b i 0 includes two parts b i 0 0 denotes the initial state and b i 1 0 denotes the increment during deformation both of them are block matrices with the following 21 b i 0 0 b i 0 j 1 0 b i 0 j n s 0 b i 1 0 b i 1 j 1 0 b i 1 j n s 0 where j i denotes the ith supporting node of the domain and ns is the number of supporting nodes for 2d case the ith block can expressed as follows 22 b i 0 j i 0 φ j i s x s 0 0 φ j i s y s φ j i s y s φ j i s x s 23 b i 1 j i 0 φ i s 0 x s x j i s x s φ i s 0 x s y j i s x s φ i s 0 y s x j i s y s φ i s 0 y s y j i s y s φ i s 0 x s x j i s y s φ i s 0 y s x j i s x s φ i s 0 x s y j i s y s φ i s 0 y s y j i s x s where x j i s and y j i s denote the displacement of supporting node j i in x and y direction respectively in order to calculate the pk2 stress the deformation gradient f should be introduced which acts as an important measure parameter for the nonlinear analysis 24 f u i j s i where i is unit matrix and u i j s is the displacement gradient then the green strain vector e can be easily obtained 25 e 1 2 f t f i the deformable structures are modeled by the nearly incompressible saint venant kirchhoff material and the components s i j of the pk2 stress can be written by the derivation 26 s i j w e λ e k k δ i j 2 μ e i j where λ and μ are the lamé constants and the relationship with poisson s ratio ν and the young s modulus e can be expressed as follows 27 λ ν e 1 ν 1 2 ν μ e 2 1 ν the pk2 stress tensor s can be also expressed by the following form 28 s de where d is material constants matrix for a plane strain problem d can be written as 29 d e 1 ν 1 2 ν 1 ν ν 0 ν 1 ν 0 0 0 1 2 ν 2 for a plane stress problem d can be replaced by the following form 30 d e 1 ν 1 ν 1 ν 0 ν 1 0 0 0 1 ν 2 as for the present simulations section 6 3 is a plane stress problem and the others are plane strain problems 3 2 the gradient strain smoothing technique in s pim in the scheme of s pim the gradient strain smoothing operation is conducted on smoothing domains to soften the model stiffness which is the main difference between the s pim and the traditional fem suppose the domain ω 0 s is divided into n s d s smoothing domain ω i s d sd 0 with boundaries γ i s d sd 0 isd 1 2 n s d s the smoothing domains ω i s d sd 0 are non overlapped and covers the problem domain together the smoothed displacement gradient in ω i s d sd 0 can be achieved using the displacement gradient u i j s in the following form zhang et al 2012a 31 u i j s x l ω i s d sd 0 u i j s ξ w x l ξ d ω where u i j s x l is the smoothed displacement gradient w x l ξ is smoothed function and satisfies the unity property 32 ω i s d sd 0 w x l ξ d ω 1 the simple heaviside constant smoothed function is adopted with the following form when the area of the smoothing domain a i s d sd is known 33 w x l ξ 1 a i s d sd ξ ω i s d sd 0 0 ξ ω i s d sd 0 utilizing the divergence theorem for equation 31 and replacing the smoothed function with the above form the smoothed displacement gradient can be evolved in the boundary integration as follows 34 u i j s x l i 1 a i s d sd γ i s d sd 0 ω i s 0 x l n sd d γ u i s where n sd is the outward normal of the boundary γ i s d sd 0 i is the number of nodes in smoothing domain and the integration for the smoothed displacement gradient u i j s x l uses only the shape functions instead of their derivative used in fem therefore the derivative of the shape function can be avoided by the gradient strain smoothing technique and one can construct the smoothed strain displacement matrix b i 0 the smoothed deformation gradient f s can be yielded using the smoothed displacement gradient in place of displacement gradient 35 f s x l u i j s x l i then other smoothed variables can be obtained such as the smoothed green strain and the smoothed pk2 stress s using the smoothed deformation gradient in equations 25 and 26 3 3 node based partly smoothed point interpolation method nps pim it has been found fem presents overly stiff behavior in the analysis of solid mechanics and on the other hand the ns pim has overly soft property by conducting node based strain smoothing operation the nps pim is proposed by combining the features of both fem and ns pim to improve the solution for solid structures for the fem the problem domain is discretized by linear triangular elements as shown in fig 2 a for the ns pim as indicated in fig 2 b node based smoothing domains are further formed based on the triangular background cells and within them the strain smoothing operation is conducted then by combining the ideas of fem and ns pim and conducting the node based strain smoothing operation partly the nps pim model can be constructed as illustrated in fig 2 c for example suppose the edge length of one triangular element is 2b and the length of the central line is 3c 2 as shown in fig 2 a and for the ns pim this edge will be equally divided into two parts with length of b for each other and the length between the centroid point and the vertex is c then for the nps pim with a length ratio α the node based partly smoothing domain is of the edge length 1 α b and the central line length 1 α c respectively in which the strain smoothing operation will be conducted for the other part of the edge length α b which belongs to the node based smoothing domain originally in the scheme of ns pim the traditional fem operation will apply in the scheme of the present nps pim the above node based partly smoothing domain division applies to all the field nodes then the area of one background triangular cell can be divided into four parts i e three node based partly smoothing domains for the three vertexes and one central part for fem and the area for fem is as follows 36 a l i e α 2 a l i s where a l i s is the total triangular element area and a l i e is the area of calculation domain for fem the other three parts belong to different smoothing domains have equal area of 1 α 2 a l i s 3 and from fig 2 c the following relationship can be established between the node based partly smoothing domain ω l α and the node based smoothing domain ω i s d sd 0 37 a l α ω l α d ω i 1 n e l e k 1 α 2 a l i s 3 1 α 2 a i s d s d where a l α is the area of the node based partly smoothing domain and n e l e k denotes the number of cells connected with the reference node l then the solver procedure is carried out based on respective calculation domain and the total internal force f i t int are the sum of two parts 38 f i t int f i e int f i s int where f i e int is calculated by fem and f i s int is calculated by ns pim they can be expressed in discrete forms 39 f i e int i 1 n e l e s α 2 b i t 0 s a l i s 40 f i s int i 1 n n s 1 α 2 b i t 0 s a i s d sd where α 2 1 denotes fem solver and α 2 0 denotes ns pim solver 3 4 further discussion of parameter α 2 on the basis of virtual work principle the virtual energies δ w for the elastic body can be written as follows belytschko et al 2000 41 δ w δ u u δ w int δ w ext δ w inext 0 where 42 δ w int δ u t f i int δ w ext δ u t f i ext δ w inext δ u t m i j and considering the energy generated by internal force with two parts in nps pim the virtual strain energy δ w int can be deduced as 43 δ w i n t δ u t f i int δ u t f i e int f i s int δ u t ω e 0 b i t 0 d b i 0 d ω ω s 0 b i t 0 d b i 0 d ω u δ u t b i t d b i 0 α 2 a l i s b i t 0 d b i 0 1 α 2 a l i s u here d is material matrix and the total stiffness matrix k t is given by 44 k t b i t d b i 0 α 2 a l s b i t 0 d b i 0 1 α 2 a l s and we define the stiffness matrix of fem and ns pim as k e and k s in the solid domain respectively 45 k e b i t d b i 0 a l s k s b i t 0 d b i 0 a l s therefore the total virtual energies can also be described as the following 46 δ w δ u u δ u t α 2 k e 1 α 2 k s u δ u t f i ext δ u t m i j remarks 1 if α 2 1 the stain energy δ w int is underestimated due to the overly stiff behavior of fem and it can provide the lower bound energy solution 2 if α 2 0 the stain energy δ w int is overestimated due to the overly soft behavior of ns pim and it can give the upper bound energy solution 3 if α 2 0 0 1 0 the energy solution varies continuously from the solution of ns pim to that of fem with regard to the change of the model stiffness k t 4 from the property of fem and ns pim it is supposed that a proper value of α 2 will lead to a nps pim model with nearly exact stiffness by comparing with the exact solution however we cannot derive the value of α 2 in a theoretical way currently so in the following study different values of α 2 was selected to study the effect for the solid solver in the fsi system 4 characteristic based split for incompressible viscous fluid solver the semi implicit characteristic based split algorithm cbs is employed to solve the navier stokes equations of incompressible viscous flows where generally the fixed euler grid is used to discretize the fluid domain suppose the whole fluid domain ω f is divided into n e l e f t3 elements with n n f nodes by using the shape function φ i f the fluid velocity v i f and pressure p i f can be interpolated and the updating of the fluid variables can be achieved using the following three steps from the step n to n 1 zienkiewicz et al 1999 step 1 the calculation of intermediate momentum to obtain the modified velocity 47 m i j f v j i f v j i f n δ t c i j f n v j i f n f i i f n δ t 2 k i j f n v j i f n f i i f t n f i i f g n r h s i i f f i i f g n step 2 the calculation of pressure poisson equation 48 h i j f p j f n 1 1 δ t q i j i f v j i f step 3 the calculation of velocity based on momentum correction 49 m i j f v j i f n 1 v j i f n δ t m i j f v j i f v j i f n δ t g i j i f p j f n r h s i i f n 1 where v j i f is the modified velocity δ t is the time step r h s i i f r h s i i f n 1 are the simplified variables respectively and others can be calculated as follows 50 m i j f ω f ρ f φ i f φ j f d ω c i j f n ω f ρ f φ i f v j f n φ j f x j f d ω f i i f n ω f φ i f x j f τ i j f d ω k i j f n ω f v k f n φ i f x k f ρ f v j f n φ j f x j f d ω f i i f t n γ f φ i f τ i j f n n j f d γ f i i f g n ω f φ i f ρ f g i d ω h i i f n ω f φ i f x j f φ j f x i f d ω q i j i f ω f ρ f φ i f φ j f x i f d ω g i j i f ω f φ i f φ j f x i f d ω 5 the solution procedure the solution schemes of dynamic solids and incompressible viscous fluid flow have been illustrated in the above sections and the general procedure also consists of the implement of fsi conditions which is key for the accuracy of fsi system the fsi conditions are composed of velocity condition which is imposed on the fluid domain as well as the forcing condition which is exerted on the solid domain and the achievement of fsi conditions depends on the introduction of fictitious domain initially the variables v f n p f n v s n a s n u s n and f s fsi n at the step n are assumed to be known and the solver for variables at next step n 1 would be given in the following subsections 5 1 the dynamic analysis of solids with fsi force condition in order to carry out the dynamic analysis of solids more effectively the fsi analysis proceeds with the solid solver the total external force for the solid nodes would be obtained with the known fsi force f s fsi n at step n 51 f s ext n 1 f s ext n 1 f s fsi n 1 applying f s ext n 1 on the solid nodes the motion equation can be solved by the central difference algorithm belytschko et al 2000 for the variables u s n 1 v s n 1 and a s n 1 then update the solid domain ω s n with ω s n 1 and the corresponding fictitious field ω fc n is changed to ω f c n 1 ω s n 1 5 2 fsi velocity condition for fluid problem the velocities v s n and v s n 1 have been calculated after the analysis of solids but the fluid nodes x ω fc cannot be directly exerted the fsi velocity condition v f v s because the fluid mesh is not in coincidence with the solid mesh therefore we should confirm the fictitious fluid nodes coved by which solid element firstly and adopt suitable numerical approximation to transform the velocity from solid nodes to fluid nodes the interpolation functions have been investigated and compared wang and zhang 2010 between dirac delta function based on the mesh approximation and fem using linear interpolation scheme and the latter proves to be more simple and effective which is also utilized in the proposed fsi algorithm it is essential to adopt a searching algorithm to accomplish the numerical interpolation as illustrated in fig 3 which shows an immersed solid with the curve boundary moves in the fluid domain with the fixed euler grids assume a fluid node x q is located inside the solid domain and the following criteria is used for finding out whether the node is located inside a particular lagrangian triangular element with nodes x i x j and x k if area δ i j k i 1 3 area δ i j k i where δ i j k i is the triangle constructed by x q and the three vertexes of x i x j and x k then x q is located inside δ i j k if area δ i j k i 0 x q is located on the edge of δ i j k and if area δ i j k i 1 3 area δ i j k i x q is located outside δ i j k after searching the velocity of fluid nodes in the fictitious domain v ˆ fc n 1 can be interpolated as follows 52 v ˆ fc n 1 l i j k φ l s n 1 x i f v l s n 1 x i f ω fc n 1 where φ l s n 1 x i f is the shape function calculated by the area proportion and v l s n 1 is the solid velocity so the fluid nodes x i f ω fc n 1 can be imposed on the fsi velocity condition in the following form 53 g fsi f n 1 v f v i f n 1 v ˆ i f c n 1 0 x i f ω fc n 1 combining g fsi f n 1 v f with the fluid velocity boundary condition g vbc f n 1 v f the total fluid domain can be solved using the following modified fluid velocity boundary condition 54 g vbcufsi f n 1 v f v i f n 1 v i f n 1 x i f γ v f v j f n 1 v ˆ j fc n 1 x j f ω fc n 1 the fluid velocity v f n 1 satisfies the fsi velocity conditions and the fluid velocity boundary condition combining fsi velocity condition velocity boundary condition g vbcufsi f n 1 as well as pressure boundary condition g pbc f p one can update the fluid status using cbs algorithm from step n to n 1 5 3 evaluating fsi force the fictitious fluid can be used to evaluate the fsi force according the coupling condition the fictitious fluid has the same fluid properties with the real fluid and cbs algorithm can be also applicable to the governing equations of fictitious fluid because the fluid and solid mesh are not fitted and the solid mesh can be simply viewed as a lagrangian fictitious fluid mesh the fsi force exerted on solids nodes can be obtained using cbs algorithm based on lagrange mesh the fluid nodes x i fc ω fc n 1 are assumed to move in consistency with solid nodes so the nodal velocities of fictitious fluid are known by 55 v i fc n 1 v i s n 1 v i fc n v i s n x i fc n 1 x i s n 1 and the nodal pressure p i fc n in the euler mesh has to be transformed in the lagrange mesh based on the searching algorithm and the fem interpolation if we use cbs to calculate the fsi force based on fictitious fluid from step n to step n 1 the three steps of equations 47 49 become step 1 the calculation of intermediate momentum with same form as equation 47 56 m i j f v j i fc v j i fc n δ t r h s i i f f i i fc g step 2 obtain the pressure in the lagrangian form according the shape function φ l f n 1 x i fc n 1 57 p i fc n l i j k φ l f n 1 x i fc n 1 p l f n x i fc ω fc n 1 step 3 the momentum increment of fictitious fluid to calculate fsi force 58 m i j f v j i fc n 1 v j i fc n δ t m i j f v j i fc v j i fc n δ t g i j i f p j fc n f i i f fsi n 1 r h s i i fc n 1 f i i f fsi n 1 substituting equations 56 to 58 the fsi force exerted on fluid nodes can be written as following 59 f i f fsi n 1 m i j f v j i f n 1 v j i f n δ t r h s i i f g i j i f p j f n v j i f n 1 v j i s n 1 hence as a reaction force the fsi force f i f fsi n 1 can be written in the lagrangian form using the fictitious fluid grid 60 f i f fsi n 1 f i fc fsi n 1 m i j fc v j i fc n 1 v j i fc n δ t c i j fc n v j i fc n f i i fc n δ t 2 k i j fc n v j i fc n g i j i fc p j fc n n m i j fc v j i fc n 1 v j i fc n δ t ω fc n 1 ρ f φ i fc v j fc n φ j fc x j fc d ω ω fc n 1 φ i fc x j fc τ i j fc d ω δ t 2 k i j f n ω fc n 1 v k fc n φ i fc x k fc ρ f v j fc n φ j fc x j fc d ω ω fc n 1 φ i fc φ j f c x i fc p j fc d ω 5 4 the calculation procedure of nps pim the numerical treatments of the proposed nps pim with immersed method have been elaborated in the above subsections and a brief solver procedure from a to f has been given in the following for a general view a discretize the fluid domain and solid domain using triangular tetrahedral elements b set up the initial fsi force calculate displacement u i s n 1 velocity v i s n 1 and acceleration a i s n 1 of the solid and update the coordinates of solid nodes c calculate fluid velocity v i fc n 1 of fixed mesh included in fictitious fluid domain using interpolation and construct the new fluid velocity boundary conditions d based on the boundary condition of velocity and pressure employ cbs algorithm to obtain v i f n 1 p i f n 1 e update coordinates and velocity of fictitious domain as well as p i i fc n 1 in lagrangian meshes by fem interpolation and calculate fsi force of solid f update the variables v i f n v i f n 1 p i f n p i f n 1 u i s n u i s n 1 v i s n v i s n 1 a i s n a i s n 1 f i s fsi n f i s fsi n 1 x i s n x i s n 1 n n 1 go to step b for recycle in the present work the uniform time step δ t c r is adopted for the fsi system which is determined by δ t c r min δ t c r f δ t c r s δ t c r f and δ t c r f are the time steps for the fluid and solid respectively and calculated as follows 61 δ t c r f min h v f h 2 μ δ t c r s min ℓ e c e where h is minimum of the fluid element size ℓ e is the solid element length and c e is the current wave speed 5 5 incompressible constraints and mesh size dependency the structure is modeled by the isotropic saint venant kirchhoff material which is nearly incompressible previous study has demonstrated that the maximum volume change of the structure in is fem zhang et al 2012a is less than 0 1 when large deformation occurs it means the volume change is nearly negligible and the solid body considered in this research is nearly incompressible continuum or rigid like continuum therefore the fictitious fluid domain always maintains the same volume the inaccuracies of interpolation between fluid and solid domain arise from the implicit fluid structure interface as the ib methods and one can improve the accuracy of information transformation by refining the fluid mesh to make the interface more coincide with fluid element edge zhang et al 2012a wall et al has pointed out that complete kinematic and dynamic continuity at γ would ensure conservation of mass momentum and energy on the interface wall et al 2006 for the present method because the non conforming identity of the fixed euler mesh and lagrange mesh exists on the interface numerical interpolation is necessary for mutual information exchange which will lead to the kinematic and dynamic discontinuity on the interface the interpolation does affect the balance momentum between the two domains the reviews about immersed typed methods mittal and iaccarino 2005 have indicated that most of the ib methods discussed cannot satisfy the underlying conservation laws for the elements in the vicinity of the interface except the cut cell finite volume approach and the effect of interpolation has been investigated in section 6 1 based on the fsi force obtained from fluid and domain for the present method the results have shown that no significant discrepancy arises from the transformation of fsi force between fluid and solid domain also both of fsi force form fluid and solid domain keeps nearly consistent with gravity at the steady state as a consequence although the interpolation affects the balance momentum between the two domains the proposed method still works well for the simulations of fsi problems described here the introduction of fictitious fluid domain will bring about the mesh size dependency between fluid and structure mesh as described in gerstenberger and wall 2008 wall et al 2006 and previous works in boffi et al 2007 lee et al 2008 wang and zhang 2010 have reported that the mesh size ratio h f h s can affect the stability of finite element immersed boundary method the effect of the ratio h f h s has been investigated numerically in is fem zhang et al 2012a b and demonstrates the stability is not affected by a wide range of mesh size ratio which is usually selected to be 0 25 2 0 considering the governing equations established based on the assumption of adiabatic condition there are no heat transfer generation and dissipation in the present fsi system 6 numerical examples 6 1 a disk falls under gravity in a fluid domain in an incompressible viscous fluid domain a falling disk with the gravity acceleration of g 981 cm s 2 is analyzed in this example as shown in fig 4 a the size of fluid field is w 2 0 cm and h 5 0 cm and the radius of the disk is given as r 0 125 cm in the x direction the disk locates in the middle of fluid field and in the y direction the distance between the top and the disk center is set as l 1 0 cm the fluid density is given as ρ f 1 0 g cm 3 the disk is described with saint venant kirchhoff model with ρ s 2 g cm 3 ν s 0 3 and e s 10 4 g cm s 2 all the boundaries are considered as no slip boundary condition which means the normal and tangential components of fluid velocity are zero on the wall irregular triangular elements are utilized to discretize fluid domain using 8125 nodes and the solid domain using 301 nodes fig 4 b the validation can be carried out using the terminal velocity which also can be obtained by the empirical formula with the following form clift 1978 62 u ref ρ s ρ f g r 2 4 μ f ln w 2 r 0 9157 1 7244 2 r w 4 we have calculated different terminal velocity u t by immersed method with fem when different viscosity μ were taken into consideration table 1 shows the calculated results by comparing with the experimental ones where it can be found that the present results are in good agreement with the reference solution u ref when the soft disk is immersed in the fluid channel it encounters with the gravity force and buoyancy and the difference between them impels the disk to fall downwards the drag force increases gradually and would balance the difference as a consequence the disk falls with a stable velocity fig 5 gives the vertical velocity contour of the fluid domain at different time when μ f 0 75 g cm s the vertical velocity contour keeps stable and symmetrical before the disk approaches the wall see fig 5 a and the unsteady status arises due to the bottom interference in fig 5 b when the disk at the bottom moves towards the right wall the velocity presents opposite distribution around the disk top fig 5 c and the flow distribution has been affected at the time 1 07 s fig 5 d resulting from the blocking effect of the right wall the time history of vertical velocity v y and displacement u y are shown in fig 6 it has been shown in fig 6 a that the velocity increases rapidly at the initial stage as a result of driving force as the increscent drag force balances the difference between gravity and buoyancy the velocity keeps almost unchanged after t 0 2 s however it decreases sharply from t 0 7 s and is close to zero at t 0 9 s because of the wall effect the disk still suffers from a fluctuation of velocity along the wall surface which may be brought about by the deformation of the body it means the proposed method can handle the contact phenomenon effectively and the slight fluctuation shows no significant effect on the displacement curve see fig 6 b which presents a continuous growth before t 0 8 s and remains unchanged afterwards the fsi force obtained from the fluid and solid domain has been computed and fig 7 has shown the calculation results accounting for different viscosity settings in the figure fsi force fluid and fsi force solid denote the fsi force calculated from fluid domain and solid domain respectively and gravity denotes gravity of the disk from the figures it can be found that with the decrease of fluid viscosity the falling velocity of disk grows and the fluctuation of fsi force becomes significant however good agreements can be achieved for the fsi forces calculated from fluid and solid domain and the forces can always balance the gravity in spite of different viscosity conditions in the following five groups of meshes are utilized to investigate the effect of mesh size ratio on the transformation of fsi force with μ 1 5 g cm s fig 8 shows the mesh settings with mesh size ratio h f h s from 4 to 0 25 regular and irregular triangular meshes are used for fluid and solid domain respectively and the computed fsi forces have been given in fig 9 fig 9 a shows that the fsi forces calculated from solid domain present no obvious distinction in the given mesh size ratios fig 9 b f compare the fsi forces from fluid and solid domain in different mesh size ratios where the consistent results have proven that the present method is efficient to transform fsi force between fluid and solid domain for reasonable mesh size ratio five groups of meshes are utilized to investigate the convergence of forces towards the gravity with respect to different mesh sizes with h f h s 2 fig 10 shows the mesh settings with different mesh sizes regular and irregular triangular meshes are used for fluid and solid domain respectively and the computed fsi forces have been given in fig 11 it has been found from fig 11 a that the fsi force can generally balance the gravity by using the given mesh sizes fig 11 b f compare the fsi forces from fluid and solid domain with different mesh sizes and the forces have shown good achievements towards the gravity as the mesh is refined also the more refined mesh can bring more stable results while keeping the same mesh size ratio the error evolution of fsi force from the solid domain has been extracted as a function of the mesh size to deduce the order of convergence with h f h s 2 the l 2 error norm e f s has been defined as follows 63 e f s f i s num f i s ref l 2 f i s ref l 2 where f i s n u m are the numerical solutions of fsi force and f i s ref are the reference solutions which is the theoretical value of gravity exerted on the solid domain as a body force considering the constantly slight fluctuation of fsi force see fig 11 the average value of e f s is calculated using e f s 1 n t 0 t 1 e f s t 0 is the initial time when the disk begins to fall with terminal velocity t 1 is set 0 4 s for the present solution and n is the selected number from the time t 0 to t 1 the result can be seen in fig 12 which shows the solution of fsi force from solid domain with the convergence rate of 1 48 6 2 beam in a fluid channel a steady problem is considered about a flexible beam fixed in the fluid tunnel which was simulated previously using is fem zhang et al 2012a the viscous fluid flows across the beam and leads to a large deformation because of the fluid force the beam will come to a stead status after some time when the elastic force balances with the fsi force as illustrated in fig 13 the length and height of the fluid field is l 4 cm and h 1 cm the distance between the fixed beam and the left edge of the fluid tunnel is l 4 the thickness of the beam is a 0 04 cm and the height is b 0 8 cm gravity is neglected for this problem the bottom of the fluid domain satisfies the no slip boundary condition and the top satisfies a symmetric condition using v 2 f 0 the inlet velocity is given at the left edge as follows 64 v 1 f t 1 5 y 2 2 y cm s v 2 f t 0 the outlet pressure p f at the right edge is defined to be zero the solid materials are modeled with ρ s 7 8 g cm 3 ν s 0 3 and e s 10 5 g cm s 2 and the fluid properties are given as ρ f 1 0 g cm 3 and μ f 0 1 g cm s we discretize the fluid domain using 100538 triangular elements with 50670 nodes and the solid domain using 648 elements with 409 nodes the top point a of beam is set as a reference point and the cures of velocity v 1 s and displacement u 1 s in horizon direction are shown in fig 14 the velocity fluctuates constantly and the displacement amplitude keeps growing during the initial period as the increased internal force gradually balances the external force the velocity decreases to zero and the displacement comes to a maximum of 0 422 cm fig 15 illustrates the velocity v 1 f contour and pressure p f contour after the fsi system comes to a steady state it is quite clear that in fig 15 a a high velocity distribution forms in the vicinity of beam end because the existence of beam decreases the height of fluid channel the velocity increases rapidly when fluid flows over the free end of beam a bubble flow arises behind the beam due to the barrier effect in fig 15 b a high pressure distribution can be observed on the left side of the beam and decreases gradually on the right side the accuracy and convergence properties of the fsi models using nps pim with α 2 1 fem 0 8 0 6 0 5 0 4 0 2 and 0 ns pim are compared with regard to the solution of solid displacement three groups of the uniform triangular meshes are used for solid domain and the mesh sizes are set as h s 1 50 1 75 and 1 100 the fluid domain is discretized with two groups of triangular meshes with mesh sizes h f 1 40 and 1 50 in this test the uniform solid mesh with h s 1 300 is provided as a reference solution the analysis of displacement error e u s can be calculated by the following formula 65 e u s u i s num u i s ref l 2 u i s ref l 2 where u i s n u m are the numerical solutions and u i s ref are the reference solutions fig 16 a and b shows the result for this test it is found that as the value of α 2 varies from 1 to 0 4 the displacement error gradually decreases because the overly stiff characteristic of model has been mitigated and the error increases when the value of α 2 changes from 0 4 to 0 which means the stiffness inclines to the soft side the trends are almost consistent for all the combinations of meshes and under the same constraints of fluid mesh better results can be obtained as solid mesh is refined generally α 2 0 4 leads to the highest accuracy compared with the other values due to a most suitable stiffness behavior for solid analysis a comparative study has been also conducted in terms of computational cost and all simulations are running by the computer of intel r core tm i5 2400 cpu 3 10 ghz and ram 4 0 g the solid domain is divided by the mesh sizes of h s 1 50 123 nodes 1 75 244 nodes and 1 100 405 nodes and a unified fluid mesh of h f 1 40 6601 nodes is used the cpu time for the fsi models using different solid solvers have been presented in table 2 which has been also drawn with bar charts for a good view in fig 17 the computational cost is counted by cpu time when it comes to a steady state t 3 s in the table fem and ns pim denote the fsi models using fem and ns pim as solid solver respectively and α 2 0 2 α 2 0 4 α 2 0 5 α 2 0 6 α 2 0 8 denote the fsi models using nps pim with the corresponding value of α 2 as solid solver respectively it is found that the cpu time of nps pim is in the same level as that of respective fem and ns pim so a very good balance can be achieved by the nps pim between results accuracy and computational cost the convergence of nps pim with α 2 0 4 has been analyzed in fig 18 which shows solid displacement solutions is close to the convergence rates of 1 79 and 1 76 when the fluid mesh sizes are set as h f 1 50 and 1 200 respectively the integral of the velocity divergence in the fictitious domain has been investigated and nps pim with α 2 0 4 is employed for solid analysis three groups of the uniform triangular meshes are used for solid domain and the mesh sizes are set as h s 1 50 1 75 and 1 100 the fluid domain is discretized with two groups of triangular meshes with mesh sizes h f 1 40 and 1 50 figs 19 and 20 have shown the results of the integral of velocity divergence div v d ω and horizontal displacement at tip point with h f 1 40 and 1 50 respectively it has been found that the integral of the velocity divergence is not strictly equal to zero on the discrete form however the maximum of div v d ω is no more than 0 4 10 3 see figs 19 a and 20 a and there are no numerical problems that have been observed from the solutions of horizontal displacement see figs 19 b and 20 b the result has demonstrated that the proposed method is capable of solving such kind of beam bending problem although the integral of the velocity divergence is not strictly equal to zero 6 3 leaflet driven by a sinusoidal fluid flow a transient problem is analyzed in this example which is the same as reference zhang and gay 2007 fig 21 has shown the geometry model for this problem and the size of rectangular fluid domain is l 4 cm and h 1 cm the length and width of the leaflet are set as λ 0 8 cm and t 0 0212 cm the material properties of solid are defined with density ρ s 6 0 g cm 3 poisson s ratio ν s 0 5 and young s modulus e s 10 7 g cm s 2 the incompressible viscous fluid is assumed with density ρ f 1 0 g cm 3 and viscosity μ f 0 1 g cm s the leaflet locates in the mid length of the fluid domain with a fixed bottom end at the start the leaflet keeps still and a sinusoidal input velocity v 1 f sin 2 π t π 2 with period t 1s is applied at y 0 and y l the no slip boundary condition is assumed at the bottom edge of the fluid domain and the velocity component v 2 f is set to be zero at the top edge we discretize the fluid domain using 5608 triangular elements with 2930 nodes and the solid domain using 216 elements with 165 nodes fig 22 illustrates the pattern of the motion and velocity in a period for the time t t 0 0 3 the flexible body is driven to the right fig 22 a b and c as the flow pushes it forward for the time t t 0 3 0 5 as the flow decays the leaflet inclines to bounce back fig 22 d and e once the input velocity is given in opposite direction the leaflet accelerates to the left during the time t t 0 5 0 7 fig 22 f and g subsequently the leaflet returns to the balance position due to its elasticity property fig 22 h and i the leaflet repeats this circle in every period and the result presents the same performance as those obtained by tbaaijens 2001 yu 2005 and zhang and gay 2007 in order to investigate the time history of horizontal displacement of the leaflet tip three sets of solid meshes with 165 nodes h s 1 80 324 nodes h s 1 100 and 679 nodes h s 1 165 are used with one set of fluid mesh of 2930 nodes the result has been shown in fig 23 and it is found that the curve becomes unchanged as solid mesh is refined the maximum of displacement is in good agreement with the literature zhang and gay 2007 then we change the period of input velocity to be t 2s t 4s and decrease the elasticity modulus to be e s 10 5 g cm s 2 and e s 10 4 g cm s 2 accordingly so the result can be compared considering larger deformation with different parameter values the fluid and solid domain are using 2930 and 165 nodes respectively the reference solution is calculated by refined solid mesh with 1080 triangular elements and 679 nodes it can be seen from fig 24 a and b that the configuration of the leaflet varies from left side to right side sequentially from α 2 1 to α 2 0 at the same time which corresponds to the continuous change of stiffness model and it seems both α 2 0 4 and α 2 0 2 lead to better results by comparing with the reference solution in fig 25 the configurations become chaotic accounting for larger deformation and α 2 0 4 has been found to have the best performance in consideration of good agreement with the reference the above results have illustrated significance differences associated with large deformation using the fsi models with fem ns pim and nps pim as solid solvers and two finer meshes have been added for further validation for the good performance of nps pim with α 2 0 4 the input velocity period is set as t 2s with e s 105 g cm s2 the fluid domain is discretized with 6601 nodes h f 1 40 and 40501 nodes h f 1 100 and the solid domain is discretized with 123 nodes h s 3 200 324 nodes h s 1 100 and 966 nodes h s 1 200 for the reference configuration the regular triangular elements are used for both fluid and solid domain fig 26 shows the time history of horizontal displacement at the leaflet tip it can be found that all the computed results are in good agreement with the reference one and the solution of the refined mesh h s 1 100 is of a little better performance than that of the coarse mesh h s 3 200 the configurations of the leaflet have also been drawn in figs 27 and 28 considering different fluid domain mesh sizes and time the configurations h s 3 200 and h s 1 200 keep basically in consistent with the reference configuration it can be found that some discrepancies exist in the tip region for h s 3 200 due to the inherent poor performance for very coarse mesh generally nps pim with α 2 0 4 performs well for this fsi problem with large displacement 6 4 elastic plate behind a fixed cylinder furthermore a classical case of the vortex excited elastic plate configuration described in turek and hron 2006 has been used to validate the present method and nps pim with α 2 0 4 is employed for analyzing the elastic plate as can be seen in fig 29 the fluid domain is given as l 2 5 m and h 0 41 m with a fixed cylinder of diameter d 0 1 m centered at c 0 2 0 2 m the elastic plate is attached at the right edge of the cylinder with the length l 0 35 m and the height h 0 02 m the top and bottom of fluid domain as well as the surface of the solid satisfy no slip boundary condition at the outlet the pressure is set to be zero and the input velocity v x t has the following distribution as time varies 66 v x t v 1 cos π t 2 2 t 2 0 v t 2 0 where v 1 5 u y h y h 2 2 two non steady situations with re 100 case 1 and re 200 case 2 are taken into account and the parameter setting has been illustrated in table 3 the fluid domain and solid domain are discretized using irregular triangular meshes with 18452 nodes and 763 nodes respectively and the average mesh size ratio of fluid and solid is 2 in the interaction region the vertical displacement of tip point a has been investigated and fig 30 depicts the curve of time history it is clear that both fig 30 a and b produce a periodic oscillation after some time due to the continuous vortex excited force the present result has been compared with reported solution in the literature in table 4 where good agreement with previous studies can validate the efficiency of proposed method in addition the levels of drag and lift as well as the frequency have been compared with the literature tables 5 and 6 have shown the results of case 1 and case 2 respectively for the drag force the average value basically keeps consistent with the reported solutions in turek and hron 2006 turek et al 2011a and some discrepancy has been observed for the oscillation amplitude the lift has presented opposite tendency good agreements have been achieved for both case 1 and case 2 in terms of the frequency figs 31 and 32 show the velocity and pressure contours of case 1 and case 2 at different time compared to case 2 case 1 exhibits a larger deformation of elastic plate owing to its high flexibility the vortex excited force compels the plate to swing periodically which brings about the advection of vortex along the channel for both velocity see figs 31 a and 32 a and pressure see figs 31 b and 32 b 7 conclusion in this article we combined the nps pim with immersed method to solve fsi problems with largely deformable solids structures following conclusions can be obtained 1 the proposed method is based on the framework of immersed method and uses the simplest triangular mesh which makes the method possess the advantages of both avoiding mesh regeneration operation and simplifying preprocessing for large deformation associated fsi problems 2 from the numerical test results it has been found that the proposed model with nps pim as solid solver can achieve better accuracy than the models with either fem or original ns pim and the computational costs of these models are in the same level the value of α 2 0 4 is recommended for the nps pim used in the proposed model based on the present study 3 the efficiency of momentum transformation between fluid and solid domains has been verified in a straightforward way and good agreements between gravity and the fsi forces calculated from fluid and solid domains have been achieved in a suitable mesh size ratio for the proposed method 4 numerical examples have verified the accuracy stability and convergence properties of the present method nps pim with α 2 0 4 provides the convergence rate of around 1 8 for solid displacement in space and the accuracy and validity has been further verified by the case of the vortex excited elastic plate configuration compared with the reported solutions acknowledgements the authors wish to thank the support of the national natural science foundation of china no 51579042 the key program of national natural science foundation of china no 51639003 the recruitment program of global young experts no d1007001 and the fundamental research funds for the central universities dut16zd218 dut2017tb05 
23424,the newly developed node based partly smoothed point interpolation method nps pim and immersed technique are coupled to simulate fluid structure interaction fsi problems associated with largely deformable solid structure under the framework of immersed method the governing equations can be decomposed into three components based on fictitious fluid assumption i e equations for incompressible viscous fluid fsi conditions and nonlinear solid the semi implicit characteristic based split algorithm is used to solve the navier stokes equation of incompressible viscous fluid and the fictitious fluid domain can be used to calculate the fsi force owing to the properly softened stiffness by the node based partly strain smoothing operation nps pim can effectively solve the large deformation problem of solids discretized with the simplest linear triangular mesh the immersed framework makes the present method avoid the troublesome re meshing process and the triangular mesh further simplifies the preprocessing operation in comparison with the models using fem and node based smoothed point interpolation method ns pim as solid solver numerical results have shown that the present method using nps pim can provide more accurate solutions for both steady and transient problems with regard to large displacement fsi problems keywords immersed methods smoothed point interpolation method fluid structure interaction large deformation 1 introduction to simulate the fluid structure interaction fsi phenomenon involving large deformable solids structures numerically is considered to be an extremely challenging work numerical methods have been viewed as a powerful tool in light of continual improvements of both the methods themselves and computer hardware the grid based numerical methods have been widely used for the majority of these fsi problems and the meshfree and particle methods generally work well for the extreme distortion problems hu et al 2014 liu and li 2016 liu and liu 2015 liu et al 2014 long et al 2016 tang et al 2016 zhang et al 2016 2017 for those grid based numerical methods the treats for fluid structure interfaces bring about constantly improvement and development for numerical techniques the moving mesh techniques were successfully used to impose the coupling condition for fsi simulation when coping with the varying interfaces such as arbitrary lagrangian eulerian ale hu et al 2001 liu et al 1988 liu and ma 1982 nordanger et al 2016 and space time st methods bazilevs et al 2008 takizawa and tezduyar 2011 tezduyar et al 1994 2008 for ale based on body fitted mesh methods the fluid mesh conforms to the solid boundary and deforms with moving boundary which makes the methods to provide accurate solution for high reynolds number configuration where the capture of the turbulent boundary layer is crucial however the feature of body fitted mesh may make the method encounter challenges when simulating problems with large deformation and body contact configuration and generally for this case mesh regeneration is needed during the process then a series of immersed typed methods using non conforming mesh have been developed which can avoid the troublesome mesh regeneration initially the immersed boundary ib methods were proposed by peskin peskin 1977 2002 and have been successfully applied to analyze the blood flow problem in the scheme of ib methods the solid boundary is considered to cover the fluid with the same properties as the real fluid and the values of velocity and force for the interface can be numerically obtained through an interpolation operation eulerian grids are used to distribute the fluid and the solid placed in the fluid domain is described in lagrangian form generally the immersed boundary methods are categorized as two groups i e continuous forcing approach and discrete forcing approach mittal and iaccarino 2005 toja silva et al 2014 for the continuous forcing approach a forcing term is added into the governing equations before discretization which accounts for the effect of immersed boundary and numerous simulations have been achieved associated with rigid or elastic boundaries by this kind of methods beyer and leveque 1992 goldstein et al 1993 lai and peskin 2000a peskin 1977 on the other hand if the equations are discretized firstly and a body force is introduced to enforce the desired velocity on the boundary it is the framework of discrete forcing approach or direct forcing approach liao et al 2010a there are also two categories on the basis of the imposition for boundary condition indirectly fadlun et al 2000 gilmanov and sotiropoulos 2005 uhlmann 2005 or directly clarke et al 1986 ye et al 1999 the present method can be considered as a discrete forcing approach with indirect boundary condition imposition in most of ib methods the solid is assumed as fiber like immersed elastic structure which restrains realistic modeling of structures with nonlinear constitutive laws and the structure only carries mass but does not occupy volume then the immersed finite element methods ifem lee et al 2007 zhang and gay 2007 zhang et al 2004 were successfully proposed which can establish realistic material model by introducing the fictitious fluid to cover the whole solid domain by introducing the newly smoothed finite element method s fem into the scheme of ifem the immersed smoothed finite element methods is fem zhang and liu 2011 zhang et al 2012a b were proposed which can further improve the solid solver performance for largely deformable problems in many fsi analysis we are primarily interested in the structural response especially for large displacement or deformable nonlinear solids structures conventionally the dynamic analysis of solids is conducted by the fem procedure it is well known that a standard galerkin fem model is fully compatible behaves overly stiff and provides a lower bound in energy norm of numerical results to soften stiffness by introducing the generalized gradient smoothing operation smoothed finite element methods s fem liu and nguyen thoi 2010 liu et al 2009a and smoothed point interpolation methods s pim liu et al 2009b 2009c liu and zhang 2013 have been proposed in the schemes of fem and meshfree methods respectively as one important member of s pim modes the node based smoothed point interpolation method ns pim has been found behave overly soft and proved to be able of provide upper bound solutions in energy norm for elasticity problems liu and zhang 2008 liu et al 2011 wu et al 2009 so consider the overly stiff fem and the overly soft ns pim a combination of these two method called node based partly smoothed interpolation method nps pim has been proposed lu et al 2017 which possesses properly softened model stiffness and provides nearly exact solutions for solid problems for the proposed method the immersed type framework in ifem is adopted in which the nps pim is used for solving solid problems the incompressible navier stokes fluid flow is solved by the semi implicit characteristic based split cbs algorithm which allows same interpolation shape functions for fluid velocity and pressure therefore linear triangular background elements can be used for efficient preprocessing in both fluid and solid domains 2 the decomposition of governing equations in fsi systems the governing equations for fsi system and boundary conditions can be expressed as follows 1 ρ f d v f d t div σ f ρ f g x ω f ρ s d v s d t div σ s ρ s g x ω s v f v s on γ fs f s fsi f f fsi on γ fs where ρ f and ρ s are the densities of fluid and solid v f and v s are the velocities of fluid and solid g denotes gravity acceleration σ f and σ s are the cauchy stresses ω f and ω s are the fluid and solid domain respectively γ fs denotes fsi interface and f f fsi and f s fsi are the fsi force on the interface the fictitious fluid is introduced which overlaps with the solid domain and is viewed as the homogeneous material with the real fluid besides nodes in the fictitious fluid are supposed to be in consistency with the solid nodes as illustrated in fig 1 the solid domain ω s which is substituted by fictitious fluid domain ω fc can be separated from the fluid domain based on the fictitious fluid assumptions and we can obtain ω s ω fc and γ fc γ s the whole fluid domain ω f ω f ω fc can be described as eulerian mesh and the solid domain can adopt lagrangian mesh the motion equation for fictitious fluid is similar as equation 1 2 ρ fc d v fc d t div σ fc ρ fc g f fc x fc ω fc where an additional body force f fc is used to compel the fictitious fluid nodes to be consistent with solid nodes therefore a pair of action and reaction force f f fsi and f s fsi arise and denote fsi force exerted on the fictitious fluid and solid on the volume respectively f f fsi functions as a body force replacing f fc and satisfies the momentum balance 3 f f fsi ρ fc d v fc d t div σ fc ρ fc g with v fc v s in ω fc the integral form of equation 3 leads to 4 ω fc ρ f d v fc d t d ω ω fc div σ fc d ω ω fc ρ f g d ω f f fsi v fc v s in ω fc where 5 f f fsi ω fc f f fsi d ω and the fsi force exerted on the solid as reaction force can be expressed as follows 6 f s fsi f f fsi ω f c f f fsi d ω the global form f s fsi applied on the solid defines the drag and lift forces which are often used in computational fluid dynamics fields see details in equation 16 it reveals that the proposed fsi force on the solid is equivalent to the real fsi force only exerted on the fluid structure interface this demonstrates that the physical fsi force is applied on the solid it can be explained that the boundary integral is converted into field integral with regard to the solution of coupling force in a conservative field combined equation 4 with the integral form of motion equation for real fluid in equation 1 we can obtain 7 ω f ρ f d v f d t d ω ω fc ρ f d v fc d t d ω ω f div σ f d ω ω fc div σ fc d ω ω f ρ f g d ω ω fc ρ f g d ω f f fsi because the whole fluid domain ω f is filled with homogeneous fluid in the fixed euler grid the integral form equation 7 can be written as follows 8 ω f ρ f d v f d t d ω ω f div σ f d ω ω f ρ f g d ω f f fsi v f v s in ω fc using the fictitious fluid the fsi force can be obtained 9 f f fsi ρ f d v f d t div σ f ρ f g i with v f v s in ω f c eventually the governing equations can be decomposed into three components 1 nonlinear solid equations 2 incompressible viscous fluid equations 3 equations for fsi conditions and we can simplify the superscript f with f in the following text 1 solid 10 ρ s u s p s x s ρ s g boundary conditions n s σ s t s on γ t s v s v s on γ v s initial conditions p s p s 0 v s v s 0 t 0 where u s is the displacement of solid p s denotes the first piola kirchhoff stress n s denotes outward surface normal t s and v s are the solid force and velocity of boundary and p s 0 and v s 0 are the initial piola kirchhoff stress and velocity respectively 2 incompressible viscous fluid 11 ρ f v f t ρ f v f v f p f μ 2 v f ρ f g v f 0 boundary conditions g vbc f v v f v f 0 on γ v f g pbc f p p f p f 0 on γ p f initial conditions v f v f 0 p f p f 0 t 0 where p f is the pressure of fluid v f denotes the boundary velocity p f denotes the boundary pressure g vbc f v and g pbc f p denote boundary conditions of fluid velocity and pressure γ v f and γ p f denote the boundary of calculation domain and v f 0 and p f 0 are the initial velocity and pressure 3 fsi conditions 12 fsi velocity condition v f v s in ω fc 13 fsi forcing condition f s fsi f f fsi in ω s 14 f f fsi ρ f v f t ρ f v f v f p f μ 2 v f ρ f g in ω fc where ω fc denotes the fictitious domain and μ denotes dynamic viscosity the fsi force in equation 14 can be also expressed in its component form as follows 15 f i f fsi ρ f v i f t ρ f x j f v i f v j f p f x i f τ i j f x j f ρ f g i in ω fc where τ i j denotes deviatoric stress the fsi force exerted on the solid in integral form can be converted with regard to the divergence theorem if the gravity is neglected or included in the pressure term since the fluid density ρ f is constant 16 f i s fsi ω fc ρ f v i f t d ω ω fc ρ f v j f v i f x j f d ω ω fc τ i j f x j f d ω ω fc p f x j f d ω ω fc ρ f v i f t d ω γ fc ρ f v i f v j f n j fc d γ γ fc τ i j f n j f c d γ γ fc p f n j fc d γ where n j fc is the normal of outward surface γ fc the component forms f i s fsi of the fsi force in cartesian coordinates are the same as the drag and lift force defined in computational fluid dynamics fields lai and peskin 2000b liao et al 2010b 3 nps pim for dynamics analysis of solids 3 1 brief introduction on fem procedure if a group of n n s nodes and n e l e s triangular background cells are used to discretize the solid domain ω s 0 the displacement u s velocity v s and acceleration a s can be interpolated by the proper shape function φ i s 0 17 u s i φ i s 0 u i s v s i φ i s 0 v i s a s i φ i s 0 a i s the motion equation of solids can be written as following by substituting equation 17 into equation 10 and implementing the galerkin procedure 18 m i j s a j s f i ext f i int where m i j s is the lumped mass matrix a j s denotes acceleration vector f i int is the internal force vector and f i ext is the external force vector including gravity and fsi force the second piola kirchhoff pk2 stress s can be used to calculate the internal force 19 f i int ω s 0 b i t 0 s d ω where b i 0 is the strain displacement matrix which can be written as 20 b i 0 b i 0 0 b i 1 0 we can see that b i 0 includes two parts b i 0 0 denotes the initial state and b i 1 0 denotes the increment during deformation both of them are block matrices with the following 21 b i 0 0 b i 0 j 1 0 b i 0 j n s 0 b i 1 0 b i 1 j 1 0 b i 1 j n s 0 where j i denotes the ith supporting node of the domain and ns is the number of supporting nodes for 2d case the ith block can expressed as follows 22 b i 0 j i 0 φ j i s x s 0 0 φ j i s y s φ j i s y s φ j i s x s 23 b i 1 j i 0 φ i s 0 x s x j i s x s φ i s 0 x s y j i s x s φ i s 0 y s x j i s y s φ i s 0 y s y j i s y s φ i s 0 x s x j i s y s φ i s 0 y s x j i s x s φ i s 0 x s y j i s y s φ i s 0 y s y j i s x s where x j i s and y j i s denote the displacement of supporting node j i in x and y direction respectively in order to calculate the pk2 stress the deformation gradient f should be introduced which acts as an important measure parameter for the nonlinear analysis 24 f u i j s i where i is unit matrix and u i j s is the displacement gradient then the green strain vector e can be easily obtained 25 e 1 2 f t f i the deformable structures are modeled by the nearly incompressible saint venant kirchhoff material and the components s i j of the pk2 stress can be written by the derivation 26 s i j w e λ e k k δ i j 2 μ e i j where λ and μ are the lamé constants and the relationship with poisson s ratio ν and the young s modulus e can be expressed as follows 27 λ ν e 1 ν 1 2 ν μ e 2 1 ν the pk2 stress tensor s can be also expressed by the following form 28 s de where d is material constants matrix for a plane strain problem d can be written as 29 d e 1 ν 1 2 ν 1 ν ν 0 ν 1 ν 0 0 0 1 2 ν 2 for a plane stress problem d can be replaced by the following form 30 d e 1 ν 1 ν 1 ν 0 ν 1 0 0 0 1 ν 2 as for the present simulations section 6 3 is a plane stress problem and the others are plane strain problems 3 2 the gradient strain smoothing technique in s pim in the scheme of s pim the gradient strain smoothing operation is conducted on smoothing domains to soften the model stiffness which is the main difference between the s pim and the traditional fem suppose the domain ω 0 s is divided into n s d s smoothing domain ω i s d sd 0 with boundaries γ i s d sd 0 isd 1 2 n s d s the smoothing domains ω i s d sd 0 are non overlapped and covers the problem domain together the smoothed displacement gradient in ω i s d sd 0 can be achieved using the displacement gradient u i j s in the following form zhang et al 2012a 31 u i j s x l ω i s d sd 0 u i j s ξ w x l ξ d ω where u i j s x l is the smoothed displacement gradient w x l ξ is smoothed function and satisfies the unity property 32 ω i s d sd 0 w x l ξ d ω 1 the simple heaviside constant smoothed function is adopted with the following form when the area of the smoothing domain a i s d sd is known 33 w x l ξ 1 a i s d sd ξ ω i s d sd 0 0 ξ ω i s d sd 0 utilizing the divergence theorem for equation 31 and replacing the smoothed function with the above form the smoothed displacement gradient can be evolved in the boundary integration as follows 34 u i j s x l i 1 a i s d sd γ i s d sd 0 ω i s 0 x l n sd d γ u i s where n sd is the outward normal of the boundary γ i s d sd 0 i is the number of nodes in smoothing domain and the integration for the smoothed displacement gradient u i j s x l uses only the shape functions instead of their derivative used in fem therefore the derivative of the shape function can be avoided by the gradient strain smoothing technique and one can construct the smoothed strain displacement matrix b i 0 the smoothed deformation gradient f s can be yielded using the smoothed displacement gradient in place of displacement gradient 35 f s x l u i j s x l i then other smoothed variables can be obtained such as the smoothed green strain and the smoothed pk2 stress s using the smoothed deformation gradient in equations 25 and 26 3 3 node based partly smoothed point interpolation method nps pim it has been found fem presents overly stiff behavior in the analysis of solid mechanics and on the other hand the ns pim has overly soft property by conducting node based strain smoothing operation the nps pim is proposed by combining the features of both fem and ns pim to improve the solution for solid structures for the fem the problem domain is discretized by linear triangular elements as shown in fig 2 a for the ns pim as indicated in fig 2 b node based smoothing domains are further formed based on the triangular background cells and within them the strain smoothing operation is conducted then by combining the ideas of fem and ns pim and conducting the node based strain smoothing operation partly the nps pim model can be constructed as illustrated in fig 2 c for example suppose the edge length of one triangular element is 2b and the length of the central line is 3c 2 as shown in fig 2 a and for the ns pim this edge will be equally divided into two parts with length of b for each other and the length between the centroid point and the vertex is c then for the nps pim with a length ratio α the node based partly smoothing domain is of the edge length 1 α b and the central line length 1 α c respectively in which the strain smoothing operation will be conducted for the other part of the edge length α b which belongs to the node based smoothing domain originally in the scheme of ns pim the traditional fem operation will apply in the scheme of the present nps pim the above node based partly smoothing domain division applies to all the field nodes then the area of one background triangular cell can be divided into four parts i e three node based partly smoothing domains for the three vertexes and one central part for fem and the area for fem is as follows 36 a l i e α 2 a l i s where a l i s is the total triangular element area and a l i e is the area of calculation domain for fem the other three parts belong to different smoothing domains have equal area of 1 α 2 a l i s 3 and from fig 2 c the following relationship can be established between the node based partly smoothing domain ω l α and the node based smoothing domain ω i s d sd 0 37 a l α ω l α d ω i 1 n e l e k 1 α 2 a l i s 3 1 α 2 a i s d s d where a l α is the area of the node based partly smoothing domain and n e l e k denotes the number of cells connected with the reference node l then the solver procedure is carried out based on respective calculation domain and the total internal force f i t int are the sum of two parts 38 f i t int f i e int f i s int where f i e int is calculated by fem and f i s int is calculated by ns pim they can be expressed in discrete forms 39 f i e int i 1 n e l e s α 2 b i t 0 s a l i s 40 f i s int i 1 n n s 1 α 2 b i t 0 s a i s d sd where α 2 1 denotes fem solver and α 2 0 denotes ns pim solver 3 4 further discussion of parameter α 2 on the basis of virtual work principle the virtual energies δ w for the elastic body can be written as follows belytschko et al 2000 41 δ w δ u u δ w int δ w ext δ w inext 0 where 42 δ w int δ u t f i int δ w ext δ u t f i ext δ w inext δ u t m i j and considering the energy generated by internal force with two parts in nps pim the virtual strain energy δ w int can be deduced as 43 δ w i n t δ u t f i int δ u t f i e int f i s int δ u t ω e 0 b i t 0 d b i 0 d ω ω s 0 b i t 0 d b i 0 d ω u δ u t b i t d b i 0 α 2 a l i s b i t 0 d b i 0 1 α 2 a l i s u here d is material matrix and the total stiffness matrix k t is given by 44 k t b i t d b i 0 α 2 a l s b i t 0 d b i 0 1 α 2 a l s and we define the stiffness matrix of fem and ns pim as k e and k s in the solid domain respectively 45 k e b i t d b i 0 a l s k s b i t 0 d b i 0 a l s therefore the total virtual energies can also be described as the following 46 δ w δ u u δ u t α 2 k e 1 α 2 k s u δ u t f i ext δ u t m i j remarks 1 if α 2 1 the stain energy δ w int is underestimated due to the overly stiff behavior of fem and it can provide the lower bound energy solution 2 if α 2 0 the stain energy δ w int is overestimated due to the overly soft behavior of ns pim and it can give the upper bound energy solution 3 if α 2 0 0 1 0 the energy solution varies continuously from the solution of ns pim to that of fem with regard to the change of the model stiffness k t 4 from the property of fem and ns pim it is supposed that a proper value of α 2 will lead to a nps pim model with nearly exact stiffness by comparing with the exact solution however we cannot derive the value of α 2 in a theoretical way currently so in the following study different values of α 2 was selected to study the effect for the solid solver in the fsi system 4 characteristic based split for incompressible viscous fluid solver the semi implicit characteristic based split algorithm cbs is employed to solve the navier stokes equations of incompressible viscous flows where generally the fixed euler grid is used to discretize the fluid domain suppose the whole fluid domain ω f is divided into n e l e f t3 elements with n n f nodes by using the shape function φ i f the fluid velocity v i f and pressure p i f can be interpolated and the updating of the fluid variables can be achieved using the following three steps from the step n to n 1 zienkiewicz et al 1999 step 1 the calculation of intermediate momentum to obtain the modified velocity 47 m i j f v j i f v j i f n δ t c i j f n v j i f n f i i f n δ t 2 k i j f n v j i f n f i i f t n f i i f g n r h s i i f f i i f g n step 2 the calculation of pressure poisson equation 48 h i j f p j f n 1 1 δ t q i j i f v j i f step 3 the calculation of velocity based on momentum correction 49 m i j f v j i f n 1 v j i f n δ t m i j f v j i f v j i f n δ t g i j i f p j f n r h s i i f n 1 where v j i f is the modified velocity δ t is the time step r h s i i f r h s i i f n 1 are the simplified variables respectively and others can be calculated as follows 50 m i j f ω f ρ f φ i f φ j f d ω c i j f n ω f ρ f φ i f v j f n φ j f x j f d ω f i i f n ω f φ i f x j f τ i j f d ω k i j f n ω f v k f n φ i f x k f ρ f v j f n φ j f x j f d ω f i i f t n γ f φ i f τ i j f n n j f d γ f i i f g n ω f φ i f ρ f g i d ω h i i f n ω f φ i f x j f φ j f x i f d ω q i j i f ω f ρ f φ i f φ j f x i f d ω g i j i f ω f φ i f φ j f x i f d ω 5 the solution procedure the solution schemes of dynamic solids and incompressible viscous fluid flow have been illustrated in the above sections and the general procedure also consists of the implement of fsi conditions which is key for the accuracy of fsi system the fsi conditions are composed of velocity condition which is imposed on the fluid domain as well as the forcing condition which is exerted on the solid domain and the achievement of fsi conditions depends on the introduction of fictitious domain initially the variables v f n p f n v s n a s n u s n and f s fsi n at the step n are assumed to be known and the solver for variables at next step n 1 would be given in the following subsections 5 1 the dynamic analysis of solids with fsi force condition in order to carry out the dynamic analysis of solids more effectively the fsi analysis proceeds with the solid solver the total external force for the solid nodes would be obtained with the known fsi force f s fsi n at step n 51 f s ext n 1 f s ext n 1 f s fsi n 1 applying f s ext n 1 on the solid nodes the motion equation can be solved by the central difference algorithm belytschko et al 2000 for the variables u s n 1 v s n 1 and a s n 1 then update the solid domain ω s n with ω s n 1 and the corresponding fictitious field ω fc n is changed to ω f c n 1 ω s n 1 5 2 fsi velocity condition for fluid problem the velocities v s n and v s n 1 have been calculated after the analysis of solids but the fluid nodes x ω fc cannot be directly exerted the fsi velocity condition v f v s because the fluid mesh is not in coincidence with the solid mesh therefore we should confirm the fictitious fluid nodes coved by which solid element firstly and adopt suitable numerical approximation to transform the velocity from solid nodes to fluid nodes the interpolation functions have been investigated and compared wang and zhang 2010 between dirac delta function based on the mesh approximation and fem using linear interpolation scheme and the latter proves to be more simple and effective which is also utilized in the proposed fsi algorithm it is essential to adopt a searching algorithm to accomplish the numerical interpolation as illustrated in fig 3 which shows an immersed solid with the curve boundary moves in the fluid domain with the fixed euler grids assume a fluid node x q is located inside the solid domain and the following criteria is used for finding out whether the node is located inside a particular lagrangian triangular element with nodes x i x j and x k if area δ i j k i 1 3 area δ i j k i where δ i j k i is the triangle constructed by x q and the three vertexes of x i x j and x k then x q is located inside δ i j k if area δ i j k i 0 x q is located on the edge of δ i j k and if area δ i j k i 1 3 area δ i j k i x q is located outside δ i j k after searching the velocity of fluid nodes in the fictitious domain v ˆ fc n 1 can be interpolated as follows 52 v ˆ fc n 1 l i j k φ l s n 1 x i f v l s n 1 x i f ω fc n 1 where φ l s n 1 x i f is the shape function calculated by the area proportion and v l s n 1 is the solid velocity so the fluid nodes x i f ω fc n 1 can be imposed on the fsi velocity condition in the following form 53 g fsi f n 1 v f v i f n 1 v ˆ i f c n 1 0 x i f ω fc n 1 combining g fsi f n 1 v f with the fluid velocity boundary condition g vbc f n 1 v f the total fluid domain can be solved using the following modified fluid velocity boundary condition 54 g vbcufsi f n 1 v f v i f n 1 v i f n 1 x i f γ v f v j f n 1 v ˆ j fc n 1 x j f ω fc n 1 the fluid velocity v f n 1 satisfies the fsi velocity conditions and the fluid velocity boundary condition combining fsi velocity condition velocity boundary condition g vbcufsi f n 1 as well as pressure boundary condition g pbc f p one can update the fluid status using cbs algorithm from step n to n 1 5 3 evaluating fsi force the fictitious fluid can be used to evaluate the fsi force according the coupling condition the fictitious fluid has the same fluid properties with the real fluid and cbs algorithm can be also applicable to the governing equations of fictitious fluid because the fluid and solid mesh are not fitted and the solid mesh can be simply viewed as a lagrangian fictitious fluid mesh the fsi force exerted on solids nodes can be obtained using cbs algorithm based on lagrange mesh the fluid nodes x i fc ω fc n 1 are assumed to move in consistency with solid nodes so the nodal velocities of fictitious fluid are known by 55 v i fc n 1 v i s n 1 v i fc n v i s n x i fc n 1 x i s n 1 and the nodal pressure p i fc n in the euler mesh has to be transformed in the lagrange mesh based on the searching algorithm and the fem interpolation if we use cbs to calculate the fsi force based on fictitious fluid from step n to step n 1 the three steps of equations 47 49 become step 1 the calculation of intermediate momentum with same form as equation 47 56 m i j f v j i fc v j i fc n δ t r h s i i f f i i fc g step 2 obtain the pressure in the lagrangian form according the shape function φ l f n 1 x i fc n 1 57 p i fc n l i j k φ l f n 1 x i fc n 1 p l f n x i fc ω fc n 1 step 3 the momentum increment of fictitious fluid to calculate fsi force 58 m i j f v j i fc n 1 v j i fc n δ t m i j f v j i fc v j i fc n δ t g i j i f p j fc n f i i f fsi n 1 r h s i i fc n 1 f i i f fsi n 1 substituting equations 56 to 58 the fsi force exerted on fluid nodes can be written as following 59 f i f fsi n 1 m i j f v j i f n 1 v j i f n δ t r h s i i f g i j i f p j f n v j i f n 1 v j i s n 1 hence as a reaction force the fsi force f i f fsi n 1 can be written in the lagrangian form using the fictitious fluid grid 60 f i f fsi n 1 f i fc fsi n 1 m i j fc v j i fc n 1 v j i fc n δ t c i j fc n v j i fc n f i i fc n δ t 2 k i j fc n v j i fc n g i j i fc p j fc n n m i j fc v j i fc n 1 v j i fc n δ t ω fc n 1 ρ f φ i fc v j fc n φ j fc x j fc d ω ω fc n 1 φ i fc x j fc τ i j fc d ω δ t 2 k i j f n ω fc n 1 v k fc n φ i fc x k fc ρ f v j fc n φ j fc x j fc d ω ω fc n 1 φ i fc φ j f c x i fc p j fc d ω 5 4 the calculation procedure of nps pim the numerical treatments of the proposed nps pim with immersed method have been elaborated in the above subsections and a brief solver procedure from a to f has been given in the following for a general view a discretize the fluid domain and solid domain using triangular tetrahedral elements b set up the initial fsi force calculate displacement u i s n 1 velocity v i s n 1 and acceleration a i s n 1 of the solid and update the coordinates of solid nodes c calculate fluid velocity v i fc n 1 of fixed mesh included in fictitious fluid domain using interpolation and construct the new fluid velocity boundary conditions d based on the boundary condition of velocity and pressure employ cbs algorithm to obtain v i f n 1 p i f n 1 e update coordinates and velocity of fictitious domain as well as p i i fc n 1 in lagrangian meshes by fem interpolation and calculate fsi force of solid f update the variables v i f n v i f n 1 p i f n p i f n 1 u i s n u i s n 1 v i s n v i s n 1 a i s n a i s n 1 f i s fsi n f i s fsi n 1 x i s n x i s n 1 n n 1 go to step b for recycle in the present work the uniform time step δ t c r is adopted for the fsi system which is determined by δ t c r min δ t c r f δ t c r s δ t c r f and δ t c r f are the time steps for the fluid and solid respectively and calculated as follows 61 δ t c r f min h v f h 2 μ δ t c r s min ℓ e c e where h is minimum of the fluid element size ℓ e is the solid element length and c e is the current wave speed 5 5 incompressible constraints and mesh size dependency the structure is modeled by the isotropic saint venant kirchhoff material which is nearly incompressible previous study has demonstrated that the maximum volume change of the structure in is fem zhang et al 2012a is less than 0 1 when large deformation occurs it means the volume change is nearly negligible and the solid body considered in this research is nearly incompressible continuum or rigid like continuum therefore the fictitious fluid domain always maintains the same volume the inaccuracies of interpolation between fluid and solid domain arise from the implicit fluid structure interface as the ib methods and one can improve the accuracy of information transformation by refining the fluid mesh to make the interface more coincide with fluid element edge zhang et al 2012a wall et al has pointed out that complete kinematic and dynamic continuity at γ would ensure conservation of mass momentum and energy on the interface wall et al 2006 for the present method because the non conforming identity of the fixed euler mesh and lagrange mesh exists on the interface numerical interpolation is necessary for mutual information exchange which will lead to the kinematic and dynamic discontinuity on the interface the interpolation does affect the balance momentum between the two domains the reviews about immersed typed methods mittal and iaccarino 2005 have indicated that most of the ib methods discussed cannot satisfy the underlying conservation laws for the elements in the vicinity of the interface except the cut cell finite volume approach and the effect of interpolation has been investigated in section 6 1 based on the fsi force obtained from fluid and domain for the present method the results have shown that no significant discrepancy arises from the transformation of fsi force between fluid and solid domain also both of fsi force form fluid and solid domain keeps nearly consistent with gravity at the steady state as a consequence although the interpolation affects the balance momentum between the two domains the proposed method still works well for the simulations of fsi problems described here the introduction of fictitious fluid domain will bring about the mesh size dependency between fluid and structure mesh as described in gerstenberger and wall 2008 wall et al 2006 and previous works in boffi et al 2007 lee et al 2008 wang and zhang 2010 have reported that the mesh size ratio h f h s can affect the stability of finite element immersed boundary method the effect of the ratio h f h s has been investigated numerically in is fem zhang et al 2012a b and demonstrates the stability is not affected by a wide range of mesh size ratio which is usually selected to be 0 25 2 0 considering the governing equations established based on the assumption of adiabatic condition there are no heat transfer generation and dissipation in the present fsi system 6 numerical examples 6 1 a disk falls under gravity in a fluid domain in an incompressible viscous fluid domain a falling disk with the gravity acceleration of g 981 cm s 2 is analyzed in this example as shown in fig 4 a the size of fluid field is w 2 0 cm and h 5 0 cm and the radius of the disk is given as r 0 125 cm in the x direction the disk locates in the middle of fluid field and in the y direction the distance between the top and the disk center is set as l 1 0 cm the fluid density is given as ρ f 1 0 g cm 3 the disk is described with saint venant kirchhoff model with ρ s 2 g cm 3 ν s 0 3 and e s 10 4 g cm s 2 all the boundaries are considered as no slip boundary condition which means the normal and tangential components of fluid velocity are zero on the wall irregular triangular elements are utilized to discretize fluid domain using 8125 nodes and the solid domain using 301 nodes fig 4 b the validation can be carried out using the terminal velocity which also can be obtained by the empirical formula with the following form clift 1978 62 u ref ρ s ρ f g r 2 4 μ f ln w 2 r 0 9157 1 7244 2 r w 4 we have calculated different terminal velocity u t by immersed method with fem when different viscosity μ were taken into consideration table 1 shows the calculated results by comparing with the experimental ones where it can be found that the present results are in good agreement with the reference solution u ref when the soft disk is immersed in the fluid channel it encounters with the gravity force and buoyancy and the difference between them impels the disk to fall downwards the drag force increases gradually and would balance the difference as a consequence the disk falls with a stable velocity fig 5 gives the vertical velocity contour of the fluid domain at different time when μ f 0 75 g cm s the vertical velocity contour keeps stable and symmetrical before the disk approaches the wall see fig 5 a and the unsteady status arises due to the bottom interference in fig 5 b when the disk at the bottom moves towards the right wall the velocity presents opposite distribution around the disk top fig 5 c and the flow distribution has been affected at the time 1 07 s fig 5 d resulting from the blocking effect of the right wall the time history of vertical velocity v y and displacement u y are shown in fig 6 it has been shown in fig 6 a that the velocity increases rapidly at the initial stage as a result of driving force as the increscent drag force balances the difference between gravity and buoyancy the velocity keeps almost unchanged after t 0 2 s however it decreases sharply from t 0 7 s and is close to zero at t 0 9 s because of the wall effect the disk still suffers from a fluctuation of velocity along the wall surface which may be brought about by the deformation of the body it means the proposed method can handle the contact phenomenon effectively and the slight fluctuation shows no significant effect on the displacement curve see fig 6 b which presents a continuous growth before t 0 8 s and remains unchanged afterwards the fsi force obtained from the fluid and solid domain has been computed and fig 7 has shown the calculation results accounting for different viscosity settings in the figure fsi force fluid and fsi force solid denote the fsi force calculated from fluid domain and solid domain respectively and gravity denotes gravity of the disk from the figures it can be found that with the decrease of fluid viscosity the falling velocity of disk grows and the fluctuation of fsi force becomes significant however good agreements can be achieved for the fsi forces calculated from fluid and solid domain and the forces can always balance the gravity in spite of different viscosity conditions in the following five groups of meshes are utilized to investigate the effect of mesh size ratio on the transformation of fsi force with μ 1 5 g cm s fig 8 shows the mesh settings with mesh size ratio h f h s from 4 to 0 25 regular and irregular triangular meshes are used for fluid and solid domain respectively and the computed fsi forces have been given in fig 9 fig 9 a shows that the fsi forces calculated from solid domain present no obvious distinction in the given mesh size ratios fig 9 b f compare the fsi forces from fluid and solid domain in different mesh size ratios where the consistent results have proven that the present method is efficient to transform fsi force between fluid and solid domain for reasonable mesh size ratio five groups of meshes are utilized to investigate the convergence of forces towards the gravity with respect to different mesh sizes with h f h s 2 fig 10 shows the mesh settings with different mesh sizes regular and irregular triangular meshes are used for fluid and solid domain respectively and the computed fsi forces have been given in fig 11 it has been found from fig 11 a that the fsi force can generally balance the gravity by using the given mesh sizes fig 11 b f compare the fsi forces from fluid and solid domain with different mesh sizes and the forces have shown good achievements towards the gravity as the mesh is refined also the more refined mesh can bring more stable results while keeping the same mesh size ratio the error evolution of fsi force from the solid domain has been extracted as a function of the mesh size to deduce the order of convergence with h f h s 2 the l 2 error norm e f s has been defined as follows 63 e f s f i s num f i s ref l 2 f i s ref l 2 where f i s n u m are the numerical solutions of fsi force and f i s ref are the reference solutions which is the theoretical value of gravity exerted on the solid domain as a body force considering the constantly slight fluctuation of fsi force see fig 11 the average value of e f s is calculated using e f s 1 n t 0 t 1 e f s t 0 is the initial time when the disk begins to fall with terminal velocity t 1 is set 0 4 s for the present solution and n is the selected number from the time t 0 to t 1 the result can be seen in fig 12 which shows the solution of fsi force from solid domain with the convergence rate of 1 48 6 2 beam in a fluid channel a steady problem is considered about a flexible beam fixed in the fluid tunnel which was simulated previously using is fem zhang et al 2012a the viscous fluid flows across the beam and leads to a large deformation because of the fluid force the beam will come to a stead status after some time when the elastic force balances with the fsi force as illustrated in fig 13 the length and height of the fluid field is l 4 cm and h 1 cm the distance between the fixed beam and the left edge of the fluid tunnel is l 4 the thickness of the beam is a 0 04 cm and the height is b 0 8 cm gravity is neglected for this problem the bottom of the fluid domain satisfies the no slip boundary condition and the top satisfies a symmetric condition using v 2 f 0 the inlet velocity is given at the left edge as follows 64 v 1 f t 1 5 y 2 2 y cm s v 2 f t 0 the outlet pressure p f at the right edge is defined to be zero the solid materials are modeled with ρ s 7 8 g cm 3 ν s 0 3 and e s 10 5 g cm s 2 and the fluid properties are given as ρ f 1 0 g cm 3 and μ f 0 1 g cm s we discretize the fluid domain using 100538 triangular elements with 50670 nodes and the solid domain using 648 elements with 409 nodes the top point a of beam is set as a reference point and the cures of velocity v 1 s and displacement u 1 s in horizon direction are shown in fig 14 the velocity fluctuates constantly and the displacement amplitude keeps growing during the initial period as the increased internal force gradually balances the external force the velocity decreases to zero and the displacement comes to a maximum of 0 422 cm fig 15 illustrates the velocity v 1 f contour and pressure p f contour after the fsi system comes to a steady state it is quite clear that in fig 15 a a high velocity distribution forms in the vicinity of beam end because the existence of beam decreases the height of fluid channel the velocity increases rapidly when fluid flows over the free end of beam a bubble flow arises behind the beam due to the barrier effect in fig 15 b a high pressure distribution can be observed on the left side of the beam and decreases gradually on the right side the accuracy and convergence properties of the fsi models using nps pim with α 2 1 fem 0 8 0 6 0 5 0 4 0 2 and 0 ns pim are compared with regard to the solution of solid displacement three groups of the uniform triangular meshes are used for solid domain and the mesh sizes are set as h s 1 50 1 75 and 1 100 the fluid domain is discretized with two groups of triangular meshes with mesh sizes h f 1 40 and 1 50 in this test the uniform solid mesh with h s 1 300 is provided as a reference solution the analysis of displacement error e u s can be calculated by the following formula 65 e u s u i s num u i s ref l 2 u i s ref l 2 where u i s n u m are the numerical solutions and u i s ref are the reference solutions fig 16 a and b shows the result for this test it is found that as the value of α 2 varies from 1 to 0 4 the displacement error gradually decreases because the overly stiff characteristic of model has been mitigated and the error increases when the value of α 2 changes from 0 4 to 0 which means the stiffness inclines to the soft side the trends are almost consistent for all the combinations of meshes and under the same constraints of fluid mesh better results can be obtained as solid mesh is refined generally α 2 0 4 leads to the highest accuracy compared with the other values due to a most suitable stiffness behavior for solid analysis a comparative study has been also conducted in terms of computational cost and all simulations are running by the computer of intel r core tm i5 2400 cpu 3 10 ghz and ram 4 0 g the solid domain is divided by the mesh sizes of h s 1 50 123 nodes 1 75 244 nodes and 1 100 405 nodes and a unified fluid mesh of h f 1 40 6601 nodes is used the cpu time for the fsi models using different solid solvers have been presented in table 2 which has been also drawn with bar charts for a good view in fig 17 the computational cost is counted by cpu time when it comes to a steady state t 3 s in the table fem and ns pim denote the fsi models using fem and ns pim as solid solver respectively and α 2 0 2 α 2 0 4 α 2 0 5 α 2 0 6 α 2 0 8 denote the fsi models using nps pim with the corresponding value of α 2 as solid solver respectively it is found that the cpu time of nps pim is in the same level as that of respective fem and ns pim so a very good balance can be achieved by the nps pim between results accuracy and computational cost the convergence of nps pim with α 2 0 4 has been analyzed in fig 18 which shows solid displacement solutions is close to the convergence rates of 1 79 and 1 76 when the fluid mesh sizes are set as h f 1 50 and 1 200 respectively the integral of the velocity divergence in the fictitious domain has been investigated and nps pim with α 2 0 4 is employed for solid analysis three groups of the uniform triangular meshes are used for solid domain and the mesh sizes are set as h s 1 50 1 75 and 1 100 the fluid domain is discretized with two groups of triangular meshes with mesh sizes h f 1 40 and 1 50 figs 19 and 20 have shown the results of the integral of velocity divergence div v d ω and horizontal displacement at tip point with h f 1 40 and 1 50 respectively it has been found that the integral of the velocity divergence is not strictly equal to zero on the discrete form however the maximum of div v d ω is no more than 0 4 10 3 see figs 19 a and 20 a and there are no numerical problems that have been observed from the solutions of horizontal displacement see figs 19 b and 20 b the result has demonstrated that the proposed method is capable of solving such kind of beam bending problem although the integral of the velocity divergence is not strictly equal to zero 6 3 leaflet driven by a sinusoidal fluid flow a transient problem is analyzed in this example which is the same as reference zhang and gay 2007 fig 21 has shown the geometry model for this problem and the size of rectangular fluid domain is l 4 cm and h 1 cm the length and width of the leaflet are set as λ 0 8 cm and t 0 0212 cm the material properties of solid are defined with density ρ s 6 0 g cm 3 poisson s ratio ν s 0 5 and young s modulus e s 10 7 g cm s 2 the incompressible viscous fluid is assumed with density ρ f 1 0 g cm 3 and viscosity μ f 0 1 g cm s the leaflet locates in the mid length of the fluid domain with a fixed bottom end at the start the leaflet keeps still and a sinusoidal input velocity v 1 f sin 2 π t π 2 with period t 1s is applied at y 0 and y l the no slip boundary condition is assumed at the bottom edge of the fluid domain and the velocity component v 2 f is set to be zero at the top edge we discretize the fluid domain using 5608 triangular elements with 2930 nodes and the solid domain using 216 elements with 165 nodes fig 22 illustrates the pattern of the motion and velocity in a period for the time t t 0 0 3 the flexible body is driven to the right fig 22 a b and c as the flow pushes it forward for the time t t 0 3 0 5 as the flow decays the leaflet inclines to bounce back fig 22 d and e once the input velocity is given in opposite direction the leaflet accelerates to the left during the time t t 0 5 0 7 fig 22 f and g subsequently the leaflet returns to the balance position due to its elasticity property fig 22 h and i the leaflet repeats this circle in every period and the result presents the same performance as those obtained by tbaaijens 2001 yu 2005 and zhang and gay 2007 in order to investigate the time history of horizontal displacement of the leaflet tip three sets of solid meshes with 165 nodes h s 1 80 324 nodes h s 1 100 and 679 nodes h s 1 165 are used with one set of fluid mesh of 2930 nodes the result has been shown in fig 23 and it is found that the curve becomes unchanged as solid mesh is refined the maximum of displacement is in good agreement with the literature zhang and gay 2007 then we change the period of input velocity to be t 2s t 4s and decrease the elasticity modulus to be e s 10 5 g cm s 2 and e s 10 4 g cm s 2 accordingly so the result can be compared considering larger deformation with different parameter values the fluid and solid domain are using 2930 and 165 nodes respectively the reference solution is calculated by refined solid mesh with 1080 triangular elements and 679 nodes it can be seen from fig 24 a and b that the configuration of the leaflet varies from left side to right side sequentially from α 2 1 to α 2 0 at the same time which corresponds to the continuous change of stiffness model and it seems both α 2 0 4 and α 2 0 2 lead to better results by comparing with the reference solution in fig 25 the configurations become chaotic accounting for larger deformation and α 2 0 4 has been found to have the best performance in consideration of good agreement with the reference the above results have illustrated significance differences associated with large deformation using the fsi models with fem ns pim and nps pim as solid solvers and two finer meshes have been added for further validation for the good performance of nps pim with α 2 0 4 the input velocity period is set as t 2s with e s 105 g cm s2 the fluid domain is discretized with 6601 nodes h f 1 40 and 40501 nodes h f 1 100 and the solid domain is discretized with 123 nodes h s 3 200 324 nodes h s 1 100 and 966 nodes h s 1 200 for the reference configuration the regular triangular elements are used for both fluid and solid domain fig 26 shows the time history of horizontal displacement at the leaflet tip it can be found that all the computed results are in good agreement with the reference one and the solution of the refined mesh h s 1 100 is of a little better performance than that of the coarse mesh h s 3 200 the configurations of the leaflet have also been drawn in figs 27 and 28 considering different fluid domain mesh sizes and time the configurations h s 3 200 and h s 1 200 keep basically in consistent with the reference configuration it can be found that some discrepancies exist in the tip region for h s 3 200 due to the inherent poor performance for very coarse mesh generally nps pim with α 2 0 4 performs well for this fsi problem with large displacement 6 4 elastic plate behind a fixed cylinder furthermore a classical case of the vortex excited elastic plate configuration described in turek and hron 2006 has been used to validate the present method and nps pim with α 2 0 4 is employed for analyzing the elastic plate as can be seen in fig 29 the fluid domain is given as l 2 5 m and h 0 41 m with a fixed cylinder of diameter d 0 1 m centered at c 0 2 0 2 m the elastic plate is attached at the right edge of the cylinder with the length l 0 35 m and the height h 0 02 m the top and bottom of fluid domain as well as the surface of the solid satisfy no slip boundary condition at the outlet the pressure is set to be zero and the input velocity v x t has the following distribution as time varies 66 v x t v 1 cos π t 2 2 t 2 0 v t 2 0 where v 1 5 u y h y h 2 2 two non steady situations with re 100 case 1 and re 200 case 2 are taken into account and the parameter setting has been illustrated in table 3 the fluid domain and solid domain are discretized using irregular triangular meshes with 18452 nodes and 763 nodes respectively and the average mesh size ratio of fluid and solid is 2 in the interaction region the vertical displacement of tip point a has been investigated and fig 30 depicts the curve of time history it is clear that both fig 30 a and b produce a periodic oscillation after some time due to the continuous vortex excited force the present result has been compared with reported solution in the literature in table 4 where good agreement with previous studies can validate the efficiency of proposed method in addition the levels of drag and lift as well as the frequency have been compared with the literature tables 5 and 6 have shown the results of case 1 and case 2 respectively for the drag force the average value basically keeps consistent with the reported solutions in turek and hron 2006 turek et al 2011a and some discrepancy has been observed for the oscillation amplitude the lift has presented opposite tendency good agreements have been achieved for both case 1 and case 2 in terms of the frequency figs 31 and 32 show the velocity and pressure contours of case 1 and case 2 at different time compared to case 2 case 1 exhibits a larger deformation of elastic plate owing to its high flexibility the vortex excited force compels the plate to swing periodically which brings about the advection of vortex along the channel for both velocity see figs 31 a and 32 a and pressure see figs 31 b and 32 b 7 conclusion in this article we combined the nps pim with immersed method to solve fsi problems with largely deformable solids structures following conclusions can be obtained 1 the proposed method is based on the framework of immersed method and uses the simplest triangular mesh which makes the method possess the advantages of both avoiding mesh regeneration operation and simplifying preprocessing for large deformation associated fsi problems 2 from the numerical test results it has been found that the proposed model with nps pim as solid solver can achieve better accuracy than the models with either fem or original ns pim and the computational costs of these models are in the same level the value of α 2 0 4 is recommended for the nps pim used in the proposed model based on the present study 3 the efficiency of momentum transformation between fluid and solid domains has been verified in a straightforward way and good agreements between gravity and the fsi forces calculated from fluid and solid domains have been achieved in a suitable mesh size ratio for the proposed method 4 numerical examples have verified the accuracy stability and convergence properties of the present method nps pim with α 2 0 4 provides the convergence rate of around 1 8 for solid displacement in space and the accuracy and validity has been further verified by the case of the vortex excited elastic plate configuration compared with the reported solutions acknowledgements the authors wish to thank the support of the national natural science foundation of china no 51579042 the key program of national natural science foundation of china no 51639003 the recruitment program of global young experts no d1007001 and the fundamental research funds for the central universities dut16zd218 dut2017tb05 
