index,text
3650,the latest generation of satellite precipitation estimates integrated multi satellite retrievals for global precipitation measurement version 06 imerg v06 calibrated by monthly rain gauge data is applied to investigate the changing characteristics of precipitation in different phases rain snow and sleet over the tibetan plateau tp from 2001 to 2020 the performance of the imerg product in capturing the characteristics of the three precipitation phases is firstly evaluated against the ground based observation the results show that the imerg product performs well in capturing the spatial distribution magnitudes and annual cycle of the amount and frequency of precipitation in different phases the bias of annual precipitation amount frequency averaged in the 90 stations used in this study is approximately 10 20 comparatively the imerg product shows higher skill in estimating rain than snow and performs better in the other three seasons than in winter in addition the performance of the imerg product is comparable in the southern and northern tp both the annual amount and frequency of precipitation have increased in most parts of the tp in the last two decades with maximal values of 50 mm and 20 days per decade respectively occurring in the central part of eastern tp changes in the amount and frequency of precipitation are dominated by rain and snow respectively in the study period in addition light and moderate precipitation contribute approximately 70 and 90 to the increases of the regional mean precipitation amount and frequency respectively in the central part of eastern tp there are no significant and uniform changes in the snowy season during the last two decades therefore the increase in snowy days in most areas of the tp is caused by more frequent snow events in the fairly constant snowy season keywords imerg ground based observation rain snow tibetan plateau 1 introduction the tibetan plateau tp is the highest plateau in the world with an average elevation of over 4000 m a s l exerting a very important influence on the climate in asia and beyond duan and wu 2005 wu et al 2012 yao et al 2012 known as the asian water tower the tp and the adjacent mountain ranges are the sources of all the major rivers in asia and play an important role in the climate water resources and ecosystem of the downstream regions immerzeel et al 2010 immerzeel and bierkens 2012 precipitation is one of the most important and active components of the water cycle and has been changed under global warming in the past several decades ipcc 2013 the tp has experienced evident climate change since the 1960 s including the overall warming glacier shrinking and water cycle changing yao et al 2007 kang et al 2010 yang et al 2014 the changes of precipitation over the tp in the past several decades are spatially different and exhibit evident decadal variability xu et al 2007 the regional mean annual precipitation over the tp showed fluctuating increase in the last decades for the periods of 1961 2012 1971 2005 and 1971 2011 the increasing rates of annual precipitation averaged over the tp are 5 mm 12 mm and 7 5 mm per decade respectively wu et al 2007 gao et al 2014 kuang and jiao 2016 wang et al 2018 the precipitation increased in central and eastern and decreased in western parts of the tp during 1961 2001 xu et al 2008 the annual precipitation averaged over southeastern and northwestern tp increased by 16 8 mm and 4 mm per decade from 1979 to 2001 respectively you et al 2015 changes in precipitation over the tp also show seasonal features winter precipitation increased slightly in most parts of the tp from 1961 to 2012 while summer precipitation also increased in most parts of the tp but decreased insignificantly over southeastern tp wang et al 2018 spring and winter precipitation significantly increased in central and eastern parts of the tp from 1961 to 2007 you et al 2012 precipitation in may increased significantly by 13 36 per decade over southeastern tp during 1979 2014 zhang et al 2017 most existing studies on precipitation over the tp do not explicitly treat precipitation in different forms although solid snow and liquid rain precipitation have different effects on the water cycle and energy balance marks and dozier 1992 loth et al 1993 slater et al 2001 clark et al 2006 dai 2008 climate change will influence snowfall and further influence the snowmelt and snow cover barnett et al 2005 huang et al 2017 ground based observation is the most direct method to obtain precipitation phases however it is often insufficient or not accessible therefore many previous studies classified precipitation phases based on surface air temperature wet bulb temperature and other atmospheric conditions auer 1974 clark et al 2006 ding et al 2014 based on the temperature threshold the regional mean snowfall and snowfall rainfall ratio decreased by 6 mm and 5 per decade over the tp from 1961 to 2013 wang et al 2016 based on the classification method proposed by ding et al 2014 the snowfall trends during 1960 2014 show large spatial variation increasing in central and western and decreasing in eastern and northeastern tp deng et al 2017 based on temperature and relative humidity thresholds snowfall increased in eastern tp and decreased in western tp during 1961 2007 in the aphro dataset bai et al 2019 there are uncertainties in estimated snowfall changes over the tp in observational studies and these can stem from different datasets used different classification methods and complex climate regimes over the tp ground based observation is the most common tool to observe precipitation and the results above are mainly based on station data or the gridded datasets interpolated from station data however rain gauges are sparsely distributed over the tp tong et al 2014b and the spatial scale of precipitation over the tp is overall small chen et al 2016 satellite based precipitation products are of great value to precipitation estimates over mountainous regions owing to their fine spatial and temporal resolution tong et al 2014a the tropical rainfall measuring mission trmm was launched in 1997 kummerow et al 1998 and many satellite based precipitation retrieval algorithms have been generated based on the multiple satellite sensors such as global satellite mapping of precipitation gsmap kubota et al 2007 climate prediction center morphing method cmorph joyce et al 2004 and trmm multi satellite precipitation analysis tmpa huffman et al 2007 to further improve the capacity and accuracy of global precipitation observation the global precipitation measurement gpm mission was launched in 2014 hou et al 2014 by the national aeronautics and space administration nasa and the japan aerospace exploration agency jaxa the gpm mission is an international network of satellites that provide global observations of rain and snow the integrated multi satellite retrievals for gpm imerg huffman et al 2019 algorithm combines information from whatever constellation of satellites operating around earth at a given time to estimate precipitation over the majority of the earth s surface in other words the imerg algorithm uses the precipitation estimates collected in both the trmm and gpm eras to obtain a set of global precipitation records as long as possible previous studies show that the imerg product exhibits overall good performance in estimating precipitation in different regions around the world by comparing with the ground based observation pradhan et al 2022 the imerg product performs well in rainfall detection over the united arab emirates from 2010 to 2018 especially the moderate and intense rainfall alsumaiti et al 2020 it shows the potential to complement ground based observations over canada moazami and najafi 2021 and agrees well with gauge based precipitation over mainland china australia and europe navarro et al 2019 jiang and bauer gottwein 2019 islam et al 2020 in addition the imerg product can accurately capture the general pattern of tropical cyclone precipitation and provides a noticeable improvement in accuracy over its predecessor tmpa yuan et al 2021 however there are still biases in the imerg such as vacancy report of precipitation occurrence overestimation of light precipitation and underestimation of heavy precipitation navarro et al 2019 alsumaiti et al 2020 moazami and najafi 2021 yuan et al 2021 tang et al 2020 compared the performance of the imerg product with nine satellite and reanalysis precipitation products in china from 2000 to 2018 and indicate that imerg performs well at the daily and hourly scale they also investigated the snowfall product in the imerg product but did not evaluate it against observed rain and snow records on the ground it is worth noting that the snowfall retrieval algorithm in the imerg product depends on wet bulb temperature and needs to be evaluated before applying it in the investigation of snowfall changes in this study we first use the precipitation phase information rain snow and sleet obtained from the weather station observation network of china to evaluate whether the imerg product could be used to investigate the precipitation in different phases over the tp then changes of precipitation over the tp in different phases during the recent two decades are investigated we aim to address the following three questions 1 weather the imerg product can reasonably capture the characteristics of rain snow and sleet over the tp 2 how did precipitation in different phases change in the recent two decades 3 what are the seasonal characteristics of precipitation changes and how precipitation in different intensity levels contribute to the total precipitation changes the rest of this paper is organized as follows section 2 describes the data and methods used the main results are exhibited in section 3 the summary and conclusions are given in section 4 2 data and methods 2 1 imerg product the imerg final run product huffman et al 2019 is used in this study the latest version of imerg product currently is version 06 v06 containing a comprehensive estimate of rain and snow since june of 2000 the time resolution is 30 min and the spatial resolution is 0 1 two variables are used to investigate the characteristics of precipitation in different phases over the tp the first one is precipitation calibrated at a monthly scale based on gauge analysis and the other one is the probability of liquid precipitation pl pl is calculated based on wet bulb temperature using the method raised by sims and liu 2015 since this diagnostic is independent of the estimated precipitation the pl is reported for all grid boxes including those with missing or zero estimated precipitation in another word this variable can be applied to other global precipitation fields for estimating precipitation phase 2 2 rain gauge data from meteorological stations the 3 hourly rain snow and sleet record and daily precipitation amount from 90 national ground stations over the tp circles in fig 2 a during 2010 2013 are used the precipitation amount has undergone strict quality control by china meteorological administration cma including climatic range check internal consistency check spatiotemporal consistency check and man computer interaction control ren et al 2015 the precipitation phases are recorded based on the visual observation of professional weather recorders the precipitation phase data is derived from the meteorological information comprehensive analysis and processing system micaps li et al 2010 and quality controlled according to the following procedures 1 the weather phenomena are manually recorded before 2014 the full period of the data we collected is 2010 2015 and there are many missing values in 2014 and 2015 therefore the period of 2010 2013 is selected first 2 there are three variables including present weather past weather 1 and past weather 2 can provide the weather phenomena information however past weather 1 and past weather 2 were often not recorded therefore only present weather is used in this study and the time resolution is every 3 h 3 90 stations are selected according to the proportion of effective sample size of weather phenomena data the missing data is less than 1 every year in these selected stations we double check the accuracy of the weather phenomena data with the daily precipitation data the precipitation amount arithmetic mean of the 90 stations on days recorded as precipitation day in the weather phenomena dataset account for approximately 97 of the total precipitation amount in the daily precipitation dataset provided by cma in 2010 2013 therefore the weather phenomena dataset can reasonably provide the precipitation phase information since the ground based observation is point measurement of precipitation we take the approach of comparing the station data with the precipitation in the imerg product at the points nearest to the stations therefore 90 imerg pixels are selected if the values are missing in the station data the corresponding values in the imerg pixels will be masked to make the comparison more effectively in order to simplify the description the regional mean of a variable in a certain region represent the arithmetic mean of this variable in the stations over this region in the evaluation section 2 3 distinguish different phases of precipitation over tp in the station data the precipitation phase is divided into three phases rain sleet and snow the three hourly station data are firstly pre processed to provide daily values for precipitation amount the amounts of precipitation in different phases are summed up for each day for precipitation days days when precipitation amount larger than 0 1 mm if multiple phases of precipitation occur on a certain day then this day will be divided proportionally according to their frequencies take the 90 stations as a whole the total amount of rain sleet and snow account for 88 8 3 4 and 7 8 of the total precipitation amount respectively rain days sleet days and snow days account for 78 6 4 4 and 17 0 of the total precipitation days respectively in the imerg products pl is a variable used for distinguishing rain sleet and snow and the value of the probability ranges from 0 to 100 the larger the probability value is the more likely the precipitation is rain ordinarily liquid precipitation happens when wet bulb temperature tw higher than 0 c and pl is high in this condition frozen hydrometeors occur around or below tw less than 0 c pl varies from around 50 to very low the mixed category is likely to occur around the pl 50 mark although the frequency of sleet is much less than rain and snow the range of pl for sleet is large we try to find a value of pl denoted as plconst to make the proportions of the three precipitation phases provided by the imerg product consistent with those from ground based observations and the specific criteria should match with the followings if pl is larger than plconst precipitation is treated as rain if pl is smaller than 100 minus plconst 100 plconst precipitation is treated as snow otherwise precipitation is treated as sleet the total absolute bias is the sum of the absolute biases of the proportions of rain snow and sleet for example when we choose 80 as plconst the proportions of the amount of rain snow and sleet in the imerg product are 88 8 8 1 and 3 1 respectively in the ground stations the corresponding values are 88 8 7 8 and 3 4 respectively therefore the total absolute bias is 88 8 88 8 8 1 7 8 3 1 3 4 0 6 a represents the absolute value of a the total absolute bias of the amount of the three precipitation phases reaches the minimum when plconst is set to 82 fig 1a while the total absolute bias of the frequency of the three precipitation phases reaches the minimum when the value is set to 77 fig 1b combining the two values calculated based on precipitation amount and precipitation days 80 is determined as the threshold for distinguishing precipitation phases over the tp in another word if the probability of liquid precipitation in a certain half hour is larger than 80 precipitation that occurred in this half hour will be treated as rain if the probability of liquid precipitation in this half hour is smaller than 20 precipitation occurred in this half hour will be treated as snow otherwise precipitation occurred in this half hour will be treated as sleet 2 4 estimating skill of imerg product the performance of the imerg product is evaluated using the following metrics chen et al 2013 1 skill 1 r 2 s d r 1 sdr 2 r is the correlation between the precipitation rain snow in the 90 selected grids in the imerg product and the corresponding 90 ground stations sdr is the ratio of the standard deviations of precipitation rain snow in the 90 grids and the corresponding 90 stations therefore both spatial distribution and magnitude are considered in this formula the skill is higher when the value is closer to 1 0 2 5 definition of sub regions and different intensity levels of rain and snow in order further evaluate the performance of the imerg product in estimating precipitation in different phases over the tp we divide the tp into two parts the southern tibetan plateau stp and the northern tibetan plateau ntp by 32 n according to general climate regimes and the location of ground stations we divide rain and snow into four intensity levels light moderate heavy and storm respectively according to the criteria of the cma in classifying rain and snow intensities the detailed information is listed in table 1 3 results 3 1 evaluation of imerg precipitation product the precipitation amount in imerg product over the tp is first evaluated in the station data generally total annual rainfall decreases from the southeast to the northwest of the tp fig 2a with the values in the large center greater than 800 mm the total annual snowfall is much less than that of rainfall in almost all the 90 stations over the tp fig 2b and the averaged snow rain ratio in the 90 stations is 12 the eastern part of the central tp is an area with more snowfall and the values are close to 150 mm in some stations the spatial distribution of the amount of sleet is similar to that of snow but the magnitudes are much smaller fig 2c the imerg product shows much more spatial distribution characteristics of precipitation in different phases than the station data fig 2d f generally imerg performs well in capturing the spatial distributions of rain snow and sleet the precipitation amounts in different phases in imerg are a little more than those in the station data but within an acceptable range the annual cycle of regional mean precipitation in different phases shows that the peak of rainfall occurs in summer fig 3 a the amount of rain is larger than 100 mm per month in july the snowfall is mainly concentrated in boreal spring and autumn and the amount of snow is larger than that of rain in boreal winter months the amount of sleet is small and the peak value occurs in may fig 3a although rainfall in the imerg product is more than that in the station data in july and august annual cycles of precipitation in different phases are reasonably characterized fig 3b in order to quantitatively evaluate the performance of the imerg product we use formula 1 to obtain the skill scores the skill is higher when the value is closer to 1 0 in general imerg shows higher skill in estimating rain than snow fig 5 a the skill scores for the annual amount of precipitation rain and snow are 0 84 0 81 and 0 42 respectively the r and sdr of annual snowfall are 0 3 and 0 92 respectively which means that the magnitudes of snowfall in the imerg product and the station observation are comparable but the spatial distributions of snowfall in the 90 grids in imerg product and the corresponding 90 stations are relatively different for different seasons the skill scores for the amount of precipitation and rain are higher in boreal spring summer and autumn than in winter and the reason is that winter precipitation is primarily snow in all the 90 stations the regional mean bias mean bias in the stations over a certain region of precipitation amount is further investigated fig 6 a the regional averaged annual precipitation amount in the imerg product is comparable with that in the station observation and the absolute relative biases over the ntp and stp are 0 9 mm month and 5 0 mm month 2 8 and 10 2 respectively consistent with fig 3 there are wet biases in summer in both of the ntp and stp and the relative biases of rain in the two regions are comparable 15 5 and 14 1 absolute biases of snowfall in winter in the two regions are small within 2 mm month but the relative biases are obvious especially in the ntp 66 the precipitation days frequency in the imerg product are also evaluated the spatial distributions of the frequency of different precipitation phases are similar to the corresponding spatial distributions of the precipitation amount figs 2 and 4 there are more than 120 rainy days per year in some stations along the southeast of the tp in the station data fig 4a snowy days are much less frequent than rainy days throughout the tp and are concentrated in 10 to 40 days for most stations fig 4b the average snowy rainy days ratio in the 90 stations is 26 the imerg product also performs well in capturing the spatial distributions and magnitudes of the frequency of precipitation in different phases fig 4d f compared with the precipitation amount the bias of precipitation frequency is larger in the imerg product figs 2 and 4 one possible reason for this bias is that light precipitation days are more frequent in the satellite observation than in the ground observation the peak of rainy days averaged in the 90 stations also occurs in boreal summer months and there are more than 15 rainy days per month in july fig 3c the average snowy days in the 90 stations are approximately 3 days in march and april and sleet days are about 1 day in may fig 3c consistent with the results above precipitation in different phases occurs more frequently in the imerg product than in the station data but the bias is within an acceptable range and the annual cycle of the precipitation frequency matches well with that in the station data fig 3d the imerg product shows acceptable skill in estimating the frequency of precipitation and its two phases and the skill scores are comparable with those for the corresponding amount fig 5a and b the regional averaged annual precipitation frequency in the two subregions are both approximately 20 fig 6b compared with precipitation amount the regional mean biases of precipitation frequency are more uniform across different seasons and regions over the tp the imerg product reported more rainy days and snowy days in spring summer and autumn in both the ntp and stp than the station observation fig 6b conditions for winter are different the imerg product reported more snowy days in stp and less snowy days in ntp than the station observation and the relative biases are more than 60 and 60 in the two regions respectively it should be noted that the rainy days are negligible in winter and the sample size for the calculation of biases in rainy days in winter is small in general the imerg product performs well in capturing the climatic characteristics of precipitation in different phases over the tp and shows higher skill in rain estimate than in snow estimate the main precipitation type in winter is solid in the 90 stations over the tp and conceivably the imerg product performs better in the other three seasons than in winter the regional mean biases in the ntp and stp are comparable for rain and snow in different seasons it should be noted that the statistics and results shown above are all derived from the 90 stations and the corresponding imerg pixels the sparsely distributed ground stations especially in the northwestern tp and the complex terrain over the tp limits the representativeness of the results and more ground based observations are needed to assess the imerg product more comprehensively in the future research previous studies indicate that the performance of the imerg product varies in different regions and climate conditions chen et al 2018 alsumaiti et al 2020 pradhan et al 2022 it shows higher skill in lower latitude regions than in higher latitude regions chen and li 2016 additionally complex terrain may make it more difficult to estimate precipitation ma et al 2018 navarro et al 2019 wang et al 2019 as mentioned above the precipitation days are more reported in the imerg product than in the station observation and the possible reason is for this is the evaporation of light precipitation in the atmosphere wang et al 2019 despite that the imerg product shows better performance in capturing snowfall than other satellite based precipitation product sadeghi et al 2019 there are still room for improvement the possible reason is the limitation of passive microwave retrievals and infrared information at cold or snow covered background surfaces yong et al 2015 lu and yong 2018 in the next part of this study we investigate the changes in precipitation in different phases in the last two decades using the imerg product 3 2 changes of precipitation in different phases the annual precipitation amount has significantly increased in most areas of the tp in the last two decades with maximal values of over 50 mm per decade occurring in the central part of eastern tp the precipitation amount has decreased in the last two decades in some parts of southwest tp but this change is not significant fig 7 a previous studies indicate that annual precipitation amount has increased in most parts of the tp since the 1960 s wang et al 2018 but the changing pattern may be different during different study periods li et al 2010 tong et al 2014b zhang et al 2017 the changing patterns of the amounts of rain snow and sleet are similar to that of total precipitation and the changing magnitudes of precipitation are dominated by that of rain accounting for up to 80 over most parts of the tp fig 7a d considering that precipitation changes may be different among different months we select two regions to further investigate the changes in the annual cycle of precipitation over the tp as shown in fig 7a one region is in the central part of eastern tp region 1 solid box and the other one is in the southwestern tp region 2 dashed box regional mean linear trends of precipitation amount and frequency in the two selected regions are shown in figs 8 and 9 precipitation amount has increased almost throughout the year in region 1 in the last two decades rainfall is the main contributor to the increase in precipitation amount in may to september while the increased precipitation in boreal spring and autumn is mainly contributed by the increase in snowfall fig 8a the absolute increase in the amount of rain in summer is larger than that of snow in spring and autumn however in terms of the relative change relative to the climatology during 2001 2020 the increase in the amount of snow is larger than that of rain fig 8b considering that in climatology precipitation amount peaks in summer and the regional mean rainfall is much more than snowfall in region 1 the precipitation amount in region 1 has been more dispersed in the past two decades and the proportion of snowfall has increased the overall warming in the past decades is one possible reason for the overall increase of the precipitation amount over the tp since the water vapor content in the atmosphere increases along with the increase of air temperature and then precipitation is expected to increase trenberth 2011 if other conditions remain the same in addition the summer precipitation over the tp has experienced an interdecadal transition in the late 1990s and the increase in precipitation over northern tp is the combined contribution of the positive phase of atlantic multi decadal oscillation amo and the negative phase of interdecadal pacific oscillation ipo liu et al 2021 besides the earlier onset of the south asian summer monsoon may be one important reason for the significant increase of precipitation amount in may in region 1 zhang et al 2017 as mentioned above precipitation amount has decreased in the past two decades in region 2 but this decrease is not significant according to student s t test at the 10 significance level fig 7 changes in the annual cycle of precipitation in different phases indicate that the decrease in precipitation amount in region 2 is mainly caused by the decrease in rainfall in june and august fig 9a and b for the mechanism of the precipitation changes in regions 2 yue et al 2020 indicate that the monsoon precipitation change over the southern tp shows a decadal variation during 1979 2018 and the mean precipitation over the southern tp decreased from 1998 to 2009 and increased afterward they also argue that this decadal variation is associated with a large scale dipolar sea surface temperature pattern between the equatorial central pacific and the indo pacific warm pool the spatial distribution of the trend in the precipitation frequency is similar to that of the precipitation amount fig 7a and e precipitation days have been significantly increased in region 1 with a maximal value of more than 20 days per year per decade the decrease in precipitation days in region 2 is more evident than that in precipitation amount and the maximal value is also more than 20 days per year per decade fig 7e the changing patterns of the frequencies of rain snow and sleet are also similar to that of precipitation fig 7f h but the changing magnitudes of precipitation days are dominated by that of snowy days fig 7e h including the increase in region 1 and decrease in region 2 the absolute increase in precipitation days in region 1 mainly occurs in spring and autumn the increase in rainy days is concentrated in late spring and early autumn while the increase in snowy days is concentrated in early spring and late autumn fig 8c similarly the relative increase in the snowy days is larger than that in the rainy days fig 8d therefore precipitation days in region 1 have become more dispersed in the past two decades and the proportion of snowy days has been increased precipitation days have decreased in region 2 almost throughout the year and this is especially true for snowy days in spring and autumn fig 9c and d the results above indicate that both rain and snow have been significantly changed in the past two decades precipitation of different intensities may affect the climate and ecosystem differently in the following part we divide rain and snow into four levels light moderate heavy and storm respectively according to the criteria of the cma in classifying rain and snow intensities the magnitudes of linear trends in rainfall decrease with the increase of intensity in most parts of the tp and the areas of significant trends are also limited to the central part of eastern tp fig 10 a d therefore the changes in rainfall over the tp in the last two decades are dominated by light and moderate rain it is worth noting that from the perspective of regional mean in region 1 the area with the largest trend the light moderate heavy and storm levels account for 32 36 30 and 2 of the total rainfall trend respectively similarly the magnitudes of linear trends of rainy days also decrease with the increase of intensity and compared with rainfall rate the changes in rainy days are more concentrated in light rain fig 10e h for the regional mean rain day in region 1 the light moderate heavy and storm levels account for 73 20 6 and 1 of the total increase respectively changes in the snowfall of different intensities all show similar spatial distributions with larger magnitudes located in the central part of eastern tp fig 11 a d the light moderate heavy and storm levels account for 40 30 22 and 8 of the total regional mean snowfall trend in region 1 respectively similar to rainy days changes in snowy days are dominated by light snow fig 11e h in region 1 the light moderate heavy and storm levels account for 78 16 5 and 1 of the total snowy day trend respectively in addition the decrease in precipitation days in region 2 is dominated by the decrease in light snow days figs 9 and 11 rain and snow of different intensity levels show similar changing patterns and the changes in the amount and frequency of rain snow are mainly contributed by the changes in light and moderate rain snow a previous study also indicates that the precipitation of different intensity levels generally increases in the tp under global warming ma et al 2015 changes in the snowy season have an important impact on the climate and water cycle system of the tp and even the whole of east asia the snowy days have been increased in region 1 and decreased in region 2 the following part illustrates whether the change in the length of the snowy season is the reason for the changes in the snowy days starting from 1st july of each year the day when the first snow event occurs and the daily precipitation amount greater than 0 1 mm is defined as the beginning of the snowy season the day when the last snow event occurs and the daily precipitation amount greater than 0 1 mm before the next 1st july is defined as the end of the snowy season the beginning end and duration of the snowy season over the tp are closely related to local altitude areas with higher altitudes often correspond to earlier beginning later end and longer duration of the snowy season fig 12 a c during the past two decades the start date of the snowy season has been delayed over most parts of the tp especially in the southwestern tp with a maximal value of more than 10 days per decade fig 12d the end date of the snowy season over the tp has been advanced over most parts of the tp especially in southeastern tp and the maximal value is also larger than 10 days per decade fig 12e as a result the duration of the snowy season over the tp has been getting shorter in the past two decades especially the southern tp fig 12f however it is worth mentioning that changes in the snowy season are not uniform and not significant over most parts of the tp the above results indicate that the increase in snowy days in most areas of the tp is caused by more frequent snow events in the relatively constant snowy season the decrease in snowy days in the southwestern tp may be partly caused by the shortening of the snowy season 4 summary and conclusion in this study the recently updated retrospective imerg v06 product calibrated by monthly rain gauge data is applied to investigate the changing characteristics of precipitation in different phases especially rain and snow over the tp during the past two decades the performance of the imerg product in capturing the characteristics of rain snow and sleet is firstly investigated by comparing it with the ground station data after confirming that the imerg product can be used as a reliable source of information to investigate precipitation over the tp the changes in precipitation in different phases are then investigated the main conclusions are summarized as follows 1 the spatial distributions of precipitation in different phases are similar decreasing from the southeast to the northwest of the tp compared with the station data the imerg product exhibits much more spatial features of precipitation over the tp the imerg product performs well in capturing the spatial distribution magnitudes and annual cycle of the amount and frequency of precipitation in different phases over the tp and the biases are within an acceptable range the bias of annual precipitation amount frequency averaged over the 90 stations is around 10 20 in 2010 2013 furthermore the imerg product shows higher skill in estimating rain than snow and performs better in the other three seasons than in winter for subregions the performance of the imerg product are comparable in the southern and northern parts of the tp 2 both the amount and frequency of the precipitation have increased in the past two decades over most parts of the tp with maximal values of 50 mm and 20 days per year per decade respectively in the central part of eastern tp region 1 the absolute increase in rainfall is larger than that in snowfall in region 1 but the relative increase is just the opposite as a result the precipitation amount in region 1 has been more dispersed in the past two decades 3 changing patterns of amount and frequency of rain snow and sleet are similar to those of precipitation changes in rainfall are the main contributors to the total changes in the amount of precipitation in the past two decades while changes in snowy days dominate the changes in precipitation days rain and snow of different intensity levels show similar changing patterns in addition increases in light and moderate rain snow are the main contributors to the regional mean increases of the amount about 70 and frequency more than 90 of rain snow in region 1 4 the snowy season has been shortened over most parts of the tp but this change is not uniform nor significant in most regions this indicates that the increase in snowy days in most areas of the tp is caused by more frequent snow events in the relatively constant snowy season the results in this study indicate that rain and snow have increased in most regions over the tp in the past two decades and this change is the continuation of the long term change in the past several decades according to the previous studies wang et al 2018 zhang et al 2017 both global warming and large scale circulations are contributed to the changes of precipitation over the tp and these contributions show obvious spatial and seasonal features the strengthened south asia summer monsoon the increased moisture transport from the indian ocean the decadal transition of amo and ipo and the large scale sea surface temperature anomaly may have affected the precipitation over the tp zhang et al 2017 li et al 2019 zhang et al 2019 yue et al 2020 liu et al 2021 previous studies mainly focus on precipitation rain snow and sleet changes not changes in rain or snow separately however causes behind changes in rain and snow may be different thus the different mechanisms for rain and snow at different intensity levels needs to be studied further in the future credit authorship contribution statement donghuan li data curation invastigation formal analysis writing original draft youcun qi formal analysis writing review editing deliang chen formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments major funding for this research was provided under strategic priority research program of chinese academy of sciences xda2006040101 national key research project the tibetan plateau land air coupling system change and its global climate effect no 91637211 and hundred talent program 
3650,the latest generation of satellite precipitation estimates integrated multi satellite retrievals for global precipitation measurement version 06 imerg v06 calibrated by monthly rain gauge data is applied to investigate the changing characteristics of precipitation in different phases rain snow and sleet over the tibetan plateau tp from 2001 to 2020 the performance of the imerg product in capturing the characteristics of the three precipitation phases is firstly evaluated against the ground based observation the results show that the imerg product performs well in capturing the spatial distribution magnitudes and annual cycle of the amount and frequency of precipitation in different phases the bias of annual precipitation amount frequency averaged in the 90 stations used in this study is approximately 10 20 comparatively the imerg product shows higher skill in estimating rain than snow and performs better in the other three seasons than in winter in addition the performance of the imerg product is comparable in the southern and northern tp both the annual amount and frequency of precipitation have increased in most parts of the tp in the last two decades with maximal values of 50 mm and 20 days per decade respectively occurring in the central part of eastern tp changes in the amount and frequency of precipitation are dominated by rain and snow respectively in the study period in addition light and moderate precipitation contribute approximately 70 and 90 to the increases of the regional mean precipitation amount and frequency respectively in the central part of eastern tp there are no significant and uniform changes in the snowy season during the last two decades therefore the increase in snowy days in most areas of the tp is caused by more frequent snow events in the fairly constant snowy season keywords imerg ground based observation rain snow tibetan plateau 1 introduction the tibetan plateau tp is the highest plateau in the world with an average elevation of over 4000 m a s l exerting a very important influence on the climate in asia and beyond duan and wu 2005 wu et al 2012 yao et al 2012 known as the asian water tower the tp and the adjacent mountain ranges are the sources of all the major rivers in asia and play an important role in the climate water resources and ecosystem of the downstream regions immerzeel et al 2010 immerzeel and bierkens 2012 precipitation is one of the most important and active components of the water cycle and has been changed under global warming in the past several decades ipcc 2013 the tp has experienced evident climate change since the 1960 s including the overall warming glacier shrinking and water cycle changing yao et al 2007 kang et al 2010 yang et al 2014 the changes of precipitation over the tp in the past several decades are spatially different and exhibit evident decadal variability xu et al 2007 the regional mean annual precipitation over the tp showed fluctuating increase in the last decades for the periods of 1961 2012 1971 2005 and 1971 2011 the increasing rates of annual precipitation averaged over the tp are 5 mm 12 mm and 7 5 mm per decade respectively wu et al 2007 gao et al 2014 kuang and jiao 2016 wang et al 2018 the precipitation increased in central and eastern and decreased in western parts of the tp during 1961 2001 xu et al 2008 the annual precipitation averaged over southeastern and northwestern tp increased by 16 8 mm and 4 mm per decade from 1979 to 2001 respectively you et al 2015 changes in precipitation over the tp also show seasonal features winter precipitation increased slightly in most parts of the tp from 1961 to 2012 while summer precipitation also increased in most parts of the tp but decreased insignificantly over southeastern tp wang et al 2018 spring and winter precipitation significantly increased in central and eastern parts of the tp from 1961 to 2007 you et al 2012 precipitation in may increased significantly by 13 36 per decade over southeastern tp during 1979 2014 zhang et al 2017 most existing studies on precipitation over the tp do not explicitly treat precipitation in different forms although solid snow and liquid rain precipitation have different effects on the water cycle and energy balance marks and dozier 1992 loth et al 1993 slater et al 2001 clark et al 2006 dai 2008 climate change will influence snowfall and further influence the snowmelt and snow cover barnett et al 2005 huang et al 2017 ground based observation is the most direct method to obtain precipitation phases however it is often insufficient or not accessible therefore many previous studies classified precipitation phases based on surface air temperature wet bulb temperature and other atmospheric conditions auer 1974 clark et al 2006 ding et al 2014 based on the temperature threshold the regional mean snowfall and snowfall rainfall ratio decreased by 6 mm and 5 per decade over the tp from 1961 to 2013 wang et al 2016 based on the classification method proposed by ding et al 2014 the snowfall trends during 1960 2014 show large spatial variation increasing in central and western and decreasing in eastern and northeastern tp deng et al 2017 based on temperature and relative humidity thresholds snowfall increased in eastern tp and decreased in western tp during 1961 2007 in the aphro dataset bai et al 2019 there are uncertainties in estimated snowfall changes over the tp in observational studies and these can stem from different datasets used different classification methods and complex climate regimes over the tp ground based observation is the most common tool to observe precipitation and the results above are mainly based on station data or the gridded datasets interpolated from station data however rain gauges are sparsely distributed over the tp tong et al 2014b and the spatial scale of precipitation over the tp is overall small chen et al 2016 satellite based precipitation products are of great value to precipitation estimates over mountainous regions owing to their fine spatial and temporal resolution tong et al 2014a the tropical rainfall measuring mission trmm was launched in 1997 kummerow et al 1998 and many satellite based precipitation retrieval algorithms have been generated based on the multiple satellite sensors such as global satellite mapping of precipitation gsmap kubota et al 2007 climate prediction center morphing method cmorph joyce et al 2004 and trmm multi satellite precipitation analysis tmpa huffman et al 2007 to further improve the capacity and accuracy of global precipitation observation the global precipitation measurement gpm mission was launched in 2014 hou et al 2014 by the national aeronautics and space administration nasa and the japan aerospace exploration agency jaxa the gpm mission is an international network of satellites that provide global observations of rain and snow the integrated multi satellite retrievals for gpm imerg huffman et al 2019 algorithm combines information from whatever constellation of satellites operating around earth at a given time to estimate precipitation over the majority of the earth s surface in other words the imerg algorithm uses the precipitation estimates collected in both the trmm and gpm eras to obtain a set of global precipitation records as long as possible previous studies show that the imerg product exhibits overall good performance in estimating precipitation in different regions around the world by comparing with the ground based observation pradhan et al 2022 the imerg product performs well in rainfall detection over the united arab emirates from 2010 to 2018 especially the moderate and intense rainfall alsumaiti et al 2020 it shows the potential to complement ground based observations over canada moazami and najafi 2021 and agrees well with gauge based precipitation over mainland china australia and europe navarro et al 2019 jiang and bauer gottwein 2019 islam et al 2020 in addition the imerg product can accurately capture the general pattern of tropical cyclone precipitation and provides a noticeable improvement in accuracy over its predecessor tmpa yuan et al 2021 however there are still biases in the imerg such as vacancy report of precipitation occurrence overestimation of light precipitation and underestimation of heavy precipitation navarro et al 2019 alsumaiti et al 2020 moazami and najafi 2021 yuan et al 2021 tang et al 2020 compared the performance of the imerg product with nine satellite and reanalysis precipitation products in china from 2000 to 2018 and indicate that imerg performs well at the daily and hourly scale they also investigated the snowfall product in the imerg product but did not evaluate it against observed rain and snow records on the ground it is worth noting that the snowfall retrieval algorithm in the imerg product depends on wet bulb temperature and needs to be evaluated before applying it in the investigation of snowfall changes in this study we first use the precipitation phase information rain snow and sleet obtained from the weather station observation network of china to evaluate whether the imerg product could be used to investigate the precipitation in different phases over the tp then changes of precipitation over the tp in different phases during the recent two decades are investigated we aim to address the following three questions 1 weather the imerg product can reasonably capture the characteristics of rain snow and sleet over the tp 2 how did precipitation in different phases change in the recent two decades 3 what are the seasonal characteristics of precipitation changes and how precipitation in different intensity levels contribute to the total precipitation changes the rest of this paper is organized as follows section 2 describes the data and methods used the main results are exhibited in section 3 the summary and conclusions are given in section 4 2 data and methods 2 1 imerg product the imerg final run product huffman et al 2019 is used in this study the latest version of imerg product currently is version 06 v06 containing a comprehensive estimate of rain and snow since june of 2000 the time resolution is 30 min and the spatial resolution is 0 1 two variables are used to investigate the characteristics of precipitation in different phases over the tp the first one is precipitation calibrated at a monthly scale based on gauge analysis and the other one is the probability of liquid precipitation pl pl is calculated based on wet bulb temperature using the method raised by sims and liu 2015 since this diagnostic is independent of the estimated precipitation the pl is reported for all grid boxes including those with missing or zero estimated precipitation in another word this variable can be applied to other global precipitation fields for estimating precipitation phase 2 2 rain gauge data from meteorological stations the 3 hourly rain snow and sleet record and daily precipitation amount from 90 national ground stations over the tp circles in fig 2 a during 2010 2013 are used the precipitation amount has undergone strict quality control by china meteorological administration cma including climatic range check internal consistency check spatiotemporal consistency check and man computer interaction control ren et al 2015 the precipitation phases are recorded based on the visual observation of professional weather recorders the precipitation phase data is derived from the meteorological information comprehensive analysis and processing system micaps li et al 2010 and quality controlled according to the following procedures 1 the weather phenomena are manually recorded before 2014 the full period of the data we collected is 2010 2015 and there are many missing values in 2014 and 2015 therefore the period of 2010 2013 is selected first 2 there are three variables including present weather past weather 1 and past weather 2 can provide the weather phenomena information however past weather 1 and past weather 2 were often not recorded therefore only present weather is used in this study and the time resolution is every 3 h 3 90 stations are selected according to the proportion of effective sample size of weather phenomena data the missing data is less than 1 every year in these selected stations we double check the accuracy of the weather phenomena data with the daily precipitation data the precipitation amount arithmetic mean of the 90 stations on days recorded as precipitation day in the weather phenomena dataset account for approximately 97 of the total precipitation amount in the daily precipitation dataset provided by cma in 2010 2013 therefore the weather phenomena dataset can reasonably provide the precipitation phase information since the ground based observation is point measurement of precipitation we take the approach of comparing the station data with the precipitation in the imerg product at the points nearest to the stations therefore 90 imerg pixels are selected if the values are missing in the station data the corresponding values in the imerg pixels will be masked to make the comparison more effectively in order to simplify the description the regional mean of a variable in a certain region represent the arithmetic mean of this variable in the stations over this region in the evaluation section 2 3 distinguish different phases of precipitation over tp in the station data the precipitation phase is divided into three phases rain sleet and snow the three hourly station data are firstly pre processed to provide daily values for precipitation amount the amounts of precipitation in different phases are summed up for each day for precipitation days days when precipitation amount larger than 0 1 mm if multiple phases of precipitation occur on a certain day then this day will be divided proportionally according to their frequencies take the 90 stations as a whole the total amount of rain sleet and snow account for 88 8 3 4 and 7 8 of the total precipitation amount respectively rain days sleet days and snow days account for 78 6 4 4 and 17 0 of the total precipitation days respectively in the imerg products pl is a variable used for distinguishing rain sleet and snow and the value of the probability ranges from 0 to 100 the larger the probability value is the more likely the precipitation is rain ordinarily liquid precipitation happens when wet bulb temperature tw higher than 0 c and pl is high in this condition frozen hydrometeors occur around or below tw less than 0 c pl varies from around 50 to very low the mixed category is likely to occur around the pl 50 mark although the frequency of sleet is much less than rain and snow the range of pl for sleet is large we try to find a value of pl denoted as plconst to make the proportions of the three precipitation phases provided by the imerg product consistent with those from ground based observations and the specific criteria should match with the followings if pl is larger than plconst precipitation is treated as rain if pl is smaller than 100 minus plconst 100 plconst precipitation is treated as snow otherwise precipitation is treated as sleet the total absolute bias is the sum of the absolute biases of the proportions of rain snow and sleet for example when we choose 80 as plconst the proportions of the amount of rain snow and sleet in the imerg product are 88 8 8 1 and 3 1 respectively in the ground stations the corresponding values are 88 8 7 8 and 3 4 respectively therefore the total absolute bias is 88 8 88 8 8 1 7 8 3 1 3 4 0 6 a represents the absolute value of a the total absolute bias of the amount of the three precipitation phases reaches the minimum when plconst is set to 82 fig 1a while the total absolute bias of the frequency of the three precipitation phases reaches the minimum when the value is set to 77 fig 1b combining the two values calculated based on precipitation amount and precipitation days 80 is determined as the threshold for distinguishing precipitation phases over the tp in another word if the probability of liquid precipitation in a certain half hour is larger than 80 precipitation that occurred in this half hour will be treated as rain if the probability of liquid precipitation in this half hour is smaller than 20 precipitation occurred in this half hour will be treated as snow otherwise precipitation occurred in this half hour will be treated as sleet 2 4 estimating skill of imerg product the performance of the imerg product is evaluated using the following metrics chen et al 2013 1 skill 1 r 2 s d r 1 sdr 2 r is the correlation between the precipitation rain snow in the 90 selected grids in the imerg product and the corresponding 90 ground stations sdr is the ratio of the standard deviations of precipitation rain snow in the 90 grids and the corresponding 90 stations therefore both spatial distribution and magnitude are considered in this formula the skill is higher when the value is closer to 1 0 2 5 definition of sub regions and different intensity levels of rain and snow in order further evaluate the performance of the imerg product in estimating precipitation in different phases over the tp we divide the tp into two parts the southern tibetan plateau stp and the northern tibetan plateau ntp by 32 n according to general climate regimes and the location of ground stations we divide rain and snow into four intensity levels light moderate heavy and storm respectively according to the criteria of the cma in classifying rain and snow intensities the detailed information is listed in table 1 3 results 3 1 evaluation of imerg precipitation product the precipitation amount in imerg product over the tp is first evaluated in the station data generally total annual rainfall decreases from the southeast to the northwest of the tp fig 2a with the values in the large center greater than 800 mm the total annual snowfall is much less than that of rainfall in almost all the 90 stations over the tp fig 2b and the averaged snow rain ratio in the 90 stations is 12 the eastern part of the central tp is an area with more snowfall and the values are close to 150 mm in some stations the spatial distribution of the amount of sleet is similar to that of snow but the magnitudes are much smaller fig 2c the imerg product shows much more spatial distribution characteristics of precipitation in different phases than the station data fig 2d f generally imerg performs well in capturing the spatial distributions of rain snow and sleet the precipitation amounts in different phases in imerg are a little more than those in the station data but within an acceptable range the annual cycle of regional mean precipitation in different phases shows that the peak of rainfall occurs in summer fig 3 a the amount of rain is larger than 100 mm per month in july the snowfall is mainly concentrated in boreal spring and autumn and the amount of snow is larger than that of rain in boreal winter months the amount of sleet is small and the peak value occurs in may fig 3a although rainfall in the imerg product is more than that in the station data in july and august annual cycles of precipitation in different phases are reasonably characterized fig 3b in order to quantitatively evaluate the performance of the imerg product we use formula 1 to obtain the skill scores the skill is higher when the value is closer to 1 0 in general imerg shows higher skill in estimating rain than snow fig 5 a the skill scores for the annual amount of precipitation rain and snow are 0 84 0 81 and 0 42 respectively the r and sdr of annual snowfall are 0 3 and 0 92 respectively which means that the magnitudes of snowfall in the imerg product and the station observation are comparable but the spatial distributions of snowfall in the 90 grids in imerg product and the corresponding 90 stations are relatively different for different seasons the skill scores for the amount of precipitation and rain are higher in boreal spring summer and autumn than in winter and the reason is that winter precipitation is primarily snow in all the 90 stations the regional mean bias mean bias in the stations over a certain region of precipitation amount is further investigated fig 6 a the regional averaged annual precipitation amount in the imerg product is comparable with that in the station observation and the absolute relative biases over the ntp and stp are 0 9 mm month and 5 0 mm month 2 8 and 10 2 respectively consistent with fig 3 there are wet biases in summer in both of the ntp and stp and the relative biases of rain in the two regions are comparable 15 5 and 14 1 absolute biases of snowfall in winter in the two regions are small within 2 mm month but the relative biases are obvious especially in the ntp 66 the precipitation days frequency in the imerg product are also evaluated the spatial distributions of the frequency of different precipitation phases are similar to the corresponding spatial distributions of the precipitation amount figs 2 and 4 there are more than 120 rainy days per year in some stations along the southeast of the tp in the station data fig 4a snowy days are much less frequent than rainy days throughout the tp and are concentrated in 10 to 40 days for most stations fig 4b the average snowy rainy days ratio in the 90 stations is 26 the imerg product also performs well in capturing the spatial distributions and magnitudes of the frequency of precipitation in different phases fig 4d f compared with the precipitation amount the bias of precipitation frequency is larger in the imerg product figs 2 and 4 one possible reason for this bias is that light precipitation days are more frequent in the satellite observation than in the ground observation the peak of rainy days averaged in the 90 stations also occurs in boreal summer months and there are more than 15 rainy days per month in july fig 3c the average snowy days in the 90 stations are approximately 3 days in march and april and sleet days are about 1 day in may fig 3c consistent with the results above precipitation in different phases occurs more frequently in the imerg product than in the station data but the bias is within an acceptable range and the annual cycle of the precipitation frequency matches well with that in the station data fig 3d the imerg product shows acceptable skill in estimating the frequency of precipitation and its two phases and the skill scores are comparable with those for the corresponding amount fig 5a and b the regional averaged annual precipitation frequency in the two subregions are both approximately 20 fig 6b compared with precipitation amount the regional mean biases of precipitation frequency are more uniform across different seasons and regions over the tp the imerg product reported more rainy days and snowy days in spring summer and autumn in both the ntp and stp than the station observation fig 6b conditions for winter are different the imerg product reported more snowy days in stp and less snowy days in ntp than the station observation and the relative biases are more than 60 and 60 in the two regions respectively it should be noted that the rainy days are negligible in winter and the sample size for the calculation of biases in rainy days in winter is small in general the imerg product performs well in capturing the climatic characteristics of precipitation in different phases over the tp and shows higher skill in rain estimate than in snow estimate the main precipitation type in winter is solid in the 90 stations over the tp and conceivably the imerg product performs better in the other three seasons than in winter the regional mean biases in the ntp and stp are comparable for rain and snow in different seasons it should be noted that the statistics and results shown above are all derived from the 90 stations and the corresponding imerg pixels the sparsely distributed ground stations especially in the northwestern tp and the complex terrain over the tp limits the representativeness of the results and more ground based observations are needed to assess the imerg product more comprehensively in the future research previous studies indicate that the performance of the imerg product varies in different regions and climate conditions chen et al 2018 alsumaiti et al 2020 pradhan et al 2022 it shows higher skill in lower latitude regions than in higher latitude regions chen and li 2016 additionally complex terrain may make it more difficult to estimate precipitation ma et al 2018 navarro et al 2019 wang et al 2019 as mentioned above the precipitation days are more reported in the imerg product than in the station observation and the possible reason is for this is the evaporation of light precipitation in the atmosphere wang et al 2019 despite that the imerg product shows better performance in capturing snowfall than other satellite based precipitation product sadeghi et al 2019 there are still room for improvement the possible reason is the limitation of passive microwave retrievals and infrared information at cold or snow covered background surfaces yong et al 2015 lu and yong 2018 in the next part of this study we investigate the changes in precipitation in different phases in the last two decades using the imerg product 3 2 changes of precipitation in different phases the annual precipitation amount has significantly increased in most areas of the tp in the last two decades with maximal values of over 50 mm per decade occurring in the central part of eastern tp the precipitation amount has decreased in the last two decades in some parts of southwest tp but this change is not significant fig 7 a previous studies indicate that annual precipitation amount has increased in most parts of the tp since the 1960 s wang et al 2018 but the changing pattern may be different during different study periods li et al 2010 tong et al 2014b zhang et al 2017 the changing patterns of the amounts of rain snow and sleet are similar to that of total precipitation and the changing magnitudes of precipitation are dominated by that of rain accounting for up to 80 over most parts of the tp fig 7a d considering that precipitation changes may be different among different months we select two regions to further investigate the changes in the annual cycle of precipitation over the tp as shown in fig 7a one region is in the central part of eastern tp region 1 solid box and the other one is in the southwestern tp region 2 dashed box regional mean linear trends of precipitation amount and frequency in the two selected regions are shown in figs 8 and 9 precipitation amount has increased almost throughout the year in region 1 in the last two decades rainfall is the main contributor to the increase in precipitation amount in may to september while the increased precipitation in boreal spring and autumn is mainly contributed by the increase in snowfall fig 8a the absolute increase in the amount of rain in summer is larger than that of snow in spring and autumn however in terms of the relative change relative to the climatology during 2001 2020 the increase in the amount of snow is larger than that of rain fig 8b considering that in climatology precipitation amount peaks in summer and the regional mean rainfall is much more than snowfall in region 1 the precipitation amount in region 1 has been more dispersed in the past two decades and the proportion of snowfall has increased the overall warming in the past decades is one possible reason for the overall increase of the precipitation amount over the tp since the water vapor content in the atmosphere increases along with the increase of air temperature and then precipitation is expected to increase trenberth 2011 if other conditions remain the same in addition the summer precipitation over the tp has experienced an interdecadal transition in the late 1990s and the increase in precipitation over northern tp is the combined contribution of the positive phase of atlantic multi decadal oscillation amo and the negative phase of interdecadal pacific oscillation ipo liu et al 2021 besides the earlier onset of the south asian summer monsoon may be one important reason for the significant increase of precipitation amount in may in region 1 zhang et al 2017 as mentioned above precipitation amount has decreased in the past two decades in region 2 but this decrease is not significant according to student s t test at the 10 significance level fig 7 changes in the annual cycle of precipitation in different phases indicate that the decrease in precipitation amount in region 2 is mainly caused by the decrease in rainfall in june and august fig 9a and b for the mechanism of the precipitation changes in regions 2 yue et al 2020 indicate that the monsoon precipitation change over the southern tp shows a decadal variation during 1979 2018 and the mean precipitation over the southern tp decreased from 1998 to 2009 and increased afterward they also argue that this decadal variation is associated with a large scale dipolar sea surface temperature pattern between the equatorial central pacific and the indo pacific warm pool the spatial distribution of the trend in the precipitation frequency is similar to that of the precipitation amount fig 7a and e precipitation days have been significantly increased in region 1 with a maximal value of more than 20 days per year per decade the decrease in precipitation days in region 2 is more evident than that in precipitation amount and the maximal value is also more than 20 days per year per decade fig 7e the changing patterns of the frequencies of rain snow and sleet are also similar to that of precipitation fig 7f h but the changing magnitudes of precipitation days are dominated by that of snowy days fig 7e h including the increase in region 1 and decrease in region 2 the absolute increase in precipitation days in region 1 mainly occurs in spring and autumn the increase in rainy days is concentrated in late spring and early autumn while the increase in snowy days is concentrated in early spring and late autumn fig 8c similarly the relative increase in the snowy days is larger than that in the rainy days fig 8d therefore precipitation days in region 1 have become more dispersed in the past two decades and the proportion of snowy days has been increased precipitation days have decreased in region 2 almost throughout the year and this is especially true for snowy days in spring and autumn fig 9c and d the results above indicate that both rain and snow have been significantly changed in the past two decades precipitation of different intensities may affect the climate and ecosystem differently in the following part we divide rain and snow into four levels light moderate heavy and storm respectively according to the criteria of the cma in classifying rain and snow intensities the magnitudes of linear trends in rainfall decrease with the increase of intensity in most parts of the tp and the areas of significant trends are also limited to the central part of eastern tp fig 10 a d therefore the changes in rainfall over the tp in the last two decades are dominated by light and moderate rain it is worth noting that from the perspective of regional mean in region 1 the area with the largest trend the light moderate heavy and storm levels account for 32 36 30 and 2 of the total rainfall trend respectively similarly the magnitudes of linear trends of rainy days also decrease with the increase of intensity and compared with rainfall rate the changes in rainy days are more concentrated in light rain fig 10e h for the regional mean rain day in region 1 the light moderate heavy and storm levels account for 73 20 6 and 1 of the total increase respectively changes in the snowfall of different intensities all show similar spatial distributions with larger magnitudes located in the central part of eastern tp fig 11 a d the light moderate heavy and storm levels account for 40 30 22 and 8 of the total regional mean snowfall trend in region 1 respectively similar to rainy days changes in snowy days are dominated by light snow fig 11e h in region 1 the light moderate heavy and storm levels account for 78 16 5 and 1 of the total snowy day trend respectively in addition the decrease in precipitation days in region 2 is dominated by the decrease in light snow days figs 9 and 11 rain and snow of different intensity levels show similar changing patterns and the changes in the amount and frequency of rain snow are mainly contributed by the changes in light and moderate rain snow a previous study also indicates that the precipitation of different intensity levels generally increases in the tp under global warming ma et al 2015 changes in the snowy season have an important impact on the climate and water cycle system of the tp and even the whole of east asia the snowy days have been increased in region 1 and decreased in region 2 the following part illustrates whether the change in the length of the snowy season is the reason for the changes in the snowy days starting from 1st july of each year the day when the first snow event occurs and the daily precipitation amount greater than 0 1 mm is defined as the beginning of the snowy season the day when the last snow event occurs and the daily precipitation amount greater than 0 1 mm before the next 1st july is defined as the end of the snowy season the beginning end and duration of the snowy season over the tp are closely related to local altitude areas with higher altitudes often correspond to earlier beginning later end and longer duration of the snowy season fig 12 a c during the past two decades the start date of the snowy season has been delayed over most parts of the tp especially in the southwestern tp with a maximal value of more than 10 days per decade fig 12d the end date of the snowy season over the tp has been advanced over most parts of the tp especially in southeastern tp and the maximal value is also larger than 10 days per decade fig 12e as a result the duration of the snowy season over the tp has been getting shorter in the past two decades especially the southern tp fig 12f however it is worth mentioning that changes in the snowy season are not uniform and not significant over most parts of the tp the above results indicate that the increase in snowy days in most areas of the tp is caused by more frequent snow events in the relatively constant snowy season the decrease in snowy days in the southwestern tp may be partly caused by the shortening of the snowy season 4 summary and conclusion in this study the recently updated retrospective imerg v06 product calibrated by monthly rain gauge data is applied to investigate the changing characteristics of precipitation in different phases especially rain and snow over the tp during the past two decades the performance of the imerg product in capturing the characteristics of rain snow and sleet is firstly investigated by comparing it with the ground station data after confirming that the imerg product can be used as a reliable source of information to investigate precipitation over the tp the changes in precipitation in different phases are then investigated the main conclusions are summarized as follows 1 the spatial distributions of precipitation in different phases are similar decreasing from the southeast to the northwest of the tp compared with the station data the imerg product exhibits much more spatial features of precipitation over the tp the imerg product performs well in capturing the spatial distribution magnitudes and annual cycle of the amount and frequency of precipitation in different phases over the tp and the biases are within an acceptable range the bias of annual precipitation amount frequency averaged over the 90 stations is around 10 20 in 2010 2013 furthermore the imerg product shows higher skill in estimating rain than snow and performs better in the other three seasons than in winter for subregions the performance of the imerg product are comparable in the southern and northern parts of the tp 2 both the amount and frequency of the precipitation have increased in the past two decades over most parts of the tp with maximal values of 50 mm and 20 days per year per decade respectively in the central part of eastern tp region 1 the absolute increase in rainfall is larger than that in snowfall in region 1 but the relative increase is just the opposite as a result the precipitation amount in region 1 has been more dispersed in the past two decades 3 changing patterns of amount and frequency of rain snow and sleet are similar to those of precipitation changes in rainfall are the main contributors to the total changes in the amount of precipitation in the past two decades while changes in snowy days dominate the changes in precipitation days rain and snow of different intensity levels show similar changing patterns in addition increases in light and moderate rain snow are the main contributors to the regional mean increases of the amount about 70 and frequency more than 90 of rain snow in region 1 4 the snowy season has been shortened over most parts of the tp but this change is not uniform nor significant in most regions this indicates that the increase in snowy days in most areas of the tp is caused by more frequent snow events in the relatively constant snowy season the results in this study indicate that rain and snow have increased in most regions over the tp in the past two decades and this change is the continuation of the long term change in the past several decades according to the previous studies wang et al 2018 zhang et al 2017 both global warming and large scale circulations are contributed to the changes of precipitation over the tp and these contributions show obvious spatial and seasonal features the strengthened south asia summer monsoon the increased moisture transport from the indian ocean the decadal transition of amo and ipo and the large scale sea surface temperature anomaly may have affected the precipitation over the tp zhang et al 2017 li et al 2019 zhang et al 2019 yue et al 2020 liu et al 2021 previous studies mainly focus on precipitation rain snow and sleet changes not changes in rain or snow separately however causes behind changes in rain and snow may be different thus the different mechanisms for rain and snow at different intensity levels needs to be studied further in the future credit authorship contribution statement donghuan li data curation invastigation formal analysis writing original draft youcun qi formal analysis writing review editing deliang chen formal analysis writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments major funding for this research was provided under strategic priority research program of chinese academy of sciences xda2006040101 national key research project the tibetan plateau land air coupling system change and its global climate effect no 91637211 and hundred talent program 
3651,groundwater models are critical for simulating subsurface hydrological processes and guiding informed policy making for groundwater management however the widely applied groundwater models typically use regular shaped grids to discretize aquifer systems and require that the directions of the grid edges are aligned with the hydraulic conductivity tensor such rigorous requirements for spatial discretization have constrained the models application in aquifer systems with anisotropic hydrogeological characteristics to address such limitations we develop an improved groundwater flow model based on the multipoint flux approximation mpfa method in this study the new model allows us to use arbitrary shaped polygon grids to discretize aquifer systems and relaxes the rigorous requirement of the alliance between polygon edges and hydraulic conductivity tensor the functionality and performance of the new model are demonstrated by comparing the output between our model modflow and analytical solution in four case studies with various hydrogeological conditions in a real world watershed with complex shaped boundaries our model outperforms the conventional groundwater model in boundaries the modeling results show that our model can yield accurate simulation of subsurface hydrological processes in aquifer systems with complex shaped boundaries furthermore our model can provide a more flexible discretization solution to couple surface water and groundwater model in integrated hydrological model development keywords groundwater flow model arbitrary polygon grids control volume scheme multipoint flux approximation modflow confined and unconfined aquifers 1 introduction groundwater is critical for agricultural municipal and industrial water use and plays a significant role in the hydrological cycle in many river basins across the globe velis et al 2017 developing computational tractable robust groundwater flow models is essential for understanding hydrological processes in the groundwater system guiding informed policy design for groundwater management to date various numerical groundwater models have been developed to simulate the groundwater flow such as modflow developed by u s geological survey harbaugh 2005 mike she developed by danish hydraulic institute dhi group ma et al 2016 3dfemwater developed by yeh and ward lin et al 1997 and feflow introduced by institute for water resources planning and systems research wasy trefry and muffels 2007 the current groundwater models usually apply numerical methods for solving the groundwater governing equation the finite difference method fdm and finite element method fem are among the most widely used numerical methods for groundwater simulation zhu et al 2012 fdm is not flexible to arbitrary boundary geometries and may lose accuracy when predicting hydraulic heads in the vicinity of irregular boundaries spitz et al 2001 mehl and hill 2004 gao et al 2019 the new version of modflow based on fdm modflow usg can be applied to arbitrary polygon grids panday et al 2013 however modflow usg cannot be used in a horizontal anisotropic medium when arbitrary polygon grids are used though fem has better mesh adaptability for representing complex boundaries than fdm it is notorious for its mass imbalance at the local level di giammarco et al 1996 and is difficult to be applied to the arbitrary polygon grids the finite volume method fvm is one of the best algorithms in the sense of easily fitting to irregular geometric boundaries while preserving the mass balance well erduran et al 2005 loudyi et al 2007 gao et al 2021 groundwater models usually encounter complex boundaries especially in the study of basin groundwater thus it is necessary to develop a groundwater numerical model that is flexible and adaptable to complex boundaries in this study the groundwater model on arbitrary polygon grids is established by the multipoint flux approximation mpfa which is based on the fvm mpfa is a reservoir simulation technique established in reservoir simulations that is locally conservative and can handle general irregular grids on anisotropic heterogeneous domains traditional reservoir simulators allow nonorthogonal grids to be used in the model ponting 1989 but the discretization is only correct if the grid directions are aligned with the principal directions of the permeability tensor aavatsmark 2002 designed the mpfa method to give a correct discretization of the flow equations for general nonorthogonal grids as well as for general orientation of the principal directions of the permeability tensor the mpfa method can be applied to triangular grids younes et al 2013 younes et al 2014 quadrilateral grids aavatsmark et al 1996 edwards and rogers 1998 aavatsmark et al 1998 aavatsmark 2002 aavatsmark et al 2006 convergence and monotonicity for the numerical scheme based on mpfa have been analyzed klausen and russell 2004 aavatsmark et al 2007 klausen et al 2008 sheng and yuan 2012 younes et al 2013 the accuracy of mpfa has been proved aavatsmark et al 2007 automatic differentiation general purpose research simulator ad gprs has used mpfa as the kernel program developed by stanford and a powerful and flexible platform in reservoir models with fully unstructured grids zhou 2012 wong et al 2019 jin et al 2020 since the nature of reservoir simulation and groundwater simulation is fluid migration in geological media the problems faced are highly similar the mpfa method has been gradually applied to groundwater simulation in recent years klausen et al 2008 applied mpfa in saturated unsaturated groundwater simulation younes et al 2013 further applied the mpfa in saturated and unsaturated flow in heterogeneous porous media and developed an upwind mpfa scheme dotlic et al 2018 studied the application of the mpfa method in an anisotropic porous medium that includes wells there are two limitations in the application of mpfa to groundwater firstly the existing groundwater model based on mpfa is two dimensional secondly the mpfa models in groundwater are used in triangular grids and quadrilateral grids but no unstructured arbitrary polygon grids the application of mpfa in groundwater still needs to be studied in this paper we construct an improved numerical scheme for solving the governing equation of groundwater flow in confined and unconfined aquifers with the cell centered mpfa method the scheme has only the cell centered unknowns and is suitable for groundwater flow calculations in anisotropic confined and unconfined aquifers on arbitrary polygon grids the new groundwater model based on the scheme is verified in four test cases by comparing with water levels calculated using analytical solution and modflow 2005 which is widely used groundwater software the remainder of this paper is organized as follows section 2 describes the construction of the numerical scheme for the governing equation of groundwater flow in section 3 the performance of our improved model is demonstrated by four case studies that represent various types of groundwater systems section 4 discusses the potential of the model in hydrological simulation and future directions followed with conclusions in section 5 2 methods this section describes the numerical scheme for groundwater in confined and unconfined aquifers with arbitrary polygonal girds section 2 1 introduces the numerical scheme for the groundwater flow governing equation section 2 2 presents grid discretization for the numerical scheme section 2 3 introduces the flux expression derivation using mpfa with arbitrary polygonal grids needed in the numerical scheme section 2 4 introduces the boundary conditions and source sink terms in the proposed method finally the characteristics of the improved method are described in section 2 5 2 1 control volume scheme for governing equation according to harbaugh 2005 the governing equation for the groundwater flow in the confined aquifer can be represented by 1 s s h t k h q where ss is the specific storage k is the hydraulic conductivity tensor h is the hydraulic head and q is the source term the governing equation for the groundwater flow in the unconfined aquifer can be represented by boussinesq equation bear 1979 2 s y h t k h h h q where sy is the specific yield kh is the horizontal conductivity tensor h is the thickness of the saturated zone in the unconfined aquifer and q is the source term that includes vertical flow because boussinesq equation only accounts for the horizontal flow in this study the mpfa method is based on the cell centered control volume according to younes 2013 a control volume scheme for groundwater governing equation in the cell k can be expressed as 3 v s c d h k dt i 1 m f i v q where v is the volume of the control cell k sc is sy in unconfined aquifer and is ss in confined aquifer fi is the flux through the ith surface of the cell k and m is the surface number of the control cell a fully implicit scheme of eq 3 is used for time discretization 4 v s s h k j  t i 1 m f i  t v q v s s h k j 1 where t is the time step and j is the time level 2 2 grid discretization a numerical method to solve eq 4 requires the imposition of spatial discretization in this paper the aquifer is divided into layers in the vertical direction fig 1 a shows the layering scheme in plan view the same horizontal grid is used for all layers fig 1b shows the irregular polygon grid distribution in each layer the top and bottom cell faces are horizontal and side faces are vertical for each irregular polygon grid therefore the irregular polygon grid is prismatic in the vertical direction as shown in fig 1c 2 3 flux expressions the control volume scheme eq 4 involves computing the flux on the surface of grids the key to calculating the flux expressions on arbitrary polygonal grids is to obtain the hydraulic head gradient the feature of the gird is are prismatic which is introduced in section 2 2 in other words the grid is irregular in the horizontal direction and regular in the vertical direction thus the vertical gradient is calculated using the traditional two point method which is suitable for regular girds and the horizontal gradient is calculated using mpfa method which can be used in irregular grids in this paper the aquifer is generally stratified in most cases the hydraulic conductivity is simplified in this study the principal directions of hydraulic conductivity tensor k are specified in horizontal and vertical directions the conductivity tensor can be expressed by horizontal conductivity tensor kh and vertical conductivity tensor kv 5 k k h k v where kh is horizontal conductivity tensor which has 2 2 elements and kv is vertical conductivity tensor which has one element in the traditional model with regular shaped grids as shown in fig 2 a the gradient can be expressed by a two point flux stencil in this study the vertical gradient is expressed by 6 h v h k h k bot z k z k bot where hv is the vertical hydraulic head gradient between cell k and the grid underneath it cell 1 in fig 2a hk and h k bot are the hydraulic head values at the cell k and the grid underneath it zk and z k bot are the cell centered coordinate values of cells k and the grid underneath it in the z direction in this paper the horizontal head gradient is approximated by a multipoint flux expression called mpfa which can be used in arbitrary polygon grid cells the number of the cell hydraulic head in the gradient expression is depended on the grids the flux between cells k and 2 is expressed by the six cell heads in mpfa shown in fig 2b for simplicity a notation is introduced sheng and yuan 2012 as fig 3 shown o1 on are the cell centers t1 t n are the midpoints of cell edge and ap1 ap n are the edges through vertex a n is the number of cells around vertex a let h 1 h n h 1 h n be the cell centered unknowns cell edge unknowns at point o1 o n t1 t n let x 1 x n x 1 x n be the cell centered coordinate values cell edge coordinate values at point o1 o n t1 t n the subcell k is divided by the vertex a the center o k and the midpoint edges t k and t k 1 as shown in fig 3b fk 1and fk 2 are the fluxes through half edge at k and at k 1 in subcell k the subcell is a computational element in mpfa method in the subcell k fig 3b the hydraulic head is assumed to be linear hence it can be written as 7 h h k x k 1 x k h k 1 h k h h k x k x k h k h k where h h is the horizontal hydraulic head gradient the above equations can be rewritten to 8 x k h h k h k 1 h k h k h k where xk is a matrix defined as 9 x k x k 1 x k t x k x k t then the determinant of xk is expressed as 10 w k det x k x k 1 x k t r x k x k t where r is the rotation matrix which is expressed as follows 11 r 0 1 1 0 the inverse of matrix xk is obtained 12 x k 1 1 w k r x k x k r x k 1 x k then the horizontal head gradient in subcell k can be expressed as follows 13 h h k 1 w k r x k 1 x k h k 1 h k r x k x k h k h k the fluxes fk 1and fk 2 can be expressed as 14 f k 1 1 2 h h k k h d k n k 1 1 2 w k d k r x k 1 x k k h n k 1 h k h k r x k x k k h n k 1 h k 1 h k a 11 h k h k a 12 h k 1 h k 15 f k 2 1 2 h h k k h d k 1 n k 2 1 2 w k d k 1 r x k 1 x k k h n k 2 h k h k r x k 1 x k k h n k 2 h k h k a 21 h k h k a 22 h k 1 h k where n k 1 and n k 2 are the outer normal vector on at k and at k 1 whose lengths are equal to those of at k and at k 1 dk is interface thickness between cell k and cell k 1 in the confined aquifer which is constant while dk is the effective thickness of the saturated zone at the interface in the unconfined aquifer which can be expressed as 16 d k 1 2 h k h k 1 1 2 h k b k h k 1 b k 1 where bk is the bottom elevation of cell k in eq 14 and eq 15 a 11 a 12 a 21 and a 22 are represented as 17 a 11 1 2 w k d k r x k 1 x k k h n k 1 a 12 1 2 w k d k r x k x k k h n k 1 a 21 1 2 w k d k 1 r x k 1 x k k h n k 2 a 22 1 2 w k d k 1 r x k x k k h n k 2 using the continuity of flux on at k 18 f k 1 f k 1 2 0 substituting eq 14 and eq 15 into eq 18 we obtain 19 a 11 k h k h k a 12 k h k 1 h k a 21 k 1 h k 1 h k 1 a 22 k 1 h k h k 1 0 eq 19 can be applied to all edges that pass vertex a so there are a total of n conservation equations these n conservation equations can be written as the following matrix form 20 m h u h where h h 1 h n t h h 1 h n t m m ij n n u u ij n n the non zero elements in m and u are given as follows 21 m k k a 11 k a 22 k 1 m k k 1 a 12 k m k k 1 a 21 k 1 u k k a 11 k a 12 k u k k 1 a 21 k 1 a 22 k 1 then the hydraulic head on the half edges can be represented by that at the center of the cell as follows 22 h m 1 u h substituting eq 22 into eq 13 the horizontal hydraulic head gradient can be expressed 23 h h k 1 w k r x k 1 x k m 1 u h k h k r x k x k m 1 u h k 1 h k where m 1 u h is a column matrix m 1 u h k is the kth element in m 1 u h acording to eq 6 and eq 23 the horizontal and vertical hydraulic head gradient can be expressed and the flux can be calcelted based on the hydraulic head gradient the flux through the bottom surface of cell k can be calculated as 24 f bot k v h k h k bot z k z k bot s bot the flux through the top surface of k can be also obtained in this manner the fluxes through the lateral surface at k and at k 1 in fig 3b fk 1 and fk 2 can be expressed as 25 f k 1 1 2 k h 1 w k r x k 1 x k m 1 u h k h k r x k x k m 1 u h k 1 h k d k n k 1 f k 1 2 1 2 1 w k r x k 1 x k m 1 u h k h k r x k x k m 1 u h k 1 h k k h d k 1 n k 2 in the unconfined aquifer dk and dk 1 calculated by eq 16 lead to the fluxes being nonlinear to the hydraulic head in eq 25 according to eq 25 the fluxes through each lateral surface of cell k can be calculated by looping through each vertex of cell k substituting all the fluxes into eq 4 the final numerical scheme where the unknown variable only contains the hydraulic head of the cell center is formed and is expressed in matrix form as 26 ah b where a is the global matrix h is the vector of hydraulic heads in cell centers and b is the right hand side vector for unconfined cases eq 26 is nonlinear whereby the global matrix is the function of hydraulic head the hydraulic heads in cell centers are solved using an iterative newton raphson solution approach which can be applied to solve a system of nonlinear equations 2 4 boundary conditions and source terms in our model the common boundary conditions dirichlet and neumann are considered we set ap k and ap k 1 are boundaries in fig 3b for the dirichlet boundary condition the known head can be assigned on the midpoint boundary edge i e h k and h k 1 in fig 3b and the flux through boundary edges can be calculated using section 2 4 for the neumann boundary condition the known flux can be assigned on ap k and ap k 1 directly our model can assign the known heads or flux on the exact boundary the common sources term i e pumping well recharge and river are in our model the well and recharge can be regarded as part of q in eq 1 and assemble the part of the right term of the final matrix equation b in eq 26 according to the numerical scheme the calculation of flow between the river and the groundwater in our model refers to modflow harbaugh 2005 the river is divided into different reaches by gird cells and each reach is completely contained in a single cell the flow between the river and the groundwater system in cell p is given by 27 q r p c r p l p h r p h p h p b r c r p l p h r p b r p h p b r where qrp is the flow rate and positive for flow from the river to the aquifer crp is the hydraulic conductance of the river aquifer interconnection for unit length lp is the length of the river in the cell p hrp is water level stage in the river hp is the groundwater head in the cell p and br is the elevation of the bottom of sediments when the river water level hrp is higher than the hydraulic head of cell p the flow between the river and the aquifer is calculated by the head and water level of cell p thus the flow is implicitly connected with a and b of eq 26 after assembling the final matrix equation when the river water level is lower the flow is only included in the b of eq 26 2 5 characteristics of the numerical scheme the new numerical scheme is easy to solve for the different number of edges around a vertex fig 3a and does not make specific requirements for the number of grid cell edges which is different from the traditional model the numerical scheme algorithm can be used on arbitrary polygon grid cells the new scheme has greater flexibility on the grid discretization than the traditional model such as modflow the scheme is suitable for a model with complex shaped boundaries in the derivation of the numerical scheme our model does not make specific requirements for the angle between the principal direction of the hydraulic conductivity tensor and the coordinate axis the angle can be set as any value in our model while the coordinate axis directions must be aligned with the principal directions of the hydraulic conductivity tensor in modflow in addition the new version of modflow modflow usg can be applied to arbitrary polygon grids panday et al 2013 however modflow usg cannot be used in a horizontal anisotropic medium when arbitrary polygon grids are used our model can use arbitrary polygon grids in a horizontal anisotropic medium thus our model is convenient for application in the anisotropic medium in this new method when calculating the gradient of the cell the hydraulic gradient of cell grid is calculated by dividing it into several subcells whose number is equal to that of grid vertexes while the gradient of a grid cell is not divided in the traditional model the hydraulic gradient of each subcell would use different cell hydraulic heads to calculate in the new method an edge flux is divided into two half edges and calculated by the two subcells hydraulic gradient which is equivalent to the refined grid thus the new scheme makes better use of grid information than the traditional method 3 case studies to assess the performance of the proposed groundwater flow model we apply the model to four case study sites including three synthetic aquifer systems and one real world aquifer system with various hydrogeological conditions first the model is applied to three synthetic cases including an unconfined aquifer section 3 1 a confined aquifer section 3 2 and a multi layer aquifer system including the unconfined and confined aquifers section 3 3 respectively then the model is applied to the maozhou river basin in china to evaluate its performance in a real world river basin section 3 4 the results of the proposed model are compared with analytic solution and modflow 2005 which is widely used software 3 1 case 1 steady state flow in an unconfined aquifer the performance of our model is firstly demonstrated in an unconfined aquifer the size of the unconfined aquifer is set as 150 m length 100 m width and 40 m thickness the bottom of the layer is a horizontal datum the left side center of the aquifer is set as the origin of a cartesian coordinate system the left and right sides x 0 m and x 150 m of the layer are set as constant heads and the values are 39 m and 36 m respectively fig 4 the other sides are no flow fig 4 the recharge rate wr is 0 1 m d in the aquifer the hydraulic conductivity is isotropic and the value is 5 m2 d according to bear 1979 the steady state head is given by 28 h x h 1 2 h 2 2 h 1 2 l x w r k l x x 2 where h 1 is the hydraulic head on the left side which is 39 m in this case h 2 is the hydraulic head on the right side which is 36 m in this case l is the distance from the boundary to the origin which is 150 m in this case two mesh systems a regular grid fig 4a and an irregular grid with arbitrary shaped polygon fig 4b are used for spatial discretization respectively the regular grid number is 3750 each regular grid size is 2 m 2 m in the horizontal direction the arbitrary polygon grids are derived from voronoi diagrams which are generated based on the random points in the study domain the arbitrary polygon grid number is 3750 which is the same as regular girds the number of arbitrary polygon sides ranges from 3 to 11 in this case three groundwater flow models are built the first model is built using our proposed model with regular grids to discretize the domain the second model is established by our proposed model with arbitrary polygons the third model is set as the baseline model built using modflow 2005 with regular grids which are the same as the girds of the first model the hydraulic heads are calculated using three models in the steady state the results simulated by the proposed models are compared with those of modflw and the analytic solution the water table contours are shown in fig 5 the water table contours of the proposed models the first and second models accord well with those from the analytic solution indicating the proposed model have good accuracy in the unconfined aquifer the proposed model can more accurately represent contours of water table than modflow which is because the known head can not be assigned on the exact boundary and has to be assigned at the cell center near the boundary in modflow which causes lower water tables in the study domain in this case the proposed model can assign the known head on the exact boundary and not cause the boundary effect fig 6 compares water levels calculated by the proposed model and modflow with the analytical solution the ordinate of a point represents the hydraulic head simulated using the numerical model in the center of each cell while the abscissa of the point is the hydraulic head of the analytical solution in the corresponding position in fig 6 as shown in fig 6 hydraulic heads simulated using the proposed model in each regular grid fig 6a the proposed model in each irregular grid fig 6b and modflow in each regular grid fig 6c are compared with hydraulic heads of analytical solution in the corresponding position the points of the proposed model are near the diagonal in fig 6a and b which indicates that the proposed model is accurate the mean error me and the root mean square error rmse between water levels calculated by the numerical model and analytical solution are shown in fig 6 all the mes and rmses of the proposed model are small which also indicates that the proposed model has good accuracy the simulation times for our model with regular grids our model with irregular grids and modflow are 6 8 s 8 2 s and 0 1 s respectively the simulation time of the proposed model with irregular grids is longer than that of the proposed model with regular grids which indicates complicated grid will increase simulation time the proposed model consumed more simulation time than modflow the simulation time mainly includes assembling the global matrix and solving the global matrix equation the time to assemble the global matrix accounts for more than 75 of the simulation time therefore the slow assembly is the main reason for the long simulation time when assembling the global matrix each vertex needs to be looped which takes much time in order to improve the computing speed the algorithm of our model needs to be further optimized and parallel computing needs to be developed in the future 3 2 case 2 transient flow in a confined aquifer the performance of our model is demonstrated in an anisotropic confined aquifer with a size of 2000 m length 2000 m width and 40 m thickness respectively the bottom of the layer is a horizontal datum the center of the aquifer is set as the origin of a cartesian coordinate system the boundaries of the aquifers have a constant hydrological head of 60 m fig 7 a pumping well with a rate of 50 m3 d is located at 0 0 m the initial head is set as 60 m the hydraulic conductivity of this aquifer is anisotropic the principal directions of the anisotropic hydraulic conductivity tensor are aligned with coordinate axes x axis and y axis the components of the hydraulic conductivity in principal directions kx and ky are 0 5 and 0 1 m d respectively the specific storage ss is 0 0001 m 1 according to papadopulos 1965 the drawdown s is given by 29 s x y t q w 4  t x t y 0 5 w u xy where tx and t y are components of transmissivity in principal directions which are 20 and 4 m3 d qw is pumping rate which is 50 m3 d w u is the well function defined as 30 w u u 1  e  d  and uxy is defined as 31 u xy s s 4 t t x y 2 t y x 2 t x t y two mesh systems a regular grid fig 7a and an irregular grid with arbitrary shaped polygon fig 7b are used for spatial discretization the densities of gird cells are variable in the two mesh systems the gird density near the well is finer than that in places far away from the well the regular grid number is 13225 the arbitrary polygon grid number is 13 225 which is the same as regular girds the number of arbitrary polygon sides ranges from 3 to 12 it can be seen from fig 7 that the proposed model has better performance in local refinement than modflow three groundwater flow models for the case study site are built using the proposed model and modflow the three models are our proposed model with regular grids the first model our proposed model with arbitrary polygons the second model and modflow 2005 with regular grids the third model three observation wells are selected in the layer fig 7 the 5 day groundwater flow process is simulated using the three models and the time step for model simulation is set as 0 2 day the water level contours around the pumping well calculated by three models and analytical solution at 3 days are shown in fig 8 the water level contours of the proposed models are in good agreement with those of modflow and analytical solution which indicates the proposed method is accurate in confined aquifers fig 9 shows the comparison of water levels calculated by the proposed model and modflow with those obtained by analytical solution at 5 days hydraulic heads simulated using the proposed model in each regular grid fig 9a those simulated using the proposed model in each irregular grid fig 9b and those simulated using modflow in each regular grid fig 9c are compared with analytical solutions in the corresponding position the points of the proposed model are near the diagonal fig 9a and b which indicates that the proposed model is accurate the mes and rmses between water levels calculated by the numerical model and analytical solution are shown in fig 9 all the mes and rmses of the proposed model are small indicating that the proposed model has good accuracy fig 10 shows the water level change process calculated by the proposed model modflow and analytical solution at the three observation wells the groundwater levels of three observation wells calculated by the three numerical models and the analytical solution are consistent with each other in general at different simulation times fig 10 also shows that the water level changes have similar laws in the three observation wells the water levels of observation wells gradually decrease which is because of pumping the flows through the surface of cells including observation wells are calculated since the flows through the surfaces of grids are directly related to the shape of grid the flows simulated by models with the same grid are compared to avoid the influence of the grid shape fig 11 shows the comparison of flows simulated by the proposed model modflow and analytical solution the flows calculated by the proposed model with regular grids are consistent with those of modflow and analytical solution which indicates the proposed model is accurate in this case the water budget is analyzed to check the accuracy of the proposed model the outflow of water only includes the pumped out from the well the outflow rate is 50 m3 d which is constant the inflow includes water storage release and water from constant head cells the inflows calculated by the proposed model with regular grids and irregular grids are almost equal to outflow from 0 to 5 days the max difference is less than 0 0001 m3 d which also indicates the proposed model is accurate in case 2 the average simulation times of per time step for our model with regular grids our model with irregular grids and modflow are 38 4 s 45 7 s and 0 01 s respectively 3 3 case 3 multi layer unconfined and confined aquifers while the previous sections have validated our model in the unconfined section 3 1 and confined aquifer section 3 2 this section uses a three layer anisotropic aquifer system including both unconfined and confined aquifers for model demonstration the first layer is an unconfined aquifer and the other layers are confined aquifers the size of each layer aquifer is set as 150 m length 100 m width 20 m thickness which is the same as that of case 1 in the horizontal direction the bottom of the first layer is a horizontal datum the center of the aquifer in the horizontal direction is set as the origin of x and y axises the recharge rate is 0 05 m d in the first layer there is a multi layer pumping well at x 0 y 1 m in the second and third layers the well pumping rates from the second and third aquifer are 500 and 100 m3 d respectively the short sides x 0 m and x 150 m of the three layers have a constant hydrological head of 18 m and the other boundaries have no flow the initial head is set as 18 m the principal directions of the anisotropic hydraulic conductivity tensor are aligned with coordinate axes x axis y axis and z axis the components of hydraulic conductivity in principal directions kx ky and kv specific yield sy and specific storage ss are listed in table 1 two mesh systems are the same as those in case1 fig 4 three groundwater flow models for the case study site are built like case 1 proposed model with a regular grid proposed model with an irregular grid and modflow with a regular grid three observation wells are selected at x 0 y 25 m x 37 y 25 m and x 37 y 0 m in each layer the 10 day groundwater flow process is simulated using the three models with a time step size of 0 1 day the water levels contours simulated by three models in three aquifer layers at 1 day and 8 days are shown in fig 12 the water level contours of the proposed models the first and second models are in good agreement with those from the modflow model in general which indicates the proposed model is accurate the simulated results of the proposed model with regular grids and modflow model are almost the same there is a deviation of water levels between the proposed models with irregular grids and the modflow model in fig 12 although the deviation is small which indicates this deviation is due to the grid difference fig 13 shows the varying process of water levels simulated by the proposed model and modflow at three observation wells the groundwater levels calculated by the three models are consistent with each other in general there is a deviation between the proposed models with irregular grids and modflow model which is consistent with the results in fig 12 from fig 13 it can be seen that the water level changes have similar laws in the three observation wells the water level of the first layer is the highest among the three layers and the third layer is the lowest which indicates that the first layer supplies the second layer and the third layer is supplied by the second layer the water level of the first layer gradually rises and tends to be stable over time because of recharge the water levels of the second and third layers drop first then rise and stabilize the water level drop is due to the extraction of the pumping well and the rise is due to be recharged by the upper aquifer in the second and third layers fig 14 compares the flows through the surface of cells including observation wells in the first layer it can be seen from fig 14 that the flows calculated by the proposed model with regular grids are consistent with those of modflow which indicates the proposed model is accurate in case 3 the average simulation times of per time step for our model with regular grids our model with irregular grids and modflow are 104 5 s 123 8 s and 0 03 s respectively 3 4 case 4 unconfined and confined aquifers in a real world watershed finally we demonstrate our model performance in a real world case study site the maozhou river basin in china the maozhou river basin is located northwest of shenzhen city guangdong province china the study area is 359 8 km2 the subsurface was discretized with two layers the first layer is an unconfined aquifer and the second layer is a confined aquifer the top elevation of the first layer is the land surface derived from a digital elevation model dem the bases of the first and second model layers are set at elevations of 60 and 500 m respectively constant head boundary conditions are specified with a hydraulic head equal to zero in the western boundary of the maozhou river basin the other boundaries are set as no flux maozhou river has been represented in this case fig 15 the river stage has been derived by dem the value of conductance for unit length cr in eq 27 is set as 0 2 m2 d lancia et al 2019 the sketch of the case is shown in fig 15 the daily recharge rate is distributed as shown in fig 16 a the initial head is 0 m in this case the hydrogeological parameters of the model are conductivity in principal directions kx ky and kv specific yield s y and specific storage s s the horizontal hydraulic conductivity kx and ky is isotropic so kx is equal to ky the subarea of hydrological parameters of this case is shown in fig 16b and c hydrogeological parameters of the subarea are listed in table 2 in this case four grid division systems 526 arbitrary shaped polygon grids fig 15a 578 square grids fig 15b 6882 arbitrary shaped polygon grids fig 15c and 6906 square grids fig 15d are used for spatial discretization respectively the arbitrary polygonal grid in fig 15a is derived from the sub basins of the maozhou river basin which is necessary for swat swat is a computationally efficient simulator of hydrology and needs to divide the watershed into sub basins as spatial subdivision faramarzi et al 2009 the number of arbitrary polygon sides ranges from 3 to 10 in fig 15a the arbitrary polygonal grid in fig 15c is derived from voronoi diagrams which are generated based on the random points in the study domain the number of arbitrary polygon sides ranges from 3 to 11 in fig 15c five groundwater models of maozhou river basin are established with the proposed model and modflow the first model is established by the proposed model with 526 polygonal grids shown in fig 15a the second model is established by modflow with 578 square grids shown in fig 15b the third model is established by the proposed model with 6882 polygonal grids shown in fig 15c the fourth model is established by modflow with 6906 square grids shown in fig 15d the numbers of grids in the second model and fourth model are similar to those in the first model and third model respectively to reduce the impact of the number of grids in the comparison process the fifth model is as a reference model established using the modflow with fine square girds whose quantity is 42766 the quantity of the fifth model is much more than that of the other models the results of the fifth model are assumed to be accurate the 200 day groundwater flow process is simulated using the five models with a time step size of 0 5 days fig 17 shows the comparison of water level contours simulated by the proposed models and modflow models in two layers at 100 days in maozhou river basin the water level contours simulated by the proposed models accord well with those simulated by modflow models which indicates our model can simulate the groundwater flow in a real watershed with the increase of the number of grids the head contours simulated by our model the first and third models are closer to those simulated by modflow models the second and fourth model and the reference model the fifth model the comparison results also indicate that the irregular girds derived from sub basins needed in swat can simulate groundwater flow it can also be seen that the errors near the interface between the different recharge zone in fig 17a and b are higher than those in fig 17c and d the water tables near the interface between the different recharge zone change strongly thus more grids are needed near the interface than in other places to calculate the head accurately fig 18 shows the comparison of water levels calculated by the proposed models the first and third models and modflow models the second and fourth models with those obtained by the reference model the fifth model at 100 days the ordinate of a circle point represents the water level simulated using the proposed model in the center of each polygonal mesh while the abscissa of the point is the water level of the reference model in the corresponding position the ordinate of a star point represents the water level simulated using modflow models the second and fourth models in the center of a grid while the abscissa of the point is the water level of the reference model the fifth model in the corresponding position the water levels in each polygonal grid of the proposed models the first and third models and square grid of the modflow models the second and fourth models are compared with those of the reference model the fifth model in the corresponding position in fig 18a and c most of the circle points are near the diagonal which indicates that the proposed model is accurate in fig 18b and d the star points in the x axis represent these grids of modflow models the second and fourth models are located at the constant boundary the circle points do not deviate as much as the star points in the x axis which indicates the proposed model has a better performance than modflow in boundaries in fig 18a and c the circle points in the y axis represent the positions of these grids of the proposed models the first and third models are located at the boundary of the constant head in the reference model which indicates that the proposed model has better performance in boundaries than the reference model the me and rmse between water levels of the proposed models the first and third models and modflow models the second and fourth models and those of the reference model are shown in fig 18 the absolute of me and rmse of the first model are lower than those of the second model while the absolute of me and rmse of the third model are higher than those of the fourth model with the increase of the number of grids the performance of modflow becomes better than the proposed model in general the mes and rmses of the proposed model are small which also indicates that the proposed model is accurate in case 4 the average simulation times of per time step for our model with 526 and 6881 irregular grids and modflow with 578 and 6906 regular grids are 1 14 s 19 98 s 0 012 s and 0 014 s respectively 4 discussion the functionality and performance of the new model are demonstrated by comparing our model with modflow in four case studies with various hydrogeological conditions the water levels simulated by the proposed model are consistent with those simulated by modflow in all cases the comparison results show that in both confined and unconfined synthetic aquifer systems our model can well represent hydrological processes thus the proposed model can be applied to simulate groundwater in anisotropic confined and unconfined aquifers with arbitrary polygon grids in the 4 case studies two advantages of the model are presented the first is that the proposed model can simulate the groundwater flow on arbitrary polygon grids improving the flexibility of spatial discretization in case 2 our model shows a good function of local mesh refinement in the case of maozhou river basin with complex shaped boundaries our model outperforms the conventional groundwater model near boundaries our model has good flexibility of spatial discretization which addresses the limitations of traditional models such as modflow the second is that the proposed model avoids the boundary effect in the other cell center models the known boundary values can not be assigned on the exact boundary and have to be assigned at the cell center near the boundary in some cell center models i e modflow which caused boundary effect the proposed model can assign the known values to the exact boundary and not cause the boundary effect in case 1 the proposed model can more accurately represent the contours of water table than modflow this is because the proposed model does not have the boundary effect while modflow has the effect the grid inflexibility of the traditional models limits the development of groundwater surface water coupled models in some common coupled models such as swat mod bailey et al 2017 and gsflow markstrom et al 2008 the groundwater model and surface water model are modeled independently in this kind of coupled model the subdivision units of the surface water model are irregular polygons while those of the groundwater grid are trigonal or quadrilateral polygons that cannot match the surface water subdivision units the grid difference between the surface water model and the groundwater model increases modeling workload and application difficulty this new model can be coupled with the surface water model based on irregular polygon units such as the swat and prms in case 4 grids of our model are derived from sub basins that are needed in swat and the calculating results are in accord well with modflow in this way the surface water grid unit can be directly applied to the groundwater model reducing modelling workload aavatsmark proposed three mpfa method mpfa o mpfa l and mpfa u for reservoir simulation aavatsmark 2002 aavatsmark and eigestad 2006 aavatsmark et al 2008 mpfa o method was first proposed by aavatsmark the mpfa l and mpfa u are variants of mpfa o aavatsmark only gave the flux scheme on the quadrilateral grid or hexahedron in all the three mpfa methods our model is established based on the mpfa o and extends it to arbitrary polygonal grids to simulate groundwater flow we simplified the hydraulic conductivity tensor based on the characteristics of the layered distribution of the aquifer the conductivity tensor is expressed by horizontal conductivity tensor kh and vertical conductivity kv therefore the proposed model can not simulate the groundwater flow in the fully anisotropic aquifer in addition the calculation speed of the proposed model is slower than modflow the time to assemble the global matrix accounts for more than 75 of the simulation time therefore the slow solution speed is mainly caused by assembling the global matrix in the future the following three aspects need to be done firstly the model should be developed in a fully anisotropic aquifer secondly the solution algorithm needs to be further optimized and parallel computing needs to be introduced to improve the calculation speed then the model will be open source software in the future to better contribute to the hydrological modeling community 5 conclusions this study develops an improved numerical groundwater flow model using the mpfa method in confined and unconfined aquifers on arbitrary polygon grids the validity and performance of the new model are demonstrated with four test cases which include three synthetic cases unconfined aquifer confined aquifer and confined and unconfined aquifers and a real world river basin groundwater case solutions of the proposed model in all 4 cases have a good agreement with those of modflow in applications of the actual watershed the new model performs better than the traditional model in boundaries the four case studies show that our model has great potential to be applied to groundwater simulation in aquifers with complex boundaries in particular the flexibility of the discretization method embedded in our model makes it possible for fully coupling calculation of surface water groundwater interaction with sub basin as the numerical grids in a watershed credit authorship contribution statement yulong gao conceptualization methodology and writing erhu du writing shuping yi conceptualization writing funding acquisition and supervision yu han writing chunmiao zheng funding acquisition supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china nos 41877193 41931292 the start up funds for scientific research of high level talents in shenzhen no y01296126 the state environmental protection key laboratory of integrated surface water groundwater pollution control and the leading talents of guangdong province program awarded to chunmiao zheng no 2016lj06n469 the authors are grateful to editor huaming guo associated editor xusheng wang and the reviewers for their constructive comments and suggestions that significantly improve this study 
3651,groundwater models are critical for simulating subsurface hydrological processes and guiding informed policy making for groundwater management however the widely applied groundwater models typically use regular shaped grids to discretize aquifer systems and require that the directions of the grid edges are aligned with the hydraulic conductivity tensor such rigorous requirements for spatial discretization have constrained the models application in aquifer systems with anisotropic hydrogeological characteristics to address such limitations we develop an improved groundwater flow model based on the multipoint flux approximation mpfa method in this study the new model allows us to use arbitrary shaped polygon grids to discretize aquifer systems and relaxes the rigorous requirement of the alliance between polygon edges and hydraulic conductivity tensor the functionality and performance of the new model are demonstrated by comparing the output between our model modflow and analytical solution in four case studies with various hydrogeological conditions in a real world watershed with complex shaped boundaries our model outperforms the conventional groundwater model in boundaries the modeling results show that our model can yield accurate simulation of subsurface hydrological processes in aquifer systems with complex shaped boundaries furthermore our model can provide a more flexible discretization solution to couple surface water and groundwater model in integrated hydrological model development keywords groundwater flow model arbitrary polygon grids control volume scheme multipoint flux approximation modflow confined and unconfined aquifers 1 introduction groundwater is critical for agricultural municipal and industrial water use and plays a significant role in the hydrological cycle in many river basins across the globe velis et al 2017 developing computational tractable robust groundwater flow models is essential for understanding hydrological processes in the groundwater system guiding informed policy design for groundwater management to date various numerical groundwater models have been developed to simulate the groundwater flow such as modflow developed by u s geological survey harbaugh 2005 mike she developed by danish hydraulic institute dhi group ma et al 2016 3dfemwater developed by yeh and ward lin et al 1997 and feflow introduced by institute for water resources planning and systems research wasy trefry and muffels 2007 the current groundwater models usually apply numerical methods for solving the groundwater governing equation the finite difference method fdm and finite element method fem are among the most widely used numerical methods for groundwater simulation zhu et al 2012 fdm is not flexible to arbitrary boundary geometries and may lose accuracy when predicting hydraulic heads in the vicinity of irregular boundaries spitz et al 2001 mehl and hill 2004 gao et al 2019 the new version of modflow based on fdm modflow usg can be applied to arbitrary polygon grids panday et al 2013 however modflow usg cannot be used in a horizontal anisotropic medium when arbitrary polygon grids are used though fem has better mesh adaptability for representing complex boundaries than fdm it is notorious for its mass imbalance at the local level di giammarco et al 1996 and is difficult to be applied to the arbitrary polygon grids the finite volume method fvm is one of the best algorithms in the sense of easily fitting to irregular geometric boundaries while preserving the mass balance well erduran et al 2005 loudyi et al 2007 gao et al 2021 groundwater models usually encounter complex boundaries especially in the study of basin groundwater thus it is necessary to develop a groundwater numerical model that is flexible and adaptable to complex boundaries in this study the groundwater model on arbitrary polygon grids is established by the multipoint flux approximation mpfa which is based on the fvm mpfa is a reservoir simulation technique established in reservoir simulations that is locally conservative and can handle general irregular grids on anisotropic heterogeneous domains traditional reservoir simulators allow nonorthogonal grids to be used in the model ponting 1989 but the discretization is only correct if the grid directions are aligned with the principal directions of the permeability tensor aavatsmark 2002 designed the mpfa method to give a correct discretization of the flow equations for general nonorthogonal grids as well as for general orientation of the principal directions of the permeability tensor the mpfa method can be applied to triangular grids younes et al 2013 younes et al 2014 quadrilateral grids aavatsmark et al 1996 edwards and rogers 1998 aavatsmark et al 1998 aavatsmark 2002 aavatsmark et al 2006 convergence and monotonicity for the numerical scheme based on mpfa have been analyzed klausen and russell 2004 aavatsmark et al 2007 klausen et al 2008 sheng and yuan 2012 younes et al 2013 the accuracy of mpfa has been proved aavatsmark et al 2007 automatic differentiation general purpose research simulator ad gprs has used mpfa as the kernel program developed by stanford and a powerful and flexible platform in reservoir models with fully unstructured grids zhou 2012 wong et al 2019 jin et al 2020 since the nature of reservoir simulation and groundwater simulation is fluid migration in geological media the problems faced are highly similar the mpfa method has been gradually applied to groundwater simulation in recent years klausen et al 2008 applied mpfa in saturated unsaturated groundwater simulation younes et al 2013 further applied the mpfa in saturated and unsaturated flow in heterogeneous porous media and developed an upwind mpfa scheme dotlic et al 2018 studied the application of the mpfa method in an anisotropic porous medium that includes wells there are two limitations in the application of mpfa to groundwater firstly the existing groundwater model based on mpfa is two dimensional secondly the mpfa models in groundwater are used in triangular grids and quadrilateral grids but no unstructured arbitrary polygon grids the application of mpfa in groundwater still needs to be studied in this paper we construct an improved numerical scheme for solving the governing equation of groundwater flow in confined and unconfined aquifers with the cell centered mpfa method the scheme has only the cell centered unknowns and is suitable for groundwater flow calculations in anisotropic confined and unconfined aquifers on arbitrary polygon grids the new groundwater model based on the scheme is verified in four test cases by comparing with water levels calculated using analytical solution and modflow 2005 which is widely used groundwater software the remainder of this paper is organized as follows section 2 describes the construction of the numerical scheme for the governing equation of groundwater flow in section 3 the performance of our improved model is demonstrated by four case studies that represent various types of groundwater systems section 4 discusses the potential of the model in hydrological simulation and future directions followed with conclusions in section 5 2 methods this section describes the numerical scheme for groundwater in confined and unconfined aquifers with arbitrary polygonal girds section 2 1 introduces the numerical scheme for the groundwater flow governing equation section 2 2 presents grid discretization for the numerical scheme section 2 3 introduces the flux expression derivation using mpfa with arbitrary polygonal grids needed in the numerical scheme section 2 4 introduces the boundary conditions and source sink terms in the proposed method finally the characteristics of the improved method are described in section 2 5 2 1 control volume scheme for governing equation according to harbaugh 2005 the governing equation for the groundwater flow in the confined aquifer can be represented by 1 s s h t k h q where ss is the specific storage k is the hydraulic conductivity tensor h is the hydraulic head and q is the source term the governing equation for the groundwater flow in the unconfined aquifer can be represented by boussinesq equation bear 1979 2 s y h t k h h h q where sy is the specific yield kh is the horizontal conductivity tensor h is the thickness of the saturated zone in the unconfined aquifer and q is the source term that includes vertical flow because boussinesq equation only accounts for the horizontal flow in this study the mpfa method is based on the cell centered control volume according to younes 2013 a control volume scheme for groundwater governing equation in the cell k can be expressed as 3 v s c d h k dt i 1 m f i v q where v is the volume of the control cell k sc is sy in unconfined aquifer and is ss in confined aquifer fi is the flux through the ith surface of the cell k and m is the surface number of the control cell a fully implicit scheme of eq 3 is used for time discretization 4 v s s h k j  t i 1 m f i  t v q v s s h k j 1 where t is the time step and j is the time level 2 2 grid discretization a numerical method to solve eq 4 requires the imposition of spatial discretization in this paper the aquifer is divided into layers in the vertical direction fig 1 a shows the layering scheme in plan view the same horizontal grid is used for all layers fig 1b shows the irregular polygon grid distribution in each layer the top and bottom cell faces are horizontal and side faces are vertical for each irregular polygon grid therefore the irregular polygon grid is prismatic in the vertical direction as shown in fig 1c 2 3 flux expressions the control volume scheme eq 4 involves computing the flux on the surface of grids the key to calculating the flux expressions on arbitrary polygonal grids is to obtain the hydraulic head gradient the feature of the gird is are prismatic which is introduced in section 2 2 in other words the grid is irregular in the horizontal direction and regular in the vertical direction thus the vertical gradient is calculated using the traditional two point method which is suitable for regular girds and the horizontal gradient is calculated using mpfa method which can be used in irregular grids in this paper the aquifer is generally stratified in most cases the hydraulic conductivity is simplified in this study the principal directions of hydraulic conductivity tensor k are specified in horizontal and vertical directions the conductivity tensor can be expressed by horizontal conductivity tensor kh and vertical conductivity tensor kv 5 k k h k v where kh is horizontal conductivity tensor which has 2 2 elements and kv is vertical conductivity tensor which has one element in the traditional model with regular shaped grids as shown in fig 2 a the gradient can be expressed by a two point flux stencil in this study the vertical gradient is expressed by 6 h v h k h k bot z k z k bot where hv is the vertical hydraulic head gradient between cell k and the grid underneath it cell 1 in fig 2a hk and h k bot are the hydraulic head values at the cell k and the grid underneath it zk and z k bot are the cell centered coordinate values of cells k and the grid underneath it in the z direction in this paper the horizontal head gradient is approximated by a multipoint flux expression called mpfa which can be used in arbitrary polygon grid cells the number of the cell hydraulic head in the gradient expression is depended on the grids the flux between cells k and 2 is expressed by the six cell heads in mpfa shown in fig 2b for simplicity a notation is introduced sheng and yuan 2012 as fig 3 shown o1 on are the cell centers t1 t n are the midpoints of cell edge and ap1 ap n are the edges through vertex a n is the number of cells around vertex a let h 1 h n h 1 h n be the cell centered unknowns cell edge unknowns at point o1 o n t1 t n let x 1 x n x 1 x n be the cell centered coordinate values cell edge coordinate values at point o1 o n t1 t n the subcell k is divided by the vertex a the center o k and the midpoint edges t k and t k 1 as shown in fig 3b fk 1and fk 2 are the fluxes through half edge at k and at k 1 in subcell k the subcell is a computational element in mpfa method in the subcell k fig 3b the hydraulic head is assumed to be linear hence it can be written as 7 h h k x k 1 x k h k 1 h k h h k x k x k h k h k where h h is the horizontal hydraulic head gradient the above equations can be rewritten to 8 x k h h k h k 1 h k h k h k where xk is a matrix defined as 9 x k x k 1 x k t x k x k t then the determinant of xk is expressed as 10 w k det x k x k 1 x k t r x k x k t where r is the rotation matrix which is expressed as follows 11 r 0 1 1 0 the inverse of matrix xk is obtained 12 x k 1 1 w k r x k x k r x k 1 x k then the horizontal head gradient in subcell k can be expressed as follows 13 h h k 1 w k r x k 1 x k h k 1 h k r x k x k h k h k the fluxes fk 1and fk 2 can be expressed as 14 f k 1 1 2 h h k k h d k n k 1 1 2 w k d k r x k 1 x k k h n k 1 h k h k r x k x k k h n k 1 h k 1 h k a 11 h k h k a 12 h k 1 h k 15 f k 2 1 2 h h k k h d k 1 n k 2 1 2 w k d k 1 r x k 1 x k k h n k 2 h k h k r x k 1 x k k h n k 2 h k h k a 21 h k h k a 22 h k 1 h k where n k 1 and n k 2 are the outer normal vector on at k and at k 1 whose lengths are equal to those of at k and at k 1 dk is interface thickness between cell k and cell k 1 in the confined aquifer which is constant while dk is the effective thickness of the saturated zone at the interface in the unconfined aquifer which can be expressed as 16 d k 1 2 h k h k 1 1 2 h k b k h k 1 b k 1 where bk is the bottom elevation of cell k in eq 14 and eq 15 a 11 a 12 a 21 and a 22 are represented as 17 a 11 1 2 w k d k r x k 1 x k k h n k 1 a 12 1 2 w k d k r x k x k k h n k 1 a 21 1 2 w k d k 1 r x k 1 x k k h n k 2 a 22 1 2 w k d k 1 r x k x k k h n k 2 using the continuity of flux on at k 18 f k 1 f k 1 2 0 substituting eq 14 and eq 15 into eq 18 we obtain 19 a 11 k h k h k a 12 k h k 1 h k a 21 k 1 h k 1 h k 1 a 22 k 1 h k h k 1 0 eq 19 can be applied to all edges that pass vertex a so there are a total of n conservation equations these n conservation equations can be written as the following matrix form 20 m h u h where h h 1 h n t h h 1 h n t m m ij n n u u ij n n the non zero elements in m and u are given as follows 21 m k k a 11 k a 22 k 1 m k k 1 a 12 k m k k 1 a 21 k 1 u k k a 11 k a 12 k u k k 1 a 21 k 1 a 22 k 1 then the hydraulic head on the half edges can be represented by that at the center of the cell as follows 22 h m 1 u h substituting eq 22 into eq 13 the horizontal hydraulic head gradient can be expressed 23 h h k 1 w k r x k 1 x k m 1 u h k h k r x k x k m 1 u h k 1 h k where m 1 u h is a column matrix m 1 u h k is the kth element in m 1 u h acording to eq 6 and eq 23 the horizontal and vertical hydraulic head gradient can be expressed and the flux can be calcelted based on the hydraulic head gradient the flux through the bottom surface of cell k can be calculated as 24 f bot k v h k h k bot z k z k bot s bot the flux through the top surface of k can be also obtained in this manner the fluxes through the lateral surface at k and at k 1 in fig 3b fk 1 and fk 2 can be expressed as 25 f k 1 1 2 k h 1 w k r x k 1 x k m 1 u h k h k r x k x k m 1 u h k 1 h k d k n k 1 f k 1 2 1 2 1 w k r x k 1 x k m 1 u h k h k r x k x k m 1 u h k 1 h k k h d k 1 n k 2 in the unconfined aquifer dk and dk 1 calculated by eq 16 lead to the fluxes being nonlinear to the hydraulic head in eq 25 according to eq 25 the fluxes through each lateral surface of cell k can be calculated by looping through each vertex of cell k substituting all the fluxes into eq 4 the final numerical scheme where the unknown variable only contains the hydraulic head of the cell center is formed and is expressed in matrix form as 26 ah b where a is the global matrix h is the vector of hydraulic heads in cell centers and b is the right hand side vector for unconfined cases eq 26 is nonlinear whereby the global matrix is the function of hydraulic head the hydraulic heads in cell centers are solved using an iterative newton raphson solution approach which can be applied to solve a system of nonlinear equations 2 4 boundary conditions and source terms in our model the common boundary conditions dirichlet and neumann are considered we set ap k and ap k 1 are boundaries in fig 3b for the dirichlet boundary condition the known head can be assigned on the midpoint boundary edge i e h k and h k 1 in fig 3b and the flux through boundary edges can be calculated using section 2 4 for the neumann boundary condition the known flux can be assigned on ap k and ap k 1 directly our model can assign the known heads or flux on the exact boundary the common sources term i e pumping well recharge and river are in our model the well and recharge can be regarded as part of q in eq 1 and assemble the part of the right term of the final matrix equation b in eq 26 according to the numerical scheme the calculation of flow between the river and the groundwater in our model refers to modflow harbaugh 2005 the river is divided into different reaches by gird cells and each reach is completely contained in a single cell the flow between the river and the groundwater system in cell p is given by 27 q r p c r p l p h r p h p h p b r c r p l p h r p b r p h p b r where qrp is the flow rate and positive for flow from the river to the aquifer crp is the hydraulic conductance of the river aquifer interconnection for unit length lp is the length of the river in the cell p hrp is water level stage in the river hp is the groundwater head in the cell p and br is the elevation of the bottom of sediments when the river water level hrp is higher than the hydraulic head of cell p the flow between the river and the aquifer is calculated by the head and water level of cell p thus the flow is implicitly connected with a and b of eq 26 after assembling the final matrix equation when the river water level is lower the flow is only included in the b of eq 26 2 5 characteristics of the numerical scheme the new numerical scheme is easy to solve for the different number of edges around a vertex fig 3a and does not make specific requirements for the number of grid cell edges which is different from the traditional model the numerical scheme algorithm can be used on arbitrary polygon grid cells the new scheme has greater flexibility on the grid discretization than the traditional model such as modflow the scheme is suitable for a model with complex shaped boundaries in the derivation of the numerical scheme our model does not make specific requirements for the angle between the principal direction of the hydraulic conductivity tensor and the coordinate axis the angle can be set as any value in our model while the coordinate axis directions must be aligned with the principal directions of the hydraulic conductivity tensor in modflow in addition the new version of modflow modflow usg can be applied to arbitrary polygon grids panday et al 2013 however modflow usg cannot be used in a horizontal anisotropic medium when arbitrary polygon grids are used our model can use arbitrary polygon grids in a horizontal anisotropic medium thus our model is convenient for application in the anisotropic medium in this new method when calculating the gradient of the cell the hydraulic gradient of cell grid is calculated by dividing it into several subcells whose number is equal to that of grid vertexes while the gradient of a grid cell is not divided in the traditional model the hydraulic gradient of each subcell would use different cell hydraulic heads to calculate in the new method an edge flux is divided into two half edges and calculated by the two subcells hydraulic gradient which is equivalent to the refined grid thus the new scheme makes better use of grid information than the traditional method 3 case studies to assess the performance of the proposed groundwater flow model we apply the model to four case study sites including three synthetic aquifer systems and one real world aquifer system with various hydrogeological conditions first the model is applied to three synthetic cases including an unconfined aquifer section 3 1 a confined aquifer section 3 2 and a multi layer aquifer system including the unconfined and confined aquifers section 3 3 respectively then the model is applied to the maozhou river basin in china to evaluate its performance in a real world river basin section 3 4 the results of the proposed model are compared with analytic solution and modflow 2005 which is widely used software 3 1 case 1 steady state flow in an unconfined aquifer the performance of our model is firstly demonstrated in an unconfined aquifer the size of the unconfined aquifer is set as 150 m length 100 m width and 40 m thickness the bottom of the layer is a horizontal datum the left side center of the aquifer is set as the origin of a cartesian coordinate system the left and right sides x 0 m and x 150 m of the layer are set as constant heads and the values are 39 m and 36 m respectively fig 4 the other sides are no flow fig 4 the recharge rate wr is 0 1 m d in the aquifer the hydraulic conductivity is isotropic and the value is 5 m2 d according to bear 1979 the steady state head is given by 28 h x h 1 2 h 2 2 h 1 2 l x w r k l x x 2 where h 1 is the hydraulic head on the left side which is 39 m in this case h 2 is the hydraulic head on the right side which is 36 m in this case l is the distance from the boundary to the origin which is 150 m in this case two mesh systems a regular grid fig 4a and an irregular grid with arbitrary shaped polygon fig 4b are used for spatial discretization respectively the regular grid number is 3750 each regular grid size is 2 m 2 m in the horizontal direction the arbitrary polygon grids are derived from voronoi diagrams which are generated based on the random points in the study domain the arbitrary polygon grid number is 3750 which is the same as regular girds the number of arbitrary polygon sides ranges from 3 to 11 in this case three groundwater flow models are built the first model is built using our proposed model with regular grids to discretize the domain the second model is established by our proposed model with arbitrary polygons the third model is set as the baseline model built using modflow 2005 with regular grids which are the same as the girds of the first model the hydraulic heads are calculated using three models in the steady state the results simulated by the proposed models are compared with those of modflw and the analytic solution the water table contours are shown in fig 5 the water table contours of the proposed models the first and second models accord well with those from the analytic solution indicating the proposed model have good accuracy in the unconfined aquifer the proposed model can more accurately represent contours of water table than modflow which is because the known head can not be assigned on the exact boundary and has to be assigned at the cell center near the boundary in modflow which causes lower water tables in the study domain in this case the proposed model can assign the known head on the exact boundary and not cause the boundary effect fig 6 compares water levels calculated by the proposed model and modflow with the analytical solution the ordinate of a point represents the hydraulic head simulated using the numerical model in the center of each cell while the abscissa of the point is the hydraulic head of the analytical solution in the corresponding position in fig 6 as shown in fig 6 hydraulic heads simulated using the proposed model in each regular grid fig 6a the proposed model in each irregular grid fig 6b and modflow in each regular grid fig 6c are compared with hydraulic heads of analytical solution in the corresponding position the points of the proposed model are near the diagonal in fig 6a and b which indicates that the proposed model is accurate the mean error me and the root mean square error rmse between water levels calculated by the numerical model and analytical solution are shown in fig 6 all the mes and rmses of the proposed model are small which also indicates that the proposed model has good accuracy the simulation times for our model with regular grids our model with irregular grids and modflow are 6 8 s 8 2 s and 0 1 s respectively the simulation time of the proposed model with irregular grids is longer than that of the proposed model with regular grids which indicates complicated grid will increase simulation time the proposed model consumed more simulation time than modflow the simulation time mainly includes assembling the global matrix and solving the global matrix equation the time to assemble the global matrix accounts for more than 75 of the simulation time therefore the slow assembly is the main reason for the long simulation time when assembling the global matrix each vertex needs to be looped which takes much time in order to improve the computing speed the algorithm of our model needs to be further optimized and parallel computing needs to be developed in the future 3 2 case 2 transient flow in a confined aquifer the performance of our model is demonstrated in an anisotropic confined aquifer with a size of 2000 m length 2000 m width and 40 m thickness respectively the bottom of the layer is a horizontal datum the center of the aquifer is set as the origin of a cartesian coordinate system the boundaries of the aquifers have a constant hydrological head of 60 m fig 7 a pumping well with a rate of 50 m3 d is located at 0 0 m the initial head is set as 60 m the hydraulic conductivity of this aquifer is anisotropic the principal directions of the anisotropic hydraulic conductivity tensor are aligned with coordinate axes x axis and y axis the components of the hydraulic conductivity in principal directions kx and ky are 0 5 and 0 1 m d respectively the specific storage ss is 0 0001 m 1 according to papadopulos 1965 the drawdown s is given by 29 s x y t q w 4  t x t y 0 5 w u xy where tx and t y are components of transmissivity in principal directions which are 20 and 4 m3 d qw is pumping rate which is 50 m3 d w u is the well function defined as 30 w u u 1  e  d  and uxy is defined as 31 u xy s s 4 t t x y 2 t y x 2 t x t y two mesh systems a regular grid fig 7a and an irregular grid with arbitrary shaped polygon fig 7b are used for spatial discretization the densities of gird cells are variable in the two mesh systems the gird density near the well is finer than that in places far away from the well the regular grid number is 13225 the arbitrary polygon grid number is 13 225 which is the same as regular girds the number of arbitrary polygon sides ranges from 3 to 12 it can be seen from fig 7 that the proposed model has better performance in local refinement than modflow three groundwater flow models for the case study site are built using the proposed model and modflow the three models are our proposed model with regular grids the first model our proposed model with arbitrary polygons the second model and modflow 2005 with regular grids the third model three observation wells are selected in the layer fig 7 the 5 day groundwater flow process is simulated using the three models and the time step for model simulation is set as 0 2 day the water level contours around the pumping well calculated by three models and analytical solution at 3 days are shown in fig 8 the water level contours of the proposed models are in good agreement with those of modflow and analytical solution which indicates the proposed method is accurate in confined aquifers fig 9 shows the comparison of water levels calculated by the proposed model and modflow with those obtained by analytical solution at 5 days hydraulic heads simulated using the proposed model in each regular grid fig 9a those simulated using the proposed model in each irregular grid fig 9b and those simulated using modflow in each regular grid fig 9c are compared with analytical solutions in the corresponding position the points of the proposed model are near the diagonal fig 9a and b which indicates that the proposed model is accurate the mes and rmses between water levels calculated by the numerical model and analytical solution are shown in fig 9 all the mes and rmses of the proposed model are small indicating that the proposed model has good accuracy fig 10 shows the water level change process calculated by the proposed model modflow and analytical solution at the three observation wells the groundwater levels of three observation wells calculated by the three numerical models and the analytical solution are consistent with each other in general at different simulation times fig 10 also shows that the water level changes have similar laws in the three observation wells the water levels of observation wells gradually decrease which is because of pumping the flows through the surface of cells including observation wells are calculated since the flows through the surfaces of grids are directly related to the shape of grid the flows simulated by models with the same grid are compared to avoid the influence of the grid shape fig 11 shows the comparison of flows simulated by the proposed model modflow and analytical solution the flows calculated by the proposed model with regular grids are consistent with those of modflow and analytical solution which indicates the proposed model is accurate in this case the water budget is analyzed to check the accuracy of the proposed model the outflow of water only includes the pumped out from the well the outflow rate is 50 m3 d which is constant the inflow includes water storage release and water from constant head cells the inflows calculated by the proposed model with regular grids and irregular grids are almost equal to outflow from 0 to 5 days the max difference is less than 0 0001 m3 d which also indicates the proposed model is accurate in case 2 the average simulation times of per time step for our model with regular grids our model with irregular grids and modflow are 38 4 s 45 7 s and 0 01 s respectively 3 3 case 3 multi layer unconfined and confined aquifers while the previous sections have validated our model in the unconfined section 3 1 and confined aquifer section 3 2 this section uses a three layer anisotropic aquifer system including both unconfined and confined aquifers for model demonstration the first layer is an unconfined aquifer and the other layers are confined aquifers the size of each layer aquifer is set as 150 m length 100 m width 20 m thickness which is the same as that of case 1 in the horizontal direction the bottom of the first layer is a horizontal datum the center of the aquifer in the horizontal direction is set as the origin of x and y axises the recharge rate is 0 05 m d in the first layer there is a multi layer pumping well at x 0 y 1 m in the second and third layers the well pumping rates from the second and third aquifer are 500 and 100 m3 d respectively the short sides x 0 m and x 150 m of the three layers have a constant hydrological head of 18 m and the other boundaries have no flow the initial head is set as 18 m the principal directions of the anisotropic hydraulic conductivity tensor are aligned with coordinate axes x axis y axis and z axis the components of hydraulic conductivity in principal directions kx ky and kv specific yield sy and specific storage ss are listed in table 1 two mesh systems are the same as those in case1 fig 4 three groundwater flow models for the case study site are built like case 1 proposed model with a regular grid proposed model with an irregular grid and modflow with a regular grid three observation wells are selected at x 0 y 25 m x 37 y 25 m and x 37 y 0 m in each layer the 10 day groundwater flow process is simulated using the three models with a time step size of 0 1 day the water levels contours simulated by three models in three aquifer layers at 1 day and 8 days are shown in fig 12 the water level contours of the proposed models the first and second models are in good agreement with those from the modflow model in general which indicates the proposed model is accurate the simulated results of the proposed model with regular grids and modflow model are almost the same there is a deviation of water levels between the proposed models with irregular grids and the modflow model in fig 12 although the deviation is small which indicates this deviation is due to the grid difference fig 13 shows the varying process of water levels simulated by the proposed model and modflow at three observation wells the groundwater levels calculated by the three models are consistent with each other in general there is a deviation between the proposed models with irregular grids and modflow model which is consistent with the results in fig 12 from fig 13 it can be seen that the water level changes have similar laws in the three observation wells the water level of the first layer is the highest among the three layers and the third layer is the lowest which indicates that the first layer supplies the second layer and the third layer is supplied by the second layer the water level of the first layer gradually rises and tends to be stable over time because of recharge the water levels of the second and third layers drop first then rise and stabilize the water level drop is due to the extraction of the pumping well and the rise is due to be recharged by the upper aquifer in the second and third layers fig 14 compares the flows through the surface of cells including observation wells in the first layer it can be seen from fig 14 that the flows calculated by the proposed model with regular grids are consistent with those of modflow which indicates the proposed model is accurate in case 3 the average simulation times of per time step for our model with regular grids our model with irregular grids and modflow are 104 5 s 123 8 s and 0 03 s respectively 3 4 case 4 unconfined and confined aquifers in a real world watershed finally we demonstrate our model performance in a real world case study site the maozhou river basin in china the maozhou river basin is located northwest of shenzhen city guangdong province china the study area is 359 8 km2 the subsurface was discretized with two layers the first layer is an unconfined aquifer and the second layer is a confined aquifer the top elevation of the first layer is the land surface derived from a digital elevation model dem the bases of the first and second model layers are set at elevations of 60 and 500 m respectively constant head boundary conditions are specified with a hydraulic head equal to zero in the western boundary of the maozhou river basin the other boundaries are set as no flux maozhou river has been represented in this case fig 15 the river stage has been derived by dem the value of conductance for unit length cr in eq 27 is set as 0 2 m2 d lancia et al 2019 the sketch of the case is shown in fig 15 the daily recharge rate is distributed as shown in fig 16 a the initial head is 0 m in this case the hydrogeological parameters of the model are conductivity in principal directions kx ky and kv specific yield s y and specific storage s s the horizontal hydraulic conductivity kx and ky is isotropic so kx is equal to ky the subarea of hydrological parameters of this case is shown in fig 16b and c hydrogeological parameters of the subarea are listed in table 2 in this case four grid division systems 526 arbitrary shaped polygon grids fig 15a 578 square grids fig 15b 6882 arbitrary shaped polygon grids fig 15c and 6906 square grids fig 15d are used for spatial discretization respectively the arbitrary polygonal grid in fig 15a is derived from the sub basins of the maozhou river basin which is necessary for swat swat is a computationally efficient simulator of hydrology and needs to divide the watershed into sub basins as spatial subdivision faramarzi et al 2009 the number of arbitrary polygon sides ranges from 3 to 10 in fig 15a the arbitrary polygonal grid in fig 15c is derived from voronoi diagrams which are generated based on the random points in the study domain the number of arbitrary polygon sides ranges from 3 to 11 in fig 15c five groundwater models of maozhou river basin are established with the proposed model and modflow the first model is established by the proposed model with 526 polygonal grids shown in fig 15a the second model is established by modflow with 578 square grids shown in fig 15b the third model is established by the proposed model with 6882 polygonal grids shown in fig 15c the fourth model is established by modflow with 6906 square grids shown in fig 15d the numbers of grids in the second model and fourth model are similar to those in the first model and third model respectively to reduce the impact of the number of grids in the comparison process the fifth model is as a reference model established using the modflow with fine square girds whose quantity is 42766 the quantity of the fifth model is much more than that of the other models the results of the fifth model are assumed to be accurate the 200 day groundwater flow process is simulated using the five models with a time step size of 0 5 days fig 17 shows the comparison of water level contours simulated by the proposed models and modflow models in two layers at 100 days in maozhou river basin the water level contours simulated by the proposed models accord well with those simulated by modflow models which indicates our model can simulate the groundwater flow in a real watershed with the increase of the number of grids the head contours simulated by our model the first and third models are closer to those simulated by modflow models the second and fourth model and the reference model the fifth model the comparison results also indicate that the irregular girds derived from sub basins needed in swat can simulate groundwater flow it can also be seen that the errors near the interface between the different recharge zone in fig 17a and b are higher than those in fig 17c and d the water tables near the interface between the different recharge zone change strongly thus more grids are needed near the interface than in other places to calculate the head accurately fig 18 shows the comparison of water levels calculated by the proposed models the first and third models and modflow models the second and fourth models with those obtained by the reference model the fifth model at 100 days the ordinate of a circle point represents the water level simulated using the proposed model in the center of each polygonal mesh while the abscissa of the point is the water level of the reference model in the corresponding position the ordinate of a star point represents the water level simulated using modflow models the second and fourth models in the center of a grid while the abscissa of the point is the water level of the reference model the fifth model in the corresponding position the water levels in each polygonal grid of the proposed models the first and third models and square grid of the modflow models the second and fourth models are compared with those of the reference model the fifth model in the corresponding position in fig 18a and c most of the circle points are near the diagonal which indicates that the proposed model is accurate in fig 18b and d the star points in the x axis represent these grids of modflow models the second and fourth models are located at the constant boundary the circle points do not deviate as much as the star points in the x axis which indicates the proposed model has a better performance than modflow in boundaries in fig 18a and c the circle points in the y axis represent the positions of these grids of the proposed models the first and third models are located at the boundary of the constant head in the reference model which indicates that the proposed model has better performance in boundaries than the reference model the me and rmse between water levels of the proposed models the first and third models and modflow models the second and fourth models and those of the reference model are shown in fig 18 the absolute of me and rmse of the first model are lower than those of the second model while the absolute of me and rmse of the third model are higher than those of the fourth model with the increase of the number of grids the performance of modflow becomes better than the proposed model in general the mes and rmses of the proposed model are small which also indicates that the proposed model is accurate in case 4 the average simulation times of per time step for our model with 526 and 6881 irregular grids and modflow with 578 and 6906 regular grids are 1 14 s 19 98 s 0 012 s and 0 014 s respectively 4 discussion the functionality and performance of the new model are demonstrated by comparing our model with modflow in four case studies with various hydrogeological conditions the water levels simulated by the proposed model are consistent with those simulated by modflow in all cases the comparison results show that in both confined and unconfined synthetic aquifer systems our model can well represent hydrological processes thus the proposed model can be applied to simulate groundwater in anisotropic confined and unconfined aquifers with arbitrary polygon grids in the 4 case studies two advantages of the model are presented the first is that the proposed model can simulate the groundwater flow on arbitrary polygon grids improving the flexibility of spatial discretization in case 2 our model shows a good function of local mesh refinement in the case of maozhou river basin with complex shaped boundaries our model outperforms the conventional groundwater model near boundaries our model has good flexibility of spatial discretization which addresses the limitations of traditional models such as modflow the second is that the proposed model avoids the boundary effect in the other cell center models the known boundary values can not be assigned on the exact boundary and have to be assigned at the cell center near the boundary in some cell center models i e modflow which caused boundary effect the proposed model can assign the known values to the exact boundary and not cause the boundary effect in case 1 the proposed model can more accurately represent the contours of water table than modflow this is because the proposed model does not have the boundary effect while modflow has the effect the grid inflexibility of the traditional models limits the development of groundwater surface water coupled models in some common coupled models such as swat mod bailey et al 2017 and gsflow markstrom et al 2008 the groundwater model and surface water model are modeled independently in this kind of coupled model the subdivision units of the surface water model are irregular polygons while those of the groundwater grid are trigonal or quadrilateral polygons that cannot match the surface water subdivision units the grid difference between the surface water model and the groundwater model increases modeling workload and application difficulty this new model can be coupled with the surface water model based on irregular polygon units such as the swat and prms in case 4 grids of our model are derived from sub basins that are needed in swat and the calculating results are in accord well with modflow in this way the surface water grid unit can be directly applied to the groundwater model reducing modelling workload aavatsmark proposed three mpfa method mpfa o mpfa l and mpfa u for reservoir simulation aavatsmark 2002 aavatsmark and eigestad 2006 aavatsmark et al 2008 mpfa o method was first proposed by aavatsmark the mpfa l and mpfa u are variants of mpfa o aavatsmark only gave the flux scheme on the quadrilateral grid or hexahedron in all the three mpfa methods our model is established based on the mpfa o and extends it to arbitrary polygonal grids to simulate groundwater flow we simplified the hydraulic conductivity tensor based on the characteristics of the layered distribution of the aquifer the conductivity tensor is expressed by horizontal conductivity tensor kh and vertical conductivity kv therefore the proposed model can not simulate the groundwater flow in the fully anisotropic aquifer in addition the calculation speed of the proposed model is slower than modflow the time to assemble the global matrix accounts for more than 75 of the simulation time therefore the slow solution speed is mainly caused by assembling the global matrix in the future the following three aspects need to be done firstly the model should be developed in a fully anisotropic aquifer secondly the solution algorithm needs to be further optimized and parallel computing needs to be introduced to improve the calculation speed then the model will be open source software in the future to better contribute to the hydrological modeling community 5 conclusions this study develops an improved numerical groundwater flow model using the mpfa method in confined and unconfined aquifers on arbitrary polygon grids the validity and performance of the new model are demonstrated with four test cases which include three synthetic cases unconfined aquifer confined aquifer and confined and unconfined aquifers and a real world river basin groundwater case solutions of the proposed model in all 4 cases have a good agreement with those of modflow in applications of the actual watershed the new model performs better than the traditional model in boundaries the four case studies show that our model has great potential to be applied to groundwater simulation in aquifers with complex boundaries in particular the flexibility of the discretization method embedded in our model makes it possible for fully coupling calculation of surface water groundwater interaction with sub basin as the numerical grids in a watershed credit authorship contribution statement yulong gao conceptualization methodology and writing erhu du writing shuping yi conceptualization writing funding acquisition and supervision yu han writing chunmiao zheng funding acquisition supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china nos 41877193 41931292 the start up funds for scientific research of high level talents in shenzhen no y01296126 the state environmental protection key laboratory of integrated surface water groundwater pollution control and the leading talents of guangdong province program awarded to chunmiao zheng no 2016lj06n469 the authors are grateful to editor huaming guo associated editor xusheng wang and the reviewers for their constructive comments and suggestions that significantly improve this study 
3652,a comprehensive understanding of groundwater chemistry and its evolution in irrigation districts is essential for irrigation management in this study with emphasis on a comparison between irrigated and nonirrigated areas the groundwater chemistry and hydrogeochemical processes of a typical irrigation district with an irrigation history of over 2260 years were studied to clarify the effects of long term irrigation on groundwater quality based on 107 water samples collected from across the study area a comprehensive analysis was conducted using multivariate statistics stable isotope analysis and hydrogeochemical modeling the results showed that the variation range and average concentrations of almost all the ions in the irrigation district are much greater than those in the nonirrigated areas the groundwater in the nonirrigated areas could be characterized by low tds and hco3 or hco3 so4 types whereas the groundwater in the irrigation district could be characterized by complex water types and high tds stable isotopes of hydrogen and oxygen indicated that the groundwater in the irrigation district experienced strong evaporation the calculated groundwater residence time showed that it takes approximately 2180 years for the groundwater to flow through the irrigation district some old irrigation water was present and it influenced the current groundwater chemistry in the study area the processes forming the current groundwater chemistry in the irrigation district can be formulated as mixing evaporation water rock interaction for mixing the proportions of rainfall irrigation water from the jing river and lateral recharge from the nonirrigated areas were found to be approximately 30 49 and 21 respectively for evaporation the ratio based on the tds was 3 83 when comparing the groundwater in the irrigation district with the mixed water after evaporation hydrogeochemical modeling showed that the irrigation area is a potential carbon source the dissolution of halite and gypsum the precipitation of calcite and dolomite co2 degassing and na ca exchange are the main chemical reactions in the geochemical evolution of groundwater the lesson learned from this irrigation district is that long term irrigation will lead to salinization and complexity of the groundwater hence in the water resource management of irrigation districts attention should not only be paid to the balance of water quantity but also to the balance of salts and the hydrochemical evolution of groundwater keywords long term irrigation hydrogeochemical processes jinghui canal irrigation district stable isotope hydrochemical modelling 1 introduction groundwater is an indispensable resource and it is also the main source of water for agriculture industry ecology and daily life particularly in arid and semi arid areas jha et al 2020 li et al 2015 clean groundwater is not only fundamental for human health economy and social development but also has an important impact on agricultural production safety and ecological environment esmaeilbeiki et al 2020 gao et al 2020a the expansion of irrigated agriculture is essential to feed a growing global population pea arancibia et al 2020 singh 2021 irrigation however is a large scale and long term human intervention that alters the natural water cycle conditions without a comprehensive understanding of the impact of irrigation activities this expansion may lead to environmental problems such as groundwater quality deterioration or soil salinization posing threats to agricultural production safety human health and even social stability rezaie balf et al 2020 singh 2021 zhou et al 2020 jha et al 2020 li et al 2015 esmaeilbeiki et al 2020 gao et al 2020a currently more than 20 of the global irrigation area is facing waterlogging and groundwater quality deterioration mao et al 2020 salmoral et al 2020 and the cultivated land affected by salinization in china has been as high as 566 000 km2 if left unattended the problem could expand to more than 50 of the world s irrigated area by 2050 singh 2021 in mesopotamia where the tigris and euphrates rivers formed long term irrigation induced soil salinization had led to the demise of the ancient mesopotamian civilization zhang and zhang 2003 therefore understanding the impacts of long term irrigation on groundwater systems is of great significance for ensuring sustainable agricultural development chen et al 2016 chen et al 2020b esmaeili vardanjani et al 2015 li and qian 2018 li et al 2015 pazand et al 2018 groundwater chemistry and its formation processes are critical to understand the evolution of a groundwater system and to clarify the interaction between groundwater and irrigation water chen et al 2020a li et al 2018 zhu et al 2020 generally the chemical components of groundwater are primarily controlled by atmospheric precipitation evaporation and water rock interactions cao et al 2020 jiang et al 2015 pant et al 2018 wang et al 2017 however with intense and long term agricultural activities the quality of irrigation water has an increasingly strong impact on the hydrochemical characteristics of groundwater in the irrigation district specifically irrigation not only changes the hydrodynamic conditions of the irrigation district but also introduces chemical substances into the irrigation district promoting mixing evaporation and various physical chemical and biological reactions in the aquifer system chen et al 2020c qin et al 2011 generally groundwater chemistry changes gradually under natural conditions while human activities such as irrigation may change or accelerate hydrochemical evolution thus with the superimposed influences of historical natural evolution and irrigation water clarifying the hydrochemical characteristics of groundwater and its formation mechanism in irrigation districts is challenging nevertheless studying the groundwater in nonirrigated areas can help reveal the natural evolution of the groundwater chemistry which can help identify the influence of irrigation water on the groundwater system by a comparison with groundwater in the irrigation district the jinghui canal irrigation district in china is one of the oldest canal irrigation districts in the world its irrigation history is over 2260 years dating back to 246 bce the canal water in the jinghui canal irrigation area comes from the zhangjiashan reservoir situated in the jing river northwest of jingyang county gravity irrigation is adopted and the area is dominated by natural terrain liu et al 2016 due to the high terrain the loess plain in the north of the study area has no canal irrigation while the river terrace and alluvial plain in the south have been irrigated since 246 bce i e during the qin dynasty because of the long term heavy dependence on surface water for agricultural irrigation and the poor drainage system historically the hydrological conditions in the irrigation areas have accordingly changed and the groundwater has currently become saline the groundwater quality issues in this irrigation area has attracted the attention of scholars for example liu et al 2013 investigated the temporal variation in the hydrochemical characteristics from 1990 to 2009 and concluded that groundwater has evolved from the hco3 type to the so4 type in the irrigation district zhang et al 2018 2019 undertook a human health risk assessment of groundwater nitrogen pollution and concluded that groundwater in the jinghui canal irrigation district is seriously polluted by th tds so4 2 cl and no3 due to intense and extensive industrial and agricultural activities however these studies only focused on the temporal variations in the hydrochemistry or on the effects of irrigation on a particular ion i e no3 or as the differences in the hydrochemistry between irrigated and nonirrigated areas the regional influence of irrigation particularly long term irrigation on hydrochemical processes and factors controlling the hydrogeochemistry have not been clearly elucidated therefore our research mainly focuses on the effects of long term irrigation on the groundwater system by clarifying the controlling factors and hydrogeochemical processes of groundwater chemistry with emphasis on the comparison between irrigation district and nonirrigated areas on this basis this study takes historical references to propose reasonable management recommendations for the sustainable development of irrigation districts 2 study area 2 1 landform and hydrology jingyang county is located at the center of guanzhong plain shaanxi province extending over an area of 780 2 km2 108 29 40 108 58 23 e 34 26 37 34 44 57 n fig 1 the topography in the area slopes from the northwest nw to the southeast se with altitudes between 361 and 1614 m fig 1 the landforms in the area mainly comprise mountains loess tableland flat alluvial plains and river terraces the mountains located in the north of jingyang county account for 12 4 of the total area of the county the irrigation district is mainly located in flat alluvial pains and river terraces accounting for 64 5 of the total area while nonirrigated areas are mainly located in loess tablelands accounting for 23 1 of the total area gao 2020c the study area has a relatively extensive river system with major rivers including the jing river the yeyu river and the qing river the xijiao reservoir located in the main stream of the qing river is the only regulating reservoir in the jinghui canal irrigated district which was built in 2003 the surplus water from the jing river in the nonirrigated period was diverted to the reservoir which significantly improved the situation of insufficient irrigation water in the irrigation district jing river is the largest river in the study area with an annual average runoff of 19 21 108 m3 and an average annual sediment transport of 2 526 108 t as the main source of irrigation water the annual average available irrigation water diverted from jing river is 2 2 108 m3 shaanxi provincial department of water resources 2019 kang 2021 the county is characterized by a temperate continental semi arid monsoon climate with average annual temperature precipitation and evaporation of 13 1 548 7 mm and 995 17 mm respectively the rainfall and temperature show large seasonal fluctuations in the study area the summer lasts from june to august with the highest air temperature reaching 41 4 winter is cold lasting from december to february with the lowest temperature reaching 20 8 the annual rainfall varies from 349 2 to 829 7 mm with the maximum rainfall in september according to local records of jingyang county http www snjingyang gov cn jydq htm 2 2 geology and hydrogeology quaternary sediments cover the entire study area including alluvial alluvial pluvial eolian and alluvial lacustrine deposits the bedrock in the mountain areas in the north of the study area is dominated by cambrian and ordovician limestone the phreatic water in the study area mainly includes unconsolidated sediments pore water and bedrock fissure water the bedrock fissure water is distributed only in the northern mountain areas and the loess hilly region while the pore water is mainly distributed in alluvial plains river terraces and the loess aquifer the loess aquifer in the loess tableland is characterized by deep groundwater approximately 10 80 m while the water depth in the alluvial plains and river terraces is typically less than 36 m precipitation leakages of the canal system and return flow from irrigation are the main recharge sources for the groundwater generally the groundwater flows from the mountains and the loess tableland to the river terraces fig 2 in recent years due to over exploitation in the river terraces the groundwater level has rapidly decreased and the river now recharges the groundwater in the downstream area of the jing river 2 3 irrigation history drought has been a major problem in the guanzhong plain since ancient times based on historical records drought had occurred 127 times in this region from 1080 bce to 1923 ce and the average occurrence period is approximately 24 years in the last hundred years droughts were more frequent and the occurrence period of extreme drought is 10 years the chorography of jinghuiqu canal 1991 therefore diversion irrigation has been a basic policy to solve the drought problem and ensure food security in all countries lu et al 2020 in the study area a canal system was constructed in 246 bce by diverting water from the jing river to solve the drought problem and to develop agriculture opening the way for diversion irrigation he 2011 this canal system was originally named zhengguo canal after the person who established the system zhengguo canal in shaanxi dujiangyan in sichuan and ling canal in guangxi are three famous ancient water conservancy projects in china you et al 2018 the zhengguo canal irrigation district was built in the qin dynasty flourished in the han and tang dynasties and kept developing in the song yuan ming and qing dynasties according to the jinghui canal chronicles the irrigated area was approximately 760 km2 in the beginning qin dynasty because of wars and historical changes the irrigation area changed significantly during the han 95 bc tang 655 ce song 991 ce yuan 1308 ce ming 1375 ce and qing 1669 ce dynasties decreasing to a mere 50 km2 in the qing dynasty approximately 1737 ce fig 3 in the late 1920 s agricultural production was severely affected by successive years of drought hydraulic scientist li yizhi begun to rebuild the canal system in the 1930 s to ensure food security and the irrigation district was extended to its current area of 970 km2 the canal systems rebuilt in 1930 s were renamed as jinghui canal liu et al 2016 regardless of how the irrigation area changed the river terraces in jingyang have always been irrigated the chorography of jinghuiqu canal 1991 after the reconstruction in 1930s due to the considerable water diversion irrigation the groundwater level in the irrigation area increased year by year and serious soil salinization occurred in the southeast of the study area therefore drainage systems were constructed to alleviate salinization from 1937 to the 1980s and well canal conjunctive irrigation began in 1950 and widely implemented after 1990s the chorography of jinghuiqu canal 1991 3 materials and methodology 3 1 sample collection the samples were collected from across the study area in august 2016 including 104 groundwater samples and three water samples from the jing river the groundwater samples were collected from domestic and agricultural wells prior to sampling the wells were continuously pumped for at least 10 15 min and the sample bottles were thoroughly rinsed thrice with groundwater from the sampling wells the sample bottles were filled to the top and immediately sealed to minimize sample exposure to air water temperature ec ph tds were measured in the field using a portable water testing kit ddb 350 leici company of china the sample collection storage transportation and analysis were all undertaken with strict adherence to the standards of the ministry of health of the people s republic of china prc all the major ion measurements and isotopic analysis were conducted by the water and soil testing center of shaanxi institute of engineering prospecting in accordance with the standard testing methods major cations ca2 and mg2 and so4 2 were measured using edta 2na titration with a detection limit of 1 0 mg l flame atomic absorption spectrometry was used to analyze k and na with detection limits of 0 05 and 0 01 mg l respectively hco3 and co3 2 were measured by titration with a detection limit of 2 0 mg l silver nitrate titration was used to analyze cl with a detection limit of 1 0 mg l the accuracy and reliability of the analysis were verified by calculating the charge balance error cbe of each sample the results for the samples showed a cbe less than 5 indicating the reliability of the analysis results the hydrogen and oxygen stable isotopes in h2o were analyzed using a liquid water isotope analyzer iwa 35 ep lgr the measured stable isotope data were expressed in per mil units using the delta  notation relative to the vienna standard mean ocean water vsmow the analytical precision values were 0 6 and 0 2 for 2h and 18o respectively 3 2 multivariate statistical analysis the hierarchical cluster analysis hca is a statistical method for classifying variables with similarities the hca can reduce the dimensionality by determining the typical variables of each cluster one of the advantages of the hca compared with graphical methods is that it is a data driven method that can unambiguously assign each sample into a single water quality category without pre determining the final number of groups or pre assuming the factors that might control categorization daughney et al 2011 gler et al 2002 the hca results can therefore be readily interpreted in geological and hydrochemical contexts daughney et al 2011 the method has been widely used in previous studies gler et al 2002 li et al 2018 moeck et al 2016 for the hca although a wide range of clustering techniques are available the most common methodology used to obtain the distance with linkage rules is the euclidian distance combined with ward s method daughney et al 2011 moeck et al 2016 wu et al 2013 ward s method evaluates the distances between clusters using an analysis of variance and forms the smallest distinct clusters by calculating the error sum of the squares according to gler et al 2002 this approach produces the most distinctive groups where the members within the group are more similar to each other in this study the hca based on the euclidean distance along with ward s linkage method was applied to classify groundwater samples into homogeneous groups through the spss software the clusters of groundwater samples can be helpful to objectively evaluate the differences in the groundwater chemistry in nonirrigated and irrigated areas 3 3 hydrogeochemical modeling hydrogeochemical modeling is a useful tool to clarify the evolutionary processes in groundwater systems an inverse modeling was performed between the initial and final solutions along the flow paths revealing the occurrence of physiochemical processes chen et al 2020a the precondition for establishing a hydrogeochemical model is to determine the chemical reactions occurring in the groundwater system therefore the factors controlling the groundwater chemistry are first identified through an ionic ratio analysis and hydrochemical methods the basic idea of the hydrogeochemical modeling is as follows 1 initial water chemistry reactants final water chemistry products the reactants and products in equation 1 are substances entering or leaving the solution phase during the reaction process generally various combinations of the reactants and products can satisfy equation 1 it is necessary to determine the most likely reactants and products under this condition based on the lithology geology and hydrogeological conditions of the study area in this regard the calculation results of the saturation index si can provide important reference information in this study the precipitation irrigation water and upstream groundwater serve as sources of the initial water chemistry that is the initial solution is a mixture water mw while the final solution is the groundwater in the irrigation district given that the studied region is in a semi arid area extensive evaporation can result in salt accumulation in shallow groundwater to calculate the net chemical reaction in a groundwater system a virtual solution vs was introduced to represent the mixture water after evaporation according to equation 1 assuming that the dissolution amounts of the minerals are x 1 x 2 xn mmol l during the hydrogeochemical processes and that the increment in the i th element in the final water chemistry is bi mmol l compared with the initial water chemistry the following expression can be written 2 j 1 n a ij x j b i i 1 2 n where aij is the stoichiometric number of i th elements relative to the j th mineral to realize hydrogeochemical modeling the ideas proposed by qian et al were used qian et al 2009 qian et al 2011 chen et al 2020a the authors used this method to study the formation processes of the chemical components of lakes and rivers in arid areas of china 4 results 4 1 hydrochemical characteristics 4 1 1 chemical composition and hydrochemical facies table 1 presents a summary of the basic statistics of the physicochemical data of the water samples collected from nonirrigated areas irrigation district and jing river the violin plot of the groundwater samples fig 4 shows that the distribution of the various ions in the irrigation district is evidently wider than that in the nonirrigated area suggesting a complex and notable spatial difference in the hydrogeochemical characteristics of the study area additionally except ph and hco3 the average concentrations of almost all the ions in the irrigated areas are much higher than those in the nonirrigated areas and some of them even exceed the acceptable limits for drinking water indicating poor groundwater quality in the irrigation district specifically the 25th percentiles of the tds in the irrigation district are much higher than 1000 mg l indicating the prevalence of brackish water whereas the groundwater in the nonirrigated areas is more diluted and has a low tds for both the districts the ph values ranged from 6 9 to 8 5 indicating that groundwater across the study area was generally neutral to slightly alkaline to reveal the similarities and differences between water samples a piper trilinear diagram was created piper 1944 as shown in fig 5 most of the samples collected from irrigation district are plotted in zone b of the lower two triangles indicating mixed type however samples from the nonirrigated areas are mostly located in zone d of the lower left triangles and zone e of the lower right triangle indicating that na and hco3 are the dominant cation and anion respectively as for the jing river water the dominant cation is na and the anion is mixed type furthermore notably the jing river samples plotted among zones i and ii are similar to the hydrochemical type of the groundwater in the irrigation district but were quite different from the samples collected from the nonirrigated areas this finding can be attributed to the long term irrigation performed using water from the jing river 4 1 2 hydrochemical evolution the hca results show four major clusters c1 c4 clearly distinguishable from each other based on a phenon line with a linkage distance of 10 fig 6 similarities between the hydrochemical characteristics of c1 and c2 can be expected because of the slightly higher linkage distance of approximately 12 however the samples from clusters c1 and c2 are linked to clusters c3 and c4 at an elevated linkage distance of 15 indicating a wider variation in the hydrochemical components between c1 c2 and c3 c4 based on stiff diagrams na and hco3 are predominant in c1 while the percentages of mg2 so4 2 and cl gradually increase in the order c1 c2 c4 c3 in particular the hydrochemical types of c3 became mixed type so4 cl na mg type the spatial distributions were helpful for understanding the relationships between these four clusters as shown in fig 7 along with the groundwater flow direction the distribution of the four clusters is c1 c2 c4 and c3 combined with stiff diagrams the transition of c1 c2 c4 c3 reflects a common natural salinization process from upstream to downstream in the semi arid area wu et al 2017 in other words the hydrochemical types of groundwater gradually transformed from bicarbonate type to sulfate or chloride type specifically c1 is mainly located in nonirrigated loess tablelands which are characterized by a high groundwater depth greater than 25 m the groundwater in this area is mainly recharged by the lateral flow from mountainous regions however some of the water samples taken from the low lying areas of the loess tableland are clustered into c4 rather than c1 because they are relatively shallow and easily affected by human activities the other three clusters are mainly distributed in the irrigation district in terms of the topography the samples from c2 are mainly located in the junction zone of the two different landforms and those from c3 are mainly located in the first terrace or around the xijiao reservoir having a shallow groundwater table while those from c4 are widely distributed in the second or third terraces of the jing river and the alluvial proluvial plain the geochemistry of the groundwater near rivers with a shallow groundwater table i e c3 is expected to be strongly associated with irrigation water and intense evaporation additionally the spatial change in the hydrochemistry is helpful to visually identify the differences between the different regions and further explain the influence of irrigation activities therefore the spatial variations in the tds and hydrochemical types including cation anion and hydrochemistry were plotted using arcgis 10 8 as shown in fig 8 the results showed that the groundwater in the nonirrigated areas can be simply characterized by low tds and hco3 or hco3 so4 types consistent with the piper diagram shown in fig 5 without irrigation precipitation and lateral flow are the main sources of groundwater recharges in the nonirrigated area in addition due to the thick loess and deep groundwater level human activities have little influence on groundwater making this a largely natural water cycle system as for the groundwater in the irrigation district its hydrochemical type is more complex with a high tds only from the anion types of the groundwater their types have diverse and complex characteristics such as hco3 so4 cl so4 hco3 cl or cl hco3 so4 type fig 8c if the cation types were included it would be much more complicated as shown in fig 10 d the hydrochemical type in the irrigation district is generally characterized by mixed type different from the nonirrigated loess tableland the flat terrain in the irrigation district makes the groundwater to flow gradually thus prolonging the water rock reaction additionally the recharging of the irrigation water disturbs the natural water cycle system raising groundwater levels at some locations and resulting in salt accumulation under intense evaporation 4 1 3 stable isotopes the stable isotope method is an important technique to clarify the recharge sources of groundwater huang et al 2017 jia et al 2020 mohammed et al 2014 if groundwater were recharged by different sources or under different evaporation conditions the relationship curves between 18o and d should have different slopes and intercepts fig 9 shows the relationships between 18o and d for the water samples for groundwater in the nonirrigated loess tablelands 18o and d values ranged from 9 7 to 7 3 average value of 8 9 and from 73 3 to 62 5 average value of 67 9 respectively the 18o and d values of the groundwater in the irrigation district varied between 9 5 and 8 0 average value of 8 6 and between 66 9 and 59 6 average value of 63 1 respectively additionally it is evident that the stable isotope values of the groundwater in the irrigated area are significantly higher than those of the groundwater in the nonirrigated area and the best fit line slope 3 73 for the irrigated area data is significantly lower than that for the nonirrigated area groundwater slope 6 38 the lmwl and gmwl indicating the influence of strong evaporation in the irrigated area additionally the average isotopic values of the jing river 18o 8 7 d 63 2 are similar to those of the groundwater in the irrigation district 18o 8 6 d 63 1 indicating that surface water is the main recharge source for groundwater through irrigation activities 4 2 controlling factors of groundwater chemistry 4 2 1 evaporation a gibbs diagram was proposed gibbs 1970 to reveal the factors controlling the dissolved salt composition in the water the ratios of na na ca2 and cl cl hco3 relative to the tds commonly illustrate three natural mechanisms in water atmospheric precipitation rock weathering and evaporation adimalla et al 2020 chen et al 2021 as shown in fig 10a and 10b rock weathering followed by evaporation are the main factors influencing groundwater evolution of c1 in the nonirrigated loess tableland for the other three clusters particularly c3 the high ratios of cl cl hco3 indicate that the groundwater was mainly controlled by evaporation in the irrigation district which correspond to the characteristics of stable isotopes due to large scale and long term irrigation and poor drainage the groundwater level generally increased in the irrigation district leading to intense evaporation of the groundwater the direct consequences are the high tds and serious soil salinization since 1990 s although the groundwater table declined because of the heavy exploitation due to the high background values of the ions in soil and groundwater formed during the long irrigation history gao et al 2020b the tds of the groundwater remains high particularly in low topography areas in 2003 the construction of the xijiao reservoir which diverted water from the jing river changed the groundwater condition near it the leakages from the reservoir changed not only the groundwater level but also the hydrochemistry around the reservoir the majority of samples from c3 were mainly distributed in areas surrounding the reservoir and in areas typically having a shallow groundwater with a depth of less than 15 m 4 2 2 mineral dissolution precipitation the evaporation process causes the concentration of all the ions to increase proportionally and cannot change the hydrochemical types in the groundwater system the hydrochemical types of waters are mainly influenced by mineral dissolution or precipitation the saturation index si is a vital parameter to reveal the dissolution or precipitation trend of a mineral si log10 iap k which is calculated using the phreeqc software in this study crerar 1975 li et al 2012 from the calculated si fig 10c the values of all the groundwater samples for calcite and dolomite are greater than zero indicating precipitation of these carbonate minerals in contrast the si values of gypsum and halite were less than zero and they increased with the increase in the tds indicating the dissolution trend of these minerals therefore the dissolution of these minerals results in an increase in the concentrations of so4 2 ca2 na and cl in groundwater and the increase in the ca2 concentration potentially causes further precipitation of the carbonate minerals along the flow path and reduces the hco3 concentration the ionic ratios provide useful information that help identify water with lithogenic origins chen et al 2020a the ca2 mg2 ratios can be used to depict the dissolution of calcite and dolomite fig 10d if the concentration of ca2 is higher than that of mg2 calcite has a greater contribution and vice versa the majority of samples are located above the 1 1 line indicating the dominance of dolomite consistent with the presence of limestone and dolomite in the bei mountain of the study area notably the sidol and sical values of all the water samples are higher than zero indicating the continuous precipitation of dolomite and calcite in the groundwater system thus the ca2 and mg2 concentrations should decrease with the precipitation of dolomite and calcite however the ca2 and mg2 concentrations in the irrigation district are much higher than that in the jing river and nonirrigated areas table 1 indicating the potential importance of intense evaporation on hydrochemical evolution 4 2 3 cation exchange the ratio of na cl is considered an important hydrogeochemical indicator in characterizing the concentration of na in groundwater and determining the origin of the groundwater li et al 2012 mirzavand et al 2020 the na cl ratio should be equal to 1 if halite dissolution is dominant wei et al 2017 however as shown in fig 10e almost all the groundwater samples are located below the 1 1 line indicating that na has other sources such as ion exchange or silicate weathering the loess and alluvial sediments are rich in clay minerals making cation exchange a potential factor affecting the concentration of cations in groundwater li et al 2012 thapa et al 2018 the ion exchange and reverse ion exchange between ca2 and na can be expressed by the following reactions respectively li et al 2018 ca2 2nax 2na cax2 2na cax2 2nax ca2 the plot of na k cl versus ca2 mg2 hco3 so4 2 in meq l can be used to assess the possible role of ion exchange in the groundwater system the results of our analysis fig 10f indicate that the groundwater samples of the four clusters have a slope of approximately 1 indicating that ion exchange strongly influences the groundwater chemistry in the study area li et al 2018 yidana and yidana 2009 4 3 hydrogeochemical processes considering the discussion above the processes forming the present groundwater chemistry should be mixing evaporation water rock interaction mixing means that when irrigation water is introduced into the study area it will be mixed with the original groundwater flowing into the area from the upstream and the precipitation infiltrating into the ground evaporation means that because of the shallow water depth caused by long term irrigation the groundwater in the irrigation district will be evaporated water rock interaction means when the groundwater is dominated by evaporation some chemical reactions occur that change the groundwater chemistry to investigate these processes quantitatively the key problems lie in determining the mixing proportion and the evaporation ratio and in defining the initial water chemistry final water chemistry and the reactants and products 4 3 1 estimation of mixing proportion and evaporation ratio the water sources entering the irrigation area include infiltrated irrigation water rainfall and groundwater from the upstream nonirrigated area based on the calculated water balance in the jinghui canal irrigation district gao 2020c the proportions of rainfall irrigation water from the jing river and lateral recharge from the nonirrigated areas are approximately 30 49 and 21 respectively thus the hydrochemical characteristics of the groundwater in the irrigation district is in fact the result of evaporation and chemical reactions on the basis of this mixed water from the proportions and chemical composition of the three recharge water sources the ion concentrations of the mixed water mw were calculated and listed in table 2 by comparing the hydrochemical characteristics of the groundwater in the irrigation district id and that of the mixed water mw calculated some clues can be obtained for estimating the evaporation ratio for example the concentrations of na mg2 cl and so4 2 of id are 4 35 3 76 5 41 and 4 87 times higher than that of mw respectively however the concentrations of ca2 and hco3 of id are only 2 60 and 2 64 times higher than those of mw respectively which are much lower than the above ion concentrations hence where did ca2 and hco3 go during evaporation this naturally suggests the precipitation of calcite which is also consistent with the super saturation of calcite additionally based on the si values the water solutions of mw and id are under saturated by halite and gypsum and super saturated by dolomite which shows the precipitation trend of dolomite and dissolution trend of halite and gypsum during the evaporation processes thus the evaporation ratio is overestimated using the ratios of id mw na cl or so4 2 4 35 5 41 or 4 87 and is underestimated using the ratios of ca2 mg2 or hco3 2 60 3 76 or 2 64 therefore the evaporation ratio of the groundwater in the irrigation district should range between 3 76 and 4 35 because the changes in the tds can comprehensively reflect the precipitation or dissolution of minerals as well as the change in the ion concentrations the ratio of tds 3 83 can be used to represent the evaporation ratio this ratio is only in the range of 3 76 4 35 4 3 2 hydrogeochemical reactions modeling given the estimated mixing proportion and evaporation ratio the initial water chemistry in the hydrogeochemical model can be defined as mixed water after evaporation and the final water chemistry is simply defined as the representative groundwater in the irrigation district the chemical composition of the initial water chemistry calculated using the determined evaporation ratio 3 83 is listed as vs in table 4 compared with the final water chemistry there are considerable differences between the two mainly controlled by the chemical reactions in the groundwater system considering the geology and si values of minerals the main chemical reactions forming the groundwater composition of the id are believed to be the dissolution of halite and gypsum the precipitation of calcite and dolomite and the escape of co2 however the dissolution of halite cannot fully explain the varying degrees of increase in the na and cl concentrations and ca2 is evidently insufficient to precipitate the related carbonate mineral therefore considering the large amount of clay sediments in the loess stratum the cation exchange between na and ca2 eq 8 is used to explain these changes thus the main chemical reactions forming the groundwater chemistry in the irrigation district are as follows 3 nacl halite na cl 4 caso4 2h2o gypsum ca2 so4 2 2h2o 5 ca2 co3 2 caco3 calcite 6 ca2 mg2 2co3 2 camg co3 2 dolomite 7 h2co3 h2o co2 8 2nax ca2 cax2 2na from eq 2 the values of the stoichiometric coefficient aij are listed in table 3 by solving eq 2 the corresponding contribution of each chemical reaction for the water chemistry evolution can be obtained table 4 halite dissolution is the most in the system occurring at a rate of 3 92 mmol l resulting in a dramatic increase in the cl concentration compared with the other ions similarly gypsum dissolution 1 79 mmol l contributes to the increase in so4 2 in groundwater in the irrigation district and the precipitation of calcite and dolomite as well as the escape of carbon dioxide result in a decrease in the hco3 concentration compared with the vs these chemical reactions led to changes in the groundwater type which was hco3 type in the recharge area but changed to mixed type in the irrigation district for the cations a dissolution of 3 92 mmol l of halite and 0 92 mmol l na ca exchange resulted in a general increase in the na concentration although the ca2 concentration would increase with gypsum dissolution 1 79 mmol l and cation exchange 0 92 mmol l the large amount of calcite precipitation at a ratio of 3 24 mmol l led to a sharp decrease in the ca2 concentration therefore the dominant cation of the groundwater in the irrigation district changed to na on this basis the corresponding contributions of the chemical reactions to the hydrochemical evolution are quantitatively determined table 4 the results are consistent with the qualitative analysis described in section 4 2 that is in addition to the evaporation the dissolution of halite and gypsum the precipitation of calcite and dolomite and the escape of co2 are the primary chemical reactions in the process of groundwater chemistry evolution moreover na ca exchange contributes to the changes in the cation concentration fig 11 5 discussion a comparison of the statistics and hydrogeochemical characteristics show that two evident characteristics can be distinguished for groundwater in the irrigation district i more complex hydrochemical types and ii high tds and poor groundwater quality irrigation activities inevitably alter the original hydraulic condition and groundwater chemistry resulting in significant differences in the hydrochemical characteristics between irrigated and nonirrigated areas meanwhile the groundwater in the irrigation district is recharged by multiple sources including irrigation water from the jing river upstream groundwater from nonirrigated areas and precipitation therefore whether the current groundwater chemistry in the irrigation district is mainly the result of natural reactions or long term irrigation activities remains unclear is it more related to recent irrigation water or the historical effects from thousands of years of irrigation water what is the leading factor in the formation of current groundwater chemistry in irrigation district all these aspects require further investigation and discussion 5 1 effects of current irrigation water the recharge of groundwater in the irrigation district has three main sources lateral runoff from nonirrigated areas irrigation water of jing river and precipitation if the groundwater in the irrigation district is mainly recharged by the lateral runoff of nonirrigated areas the 18o and d values of the groundwater in the irrigation district should be on a line passing through the points of the groundwater samples from nonirrigated area and with a slope of 3 73 groundwater evaporation fractionation slope in the irrigation district as well as heavier isotope values as shown in fig 9 this cannot be achieved by the evaporation of groundwater in the nonirrigated area on the contrary the groundwater samples from the irrigation district are mostly located above the points of the nonirrigated area groundwater and are similar to that of jing river moreover the average values of 18o and d of the groundwater in the irrigation district are significantly higher than those of the groundwater in the nonirrigated area and are similar to those of the irrigation water jing river indicating that the groundwater in the irrigation district is mainly recharged by irrigation water therefore the stable isotopic signatures to a great extent positively confirm the significant influence of irrigation water on the groundwater in the irrigation district and its hydrochemical characteristics are of course affected by irrigation water the hydrochemical characteristics also prove the primary influence of irrigation activities as shown in fig 8 b the main cations of the nonirrigated area and irrigation district are na and na mg respectively suppose the groundwater in the irrigation district is mainly recharged by the upstream groundwater of nonirrigated area the groundwater of the irrigation district should be characterized by na type with a higher concentration of sodium rather than na mg type the piper diagram fig 5 reveals a higher proportion of mg or ca in the jing river which is similar to the groundwater in the irrigation district thus the greater influence of the irrigation water on the groundwater evolution is also proven by the hydrochemical characteristics 5 2 effect of old irrigation water irrigation activities have lasted for 2260 years in the study area is it more related to recent irrigation water or the historical effects from thousands of years of irrigation water this question may be answered by calculating the water resident time by darcy s law based on the groundwater level contour map of the study area fig 2 the hydraulic gradients in the nonirrigated area and irrigation district are 8 979 and 2 077 respectively based on the permeability test in the field and parameter calibration using the numerical model the horizontal permeability coefficient and effective porosity of the loess in the study area are 1 2 m d and 0 11 respectively peng et al 2012 by darcy s law wang et al 2020 the flow velocity in the nonirrigated areas is 0 010775 m d and it requires approximately 260 years for the groundwater to migrate from the piedmont of beishan to the edge of the irrigation district however due to the flat terrain the flow velocity in the irrigation district is only 0 002492 m d and it requires approximately 2180 years for the groundwater to migrate through the irrigation district to the jing river notably this is only the average flow velocity of the groundwater due to intensive heterogeneity of the aquifer and the strong hydrodynamic dispersion effect the fast flowing groundwater has already flowed out of the irrigation district in the past 2180 years while the slow flowing groundwater still remained in the irrigation district at the same time after the completion of the irrigation project the irrigation activities in the irrigation district continued for 2260 years therefore a large amount of old irrigation water thousands of years remained in the groundwater system and the old irrigation water still has a legacy impact on the hydrochemical characteristics of current groundwater in the irrigation district 5 3 effects of chemical reactions how does the dissolution or precipitation of minerals affect the hydrochemical characteristics of groundwater in the irrigation district this effect can be illustrated by reviewing the dissolution or precipitation amounts of the main minerals halite gypsum calcite dolomite cation and co2 based on the results of hydrogeochemical reaction modeling along the flow direction from nonirrigated areas to irrigation district every one liter of mixture water will dissolve 3 92 and 1 79 mmol of halite and gypsum respectively while simultaneously precipitating 3 24 and 0 08 mmol of calcite and dolomite and releasing 1 54 mmol of co2 the average annual total recharge to groundwater is 9622 99 104 m3 a including the infiltration of precipitation and irrigation water as well as the lateral runoff the first hydrogeology engineering geological team of shaanxi geology and mineral resources exploration and development bureau 1996 therefore the amounts of halite and gypsum dissolved will be 22 445 and 29 972 t a respectively the amounts of calcite and dolomite precipitation will be 31 178 and 338 73 t a and 6 521 tons of co2 will be released from the irrigation district every year the dissolution of halite and gypsum in such large amounts every year will inevitably have a significant influence on the na cl and so4 2 concentrations of groundwater in the irrigation district additionally the largest amount of calcite precipitation will significantly decrease the hco3 concentration resulting in changes in the hydrochemical types along the flow direction from nonirrigated areas to irrigation district in particular in this area with an irrigation history of more than 2260 years the hydrochemical characteristics of groundwater in nonirrigated areas and irrigation district have displayed evident differences significantly a new finding of this study is that the introduction of water for irrigation will lead to the escape of co2 from groundwater in other words this special irrigation district is a potential carbon source 5 4 comparison with a young irrigation district the baojixia irrigation district is adjacent to the western side of jinghui canal irrigation district both baojixia and jinghui canal irrigation districts are located in the guanzhong plain with similar climate and geological conditions however the baojixia irrigation system was established in 1971 and only operated for 50 years until now based on a study on the groundwater chemistry in the baojixia irrigation district conducted by jia et al 2020 the mean value of the tds is 856 mg l and the hydrochemistry types are hco3 na hco3 so4 na and hco3 na mg evidently the groundwater in the jinghui canal irrigation district with over 2260 years of irrigation history shows more complex hydrochemical types and higher tds concentrations of 1790 mg l than that in the young irrigation district indicating the long term effects of irrigation water on groundwater quality and chemistry groundwater is a crucial source for daily life and agricultural use in arid and semi arid areas with the rapid development of the region the demand for water resources will increase in the future an analysis of the hydrogeochemical characteristics and the formation process of groundwater components in this historical irrigation area shows that the management department should pay attention to irrigation management and groundwater quality protection conventionally in irrigation district management people only pay attention to the water quantity balance but not to the salt balance let alone the contribution of chemical reactions the evaporation and chemical reaction are two crucial factors influencing groundwater salinization and high tds in irrigation districts and salinization may continue for decades centuries or even thousands of years to reverse this trend the management of groundwater salinity balance should be strengthened additionally the irrigation district is a carbon source then how about the nonirrigated areas this question should be answered in future research to make a clearer and wider understanding of the effect of long term irrigation activities on groundwater and even carbon neutrality 6 conclusions in this study the hydrochemical characteristics of groundwater in a historical irrigation district were analyzed by conducting a multivariate statistical analysis violin plots and hierarchical cluster analysis and stable isotope analysis based on a comparison of the hydrochemical characteristics between nonirrigated and irrigation areas the factors controlling the groundwater chemistry were identified through the ionic ratio analysis and hydrochemical methods subsequently a hydrogeochemical model was established to quantitively analyze the chemical reactions and gain insights into the hydrochemical processes through an in depth investigation the long term effects of irrigation on the groundwater chemistry were identified and verified the following conclusions can be drawn 1 the groundwater in the irrigation district is mixed type with a high tds whereas the groundwater in nonirrigated areas is simply characterized by hco3 or hco3 so4 with a low tds the analysis of the hydrochemistry and stable isotopes confirmed that irrigation water diverted from jing river and that the intense evaporation significantly affected the hydrochemical characteristics of the groundwater in the irrigation district 2 the processes forming the current groundwater chemistry in the irrigation district can be formulated as mixing evaporation water rock interaction the mixing proportions of rainfall irrigation water from the jing river and lateral recharge from the nonirrigated areas were approximately 30 49 and 21 respectively the evaporation ratio based on the tds was 3 83 when comparing groundwater in the irrigation district with the mixed water after evaporation 3 hydrogeochemical modeling indicated that the dissolution of halite 22 445 t a and gypsum 29 972 t a and the precipitation of calcite 31 178 t a and dolomite 338 73 t a resulted in changes in the hydrochemical types from the nonirrigated areas to the irrigation district particularly in this area with an irrigation history of more than 2260 years a new finding of this study is that the introduction of water for irrigation will lead to the escape of co2 from groundwater 4 estimated using darcy s law it takes approximately 260 years for groundwater to migrate through the nonirrigated areas and another 2180 years for it to move through the irrigated district therefore some old irrigation water was present in the irrigation district and it influenced the current groundwater chemistry 5 the lesson learned from this irrigation district is that long term irrigation will lead to salinization and complexity of the groundwater hence in the water resource management of irrigation districts attention should not only be paid to the balance of water quantity but also to the balance of salts and the hydrochemical processes of groundwater credit authorship contribution statement yanyan gao writing original draft jie chen review editing hui qian review editing haike wang methodology wenhao ren investigation wengang qu investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research was supported by national natural science foundation of china 42102288 41931285 42007184 41790441 41572236 fundamental research funds for the central universities 300102291105 300102291401 300102291402 300102291507 the programme of introducing talents of discipline to universities b08039 and natural science basic research program of shaanxi 2020jq 352 2019jlz 03 their support is gratefully acknowledged appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127437 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3652,a comprehensive understanding of groundwater chemistry and its evolution in irrigation districts is essential for irrigation management in this study with emphasis on a comparison between irrigated and nonirrigated areas the groundwater chemistry and hydrogeochemical processes of a typical irrigation district with an irrigation history of over 2260 years were studied to clarify the effects of long term irrigation on groundwater quality based on 107 water samples collected from across the study area a comprehensive analysis was conducted using multivariate statistics stable isotope analysis and hydrogeochemical modeling the results showed that the variation range and average concentrations of almost all the ions in the irrigation district are much greater than those in the nonirrigated areas the groundwater in the nonirrigated areas could be characterized by low tds and hco3 or hco3 so4 types whereas the groundwater in the irrigation district could be characterized by complex water types and high tds stable isotopes of hydrogen and oxygen indicated that the groundwater in the irrigation district experienced strong evaporation the calculated groundwater residence time showed that it takes approximately 2180 years for the groundwater to flow through the irrigation district some old irrigation water was present and it influenced the current groundwater chemistry in the study area the processes forming the current groundwater chemistry in the irrigation district can be formulated as mixing evaporation water rock interaction for mixing the proportions of rainfall irrigation water from the jing river and lateral recharge from the nonirrigated areas were found to be approximately 30 49 and 21 respectively for evaporation the ratio based on the tds was 3 83 when comparing the groundwater in the irrigation district with the mixed water after evaporation hydrogeochemical modeling showed that the irrigation area is a potential carbon source the dissolution of halite and gypsum the precipitation of calcite and dolomite co2 degassing and na ca exchange are the main chemical reactions in the geochemical evolution of groundwater the lesson learned from this irrigation district is that long term irrigation will lead to salinization and complexity of the groundwater hence in the water resource management of irrigation districts attention should not only be paid to the balance of water quantity but also to the balance of salts and the hydrochemical evolution of groundwater keywords long term irrigation hydrogeochemical processes jinghui canal irrigation district stable isotope hydrochemical modelling 1 introduction groundwater is an indispensable resource and it is also the main source of water for agriculture industry ecology and daily life particularly in arid and semi arid areas jha et al 2020 li et al 2015 clean groundwater is not only fundamental for human health economy and social development but also has an important impact on agricultural production safety and ecological environment esmaeilbeiki et al 2020 gao et al 2020a the expansion of irrigated agriculture is essential to feed a growing global population pea arancibia et al 2020 singh 2021 irrigation however is a large scale and long term human intervention that alters the natural water cycle conditions without a comprehensive understanding of the impact of irrigation activities this expansion may lead to environmental problems such as groundwater quality deterioration or soil salinization posing threats to agricultural production safety human health and even social stability rezaie balf et al 2020 singh 2021 zhou et al 2020 jha et al 2020 li et al 2015 esmaeilbeiki et al 2020 gao et al 2020a currently more than 20 of the global irrigation area is facing waterlogging and groundwater quality deterioration mao et al 2020 salmoral et al 2020 and the cultivated land affected by salinization in china has been as high as 566 000 km2 if left unattended the problem could expand to more than 50 of the world s irrigated area by 2050 singh 2021 in mesopotamia where the tigris and euphrates rivers formed long term irrigation induced soil salinization had led to the demise of the ancient mesopotamian civilization zhang and zhang 2003 therefore understanding the impacts of long term irrigation on groundwater systems is of great significance for ensuring sustainable agricultural development chen et al 2016 chen et al 2020b esmaeili vardanjani et al 2015 li and qian 2018 li et al 2015 pazand et al 2018 groundwater chemistry and its formation processes are critical to understand the evolution of a groundwater system and to clarify the interaction between groundwater and irrigation water chen et al 2020a li et al 2018 zhu et al 2020 generally the chemical components of groundwater are primarily controlled by atmospheric precipitation evaporation and water rock interactions cao et al 2020 jiang et al 2015 pant et al 2018 wang et al 2017 however with intense and long term agricultural activities the quality of irrigation water has an increasingly strong impact on the hydrochemical characteristics of groundwater in the irrigation district specifically irrigation not only changes the hydrodynamic conditions of the irrigation district but also introduces chemical substances into the irrigation district promoting mixing evaporation and various physical chemical and biological reactions in the aquifer system chen et al 2020c qin et al 2011 generally groundwater chemistry changes gradually under natural conditions while human activities such as irrigation may change or accelerate hydrochemical evolution thus with the superimposed influences of historical natural evolution and irrigation water clarifying the hydrochemical characteristics of groundwater and its formation mechanism in irrigation districts is challenging nevertheless studying the groundwater in nonirrigated areas can help reveal the natural evolution of the groundwater chemistry which can help identify the influence of irrigation water on the groundwater system by a comparison with groundwater in the irrigation district the jinghui canal irrigation district in china is one of the oldest canal irrigation districts in the world its irrigation history is over 2260 years dating back to 246 bce the canal water in the jinghui canal irrigation area comes from the zhangjiashan reservoir situated in the jing river northwest of jingyang county gravity irrigation is adopted and the area is dominated by natural terrain liu et al 2016 due to the high terrain the loess plain in the north of the study area has no canal irrigation while the river terrace and alluvial plain in the south have been irrigated since 246 bce i e during the qin dynasty because of the long term heavy dependence on surface water for agricultural irrigation and the poor drainage system historically the hydrological conditions in the irrigation areas have accordingly changed and the groundwater has currently become saline the groundwater quality issues in this irrigation area has attracted the attention of scholars for example liu et al 2013 investigated the temporal variation in the hydrochemical characteristics from 1990 to 2009 and concluded that groundwater has evolved from the hco3 type to the so4 type in the irrigation district zhang et al 2018 2019 undertook a human health risk assessment of groundwater nitrogen pollution and concluded that groundwater in the jinghui canal irrigation district is seriously polluted by th tds so4 2 cl and no3 due to intense and extensive industrial and agricultural activities however these studies only focused on the temporal variations in the hydrochemistry or on the effects of irrigation on a particular ion i e no3 or as the differences in the hydrochemistry between irrigated and nonirrigated areas the regional influence of irrigation particularly long term irrigation on hydrochemical processes and factors controlling the hydrogeochemistry have not been clearly elucidated therefore our research mainly focuses on the effects of long term irrigation on the groundwater system by clarifying the controlling factors and hydrogeochemical processes of groundwater chemistry with emphasis on the comparison between irrigation district and nonirrigated areas on this basis this study takes historical references to propose reasonable management recommendations for the sustainable development of irrigation districts 2 study area 2 1 landform and hydrology jingyang county is located at the center of guanzhong plain shaanxi province extending over an area of 780 2 km2 108 29 40 108 58 23 e 34 26 37 34 44 57 n fig 1 the topography in the area slopes from the northwest nw to the southeast se with altitudes between 361 and 1614 m fig 1 the landforms in the area mainly comprise mountains loess tableland flat alluvial plains and river terraces the mountains located in the north of jingyang county account for 12 4 of the total area of the county the irrigation district is mainly located in flat alluvial pains and river terraces accounting for 64 5 of the total area while nonirrigated areas are mainly located in loess tablelands accounting for 23 1 of the total area gao 2020c the study area has a relatively extensive river system with major rivers including the jing river the yeyu river and the qing river the xijiao reservoir located in the main stream of the qing river is the only regulating reservoir in the jinghui canal irrigated district which was built in 2003 the surplus water from the jing river in the nonirrigated period was diverted to the reservoir which significantly improved the situation of insufficient irrigation water in the irrigation district jing river is the largest river in the study area with an annual average runoff of 19 21 108 m3 and an average annual sediment transport of 2 526 108 t as the main source of irrigation water the annual average available irrigation water diverted from jing river is 2 2 108 m3 shaanxi provincial department of water resources 2019 kang 2021 the county is characterized by a temperate continental semi arid monsoon climate with average annual temperature precipitation and evaporation of 13 1 548 7 mm and 995 17 mm respectively the rainfall and temperature show large seasonal fluctuations in the study area the summer lasts from june to august with the highest air temperature reaching 41 4 winter is cold lasting from december to february with the lowest temperature reaching 20 8 the annual rainfall varies from 349 2 to 829 7 mm with the maximum rainfall in september according to local records of jingyang county http www snjingyang gov cn jydq htm 2 2 geology and hydrogeology quaternary sediments cover the entire study area including alluvial alluvial pluvial eolian and alluvial lacustrine deposits the bedrock in the mountain areas in the north of the study area is dominated by cambrian and ordovician limestone the phreatic water in the study area mainly includes unconsolidated sediments pore water and bedrock fissure water the bedrock fissure water is distributed only in the northern mountain areas and the loess hilly region while the pore water is mainly distributed in alluvial plains river terraces and the loess aquifer the loess aquifer in the loess tableland is characterized by deep groundwater approximately 10 80 m while the water depth in the alluvial plains and river terraces is typically less than 36 m precipitation leakages of the canal system and return flow from irrigation are the main recharge sources for the groundwater generally the groundwater flows from the mountains and the loess tableland to the river terraces fig 2 in recent years due to over exploitation in the river terraces the groundwater level has rapidly decreased and the river now recharges the groundwater in the downstream area of the jing river 2 3 irrigation history drought has been a major problem in the guanzhong plain since ancient times based on historical records drought had occurred 127 times in this region from 1080 bce to 1923 ce and the average occurrence period is approximately 24 years in the last hundred years droughts were more frequent and the occurrence period of extreme drought is 10 years the chorography of jinghuiqu canal 1991 therefore diversion irrigation has been a basic policy to solve the drought problem and ensure food security in all countries lu et al 2020 in the study area a canal system was constructed in 246 bce by diverting water from the jing river to solve the drought problem and to develop agriculture opening the way for diversion irrigation he 2011 this canal system was originally named zhengguo canal after the person who established the system zhengguo canal in shaanxi dujiangyan in sichuan and ling canal in guangxi are three famous ancient water conservancy projects in china you et al 2018 the zhengguo canal irrigation district was built in the qin dynasty flourished in the han and tang dynasties and kept developing in the song yuan ming and qing dynasties according to the jinghui canal chronicles the irrigated area was approximately 760 km2 in the beginning qin dynasty because of wars and historical changes the irrigation area changed significantly during the han 95 bc tang 655 ce song 991 ce yuan 1308 ce ming 1375 ce and qing 1669 ce dynasties decreasing to a mere 50 km2 in the qing dynasty approximately 1737 ce fig 3 in the late 1920 s agricultural production was severely affected by successive years of drought hydraulic scientist li yizhi begun to rebuild the canal system in the 1930 s to ensure food security and the irrigation district was extended to its current area of 970 km2 the canal systems rebuilt in 1930 s were renamed as jinghui canal liu et al 2016 regardless of how the irrigation area changed the river terraces in jingyang have always been irrigated the chorography of jinghuiqu canal 1991 after the reconstruction in 1930s due to the considerable water diversion irrigation the groundwater level in the irrigation area increased year by year and serious soil salinization occurred in the southeast of the study area therefore drainage systems were constructed to alleviate salinization from 1937 to the 1980s and well canal conjunctive irrigation began in 1950 and widely implemented after 1990s the chorography of jinghuiqu canal 1991 3 materials and methodology 3 1 sample collection the samples were collected from across the study area in august 2016 including 104 groundwater samples and three water samples from the jing river the groundwater samples were collected from domestic and agricultural wells prior to sampling the wells were continuously pumped for at least 10 15 min and the sample bottles were thoroughly rinsed thrice with groundwater from the sampling wells the sample bottles were filled to the top and immediately sealed to minimize sample exposure to air water temperature ec ph tds were measured in the field using a portable water testing kit ddb 350 leici company of china the sample collection storage transportation and analysis were all undertaken with strict adherence to the standards of the ministry of health of the people s republic of china prc all the major ion measurements and isotopic analysis were conducted by the water and soil testing center of shaanxi institute of engineering prospecting in accordance with the standard testing methods major cations ca2 and mg2 and so4 2 were measured using edta 2na titration with a detection limit of 1 0 mg l flame atomic absorption spectrometry was used to analyze k and na with detection limits of 0 05 and 0 01 mg l respectively hco3 and co3 2 were measured by titration with a detection limit of 2 0 mg l silver nitrate titration was used to analyze cl with a detection limit of 1 0 mg l the accuracy and reliability of the analysis were verified by calculating the charge balance error cbe of each sample the results for the samples showed a cbe less than 5 indicating the reliability of the analysis results the hydrogen and oxygen stable isotopes in h2o were analyzed using a liquid water isotope analyzer iwa 35 ep lgr the measured stable isotope data were expressed in per mil units using the delta  notation relative to the vienna standard mean ocean water vsmow the analytical precision values were 0 6 and 0 2 for 2h and 18o respectively 3 2 multivariate statistical analysis the hierarchical cluster analysis hca is a statistical method for classifying variables with similarities the hca can reduce the dimensionality by determining the typical variables of each cluster one of the advantages of the hca compared with graphical methods is that it is a data driven method that can unambiguously assign each sample into a single water quality category without pre determining the final number of groups or pre assuming the factors that might control categorization daughney et al 2011 gler et al 2002 the hca results can therefore be readily interpreted in geological and hydrochemical contexts daughney et al 2011 the method has been widely used in previous studies gler et al 2002 li et al 2018 moeck et al 2016 for the hca although a wide range of clustering techniques are available the most common methodology used to obtain the distance with linkage rules is the euclidian distance combined with ward s method daughney et al 2011 moeck et al 2016 wu et al 2013 ward s method evaluates the distances between clusters using an analysis of variance and forms the smallest distinct clusters by calculating the error sum of the squares according to gler et al 2002 this approach produces the most distinctive groups where the members within the group are more similar to each other in this study the hca based on the euclidean distance along with ward s linkage method was applied to classify groundwater samples into homogeneous groups through the spss software the clusters of groundwater samples can be helpful to objectively evaluate the differences in the groundwater chemistry in nonirrigated and irrigated areas 3 3 hydrogeochemical modeling hydrogeochemical modeling is a useful tool to clarify the evolutionary processes in groundwater systems an inverse modeling was performed between the initial and final solutions along the flow paths revealing the occurrence of physiochemical processes chen et al 2020a the precondition for establishing a hydrogeochemical model is to determine the chemical reactions occurring in the groundwater system therefore the factors controlling the groundwater chemistry are first identified through an ionic ratio analysis and hydrochemical methods the basic idea of the hydrogeochemical modeling is as follows 1 initial water chemistry reactants final water chemistry products the reactants and products in equation 1 are substances entering or leaving the solution phase during the reaction process generally various combinations of the reactants and products can satisfy equation 1 it is necessary to determine the most likely reactants and products under this condition based on the lithology geology and hydrogeological conditions of the study area in this regard the calculation results of the saturation index si can provide important reference information in this study the precipitation irrigation water and upstream groundwater serve as sources of the initial water chemistry that is the initial solution is a mixture water mw while the final solution is the groundwater in the irrigation district given that the studied region is in a semi arid area extensive evaporation can result in salt accumulation in shallow groundwater to calculate the net chemical reaction in a groundwater system a virtual solution vs was introduced to represent the mixture water after evaporation according to equation 1 assuming that the dissolution amounts of the minerals are x 1 x 2 xn mmol l during the hydrogeochemical processes and that the increment in the i th element in the final water chemistry is bi mmol l compared with the initial water chemistry the following expression can be written 2 j 1 n a ij x j b i i 1 2 n where aij is the stoichiometric number of i th elements relative to the j th mineral to realize hydrogeochemical modeling the ideas proposed by qian et al were used qian et al 2009 qian et al 2011 chen et al 2020a the authors used this method to study the formation processes of the chemical components of lakes and rivers in arid areas of china 4 results 4 1 hydrochemical characteristics 4 1 1 chemical composition and hydrochemical facies table 1 presents a summary of the basic statistics of the physicochemical data of the water samples collected from nonirrigated areas irrigation district and jing river the violin plot of the groundwater samples fig 4 shows that the distribution of the various ions in the irrigation district is evidently wider than that in the nonirrigated area suggesting a complex and notable spatial difference in the hydrogeochemical characteristics of the study area additionally except ph and hco3 the average concentrations of almost all the ions in the irrigated areas are much higher than those in the nonirrigated areas and some of them even exceed the acceptable limits for drinking water indicating poor groundwater quality in the irrigation district specifically the 25th percentiles of the tds in the irrigation district are much higher than 1000 mg l indicating the prevalence of brackish water whereas the groundwater in the nonirrigated areas is more diluted and has a low tds for both the districts the ph values ranged from 6 9 to 8 5 indicating that groundwater across the study area was generally neutral to slightly alkaline to reveal the similarities and differences between water samples a piper trilinear diagram was created piper 1944 as shown in fig 5 most of the samples collected from irrigation district are plotted in zone b of the lower two triangles indicating mixed type however samples from the nonirrigated areas are mostly located in zone d of the lower left triangles and zone e of the lower right triangle indicating that na and hco3 are the dominant cation and anion respectively as for the jing river water the dominant cation is na and the anion is mixed type furthermore notably the jing river samples plotted among zones i and ii are similar to the hydrochemical type of the groundwater in the irrigation district but were quite different from the samples collected from the nonirrigated areas this finding can be attributed to the long term irrigation performed using water from the jing river 4 1 2 hydrochemical evolution the hca results show four major clusters c1 c4 clearly distinguishable from each other based on a phenon line with a linkage distance of 10 fig 6 similarities between the hydrochemical characteristics of c1 and c2 can be expected because of the slightly higher linkage distance of approximately 12 however the samples from clusters c1 and c2 are linked to clusters c3 and c4 at an elevated linkage distance of 15 indicating a wider variation in the hydrochemical components between c1 c2 and c3 c4 based on stiff diagrams na and hco3 are predominant in c1 while the percentages of mg2 so4 2 and cl gradually increase in the order c1 c2 c4 c3 in particular the hydrochemical types of c3 became mixed type so4 cl na mg type the spatial distributions were helpful for understanding the relationships between these four clusters as shown in fig 7 along with the groundwater flow direction the distribution of the four clusters is c1 c2 c4 and c3 combined with stiff diagrams the transition of c1 c2 c4 c3 reflects a common natural salinization process from upstream to downstream in the semi arid area wu et al 2017 in other words the hydrochemical types of groundwater gradually transformed from bicarbonate type to sulfate or chloride type specifically c1 is mainly located in nonirrigated loess tablelands which are characterized by a high groundwater depth greater than 25 m the groundwater in this area is mainly recharged by the lateral flow from mountainous regions however some of the water samples taken from the low lying areas of the loess tableland are clustered into c4 rather than c1 because they are relatively shallow and easily affected by human activities the other three clusters are mainly distributed in the irrigation district in terms of the topography the samples from c2 are mainly located in the junction zone of the two different landforms and those from c3 are mainly located in the first terrace or around the xijiao reservoir having a shallow groundwater table while those from c4 are widely distributed in the second or third terraces of the jing river and the alluvial proluvial plain the geochemistry of the groundwater near rivers with a shallow groundwater table i e c3 is expected to be strongly associated with irrigation water and intense evaporation additionally the spatial change in the hydrochemistry is helpful to visually identify the differences between the different regions and further explain the influence of irrigation activities therefore the spatial variations in the tds and hydrochemical types including cation anion and hydrochemistry were plotted using arcgis 10 8 as shown in fig 8 the results showed that the groundwater in the nonirrigated areas can be simply characterized by low tds and hco3 or hco3 so4 types consistent with the piper diagram shown in fig 5 without irrigation precipitation and lateral flow are the main sources of groundwater recharges in the nonirrigated area in addition due to the thick loess and deep groundwater level human activities have little influence on groundwater making this a largely natural water cycle system as for the groundwater in the irrigation district its hydrochemical type is more complex with a high tds only from the anion types of the groundwater their types have diverse and complex characteristics such as hco3 so4 cl so4 hco3 cl or cl hco3 so4 type fig 8c if the cation types were included it would be much more complicated as shown in fig 10 d the hydrochemical type in the irrigation district is generally characterized by mixed type different from the nonirrigated loess tableland the flat terrain in the irrigation district makes the groundwater to flow gradually thus prolonging the water rock reaction additionally the recharging of the irrigation water disturbs the natural water cycle system raising groundwater levels at some locations and resulting in salt accumulation under intense evaporation 4 1 3 stable isotopes the stable isotope method is an important technique to clarify the recharge sources of groundwater huang et al 2017 jia et al 2020 mohammed et al 2014 if groundwater were recharged by different sources or under different evaporation conditions the relationship curves between 18o and d should have different slopes and intercepts fig 9 shows the relationships between 18o and d for the water samples for groundwater in the nonirrigated loess tablelands 18o and d values ranged from 9 7 to 7 3 average value of 8 9 and from 73 3 to 62 5 average value of 67 9 respectively the 18o and d values of the groundwater in the irrigation district varied between 9 5 and 8 0 average value of 8 6 and between 66 9 and 59 6 average value of 63 1 respectively additionally it is evident that the stable isotope values of the groundwater in the irrigated area are significantly higher than those of the groundwater in the nonirrigated area and the best fit line slope 3 73 for the irrigated area data is significantly lower than that for the nonirrigated area groundwater slope 6 38 the lmwl and gmwl indicating the influence of strong evaporation in the irrigated area additionally the average isotopic values of the jing river 18o 8 7 d 63 2 are similar to those of the groundwater in the irrigation district 18o 8 6 d 63 1 indicating that surface water is the main recharge source for groundwater through irrigation activities 4 2 controlling factors of groundwater chemistry 4 2 1 evaporation a gibbs diagram was proposed gibbs 1970 to reveal the factors controlling the dissolved salt composition in the water the ratios of na na ca2 and cl cl hco3 relative to the tds commonly illustrate three natural mechanisms in water atmospheric precipitation rock weathering and evaporation adimalla et al 2020 chen et al 2021 as shown in fig 10a and 10b rock weathering followed by evaporation are the main factors influencing groundwater evolution of c1 in the nonirrigated loess tableland for the other three clusters particularly c3 the high ratios of cl cl hco3 indicate that the groundwater was mainly controlled by evaporation in the irrigation district which correspond to the characteristics of stable isotopes due to large scale and long term irrigation and poor drainage the groundwater level generally increased in the irrigation district leading to intense evaporation of the groundwater the direct consequences are the high tds and serious soil salinization since 1990 s although the groundwater table declined because of the heavy exploitation due to the high background values of the ions in soil and groundwater formed during the long irrigation history gao et al 2020b the tds of the groundwater remains high particularly in low topography areas in 2003 the construction of the xijiao reservoir which diverted water from the jing river changed the groundwater condition near it the leakages from the reservoir changed not only the groundwater level but also the hydrochemistry around the reservoir the majority of samples from c3 were mainly distributed in areas surrounding the reservoir and in areas typically having a shallow groundwater with a depth of less than 15 m 4 2 2 mineral dissolution precipitation the evaporation process causes the concentration of all the ions to increase proportionally and cannot change the hydrochemical types in the groundwater system the hydrochemical types of waters are mainly influenced by mineral dissolution or precipitation the saturation index si is a vital parameter to reveal the dissolution or precipitation trend of a mineral si log10 iap k which is calculated using the phreeqc software in this study crerar 1975 li et al 2012 from the calculated si fig 10c the values of all the groundwater samples for calcite and dolomite are greater than zero indicating precipitation of these carbonate minerals in contrast the si values of gypsum and halite were less than zero and they increased with the increase in the tds indicating the dissolution trend of these minerals therefore the dissolution of these minerals results in an increase in the concentrations of so4 2 ca2 na and cl in groundwater and the increase in the ca2 concentration potentially causes further precipitation of the carbonate minerals along the flow path and reduces the hco3 concentration the ionic ratios provide useful information that help identify water with lithogenic origins chen et al 2020a the ca2 mg2 ratios can be used to depict the dissolution of calcite and dolomite fig 10d if the concentration of ca2 is higher than that of mg2 calcite has a greater contribution and vice versa the majority of samples are located above the 1 1 line indicating the dominance of dolomite consistent with the presence of limestone and dolomite in the bei mountain of the study area notably the sidol and sical values of all the water samples are higher than zero indicating the continuous precipitation of dolomite and calcite in the groundwater system thus the ca2 and mg2 concentrations should decrease with the precipitation of dolomite and calcite however the ca2 and mg2 concentrations in the irrigation district are much higher than that in the jing river and nonirrigated areas table 1 indicating the potential importance of intense evaporation on hydrochemical evolution 4 2 3 cation exchange the ratio of na cl is considered an important hydrogeochemical indicator in characterizing the concentration of na in groundwater and determining the origin of the groundwater li et al 2012 mirzavand et al 2020 the na cl ratio should be equal to 1 if halite dissolution is dominant wei et al 2017 however as shown in fig 10e almost all the groundwater samples are located below the 1 1 line indicating that na has other sources such as ion exchange or silicate weathering the loess and alluvial sediments are rich in clay minerals making cation exchange a potential factor affecting the concentration of cations in groundwater li et al 2012 thapa et al 2018 the ion exchange and reverse ion exchange between ca2 and na can be expressed by the following reactions respectively li et al 2018 ca2 2nax 2na cax2 2na cax2 2nax ca2 the plot of na k cl versus ca2 mg2 hco3 so4 2 in meq l can be used to assess the possible role of ion exchange in the groundwater system the results of our analysis fig 10f indicate that the groundwater samples of the four clusters have a slope of approximately 1 indicating that ion exchange strongly influences the groundwater chemistry in the study area li et al 2018 yidana and yidana 2009 4 3 hydrogeochemical processes considering the discussion above the processes forming the present groundwater chemistry should be mixing evaporation water rock interaction mixing means that when irrigation water is introduced into the study area it will be mixed with the original groundwater flowing into the area from the upstream and the precipitation infiltrating into the ground evaporation means that because of the shallow water depth caused by long term irrigation the groundwater in the irrigation district will be evaporated water rock interaction means when the groundwater is dominated by evaporation some chemical reactions occur that change the groundwater chemistry to investigate these processes quantitatively the key problems lie in determining the mixing proportion and the evaporation ratio and in defining the initial water chemistry final water chemistry and the reactants and products 4 3 1 estimation of mixing proportion and evaporation ratio the water sources entering the irrigation area include infiltrated irrigation water rainfall and groundwater from the upstream nonirrigated area based on the calculated water balance in the jinghui canal irrigation district gao 2020c the proportions of rainfall irrigation water from the jing river and lateral recharge from the nonirrigated areas are approximately 30 49 and 21 respectively thus the hydrochemical characteristics of the groundwater in the irrigation district is in fact the result of evaporation and chemical reactions on the basis of this mixed water from the proportions and chemical composition of the three recharge water sources the ion concentrations of the mixed water mw were calculated and listed in table 2 by comparing the hydrochemical characteristics of the groundwater in the irrigation district id and that of the mixed water mw calculated some clues can be obtained for estimating the evaporation ratio for example the concentrations of na mg2 cl and so4 2 of id are 4 35 3 76 5 41 and 4 87 times higher than that of mw respectively however the concentrations of ca2 and hco3 of id are only 2 60 and 2 64 times higher than those of mw respectively which are much lower than the above ion concentrations hence where did ca2 and hco3 go during evaporation this naturally suggests the precipitation of calcite which is also consistent with the super saturation of calcite additionally based on the si values the water solutions of mw and id are under saturated by halite and gypsum and super saturated by dolomite which shows the precipitation trend of dolomite and dissolution trend of halite and gypsum during the evaporation processes thus the evaporation ratio is overestimated using the ratios of id mw na cl or so4 2 4 35 5 41 or 4 87 and is underestimated using the ratios of ca2 mg2 or hco3 2 60 3 76 or 2 64 therefore the evaporation ratio of the groundwater in the irrigation district should range between 3 76 and 4 35 because the changes in the tds can comprehensively reflect the precipitation or dissolution of minerals as well as the change in the ion concentrations the ratio of tds 3 83 can be used to represent the evaporation ratio this ratio is only in the range of 3 76 4 35 4 3 2 hydrogeochemical reactions modeling given the estimated mixing proportion and evaporation ratio the initial water chemistry in the hydrogeochemical model can be defined as mixed water after evaporation and the final water chemistry is simply defined as the representative groundwater in the irrigation district the chemical composition of the initial water chemistry calculated using the determined evaporation ratio 3 83 is listed as vs in table 4 compared with the final water chemistry there are considerable differences between the two mainly controlled by the chemical reactions in the groundwater system considering the geology and si values of minerals the main chemical reactions forming the groundwater composition of the id are believed to be the dissolution of halite and gypsum the precipitation of calcite and dolomite and the escape of co2 however the dissolution of halite cannot fully explain the varying degrees of increase in the na and cl concentrations and ca2 is evidently insufficient to precipitate the related carbonate mineral therefore considering the large amount of clay sediments in the loess stratum the cation exchange between na and ca2 eq 8 is used to explain these changes thus the main chemical reactions forming the groundwater chemistry in the irrigation district are as follows 3 nacl halite na cl 4 caso4 2h2o gypsum ca2 so4 2 2h2o 5 ca2 co3 2 caco3 calcite 6 ca2 mg2 2co3 2 camg co3 2 dolomite 7 h2co3 h2o co2 8 2nax ca2 cax2 2na from eq 2 the values of the stoichiometric coefficient aij are listed in table 3 by solving eq 2 the corresponding contribution of each chemical reaction for the water chemistry evolution can be obtained table 4 halite dissolution is the most in the system occurring at a rate of 3 92 mmol l resulting in a dramatic increase in the cl concentration compared with the other ions similarly gypsum dissolution 1 79 mmol l contributes to the increase in so4 2 in groundwater in the irrigation district and the precipitation of calcite and dolomite as well as the escape of carbon dioxide result in a decrease in the hco3 concentration compared with the vs these chemical reactions led to changes in the groundwater type which was hco3 type in the recharge area but changed to mixed type in the irrigation district for the cations a dissolution of 3 92 mmol l of halite and 0 92 mmol l na ca exchange resulted in a general increase in the na concentration although the ca2 concentration would increase with gypsum dissolution 1 79 mmol l and cation exchange 0 92 mmol l the large amount of calcite precipitation at a ratio of 3 24 mmol l led to a sharp decrease in the ca2 concentration therefore the dominant cation of the groundwater in the irrigation district changed to na on this basis the corresponding contributions of the chemical reactions to the hydrochemical evolution are quantitatively determined table 4 the results are consistent with the qualitative analysis described in section 4 2 that is in addition to the evaporation the dissolution of halite and gypsum the precipitation of calcite and dolomite and the escape of co2 are the primary chemical reactions in the process of groundwater chemistry evolution moreover na ca exchange contributes to the changes in the cation concentration fig 11 5 discussion a comparison of the statistics and hydrogeochemical characteristics show that two evident characteristics can be distinguished for groundwater in the irrigation district i more complex hydrochemical types and ii high tds and poor groundwater quality irrigation activities inevitably alter the original hydraulic condition and groundwater chemistry resulting in significant differences in the hydrochemical characteristics between irrigated and nonirrigated areas meanwhile the groundwater in the irrigation district is recharged by multiple sources including irrigation water from the jing river upstream groundwater from nonirrigated areas and precipitation therefore whether the current groundwater chemistry in the irrigation district is mainly the result of natural reactions or long term irrigation activities remains unclear is it more related to recent irrigation water or the historical effects from thousands of years of irrigation water what is the leading factor in the formation of current groundwater chemistry in irrigation district all these aspects require further investigation and discussion 5 1 effects of current irrigation water the recharge of groundwater in the irrigation district has three main sources lateral runoff from nonirrigated areas irrigation water of jing river and precipitation if the groundwater in the irrigation district is mainly recharged by the lateral runoff of nonirrigated areas the 18o and d values of the groundwater in the irrigation district should be on a line passing through the points of the groundwater samples from nonirrigated area and with a slope of 3 73 groundwater evaporation fractionation slope in the irrigation district as well as heavier isotope values as shown in fig 9 this cannot be achieved by the evaporation of groundwater in the nonirrigated area on the contrary the groundwater samples from the irrigation district are mostly located above the points of the nonirrigated area groundwater and are similar to that of jing river moreover the average values of 18o and d of the groundwater in the irrigation district are significantly higher than those of the groundwater in the nonirrigated area and are similar to those of the irrigation water jing river indicating that the groundwater in the irrigation district is mainly recharged by irrigation water therefore the stable isotopic signatures to a great extent positively confirm the significant influence of irrigation water on the groundwater in the irrigation district and its hydrochemical characteristics are of course affected by irrigation water the hydrochemical characteristics also prove the primary influence of irrigation activities as shown in fig 8 b the main cations of the nonirrigated area and irrigation district are na and na mg respectively suppose the groundwater in the irrigation district is mainly recharged by the upstream groundwater of nonirrigated area the groundwater of the irrigation district should be characterized by na type with a higher concentration of sodium rather than na mg type the piper diagram fig 5 reveals a higher proportion of mg or ca in the jing river which is similar to the groundwater in the irrigation district thus the greater influence of the irrigation water on the groundwater evolution is also proven by the hydrochemical characteristics 5 2 effect of old irrigation water irrigation activities have lasted for 2260 years in the study area is it more related to recent irrigation water or the historical effects from thousands of years of irrigation water this question may be answered by calculating the water resident time by darcy s law based on the groundwater level contour map of the study area fig 2 the hydraulic gradients in the nonirrigated area and irrigation district are 8 979 and 2 077 respectively based on the permeability test in the field and parameter calibration using the numerical model the horizontal permeability coefficient and effective porosity of the loess in the study area are 1 2 m d and 0 11 respectively peng et al 2012 by darcy s law wang et al 2020 the flow velocity in the nonirrigated areas is 0 010775 m d and it requires approximately 260 years for the groundwater to migrate from the piedmont of beishan to the edge of the irrigation district however due to the flat terrain the flow velocity in the irrigation district is only 0 002492 m d and it requires approximately 2180 years for the groundwater to migrate through the irrigation district to the jing river notably this is only the average flow velocity of the groundwater due to intensive heterogeneity of the aquifer and the strong hydrodynamic dispersion effect the fast flowing groundwater has already flowed out of the irrigation district in the past 2180 years while the slow flowing groundwater still remained in the irrigation district at the same time after the completion of the irrigation project the irrigation activities in the irrigation district continued for 2260 years therefore a large amount of old irrigation water thousands of years remained in the groundwater system and the old irrigation water still has a legacy impact on the hydrochemical characteristics of current groundwater in the irrigation district 5 3 effects of chemical reactions how does the dissolution or precipitation of minerals affect the hydrochemical characteristics of groundwater in the irrigation district this effect can be illustrated by reviewing the dissolution or precipitation amounts of the main minerals halite gypsum calcite dolomite cation and co2 based on the results of hydrogeochemical reaction modeling along the flow direction from nonirrigated areas to irrigation district every one liter of mixture water will dissolve 3 92 and 1 79 mmol of halite and gypsum respectively while simultaneously precipitating 3 24 and 0 08 mmol of calcite and dolomite and releasing 1 54 mmol of co2 the average annual total recharge to groundwater is 9622 99 104 m3 a including the infiltration of precipitation and irrigation water as well as the lateral runoff the first hydrogeology engineering geological team of shaanxi geology and mineral resources exploration and development bureau 1996 therefore the amounts of halite and gypsum dissolved will be 22 445 and 29 972 t a respectively the amounts of calcite and dolomite precipitation will be 31 178 and 338 73 t a and 6 521 tons of co2 will be released from the irrigation district every year the dissolution of halite and gypsum in such large amounts every year will inevitably have a significant influence on the na cl and so4 2 concentrations of groundwater in the irrigation district additionally the largest amount of calcite precipitation will significantly decrease the hco3 concentration resulting in changes in the hydrochemical types along the flow direction from nonirrigated areas to irrigation district in particular in this area with an irrigation history of more than 2260 years the hydrochemical characteristics of groundwater in nonirrigated areas and irrigation district have displayed evident differences significantly a new finding of this study is that the introduction of water for irrigation will lead to the escape of co2 from groundwater in other words this special irrigation district is a potential carbon source 5 4 comparison with a young irrigation district the baojixia irrigation district is adjacent to the western side of jinghui canal irrigation district both baojixia and jinghui canal irrigation districts are located in the guanzhong plain with similar climate and geological conditions however the baojixia irrigation system was established in 1971 and only operated for 50 years until now based on a study on the groundwater chemistry in the baojixia irrigation district conducted by jia et al 2020 the mean value of the tds is 856 mg l and the hydrochemistry types are hco3 na hco3 so4 na and hco3 na mg evidently the groundwater in the jinghui canal irrigation district with over 2260 years of irrigation history shows more complex hydrochemical types and higher tds concentrations of 1790 mg l than that in the young irrigation district indicating the long term effects of irrigation water on groundwater quality and chemistry groundwater is a crucial source for daily life and agricultural use in arid and semi arid areas with the rapid development of the region the demand for water resources will increase in the future an analysis of the hydrogeochemical characteristics and the formation process of groundwater components in this historical irrigation area shows that the management department should pay attention to irrigation management and groundwater quality protection conventionally in irrigation district management people only pay attention to the water quantity balance but not to the salt balance let alone the contribution of chemical reactions the evaporation and chemical reaction are two crucial factors influencing groundwater salinization and high tds in irrigation districts and salinization may continue for decades centuries or even thousands of years to reverse this trend the management of groundwater salinity balance should be strengthened additionally the irrigation district is a carbon source then how about the nonirrigated areas this question should be answered in future research to make a clearer and wider understanding of the effect of long term irrigation activities on groundwater and even carbon neutrality 6 conclusions in this study the hydrochemical characteristics of groundwater in a historical irrigation district were analyzed by conducting a multivariate statistical analysis violin plots and hierarchical cluster analysis and stable isotope analysis based on a comparison of the hydrochemical characteristics between nonirrigated and irrigation areas the factors controlling the groundwater chemistry were identified through the ionic ratio analysis and hydrochemical methods subsequently a hydrogeochemical model was established to quantitively analyze the chemical reactions and gain insights into the hydrochemical processes through an in depth investigation the long term effects of irrigation on the groundwater chemistry were identified and verified the following conclusions can be drawn 1 the groundwater in the irrigation district is mixed type with a high tds whereas the groundwater in nonirrigated areas is simply characterized by hco3 or hco3 so4 with a low tds the analysis of the hydrochemistry and stable isotopes confirmed that irrigation water diverted from jing river and that the intense evaporation significantly affected the hydrochemical characteristics of the groundwater in the irrigation district 2 the processes forming the current groundwater chemistry in the irrigation district can be formulated as mixing evaporation water rock interaction the mixing proportions of rainfall irrigation water from the jing river and lateral recharge from the nonirrigated areas were approximately 30 49 and 21 respectively the evaporation ratio based on the tds was 3 83 when comparing groundwater in the irrigation district with the mixed water after evaporation 3 hydrogeochemical modeling indicated that the dissolution of halite 22 445 t a and gypsum 29 972 t a and the precipitation of calcite 31 178 t a and dolomite 338 73 t a resulted in changes in the hydrochemical types from the nonirrigated areas to the irrigation district particularly in this area with an irrigation history of more than 2260 years a new finding of this study is that the introduction of water for irrigation will lead to the escape of co2 from groundwater 4 estimated using darcy s law it takes approximately 260 years for groundwater to migrate through the nonirrigated areas and another 2180 years for it to move through the irrigated district therefore some old irrigation water was present in the irrigation district and it influenced the current groundwater chemistry 5 the lesson learned from this irrigation district is that long term irrigation will lead to salinization and complexity of the groundwater hence in the water resource management of irrigation districts attention should not only be paid to the balance of water quantity but also to the balance of salts and the hydrochemical processes of groundwater credit authorship contribution statement yanyan gao writing original draft jie chen review editing hui qian review editing haike wang methodology wenhao ren investigation wengang qu investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the research was supported by national natural science foundation of china 42102288 41931285 42007184 41790441 41572236 fundamental research funds for the central universities 300102291105 300102291401 300102291402 300102291507 the programme of introducing talents of discipline to universities b08039 and natural science basic research program of shaanxi 2020jq 352 2019jlz 03 their support is gratefully acknowledged appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127437 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3653,stratified water intake facilities are important pieces of engineering infrastructure that monitor the outflow temperature conditions of hydropower projects the outflow temperature can significantly impact the downstream eco environment and normal functioning of aquatic organisms in streams however due to the lack of scientific and effective management tools for stratified water intake and the complexity of the hydrodynamics associated with hydropower generation both the research community and operation sectors are making great efforts to explore new tools and technology to better monitor predict and control stratified intake facilities in this study surrogate models of the environmental fluid dynamics code efdc model based on the theory guided machine learning tgml paradigm are constructed these models are applied to outflow temperature prediction for the jinping i hydropower plant in china the results show that 1 the prediction precision of the high fidelity hydrodynamic and water quality efdc model is successfully emulated by a tgml model based on a long short term memory lstm algorithm and 2 the tgml model accuracy based on the mean absolute error mae value obtained using the lstm algorithm can reach 0 228 0 269 c the prediction time is less than 2 s the period of high precision prediction is 6 13 days and the model can guide the operation of stratified intake facilities in practice keywords hydropower projects stratified water intake outflow temperature theory guided machine learning model surrogate model 1 introduction in the 21st century with the rapid development of the global economy and society the demand for energy has risen sharply as a clean energy source hydropower has become a key research focus and its development and utilization are extremely important in the renewable energy domain statistics from the u s department of energy show that 27 of the growth in renewables worldwide is expected to come from hydroelectric power primarily from the construction of large scale hydropower projects u s department of energy 2016 china s hydropower development has also entered a peak period since 2000 and a number of large world class dams e g the jinping i dam xiluodu dam and nuozhadu dam have been built because of the favorable terrain conditions in southwest china according to the relevant statistics there are more than 190 reservoirs with a dam height of more than 100 m in china liu and wen 2016 by 2020 the installed hydropower capacity in southwest china reached 240 gw accounting for 70 6 of the country s total hydropower generation capacity national energy commission 2016 with the help of the west to east power transmission project national energy security has been effectively guaranteed xu 2021 although these large reservoirs could contribute to a high level of hydroelectric power generation and are beneficial for the possible reduction of carbon emissions they may cause a series of eco environmental problems petts 1985 nilsson and berggren 2000 webb et al 2008 a change in the water temperature regime is one of the adverse environmental impacts of large reservoirs tao et al 2019 water temperature is a crucial physical property of rivers and lakes and has a direct impact on almost all ecological and biogeochemical processes including chemical reaction rates oxygen solubility algal growth primary production and fish habitats carron and rajaram 2001 todd et al 2010 ren et al 2020 to reduce the negative effects on water quality and eco environment functioning caused by temperature stratification in reservoirs temperature control measures such as stratified intake devices and thermocline breaking devices are commonly used in hydropower station construction johnson and vermeyen 1993 bartholow et al 2001 deng et al 2011 stratified intake facilities change the position of the intake to discharge water that best meets the temperature demand this approach is considered an important engineering measure to mitigate the adverse ecological and environmental impacts of water temperature stratification deng et al 2011 for example in the 1990s to mitigate the adverse effects of low temperature outflows on rainbow trout a multilevel opening intake tower with a width of 76 2 m and height of 91 44 m was built at the shasta hydropower station and powerhouse in northern california usa after construction a study showed that the discharge water temperature was able to fully meet the ecological demand and the number of salmon living downstream of the shasta dam had significantly increased deng et al 2011 to date this giant intake tower structure is still the largest artificial fish protection water infrastructure worldwide stratified intakes with a stoplog gate are a new type of design that can change the intake position by stacking different layers of gates before the intake the number of stoplog gate layers can generally vary from one to four this approach is more flexible than the fixed multiposition opening intake tower i e the one used at shasta dam ren et al 2020 since 2000 stratified water intakes have been built at nearly 20 new large reservoirs in china including jinping i xiluodu wudongzhou baihetan nuozhadu etc however this new type of water intake infrastructure is still in the exploration stage and lacks mature management and modeling tools which could guide the optimal operation of the stoplog gate at present the operation and management of stoplog gates is generally based on the operating scheme proposed in the design stage which relies on the given water level conditions without consideration of the actual inflow conditions and water temperature scenarios based on in person communication with several dam operators in southwest china the current operation guidance from the stratified water intake design manual often leads to unsatisfactory operation for example the observed water temperature data of nuozhadu hydropower from 2015 to 2016 show that although the designed number of stoplog gate layers is three the water temperature demand of downstream fish spawning can be met with only one layer for xiluodu hydropower although the designed number of stoplog gate layers is four only one layer has been used in practice because of the lack of scientific guidance unfortunately the outflow water temperature of xiluodu has only increased by 0 4 c which makes it difficult to significantly improve the water temperature conditions downstream therefore there is still great space for the optimization of stratified water intake facility management it is difficult to achieve satisfactory operation with only the stratified water intake scheme formulated in the design stage addressing this gap has become an urgent engineering issue that requires scientific research development therefore this study focuses on developing a temperature prediction model for the operation management of stratified water intake facilities to predict the outflow temperature of reservoirs two major methods include empirical formulas and numerical simulations the advantages of the empirical formula method are its fast calculation speed its ease of implementation and its strong practicality however empirical formulas can only reflect the statistical trends of water temperature changes and they lack in depth physical explanations of the causes of water temperature changes thus the model results may involve large uncertainty and the prediction accuracy cannot be controlled to within a certain confidence threshold because of these drawbacks the empirical formula method is still limited in practical application in contrast the numerical simulation method encompasses our understanding of hydraulic processes and is based on decades of observations and experiments read et al 2019 in other words numerical simulation approaches could effectively avoid the drawbacks of empirical formulas and ensure high prediction accuracy kollet and maxwell 2008 in this study numerical simulation approaches remain the preferred choice for water environment prediction fatichi et al 2016 hipsey et al 2015 however due to the interactions among meteorological hydrological hydrodynamic and human activities caissie 2006 rice and jastram 2015 vliet et al 2011 ding et al 2015 chen et al 2016 making accurate predictions of the water temperature is challenging especially for large lakes and reservoirs read et al 2019 moreover the operation of stoplog gates and human factors jointly place another barrier for numerical simulation models to effectively predict the water temperature distribution finally most water temperature models are associated with complex parameter calibration procedures and high computational burdens numerical simulation models such as the ce qual w2 and environmental fluid dynamics code efdc models are high fidelity hydrodynamic and water quality models that can accurately simulate the water temperature distribution however the calculation cost of such models is high and it usually takes several hours to several days to complete a calculation alkan and eli 2009 gelda and effler 2007 in practice stratified intake facilities need to adjust the operating scheme in real time according to the inflow conditions and water temperature scenario therefore the use of ce qual w2 and the efdc model to guide stratified intake facilities is questionable as the nature of operation and decision making require a high model calculation speed and an accurate water distribution simulation with extended simulation periods therefore it is necessary to build a surrogate model for high fidelity simulation that inherits the prediction ability of high fidelity models reduces the calculation time and satisfies the threefold requirements of stratified intake facility operation and management based on the corresponding prediction accuracy calculation speed and prediction period of the water temperature model in recent years the rapid development of data driven models such as machine learning ml algorithms has changed the traditional scientific research paradigm and provided a new way to overcome the technical difficulties associated with rapid water temperature prediction ml models no longer seek to manually establish theoretical relationships among variables instead these models are designed to capture the internal relationships between the input and output variables which can be determined through data analysis mazzocchi 2015 therefore ml models have an advantage in solving nonlinear problems with many complex and uncertain factors in addition ml models are capable of achieving the same level of accuracy as traditional numerical simulation models kim et al 2021 while providing a higher computational speed and lower computational costs james et al 2018 additionally ml models have become a popular surrogate set of modeling tools in assisting water resource management especially reservoir discharge operation rezaee et al 2018 zhang et al 2018a yang et al 2016 2020 naeini et al 2020 ml models also have some drawbacks that limit their application for instance 1 ml models are typical black box models and lack theoretical support which can lead to spurious and inaccurate predictions lazer et al 2014 2 the selections of training schemes and model structural parameters will significantly affect the black box model predictive performance and simulation uncertainties yang et al 2017a yang et al 2017b and 3 ml models often require massive training datasets to learn the dynamics of complex systems and a lack of training data will reduce the learning effect chen et al 2018 to address the nontransparency issue and the model uncertainty issue associated with black box data driven models a new research method theory guided data science tgds has been proposed karpatne et al 2017 the idea of a theory oriented model is to embed the physical mechanism into the data science model to improve the prediction performance of the data science model recently researchers have introduced many methods to embed physics into data science models karpatne et al 2017 and karniadakis et al 2021 systematically reviewed these methods and nearing et al 2021 analyzed the research progress of tgds in the field of hydrology at present the commonly used methods of embedding physical mechanisms into ds models especially ml models include theory guided machine learning tgml model design and tgml model learning and training there are several main methods of tgml design one is the selection of input and output factors based on a physical mechanism which is also currently the most common structural design method for tgml karpatne et al 2017 haklidir et al 2020 the second is to divide the scientific problem into several subproblems under theoretical guidance and determine its input and output while ensuring the physical connection between the input and output for example to describe the overall hydrological process of surface runoff we can build ml models for different subprocesses such as the atmospheric processes of rainfall and evaporation and the groundwater seepage process karpatne et al 2017 third the ml algorithm is used to train some parameters in the physical model karpatne et al 2017 there are three main schools of thought in tgml model learning and training first an ml system is trained based on sufficient observational data or data generated from a high fidelity physics model thus promoting the learning of functions vector fields and operators that reflect the physical structure of the data karniadakis et al 2021 second one approach focuses on designing specialized ml architectures that implicitly embed any prior knowledge and inductive biases associated with a given predictive task the most typical of these methods are the convolutional neural network designed for image recognition and the recurrent neural network designed for sequential problems karniadakis et al 2021 the third school of thought embeds physical mechanisms into ml models by adding soft constraints to ml such as adding a penalty function to the loss function of an ml model karniadakis et al 2021 recently the tgds paradigm has started to gain prominence in a number of scientific disciplines such as science hydrology and hydromechanics paniconi and putti 2015 wang et al 2016 volpiani et al 2021 the current research results show that the tgds model can guarantee the prediction accuracy of the model and effectively reduce the computational cost which is of great value for providing real time guidance for production practice karpatne et al 2017 read et al 2019 to the best of the authors knowledge there has been limited tgds research in the field of water temperature prediction in reservoirs especially in large stratified reservoirs so it is of great value to perform case application research the tgds framework aims to enhance the effectiveness of ml models by integrating the strengths of theoretical cognition and data science to provide theoretical and physical support for the employed ml models as defined by tgds theory the most effective way of integrating theoretical cognition and data science is to select input factors and output factors based on the underlying physical mechanisms thus a better mapping relationship between the predictors and target variables can be established karpatne et al 2017 the mapping relation is closely related to the selection of the algorithm and the performance of the algorithm will directly impact the prediction effect of the model zhang et al 2018a therefore in addition to selecting appropriate input variables and defining input types for each input variable in compliance with the physical laws it is also necessary to reasonably select the ml algorithms to be applied in other words the tgds framework allows both the training data and the candidate ml models to be prescreened and tested to better match reality and our understanding of the physical dynamics of the problem based on applied research with ml models in reservoir management this paper preliminarily selects ml algorithms that are capable of predicting outflow temperatures support vector regression svr originated from the support vector machine svm algorithm and is one of the most widely used ai models in reservoir management lin et al 2006 hipni et al 2013 lin et al 2006 used the manwan reservoir as an example and proved that svr had a strong ability to predict reservoir outflow moreover haklidir et al 2020 explored the application of an svm model to predict water temperatures the bp algorithm is a representative traditional neural network algorithm and is widely used in reservoir management and water temperature prediction shaw et al 2017 zhang et al 2018a lstm a new deep learning model has shown excellent performance in the field of hydrological prediction in recent years zhang et al 2018a read et al 2019 therefore these three algorithms are selected in this study to build a prediction model of the reservoir outflow temperature based on the tgml research paradigm within the tgml framework we will identify the ml algorithm that is most suitable for outflow temperature prediction by analyzing the water temperature prediction results of the three algorithms and comparing their performances to address the aforementioned third drawback of ml models we will generate the training dataset based on the results from the numerical simulation model at present most of the water temperature observation data for large reservoirs and lakes around the world are limited or not publicly accessible the limited amount of water temperature data often cannot support the training of the tgds framework to overcome the limitation of insufficient observational data we refer to international solutions to similar problems and explore the use of numerical simulation model generated data to replace observations and to further train data driven ml models shaw et al 2017 james et al 2018 therefore based on the above experience this study provides training samples for the tgml model with the efdc model which is a widely recognized three dimensional environmental hydrodynamics model in summary the research objectives of this paper are as follows 1 relying on the research paradigm of the tgml algorithm this paper constructs a prediction model of reservoir outflow temperature based on the svr bp and lstm algorithms 2 the tgml models are trained with efdc model generated data to learn the physical mechanism behind the data 3 the prediction performance of the three tgml models is tested from three perspectives prediction accuracy calculation speed and prediction period and 4 taking the prediction of the outflow temperature of the jinping i jp i hydropower station as an example the applicability of the tgml models in guiding the operation and management of stratified water intake facilities is analyzed 2 methodology 2 1 overview this paper aims to develop a model based on the tgds research paradigm to rapidly and accurately predict the outflow temperatures of temperature stratified reservoirs under the control of stoplog gates the tgml model construction process and overall approach are illustrated in fig 1 according to fig 1 in the first model development step we build a tgml based conceptual model for rapid water temperature prediction and select the input and output variables of the model based on the physical causes of water temperature stratification in the second step combined with the conceptual model and existing research reports three ml algorithms are selected to predict outflow temperatures independently and the corresponding code is developed in this paper both the tgml model and the candidate ml algorithms are compiled based on the python 3 5 language in the third step we determine whether the collected observational data meet the training requirements of the tgml model if so the observation data are directly sorted to form a dataset that can be used for tgml model training otherwise the efdc model is executed to generate outflow temperatures under the design conditions then the design conditions and corresponding outflow temperatures are used to establish a new training dataset that consists of both observations and numerical model simulation results in the fourth step the tgml model is trained based on the dataset established in step 3 and the trained model is used to predict outflow temperatures the performance of each ml algorithm is evaluated and the best ml algorithm is selected to guide the operation of stratified intake facilities 2 2 mechanism analysis the development of the tgml model for rapid water temperature prediction needs to be based on the physical causes of water temperature stratification therefore based on an analysis of the physical mechanisms of water temperature stratification in large reservoirs we identified the factors that affect the outflow temperatures the ml model is endowed with a physical mechanism by taking the influence factors as the input of the ml model and determining the data input type numerical type or vector type according to the role of each factor in the model through a literature review we identified the inflow of the reservoir inflow temperature outflow reservoir water level water intake depth number of operating layers of the stoplog gate air temperature relative humidity solar irradiance wind speed and cloud cover as the main factors that could affect the reservoir outflow water temperature caissie 2006 poole and berman 2001 after the construction of hydropower projects the water level in front of the dam rises to form a reservoir the retention time of water bodies in the reservoir area is lengthened and the reservoir inflow and meteorological conditions carry external heat into the water bodies in the reservoir area thus different water temperature structures are created through the redistribution of convection turbulent diffusion and thermal density flows for a reservoir especially a long narrow and deep reservoir there is little lateral difference in water temperature with a distinct water temperature trend in the longitudinal direction overall the water temperature structure exhibits an obvious vertical stratification phenomenon especially for deep water reservoirs with a high dam thermal stratification combined with reservoir regulation causes the water temperature in reservoirs to highly differ from that of original natural rivers li et al 2020 current research shows that many factors can affect the outflow temperatures including the geographical location meteorological conditions inflow temperatures runoff characteristics reservoir geometric characteristics and operating rules caissie 2006 poole and berman 2001 fig 2 the geographic location is related to the climate type in the reservoir area and can affect the external heat inputs meteorological conditions and inflow temperatures are the main external heat sources of reservoirs among the different meteorological factors air temperature solar irradiance cloud coverage wind speed and relative humidity have a considerable influence on water temperature runoff characteristics and reservoir geometric characteristics mainly affect the internal heat exchange process of reservoirs by influencing the mixing degree of a water body the operating rules of reservoirs such as the operating water level outflow and position of the water intake affect the redistribution process of heat in reservoirs and are closely related to the outflow temperature caissie 2006 poole and berman 2001 except for the geographical location and the geometric characteristic parameters the quantitative indices of all other factors in fig 2 are included in the input set of the tgml model specifically the input factors include the month operating water level outflow number of operating layers of the stoplog gate water intake depth inflow inflow temperature air temperature solar radiation wind speed air relative humidity cloud cover etc and the output of the model is the outflow temperature fig 2 meanwhile according to the role of each factor in the model we defined the input type of each factor among which the month and the number of operating layers of the stoplog gate are mainly used for classification and identification thus the data input type is a binary vector type and the data input type of other factors is a numeric type in this research we select jp i as the study case the geographical location and geometric characteristic parameters of the jp i reservoir will not change therefore these two factors can be left out from the tgml model considering that the month and number of operating layers of the stoplog gate mainly play the role of labels and belong to categorical variables they are input in the one hot encoding format the mathematical expression of the tgml model is shown in eq 1 as follows to f m qi m qi t qo tm tt l d n ta h t rt w c 1 where t o t is the outflow temperature c m is the month in the current period binary vector qi m is the inflow of the mainstream yalong river m3 s qi t is the inflow of the xiaojinhe tributary reservoir m3 s qo is the outflow m3 s tm is the inflow temperature of the mainstream yalong river c tt is the inflow temperature of the xiaojinhe tributary reservoir c l is the reservoir water level m d is the water intake depth m n is the number of operating layers of the stoplog gate binary vector ta is the air temperature c h t is the relative humidity rt is the solar irradiance w m2 w is the wind speed m3 s c is the cloud coverage 2 3 study case and data sources 2 3 1 jinping i reservoir jp i jp i are selected as the study case which includes the highest double curvature arch dam in the world jp i is located on the mainstream yalong river in sichuan province china fig 3 jp i is a key water infrastructure within china s southwest water conservancy project and it serves multiple purposes such as power generation flood control and sediment retention functions the installed capacity of the jp i power station is 3600 mw the annual average power generation is 16 620 million kw h the maximum dam height is 305 m the normal water level is 1880 m the dead water level is 1800 m the total storage capacity is 7 76 billion m3 the regulated storage capacity is 4 91 billion m3 and the annual water exchange frequency is 5 0 the jp i reservoir drainage area is long and narrow the backwater length of the main reservoir area is 59 km and its xiaojinhe tributary reservoir area is 90 km therefore water temperature stratification is obvious the points marked in green in the figure are the long term observation points for water temperature and the observation data include the inflow and outflow temperatures of jp i the yellow points are the vertical sections of water temperature observations b1 8 are located in the main reservoir area of the yalong river and b9 11 are distributed in the tributary reservoir area the observation data can be used to characterize the vertical water temperature structure of the reservoir and the observation frequency is once a month 2 3 2 operating rules of the jp i stoplog gate jp i is equipped with 6 generator sets in total and the leading edge of the water inlet of each generator set is divided into 4 grid holes by the grid pier with a total of 24 grid holes the number of water gates is also 24 and each hole can be equipped with a maximum of three layered stoplog gates with a total of 72 gate leaves according to the operation rules of jp i the operation period of the stoplog gate is from march to june during this period the hydropower station can adopt four water intake schemes a single inlet without a stoplog gate a one layer stoplog gate a two layer stoplog gate and a three layer stoplog gate the water level requirements and the corresponding water intake elevation for each scheme are shown in table 1 scheme 1single inlet scheme the top elevation of the intake is 1779 m scheme 2acc or ding to the scheme of the one layer stoplog gate when the water level of the reservoir is higher than 1814 m a one layer stoplog gate should be installed when the water level is lower than 1814 m the stoplog gate should be removed scheme 3acc or ding to the scheme of the two layer stoplog gate when the water level of the reservoir is higher than 1828 m a two layer stoplog gate should be installed when the water level is between 1828 m and 1814 m the top stoplog gate should be removed and the remaining one layer stoplog gate should be used and when the water level is lower than 1814 m all the stoplog gates should be removed scheme 4acc or ding to the scheme of the three layer stoplog gate when the water level of the reservoir is higher than 1835 m a three layer stoplog gate should be installed when the water level is between 1835 m and 1828 m the top stoplog gate should be removed and the remaining two layer stoplog gate should be used when the water level is between 1828 m and 1814 m the top stoplog gate should be removed again and the remaining one layer stoplog gate should be used to block water and when the water level is lower than 1814 m all the stoplog gates should be removed 2 3 3 data sources the collected data mainly included topographic data meteorological data operation data and water temperature observation data for jp i excluding terrain data the period of other data was from april 1 2015 to march 31 2016 the topographic data include the measured whole reservoir topography of jp i the meteorological data include the air temperature relative humidity solar radiation wind speed and cloud cover obtained at the muli yuexi and yanyuan meteorological stations near jp i the cloud cover data were obtained from reference chen 2010 all other meteorological data were obtained from the china meteorological data service center http data cma cn the operation data of the power station involve managing the inflow outflow reservoir water level number of operation layers in the stoplog gate and depth of the water intake the water temperature observation data include long term water temperature observations for inflows and outflows and short term vertical profile water temperature observations the specific layout of observation points is shown in fig 3 the vertical observation section is located in the jp i reservoir area a total of 11 observation sections are arranged and the observation frequency is once a month a detailed list of collected data is shown in table 2 2 4 machine learning algorithm in this paper three supervised ml algorithms svr bp and lstm are selected to build a rapid prediction model of reservoir outflow temperatures and the performances of the three models are compared the svr algorithm is a classical machine learning algorithm that is widely used because of its generalization ability and effectiveness in finding a global optimal solution cortes and vapnik 1995 the core concept of svr is to nonlinearly map the original data to a higher dimensional feature space and solve a linear regression problem in this feature space the svr algorithm is one of the most widely used ml models in reservoir operation khalil et al 2005 hipni et al 2013 aboutalebi et al 2015 therefore this study uses the svr algorithm to build a fast prediction model of outflow temperatures bp neural networks are among the most widely used algorithms that apply shallow artificial neural networks anns in the training of a bp network signals are propagated from front to back and errors are propagated from back to front in the back propagation of errors the network weights and deviations are adjusted layer by layer and this training method yields a bp neural network with excellent ability to deal with nonlinear problems haykin and lippmann 1994 lippmann 1988 jain et al 1999 the bp algorithm has been widely used not only in reservoir operation and water environmental factor prediction chaves and chang 2008 zhang et al 2018a yang et al 2017a but also in water temperature prediction in recent years shaw et al 2017 for example shaw et al 2017 used an ann algorithm to predict the impact of cordell hull and old hickory reservoirs on the outflow water temperature of the cumberland river in tennessee however most studies have focused on the prediction of water temperatures in shallow lakes and reservoirs or surface water temperatures in deep lakes and reservoirs therefore it is challenging and uncertain to use a bp algorithm to predict the outflow temperatures of large and deep reservoirs the lstm algorithm is a representative deep learning algorithm an lstm is a type of recurrent neural network rnn that includes specialized memory cells that can capture multi time step relationships hochreiter and schmidhuber 1997 gers et al 2000 lstm is a sequential model compared with the single point interconnection between the input layer and the output layer in the traditional ann model the lstm model provides cyclic interconnections between the input layer and the output layer that is the output of the previous moment is added to the calculation for the current moment as the input parameter therefore lstm models are effective tools for solving complex and sequential problems and they have been widely applied in water temperature prediction jia et al 2019 predicted the water temperature of the mendota reservoir based on an lstm algorithm read et al 2019 created a process guided deep learning model and an lstm was used to predict lake temperature dynamics at multiple depths 2 5 tgml model training and test given the short operating time of stratified water intake facilities at present the observed data that can be collected are limited this limitation makes it difficult to obtain data that can support the training requirements of ml algorithms therefore the concept of using a numerical simulation model to generate a dataset is proposed in this study in this paper the efdc model is selected as the dataset generation tool the efdc model is an open source three dimensional numerical model of environmental hydrodynamics that is widely used in the simulation of flow fields temperature fields and water quality for different types of water bodies such as rivers lakes and reservoirs devkota and fang 2015 arifin et al 2016 the detailed governing equations and specific application methods were described by hamrick 1992 1996 efdc model is developed based on physical mechanism the key factors of water temperature prediction sorted out above are also the boundary conditions that need input in efdc model to fully train the ml model and make it learn the physical mechanism of efdc well two conditions must be satisfied sufficient amount of training data working conditions that should cover all types of scenarios faced by jp i hydropower station as far as possible therefore we specify the following training steps fig 4 first based on the observed jp i data we calibrate the parameters of the efdc model and build an efdc model that can accurately simulate the water temperature of jp i second considering the inflow and outflow meteorological conditions inflow water temperature conditions stoplog operation scheme and other factors that have a considerable impact on the outflow temperature various operating scenarios are designed to cover the actual scenarios that jp i may face thirdly the calibrated efdc is used to simulate the water temperature distribution and outflow temperatures under various operating scenarios and the dataset is generated to meet the needs of ml model training for data samples finally ml model is trained by dataset to learn the physical mechanism of efdc model the design scheme of the operating scenarios is as follows in terms of flow three typical hydrological conditions are considered low flow years normal flow years and high flow years in terms of meteorological conditions the observed meteorological data from muli station yuexi station and yanyuan station near jp i are considered in terms of inflow temperature the observed inflow water temperature data from april 1 2015 to march 31 2016 are used as the base case and inflow temperatures were increased and decreased by 5 from the base case values stoplog operation schemes are designed according to the operation rules of jp i from march to june each year according to the water level conditions for different hydrological years four operating cases are designed a single inlet without a stoplog gate a one layer stoplog gate a two layer stoplog gate and a three layer stoplog gate various operating scenarios are combined with a total of 3 hydrological years 3 meteorological conditions 3 inflow temperatures 4 stoplog operation schemes 108 operating scenarios meanwhile for the convenience of later description we encode each working condition as shown in fig 5 for example nxo represents the combination conditions of high flow years meteorological conditions from yuexi station and observed water temperatures in this paper we performed the hold one out method for ml model training following the standard computer science practice in developing prediction models specifically the collected observation data and efdc simulation results under the nxo design conditions are used to test model performance and the remainder of the data are used for training in other words the training dataset includes the remaining 19 006 samples and 96 3 of the entire data record the test dataset contains 731 samples and is equivalent to 3 7 of the entire data record meanwhile to verify the performance of the model in the actual water temperature prediction we verified the performance of the ml model with the observed outflow temperature data from 2015 to 2016 2 6 tgml model performance evaluation the performance of the tgml model is evaluated from three perspectives prediction accuracy model computational time and prediction period for prediction accuracy the error e mean absolute error mae mean relative error mre and root mean square error rmse which are commonly used to evaluate the performance of water temperature prediction models are selected to evaluate the model accuracy hanna et al 1999 alkan and eli 2009 the corresponding formulas are as follows 2 e x i t i 3 mae 1 n i 1 n x i t i 4 mre 1 n i 1 n x i t i ti 100 5 rmse i 0 n x i t i n where xi is a predicted value and ti is an observed value 3 generation of the tgml model training dataset 3 1 water temperature simulation model for jp i based on the efdc model as mentioned above the tgml model training dataset includes both observation and simulated data from the efdc model the model simulation domain of the efdc model includes the whole reservoir drainage area of jp i including the main reservoir area of the yalong river and the tributary reservoir of the xiaojinhe river a comparative analysis of the simulation results and the observation results is shown in fig 6 taking april and several typical stream sections as an example fig 6 depicts the simulated vertical temperature distribution among the selected typical sections b8 is the observation section of water temperatures in front of the dam b5 is the observation section at the intersection of the main reservoir and the tributary reservoir b4 is the observation section of the main reservoir before the intersection and b10 is the observation section of the tributary reservoir before the intersection the above four sections are used to represent the water temperature distribution at the main characteristic points in the jp i reservoir area the results show that the efdc model can effectively simulate the spatial variations in thermal stratification from the tail of the reservoir to the front of the dam moreover the efdc model can also simulate the process of water temperature stratification in different seasons within a year fig 6 fig 6 shows that the efdc model can well simulate the effects of buoyancy driven flow and atmospheric heat exchange on the water temperature distribution as well as the interactions of the main and tributary reservoirs this result indicates that the simulated water temperature obtained from the efdc model could be reasonably used as a substitute for missing observation data or an extension of a short observation record to train the tgml data driven model subgraph a shows the mae of the efdc simulation results in different months subgraph b shows the comparison of observed and simulated values of vertical water temperature in representative observation sections in april subgraph c shows the vertical profile of the water temperature structure in the main reservoir and tributary reservoir in april simulated by efdc and subgraph d shows the two dimensional distribution of the vertical water temperature water level time in the b8 observation section in front of dam 3 2 tgml training dataset generated by the efdc model the 108 operating scenarios designed in our experimental setting see section 2 5 cover inclusive combinations of flow scenarios meteorological scenarios inflow temperature scenarios and stoplog gate operating schemes which may be used in jp i s practical operation in this section the reservoir water temperature distribution and outflow temperature for the 108 designed scenarios are simulated by using the calibrated efdc model the input conditions and efdc model simulation results are matched to form the training dataset for the later tgml model the dataset contains nearly 20 000 one to one corresponding operating conditions and outflow temperature values which can reflect the main water temperature meteorological characteristics runoff variation characteristics stratified intake operation mode and corresponding reservoir temperature distribution and outflow temperature under the above operating conditions 4 results 4 1 predicted outflow temperatures under nxo conditions before comparing the performance of the svr bp and lstm models we optimized the structural parameters of each model such as the numbers of hidden layers hidden nodes and iterations and the kernel function to determine the best performance of each model the supplementary materials show the specific results finally we determined that the best kernel function for svr is the radial basis function rbf the best number of hidden layers of the bp neural network is 1 the best number of hidden nodes is 32 and the best number of iterations is 2000 and the best number of hidden layers of lstm is 7 the best number of hidden nodes is 32 and the best number of iterations is 500 after the model structural parameters are determined this paper first considers outflow temperature prediction under nxo conditions as an example to compare the performance of three models namely svr bp and lstm based on the prediction accuracy calculation time and prediction period from march to june jp i uses four water intake schemes considering the water level under nxo conditions fig 7  single inlet scheme from march 1 to june 30 a stoplog gate is not installed  one layer stoplog gate scheme from march 1 to may 27 a one layer stoplog gate is installed and from may 28 to june 30 the stoplog gate is removed  two layer stoplog gate scheme from march 1 to april 22 a two layer stoplog gate is installed from april 23 to may 27 the top stoplog gate will be removed and the remaining one layer stoplog gate will continue to work from may 28 to june 30 the remaining stoplog gate will be removed  three layer stoplog gate scheme from march 1 to april 6 a three layer stoplog gate will be installed from april 7 to april 22 the top stoplog gate will be removed and the remaining two layer stoplog gate will continue to work from april 23 to may 27 the top stoplog gate will be removed again and the remaining one layer stoplog gate will continue to work from may 28 to june 30 the remaining stoplog gate will be removed 4 1 1 prediction accuracy in table 3 and fig 8 we present the outflow temperature prediction results of the three tgml models prediction accuracy is one of the key indicators used to evaluate model performance and we compare the accuracy of outflow temperature predictions for each tgml model additionally march to june is the main breeding period of fish in the basin where jp i is located and it is also the operation period of the stratified intake facilities in addition to the outflow temperature prediction accuracy at the annual scale this paper focuses on the prediction accuracy of the tgml model from march to june therefore this paper compares the prediction accuracy of the three models based on four schemes a single inlet scheme for the whole year and one layer two layer and three layer stoplog gate schemes from march to june the prediction results indicated that the mae of the svr model was 0 395 c that of the bp neural network was 2 533 c and that of lstm was 0 264 c for the whole year table 3 as shown in fig 8 the svr and lstm models can accurately simulate the annual variations in water temperature and the largest error corresponds to the period of obvious water temperature fluctuations from june to august the overall error of the bp neural network is large and predictions of the outflow temperature are comparatively inaccurate especially in the period when the water temperature rises from march to june the eneg value is 4 527 c and the epos value is 2 688 c compared to the results from the svr model the prediction accuracy of the lstm model is higher the accuracy ranking of the three models is lstm svr bp table 3 from march to june for the single inlet scheme the mae values of the prediction results of the svr bp neural network and lstm model are 0 427 c 0 530 c and 0 228 c respectively and the model accuracy ranking is lstm svr bp table 3 fig 8 thus lstm still yields the highest prediction accuracy and the bp neural network still provides the lowest prediction accuracy notably bp has difficulty achieving satisfactory prediction results from march to june for the one layer stoplog gate scheme the mae values of the svr bp neural network and lstm model are 0 405 c 0 620 c and 0 269 c respectively the accuracy ranking of the three models is lstm svr bp table 3 specifically the variation in outflow temperature from march to april is weak and the prediction results of the three models are generally accurate in may the outflow temperature rises rapidly the water temperature fluctuations increase and the prediction accuracy of the three models decreases fig 9 for the two layer stoplog gate scheme the mae values of the svr bp neural network and lstm model are 0 334 c 0 678 c and 0 258 c respectively and the accuracy ranking of the three models is lstm svr bp table 3 and fig 10 compared with the other models the lstm model exhibits significantly higher accuracy table 3 and fig 10 for the three layer stoplog gate scheme the mae values of the svr bp neural network and lstm model are 0 428 c 0 581 c and 0 247 c respectively and the accuracy ranking of the three models is lstm svr bp table 3 and fig 11 consistently with these findings the lstm model is able to achieve the highest prediction accuracy among the three models moreover as shown in fig 11 the operation of the stoplog gate will advance the warming period of the outflow temperature and the removal of the stoplog gate leads to a large fluctuation in the outflow temperature leading to a decline in prediction accuracy 4 1 2 computational time the calculation efficiencies of the three models are compared in the respects of training time consumption and prediction time consumption the training time consumption refers to the time required for the model to complete training and the prediction time consumption is the time required to perform processes between invoking the trained model and completing a prediction to reduce the random error each model is run 10 times in parallel and the training time consumption and prediction time consumption of each run are recorded for statistical analysis the results are shown in fig 12 the results show that the training time of the svr model is the longest for the svr model with an rbf kernel function used in this paper the training time required to search for the appropriate parameter combination is more than 200 h and the training times of the other two models are less than 10 min fig 12 after training the three models can give outflow temperature predictions based on the input conditions within 2 s fig 12 compared with the calculation time of the efdc model which can be a few hours or even a few days the calculation time of the tgml model provides a significant advantage 4 1 3 prediction period in addition to the prediction accuracy and calculation time the prediction period is an important indicator of model performance in this paper the key impact factor data from the previous 0 30 days see fig 2 for details are used as inputs and the outflow temperature at the current moment is the model output used to build the tgml model mae is used as the evaluation index to explore the prediction periods of the three tgml models for the svr model if the kernel function and relevant parameter settings are the same the prediction results will be the same so the svr model can only be run once for the neural network model since the initial parameters are assigned randomly during model training the prediction results of the model will be slightly different in each run to reduce the random error the bp and lstm neural network models are run 10 times in parallel and the average value is calculated for comparative analysis in fig 13 the prediction period analysis results for the three tgml models with different operating conditions for a single inlet water intake and stratified water intakes are presented the results show that although there are significant differences in prediction accuracy among different tgml models the trend of model accuracy with prediction time is basically the same as the prediction period increases the prediction accuracy of the model gradually decreases for the single inlet water intake scheme the prediction accuracies of the bp neural network and svr model for the outflow temperature within 0 12 or 13 days are highly similar and the model error fluctuates after 13 days the prediction error of bp and svr exhibits a gradually increasing trend the lstm model displays a small difference in prediction accuracy within 0 16 days after 17 days the prediction error of the model gradually increases with time then 27 days later the model error becomes stable again fig 13a for the stratified water intake scheme the model prediction accuracy changes with increasing prediction period and is similar for the three stoplog gate operating schemes the prediction errors of the svr and bp network models for the outflow temperature within 0 6 days vary minimally after 7 days the prediction errors of these models exhibit a gradually increasing trend then approximately 25 days later the model accuracy becomes stable again fig 13 the prediction errors of the lstm model within 0 6 or 7 days exhibit little change after 6 or 7 days the lstm prediction error displays a gradually increasing trend then approximately 17 days later the model accuracy becomes stable again fig 13 in addition the prediction accuracy of the lstm model is significantly higher than that of the svr and bp neural network models regardless of how far in advance the prediction of the outflow temperature is made additionally for the water temperature over the next 30 days the prediction accuracy of the lstm model is higher than that of the svr and bp models at the current moment fig 13 4 2 prediction results for the observed outflow temperature due to the failure of the observation equipment the outflow temperature observation datasets for april and may 2015 are incomplete therefore the prediction accuracy of the three tgml models for the observed outflow temperature in jp i from june 1 2015 to march 31 2016 is analyzed in this paper the results show that among the svr bp and lstm models lstm has the highest prediction accuracy with an mae value of 0 385 c and an mre value of 1 98 compared with lstm the svr model and bp neural network exhibit obvious disadvantages in terms of prediction accuracy the mae value of the svr model is 0 874 c and the mre is over 4 while the mae value of bp is 1 98 c and the mre is over 5 table 4 in addition by plotting the annual change curve between the predicted value of the tgml model and the observed outflow temperature we can assess the coincidence between the predicted curve and the observed curve and the results are shown in fig 14 notably the outflow temperature is high from june to september and the water temperature fluctuates considerably so the prediction error of the three models in this period also fluctuates highly however overall all three models can predict the changes in water temperature in this period and the lstm model yields the highest prediction accuracy from october 2015 to february of the following year the outflow temperature gradually decreased and all models can predict the cooling trend of the outflow the predicted values of lstm are consistent with the measured values and the predicted values of svr and bp in the cooling period are generally lower than the measured values fig 14 march 2016 was the beginning of the operating period of the stoplog gate for jp i and the research results show that the lstm model can still simulate the water temperature variations well during the operating period of the stoplog gate the predicted values of the svr model are generally higher than the measured values while the predicted values of the bp neural network are generally lower than the measured values fig 14 in conclusion the prediction results of the observed temperature indicate that the lstm model performs significantly better than the svr and bp neural network models the lstm model has natural advantages over the svr and bp neural networks in addressing time sequence problems which has been verified in our research results then can lstm maintain its performance advantage compared with other time sequence models for example the autoregressive integrated moving average arima model is a time sequence prediction method proposed by box et al 1973 to obtain the periodic and trend information in a time sequence through regression analysis moving averages difference calculations and other methods to test the performance of the lstm model and arima we built a linear regression model to predict the change trend of the outflow temperature and an arima model to predict and adjust the residuals the results are shown in fig 15 the prediction results show that the mae value of the arima model is 0 499 which is higher than those of the bp and svr algorithms but lower than that of the lstm model additionally the prediction curve shows that arima has high randomness in the prediction error especially in august and september the prediction error of the arima model fluctuates greatly fig 15a from the perspective of the prediction period the prediction errors of the four models have a similar trend and the prediction errors all increase with the increase in the prediction period comparing the four models the prediction accuracy of the lstm model is always significantly higher than that of the other three models fig 15b 5 discussion 5 1 feasibility of using efdc model simulation data instead of measured data to train the tgml model the learning method of the ml algorithm in this paper is supervised learning by providing a large number of training samples for the ml models the mapping relationship between the input and expected output is established and the output of any possible input is then predicted based on this mapping relationship unlike the traditional numerical simulation model the ml model no longer focuses on describing the physical mechanisms among variables but through large sample data training the potential relationship among the variables can be directly and independently explored therefore evaluations regarding whether the number of training samples is sufficient and whether the sample values cover the possible ranges of input and output factors can be performed and the corresponding influence on the learning effect of the ml model can be assessed the operation time of a large hydropower project with stratified water intake facilities is short in china in addition the observed data that can be collected are limited in this paper jp i is used as a typical case study and we only collected water temperature distribution data in the reservoir area and outflow temperature data from april 2015 to march 2016 the amount of data collected makes it difficult to support ml model training and achieve good prediction performance therefore we refer to international ideas that solved similar problems for example ibm baylor university and notre dame university jointly developed an advanced wave forecasting system by using deep learning technology to overcome the limitation of insufficient training samples researchers used the traditional simulating waves nearshore swan model to generate a wave field and trained a deep learning network using generated data the results showed that the trained deep learning model not only greatly reduces the computing time and cost of swan but also achieves the same accuracy level as swan james et al 2018 additionally shaw et al 2017 used ce qual w2 simulations to generate outflow temperature and dissolved oxygen data and provide training samples for an artificial neural network ann model a prediction model of outflow temperature and dissolved oxygen was built based on the ann algorithm therefore we believe that in theory the tgml model trained from data generated by the efdc model has the ability to predict efdc model simulation results because the accuracy of the constructed efdc water temperature simulation model was verified based on observed data it is reasonable to believe that the tgml model trained with efdc simulation results should have the ability to predict the actual outflow temperature to verify this hypothesis in section 4 2 of this paper we used the efdc simulation results as the training set and the observed temperatures at hydropower outflows as the test set to test the predictive performance of the three tgml models then the feasibility of the trained tgml model was assessed by using generated data from the numerical simulation model instead of observed data to predict observed outflow temperatures considering the different water temperature thresholds under different conditions it may be biased to use the mae index to evaluate the tgml model performance therefore the mre value is used as the criterion for comparing prediction accuracy under different operating conditions the analysis results show that from the perspective of prediction accuracy the predicted results of the svr and lstm models for observed outflow temperatures are similar to the efdc simulated outflow temperatures and the prediction accuracy of the bp neural network results based on observed outflow temperatures is slightly lower than that of the efdc simulation results for outflow temperatures fig 16 table 3 and table 4 the tgml model trained by efdc model generated data instead of observed data exhibits good prediction performance and can achieve satisfactory results in the prediction of observed outflow temperatures this finding suggests that the training dataset generated by the efdc model can effectively support the training of the tgml model and verifies the feasibility of the concept of training the tgml model with data generated by a numerical simulation model instead of observation data this approach can effectively overcome the limitation of insufficient observation data and has certain value and reference significance for solving similar problems the blue circles represent the maximum and minimum errors of the tgml model for the efdc simulated outflow temperatures and the red dots represent the prediction errors of the tgml model for the observed outflow temperatures 5 2 applicability of the tgml model in the operation and management of stoplog gates the actual operation of stratified water intake facilities includes the adjustment of operating plans according to the inflow thermal conditions water level etc whereas our proposed modeling strategy better corresponds to the classical empirically based prediction and the numerical simulation approach moreover stratified intake facilities are difficult to install and it usually takes one to two weeks to install a one layer stoplog gate therefore a water temperature prediction model must provide acceptable prediction accuracy high computational efficiency and a long prediction period for operators to adjust the stratified water intake facility operation regarding prediction accuracy since few studies have focused on the accuracy requirements of guiding models for stratified water intake facility operation we discuss the accuracy standard that water temperature prediction models generally need to meet based on the results of reservoir water temperature prediction models from the many studies on temperature prediction effect evaluation with mae and rmse these two indicators are dimensional indices and are closely related to the numerical range of f prediction variables therefore to improve the effectiveness of the contrast we select studies with a temperature variation range similar to that of our study table 5 according to the derived statistical model performance the mae values of the three tgml water temperature prediction models developed in this paper are between 0 228 and 0 620 c the rmse values are between 0 305 and 0 805 c and the prediction accuracy is moderate table 3 and table 5 it is notable that the lstm algorithm could yield a water temperature prediction with an mae value of 0 228 0 269 c and an rmse value of 0 305 0 407 c table 3 and this prediction accuracy is superior to a number of physically based hydrodynamic models from the literature table 5 given this important finding from a model prediction accuracy perspective we believe that the three tgml water temperature prediction models developed in this paper can be used as surrogate models of many of the existing hydrodynamic models to assist stoplog gate operation and management in large hydropower projects the lstm water temperature prediction model performs best among the three models considered in this study and has shown great potential in predicting water temperature distributions in other study cases similar conclusions have been obtained by other studies in the field of reservoir operation for example zhang et al 2018a compared the performance of svr bp and lstm in gezhouba reservoir operation simulation the results showed that lstm had significantly better simulation accuracy than the other two models zhang et al 2018b compared the prediction effects of lstm and svr models on sewage flow the results showed that the lstm model had significantly higher simulation accuracy than the svr model combined with the discussion of these two articles we conclude that a possible reason for this phenomenon is as follows svr comes from the svm algorithm and its main advantage is in solving the classification problem whereas the bp neural network has a problem of gradient disappearance with the increase in the number of hidden layers which limits the feature extraction ability of the bp neural network the lstm algorithm effectively solves the gradient disappearance problem caused by the increase in the number of hidden layers has a stronger feature extraction ability and is made to solve the sequence problem outflow temperature prediction is obviously a sequence problem with complex influencing factors therefore the lstm algorithm should show the best prediction performance among the three algorithms cortes and vapnik 1995 gers et al 2000 zhang et al 2018a zhang et al 2018b according to our computational time analysis the training times of the bp neural network and lstm model are less than 10 min and the prediction time consumption after training is less than 2 s conversely the training time of the svr model is more than 200 h but the prediction time is less than 0 5 s fig 12 because model training can be completed in downtime periods at stratified water intake facilities in practice the predictive speed is the key factor that influences the real time decision making ability of a tgml model the three tgml models developed in this paper can predict water temperatures within 2 s and meet the requirements of fast decision making for the operation of stratified water intake facilities therefore we believe that based on the observed computational times all three tgml models meet the model runtime requirements of stratified water intake facility decision making the training speed and prediction speed of the bp neural network and lstm are high and the operating data observed at the previous moment can be added to the training sample set in real time thus the performance of these two models can be continuously improved through iterative training regarding the prediction lead times and the associated model uncertainty the bp neural network and svr model can maintain high predictive accuracy within 0 12 or 13 days and the lstm model can maintain high predictive accuracy within 0 16 days for the single inlet scheme for multilayer stoplog gate schemes the forecasting accuracy of the bp neural network svr model and lstm remains high over the prediction period of 0 6 or 7 days notably for the lstm model the mae value of the prediction error in the range of 0 30 days is lower than 0 4 c for both single inlet and stratified intake schemes fig 13 based on the actual situation at jp i there are 24 leaves in each layer of the stoplog gate it generally takes 1 2 h to install and remove one leaf and 3 6 days to complete the installation or removal of one layer therefore the three tgml models developed in this paper also meet the required prediction and engineering facility adjustment time frames for stoplog gate operation among the three models the lstm model requires the longest time to obtain a high precision prediction and exhibits the best performance from the perspective of the prediction period in conclusion jointly considering the prediction accuracy computational efficiency and prediction lead times and corresponding uncertainties the lstm model provides the highest simulation accuracy the fastest training speed the highest prediction speed and the longest prediction period with reliable performance therefore we conclude that the lstm model is the most suitable model for the practical guidance of stoplog gate operation and is the best candidate model for use in the tgml framework 6 conclusions stratified water intake facilities as a widely used engineering infrastructure to improve reservoir outflow water temperature conditions in hydropower projects play an important role in mitigating the adverse eco environmental impacts of hydropower projects since 2000 nearly 20 large scale hydropower projects in china have adopted stoplog gate type stratified water intake facilities however due to the lack of scientific and effective modeling tools the operation of stratified water intake facilities is still in the exploratory stage there is still great space for the optimization of stratified water intake facility management both empirically based and numerical simulation based approaches often result in unsatisfactory water temperature estimations therefore improving the operation effect of stoplog gates has become an urgent and practical problem in the scientific research community and operation sector to address this problem we developed a prototype tgml modeling framework and verified the model performance for the jp i reservoir in southwest china three ml algorithms svr bp and lstm were selected to build a tgml model framework based on the formation mechanism of the reservoir water temperature structure the concept of generating a training dataset for the tgml model with an efdc model was also proposed due to the insufficiency of in situ water temperature observation data then we compared the prediction results in terms of model prediction accuracy computational efficiency and the lengths of the prediction lead times along with model reliability to determine whether the engineering and operation requirements of the stratified intake facilities in our study case were met based on our experimental results the main conclusions are as follows 1 the tgml model trained with efdc model generated data demonstrates a good level of statistical performance and the trained model can produce satisfactory results in terms of reservoir outflow water temperatures notably the training dataset generated by the efdc model can effectively support the training of the tgml model and the results verify the feasibility of training tgml models with data generated by numerical simulation models instead of observation data this approach to filling in missing records or extending short records of in situ data with physically based hydrodynamic models can effectively overcome the limitation of insufficient observation data and has certain value and reference significance for solving similar problems 2 among the three ml models the lstm model exhibits remarkable performance in terms of the prediction accuracy computational efficiency and forecast lead times specifically the obtained mae value can reach 0 228 0 269 c the training time of lstm is less than 10 min and the prediction time is less than 2 s for the single inlet scheme lstm can maintain high precision prediction performance for 0 13 days and for the stratified intake scheme lstm can maintain high precision prediction performance for 0 6 or 7 days 3 the tgml model based on the lstm algorithm is suggested for its overall superiority over the other two employed ml models notably the statistical measurements obtained from our proposed model can exceed or reach the same level of accuracy against several commonly used hydrodynamic models including the dl mike3 efdc and ce qual w2 models table 5 we infer that the proposed efdc tgml model could be a future alternative management tool to simulate the outflow temperature and distribution for stratified water intake facilities 4 in this paper based on the tgds paradigm we constructed a tgml reservoir outflow temperature prediction model the research results show that this model can be used as a surrogate model for high fidelity hydrodynamics it can achieve the same prediction accuracy as the traditional numerical simulation model based on a physical mechanism and greatly reduce the calculation cost it provides a solution to the problem of rapid decision making however there are still some limitations to this model currently the accuracy of this model is only verified in the water temperature prediction of the jp i hydropower facility to extend it to the prediction of water temperature in other reservoirs or lakes or even in other fields researchers need to identify the main influencing factors according to the prediction objectives and incorporate the data generated by numerical simulation models or observation data to train the ml model credit authorship contribution statement di zhang writing original draft methodology formal analysis visualization dongsheng wang writing review editing conceptualization qidong peng writing review editing data curation funding acquisition junqiang lin software validation funding acquisition tiantian jin software validation tiantian yang writing review editing soroosh sorooshian supervision yi liu supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the meteorological data in this paper are available at the china meteorological data service center http data cma cn this paper is a part of a joint cooperation among the china institute of water resources and hydropower research the china renewable energy engineering institute the university of california irvine university of oklahoma the financial support for this study was made available from the national key research and development program of china 2018yfd0900800 2018yfe0196000 2018yfe0128500 the research fund of the state key laboratory of simulation and regulation of water cycle in river basin skl2020zy10 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127427 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3653,stratified water intake facilities are important pieces of engineering infrastructure that monitor the outflow temperature conditions of hydropower projects the outflow temperature can significantly impact the downstream eco environment and normal functioning of aquatic organisms in streams however due to the lack of scientific and effective management tools for stratified water intake and the complexity of the hydrodynamics associated with hydropower generation both the research community and operation sectors are making great efforts to explore new tools and technology to better monitor predict and control stratified intake facilities in this study surrogate models of the environmental fluid dynamics code efdc model based on the theory guided machine learning tgml paradigm are constructed these models are applied to outflow temperature prediction for the jinping i hydropower plant in china the results show that 1 the prediction precision of the high fidelity hydrodynamic and water quality efdc model is successfully emulated by a tgml model based on a long short term memory lstm algorithm and 2 the tgml model accuracy based on the mean absolute error mae value obtained using the lstm algorithm can reach 0 228 0 269 c the prediction time is less than 2 s the period of high precision prediction is 6 13 days and the model can guide the operation of stratified intake facilities in practice keywords hydropower projects stratified water intake outflow temperature theory guided machine learning model surrogate model 1 introduction in the 21st century with the rapid development of the global economy and society the demand for energy has risen sharply as a clean energy source hydropower has become a key research focus and its development and utilization are extremely important in the renewable energy domain statistics from the u s department of energy show that 27 of the growth in renewables worldwide is expected to come from hydroelectric power primarily from the construction of large scale hydropower projects u s department of energy 2016 china s hydropower development has also entered a peak period since 2000 and a number of large world class dams e g the jinping i dam xiluodu dam and nuozhadu dam have been built because of the favorable terrain conditions in southwest china according to the relevant statistics there are more than 190 reservoirs with a dam height of more than 100 m in china liu and wen 2016 by 2020 the installed hydropower capacity in southwest china reached 240 gw accounting for 70 6 of the country s total hydropower generation capacity national energy commission 2016 with the help of the west to east power transmission project national energy security has been effectively guaranteed xu 2021 although these large reservoirs could contribute to a high level of hydroelectric power generation and are beneficial for the possible reduction of carbon emissions they may cause a series of eco environmental problems petts 1985 nilsson and berggren 2000 webb et al 2008 a change in the water temperature regime is one of the adverse environmental impacts of large reservoirs tao et al 2019 water temperature is a crucial physical property of rivers and lakes and has a direct impact on almost all ecological and biogeochemical processes including chemical reaction rates oxygen solubility algal growth primary production and fish habitats carron and rajaram 2001 todd et al 2010 ren et al 2020 to reduce the negative effects on water quality and eco environment functioning caused by temperature stratification in reservoirs temperature control measures such as stratified intake devices and thermocline breaking devices are commonly used in hydropower station construction johnson and vermeyen 1993 bartholow et al 2001 deng et al 2011 stratified intake facilities change the position of the intake to discharge water that best meets the temperature demand this approach is considered an important engineering measure to mitigate the adverse ecological and environmental impacts of water temperature stratification deng et al 2011 for example in the 1990s to mitigate the adverse effects of low temperature outflows on rainbow trout a multilevel opening intake tower with a width of 76 2 m and height of 91 44 m was built at the shasta hydropower station and powerhouse in northern california usa after construction a study showed that the discharge water temperature was able to fully meet the ecological demand and the number of salmon living downstream of the shasta dam had significantly increased deng et al 2011 to date this giant intake tower structure is still the largest artificial fish protection water infrastructure worldwide stratified intakes with a stoplog gate are a new type of design that can change the intake position by stacking different layers of gates before the intake the number of stoplog gate layers can generally vary from one to four this approach is more flexible than the fixed multiposition opening intake tower i e the one used at shasta dam ren et al 2020 since 2000 stratified water intakes have been built at nearly 20 new large reservoirs in china including jinping i xiluodu wudongzhou baihetan nuozhadu etc however this new type of water intake infrastructure is still in the exploration stage and lacks mature management and modeling tools which could guide the optimal operation of the stoplog gate at present the operation and management of stoplog gates is generally based on the operating scheme proposed in the design stage which relies on the given water level conditions without consideration of the actual inflow conditions and water temperature scenarios based on in person communication with several dam operators in southwest china the current operation guidance from the stratified water intake design manual often leads to unsatisfactory operation for example the observed water temperature data of nuozhadu hydropower from 2015 to 2016 show that although the designed number of stoplog gate layers is three the water temperature demand of downstream fish spawning can be met with only one layer for xiluodu hydropower although the designed number of stoplog gate layers is four only one layer has been used in practice because of the lack of scientific guidance unfortunately the outflow water temperature of xiluodu has only increased by 0 4 c which makes it difficult to significantly improve the water temperature conditions downstream therefore there is still great space for the optimization of stratified water intake facility management it is difficult to achieve satisfactory operation with only the stratified water intake scheme formulated in the design stage addressing this gap has become an urgent engineering issue that requires scientific research development therefore this study focuses on developing a temperature prediction model for the operation management of stratified water intake facilities to predict the outflow temperature of reservoirs two major methods include empirical formulas and numerical simulations the advantages of the empirical formula method are its fast calculation speed its ease of implementation and its strong practicality however empirical formulas can only reflect the statistical trends of water temperature changes and they lack in depth physical explanations of the causes of water temperature changes thus the model results may involve large uncertainty and the prediction accuracy cannot be controlled to within a certain confidence threshold because of these drawbacks the empirical formula method is still limited in practical application in contrast the numerical simulation method encompasses our understanding of hydraulic processes and is based on decades of observations and experiments read et al 2019 in other words numerical simulation approaches could effectively avoid the drawbacks of empirical formulas and ensure high prediction accuracy kollet and maxwell 2008 in this study numerical simulation approaches remain the preferred choice for water environment prediction fatichi et al 2016 hipsey et al 2015 however due to the interactions among meteorological hydrological hydrodynamic and human activities caissie 2006 rice and jastram 2015 vliet et al 2011 ding et al 2015 chen et al 2016 making accurate predictions of the water temperature is challenging especially for large lakes and reservoirs read et al 2019 moreover the operation of stoplog gates and human factors jointly place another barrier for numerical simulation models to effectively predict the water temperature distribution finally most water temperature models are associated with complex parameter calibration procedures and high computational burdens numerical simulation models such as the ce qual w2 and environmental fluid dynamics code efdc models are high fidelity hydrodynamic and water quality models that can accurately simulate the water temperature distribution however the calculation cost of such models is high and it usually takes several hours to several days to complete a calculation alkan and eli 2009 gelda and effler 2007 in practice stratified intake facilities need to adjust the operating scheme in real time according to the inflow conditions and water temperature scenario therefore the use of ce qual w2 and the efdc model to guide stratified intake facilities is questionable as the nature of operation and decision making require a high model calculation speed and an accurate water distribution simulation with extended simulation periods therefore it is necessary to build a surrogate model for high fidelity simulation that inherits the prediction ability of high fidelity models reduces the calculation time and satisfies the threefold requirements of stratified intake facility operation and management based on the corresponding prediction accuracy calculation speed and prediction period of the water temperature model in recent years the rapid development of data driven models such as machine learning ml algorithms has changed the traditional scientific research paradigm and provided a new way to overcome the technical difficulties associated with rapid water temperature prediction ml models no longer seek to manually establish theoretical relationships among variables instead these models are designed to capture the internal relationships between the input and output variables which can be determined through data analysis mazzocchi 2015 therefore ml models have an advantage in solving nonlinear problems with many complex and uncertain factors in addition ml models are capable of achieving the same level of accuracy as traditional numerical simulation models kim et al 2021 while providing a higher computational speed and lower computational costs james et al 2018 additionally ml models have become a popular surrogate set of modeling tools in assisting water resource management especially reservoir discharge operation rezaee et al 2018 zhang et al 2018a yang et al 2016 2020 naeini et al 2020 ml models also have some drawbacks that limit their application for instance 1 ml models are typical black box models and lack theoretical support which can lead to spurious and inaccurate predictions lazer et al 2014 2 the selections of training schemes and model structural parameters will significantly affect the black box model predictive performance and simulation uncertainties yang et al 2017a yang et al 2017b and 3 ml models often require massive training datasets to learn the dynamics of complex systems and a lack of training data will reduce the learning effect chen et al 2018 to address the nontransparency issue and the model uncertainty issue associated with black box data driven models a new research method theory guided data science tgds has been proposed karpatne et al 2017 the idea of a theory oriented model is to embed the physical mechanism into the data science model to improve the prediction performance of the data science model recently researchers have introduced many methods to embed physics into data science models karpatne et al 2017 and karniadakis et al 2021 systematically reviewed these methods and nearing et al 2021 analyzed the research progress of tgds in the field of hydrology at present the commonly used methods of embedding physical mechanisms into ds models especially ml models include theory guided machine learning tgml model design and tgml model learning and training there are several main methods of tgml design one is the selection of input and output factors based on a physical mechanism which is also currently the most common structural design method for tgml karpatne et al 2017 haklidir et al 2020 the second is to divide the scientific problem into several subproblems under theoretical guidance and determine its input and output while ensuring the physical connection between the input and output for example to describe the overall hydrological process of surface runoff we can build ml models for different subprocesses such as the atmospheric processes of rainfall and evaporation and the groundwater seepage process karpatne et al 2017 third the ml algorithm is used to train some parameters in the physical model karpatne et al 2017 there are three main schools of thought in tgml model learning and training first an ml system is trained based on sufficient observational data or data generated from a high fidelity physics model thus promoting the learning of functions vector fields and operators that reflect the physical structure of the data karniadakis et al 2021 second one approach focuses on designing specialized ml architectures that implicitly embed any prior knowledge and inductive biases associated with a given predictive task the most typical of these methods are the convolutional neural network designed for image recognition and the recurrent neural network designed for sequential problems karniadakis et al 2021 the third school of thought embeds physical mechanisms into ml models by adding soft constraints to ml such as adding a penalty function to the loss function of an ml model karniadakis et al 2021 recently the tgds paradigm has started to gain prominence in a number of scientific disciplines such as science hydrology and hydromechanics paniconi and putti 2015 wang et al 2016 volpiani et al 2021 the current research results show that the tgds model can guarantee the prediction accuracy of the model and effectively reduce the computational cost which is of great value for providing real time guidance for production practice karpatne et al 2017 read et al 2019 to the best of the authors knowledge there has been limited tgds research in the field of water temperature prediction in reservoirs especially in large stratified reservoirs so it is of great value to perform case application research the tgds framework aims to enhance the effectiveness of ml models by integrating the strengths of theoretical cognition and data science to provide theoretical and physical support for the employed ml models as defined by tgds theory the most effective way of integrating theoretical cognition and data science is to select input factors and output factors based on the underlying physical mechanisms thus a better mapping relationship between the predictors and target variables can be established karpatne et al 2017 the mapping relation is closely related to the selection of the algorithm and the performance of the algorithm will directly impact the prediction effect of the model zhang et al 2018a therefore in addition to selecting appropriate input variables and defining input types for each input variable in compliance with the physical laws it is also necessary to reasonably select the ml algorithms to be applied in other words the tgds framework allows both the training data and the candidate ml models to be prescreened and tested to better match reality and our understanding of the physical dynamics of the problem based on applied research with ml models in reservoir management this paper preliminarily selects ml algorithms that are capable of predicting outflow temperatures support vector regression svr originated from the support vector machine svm algorithm and is one of the most widely used ai models in reservoir management lin et al 2006 hipni et al 2013 lin et al 2006 used the manwan reservoir as an example and proved that svr had a strong ability to predict reservoir outflow moreover haklidir et al 2020 explored the application of an svm model to predict water temperatures the bp algorithm is a representative traditional neural network algorithm and is widely used in reservoir management and water temperature prediction shaw et al 2017 zhang et al 2018a lstm a new deep learning model has shown excellent performance in the field of hydrological prediction in recent years zhang et al 2018a read et al 2019 therefore these three algorithms are selected in this study to build a prediction model of the reservoir outflow temperature based on the tgml research paradigm within the tgml framework we will identify the ml algorithm that is most suitable for outflow temperature prediction by analyzing the water temperature prediction results of the three algorithms and comparing their performances to address the aforementioned third drawback of ml models we will generate the training dataset based on the results from the numerical simulation model at present most of the water temperature observation data for large reservoirs and lakes around the world are limited or not publicly accessible the limited amount of water temperature data often cannot support the training of the tgds framework to overcome the limitation of insufficient observational data we refer to international solutions to similar problems and explore the use of numerical simulation model generated data to replace observations and to further train data driven ml models shaw et al 2017 james et al 2018 therefore based on the above experience this study provides training samples for the tgml model with the efdc model which is a widely recognized three dimensional environmental hydrodynamics model in summary the research objectives of this paper are as follows 1 relying on the research paradigm of the tgml algorithm this paper constructs a prediction model of reservoir outflow temperature based on the svr bp and lstm algorithms 2 the tgml models are trained with efdc model generated data to learn the physical mechanism behind the data 3 the prediction performance of the three tgml models is tested from three perspectives prediction accuracy calculation speed and prediction period and 4 taking the prediction of the outflow temperature of the jinping i jp i hydropower station as an example the applicability of the tgml models in guiding the operation and management of stratified water intake facilities is analyzed 2 methodology 2 1 overview this paper aims to develop a model based on the tgds research paradigm to rapidly and accurately predict the outflow temperatures of temperature stratified reservoirs under the control of stoplog gates the tgml model construction process and overall approach are illustrated in fig 1 according to fig 1 in the first model development step we build a tgml based conceptual model for rapid water temperature prediction and select the input and output variables of the model based on the physical causes of water temperature stratification in the second step combined with the conceptual model and existing research reports three ml algorithms are selected to predict outflow temperatures independently and the corresponding code is developed in this paper both the tgml model and the candidate ml algorithms are compiled based on the python 3 5 language in the third step we determine whether the collected observational data meet the training requirements of the tgml model if so the observation data are directly sorted to form a dataset that can be used for tgml model training otherwise the efdc model is executed to generate outflow temperatures under the design conditions then the design conditions and corresponding outflow temperatures are used to establish a new training dataset that consists of both observations and numerical model simulation results in the fourth step the tgml model is trained based on the dataset established in step 3 and the trained model is used to predict outflow temperatures the performance of each ml algorithm is evaluated and the best ml algorithm is selected to guide the operation of stratified intake facilities 2 2 mechanism analysis the development of the tgml model for rapid water temperature prediction needs to be based on the physical causes of water temperature stratification therefore based on an analysis of the physical mechanisms of water temperature stratification in large reservoirs we identified the factors that affect the outflow temperatures the ml model is endowed with a physical mechanism by taking the influence factors as the input of the ml model and determining the data input type numerical type or vector type according to the role of each factor in the model through a literature review we identified the inflow of the reservoir inflow temperature outflow reservoir water level water intake depth number of operating layers of the stoplog gate air temperature relative humidity solar irradiance wind speed and cloud cover as the main factors that could affect the reservoir outflow water temperature caissie 2006 poole and berman 2001 after the construction of hydropower projects the water level in front of the dam rises to form a reservoir the retention time of water bodies in the reservoir area is lengthened and the reservoir inflow and meteorological conditions carry external heat into the water bodies in the reservoir area thus different water temperature structures are created through the redistribution of convection turbulent diffusion and thermal density flows for a reservoir especially a long narrow and deep reservoir there is little lateral difference in water temperature with a distinct water temperature trend in the longitudinal direction overall the water temperature structure exhibits an obvious vertical stratification phenomenon especially for deep water reservoirs with a high dam thermal stratification combined with reservoir regulation causes the water temperature in reservoirs to highly differ from that of original natural rivers li et al 2020 current research shows that many factors can affect the outflow temperatures including the geographical location meteorological conditions inflow temperatures runoff characteristics reservoir geometric characteristics and operating rules caissie 2006 poole and berman 2001 fig 2 the geographic location is related to the climate type in the reservoir area and can affect the external heat inputs meteorological conditions and inflow temperatures are the main external heat sources of reservoirs among the different meteorological factors air temperature solar irradiance cloud coverage wind speed and relative humidity have a considerable influence on water temperature runoff characteristics and reservoir geometric characteristics mainly affect the internal heat exchange process of reservoirs by influencing the mixing degree of a water body the operating rules of reservoirs such as the operating water level outflow and position of the water intake affect the redistribution process of heat in reservoirs and are closely related to the outflow temperature caissie 2006 poole and berman 2001 except for the geographical location and the geometric characteristic parameters the quantitative indices of all other factors in fig 2 are included in the input set of the tgml model specifically the input factors include the month operating water level outflow number of operating layers of the stoplog gate water intake depth inflow inflow temperature air temperature solar radiation wind speed air relative humidity cloud cover etc and the output of the model is the outflow temperature fig 2 meanwhile according to the role of each factor in the model we defined the input type of each factor among which the month and the number of operating layers of the stoplog gate are mainly used for classification and identification thus the data input type is a binary vector type and the data input type of other factors is a numeric type in this research we select jp i as the study case the geographical location and geometric characteristic parameters of the jp i reservoir will not change therefore these two factors can be left out from the tgml model considering that the month and number of operating layers of the stoplog gate mainly play the role of labels and belong to categorical variables they are input in the one hot encoding format the mathematical expression of the tgml model is shown in eq 1 as follows to f m qi m qi t qo tm tt l d n ta h t rt w c 1 where t o t is the outflow temperature c m is the month in the current period binary vector qi m is the inflow of the mainstream yalong river m3 s qi t is the inflow of the xiaojinhe tributary reservoir m3 s qo is the outflow m3 s tm is the inflow temperature of the mainstream yalong river c tt is the inflow temperature of the xiaojinhe tributary reservoir c l is the reservoir water level m d is the water intake depth m n is the number of operating layers of the stoplog gate binary vector ta is the air temperature c h t is the relative humidity rt is the solar irradiance w m2 w is the wind speed m3 s c is the cloud coverage 2 3 study case and data sources 2 3 1 jinping i reservoir jp i jp i are selected as the study case which includes the highest double curvature arch dam in the world jp i is located on the mainstream yalong river in sichuan province china fig 3 jp i is a key water infrastructure within china s southwest water conservancy project and it serves multiple purposes such as power generation flood control and sediment retention functions the installed capacity of the jp i power station is 3600 mw the annual average power generation is 16 620 million kw h the maximum dam height is 305 m the normal water level is 1880 m the dead water level is 1800 m the total storage capacity is 7 76 billion m3 the regulated storage capacity is 4 91 billion m3 and the annual water exchange frequency is 5 0 the jp i reservoir drainage area is long and narrow the backwater length of the main reservoir area is 59 km and its xiaojinhe tributary reservoir area is 90 km therefore water temperature stratification is obvious the points marked in green in the figure are the long term observation points for water temperature and the observation data include the inflow and outflow temperatures of jp i the yellow points are the vertical sections of water temperature observations b1 8 are located in the main reservoir area of the yalong river and b9 11 are distributed in the tributary reservoir area the observation data can be used to characterize the vertical water temperature structure of the reservoir and the observation frequency is once a month 2 3 2 operating rules of the jp i stoplog gate jp i is equipped with 6 generator sets in total and the leading edge of the water inlet of each generator set is divided into 4 grid holes by the grid pier with a total of 24 grid holes the number of water gates is also 24 and each hole can be equipped with a maximum of three layered stoplog gates with a total of 72 gate leaves according to the operation rules of jp i the operation period of the stoplog gate is from march to june during this period the hydropower station can adopt four water intake schemes a single inlet without a stoplog gate a one layer stoplog gate a two layer stoplog gate and a three layer stoplog gate the water level requirements and the corresponding water intake elevation for each scheme are shown in table 1 scheme 1single inlet scheme the top elevation of the intake is 1779 m scheme 2acc or ding to the scheme of the one layer stoplog gate when the water level of the reservoir is higher than 1814 m a one layer stoplog gate should be installed when the water level is lower than 1814 m the stoplog gate should be removed scheme 3acc or ding to the scheme of the two layer stoplog gate when the water level of the reservoir is higher than 1828 m a two layer stoplog gate should be installed when the water level is between 1828 m and 1814 m the top stoplog gate should be removed and the remaining one layer stoplog gate should be used and when the water level is lower than 1814 m all the stoplog gates should be removed scheme 4acc or ding to the scheme of the three layer stoplog gate when the water level of the reservoir is higher than 1835 m a three layer stoplog gate should be installed when the water level is between 1835 m and 1828 m the top stoplog gate should be removed and the remaining two layer stoplog gate should be used when the water level is between 1828 m and 1814 m the top stoplog gate should be removed again and the remaining one layer stoplog gate should be used to block water and when the water level is lower than 1814 m all the stoplog gates should be removed 2 3 3 data sources the collected data mainly included topographic data meteorological data operation data and water temperature observation data for jp i excluding terrain data the period of other data was from april 1 2015 to march 31 2016 the topographic data include the measured whole reservoir topography of jp i the meteorological data include the air temperature relative humidity solar radiation wind speed and cloud cover obtained at the muli yuexi and yanyuan meteorological stations near jp i the cloud cover data were obtained from reference chen 2010 all other meteorological data were obtained from the china meteorological data service center http data cma cn the operation data of the power station involve managing the inflow outflow reservoir water level number of operation layers in the stoplog gate and depth of the water intake the water temperature observation data include long term water temperature observations for inflows and outflows and short term vertical profile water temperature observations the specific layout of observation points is shown in fig 3 the vertical observation section is located in the jp i reservoir area a total of 11 observation sections are arranged and the observation frequency is once a month a detailed list of collected data is shown in table 2 2 4 machine learning algorithm in this paper three supervised ml algorithms svr bp and lstm are selected to build a rapid prediction model of reservoir outflow temperatures and the performances of the three models are compared the svr algorithm is a classical machine learning algorithm that is widely used because of its generalization ability and effectiveness in finding a global optimal solution cortes and vapnik 1995 the core concept of svr is to nonlinearly map the original data to a higher dimensional feature space and solve a linear regression problem in this feature space the svr algorithm is one of the most widely used ml models in reservoir operation khalil et al 2005 hipni et al 2013 aboutalebi et al 2015 therefore this study uses the svr algorithm to build a fast prediction model of outflow temperatures bp neural networks are among the most widely used algorithms that apply shallow artificial neural networks anns in the training of a bp network signals are propagated from front to back and errors are propagated from back to front in the back propagation of errors the network weights and deviations are adjusted layer by layer and this training method yields a bp neural network with excellent ability to deal with nonlinear problems haykin and lippmann 1994 lippmann 1988 jain et al 1999 the bp algorithm has been widely used not only in reservoir operation and water environmental factor prediction chaves and chang 2008 zhang et al 2018a yang et al 2017a but also in water temperature prediction in recent years shaw et al 2017 for example shaw et al 2017 used an ann algorithm to predict the impact of cordell hull and old hickory reservoirs on the outflow water temperature of the cumberland river in tennessee however most studies have focused on the prediction of water temperatures in shallow lakes and reservoirs or surface water temperatures in deep lakes and reservoirs therefore it is challenging and uncertain to use a bp algorithm to predict the outflow temperatures of large and deep reservoirs the lstm algorithm is a representative deep learning algorithm an lstm is a type of recurrent neural network rnn that includes specialized memory cells that can capture multi time step relationships hochreiter and schmidhuber 1997 gers et al 2000 lstm is a sequential model compared with the single point interconnection between the input layer and the output layer in the traditional ann model the lstm model provides cyclic interconnections between the input layer and the output layer that is the output of the previous moment is added to the calculation for the current moment as the input parameter therefore lstm models are effective tools for solving complex and sequential problems and they have been widely applied in water temperature prediction jia et al 2019 predicted the water temperature of the mendota reservoir based on an lstm algorithm read et al 2019 created a process guided deep learning model and an lstm was used to predict lake temperature dynamics at multiple depths 2 5 tgml model training and test given the short operating time of stratified water intake facilities at present the observed data that can be collected are limited this limitation makes it difficult to obtain data that can support the training requirements of ml algorithms therefore the concept of using a numerical simulation model to generate a dataset is proposed in this study in this paper the efdc model is selected as the dataset generation tool the efdc model is an open source three dimensional numerical model of environmental hydrodynamics that is widely used in the simulation of flow fields temperature fields and water quality for different types of water bodies such as rivers lakes and reservoirs devkota and fang 2015 arifin et al 2016 the detailed governing equations and specific application methods were described by hamrick 1992 1996 efdc model is developed based on physical mechanism the key factors of water temperature prediction sorted out above are also the boundary conditions that need input in efdc model to fully train the ml model and make it learn the physical mechanism of efdc well two conditions must be satisfied sufficient amount of training data working conditions that should cover all types of scenarios faced by jp i hydropower station as far as possible therefore we specify the following training steps fig 4 first based on the observed jp i data we calibrate the parameters of the efdc model and build an efdc model that can accurately simulate the water temperature of jp i second considering the inflow and outflow meteorological conditions inflow water temperature conditions stoplog operation scheme and other factors that have a considerable impact on the outflow temperature various operating scenarios are designed to cover the actual scenarios that jp i may face thirdly the calibrated efdc is used to simulate the water temperature distribution and outflow temperatures under various operating scenarios and the dataset is generated to meet the needs of ml model training for data samples finally ml model is trained by dataset to learn the physical mechanism of efdc model the design scheme of the operating scenarios is as follows in terms of flow three typical hydrological conditions are considered low flow years normal flow years and high flow years in terms of meteorological conditions the observed meteorological data from muli station yuexi station and yanyuan station near jp i are considered in terms of inflow temperature the observed inflow water temperature data from april 1 2015 to march 31 2016 are used as the base case and inflow temperatures were increased and decreased by 5 from the base case values stoplog operation schemes are designed according to the operation rules of jp i from march to june each year according to the water level conditions for different hydrological years four operating cases are designed a single inlet without a stoplog gate a one layer stoplog gate a two layer stoplog gate and a three layer stoplog gate various operating scenarios are combined with a total of 3 hydrological years 3 meteorological conditions 3 inflow temperatures 4 stoplog operation schemes 108 operating scenarios meanwhile for the convenience of later description we encode each working condition as shown in fig 5 for example nxo represents the combination conditions of high flow years meteorological conditions from yuexi station and observed water temperatures in this paper we performed the hold one out method for ml model training following the standard computer science practice in developing prediction models specifically the collected observation data and efdc simulation results under the nxo design conditions are used to test model performance and the remainder of the data are used for training in other words the training dataset includes the remaining 19 006 samples and 96 3 of the entire data record the test dataset contains 731 samples and is equivalent to 3 7 of the entire data record meanwhile to verify the performance of the model in the actual water temperature prediction we verified the performance of the ml model with the observed outflow temperature data from 2015 to 2016 2 6 tgml model performance evaluation the performance of the tgml model is evaluated from three perspectives prediction accuracy model computational time and prediction period for prediction accuracy the error e mean absolute error mae mean relative error mre and root mean square error rmse which are commonly used to evaluate the performance of water temperature prediction models are selected to evaluate the model accuracy hanna et al 1999 alkan and eli 2009 the corresponding formulas are as follows 2 e x i t i 3 mae 1 n i 1 n x i t i 4 mre 1 n i 1 n x i t i ti 100 5 rmse i 0 n x i t i n where xi is a predicted value and ti is an observed value 3 generation of the tgml model training dataset 3 1 water temperature simulation model for jp i based on the efdc model as mentioned above the tgml model training dataset includes both observation and simulated data from the efdc model the model simulation domain of the efdc model includes the whole reservoir drainage area of jp i including the main reservoir area of the yalong river and the tributary reservoir of the xiaojinhe river a comparative analysis of the simulation results and the observation results is shown in fig 6 taking april and several typical stream sections as an example fig 6 depicts the simulated vertical temperature distribution among the selected typical sections b8 is the observation section of water temperatures in front of the dam b5 is the observation section at the intersection of the main reservoir and the tributary reservoir b4 is the observation section of the main reservoir before the intersection and b10 is the observation section of the tributary reservoir before the intersection the above four sections are used to represent the water temperature distribution at the main characteristic points in the jp i reservoir area the results show that the efdc model can effectively simulate the spatial variations in thermal stratification from the tail of the reservoir to the front of the dam moreover the efdc model can also simulate the process of water temperature stratification in different seasons within a year fig 6 fig 6 shows that the efdc model can well simulate the effects of buoyancy driven flow and atmospheric heat exchange on the water temperature distribution as well as the interactions of the main and tributary reservoirs this result indicates that the simulated water temperature obtained from the efdc model could be reasonably used as a substitute for missing observation data or an extension of a short observation record to train the tgml data driven model subgraph a shows the mae of the efdc simulation results in different months subgraph b shows the comparison of observed and simulated values of vertical water temperature in representative observation sections in april subgraph c shows the vertical profile of the water temperature structure in the main reservoir and tributary reservoir in april simulated by efdc and subgraph d shows the two dimensional distribution of the vertical water temperature water level time in the b8 observation section in front of dam 3 2 tgml training dataset generated by the efdc model the 108 operating scenarios designed in our experimental setting see section 2 5 cover inclusive combinations of flow scenarios meteorological scenarios inflow temperature scenarios and stoplog gate operating schemes which may be used in jp i s practical operation in this section the reservoir water temperature distribution and outflow temperature for the 108 designed scenarios are simulated by using the calibrated efdc model the input conditions and efdc model simulation results are matched to form the training dataset for the later tgml model the dataset contains nearly 20 000 one to one corresponding operating conditions and outflow temperature values which can reflect the main water temperature meteorological characteristics runoff variation characteristics stratified intake operation mode and corresponding reservoir temperature distribution and outflow temperature under the above operating conditions 4 results 4 1 predicted outflow temperatures under nxo conditions before comparing the performance of the svr bp and lstm models we optimized the structural parameters of each model such as the numbers of hidden layers hidden nodes and iterations and the kernel function to determine the best performance of each model the supplementary materials show the specific results finally we determined that the best kernel function for svr is the radial basis function rbf the best number of hidden layers of the bp neural network is 1 the best number of hidden nodes is 32 and the best number of iterations is 2000 and the best number of hidden layers of lstm is 7 the best number of hidden nodes is 32 and the best number of iterations is 500 after the model structural parameters are determined this paper first considers outflow temperature prediction under nxo conditions as an example to compare the performance of three models namely svr bp and lstm based on the prediction accuracy calculation time and prediction period from march to june jp i uses four water intake schemes considering the water level under nxo conditions fig 7  single inlet scheme from march 1 to june 30 a stoplog gate is not installed  one layer stoplog gate scheme from march 1 to may 27 a one layer stoplog gate is installed and from may 28 to june 30 the stoplog gate is removed  two layer stoplog gate scheme from march 1 to april 22 a two layer stoplog gate is installed from april 23 to may 27 the top stoplog gate will be removed and the remaining one layer stoplog gate will continue to work from may 28 to june 30 the remaining stoplog gate will be removed  three layer stoplog gate scheme from march 1 to april 6 a three layer stoplog gate will be installed from april 7 to april 22 the top stoplog gate will be removed and the remaining two layer stoplog gate will continue to work from april 23 to may 27 the top stoplog gate will be removed again and the remaining one layer stoplog gate will continue to work from may 28 to june 30 the remaining stoplog gate will be removed 4 1 1 prediction accuracy in table 3 and fig 8 we present the outflow temperature prediction results of the three tgml models prediction accuracy is one of the key indicators used to evaluate model performance and we compare the accuracy of outflow temperature predictions for each tgml model additionally march to june is the main breeding period of fish in the basin where jp i is located and it is also the operation period of the stratified intake facilities in addition to the outflow temperature prediction accuracy at the annual scale this paper focuses on the prediction accuracy of the tgml model from march to june therefore this paper compares the prediction accuracy of the three models based on four schemes a single inlet scheme for the whole year and one layer two layer and three layer stoplog gate schemes from march to june the prediction results indicated that the mae of the svr model was 0 395 c that of the bp neural network was 2 533 c and that of lstm was 0 264 c for the whole year table 3 as shown in fig 8 the svr and lstm models can accurately simulate the annual variations in water temperature and the largest error corresponds to the period of obvious water temperature fluctuations from june to august the overall error of the bp neural network is large and predictions of the outflow temperature are comparatively inaccurate especially in the period when the water temperature rises from march to june the eneg value is 4 527 c and the epos value is 2 688 c compared to the results from the svr model the prediction accuracy of the lstm model is higher the accuracy ranking of the three models is lstm svr bp table 3 from march to june for the single inlet scheme the mae values of the prediction results of the svr bp neural network and lstm model are 0 427 c 0 530 c and 0 228 c respectively and the model accuracy ranking is lstm svr bp table 3 fig 8 thus lstm still yields the highest prediction accuracy and the bp neural network still provides the lowest prediction accuracy notably bp has difficulty achieving satisfactory prediction results from march to june for the one layer stoplog gate scheme the mae values of the svr bp neural network and lstm model are 0 405 c 0 620 c and 0 269 c respectively the accuracy ranking of the three models is lstm svr bp table 3 specifically the variation in outflow temperature from march to april is weak and the prediction results of the three models are generally accurate in may the outflow temperature rises rapidly the water temperature fluctuations increase and the prediction accuracy of the three models decreases fig 9 for the two layer stoplog gate scheme the mae values of the svr bp neural network and lstm model are 0 334 c 0 678 c and 0 258 c respectively and the accuracy ranking of the three models is lstm svr bp table 3 and fig 10 compared with the other models the lstm model exhibits significantly higher accuracy table 3 and fig 10 for the three layer stoplog gate scheme the mae values of the svr bp neural network and lstm model are 0 428 c 0 581 c and 0 247 c respectively and the accuracy ranking of the three models is lstm svr bp table 3 and fig 11 consistently with these findings the lstm model is able to achieve the highest prediction accuracy among the three models moreover as shown in fig 11 the operation of the stoplog gate will advance the warming period of the outflow temperature and the removal of the stoplog gate leads to a large fluctuation in the outflow temperature leading to a decline in prediction accuracy 4 1 2 computational time the calculation efficiencies of the three models are compared in the respects of training time consumption and prediction time consumption the training time consumption refers to the time required for the model to complete training and the prediction time consumption is the time required to perform processes between invoking the trained model and completing a prediction to reduce the random error each model is run 10 times in parallel and the training time consumption and prediction time consumption of each run are recorded for statistical analysis the results are shown in fig 12 the results show that the training time of the svr model is the longest for the svr model with an rbf kernel function used in this paper the training time required to search for the appropriate parameter combination is more than 200 h and the training times of the other two models are less than 10 min fig 12 after training the three models can give outflow temperature predictions based on the input conditions within 2 s fig 12 compared with the calculation time of the efdc model which can be a few hours or even a few days the calculation time of the tgml model provides a significant advantage 4 1 3 prediction period in addition to the prediction accuracy and calculation time the prediction period is an important indicator of model performance in this paper the key impact factor data from the previous 0 30 days see fig 2 for details are used as inputs and the outflow temperature at the current moment is the model output used to build the tgml model mae is used as the evaluation index to explore the prediction periods of the three tgml models for the svr model if the kernel function and relevant parameter settings are the same the prediction results will be the same so the svr model can only be run once for the neural network model since the initial parameters are assigned randomly during model training the prediction results of the model will be slightly different in each run to reduce the random error the bp and lstm neural network models are run 10 times in parallel and the average value is calculated for comparative analysis in fig 13 the prediction period analysis results for the three tgml models with different operating conditions for a single inlet water intake and stratified water intakes are presented the results show that although there are significant differences in prediction accuracy among different tgml models the trend of model accuracy with prediction time is basically the same as the prediction period increases the prediction accuracy of the model gradually decreases for the single inlet water intake scheme the prediction accuracies of the bp neural network and svr model for the outflow temperature within 0 12 or 13 days are highly similar and the model error fluctuates after 13 days the prediction error of bp and svr exhibits a gradually increasing trend the lstm model displays a small difference in prediction accuracy within 0 16 days after 17 days the prediction error of the model gradually increases with time then 27 days later the model error becomes stable again fig 13a for the stratified water intake scheme the model prediction accuracy changes with increasing prediction period and is similar for the three stoplog gate operating schemes the prediction errors of the svr and bp network models for the outflow temperature within 0 6 days vary minimally after 7 days the prediction errors of these models exhibit a gradually increasing trend then approximately 25 days later the model accuracy becomes stable again fig 13 the prediction errors of the lstm model within 0 6 or 7 days exhibit little change after 6 or 7 days the lstm prediction error displays a gradually increasing trend then approximately 17 days later the model accuracy becomes stable again fig 13 in addition the prediction accuracy of the lstm model is significantly higher than that of the svr and bp neural network models regardless of how far in advance the prediction of the outflow temperature is made additionally for the water temperature over the next 30 days the prediction accuracy of the lstm model is higher than that of the svr and bp models at the current moment fig 13 4 2 prediction results for the observed outflow temperature due to the failure of the observation equipment the outflow temperature observation datasets for april and may 2015 are incomplete therefore the prediction accuracy of the three tgml models for the observed outflow temperature in jp i from june 1 2015 to march 31 2016 is analyzed in this paper the results show that among the svr bp and lstm models lstm has the highest prediction accuracy with an mae value of 0 385 c and an mre value of 1 98 compared with lstm the svr model and bp neural network exhibit obvious disadvantages in terms of prediction accuracy the mae value of the svr model is 0 874 c and the mre is over 4 while the mae value of bp is 1 98 c and the mre is over 5 table 4 in addition by plotting the annual change curve between the predicted value of the tgml model and the observed outflow temperature we can assess the coincidence between the predicted curve and the observed curve and the results are shown in fig 14 notably the outflow temperature is high from june to september and the water temperature fluctuates considerably so the prediction error of the three models in this period also fluctuates highly however overall all three models can predict the changes in water temperature in this period and the lstm model yields the highest prediction accuracy from october 2015 to february of the following year the outflow temperature gradually decreased and all models can predict the cooling trend of the outflow the predicted values of lstm are consistent with the measured values and the predicted values of svr and bp in the cooling period are generally lower than the measured values fig 14 march 2016 was the beginning of the operating period of the stoplog gate for jp i and the research results show that the lstm model can still simulate the water temperature variations well during the operating period of the stoplog gate the predicted values of the svr model are generally higher than the measured values while the predicted values of the bp neural network are generally lower than the measured values fig 14 in conclusion the prediction results of the observed temperature indicate that the lstm model performs significantly better than the svr and bp neural network models the lstm model has natural advantages over the svr and bp neural networks in addressing time sequence problems which has been verified in our research results then can lstm maintain its performance advantage compared with other time sequence models for example the autoregressive integrated moving average arima model is a time sequence prediction method proposed by box et al 1973 to obtain the periodic and trend information in a time sequence through regression analysis moving averages difference calculations and other methods to test the performance of the lstm model and arima we built a linear regression model to predict the change trend of the outflow temperature and an arima model to predict and adjust the residuals the results are shown in fig 15 the prediction results show that the mae value of the arima model is 0 499 which is higher than those of the bp and svr algorithms but lower than that of the lstm model additionally the prediction curve shows that arima has high randomness in the prediction error especially in august and september the prediction error of the arima model fluctuates greatly fig 15a from the perspective of the prediction period the prediction errors of the four models have a similar trend and the prediction errors all increase with the increase in the prediction period comparing the four models the prediction accuracy of the lstm model is always significantly higher than that of the other three models fig 15b 5 discussion 5 1 feasibility of using efdc model simulation data instead of measured data to train the tgml model the learning method of the ml algorithm in this paper is supervised learning by providing a large number of training samples for the ml models the mapping relationship between the input and expected output is established and the output of any possible input is then predicted based on this mapping relationship unlike the traditional numerical simulation model the ml model no longer focuses on describing the physical mechanisms among variables but through large sample data training the potential relationship among the variables can be directly and independently explored therefore evaluations regarding whether the number of training samples is sufficient and whether the sample values cover the possible ranges of input and output factors can be performed and the corresponding influence on the learning effect of the ml model can be assessed the operation time of a large hydropower project with stratified water intake facilities is short in china in addition the observed data that can be collected are limited in this paper jp i is used as a typical case study and we only collected water temperature distribution data in the reservoir area and outflow temperature data from april 2015 to march 2016 the amount of data collected makes it difficult to support ml model training and achieve good prediction performance therefore we refer to international ideas that solved similar problems for example ibm baylor university and notre dame university jointly developed an advanced wave forecasting system by using deep learning technology to overcome the limitation of insufficient training samples researchers used the traditional simulating waves nearshore swan model to generate a wave field and trained a deep learning network using generated data the results showed that the trained deep learning model not only greatly reduces the computing time and cost of swan but also achieves the same accuracy level as swan james et al 2018 additionally shaw et al 2017 used ce qual w2 simulations to generate outflow temperature and dissolved oxygen data and provide training samples for an artificial neural network ann model a prediction model of outflow temperature and dissolved oxygen was built based on the ann algorithm therefore we believe that in theory the tgml model trained from data generated by the efdc model has the ability to predict efdc model simulation results because the accuracy of the constructed efdc water temperature simulation model was verified based on observed data it is reasonable to believe that the tgml model trained with efdc simulation results should have the ability to predict the actual outflow temperature to verify this hypothesis in section 4 2 of this paper we used the efdc simulation results as the training set and the observed temperatures at hydropower outflows as the test set to test the predictive performance of the three tgml models then the feasibility of the trained tgml model was assessed by using generated data from the numerical simulation model instead of observed data to predict observed outflow temperatures considering the different water temperature thresholds under different conditions it may be biased to use the mae index to evaluate the tgml model performance therefore the mre value is used as the criterion for comparing prediction accuracy under different operating conditions the analysis results show that from the perspective of prediction accuracy the predicted results of the svr and lstm models for observed outflow temperatures are similar to the efdc simulated outflow temperatures and the prediction accuracy of the bp neural network results based on observed outflow temperatures is slightly lower than that of the efdc simulation results for outflow temperatures fig 16 table 3 and table 4 the tgml model trained by efdc model generated data instead of observed data exhibits good prediction performance and can achieve satisfactory results in the prediction of observed outflow temperatures this finding suggests that the training dataset generated by the efdc model can effectively support the training of the tgml model and verifies the feasibility of the concept of training the tgml model with data generated by a numerical simulation model instead of observation data this approach can effectively overcome the limitation of insufficient observation data and has certain value and reference significance for solving similar problems the blue circles represent the maximum and minimum errors of the tgml model for the efdc simulated outflow temperatures and the red dots represent the prediction errors of the tgml model for the observed outflow temperatures 5 2 applicability of the tgml model in the operation and management of stoplog gates the actual operation of stratified water intake facilities includes the adjustment of operating plans according to the inflow thermal conditions water level etc whereas our proposed modeling strategy better corresponds to the classical empirically based prediction and the numerical simulation approach moreover stratified intake facilities are difficult to install and it usually takes one to two weeks to install a one layer stoplog gate therefore a water temperature prediction model must provide acceptable prediction accuracy high computational efficiency and a long prediction period for operators to adjust the stratified water intake facility operation regarding prediction accuracy since few studies have focused on the accuracy requirements of guiding models for stratified water intake facility operation we discuss the accuracy standard that water temperature prediction models generally need to meet based on the results of reservoir water temperature prediction models from the many studies on temperature prediction effect evaluation with mae and rmse these two indicators are dimensional indices and are closely related to the numerical range of f prediction variables therefore to improve the effectiveness of the contrast we select studies with a temperature variation range similar to that of our study table 5 according to the derived statistical model performance the mae values of the three tgml water temperature prediction models developed in this paper are between 0 228 and 0 620 c the rmse values are between 0 305 and 0 805 c and the prediction accuracy is moderate table 3 and table 5 it is notable that the lstm algorithm could yield a water temperature prediction with an mae value of 0 228 0 269 c and an rmse value of 0 305 0 407 c table 3 and this prediction accuracy is superior to a number of physically based hydrodynamic models from the literature table 5 given this important finding from a model prediction accuracy perspective we believe that the three tgml water temperature prediction models developed in this paper can be used as surrogate models of many of the existing hydrodynamic models to assist stoplog gate operation and management in large hydropower projects the lstm water temperature prediction model performs best among the three models considered in this study and has shown great potential in predicting water temperature distributions in other study cases similar conclusions have been obtained by other studies in the field of reservoir operation for example zhang et al 2018a compared the performance of svr bp and lstm in gezhouba reservoir operation simulation the results showed that lstm had significantly better simulation accuracy than the other two models zhang et al 2018b compared the prediction effects of lstm and svr models on sewage flow the results showed that the lstm model had significantly higher simulation accuracy than the svr model combined with the discussion of these two articles we conclude that a possible reason for this phenomenon is as follows svr comes from the svm algorithm and its main advantage is in solving the classification problem whereas the bp neural network has a problem of gradient disappearance with the increase in the number of hidden layers which limits the feature extraction ability of the bp neural network the lstm algorithm effectively solves the gradient disappearance problem caused by the increase in the number of hidden layers has a stronger feature extraction ability and is made to solve the sequence problem outflow temperature prediction is obviously a sequence problem with complex influencing factors therefore the lstm algorithm should show the best prediction performance among the three algorithms cortes and vapnik 1995 gers et al 2000 zhang et al 2018a zhang et al 2018b according to our computational time analysis the training times of the bp neural network and lstm model are less than 10 min and the prediction time consumption after training is less than 2 s conversely the training time of the svr model is more than 200 h but the prediction time is less than 0 5 s fig 12 because model training can be completed in downtime periods at stratified water intake facilities in practice the predictive speed is the key factor that influences the real time decision making ability of a tgml model the three tgml models developed in this paper can predict water temperatures within 2 s and meet the requirements of fast decision making for the operation of stratified water intake facilities therefore we believe that based on the observed computational times all three tgml models meet the model runtime requirements of stratified water intake facility decision making the training speed and prediction speed of the bp neural network and lstm are high and the operating data observed at the previous moment can be added to the training sample set in real time thus the performance of these two models can be continuously improved through iterative training regarding the prediction lead times and the associated model uncertainty the bp neural network and svr model can maintain high predictive accuracy within 0 12 or 13 days and the lstm model can maintain high predictive accuracy within 0 16 days for the single inlet scheme for multilayer stoplog gate schemes the forecasting accuracy of the bp neural network svr model and lstm remains high over the prediction period of 0 6 or 7 days notably for the lstm model the mae value of the prediction error in the range of 0 30 days is lower than 0 4 c for both single inlet and stratified intake schemes fig 13 based on the actual situation at jp i there are 24 leaves in each layer of the stoplog gate it generally takes 1 2 h to install and remove one leaf and 3 6 days to complete the installation or removal of one layer therefore the three tgml models developed in this paper also meet the required prediction and engineering facility adjustment time frames for stoplog gate operation among the three models the lstm model requires the longest time to obtain a high precision prediction and exhibits the best performance from the perspective of the prediction period in conclusion jointly considering the prediction accuracy computational efficiency and prediction lead times and corresponding uncertainties the lstm model provides the highest simulation accuracy the fastest training speed the highest prediction speed and the longest prediction period with reliable performance therefore we conclude that the lstm model is the most suitable model for the practical guidance of stoplog gate operation and is the best candidate model for use in the tgml framework 6 conclusions stratified water intake facilities as a widely used engineering infrastructure to improve reservoir outflow water temperature conditions in hydropower projects play an important role in mitigating the adverse eco environmental impacts of hydropower projects since 2000 nearly 20 large scale hydropower projects in china have adopted stoplog gate type stratified water intake facilities however due to the lack of scientific and effective modeling tools the operation of stratified water intake facilities is still in the exploratory stage there is still great space for the optimization of stratified water intake facility management both empirically based and numerical simulation based approaches often result in unsatisfactory water temperature estimations therefore improving the operation effect of stoplog gates has become an urgent and practical problem in the scientific research community and operation sector to address this problem we developed a prototype tgml modeling framework and verified the model performance for the jp i reservoir in southwest china three ml algorithms svr bp and lstm were selected to build a tgml model framework based on the formation mechanism of the reservoir water temperature structure the concept of generating a training dataset for the tgml model with an efdc model was also proposed due to the insufficiency of in situ water temperature observation data then we compared the prediction results in terms of model prediction accuracy computational efficiency and the lengths of the prediction lead times along with model reliability to determine whether the engineering and operation requirements of the stratified intake facilities in our study case were met based on our experimental results the main conclusions are as follows 1 the tgml model trained with efdc model generated data demonstrates a good level of statistical performance and the trained model can produce satisfactory results in terms of reservoir outflow water temperatures notably the training dataset generated by the efdc model can effectively support the training of the tgml model and the results verify the feasibility of training tgml models with data generated by numerical simulation models instead of observation data this approach to filling in missing records or extending short records of in situ data with physically based hydrodynamic models can effectively overcome the limitation of insufficient observation data and has certain value and reference significance for solving similar problems 2 among the three ml models the lstm model exhibits remarkable performance in terms of the prediction accuracy computational efficiency and forecast lead times specifically the obtained mae value can reach 0 228 0 269 c the training time of lstm is less than 10 min and the prediction time is less than 2 s for the single inlet scheme lstm can maintain high precision prediction performance for 0 13 days and for the stratified intake scheme lstm can maintain high precision prediction performance for 0 6 or 7 days 3 the tgml model based on the lstm algorithm is suggested for its overall superiority over the other two employed ml models notably the statistical measurements obtained from our proposed model can exceed or reach the same level of accuracy against several commonly used hydrodynamic models including the dl mike3 efdc and ce qual w2 models table 5 we infer that the proposed efdc tgml model could be a future alternative management tool to simulate the outflow temperature and distribution for stratified water intake facilities 4 in this paper based on the tgds paradigm we constructed a tgml reservoir outflow temperature prediction model the research results show that this model can be used as a surrogate model for high fidelity hydrodynamics it can achieve the same prediction accuracy as the traditional numerical simulation model based on a physical mechanism and greatly reduce the calculation cost it provides a solution to the problem of rapid decision making however there are still some limitations to this model currently the accuracy of this model is only verified in the water temperature prediction of the jp i hydropower facility to extend it to the prediction of water temperature in other reservoirs or lakes or even in other fields researchers need to identify the main influencing factors according to the prediction objectives and incorporate the data generated by numerical simulation models or observation data to train the ml model credit authorship contribution statement di zhang writing original draft methodology formal analysis visualization dongsheng wang writing review editing conceptualization qidong peng writing review editing data curation funding acquisition junqiang lin software validation funding acquisition tiantian jin software validation tiantian yang writing review editing soroosh sorooshian supervision yi liu supervision declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the meteorological data in this paper are available at the china meteorological data service center http data cma cn this paper is a part of a joint cooperation among the china institute of water resources and hydropower research the china renewable energy engineering institute the university of california irvine university of oklahoma the financial support for this study was made available from the national key research and development program of china 2018yfd0900800 2018yfe0196000 2018yfe0128500 the research fund of the state key laboratory of simulation and regulation of water cycle in river basin skl2020zy10 appendix a supplementary data supplementary data to this article can be found online at https doi org 10 1016 j jhydrol 2022 127427 appendix a supplementary data the following are the supplementary data to this article supplementary data 1 
3654,an integrated simulation optimization framework is developed under uncertainty to enhance irrigation water productivity and control salinity in an arid area a full fuzzy dependent linear fractional programming approach is formulated by incorporating fuzzy dependent chance programming fuzzy credibility constrained programming and linear fractional programming within a general framework of irrigation planning then simulation module concerning water salt balance process and crop water salt production functions enables to quantify daily physical process of water and salt movement among the soil water crop root zone and groundwater aquifers thus this study can readily handle fuzzy uncertainty existing concurrently in the ratio objective i e economic water productivity through the concept of fuzzy dependent chance and double sided constraints it can also simultaneously provide the maximum credibility level that the objective is achievable and credibility levels implying that optimal solutions are believable besides daily variations of simulated physical parameters are illustrated corresponding to management strategies to demonstrate its applicability it s then applied to a case study of irrigation planning in the jiefangzha irrigation subarea in hetao irrigation district northwest china results can clearly analyze tradeoffs among satisfaction degree of fuzzy objective fuzzy constraints and optimal solutions moreover by examining different management targets and salt accumulation constraints this study demonstrates the merits and importance of the work to promote irrigation water productivity and control salinity dynamic decision making of irrigation planning is possibly made by coupling daily simulation and optimization modules therefore these findings can support decision makers to identify appropriate solutions for irrigation planning keywords economic water productivity salinity control management targets fuzzy mathematical programming irrigation planning uncertainty 1 introduction the problems of water scarcity and secondary soil salinization are important factors affecting the agricultural development in the arid regions schoups et al 2005 the appropriate irrigation planning is an essential means of regulating the soil water and salinity of agricultural land and ensuring the proper growth of crops mueller et al 2012 wang et al 2020 to better enhance irrigation water productivity and effectively control soil salt accumulation in arid agricultural areas it is desirable that optimal irrigation water management among multiple competing crops with limited water should be done zhang et al 2020 through optimization model managers are able to strengthen fine management of agricultural water and promote agricultural production levels in addition agricultural water management systems are often associated with various uncertainties such as water availability soil water content groundwater table crop prices and even preferences in the objective function pea haro et al 2011 lpez jaimes and coello coello 2014 li et al 2020 therefore it is necessary to consider the relevant uncertain factors in the study of optimal irrigation planning by employing suitable uncertain programming methods to characterize these uncertainties and effectively solve problems in traditional optimization models the total system benefits are generally chosen as their objective functions which aims to maximize economic returns resulting from water use however these methods may emphasize system outputs and hardly measure system efficiency that is associated with ratios between outputs and inputs zhu and huang 2011 in real world applications it is expected that there will be a higher irrigation water productivity which is also a question of system efficiency through defining agricultural production per amount of irrigation water use irrigation water productivity enables to reflect the relationships between water outputs and inputs pereira et al 2012 furthermore as an extension of irrigation water productivity economic water productivity is defined to measure the ratio between the whole economic benefits and total irrigation water use zhang and guo 2017 such practical problems are readily solved by method of linear fractional programming lfp initiated by charnes et al 1978 which is commonly employed when system efficiency e g revenue cost outputs inputs is to be measured for example gmez et al 2006 solved a forest planning problem though a linear fractional goal programming model however lfp method has been facing several challenges arising from uncertain information such as the random vague and hardly identified factors of study system among these uncertain programming methods fuzzy programming is a powerful method to tackle optimization problems in a fuzzy environment especially when parameters are estimated with insufficient statistical information and decisions should be made under different subjective preferences lu et al 2016 generally possibility measure necessity measure and credibility measure are the main three type of measures in fuzzy theory the former two measures have limitations in measuring fuzzy events that is they are not self dual in fuzzy decision making liu 2006 in practice credibility measure can compensate for their disadvantages as a fuzzy inequality indicator due to its self duality property which is definitely desired for example when a fuzzy event is measured by credibility e g c r a b if credibility level is 1 this fuzzy event will certainly occur and if credibility level reaches 0 such a fuzzy event will absolutely not occur zhang et al 2015 therefore credibility constrained programming was proposed based on the concept of credibility liu and iwamura 1998 furthermore credibility objectives and credibility constraints e g single sided and double sided fuzziness in constraints can also be readily solved by credibility programming methods in terms of credibility objectives wen and iwamura 2008 lau et al 2010 proposed a fuzzy credibility based model under hurwicz criterion to solve facility location allocation problem and optimize the distribution system design as for the credibility constraints pishvaee et al 2012 proposed a credibility based fuzzy programming model for green logistics design with right hand side of fuzzy constraints lu et al 2016 presented a credibility based chance constrained optimization model for integrated agricultural water resources management with the right and left hand sides of constraints in addition zhang et al 2015 employed a full credibility constrained programming method for planning water resources management and pollution control where credibility objective and double sided credibility constraints are concurrently appeared in the model nevertheless the decision makers sometimes prefer to maximize the chance or credibility of satisfying fuzzy events generally decisions are made at different pre determined credibility levels and then optimal solutions can be flexibly generated for supporting decision making zhang and guo 2017 here it should redefine a concept and theoretical framework of fuzzy dependent chance programming when these decisions are selected with the maximum credibility level to satisfy fuzzy event based on chance objective function which is a mathematically inverse question compared with traditional credibility programming methods for example a key question is what is the maximum credibility level in achieving the fuzzy goal therefore liu 1996 1997 proposed a framework of dependent chance programming to address this concern the main idea of dependent chance programming is to maximize the chance of satisfying uncertain events to make optimal decisions its characteristics is the chances of management targets are dependent after modeling the actual problems using deterministic and chance constrained models the set of feasible solutions are essentially determined but optimal solution given may not be applicable in practice conversely deterministic solutions can also be given by dependent chance programming but it only requires that the solutions be implemented as far as practically possible for example wang et al 2018 developed an interval quadratic fuzzy dependent chance programming model for optimal irrigation water allocation although dependent chance programming is available to the problems that confidence or credibility levels need to be optimized via the chance objective functions it cannot delineate the details and physical processes of soil water movement and salt transport two main approaches are commonly employed to simulate the hydrological process of soil water movement including conceptual water balance models and numerical water flow models based on the richard s equation simulation models based on the richard s equation are able to describe detailed interactions among soil water groundwater and solute transport such as swap hydrus imnek et al 2016 they are advantageous for investigating hydrological processes in agricultural fields with clear physical mechanisms moreover they usually focus on the field scale and can also be extended to a greater spatial scale through technique of remote sensing and geographic information system campos et al 2018 however it should be noted that these physical process based models have the following problems such as a large number of parameters non convergence under specific or boundary conditions and relatively complex calibration and validation of model in contrast water balance model is simple and relatively parameter less requiring only basic soil and water characteristics e g field capacity wilting point and crop parameters scanlon et al 2002 the model is stable and there are no numerical calculation problems therefore water balance model is convenient and practical for regional level irrigation water management nonetheless the simulation models can generally present better management decisions among these predefined alternatives based on scenario analysis but not the optimal one which suggests that simulation models only give the answer of what if singh 2012 as for the question of what is the best it should enhance its applicability through integration of optimization approaches previous studies on simulation optimization models have been done for water management guar et al 2011 darshana et al 2012 there are few studies on the framework of simulation optimization and fuzzy lfp method under uncertainty for irrigation planning and salinity control in this study an integrated simulation optimization framework is proposed for supporting irrigation planning which is formulated by coupling full fuzzy dependent linear fractional programming approach with simulation module of water and salt balance crop growth soil condition soil water and salt movement and water availability groundwater capillary rise and drainage are complexly linked and dictate what strategies of irrigation planning should be made for enhancing irrigation water productivity and controlling salinity thus it has the following advantages in 1 tackling fuzzy objective and fuzzy constraints and simulating daily physical interactions among soil water groundwater and salt transport using water balance model 2 making dynamic decision of irrigation planning possible 3 achieving the maximum credibility level of the fuzzy objective function when management target of economic water productivity is pre given and 4 controlling salt accumulation at the end of crop growth period through constraints related to salt transport and salt control then it s applied to a real world case study in jiefangzha irrigation subarea in hetao irrigation district northwest china irrigation planning among three crops during their crop growth period has been studied the obtained solutions can offer effective recommendations for irrigation planning and implementation of salt control practices moreover potential limitation includes the fidelity of physical models of water salinity as regional spatiotemporal variability of parameters and human activities e g water saving measures canal lining reduction of water diversion and alternation of plant structure are not considered 2 study system 2 1 study area the hetao irrigation district is located in the middle west of the inner mongolia autonomous region which is the third largest irrigation district in china with a control area of 11 600 km2 fig 1 it has a flat terrain with an average slope of only 0 02 and convenient irrigation conditions for diverting the yellow river water to agricultural fields thus it becomes an important grain production base in china in this study jiefangzha irrigation subarea as an important part of hetao irrigation district is chosen as study area it has a total area of 215 700 ha and cultivated area occupies approximately 66 the study area is located in an arid climate zone annual precipitation is 140 mm and annual potential evaporation is approximately 2 000 mm annual average temperature is about 7 c soil survey results show that the percentage of sandy loam soil in the study area is 67 and the percentage of silt clay soil is 33 xu et al 2010 major crops include maize wheat sunflowers melons tomatoes and peppers wheat maize and sunflower basically account for 15 35 and 25 of the total irrigated area while tomatoes and melons account for 19 generally the growing season for wheat maize and sunflower is late march to mid july early may to late september and late may to late september agricultural development mainly relies on irrigation where water withdrawal is from the yellow river nearly 90 of the total irrigated area is irrigated from the yellow river water the main irrigation methods are flood and border irrigation which are two typical types of surface irrigation crops are generally irrigated five to eight times during their growth period according to the rainfall condition of that year the irrigation time is empirically set as april 22th may 15th june 15th july 15th and august 15th the irrigation canal network of the whole irrigation subarea is well constructed with multi layered canals such a tree like irrigation canal system has a clear space layer structure with one main trunk canal three main canals six sub main canals and more branch canals moreover there are three main drainage ditches 12 sub main ditches and 52 branch ditches in the whole study area the long term and excessive irrigation from the yellow river has resulted in shallow groundwater depth in the irrigation area with an annual variation ranging from 0 5 m to 3 0 m furthermore due to the incompatibility between irrigation and drainage projects and poor developed drainage conditions problems of water and salinity imbalance during irrigation and drainage are caused for example the average annual drainage rate is about 10 of the volume of water diverted and the amount of salt discharge is about 1 3 of the salt content brought in which also causes the irrigation district to be in a long term state of salt accumulation statistically the average annual salt accumulation of the entire irrigation district is 183 g m2 ren et al 2016 in addition the intensive surface evaporation exacerbates soil salinization in the crop root layer therefore the problem of soil and groundwater salinization in irrigation area is facing severe challenges such adverse events naturally have a negative impact on crop growth and crop yield 2 2 problem statement policies of reduction in water diversion will inevitably cause competition among different crops for water thus proper irrigation water management is necessary in this case making sound irrigation planning decisions with the goal of enhancing irrigation water productivity becomes increasingly meaningful for maintaining the sustainable development of agriculture moreover better understanding the relationships between crop evapotranspiration and crop yield is critical to make strategies for managing irrigation water this is because crop yield is mainly affected by its actual evapotranspiration while soil water content and salinity in the crop root zone are the two major determinants of actual crop evapotranspiration especially the amount of crop evapotranspiration from groundwater recharge accounts for a large portion of the total crop water requirements at a shallow groundwater depth therefore the effects of soil water content and salinity on crop evapotranspiration and crop growth need to be considered that is simulations of these physical process among irrigation water soil water groundwater and its salinity transformation should be incorporated into the framework thus water and salinity balance models and crop water salt production functions are coupled with optimization model of irrigation water management to formulate an integrated simulation optimization framework for enhancing irrigation water productivity and controlling salinity besides the subjectivity of decision makers and the ambiguity of data lead to uncertainty in the study system which affects the reliability of irrigation water management under fuzzy environments for example a management target of economic water productivity is subjectively given the objective function is to maximize its credibility and achievable level therefore fuzzy mathematical programming methods need to be introduced to strengthen the usefulness of the optimization model 3 modeling framework this part presents the development and application of simulation optimization framework it contains the following three subsections the framework of this study is illustrated in fig 2 3 1 full fuzzy dependent linear fractional programming approach though the integration of fuzzy dependent chance programming fuzzy credibility constrained programming and linear fractional programming a full fuzzy dependent linear fractional programming approach is formulated it can fully deal with fuzzy objective and double sided fuzziness in the constraints details can be seen below 3 1 1 fuzzy dependent chance programming the main idea of fuzzy dependent chance programming is to maximize chance e g credibility level satisfaction degree of the objective function in fuzzy decision making a standard form of fuzzy dependent chance programming is presented 1a max c r f k x  0 k 1 2 m 1b s t g i x  0 i 1 2 n where cr is credibility measure which indicates credibility level of the objective function x x 1 x 2 x n is a vector of non fuzzy decision variables  is fuzzy variable f k x  0 k 1 2 m is fuzzy event and k is the number of fuzzy events g i x  0 i 1 2 n represents fuzzy environments 3 1 2 fuzzy credibility constrained programming fuzzy credibility constrained programming is able to handle the problems that their constraints are satisfied with predetermined possibility in a fuzzy environment then it can be transformed into deterministic crisps to solve single sided fuzziness or double sided fuzziness in the credibility constraints therefore the chance of occurrence of fuzzy events can be readily quantified through this method its general framework is written 2a max f j 1 n c j x j 2b s t c r j 1 n a ij x j b i  i i 1 2 m 2c x j 0 j 1 2 n where x j is non fuzzy decision variable and j 1 2 n c j is real parameter in the objective function a ij and b i are fuzzy parameters in the constraints  i is predetermined credibility level inequality 2b represents that the credibility of constraint i e j 1 n a ij x j b i should be not less than  i for example in the case of s t where s s 1 s 2 s 3 and t t 1 t 2 t 3 are fuzzy variables with membership function  c r s t is defined as follows 2d c r s t 1 if s 3 t 1 s 3 2 s 2 2 t 2 t 1 2 s 3 s 2 t 2 t 1 if s 2 t 2 s 3 t 1 t 3 s 1 2 t 3 t 2 s 2 s 1 if s 2 t 2 s 1 t 3 0 if s 1 t 3 therefore according to equation 2d credibility constraints can be transformed into deterministic ones see zhang and huang 2011 3 1 3 linear fractional programming linear fractional programming method is used to address ratio objective problems and measure system efficiency through balancing tradeoffs between outputs and inputs its general form can be formulated as follows 3a max f ax  bx  3b s t c x d 3c x 0 where a b c and d are real coefficients  and  are constant terms this linear fractional programming method is capable of handling deterministic ratio optimization problems but it can hardly deal with problems in uncertain environments in summary by incorporating fuzzy dependent chance programming fuzzy credibility constrained programing and linear fractional programming within a general modeling framework a full fuzzy dependent linear fractional programming approach can be formulated 3 2 integrated simulation optimization framework under fuzzy uncertainty there are several problems that need to be solved in this study 1 how to achieve the maximum credibility level of objective function under a given management target 2 how to measure system efficiency i e ratio objective between system benefits and the total irrigation water applied 3 how to investigate the daily water and salinity balance among irrigation water soil water and groundwater and 4 how to generate feasible strategies of irrigation planning for enhancing irrigation water productivity and controlling salinity thus an integrated simulation optimization framework under fuzzy uncertainty is developed that is to integrate water and salinity balance models crop water salt production functions and full fuzzy dependent linear fractional programming method into a general framework of irrigation planning it can be shown below 3 2 1 objective function 4a f max c r i 1 3 nb i a i y i i 1 3 a i c p i 10 i 1 3 t 1 175 c w i a i i w it  s 10 i 1 3 t 1 175 a i i w it  s ewp where f is objective function representing the maximum credibility level of a fuzzy event that economic water productivity is not less than a given fuzzy goal nb i c p i c w i and ewp are fuzzy variables in the objective function nb i is net benefits of crop i yuan kg i 1 2 3 and i 1 is spring wheat i 2 is maize and i 3 is sunflower c p i is cost of crop production per unit of area yuan ha c w i is cost of irrigation water use of crop i yuan m3 ewp is a fuzzy parameter representing economic water productivity that is defined as the ratio between system benefits and the total irrigation water use ewp ew p 1 e w p 2 e w p 3 yuan m3 a i is irrigated area of crop i ha y i is yield of crop i per unit of area kg ha i w it is allocated irrigation water of crop i on day t mm and t 1 2 175  s is comprehensive coefficient of irrigation water use and  s 0 6 actual crop yield y i varies with the ratio between actual and potentially maximum evapotranspiration in different crop growth periods it can be expressed as follows 4b 1 y i y m i k y 1 e t a i e t m i i where e t a i and e t m i are the crop evapotranspiration for yielding mm y i y m i are actual and potentially maximum crop yield kg ha k y is crop yield response factor in practice crop evapotranspiration is affected by water deficit and salinity then 4c e t a i t k ws i t k ss i t k c i t e t 0 i t where e t 0 is daily reference evapotranspiration mm k c i t is crop coefficient k ws i t is water stress coefficient and k ss i t is salinity stress coefficient for crop i on day t they can be estimated by the following equations 4d k ws i t 0  it  wp salt  it  wp s a l t  fc  wp s a l t  wp s a l t  it  fc 1  it  fc i t 4e k ss i t 1 b i 100 k y i e c e i t e c et i t e c e i t e c et i t 1 e c e i t e c et i t i t 4f  wp s a l t  wp b i e c eit e c et i t 100  fc  wp i t where  it is daily soil water content in the root zone of crop i cm3 cm3  wp and  wp s a l t are soil water content at wilting point under non saline and saline conditions respectively cm3 cm3 soil water content at wilting point will increase under saline conditions due to the combined matric potential and larger osmotic potential in the crop root zone beltro and asher 1997  fc is soil water content at field capacity cm3 cm3 b i is a crop specific parameter to describe the reduction in yield per unit of excess salts dsm 1 e c e i t is actual electrical conductivity of the saturation extract for the root zone and e c et i t is threshold of e c e i t when crop yield firstly reduces below y m i dsm 1 in this study area  fc 0 30 and  wp 0 10 3 2 2 constraints 1 irrigation water use constraint 4g c r  q s 10 i 1 3 t 1 175 1  a i i w it q s  s  pi  4h i w it 0 i 1 t 22 52 83 i w it 0 i 1 t otherdays 4i i w it 0 i 2 t 52 83 113 144 i w it 0 i 2 t otherdays 4j i w it 0 i 3 t 83 113 144 i w it 0 i 3 t otherdays 4k i w it 16 0 i t this constraint is used to limit the total irrigation availability based on fuzzy credibility constrained programming method  and q s are fuzzy parameters in the right and left hand sides of constraint  is coefficient of water loss during water conveyance  0 15 0 20 0 25 and q s is surface water availability q s 746 772 798 106 m3  pl denotes the proportion of irrigated area of study crops accounts for total irrigated area  pl 0 85  is given credibility level to satisfy the constraint 4g eqs 4h to 4k can illustrate the actual irrigation time for each crop that is spring wheat is irrigated on the 22th 52th and 83 day maize is irrigated on the 52th 83th 113th and 144th day sunflower is irrigated on the 83th 113th and 144th day equation 4k means that irrigation amount for each crop at each time is not more than 160 mm 2 constraints of water balance in the root zone daily soil water balance in the root zone is expressed at the end of the day 4l w i t 1 w it p i t 1 i w i t 1 e t g i t 1 e t a i t 1 d p i t 1 i t 4m w it 1000 z it  it i t 4n et g it c it m n e 0 t i t m 1 2 n 1 2 4o c it m n e mn exp f mn h it n 1 g mn h it r mn n 2 4p d p it p it i w it e t a i t w i t 1  it  fc 0  it  fc i t where w i t 1 and w it are the available soil water in the root zone of crop i on day t 1 and t mm p i t 1 et g i t 1 e t a i t 1 and d p i t 1 are precipitation capillary rise of groundwater groundwater based evaporation actual evapotranspiration and deep percolation of crop i on day t 1 respectively mm z it is the root depth which is generally set as 1 m eqs 4n and 4o are used to calculate groundwater based evaporation by involving soil types and crop growth periods c it m n is an empirical coefficient related to groundwater depth soil type and land use crop growth period xu et al 2010 e 0 t is open water evaporation rate which can be calculated by multiplying the 20 cm pan evaporation by a pan factor 0 56 e mn f mn g mn and r mn are fitted coefficients where n denote soil type i e n 1 is sandy loam soils n 2 is silty clay soils and m represents presence of crop cover i e m 1 is vegetated or cropped area and m 2 is non vegetated or non cropped area h it is daily groundwater depth of crop i m equation 4p is used to calculate the deep percolation during the whole crop growth period based on the xu et al 2010 e 11 1 81 f 11 1 42 g 12 0 05 and r 12 1 93 e 21 1 64 f 21 1 30 g 22 0 07 and r 22 1 70 3 constraints of water balance in the groundwater aquifers the sum of deep percolation groundwater evaporation and drainage will collectively affect the groundwater exchange and variation of groundwater levels groundwater balance is thus presented to describe the recharge and discharge of groundwater aquifers 4q h it h 0 et g it d p it d r it 1000  i t 1 4r h it h p i t 1 et g it d p it d r it 1000  i t 2 4s h p it  1 h 1 t  2 h 2 t  3 h 3 t i t 4t 0 h it 3 0 i t 4u 0 h p it 3 0 i t 4v d r it  d h d h 0 h d h 0 0 h d h 0 i t 1 4w d r it  d h d h p it h d h p it 0 h d h p it i t 2 where h it is daily groundwater depth of crop i m h 0 is initial groundwater depth m h p it is weighted daily groundwater depth m which is estimated by weighting that of spring wheat maize and sunflower based on the fraction of planted area of each crop  1  2  3 considering the lateral flow of groundwater the variations of groundwater depth are affected by crop growth and their planted area thus a weighted groundwater depth can be obtained by multiplying the respective groundwater depths of three crops h it by their fractions  i  is the specific yield  0 07  d is drainage coefficient tang et al 2007 which is used to quantify the amount of drainage between the difference of groundwater depth and bottom level of drainage ditch h d in this study h d is set as the same value in these drainage ditches and h d 1 5 m due to shallow groundwater level and  d 0 03 4 constraints of salt balance in the root zone soluble salts from irrigation water are the primary source of salinization problems in the study area salts are exchanged among the soil body crop root zone and groundwater aquifers through water movement salt balance in the root zone can be written below 4x r s i t 1 r s it i s i t 1 g w s i t 1 d p s i t 1 where r s it i s it gw s i t 1 and dp s i t 1 are soluble salt content in the root zone applied irrigation water groundwater evaporation and deep percolation respectively g m2 r s it w it s r it i s it i w it s y gw s it e t g it s g it and dp s it d p it s r it sy s r it and s g it are salt concentration of irrigation water soil water in the root zone and groundwater evaporation g l there is an empirical relationship between actual electrical conductivity ds m and the total soluble salt concentration g l that is 1 ds m 0 64 g l abrol et al 1988 5 constraints of salt balance in the groundwater aquifers similar to equation 4q salt transport and movement in the groundwater aquifers is related to groundwater evaporation deep percolation and drainage thus salt balance in the groundwater aquifers among these processes can be presented below 4y g s i t 1 g s it d p s i t 1 g w s i t 1 d r s i t 1 4z g s i t 1 z g h p t h p t 1 s g t 1 where g s it and g s i t 1 are soluble salt content in the groundwater aquifers mg m2 dr s i t 1 are soluble salt content in the drainage dr s i t 1 d r i t 1 s g i t 1 z g is the thickness of the shallow groundwater layer and its value is defined as the difference between groundwater level and the depth unreachable by groundwater level fluctuations m in this study z g is set as 2 m 6 constraint of salt accumulation in the root zone this constraint requires to limit the value of salt accumulation in the root zone at harvest to be less than a certain threshold value to control the salt accumulation during the whole crop growth period 4aa s r it 3 84 i 1 t 112 4ab s r it 3 84 i 2 3 t 175 in this study soil salt accumulation of three crops is set not to increase during the whole growth season 7 constraint of soil water content 4ac  wp s a l t  it  fc soil water content at wilting point varies from low salinity to high salinity thus equation 4ac presents the constraint of soil water content by considering the effect of salinity on the wilting point 8 initial conditions s r 0 3 84 g l 4ad s g 0 3 80 g l 4ae  0 0 22 4af h 0 1 20 m 4ag these initial conditions are provided to calculate water balance and salt balance for different time steps 3 3 data acquisition and processing the data needed for the study were obtained from experimental results statistical reports and relevant literature respectively fig 3 presents the reference evapotranspiration and precipitation during the whole crop growth period table 1 shows crop growth stages calendar and the corresponding crop coefficients other input parameters can be seen in table 2 economic water productivity is predetermined by decision makers based on their subjective or empirical data which can be interpreted as the management objectives they intend to achieve therefore triangular fuzzy number is used to define economic water productivity 5 5 6 5 7 5 yuan m3 the available volume of surface water use is also presented as triangular fuzzy number e g a a a where a a and a are the least possible value main value and the highest possible value a and a can be estimated by interval estimation method using t distribution because of unknown variance of the collected data a is determined as the mean value of the sample data source is the volume of historical water diversion from the yellow river to study area 4 results analysis through providing several credibility levels in the constraints solutions can be generated at allowable violation risk levels whereas the constraints don t need to be fully satisfied these flexible solutions can provide more choice for decision making in practical problems three credibility levels including  0 7 0 8 and 0 9 are presented in the constraints of irrigation water use to examine variations of solutions from  0 7 to  0 9 satisfactory levels of the constraints are in the state of very satisfied almost satisfied and practically satisfied respectively which can reflect decision makers subjective preference and support fuzzy decision analysis thus credibility level of constraints can represent believable confidence level of optimal solutions in a practical sense a higher credibility level is linked with a higher degree of feasibility and reliable strategy which represents conservative environmental capacities to manage irrigation water management at a relatively lower level of system failure risk by constraining different irrigation volumes under three  levels simulation process of water and salinity balance can be naturally affected meanwhile the physical process described above also constrain the irrigation volumes thus bridging the linkage of simulation optimization process because such a coupled simulation optimization framework focuses on enhancing economic water productivity and controlling salinity results include optimal solutions of objective function values irrigation water planning daily variations of salt concentration in the crop root zone and groundwater aquifers and groundwater depth are analyzed and compared 4 1 optimal objective function value the maximized credibility level of objective function is obtained by solving the simulation optimization framework based on input parameters and a set of constraints fig 4 presents optimal fuzzy objective function values under a higher credibility level an alternative with lower achievable level management target will be reached but the reliability of satisfying water availability constraint would increase for example the credibility levels of objective are 0 901 0 886 and 0 861 as the constraints are satisfied at  0 7 0 8 and 0 9 that means the credibility levels that predetermined management target i e 5 5 6 5 7 5 yuan m3 can be achieved are 0 901 0 886 and 0 861 since the credibility measure is self dual the corresponding credibility levels of its complement event are 1 0 901 0 099 1 0 886 0 114 and 1 0 861 0 139 respectively an increased credibility level of the constraints indicates a decreased permissible risk for constraints violations and thus less decision space has been arisen from more stringent constraints therefore a lower objective function value will be achieved at a higher  level but the reliability level is increased due to less system failure risk at the same time traditional studies usually provide crisp decision solutions with optimal objective values through introducing the concept of dependent chance into fuzzy programming method decision makers are able to maximize the credibility level of satisfying these fuzzy events and finally support fuzzy decisions instead of crisp ones more practically this is applicable in irrigation water planning problems because some ambiguous parameters are fuzzy in nature owing to incomplete and unavailable data the above analyses show that this study incorporates fuzzy dependent chance programming and fuzzy credibility constrained programming within its modeling framework and deals with fuzzy information in the objective function and constraints concurrently furthermore results present tradeoffs among the maximized objective value credibility level of constraint and constraint violation risk therefore this study extends the applicability of fuzzy methods and is able to solve more types of fuzzy decision problems 4 2 optimal solutions of irrigation water planning due to water competition among three crops optimal strategies of irrigation water planning are useful for achieving certain management targets and economic implications fig 5 provides solutions of irrigation water planning associated with credibility levels of constraints these results can clearly illustrate the amount of irrigation water at each irrigation time during the whole growth period for example spring wheat maize and sunflower are irrigated a total of three times four times and three times it can be seen that spring wheat is irrigated with much more water followed by maize and sunflower under different credibility levels it is revealed that maize and sunflower are irrigated almost the same amount of water at different irrigation times showing that violation constraints have less effect on the irrigation times taking maize as an example the amount of irrigation water at the first second and third fourth time are 54 4 mm 53 4 mm and 50 1 mm 50 2 mm  0 7 50 1 mm 50 4 mm and 50 3 mm 50 0 mm  0 8 and 50 4 mm 51 9 mm and 50 2 mm 52 0 mm  0 9 it is noted that the total amount of irrigation water during the whole growth period has no obvious trend under different  levels the total irrigation amount for spring wheat is 209 9 mm  0 7 232 9 mm  0 8 and 227 3 mm  0 9 similarly the total irrigation for maize is 208 1 mm  0 7 200 8 mm  0 8 and 204 6 mm  0 9 for sunflower a total irrigation of 156 3 mm  0 7 150 7 mm  0 8 and 156 7 mm  0 9 will be allocated furthermore the total irrigation water uses for three crops in the study area i e 10 i 1 3 t 1 175 a i i w it  s are increased from 298 6 106 m3 to 305 5 106 m3 when  level is raised from 0 7 to 0 9 see fig 4 obviously this can explain why optimal objective values are decreased as the  level increases in the case of ratio optimization problems e g benefits water use revenue cost as the value of the denominator i e total irrigation amount becomes larger it eventually leads to a smaller value of the objective function fig 6 presents crop yields under different  levels crop yield is directly related to crop evapotranspiration which is influenced by soil water stress and salt stress conditions from  0 7 to  0 9 crop yields are slightly decreased for all crops compared with wheat salt tolerance of maize and sunflower is lower and they are easily affected by soil salinity therefore it is found that crop yield of wheat is larger than that of maize and sunflower furthermore by summing the daily evapotranspiration of three crops during their growth periods it can be seen that wheat has the highest evapotranspiration for example the total evapotranspiration of spring wheat maize and sunflower are 345 0 mm 327 7 mm and 243 3 mm under  0 7 from fig 5 the total amount of irrigation for three crops are 209 9 mm 208 1 mm and 156 3 mm while the total groundwater based evaporation of three crops are 103 0 mm 108 1 mm and 65 2 mm accounting for 29 9 33 0 and 26 8 of crop evapotranspiration therefore it can provide insight into interrelationships of water balance elements and finally figure out the quantitative factors that contribute to crop yields 4 3 salt concentration in the root zone and groundwater aquifers better knowledge of the daily variations of salt concentration in the root zone and groundwater aquifers contributes to the understanding of the process of salinity effects on crop growth and field salt accumulation fig 7 illustrates daily variations of salt concentration in the root zone and groundwater aquifers during the whole growth period for each crop under a certain  level salt concentration is directly related to irrigation events because these values change drastically after irrigation based on the water and salt balance in the root zone and groundwater aquifers larger amount of irrigation water leads to deep seepage which takes away salts from the root zone meanwhile the deep seepage makes the groundwater level rise and finally leads to a higher drainage of the study area the salts taken away by the drainage process cause the salt concentration of the groundwater aquifers to decrease therefore salt concentration in the groundwater aquifers is highly associated with the variations of salt concentration in the root zone fig 7 shows that change points occur the day before irrigation events in the root zone and valley points occur on the days of irrigation events during the crop growing period from sowing to harvesting salt concentration of spring wheat is larger than that of maize and sunflower for example the mean values of salt concentration in the root zone of spring wheat maize and sunflower are 3 58 g l 3 13 g l and 2 79 g l under  0 7 when the crop is not irrigated the daily salt concentration is gradually increasing in the root zone this is due to the accumulation of salts from groundwater evaporation driven by crop evapotranspiration as capillary rise is a non negligible component of water balance in areas with shallow groundwater depth similarly the mean values of salt concentration in the groundwater aquifers of spring wheat maize and sunflower are 3 59 g l 3 56 g l and 3 54 g l under  0 7 in the optimization model salt accumulation in the root zone at harvest is limited to be less than 3 84 g l for spring wheat the 112th day and maize and sunflower the 175th day thus results show that the values of three crops are basically satisfied the constraints and they are 3 84 g l 3 29 g l and 2 94 g l under  0 7 3 81 g l 3 26 g l and 2 91 g l under  0 8 and 3 85 g l 3 24 g l and 2 89 g l under  0 9 in additional it is found that salt concentration in the root zone is decreased before maize and sunflower planting and after spring wheat harvest this is mainly because field drainage carries away the salts due to the shallow groundwater table in terms of different  levels the results of salt concentration in the root zone and groundwater aquifers show a similar trend the fluctuations of salt concentration are linked with irrigation events and the volume of irrigation water for maize and sunflower the values of salt concentration under three  levels are almost the same during the whole growing season for spring wheat during its growth period there is a clearly visible difference under three credibility levels for example the lowest value of salt concentration under  0 8 is found at the middle of the first 22th day and second 52th day irrigation time after the second irrigation the salt concentration value under  0 7 is even greater compared with under  0 8 and 0 9 this can also be verified by the mean values of salt concentration in the root zone under  0 7 0 8 and 0 9 and they are 3 58 g l 3 40 g l and 3 55 g l for sunflower during its growth period from 65th to 175th day results under  0 7 are slightly greater than that of  0 8 and 0 9 until the last day 175th day this is supported by the mean values of salt concentration under  0 7 0 8 and 0 9 and they are 2 79 g l 2 77 g l and 2 75 g l 4 4 groundwater depth and drainage fig 8 illustrates daily groundwater depth and its corresponding drainage under three  levels in general deep percolation emerges rapidly after irrigation and groundwater evaporation occurs daily because of the shallow depth of groundwater while drainage is generated by the difference in elevation between groundwater level and the bottom depth of drainage ditches deep percolation recharges groundwater while groundwater evaporation and drainage deplete groundwater consequently fig 8 basically presents fluctuations of groundwater depth before or after irrigation events notable changes of groundwater depth can be seen which represents expected change in groundwater level after irrigation the mean values under  0 7 0 8 and 0 9 are 1 970 m 1 974 m and 2 000 m indicating an increased credibility level leads to less irrigation water applied to crops there is a comparable trend of change under  0 7  0 8 and  0 9 as their peak values of groundwater depth occur the first day 1 200 m and the lowest values occur at the end of growing season 2 459 m 2 411 m and 2 477 m overall the fluctuation of groundwater depth is smaller and it is declining throughout the study period the drainage volume is directly related to the variation of groundwater depth when the groundwater depth is less than 1 5 m drainage will be appeared when the groundwater depth is greater than 1 5 m no drainage will be generated in the field during the whole growth period the total volume of drainage 79 2 mm is the same under  0 7 0 8 and 0 9 this is because the groundwater depth less than 1 5 m occurred only before the first irrigation there is no impact on the three crops the above results are physically consistent and clearly demonstrated the water and salt movement among irrigation water soil water and groundwater drainage it can be seen that the system representations are closer to the physics of the actual systems thus it s an effective way to develop simulation model based on water and salt balance equations 5 discussions 5 1 sensitivity analysis of the results sensitivity analysis can measure how the impact of uncertainties of one or more input variables can lead to variations on the output variables it s useful for understanding the model by qualitatively and quantitatively studying the model response to change in input variables and analyzing interactions among variables thus parametric sensitivity analysis is typically performed to examine the robustness of the results based on the significance of the initial parameters in this part changing assumptions originating from objective coefficient constraint bound are studied firstly different values of management targets in the objective function are set fig 9 shows the results of predetermined economic water productivity under  0 9 in detail when the management target is set as 5 0 6 0 7 0 yuan m3 then the credibility degree of the fuzzy objective is 0 961 indicating that this fuzzy event is almost completely achievable when the values of management targets are given as 6 0 7 0 8 0 yuan m3 6 5 7 5 8 5 yuan m3 7 0 8 0 9 0 yuan m3 these fuzzy events are only be satisfied at 0 795 0 711 and 0 604 it is obvious that a larger management target leads to a smaller credibility level and greater deviation from the target this is also in line with practical management indicating that management goals cannot be given blindly but must be considered to be practical in mathematical terms see eqs 2d and 4a it is found that a larger value of ew p 3 and ew p 2 from above scenarios results in a lower value for the numerator 2 b 2 b 1 ew p 3 2 e w p 2 and the same value for the denominator 2 b 2 b 1 2 ew p 3 e w p 2 when other conditions are being equal thereby leading to a smaller ratio in other words this is mainly determined by main and maximum possible values of triangular fuzzy numbers furthermore when the management goals are predefined as 6 5 7 0 7 5 yuan m3 6 5 7 5 8 5 yuan m3 6 5 8 0 9 5 yuan m3 it is noted that the difference of ew p 3 2 e w p 2 is the same for the three scenarios i e 7 5 2 7 0 8 5 2 7 5 9 5 2 8 0 but the difference of 2 b 2 b 1 2 ew p 3 e w p 2 is different i e 2 b 2 b 1 2 6 5 6 0 2 b 2 b 1 2 7 5 6 5 2 b 2 b 1 2 8 5 7 0 therefore optimal objective values are obtained as 0 865 0 711 and 0 597 for the above three scenarios resulting in a different outcome generally these management targets are set by decision makers through experience or subjective attitudes to reflect their expected planning for agricultural development by changing management targets in the objective function credibility levels of fuzzy objective satisfaction can be quantitatively represented though the concept of dependent chance secondly different values are varied in the salt accumulation constraint to mitigate the negative impact of salinization problems constraints of salt accumulation are introduced to limit the salt concentration in the root zone at harvest that is three threshold values of salt accumulation including 3 20 g l 3 84 g l and 4 48 g l are defined in the constraints fig 10 shows the variation of salt concentration in the root zone under these scenarios the salt concentration at harvest is satisfied the constraints and they are 3 11 g l 3 78 g l and 4 21 g l for spring wheat 3 06 g l 3 24 g l and 3 30 g l for maize and 2 83 g l 2 88 g l and 2 95 g l moreover the mean values of salt concentration in these scenarios are 3 08 g l 3 55 g l and 3 77 g l for spring wheat furthermore the credibility levels of objective in three settings are 0 804 0 861 and 0 907 it can be seen that a larger salt accumulation threshold corresponds to a larger objective function in that case the predetermined economic water productivity can be easily achieved this is understandable that more stringent constraints mean that goals are more difficult to be achieved these results enable to show the tradeoffs between salt control goals and objective function the above sensitivity analysis enables comparison of the effects of different model s assumptions on the results the sensitivity of objective coefficient is higher than that of constraint bound when we change certain assumptions showing that management targets must be robustly pre determined for our study 5 2 climate change impact on the results likewise there is an urgent need to make irrigation planning strategies in the context of climate change because these complex interactions multiply the uncertainties gaaloul et al 2020 the future climate of the hetao irrigation district will become increasingly warm and wet and the rise of in et0 will continuously increase the water demand during crop growth period which thus will bring major impacts on the hydrological cycle water balance and agricultural production sun et al 2013 based on the study of zhou et al 2017 future climate scenarios are separately divided into scenarios a2 and b2 in the time periods 2041 2070 and 2071 2099 table 3 lists the corresponding changes of et0 and precipitation under these scenarios zhou 2017 through substituting input parameters of et0 and precipitation while other parameters remain the same optimal results under these scenarios can be obtained table 4 presents optimal results for better comparison of each scenario results show that optimal objective function values slightly decrease from 0 861 baseline to 0 804 a2 2071 2099 this also means that increased crop water requirements due to climate change will lead to lower achievable level of management target moreover these potential climate induced changes in water requirements and precipitation also have an influence on crop yields compared with current conditions therefore adaptive practices should be undertaken to mitigate variability of climate change and reduce vulnerability of agricultural systems 5 3 effectiveness of the simulation optimization framework there are many studies to improve irrigation water productivity by changing irrigation quotas irrigation methods and cropping patterns kang et al 2000 oweis and hachum 2006 molden et al 2010 edreira et al 2018 these studies place more emphasis on the analysis of experimental data to conclude that a certain practice can increase water productivity besides coupled studies using hydrological models with crop models have become another way to assess water productivity for future irrigation planning after proper calibration and validation though measured and empirical data these models can be employed to do scenario analysis for searching preferable management strategies alternatively this study is to pre determine the economic water productivity and examine how irrigation planning can be carried out to ensure that the fuzzy objective is achieved with the maximum credibility level the maximized achievable level of management targets shows that the chance or credibility level for fuzzy events and management targets to be satisfied under specific conditions by comparing the credibility achievable level of different objectives the range of management targets and the difference of existing goals can ultimately be determined to help in improving economic water productivity 6 conclusions an integrated simulation optimization framework is developed for enhancing irrigation water productivity and controlling salinity under uncertainty it s formulated through incorporating full fuzzy dependent linear fractional programming approach with water and salt balance model a real case study in jiefangzha irrigation subarea in hetao irrigation district northwest china is presented to manage irrigation water and control salt accumulation optimal solutions resulting from the developed framework can identify management patterns with the maximum achievable level of fuzzy objective these results can illustrate the physical interactions among irrigation water soil water and groundwater and present a dynamic decision making process therefore the following are the novelties and importance of this study 1 the concept of dependent chance to quantify the achievable level of management target is a novelty in irrigation planning and promotes better understanding of fuzzy decisions 2 the integration of developed optimization model and water salt balance model with mathematical expression is considered a novel method for addressing a real world problem 3 this study deals with the salinity issues through salt movement among irrigation water soil water groundwater and drainage and salt accumulation constraint 4 from this study dynamic decisions can be made and tradeoffs among objective functions optimal solutions and different system satisfaction conditions are readily illustrated without losing generality this is a good attempt to connect it to agricultural practice to develop an integrated framework by coupling simulation module and uncertain programming method and finally enhancing irrigation water productivity and control salinity in agricultural lands nevertheless adaptive decisions underlying impacts on irrigation planning has limitations without considering regional spatiotemporal variability of parameters and human activities e g water saving measures canal lining reduction of water diversion and alternation of plant structure credit authorship contribution statement chenglong zhang conceptualization methodology formal analysis writing original draft xuemin li data curation methodology software ping guo writing review editing zailin huo supervision writing review editing guanhua huang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was jointly supported by the national science foundation of china grant number 52009133 and 51639009 the comments and suggestions from the editor and two anonymous reviewers are helpful in improving the earlier version of this paper 
3654,an integrated simulation optimization framework is developed under uncertainty to enhance irrigation water productivity and control salinity in an arid area a full fuzzy dependent linear fractional programming approach is formulated by incorporating fuzzy dependent chance programming fuzzy credibility constrained programming and linear fractional programming within a general framework of irrigation planning then simulation module concerning water salt balance process and crop water salt production functions enables to quantify daily physical process of water and salt movement among the soil water crop root zone and groundwater aquifers thus this study can readily handle fuzzy uncertainty existing concurrently in the ratio objective i e economic water productivity through the concept of fuzzy dependent chance and double sided constraints it can also simultaneously provide the maximum credibility level that the objective is achievable and credibility levels implying that optimal solutions are believable besides daily variations of simulated physical parameters are illustrated corresponding to management strategies to demonstrate its applicability it s then applied to a case study of irrigation planning in the jiefangzha irrigation subarea in hetao irrigation district northwest china results can clearly analyze tradeoffs among satisfaction degree of fuzzy objective fuzzy constraints and optimal solutions moreover by examining different management targets and salt accumulation constraints this study demonstrates the merits and importance of the work to promote irrigation water productivity and control salinity dynamic decision making of irrigation planning is possibly made by coupling daily simulation and optimization modules therefore these findings can support decision makers to identify appropriate solutions for irrigation planning keywords economic water productivity salinity control management targets fuzzy mathematical programming irrigation planning uncertainty 1 introduction the problems of water scarcity and secondary soil salinization are important factors affecting the agricultural development in the arid regions schoups et al 2005 the appropriate irrigation planning is an essential means of regulating the soil water and salinity of agricultural land and ensuring the proper growth of crops mueller et al 2012 wang et al 2020 to better enhance irrigation water productivity and effectively control soil salt accumulation in arid agricultural areas it is desirable that optimal irrigation water management among multiple competing crops with limited water should be done zhang et al 2020 through optimization model managers are able to strengthen fine management of agricultural water and promote agricultural production levels in addition agricultural water management systems are often associated with various uncertainties such as water availability soil water content groundwater table crop prices and even preferences in the objective function pea haro et al 2011 lpez jaimes and coello coello 2014 li et al 2020 therefore it is necessary to consider the relevant uncertain factors in the study of optimal irrigation planning by employing suitable uncertain programming methods to characterize these uncertainties and effectively solve problems in traditional optimization models the total system benefits are generally chosen as their objective functions which aims to maximize economic returns resulting from water use however these methods may emphasize system outputs and hardly measure system efficiency that is associated with ratios between outputs and inputs zhu and huang 2011 in real world applications it is expected that there will be a higher irrigation water productivity which is also a question of system efficiency through defining agricultural production per amount of irrigation water use irrigation water productivity enables to reflect the relationships between water outputs and inputs pereira et al 2012 furthermore as an extension of irrigation water productivity economic water productivity is defined to measure the ratio between the whole economic benefits and total irrigation water use zhang and guo 2017 such practical problems are readily solved by method of linear fractional programming lfp initiated by charnes et al 1978 which is commonly employed when system efficiency e g revenue cost outputs inputs is to be measured for example gmez et al 2006 solved a forest planning problem though a linear fractional goal programming model however lfp method has been facing several challenges arising from uncertain information such as the random vague and hardly identified factors of study system among these uncertain programming methods fuzzy programming is a powerful method to tackle optimization problems in a fuzzy environment especially when parameters are estimated with insufficient statistical information and decisions should be made under different subjective preferences lu et al 2016 generally possibility measure necessity measure and credibility measure are the main three type of measures in fuzzy theory the former two measures have limitations in measuring fuzzy events that is they are not self dual in fuzzy decision making liu 2006 in practice credibility measure can compensate for their disadvantages as a fuzzy inequality indicator due to its self duality property which is definitely desired for example when a fuzzy event is measured by credibility e g c r a b if credibility level is 1 this fuzzy event will certainly occur and if credibility level reaches 0 such a fuzzy event will absolutely not occur zhang et al 2015 therefore credibility constrained programming was proposed based on the concept of credibility liu and iwamura 1998 furthermore credibility objectives and credibility constraints e g single sided and double sided fuzziness in constraints can also be readily solved by credibility programming methods in terms of credibility objectives wen and iwamura 2008 lau et al 2010 proposed a fuzzy credibility based model under hurwicz criterion to solve facility location allocation problem and optimize the distribution system design as for the credibility constraints pishvaee et al 2012 proposed a credibility based fuzzy programming model for green logistics design with right hand side of fuzzy constraints lu et al 2016 presented a credibility based chance constrained optimization model for integrated agricultural water resources management with the right and left hand sides of constraints in addition zhang et al 2015 employed a full credibility constrained programming method for planning water resources management and pollution control where credibility objective and double sided credibility constraints are concurrently appeared in the model nevertheless the decision makers sometimes prefer to maximize the chance or credibility of satisfying fuzzy events generally decisions are made at different pre determined credibility levels and then optimal solutions can be flexibly generated for supporting decision making zhang and guo 2017 here it should redefine a concept and theoretical framework of fuzzy dependent chance programming when these decisions are selected with the maximum credibility level to satisfy fuzzy event based on chance objective function which is a mathematically inverse question compared with traditional credibility programming methods for example a key question is what is the maximum credibility level in achieving the fuzzy goal therefore liu 1996 1997 proposed a framework of dependent chance programming to address this concern the main idea of dependent chance programming is to maximize the chance of satisfying uncertain events to make optimal decisions its characteristics is the chances of management targets are dependent after modeling the actual problems using deterministic and chance constrained models the set of feasible solutions are essentially determined but optimal solution given may not be applicable in practice conversely deterministic solutions can also be given by dependent chance programming but it only requires that the solutions be implemented as far as practically possible for example wang et al 2018 developed an interval quadratic fuzzy dependent chance programming model for optimal irrigation water allocation although dependent chance programming is available to the problems that confidence or credibility levels need to be optimized via the chance objective functions it cannot delineate the details and physical processes of soil water movement and salt transport two main approaches are commonly employed to simulate the hydrological process of soil water movement including conceptual water balance models and numerical water flow models based on the richard s equation simulation models based on the richard s equation are able to describe detailed interactions among soil water groundwater and solute transport such as swap hydrus imnek et al 2016 they are advantageous for investigating hydrological processes in agricultural fields with clear physical mechanisms moreover they usually focus on the field scale and can also be extended to a greater spatial scale through technique of remote sensing and geographic information system campos et al 2018 however it should be noted that these physical process based models have the following problems such as a large number of parameters non convergence under specific or boundary conditions and relatively complex calibration and validation of model in contrast water balance model is simple and relatively parameter less requiring only basic soil and water characteristics e g field capacity wilting point and crop parameters scanlon et al 2002 the model is stable and there are no numerical calculation problems therefore water balance model is convenient and practical for regional level irrigation water management nonetheless the simulation models can generally present better management decisions among these predefined alternatives based on scenario analysis but not the optimal one which suggests that simulation models only give the answer of what if singh 2012 as for the question of what is the best it should enhance its applicability through integration of optimization approaches previous studies on simulation optimization models have been done for water management guar et al 2011 darshana et al 2012 there are few studies on the framework of simulation optimization and fuzzy lfp method under uncertainty for irrigation planning and salinity control in this study an integrated simulation optimization framework is proposed for supporting irrigation planning which is formulated by coupling full fuzzy dependent linear fractional programming approach with simulation module of water and salt balance crop growth soil condition soil water and salt movement and water availability groundwater capillary rise and drainage are complexly linked and dictate what strategies of irrigation planning should be made for enhancing irrigation water productivity and controlling salinity thus it has the following advantages in 1 tackling fuzzy objective and fuzzy constraints and simulating daily physical interactions among soil water groundwater and salt transport using water balance model 2 making dynamic decision of irrigation planning possible 3 achieving the maximum credibility level of the fuzzy objective function when management target of economic water productivity is pre given and 4 controlling salt accumulation at the end of crop growth period through constraints related to salt transport and salt control then it s applied to a real world case study in jiefangzha irrigation subarea in hetao irrigation district northwest china irrigation planning among three crops during their crop growth period has been studied the obtained solutions can offer effective recommendations for irrigation planning and implementation of salt control practices moreover potential limitation includes the fidelity of physical models of water salinity as regional spatiotemporal variability of parameters and human activities e g water saving measures canal lining reduction of water diversion and alternation of plant structure are not considered 2 study system 2 1 study area the hetao irrigation district is located in the middle west of the inner mongolia autonomous region which is the third largest irrigation district in china with a control area of 11 600 km2 fig 1 it has a flat terrain with an average slope of only 0 02 and convenient irrigation conditions for diverting the yellow river water to agricultural fields thus it becomes an important grain production base in china in this study jiefangzha irrigation subarea as an important part of hetao irrigation district is chosen as study area it has a total area of 215 700 ha and cultivated area occupies approximately 66 the study area is located in an arid climate zone annual precipitation is 140 mm and annual potential evaporation is approximately 2 000 mm annual average temperature is about 7 c soil survey results show that the percentage of sandy loam soil in the study area is 67 and the percentage of silt clay soil is 33 xu et al 2010 major crops include maize wheat sunflowers melons tomatoes and peppers wheat maize and sunflower basically account for 15 35 and 25 of the total irrigated area while tomatoes and melons account for 19 generally the growing season for wheat maize and sunflower is late march to mid july early may to late september and late may to late september agricultural development mainly relies on irrigation where water withdrawal is from the yellow river nearly 90 of the total irrigated area is irrigated from the yellow river water the main irrigation methods are flood and border irrigation which are two typical types of surface irrigation crops are generally irrigated five to eight times during their growth period according to the rainfall condition of that year the irrigation time is empirically set as april 22th may 15th june 15th july 15th and august 15th the irrigation canal network of the whole irrigation subarea is well constructed with multi layered canals such a tree like irrigation canal system has a clear space layer structure with one main trunk canal three main canals six sub main canals and more branch canals moreover there are three main drainage ditches 12 sub main ditches and 52 branch ditches in the whole study area the long term and excessive irrigation from the yellow river has resulted in shallow groundwater depth in the irrigation area with an annual variation ranging from 0 5 m to 3 0 m furthermore due to the incompatibility between irrigation and drainage projects and poor developed drainage conditions problems of water and salinity imbalance during irrigation and drainage are caused for example the average annual drainage rate is about 10 of the volume of water diverted and the amount of salt discharge is about 1 3 of the salt content brought in which also causes the irrigation district to be in a long term state of salt accumulation statistically the average annual salt accumulation of the entire irrigation district is 183 g m2 ren et al 2016 in addition the intensive surface evaporation exacerbates soil salinization in the crop root layer therefore the problem of soil and groundwater salinization in irrigation area is facing severe challenges such adverse events naturally have a negative impact on crop growth and crop yield 2 2 problem statement policies of reduction in water diversion will inevitably cause competition among different crops for water thus proper irrigation water management is necessary in this case making sound irrigation planning decisions with the goal of enhancing irrigation water productivity becomes increasingly meaningful for maintaining the sustainable development of agriculture moreover better understanding the relationships between crop evapotranspiration and crop yield is critical to make strategies for managing irrigation water this is because crop yield is mainly affected by its actual evapotranspiration while soil water content and salinity in the crop root zone are the two major determinants of actual crop evapotranspiration especially the amount of crop evapotranspiration from groundwater recharge accounts for a large portion of the total crop water requirements at a shallow groundwater depth therefore the effects of soil water content and salinity on crop evapotranspiration and crop growth need to be considered that is simulations of these physical process among irrigation water soil water groundwater and its salinity transformation should be incorporated into the framework thus water and salinity balance models and crop water salt production functions are coupled with optimization model of irrigation water management to formulate an integrated simulation optimization framework for enhancing irrigation water productivity and controlling salinity besides the subjectivity of decision makers and the ambiguity of data lead to uncertainty in the study system which affects the reliability of irrigation water management under fuzzy environments for example a management target of economic water productivity is subjectively given the objective function is to maximize its credibility and achievable level therefore fuzzy mathematical programming methods need to be introduced to strengthen the usefulness of the optimization model 3 modeling framework this part presents the development and application of simulation optimization framework it contains the following three subsections the framework of this study is illustrated in fig 2 3 1 full fuzzy dependent linear fractional programming approach though the integration of fuzzy dependent chance programming fuzzy credibility constrained programming and linear fractional programming a full fuzzy dependent linear fractional programming approach is formulated it can fully deal with fuzzy objective and double sided fuzziness in the constraints details can be seen below 3 1 1 fuzzy dependent chance programming the main idea of fuzzy dependent chance programming is to maximize chance e g credibility level satisfaction degree of the objective function in fuzzy decision making a standard form of fuzzy dependent chance programming is presented 1a max c r f k x  0 k 1 2 m 1b s t g i x  0 i 1 2 n where cr is credibility measure which indicates credibility level of the objective function x x 1 x 2 x n is a vector of non fuzzy decision variables  is fuzzy variable f k x  0 k 1 2 m is fuzzy event and k is the number of fuzzy events g i x  0 i 1 2 n represents fuzzy environments 3 1 2 fuzzy credibility constrained programming fuzzy credibility constrained programming is able to handle the problems that their constraints are satisfied with predetermined possibility in a fuzzy environment then it can be transformed into deterministic crisps to solve single sided fuzziness or double sided fuzziness in the credibility constraints therefore the chance of occurrence of fuzzy events can be readily quantified through this method its general framework is written 2a max f j 1 n c j x j 2b s t c r j 1 n a ij x j b i  i i 1 2 m 2c x j 0 j 1 2 n where x j is non fuzzy decision variable and j 1 2 n c j is real parameter in the objective function a ij and b i are fuzzy parameters in the constraints  i is predetermined credibility level inequality 2b represents that the credibility of constraint i e j 1 n a ij x j b i should be not less than  i for example in the case of s t where s s 1 s 2 s 3 and t t 1 t 2 t 3 are fuzzy variables with membership function  c r s t is defined as follows 2d c r s t 1 if s 3 t 1 s 3 2 s 2 2 t 2 t 1 2 s 3 s 2 t 2 t 1 if s 2 t 2 s 3 t 1 t 3 s 1 2 t 3 t 2 s 2 s 1 if s 2 t 2 s 1 t 3 0 if s 1 t 3 therefore according to equation 2d credibility constraints can be transformed into deterministic ones see zhang and huang 2011 3 1 3 linear fractional programming linear fractional programming method is used to address ratio objective problems and measure system efficiency through balancing tradeoffs between outputs and inputs its general form can be formulated as follows 3a max f ax  bx  3b s t c x d 3c x 0 where a b c and d are real coefficients  and  are constant terms this linear fractional programming method is capable of handling deterministic ratio optimization problems but it can hardly deal with problems in uncertain environments in summary by incorporating fuzzy dependent chance programming fuzzy credibility constrained programing and linear fractional programming within a general modeling framework a full fuzzy dependent linear fractional programming approach can be formulated 3 2 integrated simulation optimization framework under fuzzy uncertainty there are several problems that need to be solved in this study 1 how to achieve the maximum credibility level of objective function under a given management target 2 how to measure system efficiency i e ratio objective between system benefits and the total irrigation water applied 3 how to investigate the daily water and salinity balance among irrigation water soil water and groundwater and 4 how to generate feasible strategies of irrigation planning for enhancing irrigation water productivity and controlling salinity thus an integrated simulation optimization framework under fuzzy uncertainty is developed that is to integrate water and salinity balance models crop water salt production functions and full fuzzy dependent linear fractional programming method into a general framework of irrigation planning it can be shown below 3 2 1 objective function 4a f max c r i 1 3 nb i a i y i i 1 3 a i c p i 10 i 1 3 t 1 175 c w i a i i w it  s 10 i 1 3 t 1 175 a i i w it  s ewp where f is objective function representing the maximum credibility level of a fuzzy event that economic water productivity is not less than a given fuzzy goal nb i c p i c w i and ewp are fuzzy variables in the objective function nb i is net benefits of crop i yuan kg i 1 2 3 and i 1 is spring wheat i 2 is maize and i 3 is sunflower c p i is cost of crop production per unit of area yuan ha c w i is cost of irrigation water use of crop i yuan m3 ewp is a fuzzy parameter representing economic water productivity that is defined as the ratio between system benefits and the total irrigation water use ewp ew p 1 e w p 2 e w p 3 yuan m3 a i is irrigated area of crop i ha y i is yield of crop i per unit of area kg ha i w it is allocated irrigation water of crop i on day t mm and t 1 2 175  s is comprehensive coefficient of irrigation water use and  s 0 6 actual crop yield y i varies with the ratio between actual and potentially maximum evapotranspiration in different crop growth periods it can be expressed as follows 4b 1 y i y m i k y 1 e t a i e t m i i where e t a i and e t m i are the crop evapotranspiration for yielding mm y i y m i are actual and potentially maximum crop yield kg ha k y is crop yield response factor in practice crop evapotranspiration is affected by water deficit and salinity then 4c e t a i t k ws i t k ss i t k c i t e t 0 i t where e t 0 is daily reference evapotranspiration mm k c i t is crop coefficient k ws i t is water stress coefficient and k ss i t is salinity stress coefficient for crop i on day t they can be estimated by the following equations 4d k ws i t 0  it  wp salt  it  wp s a l t  fc  wp s a l t  wp s a l t  it  fc 1  it  fc i t 4e k ss i t 1 b i 100 k y i e c e i t e c et i t e c e i t e c et i t 1 e c e i t e c et i t i t 4f  wp s a l t  wp b i e c eit e c et i t 100  fc  wp i t where  it is daily soil water content in the root zone of crop i cm3 cm3  wp and  wp s a l t are soil water content at wilting point under non saline and saline conditions respectively cm3 cm3 soil water content at wilting point will increase under saline conditions due to the combined matric potential and larger osmotic potential in the crop root zone beltro and asher 1997  fc is soil water content at field capacity cm3 cm3 b i is a crop specific parameter to describe the reduction in yield per unit of excess salts dsm 1 e c e i t is actual electrical conductivity of the saturation extract for the root zone and e c et i t is threshold of e c e i t when crop yield firstly reduces below y m i dsm 1 in this study area  fc 0 30 and  wp 0 10 3 2 2 constraints 1 irrigation water use constraint 4g c r  q s 10 i 1 3 t 1 175 1  a i i w it q s  s  pi  4h i w it 0 i 1 t 22 52 83 i w it 0 i 1 t otherdays 4i i w it 0 i 2 t 52 83 113 144 i w it 0 i 2 t otherdays 4j i w it 0 i 3 t 83 113 144 i w it 0 i 3 t otherdays 4k i w it 16 0 i t this constraint is used to limit the total irrigation availability based on fuzzy credibility constrained programming method  and q s are fuzzy parameters in the right and left hand sides of constraint  is coefficient of water loss during water conveyance  0 15 0 20 0 25 and q s is surface water availability q s 746 772 798 106 m3  pl denotes the proportion of irrigated area of study crops accounts for total irrigated area  pl 0 85  is given credibility level to satisfy the constraint 4g eqs 4h to 4k can illustrate the actual irrigation time for each crop that is spring wheat is irrigated on the 22th 52th and 83 day maize is irrigated on the 52th 83th 113th and 144th day sunflower is irrigated on the 83th 113th and 144th day equation 4k means that irrigation amount for each crop at each time is not more than 160 mm 2 constraints of water balance in the root zone daily soil water balance in the root zone is expressed at the end of the day 4l w i t 1 w it p i t 1 i w i t 1 e t g i t 1 e t a i t 1 d p i t 1 i t 4m w it 1000 z it  it i t 4n et g it c it m n e 0 t i t m 1 2 n 1 2 4o c it m n e mn exp f mn h it n 1 g mn h it r mn n 2 4p d p it p it i w it e t a i t w i t 1  it  fc 0  it  fc i t where w i t 1 and w it are the available soil water in the root zone of crop i on day t 1 and t mm p i t 1 et g i t 1 e t a i t 1 and d p i t 1 are precipitation capillary rise of groundwater groundwater based evaporation actual evapotranspiration and deep percolation of crop i on day t 1 respectively mm z it is the root depth which is generally set as 1 m eqs 4n and 4o are used to calculate groundwater based evaporation by involving soil types and crop growth periods c it m n is an empirical coefficient related to groundwater depth soil type and land use crop growth period xu et al 2010 e 0 t is open water evaporation rate which can be calculated by multiplying the 20 cm pan evaporation by a pan factor 0 56 e mn f mn g mn and r mn are fitted coefficients where n denote soil type i e n 1 is sandy loam soils n 2 is silty clay soils and m represents presence of crop cover i e m 1 is vegetated or cropped area and m 2 is non vegetated or non cropped area h it is daily groundwater depth of crop i m equation 4p is used to calculate the deep percolation during the whole crop growth period based on the xu et al 2010 e 11 1 81 f 11 1 42 g 12 0 05 and r 12 1 93 e 21 1 64 f 21 1 30 g 22 0 07 and r 22 1 70 3 constraints of water balance in the groundwater aquifers the sum of deep percolation groundwater evaporation and drainage will collectively affect the groundwater exchange and variation of groundwater levels groundwater balance is thus presented to describe the recharge and discharge of groundwater aquifers 4q h it h 0 et g it d p it d r it 1000  i t 1 4r h it h p i t 1 et g it d p it d r it 1000  i t 2 4s h p it  1 h 1 t  2 h 2 t  3 h 3 t i t 4t 0 h it 3 0 i t 4u 0 h p it 3 0 i t 4v d r it  d h d h 0 h d h 0 0 h d h 0 i t 1 4w d r it  d h d h p it h d h p it 0 h d h p it i t 2 where h it is daily groundwater depth of crop i m h 0 is initial groundwater depth m h p it is weighted daily groundwater depth m which is estimated by weighting that of spring wheat maize and sunflower based on the fraction of planted area of each crop  1  2  3 considering the lateral flow of groundwater the variations of groundwater depth are affected by crop growth and their planted area thus a weighted groundwater depth can be obtained by multiplying the respective groundwater depths of three crops h it by their fractions  i  is the specific yield  0 07  d is drainage coefficient tang et al 2007 which is used to quantify the amount of drainage between the difference of groundwater depth and bottom level of drainage ditch h d in this study h d is set as the same value in these drainage ditches and h d 1 5 m due to shallow groundwater level and  d 0 03 4 constraints of salt balance in the root zone soluble salts from irrigation water are the primary source of salinization problems in the study area salts are exchanged among the soil body crop root zone and groundwater aquifers through water movement salt balance in the root zone can be written below 4x r s i t 1 r s it i s i t 1 g w s i t 1 d p s i t 1 where r s it i s it gw s i t 1 and dp s i t 1 are soluble salt content in the root zone applied irrigation water groundwater evaporation and deep percolation respectively g m2 r s it w it s r it i s it i w it s y gw s it e t g it s g it and dp s it d p it s r it sy s r it and s g it are salt concentration of irrigation water soil water in the root zone and groundwater evaporation g l there is an empirical relationship between actual electrical conductivity ds m and the total soluble salt concentration g l that is 1 ds m 0 64 g l abrol et al 1988 5 constraints of salt balance in the groundwater aquifers similar to equation 4q salt transport and movement in the groundwater aquifers is related to groundwater evaporation deep percolation and drainage thus salt balance in the groundwater aquifers among these processes can be presented below 4y g s i t 1 g s it d p s i t 1 g w s i t 1 d r s i t 1 4z g s i t 1 z g h p t h p t 1 s g t 1 where g s it and g s i t 1 are soluble salt content in the groundwater aquifers mg m2 dr s i t 1 are soluble salt content in the drainage dr s i t 1 d r i t 1 s g i t 1 z g is the thickness of the shallow groundwater layer and its value is defined as the difference between groundwater level and the depth unreachable by groundwater level fluctuations m in this study z g is set as 2 m 6 constraint of salt accumulation in the root zone this constraint requires to limit the value of salt accumulation in the root zone at harvest to be less than a certain threshold value to control the salt accumulation during the whole crop growth period 4aa s r it 3 84 i 1 t 112 4ab s r it 3 84 i 2 3 t 175 in this study soil salt accumulation of three crops is set not to increase during the whole growth season 7 constraint of soil water content 4ac  wp s a l t  it  fc soil water content at wilting point varies from low salinity to high salinity thus equation 4ac presents the constraint of soil water content by considering the effect of salinity on the wilting point 8 initial conditions s r 0 3 84 g l 4ad s g 0 3 80 g l 4ae  0 0 22 4af h 0 1 20 m 4ag these initial conditions are provided to calculate water balance and salt balance for different time steps 3 3 data acquisition and processing the data needed for the study were obtained from experimental results statistical reports and relevant literature respectively fig 3 presents the reference evapotranspiration and precipitation during the whole crop growth period table 1 shows crop growth stages calendar and the corresponding crop coefficients other input parameters can be seen in table 2 economic water productivity is predetermined by decision makers based on their subjective or empirical data which can be interpreted as the management objectives they intend to achieve therefore triangular fuzzy number is used to define economic water productivity 5 5 6 5 7 5 yuan m3 the available volume of surface water use is also presented as triangular fuzzy number e g a a a where a a and a are the least possible value main value and the highest possible value a and a can be estimated by interval estimation method using t distribution because of unknown variance of the collected data a is determined as the mean value of the sample data source is the volume of historical water diversion from the yellow river to study area 4 results analysis through providing several credibility levels in the constraints solutions can be generated at allowable violation risk levels whereas the constraints don t need to be fully satisfied these flexible solutions can provide more choice for decision making in practical problems three credibility levels including  0 7 0 8 and 0 9 are presented in the constraints of irrigation water use to examine variations of solutions from  0 7 to  0 9 satisfactory levels of the constraints are in the state of very satisfied almost satisfied and practically satisfied respectively which can reflect decision makers subjective preference and support fuzzy decision analysis thus credibility level of constraints can represent believable confidence level of optimal solutions in a practical sense a higher credibility level is linked with a higher degree of feasibility and reliable strategy which represents conservative environmental capacities to manage irrigation water management at a relatively lower level of system failure risk by constraining different irrigation volumes under three  levels simulation process of water and salinity balance can be naturally affected meanwhile the physical process described above also constrain the irrigation volumes thus bridging the linkage of simulation optimization process because such a coupled simulation optimization framework focuses on enhancing economic water productivity and controlling salinity results include optimal solutions of objective function values irrigation water planning daily variations of salt concentration in the crop root zone and groundwater aquifers and groundwater depth are analyzed and compared 4 1 optimal objective function value the maximized credibility level of objective function is obtained by solving the simulation optimization framework based on input parameters and a set of constraints fig 4 presents optimal fuzzy objective function values under a higher credibility level an alternative with lower achievable level management target will be reached but the reliability of satisfying water availability constraint would increase for example the credibility levels of objective are 0 901 0 886 and 0 861 as the constraints are satisfied at  0 7 0 8 and 0 9 that means the credibility levels that predetermined management target i e 5 5 6 5 7 5 yuan m3 can be achieved are 0 901 0 886 and 0 861 since the credibility measure is self dual the corresponding credibility levels of its complement event are 1 0 901 0 099 1 0 886 0 114 and 1 0 861 0 139 respectively an increased credibility level of the constraints indicates a decreased permissible risk for constraints violations and thus less decision space has been arisen from more stringent constraints therefore a lower objective function value will be achieved at a higher  level but the reliability level is increased due to less system failure risk at the same time traditional studies usually provide crisp decision solutions with optimal objective values through introducing the concept of dependent chance into fuzzy programming method decision makers are able to maximize the credibility level of satisfying these fuzzy events and finally support fuzzy decisions instead of crisp ones more practically this is applicable in irrigation water planning problems because some ambiguous parameters are fuzzy in nature owing to incomplete and unavailable data the above analyses show that this study incorporates fuzzy dependent chance programming and fuzzy credibility constrained programming within its modeling framework and deals with fuzzy information in the objective function and constraints concurrently furthermore results present tradeoffs among the maximized objective value credibility level of constraint and constraint violation risk therefore this study extends the applicability of fuzzy methods and is able to solve more types of fuzzy decision problems 4 2 optimal solutions of irrigation water planning due to water competition among three crops optimal strategies of irrigation water planning are useful for achieving certain management targets and economic implications fig 5 provides solutions of irrigation water planning associated with credibility levels of constraints these results can clearly illustrate the amount of irrigation water at each irrigation time during the whole growth period for example spring wheat maize and sunflower are irrigated a total of three times four times and three times it can be seen that spring wheat is irrigated with much more water followed by maize and sunflower under different credibility levels it is revealed that maize and sunflower are irrigated almost the same amount of water at different irrigation times showing that violation constraints have less effect on the irrigation times taking maize as an example the amount of irrigation water at the first second and third fourth time are 54 4 mm 53 4 mm and 50 1 mm 50 2 mm  0 7 50 1 mm 50 4 mm and 50 3 mm 50 0 mm  0 8 and 50 4 mm 51 9 mm and 50 2 mm 52 0 mm  0 9 it is noted that the total amount of irrigation water during the whole growth period has no obvious trend under different  levels the total irrigation amount for spring wheat is 209 9 mm  0 7 232 9 mm  0 8 and 227 3 mm  0 9 similarly the total irrigation for maize is 208 1 mm  0 7 200 8 mm  0 8 and 204 6 mm  0 9 for sunflower a total irrigation of 156 3 mm  0 7 150 7 mm  0 8 and 156 7 mm  0 9 will be allocated furthermore the total irrigation water uses for three crops in the study area i e 10 i 1 3 t 1 175 a i i w it  s are increased from 298 6 106 m3 to 305 5 106 m3 when  level is raised from 0 7 to 0 9 see fig 4 obviously this can explain why optimal objective values are decreased as the  level increases in the case of ratio optimization problems e g benefits water use revenue cost as the value of the denominator i e total irrigation amount becomes larger it eventually leads to a smaller value of the objective function fig 6 presents crop yields under different  levels crop yield is directly related to crop evapotranspiration which is influenced by soil water stress and salt stress conditions from  0 7 to  0 9 crop yields are slightly decreased for all crops compared with wheat salt tolerance of maize and sunflower is lower and they are easily affected by soil salinity therefore it is found that crop yield of wheat is larger than that of maize and sunflower furthermore by summing the daily evapotranspiration of three crops during their growth periods it can be seen that wheat has the highest evapotranspiration for example the total evapotranspiration of spring wheat maize and sunflower are 345 0 mm 327 7 mm and 243 3 mm under  0 7 from fig 5 the total amount of irrigation for three crops are 209 9 mm 208 1 mm and 156 3 mm while the total groundwater based evaporation of three crops are 103 0 mm 108 1 mm and 65 2 mm accounting for 29 9 33 0 and 26 8 of crop evapotranspiration therefore it can provide insight into interrelationships of water balance elements and finally figure out the quantitative factors that contribute to crop yields 4 3 salt concentration in the root zone and groundwater aquifers better knowledge of the daily variations of salt concentration in the root zone and groundwater aquifers contributes to the understanding of the process of salinity effects on crop growth and field salt accumulation fig 7 illustrates daily variations of salt concentration in the root zone and groundwater aquifers during the whole growth period for each crop under a certain  level salt concentration is directly related to irrigation events because these values change drastically after irrigation based on the water and salt balance in the root zone and groundwater aquifers larger amount of irrigation water leads to deep seepage which takes away salts from the root zone meanwhile the deep seepage makes the groundwater level rise and finally leads to a higher drainage of the study area the salts taken away by the drainage process cause the salt concentration of the groundwater aquifers to decrease therefore salt concentration in the groundwater aquifers is highly associated with the variations of salt concentration in the root zone fig 7 shows that change points occur the day before irrigation events in the root zone and valley points occur on the days of irrigation events during the crop growing period from sowing to harvesting salt concentration of spring wheat is larger than that of maize and sunflower for example the mean values of salt concentration in the root zone of spring wheat maize and sunflower are 3 58 g l 3 13 g l and 2 79 g l under  0 7 when the crop is not irrigated the daily salt concentration is gradually increasing in the root zone this is due to the accumulation of salts from groundwater evaporation driven by crop evapotranspiration as capillary rise is a non negligible component of water balance in areas with shallow groundwater depth similarly the mean values of salt concentration in the groundwater aquifers of spring wheat maize and sunflower are 3 59 g l 3 56 g l and 3 54 g l under  0 7 in the optimization model salt accumulation in the root zone at harvest is limited to be less than 3 84 g l for spring wheat the 112th day and maize and sunflower the 175th day thus results show that the values of three crops are basically satisfied the constraints and they are 3 84 g l 3 29 g l and 2 94 g l under  0 7 3 81 g l 3 26 g l and 2 91 g l under  0 8 and 3 85 g l 3 24 g l and 2 89 g l under  0 9 in additional it is found that salt concentration in the root zone is decreased before maize and sunflower planting and after spring wheat harvest this is mainly because field drainage carries away the salts due to the shallow groundwater table in terms of different  levels the results of salt concentration in the root zone and groundwater aquifers show a similar trend the fluctuations of salt concentration are linked with irrigation events and the volume of irrigation water for maize and sunflower the values of salt concentration under three  levels are almost the same during the whole growing season for spring wheat during its growth period there is a clearly visible difference under three credibility levels for example the lowest value of salt concentration under  0 8 is found at the middle of the first 22th day and second 52th day irrigation time after the second irrigation the salt concentration value under  0 7 is even greater compared with under  0 8 and 0 9 this can also be verified by the mean values of salt concentration in the root zone under  0 7 0 8 and 0 9 and they are 3 58 g l 3 40 g l and 3 55 g l for sunflower during its growth period from 65th to 175th day results under  0 7 are slightly greater than that of  0 8 and 0 9 until the last day 175th day this is supported by the mean values of salt concentration under  0 7 0 8 and 0 9 and they are 2 79 g l 2 77 g l and 2 75 g l 4 4 groundwater depth and drainage fig 8 illustrates daily groundwater depth and its corresponding drainage under three  levels in general deep percolation emerges rapidly after irrigation and groundwater evaporation occurs daily because of the shallow depth of groundwater while drainage is generated by the difference in elevation between groundwater level and the bottom depth of drainage ditches deep percolation recharges groundwater while groundwater evaporation and drainage deplete groundwater consequently fig 8 basically presents fluctuations of groundwater depth before or after irrigation events notable changes of groundwater depth can be seen which represents expected change in groundwater level after irrigation the mean values under  0 7 0 8 and 0 9 are 1 970 m 1 974 m and 2 000 m indicating an increased credibility level leads to less irrigation water applied to crops there is a comparable trend of change under  0 7  0 8 and  0 9 as their peak values of groundwater depth occur the first day 1 200 m and the lowest values occur at the end of growing season 2 459 m 2 411 m and 2 477 m overall the fluctuation of groundwater depth is smaller and it is declining throughout the study period the drainage volume is directly related to the variation of groundwater depth when the groundwater depth is less than 1 5 m drainage will be appeared when the groundwater depth is greater than 1 5 m no drainage will be generated in the field during the whole growth period the total volume of drainage 79 2 mm is the same under  0 7 0 8 and 0 9 this is because the groundwater depth less than 1 5 m occurred only before the first irrigation there is no impact on the three crops the above results are physically consistent and clearly demonstrated the water and salt movement among irrigation water soil water and groundwater drainage it can be seen that the system representations are closer to the physics of the actual systems thus it s an effective way to develop simulation model based on water and salt balance equations 5 discussions 5 1 sensitivity analysis of the results sensitivity analysis can measure how the impact of uncertainties of one or more input variables can lead to variations on the output variables it s useful for understanding the model by qualitatively and quantitatively studying the model response to change in input variables and analyzing interactions among variables thus parametric sensitivity analysis is typically performed to examine the robustness of the results based on the significance of the initial parameters in this part changing assumptions originating from objective coefficient constraint bound are studied firstly different values of management targets in the objective function are set fig 9 shows the results of predetermined economic water productivity under  0 9 in detail when the management target is set as 5 0 6 0 7 0 yuan m3 then the credibility degree of the fuzzy objective is 0 961 indicating that this fuzzy event is almost completely achievable when the values of management targets are given as 6 0 7 0 8 0 yuan m3 6 5 7 5 8 5 yuan m3 7 0 8 0 9 0 yuan m3 these fuzzy events are only be satisfied at 0 795 0 711 and 0 604 it is obvious that a larger management target leads to a smaller credibility level and greater deviation from the target this is also in line with practical management indicating that management goals cannot be given blindly but must be considered to be practical in mathematical terms see eqs 2d and 4a it is found that a larger value of ew p 3 and ew p 2 from above scenarios results in a lower value for the numerator 2 b 2 b 1 ew p 3 2 e w p 2 and the same value for the denominator 2 b 2 b 1 2 ew p 3 e w p 2 when other conditions are being equal thereby leading to a smaller ratio in other words this is mainly determined by main and maximum possible values of triangular fuzzy numbers furthermore when the management goals are predefined as 6 5 7 0 7 5 yuan m3 6 5 7 5 8 5 yuan m3 6 5 8 0 9 5 yuan m3 it is noted that the difference of ew p 3 2 e w p 2 is the same for the three scenarios i e 7 5 2 7 0 8 5 2 7 5 9 5 2 8 0 but the difference of 2 b 2 b 1 2 ew p 3 e w p 2 is different i e 2 b 2 b 1 2 6 5 6 0 2 b 2 b 1 2 7 5 6 5 2 b 2 b 1 2 8 5 7 0 therefore optimal objective values are obtained as 0 865 0 711 and 0 597 for the above three scenarios resulting in a different outcome generally these management targets are set by decision makers through experience or subjective attitudes to reflect their expected planning for agricultural development by changing management targets in the objective function credibility levels of fuzzy objective satisfaction can be quantitatively represented though the concept of dependent chance secondly different values are varied in the salt accumulation constraint to mitigate the negative impact of salinization problems constraints of salt accumulation are introduced to limit the salt concentration in the root zone at harvest that is three threshold values of salt accumulation including 3 20 g l 3 84 g l and 4 48 g l are defined in the constraints fig 10 shows the variation of salt concentration in the root zone under these scenarios the salt concentration at harvest is satisfied the constraints and they are 3 11 g l 3 78 g l and 4 21 g l for spring wheat 3 06 g l 3 24 g l and 3 30 g l for maize and 2 83 g l 2 88 g l and 2 95 g l moreover the mean values of salt concentration in these scenarios are 3 08 g l 3 55 g l and 3 77 g l for spring wheat furthermore the credibility levels of objective in three settings are 0 804 0 861 and 0 907 it can be seen that a larger salt accumulation threshold corresponds to a larger objective function in that case the predetermined economic water productivity can be easily achieved this is understandable that more stringent constraints mean that goals are more difficult to be achieved these results enable to show the tradeoffs between salt control goals and objective function the above sensitivity analysis enables comparison of the effects of different model s assumptions on the results the sensitivity of objective coefficient is higher than that of constraint bound when we change certain assumptions showing that management targets must be robustly pre determined for our study 5 2 climate change impact on the results likewise there is an urgent need to make irrigation planning strategies in the context of climate change because these complex interactions multiply the uncertainties gaaloul et al 2020 the future climate of the hetao irrigation district will become increasingly warm and wet and the rise of in et0 will continuously increase the water demand during crop growth period which thus will bring major impacts on the hydrological cycle water balance and agricultural production sun et al 2013 based on the study of zhou et al 2017 future climate scenarios are separately divided into scenarios a2 and b2 in the time periods 2041 2070 and 2071 2099 table 3 lists the corresponding changes of et0 and precipitation under these scenarios zhou 2017 through substituting input parameters of et0 and precipitation while other parameters remain the same optimal results under these scenarios can be obtained table 4 presents optimal results for better comparison of each scenario results show that optimal objective function values slightly decrease from 0 861 baseline to 0 804 a2 2071 2099 this also means that increased crop water requirements due to climate change will lead to lower achievable level of management target moreover these potential climate induced changes in water requirements and precipitation also have an influence on crop yields compared with current conditions therefore adaptive practices should be undertaken to mitigate variability of climate change and reduce vulnerability of agricultural systems 5 3 effectiveness of the simulation optimization framework there are many studies to improve irrigation water productivity by changing irrigation quotas irrigation methods and cropping patterns kang et al 2000 oweis and hachum 2006 molden et al 2010 edreira et al 2018 these studies place more emphasis on the analysis of experimental data to conclude that a certain practice can increase water productivity besides coupled studies using hydrological models with crop models have become another way to assess water productivity for future irrigation planning after proper calibration and validation though measured and empirical data these models can be employed to do scenario analysis for searching preferable management strategies alternatively this study is to pre determine the economic water productivity and examine how irrigation planning can be carried out to ensure that the fuzzy objective is achieved with the maximum credibility level the maximized achievable level of management targets shows that the chance or credibility level for fuzzy events and management targets to be satisfied under specific conditions by comparing the credibility achievable level of different objectives the range of management targets and the difference of existing goals can ultimately be determined to help in improving economic water productivity 6 conclusions an integrated simulation optimization framework is developed for enhancing irrigation water productivity and controlling salinity under uncertainty it s formulated through incorporating full fuzzy dependent linear fractional programming approach with water and salt balance model a real case study in jiefangzha irrigation subarea in hetao irrigation district northwest china is presented to manage irrigation water and control salt accumulation optimal solutions resulting from the developed framework can identify management patterns with the maximum achievable level of fuzzy objective these results can illustrate the physical interactions among irrigation water soil water and groundwater and present a dynamic decision making process therefore the following are the novelties and importance of this study 1 the concept of dependent chance to quantify the achievable level of management target is a novelty in irrigation planning and promotes better understanding of fuzzy decisions 2 the integration of developed optimization model and water salt balance model with mathematical expression is considered a novel method for addressing a real world problem 3 this study deals with the salinity issues through salt movement among irrigation water soil water groundwater and drainage and salt accumulation constraint 4 from this study dynamic decisions can be made and tradeoffs among objective functions optimal solutions and different system satisfaction conditions are readily illustrated without losing generality this is a good attempt to connect it to agricultural practice to develop an integrated framework by coupling simulation module and uncertain programming method and finally enhancing irrigation water productivity and control salinity in agricultural lands nevertheless adaptive decisions underlying impacts on irrigation planning has limitations without considering regional spatiotemporal variability of parameters and human activities e g water saving measures canal lining reduction of water diversion and alternation of plant structure credit authorship contribution statement chenglong zhang conceptualization methodology formal analysis writing original draft xuemin li data curation methodology software ping guo writing review editing zailin huo supervision writing review editing guanhua huang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was jointly supported by the national science foundation of china grant number 52009133 and 51639009 the comments and suggestions from the editor and two anonymous reviewers are helpful in improving the earlier version of this paper 
