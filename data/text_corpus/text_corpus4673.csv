index,text
23365,the global performance of a spar and fpso floating production storage and offloading connected by horizontal fluid transfer lines ftls bundled with a large carrier pipe called gap gravity actuated pipeline is evaluated by using a fully coupled multi body mooring riser time domain analysis program the horizontal pipeline bundle is attached to a carrier pipe to give sufficient bending stiffness and make the system neutrally buoyant the pipeline bundle is supported by chains attached to spar at one end and to fpso at the other end allowing the movement mainly in the axial direction the fpso is to weathervane with respect to a bow external turret the hydrodynamic coefficients are obtained from multi body diffraction radiation 3d panel program in the frequency domain and they are subsequently used in the time domain simulation program to carry out the fully coupled time domain global motion analysis the moorings and risers attached to the fpso and spar are modeled with high order finite elements fes the pipeline bundle is also modeled with finite elements as one line member with the equivalent diameter and structural properties the axial friction forces as well as the transverse drags on the pipeline bundle are considered because their accumulated effects along the very long ftl can be significant the coupled relative motions of the spar and fpso can significantly affect the dynamics and tensions of the ftl the dynamics of the ftl can also affect the relative motions of the two platforms too the complex coupled system is also significantly affected by the headings of environmental loadings keywords fluid transfer line ftl gap gravity actuated pipeline spar and fpso fully coupled multi body mooring riser time domain analysis axial friction forces relative motions 1 introduction conventionally the free hanging fluid transfer pipelines between two floating platforms which are usually dry tree unit dtu and fpso are made of flexible or steel pipes suspended in single or multiple wave configuration to avoid the high tensile and compressive stresses mainly due to bending moment usually the bending moment on the pipes is caused by the relative motion of the floating platforms as well as the motion of the pipeline itself compared to the seabed pipelines the suspended ftls are well known to be an attractive alternative solution the main advantages of the suspended ftl compared to the subsea pipe line are a improved flow assurance due to higher sea water temperature leading to reduced risk of blockage by formation of wax and or hydrates b avoidance of seabed constraints such as ground instability irregular sea bed profile and subsea hardware congestion however the free hanging flow lines with single or multiple wave configuration isnard et al 2006 or with bonded hoses rampi et al 2005 are much longer than the distance between the dtu and fpso to have less local curvature the long transfer line requires higher discharge pressure to withstand the pressure drop due to the friction loss along the long pipe inner wall in the case the distance is too large i e larger than 1000 m the flow line motion may also significantly influence the fpso and dtu motions in extreme environments which results in the increase of the motion and load of the flow line itself in summary the disadvantages of the conventional suspended flow transfer pipelines are limitation in the sizes of the ftls strength and fatigue problems flow assurance concerns due to the long line length with possible temperature drop and the high cost of materials and installation the gravity actuated pipelines gap is one of the alternatives to stabilize crude oil transfer lines with free hanging flexible or rigid steel pipelines fig 1 the gap is based on a large diameter pipe that serves as a structural support for the flow lines and umbilicals the flow lines are attached to the carrier pipe by supports allowing movement in the axial direction the carrier pipe terminates at each end with a towhead which channels the forces into the carrier pipe and supports flexible jumpers between the flow lines and the floating facilities the action of the clump weights or buoyancy on the angled chains keeps the carrier pipe under tension this tension minimizes the hog sag deflections of the carrier pipe bundle and keeps the gap system within the acceptable hog and sag limits the major portion of the gap system has a straight line compared to the other types of the suspended ftls therefore the environmental loads can be minimized and the size of the pipes can be maximized which is known to give more efficient solutions for the oil transfer for longer distance also it can resolve the flow assurance issue by making the line length short and by keeping the lines close to the water surface where the temperature is relatively higher than the deep water in the present paper a spar and fpso connected by the 2000m long gap is analyzed by using multi hull riser mooring coupled dynamic analysis time domain program charm3d developed by the second author s research group during the past two decades e g ran and kim 1997 kang and kim 2014 the simulation program has well been verified through many experimental and field data including fpso spar and multiple floating platforms e g kim et al 2005 2001 2016 kang et al 2010 this study uses the multibody module of the program including linear or nonlinear connections e g yang 2009 this kind of wide spread offshore system is difficult to be model tested in wave tanks since correct scaling is almost impossible due to limited dimensions of wave basins reliable computer simulations are the only viable option as far as authors know the reliable computer modeling simulation of this kind of complicated 3 part coupled gap system has never been published in the open literature the added mass radiation damping and wave excitation forces of the spar and the fpso are calculated by multibody wamit in frequency domain which are subsequently used in harp charm3d to carry out the fully coupled time domain global performance analysis along with the hanging pipeline bundle in the middle the moorings risers and gap system attached to the fpso and spar are modeled by high order finite elements fes the wave and current loads on the line members are calculated by the morison formula with the proper drag and inertia coefficients applied the pipeline bundle is lumped into one line to have the equivalent mass diameter and structural properties the chains connecting the pipeline bundle with the spar and fpso are also modeled with high order finite elements and the element connected to the pipeline bundle is modeled to have the weight equivalent to the lump weight on the pipeline bundle the axial friction forces as well as the transverse drags are considered because the long line length can make the axial friction force appreciable in the dynamic analysis of the system in this regard the sensitivity of the axial friction force in of the drag force is investigated by varying it from 0 through 10 2 system specification to investigate the global performance of the spar gap fpso coupled system a typical truss spar yang and kim 2010c is selected and modeled in the coupled analysis the principal dimensions of the spar hull are shown in table 1 the hard tank diameter is 28 65 m 94 ft and the draft at the intact condition is 163 4 m 536 ft it has 12 8 m 42 ft by 12 8 m 42 ft rectangular center wells at the hard and soft tanks the fpso has a 337 06 m overall length 61 m breadth 37 depth and 316 830 mt of displacement at the draft of 16 8 m the fpso is equipped with an external turret on the bow side the kg center of gravity from the keel is 22 60 m and the lcg longitudinal center of gravity is 161 98 m from ap the chain wire chain mooring system is used for the spar and fpso the nominal diameters of the chain and the wire are 146 mm and 133 mm respectively the lengths of the upper and anchor chains are 210 m and 107 m respectively and the length of the wire is 1778 m in this paper the gap coupling effect on the dtu and fpso and the dynamic behavior of the gap are mainly investigated the gap is a 2000 m long fluid transfer line ftl which is neutrally buoyant the carrier pipe is a large pipe of 47 ¼ inch outer diameter od the four 4 flow lines of 4 inch internal diameters are attached around the carrier pipe the nominal depth of the pipeline bundle is 200 m from the mean sea level and the length is 2 km as shown in fig 2 the two vessels are connected by the gap with two 230 m long and 5 inch od chains at each end two 150 mt clump weights are placed at the chain to carrier pipe connecting points the initial tension of the chain is set to 310 mt at the fpso hang off point and 304 mt at the spar hang off point the total of 24 ttrs and 9 mooring lines are attached to the spar and total of 9 mooring lines and 2 scrs are attached to the turret of the fpso 3 numerical modeling 3 1 dynamic system the motions of multiple rigid bodies subject to general forces are described herein the spar and the fpso are treated as separate multiple bodies each of which has six dof degrees of freedom in general the n body system has 6 n dofs the dynamics of n body system is derived here assuming that each body connected through springs or the line members the force and moment equilibrium and equations of motion of the i th body are shown in fig 3 the set of equations can be combined into the following form 1 m i y i n v i f b i f e i where 2 m i m i m i b g i m i b g i i i 3 y i r c i θ b n i 4 n v i θ b n i m i b g i θ b n i θ b n i i i θ b n i in the above equations upper dot means time derivative f b i is the body force such as gravity f e i is the external force acted on the i th body m i is body mass m i and i i are the 3 3 matrices for mass and mass moment of inertia of the i th body r c i is the displacement of the rotational center of the i th body with respect to the inertia coordinate b g i body frame displacement of the center of gravity θ b n i rotational velocity of the body with respect to the inertia frame the cross matrix b g i is a skew matrix defined as b g i 0 b g 3 i b g 2 i b g 3 i 0 b g 1 i b g 2 i b g 1 i 0 and the cross matrix θ b n i is a skew matrix defined as θ b n i 0 θ 3 i θ 2 i θ 3 i 0 θ 1 i θ 2 i θ 1 i 0 the nonlinear inertia term n v i becomes negligible when rotational motions are small however when rotational motions are large it should be retained the external forces represent environmental loads such as wave wind and current forces in case of floating platforms 5 f e m a y f r y t k k c y t y f w e t f w i n d t f m o r y t f c y y t where m a added mass at infinite frequency f r y t r t τ y d τ wave radiation damping force in terms of convolution integral r t 2 π 0 c ω c o s ω t d ω retardation function from radiation damping coefficient c ω k system stiffness matrix hydrostatic k c y t nonlinear implicit time and motion dependent stiffness matrix f c y y t motion and time dependent connection forces through connection boundary conditions f w e t f w e 1 t f w e 2 t potential based wave exciting forces of the first and the second order f w i n d t wind force f m o r y t force on the morison members whose primary contribution is viscous loading the index i is omitted in the equation for convenience the nonlinear stiffness k c and the force f c y y t due to the nonlinear structural coupling between bodies are mostly from the nonlinear fe model of mooring tendon and risers for offshore platforms yang and kim 2010 b or the nonlinear linear spring between bodies for top side structures yang et al 2010 a and 2011 3 2 hydrodynamic modeling the added mass and radiation damping coefficients and the first order and second order wave forces are calculated by the diffraction radiation panel program wamit lee et al 1991 since the distance between two floaters are far enough 2000m in this case to ignore the hydrodynamic interaction the separate hydrodynamic properties are calculated in frequency domain and the hydrodynamic interaction terms are neglected the second order wave excitation forces at difference frequencies are to be taken into account while the sum frequency components are not important for the motions of spar and fpso and thus neglected as for the second order wave force coefficients kim and yue 1991 newman s approximation is used for this study the external stiffness due to the mooring and riser are added to the hydrostatic stiffness in the frequency domain preprocessing calculations for the hydrodynamic analysis fpso is represented by 2367 panels and the spar hull is discretized by 691 panels all the hydrodynamic coefficients are calculated in the frequency domain and the corresponding forces are converted to the forms useful in time domain by using two term volterra series expansion kim and yue 1991 the frequency dependent radiation damping was included in the form of convolution integral in the time domain simulation the origin of the body fixed coordinate system is located on the free surface at the center of the hull the z axis is positive upward in fig 4 and fig 5 the panel configurations of the fpso and the spar respectively for the hydrodynamic analysis in frequency domain are shown the cross flow viscous drag forces on columns heave plates and fpso hull are modeled by the morison equation proportional to the square of the relative velocities the wind current loads on the fpso are obtained from the ocimf wind current load coefficient data ocimf 1994 3 3 mooring riser and ftl modeling the mooring lines and risers are modeled by high order fe method based on the slender rod theory garret 1982 the higher order elements used are quadratic in displacement and cubic in tension the eight ttrs consist of riser pipes and on the top of the riser connecting to the spar hull the hydro pneumatic tensioner is modeled the tensioner is modeled with a linear spring whose stiffness is 364 87 kn m 25 kips ft the hydrodynamic loads on the slender elements are calculated by the morison equation the mooring lines and risers are all attached down to the anchor points the scrs and the mooring lines on the fpso are modeled to have the end nodes at the turret center to model the same effect of the turret so that fpso can weathervane around the turret centerline total 30 finite elements are used to model the ftl line with the finer elements at both ends and drag coefficient cd 2 3 is used for both gap and the supporting end chain fig 6 shows the final fully coupled model of spar gap fpso 4 environmental criteria the water depth is 1300 m assuming spatial variation of the bathymetry is minimal over the site the extreme design conditions 100 year return period are considered for the current study which combines wave wind of 100 year return period and current of 10 year return period jonswap wave spectra are used with respective significant wave heights hs peak periods tp and peakedness parameters γ to represent the irregular uni directional waves it is confirmed that the regenerated wave spectra from the generated time histories coincide with the input spectra the time varying wind speed is generated from the api wind spectrum the 180 degree and 0 degree heading angles are considered which are all in line with ftl as follows 100 year wind w1hr 10m 17 9 m sec 100 year wave hs 6 3 m tp 13 1 s γ 3 10 year current v 1 2 m sec the collinear wwc wind wave and current condition is considered the mean positions of the spar and fpso are shown in fig 7 and fig 8 respectively for the heading angles of 180 and 0 the environment is coming from spar to fpso for 180 heading and it is coming from fpso to spar for 0 heading since the fpso is moored by the external turret it weathervanes depending on the environmental heading angles therefore the position angle of the fpso with respect to the global coordinate is different in the two figures the two heading angles are considered mainly to investigate the effect of the friction force on the pipe on the coupled motion of the two platforms as well as the dynamic characteristics of the gap fig 9 shows the numerically generated time history and spectrum of the incident wave the comparison between the target and the re generated spectra is also given in the figure 5 numerical results and discussions as described in the previous section the sensitivity of the spar gap fpso coupled motion to the variation of the friction factor on the gap in the longitudinal direction is investigated the friction factor c f of the gap longitudinal direction is set to be 0 3 5 8 and 10 of the drag coefficient c d typically tangential friction force on a long smooth circular pipe is about 3 of normal cross flow drag force however the gap system has some appurtenance with the frame as shown in the figure and there is a possibility of significant marine growth on its surface therefore the selected 0 10 range is considered first free decay simulation is carried out to the stand alone spar and fpso the spar natural period of surge is 371 s and the heave natural period is 21 79 s the fpso surge natural period is 350 s the motion time histories of spar and fpso and its spectra for heading 180 and c f 0 c d are shown from figs 10 12 to minimize the start up transient effects in time domain simulations linearly increasing ramp function from zero to actual value is applied for external loads during the first 200 s those ramp up portions were not included in the corresponding spectral and statistical analyses in fig 10 the sudden amplification of spar surge pitch motions near 1000s is noticeable which can happen depending on the relative phases of the three bodies the sudden increase of the spar pitch motion is most likely caused by sudden pool fig 20 from the gap as evidenced by the sudden increase of horizontal displacement see fig 21 at gap to spar connection the sudden pool was caused by the large amplitude slowly varying surge motion of fpso in the direction to increase the corresponding gap motion and tension at gap to spar connection it is the result of 3 body interactions at certain phase and instant the hammer like snap loading typically causes that kind of decaying transient response like ringing phenomenon at natural period this phenomenon typically demonstrates why the fully coupled 3 body time domain simulations are necessary for reliable design the fpso surge motion shows more slowly varying component than spar because the surge motion of spar is more induced by the pitch the fpso heave motions are much larger than those of spar as shown in fig 11 which is typically observed in the actual operations the pitch motion peak frequency is 0 48 rad sec 13 s for fpso and 0 1 rad sec 60 s for spar which corresponds to the peak period of the wave spectrum and the natural period of each system respectively fpso shows slowly varying yaw and sway motions since it is moored by the external turret to free the yaw fig 13 shows the horizontal motion of the fpso at the midship section since the fpso is hinged around the external turret without any friction the small yaw incurs yaw moment as the hydrodynamic coefficients wave wind current loads are calculated for different yaw angles the hydrodynamic forces for different yaw angles were pre calculated for many subdivided angles and the proper pre calculated values were assigned at each time step during the time domain simulation the tensions at both sides of the gap are plotted in fig 14 the mean tension is different because the hang off angles at both sides are different but the maximum dynamic tension range is similar to each other about 1500 kn in figs 15 and 16 the horizontal and vertical gap motions are respectively examined at the location specified in fig 7 i e the point 0 represents the connector on the spar and the point 4 is the connector on the fpso the point 2 is the middle position of the gap the low frequency horizontal motions of the gap generally follow those of the fpso the wave frequency motions of the gap follow the spar surge motions and they are more prominent closer to the spar connection point the large motion of the spar at around 1000 s is directly transferred to the entire gap the horizontal motions of points 1 2 and 3 would be identical if the gap was absolutely rigid without vertical wavy responses the vertical motions at 0 and 5 represent the platforms vertical motions at the respective fairleads while the vertical motions along the gap point 1 2 and 3 show similar trends of the gap s horizontal motions this is due to the swing like pendulum motion of the gap hung by chain and the corresponding vertical set up displacements in addition if the two platforms move away it tends to lift the gap through chain and the opposite is true when the two platforms get closer therefore the relative horizontal motions of fpso and spar directly influence the vertical motions of gap as well the longitudinal friction coefficient along the gap is varied from 0 to 10 of cd and the results for cf 10 cd are shown from figs 17 22 about 3 of cd is typical but it can be increased up to 10 depending on the degree of marine fouling the time histories and spectra of the spar and fpso surge heave and pitch motions generally show similar trends as the previous cases the mean and dynamic surge motions are however appreciably affected by the change of cf the mean surge offset of fpso is significantly increased also the tension of the chain is significantly increased at the connection point to the spar while it is slightly decreased at fpso side the dynamic tension and its maximum of the spar side is also increased appreciably while it is slightly decreased on fpso side the result is due to the increased friction force on the gap making the chain on the spar side taut and on the fpso side slack the longitudinal and vertical motion time histories of gap are shown in figs 21 and 22 respectively similar to the platform motions the gap mean offset is increased however the dynamic horizontal gap motions are significantly reduced due to the additional friction in the longitudinal direction the gap vertical motions still have some dynamic components but their amplitudes are also shown to be significantly reduced compared to the case of c f 0 c d on the other hand its mean value is increased due to the increased excursion of the gap causing the set up the motion of spar and fpso are summarized in tables 2 6 with the variation of ftl friction coefficients for 180 degree wave heading angle table 7 also provides the motions with cf 3 cd for the heading angle of 0 from fpso to spar see tables 3 4 5 fig 23 through fig 30 give the comparisons of the 2 platform motions and gap tensions of all the cases based on the tables fig 23 summarizes the comparison of the mean offset in surge direction the mean offsets of fpso and spar increase with the friction coefficient which is due to the increased mean load on the gap the fpso mean offset for 0 degree heading is larger than that for 180 degree heading however the spar mean offset is not much sensitive to the wave heading angle due to the symmetry of its hull shape the dynamic surge motion is generally not much sensitive to the friction coefficient nevertheless the decrease increase of wave frequency low frequency fpso dynamic surge motions due to the change of wave heading from 180 to 0 is noticeable see figs 24 25 29 the mean longitudinal offsets of the gap become larger as the friction coefficients increase as shown in fig 26 its mean longitudinal offset of 0 degree heading is larger than that for 180 degree heading the mean vertical gap motions also show similar trend since larger horizontal mean offset causes larger upward movement due to the pendulum effect fig 27 the mean tensions of the chain at the connections to spar and fpso are compared in fig 28 which shows the significant increase of the chain tension on spar side compared to the fpso side as gap friction coefficients increase the dynamic tension on the spar side also increases more appreciably than that of fpso side in fig 30 the maximum tension to mean tension ratio represents the dynamic effects of the chain tension the dynamic effect becomes maximum for c f 8 c d 6 conclusions the global performance of a spar gap fpso coupled system is evaluated by using harp charm3d a fully coupled multi body mooring riser time domain analysis simulation program developed by authors the detailed coupled dynamics of the three bodies for two environment headings in line with the pipeline bundle are investigated along with the sensitivity of the system response with varying the longitudinal friction factor of the pipe the present study is focused on identifying the dynamic coupling effects between the spar and fpso through the gap and the effect of the friction on the long pipe bundles on the whole system response the gap has the appreciable effect to couple the spar and fpso i e the motions of the platforms and gap as well as the tensions on the chain show the strong coupling effects which is sensitive to the friction factor and the heading of the environment therefore a reliable fully coupled dynamics program of that kind should be used to design such a complex dynamic system especially the non stochastic response such as a sudden increase of a spar surge pitch motion was captured during the simulation as a result of snap loading by the connection and it verified the necessity of the fully coupled time domain analysis for the design of this kind of complex system the gap displacements and tensions are largely caused by the spar and fpso relative motions as well as the friction force by the current the gap dynamics are not too much affected by the incident waves due to its large submergence depth the longitudinal friction forces on the gap by the current increase the mean surge of the platforms and gap which shifts the gap position upwards which may cause increased wave loading on the other hand the friction forces may effectively damp out the gap s longitudinal dynamic motions sudden response amplifications of the two platforms can happen depending on their relative phases which also influences the gap design since the current system is hard to be physically modeled in wave basins extensive numerical simulations like the present study need to be utilized in the design stage 
23365,the global performance of a spar and fpso floating production storage and offloading connected by horizontal fluid transfer lines ftls bundled with a large carrier pipe called gap gravity actuated pipeline is evaluated by using a fully coupled multi body mooring riser time domain analysis program the horizontal pipeline bundle is attached to a carrier pipe to give sufficient bending stiffness and make the system neutrally buoyant the pipeline bundle is supported by chains attached to spar at one end and to fpso at the other end allowing the movement mainly in the axial direction the fpso is to weathervane with respect to a bow external turret the hydrodynamic coefficients are obtained from multi body diffraction radiation 3d panel program in the frequency domain and they are subsequently used in the time domain simulation program to carry out the fully coupled time domain global motion analysis the moorings and risers attached to the fpso and spar are modeled with high order finite elements fes the pipeline bundle is also modeled with finite elements as one line member with the equivalent diameter and structural properties the axial friction forces as well as the transverse drags on the pipeline bundle are considered because their accumulated effects along the very long ftl can be significant the coupled relative motions of the spar and fpso can significantly affect the dynamics and tensions of the ftl the dynamics of the ftl can also affect the relative motions of the two platforms too the complex coupled system is also significantly affected by the headings of environmental loadings keywords fluid transfer line ftl gap gravity actuated pipeline spar and fpso fully coupled multi body mooring riser time domain analysis axial friction forces relative motions 1 introduction conventionally the free hanging fluid transfer pipelines between two floating platforms which are usually dry tree unit dtu and fpso are made of flexible or steel pipes suspended in single or multiple wave configuration to avoid the high tensile and compressive stresses mainly due to bending moment usually the bending moment on the pipes is caused by the relative motion of the floating platforms as well as the motion of the pipeline itself compared to the seabed pipelines the suspended ftls are well known to be an attractive alternative solution the main advantages of the suspended ftl compared to the subsea pipe line are a improved flow assurance due to higher sea water temperature leading to reduced risk of blockage by formation of wax and or hydrates b avoidance of seabed constraints such as ground instability irregular sea bed profile and subsea hardware congestion however the free hanging flow lines with single or multiple wave configuration isnard et al 2006 or with bonded hoses rampi et al 2005 are much longer than the distance between the dtu and fpso to have less local curvature the long transfer line requires higher discharge pressure to withstand the pressure drop due to the friction loss along the long pipe inner wall in the case the distance is too large i e larger than 1000 m the flow line motion may also significantly influence the fpso and dtu motions in extreme environments which results in the increase of the motion and load of the flow line itself in summary the disadvantages of the conventional suspended flow transfer pipelines are limitation in the sizes of the ftls strength and fatigue problems flow assurance concerns due to the long line length with possible temperature drop and the high cost of materials and installation the gravity actuated pipelines gap is one of the alternatives to stabilize crude oil transfer lines with free hanging flexible or rigid steel pipelines fig 1 the gap is based on a large diameter pipe that serves as a structural support for the flow lines and umbilicals the flow lines are attached to the carrier pipe by supports allowing movement in the axial direction the carrier pipe terminates at each end with a towhead which channels the forces into the carrier pipe and supports flexible jumpers between the flow lines and the floating facilities the action of the clump weights or buoyancy on the angled chains keeps the carrier pipe under tension this tension minimizes the hog sag deflections of the carrier pipe bundle and keeps the gap system within the acceptable hog and sag limits the major portion of the gap system has a straight line compared to the other types of the suspended ftls therefore the environmental loads can be minimized and the size of the pipes can be maximized which is known to give more efficient solutions for the oil transfer for longer distance also it can resolve the flow assurance issue by making the line length short and by keeping the lines close to the water surface where the temperature is relatively higher than the deep water in the present paper a spar and fpso connected by the 2000m long gap is analyzed by using multi hull riser mooring coupled dynamic analysis time domain program charm3d developed by the second author s research group during the past two decades e g ran and kim 1997 kang and kim 2014 the simulation program has well been verified through many experimental and field data including fpso spar and multiple floating platforms e g kim et al 2005 2001 2016 kang et al 2010 this study uses the multibody module of the program including linear or nonlinear connections e g yang 2009 this kind of wide spread offshore system is difficult to be model tested in wave tanks since correct scaling is almost impossible due to limited dimensions of wave basins reliable computer simulations are the only viable option as far as authors know the reliable computer modeling simulation of this kind of complicated 3 part coupled gap system has never been published in the open literature the added mass radiation damping and wave excitation forces of the spar and the fpso are calculated by multibody wamit in frequency domain which are subsequently used in harp charm3d to carry out the fully coupled time domain global performance analysis along with the hanging pipeline bundle in the middle the moorings risers and gap system attached to the fpso and spar are modeled by high order finite elements fes the wave and current loads on the line members are calculated by the morison formula with the proper drag and inertia coefficients applied the pipeline bundle is lumped into one line to have the equivalent mass diameter and structural properties the chains connecting the pipeline bundle with the spar and fpso are also modeled with high order finite elements and the element connected to the pipeline bundle is modeled to have the weight equivalent to the lump weight on the pipeline bundle the axial friction forces as well as the transverse drags are considered because the long line length can make the axial friction force appreciable in the dynamic analysis of the system in this regard the sensitivity of the axial friction force in of the drag force is investigated by varying it from 0 through 10 2 system specification to investigate the global performance of the spar gap fpso coupled system a typical truss spar yang and kim 2010c is selected and modeled in the coupled analysis the principal dimensions of the spar hull are shown in table 1 the hard tank diameter is 28 65 m 94 ft and the draft at the intact condition is 163 4 m 536 ft it has 12 8 m 42 ft by 12 8 m 42 ft rectangular center wells at the hard and soft tanks the fpso has a 337 06 m overall length 61 m breadth 37 depth and 316 830 mt of displacement at the draft of 16 8 m the fpso is equipped with an external turret on the bow side the kg center of gravity from the keel is 22 60 m and the lcg longitudinal center of gravity is 161 98 m from ap the chain wire chain mooring system is used for the spar and fpso the nominal diameters of the chain and the wire are 146 mm and 133 mm respectively the lengths of the upper and anchor chains are 210 m and 107 m respectively and the length of the wire is 1778 m in this paper the gap coupling effect on the dtu and fpso and the dynamic behavior of the gap are mainly investigated the gap is a 2000 m long fluid transfer line ftl which is neutrally buoyant the carrier pipe is a large pipe of 47 ¼ inch outer diameter od the four 4 flow lines of 4 inch internal diameters are attached around the carrier pipe the nominal depth of the pipeline bundle is 200 m from the mean sea level and the length is 2 km as shown in fig 2 the two vessels are connected by the gap with two 230 m long and 5 inch od chains at each end two 150 mt clump weights are placed at the chain to carrier pipe connecting points the initial tension of the chain is set to 310 mt at the fpso hang off point and 304 mt at the spar hang off point the total of 24 ttrs and 9 mooring lines are attached to the spar and total of 9 mooring lines and 2 scrs are attached to the turret of the fpso 3 numerical modeling 3 1 dynamic system the motions of multiple rigid bodies subject to general forces are described herein the spar and the fpso are treated as separate multiple bodies each of which has six dof degrees of freedom in general the n body system has 6 n dofs the dynamics of n body system is derived here assuming that each body connected through springs or the line members the force and moment equilibrium and equations of motion of the i th body are shown in fig 3 the set of equations can be combined into the following form 1 m i y i n v i f b i f e i where 2 m i m i m i b g i m i b g i i i 3 y i r c i θ b n i 4 n v i θ b n i m i b g i θ b n i θ b n i i i θ b n i in the above equations upper dot means time derivative f b i is the body force such as gravity f e i is the external force acted on the i th body m i is body mass m i and i i are the 3 3 matrices for mass and mass moment of inertia of the i th body r c i is the displacement of the rotational center of the i th body with respect to the inertia coordinate b g i body frame displacement of the center of gravity θ b n i rotational velocity of the body with respect to the inertia frame the cross matrix b g i is a skew matrix defined as b g i 0 b g 3 i b g 2 i b g 3 i 0 b g 1 i b g 2 i b g 1 i 0 and the cross matrix θ b n i is a skew matrix defined as θ b n i 0 θ 3 i θ 2 i θ 3 i 0 θ 1 i θ 2 i θ 1 i 0 the nonlinear inertia term n v i becomes negligible when rotational motions are small however when rotational motions are large it should be retained the external forces represent environmental loads such as wave wind and current forces in case of floating platforms 5 f e m a y f r y t k k c y t y f w e t f w i n d t f m o r y t f c y y t where m a added mass at infinite frequency f r y t r t τ y d τ wave radiation damping force in terms of convolution integral r t 2 π 0 c ω c o s ω t d ω retardation function from radiation damping coefficient c ω k system stiffness matrix hydrostatic k c y t nonlinear implicit time and motion dependent stiffness matrix f c y y t motion and time dependent connection forces through connection boundary conditions f w e t f w e 1 t f w e 2 t potential based wave exciting forces of the first and the second order f w i n d t wind force f m o r y t force on the morison members whose primary contribution is viscous loading the index i is omitted in the equation for convenience the nonlinear stiffness k c and the force f c y y t due to the nonlinear structural coupling between bodies are mostly from the nonlinear fe model of mooring tendon and risers for offshore platforms yang and kim 2010 b or the nonlinear linear spring between bodies for top side structures yang et al 2010 a and 2011 3 2 hydrodynamic modeling the added mass and radiation damping coefficients and the first order and second order wave forces are calculated by the diffraction radiation panel program wamit lee et al 1991 since the distance between two floaters are far enough 2000m in this case to ignore the hydrodynamic interaction the separate hydrodynamic properties are calculated in frequency domain and the hydrodynamic interaction terms are neglected the second order wave excitation forces at difference frequencies are to be taken into account while the sum frequency components are not important for the motions of spar and fpso and thus neglected as for the second order wave force coefficients kim and yue 1991 newman s approximation is used for this study the external stiffness due to the mooring and riser are added to the hydrostatic stiffness in the frequency domain preprocessing calculations for the hydrodynamic analysis fpso is represented by 2367 panels and the spar hull is discretized by 691 panels all the hydrodynamic coefficients are calculated in the frequency domain and the corresponding forces are converted to the forms useful in time domain by using two term volterra series expansion kim and yue 1991 the frequency dependent radiation damping was included in the form of convolution integral in the time domain simulation the origin of the body fixed coordinate system is located on the free surface at the center of the hull the z axis is positive upward in fig 4 and fig 5 the panel configurations of the fpso and the spar respectively for the hydrodynamic analysis in frequency domain are shown the cross flow viscous drag forces on columns heave plates and fpso hull are modeled by the morison equation proportional to the square of the relative velocities the wind current loads on the fpso are obtained from the ocimf wind current load coefficient data ocimf 1994 3 3 mooring riser and ftl modeling the mooring lines and risers are modeled by high order fe method based on the slender rod theory garret 1982 the higher order elements used are quadratic in displacement and cubic in tension the eight ttrs consist of riser pipes and on the top of the riser connecting to the spar hull the hydro pneumatic tensioner is modeled the tensioner is modeled with a linear spring whose stiffness is 364 87 kn m 25 kips ft the hydrodynamic loads on the slender elements are calculated by the morison equation the mooring lines and risers are all attached down to the anchor points the scrs and the mooring lines on the fpso are modeled to have the end nodes at the turret center to model the same effect of the turret so that fpso can weathervane around the turret centerline total 30 finite elements are used to model the ftl line with the finer elements at both ends and drag coefficient cd 2 3 is used for both gap and the supporting end chain fig 6 shows the final fully coupled model of spar gap fpso 4 environmental criteria the water depth is 1300 m assuming spatial variation of the bathymetry is minimal over the site the extreme design conditions 100 year return period are considered for the current study which combines wave wind of 100 year return period and current of 10 year return period jonswap wave spectra are used with respective significant wave heights hs peak periods tp and peakedness parameters γ to represent the irregular uni directional waves it is confirmed that the regenerated wave spectra from the generated time histories coincide with the input spectra the time varying wind speed is generated from the api wind spectrum the 180 degree and 0 degree heading angles are considered which are all in line with ftl as follows 100 year wind w1hr 10m 17 9 m sec 100 year wave hs 6 3 m tp 13 1 s γ 3 10 year current v 1 2 m sec the collinear wwc wind wave and current condition is considered the mean positions of the spar and fpso are shown in fig 7 and fig 8 respectively for the heading angles of 180 and 0 the environment is coming from spar to fpso for 180 heading and it is coming from fpso to spar for 0 heading since the fpso is moored by the external turret it weathervanes depending on the environmental heading angles therefore the position angle of the fpso with respect to the global coordinate is different in the two figures the two heading angles are considered mainly to investigate the effect of the friction force on the pipe on the coupled motion of the two platforms as well as the dynamic characteristics of the gap fig 9 shows the numerically generated time history and spectrum of the incident wave the comparison between the target and the re generated spectra is also given in the figure 5 numerical results and discussions as described in the previous section the sensitivity of the spar gap fpso coupled motion to the variation of the friction factor on the gap in the longitudinal direction is investigated the friction factor c f of the gap longitudinal direction is set to be 0 3 5 8 and 10 of the drag coefficient c d typically tangential friction force on a long smooth circular pipe is about 3 of normal cross flow drag force however the gap system has some appurtenance with the frame as shown in the figure and there is a possibility of significant marine growth on its surface therefore the selected 0 10 range is considered first free decay simulation is carried out to the stand alone spar and fpso the spar natural period of surge is 371 s and the heave natural period is 21 79 s the fpso surge natural period is 350 s the motion time histories of spar and fpso and its spectra for heading 180 and c f 0 c d are shown from figs 10 12 to minimize the start up transient effects in time domain simulations linearly increasing ramp function from zero to actual value is applied for external loads during the first 200 s those ramp up portions were not included in the corresponding spectral and statistical analyses in fig 10 the sudden amplification of spar surge pitch motions near 1000s is noticeable which can happen depending on the relative phases of the three bodies the sudden increase of the spar pitch motion is most likely caused by sudden pool fig 20 from the gap as evidenced by the sudden increase of horizontal displacement see fig 21 at gap to spar connection the sudden pool was caused by the large amplitude slowly varying surge motion of fpso in the direction to increase the corresponding gap motion and tension at gap to spar connection it is the result of 3 body interactions at certain phase and instant the hammer like snap loading typically causes that kind of decaying transient response like ringing phenomenon at natural period this phenomenon typically demonstrates why the fully coupled 3 body time domain simulations are necessary for reliable design the fpso surge motion shows more slowly varying component than spar because the surge motion of spar is more induced by the pitch the fpso heave motions are much larger than those of spar as shown in fig 11 which is typically observed in the actual operations the pitch motion peak frequency is 0 48 rad sec 13 s for fpso and 0 1 rad sec 60 s for spar which corresponds to the peak period of the wave spectrum and the natural period of each system respectively fpso shows slowly varying yaw and sway motions since it is moored by the external turret to free the yaw fig 13 shows the horizontal motion of the fpso at the midship section since the fpso is hinged around the external turret without any friction the small yaw incurs yaw moment as the hydrodynamic coefficients wave wind current loads are calculated for different yaw angles the hydrodynamic forces for different yaw angles were pre calculated for many subdivided angles and the proper pre calculated values were assigned at each time step during the time domain simulation the tensions at both sides of the gap are plotted in fig 14 the mean tension is different because the hang off angles at both sides are different but the maximum dynamic tension range is similar to each other about 1500 kn in figs 15 and 16 the horizontal and vertical gap motions are respectively examined at the location specified in fig 7 i e the point 0 represents the connector on the spar and the point 4 is the connector on the fpso the point 2 is the middle position of the gap the low frequency horizontal motions of the gap generally follow those of the fpso the wave frequency motions of the gap follow the spar surge motions and they are more prominent closer to the spar connection point the large motion of the spar at around 1000 s is directly transferred to the entire gap the horizontal motions of points 1 2 and 3 would be identical if the gap was absolutely rigid without vertical wavy responses the vertical motions at 0 and 5 represent the platforms vertical motions at the respective fairleads while the vertical motions along the gap point 1 2 and 3 show similar trends of the gap s horizontal motions this is due to the swing like pendulum motion of the gap hung by chain and the corresponding vertical set up displacements in addition if the two platforms move away it tends to lift the gap through chain and the opposite is true when the two platforms get closer therefore the relative horizontal motions of fpso and spar directly influence the vertical motions of gap as well the longitudinal friction coefficient along the gap is varied from 0 to 10 of cd and the results for cf 10 cd are shown from figs 17 22 about 3 of cd is typical but it can be increased up to 10 depending on the degree of marine fouling the time histories and spectra of the spar and fpso surge heave and pitch motions generally show similar trends as the previous cases the mean and dynamic surge motions are however appreciably affected by the change of cf the mean surge offset of fpso is significantly increased also the tension of the chain is significantly increased at the connection point to the spar while it is slightly decreased at fpso side the dynamic tension and its maximum of the spar side is also increased appreciably while it is slightly decreased on fpso side the result is due to the increased friction force on the gap making the chain on the spar side taut and on the fpso side slack the longitudinal and vertical motion time histories of gap are shown in figs 21 and 22 respectively similar to the platform motions the gap mean offset is increased however the dynamic horizontal gap motions are significantly reduced due to the additional friction in the longitudinal direction the gap vertical motions still have some dynamic components but their amplitudes are also shown to be significantly reduced compared to the case of c f 0 c d on the other hand its mean value is increased due to the increased excursion of the gap causing the set up the motion of spar and fpso are summarized in tables 2 6 with the variation of ftl friction coefficients for 180 degree wave heading angle table 7 also provides the motions with cf 3 cd for the heading angle of 0 from fpso to spar see tables 3 4 5 fig 23 through fig 30 give the comparisons of the 2 platform motions and gap tensions of all the cases based on the tables fig 23 summarizes the comparison of the mean offset in surge direction the mean offsets of fpso and spar increase with the friction coefficient which is due to the increased mean load on the gap the fpso mean offset for 0 degree heading is larger than that for 180 degree heading however the spar mean offset is not much sensitive to the wave heading angle due to the symmetry of its hull shape the dynamic surge motion is generally not much sensitive to the friction coefficient nevertheless the decrease increase of wave frequency low frequency fpso dynamic surge motions due to the change of wave heading from 180 to 0 is noticeable see figs 24 25 29 the mean longitudinal offsets of the gap become larger as the friction coefficients increase as shown in fig 26 its mean longitudinal offset of 0 degree heading is larger than that for 180 degree heading the mean vertical gap motions also show similar trend since larger horizontal mean offset causes larger upward movement due to the pendulum effect fig 27 the mean tensions of the chain at the connections to spar and fpso are compared in fig 28 which shows the significant increase of the chain tension on spar side compared to the fpso side as gap friction coefficients increase the dynamic tension on the spar side also increases more appreciably than that of fpso side in fig 30 the maximum tension to mean tension ratio represents the dynamic effects of the chain tension the dynamic effect becomes maximum for c f 8 c d 6 conclusions the global performance of a spar gap fpso coupled system is evaluated by using harp charm3d a fully coupled multi body mooring riser time domain analysis simulation program developed by authors the detailed coupled dynamics of the three bodies for two environment headings in line with the pipeline bundle are investigated along with the sensitivity of the system response with varying the longitudinal friction factor of the pipe the present study is focused on identifying the dynamic coupling effects between the spar and fpso through the gap and the effect of the friction on the long pipe bundles on the whole system response the gap has the appreciable effect to couple the spar and fpso i e the motions of the platforms and gap as well as the tensions on the chain show the strong coupling effects which is sensitive to the friction factor and the heading of the environment therefore a reliable fully coupled dynamics program of that kind should be used to design such a complex dynamic system especially the non stochastic response such as a sudden increase of a spar surge pitch motion was captured during the simulation as a result of snap loading by the connection and it verified the necessity of the fully coupled time domain analysis for the design of this kind of complex system the gap displacements and tensions are largely caused by the spar and fpso relative motions as well as the friction force by the current the gap dynamics are not too much affected by the incident waves due to its large submergence depth the longitudinal friction forces on the gap by the current increase the mean surge of the platforms and gap which shifts the gap position upwards which may cause increased wave loading on the other hand the friction forces may effectively damp out the gap s longitudinal dynamic motions sudden response amplifications of the two platforms can happen depending on their relative phases which also influences the gap design since the current system is hard to be physically modeled in wave basins extensive numerical simulations like the present study need to be utilized in the design stage 
23366,ais data plays an increasingly important role in collision avoidance risk evaluation and navigation behavior study however the raw ais data contains noise that can result in wrong conclusions we propose a multi regime vessel trajectory reconstruction model through three steps processing including i outliers removal ii ship navigational state estimation and iii vessel trajectory fitting this model allows for vessel trajectory reconstruction in different navigation states namely hoteling maneuvering and normal speed sailing the normal speed navigation trajectory is estimated with a spline model which can fit any types of the trajectory even with circles then the proposed model is tested and compared with other three popular trajectory reconstruction models based on a large ais dataset containing the movement of more than 500 ships in singapore port the results show that the proposed model performs significantly better than the linear regression model polynomial regression model and weighted regression model the proposed model can decrease the abnormal rate of speed acceleration jerk and rot rate of turn from 43 42 10 65 59 25 50 33 0 00 0 00 17 28 and 15 81 respectively more importantly the navigational behavior such as turning operation could be clearly shown in the trajectory reconstructed by the proposed model keywords automatic identification system ais data filtering trajectory reconstruction trajectory estimation 1 introduction automatic identification system ais is an automatic ship self reporting system used for the maritime transportation safety purpose the ais system broadcasts the vessel sailing status information such as the position speed loading status which can be received by the other ships or vessel traffic service vts centers harati mokhtari et al 2007 according to the safety of life at sea solas of the international maritime organization imo ais is mandatory for the international voyaging ships with gross tonnage gt more than 300 and all passenger ships as its wide application in the shipping industry ais data have become increasingly important for the navigational safety and maritime traffic management szlapczynski and szlapczynska 2016 wang and chin 2016 xiao et al 2015 zhang et al 2016 vessel trajectory information indicated by the ais data is one of the most important data sources for ship collision study first with real time ais data a vessel can track the movement of the neighbor vessels and use the collision avoidance decision making models to improve the navigational safety li et al 2012 mazaheri et al 2016 for example su et al developed a fuzzy logic theory based system using ais data to optimize the rudder steering decision for the give way ship su et al 2012 moreover the historical ais data is useful for vessels movement analytics and collision risk evaluation for instance mou et al investigated the actual behavior of collision involved ships off the rotterdam port in europe and analyzed the vessel collision using the ais data mou et al 2010 weng et al evaluated the vessel collision frequency in singapore strait by calculating the product of the vessel conflicts number and the causation probability using the real time vessel movement data from the lloyd s marine intelligence unit lloyd s miu database weng et al 2012 more recently ais data are used to predict the vessel trajectory for the maritime safety management using the machine learning methods borkowski 2017 shangbo mao et al 2016 for example borkowski 2017 developed a trajectory prediction model using multiple neural networks learning from the maritime fusion data all these applications depend on the accurate vessel trajectory information from the ais data the quality of the ais data depends on the ais equipment the navigational state of the vessel and ais message receiver base station lapinski and isenor 2011 there are two types of shipborne ais equipment namely class a and class b ais equipment class a ais equipment is usually installed in the international cargo ships and passenger ships while class b ais equipment is mainly installed in the inland waterway ships xiao et al 2015 the class a ais equipment is usually more expensive and has higher accuracy compared with the class b ais equipment the accuracy of the ais data also depends on the location of the ais message receiver base stations which affects the ais message signal coverage lapinski and isenor 2011 the navigational state also affects the ais data quality more specifically the ais data from the vessels in the port waters have a higher time resolution than that of the ships in the open sea lapinski and isenor 2011 a number of works have been reported for the accuracy evaluation of ais data for example harati mokhtari et al investigated the ais errors considering the navigational states and found that 30 of ships were displayed incorrectly harati mokhtari et al 2007 just as the gps data the ais data is also suffered from the data noise of position information this can be illustrated by an example of a vessel sailing in the singapore port on october 11 2013 as shown in fig 1 it can be seen in the zoom window that the trajectory of the vessel is zigzag caused by the noise data which should be a smooth curve according to the mechanisms of movement if this kind of data with noise is used for grounding risk evaluation or the vessel navigation behavior study which depends on high accurate trajectory data will result in wrong conclusions thus there is a need to quantify the quality of the ais dataset and reconstruct the real ship trajectory based on the sampling vessel position information with noise from the ais data very few attempts in the literature review have been conducted for the ais data noise elimination and vessel trajectory reconstruction based on the ais data qu et al presented a data cleansing procedure to eliminate the noises and update those inaccurate records according to newton s laws of motion qu et al 2011 more specifically the traffic speed can be calculated based on the ais trajectory which is then used as an indicator of the ais data accuracy by checking whether it is inconsistent with the maneuverability of the vessel the interpolation method can also be used for data noise elimination such as the linear interpolation model presented in zhang et al 2015 a more complex model was developed by liu and chen to complete the course vessel route in the open water area using the position speed course over ground and time stamp information liu and chen 2013 sang et al presented a method to restore the vessel trajectory by a curve fitting method for the inland waterway ships sang et al 2015 in conclusion a quantitative method to evaluate the quality of the ais data set is still missing in the existing literature moreover few studies focus on the vessel in the constrained port water areas concerning different navigational states such as hoteling maneuvering with the help of tug ships and normal speed sailing furthermore the existing curve fitting methods are not suitable for the trajectories with closed segments or circles to fill the aforementioned research gaps we propose a multi regime vessel trajectory reconstruction model for ships in port waters in the proposed model firstly the ais noise data point is detected and eliminated using a quantitative ais data evaluation method by checking the vessel speed acceleration cog course of ground change rate and acceleration change rate then the vessel trajectory is estimated for different navigation statuses by linear regression and b spline filtering model the contribution of this study is two fold first we present a quantitative approach to evaluate the quality of the ais dataset second we propose a multi regime vessel trajectory reconstruction model which can handle the vessel trajectories in port waters which are composed of different navigation status more importantly the proposed model performs significantly better than several existing trajectory filtering models based on the real case studies 2 vessel trajectory noise in ais data 2 1 ship positioning error the position of the ship is estimated by the positioning system such as gps global positioning system dgps differential global positioning system or loran c long range navigation harati mokhtari et al 2007 lapinski and isenor 2011 the positioning system allows the position of a receiver to be estimated in cartesian coordinates x and y in the word geodetic system 84 reference system the gps position data contains errors caused by many factors such as atmospheric effects clock inaccuracies and rounding errors hong et al 2004 suppose p i x i y j is the true position of the ship at time instant i δ x i g μ x i σ x i 2 and δ y i g μ y i σ y i 2 the components of the measurement error along x and y direction where g represents the generic distribution the observed position will therefore be p i o b s x i δ x i y i δ y i the measurement error is calculated by 1 δ i x i x i δ x i 2 y i y i δ y i 2 δ x i 2 δ y i 2 2 2 ais data quality indicator with the ais data we can calculate the vessel speed acceleration and the jerk change rate of the acceleration moreover the rot rate of turn is another indicator which could be calculated based the ship trajectory these values are constrained by the maneuverability of the vessel when there are inaccurate data in the ais data the calculated indicators would be abnormal which could be considered as the evidence of the ais quality it should be noted that the term abnormal refers to the low frequency very high measurement errors and not the random errors this can be further elaborated by fig 2 which shows the vessel speed acceleration and jerk it can be clearly seen that these values vary greatly and some values seem quite abnormal for example in fig 2 b a large number of the vessel speed values are above 30 knots some of which are even exceed 200 knots which may be caused by the data noise 2 2 1 abnormal speed the ship characteristic database contains the maximum speed v m a x k of the individual ship k thus the percentage of the abnormal vessel speed i v p v i j k 1 v m a x j indicts the quality of the ais database where v i j is the speed of vessel j at time instance i and k 1 is the parameter which has the default value of one by this way we can remove the very high measurement errors which conflict with the maneuverability of the ship the larger of the k 1 is the higher measurement errors will be removed 2 2 2 abnormal rot in the constrained water the maximum rot of the ship depends on the vessel speed and the vessel length which is calculated by the formula wu 1999 2 max r o t i j v i j δ t 2 l j where v i j is the speed of vessel j from time instance i to i 1 l j is the length of vessel j δ t is the time interval between time instance i to time instance i 1 the percentage of the rot which exceeds its maximum value also indicates the ais data quality 2 2 3 abnormal acceleration the vessel acceleration is affected by a lot of factors such as ship type wave condition and load factors acanfora et al 2017 fig 3 d shows the vessel acceleration based on the ais of ships in singapore port water october 2013 which will be introduced in the following sections we can see that 73 08 of the values are within 1 1 and only a small percentage of the acceleration values are above 15 knots thus unfeasible extreme values or an anomalous shape of the distribution are clear indications of problems in the ais data 2 2 4 abnormal jerk apart from the distribution of the acceleration values their temporal variation also gives an important indication of ais data quality which is measured by the jerking factor namely the derivative of the acceleration the jerking factor should not be an extremely high value as the comfortable values for the human usually do not exceed 2 m s 3 marczak and buisson 2012 for the vehicles the jerking factor is usually within 15 m s 3 in this paper the percentage of the observations with jerk values higher than the threshold of 15 m s 3 is used as another data quality indicator 3 methodology filtering technologies have been used for trajectory data processing which could remove the unwanted components or features such as noise due to the measurement error and keep the real data dynamics a number of models have been developed for the vehicle trajectory reconstruction such as the moving average model polynomial regression model weighted polynomial regression model i spline filtering ossen and hoogendoorn 2008 punzo and simonelli 2005 toledo et al 2007 however these models cannot be used for ship trajectory reconstruction directly for two reasons first the vehicle trajectory is represented by the one dimension linear referencing coordinate system because the vehicle travels along the lane of the road however in the maritime traffic the ship can navigate freely in the water and the trajectory is represented by a two dimension coordinate system which can contain circles moreover the movement features of the ships are totally different from that of the ships which may include hoteling maneuvering with the help of the tug ships and normal speed sailing according to the maneuverability feature of the ship we developed a multi regime vessel trajectory reconstruction model and compared it with the other popular models including linear regression model polynomial regression model and weighted polynomial regression model which have been developed for the vehicle trajectory processing the proposed model is composed of three steps 1 the first step aims at removing the extreme positional errors according to the ais data quality indicators presented in section 2 2 in the second step the navigational states of the vessel are estimated based on the ship activity analysis which is divided into three categories namely hoteling maneuvering and normal speed sailing 3 the last step is curve fitting for the vessel trajectory 3 1 step 1 outliers removal in this step we only used vessel speed and rot to identify the outliers although the acceleration and the jerking factor can also act as the ais data quality indicators it is quite difficult to give the determinate threshold values for different type of ships this is different from the vehicles in the urban traffic which have similar characteristics such as speed and acceleration for example in the urban traffic the threshold for the vehicle acceleration is set to 5 m s2 for acceleration and 8 m s2 for deceleration marczak and buisson 2012 in the maritime traffic the threshold values for different types of ships would vary greatly the maximum values of the vessel speed and rot could be determined for the specific vessel it should be noted that in this step we capture only the very high measurement errors and not the random error component 3 2 step 2 ship navigational state estimation the trajectories of a ship fleet can be described by a set j j i j i i 1 2 m where j i is the trajectory of the ship i and m is the number of ships the trajectory of ship i is defined as 3 j i p i k p i k t k x i k y i k u i k t k 1 2 n where k is the time instance index n is the total number of time intervals during the analysis period and p i k is the state vector of the ship i at time t k for the state vector x i k and y i k are the coordinates of the ship i at time t k and u i k is the speed of ship i at time t k the activity chain of a ship generally includes three types of activities namely hoteling maneuvering and normal speed sailing the journey of a ship is one trip from one maritime traffic zone mtaz to another traffic zone in the hoteling states the ship is usually fixed with cables to receive services such as loading goods unloading goods waiting in anchorages replenishing food water and energy or others thus the activity chain of the ship i can be defined by a set a i t i s i where t i represents the trips of the ship i and s i denotes the hoteling state of the ship i to receive service the set t i is defined by t i j i t 1 j t 2 j j 1 2 n t i where n t i is the number of trips of ship i and j is trip index j i t 1 j t 2 j is the j t h trip of ship i between time t 1 and t 2 which is defined by 4 j i t 1 j t 2 j p i k t 1 j k t 2 j where t 1 j and t 2 j are the start time and end time of a trip respectively thus the start position and end position of the trip are x i t 1 j y i t 1 j and x i t 2 j y i t 2 j similarly s i can be defined by s i j i t 1 j t 2 j j 1 2 n s i where n s i is the total number of the receiving service activities of the ship i the states of ships in port waters is firstly divided into two types sailing for the purpose of movement and hoteling for the purpose of receiving services thus the activities of all ships can be defined by the set a a i a i t i s i i 1 2 n a where n a is the number of activities if the set of hoteling to receive service and sailing activities are denoted by s and t respectively we naturally have a t s the aim of activity chain analysis is to divide the ship trajectory into separated segments according to the differentiated activities specifically we split them into two sets t i and s i once s i is determined the trajectory of the ship i can be divided into t i and s i the corresponding time instances of s i are denoted as 5 t s t 1 i k t 2 i k j i t 1 k t 2 k s i k 1 2 n s i the set t s can be determined based on the following facts a while in the state of receiving service the ship moorings a traffic zone and keeps static for a certain long time b otherwise it is regarded as the sailing state the starting time of one servicing activity t 1 i k can be determined according to the following conditions 6 t 1 i k t 1 i k m e a n s p e e d j i t 1 k t 1 k τ z j u θ j i t 1 k t 1 k τ z j z z j k 1 2 n s i where τ z j is the lower bound of the time length during which the ships receive services in mtaz maritime traffic zone z j μ θ is the upper bound of the average speed to mark a non sailing ship m e a n s p e e d is the function to calculate the average speed of ship i between times t 1 k and t 1 k t z j z j is the mtaz with index of j n s i is the number of activities that receive services of ship i according to the ship speed analysis we set u θ 1 5 knots it should be noted that the mtaz is determined by the function of the water areas according to the nautical chart the most important parameter in analyzing ship activity chain is τ z j which depends on the service types for example the time of loading goods could be probably longer than 30 min and the waiting time in anchorage areas might be longer than 60 min or even lasts a few hours the service times of the ships in z i are denoted by t s z i t s i i 1 2 n and the minimum service time in mtaz z i is denoted as t s z i m i n then we set t z min t s z i min z i 1 2 if τ z j is too small some ship sailing states may be recognized as receiving service states thus the most crucial work of this method is to determine τ z j in this study we use an easily implemented experimental method to determine τ z j we increase t z from a small initial value and check the trip numbers in the study area when the number maintains stable the proper value for t z is determined according to the data analysis based on the ais in singapore port waters the number of trips starts keeping steady from 15mins namely t z 15 mins for certain type of large vessels such as container ships they need the help of the tug ships to move from the docks the movement characteristics are quite different from normal sailing activities because the large ships need to keep a minimum speed for the controllability purpose the sailing states with the speed below this minimum value would be the maneuvering state otherwise it is the normal speed sailing states the pseudocode of the trip extraction procedure is presented in table 1 firstly the ship trajectory is divided into small segments and in every small segment the ais points are located in a traffic zone or navigable water area the trajectory in the navigable water area is the route which can link two traffic zones however the trajectory within a traffic zone can also be the ship trajectory passing through this zone other than arrived in this zone for receiving service thus the trajectory passing through the traffic zone should be detected in the next step we iterate every ship trajectory segment and divide them into two states namely the sailing and hoteling if the ship trajectory segment is in the navigable water area the ship is under the sailing state if the ship trajectory is in the traffic zone the ship trajectory is divided into sailing and hoteling according to formula 6 it should be noted that it is possible that there are multiple sailing or hoteling ship trajectory segments in one traffic zone for example one ship enters the berth and then leaves the berth after unloading loading the cargo 3 3 step 3 vessel trajectory fitting once the trajectory is divided into different navigational states the trajectory is reconstructed using the following methods i hoteling during the berthing time or receiving service stage the ships would be fixed with the cable and thus the position should keep fixed however actually the ship should still move slightly caused by the wind and wave this slight movement would be very random which depends on the level and direction of the wave in this study we set the movement distance of the ships in the hoteling state to zero ii maneuvering in this stage the ship would move with the help of the tug ships and thus the ship trajectory would be different from that during the normal speed sailing according to a large amount of real data experiments we select the linear regression model to smooth the vessel trajectory as follows 7 x i t a 0 i a 1 i t i 8 y i t β 0 i b 1 i t i where a 0 i a 1 i b 0 i b 0 i are the parameters of the regression model at time instance i for the longitude x i and latitude y i the parameters are estimated using the least squares estimation based on the nearest n points within the time window in this study n is set to 3 and the time window width is set to 5 min iii normal speed navigation in the vehicle trajectory reconstruction the distance increase with the time which is a monotone increasing function however the ship trajectory is more complex than vehicle trajectory which may contain circles in the measure observations of the ship position x i y i i 1 2 m we need to find an arbitrary curve the condition x i x i 1 is not necessarily fulfilled thus the general curve fitting methods using for vehicle trajectory reconstruction are no longer applicable in this case we process a trajectory fitting model as follows first every data point x i y i is assigned with the corresponding time value t i which is monotone increasing then for the vessel trajectory between time span a b with a t i b we determine two spline functions 9 s x t i k n c x i m i k 1 t 10 s y t i k n c y i m i k 1 t of degree k 3 with knots a t 0 t 1 t n 1 b then the trajectory reconstruction becomes an optimization problem 11 min j 1 n s x k t j 0 s x k t j 0 2 s y k t j 0 s y k t j 0 2 subject to 12 j 1 m w j x j s x t j 2 y j s y t j 2 s more details about the parametric spline and the algorithms to solve this optimization problem can be found in dierckx 1982 4 real case study 4 1 data source the ais data used in this study covers the whole singapore strait and the port waters the data is stored in two databases one contains the ship movement data with the format maritime mobile service identity mmsi vessel position time speed course draught cargo destination short safety message and etc this database has more than 0 1 billion records of the ship navigation information occurred in october 2013 in this ais database the time field is stored in text type with the utc coordinated universal time time format which is converted to unix time stamp for ship trajectory reconstruction another database contains the characteristics of 70 509 ships including maritime mobile service identity number type of vessel length beam and etc in this paper we focus on the port area and the frequency of the ais data is very high the ais database is supplied by the maritime and port authority of singapore and the average transmission period of the ais data is 22 41s it can be seen that the ais data frequency in singapore port waters is very high moreover when the time interval is larger than a threshold namely 5 min in this study we consider the ship trajectory as missing and do not conduct trajectory reconstruction in this situation we split the ship trajectory into two segments 4 2 calculation results to compare the performance of the proposed model we compared with the other three filtering models namely linear regression model polynomial regression model and weighted polynomial regression model these models have been used for vehicle trajectory reconstruction and the details can be found in the literature the weight polynomial method improves the polynomial regression model by setting larger weight on the points near to the time instance for interpolation some more complex weighted models are developed for data filtering to solve the sampling bias problems qu et al 2015 qu et al 2017 in this paper the data sampling bias is not a serious problem as the high and stable frequency for one ship in the same state as introduced in the previous section it should be also noted that in this study we filter the position of longitude and latitude separately which is different from the vehicle trajectory reconstruction the performance of the polynomial regression and the weighted polynomial regression depends on the number n of the neighbor points in this study we tested the number of 5 10 and 15 for the 3 degree polynomial function fig 4 shows the reconstructed trajectory of a small vessel with the mmsi of 563021460 which is a pilot ship belonged to psa corporation limited company in singapore the maximum speed and length of the vessel are 13 knots and 14 m respectively in fig 4 it could be easily found that the proposed model can construct a smoother trajectory compared with the other 7 models for the closed ship trajectory segment marked with the dashed circle shown in fig 4 a only the proposed model can fit a smooth trajectory we can also see that with a larger number of neighbor point n both the polynomial regression and the weighted polynomial regression model give a smoother trajectory however for some part of the trajectory the errors seem to be enlarged such as the trajectory marked with the dashed circle in fig 4 b in other words these two regression models decrease the ais data quality for some part of the ship trajectory in perspective of error enlargement the linear regression model seems better than the polynomial regression model and the weighted polynomial regression model to test the performance of the model for the trajectory of large ships in different navigational states we apply the models to a large bulk carrier ship with the mmsi of 417222311 the gross tonnage length draught and deadweight of this ship are 11315 tons 139 m 9 3 m and 18433 tons respectively fig 5 a and b illustrate its trajectory in different navigational states firstly the ship keeps static in the berthing area then it moves out of the berth with the help of the tug slowly successively it enters into the normal speed navigational states and makes a right turn fig 6 a l shows the performance of different models in respective of the vessel speed acceleration and change of course it can be seen from fig 6 a d that only the proposed model can reconstruct a trajectory with reasonable speed it should be noted that the vessel speed over 10 knots are not reasonable because the vessel speed is usually below 10 knots in singapore port water there is also a speed limit of 12 knots in singapore strait for the large ships in perspective of vessel acceleration both of the polynomial regression model and the proposed multi regime model perform better than the linear regression model the acceleration calculated from the reconstructed trajectory seems more reasonable that the raw ais data lastly we check the course of ground calculated from the different models as shown in fig 6 i l we can see that all the models except the proposed model lose the vessel movement features in fig 5 l we can clearly see that the vessel makes a big right turn to further evaluate the performance of the proposed model we test the models using a larger database which contains more than 500 different ships in singapore port water area on october 10 2013 the ais dataset quality indicators are shown in table 2 we can see that all the models can improve the quality of the trajectory in terms of these indicators the multi regime model performs best in terms of the ais data quality indicators in perspective of vessel speed the proposed model and weighted polynomial regression model perform best while the proposed model and linear regression model are better than the others in terms of rot within all the models only the proposed model works well in terms of the abnormal jerk 5 conclusions in this paper we proposed a multi regime vessel trajectory reconstruction model which includes three steps namely i outliers removal ii ship navigation state estimation and iii vessel trajectory fitting this model can reconstruct the vessel trajectory in different navigational states including hoteling maneuvering and normal speed sailing the normal speed navigation trajectory is estimated with a spline model which can fit any types of trajectory even with circles then the proposed model is tested and compared with other three popular trajectory reconstruction models based on a large ais dataset containing the movement of more than 500 ships in singapore port the results show that the proposed model performs significantly better than the other models including linear regression model polynomial regression model and the weighted regression model the proposed model can decrease the abnormal rate of speed acceleration jerk and rot from 43 42 10 65 59 25 50 33 0 00 0 00 17 28 and 15 81 respectively this indicates that the proposed trajectory can eliminate the noise in the raw ais data quite well more importantly the navigation behavior such as turning operation which is extremely important in risk study could be clearly shown in the filtered data which can be used for navigation behavior study acknowledgments this research is funded by the agency for science technology and research a star and fujitsu limited as part of the a star fujitsu smu urban computing and engineering centre of excellence ihpc 16 201504 the second author would like to appreciate the support from the project impact analysis of large ships on ship traffic in the straits of malacca and singapore smi 2015 ma 03 for this study 
23366,ais data plays an increasingly important role in collision avoidance risk evaluation and navigation behavior study however the raw ais data contains noise that can result in wrong conclusions we propose a multi regime vessel trajectory reconstruction model through three steps processing including i outliers removal ii ship navigational state estimation and iii vessel trajectory fitting this model allows for vessel trajectory reconstruction in different navigation states namely hoteling maneuvering and normal speed sailing the normal speed navigation trajectory is estimated with a spline model which can fit any types of the trajectory even with circles then the proposed model is tested and compared with other three popular trajectory reconstruction models based on a large ais dataset containing the movement of more than 500 ships in singapore port the results show that the proposed model performs significantly better than the linear regression model polynomial regression model and weighted regression model the proposed model can decrease the abnormal rate of speed acceleration jerk and rot rate of turn from 43 42 10 65 59 25 50 33 0 00 0 00 17 28 and 15 81 respectively more importantly the navigational behavior such as turning operation could be clearly shown in the trajectory reconstructed by the proposed model keywords automatic identification system ais data filtering trajectory reconstruction trajectory estimation 1 introduction automatic identification system ais is an automatic ship self reporting system used for the maritime transportation safety purpose the ais system broadcasts the vessel sailing status information such as the position speed loading status which can be received by the other ships or vessel traffic service vts centers harati mokhtari et al 2007 according to the safety of life at sea solas of the international maritime organization imo ais is mandatory for the international voyaging ships with gross tonnage gt more than 300 and all passenger ships as its wide application in the shipping industry ais data have become increasingly important for the navigational safety and maritime traffic management szlapczynski and szlapczynska 2016 wang and chin 2016 xiao et al 2015 zhang et al 2016 vessel trajectory information indicated by the ais data is one of the most important data sources for ship collision study first with real time ais data a vessel can track the movement of the neighbor vessels and use the collision avoidance decision making models to improve the navigational safety li et al 2012 mazaheri et al 2016 for example su et al developed a fuzzy logic theory based system using ais data to optimize the rudder steering decision for the give way ship su et al 2012 moreover the historical ais data is useful for vessels movement analytics and collision risk evaluation for instance mou et al investigated the actual behavior of collision involved ships off the rotterdam port in europe and analyzed the vessel collision using the ais data mou et al 2010 weng et al evaluated the vessel collision frequency in singapore strait by calculating the product of the vessel conflicts number and the causation probability using the real time vessel movement data from the lloyd s marine intelligence unit lloyd s miu database weng et al 2012 more recently ais data are used to predict the vessel trajectory for the maritime safety management using the machine learning methods borkowski 2017 shangbo mao et al 2016 for example borkowski 2017 developed a trajectory prediction model using multiple neural networks learning from the maritime fusion data all these applications depend on the accurate vessel trajectory information from the ais data the quality of the ais data depends on the ais equipment the navigational state of the vessel and ais message receiver base station lapinski and isenor 2011 there are two types of shipborne ais equipment namely class a and class b ais equipment class a ais equipment is usually installed in the international cargo ships and passenger ships while class b ais equipment is mainly installed in the inland waterway ships xiao et al 2015 the class a ais equipment is usually more expensive and has higher accuracy compared with the class b ais equipment the accuracy of the ais data also depends on the location of the ais message receiver base stations which affects the ais message signal coverage lapinski and isenor 2011 the navigational state also affects the ais data quality more specifically the ais data from the vessels in the port waters have a higher time resolution than that of the ships in the open sea lapinski and isenor 2011 a number of works have been reported for the accuracy evaluation of ais data for example harati mokhtari et al investigated the ais errors considering the navigational states and found that 30 of ships were displayed incorrectly harati mokhtari et al 2007 just as the gps data the ais data is also suffered from the data noise of position information this can be illustrated by an example of a vessel sailing in the singapore port on october 11 2013 as shown in fig 1 it can be seen in the zoom window that the trajectory of the vessel is zigzag caused by the noise data which should be a smooth curve according to the mechanisms of movement if this kind of data with noise is used for grounding risk evaluation or the vessel navigation behavior study which depends on high accurate trajectory data will result in wrong conclusions thus there is a need to quantify the quality of the ais dataset and reconstruct the real ship trajectory based on the sampling vessel position information with noise from the ais data very few attempts in the literature review have been conducted for the ais data noise elimination and vessel trajectory reconstruction based on the ais data qu et al presented a data cleansing procedure to eliminate the noises and update those inaccurate records according to newton s laws of motion qu et al 2011 more specifically the traffic speed can be calculated based on the ais trajectory which is then used as an indicator of the ais data accuracy by checking whether it is inconsistent with the maneuverability of the vessel the interpolation method can also be used for data noise elimination such as the linear interpolation model presented in zhang et al 2015 a more complex model was developed by liu and chen to complete the course vessel route in the open water area using the position speed course over ground and time stamp information liu and chen 2013 sang et al presented a method to restore the vessel trajectory by a curve fitting method for the inland waterway ships sang et al 2015 in conclusion a quantitative method to evaluate the quality of the ais data set is still missing in the existing literature moreover few studies focus on the vessel in the constrained port water areas concerning different navigational states such as hoteling maneuvering with the help of tug ships and normal speed sailing furthermore the existing curve fitting methods are not suitable for the trajectories with closed segments or circles to fill the aforementioned research gaps we propose a multi regime vessel trajectory reconstruction model for ships in port waters in the proposed model firstly the ais noise data point is detected and eliminated using a quantitative ais data evaluation method by checking the vessel speed acceleration cog course of ground change rate and acceleration change rate then the vessel trajectory is estimated for different navigation statuses by linear regression and b spline filtering model the contribution of this study is two fold first we present a quantitative approach to evaluate the quality of the ais dataset second we propose a multi regime vessel trajectory reconstruction model which can handle the vessel trajectories in port waters which are composed of different navigation status more importantly the proposed model performs significantly better than several existing trajectory filtering models based on the real case studies 2 vessel trajectory noise in ais data 2 1 ship positioning error the position of the ship is estimated by the positioning system such as gps global positioning system dgps differential global positioning system or loran c long range navigation harati mokhtari et al 2007 lapinski and isenor 2011 the positioning system allows the position of a receiver to be estimated in cartesian coordinates x and y in the word geodetic system 84 reference system the gps position data contains errors caused by many factors such as atmospheric effects clock inaccuracies and rounding errors hong et al 2004 suppose p i x i y j is the true position of the ship at time instant i δ x i g μ x i σ x i 2 and δ y i g μ y i σ y i 2 the components of the measurement error along x and y direction where g represents the generic distribution the observed position will therefore be p i o b s x i δ x i y i δ y i the measurement error is calculated by 1 δ i x i x i δ x i 2 y i y i δ y i 2 δ x i 2 δ y i 2 2 2 ais data quality indicator with the ais data we can calculate the vessel speed acceleration and the jerk change rate of the acceleration moreover the rot rate of turn is another indicator which could be calculated based the ship trajectory these values are constrained by the maneuverability of the vessel when there are inaccurate data in the ais data the calculated indicators would be abnormal which could be considered as the evidence of the ais quality it should be noted that the term abnormal refers to the low frequency very high measurement errors and not the random errors this can be further elaborated by fig 2 which shows the vessel speed acceleration and jerk it can be clearly seen that these values vary greatly and some values seem quite abnormal for example in fig 2 b a large number of the vessel speed values are above 30 knots some of which are even exceed 200 knots which may be caused by the data noise 2 2 1 abnormal speed the ship characteristic database contains the maximum speed v m a x k of the individual ship k thus the percentage of the abnormal vessel speed i v p v i j k 1 v m a x j indicts the quality of the ais database where v i j is the speed of vessel j at time instance i and k 1 is the parameter which has the default value of one by this way we can remove the very high measurement errors which conflict with the maneuverability of the ship the larger of the k 1 is the higher measurement errors will be removed 2 2 2 abnormal rot in the constrained water the maximum rot of the ship depends on the vessel speed and the vessel length which is calculated by the formula wu 1999 2 max r o t i j v i j δ t 2 l j where v i j is the speed of vessel j from time instance i to i 1 l j is the length of vessel j δ t is the time interval between time instance i to time instance i 1 the percentage of the rot which exceeds its maximum value also indicates the ais data quality 2 2 3 abnormal acceleration the vessel acceleration is affected by a lot of factors such as ship type wave condition and load factors acanfora et al 2017 fig 3 d shows the vessel acceleration based on the ais of ships in singapore port water october 2013 which will be introduced in the following sections we can see that 73 08 of the values are within 1 1 and only a small percentage of the acceleration values are above 15 knots thus unfeasible extreme values or an anomalous shape of the distribution are clear indications of problems in the ais data 2 2 4 abnormal jerk apart from the distribution of the acceleration values their temporal variation also gives an important indication of ais data quality which is measured by the jerking factor namely the derivative of the acceleration the jerking factor should not be an extremely high value as the comfortable values for the human usually do not exceed 2 m s 3 marczak and buisson 2012 for the vehicles the jerking factor is usually within 15 m s 3 in this paper the percentage of the observations with jerk values higher than the threshold of 15 m s 3 is used as another data quality indicator 3 methodology filtering technologies have been used for trajectory data processing which could remove the unwanted components or features such as noise due to the measurement error and keep the real data dynamics a number of models have been developed for the vehicle trajectory reconstruction such as the moving average model polynomial regression model weighted polynomial regression model i spline filtering ossen and hoogendoorn 2008 punzo and simonelli 2005 toledo et al 2007 however these models cannot be used for ship trajectory reconstruction directly for two reasons first the vehicle trajectory is represented by the one dimension linear referencing coordinate system because the vehicle travels along the lane of the road however in the maritime traffic the ship can navigate freely in the water and the trajectory is represented by a two dimension coordinate system which can contain circles moreover the movement features of the ships are totally different from that of the ships which may include hoteling maneuvering with the help of the tug ships and normal speed sailing according to the maneuverability feature of the ship we developed a multi regime vessel trajectory reconstruction model and compared it with the other popular models including linear regression model polynomial regression model and weighted polynomial regression model which have been developed for the vehicle trajectory processing the proposed model is composed of three steps 1 the first step aims at removing the extreme positional errors according to the ais data quality indicators presented in section 2 2 in the second step the navigational states of the vessel are estimated based on the ship activity analysis which is divided into three categories namely hoteling maneuvering and normal speed sailing 3 the last step is curve fitting for the vessel trajectory 3 1 step 1 outliers removal in this step we only used vessel speed and rot to identify the outliers although the acceleration and the jerking factor can also act as the ais data quality indicators it is quite difficult to give the determinate threshold values for different type of ships this is different from the vehicles in the urban traffic which have similar characteristics such as speed and acceleration for example in the urban traffic the threshold for the vehicle acceleration is set to 5 m s2 for acceleration and 8 m s2 for deceleration marczak and buisson 2012 in the maritime traffic the threshold values for different types of ships would vary greatly the maximum values of the vessel speed and rot could be determined for the specific vessel it should be noted that in this step we capture only the very high measurement errors and not the random error component 3 2 step 2 ship navigational state estimation the trajectories of a ship fleet can be described by a set j j i j i i 1 2 m where j i is the trajectory of the ship i and m is the number of ships the trajectory of ship i is defined as 3 j i p i k p i k t k x i k y i k u i k t k 1 2 n where k is the time instance index n is the total number of time intervals during the analysis period and p i k is the state vector of the ship i at time t k for the state vector x i k and y i k are the coordinates of the ship i at time t k and u i k is the speed of ship i at time t k the activity chain of a ship generally includes three types of activities namely hoteling maneuvering and normal speed sailing the journey of a ship is one trip from one maritime traffic zone mtaz to another traffic zone in the hoteling states the ship is usually fixed with cables to receive services such as loading goods unloading goods waiting in anchorages replenishing food water and energy or others thus the activity chain of the ship i can be defined by a set a i t i s i where t i represents the trips of the ship i and s i denotes the hoteling state of the ship i to receive service the set t i is defined by t i j i t 1 j t 2 j j 1 2 n t i where n t i is the number of trips of ship i and j is trip index j i t 1 j t 2 j is the j t h trip of ship i between time t 1 and t 2 which is defined by 4 j i t 1 j t 2 j p i k t 1 j k t 2 j where t 1 j and t 2 j are the start time and end time of a trip respectively thus the start position and end position of the trip are x i t 1 j y i t 1 j and x i t 2 j y i t 2 j similarly s i can be defined by s i j i t 1 j t 2 j j 1 2 n s i where n s i is the total number of the receiving service activities of the ship i the states of ships in port waters is firstly divided into two types sailing for the purpose of movement and hoteling for the purpose of receiving services thus the activities of all ships can be defined by the set a a i a i t i s i i 1 2 n a where n a is the number of activities if the set of hoteling to receive service and sailing activities are denoted by s and t respectively we naturally have a t s the aim of activity chain analysis is to divide the ship trajectory into separated segments according to the differentiated activities specifically we split them into two sets t i and s i once s i is determined the trajectory of the ship i can be divided into t i and s i the corresponding time instances of s i are denoted as 5 t s t 1 i k t 2 i k j i t 1 k t 2 k s i k 1 2 n s i the set t s can be determined based on the following facts a while in the state of receiving service the ship moorings a traffic zone and keeps static for a certain long time b otherwise it is regarded as the sailing state the starting time of one servicing activity t 1 i k can be determined according to the following conditions 6 t 1 i k t 1 i k m e a n s p e e d j i t 1 k t 1 k τ z j u θ j i t 1 k t 1 k τ z j z z j k 1 2 n s i where τ z j is the lower bound of the time length during which the ships receive services in mtaz maritime traffic zone z j μ θ is the upper bound of the average speed to mark a non sailing ship m e a n s p e e d is the function to calculate the average speed of ship i between times t 1 k and t 1 k t z j z j is the mtaz with index of j n s i is the number of activities that receive services of ship i according to the ship speed analysis we set u θ 1 5 knots it should be noted that the mtaz is determined by the function of the water areas according to the nautical chart the most important parameter in analyzing ship activity chain is τ z j which depends on the service types for example the time of loading goods could be probably longer than 30 min and the waiting time in anchorage areas might be longer than 60 min or even lasts a few hours the service times of the ships in z i are denoted by t s z i t s i i 1 2 n and the minimum service time in mtaz z i is denoted as t s z i m i n then we set t z min t s z i min z i 1 2 if τ z j is too small some ship sailing states may be recognized as receiving service states thus the most crucial work of this method is to determine τ z j in this study we use an easily implemented experimental method to determine τ z j we increase t z from a small initial value and check the trip numbers in the study area when the number maintains stable the proper value for t z is determined according to the data analysis based on the ais in singapore port waters the number of trips starts keeping steady from 15mins namely t z 15 mins for certain type of large vessels such as container ships they need the help of the tug ships to move from the docks the movement characteristics are quite different from normal sailing activities because the large ships need to keep a minimum speed for the controllability purpose the sailing states with the speed below this minimum value would be the maneuvering state otherwise it is the normal speed sailing states the pseudocode of the trip extraction procedure is presented in table 1 firstly the ship trajectory is divided into small segments and in every small segment the ais points are located in a traffic zone or navigable water area the trajectory in the navigable water area is the route which can link two traffic zones however the trajectory within a traffic zone can also be the ship trajectory passing through this zone other than arrived in this zone for receiving service thus the trajectory passing through the traffic zone should be detected in the next step we iterate every ship trajectory segment and divide them into two states namely the sailing and hoteling if the ship trajectory segment is in the navigable water area the ship is under the sailing state if the ship trajectory is in the traffic zone the ship trajectory is divided into sailing and hoteling according to formula 6 it should be noted that it is possible that there are multiple sailing or hoteling ship trajectory segments in one traffic zone for example one ship enters the berth and then leaves the berth after unloading loading the cargo 3 3 step 3 vessel trajectory fitting once the trajectory is divided into different navigational states the trajectory is reconstructed using the following methods i hoteling during the berthing time or receiving service stage the ships would be fixed with the cable and thus the position should keep fixed however actually the ship should still move slightly caused by the wind and wave this slight movement would be very random which depends on the level and direction of the wave in this study we set the movement distance of the ships in the hoteling state to zero ii maneuvering in this stage the ship would move with the help of the tug ships and thus the ship trajectory would be different from that during the normal speed sailing according to a large amount of real data experiments we select the linear regression model to smooth the vessel trajectory as follows 7 x i t a 0 i a 1 i t i 8 y i t β 0 i b 1 i t i where a 0 i a 1 i b 0 i b 0 i are the parameters of the regression model at time instance i for the longitude x i and latitude y i the parameters are estimated using the least squares estimation based on the nearest n points within the time window in this study n is set to 3 and the time window width is set to 5 min iii normal speed navigation in the vehicle trajectory reconstruction the distance increase with the time which is a monotone increasing function however the ship trajectory is more complex than vehicle trajectory which may contain circles in the measure observations of the ship position x i y i i 1 2 m we need to find an arbitrary curve the condition x i x i 1 is not necessarily fulfilled thus the general curve fitting methods using for vehicle trajectory reconstruction are no longer applicable in this case we process a trajectory fitting model as follows first every data point x i y i is assigned with the corresponding time value t i which is monotone increasing then for the vessel trajectory between time span a b with a t i b we determine two spline functions 9 s x t i k n c x i m i k 1 t 10 s y t i k n c y i m i k 1 t of degree k 3 with knots a t 0 t 1 t n 1 b then the trajectory reconstruction becomes an optimization problem 11 min j 1 n s x k t j 0 s x k t j 0 2 s y k t j 0 s y k t j 0 2 subject to 12 j 1 m w j x j s x t j 2 y j s y t j 2 s more details about the parametric spline and the algorithms to solve this optimization problem can be found in dierckx 1982 4 real case study 4 1 data source the ais data used in this study covers the whole singapore strait and the port waters the data is stored in two databases one contains the ship movement data with the format maritime mobile service identity mmsi vessel position time speed course draught cargo destination short safety message and etc this database has more than 0 1 billion records of the ship navigation information occurred in october 2013 in this ais database the time field is stored in text type with the utc coordinated universal time time format which is converted to unix time stamp for ship trajectory reconstruction another database contains the characteristics of 70 509 ships including maritime mobile service identity number type of vessel length beam and etc in this paper we focus on the port area and the frequency of the ais data is very high the ais database is supplied by the maritime and port authority of singapore and the average transmission period of the ais data is 22 41s it can be seen that the ais data frequency in singapore port waters is very high moreover when the time interval is larger than a threshold namely 5 min in this study we consider the ship trajectory as missing and do not conduct trajectory reconstruction in this situation we split the ship trajectory into two segments 4 2 calculation results to compare the performance of the proposed model we compared with the other three filtering models namely linear regression model polynomial regression model and weighted polynomial regression model these models have been used for vehicle trajectory reconstruction and the details can be found in the literature the weight polynomial method improves the polynomial regression model by setting larger weight on the points near to the time instance for interpolation some more complex weighted models are developed for data filtering to solve the sampling bias problems qu et al 2015 qu et al 2017 in this paper the data sampling bias is not a serious problem as the high and stable frequency for one ship in the same state as introduced in the previous section it should be also noted that in this study we filter the position of longitude and latitude separately which is different from the vehicle trajectory reconstruction the performance of the polynomial regression and the weighted polynomial regression depends on the number n of the neighbor points in this study we tested the number of 5 10 and 15 for the 3 degree polynomial function fig 4 shows the reconstructed trajectory of a small vessel with the mmsi of 563021460 which is a pilot ship belonged to psa corporation limited company in singapore the maximum speed and length of the vessel are 13 knots and 14 m respectively in fig 4 it could be easily found that the proposed model can construct a smoother trajectory compared with the other 7 models for the closed ship trajectory segment marked with the dashed circle shown in fig 4 a only the proposed model can fit a smooth trajectory we can also see that with a larger number of neighbor point n both the polynomial regression and the weighted polynomial regression model give a smoother trajectory however for some part of the trajectory the errors seem to be enlarged such as the trajectory marked with the dashed circle in fig 4 b in other words these two regression models decrease the ais data quality for some part of the ship trajectory in perspective of error enlargement the linear regression model seems better than the polynomial regression model and the weighted polynomial regression model to test the performance of the model for the trajectory of large ships in different navigational states we apply the models to a large bulk carrier ship with the mmsi of 417222311 the gross tonnage length draught and deadweight of this ship are 11315 tons 139 m 9 3 m and 18433 tons respectively fig 5 a and b illustrate its trajectory in different navigational states firstly the ship keeps static in the berthing area then it moves out of the berth with the help of the tug slowly successively it enters into the normal speed navigational states and makes a right turn fig 6 a l shows the performance of different models in respective of the vessel speed acceleration and change of course it can be seen from fig 6 a d that only the proposed model can reconstruct a trajectory with reasonable speed it should be noted that the vessel speed over 10 knots are not reasonable because the vessel speed is usually below 10 knots in singapore port water there is also a speed limit of 12 knots in singapore strait for the large ships in perspective of vessel acceleration both of the polynomial regression model and the proposed multi regime model perform better than the linear regression model the acceleration calculated from the reconstructed trajectory seems more reasonable that the raw ais data lastly we check the course of ground calculated from the different models as shown in fig 6 i l we can see that all the models except the proposed model lose the vessel movement features in fig 5 l we can clearly see that the vessel makes a big right turn to further evaluate the performance of the proposed model we test the models using a larger database which contains more than 500 different ships in singapore port water area on october 10 2013 the ais dataset quality indicators are shown in table 2 we can see that all the models can improve the quality of the trajectory in terms of these indicators the multi regime model performs best in terms of the ais data quality indicators in perspective of vessel speed the proposed model and weighted polynomial regression model perform best while the proposed model and linear regression model are better than the others in terms of rot within all the models only the proposed model works well in terms of the abnormal jerk 5 conclusions in this paper we proposed a multi regime vessel trajectory reconstruction model which includes three steps namely i outliers removal ii ship navigation state estimation and iii vessel trajectory fitting this model can reconstruct the vessel trajectory in different navigational states including hoteling maneuvering and normal speed sailing the normal speed navigation trajectory is estimated with a spline model which can fit any types of trajectory even with circles then the proposed model is tested and compared with other three popular trajectory reconstruction models based on a large ais dataset containing the movement of more than 500 ships in singapore port the results show that the proposed model performs significantly better than the other models including linear regression model polynomial regression model and the weighted regression model the proposed model can decrease the abnormal rate of speed acceleration jerk and rot from 43 42 10 65 59 25 50 33 0 00 0 00 17 28 and 15 81 respectively this indicates that the proposed trajectory can eliminate the noise in the raw ais data quite well more importantly the navigation behavior such as turning operation which is extremely important in risk study could be clearly shown in the filtered data which can be used for navigation behavior study acknowledgments this research is funded by the agency for science technology and research a star and fujitsu limited as part of the a star fujitsu smu urban computing and engineering centre of excellence ihpc 16 201504 the second author would like to appreciate the support from the project impact analysis of large ships on ship traffic in the straits of malacca and singapore smi 2015 ma 03 for this study 
23367,the hydrodynamic coefficients of the full scaled segment of an offshore fish cage collar are obtained experimentally and verified by numerical modeling the oscillation experiments are conducted under the attack angle of 90 in a custom developed flume so that the range of keulegan carpenter kc number is from 5 to 25 for numerical modeling this paper utilizes an overset mesh technique to solve the reynolds averaged navier stokes equation rans in the moving mesh region the free surface and the turbulence are described by volume of fluid vof method and shear stress transport sst k ω turbulence model respectively the results show that for the single pipe model of the floating collar in oscillating flow the drag coefficient decreases with the kc number increasing reaching approximately 0 5 with the increasing of the kc number the inertia coefficient reaches approximately 1 5 for the considered range of kc and reynolds re numbers for the double pipe specimen of the floating collars the hydrodynamic coefficient for the upstream pipe is almost identical to that of the single pipe model for the downstream pipe the hydrodynamic coefficient increases as the distance between the pipes increases the paper provides the empirical formulae for hydrodynamic coefficients as functions of kc number keywords hydrodynamic coefficients oscillating experiments overset mesh technique free surface wake effect 1 introduction the aquaculture fish cages deployed in ocean are often exposed to high energy waves and current environment as an important component of the gravity type fish cage the floating collar provides most of the buoyancy and serves as the most crucial structural component of the whole cage system the need to understand its hydrodynamic behavior and dynamic response has given rise to investigations by many scholars during last decade suhey and kim suhey et al 2005 investigated the nonlinear deformation of the floating collar with a modified beam theory after comparing the difference between horizontal force and vertical force acting on the floating collar the numerical results were in good agreement with the theoretical predictions structural investigation on the floating collar by experiments and finite element simulations was conducted by fredriksson et al 2007 a local failure criteria was employed to predict the critical load on the floating collar with the experimental error less than 16 a modelling of the floating collar utilizing the curved beam theory and the mode superposition method was performed in zhao et al 2015 to study the dynamic response of the floating collar the mode superposition method and the added mass approach were applied by endresen 2011 the results of fu and moan 2012 show that the dynamic response of the floating collar is influenced by the flexible bending and torsional modes as well as their interaction li et al 2014 used a scaled model with the ratio of 1 25 to investigate the dynamic response of the floating collar for different wave cases and found that the overtopping will happen when the wave is steep and that high order waves will cause vertical resonance of the circular cylinder kristiansen and faltinsen 2015 investigated the dynamic response of the floating collar with both experimental and numerical approaches they conducted the numerical sensitivity study and found that the mooring loads were not sensitive to the added mass of the floater and the nonlinear restoring loads the elastic deformation of the floating collar under wave loading was studied in dong et al 2010 and huang et al 2016 even though many scholars have investigated the floating collar with various approaches most of their investigations only focused on structural analysis and dynamic response the overall hydrodynamic behavior of the floating collar is not completely understood if we divide the floating collar into several segments under the assumption that each segment is rigid then each segment can be regarded as partially submerged cylinder as early as 1949 ursell applied the ideal flow theory to investigate the partially submerged circular cylinder with analytical approach see ursell 1949 and yu and ursell 1961 in 1950 morison et al 1950 proposed an empirical formula to investigate the force induced by surface wave exerted on a vertical pile since the equation is easy to use it s been extensively utilized to calculate the hydrodynamic force on the cylinder however to apply morison equation to particular structures their hydrodynamic coefficients namely drag coefficient cd and inertia coefficient cm must be known which can be obtained from either physical or numerical experiments initially the experiments concentrated on vertical cylinders with small scale until sarpkaya got the drag and inertia coefficients of a submerged horizontal cylinder by the morison equation see sarpkaya 1976 he found that the hydrodynamic coefficients are the function of the keulegan carpenter kc number and reynolds re number dixon took the effect of the free surface into consideration dixon 1980 to investigate the interaction between wave and the partially submerged horizontal cylinder from then on the free surface was taken into account as a factor to get more accurate hydrodynamic coefficients and calculate the hydrodynamic force with morison equation following dixon s principle the circular cylinder and the rectangle cylinder in partially submerged situation were simulated by chen et al 2015 the hydrodynamic force obtained by them show that the modified morrison equation underestimated the wave forces li et al 2007 used the morison equation to determine the normal and tangential coefficients of a segment of the floating pipe in waves to predict the hydrodynamic behavior of the gravity cage system hydrodynamic behavior of partially submerged horizontal cylinders was numerically investigated in chen et al 2016 loh et al 2018 and qu et al 2017 loh et al 2018 performed 2d numerical simulations of semi immersed cylinder focusing on oscillating heave motion chen et al 2016 considered double cylinder arrangement for wave energy device through 2d numerical wave flume model qu et al 2017 conducted 3d numerical simulation of a solitary tsunami like wave passing over horizontal cylinders and determined the hydrodynamic forces and vorticity fields behind the cylinders in this study we investigate the partially submerged segments of the floating collar in steady and oscillating flow we apply both numerical modeling and experimental approaches in numerical simulations we employ an overset mesh technique to solve the reynolds averaged navier stokes equation and the vof approach to represent the free surface the physical experiments are conducted on the full scale segments of the floating collar consisting from single and double pipes special considering will be taken for the effect of the gap between the inner and outer pipes of the floating collar they are used to calculate the sets of hydrodynamic coefficients c d and c m as functions of kc and re numbers for various collar segment geometries and current wave loading conditions the results are provided as tables and graphs convenient for design and analysis applications of fish farm ocean energy and other marine structures we also propose a set of simple empirical formulae to predict the hydrodynamic coefficients based on the kc number values 2 experiments we investigated a segment of the full scaled fish cage floating collar by performing towing and oscillation experiments the segment of the floating collar is shown in fig 1 2 1 parameters of the model the floating collar of a typical fish cage of gravity type is about 60 m in circumference with pipes of 0 11 m in diameter see fao 2015 the pipes are made of hdpe and fixed together by brackets several commonly used bracket designs are shown in fig 2 for experimental studies the specimens of actual diameter d 0 11 m and the length l 0 7 m were utilized see table 1 for the complete set of model parameters the parameters of the model are shown in table 1 four different models were tested to evaluate their hydrodynamic performance under steady and oscillating flow model 1 single segment of a floating collar model 2 double segment with the gap 0 5d between the pipes model 3 double segment with the gap d between the pipes model 4 double segment with the gap 1 5d between the pipes the models are depicted in fig 3 2 2 experimental setup the forced oscillation installation used for present research consists of a custom developed flume tank a dynamometer with sensors omega a data acquisition device omega and a control system custom developed the dimensions of the flume tank are 3 m length 1 m width 1 m height the movement platform of the oscillating device uses a linear servo system with two guide rails so that the connecting rods holding the model slide back and forth along the guide rails the horizontal moving distance is 2 m and the vertical moving distance is 1 m we use linear servo system made by mitsubishi electric to produce sinusoidal movement in horizontal direction to model the oscillating flow for oscillating flow in larger amplitude situation to avoid overring the torque of the motor due to larger acceleration we choose the oscillating period of not less than 3 s this limitation is also important to not exceed the range of the torque of the sensors due to the bending moment induced by the inertia of the model the picture of the actual device is shown in fig 4 when the pipe is perpendicular to flow direction and forced to do the harmonic motion the motion can be described as x t a s i n 2 π f t where x is the horizontal position of the pipe a and f are the amplitude and frequency of the oscillation flow respectively the wave absorber in the end of the flume is used to eliminate the reflection waves besides two baffles the dashed lines in fig 4 with the diameter of 3d are placed in the ends of the model to prevent the effect of vertical rails on fluid field 2 3 data processing the experimental results are obtained as a time history of the voltage signal from sensors of the dynamometer these voltage signals are transferred to the force signals however there are some undesired noises due to the transient effect dring the first 2 s there is also certain higher frequency noise in the signals due to the interference of the servo system the motors and the sensors therefore the filtering processing is conducted for the force signals as described in islam et al 2016 fig 5 presents the flow chart of the data processing to account for the inertia of the tested models and the connecting frame the inertia force is deducted to improve the accuracy of the tests while extracting the horizontal force and the hydrodynamic coefficients of the model 2 4 calibration for the dry model inertia the inertia of the tested system consists of the dry model inertia in the absence of fluid load and the contribution of the fluid that has to be evaluated by the experiment in order to eliminate the effect the dry model inertia we tested the inertia forces of the tested model and the connecting rods in the air without any fluid load after comparing the inertia force of the model with fluid loads the model is exposed to water and without fluid loads the model is exposed to air we find that when the tested model is exposed to air the inertia force is about 50 of that exposed to water therefore all of the results hereafter provide the inertia without the dry model component 2 5 load cases of the experimental study the experimental load cases include steady flow and oscillating flow the steady flow was investigated by towing a single segment model 1 at speeds ranging from 0 1 m s to 0 6 m s with a step of 0 1 m s the oscillation flow was studied by forced oscillation experiments on all specimens models 1 4 the periods t and the amplitudes a of the oscillating motion are shown in table 2 together with the keulegan carpenter and reynolds numbers and the obtained values of hydrodynamic coefficients see section 5 in the studies the considered range of kc numbers is from 5 to 25 this is motivated by the observation of sarpkaya 2010 that it is extremely difficult to extract the drag force in the inertia dominated regime kc is less than 5 especially for the smaller cylinder 3 mathematical formulation and numerical approach 3 1 parameters of oscillating flow previous studies conducted on the floating pipe towed horizontally with steady and oscillating motion sarpkaya 1976 show that the horizontal force is affected by two parameters reynolds number sommerfeld 1908 and keulegan carpenter number keulegan 1958 in the steady flow condition reynolds number re can be defined as 1 r e ρ u d μ u d ν where ρ is the density of the fluid u is the velocity of the fluid with respect to the cylinder d is the diameter of the cylinder μ is the dynamic viscosity of the fluid and ν is the kinematic viscosity of the fluid on the other hand if the cylinder is towed in the oscillating flow then the keulegan carpenter number kc number needs to be taken into consideration kc number is also called the period parameter and it can be expressed as 2 k c u m a x t d where u m a x is the maximum velocity of the incoming oscillating flow t is the corresponding period in this paper the sinusoidal movement is reproduced therefore kc number is also given by 3 k c 2 π a m d where a m is the amplitude of the oscillation flow also in the oscillation flow the reynolds number can be expressed as 4 r e ρ u m a x d μ u m a x d ν 2 π a m d t ν 3 2 hydrodynamic force since morison et al 1950 proposed the empirical formula to predict the hydrodynamic force on a vertical pile under waves the so called morison equation is been widely used to calculate hydrodynamic forces on the cylinder in various shapes according to morison equation the force on a differential section of the vertical cylinder is expressed as 5 d f c m ρ π d 2 4 u t c d ρ d 2 u 2 d z where c m is the inertia coefficient c d is the drag coefficient u is the horizontal component of the orbital velocity in this paper we follow the principle of dixon et al 1979 who modified the morison equation to calculate the wave force on the partially submerged circular cylinder as follows 6 f x 1 2 c d ρ a x t u x u x c m ρ v t u x t 7 f y c m ρ v t u y t ρ g v t v 0 where f x and f y are the wave forces in horizontal and vertical directions respectively c d and c m are the drag and inertia coefficients a x t is the instantaneous wetted projected area in horizontal direction v t and v 0 are the instantaneous submerged volume and the initial volume u x and u x t are the velocity and acceleration of the fluid in horizontal direction 3 3 governing equations and turbulence model a computational fluid dynamics based scheme is used to solve the interaction between the flow and the cylinder in a numerical wave tank the governing equation behind the cfd used in this paper is reynolds averaged navier stokes equation the volume of fluid vof approach is employed to capture the free surface also we choose the sst k ω model as the turbulence model for the incompressible flow the reynolds averaged navier stokes rans equations may be written in cartesian form as follows 8 ρ t ρ u i x i 0 9 ρ u i t ρ u i u j x j p x i x j μ u i x j ρ u i u j where μ is the dynamic viscosity of the fluid p is the static pressure u i is the average velocity items for x y z u is the fluctuation velocity i j 1 2 3 x y z ρ u i u j is the reynolds stresses in our simulations we use the shear stress transport sst k ω model menter 1994 to model the reynolds stresses the equations are as follows 10 ρ k t x i ρ k u i x j γ k k x j g k y k s k 11 ρ ω t x i ρ ω u i x j γ ω ω x j g ω y ω d ω s ω where k is the turbulent kinetic energy ω is dissipation rate g k is the generation of turbulence kinetic energy due to mean velocity gradient g ω is the generation of ω γ k and γ ω are the effective diffusivity of k and ω respectively y k and y ω are the dissipation of k and ω due to turbulence d ω is the cross diffusion term s k and s ω are self defined source terms 3 4 modeling approach we use the cfd software star ccm cd adapco 2014 to simulate a rigid segment of the floating collar under steady and oscillating flow with the attack angle of 90 the hydrodynamic coefficients obtained numerically are then compared with the experimental results the numerical wave tank is developed to calculate the hydrodynamic forces under different loading cases the non dimensional computational domain utilizes the symmetry of the problem and is set as 50d length 20d width 20d height for the model as shown in fig 6 to capture the variation of the free surface the upper portion of the domain contains the lighter fluid air and the lower portion of the domain contains the heavier fluid water the model is assigned the velocity inlet on top bottom and inlet sides of the computational domain and the pressure outlet boundary conditions on the outlet for both air and water see fig 6 in order to produce a high quality mesh for the oscillating cylinder the overset mesh technique is used and then a prism layer mesh is formed based on the surface mesh the domain is divided into the background region and the overset region this overset region is completely surrounded by the background region both regions are meshed separately there will be a zone where cells from both regions overlap with each other this overlapping zone changes if the overset body moves an overset mesh interface is created between the two regions information is transitioned from one region to another through the overlapping cells the flow chart of the overset mesh technique is shown in fig 7 the size of the free surface and the background mesh is 0 008 m the mesh around the cylinder is 0 005 m the overlapping mesh is 0 002 m with this set up we get the numbers of the background cells and the overlapping cells are 1495800 and 790886 respectively therefore the total number of the cells is 2286686 the mesh for different parts of the computational domain is shown in fig 8 4 numerical results in steady flow 4 1 single segment of the floating collar with different level of submergence numerical simulations produce the overall horizontal force that can be used to calculate the drag under steady flow the drag coefficient is extracted from the force utilizing morison s equation 6 in the absence of the inertia term fig 9 illustrates the drag coefficient changing with the submergence as function of reynolds number dixon et al 1979 reported that the drag coefficient c d and the inertia coefficient c m are influenced by reynolds number except in a higher range that re 2 10 5 that s the reason we illustrate the dependence between hydrodynamic coefficients and reynolds number in this paper from fig 9 we see that the drag coefficient decreases with the increase of reynolds number when the model is semi submerged and reynolds number is in the range of 10000 30000 the drag coefficient decreases and then keeps stable when the reynolds number is 40000 and higher when the segment of the floating collar is 3 4 submerged in the water the drag coefficient also decreases sharply when reynolds number is from 10000 to 40000 and the then decrease is more moderate comparing with the half submerged situation the drag coefficient is greater but with the increasing reynolds number the difference becomes smaller due to the rise of the free surface also known as overtopping in the cfd simulation the overtopping happens when the flow velocity is approaching 0 8 0 9 m s for the 3 4 submergence of the model observations show that the overtopping is followed by the vortices immediately behind the cylinder 4 2 comparison of numerical and experimental results comparison of numerical and experimental results for 1 2 submerged segment shows that the drag coefficients obtained from the experiments are slightly higher than those from the numerical simulations see fig 10 the difference calculated as c d n u m c d e x p c d e x p 100 varies from 3 4 to 7 4 note that the same behavior of sharp decrease followed by steady region is observed in both numerical and experimental tests 5 single segment in oscillating flow 5 1 hydrodynamic coefficients in oscillating flow when processing the experimental results for oscillating flow only the first 15 s of test were used because the rest of the data was influenced by the reflection of the waves from the flume walls the time history of the hydrodynamic force measured in the experiments was combined with the morison equation 6 to extract the hydrodynamic coefficients the experimental and numerical values of the drag coefficients cd and the inertia coefficients cm are compared in table 2 the magnitude of the difference between the corresponding experimental and numerical results is shown as err in the table note that since all of the segments models 1 4 are subjected to forced oscillation in still water the froude krylov force on the oscillating cylinders is zero therefore the inertia coefficient here is equal to the added mass coefficient however if the cylinder is fixed and the flow is oscillating then the inertia coefficient is c m 1 c a where c a is the added mass coefficient based on the data reported in table 2 there are some jumps when considering magnitude of the difference for the inertia coefficient the highest magnitude of difference happens when kc number reaches around 12 when kc number is less than 12 the dominating force is inertia force for the drag coefficient the magnitude of the difference is consistently on the order of 0 2 0 3 this significant difference was expected because of the small size of the flume tank used in the experimental studies however the overall trends appear to make physical sense in most of the cases the drag and inertia coefficients extracted from the experiments in the constrained flume tank are greater than their numerical estimates the graphical representation of these results provides information on the trends in dependence of the hydrodynamic coefficients on kc and reynolds numbers see figs 11 14 from fig 11 we see that the inflection point in the inertia coefficient appears when the kc number reaches around 8 as kc number increases the inertia coefficient for all values of re desreases to approximately 0 5 at kc 8 and then increases to almost 1 5 for kc 25 the drag coefficient decreases smoothly with the increase of kc for all considered values of re number as evident from fig 12 the numerical values of cd reduce from cd 1 6 to cd 0 4 there is no such an established pattern in the dependence of cm on the reynolds number as can be seen in fig 13 the only obvious observation is that similarly to all other dependencies the experimental results slightly over predict numerical estimates of cm for almost all values of kc fig 14 illustrates that the drag coefficient cd in oscillating flow of partially submerged cylinder reduces with the increase of re number as expected the flow undergoes a laminar separation when the re is small then the turbulence separation occurs to form the wake and this wake induces the reduction of the drag force this is consistent with the results available for the submerged cylinders under current only loading see decew et al 2010 experiments conducted by sarpkaya 2006 show that the separation of the flow is three dimensional but the separation point is hard to be predicted because of the insufficient understanding of the near wake 5 2 free surface effects the tests show when the kc number is higher than 12 in oscillating flow the free surface around the segment declines this lowering of free surface coincides with the reduction in drag force as observed in the experiments the declination of the free surface is shown in fig 15 at the moment when the acceleration of the floating collar is reaching its maximum value in oscillating flow we observe the climbing of the free surface with the rise of the free surface the force acting on the floating collar also increases especially the inertia force we used the vof method to capture the free surface in the cfd scheme and the visualized image of the climbing of the free surface is shown in fig 16 good correspondence of the cfd simulations and experimental observations for the variations in free surface is observed thus differently from the completely submerged horizontal cylinder the variation of the free surface for the partially submerged floating collar should be included in the analysis since it significantly influences the calculation results for the hydrodynamic force 6 double pipe segment in oscillating flow 6 1 hydrodynamic coefficients in oscillating flow in this section we focus on the effect of the distance between two pipes of the double pipe segment different from the investigation of sarpkaya 1985 zdravkovich 1977 and zhao and cheng 2012 this study deals with the horizontal cylinders with tandem arrangement figs 17 20 present the hydrodynamic coefficients for all of the considered models for the segment of the floating collar g is the gap between the external surfaces of the pipes for all considered re numbers the downstream pipe has no effect on the upstream one therefore the hydrodynamic coefficients of the upstream pipe are almost cosntant and nearly identical to the single pipe model for the downstream pipe when the kc number is less than 8 the drag coefficient is larger than 1 for all of the considered models and re numbers however with the increasing of the kc number from 8 to 25 the drag coefficient slightly decreases and stays around 0 5 in terms of the distance effect the results show that the inertia coefficient of the downstream pipe is increasing with the increasing distance between the pipes in the double segment the averaged increase is 22 2 from model 2 to model 3 and 20 1 from model 3 to model 4 the drag coefficient of the downstream pipe in the double segment is greater than that of the single segment for the range of the considered kc numbers but also as the distance increases the drag coefficient of the downstream pipe from model 2 to model 4 increases as well the averaged increase is 10 5 from model 2 to model 3 and 6 2 from model 3 to model 4 see figs 17 20 thus to calculate the hydrodynamic force on the double piped floater with morison equation the hydrodynamic coefficients should be chosen accoding to the distance between the parallel pipes in the floater rather than choosing the empirical value obtained for a single floater under waves and current note that not all of the hydrodynamic coefficients for the downstream pipe are larger than those of the single segment when the distance g 0 5d due to the effect of the wake turbulence behind the upstream pipe the hydrodynamic coefficients of the downstream pipe are smaller than those of the single segment when the distance reaches a critical value the effect of the wake behind upstream pipe becomes weak and the hydrodynamic coefficients of the downstream pipe increase however the critical distance observed in this study is slightly different from the estimate of hoerner 1965 because the cylinders are deployed not vertically but horizontally it has also been shown experimentally that the critical distance depends on the re number thus the wake effect will never be negligible if the distance between two pipes in the floating collar is less than the critical value 6 2 the empirical formulae for the segments of the floating collar to describe the dependence of inertia and drag coefficients on kc number quantitatively we propose the empirical formulae based on experiments for the rigid segment of the floating collar under oscillating flow the attack angle is 90 and the kc number is in the range from 5 to 25 the empirical formulae of the hydrodynamic coefficients from model 2 to model 4 correspond to the downstream pipe of the specimen for model 1 12 c m 0 0005 k c 2 0 0631 k c 0 0579 13 c d 0 0016 k c 2 0 1022 k c 1 9604 for model 2 14 c m 0 001 k c 2 0 068 k c 0 048 15 c d 0 004 k c 2 0 198 k c 2 685 for model 3 16 c m 0 002 k c 2 0 101 k c 0 143 17 c d 0 004 k c 2 0 18 k c 2 685 for model 4 18 c m 0 001 k c 2 0 092 k c 0 119 19 c d 0 023 k c 1 7 7 conclusions the oscillating experiments have been conducted to investigate the hydrodynamic coefficients of the full scale floating collar segments consisting from single and double pipes the numerical simulations based on overset mesh technique and reynolds averaged navier stokes equations have been used to verify the experimental resutls the sst k ω model was chosen as the turbulence model and the vof method was utilized to capture the free surface variations a modified morison equation combined with the least square method was used to calculate the hydrodynamic coefficients based on the experimental data after comparing the cfd numerical simulation and the experimental results the conclusions are as follows i comparison of the hydrodynamic coefficients of the single segment and double pipe segment under oscillating flow shows that the inertia coefficient of the downstream pipe is greater than that of the single segment when the distance between two parallel pipes is 1 5d for double pipe segments the drag and the inertia coefficients of the downstream pipe are both increasing with the increase of the distance between two pipes the drag coefficent of the downstream pipe is greater than that of the single segment with the distance increasing to 1 5d the drag coefficient of downstream pipe reaches its maximum value among all of the segments ii from the oscillating experiments we observe that the rise and fall of the free surface around the partially sumberged floater causes the changes in the drag coefficients and the inertia coefficients the drag coefficient decreases with the lowering of the free surface the inertia coefficient increases with the increasing of the free surface the separation of the flow has also been predicted numerically the wake behind upstream pipe has significant effect on the hydrodynamic coefficients of the downstream pipe iii the cfd simulation results based on the overset mesh technique coupled with the vof method are underestimated than the experimental measurements we predicted both experimentally and numerically that the immersed projected area of the pipe has significant effect on the horizontal force as an adapted mesh approach this overset mesh technique could be used to predict the hydrodynamic behaviors of two or three horizontal cylinders with tandem arrangement in different submergence iv the hydrodynamic coefficients and the empiricial formulae obtained from this study can be used to predict the hydrodynamic force of the single and double pipe floating collars or other partially submerged horizontal cylinders utilized in different ocean engineering applications acknowledgement this work is supported by national natural science foundation of china nsfc with grant no 51679046 the support of the china scholarship council for zhijing xu visit to the computational mechanics laboratory at the university of new hampshire is also gratefully acknowledged 
23367,the hydrodynamic coefficients of the full scaled segment of an offshore fish cage collar are obtained experimentally and verified by numerical modeling the oscillation experiments are conducted under the attack angle of 90 in a custom developed flume so that the range of keulegan carpenter kc number is from 5 to 25 for numerical modeling this paper utilizes an overset mesh technique to solve the reynolds averaged navier stokes equation rans in the moving mesh region the free surface and the turbulence are described by volume of fluid vof method and shear stress transport sst k ω turbulence model respectively the results show that for the single pipe model of the floating collar in oscillating flow the drag coefficient decreases with the kc number increasing reaching approximately 0 5 with the increasing of the kc number the inertia coefficient reaches approximately 1 5 for the considered range of kc and reynolds re numbers for the double pipe specimen of the floating collars the hydrodynamic coefficient for the upstream pipe is almost identical to that of the single pipe model for the downstream pipe the hydrodynamic coefficient increases as the distance between the pipes increases the paper provides the empirical formulae for hydrodynamic coefficients as functions of kc number keywords hydrodynamic coefficients oscillating experiments overset mesh technique free surface wake effect 1 introduction the aquaculture fish cages deployed in ocean are often exposed to high energy waves and current environment as an important component of the gravity type fish cage the floating collar provides most of the buoyancy and serves as the most crucial structural component of the whole cage system the need to understand its hydrodynamic behavior and dynamic response has given rise to investigations by many scholars during last decade suhey and kim suhey et al 2005 investigated the nonlinear deformation of the floating collar with a modified beam theory after comparing the difference between horizontal force and vertical force acting on the floating collar the numerical results were in good agreement with the theoretical predictions structural investigation on the floating collar by experiments and finite element simulations was conducted by fredriksson et al 2007 a local failure criteria was employed to predict the critical load on the floating collar with the experimental error less than 16 a modelling of the floating collar utilizing the curved beam theory and the mode superposition method was performed in zhao et al 2015 to study the dynamic response of the floating collar the mode superposition method and the added mass approach were applied by endresen 2011 the results of fu and moan 2012 show that the dynamic response of the floating collar is influenced by the flexible bending and torsional modes as well as their interaction li et al 2014 used a scaled model with the ratio of 1 25 to investigate the dynamic response of the floating collar for different wave cases and found that the overtopping will happen when the wave is steep and that high order waves will cause vertical resonance of the circular cylinder kristiansen and faltinsen 2015 investigated the dynamic response of the floating collar with both experimental and numerical approaches they conducted the numerical sensitivity study and found that the mooring loads were not sensitive to the added mass of the floater and the nonlinear restoring loads the elastic deformation of the floating collar under wave loading was studied in dong et al 2010 and huang et al 2016 even though many scholars have investigated the floating collar with various approaches most of their investigations only focused on structural analysis and dynamic response the overall hydrodynamic behavior of the floating collar is not completely understood if we divide the floating collar into several segments under the assumption that each segment is rigid then each segment can be regarded as partially submerged cylinder as early as 1949 ursell applied the ideal flow theory to investigate the partially submerged circular cylinder with analytical approach see ursell 1949 and yu and ursell 1961 in 1950 morison et al 1950 proposed an empirical formula to investigate the force induced by surface wave exerted on a vertical pile since the equation is easy to use it s been extensively utilized to calculate the hydrodynamic force on the cylinder however to apply morison equation to particular structures their hydrodynamic coefficients namely drag coefficient cd and inertia coefficient cm must be known which can be obtained from either physical or numerical experiments initially the experiments concentrated on vertical cylinders with small scale until sarpkaya got the drag and inertia coefficients of a submerged horizontal cylinder by the morison equation see sarpkaya 1976 he found that the hydrodynamic coefficients are the function of the keulegan carpenter kc number and reynolds re number dixon took the effect of the free surface into consideration dixon 1980 to investigate the interaction between wave and the partially submerged horizontal cylinder from then on the free surface was taken into account as a factor to get more accurate hydrodynamic coefficients and calculate the hydrodynamic force with morison equation following dixon s principle the circular cylinder and the rectangle cylinder in partially submerged situation were simulated by chen et al 2015 the hydrodynamic force obtained by them show that the modified morrison equation underestimated the wave forces li et al 2007 used the morison equation to determine the normal and tangential coefficients of a segment of the floating pipe in waves to predict the hydrodynamic behavior of the gravity cage system hydrodynamic behavior of partially submerged horizontal cylinders was numerically investigated in chen et al 2016 loh et al 2018 and qu et al 2017 loh et al 2018 performed 2d numerical simulations of semi immersed cylinder focusing on oscillating heave motion chen et al 2016 considered double cylinder arrangement for wave energy device through 2d numerical wave flume model qu et al 2017 conducted 3d numerical simulation of a solitary tsunami like wave passing over horizontal cylinders and determined the hydrodynamic forces and vorticity fields behind the cylinders in this study we investigate the partially submerged segments of the floating collar in steady and oscillating flow we apply both numerical modeling and experimental approaches in numerical simulations we employ an overset mesh technique to solve the reynolds averaged navier stokes equation and the vof approach to represent the free surface the physical experiments are conducted on the full scale segments of the floating collar consisting from single and double pipes special considering will be taken for the effect of the gap between the inner and outer pipes of the floating collar they are used to calculate the sets of hydrodynamic coefficients c d and c m as functions of kc and re numbers for various collar segment geometries and current wave loading conditions the results are provided as tables and graphs convenient for design and analysis applications of fish farm ocean energy and other marine structures we also propose a set of simple empirical formulae to predict the hydrodynamic coefficients based on the kc number values 2 experiments we investigated a segment of the full scaled fish cage floating collar by performing towing and oscillation experiments the segment of the floating collar is shown in fig 1 2 1 parameters of the model the floating collar of a typical fish cage of gravity type is about 60 m in circumference with pipes of 0 11 m in diameter see fao 2015 the pipes are made of hdpe and fixed together by brackets several commonly used bracket designs are shown in fig 2 for experimental studies the specimens of actual diameter d 0 11 m and the length l 0 7 m were utilized see table 1 for the complete set of model parameters the parameters of the model are shown in table 1 four different models were tested to evaluate their hydrodynamic performance under steady and oscillating flow model 1 single segment of a floating collar model 2 double segment with the gap 0 5d between the pipes model 3 double segment with the gap d between the pipes model 4 double segment with the gap 1 5d between the pipes the models are depicted in fig 3 2 2 experimental setup the forced oscillation installation used for present research consists of a custom developed flume tank a dynamometer with sensors omega a data acquisition device omega and a control system custom developed the dimensions of the flume tank are 3 m length 1 m width 1 m height the movement platform of the oscillating device uses a linear servo system with two guide rails so that the connecting rods holding the model slide back and forth along the guide rails the horizontal moving distance is 2 m and the vertical moving distance is 1 m we use linear servo system made by mitsubishi electric to produce sinusoidal movement in horizontal direction to model the oscillating flow for oscillating flow in larger amplitude situation to avoid overring the torque of the motor due to larger acceleration we choose the oscillating period of not less than 3 s this limitation is also important to not exceed the range of the torque of the sensors due to the bending moment induced by the inertia of the model the picture of the actual device is shown in fig 4 when the pipe is perpendicular to flow direction and forced to do the harmonic motion the motion can be described as x t a s i n 2 π f t where x is the horizontal position of the pipe a and f are the amplitude and frequency of the oscillation flow respectively the wave absorber in the end of the flume is used to eliminate the reflection waves besides two baffles the dashed lines in fig 4 with the diameter of 3d are placed in the ends of the model to prevent the effect of vertical rails on fluid field 2 3 data processing the experimental results are obtained as a time history of the voltage signal from sensors of the dynamometer these voltage signals are transferred to the force signals however there are some undesired noises due to the transient effect dring the first 2 s there is also certain higher frequency noise in the signals due to the interference of the servo system the motors and the sensors therefore the filtering processing is conducted for the force signals as described in islam et al 2016 fig 5 presents the flow chart of the data processing to account for the inertia of the tested models and the connecting frame the inertia force is deducted to improve the accuracy of the tests while extracting the horizontal force and the hydrodynamic coefficients of the model 2 4 calibration for the dry model inertia the inertia of the tested system consists of the dry model inertia in the absence of fluid load and the contribution of the fluid that has to be evaluated by the experiment in order to eliminate the effect the dry model inertia we tested the inertia forces of the tested model and the connecting rods in the air without any fluid load after comparing the inertia force of the model with fluid loads the model is exposed to water and without fluid loads the model is exposed to air we find that when the tested model is exposed to air the inertia force is about 50 of that exposed to water therefore all of the results hereafter provide the inertia without the dry model component 2 5 load cases of the experimental study the experimental load cases include steady flow and oscillating flow the steady flow was investigated by towing a single segment model 1 at speeds ranging from 0 1 m s to 0 6 m s with a step of 0 1 m s the oscillation flow was studied by forced oscillation experiments on all specimens models 1 4 the periods t and the amplitudes a of the oscillating motion are shown in table 2 together with the keulegan carpenter and reynolds numbers and the obtained values of hydrodynamic coefficients see section 5 in the studies the considered range of kc numbers is from 5 to 25 this is motivated by the observation of sarpkaya 2010 that it is extremely difficult to extract the drag force in the inertia dominated regime kc is less than 5 especially for the smaller cylinder 3 mathematical formulation and numerical approach 3 1 parameters of oscillating flow previous studies conducted on the floating pipe towed horizontally with steady and oscillating motion sarpkaya 1976 show that the horizontal force is affected by two parameters reynolds number sommerfeld 1908 and keulegan carpenter number keulegan 1958 in the steady flow condition reynolds number re can be defined as 1 r e ρ u d μ u d ν where ρ is the density of the fluid u is the velocity of the fluid with respect to the cylinder d is the diameter of the cylinder μ is the dynamic viscosity of the fluid and ν is the kinematic viscosity of the fluid on the other hand if the cylinder is towed in the oscillating flow then the keulegan carpenter number kc number needs to be taken into consideration kc number is also called the period parameter and it can be expressed as 2 k c u m a x t d where u m a x is the maximum velocity of the incoming oscillating flow t is the corresponding period in this paper the sinusoidal movement is reproduced therefore kc number is also given by 3 k c 2 π a m d where a m is the amplitude of the oscillation flow also in the oscillation flow the reynolds number can be expressed as 4 r e ρ u m a x d μ u m a x d ν 2 π a m d t ν 3 2 hydrodynamic force since morison et al 1950 proposed the empirical formula to predict the hydrodynamic force on a vertical pile under waves the so called morison equation is been widely used to calculate hydrodynamic forces on the cylinder in various shapes according to morison equation the force on a differential section of the vertical cylinder is expressed as 5 d f c m ρ π d 2 4 u t c d ρ d 2 u 2 d z where c m is the inertia coefficient c d is the drag coefficient u is the horizontal component of the orbital velocity in this paper we follow the principle of dixon et al 1979 who modified the morison equation to calculate the wave force on the partially submerged circular cylinder as follows 6 f x 1 2 c d ρ a x t u x u x c m ρ v t u x t 7 f y c m ρ v t u y t ρ g v t v 0 where f x and f y are the wave forces in horizontal and vertical directions respectively c d and c m are the drag and inertia coefficients a x t is the instantaneous wetted projected area in horizontal direction v t and v 0 are the instantaneous submerged volume and the initial volume u x and u x t are the velocity and acceleration of the fluid in horizontal direction 3 3 governing equations and turbulence model a computational fluid dynamics based scheme is used to solve the interaction between the flow and the cylinder in a numerical wave tank the governing equation behind the cfd used in this paper is reynolds averaged navier stokes equation the volume of fluid vof approach is employed to capture the free surface also we choose the sst k ω model as the turbulence model for the incompressible flow the reynolds averaged navier stokes rans equations may be written in cartesian form as follows 8 ρ t ρ u i x i 0 9 ρ u i t ρ u i u j x j p x i x j μ u i x j ρ u i u j where μ is the dynamic viscosity of the fluid p is the static pressure u i is the average velocity items for x y z u is the fluctuation velocity i j 1 2 3 x y z ρ u i u j is the reynolds stresses in our simulations we use the shear stress transport sst k ω model menter 1994 to model the reynolds stresses the equations are as follows 10 ρ k t x i ρ k u i x j γ k k x j g k y k s k 11 ρ ω t x i ρ ω u i x j γ ω ω x j g ω y ω d ω s ω where k is the turbulent kinetic energy ω is dissipation rate g k is the generation of turbulence kinetic energy due to mean velocity gradient g ω is the generation of ω γ k and γ ω are the effective diffusivity of k and ω respectively y k and y ω are the dissipation of k and ω due to turbulence d ω is the cross diffusion term s k and s ω are self defined source terms 3 4 modeling approach we use the cfd software star ccm cd adapco 2014 to simulate a rigid segment of the floating collar under steady and oscillating flow with the attack angle of 90 the hydrodynamic coefficients obtained numerically are then compared with the experimental results the numerical wave tank is developed to calculate the hydrodynamic forces under different loading cases the non dimensional computational domain utilizes the symmetry of the problem and is set as 50d length 20d width 20d height for the model as shown in fig 6 to capture the variation of the free surface the upper portion of the domain contains the lighter fluid air and the lower portion of the domain contains the heavier fluid water the model is assigned the velocity inlet on top bottom and inlet sides of the computational domain and the pressure outlet boundary conditions on the outlet for both air and water see fig 6 in order to produce a high quality mesh for the oscillating cylinder the overset mesh technique is used and then a prism layer mesh is formed based on the surface mesh the domain is divided into the background region and the overset region this overset region is completely surrounded by the background region both regions are meshed separately there will be a zone where cells from both regions overlap with each other this overlapping zone changes if the overset body moves an overset mesh interface is created between the two regions information is transitioned from one region to another through the overlapping cells the flow chart of the overset mesh technique is shown in fig 7 the size of the free surface and the background mesh is 0 008 m the mesh around the cylinder is 0 005 m the overlapping mesh is 0 002 m with this set up we get the numbers of the background cells and the overlapping cells are 1495800 and 790886 respectively therefore the total number of the cells is 2286686 the mesh for different parts of the computational domain is shown in fig 8 4 numerical results in steady flow 4 1 single segment of the floating collar with different level of submergence numerical simulations produce the overall horizontal force that can be used to calculate the drag under steady flow the drag coefficient is extracted from the force utilizing morison s equation 6 in the absence of the inertia term fig 9 illustrates the drag coefficient changing with the submergence as function of reynolds number dixon et al 1979 reported that the drag coefficient c d and the inertia coefficient c m are influenced by reynolds number except in a higher range that re 2 10 5 that s the reason we illustrate the dependence between hydrodynamic coefficients and reynolds number in this paper from fig 9 we see that the drag coefficient decreases with the increase of reynolds number when the model is semi submerged and reynolds number is in the range of 10000 30000 the drag coefficient decreases and then keeps stable when the reynolds number is 40000 and higher when the segment of the floating collar is 3 4 submerged in the water the drag coefficient also decreases sharply when reynolds number is from 10000 to 40000 and the then decrease is more moderate comparing with the half submerged situation the drag coefficient is greater but with the increasing reynolds number the difference becomes smaller due to the rise of the free surface also known as overtopping in the cfd simulation the overtopping happens when the flow velocity is approaching 0 8 0 9 m s for the 3 4 submergence of the model observations show that the overtopping is followed by the vortices immediately behind the cylinder 4 2 comparison of numerical and experimental results comparison of numerical and experimental results for 1 2 submerged segment shows that the drag coefficients obtained from the experiments are slightly higher than those from the numerical simulations see fig 10 the difference calculated as c d n u m c d e x p c d e x p 100 varies from 3 4 to 7 4 note that the same behavior of sharp decrease followed by steady region is observed in both numerical and experimental tests 5 single segment in oscillating flow 5 1 hydrodynamic coefficients in oscillating flow when processing the experimental results for oscillating flow only the first 15 s of test were used because the rest of the data was influenced by the reflection of the waves from the flume walls the time history of the hydrodynamic force measured in the experiments was combined with the morison equation 6 to extract the hydrodynamic coefficients the experimental and numerical values of the drag coefficients cd and the inertia coefficients cm are compared in table 2 the magnitude of the difference between the corresponding experimental and numerical results is shown as err in the table note that since all of the segments models 1 4 are subjected to forced oscillation in still water the froude krylov force on the oscillating cylinders is zero therefore the inertia coefficient here is equal to the added mass coefficient however if the cylinder is fixed and the flow is oscillating then the inertia coefficient is c m 1 c a where c a is the added mass coefficient based on the data reported in table 2 there are some jumps when considering magnitude of the difference for the inertia coefficient the highest magnitude of difference happens when kc number reaches around 12 when kc number is less than 12 the dominating force is inertia force for the drag coefficient the magnitude of the difference is consistently on the order of 0 2 0 3 this significant difference was expected because of the small size of the flume tank used in the experimental studies however the overall trends appear to make physical sense in most of the cases the drag and inertia coefficients extracted from the experiments in the constrained flume tank are greater than their numerical estimates the graphical representation of these results provides information on the trends in dependence of the hydrodynamic coefficients on kc and reynolds numbers see figs 11 14 from fig 11 we see that the inflection point in the inertia coefficient appears when the kc number reaches around 8 as kc number increases the inertia coefficient for all values of re desreases to approximately 0 5 at kc 8 and then increases to almost 1 5 for kc 25 the drag coefficient decreases smoothly with the increase of kc for all considered values of re number as evident from fig 12 the numerical values of cd reduce from cd 1 6 to cd 0 4 there is no such an established pattern in the dependence of cm on the reynolds number as can be seen in fig 13 the only obvious observation is that similarly to all other dependencies the experimental results slightly over predict numerical estimates of cm for almost all values of kc fig 14 illustrates that the drag coefficient cd in oscillating flow of partially submerged cylinder reduces with the increase of re number as expected the flow undergoes a laminar separation when the re is small then the turbulence separation occurs to form the wake and this wake induces the reduction of the drag force this is consistent with the results available for the submerged cylinders under current only loading see decew et al 2010 experiments conducted by sarpkaya 2006 show that the separation of the flow is three dimensional but the separation point is hard to be predicted because of the insufficient understanding of the near wake 5 2 free surface effects the tests show when the kc number is higher than 12 in oscillating flow the free surface around the segment declines this lowering of free surface coincides with the reduction in drag force as observed in the experiments the declination of the free surface is shown in fig 15 at the moment when the acceleration of the floating collar is reaching its maximum value in oscillating flow we observe the climbing of the free surface with the rise of the free surface the force acting on the floating collar also increases especially the inertia force we used the vof method to capture the free surface in the cfd scheme and the visualized image of the climbing of the free surface is shown in fig 16 good correspondence of the cfd simulations and experimental observations for the variations in free surface is observed thus differently from the completely submerged horizontal cylinder the variation of the free surface for the partially submerged floating collar should be included in the analysis since it significantly influences the calculation results for the hydrodynamic force 6 double pipe segment in oscillating flow 6 1 hydrodynamic coefficients in oscillating flow in this section we focus on the effect of the distance between two pipes of the double pipe segment different from the investigation of sarpkaya 1985 zdravkovich 1977 and zhao and cheng 2012 this study deals with the horizontal cylinders with tandem arrangement figs 17 20 present the hydrodynamic coefficients for all of the considered models for the segment of the floating collar g is the gap between the external surfaces of the pipes for all considered re numbers the downstream pipe has no effect on the upstream one therefore the hydrodynamic coefficients of the upstream pipe are almost cosntant and nearly identical to the single pipe model for the downstream pipe when the kc number is less than 8 the drag coefficient is larger than 1 for all of the considered models and re numbers however with the increasing of the kc number from 8 to 25 the drag coefficient slightly decreases and stays around 0 5 in terms of the distance effect the results show that the inertia coefficient of the downstream pipe is increasing with the increasing distance between the pipes in the double segment the averaged increase is 22 2 from model 2 to model 3 and 20 1 from model 3 to model 4 the drag coefficient of the downstream pipe in the double segment is greater than that of the single segment for the range of the considered kc numbers but also as the distance increases the drag coefficient of the downstream pipe from model 2 to model 4 increases as well the averaged increase is 10 5 from model 2 to model 3 and 6 2 from model 3 to model 4 see figs 17 20 thus to calculate the hydrodynamic force on the double piped floater with morison equation the hydrodynamic coefficients should be chosen accoding to the distance between the parallel pipes in the floater rather than choosing the empirical value obtained for a single floater under waves and current note that not all of the hydrodynamic coefficients for the downstream pipe are larger than those of the single segment when the distance g 0 5d due to the effect of the wake turbulence behind the upstream pipe the hydrodynamic coefficients of the downstream pipe are smaller than those of the single segment when the distance reaches a critical value the effect of the wake behind upstream pipe becomes weak and the hydrodynamic coefficients of the downstream pipe increase however the critical distance observed in this study is slightly different from the estimate of hoerner 1965 because the cylinders are deployed not vertically but horizontally it has also been shown experimentally that the critical distance depends on the re number thus the wake effect will never be negligible if the distance between two pipes in the floating collar is less than the critical value 6 2 the empirical formulae for the segments of the floating collar to describe the dependence of inertia and drag coefficients on kc number quantitatively we propose the empirical formulae based on experiments for the rigid segment of the floating collar under oscillating flow the attack angle is 90 and the kc number is in the range from 5 to 25 the empirical formulae of the hydrodynamic coefficients from model 2 to model 4 correspond to the downstream pipe of the specimen for model 1 12 c m 0 0005 k c 2 0 0631 k c 0 0579 13 c d 0 0016 k c 2 0 1022 k c 1 9604 for model 2 14 c m 0 001 k c 2 0 068 k c 0 048 15 c d 0 004 k c 2 0 198 k c 2 685 for model 3 16 c m 0 002 k c 2 0 101 k c 0 143 17 c d 0 004 k c 2 0 18 k c 2 685 for model 4 18 c m 0 001 k c 2 0 092 k c 0 119 19 c d 0 023 k c 1 7 7 conclusions the oscillating experiments have been conducted to investigate the hydrodynamic coefficients of the full scale floating collar segments consisting from single and double pipes the numerical simulations based on overset mesh technique and reynolds averaged navier stokes equations have been used to verify the experimental resutls the sst k ω model was chosen as the turbulence model and the vof method was utilized to capture the free surface variations a modified morison equation combined with the least square method was used to calculate the hydrodynamic coefficients based on the experimental data after comparing the cfd numerical simulation and the experimental results the conclusions are as follows i comparison of the hydrodynamic coefficients of the single segment and double pipe segment under oscillating flow shows that the inertia coefficient of the downstream pipe is greater than that of the single segment when the distance between two parallel pipes is 1 5d for double pipe segments the drag and the inertia coefficients of the downstream pipe are both increasing with the increase of the distance between two pipes the drag coefficent of the downstream pipe is greater than that of the single segment with the distance increasing to 1 5d the drag coefficient of downstream pipe reaches its maximum value among all of the segments ii from the oscillating experiments we observe that the rise and fall of the free surface around the partially sumberged floater causes the changes in the drag coefficients and the inertia coefficients the drag coefficient decreases with the lowering of the free surface the inertia coefficient increases with the increasing of the free surface the separation of the flow has also been predicted numerically the wake behind upstream pipe has significant effect on the hydrodynamic coefficients of the downstream pipe iii the cfd simulation results based on the overset mesh technique coupled with the vof method are underestimated than the experimental measurements we predicted both experimentally and numerically that the immersed projected area of the pipe has significant effect on the horizontal force as an adapted mesh approach this overset mesh technique could be used to predict the hydrodynamic behaviors of two or three horizontal cylinders with tandem arrangement in different submergence iv the hydrodynamic coefficients and the empiricial formulae obtained from this study can be used to predict the hydrodynamic force of the single and double pipe floating collars or other partially submerged horizontal cylinders utilized in different ocean engineering applications acknowledgement this work is supported by national natural science foundation of china nsfc with grant no 51679046 the support of the china scholarship council for zhijing xu visit to the computational mechanics laboratory at the university of new hampshire is also gratefully acknowledged 
23368,development of offshore floating wind turbines is the future trend of wind power technology however due to the complex service environment they are still in the exploratory stage without large scale commercial application especially the understanding of its load and motion characteristics is still lack for this reason firstly a structure model of offshore wind turbines is proposed and then multiple coordinate systems are established to describe the multiple loads and motion characteristics then multiple load models including wind load wave load gravity load centrifugal force and inertia load are established to solve the complex motion process it is divided into translational motion and rotational motion and the idea of progressive iteration is used to solve the problem finally in the simulink environment the input wind model blade wind turbine rotor model shaft model generator model converter model grid model controller model pitch model floating platform model and other models are integrated and the numerical simulation investigation is carried out the simulation results can be used to analyze the running load and motion characteristics of the floating wind turbines which is helpful to understand the operation mechanism and provide a reference for the design and control keywords offshore floating wind turbines multiple loads motion characteristics numerical simulation 1 introduction since the rest of land based wind farm is dwindling in recent years the development of offshore wind farm is an inevitable trend many experts agree that a significant increase of the offshore wind industry in activity will be seen in the near future roddier et al 2010 moreover considering offshore fishing military and other practical constraints the development of deep sea floating wind turbines is of great significance the main advantage of offshore floating wind turbines muliawan et al 2013 sebastian and lackner 2012 is that it is not subject to the depth of the sea area and can make full use of the abundant wind resources as early as in 1972 professor heronemus in massachusetts university put forward the design idea of deep sea floating wind turbines different from onshore wind turbines offshore floating wind turbines have no fixed base and the floating platform has six degrees of freedom however due to the complex service environment the load and motion characteristics of offshore floating wind turbines are more complex it not only needs to bear the wind load but also needs to bear the complex wave load and some other loads which limits its current practical application for a long time the study of wind turbine load and dynamic characteristics has been the focus of the wind power industry some methods such as blade element momentum theory bem lanzafame and messina 2007 ponta et al 2016 the generalized dynamic wake gdw model he 1989 kecskemety and mcnamara 2016 and computational fluid dynamics cfd hartwanger and horvat 2008 have been established to analyze the aerodynamic load of the wind turbines linear wave theory and nonlinear wave theory for example stokes theory are also developed to analyze wave load liu et al 2016 based on these analysis methods of wind load and wave load fruitful research works on wind turbine load have been carried out for example bem theory has been successfully used to calculate aerodynamic load dai et al 2011 analyze the aeroelastic behavior of the wind turbine blade rafiee et al 2016 and optimize wind turbine design lanzafame and messina 2007 nonlinear wave theories and linear wave theories have been used to analyze extreme hydrodynamic load and stochastic wave load respectively henderson et al some special software such as aerodyn moriarty and hansen 2005 and reflex seidel et al have been also developed to assist the analyzing of the aerodynamic load and wave load however when analyzing the dynamic characteristic of offshore floating wind turbines joint influences of multi loads including wind load wave load gravity load centrifugal force and inertial load should be considered at the same time the motion effect of floating platform should also be considered in recent years to grasp the dynamic characteristics of a wind turbine researchers used a variety of methods such as rigid flexible multibody dynamics floquet analysis method and modal superposition method to carry out dynamic modeling work the modeling objects are mainly focused on the system dynamics of wind turbines the dynamics of the key components blade tower and pitch mechanism and so on for example stol et al 2002 has used floquet approach to extract the correct modal parameters of a two bladed wind turbine jaksic et al 2015 has experimentally investigated the influences of multiple tuned liquid column dampers mtlcds on the dynamic characteristics of a floating tension leg platform tlp model in a wave basin cheng et al 2017 has carried out numerical modeling of the floating vertical axis wind turbine using fully coupled method shen et al 2016 has investigated the dynamic response of a tlp type floating wind turbine based on a coupled aero hydro mooring code however the development of offshore floating wind turbines is still in the exploratory stage moreover the floating platform could have many kinds of structural forms and the motion process is rather complex so the modeling method of jointly considering load and motion characteristics needs to be further studied therefore a floating offshore wind turbine structure model and multiple coordinate systems are proposed in this paper firstly then multiple load expressions including wind load wave load gravity load centrifugal force and inertial load are derived then the motion of floating platform is established using the combination of translation motion and rotation motion thus an effective modeling method for load and motion analysis of offshore floating wind turbine is developed finally in the simulink environment the integration of multiple sub models of wind turbines is achieved and numerical simulation investigation is carried out this can provide a theoretical basis and reference for further study of offshore floating wind turbines 2 wind turbine structure model the structure model and coordinate system of the investigated floating wind turbine are shown in fig 1 more specifically the structure size of the floating platform is shown in fig 1 a the force characteristic is shown in fig 1 b the multi coordinate systems are shown in fig 1 c and d shows the fixed coordinates of mooring lines the floating platform is composed of three floating barrels the floating barrel is equipped with ballast water the connecting pipes are arranged between the three floating barrels and the water level inside the three floating barrels can be mutually regulated the tower is installed above one of the floating barrels the overturning moment generated by the gravity of the tower and other components is balanced by the weight of the ballast water in the other two barrels a mooring line is provided under each floating barrel to ensure that the entire floating platform is substantially fixed to describe the motion state of the floating platform the coordinate system x g y g z g is fixed on the seabed the coordinate system x t y t z t is fixed at the bottom of floating barrel 1 but does not rotate with the platform the coordinate system x r y r z r is fixed at the bottom of floating barrel 1 and rotates with the platform the coordinate system x n y n z n is fixed on the nacelle the coordinate system x 0 y 0 z 0 is fixed on the shaft of the wind turbine rotor the coordinate system x 1 y 1 z 1 is fixed on blade 1 assuming that the seabed is flat the coordinates of the three floating barrels can be expressed as x g1 0 0 0 y g2 0 and x g3 y g3 0 aerodynamic thrust acting on the wind turbine rotor is denoted by f v wave loads acting on the three floating barrels are denoted by f w 1 f w 2 and f w 3 respectively the gravity of the tower and other components above the tower is denoted by f t g the gravities of the three floating barrels are denoted by f p g 1 f p g 2 and f p g 3 respectively f p g 1 f p g 2 f p g 3 m p g g the gravities of the ballast water in the three barrels are denoted by f s g 1 f s g 2 and f s g 3 respectively the buoyancies of the three floating barrels are denoted by f f 1 f f 2 and f f 3 the height from the top of floating barrel 1 to the hub center is denoted by h t the height of the floating barrel is denoted by h f t the heights of the ballast water in the three barrels are denoted by h s 1 h s 2 and h s 3 the heights from the seabed to the bottom of the floating barrels are denoted by h b 1 h b 2 and h b 3 respectively the water depth is denoted by h w s the length of the connecting pipe between the three floating barrels is denoted by l g and the length of the mooring line is denoted by l s under external loads the floating platform will produce the corresponding translation motion or rotation motion when considering the rotational relationship the coordinate system x r y r z r can be considered a result of the coordinate system x t y t z t rotating with an angle of θ t z around the z axis an angle of θ t x around the x axis and an angle of θ t y around the y axis the transformation matrix can be expressed as 1 a t r θ tz cos θ t z sin θ t z 0 sin θ t z cos θ t z 0 0 0 1 a t r θ t x 1 0 0 0 cos θ t x sin θ t x 0 sin θ t x cos θ t x a t r θ t y cos θ t y 0 sin θ t y 0 1 0 sin θ t y 0 cos θ t y the total rotation is the synthesis of the above three rotations in eq 1 and giving the transformation matrix is a t r a t r θ tz a t r θ t x a t r θ t y that is 2 x r y r z r a t r θ tz a t r θ t x a t r θ t y x t y t z t the coordinate of the bottom center of floating barrel 1 in the coordinate system x r y r z r is 0 0 0 that of floating barrel 2 is l g 2 r t 2 3 l g 2 r t 2 0 that of floating barrel 3 is l g 2 r t 2 3 l g 2 r t 2 0 where r t is the radius of the floating barrel in the coordinate system x t y t z t the coordinate of the bottom center of the floating barrel can be expressed as x t y t z t a t r t x r y r z r assuming the coordinate of the bottom center of floating barrel 1 in the coordinate system x g y g z g is t x 1 t y 1 t z 1 eq 3 can be used to describe the translation motion relationship that is 3 x t x g t x 1 y t y g t y 1 z t z g t z 1 the transformation matrix is t g t 1 0 0 t x 1 0 1 0 t y 1 0 0 1 t z 1 0 0 0 1 t t g 1 0 0 t x 1 0 1 0 t y 1 0 0 1 t z 1 0 0 0 1 that is x t y t z t 1 t g t x g y g z g 1 or x g y g z g 1 t t g x t y t z t 1 3 multiple load model 3 1 wind load wind load is calculated using the blade element momentum theory bem which is widely used in engineering bem theory is an extension of the actuator disk theory firstly proposed by rankine and froude and generally attributed to betz and glauert 1935 in bem theory the blade of a wind turbine is broken into many elements along its span martinez et al 2005 tenguria et al 2010 since in bem theory the blade element is modeled as a two dimensional airfoil it is easy to calculate the induced velocity and elemental forces in fig 2 the velocities and angles determining the forces acting on the element and the induced velocities are illustrated the resultant aerodynamic forces acting on the element and the corresponding components perpendicular and parallel to the turbine rotor plane are also shown the torque component produced by the blade element is denoted by d t the thrust component is denoted by d n the expressions of d t and d n are lanzafame and messina 2007 dai et al 2011 4 d t 1 2 ρ c ω r b 1 a 2 cos 2 φ c l sin φ c d cos φ d r d n 1 2 ρ c v 2 1 a 2 sin 2 φ c l cos φ c d sin φ d r where v is inflow wind speed c is chord length of the blade element r b is local radius φ is local flow angle ω is rotor rotational speed c l is lift coefficient c d is drag coefficient ρ is air density a is axial induction factor a is tangential induction factor the induction factors of a and a need to be solved iteratively they are calculated using 5 a σ c n 4 f sin 2 φ σ c n a σ c t 4 f sin φ cos φ σ c t where c t c l sin φ c d cos φ is tangential force coefficient c n c l cos φ c d sin φ is normal force coefficient f is combined tip loss and hub loss coefficient σ is equal to n b c 2 π r b n b is the number of blades it needs to be explained that when the induction factor is greater than about 0 4 the basic theory will become invalid in this case bem theory needs to be modified using empirical correction methods such as buhl correction or wilson correction buhl 2005 3 2 wave load to calculate the wave load it must firstly to obtain the relationship between the wind and the wave field measurements of wind wave spectra have shown that the wave field will evolve to reach a stationary state if the wind with constant speed and direction blows for a long time over a large area there are a variety of empirical relationships to describe the energy distributions such as neumann spectrum bretschneider spectrum mistsuyasu spectrum and pierson moskowitz p m spectra neumann and pierson 1957 seymour 1977 lin and kuang 2004 developed in 1964 the pierson moskowitz spectrum is one of the simplest descriptions moskowitz 1964 alves et al 2003 the p m spectrum defined by the significant wave height and the zero crossing period can be expressed as 6 s ω 4 π 3 h s 2 t 0 4 1 ω b 5 exp 16 π 3 t 0 4 1 ω b 4 where h s is the significant wave height t 0 is the zero crossing period t 0 1 62 π v 19 5 g s ω is spectrum function ω b is wave frequency v 19 5 is the wind speed at the height of 19 5 m above the sea surface to obtain the wave load model of the floating platform a coordinate system x w y w z w is firstly established as shown in fig 3 in this coordinate system y axis and the wave direction are always consistent the coordinate system x w y w z w can be considered a result of the coordinate system x g y g z g rotating with an angle of ϒ around the z axis the transformation matrix a g w is 7 a g w ϒ cos ϒ sin ϒ 0 sin ϒ cos ϒ 0 0 0 1 the bottom center of floating barrel 1 in the coordinate system x w y w z w can be expressed as 8 x w 1 y w 1 z w 1 a g w ϒ t x 1 t y 1 t z 1 if the ratio of diameter and wavelength d t l 0 of the floating barrel is less than 0 2 it can be regarded as a small scale structure in this case wave load can be calculated using morrison equation rainey 1989 chandrasekaran and jain 2002 hogben et al 1977 wave forces on small scale structures mainly include drag force lateral force inertial force morison equation is the sum of two components that is a drag force f d proportional to the square of the flow velocity and an inertia force f i in phase with the flow acceleration two empirical hydrodynamic coefficients are contained in morison equation namely an inertia coefficient and a drag coefficient which are determined based on experimental data there are some assumptions causing the corresponding limitations for morison equation for instance the flow acceleration is assumed to be more or less uniform at the location of the body when extending to orbital flow morison equation is not a good representation of the force as a function of time chaplin 1984 despite these limitations morison equation is a widely used method to obtain the approximate wave load results for small scale structure for considering the effects of platform tilt wave load is firstly calculated in the coordinate system x w y w z w with an equivalent height of the floating barrel then wave load can be transformed into other coordinate systems for different purposes according to morison equation the expressions of f d and f i are 9 f d 1 2 c d ρ w a u y u y f i c m ρ w v 0 u y t where c d is the drag coefficient c m is the inertia coefficient ρ w is the density of the sea water a is the cross sectional area perpendicular to the flow direction a d t u y is the flow velocity v 0 is the volume of the body for a circular cylinder z 1 z 2 the sum of wave force along the flow direction is 10 f w z 1 z 2 f w d z z 1 z 2 f d f i d z in eq 9 the expressions of u y and are 11 u y h ω b 2 ch k z sh k h w s cos k y ω b t u y t h 2 ω b 2 ch k z sh k h w s sin k y ω b t where k 2 π l l is wavelength substituting eq 11 into eq 10 one has 12 f w z 1 z 2 f d f i d z c d ρ w d t h 2 ω b 2 cos ϑ cos ϑ 4 δ 1 c m ρ w π d t 2 h ω b 2 8 δ 2 sin ϑ where δ 1 sh 2 k z 2 sh 2 k z 1 2 k z 2 z 1 8 k sh 2 k h w s δ 2 sh k z 2 sh k z 1 k sh k h w s z 2 min h w s h 2 cos k y ω b t z 1 h f t h is wave height h s 2 06 v 19 5 2 g 2 ϑ k y ω b t correspondingly the moment about point z 1 can be expressed as 13 m w z 1 z 2 z z 1 f d f i d z c d ρ w d t h 2 ω b 2 8 cos ϑ cos ϑ δ 3 c m ρ w π d t 2 h ω b 2 8 sin ϑ δ 4 where δ 3 2 k z 2 sh 2 k z 2 2 k z 1 sh 2 k z 1 ch 2 k z 2 ch 2 k z 1 8 k 2 sh 2 k h w s z 2 2 z 1 2 4 sh 2 k h w s z 1 sh 2 k z 2 sh 2 k z 1 2 k z 2 z 1 4 k sh 2 k h w s δ 4 k z 2 sh k z 2 k z 1 sh k z 1 ch k z 2 ch k z 1 k 2 sh k h w s k z 1 s h k z 2 s h k z 1 k 2 sh k h w s if the ratio of diameter and wavelength d t l 0 of the floating barrel is larger than 0 2 it can be regarded as a large scale structure in this case wave load can be calculated using maccamy fuchs equation the wave force along the flow direction at height z can be written as maccamy and fuchs 1954 14 f w 2 ρ w g h k ch k z ch k h w s a k c cos ω b t α where j 1 x and y 1 x are bessel s functions c d t 2 tan α j 1 k c y 1 k c a k c 1 j 1 2 k c y 1 2 k c for a circular cylinder z 1 z 2 the sum of wave force along the flow direction is 15 f w z 1 z 2 2 ρ w g h k ch k z ch k h w s a k c cos ω b t α d z 2 ρ w g h k 2 a k c cos ω b t α s h k z 2 s h k z 1 ch k h w s where g 9 8 n kg correspondingly the moment about point z 1 can be expressed as 16 m w z 1 z 2 z z 1 2 ρ w g h k ch k z ch k h w s a k c cos ω b t α d z 2 ρ w g h k a k c cos ω b t α 1 ch k h w s δ 5 where δ 5 1 k 2 k z 2 sh k z 2 k z 1 sh k z 1 ch k z 2 ch k z 1 z 1 1 k s h k z 2 s h k z 1 3 3 other load in addition to the external wind load and wave load offshore floating wind turbines also bear some other loads such as gravity load inertial load and centrifugal force in the previous work blade load model in the coordinate system x 0 y 0 z 0 has been established dai et al 2017 but it needs to point out that in the previous model the gravity load is along the negative direction of z axis in the coordinate system x n y n z n because the bottom of the tower is fixed thus it cannot represent the gravity load of the offshore floating wind turbine in fig 1 a correction is needed in fig 1 the gravity load is always vertical downward in the coordinate system x g y g z g or x t y t z t that is along with the negative direction of the z axis so the expression of the gravity load in the coordinate system x n y n z n can be written as 17 d f g x t d f g y t d f g z t a t r 0 0 m b d r g where m b is the quality of the blade per unit length in eq 17 the difference between the coordinate system x r y r z r and x n y n z n is not considered in other words the tilt angle is neglected and the yaw angle is not considered 4 structure motion model under multiple loads the motion characteristics of the floating platform are very complicated to solve this problem the motion process is divided into translational motion in the coordinate system x g y g z g and rotational motion in the coordinate system x t y t z t and the idea of progressive iteration needs to be used 4 1 translational motion model in translation relations one has 18 m f x c w x x k w x x f g x m f y c w y y k w x y f gy m f z c w z z k w x z f gz where m f is the equivalent mass of the floating platform c w x c w y and c w z are the equivalent damping about the x axis y axis and z axis respectively k w x k w y and k w z are the equivalent stiffness about the x axis y axis and z axis respectively considering to be zero the key to solving eq 18 is to obtain the values of f g x in x axis f gy in the y axis and f gz in the z axis respectively the forces acting on the floating platform include the components of aerodynamic force gravity centrifugal force and inertia force from the blades the components of gravity from floating platform tower nacelle generator hub and ballast water the components of wave force the components of buoyancy and the components of mooring line tension according to the previous calculation method of blade load dai et al 2017 the force components of a blade in the coordinate system x n y n z n can be obtained and denoted by i 1 3 d f b x n i i 1 3 d f byn i and i 1 3 d f bzn i respectively in the coordinate system x t y t z t the force components from the blade can be expressed as 19 d f b x t d f b y t d f b z t a t r t i 1 3 d f b x n i i 1 3 d f byn i i 1 3 d f bzn i in the coordinate system x t y t z t the force components of gravity from the floating platform tower nacelle generator hub and ballast water can be expressed as 20 d f g x t d f g y t d f g z t 0 0 f t g i 1 3 f p g i i 1 3 f s g i in the coordinate system x t y t z t the force components of buoyancy can be expressed as 21 d f f x t d f f y t d f f z t 0 0 i 1 3 f f i where f f i is approximately calculated according to the expression of ρ w g π r t 2 h w s i h b i c o s θ t x c o s θ t y i 1 2 3 in the coordinate system x t y t z t the force components of wave force can be expressed as 22 d f w x t d f w y t d f w z t a g w ϒ t 0 i 1 3 f w i 0 where i 1 2 3 in fig 1 a based on the self balance technology of mooring line the tension force of mooring line can be simplified as 23 f l i 0 l i l s f l i k l l i l s l i l s where l 1 t x 1 x g 1 2 t y 1 2 t z 1 2 l 2 t x 2 2 t y 2 y g 2 2 t z 2 2 l 3 t x 3 x g 3 2 t y 3 y g 3 2 t z 3 2 k l f m l i l s f m x is a nonlinear function i 1 2 3 combing with fig 4 the tension force componentes of mooring line 1 in the coordinate system x t y t z t can be written as 24 d f l 1 x t sign x g 1 t x 1 f l 1 cos θ 1 sin ξ 1 d f l 1 y t sign 0 t y 1 f l 1 cos θ 1 cos ξ 1 d f l 1 z t f l 1 sin θ 1 where sin θ 1 t z 1 t x 1 x g 1 2 t y 1 2 t z 1 2 cos θ 1 t x 1 2 t y 1 2 t x 1 x g 1 2 t y 1 2 t z 1 2 sin ξ 1 x g 1 t x 1 t x 1 x g 1 2 t y 1 2 cos ξ 1 t y 1 t x 1 x g 1 2 t y 1 2 sign x is an operation of symbol judgment correspondingly the tension force components of mooring line 2 can be written as 25 d f l 2 x t sign 0 t x 2 f l 2 cos θ 2 sin ξ 2 d f l 2 y t sign y g 2 t y 2 f l 2 cos θ 2 cos ξ 2 d f l 2 z t f l 2 sin θ 2 where sin θ 2 t z 2 t x 2 2 t y 2 y g 2 2 t z 2 2 cos θ 2 t x 2 2 t y 2 y g 2 2 t x 2 2 t y 2 y g 2 2 t z 2 2 sin ξ 2 t x 2 t x 2 2 t y 2 y g 2 2 cos ξ 2 t y 2 y g 2 t x 2 2 t y 2 y g 2 2 then the tension force components of mooring line 3 can be written as 26 d f l 3 x t sign x g 3 t x 3 f l 3 cos θ 3 sin ξ 3 d f l 3 y t sign y g 3 t y 3 f l 3 cos θ 3 cos ξ 3 d f l 3 z t f l 3 sin θ 3 where sin θ 3 t z 3 t x 3 x g 3 2 t y 3 y g 3 2 t z 3 2 cos θ 3 t x 3 x g 3 2 t y 3 y g 3 2 t x 3 x g 3 2 t y 3 y g 3 2 t z 3 2 sin ξ 3 t x 3 x g 3 t x 3 x g 3 2 t y 3 y g 3 2 cos ξ 3 t y 3 y g 3 t x 3 x g 3 2 t y 3 y g 3 2 according to the above analysis one has 27 f g x d f b x t d f g x t d f f x t d f w x t i 1 3 d f l i x t f gy d f b y t d f g y t d f f y t d f w y t i 1 3 d f l i y t f gz d f b z t d f g z t d f f z t d f w z t i 1 3 d f l i z t 4 2 rotational motion model in rotational relations one has 28 i b x θ t x c b x θ t x k b x θ t x m x i b y θ t y c b y θ t y k b y θ t y m y i b z θ t z c b z θ t z k b z θ t z m z where i b x i b y and i b z are the mass moments of inertia of the floating platform about the x axis y axis and z axis respectively c b x c b y and c b z are the equivalent damping about the x axis y axis and z axis respectively k b x k b y and k b z are the equivalent stiffness about the x axis y axis and z axis respectively considering to be zero the moment components m x m y and m z should be calculated firstly for solving eq 28 the moments acting on the floating platform include the components of aerodynamic moment gravity moment centrifugal moment and moment of inertia from the blades the components of gravity moment from floating platform tower nacelle generator hub and ballast water the components of wave induced moment the components of the moment of the buoyancy and the components of the moment of the mooring line tension defining the moment components of a blade in the coordinate system x n y n z n is denoted by i 1 3 d m b x n i i 1 3 d m b y n i and i 1 3 d m b z n i the moment components in the coordinate system x r y r z r without considering yaw effect can be expressed as 29 d m b x r d m b y r d m b z r i 1 3 d m b x n i i 1 3 d m byn i i 1 3 d m bzn i meanwhile the forces d f b x n i d f b y n i and d f b z n i from the blades will also produce the corresponding moments to influence the rotational motion of the floating platform to consider these influences the forces from the blades in the coordinate system x 0 y 0 z 0 is first transformed into the coordinate system x r y r z r without considering the yaw effect d f b x r d f b y r d f b z r is equal to i 1 3 d f b x n i i 1 3 d f b y n i i 1 3 d f b z n i the moment expression in the coordinate system x r y r z r can be obtained as 30 d m δ b x r d m δ b y r d m δ b z r h t 0 0 0 h t 0 0 0 l h d f b y r d f b x r d f b x r l h d f b z r 0 0 where l h is the vertical distance from the hub to the z axis considering the hub generator and other components on the tower top as a whole the mass is denoted by m h g the vertical distance from its mass center to the z axis is denoted by l h g then in the coordinate system x r y r z r d f h g x r d f h g y r d f h g z r is equal to a t r 0 0 m h g g the corresponding moment expression can be expressed as 31 d m h g x r d m h g y r d m h g z r h t 0 0 0 h t 0 0 0 l h g d f h g y r d f h g x r d f h g x r l h g d f h g z r 0 0 not considering the flexible deformation of the tower the height from the mass center of the tower to its bottom is denoted by h t m the tower mass is denoted by m t then in the coordinate system x r y r z r d f t x r d f t y r d f t z r is equal to a t r 0 0 m t g the corresponding moment expression can be obtained as 32 d m t x r d m t y r d m t z r h t m d f t y r d f t x r 0 the gravity of the floating barrels 1 2 and 3 are the same in the coordinate system x r y r z r each of them can be written as d f p g x r d f p g y r d f p g z r a t r 0 0 m p g g correspondingly the gravity moment of the floating barrel 1 can be obtained as 33 d m p g 1 x r d m p g 1 y r d m p g 1 z r h p g d f p g y r d f p g x r 0 where h p g is the height from the mass center of the floating barrel to the bottom the gravity moment of the floating barrel 2 can be written as 34 d m p g 2 x r d m p g 2 y r d m p g 2 z r ℓ 1 0 0 0 h p g 0 0 0 ℓ 2 d f p g z r d f p g x r d f p g y r h p g 0 0 0 ℓ 2 0 0 0 ℓ 1 d f p g y r d f p g z r d f p g x r where ℓ 1 3 l g 2 r t 2 ℓ 2 l g 2 r t 2 then the gravity moment of the floating barrel 3 can be written as 35 d m p g 3 x r d m p g 3 y r d m p g 3 z r ℓ 1 0 0 0 h p g 0 0 0 ℓ 2 d f p g z r d f p g x r d f p g y r h p g 0 0 0 ℓ 2 0 0 0 ℓ 1 d f p g y r d f p g z r d f p g x r if the influence of the floating barrel tilt on the relative position of ballast water gravity center in the barrel is neglected the gravity of the ballast water in the floating barrel can be expressed as d f s g i x r d f s g i y r d f s g i z r a t r 0 0 m s g i g m s g i i 1 2 3 is the mass of the ballast water in the ith floating barrel correspondingly in the coordinate system x r y r z r the gravity moment of the ballast water in the floating barrel 1 can be written as 36 d m s g 1 x r d m s g 1 y r d m s g 1 z r h s g 1 d f s g 1 y r d f s g 1 x r 0 where h s g 1 is the height from the gravity center of the ballast water to the barrel bottom in the floating barrel 1 the gravity moment of the ballast water in the floating barrel 2 can be written as 37 d m s g 2 x r d m s g 2 y r d m s g 2 z r ℓ 1 0 0 0 h s g 2 0 0 0 ℓ 2 d f s g 2 z r d f s g 2 x r d f s g 2 y r h s g 2 0 0 0 ℓ 2 0 0 0 ℓ 1 d f s g 2 y r d f s g 2 z r d f s g 2 x r where h s g 2 is the height from the gravity center of the ballast water to the barrel bottom in the floating barrel 2 then the gravity moment of the ballast water in the floating barrel 3 can be written as 38 d m s g 3 x r d m s g 3 y r d m s g 3 z r ℓ 1 0 0 0 h s g 3 0 0 0 ℓ 2 d f s g 3 z r d f s g 3 x r d f s g 3 y r h s g 3 0 0 0 ℓ 2 0 0 0 ℓ 1 d f s g 3 y r d f s g 3 z r d f s g 3 x r in the coordinate system x r y r z r the wave induced moments acting on the floating platform includes two parts the first can be obtained from the deduced wave induced moments in the coordinate system x w y w z w that is 39 d m w i x r d m w i y r d m w i z r a t r a g w ϒ t m w i 0 0 where i 1 2 3 the second can be obtained from the deduced wave forces of the floating barrels 2 and 3 in the coordinate system x w y w z w in the coordinate system x r y r z r the wave induced force d f w i x r d f w i y r d f w i z r is equal to a t r a g w ϒ t 0 f w i 0 i 2 3 for the floating barrel 2 the wave induced moments in the coordinate system x r y r z r can be written as 40 d m w 2 x r d m w 2 y r d m w 2 z r ℓ 1 0 0 0 ℓ 2 0 0 0 ℓ 1 d f w 2 z r d f w 2 z r d f w 2 x r 0 0 0 0 0 0 0 0 ℓ 2 d f w 2 z r d f w 2 x r d f w 2 y r for the floating barrel 3 the wave induced moment in the coordinate system x r y r z r can be written as 41 d m w 3 x r d m w 3 y r d m w 3 z r ℓ 1 0 0 0 ℓ 2 0 0 0 ℓ 1 d f w 3 z r d f w 3 z r d f w 3 x r 0 0 0 0 0 0 0 0 ℓ 2 d f w 3 z r d f w 3 x r d f w 3 y r when analyzing the moment of the buoyancy the relative change of floating center in the floating barrels is neglected firstly the buoyancy in the coordinate system x t y t z t is transformed into the coordinate system x r y r z r that is d f f i x r d f f i y r d f f i z r a t r d f f i x t d f f i y t d f f i z t i 1 2 3 the moment of the buoyancy of the floating barrel 1in the coordinate system x r y r z r can be written as 42 d m f 1 x r d m f 1 y r d m f 1 z r h f 1 d f f 1 y r d f f 1 x r 0 where h f 1 is the height from the floating center to the floating barrel bottom and it can be approximately calculated according to the expression 1 2 h w s 1 h b 1 cos θ t x c o s θ t y the moment of the buoyancy of the floating barrel 2 in the coordinate system x r y r z r can be written as 43 d m f 2 x r d m f 2 y r d m f 2 z r ℓ 1 0 0 0 h f 2 0 0 0 ℓ 2 d f f 2 z r d f f 2 x r d f f 2 y r h f 2 0 0 0 ℓ 2 0 0 0 ℓ 1 d f f 2 y r d f f 2 z r d f f 2 x r the moment of the buoyancy of the floating barrel 3 in the coordinate system x r y r z r can be written as 44 d m f 3 x r d m f 3 y r d m f 3 z r ℓ 1 0 0 0 h f 3 0 0 0 ℓ 2 d f f 3 z r d f f 3 x r d f f 3 y r h f 3 0 0 0 ℓ 2 0 0 0 ℓ 1 d f f 3 y r d f f 3 z r d f f 3 x r to analyze the rotational moment due to the mooring line tension the mooring line tension in the coordinate system x t y t z t is first transformed into the coordinate system x r y r z r that is d f l i x r d f l i y r d f l i z r a t r d f l i x t d f l i y t d f l i z t i 1 2 3 correspondingly the moment of the mooring line tension of mooring line 1 in the coordinate system x r y r z r can be written as 45 d m l 1 x r d m l 1 y r d m l 1 z r r t d f l 1 z r 0 d f l 1 x r the moment of the mooring line tension of mooring line 2 in the coordinate system x r y r z r can be written as 46 d m l 2 x r d m l 2 y r d m l 2 z r a d f l 2 z r d f l 2 z r d f l 2 x r 0 0 0 0 0 0 0 0 ℓ 2 3 r t 2 d f l 2 z r d f l 2 z r d f l 2 y r where a 1 2 3 l g 2 r t r t 0 0 0 1 2 l g 2 3 r t 0 0 0 1 2 3 l g 2 r t r t the moment of the mooring line tension of mooring line 3 in the coordinate system x r y r z r can be written as 47 d m l 3 x r d m l 3 y r d m l 3 z r a d f l 3 z r d f l 3 z r d f l 3 x r 0 0 0 0 0 0 0 0 ℓ 2 3 r t 2 d f l 3 z r d f l 3 z r d f l 3 y r based on the above analysis the total moment expression is obtained as 48 m x d m b x r d m δ b x t d m h g x r d m t x r i 1 3 d m p g i x r i 1 3 d m s g i x r i 1 3 d m w i x r i 2 3 d m w i x r i 1 3 d m f i x r i 1 3 d m l i x r m y d m b y r d m δ b y t d m h g y r d m t y r i 1 3 d m p g i y r i 1 3 d m s g i y r i 1 3 d m w i y r i 2 3 d m w i y r i 1 3 d m f i y r i 1 3 d m l i y r m z d m b z r d m δ b z t d m h g z r d m t z r i 1 3 d m p g i z r i 1 3 d m s g i z r i 1 3 d m w i z r i 2 3 d m w i z r i 1 3 d m f i z r i 1 3 d m l i z r 5 case analysis 5 1 numerical model for the floating wind turbine to investigate the load and dynamic characteristics of the offshore floating wind turbine in operation a system scale numerical model should be first established combining it with the previous work dai et al 2012 2013 2017 the floating platform model is integrated into the wind turbine system as shown in fig 5 in addition the system model has also integrated rotor sub model main shaft sub model generator sub model converter sub model grid sub model controller sub model pitch sub model and so on the detailed introduction about these sub models can be found in the corresponding references for example the generator sub model and converter sub model can be found in reference dai et al 2012 it should be pointed out that this model is facing direct drive wind turbines thus no speed gearbox is considered in the main drive system both the mechanical torque from the turbine rotor and the electromagnetic torque from the generator directly act on the main shaft the result of their interaction will adjust the turbine rotor speed and generator rotor speed which influences the generator status and the aerodynamic status of the turbine rotor simultaneously on the other hand by comparing the power output of the generator and the power command the pitch controller will output the pitch angle command under the rated power the pitch angle keeps constant to pursuit the maximum power capture from air kinetic energy above the rated power the pitch angle varies with the wind speed to keep a stable power output near its rated value wind information from the wind sub model flows into the turbine rotor model to form the aerodynamic load on the one hand flows into the wind wave relationship model to influence the wave parameters such as wavelength and wave height on the other hand the load from the turbine rotor will transfer into the floating platform and then combine with the wave load to influence the motion status of the floating platform the simulation parameters of the floating wind turbine are shown in table 1 5 2 ballast water level distribution to keep the balance of the wind turbine the water level distribution of ballast water should be calculated the basic principle of water level distribution is that the total amount of ballast water in the three floats is constant and the water level is regulated in the three barrels assuming the floating platform is in equilibrium the sway effect is neglected when calculating the initial water level the initial draft depth of the floating platform is calculated according to eq 49 that is 49 h c m wt g 3 ρ w g π r t 2 where h c is the draft depth m wt is the mass of the wind turbine according to the parameters shown in table 1 the initial draft depth of the floating platform is 16 6 m considering that under the initial condition the floating platform is not inclined and the mooring line is free of tension the initial water level in barrel 2 and barrel 3 can be calculated by 50 2 ρ w g π r t 2 h c 2 m p g g ρ s g π r t b 2 h s 2 h s 3 σ 1 2 3 l g 2 r t ρ s g π r t b 2 h s 3 h s 2 σ 2 2 l g 2 r t where h s 2 h s 3 are the water levels in barrel 2 and barrel 3 respectively b is barrel wall thickness ρ s the density of the ballast water σ 1 d m b x r d m δ b x t d m h g x r d m t x r i 1 3 d m w i x r i 2 3 d m w i x r σ 2 d m b y r d m δ b y t d m h g y r d m t y r i 1 3 d m w i y r i 2 3 d m w i y r the input wind is shown in fig 6 a for simulation its mean value is 12 m s fig 6 b and c show the significant wave height hs and zero crossing period ts respectively according to the characteristics of the wind turbine the wind rotor speed is set to be 17 rpm then a typical value of σ 1 σ 2 is σ 1 0 n m σ 2 6 5 10 5 n m substituting the above conditions into eq 50 one has h s 2 h s 3 16 h s 3 h s 2 0 012 h s 1 8 01 h s 2 8 h s 3 7 99 according to the above results the moments of inertia of the floating wind turbine about the x r axis y r axis z r axis are 0 87 1010 kg m2 0 90 1010 kg m2 0 52 1010 kg m2 respectively 5 3 numerical simulation result analysis fig 7 shows the wave force and wave moment acting on the floating barrel 1 floating barrel 2 and floating barrel 3 respectively in the simulation process the wave direction is constant along y axis direction the interaction of wave between three floating barrels is ignored since the wind speed fluctuates near 12 m s in fig 6 the wavelength has a corresponding result fluctuating between 30 m and 46 m the ratio of diameter and wavelength d t l 0 of the floating barrel is larger than 0 2 thus large scale structure model is suitable for wave load calculating since the wave phase for floating barrel 1 and floating barrel 2 is different the wave forces acting on the two floating barrels show some differences in fig 7 a correspondingly the wave forces acting on floating barrel 2 and floating barrel 3 are basically the same since the wave phase for them are consistent when the simulation time is 16 2 s the maximum wave force appears about 2 9 106 n correspondingly the maximum wave moment is about 4 5 107 n m in fig 7 b where a sign indicates the direction fig 8 a c show the force load of floating barrel 1 along the x axis direction y axis direction and z axis direction in the coordinate system x t y t z t respectively they are the results of the comprehensive action of multiple loads from the figures it can be seen that the load component along x axis direction is the smallest the main reason is that this load component mainly comes from the side load of the wind turbine rotor relatively the load components along the y axis and the z axis are much larger when the mooring line is free the load along the y axis is mainly from the wind load and wave load and the load along the z axis is mainly from the gravity and buoyancy load of the wind turbine in the 20s simulation time the load along y axis varies from 5 4 106 n to 8 0 106 n fig 8 d f show the moment load of floating barrel 1 along the x axis direction y axis direction and z axis direction in the coordinate system x r y r z r respectively the relationship between force direction and moment direction is determined by the right hand rule obviously moment load along x axis direction in fig 8 d is larger than that along y axis direction and z axis direction shown in fig 8 e and f meanwhile moment along x axis direction is a result of force load synthesis in fig 8 a c with the increasing of simulation time the magnitude of force load variation along x axis direction has a decreasing trend which is similar to the variation trend of force load shown in fig 8 c it is also shown that the force load along z axis direction has a strong influence on the moment load along the x axis direction in the 20s simulation time moment along x axis direction varies between 1 5 109 n m and 1 6 109 n m moment along y axis direction varies between 1 3 106 n m and 2 0 106 n m moment along z axis direction varies between 3 4 105 n m and 8 2 105 n m fig 9 shows the rotation curves of the floating platform along the x axis y axis and z axis under the moment load the rotation angle around the x axis y axis and z axis are shown in fig 9 a c respectively from the simulation results it can be seen that the rotation angle around the x axis is larger than others shown this is because the moment load along the x axis in fig 8 in the simulation process is obviously greater than that along the y axis and the z axis direction although the absolute value of the rotation angle in fig 9 b and c is small it is gradually increasing this is because the simulation process has not yet joined the ballast water control link on the other hand the increase of the rotation angle around the y axis will bring about the difference of buoyancy on the three floating barrels and the change of buoyancy will have a certain inhibitory effect on the increase of the rotation angle this can be regarded as a passive adjustment of floating platform balance in addition the inhibition of the rotation angle around the y axis can also be achieved by adjusting the ballast water in the three floating barrels active regulation which requires the subsequent introduction of closed loop control strategy of the ballast water the increasing of rotation angle around the z axis is due to the existence of moment load along the z axis direction as shown in fig 8 f it is also found that both positive and negative values appear in fig 8 f which means that the moment direction will vary this has a certain inhibitory effect on the increase of the rotation angle in the following control strategy the introduction of yaw and other active control methods for balance control can also be considered fig 9 d f show the angular velocity curves of the floating platform around the x axis y axis and z axis respectively it is clear that the angular velocity around the x axis has the maximum in the 20s simulation time its value varies between 0 14 rad s and 0 15 rad s relatively angular velocities around the y axis and z axis are smaller the angular velocity around the y axis has the trend of varying between positive and negative values the angular velocity around the z axis has the trend of gradually increasing fig 9 g i show the angular acceleration curves of the floating platform around the x axis y axis and z axis respectively in the 20s simulation time the variation trends of the floating platform around the x axis y axis and z axis are obviously different and the maximum values are 0 14 rad s2 1 6 10 4 rad s2 and 8 6 10 5 rad s2 respectively fig 10 shows the rotation angle around the x axis under different damping it can be seen from the figure that the damping coefficient has some influence on the motion characteristics however at present there is no effective method to calculate the motion damping and the more accurate analysis of the motion characteristics needs to adjust the motion damping according to the experimental or field data in the future 6 conclusions the complexity of load and motion of offshore floating wind turbines has limited the practical application in this paper the analysis of the operating load and motion characteristics of offshore floating wind turbines is helpful to understand its operation mechanism and provide a reference for design and operation control it is effective to use multiple coordinate systems to describe the load and motion characteristics of the offshore floating wind turbine multiple loads including wind load wave load gravity load inertia load and centrifugal force load are easy to establish and transform in multiple coordinate systems after dividing the motion of the floating platform into translational motion and rotational motion the idea of progressive iteration is used to solve the complex motion process by integrating the input wind model blade wind turbine rotor model shaft model generator model converter model grid model controller model pitch model floating platform model and other models in the simulink environment a system model of the offshore floating wind turbine is obtained and the numerical simulation investigation is carried out through the load and the motion model constructed in this paper the load variation and the motion process of the offshore floating wind turbine can be effectively reflected however due to the large number of parameters involved in the model some parameters for example the effective damping of motion have not been calculated theoretically and need further research acknowledgements this work is supported by national natural science foundation of the people s republic of china grant number 51675175 and state scholarship fund grant number 201408430267 national key research and development program of people s republic of china grant number 2016yff0203400 hunan provincial natural science foundation grant number 2016jj5024 and scientific research fund of hunan provincial education department grant number 15b084 nomenclature x g y g z g coordinate system fixed on the seabed x t y t z t coordinate system fixed at the bottom of floating barrel 1 without rotating with the platform x r y r z r coordinate system fixed at the bottom of floating barrel 1 rotating with the platform x n y n z n coordinate system fixed on the nacelle x 0 y 0 z 0 coordinate system fixed on the shaft of the wind turbine rotor x 1 y 1 z 1 coordinate system fixed on blade 1 x w y w z w coordinate system whose y axis is consistent with the wave direction f v aerodynamic thrust acting on the wind turbine rotor f w 1 f w 2 f w 3 wave loads acting on the three floating barrels f t g gravity of the tower and other components above the tower f p g 1 f p g 2 f p g 3 gravities of the three floating barrels f s g 1 f s g 2 f s g 3 gravities of the ballast water in the three barrels f f 1 f f 2 f f 3 buoyancies of the three floating barrels f w sum of wave force along the flow direction d f g x t d f g y t d f g z t gravity load in the coordinate system x n y n z n f g x f gy f gz forces in x axis y axis and z axis d f b x n i d f byn i d f bzn i force components of a blade in the coordinate system x n y n z n d f b x t d f b y t d f b z t force components from the blade in the coordinate system x t y t z t d f g x t d f g y t d f g z t force components of gravity from the floating platform tower nacelle generator hub and ballast water in the coordinate system x t y t z t d f f x t d f f y t d f f z t force components of buoyancy in the coordinate system x t y t z t d f w x t d f w y t d f w z t force components of wave force in the coordinate system x t y t z t d f l i x t d f l i y t d f l i z t components of the force f l i f l i tension force of mooring line d f b x r d f b y r d f b z r force components from the blades in the coordinate system x r y r z r d f h g x r d f h g y r d f h g z r force components from the hub generator and other components on the tower top in the coordinate system x r y r z r d f t x r d f t y r d f t z r force components in the coordinate system x r y r z r d f s g i x r d f s g i y r d f s g i z r gravity of the ballast water in the floating barrels in the coordinate system x r y r z r d f p g x r d f p g y r d f p g z r gravity components in the coordinate system x r y r z r d f w i x r d f w i y r d f w i z r deduced wave forces of the floating barrels 2 and 3 in the coordinate system x r y r z r d f f i x r d f f i y r d f f i z r buoyancy in the coordinate system x r y r z r d f l i x r d f l i y r d f l i z r mooring line tension in the coordinate system x r y r z r f w wave force f d f i drag force and inertia force of wave force on small scale structures h t height from the top of floating barrel 1 to the hub center h f t height of the floating barrel h s 1 h s 2 h s 3 heights of the ballast water in the three barrels h b 1 h b 2 h b 3 heights from the seabed to the bottom of the floating barrels h w s water depth h s significant wave height h wave height h t m height from the mass center of the tower to its bottom h p g height from the mass center of the floating barrel to the bottom h s g i height from the gravity center of the ballast water to the ith barrel bottom h f i height from the floating center to the floating barrel bottom h c draft depth h s i water level in the ith barrel l g length of the connecting pipe between the three floating barrels l s length of the mooring line l h vertical distance from the hub to the z axis l h g vertical distance from the mass center of m h g to the z axis m f equivalent mass of the floating platform m h g mass when considering the hub generator and other components on the tower top as a whole m t tower mass m wt mass of the wind turbine m s g i mass of the ballast water in the ith floating barrel m b the quality of the blade per unit length θ t x θ t y θ t z angles of rotation around the x axis y axis and z axis a t r θ tz a t r θ t x a t r θ t y a t r a g w t g t t t g transformation matrixes d t d n torque component and thrust component produced by the blade element v inflow wind speed b barrel wall thickness c chord length of the blade element r b local radius φ local flow angle α local angle of attack c l c d lift coefficient and drag coefficient c t c n tangential force coefficient and normal force coefficient c d c m drag coefficient and inertia coefficient of wave force ρ air density ρ s density of the ballast water ρ w density of the sea water ω rotor rotational speed ω b wave frequency a a axial induction factor and tangential induction factor f combined tip loss and hub loss coefficient n b number of blades σ rotor solidity d l d d lift force component and draft force component β pitch angle t 0 zero crossing period s ω spectrum function v 19 5 wind speed at the height of 19 5 m above the sea surface ϒ rotation angle between coordinate system x g y g z g and coordinate system x w y w z w d t diameter of the floating barrel l l 0 wavelength a cross sectional area perpendicular to the flow direction u y flow velocity v 0 volume of the body k 2 π l c d t 2 α arctan π k c 2 4 a k c 1 0 25 4 π 2 k c 4 η h cos k y ω b t 2 c w x c w y c w z equivalent damping about the x axis y axis and z axis c b x c b y c b z equivalent damping about the x axis y axis and z axis k w x k w y k w z equivalent stiffness about the x axis y axis and z axis k b x k b y k b z equivalent stiffness about the x axis y axis and z axis k l stiffness of mooring line θ i i 1 2 3 angle between mooring line and the bottom of the sea ξ i i 1 2 3 angle between the component f l i cos θ i and y axis i b x i b y i b z mass moments of inertia of the floating platform about the x axis y axis and z axis m w wave moment m x m y m z moments in the x axis y axis and z axis d m b x n i d m b y n i d m b z n i moment components of a blade in the coordinate system x n y n z n d m b x r d m b y r d m b z r moment components from the blades in the coordinate system x r y r z r d m δ b x r d m δ b y r d m δ b z r moment components in the coordinate system x r y r z r d m h g x r d m h g y r d m h g z r moments in the coordinate system x r y r z r d m t x r d m t y r d m t z r moment components in the coordinate system x r y r z r d m p g i x r d m p g i y r d m p g i z r gravity moments of the floating barrels in the coordinate system x r y r z r d m s g i x r d m s g i y r d m s g i z r gravity moment components of the ballast water in the ith floating barrel in the coordinate system x r y r z r d m w i x r d m w i y r d m w i z r deduced wave induced moment in the coordinate system x r y r z r d m w i x r d m w i y r d m w i z r wave induced moments in the coordinate system x r y r z r d m f i x r d m f i y r d m f i z r moment of the buoyancy in the coordinate system x r y r z r d m l i x r d m l i y r d m l i z r moment of the mooring line tension in the coordinate system x r y r z r 
23368,development of offshore floating wind turbines is the future trend of wind power technology however due to the complex service environment they are still in the exploratory stage without large scale commercial application especially the understanding of its load and motion characteristics is still lack for this reason firstly a structure model of offshore wind turbines is proposed and then multiple coordinate systems are established to describe the multiple loads and motion characteristics then multiple load models including wind load wave load gravity load centrifugal force and inertia load are established to solve the complex motion process it is divided into translational motion and rotational motion and the idea of progressive iteration is used to solve the problem finally in the simulink environment the input wind model blade wind turbine rotor model shaft model generator model converter model grid model controller model pitch model floating platform model and other models are integrated and the numerical simulation investigation is carried out the simulation results can be used to analyze the running load and motion characteristics of the floating wind turbines which is helpful to understand the operation mechanism and provide a reference for the design and control keywords offshore floating wind turbines multiple loads motion characteristics numerical simulation 1 introduction since the rest of land based wind farm is dwindling in recent years the development of offshore wind farm is an inevitable trend many experts agree that a significant increase of the offshore wind industry in activity will be seen in the near future roddier et al 2010 moreover considering offshore fishing military and other practical constraints the development of deep sea floating wind turbines is of great significance the main advantage of offshore floating wind turbines muliawan et al 2013 sebastian and lackner 2012 is that it is not subject to the depth of the sea area and can make full use of the abundant wind resources as early as in 1972 professor heronemus in massachusetts university put forward the design idea of deep sea floating wind turbines different from onshore wind turbines offshore floating wind turbines have no fixed base and the floating platform has six degrees of freedom however due to the complex service environment the load and motion characteristics of offshore floating wind turbines are more complex it not only needs to bear the wind load but also needs to bear the complex wave load and some other loads which limits its current practical application for a long time the study of wind turbine load and dynamic characteristics has been the focus of the wind power industry some methods such as blade element momentum theory bem lanzafame and messina 2007 ponta et al 2016 the generalized dynamic wake gdw model he 1989 kecskemety and mcnamara 2016 and computational fluid dynamics cfd hartwanger and horvat 2008 have been established to analyze the aerodynamic load of the wind turbines linear wave theory and nonlinear wave theory for example stokes theory are also developed to analyze wave load liu et al 2016 based on these analysis methods of wind load and wave load fruitful research works on wind turbine load have been carried out for example bem theory has been successfully used to calculate aerodynamic load dai et al 2011 analyze the aeroelastic behavior of the wind turbine blade rafiee et al 2016 and optimize wind turbine design lanzafame and messina 2007 nonlinear wave theories and linear wave theories have been used to analyze extreme hydrodynamic load and stochastic wave load respectively henderson et al some special software such as aerodyn moriarty and hansen 2005 and reflex seidel et al have been also developed to assist the analyzing of the aerodynamic load and wave load however when analyzing the dynamic characteristic of offshore floating wind turbines joint influences of multi loads including wind load wave load gravity load centrifugal force and inertial load should be considered at the same time the motion effect of floating platform should also be considered in recent years to grasp the dynamic characteristics of a wind turbine researchers used a variety of methods such as rigid flexible multibody dynamics floquet analysis method and modal superposition method to carry out dynamic modeling work the modeling objects are mainly focused on the system dynamics of wind turbines the dynamics of the key components blade tower and pitch mechanism and so on for example stol et al 2002 has used floquet approach to extract the correct modal parameters of a two bladed wind turbine jaksic et al 2015 has experimentally investigated the influences of multiple tuned liquid column dampers mtlcds on the dynamic characteristics of a floating tension leg platform tlp model in a wave basin cheng et al 2017 has carried out numerical modeling of the floating vertical axis wind turbine using fully coupled method shen et al 2016 has investigated the dynamic response of a tlp type floating wind turbine based on a coupled aero hydro mooring code however the development of offshore floating wind turbines is still in the exploratory stage moreover the floating platform could have many kinds of structural forms and the motion process is rather complex so the modeling method of jointly considering load and motion characteristics needs to be further studied therefore a floating offshore wind turbine structure model and multiple coordinate systems are proposed in this paper firstly then multiple load expressions including wind load wave load gravity load centrifugal force and inertial load are derived then the motion of floating platform is established using the combination of translation motion and rotation motion thus an effective modeling method for load and motion analysis of offshore floating wind turbine is developed finally in the simulink environment the integration of multiple sub models of wind turbines is achieved and numerical simulation investigation is carried out this can provide a theoretical basis and reference for further study of offshore floating wind turbines 2 wind turbine structure model the structure model and coordinate system of the investigated floating wind turbine are shown in fig 1 more specifically the structure size of the floating platform is shown in fig 1 a the force characteristic is shown in fig 1 b the multi coordinate systems are shown in fig 1 c and d shows the fixed coordinates of mooring lines the floating platform is composed of three floating barrels the floating barrel is equipped with ballast water the connecting pipes are arranged between the three floating barrels and the water level inside the three floating barrels can be mutually regulated the tower is installed above one of the floating barrels the overturning moment generated by the gravity of the tower and other components is balanced by the weight of the ballast water in the other two barrels a mooring line is provided under each floating barrel to ensure that the entire floating platform is substantially fixed to describe the motion state of the floating platform the coordinate system x g y g z g is fixed on the seabed the coordinate system x t y t z t is fixed at the bottom of floating barrel 1 but does not rotate with the platform the coordinate system x r y r z r is fixed at the bottom of floating barrel 1 and rotates with the platform the coordinate system x n y n z n is fixed on the nacelle the coordinate system x 0 y 0 z 0 is fixed on the shaft of the wind turbine rotor the coordinate system x 1 y 1 z 1 is fixed on blade 1 assuming that the seabed is flat the coordinates of the three floating barrels can be expressed as x g1 0 0 0 y g2 0 and x g3 y g3 0 aerodynamic thrust acting on the wind turbine rotor is denoted by f v wave loads acting on the three floating barrels are denoted by f w 1 f w 2 and f w 3 respectively the gravity of the tower and other components above the tower is denoted by f t g the gravities of the three floating barrels are denoted by f p g 1 f p g 2 and f p g 3 respectively f p g 1 f p g 2 f p g 3 m p g g the gravities of the ballast water in the three barrels are denoted by f s g 1 f s g 2 and f s g 3 respectively the buoyancies of the three floating barrels are denoted by f f 1 f f 2 and f f 3 the height from the top of floating barrel 1 to the hub center is denoted by h t the height of the floating barrel is denoted by h f t the heights of the ballast water in the three barrels are denoted by h s 1 h s 2 and h s 3 the heights from the seabed to the bottom of the floating barrels are denoted by h b 1 h b 2 and h b 3 respectively the water depth is denoted by h w s the length of the connecting pipe between the three floating barrels is denoted by l g and the length of the mooring line is denoted by l s under external loads the floating platform will produce the corresponding translation motion or rotation motion when considering the rotational relationship the coordinate system x r y r z r can be considered a result of the coordinate system x t y t z t rotating with an angle of θ t z around the z axis an angle of θ t x around the x axis and an angle of θ t y around the y axis the transformation matrix can be expressed as 1 a t r θ tz cos θ t z sin θ t z 0 sin θ t z cos θ t z 0 0 0 1 a t r θ t x 1 0 0 0 cos θ t x sin θ t x 0 sin θ t x cos θ t x a t r θ t y cos θ t y 0 sin θ t y 0 1 0 sin θ t y 0 cos θ t y the total rotation is the synthesis of the above three rotations in eq 1 and giving the transformation matrix is a t r a t r θ tz a t r θ t x a t r θ t y that is 2 x r y r z r a t r θ tz a t r θ t x a t r θ t y x t y t z t the coordinate of the bottom center of floating barrel 1 in the coordinate system x r y r z r is 0 0 0 that of floating barrel 2 is l g 2 r t 2 3 l g 2 r t 2 0 that of floating barrel 3 is l g 2 r t 2 3 l g 2 r t 2 0 where r t is the radius of the floating barrel in the coordinate system x t y t z t the coordinate of the bottom center of the floating barrel can be expressed as x t y t z t a t r t x r y r z r assuming the coordinate of the bottom center of floating barrel 1 in the coordinate system x g y g z g is t x 1 t y 1 t z 1 eq 3 can be used to describe the translation motion relationship that is 3 x t x g t x 1 y t y g t y 1 z t z g t z 1 the transformation matrix is t g t 1 0 0 t x 1 0 1 0 t y 1 0 0 1 t z 1 0 0 0 1 t t g 1 0 0 t x 1 0 1 0 t y 1 0 0 1 t z 1 0 0 0 1 that is x t y t z t 1 t g t x g y g z g 1 or x g y g z g 1 t t g x t y t z t 1 3 multiple load model 3 1 wind load wind load is calculated using the blade element momentum theory bem which is widely used in engineering bem theory is an extension of the actuator disk theory firstly proposed by rankine and froude and generally attributed to betz and glauert 1935 in bem theory the blade of a wind turbine is broken into many elements along its span martinez et al 2005 tenguria et al 2010 since in bem theory the blade element is modeled as a two dimensional airfoil it is easy to calculate the induced velocity and elemental forces in fig 2 the velocities and angles determining the forces acting on the element and the induced velocities are illustrated the resultant aerodynamic forces acting on the element and the corresponding components perpendicular and parallel to the turbine rotor plane are also shown the torque component produced by the blade element is denoted by d t the thrust component is denoted by d n the expressions of d t and d n are lanzafame and messina 2007 dai et al 2011 4 d t 1 2 ρ c ω r b 1 a 2 cos 2 φ c l sin φ c d cos φ d r d n 1 2 ρ c v 2 1 a 2 sin 2 φ c l cos φ c d sin φ d r where v is inflow wind speed c is chord length of the blade element r b is local radius φ is local flow angle ω is rotor rotational speed c l is lift coefficient c d is drag coefficient ρ is air density a is axial induction factor a is tangential induction factor the induction factors of a and a need to be solved iteratively they are calculated using 5 a σ c n 4 f sin 2 φ σ c n a σ c t 4 f sin φ cos φ σ c t where c t c l sin φ c d cos φ is tangential force coefficient c n c l cos φ c d sin φ is normal force coefficient f is combined tip loss and hub loss coefficient σ is equal to n b c 2 π r b n b is the number of blades it needs to be explained that when the induction factor is greater than about 0 4 the basic theory will become invalid in this case bem theory needs to be modified using empirical correction methods such as buhl correction or wilson correction buhl 2005 3 2 wave load to calculate the wave load it must firstly to obtain the relationship between the wind and the wave field measurements of wind wave spectra have shown that the wave field will evolve to reach a stationary state if the wind with constant speed and direction blows for a long time over a large area there are a variety of empirical relationships to describe the energy distributions such as neumann spectrum bretschneider spectrum mistsuyasu spectrum and pierson moskowitz p m spectra neumann and pierson 1957 seymour 1977 lin and kuang 2004 developed in 1964 the pierson moskowitz spectrum is one of the simplest descriptions moskowitz 1964 alves et al 2003 the p m spectrum defined by the significant wave height and the zero crossing period can be expressed as 6 s ω 4 π 3 h s 2 t 0 4 1 ω b 5 exp 16 π 3 t 0 4 1 ω b 4 where h s is the significant wave height t 0 is the zero crossing period t 0 1 62 π v 19 5 g s ω is spectrum function ω b is wave frequency v 19 5 is the wind speed at the height of 19 5 m above the sea surface to obtain the wave load model of the floating platform a coordinate system x w y w z w is firstly established as shown in fig 3 in this coordinate system y axis and the wave direction are always consistent the coordinate system x w y w z w can be considered a result of the coordinate system x g y g z g rotating with an angle of ϒ around the z axis the transformation matrix a g w is 7 a g w ϒ cos ϒ sin ϒ 0 sin ϒ cos ϒ 0 0 0 1 the bottom center of floating barrel 1 in the coordinate system x w y w z w can be expressed as 8 x w 1 y w 1 z w 1 a g w ϒ t x 1 t y 1 t z 1 if the ratio of diameter and wavelength d t l 0 of the floating barrel is less than 0 2 it can be regarded as a small scale structure in this case wave load can be calculated using morrison equation rainey 1989 chandrasekaran and jain 2002 hogben et al 1977 wave forces on small scale structures mainly include drag force lateral force inertial force morison equation is the sum of two components that is a drag force f d proportional to the square of the flow velocity and an inertia force f i in phase with the flow acceleration two empirical hydrodynamic coefficients are contained in morison equation namely an inertia coefficient and a drag coefficient which are determined based on experimental data there are some assumptions causing the corresponding limitations for morison equation for instance the flow acceleration is assumed to be more or less uniform at the location of the body when extending to orbital flow morison equation is not a good representation of the force as a function of time chaplin 1984 despite these limitations morison equation is a widely used method to obtain the approximate wave load results for small scale structure for considering the effects of platform tilt wave load is firstly calculated in the coordinate system x w y w z w with an equivalent height of the floating barrel then wave load can be transformed into other coordinate systems for different purposes according to morison equation the expressions of f d and f i are 9 f d 1 2 c d ρ w a u y u y f i c m ρ w v 0 u y t where c d is the drag coefficient c m is the inertia coefficient ρ w is the density of the sea water a is the cross sectional area perpendicular to the flow direction a d t u y is the flow velocity v 0 is the volume of the body for a circular cylinder z 1 z 2 the sum of wave force along the flow direction is 10 f w z 1 z 2 f w d z z 1 z 2 f d f i d z in eq 9 the expressions of u y and are 11 u y h ω b 2 ch k z sh k h w s cos k y ω b t u y t h 2 ω b 2 ch k z sh k h w s sin k y ω b t where k 2 π l l is wavelength substituting eq 11 into eq 10 one has 12 f w z 1 z 2 f d f i d z c d ρ w d t h 2 ω b 2 cos ϑ cos ϑ 4 δ 1 c m ρ w π d t 2 h ω b 2 8 δ 2 sin ϑ where δ 1 sh 2 k z 2 sh 2 k z 1 2 k z 2 z 1 8 k sh 2 k h w s δ 2 sh k z 2 sh k z 1 k sh k h w s z 2 min h w s h 2 cos k y ω b t z 1 h f t h is wave height h s 2 06 v 19 5 2 g 2 ϑ k y ω b t correspondingly the moment about point z 1 can be expressed as 13 m w z 1 z 2 z z 1 f d f i d z c d ρ w d t h 2 ω b 2 8 cos ϑ cos ϑ δ 3 c m ρ w π d t 2 h ω b 2 8 sin ϑ δ 4 where δ 3 2 k z 2 sh 2 k z 2 2 k z 1 sh 2 k z 1 ch 2 k z 2 ch 2 k z 1 8 k 2 sh 2 k h w s z 2 2 z 1 2 4 sh 2 k h w s z 1 sh 2 k z 2 sh 2 k z 1 2 k z 2 z 1 4 k sh 2 k h w s δ 4 k z 2 sh k z 2 k z 1 sh k z 1 ch k z 2 ch k z 1 k 2 sh k h w s k z 1 s h k z 2 s h k z 1 k 2 sh k h w s if the ratio of diameter and wavelength d t l 0 of the floating barrel is larger than 0 2 it can be regarded as a large scale structure in this case wave load can be calculated using maccamy fuchs equation the wave force along the flow direction at height z can be written as maccamy and fuchs 1954 14 f w 2 ρ w g h k ch k z ch k h w s a k c cos ω b t α where j 1 x and y 1 x are bessel s functions c d t 2 tan α j 1 k c y 1 k c a k c 1 j 1 2 k c y 1 2 k c for a circular cylinder z 1 z 2 the sum of wave force along the flow direction is 15 f w z 1 z 2 2 ρ w g h k ch k z ch k h w s a k c cos ω b t α d z 2 ρ w g h k 2 a k c cos ω b t α s h k z 2 s h k z 1 ch k h w s where g 9 8 n kg correspondingly the moment about point z 1 can be expressed as 16 m w z 1 z 2 z z 1 2 ρ w g h k ch k z ch k h w s a k c cos ω b t α d z 2 ρ w g h k a k c cos ω b t α 1 ch k h w s δ 5 where δ 5 1 k 2 k z 2 sh k z 2 k z 1 sh k z 1 ch k z 2 ch k z 1 z 1 1 k s h k z 2 s h k z 1 3 3 other load in addition to the external wind load and wave load offshore floating wind turbines also bear some other loads such as gravity load inertial load and centrifugal force in the previous work blade load model in the coordinate system x 0 y 0 z 0 has been established dai et al 2017 but it needs to point out that in the previous model the gravity load is along the negative direction of z axis in the coordinate system x n y n z n because the bottom of the tower is fixed thus it cannot represent the gravity load of the offshore floating wind turbine in fig 1 a correction is needed in fig 1 the gravity load is always vertical downward in the coordinate system x g y g z g or x t y t z t that is along with the negative direction of the z axis so the expression of the gravity load in the coordinate system x n y n z n can be written as 17 d f g x t d f g y t d f g z t a t r 0 0 m b d r g where m b is the quality of the blade per unit length in eq 17 the difference between the coordinate system x r y r z r and x n y n z n is not considered in other words the tilt angle is neglected and the yaw angle is not considered 4 structure motion model under multiple loads the motion characteristics of the floating platform are very complicated to solve this problem the motion process is divided into translational motion in the coordinate system x g y g z g and rotational motion in the coordinate system x t y t z t and the idea of progressive iteration needs to be used 4 1 translational motion model in translation relations one has 18 m f x c w x x k w x x f g x m f y c w y y k w x y f gy m f z c w z z k w x z f gz where m f is the equivalent mass of the floating platform c w x c w y and c w z are the equivalent damping about the x axis y axis and z axis respectively k w x k w y and k w z are the equivalent stiffness about the x axis y axis and z axis respectively considering to be zero the key to solving eq 18 is to obtain the values of f g x in x axis f gy in the y axis and f gz in the z axis respectively the forces acting on the floating platform include the components of aerodynamic force gravity centrifugal force and inertia force from the blades the components of gravity from floating platform tower nacelle generator hub and ballast water the components of wave force the components of buoyancy and the components of mooring line tension according to the previous calculation method of blade load dai et al 2017 the force components of a blade in the coordinate system x n y n z n can be obtained and denoted by i 1 3 d f b x n i i 1 3 d f byn i and i 1 3 d f bzn i respectively in the coordinate system x t y t z t the force components from the blade can be expressed as 19 d f b x t d f b y t d f b z t a t r t i 1 3 d f b x n i i 1 3 d f byn i i 1 3 d f bzn i in the coordinate system x t y t z t the force components of gravity from the floating platform tower nacelle generator hub and ballast water can be expressed as 20 d f g x t d f g y t d f g z t 0 0 f t g i 1 3 f p g i i 1 3 f s g i in the coordinate system x t y t z t the force components of buoyancy can be expressed as 21 d f f x t d f f y t d f f z t 0 0 i 1 3 f f i where f f i is approximately calculated according to the expression of ρ w g π r t 2 h w s i h b i c o s θ t x c o s θ t y i 1 2 3 in the coordinate system x t y t z t the force components of wave force can be expressed as 22 d f w x t d f w y t d f w z t a g w ϒ t 0 i 1 3 f w i 0 where i 1 2 3 in fig 1 a based on the self balance technology of mooring line the tension force of mooring line can be simplified as 23 f l i 0 l i l s f l i k l l i l s l i l s where l 1 t x 1 x g 1 2 t y 1 2 t z 1 2 l 2 t x 2 2 t y 2 y g 2 2 t z 2 2 l 3 t x 3 x g 3 2 t y 3 y g 3 2 t z 3 2 k l f m l i l s f m x is a nonlinear function i 1 2 3 combing with fig 4 the tension force componentes of mooring line 1 in the coordinate system x t y t z t can be written as 24 d f l 1 x t sign x g 1 t x 1 f l 1 cos θ 1 sin ξ 1 d f l 1 y t sign 0 t y 1 f l 1 cos θ 1 cos ξ 1 d f l 1 z t f l 1 sin θ 1 where sin θ 1 t z 1 t x 1 x g 1 2 t y 1 2 t z 1 2 cos θ 1 t x 1 2 t y 1 2 t x 1 x g 1 2 t y 1 2 t z 1 2 sin ξ 1 x g 1 t x 1 t x 1 x g 1 2 t y 1 2 cos ξ 1 t y 1 t x 1 x g 1 2 t y 1 2 sign x is an operation of symbol judgment correspondingly the tension force components of mooring line 2 can be written as 25 d f l 2 x t sign 0 t x 2 f l 2 cos θ 2 sin ξ 2 d f l 2 y t sign y g 2 t y 2 f l 2 cos θ 2 cos ξ 2 d f l 2 z t f l 2 sin θ 2 where sin θ 2 t z 2 t x 2 2 t y 2 y g 2 2 t z 2 2 cos θ 2 t x 2 2 t y 2 y g 2 2 t x 2 2 t y 2 y g 2 2 t z 2 2 sin ξ 2 t x 2 t x 2 2 t y 2 y g 2 2 cos ξ 2 t y 2 y g 2 t x 2 2 t y 2 y g 2 2 then the tension force components of mooring line 3 can be written as 26 d f l 3 x t sign x g 3 t x 3 f l 3 cos θ 3 sin ξ 3 d f l 3 y t sign y g 3 t y 3 f l 3 cos θ 3 cos ξ 3 d f l 3 z t f l 3 sin θ 3 where sin θ 3 t z 3 t x 3 x g 3 2 t y 3 y g 3 2 t z 3 2 cos θ 3 t x 3 x g 3 2 t y 3 y g 3 2 t x 3 x g 3 2 t y 3 y g 3 2 t z 3 2 sin ξ 3 t x 3 x g 3 t x 3 x g 3 2 t y 3 y g 3 2 cos ξ 3 t y 3 y g 3 t x 3 x g 3 2 t y 3 y g 3 2 according to the above analysis one has 27 f g x d f b x t d f g x t d f f x t d f w x t i 1 3 d f l i x t f gy d f b y t d f g y t d f f y t d f w y t i 1 3 d f l i y t f gz d f b z t d f g z t d f f z t d f w z t i 1 3 d f l i z t 4 2 rotational motion model in rotational relations one has 28 i b x θ t x c b x θ t x k b x θ t x m x i b y θ t y c b y θ t y k b y θ t y m y i b z θ t z c b z θ t z k b z θ t z m z where i b x i b y and i b z are the mass moments of inertia of the floating platform about the x axis y axis and z axis respectively c b x c b y and c b z are the equivalent damping about the x axis y axis and z axis respectively k b x k b y and k b z are the equivalent stiffness about the x axis y axis and z axis respectively considering to be zero the moment components m x m y and m z should be calculated firstly for solving eq 28 the moments acting on the floating platform include the components of aerodynamic moment gravity moment centrifugal moment and moment of inertia from the blades the components of gravity moment from floating platform tower nacelle generator hub and ballast water the components of wave induced moment the components of the moment of the buoyancy and the components of the moment of the mooring line tension defining the moment components of a blade in the coordinate system x n y n z n is denoted by i 1 3 d m b x n i i 1 3 d m b y n i and i 1 3 d m b z n i the moment components in the coordinate system x r y r z r without considering yaw effect can be expressed as 29 d m b x r d m b y r d m b z r i 1 3 d m b x n i i 1 3 d m byn i i 1 3 d m bzn i meanwhile the forces d f b x n i d f b y n i and d f b z n i from the blades will also produce the corresponding moments to influence the rotational motion of the floating platform to consider these influences the forces from the blades in the coordinate system x 0 y 0 z 0 is first transformed into the coordinate system x r y r z r without considering the yaw effect d f b x r d f b y r d f b z r is equal to i 1 3 d f b x n i i 1 3 d f b y n i i 1 3 d f b z n i the moment expression in the coordinate system x r y r z r can be obtained as 30 d m δ b x r d m δ b y r d m δ b z r h t 0 0 0 h t 0 0 0 l h d f b y r d f b x r d f b x r l h d f b z r 0 0 where l h is the vertical distance from the hub to the z axis considering the hub generator and other components on the tower top as a whole the mass is denoted by m h g the vertical distance from its mass center to the z axis is denoted by l h g then in the coordinate system x r y r z r d f h g x r d f h g y r d f h g z r is equal to a t r 0 0 m h g g the corresponding moment expression can be expressed as 31 d m h g x r d m h g y r d m h g z r h t 0 0 0 h t 0 0 0 l h g d f h g y r d f h g x r d f h g x r l h g d f h g z r 0 0 not considering the flexible deformation of the tower the height from the mass center of the tower to its bottom is denoted by h t m the tower mass is denoted by m t then in the coordinate system x r y r z r d f t x r d f t y r d f t z r is equal to a t r 0 0 m t g the corresponding moment expression can be obtained as 32 d m t x r d m t y r d m t z r h t m d f t y r d f t x r 0 the gravity of the floating barrels 1 2 and 3 are the same in the coordinate system x r y r z r each of them can be written as d f p g x r d f p g y r d f p g z r a t r 0 0 m p g g correspondingly the gravity moment of the floating barrel 1 can be obtained as 33 d m p g 1 x r d m p g 1 y r d m p g 1 z r h p g d f p g y r d f p g x r 0 where h p g is the height from the mass center of the floating barrel to the bottom the gravity moment of the floating barrel 2 can be written as 34 d m p g 2 x r d m p g 2 y r d m p g 2 z r ℓ 1 0 0 0 h p g 0 0 0 ℓ 2 d f p g z r d f p g x r d f p g y r h p g 0 0 0 ℓ 2 0 0 0 ℓ 1 d f p g y r d f p g z r d f p g x r where ℓ 1 3 l g 2 r t 2 ℓ 2 l g 2 r t 2 then the gravity moment of the floating barrel 3 can be written as 35 d m p g 3 x r d m p g 3 y r d m p g 3 z r ℓ 1 0 0 0 h p g 0 0 0 ℓ 2 d f p g z r d f p g x r d f p g y r h p g 0 0 0 ℓ 2 0 0 0 ℓ 1 d f p g y r d f p g z r d f p g x r if the influence of the floating barrel tilt on the relative position of ballast water gravity center in the barrel is neglected the gravity of the ballast water in the floating barrel can be expressed as d f s g i x r d f s g i y r d f s g i z r a t r 0 0 m s g i g m s g i i 1 2 3 is the mass of the ballast water in the ith floating barrel correspondingly in the coordinate system x r y r z r the gravity moment of the ballast water in the floating barrel 1 can be written as 36 d m s g 1 x r d m s g 1 y r d m s g 1 z r h s g 1 d f s g 1 y r d f s g 1 x r 0 where h s g 1 is the height from the gravity center of the ballast water to the barrel bottom in the floating barrel 1 the gravity moment of the ballast water in the floating barrel 2 can be written as 37 d m s g 2 x r d m s g 2 y r d m s g 2 z r ℓ 1 0 0 0 h s g 2 0 0 0 ℓ 2 d f s g 2 z r d f s g 2 x r d f s g 2 y r h s g 2 0 0 0 ℓ 2 0 0 0 ℓ 1 d f s g 2 y r d f s g 2 z r d f s g 2 x r where h s g 2 is the height from the gravity center of the ballast water to the barrel bottom in the floating barrel 2 then the gravity moment of the ballast water in the floating barrel 3 can be written as 38 d m s g 3 x r d m s g 3 y r d m s g 3 z r ℓ 1 0 0 0 h s g 3 0 0 0 ℓ 2 d f s g 3 z r d f s g 3 x r d f s g 3 y r h s g 3 0 0 0 ℓ 2 0 0 0 ℓ 1 d f s g 3 y r d f s g 3 z r d f s g 3 x r in the coordinate system x r y r z r the wave induced moments acting on the floating platform includes two parts the first can be obtained from the deduced wave induced moments in the coordinate system x w y w z w that is 39 d m w i x r d m w i y r d m w i z r a t r a g w ϒ t m w i 0 0 where i 1 2 3 the second can be obtained from the deduced wave forces of the floating barrels 2 and 3 in the coordinate system x w y w z w in the coordinate system x r y r z r the wave induced force d f w i x r d f w i y r d f w i z r is equal to a t r a g w ϒ t 0 f w i 0 i 2 3 for the floating barrel 2 the wave induced moments in the coordinate system x r y r z r can be written as 40 d m w 2 x r d m w 2 y r d m w 2 z r ℓ 1 0 0 0 ℓ 2 0 0 0 ℓ 1 d f w 2 z r d f w 2 z r d f w 2 x r 0 0 0 0 0 0 0 0 ℓ 2 d f w 2 z r d f w 2 x r d f w 2 y r for the floating barrel 3 the wave induced moment in the coordinate system x r y r z r can be written as 41 d m w 3 x r d m w 3 y r d m w 3 z r ℓ 1 0 0 0 ℓ 2 0 0 0 ℓ 1 d f w 3 z r d f w 3 z r d f w 3 x r 0 0 0 0 0 0 0 0 ℓ 2 d f w 3 z r d f w 3 x r d f w 3 y r when analyzing the moment of the buoyancy the relative change of floating center in the floating barrels is neglected firstly the buoyancy in the coordinate system x t y t z t is transformed into the coordinate system x r y r z r that is d f f i x r d f f i y r d f f i z r a t r d f f i x t d f f i y t d f f i z t i 1 2 3 the moment of the buoyancy of the floating barrel 1in the coordinate system x r y r z r can be written as 42 d m f 1 x r d m f 1 y r d m f 1 z r h f 1 d f f 1 y r d f f 1 x r 0 where h f 1 is the height from the floating center to the floating barrel bottom and it can be approximately calculated according to the expression 1 2 h w s 1 h b 1 cos θ t x c o s θ t y the moment of the buoyancy of the floating barrel 2 in the coordinate system x r y r z r can be written as 43 d m f 2 x r d m f 2 y r d m f 2 z r ℓ 1 0 0 0 h f 2 0 0 0 ℓ 2 d f f 2 z r d f f 2 x r d f f 2 y r h f 2 0 0 0 ℓ 2 0 0 0 ℓ 1 d f f 2 y r d f f 2 z r d f f 2 x r the moment of the buoyancy of the floating barrel 3 in the coordinate system x r y r z r can be written as 44 d m f 3 x r d m f 3 y r d m f 3 z r ℓ 1 0 0 0 h f 3 0 0 0 ℓ 2 d f f 3 z r d f f 3 x r d f f 3 y r h f 3 0 0 0 ℓ 2 0 0 0 ℓ 1 d f f 3 y r d f f 3 z r d f f 3 x r to analyze the rotational moment due to the mooring line tension the mooring line tension in the coordinate system x t y t z t is first transformed into the coordinate system x r y r z r that is d f l i x r d f l i y r d f l i z r a t r d f l i x t d f l i y t d f l i z t i 1 2 3 correspondingly the moment of the mooring line tension of mooring line 1 in the coordinate system x r y r z r can be written as 45 d m l 1 x r d m l 1 y r d m l 1 z r r t d f l 1 z r 0 d f l 1 x r the moment of the mooring line tension of mooring line 2 in the coordinate system x r y r z r can be written as 46 d m l 2 x r d m l 2 y r d m l 2 z r a d f l 2 z r d f l 2 z r d f l 2 x r 0 0 0 0 0 0 0 0 ℓ 2 3 r t 2 d f l 2 z r d f l 2 z r d f l 2 y r where a 1 2 3 l g 2 r t r t 0 0 0 1 2 l g 2 3 r t 0 0 0 1 2 3 l g 2 r t r t the moment of the mooring line tension of mooring line 3 in the coordinate system x r y r z r can be written as 47 d m l 3 x r d m l 3 y r d m l 3 z r a d f l 3 z r d f l 3 z r d f l 3 x r 0 0 0 0 0 0 0 0 ℓ 2 3 r t 2 d f l 3 z r d f l 3 z r d f l 3 y r based on the above analysis the total moment expression is obtained as 48 m x d m b x r d m δ b x t d m h g x r d m t x r i 1 3 d m p g i x r i 1 3 d m s g i x r i 1 3 d m w i x r i 2 3 d m w i x r i 1 3 d m f i x r i 1 3 d m l i x r m y d m b y r d m δ b y t d m h g y r d m t y r i 1 3 d m p g i y r i 1 3 d m s g i y r i 1 3 d m w i y r i 2 3 d m w i y r i 1 3 d m f i y r i 1 3 d m l i y r m z d m b z r d m δ b z t d m h g z r d m t z r i 1 3 d m p g i z r i 1 3 d m s g i z r i 1 3 d m w i z r i 2 3 d m w i z r i 1 3 d m f i z r i 1 3 d m l i z r 5 case analysis 5 1 numerical model for the floating wind turbine to investigate the load and dynamic characteristics of the offshore floating wind turbine in operation a system scale numerical model should be first established combining it with the previous work dai et al 2012 2013 2017 the floating platform model is integrated into the wind turbine system as shown in fig 5 in addition the system model has also integrated rotor sub model main shaft sub model generator sub model converter sub model grid sub model controller sub model pitch sub model and so on the detailed introduction about these sub models can be found in the corresponding references for example the generator sub model and converter sub model can be found in reference dai et al 2012 it should be pointed out that this model is facing direct drive wind turbines thus no speed gearbox is considered in the main drive system both the mechanical torque from the turbine rotor and the electromagnetic torque from the generator directly act on the main shaft the result of their interaction will adjust the turbine rotor speed and generator rotor speed which influences the generator status and the aerodynamic status of the turbine rotor simultaneously on the other hand by comparing the power output of the generator and the power command the pitch controller will output the pitch angle command under the rated power the pitch angle keeps constant to pursuit the maximum power capture from air kinetic energy above the rated power the pitch angle varies with the wind speed to keep a stable power output near its rated value wind information from the wind sub model flows into the turbine rotor model to form the aerodynamic load on the one hand flows into the wind wave relationship model to influence the wave parameters such as wavelength and wave height on the other hand the load from the turbine rotor will transfer into the floating platform and then combine with the wave load to influence the motion status of the floating platform the simulation parameters of the floating wind turbine are shown in table 1 5 2 ballast water level distribution to keep the balance of the wind turbine the water level distribution of ballast water should be calculated the basic principle of water level distribution is that the total amount of ballast water in the three floats is constant and the water level is regulated in the three barrels assuming the floating platform is in equilibrium the sway effect is neglected when calculating the initial water level the initial draft depth of the floating platform is calculated according to eq 49 that is 49 h c m wt g 3 ρ w g π r t 2 where h c is the draft depth m wt is the mass of the wind turbine according to the parameters shown in table 1 the initial draft depth of the floating platform is 16 6 m considering that under the initial condition the floating platform is not inclined and the mooring line is free of tension the initial water level in barrel 2 and barrel 3 can be calculated by 50 2 ρ w g π r t 2 h c 2 m p g g ρ s g π r t b 2 h s 2 h s 3 σ 1 2 3 l g 2 r t ρ s g π r t b 2 h s 3 h s 2 σ 2 2 l g 2 r t where h s 2 h s 3 are the water levels in barrel 2 and barrel 3 respectively b is barrel wall thickness ρ s the density of the ballast water σ 1 d m b x r d m δ b x t d m h g x r d m t x r i 1 3 d m w i x r i 2 3 d m w i x r σ 2 d m b y r d m δ b y t d m h g y r d m t y r i 1 3 d m w i y r i 2 3 d m w i y r the input wind is shown in fig 6 a for simulation its mean value is 12 m s fig 6 b and c show the significant wave height hs and zero crossing period ts respectively according to the characteristics of the wind turbine the wind rotor speed is set to be 17 rpm then a typical value of σ 1 σ 2 is σ 1 0 n m σ 2 6 5 10 5 n m substituting the above conditions into eq 50 one has h s 2 h s 3 16 h s 3 h s 2 0 012 h s 1 8 01 h s 2 8 h s 3 7 99 according to the above results the moments of inertia of the floating wind turbine about the x r axis y r axis z r axis are 0 87 1010 kg m2 0 90 1010 kg m2 0 52 1010 kg m2 respectively 5 3 numerical simulation result analysis fig 7 shows the wave force and wave moment acting on the floating barrel 1 floating barrel 2 and floating barrel 3 respectively in the simulation process the wave direction is constant along y axis direction the interaction of wave between three floating barrels is ignored since the wind speed fluctuates near 12 m s in fig 6 the wavelength has a corresponding result fluctuating between 30 m and 46 m the ratio of diameter and wavelength d t l 0 of the floating barrel is larger than 0 2 thus large scale structure model is suitable for wave load calculating since the wave phase for floating barrel 1 and floating barrel 2 is different the wave forces acting on the two floating barrels show some differences in fig 7 a correspondingly the wave forces acting on floating barrel 2 and floating barrel 3 are basically the same since the wave phase for them are consistent when the simulation time is 16 2 s the maximum wave force appears about 2 9 106 n correspondingly the maximum wave moment is about 4 5 107 n m in fig 7 b where a sign indicates the direction fig 8 a c show the force load of floating barrel 1 along the x axis direction y axis direction and z axis direction in the coordinate system x t y t z t respectively they are the results of the comprehensive action of multiple loads from the figures it can be seen that the load component along x axis direction is the smallest the main reason is that this load component mainly comes from the side load of the wind turbine rotor relatively the load components along the y axis and the z axis are much larger when the mooring line is free the load along the y axis is mainly from the wind load and wave load and the load along the z axis is mainly from the gravity and buoyancy load of the wind turbine in the 20s simulation time the load along y axis varies from 5 4 106 n to 8 0 106 n fig 8 d f show the moment load of floating barrel 1 along the x axis direction y axis direction and z axis direction in the coordinate system x r y r z r respectively the relationship between force direction and moment direction is determined by the right hand rule obviously moment load along x axis direction in fig 8 d is larger than that along y axis direction and z axis direction shown in fig 8 e and f meanwhile moment along x axis direction is a result of force load synthesis in fig 8 a c with the increasing of simulation time the magnitude of force load variation along x axis direction has a decreasing trend which is similar to the variation trend of force load shown in fig 8 c it is also shown that the force load along z axis direction has a strong influence on the moment load along the x axis direction in the 20s simulation time moment along x axis direction varies between 1 5 109 n m and 1 6 109 n m moment along y axis direction varies between 1 3 106 n m and 2 0 106 n m moment along z axis direction varies between 3 4 105 n m and 8 2 105 n m fig 9 shows the rotation curves of the floating platform along the x axis y axis and z axis under the moment load the rotation angle around the x axis y axis and z axis are shown in fig 9 a c respectively from the simulation results it can be seen that the rotation angle around the x axis is larger than others shown this is because the moment load along the x axis in fig 8 in the simulation process is obviously greater than that along the y axis and the z axis direction although the absolute value of the rotation angle in fig 9 b and c is small it is gradually increasing this is because the simulation process has not yet joined the ballast water control link on the other hand the increase of the rotation angle around the y axis will bring about the difference of buoyancy on the three floating barrels and the change of buoyancy will have a certain inhibitory effect on the increase of the rotation angle this can be regarded as a passive adjustment of floating platform balance in addition the inhibition of the rotation angle around the y axis can also be achieved by adjusting the ballast water in the three floating barrels active regulation which requires the subsequent introduction of closed loop control strategy of the ballast water the increasing of rotation angle around the z axis is due to the existence of moment load along the z axis direction as shown in fig 8 f it is also found that both positive and negative values appear in fig 8 f which means that the moment direction will vary this has a certain inhibitory effect on the increase of the rotation angle in the following control strategy the introduction of yaw and other active control methods for balance control can also be considered fig 9 d f show the angular velocity curves of the floating platform around the x axis y axis and z axis respectively it is clear that the angular velocity around the x axis has the maximum in the 20s simulation time its value varies between 0 14 rad s and 0 15 rad s relatively angular velocities around the y axis and z axis are smaller the angular velocity around the y axis has the trend of varying between positive and negative values the angular velocity around the z axis has the trend of gradually increasing fig 9 g i show the angular acceleration curves of the floating platform around the x axis y axis and z axis respectively in the 20s simulation time the variation trends of the floating platform around the x axis y axis and z axis are obviously different and the maximum values are 0 14 rad s2 1 6 10 4 rad s2 and 8 6 10 5 rad s2 respectively fig 10 shows the rotation angle around the x axis under different damping it can be seen from the figure that the damping coefficient has some influence on the motion characteristics however at present there is no effective method to calculate the motion damping and the more accurate analysis of the motion characteristics needs to adjust the motion damping according to the experimental or field data in the future 6 conclusions the complexity of load and motion of offshore floating wind turbines has limited the practical application in this paper the analysis of the operating load and motion characteristics of offshore floating wind turbines is helpful to understand its operation mechanism and provide a reference for design and operation control it is effective to use multiple coordinate systems to describe the load and motion characteristics of the offshore floating wind turbine multiple loads including wind load wave load gravity load inertia load and centrifugal force load are easy to establish and transform in multiple coordinate systems after dividing the motion of the floating platform into translational motion and rotational motion the idea of progressive iteration is used to solve the complex motion process by integrating the input wind model blade wind turbine rotor model shaft model generator model converter model grid model controller model pitch model floating platform model and other models in the simulink environment a system model of the offshore floating wind turbine is obtained and the numerical simulation investigation is carried out through the load and the motion model constructed in this paper the load variation and the motion process of the offshore floating wind turbine can be effectively reflected however due to the large number of parameters involved in the model some parameters for example the effective damping of motion have not been calculated theoretically and need further research acknowledgements this work is supported by national natural science foundation of the people s republic of china grant number 51675175 and state scholarship fund grant number 201408430267 national key research and development program of people s republic of china grant number 2016yff0203400 hunan provincial natural science foundation grant number 2016jj5024 and scientific research fund of hunan provincial education department grant number 15b084 nomenclature x g y g z g coordinate system fixed on the seabed x t y t z t coordinate system fixed at the bottom of floating barrel 1 without rotating with the platform x r y r z r coordinate system fixed at the bottom of floating barrel 1 rotating with the platform x n y n z n coordinate system fixed on the nacelle x 0 y 0 z 0 coordinate system fixed on the shaft of the wind turbine rotor x 1 y 1 z 1 coordinate system fixed on blade 1 x w y w z w coordinate system whose y axis is consistent with the wave direction f v aerodynamic thrust acting on the wind turbine rotor f w 1 f w 2 f w 3 wave loads acting on the three floating barrels f t g gravity of the tower and other components above the tower f p g 1 f p g 2 f p g 3 gravities of the three floating barrels f s g 1 f s g 2 f s g 3 gravities of the ballast water in the three barrels f f 1 f f 2 f f 3 buoyancies of the three floating barrels f w sum of wave force along the flow direction d f g x t d f g y t d f g z t gravity load in the coordinate system x n y n z n f g x f gy f gz forces in x axis y axis and z axis d f b x n i d f byn i d f bzn i force components of a blade in the coordinate system x n y n z n d f b x t d f b y t d f b z t force components from the blade in the coordinate system x t y t z t d f g x t d f g y t d f g z t force components of gravity from the floating platform tower nacelle generator hub and ballast water in the coordinate system x t y t z t d f f x t d f f y t d f f z t force components of buoyancy in the coordinate system x t y t z t d f w x t d f w y t d f w z t force components of wave force in the coordinate system x t y t z t d f l i x t d f l i y t d f l i z t components of the force f l i f l i tension force of mooring line d f b x r d f b y r d f b z r force components from the blades in the coordinate system x r y r z r d f h g x r d f h g y r d f h g z r force components from the hub generator and other components on the tower top in the coordinate system x r y r z r d f t x r d f t y r d f t z r force components in the coordinate system x r y r z r d f s g i x r d f s g i y r d f s g i z r gravity of the ballast water in the floating barrels in the coordinate system x r y r z r d f p g x r d f p g y r d f p g z r gravity components in the coordinate system x r y r z r d f w i x r d f w i y r d f w i z r deduced wave forces of the floating barrels 2 and 3 in the coordinate system x r y r z r d f f i x r d f f i y r d f f i z r buoyancy in the coordinate system x r y r z r d f l i x r d f l i y r d f l i z r mooring line tension in the coordinate system x r y r z r f w wave force f d f i drag force and inertia force of wave force on small scale structures h t height from the top of floating barrel 1 to the hub center h f t height of the floating barrel h s 1 h s 2 h s 3 heights of the ballast water in the three barrels h b 1 h b 2 h b 3 heights from the seabed to the bottom of the floating barrels h w s water depth h s significant wave height h wave height h t m height from the mass center of the tower to its bottom h p g height from the mass center of the floating barrel to the bottom h s g i height from the gravity center of the ballast water to the ith barrel bottom h f i height from the floating center to the floating barrel bottom h c draft depth h s i water level in the ith barrel l g length of the connecting pipe between the three floating barrels l s length of the mooring line l h vertical distance from the hub to the z axis l h g vertical distance from the mass center of m h g to the z axis m f equivalent mass of the floating platform m h g mass when considering the hub generator and other components on the tower top as a whole m t tower mass m wt mass of the wind turbine m s g i mass of the ballast water in the ith floating barrel m b the quality of the blade per unit length θ t x θ t y θ t z angles of rotation around the x axis y axis and z axis a t r θ tz a t r θ t x a t r θ t y a t r a g w t g t t t g transformation matrixes d t d n torque component and thrust component produced by the blade element v inflow wind speed b barrel wall thickness c chord length of the blade element r b local radius φ local flow angle α local angle of attack c l c d lift coefficient and drag coefficient c t c n tangential force coefficient and normal force coefficient c d c m drag coefficient and inertia coefficient of wave force ρ air density ρ s density of the ballast water ρ w density of the sea water ω rotor rotational speed ω b wave frequency a a axial induction factor and tangential induction factor f combined tip loss and hub loss coefficient n b number of blades σ rotor solidity d l d d lift force component and draft force component β pitch angle t 0 zero crossing period s ω spectrum function v 19 5 wind speed at the height of 19 5 m above the sea surface ϒ rotation angle between coordinate system x g y g z g and coordinate system x w y w z w d t diameter of the floating barrel l l 0 wavelength a cross sectional area perpendicular to the flow direction u y flow velocity v 0 volume of the body k 2 π l c d t 2 α arctan π k c 2 4 a k c 1 0 25 4 π 2 k c 4 η h cos k y ω b t 2 c w x c w y c w z equivalent damping about the x axis y axis and z axis c b x c b y c b z equivalent damping about the x axis y axis and z axis k w x k w y k w z equivalent stiffness about the x axis y axis and z axis k b x k b y k b z equivalent stiffness about the x axis y axis and z axis k l stiffness of mooring line θ i i 1 2 3 angle between mooring line and the bottom of the sea ξ i i 1 2 3 angle between the component f l i cos θ i and y axis i b x i b y i b z mass moments of inertia of the floating platform about the x axis y axis and z axis m w wave moment m x m y m z moments in the x axis y axis and z axis d m b x n i d m b y n i d m b z n i moment components of a blade in the coordinate system x n y n z n d m b x r d m b y r d m b z r moment components from the blades in the coordinate system x r y r z r d m δ b x r d m δ b y r d m δ b z r moment components in the coordinate system x r y r z r d m h g x r d m h g y r d m h g z r moments in the coordinate system x r y r z r d m t x r d m t y r d m t z r moment components in the coordinate system x r y r z r d m p g i x r d m p g i y r d m p g i z r gravity moments of the floating barrels in the coordinate system x r y r z r d m s g i x r d m s g i y r d m s g i z r gravity moment components of the ballast water in the ith floating barrel in the coordinate system x r y r z r d m w i x r d m w i y r d m w i z r deduced wave induced moment in the coordinate system x r y r z r d m w i x r d m w i y r d m w i z r wave induced moments in the coordinate system x r y r z r d m f i x r d m f i y r d m f i z r moment of the buoyancy in the coordinate system x r y r z r d m l i x r d m l i y r d m l i z r moment of the mooring line tension in the coordinate system x r y r z r 
23369,the magnitude 7 8 kaikoura earthquake on the north eastern coast of south island new zealand induced a tsunami which affected many north facing bays in banks peninsula the v shaped little pigeon bay experienced pronounced inundation compared to adjacent bays causing heavy damage to a cottage at the head of the bay in order to investigate the characteristics of the tsunami flow in the bay a numerical model based on nonlinear shallow water theory was established using tidal levels from the neighbouring sumner sea level gauge three incident wave angles were tested ranging from due north to 30 east of north the simulated maximum run up heights were validated with surveyed results for all the wave directions a resonance with a period of 6 3 min was found from 50 to 100 min in the simulation based on the physical dimensions of little pigeon bay idealised models were set up to analyse the influence of v shaped embayment on maximum water level maximum velocity and maximum momentum flux bays with sand bars of different crest heights were also investigated a sand bar with a relatively low crest height d w d 0 5 did not significantly reduce the maximum velocity and the maximum momentum flux keywords run up tsunami bay local macro roughness 1 introduction most historical tsunamis that reach new zealand coasts are from distant origins near the pacific coast e g japan and chile eiby 1982 borrero et al 2015 borrero and goring 2015 however local earthquakes submarine landslides volcanic eruptions or meteor induced tsunamis can cause damage to coastal structures and buildings posing a threat to local communities eiby 1982 at 11 02 56 a m november 13 2016 utc a magnitude 7 8 earthquake struck kaikoura 42 69 s 173 02 e on the north eastern coast of the south island new zealand and induced a small scale tsunami in nearby coasts fig 1 a the v shaped little pigeon bay in banks peninsula experienced pronounced inundation compared to adjacent bays tsunami propagation and inundation has been studied extensively in previous research e g field investigation matsutomi and okamoto 2010 mori et al 2011 shimozono et al 2012 analytical solutions carrier et al 2003 madsen and schäffer 2010 experimental research park et al 2013 and numerical modelling fraser et al 2014 gusman et al 2014 nandasena et al 2012 synolakis et al 2008 wei et al 2013 many researchers have investigated tsunami propagation in a bay using analytical and numerical models didenkulova and pelinovsky 2011 investigated tsunami wave run up in u shaped bays using linear shallow water theory and noted the significant wave amplification in bays with a non reflecting bottom strongly varying depth along the wave path the geometry of a bay can amplify the tsunami flow leading to heavy damage to buildings at the heads of bays didenkulova 2013 two models a plane beach model and an inclined bay model were used to estimate the tsunami run up in pago pago harbour tutuila american samoa these two models produced similar wave shapes and the inclined bay model gave higher run up heights baldock et al 2007 investigated tsunami run up on a plane beach and in square bays v shaped bays and u shaped bays and compared the results with analytical solutions they found the tsunami run up was higher when shorter period tsunami waves travelled towards a small v shaped bay however for longer period waves the amplification effect was much less the run up results are frequency sensitive and influenced by other factors such as the size of the bay the wave profile and the ratio of long shore width over cross shore length of the bay embayment can increase tsunami inundation with a narrow embayment causing larger increase in inundation distance than a wide embayment the wave amplification and the inundation distance depend on tsunami wave characteristics tidal level and bottom roughness as well as the coastal bathymetry gelfenbaum et al 2011 apotsos et al 2011 investigated sediment deposition in fagafue bay on america samoa as well as in idealised bays of similar dimensions it was suggested that the limited sediment supply and steep onshore topography could reduce the deposition onshore few studies have been conducted to investigate the influence of tsunami waves on the flow in a bay with complex bathymetries the balance between wave shoaling and dissipation in such bays is related to coastal morphology characteristics of the shoals and the tsunami gelfenbaum et al 2011 kunkel et al 2006 fritz et al 2011 simulated tsunami behaviour in pago pago harbour using different source models a single normal fault source mechanism was able to reproduce the water level in the bay satisfactorily løvholt et al 2015 used measured surface elevation as input to boussinesq models and long wave solvers to investigate tsunami propagation in a fjord system they found that leading waves are influenced by nonlinearity and dispersion while dispersion and dissipation are more important for trailing waves iglesias et al 2014 explored the influence of the morphology and orientation of submarine canyons on tsunami propagation and impact the tsunami related wave resonance was also studied by some researchers two categories of natural modes i e local resonance generated by coastline features and a large scale resonance of the continental shelf can contribute to tsunami amplification bellotti et al 2012 the combined oscillations of shelf and embayment concentrate the tsunami energy and exacerbated the tsunami wave impact roeber et al 2010 in order to understand the tsunami propagation and flow characteristics in little pigeon bay the authors carried out numerical simulations using three incident wave angles the effect of the wave angles on tsunami run up was investigated further the authors set up idealised numerical models with and without a sand bar in a v shaped bay to investigate the effect of embayment and the effect of the crest height of the sand bar in the bay on maximum water level maximum velocity and maximum momentum flux per unit mass per unit width 2 numerical model of little pigeon bay 2 1 governing equations to simulate the tsunami flow in shallow water and overland two dimensional depth integrated nonlinear shallow water wave equations were applied the continuity and the momentum equations are respectively 1 ζ t q x x q y y 0 2 q x t x q x 2 h y q x q y h g h ζ x τ x ρ 0 3 q y t x q x q y h y q y 2 h g h ζ y τ y ρ 0 where h is the flow depth ζ the water surface elevation q x q y the discharge fluxes in x and y direction respectively g the gravitational force ρ the water density τ x τ y the bed shear stress in x and y directions defined in eq 4 and eq 5 respectively 4 τ x ρ g n 2 q x q x 2 q y 2 h 7 3 5 τ y ρ g n 2 q y q x 2 q y 2 h 7 3 where n is the manning s roughness coefficient the tsunami flow was assumed to be quasi steady at any instant in the simulation 2 2 numerical set up and conditions the above equations were solved by the finite difference method with an upwind scheme a constant manning coefficient of 0 025 m 1 3 s was used as the roughness parameter which was suggested by previous studies bunya et al 2010 koshimura et al 2009 for coastal areas in order to avoid generating tsunami waves based on the tsunami source mechanism the model was forced in 22 m still water depth from the north of little pigeon bay using measured water levels at sumner gauge fig 1a the sumner gauge 43 34 s 172 34 e is located near the coast 12 26 km northwest of little pigeon bay fig 1a fig 1b shows the model domain extending 14 01 km in the x direction and 7 68 km in the y direction the cross and alongshore grid sizes were 10 m for all the test cases bathymetric data of the bay were obtained from linz 2016 fig 2 shows the bathymetry of little pigeon bay this bay is 1350 m long 850 m wide and 17 3 m deep at the mouth the funnel shaped bathymetry is likely to concentrate wave energy propagating onshore a bar can be seen at location 3 fig 2 which separates the bay into the inner bay and the outer bay the incident wave was given as a time series using measured water level with tidal level variations removed from the original source fig 3 the non reflective wave boundary condition was applied one hour after the earthquake the water level in sumner gauge fig 1a began to fluctuate based on the zero up crossing analysis the maximum tsunami wave height peak to trough height was 0 96 m at 3 83 h after the earthquake the wave period during the period from 1 h to 7 h after the earthquake ranged from 10 min to 39 min due to uncertainty in the tsunami wave direction three incident wave angles were tested in the numerical modelling i e waves from due north 15 east of north and 30 east of north figs 1 and 2 for different wave approach angles the bathymetry was rotated accordingly while the wave generating boundary remained at around 22 m still water depth the simulation started 1 h after the earthquake when perturbations in water level occurred with a total simulation time of 6 h the datum atl hereafter in this study which was the average tidal level during the simulated 6 h of the tsunami was 1 14 m higher than nzvd2016 3 numerical model results little pigeon bay 3 1 validation of run up heights a cottage location 6 in fig 2 near the head of the bay was heavily damaged due to the uplift forces debris impacts and sediment deposition from the tsunami the floor of the cottage was at an elevation of 1 26 m atl the land near the house was mostly covered by grass with dotted trees a map of the tsunami run up heights around the cottage obtained from inshore debris deposits and water marks on the walls of the house is given in lane et al 2017 the water marks on the house showed the tsunami run up height at the side of the cottage was 3 73 m above nzvd2016 which was 2 59 m relative to the datum of this study lane et al 2017 power et al 2017 the maximum run up heights at the cottage location 6 in fig 2 in the simulation were 2 8 m 3 06 m and 3 5 m for waves coming from bearings 0 15 and 30 respectively the maximum run up heights occurred at 184 min 104 min and 188 min respectively after wave generation at the boundary as discussed in section 5 1 the maximum run up height at the cottage during waves coming from due north corresponds well with the measured maximum run up height at the same location 3 2 effect of incident wave direction 3 2 1 water surface elevations at the head of the bay water surface elevations at the head of the bay location 5 in fig 2 for different incident wave angles are shown in fig 4 the undulations of input wave signals induced short period oscillations from 50 min to 100 min which are investigated further in section 5 1 the maximum water surface elevations in the bay increased with wave bearing increasing from bearings 0 30 the time when the maximum surface elevations occurred was also influenced by the wave incident angle as discussed in section 5 1 3 2 2 maximum tsunami wave heights fig 5 shows the maximum tsunami wave heights peak to trough along the centre of the bay locations 1 to 6 in fig 2 the maximum tsunami wave heights were the highest at the head of the bay most likely caused by energy concentration due to the narrowing shape and local resonance as can be seen from the graph the maximum tsunami wave height was sensitive to the incident wave angle and increased from the mouth of the bay location 1 in fig 2 to the head of the bay location 5 in fig 2 for waves from bearings 0 and 15 the tsunami wave height increased along the bay and the maximum tsunami wave heights were 4 7 m and 4 9 m respectively for waves from a bearing of 30 the tsunami wave height was high from the mouth of the bay location 1 in fig 2 and was 6 38 m at its maximum when it reached the head of the bay location 5 in fig 2 3 2 3 tsunami impact evaluation the tsunami pilot study working group 2006 suggested the momentum flux per unit mass per unit width hu 2 as the most suitable damage indicator where h is the total flow depth and u is the flow velocity the momentum flux can be higher due to substantial current speed during tsunami rundown even though the flow depth remains small tsunami pilot study working group 2006 fig 6 a shows the distribution of the maximum velocity magnitude when tsunami waves came from the north the maximum velocity occurred in the middle of the bay where the flow depth was shallower due to the existence of a sand bar the shoals near both sides of the bay also concentrated the tsunami wave energy and caused the velocity to increase the high magnitude velocity in the middle of the bay might induce severe scour around structures e g breakwaters and bridge piers built in this area the flow velocity was lowest at the head of the bay where it was less than 0 5 m s fema p 646 2012 gives the following formulation for calculating the tsunami induced hydrodynamic force on a structure when the tsunami flow depth is lower than the height of the structure 6 f d 0 5 ρ s c d b h u 2 max where ρ s is the fluid density c d the drag coefficient dependent on the size shape and orientation of the structure and b the width of the structure normal to the flow direction fig 6b demonstrates the maximum momentum flux distribution when tsunami waves came from due north in the bay the maximum momentum flux occurred in the middle of the bay where the maximum flow velocity was higher which indicates the higher forces exerted on an emergent structure built in a shallow water area in the bay the maximum velocity and the maximum momentum flux occurred at the same time for locations 1 to 6 fig 2 for locations 5 and 6 at head of bay fig 2 the maximum velocity and the maximum momentum flux occurred at 101 min when the water level was at a small trough between two peaks for locations 1 and 3 fig 2 the maximum values occurred at 201 min and 145 min respectively when the water level was at about still water level during the flow runup after the extreme drawdown for location 2 fig 2 the maximum values occurred shortly after the extreme drawdown prior to the flow reversal the maximum velocity and the maximum momentum flux occurred earlier for locations at the inner part of the bay locations 4 5 and 6 in fig 2 carrier et al 2003 found the momentum flux reaches its maximum value near the extreme draw down location this agrees well with the results of the present study the difference might be due to the influence of the local bathymetry in park et al 2013 when solitary waves propagated to the macro roughness land the maximum water surface elevation the maximum velocity and the maximum momentum flux did not occur at the same locations or times the maximum velocity occurred earlier than both the maximum momentum flux and the maximum surface elevation as it remained at the front part of the wave 4 numerical model idealised bay with a sand bar 4 1 model set up idealised models were set up to simulate tsunami waves entering a v shaped bay and effects on those waves of a sand bar in the bay the idealised v shaped bay was based on the physical dimensions of little pigeon bay 1350 m long 850 m wide and 17 3 m deep at the mouth with a sloping bottom fig 7 the idealised sloping beach had a uniform cross shore profile as shown in fig 7b the model domain was 6 71 km in x direction and 2 55 km in y direction for all the simulations the wave signals were the same as that used in the simulation of tsunami propagation to little pigeon bay fig 3 the wave generating boundary was at 22 m still water depth and the cross shore location where x 0 table 1 shows the test cases of the idealised models d w indicates still water depth above the sand bar d indicates the still water depth without a sand bar fig 7b the datum was mean sea level msl the initial water depth in the location of a sand bar was 7 m where x 5800 m fig 7b 4 2 effects of narrow v shaped embayment a resonance with a period of about 6 3 min was found in all the simulation cases from 50 to 100 min the high frequency water level variations led to a high frequency velocity change fig 8 shows a the maximum velocity in the x direction and b maximum momentum flux per unit mass per unit width of a sloping beach and a v shaped bay cases 6 and 1 respectively in table 1 note in the centreline of the bay the velocity in y direction is negligible and the velocity in x direction ux is the dominant component the maximum velocity in x direction was significantly higher at the head of the bay than that in a sloping beach for the given tsunami wave signals the v shape embayment led to an increase in the maximum velocity from 1 89 m s to 3 85 m s from the middle of the bay to offshore the maximum velocity in x direction was slightly larger than that in the same location for a sloping beach fig 8a the maximum velocity in x direction in the bay occurred at the still water depth 0 4 m at 75 min when the resonance appeared the water level when the maximum velocity magnitude occurred was at a peak of 2 59 m the maximum velocity in x direction in the sloping beach occurred at the still water depth 0 66 m at 157 min during the uprush of the flow for locations at the head of the bay the high frequency variations of water level from 50 min to 100 min contributed to the higher velocities the drop in the maximum velocity around x 6170 m in the v shaped bay is attributed to the difference of time at which the maximum velocity occurred from the outer bay to the centre of the bay the maximum velocity occurred at 145 250 min from the centre of the bay to the head of the bay the maximum velocity occurred at 50 100 min when the resonance appeared fig 8b shows the maximum momentum flux per unit mass per unit width hu 2 of case 1 and case 6 table 1 the maximum momentum flux decreased from the offshore to the coast on the centreline for the sloping beach model for the v shaped bay the maximum momentum flux reached its maximum value of 16 2 m3 s2 at the head of the bay due to higher velocities the maximum momentum flux in the bay occurred at the still water depth 1 04 m at 75 min when flow velocity reached a peak of 3 14 m s the corresponding water level was at around mean sea level 4 3 effects of a sand bar in a v shaped bay a sand bar was added in the middle of the bay for cases 2 to 5 with crest heights 3 m 2 5 m 1 5 m and 0 m relative to msl for case 5 table 1 with the highest sand bar the time series of water depth velocity in x direction ux and froude number fr on top of the sand bar x 5800 m in the centreline of the bay are shown in fig 9 fr is defined as 7 f r u g h where u is the flow velocity h the water depth and g the gravitational acceleration in almost all the simulation time fr was less than 1 and the flow was subcritical the maximum ux the maximum water depth and the maximum fr on top of the sand bar occurred at different time for each tsunami wave up rushing the time of the peak water depth was 1 5 min later than the time of the peak ux the maximum fr induced by each tsunami wave occurred during the wave recession the flow over the sand bar throughout this study can be identified as submerged type tanaka and sato 2015 the water cushion effects behind the sand bar was important in reducing the potential energy loss fig 10 demonstrates the distribution of the maximum water level the maximum velocity and the maximum momentum flux per unit mass per unit width along the centreline of the bay x direction the maximum water level in the bay ranged from 2 5 m to 4 0 m relative to msl and showed a rising trend from the mouth to the head of the bay due to the shoaling and amplification of tsunami waves fig 10a for relatively low crest height case 2 the maximum water level was almost the same as case 1 without a sand bar the sand bar in case 4 led to the most significant change in the maximum water level compared to case 1 the sand bar could increase the maximum flow velocity around the sand bar while decreasing the maximum flow velocity in the inner bay from the sand bar to the coast fig 10b as the height of the sand bar increased the maximum flow velocity decreased in the inner bay for d w d less than 0 5 the maximum velocity in the bay occurred above the sand bar after the resonance period from 50 to 100 min for d w d from 0 5 to 1 the maximum velocity in the bay occurred at the head of the bay after the resonance period the existence of the sand bar delayed the time when the maximum value of the velocity occurred it appears that the sand bar changed the resonance characteristics of the bay fig 10c shows the sand bar with a relatively low crest height d w d 0 5 did not reduce the maximum momentum flux per unit mass per unit width rather it increased the momentum flux at the head of the bay and around the sand bar if d w d was less than 0 5 it reduced the maximum momentum flux from the backside of the sand bar to the head of the bay the maximum value in the whole bay occurred above the sand bar the maximum value at the head of the bay occurred at 99 min for d w d from 0 5 to 1 the maximum momentum flux in the bay occurred during the resonance period for d w d less than 0 5 the maximum momentum flux in the bay occurred after the resonance period 5 discussion 5 1 local resonance in little pigeon bay in the three cases a noticeable resonance with a period of about 6 3 min was found from 50 to 100 min fig 4 fig 3 shows waves of this period within the 50 100 min time band but fewer thereafter the bay amplified the frequency and longer periods that were also visible from 50 min to 100 min appear to be suppressed somewhat the weakest resonance occurred when waves came from 30 east of north and the resonance was most significant at the head of the bay locations 5 and 6 in fig 2 the strongest resonance occurred when waves came from 15 east of north leading to the earlier occurrence of the maximum water level section 3 1 lane et al 2017 found resonance signals with periods of about 7 min along the bay in their local inundation modelling in their simulation the maximum water level occurred at approximately 150 min after the earthquake 90 min relative to the starting time in this study due to a resonant response of the bay an idealised triangular bay with a sloping bottom of similar size to little pigeon bay gave an analytical fundamental resonance period of 6 6 min following rabinovich 2008 8 t 0 1 653 2 l g h 1 1 2 where l is the length of the bay h 1 the still water depth at mouth of the bay these correspond well with the simulated results 5 2 local amplification of tsunami waves in little pigeon bay for alongshore uniform coasts tsunami run up was highest when the incident waves came perpendicular to the shore harbitz et al 2014 in pedersen 2011 the run up heights decreased with increasing incident wave angle for non breaking solitary waves in the present study the tsunami wave height in little pigeon bay was less than its maximum when tsunami waves propagated straight to the bay i e waves from 15 east of north fig 3 the 30 bearing was the worst case as the outer half of the bay is open to that direction the tsunami waves were reflected off the sides of the bay to be funnelled around the corner and up the bay the reflection and refraction of the tsunami waves in the bay amplified the tsunami heights 5 3 implications for construction of artificial bed sills although the sand bar in a bay can be washed away or reshaped during tsunami impact the modelling of sand bars as impermeable immobile structures in this study demonstrates the influence of sand bars on the tsunami flow in a bay and there are implications for the construction of artificial bed sills or submerged dikes in a bay artificial bed sills might be built offshore to reduce tsunami run up heights or hurricane damage in coastlines or to protect marshy wetland and enhance coastal ecosystem gittman et al 2014 smith et al 2017 in addition reefs exist in some bays gelfenbaum et al 2011 investigated the influence of the reef width on the inundation distance maximum velocity and maximum wave height at the shoreline they found that narrow reefs less than 200 m wide induce greater wave heights velocities and inundation inland than wide reefs as the reef widths increase tsunami wave heights and velocities decrease and the tsunami inundates less distance based on the present study and current knowledge of the influence of bed sills in a bay on mitigation of tsunamis it is recommended the d w d of proposed bed sills be less than 0 5 although the wider the bed sills are the more effective of them in reducing tsunami wave heights onshore and velocities the width of artificial bed sills should be determined based on the balance of cost and effectiveness 6 conclusion the main conclusions are 1 using water level signals recorded from sumner tidal gauge 12 26 km northwest of little pigeon bay the run up height at a cottage corresponds well with the simulation in which tsunami waves came from due north for wave directions from due north to 30 east of north the increasing wave bearing leads to greater tsunami run up and tsunami wave heights along the centre of the bay due to wave focusing to the bay combined with wave refraction diffraction and reflection a resonant period of about 6 3 min was found for different wave angles compared to 6 6 min calculated from an idealised v shaped bay following rabinovich 2008 2 the maximum velocity in little pigeon bay when waves came from the north occurred in the centre of the bay due to shoaling in the shallower water depth tsunami wave energy was concentrated in the inner part of the bay resulting in greater velocities and greater momentum fluxes which was confirmed by idealised model results with a sand bar in the centre of the bay 3 for the idealised models under the same tsunami attack as that in little pigeon bay the embayment increased the maximum velocity and the maximum momentum flux in the inner part of the bay at the head of the bay the high frequency variations of water level relative to a tsunami about 6 3 min period due to the local resonance contributed to the velocity increase 4 the sand bar with a relatively low crest height d w d 0 5 was not effective in reducing the maximum velocity and the maximum momentum flux but higher sand bars were more effective the sand bar always resulted in a spike in the maximum velocity and the maximum momentum flux around the sand bar due to the energy concentration acknowledgements this research is funded by the natural hazards research platform new zealand the authors acknowledge the valuable suggestions from graham macky and benjamin popovich s help in preparing the bathymetry of little pigeon bay the comments from two anonymous reviewers are acknowledged 
23369,the magnitude 7 8 kaikoura earthquake on the north eastern coast of south island new zealand induced a tsunami which affected many north facing bays in banks peninsula the v shaped little pigeon bay experienced pronounced inundation compared to adjacent bays causing heavy damage to a cottage at the head of the bay in order to investigate the characteristics of the tsunami flow in the bay a numerical model based on nonlinear shallow water theory was established using tidal levels from the neighbouring sumner sea level gauge three incident wave angles were tested ranging from due north to 30 east of north the simulated maximum run up heights were validated with surveyed results for all the wave directions a resonance with a period of 6 3 min was found from 50 to 100 min in the simulation based on the physical dimensions of little pigeon bay idealised models were set up to analyse the influence of v shaped embayment on maximum water level maximum velocity and maximum momentum flux bays with sand bars of different crest heights were also investigated a sand bar with a relatively low crest height d w d 0 5 did not significantly reduce the maximum velocity and the maximum momentum flux keywords run up tsunami bay local macro roughness 1 introduction most historical tsunamis that reach new zealand coasts are from distant origins near the pacific coast e g japan and chile eiby 1982 borrero et al 2015 borrero and goring 2015 however local earthquakes submarine landslides volcanic eruptions or meteor induced tsunamis can cause damage to coastal structures and buildings posing a threat to local communities eiby 1982 at 11 02 56 a m november 13 2016 utc a magnitude 7 8 earthquake struck kaikoura 42 69 s 173 02 e on the north eastern coast of the south island new zealand and induced a small scale tsunami in nearby coasts fig 1 a the v shaped little pigeon bay in banks peninsula experienced pronounced inundation compared to adjacent bays tsunami propagation and inundation has been studied extensively in previous research e g field investigation matsutomi and okamoto 2010 mori et al 2011 shimozono et al 2012 analytical solutions carrier et al 2003 madsen and schäffer 2010 experimental research park et al 2013 and numerical modelling fraser et al 2014 gusman et al 2014 nandasena et al 2012 synolakis et al 2008 wei et al 2013 many researchers have investigated tsunami propagation in a bay using analytical and numerical models didenkulova and pelinovsky 2011 investigated tsunami wave run up in u shaped bays using linear shallow water theory and noted the significant wave amplification in bays with a non reflecting bottom strongly varying depth along the wave path the geometry of a bay can amplify the tsunami flow leading to heavy damage to buildings at the heads of bays didenkulova 2013 two models a plane beach model and an inclined bay model were used to estimate the tsunami run up in pago pago harbour tutuila american samoa these two models produced similar wave shapes and the inclined bay model gave higher run up heights baldock et al 2007 investigated tsunami run up on a plane beach and in square bays v shaped bays and u shaped bays and compared the results with analytical solutions they found the tsunami run up was higher when shorter period tsunami waves travelled towards a small v shaped bay however for longer period waves the amplification effect was much less the run up results are frequency sensitive and influenced by other factors such as the size of the bay the wave profile and the ratio of long shore width over cross shore length of the bay embayment can increase tsunami inundation with a narrow embayment causing larger increase in inundation distance than a wide embayment the wave amplification and the inundation distance depend on tsunami wave characteristics tidal level and bottom roughness as well as the coastal bathymetry gelfenbaum et al 2011 apotsos et al 2011 investigated sediment deposition in fagafue bay on america samoa as well as in idealised bays of similar dimensions it was suggested that the limited sediment supply and steep onshore topography could reduce the deposition onshore few studies have been conducted to investigate the influence of tsunami waves on the flow in a bay with complex bathymetries the balance between wave shoaling and dissipation in such bays is related to coastal morphology characteristics of the shoals and the tsunami gelfenbaum et al 2011 kunkel et al 2006 fritz et al 2011 simulated tsunami behaviour in pago pago harbour using different source models a single normal fault source mechanism was able to reproduce the water level in the bay satisfactorily løvholt et al 2015 used measured surface elevation as input to boussinesq models and long wave solvers to investigate tsunami propagation in a fjord system they found that leading waves are influenced by nonlinearity and dispersion while dispersion and dissipation are more important for trailing waves iglesias et al 2014 explored the influence of the morphology and orientation of submarine canyons on tsunami propagation and impact the tsunami related wave resonance was also studied by some researchers two categories of natural modes i e local resonance generated by coastline features and a large scale resonance of the continental shelf can contribute to tsunami amplification bellotti et al 2012 the combined oscillations of shelf and embayment concentrate the tsunami energy and exacerbated the tsunami wave impact roeber et al 2010 in order to understand the tsunami propagation and flow characteristics in little pigeon bay the authors carried out numerical simulations using three incident wave angles the effect of the wave angles on tsunami run up was investigated further the authors set up idealised numerical models with and without a sand bar in a v shaped bay to investigate the effect of embayment and the effect of the crest height of the sand bar in the bay on maximum water level maximum velocity and maximum momentum flux per unit mass per unit width 2 numerical model of little pigeon bay 2 1 governing equations to simulate the tsunami flow in shallow water and overland two dimensional depth integrated nonlinear shallow water wave equations were applied the continuity and the momentum equations are respectively 1 ζ t q x x q y y 0 2 q x t x q x 2 h y q x q y h g h ζ x τ x ρ 0 3 q y t x q x q y h y q y 2 h g h ζ y τ y ρ 0 where h is the flow depth ζ the water surface elevation q x q y the discharge fluxes in x and y direction respectively g the gravitational force ρ the water density τ x τ y the bed shear stress in x and y directions defined in eq 4 and eq 5 respectively 4 τ x ρ g n 2 q x q x 2 q y 2 h 7 3 5 τ y ρ g n 2 q y q x 2 q y 2 h 7 3 where n is the manning s roughness coefficient the tsunami flow was assumed to be quasi steady at any instant in the simulation 2 2 numerical set up and conditions the above equations were solved by the finite difference method with an upwind scheme a constant manning coefficient of 0 025 m 1 3 s was used as the roughness parameter which was suggested by previous studies bunya et al 2010 koshimura et al 2009 for coastal areas in order to avoid generating tsunami waves based on the tsunami source mechanism the model was forced in 22 m still water depth from the north of little pigeon bay using measured water levels at sumner gauge fig 1a the sumner gauge 43 34 s 172 34 e is located near the coast 12 26 km northwest of little pigeon bay fig 1a fig 1b shows the model domain extending 14 01 km in the x direction and 7 68 km in the y direction the cross and alongshore grid sizes were 10 m for all the test cases bathymetric data of the bay were obtained from linz 2016 fig 2 shows the bathymetry of little pigeon bay this bay is 1350 m long 850 m wide and 17 3 m deep at the mouth the funnel shaped bathymetry is likely to concentrate wave energy propagating onshore a bar can be seen at location 3 fig 2 which separates the bay into the inner bay and the outer bay the incident wave was given as a time series using measured water level with tidal level variations removed from the original source fig 3 the non reflective wave boundary condition was applied one hour after the earthquake the water level in sumner gauge fig 1a began to fluctuate based on the zero up crossing analysis the maximum tsunami wave height peak to trough height was 0 96 m at 3 83 h after the earthquake the wave period during the period from 1 h to 7 h after the earthquake ranged from 10 min to 39 min due to uncertainty in the tsunami wave direction three incident wave angles were tested in the numerical modelling i e waves from due north 15 east of north and 30 east of north figs 1 and 2 for different wave approach angles the bathymetry was rotated accordingly while the wave generating boundary remained at around 22 m still water depth the simulation started 1 h after the earthquake when perturbations in water level occurred with a total simulation time of 6 h the datum atl hereafter in this study which was the average tidal level during the simulated 6 h of the tsunami was 1 14 m higher than nzvd2016 3 numerical model results little pigeon bay 3 1 validation of run up heights a cottage location 6 in fig 2 near the head of the bay was heavily damaged due to the uplift forces debris impacts and sediment deposition from the tsunami the floor of the cottage was at an elevation of 1 26 m atl the land near the house was mostly covered by grass with dotted trees a map of the tsunami run up heights around the cottage obtained from inshore debris deposits and water marks on the walls of the house is given in lane et al 2017 the water marks on the house showed the tsunami run up height at the side of the cottage was 3 73 m above nzvd2016 which was 2 59 m relative to the datum of this study lane et al 2017 power et al 2017 the maximum run up heights at the cottage location 6 in fig 2 in the simulation were 2 8 m 3 06 m and 3 5 m for waves coming from bearings 0 15 and 30 respectively the maximum run up heights occurred at 184 min 104 min and 188 min respectively after wave generation at the boundary as discussed in section 5 1 the maximum run up height at the cottage during waves coming from due north corresponds well with the measured maximum run up height at the same location 3 2 effect of incident wave direction 3 2 1 water surface elevations at the head of the bay water surface elevations at the head of the bay location 5 in fig 2 for different incident wave angles are shown in fig 4 the undulations of input wave signals induced short period oscillations from 50 min to 100 min which are investigated further in section 5 1 the maximum water surface elevations in the bay increased with wave bearing increasing from bearings 0 30 the time when the maximum surface elevations occurred was also influenced by the wave incident angle as discussed in section 5 1 3 2 2 maximum tsunami wave heights fig 5 shows the maximum tsunami wave heights peak to trough along the centre of the bay locations 1 to 6 in fig 2 the maximum tsunami wave heights were the highest at the head of the bay most likely caused by energy concentration due to the narrowing shape and local resonance as can be seen from the graph the maximum tsunami wave height was sensitive to the incident wave angle and increased from the mouth of the bay location 1 in fig 2 to the head of the bay location 5 in fig 2 for waves from bearings 0 and 15 the tsunami wave height increased along the bay and the maximum tsunami wave heights were 4 7 m and 4 9 m respectively for waves from a bearing of 30 the tsunami wave height was high from the mouth of the bay location 1 in fig 2 and was 6 38 m at its maximum when it reached the head of the bay location 5 in fig 2 3 2 3 tsunami impact evaluation the tsunami pilot study working group 2006 suggested the momentum flux per unit mass per unit width hu 2 as the most suitable damage indicator where h is the total flow depth and u is the flow velocity the momentum flux can be higher due to substantial current speed during tsunami rundown even though the flow depth remains small tsunami pilot study working group 2006 fig 6 a shows the distribution of the maximum velocity magnitude when tsunami waves came from the north the maximum velocity occurred in the middle of the bay where the flow depth was shallower due to the existence of a sand bar the shoals near both sides of the bay also concentrated the tsunami wave energy and caused the velocity to increase the high magnitude velocity in the middle of the bay might induce severe scour around structures e g breakwaters and bridge piers built in this area the flow velocity was lowest at the head of the bay where it was less than 0 5 m s fema p 646 2012 gives the following formulation for calculating the tsunami induced hydrodynamic force on a structure when the tsunami flow depth is lower than the height of the structure 6 f d 0 5 ρ s c d b h u 2 max where ρ s is the fluid density c d the drag coefficient dependent on the size shape and orientation of the structure and b the width of the structure normal to the flow direction fig 6b demonstrates the maximum momentum flux distribution when tsunami waves came from due north in the bay the maximum momentum flux occurred in the middle of the bay where the maximum flow velocity was higher which indicates the higher forces exerted on an emergent structure built in a shallow water area in the bay the maximum velocity and the maximum momentum flux occurred at the same time for locations 1 to 6 fig 2 for locations 5 and 6 at head of bay fig 2 the maximum velocity and the maximum momentum flux occurred at 101 min when the water level was at a small trough between two peaks for locations 1 and 3 fig 2 the maximum values occurred at 201 min and 145 min respectively when the water level was at about still water level during the flow runup after the extreme drawdown for location 2 fig 2 the maximum values occurred shortly after the extreme drawdown prior to the flow reversal the maximum velocity and the maximum momentum flux occurred earlier for locations at the inner part of the bay locations 4 5 and 6 in fig 2 carrier et al 2003 found the momentum flux reaches its maximum value near the extreme draw down location this agrees well with the results of the present study the difference might be due to the influence of the local bathymetry in park et al 2013 when solitary waves propagated to the macro roughness land the maximum water surface elevation the maximum velocity and the maximum momentum flux did not occur at the same locations or times the maximum velocity occurred earlier than both the maximum momentum flux and the maximum surface elevation as it remained at the front part of the wave 4 numerical model idealised bay with a sand bar 4 1 model set up idealised models were set up to simulate tsunami waves entering a v shaped bay and effects on those waves of a sand bar in the bay the idealised v shaped bay was based on the physical dimensions of little pigeon bay 1350 m long 850 m wide and 17 3 m deep at the mouth with a sloping bottom fig 7 the idealised sloping beach had a uniform cross shore profile as shown in fig 7b the model domain was 6 71 km in x direction and 2 55 km in y direction for all the simulations the wave signals were the same as that used in the simulation of tsunami propagation to little pigeon bay fig 3 the wave generating boundary was at 22 m still water depth and the cross shore location where x 0 table 1 shows the test cases of the idealised models d w indicates still water depth above the sand bar d indicates the still water depth without a sand bar fig 7b the datum was mean sea level msl the initial water depth in the location of a sand bar was 7 m where x 5800 m fig 7b 4 2 effects of narrow v shaped embayment a resonance with a period of about 6 3 min was found in all the simulation cases from 50 to 100 min the high frequency water level variations led to a high frequency velocity change fig 8 shows a the maximum velocity in the x direction and b maximum momentum flux per unit mass per unit width of a sloping beach and a v shaped bay cases 6 and 1 respectively in table 1 note in the centreline of the bay the velocity in y direction is negligible and the velocity in x direction ux is the dominant component the maximum velocity in x direction was significantly higher at the head of the bay than that in a sloping beach for the given tsunami wave signals the v shape embayment led to an increase in the maximum velocity from 1 89 m s to 3 85 m s from the middle of the bay to offshore the maximum velocity in x direction was slightly larger than that in the same location for a sloping beach fig 8a the maximum velocity in x direction in the bay occurred at the still water depth 0 4 m at 75 min when the resonance appeared the water level when the maximum velocity magnitude occurred was at a peak of 2 59 m the maximum velocity in x direction in the sloping beach occurred at the still water depth 0 66 m at 157 min during the uprush of the flow for locations at the head of the bay the high frequency variations of water level from 50 min to 100 min contributed to the higher velocities the drop in the maximum velocity around x 6170 m in the v shaped bay is attributed to the difference of time at which the maximum velocity occurred from the outer bay to the centre of the bay the maximum velocity occurred at 145 250 min from the centre of the bay to the head of the bay the maximum velocity occurred at 50 100 min when the resonance appeared fig 8b shows the maximum momentum flux per unit mass per unit width hu 2 of case 1 and case 6 table 1 the maximum momentum flux decreased from the offshore to the coast on the centreline for the sloping beach model for the v shaped bay the maximum momentum flux reached its maximum value of 16 2 m3 s2 at the head of the bay due to higher velocities the maximum momentum flux in the bay occurred at the still water depth 1 04 m at 75 min when flow velocity reached a peak of 3 14 m s the corresponding water level was at around mean sea level 4 3 effects of a sand bar in a v shaped bay a sand bar was added in the middle of the bay for cases 2 to 5 with crest heights 3 m 2 5 m 1 5 m and 0 m relative to msl for case 5 table 1 with the highest sand bar the time series of water depth velocity in x direction ux and froude number fr on top of the sand bar x 5800 m in the centreline of the bay are shown in fig 9 fr is defined as 7 f r u g h where u is the flow velocity h the water depth and g the gravitational acceleration in almost all the simulation time fr was less than 1 and the flow was subcritical the maximum ux the maximum water depth and the maximum fr on top of the sand bar occurred at different time for each tsunami wave up rushing the time of the peak water depth was 1 5 min later than the time of the peak ux the maximum fr induced by each tsunami wave occurred during the wave recession the flow over the sand bar throughout this study can be identified as submerged type tanaka and sato 2015 the water cushion effects behind the sand bar was important in reducing the potential energy loss fig 10 demonstrates the distribution of the maximum water level the maximum velocity and the maximum momentum flux per unit mass per unit width along the centreline of the bay x direction the maximum water level in the bay ranged from 2 5 m to 4 0 m relative to msl and showed a rising trend from the mouth to the head of the bay due to the shoaling and amplification of tsunami waves fig 10a for relatively low crest height case 2 the maximum water level was almost the same as case 1 without a sand bar the sand bar in case 4 led to the most significant change in the maximum water level compared to case 1 the sand bar could increase the maximum flow velocity around the sand bar while decreasing the maximum flow velocity in the inner bay from the sand bar to the coast fig 10b as the height of the sand bar increased the maximum flow velocity decreased in the inner bay for d w d less than 0 5 the maximum velocity in the bay occurred above the sand bar after the resonance period from 50 to 100 min for d w d from 0 5 to 1 the maximum velocity in the bay occurred at the head of the bay after the resonance period the existence of the sand bar delayed the time when the maximum value of the velocity occurred it appears that the sand bar changed the resonance characteristics of the bay fig 10c shows the sand bar with a relatively low crest height d w d 0 5 did not reduce the maximum momentum flux per unit mass per unit width rather it increased the momentum flux at the head of the bay and around the sand bar if d w d was less than 0 5 it reduced the maximum momentum flux from the backside of the sand bar to the head of the bay the maximum value in the whole bay occurred above the sand bar the maximum value at the head of the bay occurred at 99 min for d w d from 0 5 to 1 the maximum momentum flux in the bay occurred during the resonance period for d w d less than 0 5 the maximum momentum flux in the bay occurred after the resonance period 5 discussion 5 1 local resonance in little pigeon bay in the three cases a noticeable resonance with a period of about 6 3 min was found from 50 to 100 min fig 4 fig 3 shows waves of this period within the 50 100 min time band but fewer thereafter the bay amplified the frequency and longer periods that were also visible from 50 min to 100 min appear to be suppressed somewhat the weakest resonance occurred when waves came from 30 east of north and the resonance was most significant at the head of the bay locations 5 and 6 in fig 2 the strongest resonance occurred when waves came from 15 east of north leading to the earlier occurrence of the maximum water level section 3 1 lane et al 2017 found resonance signals with periods of about 7 min along the bay in their local inundation modelling in their simulation the maximum water level occurred at approximately 150 min after the earthquake 90 min relative to the starting time in this study due to a resonant response of the bay an idealised triangular bay with a sloping bottom of similar size to little pigeon bay gave an analytical fundamental resonance period of 6 6 min following rabinovich 2008 8 t 0 1 653 2 l g h 1 1 2 where l is the length of the bay h 1 the still water depth at mouth of the bay these correspond well with the simulated results 5 2 local amplification of tsunami waves in little pigeon bay for alongshore uniform coasts tsunami run up was highest when the incident waves came perpendicular to the shore harbitz et al 2014 in pedersen 2011 the run up heights decreased with increasing incident wave angle for non breaking solitary waves in the present study the tsunami wave height in little pigeon bay was less than its maximum when tsunami waves propagated straight to the bay i e waves from 15 east of north fig 3 the 30 bearing was the worst case as the outer half of the bay is open to that direction the tsunami waves were reflected off the sides of the bay to be funnelled around the corner and up the bay the reflection and refraction of the tsunami waves in the bay amplified the tsunami heights 5 3 implications for construction of artificial bed sills although the sand bar in a bay can be washed away or reshaped during tsunami impact the modelling of sand bars as impermeable immobile structures in this study demonstrates the influence of sand bars on the tsunami flow in a bay and there are implications for the construction of artificial bed sills or submerged dikes in a bay artificial bed sills might be built offshore to reduce tsunami run up heights or hurricane damage in coastlines or to protect marshy wetland and enhance coastal ecosystem gittman et al 2014 smith et al 2017 in addition reefs exist in some bays gelfenbaum et al 2011 investigated the influence of the reef width on the inundation distance maximum velocity and maximum wave height at the shoreline they found that narrow reefs less than 200 m wide induce greater wave heights velocities and inundation inland than wide reefs as the reef widths increase tsunami wave heights and velocities decrease and the tsunami inundates less distance based on the present study and current knowledge of the influence of bed sills in a bay on mitigation of tsunamis it is recommended the d w d of proposed bed sills be less than 0 5 although the wider the bed sills are the more effective of them in reducing tsunami wave heights onshore and velocities the width of artificial bed sills should be determined based on the balance of cost and effectiveness 6 conclusion the main conclusions are 1 using water level signals recorded from sumner tidal gauge 12 26 km northwest of little pigeon bay the run up height at a cottage corresponds well with the simulation in which tsunami waves came from due north for wave directions from due north to 30 east of north the increasing wave bearing leads to greater tsunami run up and tsunami wave heights along the centre of the bay due to wave focusing to the bay combined with wave refraction diffraction and reflection a resonant period of about 6 3 min was found for different wave angles compared to 6 6 min calculated from an idealised v shaped bay following rabinovich 2008 2 the maximum velocity in little pigeon bay when waves came from the north occurred in the centre of the bay due to shoaling in the shallower water depth tsunami wave energy was concentrated in the inner part of the bay resulting in greater velocities and greater momentum fluxes which was confirmed by idealised model results with a sand bar in the centre of the bay 3 for the idealised models under the same tsunami attack as that in little pigeon bay the embayment increased the maximum velocity and the maximum momentum flux in the inner part of the bay at the head of the bay the high frequency variations of water level relative to a tsunami about 6 3 min period due to the local resonance contributed to the velocity increase 4 the sand bar with a relatively low crest height d w d 0 5 was not effective in reducing the maximum velocity and the maximum momentum flux but higher sand bars were more effective the sand bar always resulted in a spike in the maximum velocity and the maximum momentum flux around the sand bar due to the energy concentration acknowledgements this research is funded by the natural hazards research platform new zealand the authors acknowledge the valuable suggestions from graham macky and benjamin popovich s help in preparing the bathymetry of little pigeon bay the comments from two anonymous reviewers are acknowledged 
