index,text
22580,in deep ocean scenario where drift of autonomous underwater vehicle auv localization system can be fast since no bottom tracking data can be obtained by doppler velocity logger dvl missions for auv are either hardly to be carried out or depended on expensive inertial instruments this paper presents a multi auvs cooperative ocean current estimation method by formulating factor graphs and solving nonlinear optimization problems which can be used for typical applications such as formation maneuvering and cooperative target searching considering that only intermittent information is broadcasted by acoustic modems observability of the system in each case is analyzed with designed simple formation switching strategies with the help of water tracking velocity acquired by acoustic doppler current profiler adcp and estimation of ocean current accuracy of auv localization system can be improved to an acceptable level for formation control and reliable position of the target can be obtained even with accumulated clock error at last field data based simulations have been carried out to demonstrate the feasibility of the proposed methodology keywords multi auvs current estimation nonlinear optimization deep ocean applications 1 introduction localization system for auv is usually composed of inertial measurement units imu doppler velocity loggers dvl for position integration and external sources from global navigation satellite systems gnss long baselines lbl or ultra short baselines usbl for position calibration leonard and bahr 2016 stutters et al 2008 with widely used fiber optic gyroscope fog and bottom tracking dvl paull et al 2014 the system can obtain localization accuracy better than 0 5 of travel distance the localization accuracy will ensure auv to carry out most tasks such as oceanographic surveys mine countermeasures and seabed mapping bogue 2015 with relative long calibration interval however in deep ocean environment where bottom tracking dvl is not available due to the limitation of detection range localization can drift fast with only accelerometer to calculate velocity of auv even though auv can maneuver near the bottom of deep ocean to get velocity measurement this leads to higher requirement for underwater sealing and auv would also loss velocity measurements during diving and surfacing processes hegrenaes and hallingstad 2011 proposed a model aided inertial navigation system ma ins to solve this problem with velocity measurements derived from dynamic model of auv hegrenaes and berglund also equipped auv with both bottom tracking and water tracking dvl in case bottom tracking dvl fails in middle depth operations randeni p et al 2016 further considered about dead zone of adcp and brought out wvam method to improve accuracy and feasibility nevertheless in both hegrenaes and hallingstad 2011 and randeni p et al 2016 dynamic model of auv fossen 2011 which can be both time and fund consuming to obtain is required for reliable localization this problem becomes even more serious for multi auvs system since consistency of each auv is difficult to ensure as a result we need to implement parameter identification experiments for each one acoustic positioning systems provide alternative solutions to this problem lbl or usbl based localization systems are often deployed in these cases morgado et al 2013 jakuba et al 2008 usually surface subsurface buoys or sea floor moored transponders are used to compose lbl positioning system which can only cover limited areas hunt et al 1974 resulting deficiency in practice in bahr et al 2009 authors proposed the concept of moving long baseline mlbl using two surface vehicles as communication navigation aids localization can be guaranteed with low end imus the result was further improved that only one surface vehicle was needed with particular path planning algorithms to keep observability fallon et al 2010 methods provided in bahr et al 2009 and fallon et al 2010 greatly increased feasibility of lbl for auv applications but it should be mentioned that one or more autonomous surface vehicles are required and will add complexity to the deploying and recovering process of multi auvs missions besides usbl is another popular approach to aid auv localization which can directly mounted on the ship with localization range of several kilometers morgado et al 2010 rigby et al 2006 one significant deficiency for usbl is the interrogation response solution to localize auv as mentioned in eustice et al 2007 since bandwidth burden will increase a lot in a multi auvs system taking this problem into consideration eustice et al 2007 brought out one way travel time owtt ranging architecture which not only reduced redundant communications but also potentially extended supporting range of navigation from several kilometers to tens of kilometers and several cooperative estimation algorithms are tested based on owtt ranging with different communication topology in walls and eustice 2011 further walls and eustice 2014 2013 webster et al 2013 proposed origin state method based on pose graph handling packet loss problem of underwater communication inspired by the research results owtt ranging method is also adopted in this paper and feasibility of current estimation algorithm will be tested under unreliable communication link and range measurement noise to be more practical as a conclusion in this paper we aim to propose solutions for localization of multi auvs system in deep ocean applications main principles are 1 practical implementation procedure 2 simple operation requirements 3 better usage of multi auvs architecture according to above principles and related studies reviewed we have brought out a cooperative current estimation based multi auvs localization method regarding two typical multi auvs missions in deep ocean environment a formation maneuvering and b cooperative target searching sensors involved in this methodology include imu gps adcp and synchronized acoustic communication modem sacm besides time division strategy is adopted to ensure communication reliability for formation maneuvering mission of multi auvs a supporting vehicle sv with high position accuracy is needed to broadcast its position with sacm the whole system structure can be presented as fig 1 p s v k δ t indicates position message of sv at t k δ t where δ t is the constant time period that is longitude and latitude value of sv at time instant k i m 1 δ t a u v i sends out its own state x a u v i current estimation c a u v i and d a u v i that indicating distance between a u v i and sv in addition m is the total number of auvs involved in the system for large area target searching mission of multi auvs system assumptions are made that the target is equipped with underwater acoustic beacon and the acoustic beacon has an oscillator with 1 ppm accuracy in this mission position of the target and accumulated clock error are estimated along with ocean current based on similar method used in formation maneuvering mission it is also worth noticing that acoustic beacon based current estimation can also be used in formation maneuvering to improve localization accuracy as long as multi auvs can drop acoustic beacons occasionally along desired path in this case sv is not necessary and multi auvs system can be more self contained in deep ocean system structure during this mission is almost the same as the one shown in fig 1 except no position information will be sent anymore regarding deep ocean missions of multi auvs above factor graph which is often used in the field of simultaneous localization and mapping slam cadena et al 2016 cunningham et al 2010 is adopted in this paper to formulate cooperative current estimation problem as maximum a posteriori map estimation in particular auv states current estimations and accumulated errors are taken as variable nodes while relative range measurements and dead reckoning integrations are regarded as factor nodes with consideration of intermittency nonlinear optimization problem can be solved with gtsam kaess et al 2008 2012 in addition unlike unmanned surface vehicles it is inconvenient for svs such as large ships moored buoys and impossible for static targets to maneuver with designed trajectory formation switching strategy is proposed instead to guarantee observability of the estimation algorithm it has shown in this paper that simple switching strategy is enough to realize both current estimation and target searching remaining parts of this paper are organized as follows section 2 introduces mathematic formulation of multi auvs current estimation and target searching problems then factor graph based descriptions of these problems are brought out with observability analysis in section 3 in the following section 4 field data based simulations are carried out to verify the feasibility of proposed algorithms in both cases at last conclusions are drawn with future work 2 problem formulation consider a multi auvs system composed with m auvs indicated as a u v 1 a u v 2 a u v m for each auv the state of a u v i at time instant k is defined as x i k x i k y i k ψ i k u i k v i k p i k ψ i k u i k v i k with x y ψ u v indicate east north yaw surge and sway separately and p directly represents position of a u v it should be noticed that we define state variables only in planar coordinate since depth can be accurately obtained with depthmeter and positions of auvs are main concerns in this paper without loss of generality all system states are assumed to be observable at initial time instant k 0 that is x i 0 i 1 m are known in addition δ t is used to represent constant time period in the whole system we can derive position of a u v i at each time instant k according to dead reckoning algorithm as 1 x i k x i 0 δ t j 0 k 1 u ˆ i j cos ψ ˆ i j v ˆ i j sin ψ ˆ i j y i k y i 0 δ t j 0 k 1 u ˆ i j sin ψ ˆ i j v ˆ i j cos ψ ˆ i j where u ˆ i v ˆ i and ψ ˆ i are measurements from sensors in deep ocean environment where bottom tracking dvl velocities are not available only water tracking velocities u ˆ i w v ˆ i w are provided then eq 1 should be revised as 2 x i k x i 0 δ t j 0 k 1 u ˆ i w j cos ψ ˆ i j v ˆ i w j sin ψ ˆ i j c ˆ x w j y i k y i 0 δ t j 0 k 1 u ˆ i w j sin ψ ˆ i j v ˆ i w j cos ψ ˆ i j c ˆ y w j with c ˆ x w j c ˆ y w j representing current velocity estimations in east and north respectively since current velocity changes slowly comparing with the velocity of auv we take c ˆ x w j c ˆ y w j as constant c x w and c y w for during one optimization process in the following sections δ t is omitted for simplicity by using k k j representing k δ t and k j m 1 δ t respectively the state of supporting vehicle can be defined as x 0 k x 0 k y 0 k at time instant k according to the system structure in fig 1 define x k as 3 x k x 0 k x 1 k x m k which can be obtained by a u v i during k k 1 excepting packet loss exists in addition range measurements can be obtained among auvs and sv with definition 4 d k d 1 i k d m i k i 0 m with d j i k representing distance between a u v j and a u v i at time k as a result each auv could estimate current velocity c x w c y w to compensate potential position errors generated from eq 2 as a result formation maneuvering problem to be solved can be presented as maximum a posteriori estimation shown as 5 x c x w c y w argmin x c x w c y w p x c x w c y w d k similarly for target searching application x 0 k is converted from measurements to constant variables to be estimated then x k is revised as 6 x k x 1 k x 2 k x m k defining accumulated clock error as δ 0 k which can be taken as constant δ 0 during whole estimation process for 1 ppm oscillator target searching problem can be presented as 7 x c x w c y w δ 0 argmin x c x w c y w δ 0 p x c x w c y w δ 0 d k where d k is the same as eq 4 3 cooperative estimation 3 1 formation maneuvering according to the definition of factor graph we can represent the estimation problem mentioned in section 2 in terms of graph model defining factor nodes f i ℱ i and variable nodes θ i θ i for a u v i the graph g i ℱ i θ i ε i can indicate corresponding factor graph with edges ε i then the joint probability density function in eq 5 for a u v i can be factorized as 8 p i x i c x w c y w x k d k k f i k θ i k where θ i k include positions and current estimations of a u v i during k k 1 f i k indicate functions of θ i k in the graph to better illustrate components of θ i k structure of g i is depicted as fig 2 with one sv and only one neighbored auv for simplicity according to fig 2 black variable node x i k represents state of a u v i at time instant k blue variable node c i k is the corresponding current velocity and green box represents position of sv with no need to estimate as a result factor nodes can be formulated in three different types as followed 9 f i x p i k p i k 1 g p i k 1 h p i k u i k c i k ψ i k f i 0 p 1 k x 0 k g r 1 2 p i k x 0 k d i 0 k 2 f i j n i p i k p j k g r 2 2 p j k p i k d j 0 k 2 where f i x represents dead reckoning factor with h x i k u i k c i k ψ i k indicating integration process between k and k 1 as eq 2 and c i c i x c i y factor f i 0 is the error between predicted distance and range measurement with 10 r 1 p i k x 0 k p i k x 0 k 2 i 1 m similarly factor f i j k is the error between a u v 0 and a u v j n i where n i is set of auvs in neighbor of a u v i and r 2 with definition as 11 r 2 p j k p i k p j k k c j k c i x 0 k 2 j n i where c i and c j are current values we should notice that even though assumed to be constant in one optimization process current estimations are also updated during each optimization process and can be adapted to slow changes finally general gaussian noise distribution is taken for all prediction errors as g a to further expand r 1 2 k and r 2 2 k define z i x k and z i y k according to eq 2 as below for briefness 12 z i x k u ˆ i w k cos ψ ˆ k v ˆ i w k sin ψ ˆ k z i y k u ˆ i w k sin ψ ˆ k v ˆ i w k cos ψ ˆ k then r 1 2 k and r 2 2 k can be derived as 13 r 1 2 p i k x 0 k x i 0 j 0 k 1 z i x j c ˆ i x j x 0 k 2 y i 0 j 0 k 1 z i y j c ˆ i y j y 0 k 2 x i k k c i x x 0 k 2 y i k k c i y y 0 k 2 where x i k and y i k represent dead reckoning derived position of a u v i at time instant k without consideration of current velocity and 14 r 2 2 p j k p i k x j k k c i x x 0 k 2 y j k k c i y y 0 k 2 x j k k c j x k c i x x 0 k 2 y j k k c j y k c i y y 0 k 2 reason to adopt this construction is to ensure the observability of current estimation with simple formation switching strategy as discussed in follows in addition another benefit to add this item is to reach consensus of current estimations among auvs since errors in this formulation also caused by different current velocities estimated considering about observability of the nonlinear optimization problem we can first analyze factors mentioned above intuitively 1 f i x is the factor results from relative measurements 2 for factor f i 0 impact of current can be reflected by range measurement between auv and sv 3 factor f i j represents distance prediction error between sv and a u v j used by a u v i through the formulation of r 2 this factor implies influence of current estimation of a u v j on a u v i as a conclusion f i 0 and f i j are main factors used next for observability analysis first for the system depicted as fig 2 measurements can be described as 15 e k e 1 k e 2 k x 1 k k c x x 0 k 2 y 1 k k c y y 0 k 2 d 1 0 k 2 x 2 k k c x x 0 k 2 y 2 k k c y y 0 k 2 d 2 0 k 2 according to weak observability theorem in slotine et al 1991 we can regard c x and c y as system states to be observed and take the lie derivative of measurement e 1 and e 2 as below l f 0 e 1 e 1 l f 0 e 2 e 2 l f 1 e 1 0 l f 1 e 2 0 as a result observability matrix can be directly given as 16 o 2 k ϵ 1 x 2 k 2 c x 2 k ϵ 1 y 2 k 2 c y 2 k ϵ 2 x 2 k 2 c x 2 k ϵ 2 y 2 k 2 c y with ϵ i x x i k x 0 k it is obvious that the rank of o is same as the rank of o 17 o ϵ 1 x k c x ϵ 1 y k c y ϵ 2 x ϵ 1 x ϵ 2 y ϵ 1 y the system is observable if the observability matrix is full rank that is 18 det o ϵ 1 x k c x ϵ 2 y ϵ 1 y ϵ 1 y k c y ϵ 2 x ϵ 1 x ϵ 1 x k c x y 2 y 1 ϵ 1 y k c y x 2 x 1 0 according to eq 18 full rank condition can be satisfied as long as it can be guaranteed that 1 position of auv is not exactly the same as position of sv otherwise will make ϵ 1 x k c x and ϵ 1 y k c y all zeros this condition can be easily reached because sv usually is some distance away from auv formation 2 auvs do not have same desired horizontal position which lead to dead reckoning results y 2 y 1 0 and x 2 x 1 0 this is always the case for a fleet of auvs maneuvering around with particular horizontal formation 3 when condition 1 2 are satisfied we still need 19 ϵ 1 x k c x y 2 y 1 ϵ 1 y k c y x 2 x 1 that is 20 y 2 y 1 x 2 x 1 ϵ 1 y k c y ϵ 1 x k c x y 1 y 0 x 1 x 0 the condition in eq 20 actually means that direction of relative movement between a u v 1 and a u v 2 should not aligned with direction between a u v 1 and sv one typical scenario goes against this condition is that a u v 1 a u v 2 and s v are moving in a straight line 4 auvs and sv in the system are not operating with the same velocity and direction this condition is implicitly lied in the construction of measurement function since all variable are observable at the beginning that is x 0 x 0 and y 0 y 0 we can deduct measurement matrix in eq 15 with zero value x i 0 x 0 0 2 y i 0 y 0 0 2 d i 0 0 2 in each row without above condition we would have x i k x i 0 k c x x 0 k x 0 0 0 y i k y i 0 k c x y 0 k y 0 0 0 then the measurement matrix can never be full rank besides it needs to be mentioned that the observability can be degraded even if only multi auvs have the same velocity and direction for a long term formation keeping mission since this will lead to z i x x i 0 and z i y y i 0 we have x 1 k k c x x 0 k x 2 k k c x x 0 k and y 1 k k c y y 0 k y 2 k k c y y 0 k in eq 15 and the optimization process would hardly reach accurate estimation with above analysis and resulting requirements we propose simple formation switching strategies that are enough to guarantee observability conditions in order to estimate current velocity for position compensation comparing with the proposed path planning method for usv to guarantee single auv localization in fallon et al 2010 the methodology in this paper releases the requirement for s v to operate complex path which would be expensive for large ships and impossible for moored buoy and the communication links from auvs to sv following three typical formation switching strategies are chosen as examples a circling circling formation switching strategy is illustrated as fig 3 this switching strategy is usually implemented before the whole multi auvs system is about to turning left in example and can reduce the possibility of collision for auvs without available sensors to realize obstacle avoidance it is obvious that all conditions mentioned above can be directly satisfied in this case and current estimation can be reached during the formation switching process b shrinking or expanding shrinking or expanding formation switching strategy is illustrated as fig 4 which is usually needed for multi auvs system to pass narrow channels in harbors for example in addition for seabed mapping mission shrinking and expanding can be used to adjust the resolution of seabed data that make whole task execution process more scalable according to conditions both shrinking and expanding process can be used to estimate current velocity c triangle to rectangle triangle to rectangle formation switching strategy is illustrated as fig 5 one potential application of this strategy is to obtain better detecting results in cooperative target detection missions since different alignments of sonar arrays can gain different detection capabilities furthermore as mentioned in walls and eustice 2014 acoustic communication is not reliable enough and packet loss always happens in field applications with the required conditions as above observability can be guaranteed for every time period however this is a sufficient condition for current estimation but not a necessary one since we do not actually need to estimate slowly changed current velocity frequently to better illustrate eq 15 is revised as below 21 e k 1 k 2 k n e 1 k 1 e 2 k 1 e 1 k n e 2 k n t according to eq 21 it can be concluded that during the time window from k 1 to k n a single useful sample is enough to keep the observability of current estimation under the assumption that current velocity is constant during that period as a conclusion in this section we have introduced a solution to current estimation problem for formation maneuvering case with formulating the optimization problem in factor graph the whole system structure can be presented in a much more clear format in addition observability analysis is carried out to show that even with simple formation switching strategies conditions needed to obtain estimation can be satisfied three different types of switching strategies that are usually needed in practice are listed as examples current estimation can be directly carried out during typical mission execution and does not need to be treated specially in most cases in next section estimation in target searching case will be further discussed to not only obtain current velocity but also static target position and accumulated clock error 3 2 target searching in target searching problem as shown in fig 6 components of factor graph are similar as in fig 2 but with revisions that the position of target and the clock error are regarded as states to be estimated for the observability of current velocity target position and clock error we need to revise eq 15 as 22 e k e 1 k 1 e 2 k 1 e 1 k 2 e 2 k 2 e 1 k 3 ξ x 1 k 1 x 0 2 ξ y 1 k 1 y 0 2 δ 0 2 d 1 0 k 1 2 ξ x 2 k 1 x 0 2 ξ y 2 k 1 y 0 2 δ 0 2 d 2 0 k 1 2 ξ x 1 k 2 x 0 2 ξ y 1 k 2 y 0 2 δ 0 2 d 1 0 k 2 2 ξ x 2 k 2 x 0 2 ξ y 2 k 2 y 0 2 δ 0 2 d 2 0 k 2 2 ξ x 1 k 3 x 0 2 ξ y 1 k 3 y 0 2 δ 0 2 d 1 0 k 3 2 with ξ x i k j x i k j k j c x ξ y i k j y i k j k j c y and δ 0 represents accumulated clock error similarly as eq 16 the observability matrix can be presented as eq 23 as long as k 1 k 2 k 3 and k 1 k 2 k 3 0 23 o ˆ 0 0 ξ x 1 k 1 x 0 ξ y 1 k 1 y 0 ξ 1 k 1 0 0 ξ x 2 k 1 x 0 ξ y 2 k 1 y 0 ξ 2 k 1 ξ x 1 k 2 x 0 ξ y 1 k 2 y 0 0 0 ξ 1 k 2 ξ x 2 k 2 x 0 ξ y 2 k 2 y 0 0 0 ξ 2 k 2 ξ x 1 k 3 x 0 ξ y 1 k 3 y 0 k 2 k 3 k 3 k 1 ξ x 1 k 3 x 0 k 2 k 3 k 3 k 1 ξ y 1 k 3 y 0 k 2 k 1 k 3 k 1 ξ 1 k 3 with ξ i k j ξ x i k j x 0 2 ξ y i k j y 0 2 define o as 24 o 0 0 ξ x 1 k 1 x 0 ξ y 1 k 1 y 0 0 0 ξ x 2 k 1 x 0 ξ y 2 k 1 y 0 ξ x 1 k 2 x 0 ξ y 1 k 2 y 0 0 0 ξ x 2 k 2 x 0 ξ y 2 k 2 y 0 0 0 it can be concluded that if det o ˆ 0 observability of estimation can be guaranteed with o 1 and o 2 defined as 25 o 1 ξ x 1 k 1 x 0 ξ y 1 k 1 y 0 ξ x 2 k 1 x 0 ξ y 2 k 1 y 0 and 26 o 2 ξ x 1 k 2 x 0 ξ y 1 k 2 y 0 ξ x 2 k 2 x 0 ξ y 2 k 2 y 0 since det o det o 1 det o 2 and formulations of o 1 and o 2 are same as eq 17 conditions for system to be observable listed in section 3 1 are still available here if we have det o 1 0 and det o 2 0 the observability of current estimation and target searching problem is ensured in the meanwhile formation switching strategies proposed above are also useful to improve the observability of the system in this case conclusions drawn in this section indicate an worth noticing fact that observability of current estimation or target searching can be improved if we increase the number of measurements as eq 22 which is consistent with discussion with eq 21 actually in real world applications better observability can be reached since the size of data set used in one optimization process can be dozens according to communication noise and disturbance 4 experiments and simulations according to algorithms proposed above simulations are carried out in this section basing experimental data from practical missions as shown in fig 7 since experiments were taken in the lake where current velocity is small and bottom tracking dvl is available current to be estimated is added through postprocessing in order to simulate deep ocean environment the multi auvs system deployed is depicted as below 4 1 multi auvs system the multi auvs system is composed of auvs as in fig 8 and specifications of the auv are listed in table 1 when auv is maneuvering in the lake antenna is mounted for wireless communication and gps localization as shown in fig 9 each individual auv is equipped with sensors such as imu gps dvl and depthmeter the sacm mentioned in this paper is simulated by calculating distance from ground truth positions so that the current added will only influence position estimations of auvs other than acoustic range measurements to better reflect practical situations packet loss and range measurement noise are also added with the multi auvs system cooperative current estimation algorithm and target searching algorithm are verified in this section field data used are obtained from two cooperative formation control missions with formation switching including 1 switching from triangle to straight line fig 10 2 switching from triangle to rectangle fig 11 according to the results there are slight consensus errors for formation control in both cases but it can be omitted since these errors would not be induced into estimation processes in addition it is obvious that there is a near static auv in each switching process that is a u v 3 and a u v 5 respectively in the following the static auvs will be regarded as the supporting vehicle and the target whose positions will not be influenced by current disturbances in order to simulate unknown current we recalculated positions of the other auvs in the system using dead reckoning algorithm with addition of current velocity and original positions are taken as ground truth values to derive range measurements 4 2 cooperative current estimation 4 2 1 without packet loss and measurement noise for verification of cooperative current estimation algorithm data from experiment 1 is used with addition of gaussian distributive current velocities as eq 27 27 c x n 0 08 0 001 c y n 0 05 0 001 with added current disturbances derived positions of auvs are shown in fig 12 where red dots are original positions and greed dots are positions with unknown current disturbances the figure demonstrates that formation of the system will diverge very fast even with small current velocity and will lead to failure of multi auvs missions such as passing through narrow tunnel which is a typical task for straight line formation in this section without consideration of packet loss and measurement noise current estimation is carried out taking a data set with 40 samples for each optimization process during the formation switching in experiment 1 optimizations are taken three times totally with resulting current estimation values and position errors listed in tables 2 and 3 according to simulation results largest position errors with current estimation are smaller than 0 2m which is neglectable in most marine applications it can be concluded that the current estimation algorithm proposed in this paper is feasible for multi auvs system 4 2 2 with packet loss and measurement noise in this section packet loss and range measurement noise are added in estimation to make the verification more practical in real world scenarios packet loss probability is chosen as 0 2 according to instruments usage and random range measurement noise is added with maximum of 0 01 range which is a common specification for range measurement of sonar in this case current and position estimation can be obtained as tables 4 and 5 comparing with estimations based on perfect communications and range measurements in tables 2 and 3 it can be noticed that estimation errors of currents and positions have increase to some extent however even though in this case compensation of current velocity still brings better position estimations for multi auvs system as in fig 12 one fundamental reason behind the increase in errors is the size of data set used in optimization is not large enough to estimate distribution of range measurement noise especially with occasionally lost samples to better illustrate this problem the optimization process was tested with data set consists of 120 samples and more accurate results were obtained as in table 6 this results indicated that even with additional noise estimation accuracy can also be guaranteed as long as samples are enough to obtain noise distribution 4 3 cooperative target searching for cooperative target searching task field data from experiment 2 is used in this case a u v 5 is acting as the target and no longer sends its own position to multi auvs system current velocity as eq 27 is also adopted here with recalculated trajectory shown in fig 13 as green dots even though formation obtained still seems like a rectangle this will impact the performance of multi auvs system for target searching in addition packet loss and range measurement noise are still considered in this section with accuracy as above the range measurements from target to auvs are based on synchronized clock in practice however slowly accumulated clock error still exists even for instrument with high accuracy in this simulation we assume that the clock error exists but is a constant during the estimation since accumulation of clock error in a short time is quite small in fact 10 ms clock error is added to the range measurement with sound velocity of 1500 m s this value is reasonable since 10 ms clock error need to be accumulated for 10000 h with 1 ppm oscillator since a u v 5 is not really physically fixed but is kept with dynamic positioning algorithm the position of a u v 5 is 17 08m in x direction with standard deviation of 0 08m and 233 04m in y direction with standard deviation of 0 168m with the proposed target searching algorithm in section 3 2 simulation results are obtained as in tables 7 and 8 the size of data set used in each optimization process is 30 and the optimization has been carried out for 2 times in total it can be found that with acceptable current estimation results the target position errors are less than 0 3 meter in maximum and the clock error is estimated with high accuracy the feasibility of the algorithm has been proved 5 conclusions this paper considered about cooperative current estimation problem for multi auvs in deep ocean where no bottom tracking dvl was available in order to improve accuracy of localization and guarantee accomplishments of missions taking real world applications including formation maneuvering and target searching as examples algorithms were proposed with capabilities of current estimation and target searching with additional communication failure measurement noise and clock error to ensure the observability of estimation several formation switching strategies were brought out to prove that simple and common deployed formation switching were enough to obtain current estimation and target searching finally field data based simulations were carried out to verify feasibilities of methods and results have shown that cooperative current estimation for multi auvs system was both necessary and applicable in the future algorithms will be tested in deep ocean environment with synchronized acoustic communication modem mounted furthermore the current estimation method will be directly integrated into a graph based cooperative navigation framework where all kind of solutions can be deployed in a plug and play manner acknowledgments this work was supported by the national natural science foundation of china under grant 51809060 51909044 and 51679057 the distinguished youth scholars foundation of heilongjiang province under grant j2016jq0052 the natural science foundation of heilongjiang province under grant e2017014 the fundamental research funds for the central universities 3072019cfj0407 and 3072019cfm0404 
22580,in deep ocean scenario where drift of autonomous underwater vehicle auv localization system can be fast since no bottom tracking data can be obtained by doppler velocity logger dvl missions for auv are either hardly to be carried out or depended on expensive inertial instruments this paper presents a multi auvs cooperative ocean current estimation method by formulating factor graphs and solving nonlinear optimization problems which can be used for typical applications such as formation maneuvering and cooperative target searching considering that only intermittent information is broadcasted by acoustic modems observability of the system in each case is analyzed with designed simple formation switching strategies with the help of water tracking velocity acquired by acoustic doppler current profiler adcp and estimation of ocean current accuracy of auv localization system can be improved to an acceptable level for formation control and reliable position of the target can be obtained even with accumulated clock error at last field data based simulations have been carried out to demonstrate the feasibility of the proposed methodology keywords multi auvs current estimation nonlinear optimization deep ocean applications 1 introduction localization system for auv is usually composed of inertial measurement units imu doppler velocity loggers dvl for position integration and external sources from global navigation satellite systems gnss long baselines lbl or ultra short baselines usbl for position calibration leonard and bahr 2016 stutters et al 2008 with widely used fiber optic gyroscope fog and bottom tracking dvl paull et al 2014 the system can obtain localization accuracy better than 0 5 of travel distance the localization accuracy will ensure auv to carry out most tasks such as oceanographic surveys mine countermeasures and seabed mapping bogue 2015 with relative long calibration interval however in deep ocean environment where bottom tracking dvl is not available due to the limitation of detection range localization can drift fast with only accelerometer to calculate velocity of auv even though auv can maneuver near the bottom of deep ocean to get velocity measurement this leads to higher requirement for underwater sealing and auv would also loss velocity measurements during diving and surfacing processes hegrenaes and hallingstad 2011 proposed a model aided inertial navigation system ma ins to solve this problem with velocity measurements derived from dynamic model of auv hegrenaes and berglund also equipped auv with both bottom tracking and water tracking dvl in case bottom tracking dvl fails in middle depth operations randeni p et al 2016 further considered about dead zone of adcp and brought out wvam method to improve accuracy and feasibility nevertheless in both hegrenaes and hallingstad 2011 and randeni p et al 2016 dynamic model of auv fossen 2011 which can be both time and fund consuming to obtain is required for reliable localization this problem becomes even more serious for multi auvs system since consistency of each auv is difficult to ensure as a result we need to implement parameter identification experiments for each one acoustic positioning systems provide alternative solutions to this problem lbl or usbl based localization systems are often deployed in these cases morgado et al 2013 jakuba et al 2008 usually surface subsurface buoys or sea floor moored transponders are used to compose lbl positioning system which can only cover limited areas hunt et al 1974 resulting deficiency in practice in bahr et al 2009 authors proposed the concept of moving long baseline mlbl using two surface vehicles as communication navigation aids localization can be guaranteed with low end imus the result was further improved that only one surface vehicle was needed with particular path planning algorithms to keep observability fallon et al 2010 methods provided in bahr et al 2009 and fallon et al 2010 greatly increased feasibility of lbl for auv applications but it should be mentioned that one or more autonomous surface vehicles are required and will add complexity to the deploying and recovering process of multi auvs missions besides usbl is another popular approach to aid auv localization which can directly mounted on the ship with localization range of several kilometers morgado et al 2010 rigby et al 2006 one significant deficiency for usbl is the interrogation response solution to localize auv as mentioned in eustice et al 2007 since bandwidth burden will increase a lot in a multi auvs system taking this problem into consideration eustice et al 2007 brought out one way travel time owtt ranging architecture which not only reduced redundant communications but also potentially extended supporting range of navigation from several kilometers to tens of kilometers and several cooperative estimation algorithms are tested based on owtt ranging with different communication topology in walls and eustice 2011 further walls and eustice 2014 2013 webster et al 2013 proposed origin state method based on pose graph handling packet loss problem of underwater communication inspired by the research results owtt ranging method is also adopted in this paper and feasibility of current estimation algorithm will be tested under unreliable communication link and range measurement noise to be more practical as a conclusion in this paper we aim to propose solutions for localization of multi auvs system in deep ocean applications main principles are 1 practical implementation procedure 2 simple operation requirements 3 better usage of multi auvs architecture according to above principles and related studies reviewed we have brought out a cooperative current estimation based multi auvs localization method regarding two typical multi auvs missions in deep ocean environment a formation maneuvering and b cooperative target searching sensors involved in this methodology include imu gps adcp and synchronized acoustic communication modem sacm besides time division strategy is adopted to ensure communication reliability for formation maneuvering mission of multi auvs a supporting vehicle sv with high position accuracy is needed to broadcast its position with sacm the whole system structure can be presented as fig 1 p s v k δ t indicates position message of sv at t k δ t where δ t is the constant time period that is longitude and latitude value of sv at time instant k i m 1 δ t a u v i sends out its own state x a u v i current estimation c a u v i and d a u v i that indicating distance between a u v i and sv in addition m is the total number of auvs involved in the system for large area target searching mission of multi auvs system assumptions are made that the target is equipped with underwater acoustic beacon and the acoustic beacon has an oscillator with 1 ppm accuracy in this mission position of the target and accumulated clock error are estimated along with ocean current based on similar method used in formation maneuvering mission it is also worth noticing that acoustic beacon based current estimation can also be used in formation maneuvering to improve localization accuracy as long as multi auvs can drop acoustic beacons occasionally along desired path in this case sv is not necessary and multi auvs system can be more self contained in deep ocean system structure during this mission is almost the same as the one shown in fig 1 except no position information will be sent anymore regarding deep ocean missions of multi auvs above factor graph which is often used in the field of simultaneous localization and mapping slam cadena et al 2016 cunningham et al 2010 is adopted in this paper to formulate cooperative current estimation problem as maximum a posteriori map estimation in particular auv states current estimations and accumulated errors are taken as variable nodes while relative range measurements and dead reckoning integrations are regarded as factor nodes with consideration of intermittency nonlinear optimization problem can be solved with gtsam kaess et al 2008 2012 in addition unlike unmanned surface vehicles it is inconvenient for svs such as large ships moored buoys and impossible for static targets to maneuver with designed trajectory formation switching strategy is proposed instead to guarantee observability of the estimation algorithm it has shown in this paper that simple switching strategy is enough to realize both current estimation and target searching remaining parts of this paper are organized as follows section 2 introduces mathematic formulation of multi auvs current estimation and target searching problems then factor graph based descriptions of these problems are brought out with observability analysis in section 3 in the following section 4 field data based simulations are carried out to verify the feasibility of proposed algorithms in both cases at last conclusions are drawn with future work 2 problem formulation consider a multi auvs system composed with m auvs indicated as a u v 1 a u v 2 a u v m for each auv the state of a u v i at time instant k is defined as x i k x i k y i k ψ i k u i k v i k p i k ψ i k u i k v i k with x y ψ u v indicate east north yaw surge and sway separately and p directly represents position of a u v it should be noticed that we define state variables only in planar coordinate since depth can be accurately obtained with depthmeter and positions of auvs are main concerns in this paper without loss of generality all system states are assumed to be observable at initial time instant k 0 that is x i 0 i 1 m are known in addition δ t is used to represent constant time period in the whole system we can derive position of a u v i at each time instant k according to dead reckoning algorithm as 1 x i k x i 0 δ t j 0 k 1 u ˆ i j cos ψ ˆ i j v ˆ i j sin ψ ˆ i j y i k y i 0 δ t j 0 k 1 u ˆ i j sin ψ ˆ i j v ˆ i j cos ψ ˆ i j where u ˆ i v ˆ i and ψ ˆ i are measurements from sensors in deep ocean environment where bottom tracking dvl velocities are not available only water tracking velocities u ˆ i w v ˆ i w are provided then eq 1 should be revised as 2 x i k x i 0 δ t j 0 k 1 u ˆ i w j cos ψ ˆ i j v ˆ i w j sin ψ ˆ i j c ˆ x w j y i k y i 0 δ t j 0 k 1 u ˆ i w j sin ψ ˆ i j v ˆ i w j cos ψ ˆ i j c ˆ y w j with c ˆ x w j c ˆ y w j representing current velocity estimations in east and north respectively since current velocity changes slowly comparing with the velocity of auv we take c ˆ x w j c ˆ y w j as constant c x w and c y w for during one optimization process in the following sections δ t is omitted for simplicity by using k k j representing k δ t and k j m 1 δ t respectively the state of supporting vehicle can be defined as x 0 k x 0 k y 0 k at time instant k according to the system structure in fig 1 define x k as 3 x k x 0 k x 1 k x m k which can be obtained by a u v i during k k 1 excepting packet loss exists in addition range measurements can be obtained among auvs and sv with definition 4 d k d 1 i k d m i k i 0 m with d j i k representing distance between a u v j and a u v i at time k as a result each auv could estimate current velocity c x w c y w to compensate potential position errors generated from eq 2 as a result formation maneuvering problem to be solved can be presented as maximum a posteriori estimation shown as 5 x c x w c y w argmin x c x w c y w p x c x w c y w d k similarly for target searching application x 0 k is converted from measurements to constant variables to be estimated then x k is revised as 6 x k x 1 k x 2 k x m k defining accumulated clock error as δ 0 k which can be taken as constant δ 0 during whole estimation process for 1 ppm oscillator target searching problem can be presented as 7 x c x w c y w δ 0 argmin x c x w c y w δ 0 p x c x w c y w δ 0 d k where d k is the same as eq 4 3 cooperative estimation 3 1 formation maneuvering according to the definition of factor graph we can represent the estimation problem mentioned in section 2 in terms of graph model defining factor nodes f i ℱ i and variable nodes θ i θ i for a u v i the graph g i ℱ i θ i ε i can indicate corresponding factor graph with edges ε i then the joint probability density function in eq 5 for a u v i can be factorized as 8 p i x i c x w c y w x k d k k f i k θ i k where θ i k include positions and current estimations of a u v i during k k 1 f i k indicate functions of θ i k in the graph to better illustrate components of θ i k structure of g i is depicted as fig 2 with one sv and only one neighbored auv for simplicity according to fig 2 black variable node x i k represents state of a u v i at time instant k blue variable node c i k is the corresponding current velocity and green box represents position of sv with no need to estimate as a result factor nodes can be formulated in three different types as followed 9 f i x p i k p i k 1 g p i k 1 h p i k u i k c i k ψ i k f i 0 p 1 k x 0 k g r 1 2 p i k x 0 k d i 0 k 2 f i j n i p i k p j k g r 2 2 p j k p i k d j 0 k 2 where f i x represents dead reckoning factor with h x i k u i k c i k ψ i k indicating integration process between k and k 1 as eq 2 and c i c i x c i y factor f i 0 is the error between predicted distance and range measurement with 10 r 1 p i k x 0 k p i k x 0 k 2 i 1 m similarly factor f i j k is the error between a u v 0 and a u v j n i where n i is set of auvs in neighbor of a u v i and r 2 with definition as 11 r 2 p j k p i k p j k k c j k c i x 0 k 2 j n i where c i and c j are current values we should notice that even though assumed to be constant in one optimization process current estimations are also updated during each optimization process and can be adapted to slow changes finally general gaussian noise distribution is taken for all prediction errors as g a to further expand r 1 2 k and r 2 2 k define z i x k and z i y k according to eq 2 as below for briefness 12 z i x k u ˆ i w k cos ψ ˆ k v ˆ i w k sin ψ ˆ k z i y k u ˆ i w k sin ψ ˆ k v ˆ i w k cos ψ ˆ k then r 1 2 k and r 2 2 k can be derived as 13 r 1 2 p i k x 0 k x i 0 j 0 k 1 z i x j c ˆ i x j x 0 k 2 y i 0 j 0 k 1 z i y j c ˆ i y j y 0 k 2 x i k k c i x x 0 k 2 y i k k c i y y 0 k 2 where x i k and y i k represent dead reckoning derived position of a u v i at time instant k without consideration of current velocity and 14 r 2 2 p j k p i k x j k k c i x x 0 k 2 y j k k c i y y 0 k 2 x j k k c j x k c i x x 0 k 2 y j k k c j y k c i y y 0 k 2 reason to adopt this construction is to ensure the observability of current estimation with simple formation switching strategy as discussed in follows in addition another benefit to add this item is to reach consensus of current estimations among auvs since errors in this formulation also caused by different current velocities estimated considering about observability of the nonlinear optimization problem we can first analyze factors mentioned above intuitively 1 f i x is the factor results from relative measurements 2 for factor f i 0 impact of current can be reflected by range measurement between auv and sv 3 factor f i j represents distance prediction error between sv and a u v j used by a u v i through the formulation of r 2 this factor implies influence of current estimation of a u v j on a u v i as a conclusion f i 0 and f i j are main factors used next for observability analysis first for the system depicted as fig 2 measurements can be described as 15 e k e 1 k e 2 k x 1 k k c x x 0 k 2 y 1 k k c y y 0 k 2 d 1 0 k 2 x 2 k k c x x 0 k 2 y 2 k k c y y 0 k 2 d 2 0 k 2 according to weak observability theorem in slotine et al 1991 we can regard c x and c y as system states to be observed and take the lie derivative of measurement e 1 and e 2 as below l f 0 e 1 e 1 l f 0 e 2 e 2 l f 1 e 1 0 l f 1 e 2 0 as a result observability matrix can be directly given as 16 o 2 k ϵ 1 x 2 k 2 c x 2 k ϵ 1 y 2 k 2 c y 2 k ϵ 2 x 2 k 2 c x 2 k ϵ 2 y 2 k 2 c y with ϵ i x x i k x 0 k it is obvious that the rank of o is same as the rank of o 17 o ϵ 1 x k c x ϵ 1 y k c y ϵ 2 x ϵ 1 x ϵ 2 y ϵ 1 y the system is observable if the observability matrix is full rank that is 18 det o ϵ 1 x k c x ϵ 2 y ϵ 1 y ϵ 1 y k c y ϵ 2 x ϵ 1 x ϵ 1 x k c x y 2 y 1 ϵ 1 y k c y x 2 x 1 0 according to eq 18 full rank condition can be satisfied as long as it can be guaranteed that 1 position of auv is not exactly the same as position of sv otherwise will make ϵ 1 x k c x and ϵ 1 y k c y all zeros this condition can be easily reached because sv usually is some distance away from auv formation 2 auvs do not have same desired horizontal position which lead to dead reckoning results y 2 y 1 0 and x 2 x 1 0 this is always the case for a fleet of auvs maneuvering around with particular horizontal formation 3 when condition 1 2 are satisfied we still need 19 ϵ 1 x k c x y 2 y 1 ϵ 1 y k c y x 2 x 1 that is 20 y 2 y 1 x 2 x 1 ϵ 1 y k c y ϵ 1 x k c x y 1 y 0 x 1 x 0 the condition in eq 20 actually means that direction of relative movement between a u v 1 and a u v 2 should not aligned with direction between a u v 1 and sv one typical scenario goes against this condition is that a u v 1 a u v 2 and s v are moving in a straight line 4 auvs and sv in the system are not operating with the same velocity and direction this condition is implicitly lied in the construction of measurement function since all variable are observable at the beginning that is x 0 x 0 and y 0 y 0 we can deduct measurement matrix in eq 15 with zero value x i 0 x 0 0 2 y i 0 y 0 0 2 d i 0 0 2 in each row without above condition we would have x i k x i 0 k c x x 0 k x 0 0 0 y i k y i 0 k c x y 0 k y 0 0 0 then the measurement matrix can never be full rank besides it needs to be mentioned that the observability can be degraded even if only multi auvs have the same velocity and direction for a long term formation keeping mission since this will lead to z i x x i 0 and z i y y i 0 we have x 1 k k c x x 0 k x 2 k k c x x 0 k and y 1 k k c y y 0 k y 2 k k c y y 0 k in eq 15 and the optimization process would hardly reach accurate estimation with above analysis and resulting requirements we propose simple formation switching strategies that are enough to guarantee observability conditions in order to estimate current velocity for position compensation comparing with the proposed path planning method for usv to guarantee single auv localization in fallon et al 2010 the methodology in this paper releases the requirement for s v to operate complex path which would be expensive for large ships and impossible for moored buoy and the communication links from auvs to sv following three typical formation switching strategies are chosen as examples a circling circling formation switching strategy is illustrated as fig 3 this switching strategy is usually implemented before the whole multi auvs system is about to turning left in example and can reduce the possibility of collision for auvs without available sensors to realize obstacle avoidance it is obvious that all conditions mentioned above can be directly satisfied in this case and current estimation can be reached during the formation switching process b shrinking or expanding shrinking or expanding formation switching strategy is illustrated as fig 4 which is usually needed for multi auvs system to pass narrow channels in harbors for example in addition for seabed mapping mission shrinking and expanding can be used to adjust the resolution of seabed data that make whole task execution process more scalable according to conditions both shrinking and expanding process can be used to estimate current velocity c triangle to rectangle triangle to rectangle formation switching strategy is illustrated as fig 5 one potential application of this strategy is to obtain better detecting results in cooperative target detection missions since different alignments of sonar arrays can gain different detection capabilities furthermore as mentioned in walls and eustice 2014 acoustic communication is not reliable enough and packet loss always happens in field applications with the required conditions as above observability can be guaranteed for every time period however this is a sufficient condition for current estimation but not a necessary one since we do not actually need to estimate slowly changed current velocity frequently to better illustrate eq 15 is revised as below 21 e k 1 k 2 k n e 1 k 1 e 2 k 1 e 1 k n e 2 k n t according to eq 21 it can be concluded that during the time window from k 1 to k n a single useful sample is enough to keep the observability of current estimation under the assumption that current velocity is constant during that period as a conclusion in this section we have introduced a solution to current estimation problem for formation maneuvering case with formulating the optimization problem in factor graph the whole system structure can be presented in a much more clear format in addition observability analysis is carried out to show that even with simple formation switching strategies conditions needed to obtain estimation can be satisfied three different types of switching strategies that are usually needed in practice are listed as examples current estimation can be directly carried out during typical mission execution and does not need to be treated specially in most cases in next section estimation in target searching case will be further discussed to not only obtain current velocity but also static target position and accumulated clock error 3 2 target searching in target searching problem as shown in fig 6 components of factor graph are similar as in fig 2 but with revisions that the position of target and the clock error are regarded as states to be estimated for the observability of current velocity target position and clock error we need to revise eq 15 as 22 e k e 1 k 1 e 2 k 1 e 1 k 2 e 2 k 2 e 1 k 3 ξ x 1 k 1 x 0 2 ξ y 1 k 1 y 0 2 δ 0 2 d 1 0 k 1 2 ξ x 2 k 1 x 0 2 ξ y 2 k 1 y 0 2 δ 0 2 d 2 0 k 1 2 ξ x 1 k 2 x 0 2 ξ y 1 k 2 y 0 2 δ 0 2 d 1 0 k 2 2 ξ x 2 k 2 x 0 2 ξ y 2 k 2 y 0 2 δ 0 2 d 2 0 k 2 2 ξ x 1 k 3 x 0 2 ξ y 1 k 3 y 0 2 δ 0 2 d 1 0 k 3 2 with ξ x i k j x i k j k j c x ξ y i k j y i k j k j c y and δ 0 represents accumulated clock error similarly as eq 16 the observability matrix can be presented as eq 23 as long as k 1 k 2 k 3 and k 1 k 2 k 3 0 23 o ˆ 0 0 ξ x 1 k 1 x 0 ξ y 1 k 1 y 0 ξ 1 k 1 0 0 ξ x 2 k 1 x 0 ξ y 2 k 1 y 0 ξ 2 k 1 ξ x 1 k 2 x 0 ξ y 1 k 2 y 0 0 0 ξ 1 k 2 ξ x 2 k 2 x 0 ξ y 2 k 2 y 0 0 0 ξ 2 k 2 ξ x 1 k 3 x 0 ξ y 1 k 3 y 0 k 2 k 3 k 3 k 1 ξ x 1 k 3 x 0 k 2 k 3 k 3 k 1 ξ y 1 k 3 y 0 k 2 k 1 k 3 k 1 ξ 1 k 3 with ξ i k j ξ x i k j x 0 2 ξ y i k j y 0 2 define o as 24 o 0 0 ξ x 1 k 1 x 0 ξ y 1 k 1 y 0 0 0 ξ x 2 k 1 x 0 ξ y 2 k 1 y 0 ξ x 1 k 2 x 0 ξ y 1 k 2 y 0 0 0 ξ x 2 k 2 x 0 ξ y 2 k 2 y 0 0 0 it can be concluded that if det o ˆ 0 observability of estimation can be guaranteed with o 1 and o 2 defined as 25 o 1 ξ x 1 k 1 x 0 ξ y 1 k 1 y 0 ξ x 2 k 1 x 0 ξ y 2 k 1 y 0 and 26 o 2 ξ x 1 k 2 x 0 ξ y 1 k 2 y 0 ξ x 2 k 2 x 0 ξ y 2 k 2 y 0 since det o det o 1 det o 2 and formulations of o 1 and o 2 are same as eq 17 conditions for system to be observable listed in section 3 1 are still available here if we have det o 1 0 and det o 2 0 the observability of current estimation and target searching problem is ensured in the meanwhile formation switching strategies proposed above are also useful to improve the observability of the system in this case conclusions drawn in this section indicate an worth noticing fact that observability of current estimation or target searching can be improved if we increase the number of measurements as eq 22 which is consistent with discussion with eq 21 actually in real world applications better observability can be reached since the size of data set used in one optimization process can be dozens according to communication noise and disturbance 4 experiments and simulations according to algorithms proposed above simulations are carried out in this section basing experimental data from practical missions as shown in fig 7 since experiments were taken in the lake where current velocity is small and bottom tracking dvl is available current to be estimated is added through postprocessing in order to simulate deep ocean environment the multi auvs system deployed is depicted as below 4 1 multi auvs system the multi auvs system is composed of auvs as in fig 8 and specifications of the auv are listed in table 1 when auv is maneuvering in the lake antenna is mounted for wireless communication and gps localization as shown in fig 9 each individual auv is equipped with sensors such as imu gps dvl and depthmeter the sacm mentioned in this paper is simulated by calculating distance from ground truth positions so that the current added will only influence position estimations of auvs other than acoustic range measurements to better reflect practical situations packet loss and range measurement noise are also added with the multi auvs system cooperative current estimation algorithm and target searching algorithm are verified in this section field data used are obtained from two cooperative formation control missions with formation switching including 1 switching from triangle to straight line fig 10 2 switching from triangle to rectangle fig 11 according to the results there are slight consensus errors for formation control in both cases but it can be omitted since these errors would not be induced into estimation processes in addition it is obvious that there is a near static auv in each switching process that is a u v 3 and a u v 5 respectively in the following the static auvs will be regarded as the supporting vehicle and the target whose positions will not be influenced by current disturbances in order to simulate unknown current we recalculated positions of the other auvs in the system using dead reckoning algorithm with addition of current velocity and original positions are taken as ground truth values to derive range measurements 4 2 cooperative current estimation 4 2 1 without packet loss and measurement noise for verification of cooperative current estimation algorithm data from experiment 1 is used with addition of gaussian distributive current velocities as eq 27 27 c x n 0 08 0 001 c y n 0 05 0 001 with added current disturbances derived positions of auvs are shown in fig 12 where red dots are original positions and greed dots are positions with unknown current disturbances the figure demonstrates that formation of the system will diverge very fast even with small current velocity and will lead to failure of multi auvs missions such as passing through narrow tunnel which is a typical task for straight line formation in this section without consideration of packet loss and measurement noise current estimation is carried out taking a data set with 40 samples for each optimization process during the formation switching in experiment 1 optimizations are taken three times totally with resulting current estimation values and position errors listed in tables 2 and 3 according to simulation results largest position errors with current estimation are smaller than 0 2m which is neglectable in most marine applications it can be concluded that the current estimation algorithm proposed in this paper is feasible for multi auvs system 4 2 2 with packet loss and measurement noise in this section packet loss and range measurement noise are added in estimation to make the verification more practical in real world scenarios packet loss probability is chosen as 0 2 according to instruments usage and random range measurement noise is added with maximum of 0 01 range which is a common specification for range measurement of sonar in this case current and position estimation can be obtained as tables 4 and 5 comparing with estimations based on perfect communications and range measurements in tables 2 and 3 it can be noticed that estimation errors of currents and positions have increase to some extent however even though in this case compensation of current velocity still brings better position estimations for multi auvs system as in fig 12 one fundamental reason behind the increase in errors is the size of data set used in optimization is not large enough to estimate distribution of range measurement noise especially with occasionally lost samples to better illustrate this problem the optimization process was tested with data set consists of 120 samples and more accurate results were obtained as in table 6 this results indicated that even with additional noise estimation accuracy can also be guaranteed as long as samples are enough to obtain noise distribution 4 3 cooperative target searching for cooperative target searching task field data from experiment 2 is used in this case a u v 5 is acting as the target and no longer sends its own position to multi auvs system current velocity as eq 27 is also adopted here with recalculated trajectory shown in fig 13 as green dots even though formation obtained still seems like a rectangle this will impact the performance of multi auvs system for target searching in addition packet loss and range measurement noise are still considered in this section with accuracy as above the range measurements from target to auvs are based on synchronized clock in practice however slowly accumulated clock error still exists even for instrument with high accuracy in this simulation we assume that the clock error exists but is a constant during the estimation since accumulation of clock error in a short time is quite small in fact 10 ms clock error is added to the range measurement with sound velocity of 1500 m s this value is reasonable since 10 ms clock error need to be accumulated for 10000 h with 1 ppm oscillator since a u v 5 is not really physically fixed but is kept with dynamic positioning algorithm the position of a u v 5 is 17 08m in x direction with standard deviation of 0 08m and 233 04m in y direction with standard deviation of 0 168m with the proposed target searching algorithm in section 3 2 simulation results are obtained as in tables 7 and 8 the size of data set used in each optimization process is 30 and the optimization has been carried out for 2 times in total it can be found that with acceptable current estimation results the target position errors are less than 0 3 meter in maximum and the clock error is estimated with high accuracy the feasibility of the algorithm has been proved 5 conclusions this paper considered about cooperative current estimation problem for multi auvs in deep ocean where no bottom tracking dvl was available in order to improve accuracy of localization and guarantee accomplishments of missions taking real world applications including formation maneuvering and target searching as examples algorithms were proposed with capabilities of current estimation and target searching with additional communication failure measurement noise and clock error to ensure the observability of estimation several formation switching strategies were brought out to prove that simple and common deployed formation switching were enough to obtain current estimation and target searching finally field data based simulations were carried out to verify feasibilities of methods and results have shown that cooperative current estimation for multi auvs system was both necessary and applicable in the future algorithms will be tested in deep ocean environment with synchronized acoustic communication modem mounted furthermore the current estimation method will be directly integrated into a graph based cooperative navigation framework where all kind of solutions can be deployed in a plug and play manner acknowledgments this work was supported by the national natural science foundation of china under grant 51809060 51909044 and 51679057 the distinguished youth scholars foundation of heilongjiang province under grant j2016jq0052 the natural science foundation of heilongjiang province under grant e2017014 the fundamental research funds for the central universities 3072019cfj0407 and 3072019cfm0404 
22581,in this paper the hydrodynamic interaction between amirkabir semi submersible and a mono column fpso floating platforms in caspian sea conditions was studied dynamic responses of the floating platforms in the second order stokes incident wave was investigated using the boundary element method in ansys aqwa software for both time domain and frequency domain in this numerical simulation the hydrodynamic loads acted on the hull body were determined by 3d radiation diffraction theory while the mooring line forces were estimated by the morison elements method the main purpose of the research is to study the effects of different distances between centers of platforms and different wavelengths on semi submersible hydrodynamics motions hydrodynamic forces and mooring line tension the numerical results show that as the platforms come closer the values of diffraction force motions and the oscillation of mooring line tension for the semi submersible platform decrease in addition increase of wave length results in increase of the motions of semi submersible platform in this process the hydrodynamic forces and the oscillation of mooring line tension demonstrate a peak in wave length of about 55 60 m keywords hydrodynamic interaction dynamic responses radiation diffraction theory mooring tension hydrodynamic forces symbols fluid domain ω velocity potential function ϕ green s function g wave number k relationship between wave frequency and wave number v sea depth d bessel function of the first kind j 0 dirac delta function δ wave frequency in rad s ω incident wave amplitude a w gravitational acceleration g water density ρ total potential ϕ x radiation wave potential ϕ 1 incident wave potential ϕ d diffracted wave potential ϕ r j position vector r first order hydrodynamic pressure p 1 mean wetted surface s 0 unit normal vector n center of gravity x g total 1st order hydrodynamic force f j j th froude krylov force f i j j th diffracted force f d j j th radiated force f r j k added mass a j k damping b j k structural mooring mass per unit length m distributed moment per unit length q the position vector of the cable element first node r length of the element δ s e diameter of the element d e weight of the element w tension force vector at the element first node t bending moment vector at the element first node m shear force vector at the element first node v hydrodynamic load f h drag load f d buoyant load f b added mass matrix of the cable element m a cable acceleration at node j a j element buoyant force matrix m b equivalent cross sectional area of the mooring line element a c j un stretched element length l j drag coefficients of the intermediate buoy c d b projected surface area s b mooring element drag force f d j structural velocity matrix form at node j in time t v j t current velocity matrix form at node j u j transverse drag coefficients c d inline drag coefficients c x total structure matrix m s total added mass matrix due to morison element and diffraction panels m a hydrostatic stiffness matrix k h y s additional structural stiffness matrix k a hydrodynamic damping matrix c diffracting force and total froude krylov force f j m velocity impulse function matrix r structural mass matrix m fluid added mass matrix at infinite frequency a damping matrix c total stiffness matrix k acceleration impulse function matrix h t added mass matrix a ω hydrodynamic damping matrix b ω first order wave excitation force f 1 t second order wave excitation force f 2 t mooring force f t t significant wave height h s significant wave period t s wind speed v s 1 introduction the analysis of hydrodynamic interaction between tandem floating bodies in the sea condition is a complex task relevant to many navy operations and offshore activities for the safe operation the hydrodynamic interaction between two or more floating structures needs to be carefully taken into account hydrodynamic interaction of multi platforms concerns the influence of flow field of one structure on another s the importance of hydrodynamics interaction between several floating platforms in sea condition will depend on both the relative dimensions of the floating platforms and their separation distance in the literature the hydrodynamic interactions between two ships advancing in oblique waves were carried out in different arrangements speeds and headings by applying the strip theory fang and kim 1986 kodan 1984 investigated the hydrodynamic interaction between two parallel slender floating structures in oblique waves using the 2d strip and diffraction theories they found good agreement between theoretical and experimental results hess and smith 1962 investigated the non lifting potential flow applying a source density distribution about arbitrary 3d objects to approximate the body surface in this method plane quadrilateral surface elements were used hong et al 2003 used a higher order boundary element method hobem combined with generalized mode approach to account drift force and motion of side by side three moored vessels lng fpso lgc and shuttle tankers in regular and irregular waves wu et al 1997 studied the motion of a moored semi submersible in their study the floating body with external constraints was divided into several rigidly connected parts in regular waves they finally derived the linearized equations of motions for this interaction hydrodynamic interaction between a semi submersible tender assisted drilling and a tension leg platform tlp to obtain relative motions for pitch heave and surge in regular waves were carried out by abyn et al 2016 they concluded that nonlinearity of the wave increase the semi submersible platform motions especially in the natural frequency region hydrodynamic interaction between several freely floating vertical cylinders were carried out by ali and khalil 2005 using a 3d source sink method in order to study the interaction effect they compared the numerical results for a single cylinder with those of the multi cylinder ones chua et al 2018 developed a framework analysis based on a viscous cfd model to determine the behavior of a partially entrapped water volume between two floating bodies the ship ship interactions in regular waves were investigated by jin et al 2018 using viscous unsteady reynolds averaged navier stokes method it is evident from their results that by approaching the incident wave frequency to the natural frequency of the motions for the flng and lng vessels the gap wave resonance leads to significant variation of wave loads on vessels in different degrees of freedom although first order waves involve a significant portion of wave forces in some circumstances the nonlinear effects of waves are dominant therefore in this study using the first and second order wave forces the hydrodynamic interaction between two floating platforms was simulated using 3d radiation diffraction theories the main focus of this paper is to investigate the effect of different wavelengths and different distances between centers of amirkabir semi submersible and mono column fpso platforms in second order stokes waves the numerical simulation was performed in both time and frequency domains using the boundary element method bem in ansys aqwa software 2 platforms characteristics in this research amirkabir semi submersible drilling platform and a mono column fpso platform were considered in a joint operation in the caspian sea environmental conditions the operation was performed in a water depth of 1000 m significant wave height and period of 8 m and 9 4 s respectively see fig 1 the significant wave was considered as design wave as environmental conditions since for sea and oceans the wave s climate are variable in different seasons the response of the platform has been evaluated at various wavelengths for different sea states amirkabir semi submersible platform consists of four columns a deck a derrick and two pontoons the world s first fpso floating production storage and offloading unit mono column type platform was designed and manufactured for operating in 1090 m water depth located in the piranema field in brazil it is supposed that this fpso participates in a joint operation with amirkabir semi submersible in caspian sea see fig 2 characteristics of the mono column fpso and amirkabir semi submersible are presented in tables 1 and 2 respectively the catenary mooring system possesses 8 lines with an arrangement of 45 relative to each other in this system each mooring line has a cable between two chain sections the main properties of mooring lines are listed in table 3 3 governing equations in this section the governing equations of the modeling are described 3 1 potential theory the velocity potential is used to define the fluid flow field surrounding a floating body barltrop 1998 as 1 φ x t a w ϕ x e iωt where x x y z is the location relative to fixed reference axes fra t is the time and a w and ω are the wave amplitude and wave frequency respectively in eq 1 the term ϕ x is independent of time and separated into three other terms including the incident wave potential ϕ i due to the changes in water level from calm to wave mode the diffracted wave potential ϕ d due to the return of wave after its impact with the body and the radiation wave potential ϕ r due to six basic modes of body motion the velocity potential is a complex function but some resultant physical quantities such as body motions in time domain analysis and fluid pressure will be obtained considering the real part therefore the velocity potential due to the incident diffraction and radiation waves are written as follows 2 ϕ x e iωt ϕ i ϕ d j 1 6 ϕ rj x j e iωt where ϕ r j is the radiation wave potential due to the j th motion three translational and three rotational motions of the body s center of gravity are introduced by x j 3 x j u j j 1 2 3 x j θ j 3 j 4 5 6 based on linear hydrodynamic theory for inviscid and incompressible fluid and irrotational fluid flow the velocity potential function φ x t with time independent term ϕ x is described by the following equations in far the laplace equation which is used everywhere in the fluid domain ω newman 1979 4 2 ϕ 2 ϕ x 2 2 ϕ y 2 2 ϕ z 2 0 linear free surface equation 5 ω 2 ϕ g ϕ z 0 on z 0 body surface conditions 6 ϕ n i ω n j f o r r a d i a t i o n p o t e n t i a l ϕ n f o r d i f f r a c t i o n p o t e n t i a l seafloor surface condition at depth of d 7 ϕ z 0 on z d the distant condition which the generalized wave disturbance dies away 8 ϕ 0 when x 2 y 2 using the boundary integration approach ansys aqwa was employed to solve the velocity potential for control conditions the frequency domain pulsating green s function is used in this approach for finite water depth in addition to the proposed boundary conditions the following condition is satisfied in the fluid field havelock 1955 9 2 g x ξ ω 2 g x 2 2 g y 2 2 g z 2 δ x ξ where x ε ω and ξ ε ω where ξ ξ η ζ is the position of a source on the platform wetted surface and δ x ξ is the dirac function which is defined as 10 δ x ξ 0 w h e r e x ξ 0 w h e r e x ξ 0 the green s function can be expressed as 11 g x ξ ω 1 r 1 r 2 0 2 k v e kd cosh k z d cosh k ζ d k sinh kd v cosh kd j 0 kr dk i 2 π k 0 v e k 0 d cosh k 0 z d cosh k 0 ζ d sinh k 0 d k 0 d cosh k 0 d vd sinh k 0 d j 0 k 0 r where j 0 is the bessel function of the first kind and 12 r x ξ 2 y η 2 13 r r 2 z ζ 2 14 r 2 r 2 z ζ 2 d 2 15 v ω 2 g 16 k 0 tanh k 0 d v here k 2 π λ is the wave number in which λ is the wavelength applying green s theorem the velocity potential of radiation and diffraction waves can be expressed as a fredholm integral equation of the second kind 17 cϕ x s 0 ϕ ξ g x ξ ω n ξ g x ξ ω ϕ ξ n ξ ds where s 0 is the wetted surface and 18 c 0 x ω s 0 2 π x s 0 4 π x ω also the source distribution σ on the wetted surface can be used to obtain the fluid velocity potential as 19 ϕ x 1 4 π s 0 σ ξ g x ξ ω ds where x ω s 0 the source strength over the wetted surface can be determined by body surface conditions in eq 6 therefore 20 ϕ x n x 1 2 σ x 1 4 π s 0 σ ξ g x ξ ω n x ds where x s 0 ansys aqwa uses the hess smith constant panel to solve eq 20 in this method the wetted surface is divided into triangular or quadrilateral panels it is assumed that the potential and the source strength in each panel are constant and taken as the corresponding average values eqs 19 and 20 are expressed in the discrete integral form as follows hess and smith 1962 21 ϕ x 1 4 π m 1 n p σ m g x ξ m ω δs m where x ω s 0 22 ϕ x k n x k 1 2 σ k 1 4 π m 1 n p σ m g x k ξ m ω n x k δs m where x k s 0 k 1 n p where n p is the total number of the panels over the wetted surface ξ m and x k are coordinates of panel geometric center in the m th and k th panels respectively and δ s m is the m th panel s area 3 2 first order wave force after identification of the wave velocity potentials the first order hydrodynamic pressure distribution is calculated by employing the linearized bernoulli s equation as 23 p 1 ρ φ x t t iωρϕ x e iωt therefore the first order hydrodynamic force and moment components can be written in a generalized form as 24 f j e iωt s 0 p 1 n j ds s 0 ϕ x n j ds e iωt based on eq 2 the total first order hydrodynamic force is expressed as follows 25 f j f ij f dj k 1 6 f rjk x k where j 1 6 in this equation f i j is the froude krylov force due to incident wave in the j th body motion f d j is the diffracting force due to diffraction wave in the j th body motion and f r j k is the radiation force in the j th body motion due to the radiation wave induced by the k th unit amplitude body motion the equation of froude krylov diffracting and radiating force are 26 f ij iωρ s 0 ϕ i x n j ds 27 f dj iωρ s 0 ϕ d x n j ds 28 f rjk iωρ s 0 ϕ rk x n j ds the radiation wave potential ϕ r k can be expressed as a complex function therefore the radiation force in eq 28 can be written as 29 f rjk iωρ s 0 re ϕ rk x iim ϕ rk x n j ds ωρ s 0 im ϕ rk x n j ds iωρ s 0 re ϕ rk x n j ds ω 2 a jk iωb jk where a j k is the added mass and b j k is the wave damping coefficients 30 a jk ρ ω s 0 im ϕ rk x n j ds 31 b jk ρ s 0 re ϕ rk x n j ds 3 3 second order wave force the second order wave exciting forces concept can be explained based on the assumption of hydrodynamic responses of the fixed or floating body surrounding by an incompressible irrotational homogeneous and inviscid fluid in addition in this concept both body motion response amplitudes and the fluid wave amplitudes are small pinkster 1980 under these assumptions in order to express the wave elevation the position of a point on hull body and the fluid potential the perturbation approach applied and velocity potential function can be used to express the surrounding fluid 32 φ εφ 1 ε 2 φ 2 ο ε 3 33 ζ ζ 0 εζ 1 ε 2 ζ 2 ο ε 3 where ε 0 34 x x 0 ε x 1 ε 2 x 2 ο ε 3 where ε is the perturbation parameter and 0 is denoting the static values the first and the second order variations with respect to ε are denoting by superscripts 1 and 2 respectively applying the bernoulli s equation at a given point the fluid pressure can be determined as follows 35 p ρ φ t 1 2 ρ φ φ ρgz p 0 p 1 p 2 ο ε 3 where 36 p 0 ρgx 3 0 37 p 1 ρgx 3 1 ρ φ 1 t 38 p 2 1 2 ρ φ 1 2 ρ x 1 φ 1 t ρ φ 2 t ρgx 3 2 the total fluid force and moment in the fra have the general forms of eqs 39 and 40 that is considered respect to the center of gravity of the hull body 39 f t s t p n ds 40 m t s t p x x g n ds where s t indicates the instantaneous wetted surface area of the hull body the second order wave exciting force and moment can be obtained by the perturbation analysis of eqs 41 and 42 over the instantaneous wetted surface as follows 24 41 f 2 1 2 ρg wl ζ r 1 ζ r 1 n dl water line integral 1 2 ρ s 0 φ 1 φ 1 n ds bernoulli ρ s 0 x 1 φ 1 t n ds acceleration α 1 f 1 momentum ρ s 0 φ 2 t n ds 2 nd order potential and 42 m 2 1 2 ρg wl ζ r 1 ζ r 1 x n dl water line integral 1 2 ρ s 0 φ 1 φ 1 x n ds bernoulli ρ s 0 x 1 φ 1 t x n ds acceleration α 1 m 1 momentum ρ s 0 φ 2 t x n ds 2 nd order potential where s 0 represents the mean wetted surface ζ r 1 ζ r 1 x 3 w l 1 represents the relative wave elevation along the mean undisturbed water line the total fluid force and moment as first order are defined by f 1 and m 1 that including hydrodynamic radiation force and moment wave exciting hydrostatic restoring and the gravity variation relative to the body fixed axes 3 4 mooring equation of motion in order to model the mooring line ansys aqwa morison elements were applied subjected to the external hydrodynamic and structural inertia loadings fig 3 shows a single element of morison type modeled as a circular slender cable for each element of cable the motion equation can be written as follows 43 t s e v s e w f h m 2 r t 2 44 m s e r s e v q where r t m and v are determined at the first node of element and represents the position the tension force the bending moment and the shear force vectors respectively also f h q m and w are determined per unit length and represent external hydrodynamic loading distributed moment structural mass and the element weight respectively d e and δ s e represent element diameter and element length respectively 3 5 equation of motion a combination of panels and the morison elements can be modeled in ansys aqwa the structural equation of motion with frequency dependent coefficients is given by 45 ω 2 m s m a iωc k hys k a x jm f jm where m s and m a are the total structural mass and the total added mass matrices respectively due to morison element and diffraction panels the coefficient c is the hydrodynamic damping matrix due to the diffraction panels k h y s and k a are the assembled hydrostatic stiffness and the additional structural stiffness matrices respectively f j m is the total froud krylov and diffracting forces and moments where m corresponds to the structure and j refer to the motion modes the equation of motion in the time domain is as follows 46 m x t c x t kx t f t in this equation the external force f t has a constant amplitude therefore the equation of motion in the frequency domain cannot be directly converted into the time domain equation hence by employing a convolution integral form the equation of motion can be expressed as follows cummins 1962 47 m s a x t c x t kx t 0 t r t τ x τ dτ f t where a is the added mass matrix at the infinite frequency c is the damping matrix including the effects of the radiation damping k is the total stiffness matrix and r is the velocity impulse function matrix on the other hand the acceleration impulse function matrix h can be used in the equation of motion as follows 48 m s a x t c x t kx t 0 t h t τ x τ dτ f t in which the acceleration impulse function matrix can be defined as 49 h t 2 π 0 b ω sin ωt ω dω 2 π 0 a ω a cos ωt dω where a ω is the added mass matrix and b ω is the hydrodynamics damping matrix the equation of motion can be obtained by substituting the first and second order wave loads into eq 48 as 50 m a x t f 1 t f 2 t f t t c x t kx t 0 t h t τ x τ dτ in the above equation k is the total stiffness matrix and includes the linear hydrostatic and mooring stiffness f 1 t is the first order wave excitation force and moment i e the sum of the froude krylov and diffracting forces and moments f 2 t is the second order wave excitation force and f t t is the mooring and articulation force 4 validation the experimental work on the mono column fpso model see fig 4 a was carried out in the state key laboratory of coastal and offshore engineering of the dalian university of technology with a scale of 1 70 the wave tank was 50 0 m long 1 0 m wide and 1 5 m deep saad et al 2009 the experimental work for amirkabir semi submersible platform was performed in the wave flume of sharif university of technology tehran iran with a scale of 1 143 it was 25 0 m long 2 5 m wide and 1 8 m deep fig 4b shows amirkabir semi submersible platform model characteristics of the mono column fpso and amirkabir semi submersible are presented in tables 1 and 2 respectively in this paper amirkabir semi submersible and mono column fpso platforms were modeled numerically to demonstrate the validity of the results the present bem results for response amplitude operator rao was compared with the mentioned experimental work see fig 5 this comparison shows that the model simulation results and experimental data are consistent 5 results and discussion in this section the results of the modeling are presented and discussed 5 1 hydrodynamic response in this section the motion responses of amirkabir semisubmersible for second order stokes waves were obtained to simplify the complicated problem of wave platforms interaction and make it possible to compare the results for a selected significant wave heights of 8 m based on fig 1 various periods or wave lengths were adopted for incident waves the wavelengths were in the range of 35 to 100 m with a 5 m increment fig 6 shows the results of surge heave and pitch motions for semi submersible platform in the frequency domain for different wavelengths as shown in fig 6 surge heave and pitch motions have two resonant frequencies so that the amplitude of the second resonant frequency is larger than the first one while for wavelengths more than 80 m in surge motion the amplitude of the second resonant frequency is smaller than that of the first one this figure also shows that as the wavelength for these three motions increases the second resonant frequency decreases for heave and pitch motions with increasing the wave length the first and second amplitudes of the resonant frequencies increase for surge motion the amplitude of first resonant frequency demonstrates a peak at waves with lengths of 90m while for this motion the amplitude of second resonant frequency have a peak at waves of 60 length the hydrodynamic interaction of the fpso and the semi submersible platforms concerns the influence of flow field of the fpso on the semi submersible platform therefore with increasing the wavelength in deep sea condition the flow field behind the fpso becomes more disturbing and the semisubmersible is more affected leading to larger platform movements in order to investigate the effect of center to center distance between platforms on the global responses of the semi submersible platform simulations are carried out for second order stokes wave condition with wavelength of 50 m and for six different distances l 125 150 175 200 225 and 250 m fig 7 shows the results of surge heave and pitch motions of the semi submersible platform in the frequency domain for different distances between platforms as can be seen in this figure the frequency response of surge heave and pitch motions in different distances between platforms demonstrates two resonant frequencies the amplitude of the second resonant frequency is larger than that of the first one also it is found that with increasing the separation distance the amplitude of resonant frequencies increases 5 2 hydrodynamics force the maximum values of the both froude krylov and diffraction force in time domain simulation was applied on the semi submersible platform the analysis was performed for different wavelengths and different distances between two platforms the results are presented in figs 8 and 9 fig 8 indicates that the first order hydrodynamic forces for wavelengths from 35 to 55 60 m have an uptrend and then demonstrate a downtrends for 60 to 100 m wavelengths it means that the maximum total force in x direction occurs about 55 60 m wave lengths as can be seen in this figure the trend of both froude krylov and diffraction forces are nearly similar also it is evident that the froude krylov force is larger than diffraction force for wavelengths less than 55 m while after 55 m wavelengths it is vice versa it can be seen from fig 9 that the effects of separation distance between two platforms on froude krylov force are negligible whereas the diffraction force acting on the semi submersible platform increases as the separation distance increases hence the increase in the separation distance between two platforms only effects on the diffraction force while its effect on the froude krylov force is negligible fig 10 shows effects of the wavelength on the froude krylov and diffraction force applied to the semi submersible platform for 35 60 and 95 m wavelengths in time domain analyses it can be seen that oscillation amplitudes of both the diffraction and froude krylov forces for 60 m wavelength were 3 6 and 9 1 times of 35 m wavelength amplitude respectively it is also evident that for 90 m wavelength despite the reduction of these forces compared to that of the 60 m wavelength these forces are 3 4 diffraction force and 0 6 froude krylov force times respectively than the wavelength of 35 m hence percentage contribution of froude krylov force applied to the semi submersible platform is lower than that of the diffraction force 5 3 mooring line tension in fig 11 the effects of different wavelengths and different separation distances on the catenary mooring line tension were investigated in frequency domain this figure shows that decreasing the wavelengths leads to the maximum tension in mooring lines which occurs in higher frequency waves while increasing the separation distances between platforms doesn t affect the frequency of the maximum mooring line tension the mooring line tension of the semi submersible platform in time domain analyses versus the platforms separation distances is presented in fig 12 comparison of time response of the semi submersible mooring line tension for different separation distances shows that increasing the distance between centers of platforms leads to an increase in the amplitude of the mooring line tension oscillations 6 conclusion in this research to simulate the hydrodynamic interaction between two floating platforms in second order stokes wave of the caspian sea the bem of ansys aqwa software was employed the frequency and time domain analysis were performed to investigate the effects of different wavelengths and different separation distances of platforms on the hydrodynamics motions hydrodynamics force and mooring line tension in the light of most important results the following conclusions can be drawn the numerical results show that as the platforms come closer the values of diffraction force motions and the oscillation of mooring line tension for the semi submersible platform decrease as the distance between two platforms increases the diffraction force has an uptrend and has a negligible effect on the froude krylov force also the amplitude of resonant frequencies increases increase of wave length results in an increase in motions of semi submersible platform in this process the hydrodynamic forces and the oscillation of mooring line tension demonstrate a peak in wave lengths of about 55 60 m 
22581,in this paper the hydrodynamic interaction between amirkabir semi submersible and a mono column fpso floating platforms in caspian sea conditions was studied dynamic responses of the floating platforms in the second order stokes incident wave was investigated using the boundary element method in ansys aqwa software for both time domain and frequency domain in this numerical simulation the hydrodynamic loads acted on the hull body were determined by 3d radiation diffraction theory while the mooring line forces were estimated by the morison elements method the main purpose of the research is to study the effects of different distances between centers of platforms and different wavelengths on semi submersible hydrodynamics motions hydrodynamic forces and mooring line tension the numerical results show that as the platforms come closer the values of diffraction force motions and the oscillation of mooring line tension for the semi submersible platform decrease in addition increase of wave length results in increase of the motions of semi submersible platform in this process the hydrodynamic forces and the oscillation of mooring line tension demonstrate a peak in wave length of about 55 60 m keywords hydrodynamic interaction dynamic responses radiation diffraction theory mooring tension hydrodynamic forces symbols fluid domain ω velocity potential function ϕ green s function g wave number k relationship between wave frequency and wave number v sea depth d bessel function of the first kind j 0 dirac delta function δ wave frequency in rad s ω incident wave amplitude a w gravitational acceleration g water density ρ total potential ϕ x radiation wave potential ϕ 1 incident wave potential ϕ d diffracted wave potential ϕ r j position vector r first order hydrodynamic pressure p 1 mean wetted surface s 0 unit normal vector n center of gravity x g total 1st order hydrodynamic force f j j th froude krylov force f i j j th diffracted force f d j j th radiated force f r j k added mass a j k damping b j k structural mooring mass per unit length m distributed moment per unit length q the position vector of the cable element first node r length of the element δ s e diameter of the element d e weight of the element w tension force vector at the element first node t bending moment vector at the element first node m shear force vector at the element first node v hydrodynamic load f h drag load f d buoyant load f b added mass matrix of the cable element m a cable acceleration at node j a j element buoyant force matrix m b equivalent cross sectional area of the mooring line element a c j un stretched element length l j drag coefficients of the intermediate buoy c d b projected surface area s b mooring element drag force f d j structural velocity matrix form at node j in time t v j t current velocity matrix form at node j u j transverse drag coefficients c d inline drag coefficients c x total structure matrix m s total added mass matrix due to morison element and diffraction panels m a hydrostatic stiffness matrix k h y s additional structural stiffness matrix k a hydrodynamic damping matrix c diffracting force and total froude krylov force f j m velocity impulse function matrix r structural mass matrix m fluid added mass matrix at infinite frequency a damping matrix c total stiffness matrix k acceleration impulse function matrix h t added mass matrix a ω hydrodynamic damping matrix b ω first order wave excitation force f 1 t second order wave excitation force f 2 t mooring force f t t significant wave height h s significant wave period t s wind speed v s 1 introduction the analysis of hydrodynamic interaction between tandem floating bodies in the sea condition is a complex task relevant to many navy operations and offshore activities for the safe operation the hydrodynamic interaction between two or more floating structures needs to be carefully taken into account hydrodynamic interaction of multi platforms concerns the influence of flow field of one structure on another s the importance of hydrodynamics interaction between several floating platforms in sea condition will depend on both the relative dimensions of the floating platforms and their separation distance in the literature the hydrodynamic interactions between two ships advancing in oblique waves were carried out in different arrangements speeds and headings by applying the strip theory fang and kim 1986 kodan 1984 investigated the hydrodynamic interaction between two parallel slender floating structures in oblique waves using the 2d strip and diffraction theories they found good agreement between theoretical and experimental results hess and smith 1962 investigated the non lifting potential flow applying a source density distribution about arbitrary 3d objects to approximate the body surface in this method plane quadrilateral surface elements were used hong et al 2003 used a higher order boundary element method hobem combined with generalized mode approach to account drift force and motion of side by side three moored vessels lng fpso lgc and shuttle tankers in regular and irregular waves wu et al 1997 studied the motion of a moored semi submersible in their study the floating body with external constraints was divided into several rigidly connected parts in regular waves they finally derived the linearized equations of motions for this interaction hydrodynamic interaction between a semi submersible tender assisted drilling and a tension leg platform tlp to obtain relative motions for pitch heave and surge in regular waves were carried out by abyn et al 2016 they concluded that nonlinearity of the wave increase the semi submersible platform motions especially in the natural frequency region hydrodynamic interaction between several freely floating vertical cylinders were carried out by ali and khalil 2005 using a 3d source sink method in order to study the interaction effect they compared the numerical results for a single cylinder with those of the multi cylinder ones chua et al 2018 developed a framework analysis based on a viscous cfd model to determine the behavior of a partially entrapped water volume between two floating bodies the ship ship interactions in regular waves were investigated by jin et al 2018 using viscous unsteady reynolds averaged navier stokes method it is evident from their results that by approaching the incident wave frequency to the natural frequency of the motions for the flng and lng vessels the gap wave resonance leads to significant variation of wave loads on vessels in different degrees of freedom although first order waves involve a significant portion of wave forces in some circumstances the nonlinear effects of waves are dominant therefore in this study using the first and second order wave forces the hydrodynamic interaction between two floating platforms was simulated using 3d radiation diffraction theories the main focus of this paper is to investigate the effect of different wavelengths and different distances between centers of amirkabir semi submersible and mono column fpso platforms in second order stokes waves the numerical simulation was performed in both time and frequency domains using the boundary element method bem in ansys aqwa software 2 platforms characteristics in this research amirkabir semi submersible drilling platform and a mono column fpso platform were considered in a joint operation in the caspian sea environmental conditions the operation was performed in a water depth of 1000 m significant wave height and period of 8 m and 9 4 s respectively see fig 1 the significant wave was considered as design wave as environmental conditions since for sea and oceans the wave s climate are variable in different seasons the response of the platform has been evaluated at various wavelengths for different sea states amirkabir semi submersible platform consists of four columns a deck a derrick and two pontoons the world s first fpso floating production storage and offloading unit mono column type platform was designed and manufactured for operating in 1090 m water depth located in the piranema field in brazil it is supposed that this fpso participates in a joint operation with amirkabir semi submersible in caspian sea see fig 2 characteristics of the mono column fpso and amirkabir semi submersible are presented in tables 1 and 2 respectively the catenary mooring system possesses 8 lines with an arrangement of 45 relative to each other in this system each mooring line has a cable between two chain sections the main properties of mooring lines are listed in table 3 3 governing equations in this section the governing equations of the modeling are described 3 1 potential theory the velocity potential is used to define the fluid flow field surrounding a floating body barltrop 1998 as 1 φ x t a w ϕ x e iωt where x x y z is the location relative to fixed reference axes fra t is the time and a w and ω are the wave amplitude and wave frequency respectively in eq 1 the term ϕ x is independent of time and separated into three other terms including the incident wave potential ϕ i due to the changes in water level from calm to wave mode the diffracted wave potential ϕ d due to the return of wave after its impact with the body and the radiation wave potential ϕ r due to six basic modes of body motion the velocity potential is a complex function but some resultant physical quantities such as body motions in time domain analysis and fluid pressure will be obtained considering the real part therefore the velocity potential due to the incident diffraction and radiation waves are written as follows 2 ϕ x e iωt ϕ i ϕ d j 1 6 ϕ rj x j e iωt where ϕ r j is the radiation wave potential due to the j th motion three translational and three rotational motions of the body s center of gravity are introduced by x j 3 x j u j j 1 2 3 x j θ j 3 j 4 5 6 based on linear hydrodynamic theory for inviscid and incompressible fluid and irrotational fluid flow the velocity potential function φ x t with time independent term ϕ x is described by the following equations in far the laplace equation which is used everywhere in the fluid domain ω newman 1979 4 2 ϕ 2 ϕ x 2 2 ϕ y 2 2 ϕ z 2 0 linear free surface equation 5 ω 2 ϕ g ϕ z 0 on z 0 body surface conditions 6 ϕ n i ω n j f o r r a d i a t i o n p o t e n t i a l ϕ n f o r d i f f r a c t i o n p o t e n t i a l seafloor surface condition at depth of d 7 ϕ z 0 on z d the distant condition which the generalized wave disturbance dies away 8 ϕ 0 when x 2 y 2 using the boundary integration approach ansys aqwa was employed to solve the velocity potential for control conditions the frequency domain pulsating green s function is used in this approach for finite water depth in addition to the proposed boundary conditions the following condition is satisfied in the fluid field havelock 1955 9 2 g x ξ ω 2 g x 2 2 g y 2 2 g z 2 δ x ξ where x ε ω and ξ ε ω where ξ ξ η ζ is the position of a source on the platform wetted surface and δ x ξ is the dirac function which is defined as 10 δ x ξ 0 w h e r e x ξ 0 w h e r e x ξ 0 the green s function can be expressed as 11 g x ξ ω 1 r 1 r 2 0 2 k v e kd cosh k z d cosh k ζ d k sinh kd v cosh kd j 0 kr dk i 2 π k 0 v e k 0 d cosh k 0 z d cosh k 0 ζ d sinh k 0 d k 0 d cosh k 0 d vd sinh k 0 d j 0 k 0 r where j 0 is the bessel function of the first kind and 12 r x ξ 2 y η 2 13 r r 2 z ζ 2 14 r 2 r 2 z ζ 2 d 2 15 v ω 2 g 16 k 0 tanh k 0 d v here k 2 π λ is the wave number in which λ is the wavelength applying green s theorem the velocity potential of radiation and diffraction waves can be expressed as a fredholm integral equation of the second kind 17 cϕ x s 0 ϕ ξ g x ξ ω n ξ g x ξ ω ϕ ξ n ξ ds where s 0 is the wetted surface and 18 c 0 x ω s 0 2 π x s 0 4 π x ω also the source distribution σ on the wetted surface can be used to obtain the fluid velocity potential as 19 ϕ x 1 4 π s 0 σ ξ g x ξ ω ds where x ω s 0 the source strength over the wetted surface can be determined by body surface conditions in eq 6 therefore 20 ϕ x n x 1 2 σ x 1 4 π s 0 σ ξ g x ξ ω n x ds where x s 0 ansys aqwa uses the hess smith constant panel to solve eq 20 in this method the wetted surface is divided into triangular or quadrilateral panels it is assumed that the potential and the source strength in each panel are constant and taken as the corresponding average values eqs 19 and 20 are expressed in the discrete integral form as follows hess and smith 1962 21 ϕ x 1 4 π m 1 n p σ m g x ξ m ω δs m where x ω s 0 22 ϕ x k n x k 1 2 σ k 1 4 π m 1 n p σ m g x k ξ m ω n x k δs m where x k s 0 k 1 n p where n p is the total number of the panels over the wetted surface ξ m and x k are coordinates of panel geometric center in the m th and k th panels respectively and δ s m is the m th panel s area 3 2 first order wave force after identification of the wave velocity potentials the first order hydrodynamic pressure distribution is calculated by employing the linearized bernoulli s equation as 23 p 1 ρ φ x t t iωρϕ x e iωt therefore the first order hydrodynamic force and moment components can be written in a generalized form as 24 f j e iωt s 0 p 1 n j ds s 0 ϕ x n j ds e iωt based on eq 2 the total first order hydrodynamic force is expressed as follows 25 f j f ij f dj k 1 6 f rjk x k where j 1 6 in this equation f i j is the froude krylov force due to incident wave in the j th body motion f d j is the diffracting force due to diffraction wave in the j th body motion and f r j k is the radiation force in the j th body motion due to the radiation wave induced by the k th unit amplitude body motion the equation of froude krylov diffracting and radiating force are 26 f ij iωρ s 0 ϕ i x n j ds 27 f dj iωρ s 0 ϕ d x n j ds 28 f rjk iωρ s 0 ϕ rk x n j ds the radiation wave potential ϕ r k can be expressed as a complex function therefore the radiation force in eq 28 can be written as 29 f rjk iωρ s 0 re ϕ rk x iim ϕ rk x n j ds ωρ s 0 im ϕ rk x n j ds iωρ s 0 re ϕ rk x n j ds ω 2 a jk iωb jk where a j k is the added mass and b j k is the wave damping coefficients 30 a jk ρ ω s 0 im ϕ rk x n j ds 31 b jk ρ s 0 re ϕ rk x n j ds 3 3 second order wave force the second order wave exciting forces concept can be explained based on the assumption of hydrodynamic responses of the fixed or floating body surrounding by an incompressible irrotational homogeneous and inviscid fluid in addition in this concept both body motion response amplitudes and the fluid wave amplitudes are small pinkster 1980 under these assumptions in order to express the wave elevation the position of a point on hull body and the fluid potential the perturbation approach applied and velocity potential function can be used to express the surrounding fluid 32 φ εφ 1 ε 2 φ 2 ο ε 3 33 ζ ζ 0 εζ 1 ε 2 ζ 2 ο ε 3 where ε 0 34 x x 0 ε x 1 ε 2 x 2 ο ε 3 where ε is the perturbation parameter and 0 is denoting the static values the first and the second order variations with respect to ε are denoting by superscripts 1 and 2 respectively applying the bernoulli s equation at a given point the fluid pressure can be determined as follows 35 p ρ φ t 1 2 ρ φ φ ρgz p 0 p 1 p 2 ο ε 3 where 36 p 0 ρgx 3 0 37 p 1 ρgx 3 1 ρ φ 1 t 38 p 2 1 2 ρ φ 1 2 ρ x 1 φ 1 t ρ φ 2 t ρgx 3 2 the total fluid force and moment in the fra have the general forms of eqs 39 and 40 that is considered respect to the center of gravity of the hull body 39 f t s t p n ds 40 m t s t p x x g n ds where s t indicates the instantaneous wetted surface area of the hull body the second order wave exciting force and moment can be obtained by the perturbation analysis of eqs 41 and 42 over the instantaneous wetted surface as follows 24 41 f 2 1 2 ρg wl ζ r 1 ζ r 1 n dl water line integral 1 2 ρ s 0 φ 1 φ 1 n ds bernoulli ρ s 0 x 1 φ 1 t n ds acceleration α 1 f 1 momentum ρ s 0 φ 2 t n ds 2 nd order potential and 42 m 2 1 2 ρg wl ζ r 1 ζ r 1 x n dl water line integral 1 2 ρ s 0 φ 1 φ 1 x n ds bernoulli ρ s 0 x 1 φ 1 t x n ds acceleration α 1 m 1 momentum ρ s 0 φ 2 t x n ds 2 nd order potential where s 0 represents the mean wetted surface ζ r 1 ζ r 1 x 3 w l 1 represents the relative wave elevation along the mean undisturbed water line the total fluid force and moment as first order are defined by f 1 and m 1 that including hydrodynamic radiation force and moment wave exciting hydrostatic restoring and the gravity variation relative to the body fixed axes 3 4 mooring equation of motion in order to model the mooring line ansys aqwa morison elements were applied subjected to the external hydrodynamic and structural inertia loadings fig 3 shows a single element of morison type modeled as a circular slender cable for each element of cable the motion equation can be written as follows 43 t s e v s e w f h m 2 r t 2 44 m s e r s e v q where r t m and v are determined at the first node of element and represents the position the tension force the bending moment and the shear force vectors respectively also f h q m and w are determined per unit length and represent external hydrodynamic loading distributed moment structural mass and the element weight respectively d e and δ s e represent element diameter and element length respectively 3 5 equation of motion a combination of panels and the morison elements can be modeled in ansys aqwa the structural equation of motion with frequency dependent coefficients is given by 45 ω 2 m s m a iωc k hys k a x jm f jm where m s and m a are the total structural mass and the total added mass matrices respectively due to morison element and diffraction panels the coefficient c is the hydrodynamic damping matrix due to the diffraction panels k h y s and k a are the assembled hydrostatic stiffness and the additional structural stiffness matrices respectively f j m is the total froud krylov and diffracting forces and moments where m corresponds to the structure and j refer to the motion modes the equation of motion in the time domain is as follows 46 m x t c x t kx t f t in this equation the external force f t has a constant amplitude therefore the equation of motion in the frequency domain cannot be directly converted into the time domain equation hence by employing a convolution integral form the equation of motion can be expressed as follows cummins 1962 47 m s a x t c x t kx t 0 t r t τ x τ dτ f t where a is the added mass matrix at the infinite frequency c is the damping matrix including the effects of the radiation damping k is the total stiffness matrix and r is the velocity impulse function matrix on the other hand the acceleration impulse function matrix h can be used in the equation of motion as follows 48 m s a x t c x t kx t 0 t h t τ x τ dτ f t in which the acceleration impulse function matrix can be defined as 49 h t 2 π 0 b ω sin ωt ω dω 2 π 0 a ω a cos ωt dω where a ω is the added mass matrix and b ω is the hydrodynamics damping matrix the equation of motion can be obtained by substituting the first and second order wave loads into eq 48 as 50 m a x t f 1 t f 2 t f t t c x t kx t 0 t h t τ x τ dτ in the above equation k is the total stiffness matrix and includes the linear hydrostatic and mooring stiffness f 1 t is the first order wave excitation force and moment i e the sum of the froude krylov and diffracting forces and moments f 2 t is the second order wave excitation force and f t t is the mooring and articulation force 4 validation the experimental work on the mono column fpso model see fig 4 a was carried out in the state key laboratory of coastal and offshore engineering of the dalian university of technology with a scale of 1 70 the wave tank was 50 0 m long 1 0 m wide and 1 5 m deep saad et al 2009 the experimental work for amirkabir semi submersible platform was performed in the wave flume of sharif university of technology tehran iran with a scale of 1 143 it was 25 0 m long 2 5 m wide and 1 8 m deep fig 4b shows amirkabir semi submersible platform model characteristics of the mono column fpso and amirkabir semi submersible are presented in tables 1 and 2 respectively in this paper amirkabir semi submersible and mono column fpso platforms were modeled numerically to demonstrate the validity of the results the present bem results for response amplitude operator rao was compared with the mentioned experimental work see fig 5 this comparison shows that the model simulation results and experimental data are consistent 5 results and discussion in this section the results of the modeling are presented and discussed 5 1 hydrodynamic response in this section the motion responses of amirkabir semisubmersible for second order stokes waves were obtained to simplify the complicated problem of wave platforms interaction and make it possible to compare the results for a selected significant wave heights of 8 m based on fig 1 various periods or wave lengths were adopted for incident waves the wavelengths were in the range of 35 to 100 m with a 5 m increment fig 6 shows the results of surge heave and pitch motions for semi submersible platform in the frequency domain for different wavelengths as shown in fig 6 surge heave and pitch motions have two resonant frequencies so that the amplitude of the second resonant frequency is larger than the first one while for wavelengths more than 80 m in surge motion the amplitude of the second resonant frequency is smaller than that of the first one this figure also shows that as the wavelength for these three motions increases the second resonant frequency decreases for heave and pitch motions with increasing the wave length the first and second amplitudes of the resonant frequencies increase for surge motion the amplitude of first resonant frequency demonstrates a peak at waves with lengths of 90m while for this motion the amplitude of second resonant frequency have a peak at waves of 60 length the hydrodynamic interaction of the fpso and the semi submersible platforms concerns the influence of flow field of the fpso on the semi submersible platform therefore with increasing the wavelength in deep sea condition the flow field behind the fpso becomes more disturbing and the semisubmersible is more affected leading to larger platform movements in order to investigate the effect of center to center distance between platforms on the global responses of the semi submersible platform simulations are carried out for second order stokes wave condition with wavelength of 50 m and for six different distances l 125 150 175 200 225 and 250 m fig 7 shows the results of surge heave and pitch motions of the semi submersible platform in the frequency domain for different distances between platforms as can be seen in this figure the frequency response of surge heave and pitch motions in different distances between platforms demonstrates two resonant frequencies the amplitude of the second resonant frequency is larger than that of the first one also it is found that with increasing the separation distance the amplitude of resonant frequencies increases 5 2 hydrodynamics force the maximum values of the both froude krylov and diffraction force in time domain simulation was applied on the semi submersible platform the analysis was performed for different wavelengths and different distances between two platforms the results are presented in figs 8 and 9 fig 8 indicates that the first order hydrodynamic forces for wavelengths from 35 to 55 60 m have an uptrend and then demonstrate a downtrends for 60 to 100 m wavelengths it means that the maximum total force in x direction occurs about 55 60 m wave lengths as can be seen in this figure the trend of both froude krylov and diffraction forces are nearly similar also it is evident that the froude krylov force is larger than diffraction force for wavelengths less than 55 m while after 55 m wavelengths it is vice versa it can be seen from fig 9 that the effects of separation distance between two platforms on froude krylov force are negligible whereas the diffraction force acting on the semi submersible platform increases as the separation distance increases hence the increase in the separation distance between two platforms only effects on the diffraction force while its effect on the froude krylov force is negligible fig 10 shows effects of the wavelength on the froude krylov and diffraction force applied to the semi submersible platform for 35 60 and 95 m wavelengths in time domain analyses it can be seen that oscillation amplitudes of both the diffraction and froude krylov forces for 60 m wavelength were 3 6 and 9 1 times of 35 m wavelength amplitude respectively it is also evident that for 90 m wavelength despite the reduction of these forces compared to that of the 60 m wavelength these forces are 3 4 diffraction force and 0 6 froude krylov force times respectively than the wavelength of 35 m hence percentage contribution of froude krylov force applied to the semi submersible platform is lower than that of the diffraction force 5 3 mooring line tension in fig 11 the effects of different wavelengths and different separation distances on the catenary mooring line tension were investigated in frequency domain this figure shows that decreasing the wavelengths leads to the maximum tension in mooring lines which occurs in higher frequency waves while increasing the separation distances between platforms doesn t affect the frequency of the maximum mooring line tension the mooring line tension of the semi submersible platform in time domain analyses versus the platforms separation distances is presented in fig 12 comparison of time response of the semi submersible mooring line tension for different separation distances shows that increasing the distance between centers of platforms leads to an increase in the amplitude of the mooring line tension oscillations 6 conclusion in this research to simulate the hydrodynamic interaction between two floating platforms in second order stokes wave of the caspian sea the bem of ansys aqwa software was employed the frequency and time domain analysis were performed to investigate the effects of different wavelengths and different separation distances of platforms on the hydrodynamics motions hydrodynamics force and mooring line tension in the light of most important results the following conclusions can be drawn the numerical results show that as the platforms come closer the values of diffraction force motions and the oscillation of mooring line tension for the semi submersible platform decrease as the distance between two platforms increases the diffraction force has an uptrend and has a negligible effect on the froude krylov force also the amplitude of resonant frequencies increases increase of wave length results in an increase in motions of semi submersible platform in this process the hydrodynamic forces and the oscillation of mooring line tension demonstrate a peak in wave lengths of about 55 60 m 
22582,this paper considers conducting underwater surveys using multiple sonar equipped autonomous surface vehicles asvs given a workspace every asv simultaneously searches for a mine towing a side scan sonar sss which can provide high resolution image of underwater environments under strong currents a survey may result in blurry sonar image which is not desirable for detecting mines in the case where the heading of the asv is opposite to the direction of currents we can obtain vivid sonar images suitable for detecting mines this paper thus introduces global path planning of multiple asvs satisfying the following three goals 1 there is no hole in coverage after the search is done 2 whenever an asv performs sonar survey inside the workspace the heading of the asv is opposite to the direction of currents 3 the workload of every asv is balanced for time efficient search we verified the effectiveness of our multi asv path planning methods using matlab simulations keywords multi robot exploration strong currents underwater survey mine search 1 introduction various underwater scenarios considered searching with sonar sensors an underwater area such that there are no holes in coverage sonar sensors provide high resolution image of underwater environments and this image can be used for detecting objects in many application scenarios archaeology habitat mapping and mine countermeasures this paper is on utilizing sonar sensors to detect an underwater mine mine countermeasures in the past human operators controlled a ship towing side scan sonar sss sensors to detect underwater mines the sss is a torpedo shaped object such that active sonar emitter which emit sonar pings periodically are attached on both sides of the object see fig 1 for an illustration of the case where the ship tows the cable attached to the sss however this operation is dangerous for a human operator since a mine can explode while the ship is close to the mine moreover considering the case where the area to scan is too wide it takes huge amount of time to make the ship scan the entire workspace in other words this underwater survey is time consuming inspired by multi robot system in the literature kim 2018a 2019 this paper introduces using multiple autonomous surface vehicles asvs such that each asv tows sss for mine countermeasures in other words we consider conducting underwater sonar surveys with sonar equipped asvs once a workspace is given then we divide the workspace into smaller sub workspaces so that each asv searches for a mine inside its designated sub workspace the workspace is divided evenly so that the work load of every asv is balanced since multiple asvs can clear its designated sub workspace simultaneously we can complete the sonar survey much faster than the case where only one asv is used there are many papers on path tracking control of an autonomous vehicle sun et al 2006 de and koditschek 2013 kim et al 2009a healey and lienard 1993 guerrero gonzalez et al 2011 peng et al 2018 kim 2018b hoy 2013 matveev et al 2011 chen et al 2014 toibero et al 2006 teimoori and savkin 2008 the standard survey plan used in practice williams 2010 choset 2000 2005 williams et al 2016 warren 1990 is a series of equidistant parallel tracks such that the swaths of consecutive tracks interleave resulting in sonar coverage for the entire workspace this pattern which is composed of parallel tracks is called the lawnmower pattern the sonar sensors generate vivid image in the case where it moves straight in underwater environments under the lawnmower pattern the asv moves straight inside the workspace this straight movement is desirable for generating vivid sonar sensor images williams et al 2016 in calm water an asv can perform a desired survey rather easily however strong currents in the water column can make even a simple sonar survey a struggle we say that currents are strong in the case where currents can push the vehicle off its intended course or induce crabbing while the vehicle maintains its track strong currents can alter the vehicles speed over ground making the asv travel too quickly or too slowly in general strong currents generate undesired asv motion that can greatly ruin the quality of the resulting imagery under strong currents a survey may result in blurry sonar image which is not suitable for detecting mines williams et al 2016 in the case where the heading of an asv is opposite to the direction of currents the asv can move straight while maintain its track in this case we can obtain vivid sonar images suitable for detecting objects of interest williams et al 2016 the authors of williams et al 2016 introduced adaptive survey orientation which is to change the orientation of the asv so that the heading of the asv is opposite to the direction of currents williams et al 2016 considered underwater survey using one autonomous underwater vehicle auv equipped with active sonars to scan the underwater environments distinct from an auv the activity of asv can use the electromagnetic waves very efficiently in the inter communication thus the asv can be more flexible in operations and applications compared to the auv where the autonomy issues are relatively important williams et al 2016 used acoustic doppler current profiler adcp embedded in the auv to measure the velocity magnitude and direction of currents in this paper we assume that the asv can locate itself using global positioning systems gps signal this paper presents a method to detect and estimate changed currents using the position information of the asv williams et al 2016 only considered local path planning and did not consider the fact that there must be no coverage hole after the search is done in other words williams et al 2016 did not present how to plan the asvs global path autonomously so that there is no coverage hole after the search is done moreover williams et al 2016 considered sonar survey using only one asv in the past multi robot coverage methods included voronoi diagram kim et al 2009b kim 2014 2018a trapezoidal decompositions choset 2005 and morse decompositions acar et al 2002 where a robot from the team was designated to clear a specific small area multi robot coverage with boustrophedon decompositions in kong et al 2006 used a pre partitioned workspace for each robot coverage in water area with a multi robot team was presented in li et al 2016 no paper on multi robot coverage methods considered the problem of scanning the sea bottom using multiple asvs as far as we know this paper is unique in the following three aspects 1 multiple asvs scan the sea bottom so that there is no coverage hole after the search is done 2 the main computer generates the waypoints for every asv so that the workload of every asv is evenly balanced this way we achieve time efficient scanning of the entire workspace 3 as each asv scans the sea bottom its heading is opposite to the direction of currents this way we can generate vivid sonar images suitable for detecting objects of interest williams et al 2016 we verified our multi asv path planning methods using matlab simulations we organize this paper as follows section 2 presents the global path plan algorithm introduced in this paper section 3 presents matlab simulation results to demonstrate the performance of our path plan algorithm section 4 provides conclusions 2 main results this paper considers a polygonal workspace with multiple vertices a polygonal workspace can be non convex or convex a non convex workspace can be built as a union of convex workspaces thus this section considers a convex polygonal workspace a convex workspace implies that for any two points a and b inside the workspace l a b is also inside the workspace here l a b indicates the line segment whose two end points are a and b respectively let r denote a convex polygonal workspace also let a r e a r denote the area of r let n denote the number of asvs deployed for underwater survey v n where n n denotes the n th asv the underwater search must be performed such that there is no coverage hole in the workspace after the search is done for balanced survey we divide r into n sub workspaces evenly so that each asv performs underwater survey to cover its associated sub workspace 2 1 estimation of the direction and speed of currents we first present how to estimate the direction and speed of currents in order to measure the direction of currents this paper utilizes the initial motion of the asv before turning on the propeller since the propeller is turned off the asv s motion is generated by currents thus the initial velocity of the asv is utilized to estimate the velocity of currents this method is a simple version of the motion tomography addressed in chang et al 2017 this way we can estimate the direction and strength of the currents 2 2 generate global paths for all asvs this paper presents how to generate paths for all asvs such that the work load of every asv is balanced beforehand we introduce how to generate global paths for all asvs we first generate the local coordinate system in the local coordinate system one vertex of the workspace is set as the origin also we generate the local coordinate system so that the x axis and the y axis are normal to each other see fig 2 for an illustration let θ 0 denote the angle of the infinite line associated to currents direction at time step 0 measured counter clockwise from the x axis under this definition θ 0 exists between 0 and 180 we consider the case where θ 0 is not 0 exactly in other words we do not consider the case where the direction of currents is exactly parallel to the x axis see fig 2 for an illustration of θ 0 the bottom left arrow in this figure indicates the direction of currents at time step 0 we generate parallel tracks inside r such that each track is parallel to the direction of currents we first draw an infinite line called the base line crossing the origin such that the angle formed by the line and the x axis is θ 0 the equation for this base line is 1 y tan θ 0 x let d denote the scan width of the sss we generate parallel tracks such that the distance between two adjacent tracks is d in this way as an asv moves along parallel tracks there is no coverage hole we consider the following equation presenting an infinite line parallel to the base line 2 y tan θ 0 x j d cos θ 0 here d 0 is a constant as we increase j in 2 as 0 1 2 in this order then we find that at a certain j say j the infinite line associated to j does not intersect r this infinite line is called the start line the equation for the start line is 3 y tan θ 0 x j d cos θ 0 considering m 1 2 3 we define l i n e m as 4 y tan θ 0 x j m d cos θ 0 since r is convex the intersection between l i n e m and r forms a connected line segment or a point l i n e m is used as a parallel track to cover the entire workspace for any m 1 the intersection between the y axis and l i n e m is d cos θ 0 below the intersection between the y axis and l i n e m 1 also the distance between l i n e m and l i n e m 1 is d by its definition 4 we define the center line as the infinite line which exists between the start line and l i n e 1 the equation for the center line is 5 y tan θ 0 x j 0 5 d cos θ 0 suppose that the asv moves along l i n e 1 while scanning the sea bottom since the scan width of the sonar is d the region between the center line and the start line is not covered by the asv let u denote this region it is desirable that no point of r exists inside u however in practice there may be a case where a point of r exists inside u suppose that a point of r exists inside u see fig 3 for an illustration this case we project all boundary points of r which exist inside u onto the start line since r is convex the projected points form a connected line segment in fig 3 the projected points are depicted with a bold line segment on the start line between two end points of this line segment p 1 and p 0 are selected so that as the asv moves along the straight path from p 1 to p 0 the asv movement is opposite to the direction of currents as the asv moves from p 1 to p 0 all points of r which exist inside u are scanned by the asv our idea is to generate parallel paths to scan the workspace from top to bottom thus an asv moves along l i n e m before moving along l i n e m for any m m we acknowledge that we can generate parallel paths to scan the workspace from bottom to top in this case we need to change 5 and 4 slightly since it is trivial generating parallel paths to scan the workspace from bottom to top is not within the scope of this paper let global path list denote the list of waypoints that will be visited by an asv during the sonar survey let p i denote the i th waypoint in the global path list algorithm 1 presents how to generate the global path list algorithm 1 path plan algorithm image 1 we explain algorithm 1 in detail in algorithm 1 i n i t p a t h is empty in the case where no point of r exists inside u in algorithm 1 we keep increasing m in 4 until l i n e m does not meet r see fig 2 for an illustration in this figure the global path list i n i t p a t h p 1 p 2 p 14 is generated using our path generation algorithm we consider two cases respectively m 1 or m 1 while running algorithm 1 1 consider the case where m 1 while running algorithm 1 since r is convex the intersection between l i n e 1 and r forms a connected line segment or a point suppose the intersection between l i n e 1 and r forms a connected line segment with two end points the global path list is i n i t p a t h initially between the two end points p 1 and p 2 are selected so that as an asv moves along the straight path from p 1 to p 2 the asv movement is opposite to the direction of currents the generated global path list becomes i n i t p a t h p 1 p 2 under algorithm 1 as an asv moves along l p 1 p 2 the heading of the asv is opposite to the direction of currents see fig 2 for an illustration thus the asv can move straight while maintaining its track while the asv moves along l p 1 p 2 the asv performs sonar survey to obtain vivid underwater image suppose the intersection between l i n e 1 and r forms a single point this case the generated global path list becomes i n i t p a t h p 1 under algorithm 1 2 consider the case where m 1 while running algorithm 1 suppose that the global path list is i n i t p a t h p 1 p 2 p q and that m 1 since r is convex the intersection between l i n e m and r forms a connected line segment or a point suppose that the intersection between l i n e m and r forms a connected line segment with two end points between the two points p q 1 and p q 2 are selected so that as an asv moves along the straight path from p q 1 to p q 2 the asv movement is opposite to the direction of currents the generated global path list becomes i n i t p a t h p 1 p 2 p q 1 p q 2 under algorithm 1 as an asv moves along l p q 1 p q 2 the heading of the asv is opposite to the direction of currents see fig 2 for an illustration thus the asv can move straight while maintaining its track while the asv moves along l p q 1 p q 2 the asv performs sonar survey to obtain vivid underwater image suppose that l i n e m intersects r at only one point this case the generated global path list becomes i n i t p a t h p 1 p 2 p q 1 under algorithm 1 2 3 the case where we use only one asv consider the case where we use only one asv i e n 1 suppose that the global path list i n i t p a t h p 1 p 2 p e n d is built using algorithm 1 the asv moves along the waypoints in the global path list to cover r section 2 6 presents the control law for the asv to visit the waypoints in the global path list sequentially 2 4 the case where we use more than one asv consider the case where we have more than one asv i e n 1 this case we need to derive the path list for each asv from the global path list so that the workload of each asv is balanced in order to balance the workload of every robot the main computer generates the waypoints of every robot this will be the topic of this subsection as we change m in algorithm 1 as 1 2 in this order we generate new points where each l i n e m meets the boundary of r let a m denote the area inside r such that the area is above l i n e m a m is generated while we change m in algorithm 1 as 1 2 in this order see algorithm 1 for the generation of a m for instance consider the case where m 1 according to the definition of the start line l i n e 1 meets the workspace r a 1 is the area inside r such that the area exists above l i n e 1 see fig 2 for an illustration of a 1 in the case where l i n e 1 meets r at only one point we have a 1 0 let d i v i s i o n denote a column matrix with n elements d i v i s i o n n denotes the n th element in d i v i s i o n using a m we generate each element in d i v i s i o n as follows 6 d i v i s i o n n a r g m i n m a m n a r e a r n suppose that d i v i s i o n t 1 t 2 t n is generated using 6 in this case l i n e t n where n n is used to divide the workspace into sub workspaces so that each asv scans its associated sub workspace 6 is used to divide the workspace evenly let p a t h n denote the n th path list where n n p a t h n is the subset of the global path list p a t h n is the list of waypoints that will be visited by a single asv during the survey if an asv visits all waypoints in p a t h n sequentially then the asv scans the sub workspace associated to the asv without holes we next present how to derive p a t h n in detail consider the case where n 1 p a t h 1 is the set of waypoints that exists above l i n e t 1 suppose that the intersection between l i n e t 1 and r forms a connected line segment suppose that two end points of the line segment are p l and p l 1 in the global path list then we get p a t h 1 i n i t p a t h p 1 p 2 p l p l 1 consider the case where n 1 p a t h n n 1 is the set of waypoints that exist below l i n e t n 1 and above l i n e t n suppose that the intersection between l i n e t n 1 and r forms a connected line segment suppose that two end points of the line segment are p m 1 and p m 1 1 in the global path list also suppose that the intersection between l i n e t n and r forms a connected line segment suppose that two end points of the line segment are p m 2 and p m 2 1 in the global path list then we get p a t h n p m 1 1 p m 2 p m 2 1 note that an asv does not have to move along the straight path from p m 1 to p m 1 1 since this path is in p a t h n 1 here p a t h n 1 n 2 is the set of waypoints that exist below l i n e t n 2 and above l i n e t n 1 p a t h n and p a t h n 1 meet only at p m 1 algorithm 1 presents how to generate p a t h n where n n once p a t h n is generated for all n n then the main computer assigns p a t h n to each asv this way the workload of every asv is evenly balanced this assignment is presented in section 2 5 thereafter each asv visits the waypoints in its associated path list sequentially in algorithm 1 section 2 6 presents the control law for an asv to visit the waypoints in its associated path list sequentially 2 5 assignment for balanced workload until now we studied how to design p a t h n for all n n in this subsection we discuss how to assign p a t h n to each asv v k where k n the assignment is performed to balance the workload of every asv we introduce several definitions before presenting the assignment let p i n denote the i th waypoint in p a t h n this implies that p a t h n p 1 n p 2 n p e n d n let i 0 k denote the initial position of an asv v k suppose that v k visits the waypoints in p a t h n sequentially using the control law in section 2 6 the total path length is given by 7 p a t h l e n k n i 1 e n d 1 l e n p i n p i 1 n l e n i 0 k p 1 n here l e n a b denotes the length of the line segment l a b the problem becomes the following assignment problem we have n asvs and n path lists we want to assign n asvs to n path lists on a one to one basis the cost of assigning an asv v k to a path list p a t h n is p a t h l e n k n in 7 we wish to find an optimal assignment which minimizes total cost this paper utilizes the hungarian assignment method to solve this optimal assignment problem 2 6 tracking control law this paper is on planning the path of the asv once the path list associated to an asv is built then the asv needs to visit the waypoints in the path list sequentially various guidance algorithms were used to make a marine vehicle follow a predefined path lekkas and fossen 2014 breivik 2010 oh and sun 2010 snider 2009 this paper uses a path following method as follows whenever v n meets a waypoint in its path list p a t h n the asv moves towards the next waypoint in p a t h n iterate this until the asv visits the last waypoint in p a t h n v is the desired speed of the asv under strong currents let q n k denote the position of v n at time step k also let p denote the position of the next waypoint let d t denote the sampling interval of our control law we introduce how to set both the speed and the heading of the asv so that the asv can move towards the next waypoint p with a constant velocity v under strong currents recall that section 2 1 presented how to estimate the direction and speed of currents let current vector c k denote the vector representing the direction and speed of currents at time step k let movement vector m n k denote the desired movement vector of v n at time step k since we want the asv to head towards the next waypoint the equation for m n k is 8 m n k v p q n k p q n k under m n k v n moves according to 9 q n k 1 q n k m n k d t due to currents the heading direction of the asv may not coincide with the movement direction of the asv thus let heading vector h n k denote the vector representing the heading of the asv v n at time step k h n k is set as 10 h n k m n k c k see fig 4 for an illustration of the heading vector in this figure the triangle represents the pose of the asv in the case where the heading of the asv is opposite to the direction of currents h n k is parallel to m n k in this case the asv can move straight while maintaining its track hence we can obtain vivid sonar images suitable for detecting objects of interest williams et al 2016 3 simulation results this section presents matlab simulations to verify the effectiveness of the proposed path planning algorithm the scan width of sss is d 300 meters initially the positions of all asvs are 0 2000 0 1000 1000 1000 0 0 respectively v 10 m s r is an ellipse x y whose coordinate is given by 11 x 2 5000 2 y 2 1000 2 1 3 1 θ 0 30 degrees fig 5 shows the case where n 2 and θ 0 30 degrees in the above sub figure of fig 5 initial positions of all asvs are marked with black asterisks the blue line segments in the above sub figure of fig 5 present the global path list in the below sub figure of fig 5 the trajectory of each asv is depicted with circles with distinct colors 5320 s are spent to finish the survey fig 6 shows the case where n 4 and θ 0 30 degrees in the above sub figure of fig 6 initial positions of all asvs are marked with black asterisks in the below sub figure of fig 6 the trajectory of each asv is depicted with circles with distinct colors 2780 s are spent to finish the survey see that as we increase the number of asvs to n 4 we can complete the scanning task much faster than the case where n 2 3 2 θ 0 90 degrees fig 7 shows the case where n 2 and θ 0 90 degrees in the above sub figure of fig 7 initial positions of all asvs are marked with black asterisks in the below sub figure of fig 7 the trajectory of each asv is depicted with circles with distinct colors 4660 s are spent to finish the survey fig 8 shows the case where n 4 and θ 0 90 degrees in the above sub figure of fig 8 initial positions of all asvs are marked with black asterisks in the below sub figure of fig 8 the trajectory of each asv is depicted with circles with distinct colors 2410 s are spent to finish the survey see that as we increase the number of asvs to n 4 we can complete the scanning task much faster than the case where n 2 4 conclusions this paper considers conducting underwater surveys using multiple sonar equipped asvs given a workspace every asv simultaneously searches for a mine towing a sss which can provide high resolution image of underwater environments this paper introduces global path planning of multiple asvs satisfying the following three goals 1 there is no hole in coverage after the search is done 2 whenever an asv performs sonar survey inside the workspace the heading of the asv is opposite to the direction of currents 3 the workload of every asv is balanced for time efficient search we verified the effectiveness of our multi asv path planning methods using matlab simulations as our future works we will verify the effectiveness of our planning methods using real experiments with multiple asvs moreover we will consider the case where the sea currents change as time goes on acknowledgment this work was supported by 2019 hongik university research fund 
22582,this paper considers conducting underwater surveys using multiple sonar equipped autonomous surface vehicles asvs given a workspace every asv simultaneously searches for a mine towing a side scan sonar sss which can provide high resolution image of underwater environments under strong currents a survey may result in blurry sonar image which is not desirable for detecting mines in the case where the heading of the asv is opposite to the direction of currents we can obtain vivid sonar images suitable for detecting mines this paper thus introduces global path planning of multiple asvs satisfying the following three goals 1 there is no hole in coverage after the search is done 2 whenever an asv performs sonar survey inside the workspace the heading of the asv is opposite to the direction of currents 3 the workload of every asv is balanced for time efficient search we verified the effectiveness of our multi asv path planning methods using matlab simulations keywords multi robot exploration strong currents underwater survey mine search 1 introduction various underwater scenarios considered searching with sonar sensors an underwater area such that there are no holes in coverage sonar sensors provide high resolution image of underwater environments and this image can be used for detecting objects in many application scenarios archaeology habitat mapping and mine countermeasures this paper is on utilizing sonar sensors to detect an underwater mine mine countermeasures in the past human operators controlled a ship towing side scan sonar sss sensors to detect underwater mines the sss is a torpedo shaped object such that active sonar emitter which emit sonar pings periodically are attached on both sides of the object see fig 1 for an illustration of the case where the ship tows the cable attached to the sss however this operation is dangerous for a human operator since a mine can explode while the ship is close to the mine moreover considering the case where the area to scan is too wide it takes huge amount of time to make the ship scan the entire workspace in other words this underwater survey is time consuming inspired by multi robot system in the literature kim 2018a 2019 this paper introduces using multiple autonomous surface vehicles asvs such that each asv tows sss for mine countermeasures in other words we consider conducting underwater sonar surveys with sonar equipped asvs once a workspace is given then we divide the workspace into smaller sub workspaces so that each asv searches for a mine inside its designated sub workspace the workspace is divided evenly so that the work load of every asv is balanced since multiple asvs can clear its designated sub workspace simultaneously we can complete the sonar survey much faster than the case where only one asv is used there are many papers on path tracking control of an autonomous vehicle sun et al 2006 de and koditschek 2013 kim et al 2009a healey and lienard 1993 guerrero gonzalez et al 2011 peng et al 2018 kim 2018b hoy 2013 matveev et al 2011 chen et al 2014 toibero et al 2006 teimoori and savkin 2008 the standard survey plan used in practice williams 2010 choset 2000 2005 williams et al 2016 warren 1990 is a series of equidistant parallel tracks such that the swaths of consecutive tracks interleave resulting in sonar coverage for the entire workspace this pattern which is composed of parallel tracks is called the lawnmower pattern the sonar sensors generate vivid image in the case where it moves straight in underwater environments under the lawnmower pattern the asv moves straight inside the workspace this straight movement is desirable for generating vivid sonar sensor images williams et al 2016 in calm water an asv can perform a desired survey rather easily however strong currents in the water column can make even a simple sonar survey a struggle we say that currents are strong in the case where currents can push the vehicle off its intended course or induce crabbing while the vehicle maintains its track strong currents can alter the vehicles speed over ground making the asv travel too quickly or too slowly in general strong currents generate undesired asv motion that can greatly ruin the quality of the resulting imagery under strong currents a survey may result in blurry sonar image which is not suitable for detecting mines williams et al 2016 in the case where the heading of an asv is opposite to the direction of currents the asv can move straight while maintain its track in this case we can obtain vivid sonar images suitable for detecting objects of interest williams et al 2016 the authors of williams et al 2016 introduced adaptive survey orientation which is to change the orientation of the asv so that the heading of the asv is opposite to the direction of currents williams et al 2016 considered underwater survey using one autonomous underwater vehicle auv equipped with active sonars to scan the underwater environments distinct from an auv the activity of asv can use the electromagnetic waves very efficiently in the inter communication thus the asv can be more flexible in operations and applications compared to the auv where the autonomy issues are relatively important williams et al 2016 used acoustic doppler current profiler adcp embedded in the auv to measure the velocity magnitude and direction of currents in this paper we assume that the asv can locate itself using global positioning systems gps signal this paper presents a method to detect and estimate changed currents using the position information of the asv williams et al 2016 only considered local path planning and did not consider the fact that there must be no coverage hole after the search is done in other words williams et al 2016 did not present how to plan the asvs global path autonomously so that there is no coverage hole after the search is done moreover williams et al 2016 considered sonar survey using only one asv in the past multi robot coverage methods included voronoi diagram kim et al 2009b kim 2014 2018a trapezoidal decompositions choset 2005 and morse decompositions acar et al 2002 where a robot from the team was designated to clear a specific small area multi robot coverage with boustrophedon decompositions in kong et al 2006 used a pre partitioned workspace for each robot coverage in water area with a multi robot team was presented in li et al 2016 no paper on multi robot coverage methods considered the problem of scanning the sea bottom using multiple asvs as far as we know this paper is unique in the following three aspects 1 multiple asvs scan the sea bottom so that there is no coverage hole after the search is done 2 the main computer generates the waypoints for every asv so that the workload of every asv is evenly balanced this way we achieve time efficient scanning of the entire workspace 3 as each asv scans the sea bottom its heading is opposite to the direction of currents this way we can generate vivid sonar images suitable for detecting objects of interest williams et al 2016 we verified our multi asv path planning methods using matlab simulations we organize this paper as follows section 2 presents the global path plan algorithm introduced in this paper section 3 presents matlab simulation results to demonstrate the performance of our path plan algorithm section 4 provides conclusions 2 main results this paper considers a polygonal workspace with multiple vertices a polygonal workspace can be non convex or convex a non convex workspace can be built as a union of convex workspaces thus this section considers a convex polygonal workspace a convex workspace implies that for any two points a and b inside the workspace l a b is also inside the workspace here l a b indicates the line segment whose two end points are a and b respectively let r denote a convex polygonal workspace also let a r e a r denote the area of r let n denote the number of asvs deployed for underwater survey v n where n n denotes the n th asv the underwater search must be performed such that there is no coverage hole in the workspace after the search is done for balanced survey we divide r into n sub workspaces evenly so that each asv performs underwater survey to cover its associated sub workspace 2 1 estimation of the direction and speed of currents we first present how to estimate the direction and speed of currents in order to measure the direction of currents this paper utilizes the initial motion of the asv before turning on the propeller since the propeller is turned off the asv s motion is generated by currents thus the initial velocity of the asv is utilized to estimate the velocity of currents this method is a simple version of the motion tomography addressed in chang et al 2017 this way we can estimate the direction and strength of the currents 2 2 generate global paths for all asvs this paper presents how to generate paths for all asvs such that the work load of every asv is balanced beforehand we introduce how to generate global paths for all asvs we first generate the local coordinate system in the local coordinate system one vertex of the workspace is set as the origin also we generate the local coordinate system so that the x axis and the y axis are normal to each other see fig 2 for an illustration let θ 0 denote the angle of the infinite line associated to currents direction at time step 0 measured counter clockwise from the x axis under this definition θ 0 exists between 0 and 180 we consider the case where θ 0 is not 0 exactly in other words we do not consider the case where the direction of currents is exactly parallel to the x axis see fig 2 for an illustration of θ 0 the bottom left arrow in this figure indicates the direction of currents at time step 0 we generate parallel tracks inside r such that each track is parallel to the direction of currents we first draw an infinite line called the base line crossing the origin such that the angle formed by the line and the x axis is θ 0 the equation for this base line is 1 y tan θ 0 x let d denote the scan width of the sss we generate parallel tracks such that the distance between two adjacent tracks is d in this way as an asv moves along parallel tracks there is no coverage hole we consider the following equation presenting an infinite line parallel to the base line 2 y tan θ 0 x j d cos θ 0 here d 0 is a constant as we increase j in 2 as 0 1 2 in this order then we find that at a certain j say j the infinite line associated to j does not intersect r this infinite line is called the start line the equation for the start line is 3 y tan θ 0 x j d cos θ 0 considering m 1 2 3 we define l i n e m as 4 y tan θ 0 x j m d cos θ 0 since r is convex the intersection between l i n e m and r forms a connected line segment or a point l i n e m is used as a parallel track to cover the entire workspace for any m 1 the intersection between the y axis and l i n e m is d cos θ 0 below the intersection between the y axis and l i n e m 1 also the distance between l i n e m and l i n e m 1 is d by its definition 4 we define the center line as the infinite line which exists between the start line and l i n e 1 the equation for the center line is 5 y tan θ 0 x j 0 5 d cos θ 0 suppose that the asv moves along l i n e 1 while scanning the sea bottom since the scan width of the sonar is d the region between the center line and the start line is not covered by the asv let u denote this region it is desirable that no point of r exists inside u however in practice there may be a case where a point of r exists inside u suppose that a point of r exists inside u see fig 3 for an illustration this case we project all boundary points of r which exist inside u onto the start line since r is convex the projected points form a connected line segment in fig 3 the projected points are depicted with a bold line segment on the start line between two end points of this line segment p 1 and p 0 are selected so that as the asv moves along the straight path from p 1 to p 0 the asv movement is opposite to the direction of currents as the asv moves from p 1 to p 0 all points of r which exist inside u are scanned by the asv our idea is to generate parallel paths to scan the workspace from top to bottom thus an asv moves along l i n e m before moving along l i n e m for any m m we acknowledge that we can generate parallel paths to scan the workspace from bottom to top in this case we need to change 5 and 4 slightly since it is trivial generating parallel paths to scan the workspace from bottom to top is not within the scope of this paper let global path list denote the list of waypoints that will be visited by an asv during the sonar survey let p i denote the i th waypoint in the global path list algorithm 1 presents how to generate the global path list algorithm 1 path plan algorithm image 1 we explain algorithm 1 in detail in algorithm 1 i n i t p a t h is empty in the case where no point of r exists inside u in algorithm 1 we keep increasing m in 4 until l i n e m does not meet r see fig 2 for an illustration in this figure the global path list i n i t p a t h p 1 p 2 p 14 is generated using our path generation algorithm we consider two cases respectively m 1 or m 1 while running algorithm 1 1 consider the case where m 1 while running algorithm 1 since r is convex the intersection between l i n e 1 and r forms a connected line segment or a point suppose the intersection between l i n e 1 and r forms a connected line segment with two end points the global path list is i n i t p a t h initially between the two end points p 1 and p 2 are selected so that as an asv moves along the straight path from p 1 to p 2 the asv movement is opposite to the direction of currents the generated global path list becomes i n i t p a t h p 1 p 2 under algorithm 1 as an asv moves along l p 1 p 2 the heading of the asv is opposite to the direction of currents see fig 2 for an illustration thus the asv can move straight while maintaining its track while the asv moves along l p 1 p 2 the asv performs sonar survey to obtain vivid underwater image suppose the intersection between l i n e 1 and r forms a single point this case the generated global path list becomes i n i t p a t h p 1 under algorithm 1 2 consider the case where m 1 while running algorithm 1 suppose that the global path list is i n i t p a t h p 1 p 2 p q and that m 1 since r is convex the intersection between l i n e m and r forms a connected line segment or a point suppose that the intersection between l i n e m and r forms a connected line segment with two end points between the two points p q 1 and p q 2 are selected so that as an asv moves along the straight path from p q 1 to p q 2 the asv movement is opposite to the direction of currents the generated global path list becomes i n i t p a t h p 1 p 2 p q 1 p q 2 under algorithm 1 as an asv moves along l p q 1 p q 2 the heading of the asv is opposite to the direction of currents see fig 2 for an illustration thus the asv can move straight while maintaining its track while the asv moves along l p q 1 p q 2 the asv performs sonar survey to obtain vivid underwater image suppose that l i n e m intersects r at only one point this case the generated global path list becomes i n i t p a t h p 1 p 2 p q 1 under algorithm 1 2 3 the case where we use only one asv consider the case where we use only one asv i e n 1 suppose that the global path list i n i t p a t h p 1 p 2 p e n d is built using algorithm 1 the asv moves along the waypoints in the global path list to cover r section 2 6 presents the control law for the asv to visit the waypoints in the global path list sequentially 2 4 the case where we use more than one asv consider the case where we have more than one asv i e n 1 this case we need to derive the path list for each asv from the global path list so that the workload of each asv is balanced in order to balance the workload of every robot the main computer generates the waypoints of every robot this will be the topic of this subsection as we change m in algorithm 1 as 1 2 in this order we generate new points where each l i n e m meets the boundary of r let a m denote the area inside r such that the area is above l i n e m a m is generated while we change m in algorithm 1 as 1 2 in this order see algorithm 1 for the generation of a m for instance consider the case where m 1 according to the definition of the start line l i n e 1 meets the workspace r a 1 is the area inside r such that the area exists above l i n e 1 see fig 2 for an illustration of a 1 in the case where l i n e 1 meets r at only one point we have a 1 0 let d i v i s i o n denote a column matrix with n elements d i v i s i o n n denotes the n th element in d i v i s i o n using a m we generate each element in d i v i s i o n as follows 6 d i v i s i o n n a r g m i n m a m n a r e a r n suppose that d i v i s i o n t 1 t 2 t n is generated using 6 in this case l i n e t n where n n is used to divide the workspace into sub workspaces so that each asv scans its associated sub workspace 6 is used to divide the workspace evenly let p a t h n denote the n th path list where n n p a t h n is the subset of the global path list p a t h n is the list of waypoints that will be visited by a single asv during the survey if an asv visits all waypoints in p a t h n sequentially then the asv scans the sub workspace associated to the asv without holes we next present how to derive p a t h n in detail consider the case where n 1 p a t h 1 is the set of waypoints that exists above l i n e t 1 suppose that the intersection between l i n e t 1 and r forms a connected line segment suppose that two end points of the line segment are p l and p l 1 in the global path list then we get p a t h 1 i n i t p a t h p 1 p 2 p l p l 1 consider the case where n 1 p a t h n n 1 is the set of waypoints that exist below l i n e t n 1 and above l i n e t n suppose that the intersection between l i n e t n 1 and r forms a connected line segment suppose that two end points of the line segment are p m 1 and p m 1 1 in the global path list also suppose that the intersection between l i n e t n and r forms a connected line segment suppose that two end points of the line segment are p m 2 and p m 2 1 in the global path list then we get p a t h n p m 1 1 p m 2 p m 2 1 note that an asv does not have to move along the straight path from p m 1 to p m 1 1 since this path is in p a t h n 1 here p a t h n 1 n 2 is the set of waypoints that exist below l i n e t n 2 and above l i n e t n 1 p a t h n and p a t h n 1 meet only at p m 1 algorithm 1 presents how to generate p a t h n where n n once p a t h n is generated for all n n then the main computer assigns p a t h n to each asv this way the workload of every asv is evenly balanced this assignment is presented in section 2 5 thereafter each asv visits the waypoints in its associated path list sequentially in algorithm 1 section 2 6 presents the control law for an asv to visit the waypoints in its associated path list sequentially 2 5 assignment for balanced workload until now we studied how to design p a t h n for all n n in this subsection we discuss how to assign p a t h n to each asv v k where k n the assignment is performed to balance the workload of every asv we introduce several definitions before presenting the assignment let p i n denote the i th waypoint in p a t h n this implies that p a t h n p 1 n p 2 n p e n d n let i 0 k denote the initial position of an asv v k suppose that v k visits the waypoints in p a t h n sequentially using the control law in section 2 6 the total path length is given by 7 p a t h l e n k n i 1 e n d 1 l e n p i n p i 1 n l e n i 0 k p 1 n here l e n a b denotes the length of the line segment l a b the problem becomes the following assignment problem we have n asvs and n path lists we want to assign n asvs to n path lists on a one to one basis the cost of assigning an asv v k to a path list p a t h n is p a t h l e n k n in 7 we wish to find an optimal assignment which minimizes total cost this paper utilizes the hungarian assignment method to solve this optimal assignment problem 2 6 tracking control law this paper is on planning the path of the asv once the path list associated to an asv is built then the asv needs to visit the waypoints in the path list sequentially various guidance algorithms were used to make a marine vehicle follow a predefined path lekkas and fossen 2014 breivik 2010 oh and sun 2010 snider 2009 this paper uses a path following method as follows whenever v n meets a waypoint in its path list p a t h n the asv moves towards the next waypoint in p a t h n iterate this until the asv visits the last waypoint in p a t h n v is the desired speed of the asv under strong currents let q n k denote the position of v n at time step k also let p denote the position of the next waypoint let d t denote the sampling interval of our control law we introduce how to set both the speed and the heading of the asv so that the asv can move towards the next waypoint p with a constant velocity v under strong currents recall that section 2 1 presented how to estimate the direction and speed of currents let current vector c k denote the vector representing the direction and speed of currents at time step k let movement vector m n k denote the desired movement vector of v n at time step k since we want the asv to head towards the next waypoint the equation for m n k is 8 m n k v p q n k p q n k under m n k v n moves according to 9 q n k 1 q n k m n k d t due to currents the heading direction of the asv may not coincide with the movement direction of the asv thus let heading vector h n k denote the vector representing the heading of the asv v n at time step k h n k is set as 10 h n k m n k c k see fig 4 for an illustration of the heading vector in this figure the triangle represents the pose of the asv in the case where the heading of the asv is opposite to the direction of currents h n k is parallel to m n k in this case the asv can move straight while maintaining its track hence we can obtain vivid sonar images suitable for detecting objects of interest williams et al 2016 3 simulation results this section presents matlab simulations to verify the effectiveness of the proposed path planning algorithm the scan width of sss is d 300 meters initially the positions of all asvs are 0 2000 0 1000 1000 1000 0 0 respectively v 10 m s r is an ellipse x y whose coordinate is given by 11 x 2 5000 2 y 2 1000 2 1 3 1 θ 0 30 degrees fig 5 shows the case where n 2 and θ 0 30 degrees in the above sub figure of fig 5 initial positions of all asvs are marked with black asterisks the blue line segments in the above sub figure of fig 5 present the global path list in the below sub figure of fig 5 the trajectory of each asv is depicted with circles with distinct colors 5320 s are spent to finish the survey fig 6 shows the case where n 4 and θ 0 30 degrees in the above sub figure of fig 6 initial positions of all asvs are marked with black asterisks in the below sub figure of fig 6 the trajectory of each asv is depicted with circles with distinct colors 2780 s are spent to finish the survey see that as we increase the number of asvs to n 4 we can complete the scanning task much faster than the case where n 2 3 2 θ 0 90 degrees fig 7 shows the case where n 2 and θ 0 90 degrees in the above sub figure of fig 7 initial positions of all asvs are marked with black asterisks in the below sub figure of fig 7 the trajectory of each asv is depicted with circles with distinct colors 4660 s are spent to finish the survey fig 8 shows the case where n 4 and θ 0 90 degrees in the above sub figure of fig 8 initial positions of all asvs are marked with black asterisks in the below sub figure of fig 8 the trajectory of each asv is depicted with circles with distinct colors 2410 s are spent to finish the survey see that as we increase the number of asvs to n 4 we can complete the scanning task much faster than the case where n 2 4 conclusions this paper considers conducting underwater surveys using multiple sonar equipped asvs given a workspace every asv simultaneously searches for a mine towing a sss which can provide high resolution image of underwater environments this paper introduces global path planning of multiple asvs satisfying the following three goals 1 there is no hole in coverage after the search is done 2 whenever an asv performs sonar survey inside the workspace the heading of the asv is opposite to the direction of currents 3 the workload of every asv is balanced for time efficient search we verified the effectiveness of our multi asv path planning methods using matlab simulations as our future works we will verify the effectiveness of our planning methods using real experiments with multiple asvs moreover we will consider the case where the sea currents change as time goes on acknowledgment this work was supported by 2019 hongik university research fund 
22583,random vibration and force transmission characteristics of an elastic propeller shafting system induced by the inflow turbulence are analytically studied both the propeller blades and the shafting are simplified as three dimensional elastic beam which are connected by lumped spring elements based on the timoshenko beam theory an analytical model considering both the longitudinal and transverse responses of the propeller shafting system is developed the random pressure spectrum induced by inflow turbulence is computed by the correlation method and is mapped onto the blades as exciting source by virtue of the frequency response function matrix the random vibration characteristics of the propeller shafting system and forces transmitted through different bearings are obtained analytical results show that the elasticity of the propeller blades cannot be neglected and the bending modes of the propeller blades amplify both the longitudinal and transverse transmitted forces the longitudinal force transmission is mainly controlled by the propeller elasticity and the longitudinal stiffness of the thrust bearing while the frequency and magnitude of the transverse force is mainly controlled by the bending modes of the shafting and the system elasticity respectively keywords propeller shafting inflow turbulence random vibration force transmission nomenclature l i the length of blade i l 0 j the length of the j t h segment of shaft ρ i the density of blade i ρ f the density of the fluid surrounding the blade y i x i t transverse displacement of the blade i at position x i and time t φ i x i t bending slope of the blade i at position x i and time t y i x i the mode shape functions with respect to y i x i t φ i x i the mode shape functions with respect to y i x i t u i x i t the axial displacement of blade i at position x i and time t θ i x i t the torsion angle of blade i at position x i and time t y i u x i φ i u x i the mode shape functions of transverse responses along coordinate direction u of blade i y 0 u j x 0 j φ 0 u j x 0 j the mode shape functions of transverse responses along coordinate direction u of the j t h segment of shaft r radius of propeller m the mass of the hub j x j y j z the rotational inertia of the propeller hub ω the natural angle frequency of propeller shafting system r s p ω the random frequency response at position p u velocity fluctuation in the turbulent inflow l u v γ t τ hydrodynamic force related to the fluid velocity fluctuations h u k γ ω hydrodynamic frequency response function f u γ t hydrodynamic force acting on the γ t h strip at time t in the direction u f n γ ω frequency spectrum of fluctuating force at the γ t h strip in the direction of law φ u v γ χ τ correlation function of unsteady forces between f u γ t and f v χ t ψ u v γ χ ω frequency spectrum of the force fluctuations r k m γ χ τ velocity correlation function between different fluid point in the turbulence g k m γ χ ω frequency spectrum of fluid velocity fluctuations h n γ p ω frequency response function of propeller shafting system λ the integral length scale of turbulence r τ the instantaneous instance between two inflow fluid particles ω rotational speed of propeller u w mean inflow velocity for the propeller 1 introduction the fluctuating thrust force of the marine propeller is an important source of the vibration and acoustic radiation for both submarines and surface vessels chen et al 2019 ross 1987 youssef et al 2015 although many efforts have been made by designers to reduce the narrowband periodic components of the unsteady hydrodynamic force the broadband force resulting from the interaction between inflow turbulence and propeller blades abbas et al 2015 blake and maga 1975 becomes more and more prominent the broadband force components are usually distributed on a frequency span of several hundred hertz with some hump at the first and second blade rate frequencies jiang et al 1991 sevik 1970 causing resonance at the natural frequency of the propulsion system considering the broadband characteristics of this kind of unsteady hydrodynamic force the inherent dynamic characteristics of the propeller shafting system must be carefully modeled to ensure an accurate prediction on the vibration response characteristics of the whole marine some vibration control measures and devices such as the resonance changer dylejko and kessissoglou 2004 merz et al 2009 2010 magnetorheological elastomers yang et al 2014 active vibration control device zhang et al 2012 have been developed to optimize the force transmission characteristics of propeller shafting system and reduce the excitation transmitted from bearing to marine hull in short the existing vibration control measures mainly focused on the vibration of the shafting system ignoring the blade vibration itself some experiments found the lowest natural frequency of propeller could be lowed to several tens of hertz castellini and santolini 1998 blade bending modes can amplify the thrust transmission of propeller fluctuating force at specific resonance frequencies thus the vibration behaviors of the propeller should get more attention and actually the influence of these behaviors on the force transmission characteristics of propeller shafting system is providing new approaches for vibration control chen et al 2017 many propeller shafting models have been developed in the past years to study the vibration transmission characteristics of the submarine systems which can have also been further utilized to optimize the low frequency vibration performances of the submarines some analytical and semi analytical models were proposed to predict the vibration of the simplified propeller shafting system where the propellers were often represented by a rigid lumped mass attached to a continuous model of the elastic shafting dylejko et al 2007 merz et al 2009 qu et al 2017 zou et al 2016 in these models the propellers are excessively simplified by ignoring the effect of the elasticity and the interaction of vibration between the propeller and shafting to consider the propeller flexibility and the resulting blade resonances the propeller blades were represented as a continuous beam based on euler bernoulli theory or a mass spring model huang et al 2018a li et al 2016 youssef et al 2015 however the mass spring model can only be used to describe the first resonance of the propeller and can not simulate higher order natural vibration of the propeller moreover the mass and stiffness parameters need to be apriori determined according to natural frequency of the system for the research on the bending vibration the euler bernoulli beam is not accurate enough as compared with the timoshenko beam owing to the complexity of the propulsion system these models can only analyze the vibrations of the propeller shafting system in the two dimensional space in addition to the analytical models of the propeller numerical models have also been developed according to the geometry structures for getting more accurate prediction of the vibration response the commercial software and finite element method fem were further employed to create the propeller model with its elastic properties considered zhang et al 2014 and frf based sub structuring method was utilized to further obtain the responses of the propeller shafting system due to the fluctuating propeller force huang et al 2017 liu et al 2017 however it is not convenient to perform parametric study due to computational expensiveness of the model moreover during the design stage of the propeller shafting system the precise geometry structure is not always confirmed therefore an accurate simplified model accounting for the propeller elasticity and high order vibration of blades which can be used to obtain the dynamic behaviors of the propeller shafting system more efficiently is still required for the computing of the vibration responses of propulsion system many investigations only focusing on the longitudinal vibration of propeller shafting system chen et al 2017 huang et al 2018a merz et al 2009 have been carried out the propeller force was sometimes assumed as the point force with unit amplitude exerted on representative points on the blades such as points at the tip 0 7 times radius and root of the propeller blades huang et al 2018b qi et al 2019 however the unsteady thrust is in fact a complex random force distributed on the blade surface which contains components in different directions therefore the previous simplifications cannot adequately describe the amplitude frequency characteristics of the fluctuating force consequentially this paper contributes an elastic propeller shafting model to study three dimensional random vibrations and force transmission characteristics induced by inflow turbulence longitudinal and transverse responses of the propulsion system as well as the interaction between the blades and shafting are taken into account in the developed spatial model moreover this paper also contributes a random analysis method which combine the strip method and the correlation method to accomplish the load of random pressure spectrum induced by inflow turbulence in order to simulate the whole blade under stresses the force transmission characteristics as well as effect of the system elasticity are then analyzed and compared 2 analytical modelling on the elastic propeller shafting coupling system the dynamic behaviors of the propeller with four blades and shafting are investigated the equivalent model is shown in fig 1 the blades and shaft in the propeller shafting system are all simplified as timoshenko beams with transverse longitudinal and torsional vibration behaviors considered especially the shaft is modeled by multi span non uniform beams with flexible attachments the elastic blades can be simplified as beams because the preceding analysis shows that the blade bending mode is main cause of the amplification of transmission force chen et al 2017 since the propeller hub is relatively rigid it is modeled as a concentrated mass point attaching at the end of shafting the mass and rotational inertia about the u x y z axis of the propeller hub are represented by m and j u the length of each blade is denoted by l i i 1 2 3 4 and the shaft is subdivided into three segments by the two stern bearings in which the length of each segment is represented by l 0 j j 1 2 3 three sets of translational springs and three sets of rotational springs are used to simulate the interactions between the blades and shafting two sets of translational springs are employed to simulate the radial stiffness of stern bearing while three sets of translational springs are used to simulate the stiffness of thrust bearing the hull is hard to employ uniform elastic model to simulate the different structures and not the research object in this paper so it is represented by rigid fixed end 2 1 dynamic motion equation of blades since the propeller is immersed in fluid the effect of the added fluid mass on the blade should be taken into account as the dimensions of the immersed beam increase to macroscopic size fluid viscosity exerts a negligible effect and fluid can be considered to be inviscid van eysden and sader 2006 pertinent literature reported this problem as wet beam and gave the analytical methods to solve it from existing literature it can be found that the technique used for the vibration analysis of the wet beam is similar as that of dry beam fig 3 b shows the axial coordinate system of each blade the origin of coordinates of blade b 1 and b 3 is at the end of blade tip while b 2 and b 4 is at the blade root to get the analytical solution the governing equations of transverse vibration of each blade i 1 2 3 4 can be written as chang and liu 1989 posiadała 1997 wu and chen 2001 2005 zhang et al 2014b 1a ρ i ρ f c m a i 2 y i x i t t 2 κ i g i a i 2 y i x i t x i 2 φ i x i t x i 0 1b ρ i ρ f c m i i 2 φ i x i t t 2 e i i i 2 φ i x i t x i 2 κ i g i a i y i x i t x i φ i x i t 0 2 ρ i e q ρ i ρ f c m where y i x i t and φ i x i t are the transverse displacement and bending slope of the blade i at position x i respectively t is the time variable e i and g i are the young s modulus and shear modulus a i is the cross sectional area ρ i is the density of the blade i i denotes the moment inertia of the cross section about neutral axis κ i is the shear correction factor ρ f is the mass density of the fluid surrounding the blade and c m is the added mass coefficient relating to the cross section shape of the blade the eq 1 can be decoupled in y i and φ i to yield 3a e i i i 4 y i x i t x i 4 ρ i e q a i 2 y i x i t t 2 i i 1 e i κ i g i 4 y i x i t x i 2 t 2 ρ i e q 2 i i κ i g i 4 y i x i t t i 4 0 3b e i i i 4 φ i x i t x i 4 ρ i e q a i 2 φ i x i t t 2 i i 1 e i κ i g i 4 φ i x i t x i 2 t 2 ρ i e q 2 i i κ i g i 4 φ i x i t t i 4 0 the solutions of eq 3 are assumed as 4a b y i x i t y i x i e i ω t φ i 1 x i t φ i x i e i ω t where ω is the natural angular frequency while y i x i and φ i x i are the mode shape functions by substituting of eq 4 into eq 3 the general solution of mode shape functions can be written in the form 5a y i x i cosh λ i x i sinh λ i x i cos λ i x i sin λ i x i c i 5b φ i x i q i sinh λ i x i q i cosh λ i x i q i sin λ i x i q i cos λ i x i c i where c i is the integration constant associated with the boundary conditions of blade i which can be expressed as 6 c i c i 1 c i 2 c i 3 c i 4 t 7a b λ i σ i τ i 2 2 α i σ i τ i 2 1 2 λ i σ i τ i 2 2 α i σ i τ i 2 1 2 8a b q i ω 2 ρ i e q κ i g i λ i λ i q i ω 2 ρ i e q κ i g i λ i λ i 9a c σ i ρ i e q ω 2 e i τ i ρ i e q ω 2 κ i g i α i ρ i e q a i ω 2 e i i i the longitudinal and torsional vibration equations of each immersed blade can be written as chang and liu 1989 wu and chen 2001 2005 xiang et al 2012 zhang et al 2014b 10a e i a i 2 u i x i t x i 2 ρ i e q a i 2 u i x i t t 2 0 10b g i j i 2 θ i x i t x i 2 ρ i e q j i 2 θ i x i t t 2 0 where u i x i t and θ i x i t are the axial displacement and torsion angle of blade i at position x i and time t j i denotes the polar moment of inertia the solutions of eq 10 can be assumed as 11a b u i x i t u i x i e i ω t θ i x i t θ i x i e i ω t substituting eq 11 into eq 10 the mode shape functions u i x i and θ i x i can be further expressed as 12a b u i x i cos μ i x i sin μ i x i d i θ i x i cos γ i x i sin γ i x i h i where d i and h i are the constants associated with the boundary conditions of the blade i and they can be given by 13a b d i d 1 i d 2 i t h i h 1 i h 2 i t 14a b μ i ρ i e q e i ω 2 γ i ρ i e q g i ω 2 2 2 general formulations of the three span shaft with bearings supporting the section 2 1 gives the motion equations and corresponding solutions of the transverse longitudinal and torsional vibrations of immersed blades b 1 b 2 b 3 b 4 in fig 1 it s worth noting that the solution process for the three span shaft b 0 1 b 0 2 b 0 3 is similar as that for blades and the variables use the superscripts to denote the serial number of segments of the shaft since the shaft is supported by a series of bearings the shaft is subdivided into three segments by two stern bearings in this paper each segment can be simplified as uniform beam and two sets of translational springs are used to simulate the stiffness of bearing as shown in fig 2 firstly the force equilibrium conditions and the deflection compatibility conditions of transverse vibration across the j t h j 1 2 stern spring supporting point can be expressed as 15 y 0 j 1 0 y 0 j l 0 j φ 0 j 1 0 φ 0 j l 0 j e 0 j 1 i 0 j 1 d φ 0 j 1 0 d x 0 i 1 e 0 j i 0 j d φ 0 j l 0 j d x 0 i κ 0 j 1 g 0 j 1 a 0 j 1 φ 0 j 1 0 d y 0 j 1 0 d x 0 j 1 k 0 j y 0 j 1 0 κ 0 j g 0 j a 0 j φ 0 j l 0 j d y 0 j l 0 j d x 0 j substituting the solution of y 0 j x 0 j and φ 0 j x 0 j into eq 15 and writing in matrix form leads to the following formula 16 t j 1 c 0 j 1 t j c 0 j where 17a b c 0 j 1 c 01 j 1 c 02 j 1 c 03 j 1 c 04 j 1 t c 0 j c 01 j c 02 j c 03 j c 04 j t 18 t j 1 1 0 1 0 0 q 0 j 1 0 q 0 j 1 q 0 j 1 λ 0 j 1 0 q 0 j 1 λ 0 j 1 0 k 0 j q 0 j 1 λ 0 j 1 k 0 j q 0 j 1 λ 0 j 1 19 t j cosh λ 0 j l 0 j sinh λ 0 j l 0 j cos λ 0 j l 0 j sin λ 0 j l 0 j q 0 j sinh λ 0 j l 0 j q 0 j cosh λ 0 j l 0 j q 0 j sin λ 0 j l 0 j q 0 j cos λ 0 j l 0 j ε 1 j cosh λ 0 j l 0 j ε 1 j sinh λ 0 j l 0 j ε 2 j cos λ 0 j l 0 j ε 2 j sin λ 0 j l 0 j ε 3 j sinh λ 0 j l 0 j ε 3 j cosh λ 0 j l 0 j ε 4 j sin λ 0 j l 0 j ε 4 j cos λ 0 j l 0 j and 20a d ε 1 j e i j q 0 j λ 0 j ε 2 j e i j q 0 j λ 0 j ε 3 j k g a j q 0 j λ 0 j ε 4 j k g a j q 0 j λ 0 j 21a c e i j e 0 j i 0 j e 0 j 1 i 0 j 1 k g a j κ 0 j g 0 j a 0 j κ 0 j 1 g 0 j 1 a 0 j 1 k 0 j k 0 j κ 0 j 1 g 0 j 1 a 0 j 1 then the compatibility conditions of longitudinal and torsional vibration across the j t h stern spring supporting point can be expressed as 22a u 0 j 1 0 u 0 j l 0 j a 0 j 1 e 0 j 1 u 0 j 1 0 x 0 j 1 a 0 j e 0 j u 0 j l 0 j x 0 j 22b θ 0 j 1 0 θ 0 j l 0 j g 0 j 1 j 0 j 1 θ 0 j 1 0 x 0 j 1 g 0 j j 0 j θ 0 j l 0 j x 0 j substituting the solution of u 0 j x 0 j and θ 0 j x 0 j into eq 22 and writing in matrix form leads to the following formula 23a b z j 1 d 0 j 1 z j d 0 j n j 1 h 0 j 1 n j h 0 j where 24a b z j 1 1 0 0 a 0 j 1 e 0 j 1 μ 0 j 1 z j cos μ 0 j l 0 j sin μ 0 j l 0 j a 0 j e 0 j μ 0 j sin μ 0 j l 0 j a 0 j e 0 j μ 0 j cos μ 0 j l 0 j and 25a b n j 1 1 0 0 g 0 j 1 j 0 j 1 γ 0 j 1 n j cos γ 0 j l 0 j sin γ 0 j l 0 j g 0 j j 0 j γ 0 j sin γ 0 j l 0 j g 0 j j 0 j γ 0 j cos γ 0 j l 0 j it is clearly found that the constants in the j 1 t h segment are related with those in j t h segment according to eq 16 and eq 23 the constants in the third segment can be easily reconstructed by that of first segment 26a c c 0 3 w 3 w 2 c 0 1 d 0 3 s 3 s 2 d 0 1 h 0 3 m 3 m 2 h 0 1 where 27a c w j t j 1 t j 1 s j z j 1 z j 1 m j n j 1 n j 1 j 3 2 2 3 boundary conditions of the propeller shafting system the vibration of blades and shafting with classical boundary conditions free end and complicated boundary conditions such as elastic support lumped mass rotational inertial boundary or any combination of them can be readily investigated in present work fig 3 a plots the schematic figure of the interaction of blade b 1 and shafting in x z plane of the global coordinate system and other blades have the same connection type since the interactions between the blades and shafting are considered their vibrations are coupled the blades and shaft are all spatial structure each of them has two direction transverse vibration longitudinal vibration and torsional vibration the variables y i u x i and φ i u x i are respectively the mode shape functions with respect to y i u x i t and φ i u x i t which denote the bending responses of blade i along the global coordinate direction u x y z and i i u x i is the corresponding moment inertia of the cross section about the neutral axis in general the corresponding variable of the j t h segment of shafting can be represented by v a 0 u j x 0 j t and v a 0 j x 0 j t it is known that the bending moment and shear force have the following relation to bending slope φ i u x i and deflection y i u x i 28 m i u x i e i i i u φ i u x i v i u x i κ i g i a i φ i u x i y i u x i the blade i 1 3 has a free end and an elastic connection end so the boundary and compatibility conditions including shear force bending moment and axial force can be expressed as 29 κ i g i a i φ i x 0 y i x 0 0 κ i g i a i φ i x l i y i x l i k i x y i x l i u 0 1 0 30 e i i i x φ i x 0 0 e i i i x φ i x l i k r i y φ i x l i φ 0 z 1 0 31 κ i g i a i φ i y 0 y i y 0 0 κ i g i a i φ i y l i y i y l i k i y y i y l i y 0 y 1 0 32 e i i i y φ i y 0 0 e i i i y φ i y l i k r i x φ i y l i φ 0 1 0 33 u i 0 0 a i e i u i l i k i z u i l i y 0 z 1 0 it s worth noting that the subscripts x y z in eqs 29 33 should be replaced as x z y when i 3 similarly the boundary and compatibility conditions of blade i 2 4 can be expressed as 34 κ i g i a i φ i x 0 y i x 0 k i x y i x 0 u 0 1 0 κ i g i a i φ i x l i y i x l i 0 35 e i i i x φ i x 0 k r i y φ i x 0 φ 0 z 1 0 e i i i x φ i x l i 0 36 κ i g i a i φ i y 0 y i y 0 k i y y i y 0 y 0 y 1 0 κ i g i a i φ i y l i y i y l i 0 37 e i i i y φ i y 0 k r i x φ i y 0 φ 0 1 0 e i i i y φ i y l i 0 38 a i e i u i 0 k i z u i 0 y 0 z 1 0 u i l i 0 also the subscripts in eqs 34 38 x y z should be replaced as x z y when i 4 considering the equilibrium conditions of the axial force torsional shear stress shear force and bending moment at the ends of shaft the boundary and compatibility conditions of the non uniform three span shaft can be expressed as 39 a 0 1 e 0 u 0 1 0 t 1 4 k t x m ω 2 u 0 1 0 i 1 3 k i x y i x l i j 2 4 k j x y j x 0 40 g 0 j 0 1 θ 0 1 0 i 1 3 k r i x j 2 4 k r j x j x ω 2 θ 0 1 0 i 1 3 k r i x φ i y l i j 2 4 k r j x φ j z 0 41 v 0 y 1 0 i 1 2 3 4 k i y m ω 2 y 0 y 1 0 k 1 y y 1 y l 1 k 2 y y 2 y 0 k 3 y u 3 l 3 k 4 y u 4 0 42 m 0 y 1 0 i 1 2 3 4 k r i z j z ω 2 φ 0 y 1 0 k r 3 z φ 3 x l 3 k r 4 z φ 4 x 0 43 v 0 z 1 0 i 1 2 3 4 k i z m ω 2 y 0 z 1 0 k 1 z u 1 l 1 k 2 z u 2 0 k 3 z y 3 z l 3 k 4 z y 4 z 0 44 m 0 z 1 0 i 1 2 3 4 k r i y j y ω 2 φ 0 z 1 0 k r 1 y φ 1 x l 1 k r 2 y φ 2 x 0 45 a 0 3 e 0 u 0 3 l 0 3 k 0 x u 0 3 l 0 3 θ 0 3 l 0 3 0 46 v 0 y 3 l 0 3 k 0 y y 0 y 3 l 0 3 m 0 y 3 l 0 3 0 47 v 0 z 3 l 0 3 k 0 z y 0 z 3 l 0 3 m 0 z 3 l 0 3 0 combing eqs 29 47 and the transfer relation in eq 26 and then substituting eq 5 and eq 12 into them the following matrix form can be obtained 48 p r o 1 p r o 2 p r o 3 p r o 4 s a t t c o e 0 52 1 p r o 1 p r o 2 p r o 3 p r o 4 s a t are given in appendix a which are only associated with the boundary conditions of the propeller and shafting 49 c o e c 0 y 1 c 0 z 1 d 0 1 h 0 1 c 1 x c 1 y d 1 c 4 x c 4 z d 4 t it is noted that only c o e is unknown so the existence of non trivial solutions in eq 48 requires the determinant of the matrix on the left side is equal to zero 50 det p r o 1 p r o 2 p r o 3 p r o 4 s a t t 0 a single equation for the solution of the natural angular frequency ω of system is provided by the above equation which can be solved by the false position method once the frequency parameters have been determined the c o e can be easily obtained by solving eq 48 using the transfer relation in eq 26 the integration constants in segments b 0 2 and b 0 3 can be obtained consequently the mode shape functions of propeller shafting system are derived the forced vibration response of the system can also be developed based on the above method when the external force f i x f acts at the position x f of the blade i the shear force equilibrium condition can be written as 51 κ i g i a i φ i x f y i x f f i x f 52 p r o 1 p r o 2 p r o 3 p r o 4 s a t t c o e 0 f i 0 t and the right side of eq 48 will be replaced by 0 f i 0 t assuming that the external load is harmonic so that directly solving eq 52 and using transfer matrix can lead to the integration constants of the system under certain frequency excitation the frequency response of propeller shafting can be further obtained 3 random vibration analysis of propeller shafting system 3 1 unsteady force spectrum loadings at the propeller the correlation method jiang et al 1991 is adopted in this paper to obtain the propeller broadband force generated by turbulence it is a direct approach and the explicit auto power and cross power spectrum matrix can be easily obtained which is essential for the subsequent random vibration analysis of the propeller shafting system the derivations of the frequency spectrum of propeller thrust using the correlation approach are briefly discussed based on the strip theory and the velocity correlation incorporating propeller rotational effects anderson et al 2014 the blade is divided into a number of strip elements along its radius as shown in fig 4 to calculate the characteristics of the fluctuating force over the blade surfaces the following equations use the subscripts to denote the direction along the coordinate axes while superscripts are used to denote the blade element involved for example l u v γ χ t τ denotes the hydrodynamic force acting on the γ t h element in the direction u at the instant of time t caused by a velocity fluctuation of unit magnitude in the direction v of the χ t h element with velocity u v χ at the instant τ under this convention the hydrodynamic force acting on the γ t h element at time t in the direction u f u γ t due to the influence of velocity fluctuation at all elements and in all the direction over all time τ can be expressed as 53 f u γ t t l u v γ χ t τ u v χ τ d τ where u v x y z γ χ 1 2 n as f u γ t is a random function of time in a turbulent flow a statistical approach must be employed in this paper assuming the inflow turbulence is time invariant so the correlation function of unsteady forces φ u v γ χ between the γ t h element in the direction u due to the χ t h element in the direction v becomes 54 φ u v γ χ τ e f u γ t f v χ t τ lim t 1 t 0 t 0 0 l u k γ α τ 1 l v m χ δ τ 2 u k α t τ 1 u m δ t τ τ 2 d τ 1 d τ 2 d t 0 0 l u k γ α τ 1 l v m χ δ τ 2 r k m α δ t τ τ 2 d τ 1 d τ 2 where r k m α δ is the velocity correlation function between different fluid particles in the turbulence 55 r k m α δ t τ τ 2 lim t 1 t 0 t u k α t τ 1 u m δ t τ τ 2 d t the corresponding frequency spectrum of the correlated force fluctuations can be obtained by using the fourier transform of the above correlation function 56 ψ u v γ χ ω φ u v γ χ τ e i ω τ d τ 0 0 l u k γ α τ 1 d τ 1 l v m χ δ τ 2 d τ 2 r k m α δ t τ τ 2 d τ h u k γ α ω h v m χ δ ω g k m α δ ω where h u k γ α ω is the hydrodynamic frequency response function and g k m α δ ω is the fourier transform of the velocity correlation function r k m α δ in this paper the turbulent inflow to be modeled is a spatially homogeneous turbulent flow where two point velocity correlations are invariant with translations in position by assuming the flow field is divergence free and exponentially decays normalized stream wise the velocity correlation function can be written as hinze 1959 57 r u v u 2 1 2 r λ r u r v 1 r 2 λ δ u v e r τ λ where λ is the integral length scale of turbulence assuming blades rotating in a turbulent field with rotational speed ω r τ the instantaneous instance between two inflow fluid particles that will flow to the γ t h and χ t h strip element 58 r τ d x 2 r γ 2 r χ 2 2 r γ r χ θ γ 0 θ χ 0 ω τ where r γ and r χ is the location of γ t h and χ t h strip in radius θ γ 0 and θ χ 0 is the initial angle of two blade strips 3 2 random vibration response the random response induced by inflow turbulence is computed by a two stepped method fig 5 gives the computational procedure in the first step an analytical method is presented to obtain the frequency response function of propeller shafting system considering the entrained fluid in the second step the strip theory and correlation method is used to compute the unsteady thrust spectrum for the blades strip elements finally the random response can be obtained by the thrust spectrum matrix and frequency response function vector when the velocity correlation functions r k m α δ obtained by eq 57 and the unsteady forces l u v γ χ due to inflow turbulence have been computed the correlation force spectrum of all strips on blade is determined according to eq 56 if all blades are divided into n strips the force spectrum of all strip elements can be written as a n n matrix each diagonal element is auto power spectrum of the corresponding strip while others are cross power spectrum between different strips 59 ψ n n 11 ω ψ n n 12 ω ψ n n 1 n ω ψ n n 21 ω ψ n n 22 ω ψ n n 2 n ω ψ n n γ χ ω ψ n n n 1 ω ψ n n n 2 ω ψ n n n n ω since the propeller shafting system in this paper is a linear system the random response at any position p can be obtained by the following equation 60 r s p ω γ 1 n f n γ ω h n γ p ω where f n γ ω is the frequency spectrum of fluctuating force at the γ t h strip in the direction of law obtained by the fourier transform of f n γ t h n γ p ω is the frequency response at position p under the unit magnitude harmonic force acting at the γ t h strip along the normal the auto power spectrum of the corresponding random response at position p is further obtained by 61 r s p r s p γ 1 n f n γ ω h n γ p ω γ 1 n f n γ ω h n γ p ω f n 1 ω f n 1 ω h n 1 p ω h n 1 p ω f n n ω f n n ω h n n p ω h n n p ω ψ n n 11 ω h n 1 p ω h n 1 p ω ψ n n n n ω h n n p ω h n n p ω each element in the matrix of eq 59 defines the multiplier of each item in eq 61 the cross power spectrum of random response at any two different positions can also be further computed similarly 4 numerical results and discussions 4 1 model verification to validate the accuracy and reliability of the present method a matlab code based on the proposed model is developed a propeller shafting system with four blades and three span shaft is chosen as the computational model shown in fig 1 the length and diameter of all spans of shaft are l 0 1 0 3 m l 0 2 5 m l 0 3 10 m d 0 1 0 4 m d 0 2 0 36 m d 0 3 0 32 m and the material properties of shaft are defined as e s 2 1 e 11 pa υ s 0 3 ρ s 7500 kg m 3 the geometrical parameters of blade are b 0 07 m h 0 3 m l 1 l 2 l 3 l 4 1 6 m and the material properties of propeller are e p 4 2 e 11 pa υ p 0 32 ρ p 8900 kg m 3 besides the fluid density is ρ f 1000 kg m 3 the shear correction factors of shaft and blade are respectively κ s 0 9 and κ p 5 6 in analysis for the propeller hub and bearings two cases of physical parameters are available in table 1 a comparison of natural frequencies of the system using proposed method and fem is shown in table 2 meanwhile the corresponding mode shapes of propeller shafting system using present method and fem for the case1 are also shown in fig 6 a f excellent agreements can be observed between the obtained results and those from fem which means the proposed method is accurate to predict free vibration of the propeller shafting system 4 2 influence of system elasticity subsequently the influence of the system elasticity on vibration characteristics is studied by changing the elastic parameters of propeller blades and bearings firstly three different elastic modulus of blade material are taken into consideration and the first ten mode frequencies and some typical mode shapes are compared in fig 7 the first two modes are the transverse bending mode of shafting in two different planes which are not affected by the modulus of blade when the modulus decreases to 4 2e10pa the pure bending mode of blade can be seen in the first ten order which means vibration behaviors of propeller itself will be enlarged if the external force acts on the blade although the natural frequency of the longitudinal mode of propeller shafting system has no relation to blade modulus its mode shape will be significantly changed by the blade elasticity as the increase of modulus the elastic deformation of blade gradually attenuates until it can be considered as rigid body based on the method proposed in section 3 2 the auto power spectrums of unsteady force transmitted by bearings are obtained and shown in fig 8 the inflow velocity u w is equal to 4 63 m s and the rotating speed of propeller ω is 1 9r s the turbulence level is about 3 with integral length scale λ being about 4 cm the longitudinal transverse force spectrums transmitted by the thrust bearing are plotted in fig 8 a it can be found that the elasticity of system has great impact on the auto power spectrums of transmitted force an important phenomenon is that the longitudinal force transmission spectrum has resonance peaks not only at each longitudinal mode of shafting f s i i 1 2 3 but also at the bending mode of blade f b j j 1 2 since the fluctuating force of propeller decreases in high frequency range the value of resonance peaks gradually attenuates at higher longitudinal and bending mode frequency the transverse force transmission spectrum has more resonance peaks compared with that of the longitudinal force spectrum in the frequency range lower than the second order of bending mode of shafting f t 2 longitudinal force spectrum is larger than that of transverse spectrum obviously while in the middle frequency range of f t 3 f s 2 considerable bending modes of shafting can be observed in transverse force spectrum when the external excitation frequency is higher than f s 2 the value of resonance peaks of transverse force spectrum gradually decreases for the energy attenuation and elastic filtering effect the transverse force spectrums transmitted by different bearings are plotted and compared in fig 8 b the resonance peaks of force spectrums can be seen not only at the bending mode frequency of shafting but also the propeller blade in the frequency range lower than f t 2 the magnitude of force spectrum transmitted by the back stern bearing is larger than that of the other two when the frequency is higher than f t 4 the resonance peaks at thrust bearing and front stern bearing are almost same and the peaks of force spectrum at back stern bearing attenuate greatly for the filtering effect of the elastic shafting with increase of frequency as the shorter length of wave and the dispersion effect of the elastic wave the difference between the peaks of force spectrums transmitted by different bearings becomes smaller and their magnitude gradually attenuates secondly the auto power spectrums of unsteady force transmitted by bearings are analyzed with blade elasticity modulus changed and compared in fig 9 a and fig 10 the elasticity of blade can affect the distribution of longitudinal force spectrum and the magnitude of transverse force spectrum the peaks at the two order bending modes f b 1 and f b 2 of blade can be observed within 250hz and the distinctive valley exists between these two resonance peaks in fig 9 a the resonance peaks at the same order of blade bending mode gradually attenuate with the increase of blade modulus as can be seen that the resonance peaks induced by blade bending modes become smaller in higher order for the same modulus this fact should be attributed to the lower frequency range with higher excitation energy in fig 10 the auto power spectrums of transverse force transmitted by the two stern bearings have almost the similar characteristics when the blade modulus changes in the frequency range lower than f 1 the force spectrum of the softest blade is bigger than that of the other two and the amplification effect can be seen at the resonance peaks more obviously when the modulus equals the normal value 4 2e11pa the magnitude of transmitted force spectrum is higher than that of the other two cases in the frequency range of f 1 f 2 while the frequency is higher than f 2 the corresponding magnitude becomes the lowest one the force transmission spectrum of the hardest blade is much bigger when the frequency higher than f 3 compared with the longitudinal response distinctive characteristics of the transverse response reveal in different frequency range the distribution of transverse force spectrum transmitted by the stern bearings is mainly controlled by the bending modes of shafting and the blade elasticity has effect on the magnitude similarly the variations of longitudinal force spectrum transmitted by the thrust bearing with different stiffness values of thrust bearing are shown in fig 9 b with the increase of thrust bearing stiffness the shape of force transmission spectrum curves only has slight difference and the peaks induced by longitudinal mode of shafting shift to right blade bending mode frequency has no relation to the bearing stiffness while smaller stiffness leads to lower magnitude of resonance peaks fig 9 b also illustrates that reducing the stiffness of thrust bearing can attenuate the longitudinal transmission force consistently in the whole frequency domain the influence of the stern bearing stiffness on the transverse force transmitted by the two stern bearings is studied and the results are shown in fig 11 when the frequency is lower than f 1 the smaller the bearing stiffness the bigger the force transmission spectrum amplitude is while reducing the stiffness of stern bearing can attenuate the transverse force transmission consistently when the frequency is higher than f 2 however in the frequency range of f 1 f 2 bigger and smaller stiffness both can attenuate the force transmission spectrum therefore the stern spring stiffness should be properly designed according to the low vibration and noise requirements in different frequency range 5 conclusions based on the analytical model of propeller shafting system built with the timoshenko beam theory the random vibration and force transmission characteristics of an elastic propeller shafting system induced by inflow turbulence are studied it is found that the elasticity of propeller blade cannot be ignored for the practical propeller because the blade bending modes can amplify both the longitudinal force transmission at the thrust bearing and the transverse force transmission at the radial bearings lower elasticity modulus of propeller may lead to larger longitudinal responses while distinctive amplification characteristics of the transverse response can be exhibited in different frequency band the magnitude of the longitudinal force transmitted by thrust bearing is much larger than the transverse response when the frequency is lower than the second order bending mode frequency of shafting however the transverse response has more resonance peaks moreover the results reveal that the reduction of the thrust bearing stiffness can attenuate longitudinal force transmission in the whole frequency domain while the effects of stern bearing stiffness on transverse force spectrum are inconsistent in different frequency ranges aiming to obtain the fluctuating force characteristics transmitted from bearings to hull this paper investigated only the random vibration of propeller shafting system induced by the inflow turbulence where the elastic boundary of the shafting is treated to be rigid in order to simplify the analysis in the future work the model of the flexible marine hull should be included and the propeller shafting hull system should be developed for the prediction of the noise radiation of marine induced by turbulence appendix a the details of eq 48 a 1 p r o 1 0 1 4 0 1 4 p d 0 1 0 1 2 p c 1 x 0 1 4 0 1 2 0 1 30 0 1 4 p w c 0 z 1 0 1 2 0 1 2 p w c 1 x 0 1 4 0 1 2 0 1 30 0 2 4 0 2 4 0 2 2 0 2 2 b 1 x 0 2 4 0 2 2 0 2 30 p c 0 y 1 0 1 4 0 1 2 0 1 2 0 1 4 p c 1 y 0 1 2 0 1 30 0 1 4 0 1 4 0 1 2 p w h 0 1 0 1 4 p w c 1 y 0 1 2 0 1 30 0 2 4 0 2 4 0 2 2 0 2 2 0 2 4 b 1 y 0 2 2 0 2 30 0 1 4 p c 0 z 1 0 1 2 0 1 2 0 1 4 0 1 4 p d 1 0 2 30 0 1 4 0 1 4 0 1 2 0 1 2 0 1 4 0 1 4 f z 1 0 1 30 a 2 p r o 2 0 1 4 0 1 4 p d 0 2 0 1 2 0 1 10 p c 2 x 0 1 4 0 1 2 0 1 20 0 1 4 p w c 0 z 2 0 1 2 0 1 2 0 1 10 p w c 2 x 0 1 4 0 1 4 0 1 20 0 2 4 0 2 4 0 2 2 0 2 2 0 2 10 b 2 x 0 2 4 0 2 2 0 2 20 p c 0 y 2 0 1 4 0 1 2 0 1 2 0 1 10 0 1 4 p c 2 y 0 1 2 0 1 20 0 1 4 0 1 4 0 1 2 p w h 0 2 0 1 10 0 1 4 p w c 2 y 0 1 2 0 1 20 0 2 4 0 2 4 0 2 2 0 2 2 0 2 10 0 2 4 b 2 y 0 2 2 0 2 20 0 1 4 p c 0 z 2 0 1 2 0 1 2 0 1 10 0 1 4 0 1 4 p d 2 0 1 20 0 1 4 0 1 4 0 1 2 0 1 2 0 1 10 0 1 4 0 1 4 f z 2 0 1 20 a 3 p r o 3 0 1 4 0 1 4 p d 0 3 0 1 2 0 1 20 p c 3 x 0 1 4 0 1 2 0 1 10 p w c 0 y 3 0 1 4 0 1 2 0 1 2 0 1 20 p w c 3 x 0 1 4 0 1 4 0 1 10 0 2 4 0 2 4 0 2 2 0 2 2 0 2 20 b 3 x 0 2 4 0 2 2 0 2 10 0 1 4 p c 0 z 3 0 1 2 0 1 2 0 1 20 0 1 4 p c 3 z 0 1 2 0 1 10 0 1 4 0 1 4 0 1 2 p w h 0 3 0 1 20 0 1 4 p w c 3 z 0 1 2 0 1 10 0 2 4 0 2 4 0 2 2 0 2 2 0 2 20 0 2 4 b 3 z 0 2 2 0 2 10 p c 0 y 3 0 1 4 0 1 2 0 1 2 0 1 20 0 1 4 0 1 4 p d 3 0 1 10 0 1 4 0 1 4 0 1 2 0 1 2 0 1 20 0 1 4 0 1 4 f z 3 0 1 10 a 4 p r o 4 0 1 4 0 1 4 p d 0 4 0 1 2 0 1 30 p c 4 x 0 1 4 0 1 2 p w c 0 y 4 0 1 4 0 1 2 0 1 2 0 1 30 p w c 4 x 0 1 4 0 1 2 0 2 4 0 2 4 0 2 2 0 2 2 0 2 30 b 4 x 0 2 4 0 2 2 0 1 4 p c 0 z 4 0 1 2 0 1 2 0 1 30 0 1 4 p c 4 z 0 1 2 0 1 4 0 1 4 0 1 2 p w h 0 4 0 1 30 0 1 4 p w c 4 z 0 1 2 0 2 4 0 2 4 0 2 2 0 2 2 0 2 30 0 2 4 b 4 z 0 2 2 p c 0 y 4 0 1 4 0 1 2 0 1 2 0 1 30 0 1 4 0 1 4 p d 4 0 1 4 0 1 4 0 1 2 0 1 2 0 1 30 0 1 4 0 1 4 f z 4 a 5 s a t 0 1 4 0 1 4 s d 0 0 1 2 s c 1 x 0 1 4 0 1 2 s c 3 x 0 1 4 0 1 2 0 1 4 0 1 4 g u z 0 0 1 2 0 1 4 0 1 4 0 1 2 0 1 4 0 1 4 0 1 2 0 1 4 0 1 4 0 1 2 s n h 0 0 1 4 s n c 1 y 0 1 2 0 1 4 s n c 3 z 0 1 2 0 1 4 0 1 4 0 1 2 s n g 0 0 1 4 0 1 4 0 1 2 0 1 4 0 1 4 0 1 2 s c 0 y 0 1 4 0 1 2 0 1 2 0 1 4 s c 1 y 0 1 2 0 1 4 0 1 4 s d 3 v s w c 0 y 0 1 4 0 1 2 0 1 2 0 1 4 0 1 4 0 1 2 s w c 3 x 0 1 4 0 1 2 b 0 y 0 2 4 0 2 2 0 2 2 0 2 4 0 2 4 0 2 2 0 2 4 0 2 4 0 2 2 0 1 4 s c 0 z 0 1 2 0 1 2 0 1 4 0 1 4 s d 1 0 1 4 s c 3 z 0 1 2 0 1 4 s w c 0 z 0 1 2 0 1 2 s w c 1 x 0 1 4 0 1 2 0 1 4 0 1 4 0 1 2 0 2 4 b 0 z 0 2 2 0 2 2 0 2 4 0 2 4 0 2 2 0 2 4 0 2 4 0 2 2 
22583,random vibration and force transmission characteristics of an elastic propeller shafting system induced by the inflow turbulence are analytically studied both the propeller blades and the shafting are simplified as three dimensional elastic beam which are connected by lumped spring elements based on the timoshenko beam theory an analytical model considering both the longitudinal and transverse responses of the propeller shafting system is developed the random pressure spectrum induced by inflow turbulence is computed by the correlation method and is mapped onto the blades as exciting source by virtue of the frequency response function matrix the random vibration characteristics of the propeller shafting system and forces transmitted through different bearings are obtained analytical results show that the elasticity of the propeller blades cannot be neglected and the bending modes of the propeller blades amplify both the longitudinal and transverse transmitted forces the longitudinal force transmission is mainly controlled by the propeller elasticity and the longitudinal stiffness of the thrust bearing while the frequency and magnitude of the transverse force is mainly controlled by the bending modes of the shafting and the system elasticity respectively keywords propeller shafting inflow turbulence random vibration force transmission nomenclature l i the length of blade i l 0 j the length of the j t h segment of shaft ρ i the density of blade i ρ f the density of the fluid surrounding the blade y i x i t transverse displacement of the blade i at position x i and time t φ i x i t bending slope of the blade i at position x i and time t y i x i the mode shape functions with respect to y i x i t φ i x i the mode shape functions with respect to y i x i t u i x i t the axial displacement of blade i at position x i and time t θ i x i t the torsion angle of blade i at position x i and time t y i u x i φ i u x i the mode shape functions of transverse responses along coordinate direction u of blade i y 0 u j x 0 j φ 0 u j x 0 j the mode shape functions of transverse responses along coordinate direction u of the j t h segment of shaft r radius of propeller m the mass of the hub j x j y j z the rotational inertia of the propeller hub ω the natural angle frequency of propeller shafting system r s p ω the random frequency response at position p u velocity fluctuation in the turbulent inflow l u v γ t τ hydrodynamic force related to the fluid velocity fluctuations h u k γ ω hydrodynamic frequency response function f u γ t hydrodynamic force acting on the γ t h strip at time t in the direction u f n γ ω frequency spectrum of fluctuating force at the γ t h strip in the direction of law φ u v γ χ τ correlation function of unsteady forces between f u γ t and f v χ t ψ u v γ χ ω frequency spectrum of the force fluctuations r k m γ χ τ velocity correlation function between different fluid point in the turbulence g k m γ χ ω frequency spectrum of fluid velocity fluctuations h n γ p ω frequency response function of propeller shafting system λ the integral length scale of turbulence r τ the instantaneous instance between two inflow fluid particles ω rotational speed of propeller u w mean inflow velocity for the propeller 1 introduction the fluctuating thrust force of the marine propeller is an important source of the vibration and acoustic radiation for both submarines and surface vessels chen et al 2019 ross 1987 youssef et al 2015 although many efforts have been made by designers to reduce the narrowband periodic components of the unsteady hydrodynamic force the broadband force resulting from the interaction between inflow turbulence and propeller blades abbas et al 2015 blake and maga 1975 becomes more and more prominent the broadband force components are usually distributed on a frequency span of several hundred hertz with some hump at the first and second blade rate frequencies jiang et al 1991 sevik 1970 causing resonance at the natural frequency of the propulsion system considering the broadband characteristics of this kind of unsteady hydrodynamic force the inherent dynamic characteristics of the propeller shafting system must be carefully modeled to ensure an accurate prediction on the vibration response characteristics of the whole marine some vibration control measures and devices such as the resonance changer dylejko and kessissoglou 2004 merz et al 2009 2010 magnetorheological elastomers yang et al 2014 active vibration control device zhang et al 2012 have been developed to optimize the force transmission characteristics of propeller shafting system and reduce the excitation transmitted from bearing to marine hull in short the existing vibration control measures mainly focused on the vibration of the shafting system ignoring the blade vibration itself some experiments found the lowest natural frequency of propeller could be lowed to several tens of hertz castellini and santolini 1998 blade bending modes can amplify the thrust transmission of propeller fluctuating force at specific resonance frequencies thus the vibration behaviors of the propeller should get more attention and actually the influence of these behaviors on the force transmission characteristics of propeller shafting system is providing new approaches for vibration control chen et al 2017 many propeller shafting models have been developed in the past years to study the vibration transmission characteristics of the submarine systems which can have also been further utilized to optimize the low frequency vibration performances of the submarines some analytical and semi analytical models were proposed to predict the vibration of the simplified propeller shafting system where the propellers were often represented by a rigid lumped mass attached to a continuous model of the elastic shafting dylejko et al 2007 merz et al 2009 qu et al 2017 zou et al 2016 in these models the propellers are excessively simplified by ignoring the effect of the elasticity and the interaction of vibration between the propeller and shafting to consider the propeller flexibility and the resulting blade resonances the propeller blades were represented as a continuous beam based on euler bernoulli theory or a mass spring model huang et al 2018a li et al 2016 youssef et al 2015 however the mass spring model can only be used to describe the first resonance of the propeller and can not simulate higher order natural vibration of the propeller moreover the mass and stiffness parameters need to be apriori determined according to natural frequency of the system for the research on the bending vibration the euler bernoulli beam is not accurate enough as compared with the timoshenko beam owing to the complexity of the propulsion system these models can only analyze the vibrations of the propeller shafting system in the two dimensional space in addition to the analytical models of the propeller numerical models have also been developed according to the geometry structures for getting more accurate prediction of the vibration response the commercial software and finite element method fem were further employed to create the propeller model with its elastic properties considered zhang et al 2014 and frf based sub structuring method was utilized to further obtain the responses of the propeller shafting system due to the fluctuating propeller force huang et al 2017 liu et al 2017 however it is not convenient to perform parametric study due to computational expensiveness of the model moreover during the design stage of the propeller shafting system the precise geometry structure is not always confirmed therefore an accurate simplified model accounting for the propeller elasticity and high order vibration of blades which can be used to obtain the dynamic behaviors of the propeller shafting system more efficiently is still required for the computing of the vibration responses of propulsion system many investigations only focusing on the longitudinal vibration of propeller shafting system chen et al 2017 huang et al 2018a merz et al 2009 have been carried out the propeller force was sometimes assumed as the point force with unit amplitude exerted on representative points on the blades such as points at the tip 0 7 times radius and root of the propeller blades huang et al 2018b qi et al 2019 however the unsteady thrust is in fact a complex random force distributed on the blade surface which contains components in different directions therefore the previous simplifications cannot adequately describe the amplitude frequency characteristics of the fluctuating force consequentially this paper contributes an elastic propeller shafting model to study three dimensional random vibrations and force transmission characteristics induced by inflow turbulence longitudinal and transverse responses of the propulsion system as well as the interaction between the blades and shafting are taken into account in the developed spatial model moreover this paper also contributes a random analysis method which combine the strip method and the correlation method to accomplish the load of random pressure spectrum induced by inflow turbulence in order to simulate the whole blade under stresses the force transmission characteristics as well as effect of the system elasticity are then analyzed and compared 2 analytical modelling on the elastic propeller shafting coupling system the dynamic behaviors of the propeller with four blades and shafting are investigated the equivalent model is shown in fig 1 the blades and shaft in the propeller shafting system are all simplified as timoshenko beams with transverse longitudinal and torsional vibration behaviors considered especially the shaft is modeled by multi span non uniform beams with flexible attachments the elastic blades can be simplified as beams because the preceding analysis shows that the blade bending mode is main cause of the amplification of transmission force chen et al 2017 since the propeller hub is relatively rigid it is modeled as a concentrated mass point attaching at the end of shafting the mass and rotational inertia about the u x y z axis of the propeller hub are represented by m and j u the length of each blade is denoted by l i i 1 2 3 4 and the shaft is subdivided into three segments by the two stern bearings in which the length of each segment is represented by l 0 j j 1 2 3 three sets of translational springs and three sets of rotational springs are used to simulate the interactions between the blades and shafting two sets of translational springs are employed to simulate the radial stiffness of stern bearing while three sets of translational springs are used to simulate the stiffness of thrust bearing the hull is hard to employ uniform elastic model to simulate the different structures and not the research object in this paper so it is represented by rigid fixed end 2 1 dynamic motion equation of blades since the propeller is immersed in fluid the effect of the added fluid mass on the blade should be taken into account as the dimensions of the immersed beam increase to macroscopic size fluid viscosity exerts a negligible effect and fluid can be considered to be inviscid van eysden and sader 2006 pertinent literature reported this problem as wet beam and gave the analytical methods to solve it from existing literature it can be found that the technique used for the vibration analysis of the wet beam is similar as that of dry beam fig 3 b shows the axial coordinate system of each blade the origin of coordinates of blade b 1 and b 3 is at the end of blade tip while b 2 and b 4 is at the blade root to get the analytical solution the governing equations of transverse vibration of each blade i 1 2 3 4 can be written as chang and liu 1989 posiadała 1997 wu and chen 2001 2005 zhang et al 2014b 1a ρ i ρ f c m a i 2 y i x i t t 2 κ i g i a i 2 y i x i t x i 2 φ i x i t x i 0 1b ρ i ρ f c m i i 2 φ i x i t t 2 e i i i 2 φ i x i t x i 2 κ i g i a i y i x i t x i φ i x i t 0 2 ρ i e q ρ i ρ f c m where y i x i t and φ i x i t are the transverse displacement and bending slope of the blade i at position x i respectively t is the time variable e i and g i are the young s modulus and shear modulus a i is the cross sectional area ρ i is the density of the blade i i denotes the moment inertia of the cross section about neutral axis κ i is the shear correction factor ρ f is the mass density of the fluid surrounding the blade and c m is the added mass coefficient relating to the cross section shape of the blade the eq 1 can be decoupled in y i and φ i to yield 3a e i i i 4 y i x i t x i 4 ρ i e q a i 2 y i x i t t 2 i i 1 e i κ i g i 4 y i x i t x i 2 t 2 ρ i e q 2 i i κ i g i 4 y i x i t t i 4 0 3b e i i i 4 φ i x i t x i 4 ρ i e q a i 2 φ i x i t t 2 i i 1 e i κ i g i 4 φ i x i t x i 2 t 2 ρ i e q 2 i i κ i g i 4 φ i x i t t i 4 0 the solutions of eq 3 are assumed as 4a b y i x i t y i x i e i ω t φ i 1 x i t φ i x i e i ω t where ω is the natural angular frequency while y i x i and φ i x i are the mode shape functions by substituting of eq 4 into eq 3 the general solution of mode shape functions can be written in the form 5a y i x i cosh λ i x i sinh λ i x i cos λ i x i sin λ i x i c i 5b φ i x i q i sinh λ i x i q i cosh λ i x i q i sin λ i x i q i cos λ i x i c i where c i is the integration constant associated with the boundary conditions of blade i which can be expressed as 6 c i c i 1 c i 2 c i 3 c i 4 t 7a b λ i σ i τ i 2 2 α i σ i τ i 2 1 2 λ i σ i τ i 2 2 α i σ i τ i 2 1 2 8a b q i ω 2 ρ i e q κ i g i λ i λ i q i ω 2 ρ i e q κ i g i λ i λ i 9a c σ i ρ i e q ω 2 e i τ i ρ i e q ω 2 κ i g i α i ρ i e q a i ω 2 e i i i the longitudinal and torsional vibration equations of each immersed blade can be written as chang and liu 1989 wu and chen 2001 2005 xiang et al 2012 zhang et al 2014b 10a e i a i 2 u i x i t x i 2 ρ i e q a i 2 u i x i t t 2 0 10b g i j i 2 θ i x i t x i 2 ρ i e q j i 2 θ i x i t t 2 0 where u i x i t and θ i x i t are the axial displacement and torsion angle of blade i at position x i and time t j i denotes the polar moment of inertia the solutions of eq 10 can be assumed as 11a b u i x i t u i x i e i ω t θ i x i t θ i x i e i ω t substituting eq 11 into eq 10 the mode shape functions u i x i and θ i x i can be further expressed as 12a b u i x i cos μ i x i sin μ i x i d i θ i x i cos γ i x i sin γ i x i h i where d i and h i are the constants associated with the boundary conditions of the blade i and they can be given by 13a b d i d 1 i d 2 i t h i h 1 i h 2 i t 14a b μ i ρ i e q e i ω 2 γ i ρ i e q g i ω 2 2 2 general formulations of the three span shaft with bearings supporting the section 2 1 gives the motion equations and corresponding solutions of the transverse longitudinal and torsional vibrations of immersed blades b 1 b 2 b 3 b 4 in fig 1 it s worth noting that the solution process for the three span shaft b 0 1 b 0 2 b 0 3 is similar as that for blades and the variables use the superscripts to denote the serial number of segments of the shaft since the shaft is supported by a series of bearings the shaft is subdivided into three segments by two stern bearings in this paper each segment can be simplified as uniform beam and two sets of translational springs are used to simulate the stiffness of bearing as shown in fig 2 firstly the force equilibrium conditions and the deflection compatibility conditions of transverse vibration across the j t h j 1 2 stern spring supporting point can be expressed as 15 y 0 j 1 0 y 0 j l 0 j φ 0 j 1 0 φ 0 j l 0 j e 0 j 1 i 0 j 1 d φ 0 j 1 0 d x 0 i 1 e 0 j i 0 j d φ 0 j l 0 j d x 0 i κ 0 j 1 g 0 j 1 a 0 j 1 φ 0 j 1 0 d y 0 j 1 0 d x 0 j 1 k 0 j y 0 j 1 0 κ 0 j g 0 j a 0 j φ 0 j l 0 j d y 0 j l 0 j d x 0 j substituting the solution of y 0 j x 0 j and φ 0 j x 0 j into eq 15 and writing in matrix form leads to the following formula 16 t j 1 c 0 j 1 t j c 0 j where 17a b c 0 j 1 c 01 j 1 c 02 j 1 c 03 j 1 c 04 j 1 t c 0 j c 01 j c 02 j c 03 j c 04 j t 18 t j 1 1 0 1 0 0 q 0 j 1 0 q 0 j 1 q 0 j 1 λ 0 j 1 0 q 0 j 1 λ 0 j 1 0 k 0 j q 0 j 1 λ 0 j 1 k 0 j q 0 j 1 λ 0 j 1 19 t j cosh λ 0 j l 0 j sinh λ 0 j l 0 j cos λ 0 j l 0 j sin λ 0 j l 0 j q 0 j sinh λ 0 j l 0 j q 0 j cosh λ 0 j l 0 j q 0 j sin λ 0 j l 0 j q 0 j cos λ 0 j l 0 j ε 1 j cosh λ 0 j l 0 j ε 1 j sinh λ 0 j l 0 j ε 2 j cos λ 0 j l 0 j ε 2 j sin λ 0 j l 0 j ε 3 j sinh λ 0 j l 0 j ε 3 j cosh λ 0 j l 0 j ε 4 j sin λ 0 j l 0 j ε 4 j cos λ 0 j l 0 j and 20a d ε 1 j e i j q 0 j λ 0 j ε 2 j e i j q 0 j λ 0 j ε 3 j k g a j q 0 j λ 0 j ε 4 j k g a j q 0 j λ 0 j 21a c e i j e 0 j i 0 j e 0 j 1 i 0 j 1 k g a j κ 0 j g 0 j a 0 j κ 0 j 1 g 0 j 1 a 0 j 1 k 0 j k 0 j κ 0 j 1 g 0 j 1 a 0 j 1 then the compatibility conditions of longitudinal and torsional vibration across the j t h stern spring supporting point can be expressed as 22a u 0 j 1 0 u 0 j l 0 j a 0 j 1 e 0 j 1 u 0 j 1 0 x 0 j 1 a 0 j e 0 j u 0 j l 0 j x 0 j 22b θ 0 j 1 0 θ 0 j l 0 j g 0 j 1 j 0 j 1 θ 0 j 1 0 x 0 j 1 g 0 j j 0 j θ 0 j l 0 j x 0 j substituting the solution of u 0 j x 0 j and θ 0 j x 0 j into eq 22 and writing in matrix form leads to the following formula 23a b z j 1 d 0 j 1 z j d 0 j n j 1 h 0 j 1 n j h 0 j where 24a b z j 1 1 0 0 a 0 j 1 e 0 j 1 μ 0 j 1 z j cos μ 0 j l 0 j sin μ 0 j l 0 j a 0 j e 0 j μ 0 j sin μ 0 j l 0 j a 0 j e 0 j μ 0 j cos μ 0 j l 0 j and 25a b n j 1 1 0 0 g 0 j 1 j 0 j 1 γ 0 j 1 n j cos γ 0 j l 0 j sin γ 0 j l 0 j g 0 j j 0 j γ 0 j sin γ 0 j l 0 j g 0 j j 0 j γ 0 j cos γ 0 j l 0 j it is clearly found that the constants in the j 1 t h segment are related with those in j t h segment according to eq 16 and eq 23 the constants in the third segment can be easily reconstructed by that of first segment 26a c c 0 3 w 3 w 2 c 0 1 d 0 3 s 3 s 2 d 0 1 h 0 3 m 3 m 2 h 0 1 where 27a c w j t j 1 t j 1 s j z j 1 z j 1 m j n j 1 n j 1 j 3 2 2 3 boundary conditions of the propeller shafting system the vibration of blades and shafting with classical boundary conditions free end and complicated boundary conditions such as elastic support lumped mass rotational inertial boundary or any combination of them can be readily investigated in present work fig 3 a plots the schematic figure of the interaction of blade b 1 and shafting in x z plane of the global coordinate system and other blades have the same connection type since the interactions between the blades and shafting are considered their vibrations are coupled the blades and shaft are all spatial structure each of them has two direction transverse vibration longitudinal vibration and torsional vibration the variables y i u x i and φ i u x i are respectively the mode shape functions with respect to y i u x i t and φ i u x i t which denote the bending responses of blade i along the global coordinate direction u x y z and i i u x i is the corresponding moment inertia of the cross section about the neutral axis in general the corresponding variable of the j t h segment of shafting can be represented by v a 0 u j x 0 j t and v a 0 j x 0 j t it is known that the bending moment and shear force have the following relation to bending slope φ i u x i and deflection y i u x i 28 m i u x i e i i i u φ i u x i v i u x i κ i g i a i φ i u x i y i u x i the blade i 1 3 has a free end and an elastic connection end so the boundary and compatibility conditions including shear force bending moment and axial force can be expressed as 29 κ i g i a i φ i x 0 y i x 0 0 κ i g i a i φ i x l i y i x l i k i x y i x l i u 0 1 0 30 e i i i x φ i x 0 0 e i i i x φ i x l i k r i y φ i x l i φ 0 z 1 0 31 κ i g i a i φ i y 0 y i y 0 0 κ i g i a i φ i y l i y i y l i k i y y i y l i y 0 y 1 0 32 e i i i y φ i y 0 0 e i i i y φ i y l i k r i x φ i y l i φ 0 1 0 33 u i 0 0 a i e i u i l i k i z u i l i y 0 z 1 0 it s worth noting that the subscripts x y z in eqs 29 33 should be replaced as x z y when i 3 similarly the boundary and compatibility conditions of blade i 2 4 can be expressed as 34 κ i g i a i φ i x 0 y i x 0 k i x y i x 0 u 0 1 0 κ i g i a i φ i x l i y i x l i 0 35 e i i i x φ i x 0 k r i y φ i x 0 φ 0 z 1 0 e i i i x φ i x l i 0 36 κ i g i a i φ i y 0 y i y 0 k i y y i y 0 y 0 y 1 0 κ i g i a i φ i y l i y i y l i 0 37 e i i i y φ i y 0 k r i x φ i y 0 φ 0 1 0 e i i i y φ i y l i 0 38 a i e i u i 0 k i z u i 0 y 0 z 1 0 u i l i 0 also the subscripts in eqs 34 38 x y z should be replaced as x z y when i 4 considering the equilibrium conditions of the axial force torsional shear stress shear force and bending moment at the ends of shaft the boundary and compatibility conditions of the non uniform three span shaft can be expressed as 39 a 0 1 e 0 u 0 1 0 t 1 4 k t x m ω 2 u 0 1 0 i 1 3 k i x y i x l i j 2 4 k j x y j x 0 40 g 0 j 0 1 θ 0 1 0 i 1 3 k r i x j 2 4 k r j x j x ω 2 θ 0 1 0 i 1 3 k r i x φ i y l i j 2 4 k r j x φ j z 0 41 v 0 y 1 0 i 1 2 3 4 k i y m ω 2 y 0 y 1 0 k 1 y y 1 y l 1 k 2 y y 2 y 0 k 3 y u 3 l 3 k 4 y u 4 0 42 m 0 y 1 0 i 1 2 3 4 k r i z j z ω 2 φ 0 y 1 0 k r 3 z φ 3 x l 3 k r 4 z φ 4 x 0 43 v 0 z 1 0 i 1 2 3 4 k i z m ω 2 y 0 z 1 0 k 1 z u 1 l 1 k 2 z u 2 0 k 3 z y 3 z l 3 k 4 z y 4 z 0 44 m 0 z 1 0 i 1 2 3 4 k r i y j y ω 2 φ 0 z 1 0 k r 1 y φ 1 x l 1 k r 2 y φ 2 x 0 45 a 0 3 e 0 u 0 3 l 0 3 k 0 x u 0 3 l 0 3 θ 0 3 l 0 3 0 46 v 0 y 3 l 0 3 k 0 y y 0 y 3 l 0 3 m 0 y 3 l 0 3 0 47 v 0 z 3 l 0 3 k 0 z y 0 z 3 l 0 3 m 0 z 3 l 0 3 0 combing eqs 29 47 and the transfer relation in eq 26 and then substituting eq 5 and eq 12 into them the following matrix form can be obtained 48 p r o 1 p r o 2 p r o 3 p r o 4 s a t t c o e 0 52 1 p r o 1 p r o 2 p r o 3 p r o 4 s a t are given in appendix a which are only associated with the boundary conditions of the propeller and shafting 49 c o e c 0 y 1 c 0 z 1 d 0 1 h 0 1 c 1 x c 1 y d 1 c 4 x c 4 z d 4 t it is noted that only c o e is unknown so the existence of non trivial solutions in eq 48 requires the determinant of the matrix on the left side is equal to zero 50 det p r o 1 p r o 2 p r o 3 p r o 4 s a t t 0 a single equation for the solution of the natural angular frequency ω of system is provided by the above equation which can be solved by the false position method once the frequency parameters have been determined the c o e can be easily obtained by solving eq 48 using the transfer relation in eq 26 the integration constants in segments b 0 2 and b 0 3 can be obtained consequently the mode shape functions of propeller shafting system are derived the forced vibration response of the system can also be developed based on the above method when the external force f i x f acts at the position x f of the blade i the shear force equilibrium condition can be written as 51 κ i g i a i φ i x f y i x f f i x f 52 p r o 1 p r o 2 p r o 3 p r o 4 s a t t c o e 0 f i 0 t and the right side of eq 48 will be replaced by 0 f i 0 t assuming that the external load is harmonic so that directly solving eq 52 and using transfer matrix can lead to the integration constants of the system under certain frequency excitation the frequency response of propeller shafting can be further obtained 3 random vibration analysis of propeller shafting system 3 1 unsteady force spectrum loadings at the propeller the correlation method jiang et al 1991 is adopted in this paper to obtain the propeller broadband force generated by turbulence it is a direct approach and the explicit auto power and cross power spectrum matrix can be easily obtained which is essential for the subsequent random vibration analysis of the propeller shafting system the derivations of the frequency spectrum of propeller thrust using the correlation approach are briefly discussed based on the strip theory and the velocity correlation incorporating propeller rotational effects anderson et al 2014 the blade is divided into a number of strip elements along its radius as shown in fig 4 to calculate the characteristics of the fluctuating force over the blade surfaces the following equations use the subscripts to denote the direction along the coordinate axes while superscripts are used to denote the blade element involved for example l u v γ χ t τ denotes the hydrodynamic force acting on the γ t h element in the direction u at the instant of time t caused by a velocity fluctuation of unit magnitude in the direction v of the χ t h element with velocity u v χ at the instant τ under this convention the hydrodynamic force acting on the γ t h element at time t in the direction u f u γ t due to the influence of velocity fluctuation at all elements and in all the direction over all time τ can be expressed as 53 f u γ t t l u v γ χ t τ u v χ τ d τ where u v x y z γ χ 1 2 n as f u γ t is a random function of time in a turbulent flow a statistical approach must be employed in this paper assuming the inflow turbulence is time invariant so the correlation function of unsteady forces φ u v γ χ between the γ t h element in the direction u due to the χ t h element in the direction v becomes 54 φ u v γ χ τ e f u γ t f v χ t τ lim t 1 t 0 t 0 0 l u k γ α τ 1 l v m χ δ τ 2 u k α t τ 1 u m δ t τ τ 2 d τ 1 d τ 2 d t 0 0 l u k γ α τ 1 l v m χ δ τ 2 r k m α δ t τ τ 2 d τ 1 d τ 2 where r k m α δ is the velocity correlation function between different fluid particles in the turbulence 55 r k m α δ t τ τ 2 lim t 1 t 0 t u k α t τ 1 u m δ t τ τ 2 d t the corresponding frequency spectrum of the correlated force fluctuations can be obtained by using the fourier transform of the above correlation function 56 ψ u v γ χ ω φ u v γ χ τ e i ω τ d τ 0 0 l u k γ α τ 1 d τ 1 l v m χ δ τ 2 d τ 2 r k m α δ t τ τ 2 d τ h u k γ α ω h v m χ δ ω g k m α δ ω where h u k γ α ω is the hydrodynamic frequency response function and g k m α δ ω is the fourier transform of the velocity correlation function r k m α δ in this paper the turbulent inflow to be modeled is a spatially homogeneous turbulent flow where two point velocity correlations are invariant with translations in position by assuming the flow field is divergence free and exponentially decays normalized stream wise the velocity correlation function can be written as hinze 1959 57 r u v u 2 1 2 r λ r u r v 1 r 2 λ δ u v e r τ λ where λ is the integral length scale of turbulence assuming blades rotating in a turbulent field with rotational speed ω r τ the instantaneous instance between two inflow fluid particles that will flow to the γ t h and χ t h strip element 58 r τ d x 2 r γ 2 r χ 2 2 r γ r χ θ γ 0 θ χ 0 ω τ where r γ and r χ is the location of γ t h and χ t h strip in radius θ γ 0 and θ χ 0 is the initial angle of two blade strips 3 2 random vibration response the random response induced by inflow turbulence is computed by a two stepped method fig 5 gives the computational procedure in the first step an analytical method is presented to obtain the frequency response function of propeller shafting system considering the entrained fluid in the second step the strip theory and correlation method is used to compute the unsteady thrust spectrum for the blades strip elements finally the random response can be obtained by the thrust spectrum matrix and frequency response function vector when the velocity correlation functions r k m α δ obtained by eq 57 and the unsteady forces l u v γ χ due to inflow turbulence have been computed the correlation force spectrum of all strips on blade is determined according to eq 56 if all blades are divided into n strips the force spectrum of all strip elements can be written as a n n matrix each diagonal element is auto power spectrum of the corresponding strip while others are cross power spectrum between different strips 59 ψ n n 11 ω ψ n n 12 ω ψ n n 1 n ω ψ n n 21 ω ψ n n 22 ω ψ n n 2 n ω ψ n n γ χ ω ψ n n n 1 ω ψ n n n 2 ω ψ n n n n ω since the propeller shafting system in this paper is a linear system the random response at any position p can be obtained by the following equation 60 r s p ω γ 1 n f n γ ω h n γ p ω where f n γ ω is the frequency spectrum of fluctuating force at the γ t h strip in the direction of law obtained by the fourier transform of f n γ t h n γ p ω is the frequency response at position p under the unit magnitude harmonic force acting at the γ t h strip along the normal the auto power spectrum of the corresponding random response at position p is further obtained by 61 r s p r s p γ 1 n f n γ ω h n γ p ω γ 1 n f n γ ω h n γ p ω f n 1 ω f n 1 ω h n 1 p ω h n 1 p ω f n n ω f n n ω h n n p ω h n n p ω ψ n n 11 ω h n 1 p ω h n 1 p ω ψ n n n n ω h n n p ω h n n p ω each element in the matrix of eq 59 defines the multiplier of each item in eq 61 the cross power spectrum of random response at any two different positions can also be further computed similarly 4 numerical results and discussions 4 1 model verification to validate the accuracy and reliability of the present method a matlab code based on the proposed model is developed a propeller shafting system with four blades and three span shaft is chosen as the computational model shown in fig 1 the length and diameter of all spans of shaft are l 0 1 0 3 m l 0 2 5 m l 0 3 10 m d 0 1 0 4 m d 0 2 0 36 m d 0 3 0 32 m and the material properties of shaft are defined as e s 2 1 e 11 pa υ s 0 3 ρ s 7500 kg m 3 the geometrical parameters of blade are b 0 07 m h 0 3 m l 1 l 2 l 3 l 4 1 6 m and the material properties of propeller are e p 4 2 e 11 pa υ p 0 32 ρ p 8900 kg m 3 besides the fluid density is ρ f 1000 kg m 3 the shear correction factors of shaft and blade are respectively κ s 0 9 and κ p 5 6 in analysis for the propeller hub and bearings two cases of physical parameters are available in table 1 a comparison of natural frequencies of the system using proposed method and fem is shown in table 2 meanwhile the corresponding mode shapes of propeller shafting system using present method and fem for the case1 are also shown in fig 6 a f excellent agreements can be observed between the obtained results and those from fem which means the proposed method is accurate to predict free vibration of the propeller shafting system 4 2 influence of system elasticity subsequently the influence of the system elasticity on vibration characteristics is studied by changing the elastic parameters of propeller blades and bearings firstly three different elastic modulus of blade material are taken into consideration and the first ten mode frequencies and some typical mode shapes are compared in fig 7 the first two modes are the transverse bending mode of shafting in two different planes which are not affected by the modulus of blade when the modulus decreases to 4 2e10pa the pure bending mode of blade can be seen in the first ten order which means vibration behaviors of propeller itself will be enlarged if the external force acts on the blade although the natural frequency of the longitudinal mode of propeller shafting system has no relation to blade modulus its mode shape will be significantly changed by the blade elasticity as the increase of modulus the elastic deformation of blade gradually attenuates until it can be considered as rigid body based on the method proposed in section 3 2 the auto power spectrums of unsteady force transmitted by bearings are obtained and shown in fig 8 the inflow velocity u w is equal to 4 63 m s and the rotating speed of propeller ω is 1 9r s the turbulence level is about 3 with integral length scale λ being about 4 cm the longitudinal transverse force spectrums transmitted by the thrust bearing are plotted in fig 8 a it can be found that the elasticity of system has great impact on the auto power spectrums of transmitted force an important phenomenon is that the longitudinal force transmission spectrum has resonance peaks not only at each longitudinal mode of shafting f s i i 1 2 3 but also at the bending mode of blade f b j j 1 2 since the fluctuating force of propeller decreases in high frequency range the value of resonance peaks gradually attenuates at higher longitudinal and bending mode frequency the transverse force transmission spectrum has more resonance peaks compared with that of the longitudinal force spectrum in the frequency range lower than the second order of bending mode of shafting f t 2 longitudinal force spectrum is larger than that of transverse spectrum obviously while in the middle frequency range of f t 3 f s 2 considerable bending modes of shafting can be observed in transverse force spectrum when the external excitation frequency is higher than f s 2 the value of resonance peaks of transverse force spectrum gradually decreases for the energy attenuation and elastic filtering effect the transverse force spectrums transmitted by different bearings are plotted and compared in fig 8 b the resonance peaks of force spectrums can be seen not only at the bending mode frequency of shafting but also the propeller blade in the frequency range lower than f t 2 the magnitude of force spectrum transmitted by the back stern bearing is larger than that of the other two when the frequency is higher than f t 4 the resonance peaks at thrust bearing and front stern bearing are almost same and the peaks of force spectrum at back stern bearing attenuate greatly for the filtering effect of the elastic shafting with increase of frequency as the shorter length of wave and the dispersion effect of the elastic wave the difference between the peaks of force spectrums transmitted by different bearings becomes smaller and their magnitude gradually attenuates secondly the auto power spectrums of unsteady force transmitted by bearings are analyzed with blade elasticity modulus changed and compared in fig 9 a and fig 10 the elasticity of blade can affect the distribution of longitudinal force spectrum and the magnitude of transverse force spectrum the peaks at the two order bending modes f b 1 and f b 2 of blade can be observed within 250hz and the distinctive valley exists between these two resonance peaks in fig 9 a the resonance peaks at the same order of blade bending mode gradually attenuate with the increase of blade modulus as can be seen that the resonance peaks induced by blade bending modes become smaller in higher order for the same modulus this fact should be attributed to the lower frequency range with higher excitation energy in fig 10 the auto power spectrums of transverse force transmitted by the two stern bearings have almost the similar characteristics when the blade modulus changes in the frequency range lower than f 1 the force spectrum of the softest blade is bigger than that of the other two and the amplification effect can be seen at the resonance peaks more obviously when the modulus equals the normal value 4 2e11pa the magnitude of transmitted force spectrum is higher than that of the other two cases in the frequency range of f 1 f 2 while the frequency is higher than f 2 the corresponding magnitude becomes the lowest one the force transmission spectrum of the hardest blade is much bigger when the frequency higher than f 3 compared with the longitudinal response distinctive characteristics of the transverse response reveal in different frequency range the distribution of transverse force spectrum transmitted by the stern bearings is mainly controlled by the bending modes of shafting and the blade elasticity has effect on the magnitude similarly the variations of longitudinal force spectrum transmitted by the thrust bearing with different stiffness values of thrust bearing are shown in fig 9 b with the increase of thrust bearing stiffness the shape of force transmission spectrum curves only has slight difference and the peaks induced by longitudinal mode of shafting shift to right blade bending mode frequency has no relation to the bearing stiffness while smaller stiffness leads to lower magnitude of resonance peaks fig 9 b also illustrates that reducing the stiffness of thrust bearing can attenuate the longitudinal transmission force consistently in the whole frequency domain the influence of the stern bearing stiffness on the transverse force transmitted by the two stern bearings is studied and the results are shown in fig 11 when the frequency is lower than f 1 the smaller the bearing stiffness the bigger the force transmission spectrum amplitude is while reducing the stiffness of stern bearing can attenuate the transverse force transmission consistently when the frequency is higher than f 2 however in the frequency range of f 1 f 2 bigger and smaller stiffness both can attenuate the force transmission spectrum therefore the stern spring stiffness should be properly designed according to the low vibration and noise requirements in different frequency range 5 conclusions based on the analytical model of propeller shafting system built with the timoshenko beam theory the random vibration and force transmission characteristics of an elastic propeller shafting system induced by inflow turbulence are studied it is found that the elasticity of propeller blade cannot be ignored for the practical propeller because the blade bending modes can amplify both the longitudinal force transmission at the thrust bearing and the transverse force transmission at the radial bearings lower elasticity modulus of propeller may lead to larger longitudinal responses while distinctive amplification characteristics of the transverse response can be exhibited in different frequency band the magnitude of the longitudinal force transmitted by thrust bearing is much larger than the transverse response when the frequency is lower than the second order bending mode frequency of shafting however the transverse response has more resonance peaks moreover the results reveal that the reduction of the thrust bearing stiffness can attenuate longitudinal force transmission in the whole frequency domain while the effects of stern bearing stiffness on transverse force spectrum are inconsistent in different frequency ranges aiming to obtain the fluctuating force characteristics transmitted from bearings to hull this paper investigated only the random vibration of propeller shafting system induced by the inflow turbulence where the elastic boundary of the shafting is treated to be rigid in order to simplify the analysis in the future work the model of the flexible marine hull should be included and the propeller shafting hull system should be developed for the prediction of the noise radiation of marine induced by turbulence appendix a the details of eq 48 a 1 p r o 1 0 1 4 0 1 4 p d 0 1 0 1 2 p c 1 x 0 1 4 0 1 2 0 1 30 0 1 4 p w c 0 z 1 0 1 2 0 1 2 p w c 1 x 0 1 4 0 1 2 0 1 30 0 2 4 0 2 4 0 2 2 0 2 2 b 1 x 0 2 4 0 2 2 0 2 30 p c 0 y 1 0 1 4 0 1 2 0 1 2 0 1 4 p c 1 y 0 1 2 0 1 30 0 1 4 0 1 4 0 1 2 p w h 0 1 0 1 4 p w c 1 y 0 1 2 0 1 30 0 2 4 0 2 4 0 2 2 0 2 2 0 2 4 b 1 y 0 2 2 0 2 30 0 1 4 p c 0 z 1 0 1 2 0 1 2 0 1 4 0 1 4 p d 1 0 2 30 0 1 4 0 1 4 0 1 2 0 1 2 0 1 4 0 1 4 f z 1 0 1 30 a 2 p r o 2 0 1 4 0 1 4 p d 0 2 0 1 2 0 1 10 p c 2 x 0 1 4 0 1 2 0 1 20 0 1 4 p w c 0 z 2 0 1 2 0 1 2 0 1 10 p w c 2 x 0 1 4 0 1 4 0 1 20 0 2 4 0 2 4 0 2 2 0 2 2 0 2 10 b 2 x 0 2 4 0 2 2 0 2 20 p c 0 y 2 0 1 4 0 1 2 0 1 2 0 1 10 0 1 4 p c 2 y 0 1 2 0 1 20 0 1 4 0 1 4 0 1 2 p w h 0 2 0 1 10 0 1 4 p w c 2 y 0 1 2 0 1 20 0 2 4 0 2 4 0 2 2 0 2 2 0 2 10 0 2 4 b 2 y 0 2 2 0 2 20 0 1 4 p c 0 z 2 0 1 2 0 1 2 0 1 10 0 1 4 0 1 4 p d 2 0 1 20 0 1 4 0 1 4 0 1 2 0 1 2 0 1 10 0 1 4 0 1 4 f z 2 0 1 20 a 3 p r o 3 0 1 4 0 1 4 p d 0 3 0 1 2 0 1 20 p c 3 x 0 1 4 0 1 2 0 1 10 p w c 0 y 3 0 1 4 0 1 2 0 1 2 0 1 20 p w c 3 x 0 1 4 0 1 4 0 1 10 0 2 4 0 2 4 0 2 2 0 2 2 0 2 20 b 3 x 0 2 4 0 2 2 0 2 10 0 1 4 p c 0 z 3 0 1 2 0 1 2 0 1 20 0 1 4 p c 3 z 0 1 2 0 1 10 0 1 4 0 1 4 0 1 2 p w h 0 3 0 1 20 0 1 4 p w c 3 z 0 1 2 0 1 10 0 2 4 0 2 4 0 2 2 0 2 2 0 2 20 0 2 4 b 3 z 0 2 2 0 2 10 p c 0 y 3 0 1 4 0 1 2 0 1 2 0 1 20 0 1 4 0 1 4 p d 3 0 1 10 0 1 4 0 1 4 0 1 2 0 1 2 0 1 20 0 1 4 0 1 4 f z 3 0 1 10 a 4 p r o 4 0 1 4 0 1 4 p d 0 4 0 1 2 0 1 30 p c 4 x 0 1 4 0 1 2 p w c 0 y 4 0 1 4 0 1 2 0 1 2 0 1 30 p w c 4 x 0 1 4 0 1 2 0 2 4 0 2 4 0 2 2 0 2 2 0 2 30 b 4 x 0 2 4 0 2 2 0 1 4 p c 0 z 4 0 1 2 0 1 2 0 1 30 0 1 4 p c 4 z 0 1 2 0 1 4 0 1 4 0 1 2 p w h 0 4 0 1 30 0 1 4 p w c 4 z 0 1 2 0 2 4 0 2 4 0 2 2 0 2 2 0 2 30 0 2 4 b 4 z 0 2 2 p c 0 y 4 0 1 4 0 1 2 0 1 2 0 1 30 0 1 4 0 1 4 p d 4 0 1 4 0 1 4 0 1 2 0 1 2 0 1 30 0 1 4 0 1 4 f z 4 a 5 s a t 0 1 4 0 1 4 s d 0 0 1 2 s c 1 x 0 1 4 0 1 2 s c 3 x 0 1 4 0 1 2 0 1 4 0 1 4 g u z 0 0 1 2 0 1 4 0 1 4 0 1 2 0 1 4 0 1 4 0 1 2 0 1 4 0 1 4 0 1 2 s n h 0 0 1 4 s n c 1 y 0 1 2 0 1 4 s n c 3 z 0 1 2 0 1 4 0 1 4 0 1 2 s n g 0 0 1 4 0 1 4 0 1 2 0 1 4 0 1 4 0 1 2 s c 0 y 0 1 4 0 1 2 0 1 2 0 1 4 s c 1 y 0 1 2 0 1 4 0 1 4 s d 3 v s w c 0 y 0 1 4 0 1 2 0 1 2 0 1 4 0 1 4 0 1 2 s w c 3 x 0 1 4 0 1 2 b 0 y 0 2 4 0 2 2 0 2 2 0 2 4 0 2 4 0 2 2 0 2 4 0 2 4 0 2 2 0 1 4 s c 0 z 0 1 2 0 1 2 0 1 4 0 1 4 s d 1 0 1 4 s c 3 z 0 1 2 0 1 4 s w c 0 z 0 1 2 0 1 2 s w c 1 x 0 1 4 0 1 2 0 1 4 0 1 4 0 1 2 0 2 4 b 0 z 0 2 2 0 2 2 0 2 4 0 2 4 0 2 2 0 2 4 0 2 4 0 2 2 
22584,many estuaries present natural harbor conditions with relatively calm and shallow waters that provide a connection between the ocean and continental waterways the increase in the demand for goods by the constant growing of the world population has forced estuaries to be altered by human activities such as dredging in order to maintain a safe navigation system the development of sophisticated morphological and hydrodynamic models opened a new perspective of assisting dredging operations inside different estuaries thus the aim of this study is to apply a hydromorphodynamic model to simulate the bed evolution of the patos lagoon estuary southern brazil the results of the simulation were applied in a dredge operation model to simulate dredging inside the waterway of the rio grande harbor located inside the patos lagoon estuary the salinity and current velocities inside the estuary were well represented by the model simulations an annual mean discharge of 3 407 ms3 s 1 was calculated for the lagoon for the year 2004 the morphodynamic model successfully represented the silted and eroded scenarios for the estuarine channel the dredge operation model results affirm that dredging of the channel causes significant variations in estuarine physical parameters such as salinity current velocity and suspended sediment concentration the bed evolution results indicate that a fast siltation of the channel occurs right after dredging stops stabilizing the variations after a 60 day period keywords dredging hydromorphodynamic bed evolution sediment transport numerical modeling estuary 1 introduction estuaries receive sediments from the ocean via waves and currents and from upland rivers via river discharge an upstream decrease in salinity leads to up estuary directed flow near bed and a down estuary flow on the surface dyer 1995 combined with near bed high concentration of sediments this process generates an up estuary sediment transport that characterizes a sensible balance when this balance is disturbed it can lead to siltation and or erosion of estuarine channels and sand banks since many estuaries are hosting larger harbors and receiving larger vessels dredging became a common activity in order to maintain a safe navigation system hence deepening and widening of estuarine channels can increase the up estuary sediment transport and sediment concentrations resulting in channel siltation van maren et al 2015 likewise some estuaries present a river discharge dominant force and fine sediments can reach the estuarine region transported as suspended load until they silt at the estuary channel or adjacent sand banks in shallow areas of the estuary modeling of sediment transport and bed evolution of coastal environments especially estuaries is a difficult challenge mainly because of the various different scale processes that need to be considered putzar and malcherek 2014 with the improvement of morphological models and the advance of computational resources morphological modeling became a relevant alternative to understand the consequences of sediment transport in estuarine systems and the impacts of human activities on estuarine hydromorphodynamics liu et al 2002 moreover following the advance of the morphodynamic and hydrodynamic models dredging models started to be developed to complement the studies of sediment transport in dredged estuaries many studies of dredging impacts were already carried out in different environments in order to understand and mitigate the impacts of these activities in hydrodynamic and morphodynamic processes jeuken and wang 2010 analyzed the impact of dredging on the stability of the ebb flood channel system on the schelde estuary belgium maerker and malcherek 2010 developed the dredgesim model to represent dredging activities coupled with hydrodynamic and morphodynamic models such as telemac 3d and sisyphe monge ganuzas et al 2013 observed the morphodynamic consequences of dredging and dumping activities along the oka estuary spain van maren et al 2015 using a sediment transport model studied the impact of channel deepening on sediment concentrations on the ems estuary at the dutch german border all the mentioned studies found the same connection between dredging and dumping activities which is that maintenance of waterways has a great impact on suspended sediment concentrations sscs in the short term and on bed evolution in the long term perspective affecting natural hydromorphodynamic processes that influence the navigability of waterways and safety of structures thus the present study intends to model the estuary hydromorphodynamic to then apply a dredge operation model over the resulting bottom the results of nondredging and the dredged environment were compared in order to understand the effects of dredging on the estuary of the patos lagoon 2 the patos lagoon estuary the patos lagoon is located in the southernmost sector of brazil between 30 and 32 s and between 50 and 52 w and is connected to the atlantic ocean by a single channel less than 1 km wide marques et al 2009 according to kjerfve 1986 it is the largest choked coastal lagoon in the world having an approximate extent of 2500 km a mean width of 40 km and an area of 10 360 km 2 fig 1 the estuarine circulation is dominated by a bidirectional wind regime in a short term scenario and by river discharge over a long term scenario marques and moller 2008 marques et al 2010 applied a numerical model and estimated an annual mean discharge of 2088 m 3 s 1 granting the lagoon a dominant ebb condition and a discharge rate of total suspended matter of approximately 1 37 10 7 ton yr 1 the discharges are controlled by the pluviometric rates resulting in high river discharge inside the lagoon during late autumn and winter marques et al 2009 2010 as shown by fig 2 according to these authors this region presents a large interannual variability associated with el niño southern oscillation events the sedimentation pattern of the lagoon is composed of coarse fractions at the margins and regions with intense hydrodynamics according to toldo et al 2006 these authors also affirm that the fine sediments settle at less energetic regions and at the deeper parts of the lagoon the estuarine channel is mainly composed of a mixture of fine grains and the most frequent are silt more than 80 clay 15 and finer sand 5 calliari et al 2009 rio grande harbor the most southern harbor in the country maintains heavy traffic of large vessels daily on its waterway according to the agência nacional de transportes aquaviários antaq webportos labtrans ufsc br brasil movimentacao this harbor shipped 27 17 million tons of cargo during 2018 and this represents 7 25 of the total cargo shipped from brazilian ports in the same year the rio grande harbor connects the southern atlantic ocean to the capital of the rio grande do sul state porto alegre via patos lagoon it also represents an important connection between other brazilian ports and the ports of the la plata estuary argentina and uruguay möller jr et al 2001 verified that the adjacent tidal flats are mainly shallow less than 1 m with diurnal dominance and the estuarine channel depths vary from 9 to 22 m 3 modeling system the modeling procedure involves internally coupling three modules of the telemac mascaret system www opentelemac org the hydrodynamic model telemac 3d the morphodynamic model sisyphe and the dredge operation model nestor hence these modules are constantly exchanging information in order to correctly simulate the hydrodynamic forces that induce sediment transport and consequently the bed evolution over time nestor is applied to modify the bottom and to return the new bathymetry to the other two models so they can recalculate the variables and update the simulated environment telemac 3d was set up on a domain covering the patos lagoon and the coastal region between 30 05 s and 35 45 s and between 53 23 w and 47 38 w the computational domain contains 93 050 nodes with sizes varying from 10 to 20 m on important regions of the estuary to 10 km offshore fig 3a the time step used for the simulations was set to 90 s morphological and sedimentological data were set based on available resources therefore ssc boundary conditions for the rivers were forced by annual mean values of 0 069 0 091 and 0 145 kg m 3 for the guaíba and camaquã rivers and the são gonçalo channel respectively these data were obtained from the calculations presented by jung 2017 ssc data were prescribed at the liquid continental boundaries of the mesh fig 3a because there is a conflict between government and private agencies in providing updated bathymetry for scientific purposes a nautical chart s bathymetric data were interpolated in the mesh to represent the bottom the estuarine bottom is composed of a mixture of fine sediment classes therefore only two sediment classes were modeled in order to reduce the computational demand of the simulation because of the short time to perform this study the mean grain size diameter d 50 was set based on previous studies of sediment classification of the estuary antiqueira and calliari 2005 calliari et al 2009 according to these authors silt and clay are the most expressive sediment classes inside the estuarine channel based on the krumbein phi scale ϕ a d 50 of 62 5 μ m was set to represent silt and 3 9 μ m to represent clay in the sisyphe ssc boundary condition at the rivers these two sediment classes are initiated with 50 of the distribution the time step was set to 90 s as well the other boundary conditions were obtained from several sources for the period between 2003 and 2007 atmospheric pressure wind velocity and air temperature data were obtained from the ncep ncar reanalysis 1 project from the national oceanic and atmospheric administration noaa and prescribed over the surface of the computational mesh current velocity sea surface height salinity and temperature were obtained from the hycom hybrid coordinate ocean model and astronomical tides were obtained from otis osu tidal inversion software and prescribed at the oceanic boundaries river discharge data were obtained from the agência nacional de águas ana and prescribed at the liquid continental boundaries as daily discharges fig 3b 3 1 hydrodynamic model telemac 3d solves the navier stokes equations for geophysical fluids it considers variations on the free surface of the fluid and neglects density variations in the mass conservation equation to solve the motion equations in the three components of the cartesian plane it considers the boussinesq and hydrostatic pressure approximations it considers important forces that act on a geophysical fluid such as the coriolis force bed shear stress and the heat exchange between the fluid and the atmosphere hervouet 2007 3 2 morphodynamic model sisyphe computes the total load bed load suspended load of sediments and the bed evolution as a function of the hydrodynamic parameters issued by telemac 3d the cohesive sediment suspended load was computed using a concentration based approach that satisfies the depth average advection diffusion transport equation tassi and villaret 2014 van rijn 2007 bed load was not computed because of problems associated with coupling both types of transport together in the modeling system the bed evolution was computed using the exner equation which considers the changes in bottom elevation as a function of the sediment flow above the bed it assumes an equilibrium state in which alterations in the bed are linked to the sediment transport and flow interactions tassi and villaret 2014 riesterer et al 2016 3 3 dredge operation model the model nestor was developed to simulate dredging activities in river beds and waterways that face constant siltation due to sediment transport the module enables two different approaches to simulate dredging operations the first assumes a hindcast scenario where the dredging actions are defined by providing a specific time and amount of dredged material to model dredging actions in the past whereas in the second approach a certain criterion can be set so dredging actions start automatically when an elevated amount of sediment is detected within the waterway this second approach is used as a forecast simulation of dredging needs maerker and malcherek 2010 both approaches can be used to assist current dredging actions or to develop new strategies the dredging approach used herein is the hindcast form this approach also allows the evaluation of the effects of dredging on the hydrodynamic and morphodynamic regime nestor works with two kinds of files the first file uniquely serves the definition of dredging parameters such as time volume dig rate and computational settings the second file consists of the geographical definition of the operational areas where dredging takes place therefore polygons have to be defined within the waterway so the model can initiate dredging as shown in fig 4 4 study case the patos lagoon estuary the waterway of the rio grande harbor is established at the canal do norte as it is known as the natural channel formed by the estuary hydrodynamic the rio grande harbor is established at the east margin of the channel where a vast harbor complex represents shipyards containers docks and oil terminals fig 1b this waterway is constantly in need of maintenance dredging due the constant siltation by fine suspended sediment transported by the lagoon circulation through the estuary the source of these sediments is bidirectional transported seaward by the rivers and introduced into the estuary by the saline intrusion the rio grande harbor waterway has received maintenance dredging operations since the construction of the porto novo basin and the two jetties the sectors used to receive dredging are presented in fig 5 however based on the morphodynamic results new dredging sectors were delimited according to the positive bed evolution areas of the channel two of these sectors were dredged using a hindcast approach as mentioned previously and the changes in hydromorphodynamic variables were analyzed the configuration of the waterway is capable to receive two main design vessels container vessels and bulk carriers therefore the operational geometry of the waterway is set to have a depth of 18 m and a width of 258 m at the outer channel outside the estuary and a depth of 16 m and a width of 168 m at the inner channel inside the estuary inph sep 2015 5 model calibration the hydrodynamic model telemac 3d was calibrated based on in situ data salinity and current velocity were calibrated using conductivity and temperature ct and acoustic doppler current profiler adcp data collected by laboratório de oceanografia costeira e estuarina locoste furg at the praticagem station fig 1 the calibration period involves the year 2011 according to fig 6 the black dots represent the in situ data while the red and blue lines show the modeled salinity and current velocity data respectively fig 6 correctly represents the synoptic variations of salt intrusion inside the estuary as a function of the current velocities and direction in addition the positive values of current velocities represent flood conditions of the estuary and the negative values represent ebb conditions the time series of salinity range from zero to 40 psu and demonstrate that the modeled data are underestimated in relation to the in situ data however the average behavior of this variable follows the same trend in both situations confirming a good correlation between the data in the surface and bottom velocity the modeled data are also observed to follow the same behavior of the measured data in addition the model results showed underestimated values during some periods this behavior can be explained as a consequence of using the reanalysis data which can produce underestimated modeled results according to marques et al 2010 some authors also observed problems capturing the temporal and spatial variability using the reanalysis data for example simionato et al 2006 performed a wind analysis for the prata river region using reanalysis data and observed underestimations of high intensity events by up to 50 when compared to field data nevertheless the time series satisfactorily represent the trends of the signals measured the agreement between the time series of salinity and surface and bottom velocities was quantitatively evaluated using performance indicators the statistical results obtained by the telemac 3d and in situ data are presented in table 1 the metrics obtained from the modeled and measured data show that these are well adjusted the standard deviation results are similar in all situations highlighting the surface velocity where the data values are close it is possible to observe that salinity presented a high value of absolute error and rmse root mean square error reaching 8 2 psu and 10 7 psu respectively this can be explained by considering that salinity varies rapidly inside the estuary in a single day this is due the range that salinity can vary in a few hours from 0 to more than 30 psu in extreme flood events which combines winds and high discharge these results are similar to the values calculated by marques et al 2017 the statistics for current velocity show a low absolute error and rmse this indicates that the model is correctly representing the circulation pattern of the estuary the rmse values for surface and bottom velocities are 0 20 m s 1 and 0 195 m s 1 respectively these rmse values are similar to the values calculated by marques et al 2010 moreover free surface elevation inside the lagoon was validated at three sites ipanema arambaré and são lourenço station in this analysis the telemac data were compared with ana data for the year 2011 the time series are presented in fig 7 and the statistical results are presented in table 2 the time series of free surface elevation presented good adjustment between the telemac 3d and ana data in the three validated stations although there are gaps in water level data from ana in contrast a remarkable inconsistency is exhibited between the in situ data and the model estimations at some periods this can be explained by the use of reanalysis data as the meteorological forced parameters inside the modeling system reanalysis data are estimated in a fixed grid domain which is larger than the grid used in this numerical model simulation therefore the model estimation of the water level can oscillate up and down in the observed data this is remarkable when analyzing the peaks of the observed data in ipanema and arambaré stations between august and december on the other hand when analyzing the nonextreme values the model tends to be closer to the observed data the metrics calculated from the telemac 3d and ana data show that these are well adjusted highlighting the close standard deviation that resulted in all situations the absolute error and the rmse presented values up to 0 735 m and 0 8638 m respectively which are considered reasonable for this comparison from these findings it is possible to verify that the results of the telemac 3d model are reliable for the objectives of this study 6 results and discussion the patos lagoon estuary was numerically modeled over a period of 5 years 2003 2007 fig 8 shows the time series of the current velocity and salt intrusion at two distinct points inside the estuary and the resulting map of the bed evolution after the 5 year simulation these points are located on the positive bed evolution areas pnb and sp4 as shown in the map in fig 8 by the yellow rectangles salinity and current velocity were obtained at a depth of 10 m the pnb sector represents the porto novo basin and the sp4 represents the sector between the two jetties near the mouth of the estuary both areas present positive bed evolution after the period simulated by the morphodynamic model however they differ in hydrodynamic patterns since the pnb is located in a brackish water dominant region of the estuary while the sp4 sector is located inside the estuary inlet in a salt water dominant environment therefore it is expected that the sp4 sector presents higher salinity values than the pnb as well high current velocity intensity as shown in fig 8 the hydrodynamic model is shown to correctly represent the high ebb conditions of the estuary during the end of winter up to the beginning of summer when the high precipitation over interior lands fills up the rivers that discharge into the lagoon möller jr et al 2001 the intensity of the current velocity increases up to 1 m s 1 at the sp4 sector and antiqueira and calliari 2005 reported current velocities of approximately 1 3 and 1 5 m s 1 at the estuary inlet at the pnb sector velocities also increase but stay lower than 1 m s 1 therefore a longer hydrodynamic simulation more than 10 years would provide the interdecadal variations on the ebb patterns due el niño events that alter the lagoon and estuarine circulation marques and moller 2008 the high peaks of current velocity in late winter and early spring reflect the low salinity intrusion in the estuary for the same seasons this is explained by marques and moller 2008 when the authors affirmed that precipitation rates increase during winter conditioning the estuary to be ebb dominant the variability of the estuarine discharge is a consequence of the seasonal variations in river discharge inside the lagoon as shown in fig 2 this pattern is remarkably visible during the winter seasons of 2005 and 2006 fig 8 the opposite scenario is observed during the summer of 2005 when the highest peak of salinity conditioned by the lowest current velocities characterized a dry season for the patos lagoon estuary the current velocity time series fig 8 show how the velocities increase near the estuary inlet sp4 sector this is due to the geometry of the estuary that is narrower near the inlet according to antiqueira and calliari 2005 this is a high hydrodynamic region and therefore currents are stronger here making possible the settlement of coarser sediment particles while the finer silt and clay particles continue to be transported as seaward suspended load with these hydromorphodynamic results the year 2004 was chosen to be dredged and the sectors dredged were the sp4 and pnb the other silted sectors were not analyzed in this paper therefore the hindcast approach from the nestor model was applied the volume of 800 000 m 3 was dredged from the sp4 sector and at pnb the dredged volume was 260 000 m 3 these volumes are hypothetical we simply desired to excavate the bottom and reach the project depth quotas established by the inph sep 2015 in order to analyze the effects of dredging in the hydromorphodynamics of these sectors the established depth quotas for the rio grande harbor waterway are also presented in fig 5 the resulting bathymetry after dredging is presented in fig 9 both sectors were dredged during 30 days of june 2004 therefore the mean annual estuarine discharge calculated for 2004 was 3 407 m 3 s 1 with the maximum reached in july 9 850 m 3 s 1 the section considered here is at the mouth of the jetties with 9 159 5 m2 of area for comparison purposes marques et al 2010 found an estuarine discharge of 2 088 m 3 s 1 over a 606 day study during the year of 2006 herein the 2006 mean annual estuarine discharge calculated was 3 607 m 3 s 1 and the difference in the results for the same year can be associated with the time simulated which in this study was longer than the one simulated by marques et al 2010 dredging was performed using the nestor model and the 150 day simulation was run over a natural environment with no dredging these results were further compared with a 150 day simulation over a dredged bottom fig 10 compares the dredged and nondredged scenarios of both sectors of the approach channel the time series presented in fig 10 represent the 120 days after the dredge operation the other 30 days representing june were the days when dredging took place and are therefore not represented in the figure in the following section the behavior of environmental variables such as salinity current velocity ssc and the bottom variation of each sector are analyzed separately 6 1 sector sp4 inside the jetties in this scenario 800 000 m 3 were dredged from the sp4 sector this volume was capable of reaching the depth quota of 18 meters for this section of the channel the final bathymetry is shown in fig 9 after the end of dredging june 30 this sector presented a smooth increase of the mean current velocity 18 days after the end of the operation the decrease in salinity in the same period indicates that the estuary may be in an intense ebb condition increasing the velocities seaward and blocking the salt intrusion to enter the estuary however 60 days after the end of the dredging operation the mean current velocity kept the values below the time series of the nondredged bottom this indicates a reduction in the mean current velocities in this sector and this behavior was already pointed out by schiller et al 2006 the authors presented that dredging of this sector induces the reduction of the current velocities enabling sediments to settle therefore the results found by schiller et al 2006 endorse the results found in our simulations this reduction in velocities after dredging is also pointed out by jeuken and wang 2010 these authors visualized the reduction in current velocities by studying dredging and dumping impacts at the westerschelde estuary dating back to 1955 although the patos lagoon and the westerschelde estuary are different the relation between both estuaries and the dredging activities can be related this may indicate that dredging can equally reduce current velocity in estuaries with different patterns of circulation due deepening of the bottom this change in current velocity can explain the reduction in suspended silt and clay inside the sector after dredging these sediment particles are likely being deposited by the reduction in the mean current velocity which creates a less hydrodynamic environment enabling sediments to settle the suspended concentration of silt and clay tend to decrease in the water column 24 days after dredging operations finished as shown in fig 10 current velocities for the dredged scenario presented a maximum reduction of 93 24 in intensity and a mean reduction of 88 when compared with a nondredging scenario van maren et al 2015 pointed out that dredging affects the salinity induced density currents inside estuaries in addition deepening of channels can increase the residual flow due to enhancement in the salinity transport at tidal dominant estuaries in contrast the patos lagoon estuary behaves mainly as a river because high discharge events are dominant almost every day of the year therefore it was expected that this behavior of salinity would be different for the patos lagoon estuary however fig 10 shows that salinity inside the sp4 sector reduces immediately after the dredging operation of june and is associated with the next month july with high discharge of the estuary as already explained above on the other hand the salinity started to increase 30 days after the dredging operation ended and regarding small oscillations it stayed above the salinity of a nondredge scenario more investigations about this increase in salinity in a nontidal dominant estuary after dredge operations are needed to endorse these results no references for alterations due to dredging in salinity were found for a wind river discharge dominated estuary future studies should investigate the similarities between different estuary types and the impacts of dredging in salinity induced currents and salt intrusion dynamics regarding the evolution of the bottom the variation during the simulated period was calculated based on the bed evolution results from the morphodynamic model in fig 10 with no dredging the mean variation of the bottom at the sector sp4 was calculated to be 5 4 mm with dredging this variation increases to 90 74 with the value of 10 3 mm indicating that a dredged bottom suffers a more intense accretion of sediments than a nondredged scenario it is remarkable that until 60 days after the dredging operation the bottom had an intense positive increase and after this 60 day period the variations are smoother 6 2 sector pnb the porto novo basin salt intrusion in this sector was reduced after dredging due to the high ebb condition and just spikes again with the reduction on the lagoon discharge observed at the beginning of august however the sector presented a similar pattern to the sector sp4 where the salinity stayed above the nondredged scenario after 24 days of the dredging operation the lowest salinity presented between september and november can be associated with high estuarine discharge in addition as the pnb sector is farther upstream of the sp4 sector salinity levels here are lower again as in sector sp4 the salinity in a dredging scenario stayed above the salinity in a nondredged scenario fig 10 according to van maren et al 2015 the salinity induced flow is increased with deepening of estuarine channels but the author is referring to a tidal dominant estuary the patos lagoon estuary may present the same pattern but can surely vary this behavior between high ebb and flood scenarios throughout the year this similarity between the two different estuaries when analyzing dredging impacts on salinity needs to be carefully investigated in future studies current velocities presented a mean decrease of 23 3 with dredging operations this opens the possibility for sediments to settle contributing to the fast siltation observed during the 24 days following the end of the operations fig 10 the bathymetry of the basin without dredging was 10 28 m after dredging the quota of 10 50 m established by the inph sep 2015 was achieved and the final depth was 11 06 m the difference is approximately 0 77 m and the variation of the bottom presented a similar pattern to the sector sp4 with intense variation during 60 days after dredging after this period the bottom tends to present a smoother variation and incurs a smaller variation than the nondredged scenario in the middle of august 7 conclusions the 5 year results of the hydromorphodynamic simulation granted the following conclusions the estuarine annual mean discharges of the years 2004 and 2006 were calculated to be 3 407 m 3 s 1 and 3 607 m 3 s 1 respectively the estuarine channel presented 4 major positive bed evolution sectors indicating that the need of dredging in these areas is greater than the other regions of the approach channel to the rio grande harbor the water level validation procedure presented inconsistent results when comparing the modeled and collected data the model underestimated the peaks presented in the collected data however current velocity validation presented an absolute error of 0 203 and 0 158 m s 1 for surface and bottom velocities respectively this conveys the model s reliability to represent sediment transport with an acceptable modeled hydrodynamic of the estuary it is important to emphasize that these results should be interpreted carefully because they reflect the initial conditions forced on the model s domain these results do not represent the behavior of the estuarine channel hydrodynamics and morphodynamics under different environmental conditions such as water levels current velocities and wind regimes that differ from those established here the application of the dredge model nestor at two sectors of the channel of the rio grande harbor granted the following conclusions the bottom evolution after a dredging scenario is more intense than a nondredging scenario indicating a fast siltation of the dredged sectors until 60 days after the end of the operations this effect should be carefully analyzed when planning dredging operations at the patos lagoon estuary since depth quotas could not be achieved if this instant siltation of dredged sectors is not taken into account the dredging of the two sectors presented alterations in salinity current velocities and ssc in both sectors these results were calculated for the year 2004 a year that the estuary presented high ebb conditions because of high estuarine discharge we suggest a similar simulation should be performed for a drier year than 2004 with different dominant conditions the postdredging scenario indicates that a faster siltation of both sectors occurs but 2 months after the end of the operations the bottom tends to present a smoother variation the sp4 sector evolves faster than the pnb sector when dredging takes place this can be associated with the proximity of the sp4 sector to the ocean where the input of marine sediments and water are more pronounced the reduction in current velocity due dredging is remarkable the intensity of the mean current velocity in sector pnb reduced 23 3 after the dredging operation while at the sp4 sector the reduction was more pronounced with a value of 93 24 this study intends to encourage more scientific studies about the effects of dredging on estuarine channels in brazil and other developing countries the numerical modeling approach is a fine and well developed tool to assist dredge operations particularly where data are difficult to collect due environmental conditions or lack of funding acknowledgments the authors are greatful to the coordenação de aperfeiçoamento de pessoal de nível superior capes brazil for granting scholarships to the conselho nacional de desenvolvimento científico e tecnológico cnpq brazil by contract 304227 2016 1 to the fundação de amparo a pesquisa do estado do rio grande do sul fapergs by contract 17 2551 0001 159 7 and to the centro nacional de supercomputação cesup of the universidade federal do rio grande do sul ufrgs brazil which supported the development of this work the authors also thanks the ecmwf for the oceanographic and atmospheric data used to the consortium open telemac mascaret for providing the telemac system for free and to the laboratório nacional de computação científica lncc for the availability to use of the supercomputer dantos dumont 
22584,many estuaries present natural harbor conditions with relatively calm and shallow waters that provide a connection between the ocean and continental waterways the increase in the demand for goods by the constant growing of the world population has forced estuaries to be altered by human activities such as dredging in order to maintain a safe navigation system the development of sophisticated morphological and hydrodynamic models opened a new perspective of assisting dredging operations inside different estuaries thus the aim of this study is to apply a hydromorphodynamic model to simulate the bed evolution of the patos lagoon estuary southern brazil the results of the simulation were applied in a dredge operation model to simulate dredging inside the waterway of the rio grande harbor located inside the patos lagoon estuary the salinity and current velocities inside the estuary were well represented by the model simulations an annual mean discharge of 3 407 ms3 s 1 was calculated for the lagoon for the year 2004 the morphodynamic model successfully represented the silted and eroded scenarios for the estuarine channel the dredge operation model results affirm that dredging of the channel causes significant variations in estuarine physical parameters such as salinity current velocity and suspended sediment concentration the bed evolution results indicate that a fast siltation of the channel occurs right after dredging stops stabilizing the variations after a 60 day period keywords dredging hydromorphodynamic bed evolution sediment transport numerical modeling estuary 1 introduction estuaries receive sediments from the ocean via waves and currents and from upland rivers via river discharge an upstream decrease in salinity leads to up estuary directed flow near bed and a down estuary flow on the surface dyer 1995 combined with near bed high concentration of sediments this process generates an up estuary sediment transport that characterizes a sensible balance when this balance is disturbed it can lead to siltation and or erosion of estuarine channels and sand banks since many estuaries are hosting larger harbors and receiving larger vessels dredging became a common activity in order to maintain a safe navigation system hence deepening and widening of estuarine channels can increase the up estuary sediment transport and sediment concentrations resulting in channel siltation van maren et al 2015 likewise some estuaries present a river discharge dominant force and fine sediments can reach the estuarine region transported as suspended load until they silt at the estuary channel or adjacent sand banks in shallow areas of the estuary modeling of sediment transport and bed evolution of coastal environments especially estuaries is a difficult challenge mainly because of the various different scale processes that need to be considered putzar and malcherek 2014 with the improvement of morphological models and the advance of computational resources morphological modeling became a relevant alternative to understand the consequences of sediment transport in estuarine systems and the impacts of human activities on estuarine hydromorphodynamics liu et al 2002 moreover following the advance of the morphodynamic and hydrodynamic models dredging models started to be developed to complement the studies of sediment transport in dredged estuaries many studies of dredging impacts were already carried out in different environments in order to understand and mitigate the impacts of these activities in hydrodynamic and morphodynamic processes jeuken and wang 2010 analyzed the impact of dredging on the stability of the ebb flood channel system on the schelde estuary belgium maerker and malcherek 2010 developed the dredgesim model to represent dredging activities coupled with hydrodynamic and morphodynamic models such as telemac 3d and sisyphe monge ganuzas et al 2013 observed the morphodynamic consequences of dredging and dumping activities along the oka estuary spain van maren et al 2015 using a sediment transport model studied the impact of channel deepening on sediment concentrations on the ems estuary at the dutch german border all the mentioned studies found the same connection between dredging and dumping activities which is that maintenance of waterways has a great impact on suspended sediment concentrations sscs in the short term and on bed evolution in the long term perspective affecting natural hydromorphodynamic processes that influence the navigability of waterways and safety of structures thus the present study intends to model the estuary hydromorphodynamic to then apply a dredge operation model over the resulting bottom the results of nondredging and the dredged environment were compared in order to understand the effects of dredging on the estuary of the patos lagoon 2 the patos lagoon estuary the patos lagoon is located in the southernmost sector of brazil between 30 and 32 s and between 50 and 52 w and is connected to the atlantic ocean by a single channel less than 1 km wide marques et al 2009 according to kjerfve 1986 it is the largest choked coastal lagoon in the world having an approximate extent of 2500 km a mean width of 40 km and an area of 10 360 km 2 fig 1 the estuarine circulation is dominated by a bidirectional wind regime in a short term scenario and by river discharge over a long term scenario marques and moller 2008 marques et al 2010 applied a numerical model and estimated an annual mean discharge of 2088 m 3 s 1 granting the lagoon a dominant ebb condition and a discharge rate of total suspended matter of approximately 1 37 10 7 ton yr 1 the discharges are controlled by the pluviometric rates resulting in high river discharge inside the lagoon during late autumn and winter marques et al 2009 2010 as shown by fig 2 according to these authors this region presents a large interannual variability associated with el niño southern oscillation events the sedimentation pattern of the lagoon is composed of coarse fractions at the margins and regions with intense hydrodynamics according to toldo et al 2006 these authors also affirm that the fine sediments settle at less energetic regions and at the deeper parts of the lagoon the estuarine channel is mainly composed of a mixture of fine grains and the most frequent are silt more than 80 clay 15 and finer sand 5 calliari et al 2009 rio grande harbor the most southern harbor in the country maintains heavy traffic of large vessels daily on its waterway according to the agência nacional de transportes aquaviários antaq webportos labtrans ufsc br brasil movimentacao this harbor shipped 27 17 million tons of cargo during 2018 and this represents 7 25 of the total cargo shipped from brazilian ports in the same year the rio grande harbor connects the southern atlantic ocean to the capital of the rio grande do sul state porto alegre via patos lagoon it also represents an important connection between other brazilian ports and the ports of the la plata estuary argentina and uruguay möller jr et al 2001 verified that the adjacent tidal flats are mainly shallow less than 1 m with diurnal dominance and the estuarine channel depths vary from 9 to 22 m 3 modeling system the modeling procedure involves internally coupling three modules of the telemac mascaret system www opentelemac org the hydrodynamic model telemac 3d the morphodynamic model sisyphe and the dredge operation model nestor hence these modules are constantly exchanging information in order to correctly simulate the hydrodynamic forces that induce sediment transport and consequently the bed evolution over time nestor is applied to modify the bottom and to return the new bathymetry to the other two models so they can recalculate the variables and update the simulated environment telemac 3d was set up on a domain covering the patos lagoon and the coastal region between 30 05 s and 35 45 s and between 53 23 w and 47 38 w the computational domain contains 93 050 nodes with sizes varying from 10 to 20 m on important regions of the estuary to 10 km offshore fig 3a the time step used for the simulations was set to 90 s morphological and sedimentological data were set based on available resources therefore ssc boundary conditions for the rivers were forced by annual mean values of 0 069 0 091 and 0 145 kg m 3 for the guaíba and camaquã rivers and the são gonçalo channel respectively these data were obtained from the calculations presented by jung 2017 ssc data were prescribed at the liquid continental boundaries of the mesh fig 3a because there is a conflict between government and private agencies in providing updated bathymetry for scientific purposes a nautical chart s bathymetric data were interpolated in the mesh to represent the bottom the estuarine bottom is composed of a mixture of fine sediment classes therefore only two sediment classes were modeled in order to reduce the computational demand of the simulation because of the short time to perform this study the mean grain size diameter d 50 was set based on previous studies of sediment classification of the estuary antiqueira and calliari 2005 calliari et al 2009 according to these authors silt and clay are the most expressive sediment classes inside the estuarine channel based on the krumbein phi scale ϕ a d 50 of 62 5 μ m was set to represent silt and 3 9 μ m to represent clay in the sisyphe ssc boundary condition at the rivers these two sediment classes are initiated with 50 of the distribution the time step was set to 90 s as well the other boundary conditions were obtained from several sources for the period between 2003 and 2007 atmospheric pressure wind velocity and air temperature data were obtained from the ncep ncar reanalysis 1 project from the national oceanic and atmospheric administration noaa and prescribed over the surface of the computational mesh current velocity sea surface height salinity and temperature were obtained from the hycom hybrid coordinate ocean model and astronomical tides were obtained from otis osu tidal inversion software and prescribed at the oceanic boundaries river discharge data were obtained from the agência nacional de águas ana and prescribed at the liquid continental boundaries as daily discharges fig 3b 3 1 hydrodynamic model telemac 3d solves the navier stokes equations for geophysical fluids it considers variations on the free surface of the fluid and neglects density variations in the mass conservation equation to solve the motion equations in the three components of the cartesian plane it considers the boussinesq and hydrostatic pressure approximations it considers important forces that act on a geophysical fluid such as the coriolis force bed shear stress and the heat exchange between the fluid and the atmosphere hervouet 2007 3 2 morphodynamic model sisyphe computes the total load bed load suspended load of sediments and the bed evolution as a function of the hydrodynamic parameters issued by telemac 3d the cohesive sediment suspended load was computed using a concentration based approach that satisfies the depth average advection diffusion transport equation tassi and villaret 2014 van rijn 2007 bed load was not computed because of problems associated with coupling both types of transport together in the modeling system the bed evolution was computed using the exner equation which considers the changes in bottom elevation as a function of the sediment flow above the bed it assumes an equilibrium state in which alterations in the bed are linked to the sediment transport and flow interactions tassi and villaret 2014 riesterer et al 2016 3 3 dredge operation model the model nestor was developed to simulate dredging activities in river beds and waterways that face constant siltation due to sediment transport the module enables two different approaches to simulate dredging operations the first assumes a hindcast scenario where the dredging actions are defined by providing a specific time and amount of dredged material to model dredging actions in the past whereas in the second approach a certain criterion can be set so dredging actions start automatically when an elevated amount of sediment is detected within the waterway this second approach is used as a forecast simulation of dredging needs maerker and malcherek 2010 both approaches can be used to assist current dredging actions or to develop new strategies the dredging approach used herein is the hindcast form this approach also allows the evaluation of the effects of dredging on the hydrodynamic and morphodynamic regime nestor works with two kinds of files the first file uniquely serves the definition of dredging parameters such as time volume dig rate and computational settings the second file consists of the geographical definition of the operational areas where dredging takes place therefore polygons have to be defined within the waterway so the model can initiate dredging as shown in fig 4 4 study case the patos lagoon estuary the waterway of the rio grande harbor is established at the canal do norte as it is known as the natural channel formed by the estuary hydrodynamic the rio grande harbor is established at the east margin of the channel where a vast harbor complex represents shipyards containers docks and oil terminals fig 1b this waterway is constantly in need of maintenance dredging due the constant siltation by fine suspended sediment transported by the lagoon circulation through the estuary the source of these sediments is bidirectional transported seaward by the rivers and introduced into the estuary by the saline intrusion the rio grande harbor waterway has received maintenance dredging operations since the construction of the porto novo basin and the two jetties the sectors used to receive dredging are presented in fig 5 however based on the morphodynamic results new dredging sectors were delimited according to the positive bed evolution areas of the channel two of these sectors were dredged using a hindcast approach as mentioned previously and the changes in hydromorphodynamic variables were analyzed the configuration of the waterway is capable to receive two main design vessels container vessels and bulk carriers therefore the operational geometry of the waterway is set to have a depth of 18 m and a width of 258 m at the outer channel outside the estuary and a depth of 16 m and a width of 168 m at the inner channel inside the estuary inph sep 2015 5 model calibration the hydrodynamic model telemac 3d was calibrated based on in situ data salinity and current velocity were calibrated using conductivity and temperature ct and acoustic doppler current profiler adcp data collected by laboratório de oceanografia costeira e estuarina locoste furg at the praticagem station fig 1 the calibration period involves the year 2011 according to fig 6 the black dots represent the in situ data while the red and blue lines show the modeled salinity and current velocity data respectively fig 6 correctly represents the synoptic variations of salt intrusion inside the estuary as a function of the current velocities and direction in addition the positive values of current velocities represent flood conditions of the estuary and the negative values represent ebb conditions the time series of salinity range from zero to 40 psu and demonstrate that the modeled data are underestimated in relation to the in situ data however the average behavior of this variable follows the same trend in both situations confirming a good correlation between the data in the surface and bottom velocity the modeled data are also observed to follow the same behavior of the measured data in addition the model results showed underestimated values during some periods this behavior can be explained as a consequence of using the reanalysis data which can produce underestimated modeled results according to marques et al 2010 some authors also observed problems capturing the temporal and spatial variability using the reanalysis data for example simionato et al 2006 performed a wind analysis for the prata river region using reanalysis data and observed underestimations of high intensity events by up to 50 when compared to field data nevertheless the time series satisfactorily represent the trends of the signals measured the agreement between the time series of salinity and surface and bottom velocities was quantitatively evaluated using performance indicators the statistical results obtained by the telemac 3d and in situ data are presented in table 1 the metrics obtained from the modeled and measured data show that these are well adjusted the standard deviation results are similar in all situations highlighting the surface velocity where the data values are close it is possible to observe that salinity presented a high value of absolute error and rmse root mean square error reaching 8 2 psu and 10 7 psu respectively this can be explained by considering that salinity varies rapidly inside the estuary in a single day this is due the range that salinity can vary in a few hours from 0 to more than 30 psu in extreme flood events which combines winds and high discharge these results are similar to the values calculated by marques et al 2017 the statistics for current velocity show a low absolute error and rmse this indicates that the model is correctly representing the circulation pattern of the estuary the rmse values for surface and bottom velocities are 0 20 m s 1 and 0 195 m s 1 respectively these rmse values are similar to the values calculated by marques et al 2010 moreover free surface elevation inside the lagoon was validated at three sites ipanema arambaré and são lourenço station in this analysis the telemac data were compared with ana data for the year 2011 the time series are presented in fig 7 and the statistical results are presented in table 2 the time series of free surface elevation presented good adjustment between the telemac 3d and ana data in the three validated stations although there are gaps in water level data from ana in contrast a remarkable inconsistency is exhibited between the in situ data and the model estimations at some periods this can be explained by the use of reanalysis data as the meteorological forced parameters inside the modeling system reanalysis data are estimated in a fixed grid domain which is larger than the grid used in this numerical model simulation therefore the model estimation of the water level can oscillate up and down in the observed data this is remarkable when analyzing the peaks of the observed data in ipanema and arambaré stations between august and december on the other hand when analyzing the nonextreme values the model tends to be closer to the observed data the metrics calculated from the telemac 3d and ana data show that these are well adjusted highlighting the close standard deviation that resulted in all situations the absolute error and the rmse presented values up to 0 735 m and 0 8638 m respectively which are considered reasonable for this comparison from these findings it is possible to verify that the results of the telemac 3d model are reliable for the objectives of this study 6 results and discussion the patos lagoon estuary was numerically modeled over a period of 5 years 2003 2007 fig 8 shows the time series of the current velocity and salt intrusion at two distinct points inside the estuary and the resulting map of the bed evolution after the 5 year simulation these points are located on the positive bed evolution areas pnb and sp4 as shown in the map in fig 8 by the yellow rectangles salinity and current velocity were obtained at a depth of 10 m the pnb sector represents the porto novo basin and the sp4 represents the sector between the two jetties near the mouth of the estuary both areas present positive bed evolution after the period simulated by the morphodynamic model however they differ in hydrodynamic patterns since the pnb is located in a brackish water dominant region of the estuary while the sp4 sector is located inside the estuary inlet in a salt water dominant environment therefore it is expected that the sp4 sector presents higher salinity values than the pnb as well high current velocity intensity as shown in fig 8 the hydrodynamic model is shown to correctly represent the high ebb conditions of the estuary during the end of winter up to the beginning of summer when the high precipitation over interior lands fills up the rivers that discharge into the lagoon möller jr et al 2001 the intensity of the current velocity increases up to 1 m s 1 at the sp4 sector and antiqueira and calliari 2005 reported current velocities of approximately 1 3 and 1 5 m s 1 at the estuary inlet at the pnb sector velocities also increase but stay lower than 1 m s 1 therefore a longer hydrodynamic simulation more than 10 years would provide the interdecadal variations on the ebb patterns due el niño events that alter the lagoon and estuarine circulation marques and moller 2008 the high peaks of current velocity in late winter and early spring reflect the low salinity intrusion in the estuary for the same seasons this is explained by marques and moller 2008 when the authors affirmed that precipitation rates increase during winter conditioning the estuary to be ebb dominant the variability of the estuarine discharge is a consequence of the seasonal variations in river discharge inside the lagoon as shown in fig 2 this pattern is remarkably visible during the winter seasons of 2005 and 2006 fig 8 the opposite scenario is observed during the summer of 2005 when the highest peak of salinity conditioned by the lowest current velocities characterized a dry season for the patos lagoon estuary the current velocity time series fig 8 show how the velocities increase near the estuary inlet sp4 sector this is due to the geometry of the estuary that is narrower near the inlet according to antiqueira and calliari 2005 this is a high hydrodynamic region and therefore currents are stronger here making possible the settlement of coarser sediment particles while the finer silt and clay particles continue to be transported as seaward suspended load with these hydromorphodynamic results the year 2004 was chosen to be dredged and the sectors dredged were the sp4 and pnb the other silted sectors were not analyzed in this paper therefore the hindcast approach from the nestor model was applied the volume of 800 000 m 3 was dredged from the sp4 sector and at pnb the dredged volume was 260 000 m 3 these volumes are hypothetical we simply desired to excavate the bottom and reach the project depth quotas established by the inph sep 2015 in order to analyze the effects of dredging in the hydromorphodynamics of these sectors the established depth quotas for the rio grande harbor waterway are also presented in fig 5 the resulting bathymetry after dredging is presented in fig 9 both sectors were dredged during 30 days of june 2004 therefore the mean annual estuarine discharge calculated for 2004 was 3 407 m 3 s 1 with the maximum reached in july 9 850 m 3 s 1 the section considered here is at the mouth of the jetties with 9 159 5 m2 of area for comparison purposes marques et al 2010 found an estuarine discharge of 2 088 m 3 s 1 over a 606 day study during the year of 2006 herein the 2006 mean annual estuarine discharge calculated was 3 607 m 3 s 1 and the difference in the results for the same year can be associated with the time simulated which in this study was longer than the one simulated by marques et al 2010 dredging was performed using the nestor model and the 150 day simulation was run over a natural environment with no dredging these results were further compared with a 150 day simulation over a dredged bottom fig 10 compares the dredged and nondredged scenarios of both sectors of the approach channel the time series presented in fig 10 represent the 120 days after the dredge operation the other 30 days representing june were the days when dredging took place and are therefore not represented in the figure in the following section the behavior of environmental variables such as salinity current velocity ssc and the bottom variation of each sector are analyzed separately 6 1 sector sp4 inside the jetties in this scenario 800 000 m 3 were dredged from the sp4 sector this volume was capable of reaching the depth quota of 18 meters for this section of the channel the final bathymetry is shown in fig 9 after the end of dredging june 30 this sector presented a smooth increase of the mean current velocity 18 days after the end of the operation the decrease in salinity in the same period indicates that the estuary may be in an intense ebb condition increasing the velocities seaward and blocking the salt intrusion to enter the estuary however 60 days after the end of the dredging operation the mean current velocity kept the values below the time series of the nondredged bottom this indicates a reduction in the mean current velocities in this sector and this behavior was already pointed out by schiller et al 2006 the authors presented that dredging of this sector induces the reduction of the current velocities enabling sediments to settle therefore the results found by schiller et al 2006 endorse the results found in our simulations this reduction in velocities after dredging is also pointed out by jeuken and wang 2010 these authors visualized the reduction in current velocities by studying dredging and dumping impacts at the westerschelde estuary dating back to 1955 although the patos lagoon and the westerschelde estuary are different the relation between both estuaries and the dredging activities can be related this may indicate that dredging can equally reduce current velocity in estuaries with different patterns of circulation due deepening of the bottom this change in current velocity can explain the reduction in suspended silt and clay inside the sector after dredging these sediment particles are likely being deposited by the reduction in the mean current velocity which creates a less hydrodynamic environment enabling sediments to settle the suspended concentration of silt and clay tend to decrease in the water column 24 days after dredging operations finished as shown in fig 10 current velocities for the dredged scenario presented a maximum reduction of 93 24 in intensity and a mean reduction of 88 when compared with a nondredging scenario van maren et al 2015 pointed out that dredging affects the salinity induced density currents inside estuaries in addition deepening of channels can increase the residual flow due to enhancement in the salinity transport at tidal dominant estuaries in contrast the patos lagoon estuary behaves mainly as a river because high discharge events are dominant almost every day of the year therefore it was expected that this behavior of salinity would be different for the patos lagoon estuary however fig 10 shows that salinity inside the sp4 sector reduces immediately after the dredging operation of june and is associated with the next month july with high discharge of the estuary as already explained above on the other hand the salinity started to increase 30 days after the dredging operation ended and regarding small oscillations it stayed above the salinity of a nondredge scenario more investigations about this increase in salinity in a nontidal dominant estuary after dredge operations are needed to endorse these results no references for alterations due to dredging in salinity were found for a wind river discharge dominated estuary future studies should investigate the similarities between different estuary types and the impacts of dredging in salinity induced currents and salt intrusion dynamics regarding the evolution of the bottom the variation during the simulated period was calculated based on the bed evolution results from the morphodynamic model in fig 10 with no dredging the mean variation of the bottom at the sector sp4 was calculated to be 5 4 mm with dredging this variation increases to 90 74 with the value of 10 3 mm indicating that a dredged bottom suffers a more intense accretion of sediments than a nondredged scenario it is remarkable that until 60 days after the dredging operation the bottom had an intense positive increase and after this 60 day period the variations are smoother 6 2 sector pnb the porto novo basin salt intrusion in this sector was reduced after dredging due to the high ebb condition and just spikes again with the reduction on the lagoon discharge observed at the beginning of august however the sector presented a similar pattern to the sector sp4 where the salinity stayed above the nondredged scenario after 24 days of the dredging operation the lowest salinity presented between september and november can be associated with high estuarine discharge in addition as the pnb sector is farther upstream of the sp4 sector salinity levels here are lower again as in sector sp4 the salinity in a dredging scenario stayed above the salinity in a nondredged scenario fig 10 according to van maren et al 2015 the salinity induced flow is increased with deepening of estuarine channels but the author is referring to a tidal dominant estuary the patos lagoon estuary may present the same pattern but can surely vary this behavior between high ebb and flood scenarios throughout the year this similarity between the two different estuaries when analyzing dredging impacts on salinity needs to be carefully investigated in future studies current velocities presented a mean decrease of 23 3 with dredging operations this opens the possibility for sediments to settle contributing to the fast siltation observed during the 24 days following the end of the operations fig 10 the bathymetry of the basin without dredging was 10 28 m after dredging the quota of 10 50 m established by the inph sep 2015 was achieved and the final depth was 11 06 m the difference is approximately 0 77 m and the variation of the bottom presented a similar pattern to the sector sp4 with intense variation during 60 days after dredging after this period the bottom tends to present a smoother variation and incurs a smaller variation than the nondredged scenario in the middle of august 7 conclusions the 5 year results of the hydromorphodynamic simulation granted the following conclusions the estuarine annual mean discharges of the years 2004 and 2006 were calculated to be 3 407 m 3 s 1 and 3 607 m 3 s 1 respectively the estuarine channel presented 4 major positive bed evolution sectors indicating that the need of dredging in these areas is greater than the other regions of the approach channel to the rio grande harbor the water level validation procedure presented inconsistent results when comparing the modeled and collected data the model underestimated the peaks presented in the collected data however current velocity validation presented an absolute error of 0 203 and 0 158 m s 1 for surface and bottom velocities respectively this conveys the model s reliability to represent sediment transport with an acceptable modeled hydrodynamic of the estuary it is important to emphasize that these results should be interpreted carefully because they reflect the initial conditions forced on the model s domain these results do not represent the behavior of the estuarine channel hydrodynamics and morphodynamics under different environmental conditions such as water levels current velocities and wind regimes that differ from those established here the application of the dredge model nestor at two sectors of the channel of the rio grande harbor granted the following conclusions the bottom evolution after a dredging scenario is more intense than a nondredging scenario indicating a fast siltation of the dredged sectors until 60 days after the end of the operations this effect should be carefully analyzed when planning dredging operations at the patos lagoon estuary since depth quotas could not be achieved if this instant siltation of dredged sectors is not taken into account the dredging of the two sectors presented alterations in salinity current velocities and ssc in both sectors these results were calculated for the year 2004 a year that the estuary presented high ebb conditions because of high estuarine discharge we suggest a similar simulation should be performed for a drier year than 2004 with different dominant conditions the postdredging scenario indicates that a faster siltation of both sectors occurs but 2 months after the end of the operations the bottom tends to present a smoother variation the sp4 sector evolves faster than the pnb sector when dredging takes place this can be associated with the proximity of the sp4 sector to the ocean where the input of marine sediments and water are more pronounced the reduction in current velocity due dredging is remarkable the intensity of the mean current velocity in sector pnb reduced 23 3 after the dredging operation while at the sp4 sector the reduction was more pronounced with a value of 93 24 this study intends to encourage more scientific studies about the effects of dredging on estuarine channels in brazil and other developing countries the numerical modeling approach is a fine and well developed tool to assist dredge operations particularly where data are difficult to collect due environmental conditions or lack of funding acknowledgments the authors are greatful to the coordenação de aperfeiçoamento de pessoal de nível superior capes brazil for granting scholarships to the conselho nacional de desenvolvimento científico e tecnológico cnpq brazil by contract 304227 2016 1 to the fundação de amparo a pesquisa do estado do rio grande do sul fapergs by contract 17 2551 0001 159 7 and to the centro nacional de supercomputação cesup of the universidade federal do rio grande do sul ufrgs brazil which supported the development of this work the authors also thanks the ecmwf for the oceanographic and atmospheric data used to the consortium open telemac mascaret for providing the telemac system for free and to the laboratório nacional de computação científica lncc for the availability to use of the supercomputer dantos dumont 
