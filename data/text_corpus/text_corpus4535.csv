index,text
22675,computational studies using the reynolds averaged navier stokes rans method on viscous wake fields and the propulsion performance of a four screw ship were conducted the self propulsion experimental investigation was carried out in a towing tank to analyze the propulsion performance of the four screw ship the characteristics of the wake field and hydrodynamic performance of the inside and outside propellers were compared in detail the computational fluid dynamics results and experimental data showed good agreement there were considerably different distribution patterns of the wake field between inside and outside the propeller disc especially in the zone behind the brackets the mean axial velocity at different radii of the inside propeller is generally smaller than that of the outside propeller which results in the time averaged loads of the inside propeller becoming larger than those of the outside one harmonics analysis indicates that in the considered range of the outer radii the 1st and 2nd order harmonic components of the inside propeller disc are larger than those of the outside one which causes the fluctuation amplitudes of the loads on the inside propeller to become higher than those of the outside one keywords four screw ship wake field harmonic analysis time averaged load fluctuation amplitude nomenclature l length between perpendiculars m t draught m d propeller diameter m z number of blades c b block coefficient c m mid ship section coefficient p d pitch ratio h d hub ratio v the inflow velocity m s f r froude number f r v g l n rotation speed of propeller rps re reynolds number y nondimensional spacing t propeller thrust n q propeller torque n m k t thrust coefficient k q torque coefficient r propeller radius m 1 introduction owing to the advances in ship design and market demands the speed and displacement of a ship are increasing gradually as a result multiple screw vessels such as twin screw ships and four screw ships have emerged in recent years the wake fields and propulsion performance of such ships are considerably different from those of general single screw ships in a four screw ship four propellers are symmetrically distributed along the longitudinal section in the center disc as shown in fig 1 the position of the inside propeller is closer to the stern while that of the outside propeller is closer to the bow which will cause differences in the wake field between them the wake field plays an important role in propeller performance the difference in the wake field between inside and outside propeller disc will lead to load imbalance between the inside and outside propeller thus it is necessary to clarify the characteristics of the wake field propulsion performance as well as the interaction mechanism of the hull propeller and rudder for four screw ships gadd g e 1978 first proposed the numerical prediction of ship flow at the international symposium on ship viscous resistance and then it became one of the key research topics in this field patel v c and larsson l 1992 summarized the research findings of ship viscous flow at the 5th symposium on numerical and physical aspects of aerodynamic flows held in goteborg in 1990 a total of 19 research groups carried out research and calculations on two ship models the hamburgische schiffbau versuchsanstalt gmbh hsva ship model and the dyne ship model the calculation results of all the groups were in good agreement with the test values however the drastic contraction of the stern lines of ships induce wake vortices these wake vortices cause the wake distribution of the propeller disc to form a rabbit ear shaped velocity contour which is not well studied at this stage research is mainly restricted to the viscous wake field of the overlap model without considering the influence of the free surface abdel maksoud 2000 discussed the turbulence flow around the kcs model considering the free surface and the impact of propulsion at the gothenburg 2000 workshop on numerical ship hydrodynamics lars larsson and stern f 2003 2013 and 2014 assessed the state of the art in computational fluid dynamics cfd applied to computation of ship wake fields the discussion on wake fields at the tokyo conference in 2005 was mainly aimed at kcs ships and kvlcc2m see kim j 2005 at the 25th ittc meeting in 2008 the laser doppler velocimeter ldv was introduced to measure the nominal companion flow at the propeller disc providing accurate and reliable experimental data for numerical calculations lee et al 2009 also provided the wake test values for a ship model obtained via velocity field measurements using particle image velocimetry piv luo et al 2016 simulated the viscous wake field around ships in the ballast and compared the difference in the wake field between the design condition and in ballast condition developments in computer technology make it possible to employ cfd methods to simulate full scale ship wake fields abdel maksoud and heinke 2002 compared model and full scale wake fields for a twin screw ship with the propeller shaft and shaft brackets the study showed that the difference in the wake fields between the model and the full scale ship has a significant influence on the accuracy of cavitation prediction and the acoustic performance of the ship wang et al 2015a b studied the viscous wake field of single screw and two screw ships using the reynolds averaged navier stokes rans method and proposed an extrapolation method to convert the model scale wake field to the full scale wake field some researchers gaggero et al 2017 pereira et al 2017 compared the wake field prediction results using different turbulence models and found that the turbulence model based on the response surface methodology rsm was the most accurate turbulence model for nominal wake prediction farkas et al 2018 studied the flow around a full scale ship at different draughts self propulsion computations of surface ships were performed by castro et al 2011 who studied two single screw ships a tanker kvlcc1 and a containership kcs and a twin screw ship a surface combatant onr tumblehome propeller forces and the ship attitude along with the complete flow field were predicted sánchez caja et al 2008 2015 di mascio et al 2015 zhao et al 2016 and muscari et al 2017a studied the interaction of the propeller and rudder including the details of the flow field and rudder performance a more detailed understanding of the interaction mechanisms can be obtained through simulation of the flow field around a fully appended ship model wang et al 2016 and sun et al 2018 studied the propeller bearing force on a full scale hull propeller rudder system under oblique flow dubbioso et al 2015 2016 2017 and muscari et al 2017b 2017c investigated the asymmetric behavior of the propeller rudder system and the bearing loads of the propeller for twin screw ships during maneuvers there are limited studies on four screw ships zong et al 2017 conducted a self propulsion test on a four screw ship and proposed an optimum arrangement of the four propellers in addition they used numerical methods to calculate and analyze the influence of ship type and internal and external propeller interferences on propeller performance they concluded that the influence of ship type on propeller performance was greater than the interaction between propellers and the influence of ship type on the internal propeller was greater than that on the external propeller according to the above literature review it is clear that the wake field and propulsion performance characteristics of single screw and twin screw ships have been studied systematically and adequately while research on four screw ships is limited and rarely published the existing studies mainly focused on the prediction of propeller performance and optimization of the propeller layout to improve propeller efficiency till date there are no studies concerning the difference in the wake field between the inside and outside propellers and the resulting unbalanced load distribution between them however the wake fields of the inside and outside propellers for a four screw ship are considerably different their characteristics are more complicated than those of single screw or twin screw ships because of the appendages and asymmetrical spacing of the inside and outside propellers therefore it is necessary to study the wake fields and propulsion performance of four screw ships in this study the wake field and propulsion performance of a four screw ship were analyzed utilizing cfd simulations the commercial software package star ccm was used for grid generation and numerical simulations this paper is organized as follows section 2 provides the test and model descriptions the numerical simulation procedures are described in section 3 the calculation results are compared and discussed in section 4 finally the conclusions drawn from this study are summarized and plans for future research are stated 2 model description the model used in this study is a four propeller ship with two rudders all four propellers are external rotors the ship model and layout of the propellers are in fig 2 and the characteristic parameters of the ship and propeller are listed in table 1 the self propulsion measurements on this four screw ship were conducted in the towing tank laboratory at the harbin engineering university heu 3 numerical model 3 1 governing equations and turbulence model the motion compliant continuity and momentum conservation equations for incompressible newtonian fluid motion david c 1994 are as follows 1 u i x i 0 2 u i t x j u i u j p x i τ i j x j s i where u i and u j i j 1 2 3 represent the time averaged velocity component p is the time averaged value of the pressure and s j is the source term of the momentum equation τ i j ν t u i x j u j x i is the reynolds stress tensor in this study the simulation were carried out without considering the free surface effects on one hand wang et al 2015a b obtained almost the same numerical results with and without considering the free surface on the other hand we focus on the performance difference between inside and outside propeller even if the free surface has some effects on the propeller performance the effect on inside and outside propeller should be almost same thus we ignored the free surface effects to improve the computation efficiency the computational domain and boundary conditions for resistance and self propulsion simulations are shown in fig 3 to simulate propeller rotation the siding mesh method was used the k ω shear stress transport model was used as the turbulence model menter 1994 the governing equations david c wilcox 1994 were discretized using the finite volume method with a second order unwind all the numerical simulations were realized using star ccm 3 2 mesh grid there are two computation conditions are simulated and discussed in this paper one computation is performed without propeller and the other one is performed with propeller corresponding to nominal wake computation fr 0 28 and self propulsion computation fr 0 28 and rps 19 82 respectively the grid topologies and refinement region are the same for these two computation conditions all trimmed meshes were generated using star ccm generally it is suitable to limit the model scale y to the recommended 60 or so corresponding to which the thickness of the first layer of grids is 0 8 1 mm see castro et al 2011 one important aspect is that when dividing computational grids more grids should be allotted to the stern and appendage where the wake field varies dramatically the detailed cfd meshes are shown in fig 4 3 3 comparisons between cfd results and test data on the model scale three sets of grids were applied in the grid sensitivity analysis for the self propulsion computation the grid numbers and calculation results are listed in tables 2 and 3 respectively compared with the experimental fluid dynamics efd when the whole grid number achieve to 22 03m the cfd results agree well with the efd although the data of nominal wake computation are not validated the results can be accepted because the hull with c b 0 62 is rather slender and rans technique is quite applicable furthermore considering these two computation conditions with same grid topologies the validation of self propulsion can be considered as the sign of good accuracy for the wake computation to some extent therefore medium grids were applied in both nominal wake computations and self propulsion computations 4 results and discussion 4 1 wake flow field comparison of inside and outside propeller discs the right handed local coordinate systems of inside and outside propellers and the definition of the angles are shown in fig 5 the origin of the coordinates is the respective center of the inside and outside propellers because of the different positions of the inner and outer propellers their wake flow fields are considerably different resulting in a variety of propeller performances in this section the difference between the wake flow fields of the inside and outside propeller discs is compared fig 6 shows the nondimensional axial velocity contours of the inside and outside propeller discs the white dotted line in the figure denotes the radius of the propeller it indicates that there is a clear low speed zone behind the bracket the shape of the low speed zone corresponds to the angle of the bracket there is a high speed zone between the bracket arm for both the inside and outside propeller discs there is no v x v 0 1 velocity contour for the inside propeller disc while it exists for the outside propeller disc to illustrate the cause of the difference between the inside and outside propeller discs we considered more transversal planes along the x direction before the propeller disk plane shown in fig 7 where p0 represents the propeller disk plane we added superscripts in out to distinguish the inside and outside propeller disk plane p0 in represents the inside propeller disk plane and p0 out represents the outside propeller disk plane the other transversal planes are the same fig 8 shows the changes in the velocity contours of the inside and outside transversal planes it can be seen that the wake field distributions of p4 out and p3 out are similar to that of a single screw ship except for the symmetry when the current flows through the brackets the suction surface of the bracket acts as an accelerator the high speed zones can be found between the bracket arms in p2 out and p1 out as for the inside transversal planes p4 in is closer to the amidships than p4 out and the deadwood has a significant influence on the wake field distribution of p4 in compared to p4 in the velocity contour in p3 in deflects to the amidships which results from the sharp shrinking of stern lines the closed high speed velocity contour located between the bracket arms in p2 in and p1 in also shows an inward trend especially the 0 6 and 0 7 velocity contours fig 9 shows the vortex structure shedding from the bossing it shows that there are two vortices shedding from the bossing and flowing to the propeller disc however the difference is that the vortices shedding from the outside bossing flow downstream close to the shaft while the inside bossing vortices turn upward when flowing to the inside propeller disc fig 10 shows the vorticity contours of the propeller discs white and red dashed lines in the figure denote 1 0r and 0 7r respectively and red solid circles denote wake vortices of wake field it indicates that vortices of outside propeller disc are located inside 0 7r while the vortices of inside propeller disc are located at 0 7r this is mainly due to the hull lines and the position of the propellers the shape of the hull shrinks rapidly over the inside propeller shaft this leads to streamlines turning upward see in fig 11 which cause the inside bossing vortex to turn up accordingly in contrast the shape of the hull over the outside shaft has a small contraction amplitude and the streamlines over the outside shaft turn up tightly since turbulent flow is a pulsating motion the physical quantities in turbulent flow can be regarded as the sum of mean and pulsation values i e v x v x v x in order to estimate the turbulence fluctuation the turbulence intensity ε pope 2000 is usually introduced 3 ε 1 3 v x 2 v y 2 v z 2 v 0 2 where v x v y and v z are the three components of fluctuating velocity and v 0 is the inflow velocity the circumferential distribution of turbulence characteristics of wake field are shown in fig 12 wherein the green region 60 θ 30 is a locally high turbulent region which corresponds to the area behind brackets the pulsating velocity plots indicate that the fluctuation of v x is concentrated in the green region similar change rules are found when it comes to ε it is remarkable that the values of ε i n at 0 7r are generally larger than those of ε o u t subscript in out represent the variable of inside and outside propeller respectively this attributes to the interference of upward vortices see fig 10 this finding suggests that the inside propeller will generate greater unsteady forces 4 2 circumferential distribution of axial and tangential velocities for inside and outside propeller discs fig 13 shows the circumferential distribution of non dimensional axial and tangential velocities for the inside and outside propeller discs at r r 0 7 it indicates that the axial velocity behind the brackets decreases dramatically which corresponds to the velocity contours in fig 6 except for the zone behind the brackets the distribution patterns between the inside and outside discs are similar although the velocity magnitudes are different however there are two wake peaks resulting from the brackets in the outside propeller disc while there are three wake peaks in the inside propeller disc besides the two peaks resulting from brackets there is one wake peak located at around θ 0 in the inside propeller disc it was inferred that this third peak resulted from the vortex shedding at the appendage as for the tangential velocity distribution see in fig 13b the two lines are considerably different overall the reason is that the tangential velocity is mainly induced by the hull appendage and shedding vortex because of the asymmetrical spacing positions of the inside and outside propeller discs the influences of the hull appendage and shedding vortex on the tangential velocity are also diverse moreover the magnitude of the tangential velocity of the inside propeller disc is generally higher than that of the outside one which may result in the load of the inside propeller being higher than that of the outside propeller table 4 lists the mean nondimensional velocity at each radius the axial velocity comparison shows that the mean axial velocity of the inside propeller disc is smaller than that of outside one for all radii except at r r 0 3 according to the propeller performance characteristics the smaller the advance coefficient the greater is the propeller load therefore the difference in the mean axial velocity between the inside and outside discs may lead to imbalance in the propeller load and the load of the inside propeller may be greater than that of the outside one the tangential velocity comparison shows that the mean tangential velocity of the inside propeller disc is higher than that of the outside one at each radius except at r r 0 3 therefore increasing the rotation speed of the inside propeller will result in the increase of the inside propeller load considering that the velocity at r r 0 3 has little effect on the propeller performance the mean velocity characteristic will lead to the inside propeller load becoming greater than the outside one the mean nondimensional axial velocity of the inside propeller disc 0 842 is 4 2 smaller than that of the outside propeller disc 0 878 which will result in a greater inside propeller load compared to that of the outside propeller 4 3 harmonics analysis of wake field fig 14 shows the harmonics analysis of the axial wake field the x axis is the order and the y axis is the amplitude as for the axial component for both the inside and outside discs with the increase in the harmonic order the amplitude decreases at each radius dramatically and the amplitudes for the four or more harmonic orders are less than 3 of the incoming velocity 2 5 m s from the point of view of vibration the bearing force caused by propeller is related to the number of blades z as a general rule burnside et al 1979 point out that increasing the number of blades usually lowers the excitation forces on the shafting and the fluid pressures transmitted to the ship s hull there is a tradeoff however because increasing the number of blades also increases the possible number of resonances with the hull and the propulsion system as the 1st and 2nd order components considerably influence the bearing force of the propeller we focused on them the figure shows that the amplitudes of wake harmonic components of outside propeller in the inner radius range 0 3 r r 0 5 are higher than that of the inside one however for the outer radius range considered the amplitudes of wake harmonic components of inside propeller are higher than that of the outside one this is mainly because of the shedding vortex the vortex shedding from the outside bossing flows downstream close to the shaft resulting in an uneven wake field at the range of inner radius in contrast the inside bossing vortex turns upward when flowing to the inside propeller disc driven by the upward stream which results in an uneven wake field for the outer radius furthermore the fact that the inside propeller is located in the flow region of the outside propeller also makes the harmonics components of the inside propeller higher 4 4 propulsion performance analysis to characterize the difference and connection between the loads of the inside and outside propellers we define new variables load differences δ k t and δ k q they are given in equation 4 here the subscripts in out represent the load of the inside and outside propeller respectively it can be observed in table 5 that the thrust of the inside propeller is 9 3 higher than that of the outside one while the torque of the inside propeller is 4 2 higher than that of the outside propeller this phenomenon is mainly because of the differences in the wake field which is consistent with the conclusions given in sections 4 1 and 4 2 4 δ k t k t i n k t o u t k t i n k t o u t 2 δ k q k q i n k q o u t k q i n k q o u t 2 the thrusts and torques of the inside and outside propellers within approximately three cycles were recorded and plotted in time domain curves from which the corresponding frequency domain curves were obtained via fast fourier transform as shown in fig 15 according to the time domain curves see fig 15 a1 and b1 the thrust and torque fluctuate periodically over time the time averaged thrust and torque of inside propeller are higher than those of the outside propeller moreover the fluctuation amplitudes of the inside propeller loads are higher according to the frequency domain curves see fig 15 a2 and b2 the propeller thrust and torque have the same fluctuation frequency peaks appear at the blade frequency bpf 99 1 hz and its integral multiples with the peak being the largest at the bpf and quickly attenuating afterward after 3bpf these forces can be ignored furthermore it clearly shows that the thrust and torque fluctuations of the inside propeller are both larger than those of the outside one which suggests that the vibration and noise intensities of the inside propeller are higher than those of the outside propeller this is ascribed to be that the inside propeller is located behind the outside propeller and the forward slipstream will generally affect the inflow of inside propeller see fig 16 which results in the wake field of the inside propeller disc being less uniform 5 discussion the typical propulsive configuration for 4 screw ships is that each propeller is driven by an independent main engine the load imbalance between the inside and outside propellers has considerable influence on the overall performance and mechanical equipment of ships under the condition of maximum speed the load of the inside propeller is larger than that of the outside one which causes the engine power of the inside propeller to exceed the design value the rotation speed of the inside propeller cannot reach the rated speed while the state of the outside propeller is exactly opposite to that of the inside propeller as a result this load imbalance affects the maximum speed of the ship and its resistance and performance on the other hand the internal propeller shaft torque may exceed the rated torque owing to the excessive load of the inside propeller which will lead to damage of the shaft bearing gearbox and the main engine furthermore if the inside and outside propellers operate under different load conditions for a long time the service life of the internal and external propeller shaft systems will be considerably different which is not conducive to the later modification and replacement of the ship shafts and is not conducive to the economic performance of the ship according to the above analysis the difference in the wake fields between the inside and outside propeller discs lead to the load difference between them these problems can be avoided by designing a different propeller to match the wake field however we have to obtain the wake field characteristics before designing a differential propeller this is the prerequisite for designing a differential propeller only by identifying the differences in the wake field between the inner and outer propeller disc can we develop pertinent propeller designs in this regard we mention some additional considerations from the viewpoint of propeller design because the wake fraction of the inner propeller is higher than that of the outer propeller for reducing the vibration noise of the propeller the skew angle of the inner propeller should be larger than that of the outer propeller the disk ratio of the inner propeller should be larger than that of the outer propeller the clearance between the shaft and hull of the inner propeller is smaller than that of the outer propeller from the viewpoint of reducing the pulsating pressure caused by the propeller the rake of the inner propeller should be larger than that of the outer propeller to increase the clearance between the blade tip of inner propeller and stern the chord length pitch camber thickness and airfoil profile of the inner and outer propellers should be different to reduce the load difference the stress level of the inner propeller is obviously higher than that of the outer propeller under the same rotational speed because the disk ratio rake and skew of the inner propeller are designed to be higher than that of the outer propeller then to ensure that the inner and outer blades have the same strength characteristics the thickness of the inner blade should be higher than that of the outer blade 6 conclusions to analyze the differences in the wake field and performance between the inside and outside propeller a computational study of a four screw ship was conducted using the rans method the computational results were validated using the self propulsion experimental data the study results can be summarized as follows 1 the cfd results and test data are in good agreement generally which proves that it is reasonable to use this method to analyze the hydrodynamic performance of a four screw ship 2 for a four screw ship significant differences in the wake field are found between the inside and outside propeller discs there are different circumferential distribution patterns of the axial and tangential wake fields between them owing to their different positions especially in the zone behind the brackets 3 the mean axial velocity at different radii of the inside propeller is generally smaller than that of the outside propeller causing the time averaged loads of the inside propeller to become higher than those of the outside one 4 harmonics analysis indicates that in the considered range of the outer radius the 1st and 2nd order harmonic components of the inside propeller disc are larger than those of the outside one causing the fluctuation amplitudes of the loads on the inside propeller to become higher than those of the outside one 5 by identifying the differences in the wake field between the inner and outer propeller discs a differential propeller design is proposed to resolve the load imbalance in a four screw ship in case two different designs are used for the inner and outer propeller discs by adapting them to the different wakes the propeller loads could be made more similar 6 we believe the research presented in this paper is the prerequisite and foundation for better propeller designs subsequent research will focus on a differential propeller design based on the differences in the wake field acknowledgements the present work was supported by the national natural science foundation of china grant no 51679052 and defense industrial technology development program grant no jcky2016604b001 
22675,computational studies using the reynolds averaged navier stokes rans method on viscous wake fields and the propulsion performance of a four screw ship were conducted the self propulsion experimental investigation was carried out in a towing tank to analyze the propulsion performance of the four screw ship the characteristics of the wake field and hydrodynamic performance of the inside and outside propellers were compared in detail the computational fluid dynamics results and experimental data showed good agreement there were considerably different distribution patterns of the wake field between inside and outside the propeller disc especially in the zone behind the brackets the mean axial velocity at different radii of the inside propeller is generally smaller than that of the outside propeller which results in the time averaged loads of the inside propeller becoming larger than those of the outside one harmonics analysis indicates that in the considered range of the outer radii the 1st and 2nd order harmonic components of the inside propeller disc are larger than those of the outside one which causes the fluctuation amplitudes of the loads on the inside propeller to become higher than those of the outside one keywords four screw ship wake field harmonic analysis time averaged load fluctuation amplitude nomenclature l length between perpendiculars m t draught m d propeller diameter m z number of blades c b block coefficient c m mid ship section coefficient p d pitch ratio h d hub ratio v the inflow velocity m s f r froude number f r v g l n rotation speed of propeller rps re reynolds number y nondimensional spacing t propeller thrust n q propeller torque n m k t thrust coefficient k q torque coefficient r propeller radius m 1 introduction owing to the advances in ship design and market demands the speed and displacement of a ship are increasing gradually as a result multiple screw vessels such as twin screw ships and four screw ships have emerged in recent years the wake fields and propulsion performance of such ships are considerably different from those of general single screw ships in a four screw ship four propellers are symmetrically distributed along the longitudinal section in the center disc as shown in fig 1 the position of the inside propeller is closer to the stern while that of the outside propeller is closer to the bow which will cause differences in the wake field between them the wake field plays an important role in propeller performance the difference in the wake field between inside and outside propeller disc will lead to load imbalance between the inside and outside propeller thus it is necessary to clarify the characteristics of the wake field propulsion performance as well as the interaction mechanism of the hull propeller and rudder for four screw ships gadd g e 1978 first proposed the numerical prediction of ship flow at the international symposium on ship viscous resistance and then it became one of the key research topics in this field patel v c and larsson l 1992 summarized the research findings of ship viscous flow at the 5th symposium on numerical and physical aspects of aerodynamic flows held in goteborg in 1990 a total of 19 research groups carried out research and calculations on two ship models the hamburgische schiffbau versuchsanstalt gmbh hsva ship model and the dyne ship model the calculation results of all the groups were in good agreement with the test values however the drastic contraction of the stern lines of ships induce wake vortices these wake vortices cause the wake distribution of the propeller disc to form a rabbit ear shaped velocity contour which is not well studied at this stage research is mainly restricted to the viscous wake field of the overlap model without considering the influence of the free surface abdel maksoud 2000 discussed the turbulence flow around the kcs model considering the free surface and the impact of propulsion at the gothenburg 2000 workshop on numerical ship hydrodynamics lars larsson and stern f 2003 2013 and 2014 assessed the state of the art in computational fluid dynamics cfd applied to computation of ship wake fields the discussion on wake fields at the tokyo conference in 2005 was mainly aimed at kcs ships and kvlcc2m see kim j 2005 at the 25th ittc meeting in 2008 the laser doppler velocimeter ldv was introduced to measure the nominal companion flow at the propeller disc providing accurate and reliable experimental data for numerical calculations lee et al 2009 also provided the wake test values for a ship model obtained via velocity field measurements using particle image velocimetry piv luo et al 2016 simulated the viscous wake field around ships in the ballast and compared the difference in the wake field between the design condition and in ballast condition developments in computer technology make it possible to employ cfd methods to simulate full scale ship wake fields abdel maksoud and heinke 2002 compared model and full scale wake fields for a twin screw ship with the propeller shaft and shaft brackets the study showed that the difference in the wake fields between the model and the full scale ship has a significant influence on the accuracy of cavitation prediction and the acoustic performance of the ship wang et al 2015a b studied the viscous wake field of single screw and two screw ships using the reynolds averaged navier stokes rans method and proposed an extrapolation method to convert the model scale wake field to the full scale wake field some researchers gaggero et al 2017 pereira et al 2017 compared the wake field prediction results using different turbulence models and found that the turbulence model based on the response surface methodology rsm was the most accurate turbulence model for nominal wake prediction farkas et al 2018 studied the flow around a full scale ship at different draughts self propulsion computations of surface ships were performed by castro et al 2011 who studied two single screw ships a tanker kvlcc1 and a containership kcs and a twin screw ship a surface combatant onr tumblehome propeller forces and the ship attitude along with the complete flow field were predicted sánchez caja et al 2008 2015 di mascio et al 2015 zhao et al 2016 and muscari et al 2017a studied the interaction of the propeller and rudder including the details of the flow field and rudder performance a more detailed understanding of the interaction mechanisms can be obtained through simulation of the flow field around a fully appended ship model wang et al 2016 and sun et al 2018 studied the propeller bearing force on a full scale hull propeller rudder system under oblique flow dubbioso et al 2015 2016 2017 and muscari et al 2017b 2017c investigated the asymmetric behavior of the propeller rudder system and the bearing loads of the propeller for twin screw ships during maneuvers there are limited studies on four screw ships zong et al 2017 conducted a self propulsion test on a four screw ship and proposed an optimum arrangement of the four propellers in addition they used numerical methods to calculate and analyze the influence of ship type and internal and external propeller interferences on propeller performance they concluded that the influence of ship type on propeller performance was greater than the interaction between propellers and the influence of ship type on the internal propeller was greater than that on the external propeller according to the above literature review it is clear that the wake field and propulsion performance characteristics of single screw and twin screw ships have been studied systematically and adequately while research on four screw ships is limited and rarely published the existing studies mainly focused on the prediction of propeller performance and optimization of the propeller layout to improve propeller efficiency till date there are no studies concerning the difference in the wake field between the inside and outside propellers and the resulting unbalanced load distribution between them however the wake fields of the inside and outside propellers for a four screw ship are considerably different their characteristics are more complicated than those of single screw or twin screw ships because of the appendages and asymmetrical spacing of the inside and outside propellers therefore it is necessary to study the wake fields and propulsion performance of four screw ships in this study the wake field and propulsion performance of a four screw ship were analyzed utilizing cfd simulations the commercial software package star ccm was used for grid generation and numerical simulations this paper is organized as follows section 2 provides the test and model descriptions the numerical simulation procedures are described in section 3 the calculation results are compared and discussed in section 4 finally the conclusions drawn from this study are summarized and plans for future research are stated 2 model description the model used in this study is a four propeller ship with two rudders all four propellers are external rotors the ship model and layout of the propellers are in fig 2 and the characteristic parameters of the ship and propeller are listed in table 1 the self propulsion measurements on this four screw ship were conducted in the towing tank laboratory at the harbin engineering university heu 3 numerical model 3 1 governing equations and turbulence model the motion compliant continuity and momentum conservation equations for incompressible newtonian fluid motion david c 1994 are as follows 1 u i x i 0 2 u i t x j u i u j p x i τ i j x j s i where u i and u j i j 1 2 3 represent the time averaged velocity component p is the time averaged value of the pressure and s j is the source term of the momentum equation τ i j ν t u i x j u j x i is the reynolds stress tensor in this study the simulation were carried out without considering the free surface effects on one hand wang et al 2015a b obtained almost the same numerical results with and without considering the free surface on the other hand we focus on the performance difference between inside and outside propeller even if the free surface has some effects on the propeller performance the effect on inside and outside propeller should be almost same thus we ignored the free surface effects to improve the computation efficiency the computational domain and boundary conditions for resistance and self propulsion simulations are shown in fig 3 to simulate propeller rotation the siding mesh method was used the k ω shear stress transport model was used as the turbulence model menter 1994 the governing equations david c wilcox 1994 were discretized using the finite volume method with a second order unwind all the numerical simulations were realized using star ccm 3 2 mesh grid there are two computation conditions are simulated and discussed in this paper one computation is performed without propeller and the other one is performed with propeller corresponding to nominal wake computation fr 0 28 and self propulsion computation fr 0 28 and rps 19 82 respectively the grid topologies and refinement region are the same for these two computation conditions all trimmed meshes were generated using star ccm generally it is suitable to limit the model scale y to the recommended 60 or so corresponding to which the thickness of the first layer of grids is 0 8 1 mm see castro et al 2011 one important aspect is that when dividing computational grids more grids should be allotted to the stern and appendage where the wake field varies dramatically the detailed cfd meshes are shown in fig 4 3 3 comparisons between cfd results and test data on the model scale three sets of grids were applied in the grid sensitivity analysis for the self propulsion computation the grid numbers and calculation results are listed in tables 2 and 3 respectively compared with the experimental fluid dynamics efd when the whole grid number achieve to 22 03m the cfd results agree well with the efd although the data of nominal wake computation are not validated the results can be accepted because the hull with c b 0 62 is rather slender and rans technique is quite applicable furthermore considering these two computation conditions with same grid topologies the validation of self propulsion can be considered as the sign of good accuracy for the wake computation to some extent therefore medium grids were applied in both nominal wake computations and self propulsion computations 4 results and discussion 4 1 wake flow field comparison of inside and outside propeller discs the right handed local coordinate systems of inside and outside propellers and the definition of the angles are shown in fig 5 the origin of the coordinates is the respective center of the inside and outside propellers because of the different positions of the inner and outer propellers their wake flow fields are considerably different resulting in a variety of propeller performances in this section the difference between the wake flow fields of the inside and outside propeller discs is compared fig 6 shows the nondimensional axial velocity contours of the inside and outside propeller discs the white dotted line in the figure denotes the radius of the propeller it indicates that there is a clear low speed zone behind the bracket the shape of the low speed zone corresponds to the angle of the bracket there is a high speed zone between the bracket arm for both the inside and outside propeller discs there is no v x v 0 1 velocity contour for the inside propeller disc while it exists for the outside propeller disc to illustrate the cause of the difference between the inside and outside propeller discs we considered more transversal planes along the x direction before the propeller disk plane shown in fig 7 where p0 represents the propeller disk plane we added superscripts in out to distinguish the inside and outside propeller disk plane p0 in represents the inside propeller disk plane and p0 out represents the outside propeller disk plane the other transversal planes are the same fig 8 shows the changes in the velocity contours of the inside and outside transversal planes it can be seen that the wake field distributions of p4 out and p3 out are similar to that of a single screw ship except for the symmetry when the current flows through the brackets the suction surface of the bracket acts as an accelerator the high speed zones can be found between the bracket arms in p2 out and p1 out as for the inside transversal planes p4 in is closer to the amidships than p4 out and the deadwood has a significant influence on the wake field distribution of p4 in compared to p4 in the velocity contour in p3 in deflects to the amidships which results from the sharp shrinking of stern lines the closed high speed velocity contour located between the bracket arms in p2 in and p1 in also shows an inward trend especially the 0 6 and 0 7 velocity contours fig 9 shows the vortex structure shedding from the bossing it shows that there are two vortices shedding from the bossing and flowing to the propeller disc however the difference is that the vortices shedding from the outside bossing flow downstream close to the shaft while the inside bossing vortices turn upward when flowing to the inside propeller disc fig 10 shows the vorticity contours of the propeller discs white and red dashed lines in the figure denote 1 0r and 0 7r respectively and red solid circles denote wake vortices of wake field it indicates that vortices of outside propeller disc are located inside 0 7r while the vortices of inside propeller disc are located at 0 7r this is mainly due to the hull lines and the position of the propellers the shape of the hull shrinks rapidly over the inside propeller shaft this leads to streamlines turning upward see in fig 11 which cause the inside bossing vortex to turn up accordingly in contrast the shape of the hull over the outside shaft has a small contraction amplitude and the streamlines over the outside shaft turn up tightly since turbulent flow is a pulsating motion the physical quantities in turbulent flow can be regarded as the sum of mean and pulsation values i e v x v x v x in order to estimate the turbulence fluctuation the turbulence intensity ε pope 2000 is usually introduced 3 ε 1 3 v x 2 v y 2 v z 2 v 0 2 where v x v y and v z are the three components of fluctuating velocity and v 0 is the inflow velocity the circumferential distribution of turbulence characteristics of wake field are shown in fig 12 wherein the green region 60 θ 30 is a locally high turbulent region which corresponds to the area behind brackets the pulsating velocity plots indicate that the fluctuation of v x is concentrated in the green region similar change rules are found when it comes to ε it is remarkable that the values of ε i n at 0 7r are generally larger than those of ε o u t subscript in out represent the variable of inside and outside propeller respectively this attributes to the interference of upward vortices see fig 10 this finding suggests that the inside propeller will generate greater unsteady forces 4 2 circumferential distribution of axial and tangential velocities for inside and outside propeller discs fig 13 shows the circumferential distribution of non dimensional axial and tangential velocities for the inside and outside propeller discs at r r 0 7 it indicates that the axial velocity behind the brackets decreases dramatically which corresponds to the velocity contours in fig 6 except for the zone behind the brackets the distribution patterns between the inside and outside discs are similar although the velocity magnitudes are different however there are two wake peaks resulting from the brackets in the outside propeller disc while there are three wake peaks in the inside propeller disc besides the two peaks resulting from brackets there is one wake peak located at around θ 0 in the inside propeller disc it was inferred that this third peak resulted from the vortex shedding at the appendage as for the tangential velocity distribution see in fig 13b the two lines are considerably different overall the reason is that the tangential velocity is mainly induced by the hull appendage and shedding vortex because of the asymmetrical spacing positions of the inside and outside propeller discs the influences of the hull appendage and shedding vortex on the tangential velocity are also diverse moreover the magnitude of the tangential velocity of the inside propeller disc is generally higher than that of the outside one which may result in the load of the inside propeller being higher than that of the outside propeller table 4 lists the mean nondimensional velocity at each radius the axial velocity comparison shows that the mean axial velocity of the inside propeller disc is smaller than that of outside one for all radii except at r r 0 3 according to the propeller performance characteristics the smaller the advance coefficient the greater is the propeller load therefore the difference in the mean axial velocity between the inside and outside discs may lead to imbalance in the propeller load and the load of the inside propeller may be greater than that of the outside one the tangential velocity comparison shows that the mean tangential velocity of the inside propeller disc is higher than that of the outside one at each radius except at r r 0 3 therefore increasing the rotation speed of the inside propeller will result in the increase of the inside propeller load considering that the velocity at r r 0 3 has little effect on the propeller performance the mean velocity characteristic will lead to the inside propeller load becoming greater than the outside one the mean nondimensional axial velocity of the inside propeller disc 0 842 is 4 2 smaller than that of the outside propeller disc 0 878 which will result in a greater inside propeller load compared to that of the outside propeller 4 3 harmonics analysis of wake field fig 14 shows the harmonics analysis of the axial wake field the x axis is the order and the y axis is the amplitude as for the axial component for both the inside and outside discs with the increase in the harmonic order the amplitude decreases at each radius dramatically and the amplitudes for the four or more harmonic orders are less than 3 of the incoming velocity 2 5 m s from the point of view of vibration the bearing force caused by propeller is related to the number of blades z as a general rule burnside et al 1979 point out that increasing the number of blades usually lowers the excitation forces on the shafting and the fluid pressures transmitted to the ship s hull there is a tradeoff however because increasing the number of blades also increases the possible number of resonances with the hull and the propulsion system as the 1st and 2nd order components considerably influence the bearing force of the propeller we focused on them the figure shows that the amplitudes of wake harmonic components of outside propeller in the inner radius range 0 3 r r 0 5 are higher than that of the inside one however for the outer radius range considered the amplitudes of wake harmonic components of inside propeller are higher than that of the outside one this is mainly because of the shedding vortex the vortex shedding from the outside bossing flows downstream close to the shaft resulting in an uneven wake field at the range of inner radius in contrast the inside bossing vortex turns upward when flowing to the inside propeller disc driven by the upward stream which results in an uneven wake field for the outer radius furthermore the fact that the inside propeller is located in the flow region of the outside propeller also makes the harmonics components of the inside propeller higher 4 4 propulsion performance analysis to characterize the difference and connection between the loads of the inside and outside propellers we define new variables load differences δ k t and δ k q they are given in equation 4 here the subscripts in out represent the load of the inside and outside propeller respectively it can be observed in table 5 that the thrust of the inside propeller is 9 3 higher than that of the outside one while the torque of the inside propeller is 4 2 higher than that of the outside propeller this phenomenon is mainly because of the differences in the wake field which is consistent with the conclusions given in sections 4 1 and 4 2 4 δ k t k t i n k t o u t k t i n k t o u t 2 δ k q k q i n k q o u t k q i n k q o u t 2 the thrusts and torques of the inside and outside propellers within approximately three cycles were recorded and plotted in time domain curves from which the corresponding frequency domain curves were obtained via fast fourier transform as shown in fig 15 according to the time domain curves see fig 15 a1 and b1 the thrust and torque fluctuate periodically over time the time averaged thrust and torque of inside propeller are higher than those of the outside propeller moreover the fluctuation amplitudes of the inside propeller loads are higher according to the frequency domain curves see fig 15 a2 and b2 the propeller thrust and torque have the same fluctuation frequency peaks appear at the blade frequency bpf 99 1 hz and its integral multiples with the peak being the largest at the bpf and quickly attenuating afterward after 3bpf these forces can be ignored furthermore it clearly shows that the thrust and torque fluctuations of the inside propeller are both larger than those of the outside one which suggests that the vibration and noise intensities of the inside propeller are higher than those of the outside propeller this is ascribed to be that the inside propeller is located behind the outside propeller and the forward slipstream will generally affect the inflow of inside propeller see fig 16 which results in the wake field of the inside propeller disc being less uniform 5 discussion the typical propulsive configuration for 4 screw ships is that each propeller is driven by an independent main engine the load imbalance between the inside and outside propellers has considerable influence on the overall performance and mechanical equipment of ships under the condition of maximum speed the load of the inside propeller is larger than that of the outside one which causes the engine power of the inside propeller to exceed the design value the rotation speed of the inside propeller cannot reach the rated speed while the state of the outside propeller is exactly opposite to that of the inside propeller as a result this load imbalance affects the maximum speed of the ship and its resistance and performance on the other hand the internal propeller shaft torque may exceed the rated torque owing to the excessive load of the inside propeller which will lead to damage of the shaft bearing gearbox and the main engine furthermore if the inside and outside propellers operate under different load conditions for a long time the service life of the internal and external propeller shaft systems will be considerably different which is not conducive to the later modification and replacement of the ship shafts and is not conducive to the economic performance of the ship according to the above analysis the difference in the wake fields between the inside and outside propeller discs lead to the load difference between them these problems can be avoided by designing a different propeller to match the wake field however we have to obtain the wake field characteristics before designing a differential propeller this is the prerequisite for designing a differential propeller only by identifying the differences in the wake field between the inner and outer propeller disc can we develop pertinent propeller designs in this regard we mention some additional considerations from the viewpoint of propeller design because the wake fraction of the inner propeller is higher than that of the outer propeller for reducing the vibration noise of the propeller the skew angle of the inner propeller should be larger than that of the outer propeller the disk ratio of the inner propeller should be larger than that of the outer propeller the clearance between the shaft and hull of the inner propeller is smaller than that of the outer propeller from the viewpoint of reducing the pulsating pressure caused by the propeller the rake of the inner propeller should be larger than that of the outer propeller to increase the clearance between the blade tip of inner propeller and stern the chord length pitch camber thickness and airfoil profile of the inner and outer propellers should be different to reduce the load difference the stress level of the inner propeller is obviously higher than that of the outer propeller under the same rotational speed because the disk ratio rake and skew of the inner propeller are designed to be higher than that of the outer propeller then to ensure that the inner and outer blades have the same strength characteristics the thickness of the inner blade should be higher than that of the outer blade 6 conclusions to analyze the differences in the wake field and performance between the inside and outside propeller a computational study of a four screw ship was conducted using the rans method the computational results were validated using the self propulsion experimental data the study results can be summarized as follows 1 the cfd results and test data are in good agreement generally which proves that it is reasonable to use this method to analyze the hydrodynamic performance of a four screw ship 2 for a four screw ship significant differences in the wake field are found between the inside and outside propeller discs there are different circumferential distribution patterns of the axial and tangential wake fields between them owing to their different positions especially in the zone behind the brackets 3 the mean axial velocity at different radii of the inside propeller is generally smaller than that of the outside propeller causing the time averaged loads of the inside propeller to become higher than those of the outside one 4 harmonics analysis indicates that in the considered range of the outer radius the 1st and 2nd order harmonic components of the inside propeller disc are larger than those of the outside one causing the fluctuation amplitudes of the loads on the inside propeller to become higher than those of the outside one 5 by identifying the differences in the wake field between the inner and outer propeller discs a differential propeller design is proposed to resolve the load imbalance in a four screw ship in case two different designs are used for the inner and outer propeller discs by adapting them to the different wakes the propeller loads could be made more similar 6 we believe the research presented in this paper is the prerequisite and foundation for better propeller designs subsequent research will focus on a differential propeller design based on the differences in the wake field acknowledgements the present work was supported by the national natural science foundation of china grant no 51679052 and defense industrial technology development program grant no jcky2016604b001 
22676,subsea pipe route selection is very complex which involves several issues due to the complicated sea environment a properly selected subsea pipe route could help reduce costs and meet engineering requirements while simultaneously considering the related requirements this task becomes a complicated optimization problem this paper proposes a nonlinear constrained optimization model for selecting pipe route with minimum length that considers seabed topography obstacles and pipe curvature requirements besides the process of determining the intersection between the pipe route and obstacles is presented the particle swarm optimization based augmented lagrangian multiplier method followed by dynamic programming is applied to solve the proposed model both flat and undulating seabed with obstacles were considered for the case studies and the proposed model was compared with dijkstra algorithm indicating the feasibility stability and reliability of the proposed model and solution method this work provides an initial understanding of pipe route optimization and other engineering requirements related to safety and cost can be easily added to the proposed model making the proposed model flexible to the needs of users for different application scenarios keywords pipe route optimization seabed topography and obstacles pipe curvature augmented lagrangian multiplier method particle swarm optimization pso dynamic programming 1 introduction 1 1 background offshore deep water oil fields have been continuously discovered in recent years especially in brazil buckley and uehara 2017 the gulf of mexico duncan et al 2018 west africa thomson et al 2013 and the north sea guerrero and stephen 2018 to develop these fields subsea pipes have been installed on the seabed providing the flow path among wellheads related subsea facilities manifold subsea pump etc and the receiving terminals such as the floating production storage and offloading unit fpso for produced fluids from the reservoir safety and reliability issues of subsea pipes immediately affect the production performance and the sea environment additionally the cost of subsea pipes occupies a large proportion of project capital expenditure capex in offshore fields beltrao 1995 kaiser 2017 considering the volatility of oil prices reducing the cost of subsea pipes is crucial for a competitive offshore project subsea pipe route selection is one of the earliest and most critical tasks traditionally pipe route selection is performed manually depending on the expertise of the engineers since it is a very complex task involving a variety of issues researchers have recognized that the selection of a subsea pipe route with good performance and low cost can be formally described and treated as a synthesis of optimization problems meisingset and olsen 2004 this paper focuses on this topic aiming at optimizing the pipe route on the undulating seabed for cost reduction under several engineering requirements 1 2 related work the earliest research related to oil pipe route optimization dates back to shamir 1971 he considered that there was a maximum available pressure drop of the two phase flow between the head and terminal points under this constraint an oil pipe route was optimized for minimum total cost through dynamic programming this work is very basic and several other constraints such as obstacles pipe curvature and structural issues still need to be considered however shamir s study indicates the possibility of optimizing oil pipe routes while incorporating engineering requirements meisingset and olsen 2004 set minimum cost as the object function and summarized the factors that need to be considered including route length free spans obstacles lateral stability pipe curvature and the vertical undulation the parameters related to the cost were chosen as a set of dimensionless variables reflecting the relative importance of the different terms the model was solved through simulated annealing algorithm the study provided a synthetic structure for linking the related engineering requirements to pipe route optimization xiao et al 2006 focused on the relationship between pipe route and the hydraulic behavior of multiphase flow they desired to find a proper pipe route that balances pipe cost and pressure loss as well as liquid inventory the pressure drop of multiphase flow was not directly calculated instead it was expressed by the ground undulations considering that high pressure drops are caused by variations in seabed elevation the dijkstra algorithm a typical way of finding a path on graphs with nodes and edges was applied to solve the proposed model kang and lee 2017 also applied this algorithm to optimize a subsea pipe route and they also used the laplacian smoothing algorithm to make the route smoother smoothing routes was also studied by berglund et al 2003 and donatelli et al 2017 baeza et al 2017 compared the applications of the dijkstra algorithm and ant colony optimization aco and discussed the advantages and limitations of both algorithms vieira et al 2010 established a subsea pipe route optimization model by dividing the pipe into a set of straight lines and curves in this way the pipe route could be determined by obtaining the length of the straight lines and radius of the curves genetic algorithm ga was applied to solve the model and different constraint handling methods in the ga were discussed de lucena et al 2014 the proposed model was employed for pipe route design under a series of constraints such as seabed topography obstacles on bottom stability and vortex induced vibration viv fatigue with the aim of minimizing total length rocha et al 2015 baioco et al 2015 2017 2018 the model was a huge optimization problem to be solved when all considerations are put together zhou et al 2017 also used ga to optimize the pipe route while considering gas liquid two phase flow in combination with beggs brill correlations for pressure drop other aspects related to pipe route optimization have also been studied such as the uncertainty of seabed information haneberg 2015 devine et al 2016 the quantified classification of factors that need to be considered in pipe route design balogun et al 2015 and the treatment methods of slope and curvature de smith 2006 these studies provide a reliable and applicable basis for pipe route optimization furthermore subsea pipe route selection is actually a kind of path finding problem which is widely seen in vehicle route design and robot planning contreras cruz et al 2015 wang and ju 2015 niu et al 2018 zhang et al 2018 proposed a comprehensive risk assessment model through assigning different weight factors to related impact issues to select the optimal route for hazardous liquid railway network related research in these areas might provide useful guidance about mathematical models and solution methods for subsea pipe route selection according to the literature review the subsea pipe route selection can be treated as an optimization problem there are still some issues to be improved 1 a series of identified factors need to be considered such as seabed topography obstacles structural performance and multiphase flow issues however most of the proposed model is limited to one or several factors and the other factors are difficult to be added for example the work of xiao et al 2006 considered multiphase flow but the structural issues such as the pipe curvature could not be treated due to the limitation of the algorithm based on discrete grid nodes therefore it makes sense to build an optimization model which is flexible and convenient to add these related factors according to the user needs 2 metaheuristic algorithms such as the genetic algorithm ga and simulated annealing sa are a popular way of solving this kind of mathematical model if there are too many variables to be solved the stability of the adopted algorithms needs to be discussed and controlled this paper focuses on the above two topics and proposes a nonlinear constrained optimization model for pipe route selection that considers seabed topography obstacles and pipe curvature requirements other related factors could be added into the model as constraints through the model a pipe route with minimum length and corresponding route geometry configuration can be obtained case studies are provided indicating a feasible stable and reliable model the paper is structured as follows section 2 describes the problem and establishes the mathematical model section 3 presents the process of the solution method which combines the augmented lagrangian multiplier method with particle swarm optimization pso and the dynamic programming section 4 presents case studies including both flat and undulating seabeds with multiple obstacles section 5 includes discussions about the stability of the proposed model and comparisons with the dijkstra algorithm as well as suggestions for future work 2 mathematical model 2 1 pipe route geometric description in practical situations the route for a subsea flowline is a smooth continuous curve in this work the smooth curve is simplified as a sequence of nodes and segments fig 1 explains this simplification the pipe route on x y plane is the projection of the real pipe route in 3d space in this work it is assumed that the pipe route follows the seabed landscape so that one projection on x y plane corresponds to a unique pipe route in 3d space as a result the geometric description is basically conducted on x y plane from the top view perspective and the related z coordinates are interpolated according to seabed topography in fig 1 nodes p 0 and p n are the start and end nodes respectively the gray areas are obstacles that the pipe route should avoid therefore a straight connection line from p 0 to p n is not feasible the possible candidate route p 0 p 1 p k p n can be transformed from the original straight line p 0 p n as indicated below the straight line p 0 p n is divided into n segments with equal length the x and y coordinates of p 0 and p n are x 0 y 0 and x n y n respectively the length of each segment l 0 is 1 l 0 p 0 p n n x n x 0 2 y n y 0 2 n and the direction vector of p 0 p n is given by 2 e 0 p 0 p n p 0 p n x n x 0 y n y 0 t x n x 0 2 y n y 0 2 note that the superscript t is the transpose sign which is used to represent the vectors as column vectors in the calculations for any two consecutive nodes p k x k y k and p k 1 x k 1 y k 1 of the candidate route there are two parameters to be defined the interval length l k and the direction vector e k which can be obtained by 3 l k λ l 0 4 e k x e k y e k t cos θ k sin θ k sin θ k cos θ k e 0 the angle θ k is the counterclockwise rotation angle of the vector p k p k 1 relative to the direction vector e 0 as shown in fig 1 therefore 5 0 θ k 2 π the vector p k p k 1 is 6 p k p k 1 l k e k x k 1 x k y k 1 y k t then from eqs 2 4 and 6 7 x k 1 x k λ x n x 0 n cos θ k y n y 0 n sin θ k y k 1 y k λ x n x 0 n sin θ k y n y 0 n cos θ k from eq 7 it is convenient to write down the coordinates of node p k 8 x k x 0 i 1 k λ x n x 0 n cos θ k y n y 0 n sin θ k y k y 0 i 1 k λ x n x 0 n sin θ k y n y 0 n cos θ k k n represents the end node p n which acts as a boundary condition related to the target end point of the pipe 9 i 1 n λ x n x 0 n cos θ k y n y 0 n sin θ k x n x 0 i 1 k λ x n x 0 n sin θ k y n y 0 n cos θ k y n y 0 eqs 8 and 9 together express the pipe route geometry through the variable vector x λ θ 1 θ 2 θ k θ n t in this way the possible candidate route is divided into segments of equal length and different rotation angles if λ 1 and θ 1 θ 2 θ k θ n 0 the pipe route becomes the straight connection line p 0 p n between start and end nodes on the x y plane therefore based on the above description the proper x can be found to determine the best pipe route that satisfies eqs 8 and 9 as well as the other constraints include obstacles pipe structural issues curvature on bottom stability free span etc and fluid hydraulic and thermal behavior as well as other related factors that might affect total cost and pipe reliability meisingset and olsen 2004 the objective is usually to minimize the total cost the simplest and most basic criterion is the shortest pipeline length in addition a shorter pipeline length leads to less pressure and temperature loss of the fluid resulting in less required insulation material and power supply although there are many factors that influence the total cost such as the intervention cost related to eliminating structural risk this paper takes the shortest pipeline length as the optimization object for and initial understanding of subsea pipe route optimization obstacles and pipeline curvature limitations are considered constraints through this kind of simple but typical situation the method and process for optimizing pipe routes are presented 2 2 constraints 2 2 1 boundary constraints the area for the pipe route design is assumed to be rectangular therefore every node on the pipe route remains inside this area then 10 b x x k u b x l b y y k u b y l b x and u b x are the lower and upper boundaries along the x axis respectively and l b y and u b y are the lower and upper boundaries along the y axis respectively substituting eq 8 into 10 gives 11 l b x x 0 i 1 k λ x n x 0 n cos θ k y n y 0 n sin θ k u b x l b y y 0 i 1 k λ x n x 0 n sin θ k y n y 0 n cos θ k u b y to ensure that the pipe route connects to the start node p 0 and the end node p n eq 9 should be satisfied therefore eq 9 is also one of the boundary constraints in addition the ratio λ should be at least 1 indicating that a route should at least be with the same length as the straight connection eq 5 defines the range of the rotation angle θ k therefore 12 λ 1 0 θ k 2 π 2 2 2 obstacles due to the complexity of subsea topography some restricted areas can act as obstacles that should be avoided these areas can be divided into two categories one is line shaped such as existed wirelines and umbilical and other flowlines the other is polygon shaped which represents a closed region such as geohazard regions regions of environmental protection and other developed fields nash 2015 the pipe route must also keep some distance away from these obstacles to ensure the safety of the installation and operation dnvgl rp f107 2017 therefore the obstacles were extended outwards to achieve this requirement as shown in fig 2 fig 2 a and b present the extension of line shaped obstacles and polygon shaped obstacles respectively for the polygon shaped obstacles each edge of the polygon was moved by a distance δ d along its outer normal vector direction the extended edges form a new polygon for the design of the subsea pipe route the extension of line shaped obstacles is similar the difference is the treatment of the head and end nodes as shown in fig 2 b taking the head node for instance the straight line perpendicular to the first edge was moved by a distance δ d along its outer normal vector direction the same treatment was done for the end node then together with the extended edges of the line a polygon is formed the distance δ d is the minimum safe distance between the pipe route and the real obstacles this is a manual set value that can differ between obstacles through this process the two kinds of obstacles were both transformed to polygon shaped for the subsequent pipe route design the next step is to verify the intersections between the segments of the route against the segments of the obstacles the extended polygons therefore a function was defined to represent the intersection between a segment a b and a polygon λ it should be noted that the expression polygon here and in the subsequent text means the area enclosed by the polygon boundary 13 c a b λ 0 a b does not intersect λ 1 a b intersects λ the function c a b λ is determined based on the relationship between segments the detailed process is presented later in this paper the pipe route should avoid all related obstacles this means that the value of the function c applied to any segment of the route and any of the obstacles should be zero which can be represented by eq 14 14 j 1 m k 1 n c p k 1 p k λ j 0 λ j represents the j th obstacle related to the pipe route design and m is the total number of obstacles eq 14 is also related to the variable vector x to apply eq 14 to the optimization the key point is to provide a clear calculation process for the function c shown in eq 13 the process includes two steps the first step is to determine whether the segment end points are inside the polygon and the second step is to figure out the relationship between segment and polygon according to the results from step 1 step 1 relationship between point and polygon there are three kinds of relationships between a point and a polygon as shown in fig 3 a outside the polygon on the edge of the polygon and inside the polygon the criteria for these three relationships are proposed through the angle of the vectors as presented below fig 3 b and c helps explain the detailed process suppose the end point is q as shown in fig 3 b point q and any one of the polygon vertices e k forms a vector q e k using the x and y coordinates of these points the angle α k between the vector and the positive direction of x axis could be represented by eq 15 the range of arctan function is π 2 π 2 and the range of α k is π π as a result the angle α k need to be determined according to the coordinates of the vector as shown in fig 3 b 15 α k arctan y e k y q x e k x q x e k x q 0 arctan y e k y q x e k x q π x e k x q 0 y e k y q 0 arctan y e k y q x e k x q π x e k x q 0 y e k y q 0 where x q y q are the coordinates of point q and x e k y e k are the coordinates of the polygon vertices therefore the rotation angle β k from vector q e k to q e k 1 then could be represented by eq 16 16 β k α k 1 α k k 1 2 n 1 β n α 1 α n then the relationships between point q and the polygon could be determined according to the characteristics of the angle α k and β k 1 if point q coincides with one of the vertices of the polygon point q is on the polygon there is no need of calculating the eq 15 2 if point q does not coincide with any of the vertices but it is on one of the edges of polygon point q is also on the polygon under this condition the two vertices of the edge where the point q is on are collinear with point q therefore the rotation angle between these two vertices will be π or π depending on the arrangement of polygon vertices this condition could be represented by eq 17 17 max β k π 3 if point q is inside the polygon through fig 3 c there is 18 k 1 n β k 2 π 4 if eq 18 is not satisfied point q is outside the polygon step 2 relationship between segment and polygon considering the pipe route search criteria if part of the segment is inside the polygon the segment intersects the polygon it is acceptable that the segment be totally on the polygon as a result the preliminary results of the value of function c can be obtained by determining the relationship between polygon λ and the two end points of segment a b as shown in table 1 two positions are left undetermined in this table both a and b are outside polygon λ and both points a and b are on polygon λ these two scenarios need further discussion because they include several different situations and are thus more complicated as shown in fig 4 to discuss these two scenarios the relationship between two segments is first analyzed as shown in fig 4 there are two segments a b and p q on the x y plane the x and y coordinates are known there are four kinds of relationships between two segments on the x y plane a strictly intersecting b separated from each other c the end of one segment is on the other and d the two segments partially or totally coincide the last three are defined as not intersecting let 19 c 1 a p a q b p b q c 2 p a p b q a q b then it is easy to recognize these four relationships through the values of c 1 and c 2 as shown in table 2 for the two undetermined scenarios shown in table 1 the relationship between segments and polygons are illustrated in fig 5 each relation could be described by the recognition method presented in eq 19 and table 2 if both points a and b are outside polygon λ eq 19 should be applied to determine whether segment a b intersects any edges of the polygon if none of the edges strictly intersect a b c a b λ 0 as shown in a 2 of fig 5 otherwise c a b λ 1 as shown in a 1 if both points a and b are on polygon λ there are four different possible situations with convex polygon and concave polygons as shown in fig 5 first eq 19 is applied to determine whether segment a b strictly intersects any edge of the polygon if so it must be situation b 4 and c a b λ 1 otherwise if segment a b does not strictly intersect any edge of the polygon the relationship might be b 1 b 2 or b 3 the situation shown in fig 6 is also possible under the condition of a concave polygon to deal with these situations it is necessary to find out all the vertices of the polygon that are on segment a b except its end points for example in fig 6 it is found that segment a b passes some of the polygon vertices these vertices divide a b into several sub segments if the middle points of all the sub segments lies outside the polygon according to the rules proposed above segment a b does not intersects the polygon c a b λ 0 as shown in the right figure of fig 6 otherwise c a b λ 1 as shown in the left figure through this process the undetermined positions in table 1 can be achieved and then the table can be applied to the proposed route optimization model since the value of function c is either 0 or 1 eq 14 will always provide integer values indicating that it is not continuous the calculation process for function c is a little complicated but it is easy to achieve with the help of computer programming besides in this work polygons represent seabed obstacles and the strange shape shown in fig 6 might not appear frequently however these shapes were all included in the analysis to provide a comprehensive calculation process 2 2 3 horizontal curvature the subsea pipe usually presents a curved shape indicating curvature too much curvature results in pipe buckling or collapse dnv os f101 2013 therefore there is a maximum value for the route curvature the curvature of the pipe route includes two parts one is the horizontal curvature which results from the requirement of avoiding restricted regions such as the subsea obstacles discussed above the other is vertical curvature which is mainly due to the undulating seabed the pipe route follows as well as the gravity effect of the pipe line if free span occurs meisingset and olsen 2004 since seabed elevation variation is usually not very large compared with the width and length of the target region and this work deals with a flexible pipe so that free span is not considered the effect of the vertical curvature is much smaller than that of the horizontal curvature therefore in this research only the horizontal curvature constraint was considered using the method of polynomial approximation if a curve on the x y plane is given by y f x the radius of curvature r is 20 r 1 d y d x 2 3 2 d 2 y d x 2 however in our model the pipe route is discretized as segments and nodes as shown in fig 1 so the first derivative at each node of the route is not continuous which makes eq 20 unable to be applied as a result the polynomial interpolation method was applied here to make the pipe route smooth parametric equations based on arc length were used to obtain the route curvature at each node since in this work only horizontal curvature is considered then we could focus on the pipe route projection on the x y plane as indicated above in practical situation the pipe is a smooth curve so its projection on the x y plane is also a smooth curve beginning from the start of the pipe each point on the pipe route corresponds to an arc length of the route projection which is represented by s in the proposed model those discrete nodes p 0 p 1 p k p n are on the curve and we use different subscripts to distinguish these different nodes for example s k represents the arc length from the k th node p k to the start node p 0 obviously s 0 0 according to this definition the total length of the segments on the x y plane between node p k and p 0 could be used to approximate the arc length s k which is shown by eq 21 21 s k i 1 k p k 1 p k k λ x n x 0 2 y n y 0 2 n k λ l 0 then for any consecutive three nodes p k 1 p k and p k 1 the correspondence between the arc length s and the x and y coordinates are shown in table 3 according to this table both the x and y coordinates on the continuous curve that passes these three nodes could be regarded as the function of the corresponding arc length therefore the curve could be represented by the parametric equation x x s y y s as shown in fig 7 therefore lagrangian interpolation is applied to approximate the parametric equation which is shown in eq 22 22 x s s s k s s k 1 s k 1 s k s k 1 s k 1 x k 1 s s k 1 s s k 1 s k s k 1 s k s k 1 x k s s k 1 s s k s k 1 s k 1 s k 1 s k x k 1 y s s s k s s k 1 s k 1 s k s k 1 s k 1 y k 1 s s k 1 s s k 1 s k s k 1 s k s k 1 y k s s k 1 s s k s k 1 s k 1 s k 1 s k y k 1 s s k 1 s k 1 substituting eq 21 in 22 gives 23 x s s s k s s k 1 2 λ 2 l 0 2 x k 1 s s k 1 s s k 1 λ 2 l 0 2 x k s s k 1 s s k 2 λ 2 l 0 2 x k 1 y s s s k s s k 1 2 λ 2 l 0 2 y k 1 s s k 1 s s k 1 λ 2 l 0 2 y k s s k 1 s s k 2 λ 2 l 0 2 y k 1 note that x x 0 y y 0 corresponds to the start node and s 0 0 eq 23 provides a smooth curve connecting the consecutive three nodes then the relationship between the arc length and the x and y coordinates could be built up the radius curvature at the k th node p k could be obtained by eq 24 24 r k d x d s 2 d y d s 2 3 2 d x d s d 2 y d s 2 d 2 x d s 2 d y d s s s k then from eqs 23 and 24 after a series of calculations eq 25 is derived 25 1 r k x k 1 x k 1 y k 1 y k 1 2 y k x k 1 x k 1 2 y k 1 y k 1 2 3 2 y k 1 y k 1 x k 1 x k 1 2 x k x k 1 x k 1 2 y k 1 y k 1 2 3 2 according to the above discussion there is a maximum horizontal curvature for the subsea pipe that corresponds to the minimum radius of curvature which is denoted by r min then 26 r k r min which could also be represented as 27 min r k r min 0 0 then for the nodes from p 1 to p n 1 the nodes between the start and the end the radius of curvature at each node should all satisfy eq 27 therefore 28 k 1 n 1 min r k r m i n 0 0 eqs 8 and 25 indicates that the right side of eq 28 is also a function of the variable vector x 2 3 objective function the aim of the objective function is to find the minimum pipe length this work deals with a flexible pipe so the pipeline route follows the seabed landscape hong et al 2018 and free span is usually not a problem consequently the pipe length is the same as the route length on the seabed surface the actual continuous seabed topography is represented by discrete data which are a set of interconnected points or nodes denoted by coordinates x y z x and y are coordinates on the x y plane and z is the corresponding water depth fig 8 shows an example of seabed topography since the pipe route geometric parameterization and the related constraints are all set up on x y plane from the top view perspective the z coordinate of the route must be calculated to obtain the pipe length first the z coordinate of each node is calculated for node p k x k y k the z coordinate z k can be interpolated according to the subsea topography data function g represents the interpolation function there are a several possible methods such as linear quadratic and spline interpolations the spline interpolation method was selected in this work 29 z k g x k y k since the pipe route geometric description presented in section 2 1 is on the x y plane which is independent from the seabed topography it is possible that the segment between two consecutive nodes crosses the local peak or valley of the seabed fig 9 presents an example to explain the problem fig 9 a shows the top view of a segment connecting nodes a and b on the x y plane the nearby seabed discrete nodes form the rectangle a b c d e f which is a projection of the actual seabed surface a b c d e f as shown in fig 9 b nodes a and b are the projections of a and b on the actual surface respectively and b e acts as a peak edge considering that this work applies to flexible pipes the above explanation indicates that the length of the straight segment a b is not the real length of the route between a and b instead an extra node c needs to be inserted at the intersection between a b and b e this is the projection of c on the seabed surface for this extra node either of the x and y coordinates is already given by the seabed topography in this example the x coordinate of node c is known because it is on the edge of b e the other coordinate can be obtained through linear interpolation then eq 29 is used to obtain the z coordinate of c therefore the length of the pipe route on the seabed between node a and b is 30 l a b a c c b based on this assumption a series of extra nodes can be inserted between any consecutive nodes of the pipe route expressed by eqs 8 and 9 to make the route follow the seabed topography fig 9 c shows a more general condition that the connection between node p k 1 and p k crosses a series of the grid edges of the discrete seabed between nodes p k 1 and p k k 1 2 n the extra inserted nodes are represented by a 1 k a 2 k a 3 k a n k k which can be obtained from the subsea topography and the coordinates of p k and p k 1 then the length of the route between node p k 1 and p k is 31 l p k 1 p k p k 1 a 1 k j 1 n 1 a j k a j 1 k a n k k p k therefore the total pipe route length is 32 l p k 1 n l p k 1 p k k 1 n p k 1 a 1 k j 1 n k 1 a j k a j 1 k a n k k p k considering the description about the pipe route it is easy to find that l p is a function of the variable vector x x λ θ 1 θ 2 θ k θ n t as result the objective function can be represented by 33 min l p f λ θ 1 θ 2 θ k θ n function f is short for eq 32 so far both the objective function and related constraints have been obtained the main expressions are briefly summarized in table 4 these expressions indicate that the proposed mathematical model is a nonlinear constrained single object optimization model with four equalities and 3 n 1 inequalities of constraints the input parameters include seabed topography the start and end node positions and the segment number n the output results include the minimum pipe route length and the corresponding pipe route geometry obviously the objective function and the constraints are all functions of x the four equality constraints could be put together represented by h i x where i 1 2 3 4 one h i x stands for one equality constraint similarly the 3 n 1 inequality constraints are represented by g j x where j 1 2 3 n 1 therefore the mathematical model can be simply expressed as follows 34 min l p f x s t h i x 0 i 1 2 3 4 g j x 0 j 1 2 3 n 1 3 model solutions 3 1 the augmented lagrangian multiplier method as indicated above the proposed mathematical model is a non linear single objective optimization model to solve it the augmented lagrangian multiplier method is adopted to transform the model into a series of unconstrained optimization subproblems which are more convenient to solve this section presents the solution process based on eq 34 the augmented lagrangian multiplier method is a modification of the original lagrangian multiplier method in which quadratic penalty terms are added to improve the convergence performance rockafellar 1973 based on eq 34 the augmented lagrangian multiplier function is built as shown by eq 35 35 q t x m t u t v t f x m t 2 i 1 n h h i 2 x i 1 n h u i t h i x 1 2 m t j 1 n g max 0 v j t m t g j x 2 v j t 2 the superscript t is the iteration steps m is the penalty factor which is a scalar quantity u u 1 u 2 u n h is the lagrange multiplier vector for the equality constraints and the vector length is n h in this work n h 4 v v 1 v 2 v n g is the lagrange multiplier vector for the inequality constraints and the vector length is n g then n g 3 n 1 at the right side of the equation the second and third terms together deal with the equality constraints and the fourth term deals with the inequality constraints an auxiliary function shown in eq 36 was defined to put all the equality and inequality constraints together to help decide the convergence criteria 36 h r x h r x r 1 2 n h 1 m t min v r n h t m t g r n h x r n h 1 n h 2 n h n g the related mechanism and proof process can been seen in the work by rockafellar 1973 which presents the steps of how to use the augmented lagrangian multiplier method as summarized below step 1 set the initial value x 0 the initial penalty factor m 1 the initial lagrange multiplier vectors u 1 and v 1 the amplification factor α used to update penalty factor the tolerance ε and the constant γ 0 1 used to check the convergence speed set t 1 step 2 start from the initial value x t 1 find the solution x t of the unconstrained optimization problem q t x m t u t v t step 3 check the convergence criteria if h r x t ε the iteration stops and x t is the solution of the original problem f x otherwise move to step 4 step 4 check the convergence speed if h r x t γ h r x t 1 update m t by m t 1 α m t and move to step 5 otherwise m t 1 m t and move to step 5 step 5 update the lagrange multipliers through u i t 1 u i t m t h i x t and v i t 1 max 0 v j t m t g j x t and let t t 1 return to step 2 in this process one of the most important steps is solving the unconstrained problem q t x m t u t v t at each iteration several methods have been proposed to solve unconstrained optimization problems however the constraint function for avoiding obstacles is not continuous as shown in section 2 so methods that rely on the function gradient are not available therefore metaheuristic optimization algorithms such as ga sa and pso are better alternatives these algorithms do not require continuous and explicit expressions for the related constraints and objectives in this work pso was selected to solve these unconstrained sub problems 3 2 the particle swarm optimization algorithm pso was introduced by eberhart and kennedy 1995 it is one of the metaheuristic algorithms inspired by the swarming behavior as displayed by a flock of birds pso consists of a swarm of particles moving in an n dimensional real valued search space of possible problem solutions the dimension number n is the same as the number of variables to be found while the variable vector is x each particle has a position vector v which is used for representing a candidate solution to the problem there are two important positions one is the global best position of all the particles seen so far g k t of which k t is the present iteration step the other is the local best position of each particle seen so far p i k t the i th particle s velocity in the next iteration is updated based on the particle s velocity at the present iteration together with the above mentioned two positions then the particle moves to a new position in the next iteration the update rules are denoted by eq 37 37 v i k t 1 ω v i k t c 1 r 1 p i k t x i k t c 2 r 2 g k t x i k t x i k t 1 x i k t v i k t 1 where ω is the weight factor of present velocity and r 1 and r 2 are acceleration factors which are non negative constants c 1 and c 2 are random numbers distributed within 0 1 through this kind of updating rule the information about better solutions spreads through the swarm and the particles tend to move to increasingly better positions in the search space the algorithm is initialized by assigning each particle a uniformly and randomly chosen position in the search space and the velocities are initialized randomly in the range v m a x v m a x this range is also used to constrain the velocity in the whole iteration process the mechanism of pso is easy to understand but its convergence performance and stability should be carefully dealt with researchers have improved its performance by designing proper values of ω r 1 and r 2 eberhart and shi 2000 or by combinations with other algorithms such as ga ghorbani et al 2018 considering that the main purpose of this work is to solve the proposed mathematic model rather than deeply investigating issues about the algorithm itself the pso toolbox in matlab was used which is a robust package developed for practical applications 3 3 post treatment through dynamic programming it should be noted that the characteristics of pso algorithm will bring some uncertainty to the optimization process on one hand pso algorithm is with random process during the calculation as can be seen in eq 37 the factors r 1 and r 2 are two randomly chosen parameter which will bring different results while repeating the optimization calculation therefore the stability of the algorithm needs to be checked before application this will be presented in section 4 on the other hand in limited iteration steps if the number of decision variables is small pso could provide the optimal solution but when there are too many decision variables the calculation usually results in relatively better solution which we call sub optimal rather than the strictly optimal one therefore in this work if the segment number n is larger there will be more decision variables and possibly the sub optimal solution will be obtained through the above solution process which makes the pipe route present a slightly saw tooth shape in section 4 some calculation cases are presented to show this phenomenon fig 10 illustrate a simple example to help explain route from p h to p e is obtained through the proposed solution method the interval from node p h to node c p h a b c presents such saw tooth shape and obviously the straight connection from p h to c which is shown by the pink dotted line is better than the original and node a and b are regarded as redundant node which could be eliminated therefore the original route is the sub optimal and we could find better route through correctly eliminating the redundant nodes based on this idea dynamic programming is applied to conduct a post treatment process for the obtained optimized route in order to reduce the saw tooth shape thus achieving a better route dynamic programming is a kind of method which breaks a complicated problem down into series of simple sub problems in a recursive manner dreyfus 1969 suppose a 0 a 1 a 2 a n is the route node sequence which is the optimization result of the above proposed solution method these nodes are taken as the candidate nodes and what we need to do is to find out the nodes from these candidates which results in the shortest length from the head to the end nodes starting from a 0 o p t a 0 a i represents the shortest route length from a 0 to the i th node a i then dynamic programming process is represented by eq 38 38 o p t a 0 a i min o p t a 0 a j w a j a i j 1 i 1 w a j a i is the distance between the j th and i th node if the connection between a j and a i satisfies all corresponding proposed constraints such as not crossing the obstacles w a j a i is calculated through eq 31 considering the seabed elevation otherwise w a j a i is assigned a large number to indicate it is not feasible when i 1 obviously o p t a 0 a 1 is the route length between a 0 and a 1 because there is no other option this provides the initial condition for the determination of the shortest route between a 0 and the subsequent nodes beginning from i 1 continuously using eq 38 until i n the output o p t a 0 a n and the corresponding node coordinates are the desired results in subsequent section the calculation results with and without this proposed post treatment process are compared to indicate its performance 3 4 the overall solution process as discussed above the proposed nonlinear constrained optimization model can be solved by the augmented lagrangian multiplier method coupled with the pso algorithm the solution method contains two loops of iteration each outer iteration step calculates the unconstrained augmented lagrangian multiplier function and includes the inner required iterative process using the pso algorithm since pso algorithm always brings sub optimal solution to overcome this the obtained optimized route is regarded as the basic result dynamic programming is applied to conduct a post treatment process to screen the nodes of the basic results removing the redundant nodes and reducing the possible saw tooth shape thus achieving better route with shorter length for pipe route optimization there are also some pre treatment processes such as extending the obstacles as presented in section 2 fig 11 shows the overall process to solve the proposed optimization model the calculations were conducted on a computer with 4 gb of ram memory and a 2 6 ghz intel core i5 processor 4 case study 4 1 a simple case flat seabed to validate the proposed mathematic model the simple flat seabed case was considered initially since this simple case was for checking the reliability of the mathematic model and the algorithm the process of the obstacle extension was temporarily not considered to simplify the calculations as shown in fig 12 there is a rectangular area with four vertices of a 1 1 b 21 1 c 21 21 and d 1 21 a rectangle obstacle is inside the area presented by the gray color in fig 12 the four vertices of the rectangle are 12 4 15 4 15 16 and 12 16 respectively the route starts at p s 2 3 and ends at p e 20 20 to start the calculation a randomly selected initial route is input and the other related initial parameters are listed in table 5 note that the lagrangian multipliers are vectors with lengths equal to the number of equality and inequality constraints respectively and the initial value is set to be 0 2 for all members so in table 5 they are represented by one value for simplicity it is easy to figure out the route with minimum length from p s to m one of the obstacle vertices and finally to p e which is presented by a black dotted line in fig 12 its length is 25 345 different segment numbers were input to the optimization model to calculate the routes with minimum length under each segment number the calculation is repeated for 100 times the results without and with the post treatment process are compared from the 100 times calculation results under different segment numbers one for each is picked out and the pipe routes are shown in fig 12 a and the corresponding post treated routes are presented in fig 12 b in fig 12 a the saw tooth shape as mentioned above occurs if the segment number is small the saw tooth shape is not very significant for example when n 5 and if the segment number is larger this shape is more obvious for example when n 40 therefore the proposed post treatment process effectively reduces the saw tooth shape compensating the solution variations brought by pso algorithm which makes the found route better fig 13 a and b present all the 100 times calculation of optimized route length without and with the post treatment process respectively and table 6 lists the general statistical results the y axis of fig 13 a and b is chosen to be in the same scale in order to show the differences fig 13 a indicates that repeating the calculation brings different results of the route length most of the values concentrate between 25 4 and 26 6 the gap is not very big which is about 4 7 of the theoretical optimal value 13 b shows that the post treatment process through dynamic programming brings significant improvements to the optimization results the route lengths concentrate between 25 3 and 25 7 which are furtherly closer to the theoretical optimal value the statistical analysis in table 6 provides a quantified view without the post treatment the difference between maximum and minimum value is small and close to the theoretical optimal value indicating the reliability of the proposed model and algorithm besides the standard deviation is small either indicating that repeating calculation will not bring big variation to the results therefore the proposed model and algorithm is stable after the post treatment every index turns out to be better which means that the results become more reliable and stable besides table 6 also indicates that larger segment leads to better pipe route when including the post treatment when the segment number is more significant it is possible for the internal nodes to be close to the critical nodes that make the route avoid obstacles in this case point m is the critical node and when n 5 the internal nodes on the routes are some distance away from point m while n 40 some internal nodes are closer to m which makes the route better however without the post treatment process since pso algorithm leads to the sawtooth shape of the route this issue is covered and not found as a result the post treatment process helps increase the advantage of choosing a more significant segment number when optimizing the route the effectiveness of the proposed model and algorithm is checked through a single flat plane indicating reliability and stability moreover the post treatment process further makes the result better therefore the proposed model and algorithm could be applied to the optimization of pipe routes on an undulating seabed 4 2 pipe route on undulating seabed a 7 km length and 7 km width subsea area with two line shape obstacles and two polynomial obstacles are provided as an example of applying the proposed pipe route optimization model the water depth ranges from 1500 m to 1600 m the seabed bathymetry is digitized by 80 80 nodes a flexible pipe is installed to connect the start point p s 7 6566 7 8253 and the end point p e 1 2271 1 1398 the z coordinates can be interpolated through the digitized seabed bathymetry the minimum allowable lateral curvature radius of the subsea pipe is 300 m in addition as mentioned in section 2 the original obstacles were extended outwards the extension distance was set to be 100 m as the safety distance fig 14 presents the seabed bathymetry and the obstacle distribution with both 3d perspective and top view similar to the simple case in section 4 1 the initial parameters were set for the optimization calculation the number of segments n 5 and the initial route was selected to be the straight connection between the start and end points on the x y plane which means the initial variable vector is x 0 1 0 0 0 0 0 other related parameters are the same as in table 5 starting with these initial values the calculation takes about 8 min in the matlab environment fig 15 presents the optimization results in both 3d perspective and top view the black line is the route and the blue dots are the internal nodes corresponding to the given segment number n 5 the route follows the seabed landscape which is consistent with assuming a flexible pipe as indicated in section 2 the optimized route avoids all obstacles and meets the requirement of safety distance the solution is x 1 0624 0 4545 0 5 7342 6 1171 0 2507 and the corresponding pipe route nodes coordinates are listed in table 7 the pipe route length is 9 8629 km the optimization is an iterative process as discussed in section 3 fig 16 presents the optimization evolution process the x axis is the iteration step and the y axis is the corresponding optimal value for the augmented lagrangian function through the pso algorithm beginning from the initial input parameters the function value quickly approaches the final optimal value at the second step oscillates around and finally arrives at the optimal value after 79 iteration steps indicating good convergence performance again note that while the optimized route is suboptimal as it is slightly different from the strict global optimal value the result is appropriate and accurate enough for engineering applications 5 discussions 5 1 comparison with the dijkstra algorithm as discussed in section 1 many algorithms can help determine the pipe route by finding proper nodes from the discrete seabed topography such as the dijkstra algorithm and ant colony optimization an obvious problem of these algorithms is that the resolution of seabed topography might cause differences in the optimized route because the internal route nodes are the discrete nodes of the seabed topography but for the proposed optimization model in this work though discrete seabed topography is used the decision variables are searched in continuous space and the internal nodes of the route is not limited by the nodes of the seabed discretization to check the difference between them in detail one of the typical path finding algorithms the dijkstra algorithm is selected as representative to compare with the proposed model the dijkstra algorithm is one of the earliest and best known algorithms for finding the shortest path between two nodes in a graph dijkstra 1959 it can be applied to find a subsea pipe route hong et al 2018 based on seabed topography when applying the algorithm for any node the neighboring eight nodes are defined as candidates to be searched including horizontal vertical and oblique directions as shown in fig 17 a in addition the nodes inside the obstacle regions are unavailable and thus avoided as shown in fig 17 b beginning from the starting node the algorithm spreads out to visit all the available candidate nodes calculating the minimum accumulating weight of each node the process continues until the target node is reached both the proposed optimization model and the dijkstra algorithm were applied to two different resolutions of seabed topography one with an 80 80 grid and the other with a 20 20 grid the 20 20 grid was obtained by coarsening the 80 80 one to maintain the major undulating characteristics for the proposed model the segment number is chosen to be n 5 fig 18 presents the optimization results fig 18 a and b present the comparison of the optimized routes through the proposed model and dijkstra algorithm under both 80 80 grid and 20 20 grid seabed topographies respectively and the route lengths are presented in table 8 under the same resolution of seabed topography the optimized routes of the proposed model and dijkstra algorithm are different according to table 8 the pipe route length from the dijkstra algorithm is about 5 6 larger than that from the proposed model and the shapes of the pipe routes are also different the differences are caused by the different searching mechanism for the route nodes of the proposed model and the dijkstra algorithm for the dijkstra algorithm the route nodes only come from the discrete seabed nodes so the information of other points on the seabed are not included which might lead to missing the better route instead the proposed model allows searching for the nodes of the pipe route continuously on the seabed which is more comprehensive and allows finding the route with the minimum length besides for the dijkstra algorithm the inflection angle of the pipe route is restricted to 135 due to the around eight nodes searching rule although one can increase the number of around candidate nodes to for example sixteen nodes zhang et al 2017 the inflection angle is also restricted to several fixed values instead for the proposed model the nodes of the route are searched in the continuous space so the inflection is not limited to fixed values therefore the shapes of the optimized routes of the two algorithms are different furthermore since the proposed model is not limited to fixed values for the inflection angle the minimum pipe curvature radius could be taken into consideration when optimizing the pipe route which is set as one of the constraints as indicated in section 2 but dijkstra algorithm cannot deal with this issue due to the limitation of inflection angle the proposed model takes about 439 s to complete the calculation while dijkstra algorithm only takes about 4s under 80 80 grid of seabed resolution if the segment number is higher the time taken by the proposed model will be even longer but as indicated above the proposed model is free from the limitation of route inflection angle as well as the seabed discrete nodes the result is closer to practical engineering scenarios table 8 also shows that for either the proposed model or the dijkstra algorithm the pipe route lengths under different seabed resolutions are close to each other this is mainly because the seabed with low resolution still maintains the major seabed undulation characteristics therefore pipe route optimization based on a seabed topography with relatively low resolution but reliable information can provide reliable results 5 2 effect of segment number note that in the above cases segment number n is chosen to be 5 and the post treatment process does not make any difference because the number of segment is relatively small when applying dynamic programming to screening the internal nodes all of them should be picked to avoid obstacles and meet the curvature requirement to see the effect on the segment number as well as how the post treatment process behaves segment number n 5 10 20 30 and 40 are selected under each segment number the calculation is repeated 10 times fig 19 presents the routes obtained from the proposed method without and with the post treatment process respectively which are picked from the 10 times calculation results similar to the cases presented in section 4 1 without the post treatment process the saw tooth shape of the route occurs while after the post treatment process the route becomes better the average calculation time under each segment number is listed in table 9 larger segment number leads to longer calculation time due to more decision variables the statistical analysis of all the calculation results are presented in table 10 compared with the route lengths without post treatment process the maximum minimum mean and the standard deviation of the route lengths are all lower indicating that the post treatment process provides better results besides after the post treatment process larger segment number makes the mean value of the route length lower as well as the standard deviation indicating that larger segment number brings better results the reason is the same as presented in section 4 1 in fig 19 it is easy to find that the nodes close to the obstacle edge are the critical nodes and larger segment number has more probability to find out the nodes of the route that are closer to these critical nodes which provides better optimized route the calculation results show that the proposed optimization process which is the pso based augmented lagrangian multiplier method followed by dynamic programming as post treatment is reliable and stable and could be applied to actual engineering scenarios larger segment number leads to better route length but at the same time the calculation time will be longer in this case n 20 or 30 is good enough to obtain appropriate results 5 3 comments on the optimization model 5 3 1 about the objective function the aim was to find the pipe route with minimum length this is only one part of the pipe route selection besides the pipe route length reducing pipe costs includes many other aspects such as possible investment for eliminating potential structural risk the cost of providing enough pressure drop to transport the fluid the cost of flow assurance etc theoretically taking more aspects related to the cost could make the optimized pipe route more reliable for both cost estimation and safety operation for example in the above discussion it was found that seabed elevation does not much affect the pipe route length because the elevation variation is much smaller than the length and width of the area but when the cost of pressure drop needs to be considered the undulating pipe route profile will affect the pressure drop significantly and the seabed elevation variation might be a very important point in future research these related aspects should be considered step by step the present work only considers the simplest object pipe length to provide an initial understanding of pipe route optimization 5 3 2 about the constraints the constraints in the proposed optimization model can be divided into two categories the first is the geometry configuration such as the variable boundaries and node coordinates restrictions this category is mandatory since it defines a geometrically completed pipe route the second is related to engineering requirements coupling practical scenarios with the optimization process related issues from practical situations could be added into the optimization model through proper mathematical descriptions for instance this work provides a fixed allowable pipe curvature radius but in practice it is related to many factors such as pipe stress and seabed soil friction therefore these more complex parameters could be added into the model by building up the relationship between them and the curvature radius to make the optimization model much closer to the reality 5 3 3 about the solution method the solution method is summarized as pso based augmented lagrangian multiplier method followed by dynamic programming augmented lagrangian multiplier method is applied to deal with the related constraints of the proposed mathematical model and pso algorithm is used to solve the augmented lagrangian function the obtained pipe route is taken as the basic route and dynamic programming is applied as a post treatment process to further optimize the basic route by screening the nodes on the basic route thus achieving the final result pso algorithm has good capacity of global search which helps obtaining a good pipe route and the dynamic programming acts as a local search which provides further optimized results combining the two algorithms brings excellent calculation performance as indicated by the presented cases another issue to be noted is that when building up the mathematical model the pipe route is divided into several segments with equal length after the post treatment process the nodes are screened and the redundant nodes are removed to provide a better route after removing the redundant nodes the segment lengths of the final optimized route will not be equal 6 conclusions in this work a nonlinear constrained optimization model was established to help find the best subsea pipe route the model can give the pipe route with minimum length and corresponding route geometry configuration the way of determining the intersection between the pipe route and obstacles was also provided a framework of pso based augmented lagrangian multiplier method followed by dynamic programming was established to solve the proposed model case studies on flat and undulating seabed were presented comparison of the results without and with the post treatment process by dynamic programming is presented pso algorithm might bring some variation to the results but dynamic programming helps to reduce the variation and provides better results indicating the feasibility reliability and stability of the proposed solution method the proposed model was compared with the dijkstra algorithm although the proposed model needs much longer time to solve it is free of the limitation of route inflection angle as well as the seabed discrete nodes while dijkstra algorithm is not therefore the proposed model can represent the reality with more accuracy for practical engineering scenarios the research work will be extended to incorporate other relevant parameters that can influence pipe route optimization such as pipe structural ultimate behavior and flow assurance thermal restrictions acknowledgments the authors acknowledge the financial support provided by petrogal brazil anp r d program contract no peno 18636 and embrapii coppe unit in subsea technology contract no peno 19143 for the development of the research project subsea systems sistsub special thanks to capes and the china scholarship council for supporting the first and fourth authors respectively thanks also to the brazilian research council cnpq for supporting the research activities of the second author on subsea technology 
22676,subsea pipe route selection is very complex which involves several issues due to the complicated sea environment a properly selected subsea pipe route could help reduce costs and meet engineering requirements while simultaneously considering the related requirements this task becomes a complicated optimization problem this paper proposes a nonlinear constrained optimization model for selecting pipe route with minimum length that considers seabed topography obstacles and pipe curvature requirements besides the process of determining the intersection between the pipe route and obstacles is presented the particle swarm optimization based augmented lagrangian multiplier method followed by dynamic programming is applied to solve the proposed model both flat and undulating seabed with obstacles were considered for the case studies and the proposed model was compared with dijkstra algorithm indicating the feasibility stability and reliability of the proposed model and solution method this work provides an initial understanding of pipe route optimization and other engineering requirements related to safety and cost can be easily added to the proposed model making the proposed model flexible to the needs of users for different application scenarios keywords pipe route optimization seabed topography and obstacles pipe curvature augmented lagrangian multiplier method particle swarm optimization pso dynamic programming 1 introduction 1 1 background offshore deep water oil fields have been continuously discovered in recent years especially in brazil buckley and uehara 2017 the gulf of mexico duncan et al 2018 west africa thomson et al 2013 and the north sea guerrero and stephen 2018 to develop these fields subsea pipes have been installed on the seabed providing the flow path among wellheads related subsea facilities manifold subsea pump etc and the receiving terminals such as the floating production storage and offloading unit fpso for produced fluids from the reservoir safety and reliability issues of subsea pipes immediately affect the production performance and the sea environment additionally the cost of subsea pipes occupies a large proportion of project capital expenditure capex in offshore fields beltrao 1995 kaiser 2017 considering the volatility of oil prices reducing the cost of subsea pipes is crucial for a competitive offshore project subsea pipe route selection is one of the earliest and most critical tasks traditionally pipe route selection is performed manually depending on the expertise of the engineers since it is a very complex task involving a variety of issues researchers have recognized that the selection of a subsea pipe route with good performance and low cost can be formally described and treated as a synthesis of optimization problems meisingset and olsen 2004 this paper focuses on this topic aiming at optimizing the pipe route on the undulating seabed for cost reduction under several engineering requirements 1 2 related work the earliest research related to oil pipe route optimization dates back to shamir 1971 he considered that there was a maximum available pressure drop of the two phase flow between the head and terminal points under this constraint an oil pipe route was optimized for minimum total cost through dynamic programming this work is very basic and several other constraints such as obstacles pipe curvature and structural issues still need to be considered however shamir s study indicates the possibility of optimizing oil pipe routes while incorporating engineering requirements meisingset and olsen 2004 set minimum cost as the object function and summarized the factors that need to be considered including route length free spans obstacles lateral stability pipe curvature and the vertical undulation the parameters related to the cost were chosen as a set of dimensionless variables reflecting the relative importance of the different terms the model was solved through simulated annealing algorithm the study provided a synthetic structure for linking the related engineering requirements to pipe route optimization xiao et al 2006 focused on the relationship between pipe route and the hydraulic behavior of multiphase flow they desired to find a proper pipe route that balances pipe cost and pressure loss as well as liquid inventory the pressure drop of multiphase flow was not directly calculated instead it was expressed by the ground undulations considering that high pressure drops are caused by variations in seabed elevation the dijkstra algorithm a typical way of finding a path on graphs with nodes and edges was applied to solve the proposed model kang and lee 2017 also applied this algorithm to optimize a subsea pipe route and they also used the laplacian smoothing algorithm to make the route smoother smoothing routes was also studied by berglund et al 2003 and donatelli et al 2017 baeza et al 2017 compared the applications of the dijkstra algorithm and ant colony optimization aco and discussed the advantages and limitations of both algorithms vieira et al 2010 established a subsea pipe route optimization model by dividing the pipe into a set of straight lines and curves in this way the pipe route could be determined by obtaining the length of the straight lines and radius of the curves genetic algorithm ga was applied to solve the model and different constraint handling methods in the ga were discussed de lucena et al 2014 the proposed model was employed for pipe route design under a series of constraints such as seabed topography obstacles on bottom stability and vortex induced vibration viv fatigue with the aim of minimizing total length rocha et al 2015 baioco et al 2015 2017 2018 the model was a huge optimization problem to be solved when all considerations are put together zhou et al 2017 also used ga to optimize the pipe route while considering gas liquid two phase flow in combination with beggs brill correlations for pressure drop other aspects related to pipe route optimization have also been studied such as the uncertainty of seabed information haneberg 2015 devine et al 2016 the quantified classification of factors that need to be considered in pipe route design balogun et al 2015 and the treatment methods of slope and curvature de smith 2006 these studies provide a reliable and applicable basis for pipe route optimization furthermore subsea pipe route selection is actually a kind of path finding problem which is widely seen in vehicle route design and robot planning contreras cruz et al 2015 wang and ju 2015 niu et al 2018 zhang et al 2018 proposed a comprehensive risk assessment model through assigning different weight factors to related impact issues to select the optimal route for hazardous liquid railway network related research in these areas might provide useful guidance about mathematical models and solution methods for subsea pipe route selection according to the literature review the subsea pipe route selection can be treated as an optimization problem there are still some issues to be improved 1 a series of identified factors need to be considered such as seabed topography obstacles structural performance and multiphase flow issues however most of the proposed model is limited to one or several factors and the other factors are difficult to be added for example the work of xiao et al 2006 considered multiphase flow but the structural issues such as the pipe curvature could not be treated due to the limitation of the algorithm based on discrete grid nodes therefore it makes sense to build an optimization model which is flexible and convenient to add these related factors according to the user needs 2 metaheuristic algorithms such as the genetic algorithm ga and simulated annealing sa are a popular way of solving this kind of mathematical model if there are too many variables to be solved the stability of the adopted algorithms needs to be discussed and controlled this paper focuses on the above two topics and proposes a nonlinear constrained optimization model for pipe route selection that considers seabed topography obstacles and pipe curvature requirements other related factors could be added into the model as constraints through the model a pipe route with minimum length and corresponding route geometry configuration can be obtained case studies are provided indicating a feasible stable and reliable model the paper is structured as follows section 2 describes the problem and establishes the mathematical model section 3 presents the process of the solution method which combines the augmented lagrangian multiplier method with particle swarm optimization pso and the dynamic programming section 4 presents case studies including both flat and undulating seabeds with multiple obstacles section 5 includes discussions about the stability of the proposed model and comparisons with the dijkstra algorithm as well as suggestions for future work 2 mathematical model 2 1 pipe route geometric description in practical situations the route for a subsea flowline is a smooth continuous curve in this work the smooth curve is simplified as a sequence of nodes and segments fig 1 explains this simplification the pipe route on x y plane is the projection of the real pipe route in 3d space in this work it is assumed that the pipe route follows the seabed landscape so that one projection on x y plane corresponds to a unique pipe route in 3d space as a result the geometric description is basically conducted on x y plane from the top view perspective and the related z coordinates are interpolated according to seabed topography in fig 1 nodes p 0 and p n are the start and end nodes respectively the gray areas are obstacles that the pipe route should avoid therefore a straight connection line from p 0 to p n is not feasible the possible candidate route p 0 p 1 p k p n can be transformed from the original straight line p 0 p n as indicated below the straight line p 0 p n is divided into n segments with equal length the x and y coordinates of p 0 and p n are x 0 y 0 and x n y n respectively the length of each segment l 0 is 1 l 0 p 0 p n n x n x 0 2 y n y 0 2 n and the direction vector of p 0 p n is given by 2 e 0 p 0 p n p 0 p n x n x 0 y n y 0 t x n x 0 2 y n y 0 2 note that the superscript t is the transpose sign which is used to represent the vectors as column vectors in the calculations for any two consecutive nodes p k x k y k and p k 1 x k 1 y k 1 of the candidate route there are two parameters to be defined the interval length l k and the direction vector e k which can be obtained by 3 l k λ l 0 4 e k x e k y e k t cos θ k sin θ k sin θ k cos θ k e 0 the angle θ k is the counterclockwise rotation angle of the vector p k p k 1 relative to the direction vector e 0 as shown in fig 1 therefore 5 0 θ k 2 π the vector p k p k 1 is 6 p k p k 1 l k e k x k 1 x k y k 1 y k t then from eqs 2 4 and 6 7 x k 1 x k λ x n x 0 n cos θ k y n y 0 n sin θ k y k 1 y k λ x n x 0 n sin θ k y n y 0 n cos θ k from eq 7 it is convenient to write down the coordinates of node p k 8 x k x 0 i 1 k λ x n x 0 n cos θ k y n y 0 n sin θ k y k y 0 i 1 k λ x n x 0 n sin θ k y n y 0 n cos θ k k n represents the end node p n which acts as a boundary condition related to the target end point of the pipe 9 i 1 n λ x n x 0 n cos θ k y n y 0 n sin θ k x n x 0 i 1 k λ x n x 0 n sin θ k y n y 0 n cos θ k y n y 0 eqs 8 and 9 together express the pipe route geometry through the variable vector x λ θ 1 θ 2 θ k θ n t in this way the possible candidate route is divided into segments of equal length and different rotation angles if λ 1 and θ 1 θ 2 θ k θ n 0 the pipe route becomes the straight connection line p 0 p n between start and end nodes on the x y plane therefore based on the above description the proper x can be found to determine the best pipe route that satisfies eqs 8 and 9 as well as the other constraints include obstacles pipe structural issues curvature on bottom stability free span etc and fluid hydraulic and thermal behavior as well as other related factors that might affect total cost and pipe reliability meisingset and olsen 2004 the objective is usually to minimize the total cost the simplest and most basic criterion is the shortest pipeline length in addition a shorter pipeline length leads to less pressure and temperature loss of the fluid resulting in less required insulation material and power supply although there are many factors that influence the total cost such as the intervention cost related to eliminating structural risk this paper takes the shortest pipeline length as the optimization object for and initial understanding of subsea pipe route optimization obstacles and pipeline curvature limitations are considered constraints through this kind of simple but typical situation the method and process for optimizing pipe routes are presented 2 2 constraints 2 2 1 boundary constraints the area for the pipe route design is assumed to be rectangular therefore every node on the pipe route remains inside this area then 10 b x x k u b x l b y y k u b y l b x and u b x are the lower and upper boundaries along the x axis respectively and l b y and u b y are the lower and upper boundaries along the y axis respectively substituting eq 8 into 10 gives 11 l b x x 0 i 1 k λ x n x 0 n cos θ k y n y 0 n sin θ k u b x l b y y 0 i 1 k λ x n x 0 n sin θ k y n y 0 n cos θ k u b y to ensure that the pipe route connects to the start node p 0 and the end node p n eq 9 should be satisfied therefore eq 9 is also one of the boundary constraints in addition the ratio λ should be at least 1 indicating that a route should at least be with the same length as the straight connection eq 5 defines the range of the rotation angle θ k therefore 12 λ 1 0 θ k 2 π 2 2 2 obstacles due to the complexity of subsea topography some restricted areas can act as obstacles that should be avoided these areas can be divided into two categories one is line shaped such as existed wirelines and umbilical and other flowlines the other is polygon shaped which represents a closed region such as geohazard regions regions of environmental protection and other developed fields nash 2015 the pipe route must also keep some distance away from these obstacles to ensure the safety of the installation and operation dnvgl rp f107 2017 therefore the obstacles were extended outwards to achieve this requirement as shown in fig 2 fig 2 a and b present the extension of line shaped obstacles and polygon shaped obstacles respectively for the polygon shaped obstacles each edge of the polygon was moved by a distance δ d along its outer normal vector direction the extended edges form a new polygon for the design of the subsea pipe route the extension of line shaped obstacles is similar the difference is the treatment of the head and end nodes as shown in fig 2 b taking the head node for instance the straight line perpendicular to the first edge was moved by a distance δ d along its outer normal vector direction the same treatment was done for the end node then together with the extended edges of the line a polygon is formed the distance δ d is the minimum safe distance between the pipe route and the real obstacles this is a manual set value that can differ between obstacles through this process the two kinds of obstacles were both transformed to polygon shaped for the subsequent pipe route design the next step is to verify the intersections between the segments of the route against the segments of the obstacles the extended polygons therefore a function was defined to represent the intersection between a segment a b and a polygon λ it should be noted that the expression polygon here and in the subsequent text means the area enclosed by the polygon boundary 13 c a b λ 0 a b does not intersect λ 1 a b intersects λ the function c a b λ is determined based on the relationship between segments the detailed process is presented later in this paper the pipe route should avoid all related obstacles this means that the value of the function c applied to any segment of the route and any of the obstacles should be zero which can be represented by eq 14 14 j 1 m k 1 n c p k 1 p k λ j 0 λ j represents the j th obstacle related to the pipe route design and m is the total number of obstacles eq 14 is also related to the variable vector x to apply eq 14 to the optimization the key point is to provide a clear calculation process for the function c shown in eq 13 the process includes two steps the first step is to determine whether the segment end points are inside the polygon and the second step is to figure out the relationship between segment and polygon according to the results from step 1 step 1 relationship between point and polygon there are three kinds of relationships between a point and a polygon as shown in fig 3 a outside the polygon on the edge of the polygon and inside the polygon the criteria for these three relationships are proposed through the angle of the vectors as presented below fig 3 b and c helps explain the detailed process suppose the end point is q as shown in fig 3 b point q and any one of the polygon vertices e k forms a vector q e k using the x and y coordinates of these points the angle α k between the vector and the positive direction of x axis could be represented by eq 15 the range of arctan function is π 2 π 2 and the range of α k is π π as a result the angle α k need to be determined according to the coordinates of the vector as shown in fig 3 b 15 α k arctan y e k y q x e k x q x e k x q 0 arctan y e k y q x e k x q π x e k x q 0 y e k y q 0 arctan y e k y q x e k x q π x e k x q 0 y e k y q 0 where x q y q are the coordinates of point q and x e k y e k are the coordinates of the polygon vertices therefore the rotation angle β k from vector q e k to q e k 1 then could be represented by eq 16 16 β k α k 1 α k k 1 2 n 1 β n α 1 α n then the relationships between point q and the polygon could be determined according to the characteristics of the angle α k and β k 1 if point q coincides with one of the vertices of the polygon point q is on the polygon there is no need of calculating the eq 15 2 if point q does not coincide with any of the vertices but it is on one of the edges of polygon point q is also on the polygon under this condition the two vertices of the edge where the point q is on are collinear with point q therefore the rotation angle between these two vertices will be π or π depending on the arrangement of polygon vertices this condition could be represented by eq 17 17 max β k π 3 if point q is inside the polygon through fig 3 c there is 18 k 1 n β k 2 π 4 if eq 18 is not satisfied point q is outside the polygon step 2 relationship between segment and polygon considering the pipe route search criteria if part of the segment is inside the polygon the segment intersects the polygon it is acceptable that the segment be totally on the polygon as a result the preliminary results of the value of function c can be obtained by determining the relationship between polygon λ and the two end points of segment a b as shown in table 1 two positions are left undetermined in this table both a and b are outside polygon λ and both points a and b are on polygon λ these two scenarios need further discussion because they include several different situations and are thus more complicated as shown in fig 4 to discuss these two scenarios the relationship between two segments is first analyzed as shown in fig 4 there are two segments a b and p q on the x y plane the x and y coordinates are known there are four kinds of relationships between two segments on the x y plane a strictly intersecting b separated from each other c the end of one segment is on the other and d the two segments partially or totally coincide the last three are defined as not intersecting let 19 c 1 a p a q b p b q c 2 p a p b q a q b then it is easy to recognize these four relationships through the values of c 1 and c 2 as shown in table 2 for the two undetermined scenarios shown in table 1 the relationship between segments and polygons are illustrated in fig 5 each relation could be described by the recognition method presented in eq 19 and table 2 if both points a and b are outside polygon λ eq 19 should be applied to determine whether segment a b intersects any edges of the polygon if none of the edges strictly intersect a b c a b λ 0 as shown in a 2 of fig 5 otherwise c a b λ 1 as shown in a 1 if both points a and b are on polygon λ there are four different possible situations with convex polygon and concave polygons as shown in fig 5 first eq 19 is applied to determine whether segment a b strictly intersects any edge of the polygon if so it must be situation b 4 and c a b λ 1 otherwise if segment a b does not strictly intersect any edge of the polygon the relationship might be b 1 b 2 or b 3 the situation shown in fig 6 is also possible under the condition of a concave polygon to deal with these situations it is necessary to find out all the vertices of the polygon that are on segment a b except its end points for example in fig 6 it is found that segment a b passes some of the polygon vertices these vertices divide a b into several sub segments if the middle points of all the sub segments lies outside the polygon according to the rules proposed above segment a b does not intersects the polygon c a b λ 0 as shown in the right figure of fig 6 otherwise c a b λ 1 as shown in the left figure through this process the undetermined positions in table 1 can be achieved and then the table can be applied to the proposed route optimization model since the value of function c is either 0 or 1 eq 14 will always provide integer values indicating that it is not continuous the calculation process for function c is a little complicated but it is easy to achieve with the help of computer programming besides in this work polygons represent seabed obstacles and the strange shape shown in fig 6 might not appear frequently however these shapes were all included in the analysis to provide a comprehensive calculation process 2 2 3 horizontal curvature the subsea pipe usually presents a curved shape indicating curvature too much curvature results in pipe buckling or collapse dnv os f101 2013 therefore there is a maximum value for the route curvature the curvature of the pipe route includes two parts one is the horizontal curvature which results from the requirement of avoiding restricted regions such as the subsea obstacles discussed above the other is vertical curvature which is mainly due to the undulating seabed the pipe route follows as well as the gravity effect of the pipe line if free span occurs meisingset and olsen 2004 since seabed elevation variation is usually not very large compared with the width and length of the target region and this work deals with a flexible pipe so that free span is not considered the effect of the vertical curvature is much smaller than that of the horizontal curvature therefore in this research only the horizontal curvature constraint was considered using the method of polynomial approximation if a curve on the x y plane is given by y f x the radius of curvature r is 20 r 1 d y d x 2 3 2 d 2 y d x 2 however in our model the pipe route is discretized as segments and nodes as shown in fig 1 so the first derivative at each node of the route is not continuous which makes eq 20 unable to be applied as a result the polynomial interpolation method was applied here to make the pipe route smooth parametric equations based on arc length were used to obtain the route curvature at each node since in this work only horizontal curvature is considered then we could focus on the pipe route projection on the x y plane as indicated above in practical situation the pipe is a smooth curve so its projection on the x y plane is also a smooth curve beginning from the start of the pipe each point on the pipe route corresponds to an arc length of the route projection which is represented by s in the proposed model those discrete nodes p 0 p 1 p k p n are on the curve and we use different subscripts to distinguish these different nodes for example s k represents the arc length from the k th node p k to the start node p 0 obviously s 0 0 according to this definition the total length of the segments on the x y plane between node p k and p 0 could be used to approximate the arc length s k which is shown by eq 21 21 s k i 1 k p k 1 p k k λ x n x 0 2 y n y 0 2 n k λ l 0 then for any consecutive three nodes p k 1 p k and p k 1 the correspondence between the arc length s and the x and y coordinates are shown in table 3 according to this table both the x and y coordinates on the continuous curve that passes these three nodes could be regarded as the function of the corresponding arc length therefore the curve could be represented by the parametric equation x x s y y s as shown in fig 7 therefore lagrangian interpolation is applied to approximate the parametric equation which is shown in eq 22 22 x s s s k s s k 1 s k 1 s k s k 1 s k 1 x k 1 s s k 1 s s k 1 s k s k 1 s k s k 1 x k s s k 1 s s k s k 1 s k 1 s k 1 s k x k 1 y s s s k s s k 1 s k 1 s k s k 1 s k 1 y k 1 s s k 1 s s k 1 s k s k 1 s k s k 1 y k s s k 1 s s k s k 1 s k 1 s k 1 s k y k 1 s s k 1 s k 1 substituting eq 21 in 22 gives 23 x s s s k s s k 1 2 λ 2 l 0 2 x k 1 s s k 1 s s k 1 λ 2 l 0 2 x k s s k 1 s s k 2 λ 2 l 0 2 x k 1 y s s s k s s k 1 2 λ 2 l 0 2 y k 1 s s k 1 s s k 1 λ 2 l 0 2 y k s s k 1 s s k 2 λ 2 l 0 2 y k 1 note that x x 0 y y 0 corresponds to the start node and s 0 0 eq 23 provides a smooth curve connecting the consecutive three nodes then the relationship between the arc length and the x and y coordinates could be built up the radius curvature at the k th node p k could be obtained by eq 24 24 r k d x d s 2 d y d s 2 3 2 d x d s d 2 y d s 2 d 2 x d s 2 d y d s s s k then from eqs 23 and 24 after a series of calculations eq 25 is derived 25 1 r k x k 1 x k 1 y k 1 y k 1 2 y k x k 1 x k 1 2 y k 1 y k 1 2 3 2 y k 1 y k 1 x k 1 x k 1 2 x k x k 1 x k 1 2 y k 1 y k 1 2 3 2 according to the above discussion there is a maximum horizontal curvature for the subsea pipe that corresponds to the minimum radius of curvature which is denoted by r min then 26 r k r min which could also be represented as 27 min r k r min 0 0 then for the nodes from p 1 to p n 1 the nodes between the start and the end the radius of curvature at each node should all satisfy eq 27 therefore 28 k 1 n 1 min r k r m i n 0 0 eqs 8 and 25 indicates that the right side of eq 28 is also a function of the variable vector x 2 3 objective function the aim of the objective function is to find the minimum pipe length this work deals with a flexible pipe so the pipeline route follows the seabed landscape hong et al 2018 and free span is usually not a problem consequently the pipe length is the same as the route length on the seabed surface the actual continuous seabed topography is represented by discrete data which are a set of interconnected points or nodes denoted by coordinates x y z x and y are coordinates on the x y plane and z is the corresponding water depth fig 8 shows an example of seabed topography since the pipe route geometric parameterization and the related constraints are all set up on x y plane from the top view perspective the z coordinate of the route must be calculated to obtain the pipe length first the z coordinate of each node is calculated for node p k x k y k the z coordinate z k can be interpolated according to the subsea topography data function g represents the interpolation function there are a several possible methods such as linear quadratic and spline interpolations the spline interpolation method was selected in this work 29 z k g x k y k since the pipe route geometric description presented in section 2 1 is on the x y plane which is independent from the seabed topography it is possible that the segment between two consecutive nodes crosses the local peak or valley of the seabed fig 9 presents an example to explain the problem fig 9 a shows the top view of a segment connecting nodes a and b on the x y plane the nearby seabed discrete nodes form the rectangle a b c d e f which is a projection of the actual seabed surface a b c d e f as shown in fig 9 b nodes a and b are the projections of a and b on the actual surface respectively and b e acts as a peak edge considering that this work applies to flexible pipes the above explanation indicates that the length of the straight segment a b is not the real length of the route between a and b instead an extra node c needs to be inserted at the intersection between a b and b e this is the projection of c on the seabed surface for this extra node either of the x and y coordinates is already given by the seabed topography in this example the x coordinate of node c is known because it is on the edge of b e the other coordinate can be obtained through linear interpolation then eq 29 is used to obtain the z coordinate of c therefore the length of the pipe route on the seabed between node a and b is 30 l a b a c c b based on this assumption a series of extra nodes can be inserted between any consecutive nodes of the pipe route expressed by eqs 8 and 9 to make the route follow the seabed topography fig 9 c shows a more general condition that the connection between node p k 1 and p k crosses a series of the grid edges of the discrete seabed between nodes p k 1 and p k k 1 2 n the extra inserted nodes are represented by a 1 k a 2 k a 3 k a n k k which can be obtained from the subsea topography and the coordinates of p k and p k 1 then the length of the route between node p k 1 and p k is 31 l p k 1 p k p k 1 a 1 k j 1 n 1 a j k a j 1 k a n k k p k therefore the total pipe route length is 32 l p k 1 n l p k 1 p k k 1 n p k 1 a 1 k j 1 n k 1 a j k a j 1 k a n k k p k considering the description about the pipe route it is easy to find that l p is a function of the variable vector x x λ θ 1 θ 2 θ k θ n t as result the objective function can be represented by 33 min l p f λ θ 1 θ 2 θ k θ n function f is short for eq 32 so far both the objective function and related constraints have been obtained the main expressions are briefly summarized in table 4 these expressions indicate that the proposed mathematical model is a nonlinear constrained single object optimization model with four equalities and 3 n 1 inequalities of constraints the input parameters include seabed topography the start and end node positions and the segment number n the output results include the minimum pipe route length and the corresponding pipe route geometry obviously the objective function and the constraints are all functions of x the four equality constraints could be put together represented by h i x where i 1 2 3 4 one h i x stands for one equality constraint similarly the 3 n 1 inequality constraints are represented by g j x where j 1 2 3 n 1 therefore the mathematical model can be simply expressed as follows 34 min l p f x s t h i x 0 i 1 2 3 4 g j x 0 j 1 2 3 n 1 3 model solutions 3 1 the augmented lagrangian multiplier method as indicated above the proposed mathematical model is a non linear single objective optimization model to solve it the augmented lagrangian multiplier method is adopted to transform the model into a series of unconstrained optimization subproblems which are more convenient to solve this section presents the solution process based on eq 34 the augmented lagrangian multiplier method is a modification of the original lagrangian multiplier method in which quadratic penalty terms are added to improve the convergence performance rockafellar 1973 based on eq 34 the augmented lagrangian multiplier function is built as shown by eq 35 35 q t x m t u t v t f x m t 2 i 1 n h h i 2 x i 1 n h u i t h i x 1 2 m t j 1 n g max 0 v j t m t g j x 2 v j t 2 the superscript t is the iteration steps m is the penalty factor which is a scalar quantity u u 1 u 2 u n h is the lagrange multiplier vector for the equality constraints and the vector length is n h in this work n h 4 v v 1 v 2 v n g is the lagrange multiplier vector for the inequality constraints and the vector length is n g then n g 3 n 1 at the right side of the equation the second and third terms together deal with the equality constraints and the fourth term deals with the inequality constraints an auxiliary function shown in eq 36 was defined to put all the equality and inequality constraints together to help decide the convergence criteria 36 h r x h r x r 1 2 n h 1 m t min v r n h t m t g r n h x r n h 1 n h 2 n h n g the related mechanism and proof process can been seen in the work by rockafellar 1973 which presents the steps of how to use the augmented lagrangian multiplier method as summarized below step 1 set the initial value x 0 the initial penalty factor m 1 the initial lagrange multiplier vectors u 1 and v 1 the amplification factor α used to update penalty factor the tolerance ε and the constant γ 0 1 used to check the convergence speed set t 1 step 2 start from the initial value x t 1 find the solution x t of the unconstrained optimization problem q t x m t u t v t step 3 check the convergence criteria if h r x t ε the iteration stops and x t is the solution of the original problem f x otherwise move to step 4 step 4 check the convergence speed if h r x t γ h r x t 1 update m t by m t 1 α m t and move to step 5 otherwise m t 1 m t and move to step 5 step 5 update the lagrange multipliers through u i t 1 u i t m t h i x t and v i t 1 max 0 v j t m t g j x t and let t t 1 return to step 2 in this process one of the most important steps is solving the unconstrained problem q t x m t u t v t at each iteration several methods have been proposed to solve unconstrained optimization problems however the constraint function for avoiding obstacles is not continuous as shown in section 2 so methods that rely on the function gradient are not available therefore metaheuristic optimization algorithms such as ga sa and pso are better alternatives these algorithms do not require continuous and explicit expressions for the related constraints and objectives in this work pso was selected to solve these unconstrained sub problems 3 2 the particle swarm optimization algorithm pso was introduced by eberhart and kennedy 1995 it is one of the metaheuristic algorithms inspired by the swarming behavior as displayed by a flock of birds pso consists of a swarm of particles moving in an n dimensional real valued search space of possible problem solutions the dimension number n is the same as the number of variables to be found while the variable vector is x each particle has a position vector v which is used for representing a candidate solution to the problem there are two important positions one is the global best position of all the particles seen so far g k t of which k t is the present iteration step the other is the local best position of each particle seen so far p i k t the i th particle s velocity in the next iteration is updated based on the particle s velocity at the present iteration together with the above mentioned two positions then the particle moves to a new position in the next iteration the update rules are denoted by eq 37 37 v i k t 1 ω v i k t c 1 r 1 p i k t x i k t c 2 r 2 g k t x i k t x i k t 1 x i k t v i k t 1 where ω is the weight factor of present velocity and r 1 and r 2 are acceleration factors which are non negative constants c 1 and c 2 are random numbers distributed within 0 1 through this kind of updating rule the information about better solutions spreads through the swarm and the particles tend to move to increasingly better positions in the search space the algorithm is initialized by assigning each particle a uniformly and randomly chosen position in the search space and the velocities are initialized randomly in the range v m a x v m a x this range is also used to constrain the velocity in the whole iteration process the mechanism of pso is easy to understand but its convergence performance and stability should be carefully dealt with researchers have improved its performance by designing proper values of ω r 1 and r 2 eberhart and shi 2000 or by combinations with other algorithms such as ga ghorbani et al 2018 considering that the main purpose of this work is to solve the proposed mathematic model rather than deeply investigating issues about the algorithm itself the pso toolbox in matlab was used which is a robust package developed for practical applications 3 3 post treatment through dynamic programming it should be noted that the characteristics of pso algorithm will bring some uncertainty to the optimization process on one hand pso algorithm is with random process during the calculation as can be seen in eq 37 the factors r 1 and r 2 are two randomly chosen parameter which will bring different results while repeating the optimization calculation therefore the stability of the algorithm needs to be checked before application this will be presented in section 4 on the other hand in limited iteration steps if the number of decision variables is small pso could provide the optimal solution but when there are too many decision variables the calculation usually results in relatively better solution which we call sub optimal rather than the strictly optimal one therefore in this work if the segment number n is larger there will be more decision variables and possibly the sub optimal solution will be obtained through the above solution process which makes the pipe route present a slightly saw tooth shape in section 4 some calculation cases are presented to show this phenomenon fig 10 illustrate a simple example to help explain route from p h to p e is obtained through the proposed solution method the interval from node p h to node c p h a b c presents such saw tooth shape and obviously the straight connection from p h to c which is shown by the pink dotted line is better than the original and node a and b are regarded as redundant node which could be eliminated therefore the original route is the sub optimal and we could find better route through correctly eliminating the redundant nodes based on this idea dynamic programming is applied to conduct a post treatment process for the obtained optimized route in order to reduce the saw tooth shape thus achieving a better route dynamic programming is a kind of method which breaks a complicated problem down into series of simple sub problems in a recursive manner dreyfus 1969 suppose a 0 a 1 a 2 a n is the route node sequence which is the optimization result of the above proposed solution method these nodes are taken as the candidate nodes and what we need to do is to find out the nodes from these candidates which results in the shortest length from the head to the end nodes starting from a 0 o p t a 0 a i represents the shortest route length from a 0 to the i th node a i then dynamic programming process is represented by eq 38 38 o p t a 0 a i min o p t a 0 a j w a j a i j 1 i 1 w a j a i is the distance between the j th and i th node if the connection between a j and a i satisfies all corresponding proposed constraints such as not crossing the obstacles w a j a i is calculated through eq 31 considering the seabed elevation otherwise w a j a i is assigned a large number to indicate it is not feasible when i 1 obviously o p t a 0 a 1 is the route length between a 0 and a 1 because there is no other option this provides the initial condition for the determination of the shortest route between a 0 and the subsequent nodes beginning from i 1 continuously using eq 38 until i n the output o p t a 0 a n and the corresponding node coordinates are the desired results in subsequent section the calculation results with and without this proposed post treatment process are compared to indicate its performance 3 4 the overall solution process as discussed above the proposed nonlinear constrained optimization model can be solved by the augmented lagrangian multiplier method coupled with the pso algorithm the solution method contains two loops of iteration each outer iteration step calculates the unconstrained augmented lagrangian multiplier function and includes the inner required iterative process using the pso algorithm since pso algorithm always brings sub optimal solution to overcome this the obtained optimized route is regarded as the basic result dynamic programming is applied to conduct a post treatment process to screen the nodes of the basic results removing the redundant nodes and reducing the possible saw tooth shape thus achieving better route with shorter length for pipe route optimization there are also some pre treatment processes such as extending the obstacles as presented in section 2 fig 11 shows the overall process to solve the proposed optimization model the calculations were conducted on a computer with 4 gb of ram memory and a 2 6 ghz intel core i5 processor 4 case study 4 1 a simple case flat seabed to validate the proposed mathematic model the simple flat seabed case was considered initially since this simple case was for checking the reliability of the mathematic model and the algorithm the process of the obstacle extension was temporarily not considered to simplify the calculations as shown in fig 12 there is a rectangular area with four vertices of a 1 1 b 21 1 c 21 21 and d 1 21 a rectangle obstacle is inside the area presented by the gray color in fig 12 the four vertices of the rectangle are 12 4 15 4 15 16 and 12 16 respectively the route starts at p s 2 3 and ends at p e 20 20 to start the calculation a randomly selected initial route is input and the other related initial parameters are listed in table 5 note that the lagrangian multipliers are vectors with lengths equal to the number of equality and inequality constraints respectively and the initial value is set to be 0 2 for all members so in table 5 they are represented by one value for simplicity it is easy to figure out the route with minimum length from p s to m one of the obstacle vertices and finally to p e which is presented by a black dotted line in fig 12 its length is 25 345 different segment numbers were input to the optimization model to calculate the routes with minimum length under each segment number the calculation is repeated for 100 times the results without and with the post treatment process are compared from the 100 times calculation results under different segment numbers one for each is picked out and the pipe routes are shown in fig 12 a and the corresponding post treated routes are presented in fig 12 b in fig 12 a the saw tooth shape as mentioned above occurs if the segment number is small the saw tooth shape is not very significant for example when n 5 and if the segment number is larger this shape is more obvious for example when n 40 therefore the proposed post treatment process effectively reduces the saw tooth shape compensating the solution variations brought by pso algorithm which makes the found route better fig 13 a and b present all the 100 times calculation of optimized route length without and with the post treatment process respectively and table 6 lists the general statistical results the y axis of fig 13 a and b is chosen to be in the same scale in order to show the differences fig 13 a indicates that repeating the calculation brings different results of the route length most of the values concentrate between 25 4 and 26 6 the gap is not very big which is about 4 7 of the theoretical optimal value 13 b shows that the post treatment process through dynamic programming brings significant improvements to the optimization results the route lengths concentrate between 25 3 and 25 7 which are furtherly closer to the theoretical optimal value the statistical analysis in table 6 provides a quantified view without the post treatment the difference between maximum and minimum value is small and close to the theoretical optimal value indicating the reliability of the proposed model and algorithm besides the standard deviation is small either indicating that repeating calculation will not bring big variation to the results therefore the proposed model and algorithm is stable after the post treatment every index turns out to be better which means that the results become more reliable and stable besides table 6 also indicates that larger segment leads to better pipe route when including the post treatment when the segment number is more significant it is possible for the internal nodes to be close to the critical nodes that make the route avoid obstacles in this case point m is the critical node and when n 5 the internal nodes on the routes are some distance away from point m while n 40 some internal nodes are closer to m which makes the route better however without the post treatment process since pso algorithm leads to the sawtooth shape of the route this issue is covered and not found as a result the post treatment process helps increase the advantage of choosing a more significant segment number when optimizing the route the effectiveness of the proposed model and algorithm is checked through a single flat plane indicating reliability and stability moreover the post treatment process further makes the result better therefore the proposed model and algorithm could be applied to the optimization of pipe routes on an undulating seabed 4 2 pipe route on undulating seabed a 7 km length and 7 km width subsea area with two line shape obstacles and two polynomial obstacles are provided as an example of applying the proposed pipe route optimization model the water depth ranges from 1500 m to 1600 m the seabed bathymetry is digitized by 80 80 nodes a flexible pipe is installed to connect the start point p s 7 6566 7 8253 and the end point p e 1 2271 1 1398 the z coordinates can be interpolated through the digitized seabed bathymetry the minimum allowable lateral curvature radius of the subsea pipe is 300 m in addition as mentioned in section 2 the original obstacles were extended outwards the extension distance was set to be 100 m as the safety distance fig 14 presents the seabed bathymetry and the obstacle distribution with both 3d perspective and top view similar to the simple case in section 4 1 the initial parameters were set for the optimization calculation the number of segments n 5 and the initial route was selected to be the straight connection between the start and end points on the x y plane which means the initial variable vector is x 0 1 0 0 0 0 0 other related parameters are the same as in table 5 starting with these initial values the calculation takes about 8 min in the matlab environment fig 15 presents the optimization results in both 3d perspective and top view the black line is the route and the blue dots are the internal nodes corresponding to the given segment number n 5 the route follows the seabed landscape which is consistent with assuming a flexible pipe as indicated in section 2 the optimized route avoids all obstacles and meets the requirement of safety distance the solution is x 1 0624 0 4545 0 5 7342 6 1171 0 2507 and the corresponding pipe route nodes coordinates are listed in table 7 the pipe route length is 9 8629 km the optimization is an iterative process as discussed in section 3 fig 16 presents the optimization evolution process the x axis is the iteration step and the y axis is the corresponding optimal value for the augmented lagrangian function through the pso algorithm beginning from the initial input parameters the function value quickly approaches the final optimal value at the second step oscillates around and finally arrives at the optimal value after 79 iteration steps indicating good convergence performance again note that while the optimized route is suboptimal as it is slightly different from the strict global optimal value the result is appropriate and accurate enough for engineering applications 5 discussions 5 1 comparison with the dijkstra algorithm as discussed in section 1 many algorithms can help determine the pipe route by finding proper nodes from the discrete seabed topography such as the dijkstra algorithm and ant colony optimization an obvious problem of these algorithms is that the resolution of seabed topography might cause differences in the optimized route because the internal route nodes are the discrete nodes of the seabed topography but for the proposed optimization model in this work though discrete seabed topography is used the decision variables are searched in continuous space and the internal nodes of the route is not limited by the nodes of the seabed discretization to check the difference between them in detail one of the typical path finding algorithms the dijkstra algorithm is selected as representative to compare with the proposed model the dijkstra algorithm is one of the earliest and best known algorithms for finding the shortest path between two nodes in a graph dijkstra 1959 it can be applied to find a subsea pipe route hong et al 2018 based on seabed topography when applying the algorithm for any node the neighboring eight nodes are defined as candidates to be searched including horizontal vertical and oblique directions as shown in fig 17 a in addition the nodes inside the obstacle regions are unavailable and thus avoided as shown in fig 17 b beginning from the starting node the algorithm spreads out to visit all the available candidate nodes calculating the minimum accumulating weight of each node the process continues until the target node is reached both the proposed optimization model and the dijkstra algorithm were applied to two different resolutions of seabed topography one with an 80 80 grid and the other with a 20 20 grid the 20 20 grid was obtained by coarsening the 80 80 one to maintain the major undulating characteristics for the proposed model the segment number is chosen to be n 5 fig 18 presents the optimization results fig 18 a and b present the comparison of the optimized routes through the proposed model and dijkstra algorithm under both 80 80 grid and 20 20 grid seabed topographies respectively and the route lengths are presented in table 8 under the same resolution of seabed topography the optimized routes of the proposed model and dijkstra algorithm are different according to table 8 the pipe route length from the dijkstra algorithm is about 5 6 larger than that from the proposed model and the shapes of the pipe routes are also different the differences are caused by the different searching mechanism for the route nodes of the proposed model and the dijkstra algorithm for the dijkstra algorithm the route nodes only come from the discrete seabed nodes so the information of other points on the seabed are not included which might lead to missing the better route instead the proposed model allows searching for the nodes of the pipe route continuously on the seabed which is more comprehensive and allows finding the route with the minimum length besides for the dijkstra algorithm the inflection angle of the pipe route is restricted to 135 due to the around eight nodes searching rule although one can increase the number of around candidate nodes to for example sixteen nodes zhang et al 2017 the inflection angle is also restricted to several fixed values instead for the proposed model the nodes of the route are searched in the continuous space so the inflection is not limited to fixed values therefore the shapes of the optimized routes of the two algorithms are different furthermore since the proposed model is not limited to fixed values for the inflection angle the minimum pipe curvature radius could be taken into consideration when optimizing the pipe route which is set as one of the constraints as indicated in section 2 but dijkstra algorithm cannot deal with this issue due to the limitation of inflection angle the proposed model takes about 439 s to complete the calculation while dijkstra algorithm only takes about 4s under 80 80 grid of seabed resolution if the segment number is higher the time taken by the proposed model will be even longer but as indicated above the proposed model is free from the limitation of route inflection angle as well as the seabed discrete nodes the result is closer to practical engineering scenarios table 8 also shows that for either the proposed model or the dijkstra algorithm the pipe route lengths under different seabed resolutions are close to each other this is mainly because the seabed with low resolution still maintains the major seabed undulation characteristics therefore pipe route optimization based on a seabed topography with relatively low resolution but reliable information can provide reliable results 5 2 effect of segment number note that in the above cases segment number n is chosen to be 5 and the post treatment process does not make any difference because the number of segment is relatively small when applying dynamic programming to screening the internal nodes all of them should be picked to avoid obstacles and meet the curvature requirement to see the effect on the segment number as well as how the post treatment process behaves segment number n 5 10 20 30 and 40 are selected under each segment number the calculation is repeated 10 times fig 19 presents the routes obtained from the proposed method without and with the post treatment process respectively which are picked from the 10 times calculation results similar to the cases presented in section 4 1 without the post treatment process the saw tooth shape of the route occurs while after the post treatment process the route becomes better the average calculation time under each segment number is listed in table 9 larger segment number leads to longer calculation time due to more decision variables the statistical analysis of all the calculation results are presented in table 10 compared with the route lengths without post treatment process the maximum minimum mean and the standard deviation of the route lengths are all lower indicating that the post treatment process provides better results besides after the post treatment process larger segment number makes the mean value of the route length lower as well as the standard deviation indicating that larger segment number brings better results the reason is the same as presented in section 4 1 in fig 19 it is easy to find that the nodes close to the obstacle edge are the critical nodes and larger segment number has more probability to find out the nodes of the route that are closer to these critical nodes which provides better optimized route the calculation results show that the proposed optimization process which is the pso based augmented lagrangian multiplier method followed by dynamic programming as post treatment is reliable and stable and could be applied to actual engineering scenarios larger segment number leads to better route length but at the same time the calculation time will be longer in this case n 20 or 30 is good enough to obtain appropriate results 5 3 comments on the optimization model 5 3 1 about the objective function the aim was to find the pipe route with minimum length this is only one part of the pipe route selection besides the pipe route length reducing pipe costs includes many other aspects such as possible investment for eliminating potential structural risk the cost of providing enough pressure drop to transport the fluid the cost of flow assurance etc theoretically taking more aspects related to the cost could make the optimized pipe route more reliable for both cost estimation and safety operation for example in the above discussion it was found that seabed elevation does not much affect the pipe route length because the elevation variation is much smaller than the length and width of the area but when the cost of pressure drop needs to be considered the undulating pipe route profile will affect the pressure drop significantly and the seabed elevation variation might be a very important point in future research these related aspects should be considered step by step the present work only considers the simplest object pipe length to provide an initial understanding of pipe route optimization 5 3 2 about the constraints the constraints in the proposed optimization model can be divided into two categories the first is the geometry configuration such as the variable boundaries and node coordinates restrictions this category is mandatory since it defines a geometrically completed pipe route the second is related to engineering requirements coupling practical scenarios with the optimization process related issues from practical situations could be added into the optimization model through proper mathematical descriptions for instance this work provides a fixed allowable pipe curvature radius but in practice it is related to many factors such as pipe stress and seabed soil friction therefore these more complex parameters could be added into the model by building up the relationship between them and the curvature radius to make the optimization model much closer to the reality 5 3 3 about the solution method the solution method is summarized as pso based augmented lagrangian multiplier method followed by dynamic programming augmented lagrangian multiplier method is applied to deal with the related constraints of the proposed mathematical model and pso algorithm is used to solve the augmented lagrangian function the obtained pipe route is taken as the basic route and dynamic programming is applied as a post treatment process to further optimize the basic route by screening the nodes on the basic route thus achieving the final result pso algorithm has good capacity of global search which helps obtaining a good pipe route and the dynamic programming acts as a local search which provides further optimized results combining the two algorithms brings excellent calculation performance as indicated by the presented cases another issue to be noted is that when building up the mathematical model the pipe route is divided into several segments with equal length after the post treatment process the nodes are screened and the redundant nodes are removed to provide a better route after removing the redundant nodes the segment lengths of the final optimized route will not be equal 6 conclusions in this work a nonlinear constrained optimization model was established to help find the best subsea pipe route the model can give the pipe route with minimum length and corresponding route geometry configuration the way of determining the intersection between the pipe route and obstacles was also provided a framework of pso based augmented lagrangian multiplier method followed by dynamic programming was established to solve the proposed model case studies on flat and undulating seabed were presented comparison of the results without and with the post treatment process by dynamic programming is presented pso algorithm might bring some variation to the results but dynamic programming helps to reduce the variation and provides better results indicating the feasibility reliability and stability of the proposed solution method the proposed model was compared with the dijkstra algorithm although the proposed model needs much longer time to solve it is free of the limitation of route inflection angle as well as the seabed discrete nodes while dijkstra algorithm is not therefore the proposed model can represent the reality with more accuracy for practical engineering scenarios the research work will be extended to incorporate other relevant parameters that can influence pipe route optimization such as pipe structural ultimate behavior and flow assurance thermal restrictions acknowledgments the authors acknowledge the financial support provided by petrogal brazil anp r d program contract no peno 18636 and embrapii coppe unit in subsea technology contract no peno 19143 for the development of the research project subsea systems sistsub special thanks to capes and the china scholarship council for supporting the first and fourth authors respectively thanks also to the brazilian research council cnpq for supporting the research activities of the second author on subsea technology 
22677,when an underwater collision or explosion happens to a ship the water will rush into the cabin through the broken opening the water spike induced by hydrostatic pressure has the potential to destroy the facilities and structures inside the cabin and the water flooding may threat the vitality of ship dynamic characteristics of this water spike during early flooding process is studied by a three dimensional fast multipole boundary element method fmbem based on the potential theory in this article the edge swap operation is elaborated and adopted to eliminate the slender elements at the air water interface which helps us study the evolution of the inrush water and maintains the computational efficiency the numerical model is validated by experimental data and the result from the finite volume method the flooding process can be divided into the developing flow stage and the stable flow stage the flow rate increases gradually during the former stage and reaches a constant value in the latter one through parametric study we find that the water flooded through the opening earlier is subjected to the gravity for longer time and achieves larger velocity which results in a slender water spike when the opening gets deeper the developing flow stage becomes shorter and the flow rate increases whilst the increasing speed slows down with the growing depth it is the area of the opening rather than the shape that influences the flow rate and flooding velocity and the maximum velocity in the horizontal direction appears at the transition time between the two stages this study reveals that the water flooding spike has complex and non linear dynamic behaviour and helps lay the foundation of studying the interaction between high speed water jet and the structures it also shows that the fmbem is suitable for dealing with the large scale moving boundary problems efficiently and accurately keywords water flooding boundary element method bem fast multipole method fmm ship collision 1 introduction the liquid rushing or flooding through an orifice opening is a very common phenomenon in many fields when the orifice is small e g less than millimetre scale and there is high pressure at the orifice the liquid jet has applications associated with the needle free injection or micro pump devices in bio medical fields fletcher and palanker 2001 fletcher et al 2002 gonzalez avila et al 2015 as well as the micro electrical mechanical devices or the ink jet printing borthakur et al 2019 in other fields such as ocean engineering or military sometimes the water flooding through an opening with the size of several metres happens which may due to ship collision with submerged reefs when sailing in shallow water i e the groundings nguyen et al 2011 or with icebergs during oceangoing voyage like rms titanic stettler and thomas 2013 and with other vessels or even under the attack of underwater explosions during the warfare there is nonlinear dynamics embedded in the motion of the liquid jets or flooding water and for the latter situations the flooding water with large momentum may rupture the facilities inside the cabin threat the ship vitality and even cause casualties which are needed to be studied in detail the liquid flows through small orifices has been studied extensively through experiments images of the formation and evolution of the liquid jet are captured by the high speed photographic system fletcher et al and avila et al measured the speed of the jet which is induced by the collapsing cavitation bubble fletcher and palanker 2001 fletcher et al 2002 gonzalez avila et al 2015 su n ol et al studied the jet breakup length and the dynamics in normal and micro gravity fields suol and gonzález cinca 2015 with numerical simulations pan suga focused on the evolution and breakup process of laminar liquid jets into the gas in parallel with the direction of gravity the surface wave is captured using the level set method and the liquid drop breakup mechanisms are discussed pan and suga 2006 when the jet shoots perpendicular to the gravity borthakur et al studied the parabolic trajectory of the jet under different parameter set and found the mechanism underlying the rotating liquid drops after their breakup borthakur et al 2019 the water flooding through a large broken opening at the bottom or side shell of a ship will endanger the ship s survivability previous works on this field mainly focused on the dynamic response of the damaged ship with flooding water sloshing inside the cabin or the ship motion during the sinking process acanfora luca conducted the experiment on a passenger ferry hull model with a rectangular opening at the broadside in a towing water tank acanfora and de luca 2017 roll responses of the model in still and beam regular waves are both studied le touzé et al cao et al sun et al and ming et al used the smoothed particle hydrodynamics sph to investigate the scenario of water flooding into a floating cabin le touzé et al 2010 zhang et al 2013 guo et al 2017 ming et al 2018 the sloshing motion of the cabin when the water rushes from the opening at the bilge bottom and side wall is discussed also the influence of transversal waves on the sinking process is considered measurements achieved by the sph show fair agreement with the experimental data gao et al employed the commercial computational fluid dynamics cfd solver fluent 12 0 to simulate the dynamics of a damaged ship model flooding and sinking in calm water gao et al 2018 ruponen researched on the leakage and collapse of the non watertight structures during the flooding process of a large passenger ship ruponen 2017 rodrigues soares studied the increment of the load onto a damaged ship due to the progressive flooding rodrigues and guedes soares 2017 in the above cases of water flooding into a broken cabin the water spike is injected by the ambient hydrostatic pressure and evolves perpendicular to the direction of gravity much less attention has been paid onto the physics and dynamical mechanism of the water spike in this processes however the water spike itself at the early stage of flooding has large momentum and may destroy the pipelines and facilities inside the cabin resulting in the lost of defensive power of the warship webster 2007 which is very worthy of study the numerical methods have advantages over experimental studies on this problem since the full scale model can be studied during calculation and details of the migration of the water jet are captured accurately when using the above cfd methods both the gas and liquid domains have to be discretized and the mesh near the air water interface needs to be refined to present the details this makes the computational cost increase as the water jet migrating and the total number of mesh is too large so the parallel super computing is needed borthakur et al 2017a the boundary element method bem only needs information on the boundaries of the flow domain which reduces the dimension of the calculating space by one cheng and cheng 2005 thus simplifies the mesh generation besides the infinite boundary condition is automatically satisfied in bem these advantages make this method be widely used for the open boundary problems with complicated geometries such as ship sails in wave wang 2005 shao and faltinsen 2014 chen et al 2016 as well as the moving boundary problems such as the cavitation bubble dynamics huang et al 2018 nonetheless the disadvantage is that the coefficient matrix of the discrete bem is dense this means that for a problem with the number of unknowns n the computational complexity and the memory storage are o n 3 and o n 2 for the conventional bem respectively in order to deal with this deficiency researchers adopted the fast multipole method fmm greengard and rokhlin 1987 carrier et al 1988 greengard 1988 to the bem and achieved the fast multipole boundary element method fmbem yoshida 2001 nishimura 2002 later on some improvements have been carried out to further accelerate the calculation including the adaptive tree structure shen and liu 2007 bapat and liu 2010 and the adoption of the dual boundary integral equation liu and shen 2007 liu 2009 the memory storage and the computational expense are cut down to o n through the above approaches in this work the fmbem is used to study the migration and dynamics of the water spike at the early stage of water flooding in order to eliminate large deformation of the meshes at the surface of the inrush water spike the edge swap operation is used and some numerical techniques are also considered to keep the air water interface smooth and uniformly distributed the physical model is formulated in sec 2 followed by the brief introduction of the fmbem in sec 3 1 through adopting the edge swap operation in sec 3 2 our model is validated by previous numerical result and our experimental data in sec 4 after presenting the general features of the water flooding precess in sec 5 1 parametric studies are conducted in secs 5 2 and 5 3 respectively effects of the depth and shape of the opening on the dynamics of the inrush water spike are investigated therein and finally in sec 6 concluding remarks are given with the outlook of the future work 2 physical model assume that an opening emerges at the side shell of a floating structure ship submarine or platform the water begins to rush through the opening into cabin this side shell is simplified as an vertical solid plate with a submerged opening as illustrated in fig 1 the plate is set in the y o z plane with the origin o laying on the static free surface right above the centre of the opening the shape of the opening is elliptical with the long axis and short axis denoted as d a and d b respectively the depth of the opening which is described by the distance from the centre of the opening to the static free surface is d f the x axis is perpendicular to the solid plate and pointed outwards the cabin see fig 2 we take the background of this study as the water flooding into a damaged ship cabin the inrush water speed v usually has the order of o 1 m s the size of the opening due to collision which is denoted as l l max d a d b is usually several metres nguyen et al 2011 hence the reynolds number r e v l ν of the flow field is 10 6 10 7 with ν indicating the kinematic viscosity therefore the flow is inertia dominated and the mach number of the problem discussed in this work is less than 0 02 in this parameter range we may postulate that the flow domain is inviscid incompressible and irrotational huang et al 2016 wang 2016 based on these assumptions there exist the velocity potential φ and the velocity v can be described by φ as v φ hence the laplace equation is the governing equation of the fluid domain as 1 2 φ x 2 2 φ y 2 2 φ z 2 0 we take the time when the opening is created as the beginning of simulation the air water interface at the opening is assumed as quasi static at t 0 the velocity potential φ and velocity v are both zero at this time throughout the fluid domain the flow is dominated by the gravity acceleration g the dynamic boundary condition on the opening surface reads 2 d φ d t 1 2 φ 2 2 σ κ ρ g z d f where σ is surface tension and κ the local curvature of the air water interface a cabin model with an elliptical opening is shown in fig 2 except for the vertical wall with opening other boundaries are auxiliary for making the infinite fluid domain outside the cabin have a closed boundary the velocity potential φ and velocity v on the solid boundary the auxiliary boundaries and the boundary at infinite are set to zero during the whole simulation and in order to track the position of the air water interface in each time step the following kinematic boundary condition is used 3 d r d t φ here r is the position vector of each fluid particle on the inrush water surface the non dimensionalization is carried out for the variables in this paper the characteristic parameters the length l of the long axis of the opening l max d a d b the density of liquid ρ and the pressure p 0 are taken as the length density and pressure scales respectively here p 0 denotes ambient hydrostatic pressure in the undisturbed liquid at the depth d f i e p 0 p a ρ g d f with p a denoting the standard atmospheric pressure and g the gravitational acceleration the derived dimensionless variables are 4a d f d f l d a d a l d b d b l v v ρ p 0 4b t t l p 0 ρ φ φ l ρ p 0 g ρ g l p 0 σ σ l p 0 note that all dimensionless variables have a as the superscript 3 mathematical model and numerical scheme 3 1 fast multipole boundary element method in the simulations the water spike keeps flooding into the cabin through the opening the air water interface at the opening undergoes large deformation therefore a relatively dense mesh has to be used there which makes the total unknowns of the problem more than ten thousands see fig 2 the fast multipole boundary element method liu 2009 huang et al 2016 is applied in our work to achieve a high efficiency computation which is briefly introduced in the following part through applying green s identity the solution of the velocity potential φ in fluid domain from laplace s equation eq 1 is 5 φ r s φ s g r s n s d s s s φ s n s g r s d s s r ω s s where r and s respectively denote the control point and the integral point g r s 1 4 π s r is the fundamental solution of the governing equation 1 for three dimensions n denotes the outward unit normal vector of the boundary s i e pointing inwards the cabin ω is the fluid domain excluding the boundaries a regular boundary integral equation rbie can be obtained if we let the control point r in domain ω in eq 5 approach to the boundary s 6 m r φ r s φ s g r s n s d s s s φ s n s g r s d s s r s s where m r is a geometrical function related to r if r stays on the surface s which is smooth around r m r is a constant and equals 1 2 as for the fmbem approach dealing with three dimensional 3d potential problems numerous previous researches have documented it in detail carrier et al 1988 nishimura 2002 shen and liu 2007 liu 2009 bapat and liu 2010 in the present work the expansions of kernels in the rbie are summarized briefly for completeness the fundamental solution g and its normal derivative g n y in eq 6 are expanded into 7a g r s 1 4 π s r 1 4 π k 0 q l k k p k l r s e q k l s s e s s e r s e 7b g r s n s 1 4 π k 0 q l k k p k l r s e q k l s s e n s s s e r s e where the expansion is truncated to the order of q refers to the complex conjugate yoshida 2001 note that in the equations above an expansion centre s e which is close to the integral point s is introduced the control and integral points are therefore separated via the expansion centre now are respectively associated with the solid harmonic functions p k l and q k l yoshida 2001 liu and shen 2007 through the expansion one can add the contributions from the integral points onto the expansion centre firstly and these contributions are stored and reused as the control point shifts from one to another during the calculation the expense of computation is thus reduced to satisfy the condition s s e r s e in eq 7 one should firstly find a subset s e of the entire boundary s i e s e s which is away from the control point r then substituting eqs 7a and 7b into 6 to calculate the following integrals 8a s e φ s n s g r s d s s 1 4 π k 0 q l k k p k l r s e m k l s e s s e r s e 8b s e φ s g r s n s d s s 1 4 π k 0 q l k k p k l r s e m k l s e s s e r s e 1 2 these two equations above are the so called multipole expansions yoshida 2001 which are crucial in the fast multipole method m k l and m k l are the multipole moments with the point s e being the centre 9a m k l s e s e φ s n s q k l r s e d s s 9b m k l s e s e φ s q k l s s e n s d s s with the multipole moments the integration on s e is independent of any control point r which is far away from s e so the multipole moments can be reused for many times once calculated in the 3d fmm an adaptive tree structure is used following bapat liu bapat and liu 2010 to divide the space containing all boundaries into many levels of boxes boxes in the deepest level of the tree are called leaves in each leaf the multipole moment is calculated a moment to moment translation m2m is used to accumulate integrals from leaves to the root the most coarse level of the tree similarly the control points can also be divided into boxes to further reduce the calculation cost thus the moment to local m2l and local to local l2l translations are essential which have been introduced in detail in literature yoshida 2001 liu 2009 bapat and liu 2010 the generalized minimal residual method gmres is used to solve the discrete bies iteratively saad and schultz 1986 with the coefficient matrix of integrals on elements in a leaf used as the pre conditioner to speed up the convergence in our previous work huang et al 2016 the fmbem is extended to solving the moving boundary problems we defined the acceleration factor a f 3 3 10 4 n 1 3 of fmbem compared with the conventional bem on calculation time consuming in this paper the total elements for each case is about n 20000 which means that a f 128 thus the calculation of each case can be finished on a normal desktop computer intel core i7 4790 with frequency of 4 00 ghz and allocated ram of 16 0 gb for less than 2 h 3 2 mesh optimization at the air water interface for the situation in this paper the air water interface deforms severely as the water spike migrates at the beginning of simulation the interface is meshed finely and each element has the shape that is close to a equilateral triangle nevertheless the elements on the surface of the water spike are still stretched to slender shapes after a period of time as shown in fig 3 a the boundaries are discretized into 20830 elements in this case too many slender elements may result in low accuracy or even collapse of the calculation we adopted the edge swap operation hua et al 2008 to eliminate the slender shaped elements in our program as shown in fig 4 through the following steps 1 for the two slender elements a b c and b d c that shearing the edge b c find the minimum angle α m i n among the six angles of these two elements 2 if the original elements a b c and b d c are both on the air water interface and none of the edges of these 2 elements belong to the three phase contact line then carry out the edge swap operation i e delete the edge b c and connect the nodes a and c instead thus two new elements a b d and a d c are generated 3 find the minimum angle α m i n among the six angles and the normal vectors n a b d n a d c of the two newly generated elements 4 compare the angles α m i n and α m i n find the angle β between vectors n a b d and n a d c and record the number of edges that each node a b c and d is connected 5 if α m i n α m i n and β π 2 and the number of edges that connected to either node is more than 4 and less than 9 the swap operation is finally approved without the edge swap operation the calculation has to be aborted at the time at fig 3 a in this case due to the deteriorated mesh quality when the edge swap is conducted the mesh is optimized as shown in fig 3 b the slender elements are eliminated and thus the calculation can continue note that in fig 4 the nodes a b c d are vertices of a tetrahedron which are not distributed in a plane meaning that the volume of the space wrapped by the original elements and the new elements is slightly different in fig 5 a time histories of the water volume v that flowed into the cabin for the case in fig 3 are recorded the flow rate q i e the slope of the curve increases from 0 to a constant before the dimensionless time t reaches 15 the results with and without the edge swap operation agree fairly well with each other since the maximum difference of less than 0 9 is detected and by conducting the edge swap operation the simulation goes forward until t 44 for this case in order to have a better understanding of the quantitative characteristics of the inrush water spike 3 gauging points g a 0 0 d b 4 d f g b 0 0 d f and g c 0 0 d b 4 d f are distributed on the opening surface at t 0 the x coordinate of the fluid particle initially at g b is recorded for cases with and without the swap operations as shown in fig 5 b and again good agreement has been achieved therefore the edge swap operation is proved to be accurate and can help sustain a stable calculation in this work the operation is taken when any angle smaller than π 6 is detected and is taken in every 3 time steps other techniques that may help improve the mesh quality are also adopted including the surface interpolation 5 point least squares technique for keeping the mesh smooth zhang et al 2001 wang and manmi 2014 and the density potential method dpm which guarantees the nodes on the interface uniformly distributed zhang and liu 2015 the former technique is adopted every 10 time steps whilst the latter is used in each time step and note that in this work we simulate the water flows through an opening on the steel plate the contact angle of water at the edge of the opening is fixed to 90 and the three phase contact line remains pined at the sharp edge of the orifice this simplification is commonly used for simulating water flows through an orifice one can refer to the details from previous work borthakur et al 2017a 4 validation of the numerical model the comparison between our model with the 3d finite volume method fvm model in borthakur et al is given in fig 6 the water spike in this case is dominated by gravity with the bond number b o ρ g l 2 σ 0 67 in their work the calculation ends until the drop separation appears we take the profile of their water jet of the part near the orifice and depict it by the dashed line the trajectories of water flow between these two cases reach a fair agreement however in their work the constant flow rate is given while here the flow rate is increasing from zero at the beginning of the flow see fig 5 a therefore we further validate our numerical results with the experimental data the experiment is carried out with the help of the high speed photographic system the process of water flooding through a circular opening with the diameter of 16 mm is recorded at four moments as shown in fig 7 a and 7 d the initial depth d f of the centre of the opening is 30 mm a plastic paper that covered the opening is pulled upwards promptly and the water starts to rush into an empty glass tank this time is regarded as t 0 in the experiment the revelent numerical study is conducted with the density of water ρ 1000 kg m3 and the standard atmospheric pressure p a 101 3 kpa respectively the moments corresponding to those in the experiment are presented in fig 7 e 7 h the dashed lines are used to depict the profiles of the water spike in fig 7 b and 7 d one may find that the shapes of the water spikes agree with each other well through comparing the numerical and the experimental results the tip of the water spike in experiment evolves faster and protrudes downwards more obviously than the numerical results this is because when we move the cover away from the opening water at the lower part of the opening may flow inwards earlier which can be observed at the lower area of the air water interface near the edge in fig 7 a marked out by the dashed circle even though the comparison still reveals that the numerical model is capable of dealing with the dynamics of the flooding water spike 5 results and discussions in this section a parametric study is conducted to investigate the dynamics of the flooding water spike in detail the general features of the water spike is presented firstly with the developing flow stage and the stable flow stage of the flooding process being divided and described then the effect of the opening depth is discussed finally the shape of the opening i e when d a d b is considered 5 1 general features the general features of water flooding is presented in fig 8 the parameters are d a d b 1 0 and d f 2 5 respectively in the beginning the water migrates faster at the area close to the edge than the area at the central part of the opening which results in a concave shape in the middle of the air water interface little attention is being given on this phenomenon sice previous studies assume that there is a hemispherical drop initially stays at the opening borthakur et al 2017b the depth of the opening d f of this case is relatively small resulting in the weak water pressure at the opening and slow flooding water speed this makes the gravity presents obvious effect onto the motion of the water spike b o 13 7 and the lower part evolves faster as can be seen in fig 8 a the water spike enters the stable flow stage before t 10 95 at this moment the concave shape at the central area of the air water interface evolves much faster than other parts and protrudes outwards forming a convex shape on the contrary as shown in fig 8 b as the water rushes through the opening the tip of the spike becomes larger and evolves downwards see fig 8 c the water spike stretches deeper and lower into the cabin and becomes thinner as time goes on see fig 8 d finally the surface instability emerges at the tip of the water spike we may postulate that the developing flow stage of the flooding water spike terminates and the stable flow stage starts when the flow rate q reaches a constant as can be referred to the slope of the dimensionless historical volume curve in this case see fig 9 the developing flow stage of the flooding water spike is relatively shorter compared with that in fig 5 a since when the opening sizes l of the two cases are the same deeper opening position induces a faster developing flow and a larger flow rate q as for the migration of the water spike the dimensionless x coordinates of the gauging points g a g b and g c are recorded the fluid initially at the area near the edge of the opening g a and g c evolves faster than the central part g b which agrees with fig 8 a then the central part rushes into the cabin with a higher speed at the late developing flow stage i e t 6 10 in this case thus the position of point g b surpass the other two points see fig 8 b after then the flooding speed i e slopes of the curves of the points g b and g c changes little and that of the upper point g a is much smaller at the end of the simulation the depth in x direction of g b and g c are almost twice of that of g a which means that for the water rushes through the opening most of them comes from the lower position of the opening due to the greater water pressure there 5 2 flooding water spike at different opening depth effect of the initial opening depth on the flooding water spike migration is studied in this section firstly three different depth d f 1 0 d f 5 0 and d f 100 0 are considered as shown in fig 10 for each case 4 typical moments during the flooding process are recorded that is the beginning of the flooding the end of the developing flow stage the early time of the stable flow stage and the time when the simulation is well developed in the early stage of flooding the colour of the water spike surface depicts the dimensionless potential distribution it is obvious that the water spike evolves faster as the opening position gets deeper due to the higher water pressure and therefore the water shoots more straight into the cabin in the case with large depth since the high speed water has relatively large inertia in x direction making the gravity force acting on the water column not shown up in such a short period of time as for the left column in the figure at the beginning of water flooding the concave shape of air water interface is more symmetric with respect to the horizontal plane for larger d f during the developing flow stage shapes of the flooding water spike evolves from the moment of the first column to that of the second column in fig 10 the central part at the surface moves outwards faster forming a convex shape at the front of the water spike and this central area evolves even faster at larger depth in the stable flow stage shapes at the tip of the water spikes are almost unchanged as shown from the second to the fourth frame in each line of the figure at the end of the simulation the water spike has obvious translation in z direction for small d f case for d f 100 0 the spike has a symmetric shape until its tip reaches a relatively large x component five historical curves of the dimensionless water volume that flowed through the opening when the depth d f varies from 1 0 to 100 0 are presented in fig 11 a from this frame we can find that for each case the flow undergoes the transition from developing flow stage to the stable flow stage during the stable flow stage the water flows through the opening at a constant flow rate i e constant slope of the curve which is fitted through the dashed line as depicted in fig 11 a as the opening goes deeper the flow rate is increasing and the flow goes into the stable flow stage earlier the slopes of the fitted lines are also labeled in the figure the dimensionless flow rate q is given by 10 q t d v t d t as d f increases q at the stable flow stage of each case is recorded in fig 11 b these data is fitted by the curve 11 q d f 0 80 d f 0 22 1 0 one may find that as d f gets larger the increasing speed of q gradually falls down this trend also helps to choose the water pressure in order to get a required flow rate since in water hydraulics the flow coefficient of a designed valve is achieved by studying the characteristics of the water flow yusof et al 2013 the x coordinate of the fluid particle initially at the opening centre point g b for the 5 cases in fig 11 a is presented in fig 11 c comparing the cases of d f 1 0 and d f 100 0 the length of the water spike is about 7 times for the latter case of the former one at the same dimensionless time t 2 0 the inrush velocity in x direction slope of the curve increases in the developing flow stage reaching a maximum value at the beginning of the stable flow stage and then gradually decreases which will be further explained in the next part 5 3 flooding water spike through an elliptical opening in the situation of underwater collision as well as the case of water flows out from a pipe the shape of the opening sometimes is not a standard circle therefore effect of the shape of the opening is taken into consideration in this section two elliptical openings are chosen i e d a 1 0 d b 0 5 and d a 0 5 d b 1 0 respectively the depth is d f 10 these two cases are presented in fig 12 views from different directions at 3 moments during the flooding process are recorded for each case corresponding to each row in the figure here we define the size ratio λ d a d b and thus these two cases have λ 2 0 and λ 0 5 respectively at the beginning of water flooding one may see that the flow speed is larger at the area farther away from the centre of the opening resulting in the air water interface at the end of the long axis of the elliptical opening migrates faster for the second and third columns when the water enters the stable flow stage the shape of the front part of the water spike gradually deforms as time goes on for λ 2 0 the front part loses the initial elliptical shape as the water spike stretches it firstly deforms to a round shape and then to an elliptical shape whose long axis is perpendicular to that of the opening as can be seen in the o y z frame in fig 12 b and c respectively that is because in order to reach a minimum surface area the surface tension deforms the elliptical water jet to round shape however the deformation continues due the vertical inertia and finally produces another elliptical cross section of the water spike which is switched 90 farvardin and dolatabadi 2012 for λ 0 5 the evolution trend of the water spike is similar to that of λ 2 0 the case of a circular opening at the same depth is added for comparison in fig 13 the area of the circular opening is twice of the elliptical openings it reveals that the historical volume lines has nothing to do with the opening shape but is proportional to the opening area as can be seen from fig 13 a fig 13 b presents the historical position of fluid particle initially at the opening centre point g b in x direction the flow through the circular opening takes longer time to shift to the stable flow stage than that from the elliptical opening but once the stable flow stage arrives the water jet flows through larger opening evolves faster and finally advances deeper in fig 13 c when the x component of flow velocity v x of point g b is taken into consideration we find that water jet gets the maximum speed at the transition between the developing flow and stable flow stages since the flow rate is almost a constant in the stable flow stage and the v z keeps increasing due to the gravity the v x decreases to keep the conservation for larger opening the circular opening in this case the maximum v x of the water jet is larger meaning that the jet has larger momentum and stronger potential to make destructions to the facilities inside the cabin 6 conclusions the early stage of water flooding through an opening of a submerged vertical plate is simulated by the fast multipole boundary element method based on the potential flow theory the edge swap operation is adopted to improve the quality of the mesh at the surface of the water spike since the elements will be stretched to slender shapes and result in inaccuracy and unstable calculation through comparing with previous numerical results and our experimental data the model is proved to be accurate and qualified for studying the water flooding process after discussing the general features of the flooding water spike some parametric studies are carried out to find the effect of the depth and opening shape on the dynamic behaviour of the water spike the flow can be divided into the developing flow stage and the stable flow stage the water flow rate gradually increases during the developing flow stage and reach a constant value at the stable flow stage at the beginning of the first stage the flow at the area near the edge of the opening is faster than that at the central area which results in a concave shape of the air water interface this central area then starts to evolve faster making the front of the water spike form a convex shape when it enters the stable flow stage the water spike shoots into the cabin under the water pressure at the opening and the gravity force the water spike is stretched and becomes thinner due to the gravitational acceleration sometimes the surface instability emerges at the tip after a period of time as the depth of the opening increases the developing flow stage becomes shorter the water flow rate reaches a stable value soon the flow rate increases with the growing depth d f whilst the rate of increase declines due to the water inertia for large depth the effect of the gravity on these large d f cases is relatively weak the water spike maintians a symmetrical shape with respect to the horizontal plane even if it has rushed deeply into the cabin in x direction when comparing the dynamic behaviour of the flooding water spike through different shapes of the opening we find that it is the area instead of the shape that presents the influence the water flow rate is proportional to the area of the opening for large opening area the developing flow stage is longer whilst the central area evolves slower and the maximum velocity in x direction appears at the transition time of the two stages this study helps understand the dynamic behaviour of the flooding water spike in the initial stage of the flooding process caused by the underwater collision explosion etc the follow up work in the near future may be the investigation on the dynamics of the underwater explosion bubble induced flooding water spike which is much more violent non linear and have the potential to bring severe destruction to the facilities and structures inside the cabin acknowledgement this work is supported by the postdoctoral science foundation of china no 2019m653748 the natural science basic research plan in shaanxi province of china no 2019jq 448 and the national natural science fundation of china no 51879218 
22677,when an underwater collision or explosion happens to a ship the water will rush into the cabin through the broken opening the water spike induced by hydrostatic pressure has the potential to destroy the facilities and structures inside the cabin and the water flooding may threat the vitality of ship dynamic characteristics of this water spike during early flooding process is studied by a three dimensional fast multipole boundary element method fmbem based on the potential theory in this article the edge swap operation is elaborated and adopted to eliminate the slender elements at the air water interface which helps us study the evolution of the inrush water and maintains the computational efficiency the numerical model is validated by experimental data and the result from the finite volume method the flooding process can be divided into the developing flow stage and the stable flow stage the flow rate increases gradually during the former stage and reaches a constant value in the latter one through parametric study we find that the water flooded through the opening earlier is subjected to the gravity for longer time and achieves larger velocity which results in a slender water spike when the opening gets deeper the developing flow stage becomes shorter and the flow rate increases whilst the increasing speed slows down with the growing depth it is the area of the opening rather than the shape that influences the flow rate and flooding velocity and the maximum velocity in the horizontal direction appears at the transition time between the two stages this study reveals that the water flooding spike has complex and non linear dynamic behaviour and helps lay the foundation of studying the interaction between high speed water jet and the structures it also shows that the fmbem is suitable for dealing with the large scale moving boundary problems efficiently and accurately keywords water flooding boundary element method bem fast multipole method fmm ship collision 1 introduction the liquid rushing or flooding through an orifice opening is a very common phenomenon in many fields when the orifice is small e g less than millimetre scale and there is high pressure at the orifice the liquid jet has applications associated with the needle free injection or micro pump devices in bio medical fields fletcher and palanker 2001 fletcher et al 2002 gonzalez avila et al 2015 as well as the micro electrical mechanical devices or the ink jet printing borthakur et al 2019 in other fields such as ocean engineering or military sometimes the water flooding through an opening with the size of several metres happens which may due to ship collision with submerged reefs when sailing in shallow water i e the groundings nguyen et al 2011 or with icebergs during oceangoing voyage like rms titanic stettler and thomas 2013 and with other vessels or even under the attack of underwater explosions during the warfare there is nonlinear dynamics embedded in the motion of the liquid jets or flooding water and for the latter situations the flooding water with large momentum may rupture the facilities inside the cabin threat the ship vitality and even cause casualties which are needed to be studied in detail the liquid flows through small orifices has been studied extensively through experiments images of the formation and evolution of the liquid jet are captured by the high speed photographic system fletcher et al and avila et al measured the speed of the jet which is induced by the collapsing cavitation bubble fletcher and palanker 2001 fletcher et al 2002 gonzalez avila et al 2015 su n ol et al studied the jet breakup length and the dynamics in normal and micro gravity fields suol and gonzález cinca 2015 with numerical simulations pan suga focused on the evolution and breakup process of laminar liquid jets into the gas in parallel with the direction of gravity the surface wave is captured using the level set method and the liquid drop breakup mechanisms are discussed pan and suga 2006 when the jet shoots perpendicular to the gravity borthakur et al studied the parabolic trajectory of the jet under different parameter set and found the mechanism underlying the rotating liquid drops after their breakup borthakur et al 2019 the water flooding through a large broken opening at the bottom or side shell of a ship will endanger the ship s survivability previous works on this field mainly focused on the dynamic response of the damaged ship with flooding water sloshing inside the cabin or the ship motion during the sinking process acanfora luca conducted the experiment on a passenger ferry hull model with a rectangular opening at the broadside in a towing water tank acanfora and de luca 2017 roll responses of the model in still and beam regular waves are both studied le touzé et al cao et al sun et al and ming et al used the smoothed particle hydrodynamics sph to investigate the scenario of water flooding into a floating cabin le touzé et al 2010 zhang et al 2013 guo et al 2017 ming et al 2018 the sloshing motion of the cabin when the water rushes from the opening at the bilge bottom and side wall is discussed also the influence of transversal waves on the sinking process is considered measurements achieved by the sph show fair agreement with the experimental data gao et al employed the commercial computational fluid dynamics cfd solver fluent 12 0 to simulate the dynamics of a damaged ship model flooding and sinking in calm water gao et al 2018 ruponen researched on the leakage and collapse of the non watertight structures during the flooding process of a large passenger ship ruponen 2017 rodrigues soares studied the increment of the load onto a damaged ship due to the progressive flooding rodrigues and guedes soares 2017 in the above cases of water flooding into a broken cabin the water spike is injected by the ambient hydrostatic pressure and evolves perpendicular to the direction of gravity much less attention has been paid onto the physics and dynamical mechanism of the water spike in this processes however the water spike itself at the early stage of flooding has large momentum and may destroy the pipelines and facilities inside the cabin resulting in the lost of defensive power of the warship webster 2007 which is very worthy of study the numerical methods have advantages over experimental studies on this problem since the full scale model can be studied during calculation and details of the migration of the water jet are captured accurately when using the above cfd methods both the gas and liquid domains have to be discretized and the mesh near the air water interface needs to be refined to present the details this makes the computational cost increase as the water jet migrating and the total number of mesh is too large so the parallel super computing is needed borthakur et al 2017a the boundary element method bem only needs information on the boundaries of the flow domain which reduces the dimension of the calculating space by one cheng and cheng 2005 thus simplifies the mesh generation besides the infinite boundary condition is automatically satisfied in bem these advantages make this method be widely used for the open boundary problems with complicated geometries such as ship sails in wave wang 2005 shao and faltinsen 2014 chen et al 2016 as well as the moving boundary problems such as the cavitation bubble dynamics huang et al 2018 nonetheless the disadvantage is that the coefficient matrix of the discrete bem is dense this means that for a problem with the number of unknowns n the computational complexity and the memory storage are o n 3 and o n 2 for the conventional bem respectively in order to deal with this deficiency researchers adopted the fast multipole method fmm greengard and rokhlin 1987 carrier et al 1988 greengard 1988 to the bem and achieved the fast multipole boundary element method fmbem yoshida 2001 nishimura 2002 later on some improvements have been carried out to further accelerate the calculation including the adaptive tree structure shen and liu 2007 bapat and liu 2010 and the adoption of the dual boundary integral equation liu and shen 2007 liu 2009 the memory storage and the computational expense are cut down to o n through the above approaches in this work the fmbem is used to study the migration and dynamics of the water spike at the early stage of water flooding in order to eliminate large deformation of the meshes at the surface of the inrush water spike the edge swap operation is used and some numerical techniques are also considered to keep the air water interface smooth and uniformly distributed the physical model is formulated in sec 2 followed by the brief introduction of the fmbem in sec 3 1 through adopting the edge swap operation in sec 3 2 our model is validated by previous numerical result and our experimental data in sec 4 after presenting the general features of the water flooding precess in sec 5 1 parametric studies are conducted in secs 5 2 and 5 3 respectively effects of the depth and shape of the opening on the dynamics of the inrush water spike are investigated therein and finally in sec 6 concluding remarks are given with the outlook of the future work 2 physical model assume that an opening emerges at the side shell of a floating structure ship submarine or platform the water begins to rush through the opening into cabin this side shell is simplified as an vertical solid plate with a submerged opening as illustrated in fig 1 the plate is set in the y o z plane with the origin o laying on the static free surface right above the centre of the opening the shape of the opening is elliptical with the long axis and short axis denoted as d a and d b respectively the depth of the opening which is described by the distance from the centre of the opening to the static free surface is d f the x axis is perpendicular to the solid plate and pointed outwards the cabin see fig 2 we take the background of this study as the water flooding into a damaged ship cabin the inrush water speed v usually has the order of o 1 m s the size of the opening due to collision which is denoted as l l max d a d b is usually several metres nguyen et al 2011 hence the reynolds number r e v l ν of the flow field is 10 6 10 7 with ν indicating the kinematic viscosity therefore the flow is inertia dominated and the mach number of the problem discussed in this work is less than 0 02 in this parameter range we may postulate that the flow domain is inviscid incompressible and irrotational huang et al 2016 wang 2016 based on these assumptions there exist the velocity potential φ and the velocity v can be described by φ as v φ hence the laplace equation is the governing equation of the fluid domain as 1 2 φ x 2 2 φ y 2 2 φ z 2 0 we take the time when the opening is created as the beginning of simulation the air water interface at the opening is assumed as quasi static at t 0 the velocity potential φ and velocity v are both zero at this time throughout the fluid domain the flow is dominated by the gravity acceleration g the dynamic boundary condition on the opening surface reads 2 d φ d t 1 2 φ 2 2 σ κ ρ g z d f where σ is surface tension and κ the local curvature of the air water interface a cabin model with an elliptical opening is shown in fig 2 except for the vertical wall with opening other boundaries are auxiliary for making the infinite fluid domain outside the cabin have a closed boundary the velocity potential φ and velocity v on the solid boundary the auxiliary boundaries and the boundary at infinite are set to zero during the whole simulation and in order to track the position of the air water interface in each time step the following kinematic boundary condition is used 3 d r d t φ here r is the position vector of each fluid particle on the inrush water surface the non dimensionalization is carried out for the variables in this paper the characteristic parameters the length l of the long axis of the opening l max d a d b the density of liquid ρ and the pressure p 0 are taken as the length density and pressure scales respectively here p 0 denotes ambient hydrostatic pressure in the undisturbed liquid at the depth d f i e p 0 p a ρ g d f with p a denoting the standard atmospheric pressure and g the gravitational acceleration the derived dimensionless variables are 4a d f d f l d a d a l d b d b l v v ρ p 0 4b t t l p 0 ρ φ φ l ρ p 0 g ρ g l p 0 σ σ l p 0 note that all dimensionless variables have a as the superscript 3 mathematical model and numerical scheme 3 1 fast multipole boundary element method in the simulations the water spike keeps flooding into the cabin through the opening the air water interface at the opening undergoes large deformation therefore a relatively dense mesh has to be used there which makes the total unknowns of the problem more than ten thousands see fig 2 the fast multipole boundary element method liu 2009 huang et al 2016 is applied in our work to achieve a high efficiency computation which is briefly introduced in the following part through applying green s identity the solution of the velocity potential φ in fluid domain from laplace s equation eq 1 is 5 φ r s φ s g r s n s d s s s φ s n s g r s d s s r ω s s where r and s respectively denote the control point and the integral point g r s 1 4 π s r is the fundamental solution of the governing equation 1 for three dimensions n denotes the outward unit normal vector of the boundary s i e pointing inwards the cabin ω is the fluid domain excluding the boundaries a regular boundary integral equation rbie can be obtained if we let the control point r in domain ω in eq 5 approach to the boundary s 6 m r φ r s φ s g r s n s d s s s φ s n s g r s d s s r s s where m r is a geometrical function related to r if r stays on the surface s which is smooth around r m r is a constant and equals 1 2 as for the fmbem approach dealing with three dimensional 3d potential problems numerous previous researches have documented it in detail carrier et al 1988 nishimura 2002 shen and liu 2007 liu 2009 bapat and liu 2010 in the present work the expansions of kernels in the rbie are summarized briefly for completeness the fundamental solution g and its normal derivative g n y in eq 6 are expanded into 7a g r s 1 4 π s r 1 4 π k 0 q l k k p k l r s e q k l s s e s s e r s e 7b g r s n s 1 4 π k 0 q l k k p k l r s e q k l s s e n s s s e r s e where the expansion is truncated to the order of q refers to the complex conjugate yoshida 2001 note that in the equations above an expansion centre s e which is close to the integral point s is introduced the control and integral points are therefore separated via the expansion centre now are respectively associated with the solid harmonic functions p k l and q k l yoshida 2001 liu and shen 2007 through the expansion one can add the contributions from the integral points onto the expansion centre firstly and these contributions are stored and reused as the control point shifts from one to another during the calculation the expense of computation is thus reduced to satisfy the condition s s e r s e in eq 7 one should firstly find a subset s e of the entire boundary s i e s e s which is away from the control point r then substituting eqs 7a and 7b into 6 to calculate the following integrals 8a s e φ s n s g r s d s s 1 4 π k 0 q l k k p k l r s e m k l s e s s e r s e 8b s e φ s g r s n s d s s 1 4 π k 0 q l k k p k l r s e m k l s e s s e r s e 1 2 these two equations above are the so called multipole expansions yoshida 2001 which are crucial in the fast multipole method m k l and m k l are the multipole moments with the point s e being the centre 9a m k l s e s e φ s n s q k l r s e d s s 9b m k l s e s e φ s q k l s s e n s d s s with the multipole moments the integration on s e is independent of any control point r which is far away from s e so the multipole moments can be reused for many times once calculated in the 3d fmm an adaptive tree structure is used following bapat liu bapat and liu 2010 to divide the space containing all boundaries into many levels of boxes boxes in the deepest level of the tree are called leaves in each leaf the multipole moment is calculated a moment to moment translation m2m is used to accumulate integrals from leaves to the root the most coarse level of the tree similarly the control points can also be divided into boxes to further reduce the calculation cost thus the moment to local m2l and local to local l2l translations are essential which have been introduced in detail in literature yoshida 2001 liu 2009 bapat and liu 2010 the generalized minimal residual method gmres is used to solve the discrete bies iteratively saad and schultz 1986 with the coefficient matrix of integrals on elements in a leaf used as the pre conditioner to speed up the convergence in our previous work huang et al 2016 the fmbem is extended to solving the moving boundary problems we defined the acceleration factor a f 3 3 10 4 n 1 3 of fmbem compared with the conventional bem on calculation time consuming in this paper the total elements for each case is about n 20000 which means that a f 128 thus the calculation of each case can be finished on a normal desktop computer intel core i7 4790 with frequency of 4 00 ghz and allocated ram of 16 0 gb for less than 2 h 3 2 mesh optimization at the air water interface for the situation in this paper the air water interface deforms severely as the water spike migrates at the beginning of simulation the interface is meshed finely and each element has the shape that is close to a equilateral triangle nevertheless the elements on the surface of the water spike are still stretched to slender shapes after a period of time as shown in fig 3 a the boundaries are discretized into 20830 elements in this case too many slender elements may result in low accuracy or even collapse of the calculation we adopted the edge swap operation hua et al 2008 to eliminate the slender shaped elements in our program as shown in fig 4 through the following steps 1 for the two slender elements a b c and b d c that shearing the edge b c find the minimum angle α m i n among the six angles of these two elements 2 if the original elements a b c and b d c are both on the air water interface and none of the edges of these 2 elements belong to the three phase contact line then carry out the edge swap operation i e delete the edge b c and connect the nodes a and c instead thus two new elements a b d and a d c are generated 3 find the minimum angle α m i n among the six angles and the normal vectors n a b d n a d c of the two newly generated elements 4 compare the angles α m i n and α m i n find the angle β between vectors n a b d and n a d c and record the number of edges that each node a b c and d is connected 5 if α m i n α m i n and β π 2 and the number of edges that connected to either node is more than 4 and less than 9 the swap operation is finally approved without the edge swap operation the calculation has to be aborted at the time at fig 3 a in this case due to the deteriorated mesh quality when the edge swap is conducted the mesh is optimized as shown in fig 3 b the slender elements are eliminated and thus the calculation can continue note that in fig 4 the nodes a b c d are vertices of a tetrahedron which are not distributed in a plane meaning that the volume of the space wrapped by the original elements and the new elements is slightly different in fig 5 a time histories of the water volume v that flowed into the cabin for the case in fig 3 are recorded the flow rate q i e the slope of the curve increases from 0 to a constant before the dimensionless time t reaches 15 the results with and without the edge swap operation agree fairly well with each other since the maximum difference of less than 0 9 is detected and by conducting the edge swap operation the simulation goes forward until t 44 for this case in order to have a better understanding of the quantitative characteristics of the inrush water spike 3 gauging points g a 0 0 d b 4 d f g b 0 0 d f and g c 0 0 d b 4 d f are distributed on the opening surface at t 0 the x coordinate of the fluid particle initially at g b is recorded for cases with and without the swap operations as shown in fig 5 b and again good agreement has been achieved therefore the edge swap operation is proved to be accurate and can help sustain a stable calculation in this work the operation is taken when any angle smaller than π 6 is detected and is taken in every 3 time steps other techniques that may help improve the mesh quality are also adopted including the surface interpolation 5 point least squares technique for keeping the mesh smooth zhang et al 2001 wang and manmi 2014 and the density potential method dpm which guarantees the nodes on the interface uniformly distributed zhang and liu 2015 the former technique is adopted every 10 time steps whilst the latter is used in each time step and note that in this work we simulate the water flows through an opening on the steel plate the contact angle of water at the edge of the opening is fixed to 90 and the three phase contact line remains pined at the sharp edge of the orifice this simplification is commonly used for simulating water flows through an orifice one can refer to the details from previous work borthakur et al 2017a 4 validation of the numerical model the comparison between our model with the 3d finite volume method fvm model in borthakur et al is given in fig 6 the water spike in this case is dominated by gravity with the bond number b o ρ g l 2 σ 0 67 in their work the calculation ends until the drop separation appears we take the profile of their water jet of the part near the orifice and depict it by the dashed line the trajectories of water flow between these two cases reach a fair agreement however in their work the constant flow rate is given while here the flow rate is increasing from zero at the beginning of the flow see fig 5 a therefore we further validate our numerical results with the experimental data the experiment is carried out with the help of the high speed photographic system the process of water flooding through a circular opening with the diameter of 16 mm is recorded at four moments as shown in fig 7 a and 7 d the initial depth d f of the centre of the opening is 30 mm a plastic paper that covered the opening is pulled upwards promptly and the water starts to rush into an empty glass tank this time is regarded as t 0 in the experiment the revelent numerical study is conducted with the density of water ρ 1000 kg m3 and the standard atmospheric pressure p a 101 3 kpa respectively the moments corresponding to those in the experiment are presented in fig 7 e 7 h the dashed lines are used to depict the profiles of the water spike in fig 7 b and 7 d one may find that the shapes of the water spikes agree with each other well through comparing the numerical and the experimental results the tip of the water spike in experiment evolves faster and protrudes downwards more obviously than the numerical results this is because when we move the cover away from the opening water at the lower part of the opening may flow inwards earlier which can be observed at the lower area of the air water interface near the edge in fig 7 a marked out by the dashed circle even though the comparison still reveals that the numerical model is capable of dealing with the dynamics of the flooding water spike 5 results and discussions in this section a parametric study is conducted to investigate the dynamics of the flooding water spike in detail the general features of the water spike is presented firstly with the developing flow stage and the stable flow stage of the flooding process being divided and described then the effect of the opening depth is discussed finally the shape of the opening i e when d a d b is considered 5 1 general features the general features of water flooding is presented in fig 8 the parameters are d a d b 1 0 and d f 2 5 respectively in the beginning the water migrates faster at the area close to the edge than the area at the central part of the opening which results in a concave shape in the middle of the air water interface little attention is being given on this phenomenon sice previous studies assume that there is a hemispherical drop initially stays at the opening borthakur et al 2017b the depth of the opening d f of this case is relatively small resulting in the weak water pressure at the opening and slow flooding water speed this makes the gravity presents obvious effect onto the motion of the water spike b o 13 7 and the lower part evolves faster as can be seen in fig 8 a the water spike enters the stable flow stage before t 10 95 at this moment the concave shape at the central area of the air water interface evolves much faster than other parts and protrudes outwards forming a convex shape on the contrary as shown in fig 8 b as the water rushes through the opening the tip of the spike becomes larger and evolves downwards see fig 8 c the water spike stretches deeper and lower into the cabin and becomes thinner as time goes on see fig 8 d finally the surface instability emerges at the tip of the water spike we may postulate that the developing flow stage of the flooding water spike terminates and the stable flow stage starts when the flow rate q reaches a constant as can be referred to the slope of the dimensionless historical volume curve in this case see fig 9 the developing flow stage of the flooding water spike is relatively shorter compared with that in fig 5 a since when the opening sizes l of the two cases are the same deeper opening position induces a faster developing flow and a larger flow rate q as for the migration of the water spike the dimensionless x coordinates of the gauging points g a g b and g c are recorded the fluid initially at the area near the edge of the opening g a and g c evolves faster than the central part g b which agrees with fig 8 a then the central part rushes into the cabin with a higher speed at the late developing flow stage i e t 6 10 in this case thus the position of point g b surpass the other two points see fig 8 b after then the flooding speed i e slopes of the curves of the points g b and g c changes little and that of the upper point g a is much smaller at the end of the simulation the depth in x direction of g b and g c are almost twice of that of g a which means that for the water rushes through the opening most of them comes from the lower position of the opening due to the greater water pressure there 5 2 flooding water spike at different opening depth effect of the initial opening depth on the flooding water spike migration is studied in this section firstly three different depth d f 1 0 d f 5 0 and d f 100 0 are considered as shown in fig 10 for each case 4 typical moments during the flooding process are recorded that is the beginning of the flooding the end of the developing flow stage the early time of the stable flow stage and the time when the simulation is well developed in the early stage of flooding the colour of the water spike surface depicts the dimensionless potential distribution it is obvious that the water spike evolves faster as the opening position gets deeper due to the higher water pressure and therefore the water shoots more straight into the cabin in the case with large depth since the high speed water has relatively large inertia in x direction making the gravity force acting on the water column not shown up in such a short period of time as for the left column in the figure at the beginning of water flooding the concave shape of air water interface is more symmetric with respect to the horizontal plane for larger d f during the developing flow stage shapes of the flooding water spike evolves from the moment of the first column to that of the second column in fig 10 the central part at the surface moves outwards faster forming a convex shape at the front of the water spike and this central area evolves even faster at larger depth in the stable flow stage shapes at the tip of the water spikes are almost unchanged as shown from the second to the fourth frame in each line of the figure at the end of the simulation the water spike has obvious translation in z direction for small d f case for d f 100 0 the spike has a symmetric shape until its tip reaches a relatively large x component five historical curves of the dimensionless water volume that flowed through the opening when the depth d f varies from 1 0 to 100 0 are presented in fig 11 a from this frame we can find that for each case the flow undergoes the transition from developing flow stage to the stable flow stage during the stable flow stage the water flows through the opening at a constant flow rate i e constant slope of the curve which is fitted through the dashed line as depicted in fig 11 a as the opening goes deeper the flow rate is increasing and the flow goes into the stable flow stage earlier the slopes of the fitted lines are also labeled in the figure the dimensionless flow rate q is given by 10 q t d v t d t as d f increases q at the stable flow stage of each case is recorded in fig 11 b these data is fitted by the curve 11 q d f 0 80 d f 0 22 1 0 one may find that as d f gets larger the increasing speed of q gradually falls down this trend also helps to choose the water pressure in order to get a required flow rate since in water hydraulics the flow coefficient of a designed valve is achieved by studying the characteristics of the water flow yusof et al 2013 the x coordinate of the fluid particle initially at the opening centre point g b for the 5 cases in fig 11 a is presented in fig 11 c comparing the cases of d f 1 0 and d f 100 0 the length of the water spike is about 7 times for the latter case of the former one at the same dimensionless time t 2 0 the inrush velocity in x direction slope of the curve increases in the developing flow stage reaching a maximum value at the beginning of the stable flow stage and then gradually decreases which will be further explained in the next part 5 3 flooding water spike through an elliptical opening in the situation of underwater collision as well as the case of water flows out from a pipe the shape of the opening sometimes is not a standard circle therefore effect of the shape of the opening is taken into consideration in this section two elliptical openings are chosen i e d a 1 0 d b 0 5 and d a 0 5 d b 1 0 respectively the depth is d f 10 these two cases are presented in fig 12 views from different directions at 3 moments during the flooding process are recorded for each case corresponding to each row in the figure here we define the size ratio λ d a d b and thus these two cases have λ 2 0 and λ 0 5 respectively at the beginning of water flooding one may see that the flow speed is larger at the area farther away from the centre of the opening resulting in the air water interface at the end of the long axis of the elliptical opening migrates faster for the second and third columns when the water enters the stable flow stage the shape of the front part of the water spike gradually deforms as time goes on for λ 2 0 the front part loses the initial elliptical shape as the water spike stretches it firstly deforms to a round shape and then to an elliptical shape whose long axis is perpendicular to that of the opening as can be seen in the o y z frame in fig 12 b and c respectively that is because in order to reach a minimum surface area the surface tension deforms the elliptical water jet to round shape however the deformation continues due the vertical inertia and finally produces another elliptical cross section of the water spike which is switched 90 farvardin and dolatabadi 2012 for λ 0 5 the evolution trend of the water spike is similar to that of λ 2 0 the case of a circular opening at the same depth is added for comparison in fig 13 the area of the circular opening is twice of the elliptical openings it reveals that the historical volume lines has nothing to do with the opening shape but is proportional to the opening area as can be seen from fig 13 a fig 13 b presents the historical position of fluid particle initially at the opening centre point g b in x direction the flow through the circular opening takes longer time to shift to the stable flow stage than that from the elliptical opening but once the stable flow stage arrives the water jet flows through larger opening evolves faster and finally advances deeper in fig 13 c when the x component of flow velocity v x of point g b is taken into consideration we find that water jet gets the maximum speed at the transition between the developing flow and stable flow stages since the flow rate is almost a constant in the stable flow stage and the v z keeps increasing due to the gravity the v x decreases to keep the conservation for larger opening the circular opening in this case the maximum v x of the water jet is larger meaning that the jet has larger momentum and stronger potential to make destructions to the facilities inside the cabin 6 conclusions the early stage of water flooding through an opening of a submerged vertical plate is simulated by the fast multipole boundary element method based on the potential flow theory the edge swap operation is adopted to improve the quality of the mesh at the surface of the water spike since the elements will be stretched to slender shapes and result in inaccuracy and unstable calculation through comparing with previous numerical results and our experimental data the model is proved to be accurate and qualified for studying the water flooding process after discussing the general features of the flooding water spike some parametric studies are carried out to find the effect of the depth and opening shape on the dynamic behaviour of the water spike the flow can be divided into the developing flow stage and the stable flow stage the water flow rate gradually increases during the developing flow stage and reach a constant value at the stable flow stage at the beginning of the first stage the flow at the area near the edge of the opening is faster than that at the central area which results in a concave shape of the air water interface this central area then starts to evolve faster making the front of the water spike form a convex shape when it enters the stable flow stage the water spike shoots into the cabin under the water pressure at the opening and the gravity force the water spike is stretched and becomes thinner due to the gravitational acceleration sometimes the surface instability emerges at the tip after a period of time as the depth of the opening increases the developing flow stage becomes shorter the water flow rate reaches a stable value soon the flow rate increases with the growing depth d f whilst the rate of increase declines due to the water inertia for large depth the effect of the gravity on these large d f cases is relatively weak the water spike maintians a symmetrical shape with respect to the horizontal plane even if it has rushed deeply into the cabin in x direction when comparing the dynamic behaviour of the flooding water spike through different shapes of the opening we find that it is the area instead of the shape that presents the influence the water flow rate is proportional to the area of the opening for large opening area the developing flow stage is longer whilst the central area evolves slower and the maximum velocity in x direction appears at the transition time of the two stages this study helps understand the dynamic behaviour of the flooding water spike in the initial stage of the flooding process caused by the underwater collision explosion etc the follow up work in the near future may be the investigation on the dynamics of the underwater explosion bubble induced flooding water spike which is much more violent non linear and have the potential to bring severe destruction to the facilities and structures inside the cabin acknowledgement this work is supported by the postdoctoral science foundation of china no 2019m653748 the natural science basic research plan in shaanxi province of china no 2019jq 448 and the national natural science fundation of china no 51879218 
22678,lateral soil resistance plays a significant role in lateral buckling which is a main consideration in the design of subsea pipelines in this study a new lateral soil resistance model is proposed to describe the lateral resistance force displacement relation it shows a good agreement with existing test results based on the new lateral soil resistance model analytical solution for the lateral buckling of subsea pipelines with initial imperfections is presented the exact formula to determine the critical half wavelength is also presented the effects of initial imperfection parameters soil properties and parameters and lateral soil resistance models on critical force of lateral buckling are discussed results show that the capacity of subsea pipeline against lateral buckling increases with the increase of the initial half wavelength submerged unit weight of soil and vertical load it decreases with the increase of the initial imperfection amplitude soil undrained shear strength and breakout displacement the critical forces of lateral buckling in and away from the buckled region both depend on the exact lateral soil resistance model and initial imperfection parameters keywords subsea pipelines lateral buckling lateral soil resistance model critical force nomenclature d pipeline diameter v vertical load applied to pipe su soil undrained shear strength st soil sensitivity zinit initial embedment of pipeline f e limit force of f in linear elasticity stage f b breakout resistance f r residual resistance w i n initial embedment depth of the pipeline u dimensionless form of y u y d u b breakout displacement u r residual displacement u e lateral displacement corresponding to f e p axial force in buckled region p 0 axial force away from buckled region a cross section area ei flexural rigidity of pipeline section y 0 initial imperfection shape function y lateral displacement of pipeline not including initial deviation y 0 amplitude of initial imperfection y amplitude of lateral displacement α thermal expansion coefficient β coefficient for u b ε coefficient for u r δ coefficient for u e γ submerged unit weight of soil l the total length of pipeline t pipeline wall thickness l 0 the initial wavelength of imperfection λ half wavelength of the buckled pipeline f y nonlinear lateral resistance per unit length δt temperature difference δp pressure difference ν poisson s ratio 1 introduction long subsea pipelines are widely used to transport untreated hydrocarbons from well heads subsea pipelines often serve in high temperature and high internal pressure conditions which brings large challenges to the design of subsea pipelines one of the challenges is lateral buckling caused by excessive compressive axial force due to high temperature and high internal pressure lateral buckling may damage the integrity of subsea pipelines in terms of bending stresses triggering collapse or even fracture failure mode dnvgl rp f110 2018 therefore the study of the lateral buckling problem becomes very important for the design of subsea pipelines many studies have been conducted focusing on buckling mechanisms and the description of the critical state why buckling occurs palmer and baldry 1974 gave a correct answer to the controversial question on reason for lateral buckling and confirmed the conclusion by experiment it is the axial compressive force produced by internal pressure that leads to lateral buckling of pipelines hobbs 1981 1984 proposed five modes of lateral buckling and the analytical solutions for the buckling wavelength amplitude and critical force corresponding to those five modes based on the works of railroad track however the initial imperfections were not considered in his studies using a similar analytical method taylor and his colleagues proposed some analytical formulas for lateral buckling of subsea pipelines with the presence of initial imperfections taylor and gan 1984 1986a taylor and tran 1993 1996 thereafter many theoretical works on lateral buckling were based on hobbs s method hong et al 2015 proposed analytical solutions for high order lateral buckling mode of subsea pipelines with the presence of one symmetric imperfection tianfeng and xianhong 2015 proposed an analytical solution for the global buckling of a subsea pipeline that was restrained by two segmented ditching constructions wang et al 2018 studied the lateral buckling response of subsea pipelines that was triggered by one sleeper and proposed analytical solutions for this case lateral bucking triggered by distributed buoyancy sections was investigated by wang et al 2017a b and some analytical solutions were presented for the case hobbs s method has been extended and improved however there exists one limitation in the above studies that the seabed was assumed to be a frictional rigid foundation although some works with respect to lateral buckling of subsea pipelines in soft seabed were done by wang et al 2011 shi et al 2013 and shi and wang 2014 the soil resistance was still assumed to be invariable with pipeline displacement actually lateral buckling is greatly affected by lateral soil resistance and deformation dependent resistance force model as explained by tvergaard and needleman 1980 and taylor and gan 1986b this explanation has been confirmed by many investigators maltby and calladine 1995a b conducted experimental and theoretical studies with respect to the thermal buckling of subsea pipelines and found the localization phenomenon as the initial imperfection grows under steadily increasing axial compressive force their analysis results show two key points for buckling the interaction between the subsea pipeline and soil should be expressed as a nonlinear force displacement relationship and the relation between the localization and the maximum axial load is essential for lateral buckling response karampour et al 2013 confirmed maltby and calladine s work and presented a new explanation for buckling localization by two load carrying mechanisms membrane and flexure their analysis results show that the critical state of lateral buckling is related to the condition of localization and the nonlinear soil resistance plays a critical role in the localization of lateral buckling of subsea pipelines with the presence of initial imperfections therefore simple friction coefficient approximation or invariable soil resistance is inappropriate to describe the relation between the subsea pipeline and soil on seabed during lateral buckling the main reason is that the influences of initial penetration and soil berm are not taken account bruton et al 2006 white and chuck 2008 chatterjee et al 2012 concerning lateral soil resistance investigators have proposed different lateral soil resistance models to study the localized lateral buckling problem a bi linear model was proposed by lagrange and averbuch 2012 to study the uniform development of sinusoidal imperfection in a strut on a nonlinear foundation tvergaard and needleman 1980 used a piecewise linear model to study the localization of buckling patterns tri line model was proposed by white and cheuk 2008 to describe the soil resistance model in large lateral movements exponential model was proposed by maltby and calladine 1995b and was used to study the lateral buckling mechanism by karampour et al 2013 hyperbola model was proposed by trautmann et al 1985 to express the resistance force displacement relation a quintic polynomial model was proposed by zeng and duan 2014 to study the localized lateral buckling wang and liu 2016 and liu et al 2015 carried out a series of experiments on the lateral resistance of shallow pipelines a typical lateral resistance force displacement curve of their tests is shown in fig 1 which also shows the above lateral resistance models under the same conditions it can be seen clearly that the existing lateral resistance models have relatively small differences with the test results before the lateral soil resistance reaches peak value after the peak the above existing resistance models are far away from the test results that is to say the existing lateral resistance models sometimes cannot accurately describe the entire resistance force displacement relation therefore it is necessary to do further research on the non linear lateral resistance model and the effect of lateral resistance on the lateral buckling behavior in this paper a new lateral soil resistance model is proposed based on the new lateral soil resistance model analytical solution for the lateral buckling of subsea pipelines on nonlinear foundation is presented the analytical solution is compared with the published results and fe results it is shown that the proposed methodology is effective to obtain the critical force and capture the main feature of lateral buckling the exact formula to determine the critical half wavelength is also presented the effects of initial imperfection parameters soil properties and parameters and lateral soil resistance models on the critical force of lateral buckling are discussed 2 lateral soil resistance model and verification consider a pipeline of length l which is directly laid on the seabed horizontal plane x y as shown in fig 2 a the pipeline initially has a symmetrical imperfection with initial wavelength 2l 0 and imperfection shape function y 0 x because of high temperature and high internal pressure loads a compressive axial force p is produced in the pipeline which can be written as taylor and tran 1996 karampour et al 2013 zeng et al 2014 zhang and duan 2015 zhang et al 2018 1 p e a α δ t δ p a d 2 t 0 5 ν where e is the young s modulus a d t α and ν are pipeline cross section area diameter wall thickness thermal expansion coefficient and poisson s ratio respectively δ t and δ p are temperature difference and pressure difference respectively the axial force increases as the increase of temperature and pressure difference axial expansion will occur in the pipeline if the ends of the pipeline are free while the expansion is actually restricted by the axial soil resistance the axial force accumulates once the axial force exceeds a certain level critical buckling force the lateral buckling occurs as shown in fig 2 b as the pipeline feeds into the buckle the axial force in feed in region drops which makes it easier to draw more parts adjacent to the buckle into the buckle the length of the feed in region is denoted by l s it is assumed that the soil beneath the pipeline is clay in this paper during the lateral buckling process the unit lateral resistance f applied to the pipeline by soil is nonlinear and is a function that depends on lateral displacement y the axial soil resistance is denoted by f a to better study the influence of lateral soil resistance on the lateral buckling response of subsea pipelines the accurate lateral soil resistance model lateral resistance force displacement relation is essential in the following sections a new lateral soil resistance model is proposed and verified 2 1 lateral soil resistance model previous experimental and numerical studies on lateral soil resistance show that the breakout resistance f b breakout displacement y b the distance of the pipeline has moved before the breakout resistance force is reached residual resistance f r and residual displacement y r are key parameters for lateral soil resistance model bruton et al 2006 white and chuck 2008 chatterjee et al 2012 wang and liu 2016 liu et al 2015 when a subsea pipeline is laid on the seabed owing to its self weight it embeds partially in the soil on the seabed the initial embedment depth w in affects the breakout resistance it is related to the soil sensitivity s t vertical load v soil undrained shear strength s u and pipeline diameter d it can be calculated as bruton et al 2006 2 w i n d s t 15 v d s u 2 note that the lateral soil resistance depends on embedment at start up rather than initial embedment in this paper the additional consolidation settlement is neglected and the embedment at start up is assumed to be equal to the initial embedment the breakout resistance is reached when the lateral soil resistance is mobilized it is a function that depends on vertical load initial embedment depth soil undrained shear strength pipeline diameter and submerged unit weight of soil γ it can be determined by bruton et al 2006 3 f b 0 2 v 3 s u γ d w i n as breakout resistance is reached large displacement occurs in this process if the pipeline is light it will move upward and the resistance approaches a steady value if the pipeline is heavy it will move downward resulting in increasing passive berm resistance and then the resistance approaches a steady value in either case the steady value is referred to as residual resistance which is related to vertical load submerged soil weight per unit length soil undrained shear strength and pipeline diameter it can be determined by bruton et al 2006 4 f r v 1 0 65 1 exp 1 2 s u γ d the breakout displacement y b and the residual displacement y r can be determined by zeng and duan 2014 5 y b β d 6 y r ε d where β and ε represent two empirical coefficients for breakout displacement and residual displacement respectively once the breakout resistance and residual resistance are obtained it is convenient to model the complete resistance force displacement response the model proposed here results from combining the tri line model and the hyperbola model as shown by solid line in fig 3 it is expressed as follows 7 f u a u 3 b u 2 c u u 2 p u q u y d where a b c p and q are all coefficients and can be determined later the above formula can be written as 8 f u a u b a p u 2 c a q u u 2 p u q u y d it can be seen from the above formula that if omitting the second term the lateral soil resistance force displacement relation becomes linear which corresponds to the first stage of tri line model therefore the second term of the above formula controls the nonlinear part of the model the lateral soil resistance model needs to meet the following requirements so as to determine the above coefficients i when the normalized lateral displacement of the pipeline reaches β the breakout resistance is reached therefore it has 9 f u u β f b ii when the normalized lateral displacement of the pipeline reaches ε the residual resistance is reached this results in 10 f u u ε f r iii once the normalized lateral displacement of the pipeline reaches ε the lateral resistance holds constant no matter what the lateral displacement is equal to therefore the slope for the lateral resistance displacement curve is equal to zero or approximately equals zero zhang et al 2017 11 d f u d s u ε 0 iv when the lateral resistance reaches the proportional limit the lateral resistance takes 70 of the breakout resistance trautmann et al 1985 assume in this case the normalized lateral displacement takes δ therefore it meets the following condition 12 f u u δ 0 7 f b i the lateral resistance experiences the maximum value when the lateral displacement reaches breakout displacement this results in 13 d f u d s u β 0 there are five unknown coefficients in the nonlinear lateral soil resistance model eq 7 or 8 and five functions eq 9 to 13 therefore the new lateral soil resistance model can be identified 2 2 verification of the lateral soil resistance model one set of experimental test results from wang and liu 2016 are selected to validate the present lateral soil resistance model in their tests a hermetic pvc pipe segment was used and the length and outer diameter were 1 m and 0 16 m respectively the pipe segment was initially embedded in fine dry sand with depth 0 06 m their tests were carried out in dry environment which is far away to subsea environment in which subsea pipelines serve therefore empirical formulas eqs 2 4 cannot be used to calculate the key parameters f b and f r according to their test results the breakout resistance f b and resistance f r are around 315 0 n and 75 3 n respectively the normalized displacements the ratios of actual displacement to pipeline diameter corresponding to breakout and residual resistance are 0 60 and 7 98 respectively according to the above method the lateral soil resistance model can be obtained as 14 f u 315 0 01 u 3 0 0279 u 2 1 0855 u u 2 0 1389 u 0 2315 the above lateral soil resistance model is plotted in fig 4 for comparison fig 4 also shows the set of experimental test results from wang and liu et al 2016 and tri line model from fig 4 it is clear that the results of the present model have a good agreement with the results of the tri line model and the experiments in first phase lateral soil resistance ranges from zero to the proportional limit in the second phase lateral soil resistance ranges from the proportional limit to breakout resistance the results from the present model have a better agreement with the results of the experiments than the tri line model in the third and fourth phrases lateral soil resistance ranges from breakout resistance to residual resistance and ranges from residual resistance to the end the results of the present model have an excellent agreement with the results of the experimental test while the results of the tri line model are very different from the experimental tests therefore the proposed lateral soil resistance model has a good agreement with the experimental test in the entire lateral movement process 3 lateral buckling of the pipelines on nonlinear foundation 3 1 analytical model maltby and calladine 1995b presented a simplified analysis to investigate the localization phenomenon of lateral buckling herein a similar model is built to study the lateral buckling response of subsea pipelines with initial imperfections based on the new lateral soil resistance model it is assumed that the initial imperfection follows the following form 15 y 0 x y 0 cos π l 0 x where y 0 denotes the amplitude of initial imperfection take a half wave of buckled pipeline the topology and the loads imposed on the pipeline segment are shown in fig 5 under the compressive axial force p and lateral soil resistance f the governing equation of the buckled pipeline is 16 e i y y 0 p y f y 0 where f y represents the lateral soil resistance per unit length which is a function of lateral displacement y it can be determined by eq 7 or 8 for simplicity it is assumed that the distribution of f in the x direction is always cosinoidal the same assumption was made by maltby and calladine 1995b and karampour et al 2013 with this assumption a cosinoidal lateral displacement will be the solution of eq 16 as follows 17 y x y cos π λ x where y and λ denote the amplitude of the lateral displacement and half wavelength of the buckled pipeline respectively setting λ l 0 and substituting eqs 15 and 17 into eq 16 eq 16 can then be rewritten in the terms of amplitude y 18 π 4 e i λ 4 y y 0 π 2 λ 2 p y f 0 a solution for the axial force p in buckled region of the pipeline is obtained 19 p π 2 e i λ 2 1 y 0 y λ 2 π 2 f y from eq 19 it is clear that the axial force in buckled region is a function of the amplitude of lateral displacement the first term on the right side of eq 19 increases with the increase of y while the second term decreases with the increase of y therefore the lateral buckling response in buckled region can be a bifurcation type with unstable post buckling response also called snap through or be a stable type with monotonic increase with y if a bifurcation type lateral buckling occurs the critical force can be obtained in which p has a local maximum therefore the first order differential of p should be zero as follows 20 y d f d y f π λ 4 e i y 0 0 where f is function of y it is obvious that the extreme value points are related to f in other words the critical force depends on the exact lateral soil resistance relation details on that will be discussed later now see eq 20 it is an equation of degree higher than four to obtain the analytical solution is not easy numerical method can be used to solve it suppose that y m satisfies the above equation and makes the local maximum of axial force p the critical force can then be determined by p y m alternatively the critical force can also be obtained by plotting the p y curve for stable type lateral buckling the critical force can only be determined by the latter method the axial force away from the buckled region p 0 can be obtained by taking the compatibility condition into account that is the reduction of axial force in the buckle equals the product of the axial stiffness and the extension round the curve as shown 21 p 0 p e a λ λ 2 λ 2 y 2 2 y 0 2 2 substituting eqs 15 and 17 into eq 21 the axial force away from the buckled region is obtained 22 p 0 π 2 e i λ 2 1 y 0 y e a 4 π 2 λ 2 y 2 y 0 2 λ 2 π 2 f y the axial force away from the buckled region can also be seen as a function of lateral displacement amplitude similar with axial force in buckled region the lateral buckling response away from the buckled region can also be a bifurcation type or be a stable type if a bifurcation type lateral buckling occurs the critical force can be obtained in which p 0 has a local maximum therefore the first order differential of p 0 should be zero as follows 23 e a y 3 2 λ π 4 d f d y y f 2 e i y 0 0 similarly the extreme value points of p 0 are related to f and the critical force away from the buckled region also depends on the exact lateral soil resistance relation the above two methods can also be used to determine the critical force of lateral buckling away from the buckled region 3 2 comparison with the literature and finite element simulation to provide verification for the above analytical solutions 2d two dimensional finite element fe models were developed with the frame of abaqus the pipeline was modelled by timoshenko beam element pipe21 the soil and the interaction between the pipeline and soil were modelled by pipe soil interaction element psi24 the proposed lateral soil resistance model was used as the nonlinear constitutive relationship between lateral resistance and displacement the nonlinear equilibrium equations were solved by riks method for sake of comparison the same geometric and material properties used by hobbs 1984 and karampour et al 2013 are adopted as shown in table 1 according to bruton et al 2006 and white and chuck 2008 the typical value for breakout displacement is less than half of a diameter and the typical value for residual displacement is in the region of 3 5 times diameter therefore the breakout displacement and residual displacement are taken 0 5d and 5d respectively in this paper the soil sensitivity typically ranges from 2 to 5 for soft marine clays randolph and white 2008 here it is taken 4 5 the soil properties and parameters are listed in table 2 according to the above parameters and the proposed method in section 2 1 the lateral soil resistance force displacement relation is obtained 24 f u 2706 2 0 02 u 3 0 5753 u 2 1 545 u u 2 1 1095 u 0 1140 the amplitude of initial imperfection y 0 and half wavelength of the buckling λ are taken as 0 1 m and 50 m respectively according to eq 22 the compressive axial force away from the buckled region versus lateral displacement amplitude curve is plotted in fig 6 for comparison fig 6 also shows the results of hobbs 1984 corresponding to mode 3 the results of taylor and gan 1986a and the fe results it is worth to note that in hobbs s and taylor and gan s analysis the seabed was assumed to be rigid and the lateral pipe soil interaction was simplified to the coulomb friction model to compare the results of the present model and their results the residual resistance in the present lateral soil resistance model should be equal to the friction in their models therefore the lateral friction coefficient is taken as 0 57 in this way the lateral friction is same with the residual resistance i e 2171 4n m in this situation the critical forces of lateral buckling calculated by hobbs s formula and taylor and gan s formula are 3 207 mn and 4 578 mn respectively however the critical forces of lateral buckling obtained by the present analytical method and fe method are 7 119 mn and 7 191 mn respectively it is obvious that the critical force of lateral buckling calculated by the present analytical model has a good agreement with that calculated by fe method whereas it is larger by 122 0 and 55 5 than that calculated by hobbs s method and that calculated by taylor and gan s method respectively zeng and duan 2014 proposed two formulas to determine the upper and lower limits for critical force of lateral buckling on nonlinear foundation according to their formulas the upper and lower limits of the critical force under the above conditions are 7 734 mn and 5 189 mn respectively from this point the critical forces of lateral buckling predicted by the present analytical model and fe models agree well with the results of zeng and duan 2014 4 parametric analysis and discussion 4 1 effect of initial imperfections using the present methodology the influences of initial imperfections on the lateral buckling of subsea pipelines on nonlinear foundation are discussed in this section the pipeline parameters pipeline properties soil properties and soil parameters were kept constant see tables 1 and 2 first let the amplitude of the initial imperfection y 0 vary from 0 1 m to 0 5 m while keeping initial half wavelength constant the axial force in buckled region versus the lateral displacement amplitude curves are plotted in fig 7 it is clear that the critical force of lateral buckling in buckled region decreases with the increase of initial imperfection amplitude the smaller the initial imperfection amplitude is the more obvious the snap through is when the initial imperfection amplitude equals 0 5 m the snap through almost disappears in other words the lateral buckling changes from bifurcation type to stable type fig 8 shows the axial force away from the buckled region versus the lateral displacement amplitude curves from fig 8 it can be seen that the critical force of lateral buckling away from the buckled region has similar rules with that in buckled region the snap through away from the buckled region is more obvious than that in buckled region let the initial half wavelength of the imperfection vary from 30 m to 50 m while keeping the initial imperfection amplitude constant the axial force in buckled region versus the lateral displacement amplitude curves are plotted in fig 9 it is clear that the critical force of lateral buckling in buckled region increases with the increase of initial half wavelength the larger the initial half wavelength is the more obvious the snap through is when the initial half wavelength equals 30 m no bifurcation buckling occurs the lateral buckling changes from bifurcation type to stable type as the half wavelength decreases fig 10 shows the axial force away from the buckled region versus the lateral displacement amplitude curves from fig 10 it can be seen that the critical force of lateral buckling away from the buckled region has similar rules with that in buckled region comparing fig 10 with fig 9 it can be seen that the critical force of lateral buckling away from the buckled region is larger than that in buckled region and the snap through away from the buckled region is more obvious than that in buckled region from fig 9 or 10 it can be seen that there exists a critical value of the initial half wavelength when the initial half wavelength is higher than the critical value the lateral buckling response is a bifurcation type and otherwise the lateral buckling response is a stable type to determine the critical value of initial half wavelength eq 20 can be rewritten as 25 π λ 4 e i y 0 f y d f d y the left side of eq 25 is not a function of y therefore it is a constant for fixed y 0 and λ setting 26 g y f y d f d y g y reaches a global maximum when dg dy 0 it gives 27 d 2 f d y 2 0 suppose that y y n satisfies eq 27 if the lateral buckling response is a bifurcation type eq 25 should have at least a solution in other words the left side of eq 25 should not greater than the global maximum of g y therefore it has 28 π λ 4 e i y 0 f y n y n d f d y y y n eq 28 can be rewritten as 29 λ π e i y 0 f y n y n f y n 4 therefore the critical value of initial half wavelength is obtained when equal sign is obtained in eq 29 for the above lateral soil resistance model and initial imperfection amplitude y 0 0 1 m fig 11 shows g y curve black solid line and π λ 4 e i y 0 curves other solid line when initial half wavelength varies from 34 m to 30 m it is clear when λ 30 m or 31 m there is no point of interaction between g y curve and π λ 4 e i y 0 curve this implies there is no solution for eq 25 therefore the lateral buckling response in buckled region in this situation is a stably type when λ 33 m or 34 m there exists point of interaction between g y curve and π λ 4 e i y 0 curve it implies that the lateral buckling response in buckled region in this situation is a bifurcation type the point of interaction is the extreme value point in which the axial force has a local maximum critical force when λ 32 0215 m there is only one point of interaction between g y curve and π λ 4 e i y 0 curve it implies that the lateral buckling response in buckled region in this situation is critical state and λ 32 0215 m is the critical initial half wavelength these values agree well with the results calculated by eq 29 by observing some examples maltby and calladine 1995b concluded that the critical half wavelength is obtained when df dy 0 and the critical half wavelength is 30 λ c π e i y 0 f y m 4 for the above case table 3 lists the critical half wavelengths calculated by this study eq 29 and calculated by maltby and calladine 1995b for different initial imperfection amplitude it is clear that the critical half wavelengths calculated by maltby and calladine 1995b are all a little bit larger than those calculated by this study the errors increase as the initial imperfection amplitude increases therefore maltby and calladine s formula can give a rough calculation for the case of small initial imperfection amplitude the present formula can provide a precise estimate 4 2 effect of soil properties and parameters the influences of soil properties and parameters on the lateral buckling of subsea pipelines are discussed in this section the soil properties and parameters considered in this paper include submerged soil weight per unit length undrained shear strength of soil breakout displacement residual displacement and vertical load the amplitude of initial imperfection and the initial half wavelength were kept constant y 0 0 1 m λ 50 m the submerged unit weight of soil γ was varied from 5000n m3 to 12000 n m3 whereas other parameters were kept constant same with those in tables 1 and 2 according to section 2 1 different lateral soil resistance models were built the lateral buckling responses under different submerged unit weights of soil are illustrated in fig 12 it is clear that the critical force of lateral buckling away from the buckled region increases with the increase of submerged unit weight of soil a larger submerged unit weight of soil corresponds to a larger critical force of lateral buckling there is no obvious change in snap through it is not difficult to understand that a larger submerged unit weight of soil means a larger resistance to overcome when lateral buckling occurs thereby the critical force of lateral buckling becomes larger to understand the influence of soil undrained shear strength on the lateral buckling response the values of soil undrained shear strength s u were varied from 5000pa to 15000 pa while other parameters were kept constant fig 13 shows the axial force away from the buckled region versus the lateral displacement amplitude curve from fig 13 it can be seen that the critical force of lateral buckling away from the buckled region decreases with the increase of soil undrained shear strength a larger soil undrained shear strength corresponds to a smaller critical force of lateral buckling the smaller the soil undrained shear strength is the more obvious the snap through is to investigate the influence of the normalized breakout displacement β on the lateral buckling response the values of normalized breakout displacement β were varied from 0 25 to 1 0 while other parameters were kept constant fig 14 shows the axial force away from the buckled region versus the lateral displacement amplitude curve from fig 14 it can be seen that the critical force of lateral buckling away from the buckled region decreases with the increase of the normalized breakout displacement β it implies that a larger breakout displacement corresponds to a smaller critical force of lateral buckling the effect of normalized residual displacement ε on the lateral buckling is shown in fig 15 when ε was varied from 2 5 to 10 0 it can be seen that the critical force of lateral buckling is almost unchanged with the increase of normalized residual displacement therefore the critical force of lateral buckling is not affected by the residual displacement the influence of vertical load v on the lateral buckling is illustrated in fig 16 when v was varied from 3500n m to 5000 n m it implies that the critical force of lateral buckling increases with the increase of vertical load the smaller the vertical load is the smaller the critical force of lateral buckling is from the above analysis it can conclude that the capacity of subsea pipeline against lateral buckling increases with the increase of the submerged soil weight per unit length and vertical load and it decreases with the increase of the soil undrained shear strength and breakout displacement 4 3 effect of lateral soil resistance models the influences of lateral soil resistance models on the lateral buckling of subsea pipelines are discussed in this section using the proposed methodology the lateral soil resistance models considered in this paper include tri line model exponential model and the proposed soil resistance model the amplitude of initial imperfection and the initial half wavelength were kept constant y 0 0 1 m λ 50 m the pipeline properties and parameters as well as soil properties and parameters were also kept constant same with those values in tables 1 and 2 therefore the only difference is the constitutive law that governs lateral soil resistance fig 17 shows the lateral buckling responses of subsea pipelines based on the aforementioned lateral soil resistance models it can be seen that the critical forces of lateral buckling corresponding to exponential model tri line model and the present model are 6 140 mn 6 538 mn and 7 145 mn respectively therefore the critical force of lateral buckling is affected by the exact soil resistance relation in fact it can be seen from eq 20 or eq 23 that the extreme value points of critical force in buckled region and away from the buckled region are related to the lateral soil resistance relation f combining the conclusion in section 4 1 it can conclude that the critical forces in buckled region and away from the buckled region both depend on the exact lateral soil resistance relation and initial imperfection parameters 5 conclusions in this paper a new lateral soil resistance model is presented it reveals a good agreement with previous experimental results wang and liu 2016 based on the new lateral soil resistance model analytical solution for the lateral buckling of subsea pipelines on nonlinear foundation is presented the analytical solution is compared with the published results and fe results it is shown that the proposed methodology is effective to obtain the critical force and capture the main feature of lateral buckling the effects of initial imperfection parameters soil properties and parameters and lateral soil resistance models on the critical force of lateral buckling are discussed using the analytical method the following conclusions are drawn i for a subsea pipeline with fixed initial imperfection amplitude and lateral soil resistance model there exists a critical value of the initial half wavelength when the initial half wavelength is higher than the critical value the lateral buckling response is a bifurcation type and otherwise the lateral buckling response is a stable type ii the critical initial half wavelength calculated by maltby and calladine s formula is a rough estimation which is a little bit overestimated exact formula to determine the critical value of initial half wavelength is proposed in this study ii the capacity of subsea pipeline against lateral buckling increases with the increase of the initial half wavelength submerged unit weight of soil and vertical load it decreases with the increase of the initial imperfection amplitude soil undrained shear strength and breakout displacement iv the critical forces of lateral buckling in and away from the buckled region both depend on the exact lateral soil resistance model and initial imperfection parameters acknowledgements this study was performed within the strategic research plan of the centre for marine technology and ocean engineering which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 the last author holds a visiting position at coppe ufrj which is supported by conselho nacional de desenvolvimento cientifico e tecnologico cnpq 
22678,lateral soil resistance plays a significant role in lateral buckling which is a main consideration in the design of subsea pipelines in this study a new lateral soil resistance model is proposed to describe the lateral resistance force displacement relation it shows a good agreement with existing test results based on the new lateral soil resistance model analytical solution for the lateral buckling of subsea pipelines with initial imperfections is presented the exact formula to determine the critical half wavelength is also presented the effects of initial imperfection parameters soil properties and parameters and lateral soil resistance models on critical force of lateral buckling are discussed results show that the capacity of subsea pipeline against lateral buckling increases with the increase of the initial half wavelength submerged unit weight of soil and vertical load it decreases with the increase of the initial imperfection amplitude soil undrained shear strength and breakout displacement the critical forces of lateral buckling in and away from the buckled region both depend on the exact lateral soil resistance model and initial imperfection parameters keywords subsea pipelines lateral buckling lateral soil resistance model critical force nomenclature d pipeline diameter v vertical load applied to pipe su soil undrained shear strength st soil sensitivity zinit initial embedment of pipeline f e limit force of f in linear elasticity stage f b breakout resistance f r residual resistance w i n initial embedment depth of the pipeline u dimensionless form of y u y d u b breakout displacement u r residual displacement u e lateral displacement corresponding to f e p axial force in buckled region p 0 axial force away from buckled region a cross section area ei flexural rigidity of pipeline section y 0 initial imperfection shape function y lateral displacement of pipeline not including initial deviation y 0 amplitude of initial imperfection y amplitude of lateral displacement α thermal expansion coefficient β coefficient for u b ε coefficient for u r δ coefficient for u e γ submerged unit weight of soil l the total length of pipeline t pipeline wall thickness l 0 the initial wavelength of imperfection λ half wavelength of the buckled pipeline f y nonlinear lateral resistance per unit length δt temperature difference δp pressure difference ν poisson s ratio 1 introduction long subsea pipelines are widely used to transport untreated hydrocarbons from well heads subsea pipelines often serve in high temperature and high internal pressure conditions which brings large challenges to the design of subsea pipelines one of the challenges is lateral buckling caused by excessive compressive axial force due to high temperature and high internal pressure lateral buckling may damage the integrity of subsea pipelines in terms of bending stresses triggering collapse or even fracture failure mode dnvgl rp f110 2018 therefore the study of the lateral buckling problem becomes very important for the design of subsea pipelines many studies have been conducted focusing on buckling mechanisms and the description of the critical state why buckling occurs palmer and baldry 1974 gave a correct answer to the controversial question on reason for lateral buckling and confirmed the conclusion by experiment it is the axial compressive force produced by internal pressure that leads to lateral buckling of pipelines hobbs 1981 1984 proposed five modes of lateral buckling and the analytical solutions for the buckling wavelength amplitude and critical force corresponding to those five modes based on the works of railroad track however the initial imperfections were not considered in his studies using a similar analytical method taylor and his colleagues proposed some analytical formulas for lateral buckling of subsea pipelines with the presence of initial imperfections taylor and gan 1984 1986a taylor and tran 1993 1996 thereafter many theoretical works on lateral buckling were based on hobbs s method hong et al 2015 proposed analytical solutions for high order lateral buckling mode of subsea pipelines with the presence of one symmetric imperfection tianfeng and xianhong 2015 proposed an analytical solution for the global buckling of a subsea pipeline that was restrained by two segmented ditching constructions wang et al 2018 studied the lateral buckling response of subsea pipelines that was triggered by one sleeper and proposed analytical solutions for this case lateral bucking triggered by distributed buoyancy sections was investigated by wang et al 2017a b and some analytical solutions were presented for the case hobbs s method has been extended and improved however there exists one limitation in the above studies that the seabed was assumed to be a frictional rigid foundation although some works with respect to lateral buckling of subsea pipelines in soft seabed were done by wang et al 2011 shi et al 2013 and shi and wang 2014 the soil resistance was still assumed to be invariable with pipeline displacement actually lateral buckling is greatly affected by lateral soil resistance and deformation dependent resistance force model as explained by tvergaard and needleman 1980 and taylor and gan 1986b this explanation has been confirmed by many investigators maltby and calladine 1995a b conducted experimental and theoretical studies with respect to the thermal buckling of subsea pipelines and found the localization phenomenon as the initial imperfection grows under steadily increasing axial compressive force their analysis results show two key points for buckling the interaction between the subsea pipeline and soil should be expressed as a nonlinear force displacement relationship and the relation between the localization and the maximum axial load is essential for lateral buckling response karampour et al 2013 confirmed maltby and calladine s work and presented a new explanation for buckling localization by two load carrying mechanisms membrane and flexure their analysis results show that the critical state of lateral buckling is related to the condition of localization and the nonlinear soil resistance plays a critical role in the localization of lateral buckling of subsea pipelines with the presence of initial imperfections therefore simple friction coefficient approximation or invariable soil resistance is inappropriate to describe the relation between the subsea pipeline and soil on seabed during lateral buckling the main reason is that the influences of initial penetration and soil berm are not taken account bruton et al 2006 white and chuck 2008 chatterjee et al 2012 concerning lateral soil resistance investigators have proposed different lateral soil resistance models to study the localized lateral buckling problem a bi linear model was proposed by lagrange and averbuch 2012 to study the uniform development of sinusoidal imperfection in a strut on a nonlinear foundation tvergaard and needleman 1980 used a piecewise linear model to study the localization of buckling patterns tri line model was proposed by white and cheuk 2008 to describe the soil resistance model in large lateral movements exponential model was proposed by maltby and calladine 1995b and was used to study the lateral buckling mechanism by karampour et al 2013 hyperbola model was proposed by trautmann et al 1985 to express the resistance force displacement relation a quintic polynomial model was proposed by zeng and duan 2014 to study the localized lateral buckling wang and liu 2016 and liu et al 2015 carried out a series of experiments on the lateral resistance of shallow pipelines a typical lateral resistance force displacement curve of their tests is shown in fig 1 which also shows the above lateral resistance models under the same conditions it can be seen clearly that the existing lateral resistance models have relatively small differences with the test results before the lateral soil resistance reaches peak value after the peak the above existing resistance models are far away from the test results that is to say the existing lateral resistance models sometimes cannot accurately describe the entire resistance force displacement relation therefore it is necessary to do further research on the non linear lateral resistance model and the effect of lateral resistance on the lateral buckling behavior in this paper a new lateral soil resistance model is proposed based on the new lateral soil resistance model analytical solution for the lateral buckling of subsea pipelines on nonlinear foundation is presented the analytical solution is compared with the published results and fe results it is shown that the proposed methodology is effective to obtain the critical force and capture the main feature of lateral buckling the exact formula to determine the critical half wavelength is also presented the effects of initial imperfection parameters soil properties and parameters and lateral soil resistance models on the critical force of lateral buckling are discussed 2 lateral soil resistance model and verification consider a pipeline of length l which is directly laid on the seabed horizontal plane x y as shown in fig 2 a the pipeline initially has a symmetrical imperfection with initial wavelength 2l 0 and imperfection shape function y 0 x because of high temperature and high internal pressure loads a compressive axial force p is produced in the pipeline which can be written as taylor and tran 1996 karampour et al 2013 zeng et al 2014 zhang and duan 2015 zhang et al 2018 1 p e a α δ t δ p a d 2 t 0 5 ν where e is the young s modulus a d t α and ν are pipeline cross section area diameter wall thickness thermal expansion coefficient and poisson s ratio respectively δ t and δ p are temperature difference and pressure difference respectively the axial force increases as the increase of temperature and pressure difference axial expansion will occur in the pipeline if the ends of the pipeline are free while the expansion is actually restricted by the axial soil resistance the axial force accumulates once the axial force exceeds a certain level critical buckling force the lateral buckling occurs as shown in fig 2 b as the pipeline feeds into the buckle the axial force in feed in region drops which makes it easier to draw more parts adjacent to the buckle into the buckle the length of the feed in region is denoted by l s it is assumed that the soil beneath the pipeline is clay in this paper during the lateral buckling process the unit lateral resistance f applied to the pipeline by soil is nonlinear and is a function that depends on lateral displacement y the axial soil resistance is denoted by f a to better study the influence of lateral soil resistance on the lateral buckling response of subsea pipelines the accurate lateral soil resistance model lateral resistance force displacement relation is essential in the following sections a new lateral soil resistance model is proposed and verified 2 1 lateral soil resistance model previous experimental and numerical studies on lateral soil resistance show that the breakout resistance f b breakout displacement y b the distance of the pipeline has moved before the breakout resistance force is reached residual resistance f r and residual displacement y r are key parameters for lateral soil resistance model bruton et al 2006 white and chuck 2008 chatterjee et al 2012 wang and liu 2016 liu et al 2015 when a subsea pipeline is laid on the seabed owing to its self weight it embeds partially in the soil on the seabed the initial embedment depth w in affects the breakout resistance it is related to the soil sensitivity s t vertical load v soil undrained shear strength s u and pipeline diameter d it can be calculated as bruton et al 2006 2 w i n d s t 15 v d s u 2 note that the lateral soil resistance depends on embedment at start up rather than initial embedment in this paper the additional consolidation settlement is neglected and the embedment at start up is assumed to be equal to the initial embedment the breakout resistance is reached when the lateral soil resistance is mobilized it is a function that depends on vertical load initial embedment depth soil undrained shear strength pipeline diameter and submerged unit weight of soil γ it can be determined by bruton et al 2006 3 f b 0 2 v 3 s u γ d w i n as breakout resistance is reached large displacement occurs in this process if the pipeline is light it will move upward and the resistance approaches a steady value if the pipeline is heavy it will move downward resulting in increasing passive berm resistance and then the resistance approaches a steady value in either case the steady value is referred to as residual resistance which is related to vertical load submerged soil weight per unit length soil undrained shear strength and pipeline diameter it can be determined by bruton et al 2006 4 f r v 1 0 65 1 exp 1 2 s u γ d the breakout displacement y b and the residual displacement y r can be determined by zeng and duan 2014 5 y b β d 6 y r ε d where β and ε represent two empirical coefficients for breakout displacement and residual displacement respectively once the breakout resistance and residual resistance are obtained it is convenient to model the complete resistance force displacement response the model proposed here results from combining the tri line model and the hyperbola model as shown by solid line in fig 3 it is expressed as follows 7 f u a u 3 b u 2 c u u 2 p u q u y d where a b c p and q are all coefficients and can be determined later the above formula can be written as 8 f u a u b a p u 2 c a q u u 2 p u q u y d it can be seen from the above formula that if omitting the second term the lateral soil resistance force displacement relation becomes linear which corresponds to the first stage of tri line model therefore the second term of the above formula controls the nonlinear part of the model the lateral soil resistance model needs to meet the following requirements so as to determine the above coefficients i when the normalized lateral displacement of the pipeline reaches β the breakout resistance is reached therefore it has 9 f u u β f b ii when the normalized lateral displacement of the pipeline reaches ε the residual resistance is reached this results in 10 f u u ε f r iii once the normalized lateral displacement of the pipeline reaches ε the lateral resistance holds constant no matter what the lateral displacement is equal to therefore the slope for the lateral resistance displacement curve is equal to zero or approximately equals zero zhang et al 2017 11 d f u d s u ε 0 iv when the lateral resistance reaches the proportional limit the lateral resistance takes 70 of the breakout resistance trautmann et al 1985 assume in this case the normalized lateral displacement takes δ therefore it meets the following condition 12 f u u δ 0 7 f b i the lateral resistance experiences the maximum value when the lateral displacement reaches breakout displacement this results in 13 d f u d s u β 0 there are five unknown coefficients in the nonlinear lateral soil resistance model eq 7 or 8 and five functions eq 9 to 13 therefore the new lateral soil resistance model can be identified 2 2 verification of the lateral soil resistance model one set of experimental test results from wang and liu 2016 are selected to validate the present lateral soil resistance model in their tests a hermetic pvc pipe segment was used and the length and outer diameter were 1 m and 0 16 m respectively the pipe segment was initially embedded in fine dry sand with depth 0 06 m their tests were carried out in dry environment which is far away to subsea environment in which subsea pipelines serve therefore empirical formulas eqs 2 4 cannot be used to calculate the key parameters f b and f r according to their test results the breakout resistance f b and resistance f r are around 315 0 n and 75 3 n respectively the normalized displacements the ratios of actual displacement to pipeline diameter corresponding to breakout and residual resistance are 0 60 and 7 98 respectively according to the above method the lateral soil resistance model can be obtained as 14 f u 315 0 01 u 3 0 0279 u 2 1 0855 u u 2 0 1389 u 0 2315 the above lateral soil resistance model is plotted in fig 4 for comparison fig 4 also shows the set of experimental test results from wang and liu et al 2016 and tri line model from fig 4 it is clear that the results of the present model have a good agreement with the results of the tri line model and the experiments in first phase lateral soil resistance ranges from zero to the proportional limit in the second phase lateral soil resistance ranges from the proportional limit to breakout resistance the results from the present model have a better agreement with the results of the experiments than the tri line model in the third and fourth phrases lateral soil resistance ranges from breakout resistance to residual resistance and ranges from residual resistance to the end the results of the present model have an excellent agreement with the results of the experimental test while the results of the tri line model are very different from the experimental tests therefore the proposed lateral soil resistance model has a good agreement with the experimental test in the entire lateral movement process 3 lateral buckling of the pipelines on nonlinear foundation 3 1 analytical model maltby and calladine 1995b presented a simplified analysis to investigate the localization phenomenon of lateral buckling herein a similar model is built to study the lateral buckling response of subsea pipelines with initial imperfections based on the new lateral soil resistance model it is assumed that the initial imperfection follows the following form 15 y 0 x y 0 cos π l 0 x where y 0 denotes the amplitude of initial imperfection take a half wave of buckled pipeline the topology and the loads imposed on the pipeline segment are shown in fig 5 under the compressive axial force p and lateral soil resistance f the governing equation of the buckled pipeline is 16 e i y y 0 p y f y 0 where f y represents the lateral soil resistance per unit length which is a function of lateral displacement y it can be determined by eq 7 or 8 for simplicity it is assumed that the distribution of f in the x direction is always cosinoidal the same assumption was made by maltby and calladine 1995b and karampour et al 2013 with this assumption a cosinoidal lateral displacement will be the solution of eq 16 as follows 17 y x y cos π λ x where y and λ denote the amplitude of the lateral displacement and half wavelength of the buckled pipeline respectively setting λ l 0 and substituting eqs 15 and 17 into eq 16 eq 16 can then be rewritten in the terms of amplitude y 18 π 4 e i λ 4 y y 0 π 2 λ 2 p y f 0 a solution for the axial force p in buckled region of the pipeline is obtained 19 p π 2 e i λ 2 1 y 0 y λ 2 π 2 f y from eq 19 it is clear that the axial force in buckled region is a function of the amplitude of lateral displacement the first term on the right side of eq 19 increases with the increase of y while the second term decreases with the increase of y therefore the lateral buckling response in buckled region can be a bifurcation type with unstable post buckling response also called snap through or be a stable type with monotonic increase with y if a bifurcation type lateral buckling occurs the critical force can be obtained in which p has a local maximum therefore the first order differential of p should be zero as follows 20 y d f d y f π λ 4 e i y 0 0 where f is function of y it is obvious that the extreme value points are related to f in other words the critical force depends on the exact lateral soil resistance relation details on that will be discussed later now see eq 20 it is an equation of degree higher than four to obtain the analytical solution is not easy numerical method can be used to solve it suppose that y m satisfies the above equation and makes the local maximum of axial force p the critical force can then be determined by p y m alternatively the critical force can also be obtained by plotting the p y curve for stable type lateral buckling the critical force can only be determined by the latter method the axial force away from the buckled region p 0 can be obtained by taking the compatibility condition into account that is the reduction of axial force in the buckle equals the product of the axial stiffness and the extension round the curve as shown 21 p 0 p e a λ λ 2 λ 2 y 2 2 y 0 2 2 substituting eqs 15 and 17 into eq 21 the axial force away from the buckled region is obtained 22 p 0 π 2 e i λ 2 1 y 0 y e a 4 π 2 λ 2 y 2 y 0 2 λ 2 π 2 f y the axial force away from the buckled region can also be seen as a function of lateral displacement amplitude similar with axial force in buckled region the lateral buckling response away from the buckled region can also be a bifurcation type or be a stable type if a bifurcation type lateral buckling occurs the critical force can be obtained in which p 0 has a local maximum therefore the first order differential of p 0 should be zero as follows 23 e a y 3 2 λ π 4 d f d y y f 2 e i y 0 0 similarly the extreme value points of p 0 are related to f and the critical force away from the buckled region also depends on the exact lateral soil resistance relation the above two methods can also be used to determine the critical force of lateral buckling away from the buckled region 3 2 comparison with the literature and finite element simulation to provide verification for the above analytical solutions 2d two dimensional finite element fe models were developed with the frame of abaqus the pipeline was modelled by timoshenko beam element pipe21 the soil and the interaction between the pipeline and soil were modelled by pipe soil interaction element psi24 the proposed lateral soil resistance model was used as the nonlinear constitutive relationship between lateral resistance and displacement the nonlinear equilibrium equations were solved by riks method for sake of comparison the same geometric and material properties used by hobbs 1984 and karampour et al 2013 are adopted as shown in table 1 according to bruton et al 2006 and white and chuck 2008 the typical value for breakout displacement is less than half of a diameter and the typical value for residual displacement is in the region of 3 5 times diameter therefore the breakout displacement and residual displacement are taken 0 5d and 5d respectively in this paper the soil sensitivity typically ranges from 2 to 5 for soft marine clays randolph and white 2008 here it is taken 4 5 the soil properties and parameters are listed in table 2 according to the above parameters and the proposed method in section 2 1 the lateral soil resistance force displacement relation is obtained 24 f u 2706 2 0 02 u 3 0 5753 u 2 1 545 u u 2 1 1095 u 0 1140 the amplitude of initial imperfection y 0 and half wavelength of the buckling λ are taken as 0 1 m and 50 m respectively according to eq 22 the compressive axial force away from the buckled region versus lateral displacement amplitude curve is plotted in fig 6 for comparison fig 6 also shows the results of hobbs 1984 corresponding to mode 3 the results of taylor and gan 1986a and the fe results it is worth to note that in hobbs s and taylor and gan s analysis the seabed was assumed to be rigid and the lateral pipe soil interaction was simplified to the coulomb friction model to compare the results of the present model and their results the residual resistance in the present lateral soil resistance model should be equal to the friction in their models therefore the lateral friction coefficient is taken as 0 57 in this way the lateral friction is same with the residual resistance i e 2171 4n m in this situation the critical forces of lateral buckling calculated by hobbs s formula and taylor and gan s formula are 3 207 mn and 4 578 mn respectively however the critical forces of lateral buckling obtained by the present analytical method and fe method are 7 119 mn and 7 191 mn respectively it is obvious that the critical force of lateral buckling calculated by the present analytical model has a good agreement with that calculated by fe method whereas it is larger by 122 0 and 55 5 than that calculated by hobbs s method and that calculated by taylor and gan s method respectively zeng and duan 2014 proposed two formulas to determine the upper and lower limits for critical force of lateral buckling on nonlinear foundation according to their formulas the upper and lower limits of the critical force under the above conditions are 7 734 mn and 5 189 mn respectively from this point the critical forces of lateral buckling predicted by the present analytical model and fe models agree well with the results of zeng and duan 2014 4 parametric analysis and discussion 4 1 effect of initial imperfections using the present methodology the influences of initial imperfections on the lateral buckling of subsea pipelines on nonlinear foundation are discussed in this section the pipeline parameters pipeline properties soil properties and soil parameters were kept constant see tables 1 and 2 first let the amplitude of the initial imperfection y 0 vary from 0 1 m to 0 5 m while keeping initial half wavelength constant the axial force in buckled region versus the lateral displacement amplitude curves are plotted in fig 7 it is clear that the critical force of lateral buckling in buckled region decreases with the increase of initial imperfection amplitude the smaller the initial imperfection amplitude is the more obvious the snap through is when the initial imperfection amplitude equals 0 5 m the snap through almost disappears in other words the lateral buckling changes from bifurcation type to stable type fig 8 shows the axial force away from the buckled region versus the lateral displacement amplitude curves from fig 8 it can be seen that the critical force of lateral buckling away from the buckled region has similar rules with that in buckled region the snap through away from the buckled region is more obvious than that in buckled region let the initial half wavelength of the imperfection vary from 30 m to 50 m while keeping the initial imperfection amplitude constant the axial force in buckled region versus the lateral displacement amplitude curves are plotted in fig 9 it is clear that the critical force of lateral buckling in buckled region increases with the increase of initial half wavelength the larger the initial half wavelength is the more obvious the snap through is when the initial half wavelength equals 30 m no bifurcation buckling occurs the lateral buckling changes from bifurcation type to stable type as the half wavelength decreases fig 10 shows the axial force away from the buckled region versus the lateral displacement amplitude curves from fig 10 it can be seen that the critical force of lateral buckling away from the buckled region has similar rules with that in buckled region comparing fig 10 with fig 9 it can be seen that the critical force of lateral buckling away from the buckled region is larger than that in buckled region and the snap through away from the buckled region is more obvious than that in buckled region from fig 9 or 10 it can be seen that there exists a critical value of the initial half wavelength when the initial half wavelength is higher than the critical value the lateral buckling response is a bifurcation type and otherwise the lateral buckling response is a stable type to determine the critical value of initial half wavelength eq 20 can be rewritten as 25 π λ 4 e i y 0 f y d f d y the left side of eq 25 is not a function of y therefore it is a constant for fixed y 0 and λ setting 26 g y f y d f d y g y reaches a global maximum when dg dy 0 it gives 27 d 2 f d y 2 0 suppose that y y n satisfies eq 27 if the lateral buckling response is a bifurcation type eq 25 should have at least a solution in other words the left side of eq 25 should not greater than the global maximum of g y therefore it has 28 π λ 4 e i y 0 f y n y n d f d y y y n eq 28 can be rewritten as 29 λ π e i y 0 f y n y n f y n 4 therefore the critical value of initial half wavelength is obtained when equal sign is obtained in eq 29 for the above lateral soil resistance model and initial imperfection amplitude y 0 0 1 m fig 11 shows g y curve black solid line and π λ 4 e i y 0 curves other solid line when initial half wavelength varies from 34 m to 30 m it is clear when λ 30 m or 31 m there is no point of interaction between g y curve and π λ 4 e i y 0 curve this implies there is no solution for eq 25 therefore the lateral buckling response in buckled region in this situation is a stably type when λ 33 m or 34 m there exists point of interaction between g y curve and π λ 4 e i y 0 curve it implies that the lateral buckling response in buckled region in this situation is a bifurcation type the point of interaction is the extreme value point in which the axial force has a local maximum critical force when λ 32 0215 m there is only one point of interaction between g y curve and π λ 4 e i y 0 curve it implies that the lateral buckling response in buckled region in this situation is critical state and λ 32 0215 m is the critical initial half wavelength these values agree well with the results calculated by eq 29 by observing some examples maltby and calladine 1995b concluded that the critical half wavelength is obtained when df dy 0 and the critical half wavelength is 30 λ c π e i y 0 f y m 4 for the above case table 3 lists the critical half wavelengths calculated by this study eq 29 and calculated by maltby and calladine 1995b for different initial imperfection amplitude it is clear that the critical half wavelengths calculated by maltby and calladine 1995b are all a little bit larger than those calculated by this study the errors increase as the initial imperfection amplitude increases therefore maltby and calladine s formula can give a rough calculation for the case of small initial imperfection amplitude the present formula can provide a precise estimate 4 2 effect of soil properties and parameters the influences of soil properties and parameters on the lateral buckling of subsea pipelines are discussed in this section the soil properties and parameters considered in this paper include submerged soil weight per unit length undrained shear strength of soil breakout displacement residual displacement and vertical load the amplitude of initial imperfection and the initial half wavelength were kept constant y 0 0 1 m λ 50 m the submerged unit weight of soil γ was varied from 5000n m3 to 12000 n m3 whereas other parameters were kept constant same with those in tables 1 and 2 according to section 2 1 different lateral soil resistance models were built the lateral buckling responses under different submerged unit weights of soil are illustrated in fig 12 it is clear that the critical force of lateral buckling away from the buckled region increases with the increase of submerged unit weight of soil a larger submerged unit weight of soil corresponds to a larger critical force of lateral buckling there is no obvious change in snap through it is not difficult to understand that a larger submerged unit weight of soil means a larger resistance to overcome when lateral buckling occurs thereby the critical force of lateral buckling becomes larger to understand the influence of soil undrained shear strength on the lateral buckling response the values of soil undrained shear strength s u were varied from 5000pa to 15000 pa while other parameters were kept constant fig 13 shows the axial force away from the buckled region versus the lateral displacement amplitude curve from fig 13 it can be seen that the critical force of lateral buckling away from the buckled region decreases with the increase of soil undrained shear strength a larger soil undrained shear strength corresponds to a smaller critical force of lateral buckling the smaller the soil undrained shear strength is the more obvious the snap through is to investigate the influence of the normalized breakout displacement β on the lateral buckling response the values of normalized breakout displacement β were varied from 0 25 to 1 0 while other parameters were kept constant fig 14 shows the axial force away from the buckled region versus the lateral displacement amplitude curve from fig 14 it can be seen that the critical force of lateral buckling away from the buckled region decreases with the increase of the normalized breakout displacement β it implies that a larger breakout displacement corresponds to a smaller critical force of lateral buckling the effect of normalized residual displacement ε on the lateral buckling is shown in fig 15 when ε was varied from 2 5 to 10 0 it can be seen that the critical force of lateral buckling is almost unchanged with the increase of normalized residual displacement therefore the critical force of lateral buckling is not affected by the residual displacement the influence of vertical load v on the lateral buckling is illustrated in fig 16 when v was varied from 3500n m to 5000 n m it implies that the critical force of lateral buckling increases with the increase of vertical load the smaller the vertical load is the smaller the critical force of lateral buckling is from the above analysis it can conclude that the capacity of subsea pipeline against lateral buckling increases with the increase of the submerged soil weight per unit length and vertical load and it decreases with the increase of the soil undrained shear strength and breakout displacement 4 3 effect of lateral soil resistance models the influences of lateral soil resistance models on the lateral buckling of subsea pipelines are discussed in this section using the proposed methodology the lateral soil resistance models considered in this paper include tri line model exponential model and the proposed soil resistance model the amplitude of initial imperfection and the initial half wavelength were kept constant y 0 0 1 m λ 50 m the pipeline properties and parameters as well as soil properties and parameters were also kept constant same with those values in tables 1 and 2 therefore the only difference is the constitutive law that governs lateral soil resistance fig 17 shows the lateral buckling responses of subsea pipelines based on the aforementioned lateral soil resistance models it can be seen that the critical forces of lateral buckling corresponding to exponential model tri line model and the present model are 6 140 mn 6 538 mn and 7 145 mn respectively therefore the critical force of lateral buckling is affected by the exact soil resistance relation in fact it can be seen from eq 20 or eq 23 that the extreme value points of critical force in buckled region and away from the buckled region are related to the lateral soil resistance relation f combining the conclusion in section 4 1 it can conclude that the critical forces in buckled region and away from the buckled region both depend on the exact lateral soil resistance relation and initial imperfection parameters 5 conclusions in this paper a new lateral soil resistance model is presented it reveals a good agreement with previous experimental results wang and liu 2016 based on the new lateral soil resistance model analytical solution for the lateral buckling of subsea pipelines on nonlinear foundation is presented the analytical solution is compared with the published results and fe results it is shown that the proposed methodology is effective to obtain the critical force and capture the main feature of lateral buckling the effects of initial imperfection parameters soil properties and parameters and lateral soil resistance models on the critical force of lateral buckling are discussed using the analytical method the following conclusions are drawn i for a subsea pipeline with fixed initial imperfection amplitude and lateral soil resistance model there exists a critical value of the initial half wavelength when the initial half wavelength is higher than the critical value the lateral buckling response is a bifurcation type and otherwise the lateral buckling response is a stable type ii the critical initial half wavelength calculated by maltby and calladine s formula is a rough estimation which is a little bit overestimated exact formula to determine the critical value of initial half wavelength is proposed in this study ii the capacity of subsea pipeline against lateral buckling increases with the increase of the initial half wavelength submerged unit weight of soil and vertical load it decreases with the increase of the initial imperfection amplitude soil undrained shear strength and breakout displacement iv the critical forces of lateral buckling in and away from the buckled region both depend on the exact lateral soil resistance model and initial imperfection parameters acknowledgements this study was performed within the strategic research plan of the centre for marine technology and ocean engineering which is financed by portuguese foundation for science and technology fundação para a ciência e tecnologia fct under contract uid multi 00134 2013 lisboa 01 0145 feder 007629 the last author holds a visiting position at coppe ufrj which is supported by conselho nacional de desenvolvimento cientifico e tecnologico cnpq 
22679,the model order reduction mor is a useful tool for accelerating calculations connected to parametric studies or optimizations of complex systems in this paper we provide a mor method directly applicable to industrial scale problems we consider a posteriori mor based on the proper orthogonal decomposition pod with galerkin projection the problems arising from the nonlinearities in the original model are addressed within the framework of the discrete empirical interpolation method deim the reduced order model rom construction is newly implemented as a part of the open source openfoam cfd library the new implementation is validated on a number of small scale tests and applied to a real life problem of acceleration of a parametric study of flow in a complex geometry of an absorption column based on our tests the application of reduced order model as a predictor for standard simple solution can speed up the solution approximately two fold furthermore higher speed ups may be achieved if the full order model may be completely replaced by rom msc 00 01 99 00 keywords pod deim cfd openfoam 1 introduction current progress in numerical methods and available computational power combined with industrial needs promote development of more and more complex cfd simulations such simulations are expensive from the point of view of the data storage and the time necessary for their evaluation nevertheless industrial practice often calls for parametric studies and optimizations performed using these models fortunately as noted for example by cross and hohenberg 1993 numerous non linear dynamical systems exhibit a low dimensional phenomena in the sense of the term as described in katok and hasselblatt 1997 more precisely if one constructs a matrix from the measured data in our case represented by the numerical solution to the considered models most of the variance and energy is contained in a few modes computed from a singular value decomposition svd of the constructed matrix dimitriu et al 2017 therefore it is possible to apply svd based model order reduction mor techniques to reduce the computational cost and storage requirements of the developed cfd models the most widely used svd based mor technique is the proper orthogonal decomposition pod with galerkin projection volkwein 2013 kahlbacher and volkwein 2007 for a given set of theoretical experimental or computational data the method provides an orthonormal basis the obtained basis is optimally ordered in the least squares sense and the reduced order models rom are constructed by truncating this basis pinnau 2008 the original idea behind pod is known for more than a century and dates back to pearson 1901 furthermore the proper orthogonal decomposition has been independently rediscovered several times from different points of view consequently pod is also known as principal component analysis pca hoetelling 1935 jolliffe 2014 karhunen loeve decomposition karhunen 1946b a total least squares estimation tlse van huffel and lemmerling 2013 schaffrin 2006 leyang 2012 and empirical orthogonal functions eofs lorenz 0000 the pod galerkin approach has been used to construct reduced order models of systems in numerous applications in the present work we focus on simulations of different flows hence we would like to bring to the reader s attention the applications of pod in simulations of compressible flow provided by rowley et al 2004 in an experimental analysis of the flow field in a plane jet performed by shim et al 2013 and in the work of lozovskiy et al 2016 on a use of pod based mor for modeling of shallow water flows in addition many other examples of applications of pod galerkin based mor are mentioned in peng and mohseni 2016 or in chaturantabut and sorensen 2010 the applicability of the pod galerkin approach in its classical formulation is usually limited to problems with linear or bilinear terms chaturantabut and sorensen 2010 nguyen and peraire 2008 however the cfd models relevant to the industry are commonly non linear several approaches have been proposed to address the complexity of evaluating the non linear terms for the pod reduced models in the context of finite element fe finite difference fd and finite volume fv discretizations see e g nguyen and peraire 2008 astrid 2004 willcox 2006 chaturantabut and sorensen 2010 barrault et al 2004 in this work the non linearities present in the original models are treated within the framework of the discrete empirical interpolation method deim of chaturantabut and sorensen 2010 which is a discrete variant of the empirical interpolation method eim of barrault et al 2004 in this paper we develop and validate a link between the pod deim based mor and openfoam a finite volume method fvm based open source library for solution of problems of computational continuum mechanics opencfd 2016 the newly developed reduced order model rom creation technique represents an a posteriori approach to mor cosimo et al 2016 hence the solution of the full order model fom has to be available for the rom creation moreover not only the solution of the system is necessary for the pod deim based model order reduction the method also needs an access to several other data structures which are usually internal to the cfd solver this need to easily access the internal cfd solver variables often results in the use of in house cfd solvers to calculate the fom results however in order to enable a direct order reduction for large scale systems originating in the industrial practice a link between pod deim based mor and a robust enough cfd solver is needed because openfoam is open source it provides an easy access to the needed data structures moreover openfoam has been successfully used to solve industrial scale problems in various fields of cfd thus the newly implemented pod deim based model order reduction can be directly applied to a large variety of real life engineering problems our approach to the model order reduction shares some common traits with the recently published work of stabile and rozza 2018 however we directly construct a reduced order model only for the pressure and use an explicit reconstruction scheme for the velocity field consequently the resulting rom is slightly less accurate than the one obtained by stabile and rozza 2018 but it is inherently stable the paper is structured as follows first we present fundamentals of the proper orthogonal decomposition and discrete empirical interpolation next we propose a method for rom construction for systems arising from simple patankar and spalding 1972 solution of incompressible navier stokes equations the method is validated on a number of small scale examples after the method validation we combine it with a newly developed simple heuristic for optimal selection of snapshots of the full order model solution the paper is concluded by an example of an industrial scale application of the proposed method for optimization of operating conditions of an absorption column 2 fundamentals of proper orthogonal decomposition and discrete empirical interpolation the proper orthogonal decomposition is a projection based method for reducing the dimensions of general large scale ode systems regardless of their origin pinnau 2008 however we focus our attention to the systems obtained from the semi discretization of time dependent or parameter dependent partial differential equations we are particularly interested in model order reduction of large scale ode systems generated by a finite volume fv discretization of incompressible navier stokes equations as a suitable tool for the full order model evaluation and for the preparation of inputs for the reduced order model creation we use the software package openfoam which is based on the finite volume method and used for solution of tasks of the computational fluid dynamics 2 1 problem formulation a scalar non linear pde for an unknown function y r ω r ω r 3 may be rewritten as 1 y l t y 0 where the operator l r ω r represents all terms of the original pde apart from the temporal derivative after the fv semi discretization of eq 1 we obtain the system 2 δ ω h y l h t y 0 let m be the number of cells in the fv discretization mesh ω h then y r r m in 2 is the finite volume spatial semi discretization of the function y l h r ω h r m is the spatial discretization operator corresponding to the operator l and δ ω h diag δ ω 1 h δ ω m h r m m is a diagonal matrix the symbol δ ω i h i 1 m represents the volume of the i th fv volume cell of ω h in openfoam the operator l h has the structure 3 l h t y a t y b t y where implicitly discretized terms are concentrated in a t y and explicitly discretized non linearities and corrections e g for the mesh non orthogonality are used for the construction of the vector b t y the size of the matrix a and of the vector b is determined by the number of cells in ω h because the matrix δ ω h is diagonal its inversion is cheap and one can rewrite eq 2 as a large system of odes 4 y a t y b t y t 0 t y 0 y 0 a t δ ω h 1 a t b t y δ ω h 1 b t y where y 0 r m is a selected initial condition let us assume that a 0 t r m m is a continuous matrix valued mapping and b 0 t r m r m is continuous in both arguments and locally lipschitz continuous with respect to the second argument then 4 has a unique classical solution y c 1 0 t r m c 0 t r m for some maximal time t 0 t volkwein 2013 from now on we assume t t and consequently y c 1 0 t r m the goal of the following sections is to describe y as well as possible by the means of the solution of a yet unspecified replacement problem 5 η ℓ a ℓ t η ℓ f ℓ t η ℓ t 0 t η ℓ 0 η 0 ℓ where a ℓ t r ℓ ℓ and f ℓ t η ℓ r ℓ and ℓ m 2 2 proper orthogonal decomposition let v span ψ j j 1 d be the space containing the solution of the system 4 and ψ j j 1 d its orthonormal basis then it is possible to rewrite the solution of 4 as 6 y t j 1 d η j ψ j t 0 t η j t y t ψ j d dim v m where by we denote an inner product the fourier coefficients η j j 1 d are functions that map 0 t into r the terms of the sum in 6 can be arranged in descending order by the amount of information on the original system they carry by taking into account only the first ℓ d terms of 6 the following ansatz is introduced 7 y ℓ t j 1 ℓ η j ℓ ψ j t 0 t η j ℓ t y ℓ t ψ j ℓ d the ansatz 7 is an approximation of y t provided ℓ d inserting 7 into 4 and assuming that the equality holds after the projection of v on the ℓ dimensional subspace v ℓ span ψ j j 1 ℓ we obtain the reduced order system in form 5 with a new set of unknown functions 8 η ℓ η i ℓ t 0 t r m i 1 ℓ the reduced system matrix 9 a ℓ a i j ℓ r ℓ ℓ a i j ℓ a ψ j ψ i the rom non linearities 10 f ℓ f i ℓ t 0 t r ℓ f i ℓ t η b t j 1 ℓ η j ψ j ψ i and the initial condition 11 η ℓ 0 η 0 ℓ y 0 ψ 1 y 0 ψ l t the dimension of the newly defined system is ℓ d m the quality of the approximation is largely dependent on the choice of basis ψ j j 1 ℓ the proper orthogonal decomposition is a method for finding the in the least squares sense optimal basis ψ j j 1 ℓ the idea of pod is to describe the trajectory v given by 12 v span y t t 0 t v by a few orthonormal functions ψ j j 1 ℓ v ℓ while preserving as much of the information contained in the original system as possible in our case the data is generated by sampling the numerical solution of the full order model 4 at given times 13 s y j k y k t j j 1 n t j 0 t in other words we sample the trajectory v at the time points 0 t 1 t n t these samples are called snapshots because the continuous solution to problem 4 is not available we will restrict our attention to the discrete variant of pod the analogy to the trajectory 12 in the discrete setting is given by 14 v k span y 0 k y 1 k y n k v k with d k dim v k min m n 1 we introduced the superscript k to distinguish between the time continuous solution of 4 y and its discrete approximation y k however in the following text we will work solely with y k and the superscript k will be omitted the discrete variant of the pod basis ψ j j 1 ℓ is generated as described in algorithm 1 remark 1 determination of pod rank ℓ let y r m n n m be the matrix of snapshots also let ψ σ w t be the singular value decomposition of the matrix y we denote y k j 1 k σ j ψ j w j t the approximation of the matrix y generated from ψ σ and w t by taking into account only the first k columns of the matrices ψ and w t and the first k singular values we define the error with respect to the frobenius norm of the approximation of y by y k as 15 δ k 1 y k f y f 1 j 1 k σ j 2 j 1 n σ j 2 we mark ε f the desired accuracy with respect to the frobenius norm of the approximation of y by y k the pod rank ℓ is determined as 16 min k 1 n k such that δ k ε f remark 2 in applications it is usually profitable to use a weighted inner product see e g volkwein 2013 because we work with systems of odes originating in fv spatial discretization of partial differential equations it is profitable to use l 2 weighted inner product for a second order accurate discrete variant of the l 2 weighted inner product the weights directly correspond to δ ω i h i 1 m i e to the volumes of finite volume cells used in the solved problem spatial discretization 2 3 application of pod to openfoam originating systems the proper orthogonal decomposition was originally developed for linear systems of ordinary differential equations of structure 17 y a y b t y t 0 t y 0 y 0 i e for systems with time independent matrix a however in openfoam non linear pdes are linearized prior to the construction of system 4 consequently the system matrix a is time dependent the time dependence of the matrix a would enforce a recalculation of the matrix a ℓ for each rom evaluation which would in turn make the usage of rom uneconomical a way to resolve the time dependence of the matrix a is to sample the system matrices the same way as the full system solution and to interpolate between the full system matrix snapshots if one uses the linear interpolation it is possible to write the approximate system matrix as 18 a ˆ t 1 ϖ t a i 1 ϖ t a i ϖ t t t i 1 t i t i 1 i 1 n substituting the approximation 18 of the matrix a into a ℓ matrix definition 9 one may define an approximate time dependent matrix of the reduced system as 19 a ˆ ℓ t ψ t w a ˆ t ψ 1 ϖ t ψ t w a i 1 ψ ϖ t ψ t w a i ψ 1 ϖ t a i 1 ℓ ϖ t a i ℓ and the reduced order model once it is created stays fully independent on the full system dimension on the other hand it is necessary to either expand the snapshots 20 s y j j 1 n s y j a j a t j j 1 n or to recompute the needed system matrices from the saved values of y during the rom creation 2 4 discrete empirical interpolation method the reduced order model 5 introduced above is non linear however up to now we have not paid any attention to the treatment of non linearity present in the model a number of ways have been proposed to overcome the complexity of the evaluation of the reduced order non linearities e g astrid 2004 barrault et al 2004 hesthaven et al 2016 maday and mula 2013 the method used in this work is the discrete empirical interpolation method deim by chaturantabut and sorensen 2010 in order to mitigate the complexity of the non linearity evaluation the non linearity f ℓ in 5 is approximated by a projection into a subspace generated by the non linear function and spanned by a basis of dimension p m chaturantabut and sorensen 2010 volkwein 2013 the discrete version of the reduced order non linearity 10 is 21 f ℓ t ψ t b t ψ η ℓ t f ℓ t r ℓ t 0 t let n span ϕ j j 1 o be the space containing the non linearity b from 4 where o m is the dimension of the space n let s n b j b t j y j j 1 n denote the set of snapshots of system non linearities constructed the same way as the solution snapshots 13 let us define 22 f t b t ψ η ℓ t f t r m t 0 t we approximate f t by a galerkin ansatz the same way we approximated y t in 6 and 7 23 f t j 1 p c j t ϕ j φ c t φ r m p c t r p t 0 t where p is the dimension of the subspace n p n on which we projected the system non linearity the matrix φ is a discrete pod basis of the non linearity snapshots obtained via algorithm 1 if p m which is one of our requirements on the reduced order model the equality f t φ c t generates an overdetermined system to uniquely specify the vector c t it is sufficient to choose any p rows of φ and f t in deim the rows of φ and f t used to compute the vector c t are selected inductively based on a greedy algorithm the deim is summarized in algorithm 2 for further details on the method the reader is referred to relevant literature e g chaturantabut and sorensen 2010 the outputs of algorithm 2 are used to reduce the computational complexity of evaluation of 21 the indexing vector i is used to construct a matrix p e i 1 e i p where e i j 0 1 0 t is a vector with 1 in row i j and zeros elsewhere if det p t φ 0 the vector c t can be specified as 24 c t p t φ 1 f t we substitute from 24 into 21 and obtain 25 f ℓ t ψ t b t ψ η ℓ t ψ t φ c t ψ t φ p t φ 1 p t b t ψ η ℓ t furthermore if the matrix p can be moved into the argument of the non linearity the final relation is 26 ψ t φ p t φ 1 p t b t ψ η ℓ t ψ t φ p t φ 1 b t p t ψ η ℓ t the matrices ψ t φ r ℓ p p t φ 1 r p p and p t ψ r p ℓ can be precomputed volkwein 2013 all the precomputed quantities are independent of the full dimension m besides if the relation 26 is used the non linearity of the system should only be evaluated in p interpolation points or in the case of a system of odes generated by fv discretization of pde in p selected cells consequently the resulting rom is completely independent of the full system dimension 2 5 pod deim based model order reduction for parameter dependent steady non linear pdes we mark μ d r d d n a set of parameters describing the system for simplicity we assume μ d r i e d 1 the finite volume spatial semi discretization of a parameter dependent steady non linear pdes performed in openfoam generates a system similar to 4 in particular 27 0 a μ y b μ y μ d a μ δ ω h 1 a μ b μ y δ ω h 1 b μ y the construction of rom corresponding to 27 is analogous to the construction of rom for 4 the resulting rom is 28 0 a ˆ ℓ μ η ℓ μ f ˆ ℓ μ η ℓ the matrix a ˆ ℓ μ in 28 is obtained from 19 where we replaced t by μ the vector f ˆ ℓ μ η ℓ is calculated similarly from 25 the generalization of 28 for d 1 is not quite straightforward first the set of snapshots s s n needs to be robust enough to properly describe the dynamics of the studied full order system consequently the number of elements of both pod bases for the solution and for the system non linearity can significantly increase second if d 1 the parameter dependent reduced system matrix a ˆ is obtained from the pre computed reduced system matrices by linear interpolation see 19 for d 2 bi linear interpolation is required to calculate a ˆ for d 3 a tri linear interpolation might be used however the implementation of both the bi and tri linear interpolation is not trivial 3 mor of incompressible navier stokes equations 3 1 the case of parameter dependent steady state to describe our approach to the model order reduction of incompressible navier stokes equations we begin with a steady variant of the equations 29 u u ν u p f u 0 defined on a simply connected bounded domain ω r 3 and supplemented with appropriate boundary data we study the dependence of the solution u p to the system 29 on some parameter μ d r i e u d ω r 3 p d ω r the cfd solver used to compute the full solution of 29 is the simplefoam from the openfoam library opencfd 2016 patankar and spalding 1972 jasak 1996 the system 29 may be rewritten as 30 m x t 0 u p f 0 m x u ν u u u the continuity equation u 0 is pressure free thus the linearization and discretization of 30 leads to a saddle point problem which cannot be directly solved by the methods of numerical linear algebra benzi et al 2005 elman and golub 1994 for simplicity we assume that the discretization of 30 results in a system of linear algebraic equations 31 a m x n t n 0 u h p h f h 0 m x r 3 m 3 m n r m 3 m u h f h r 3 m p h r m such a situation corresponds to the discretization of the navier stokes equations on an orthogonal finite volume mesh ω h with m cells isoz 2018 however the principles of the rom construction remain the same also for more complex problems and non orthogonal meshes note that the operator m x has to be linearized before the construction of the matrix m x consequently the matrix m x depends on the current velocity field in the simple algorithm patankar and spalding 1972 which is the base of the simplefoam solver the velocity u h is expressed directly from the first row of 31 as 32 u h m x 1 f h n t p h and plugged into the second row of 31 to obtain a system of linear algebraic equations 33 n m x 1 n t p h n m x 1 f h where the only unknown is the pressure and which is solvable by standard methods of numerical linear algebra however the inverse m x 1 of the matrix m x is not usually available the issue of the calculation of the inverse m x 1 is mitigated by splitting the matrix m x as m x d l u where d l and u are diagonal lower triangular and upper triangular matrices respectively the inverse m x 1 is approximated as m x 1 d 1 and the following iterations are constructed 34 n d 1 n t p h n n d 1 h u h o u h n d 1 h u h o n t p h h u h o f h u l u h o where we denote the current iteration by the superscript o and the next iteration by the superscript n the reduced order model generated from the solution to 29 computed by the simplefoam solver must take into account the solution procedure the natural variable for solution techniques for the incompressible navier stokes equations based on the solution of the system 33 is the pressure thus it would seem reasonable to base the reduced order model directly on the relations 34 we propose to rewrite the system 27 as 35 0 a μ p h b μ p h a μ n d 1 n t b μ p h n d 1 h u h where u h is the solution for the velocity obtained from the simple iterations the reduced order model 35 needs to be supplemented by a way to calculate the velocity field in the proposed approach there is no evolution equation available for the velocity if the velocity is needed it is reconstructed after the reduced order model is evaluated and projected back into the original space v the explicit relation for velocity in 34 is 36 u h d 1 h u h n t p h the term n t p h in 36 can be easily calculated because the matrix n t r 3 m m is the discretization of the gradient operator and the pressure is obtained by the projection of the reduced variable η p ℓ into the original space however the matrix d 1 r 3 m 3 m and vector h u h r 3 m are not readily available similarly to the treatment of parameter or time dependent system matrix a t it is possible to either expand the solution snapshots to contain all the data needed for rom construction i e the solution for pressure p j h the system non linearities b j the snapshots of system matrices a j and the vectors d j inv diag d j 1 r m and h u j h j 1 n or to store only the snapshots of pressure and velocity fields and to re discretize the problem during the rom preparation this way all the above listed remaining variables can be computed when needed for a subsequent model evaluation it is sufficient to store the matrices a j ℓ r ℓ ℓ j 1 n and vectors f j r ℓ j 1 n however for the reconstruction of velocity field based on the projection of η p ℓ into v it would be necessary to store potentially large vectors d j inv and h u j h and to interpolate between them in order to mitigate this need of a large storage we propose to project these two vectors into small dimensional subspaces as 37 d j inv ℓ d ψ d inv t d j inv j 1 n and h j ℓ h ψ h t h u j h j 1 n where ψ d inv r m ℓ d and ψ h r 3 m ℓ h are pod bases for d j inv and h u j h j 1 n respectively the vectors d j inv ℓ d r ℓ d h j ℓ h r ℓ h j 1 n must be saved for the velocity field reconstruction from the rom results still the whole model remains independent of the fom dimension to reconstruct the velocity field from the rom results for some parameter μ d we first evaluate the reduced order model 35 next we apply similarly to 18 linear interpolation for approximation of vectors d inv ℓ d μ and h ℓ h μ 38 d inv ℓ d μ d ˆ inv ℓ d μ ϖ μ d i 1 inv ℓ d 1 ϖ μ d i inv ℓ d h ℓ h μ h ˆ ℓ h μ ϖ μ h i 1 ℓ h 1 ϖ μ h i ℓ h ϖ μ μ μ i 1 μ i μ i 1 i 1 n finally we project the variables η p ℓ μ d ˆ inv ℓ d μ and h ˆ ℓ h μ back into the original spaces 39 p rom μ ψ η p ℓ μ d rom inv μ ψ d inv d ˆ inv ℓ d μ h rom μ ψ h h ˆ ℓ h μ and reconstruct the velocity field directly from 36 note that in 39 we marked the rom based approximations by the subscript rom furthermore in the following we denote the reconstructed velocity field as u rec the procedure for construction and evaluation of rom for parameter dependent steady state navier stokes equations is summarized in algorithms 3 and 4 remark 3 let us denote the values of μ at which we saved the snapshots s n s as μ 1 μ 2 μ n because of the linear interpolation used to evaluate a ˆ ℓ μ and f ˆ ℓ μ on line 2 and d ˆ inv ℓ d μ and h ˆ ℓ h μ on line 4 of algorithm 4 the generated reduced order model can be used only for μ μ 1 μ n 3 2 the case of transient incompressible navier stokes equations our approach to the derivation and evaluation of rom for transient incompressible navier stokes equations 40 u t u u ν u p f u 0 defined on a solution domain q 0 t ω ω r 3 is almost analogous to the creation of rom for parameter dependent steady state navier stokes equations which is described in the previous part of the text the numerical solution of the system 40 in openfoam is based on the pimple algorithm opencfd 2016 the pressure velocity coupling in the pimple algorithm is similarly to the simple algorithm based on the iterative solution of the equation for pressure analogously to m x operator see 30 we define the operator 41 m m t m x m t u t u m x u ν u u u the full order model is 42 p h a t p h b t p h t 0 t p h 0 p 0 h a t n d 1 n t b t p h n d 1 h u h where we used the matrices n and d and the vector h u h as defined in the previous section in other words to compute the explicit time derivative of pressure necessary for the rom construction we split the operator m as shown in 41 and use only its spatial part m x to compute a t and b t p h in 42 at the moment we do not have a proof that this approach yields an exact pressure time derivative in 42 hence we define p h in the first row of 42 only approximately we use pod and deim to construct a reduced order model for 42 in the form 43 η p ℓ a ˆ p ℓ t η p ℓ f ˆ p ℓ t η p ℓ t 0 t η p ℓ 0 η p 0 ℓ the required snapshots are the same as for the case of the parameter dependent navier stokes equations the algorithm of rom construction for transient incompressible navier stokes equations is identical to algorithm 3 the only additional step during the creation of rom for the transient case is the projection of the initial condition p 0 h into v ℓ to obtain the rom initial condition η p 0 ℓ ψ t p 0 h the integration of rom 43 is similar to the evaluation of rom for parameter dependent steady state navier stokes equations for illustration we present the rom integration by a θ method with fixed time step in algorithm 5 nevertheless any other suitable integration method may be used 4 approach validation and numerical examples in order to validate the proposed method we performed a series of numerical tests we started with a test of the link between pod deim based mor and openfoam on a system that can be readily expressed in the form 1 then we proceeded to the validation of the presented approach to the rom construction for the incompressible navier stokes equations finally we tested mor of a system generated by the volume of fluid vof method hirt and nichols 1981 based model for multiphase flow 4 1 passive scalar advection as a problem that can be expressed directly in the form 1 we selected the advection of passive scalar α that comes from vof simulations of multiphase flows hirt and nichols 1981 after the spatial discretization one obtains the system in the form 2 44 α δ ω h 1 l α h a α t α b α t α t 0 t α 0 α 0 for which it is possible to construct the reduced order model directly by the previously presented methods in 44 we use a shortened notation for example the matrix a α does not explicitly depend on time but it is a function of the time dependent velocity field however at the moment the velocity is not considered a system unknown because we are interested only in the advection of the variable α in fig 1 we show a qualitative comparison between the results of an openfoam cfd simulation full order model fom and the reduced order model rom for the case of a gravity driven multiphase flow down a plate inclined by the angle φ 60 to the horizontal the dimensions of the computational domain are 6 5 0 7 cm the liquid flow rate was selected such that the simulated flow reaches a state quasi periodic in time for further details on the simulation settings see isoz 2019 the cfd simulation was performed on approximately 1 million cells the reduced order model consisted of 46 ordinary differential equations on an examination of fig 1 it can be seen that the rom describes well the general features of the flow however it tends to smooth the gas liquid interface nonetheless there is a rather good qualitative agreement between the rom and cfd simulation to further evaluate on the agreement between the cfd simulation fom and rom we calculated the absolute difference of the fields α f o m and α r o m because the tracked phase volume fractions are from 0 1 the calculated absolute difference coincides with the relative difference 45 α f o m α r o m ε α r α f o m α r o m max α min α for α 0 1 in fig 2 we show only the parts of the computational domain in which ε α r 0 1 for the most of the domain the difference is substantially lower it is visible that the biggest differences between the fields were encountered at the parts of the computational domain with a complex gas liquid interface evolution or in other words with large gradients of α function to get a notion of the difference of the solutions in the whole computational domain let us define the spatial average of ε α r as 46 ε α r i 1 m ε α i r m where m is the number of cells in the computational mesh the value ε α r for the case depicted in figs 1 and 2 is ε α r 0 0088 in fig 3 we show the evolution of ε α r with simulation time for the studied case the applied initial condition corresponds to a dry plate hence the simulation is highly dynamic at the beginning and we would need to use a large number of snapshots to account for this effect however at t 0 3 s the flow becomes quasi periodic and the agreement between fom and rom is significantly improved furthermore comparing figs 2 and 3 it is possible to determine that although the local difference between fom and rom might go up to 30 the difference between the α fields on the whole mesh lies well below 5 thus we conclude that the implementation of the link between pod deim based mor and openfoam was successful and the approach is usable for creation of roms based on equations expressible in the form 1 4 2 incompressible navier stokes equations after the validation of the link between the mor and openfoam we tested the proposed approach to the rom construction for pressure linked incompressible navier stokes equations as the first test case we selected the creation of the reduced order model for the transient laminar flow in the vicinity of a cylindrical obstacle such a flow develops an instability that leads to the formation of the famous von kármán vortex street von karman 1963 a qualitative comparison of the results of the full model fvm simulation of the full navier stokes equations on approximately 18000 cells and the constructed rom system of 7 odes is depicted in fig 4 in agreement with relation 45 we define a mesh averaged relative difference of the fields y f o m and y r o m as 47 ε y r i 1 m ε y i r m ε y i y f o m y r o m max i j y min i j y i 1 2 m j 1 2 n where n is the number of available snapshots of the full solution m is the original model dimension and by max i j y and min i j y we denote the maximum and minimum value of the corresponding matrix of snapshots y y 1 f o m y n f o m in fig 5 we depict the time dependence of ε p r and ε u r it can be seen that the difference between the full order model and the reduced order model for pressure which is our primary variable oscillates around 0 2 for the whole simulation the magnitude of the difference between the velocities is slightly larger around 0 6 however this is to be expected because the velocity field u rec is obtained from p rom via the relation 36 in which the matrix d 1 and the vector h u h are approximated the necessity of approximating these two variables in the relation 36 is imposed by the applied method for the finite volume solution of the incompressible navier stokes equations in the following tests we aim on examining the proposed approach to the model order reduction in the cases which leverage the capabilities of the openfoam library mind that the selected approach to the model order reduction is purely data driven and that the reduced order model is constructed after the evaluation of the full order model consequently all the capabilities of the openfoam library are available for the full order model evaluation to illustrate the situation we selected two different approaches to modeling of mixed vessels we generated a simple two dimensional geometry corresponding to a mixed vessel with baffles the simulated stirred tank has the radius of 10 cm the mixer itself has the radius of 6 5 cm and the baffles are 2 cm long the geometry is illustrated in fig 6 in the first approach the flow in the mixed vessel was kept in the laminar regime and modeled via the so called arbitrary mesh interfaces ami in the simulations containing arbitrary mesh interfaces a part of the mesh is dynamic i e moving in time and another part stays stationary see fig 6 the data between the two mesh parts are shared via an interface for a detailed description of the principles of the arbitrary mesh interfaces we refer the reader to the relevant literature e g jasak 2009 wang et al 2012 mcnaughton et al 2014 in the second approach to the simulation of a mixed vessel we exploit the multiple reference frames mrf method once again the mesh is divided into the moving and stationary regions as it is depicted in fig 6 however both the mesh regions are kept stationary during the simulation specifically the position of the mixer relative to the baffles as it is shown in the left part of fig 6 is maintained the rotating motion of the impeller is simulated via insertion of additional terms into the navier stokes equations for the details on mrf principles the reader is referred to the literature e g luo et al 1994 aubin et al 2004 deglon and meyer 2006 jahoda et al 2007 in the ami test case the mixer was rotating with angular velocity of 2 π rad s 1 let us now define the case reynolds number as 48 re ω imp r imp 2 ν where ω imp is the angular velocity of the impeller r imp is the impeller radius and ν is the fluid kinematic viscosity the flow was kept in the laminar regime by setting such a kinematic viscosity of the fluid that the flow reynolds number defined by 48 would be 100 the used finite volume mesh had approximately 3600 cells and it is depicted in fig 6 the result of the simulation in the openfoam software as well as the results of the generated reduced order model projected back into the original state space are depicted in fig 7 the flow in the simulated conditions is periodic one period corresponds to one quarter of the impeller rotation for the described case we constructed the rom for pressure of dimension ℓ 9 in fig 8 we plot the time evolution of mesh averaged relative difference for pressure and velocity fields it can be seen that ε u r is lower than 2 during the whole simulation the mesh averaged relative error for pressure oscillates between 1 and 3 these oscillations may be caused by the necessity to interpolate the values on the sliding arbitrary mesh interface during the fom evaluation the mrf test case was solved in the same geometry as the ami test case however the mixer was frozen in one position the mrf approach is usually used to study the steady state solutions of flow if the flow is turbulent the turbulence is simulated via the reynolds averaged navier stokes equations see menter 1992 hellsten 1997 however the purpose of the mrf test case in the present work was to evaluate the capabilities of the rom to catch fine flow structures during transient turbulent flows in order to establish the capabilities of the proposed approach to the rom construction with respect to the simulation of transient turbulent flows we simulated the flow in the mrf test case via the large eddy simulation method with the smagorinski subgrid scale model ferziger 1996 the case was modeled as transient with the initial condition corresponding to the fluid at rest the impeller angular velocity was set at 4 π rad s 1 which is twice the velocity used in the ami test case the fluid kinematic viscosity was set at 1 100 of the value used for the ami test case the case reynolds number as defined by 48 was 20000 the simulated velocity field is depicted in the right side of fig 9 four different vortices behind the baffles might be observed during the simulation these vortices detached from the baffles in an arbitrary manner and the flow itself showed a chaotic behavior because of the complex nature of the simulated flow it was necessary to increase the number of the cells in the finite volume mesh to approximately 58000 furthermore 57 pod modes had to be utilized to capture the flow intricacies with the desired accuracy from the qualitative comparison of the fom and rom results depicted in fig 9 it may be seen that even the finer flow structures were successfully captured by the reduced order model in fig 10 we show the evolution of the mesh averaged relative error in the pressure and velocity fields between the fom and rom both the errors were less than 5 during the whole simulation time 4 3 vof based model for multiphase flow the purpose of the last validation case was to test the model order reduction for the interfoam a vof based model for simulations of multiphase flows we simulated a 2 dimensional drop sliding on an infinitely long substrate inclined by φ π 3 to the horizontal the only force driving the flow was the gravity the infinite length of the substrate was approximated by connecting the left and right sides of the solution domain by a cyclic boundary condition the situation is depicted in the middle part of fig 11 the cyclic patch i which is an outlet boundary for the liquid is connected to the cyclic patch ii which consequently becomes an inlet boundary the investigated pair of fluids was water and air which we denote as a and b respectively the used fluid densities were ρ a 997 kg m 3 and ρ b 1 18 kg m 3 the dynamic viscosities of the constituent phases were μ a 8 899 1 0 3 pa s and μ b 1 831 1 0 5 pa s the surface tension between the two phases was specified as γ 0 0728 n m 1 the parameters of the dynamic contact angle model in the dynamicalphacontactangle boundary condition in the interfoam solver were fixed at β 0 70 β a 75 β r 65 and u β 1 m s 1 as the initial condition we prescribed a stagnant drop of radius r drop 2 0 mm deposited in the middle of the solution domain the initial contact angle of the drop was β i 38 6 the flow was solved using the interfoam solver from the openfoam library at first the droplet shrunk to reflect the fact that β i β r then the droplet started sliding down the plate and after approximately 0 2 s it achieved its terminal velocity and shape from that point onward the solution became periodic in fig 12 we show a qualitative comparison of fom and rom results almost at the end of the simulated time interval the exact depicted time was selected such that the droplet would be deposited in the middle of the solution domain in the left part of the figure it is possible to see that the rom tends to smear the gas liquid interface furthermore there are some relicts with α r o m 0 in the part of the solution domain that should be occupied solely by air on the other hand the rom and fom velocity fields seem to correspond rather well please note that the regions with high velocity outside the drop are unphysical this behavior of the interfoam solver is known and well documented see deshpande et al 2012 and the references therein however the goal of the test case was not to provide a physically viable solution but to test the proposed method for rom construction in fig 13 we depict the evolution of the mesh averaged relative error for the three simulated quantities i e the dynamic pressure the velocity and the color function for vof model we would like to point out three observations first all the three plotted errors are higher at the beginning of the simulation when the flow nature is changing and converge to more or less constant values after the periodic flow regime is reached second the droplet was accelerating during the simulation therefore we needed to increase the frequency of taking the solution snapshots during the fom solution this temporal refinement is visible in the increase of the number of plotted markers in fig 13 third the relatively higher values of ε α r compared to ε p r and ε u r are caused by the generation of two different roms for α and p the size of the constructed roms was selected such that the models would have the same order of the mesh averaged relative error i e the same desired accuracy as introduced in remark 1 however the dimensions ℓ α and ℓ p are different and independent one of each other 5 applications of mor for speed up of cfd parametric studies the main goal of the development of the presented approach to the model order reduction was to enable faster parametric studies of complex cfd models in this section we will first propose a simple heuristics for the choice of parameters in the reference interval against the background of rom quality maximization and outline a method to use pod deim rom as a predictor step to the simple algorithm then the proposed method will be used to reduce the computational cost of evaluation of a parametric study of an industrial scale cfd simulation finally we present a simple industry motivated toy problem to outline the capabilities of our approach to mor in optimization of process parameters 5 1 rom as a predictor step for simple algorithm let us use an example to illustrate a possibility of using a pod deim based rom as an initial guess predictor for solution of flow problems via the simple algorithm we consider a two dimensional square domain ω r 2 of side l 1 m the top side of the square is moving with a prescribed velocity of u mw 1 0 0 t m s 1 the remaining three sides are fixed for the pressure we prescribe a zero gradient boundary condition all the square sides the absolute values of pressure are determined by enforcing p 0 in the bottom left corner of ω the described case coincides with the extensively studied cavity case see e g moallemi and jang 1992 botella and peyret 1998 bruneau and saad 2006 which is distributed with openfoam as one of the tutorials the case geometry is depicted in the left side of fig 14 we are interested in a parametric study of the steady state solution to the navier stokes equations for an incompressible fluid in dependence on the problem reynolds number defined as 49 re u mw l ν re 0 1 1000 where ν is the fluid kinematic viscosity because l 1 m and u mw 1 m s 1 the problem reynolds number is inversely proportional to the fluid viscosity ν the goal of using rom as a predictor is to reduce the number of simple iterations needed to solve the flow with the desired accuracy to do so we have to construct a reduced order model that would be able to describe the flow variations for all the values of re of interest as few fom evaluations as possible then the constructed reduced order model can be used to initialize the simple iterations of the full order model to identify the values of parameters suitable for inclusion in the reduced order model we leverage the continuity equation in the navier stokes equations 50 u 0 we mark ω p h ω h the finite volume cell from the mesh ω h and introduce the finite volume discretization of the continuity error as 51 e cont ω p h ω h f f p φ f v where by f p we denote the set of all faces of the cell ω p h and by φ f v s f u f h the volume flux of an incompressible fluid through the face f the symbol s f marks the face area vector of the face f and u f h is the discretized velocity defined in the centroid of the face f note that e cont is a finite volume discretization of u from 50 also the inner sum in 51 represents the local continuity error in each cell ω p h in ω h ideally the field u rec obtained from algorithm 4 given in section 3 should be divergence free however even the solution of the full order model u h is not completely solenoidal we denote e cont u rec ℓ the continuity error obtained for u rec ℓ corresponding to the pod basis ψ j j 1 ℓ and e cont u h the continuity error of the full order model solution if n is the number of saved snapshots of the full order model solution m is the number of cells in ω h and m n then the error e cont u rec ℓ should converge to e cont u h as ℓ n we study the dependence of the solution u p to the system 29 on the parameter μ re μ d r let us assume that we have a prepared reduced order model now let us introduce μ u the vector of parameter values for which the full order model was already evaluated mind that the current rom is based on snapshots of the fom solution computed for μ μ u let μ denote the vector of parameter values of interest for which the fom was not yet evaluated we want to find the best possible μ μ to include in μ u in other words we seek such μ μ that the expansion of the current matrix of snapshots by the fom snapshot computed for μ will improve the most possible the quality of the rom we propose to use the discretized continuity error 51 and define a cost function 52 s cont ω p h ω h f f p φ f v which corresponds to a sum of all the local continuity errors in the mesh ω h the value of the parameter to evaluate the fom in μ μ can be found as 53 μ argmax μ μ s cont μ the proposed approach to the evaluation of a parametric study with rom predictor is summarized in algorithm 6 based on numerical experiments it was found that the performance of the algorithm 6 may be improved by incorporating the distance of the current tested parameter to the nearest parameter already included in the snapshots into the cost function the modified cost function is 54 s cont nn d nn q s cont where d nn marks the distance of the tested parameter μ to its nearest neighbor in μ u the power q may be used to adjust the importance of d nn for the final value of s cont nn for the purpose of this paper we used q 1 3 if the number of parameters of interest d is large the evaluation of s cont for each μ μ might be uneconomical instead it is possible to prepare the rom independently of the parameters of interest let us have a vector of parameters included in the snapshots for the rom creation with its elements ordered in the ascending order 55 μ u μ u 1 μ u d u t r d u μ 1 μ u 1 μ u 2 μ u d u μ d finding the next value of the parameter μ d μ u to be included in the snapshots is equivalent to the problem 56 μ argmax μ d μ u s cont nn μ the function s cont nn is non linear furthermore the optimization is solved on the discontinuous domain d μ u i e on d u 2 subintervals i μ j μ u j μ u j 1 j 2 d u 1 on the other hand we assume that d u is a relatively low number thus the optimization problem 56 can be solved as described in algorithm 7 the computing time of the maximization can be reduced by omitting subintervals of small length remark 4 algorithm 7 may be used instead of lines 6 9 of algorithm 6 the maximization on line 5 of algorithm 7 may be performed by any method suitable for one dimensional bounded optimization e g the brent s method brent 1973 nevertheless for each evaluation of s cont nn it is necessary to compute the fields p rom and u rec from algorithm 4 in fig 15 we depict a typical output from finding optimal snapshots to base the rom on the shown results were obtained for the cavity case where the changed parameter is the flow reynolds number re first we evaluate the full order model for the boundary values of the parameter of interest re 1 0 1 and re d 1000 then we construct rom based on the obtained results and use it to find the next value of the parameter to include in the pod basis the different optimization steps are shown in green in fig 15 and denoted as level 0 0 to find the next parameter to include we used algorithm 7 the found value is marked by a black plus and it corresponds to re 10 next we evaluate the full order model for re 10 and include the obtained snapshot in the matrix of snapshots used for the generation of the reduced order model now we need to maximize the cost function s cont nn on two subintervals re 0 1 10 and re 10 1000 the two optimizations are depicted in orange in fig 15 and denoted as level 1 0 and level 1 1 respectively the final value of the reynolds number to include in the pod basis is chosen as the higher one of the two found maxima it is marked by a black plus and it corresponds to re 1 finally the full order model is evaluated for re 1 the new snapshot is used to construct a new reduced order model the cost function should be now maximized on three subintervals re 0 1 1 re 1 10 and re 10 1000 however the subinterval re 0 1 1 is dismissed as too short the cost function is maximized on the two remaining subintervals the computed maxima are lower than the target cost function value ε s 1 thus we do not update the reduced order model and we jump directly to line 16 of algorithm 6 the obtained reduced order model is used to predict the initial guess for the simple algorithm and to speed up the process of the parametric study evaluation in fig 16 we depict a comparison of the number of simple iterations needed to obtain a fom solution with the same level of accuracy the compared cases are i a cfd simulation without any a priori pressure and velocity fields initialization ii a simulation with the initial guess predicted by a rom of dimension ℓ 6 and the snapshots selected via algorithm 6 extended by algorithm 7 and the cost function 52 and iii a simulation with the initial guess predicted by a rom of dimension ℓ 6 and the snapshots selected similarly as in ii but with the cost function 54 once more the depicted results were computed for the cavity case as it may be seen from fig 16 when the cost function s cont nn was applied we were able to achieve speed up of almost two however we would like to mention two things first the selected range of reynolds numbers to be simulated is rather large the studied parameter changes by four orders of magnitude for most of the practical applications the range of parameters of interest will be significantly more narrow and the results of the pod deim predictor might be better second using the cost function s cont nn defined by 54 instead of s cont introduced in 52 might seem beneficial from the point of view of the final computation speed up nevertheless it seems that the optimal value of the power q in 54 is problem dependent and we do not have any universally valid estimate for it in practice we are not interested in the maximal possible speed up of the calculation but in the actual results of the parametric study hence it does not make much sense to find the optimal value of q for each studied case 5 2 application of pod deim based rom to an industrial scale cfd simulation we would like to illustrate the capabilities of the developed method with respect to simulations of scales applicable in the engineering practice our test is motivated by the needs of chemical industry specifically we are interested in modeling the single phase flow in distillation and absorption columns as it was described in detail in isoz and haidl 2018 our goals are i to save the computational time during the parametric study evaluation and ii to evaluate the possibility to replace the full order model solution by the corresponding rom we take into consideration a single phase flow of the nitrogen gas in an absorption column filled with the mellapak 250 y commercial structured packing we limit our study to the simulation of a single packing element the examined inlet gas velocities range between u i 0 46 m s 1 and u i 4 31 m s 1 the mellapak 250 y geometry and the corresponding mesh are shown in fig 17 the full order model consists of a solution of incompressible reynolds averaged navier stokes equations rans the closure model for turbulence is the k ω shear stress transport model of menter 1992 the used finite volume mesh comprised approximately 5 million cells the first goal of the study is to estimate the dependence of the dry pressure loss i e the difference in pressure above and below the packed bed relative to the bed height on the gas inlet velocity then we want to find an optimal gas load of the mellapak 250 y packing element with respect to the dry pressure loss and the amount of gas processed by the column rom is used as a predictor for simple iterations in order to save computational time during the parametric study evaluation to obtain a viable initial guess for simple it is necessary to estimate five different fields kinematic pressure p velocity u turbulence kinetic energy k specific dissipation rate ω and the turbulence kinematic viscosity ν t the treatment of pressure and velocity fields is exactly the same as described in the previous parts of the text the turbulence kinetic energy and specific dissipation rate are defined by non linear pdes that after the spatial discretization lead directly to systems in the form 1 no evolution equation is available for the turbulence kinematic viscosity hence the field ν t is treated the same way as the fields d inv and h u h see eqs 37 and 38 and their description to test the applicability of the approach to the evaluation of parametric studies described in section 5 1 we generated a reduced order model via algorithm 6 with the cost function s cont nn given by 54 the evolution of s cont nn values during the run of algorithm 6 is shown in fig 18 mind that each level shown in fig 18 represents evaluation of the parametric study of interest via different rom with gradually increasing dimension the final reduced order model had dimension ℓ 6 in fig 19 we compare the number of simple iterations needed to achieve the same level of accuracy of the solution the comparison is made between the cfd with the rom predicted initial guess and a reference cfd simulation at the beginning there is not enough available full order model solutions to fully sample the solution space consequently using the rom based on those incomplete data to speed up the calculation process is counterproductive however when the solution space of the full order model is properly sampled the savings with respect to the number of simple iterations needed to achieve a converged solution become substantial in particular we used the algorithm 6 with the cost function 54 to construct the reduced order model of dimension ℓ 6 and applied this rom as a predictor for the initial guess for the rest of the parametric study the total number of simple iterations needed to evaluate the parametric study was 1246 on the other hand 1942 simple iterations are required to evaluate the parametric study without any initial guess estimate thus the total speed up achieved by using rom as an initial guess predictor for fom was approximately 1 5 moreover if a suitable reduced order model is used as a predictor for the cfd simulation fom the number of the simple iterations necessary to achieve the desired solution accuracy does not seem to depend on the flow reynolds number to examine in detail the difference in the number of iterations we concentrate on the convergence properties of the cfd simulations with a simple field initialization and with the rom predicted initial guess for a system of linear algebraic equations in the form a x b a r m m det a 0 x b r m we define the normalized residual 57 δ x j 1 m b a x j j 1 m a x a x j b a x j where x is the average of the solution vector in fig 20 we show the evolution of the normalized residual for pressure for four different cases the first two cases correspond to the gas inlet velocity of u i 2 18 m s 1 which was selected by the algorithm 6 as the first value of u i to include in the solution snapshots rom used for the prediction of the initial guess for this particular case had the dimension ℓ 2 and was based on the solution of fom for u i 0 46 m s 1 and u i 4 31 m s 1 the solution is not yet well approximated by the rom and the convergence from the rom predicted initial guess is slightly slower than the convergence of the reference cfd simulation the second case depicted in fig 20 represents a situation for which the initial guess was predicted by the final rom constructed via algorithm 6 the dimension of the final rom was ℓ 6 upon the examination of the evolution of δ p it may be seen that the initial pressure residual of the rom predicted case is approximately 10 2 furthermore the computation reaches the goal value of δ p significantly faster than the reference cfd simulation in fig 21 we show the comparison of cfd and rom results for the case of the single phase steady state flow of an incompressible fluid nitrogen gas in the complex geometry of the mellapak 250 y structured packing we depict three slices through the geometry made in x 0 09 x 0 00 and x 0 09 planes the slices are colored according to the cfd calculated velocity field y 0 and according to the relative difference between the converged cfd and rom prediction for the velocity magnitudes y 0 furthermore the part of the geometry lying in the semi space z 0 is shown and colored by the cfd calculated pressure y 0 and by the relative difference between the cfd and rom in pressure y 0 the relative error for pressure was below 1 on most of the computational mesh and never exceeded 3 the relative error in velocity magnitudes stayed below 5 throughout the computational domain to elaborate on the agreement between the converged cfd solution and the reduced order model estimate we concentrate on the packing dry pressure loss δ p h which can be directly measured therefore it is possible to use δ p h to get a notion of the reliability of the cfd simulation itself in the top part of fig 22 we compare the measured dry pressure losses to the cfd and rom estimates 1 1 for a detailed description of the experiments see isoz and haidl 2018 it can be seen that both the cfd and rom results are in a good agreement with the experimental data in the bottom part of the same figure we show relative differences in δ p h between the experimental data and cfd simulation and the cfd simulation and rom results the relative differences between cfd and experiments ranged from 4 to 8 for all the available data the differences between cfd and rom never exceeded 10 and were usually substantially lower therefore we conclude that for the purpose of the engineering calculations the reduced order model estimates may be used instead of the full order model solution once the reduced order model approximating well enough the full order model solution is obtained the full order model may be abandoned and only the reduced order model may be used in subsequent calculations to illustrate the situation we propose a simple toy problem optimization the goal of the optimization is to find the optimal gas load of an absorption column we do not take into account any mass or heat transfer in fact the liquid phase is completely neglected we are interested solely in the amount of gas processed by the column and the corresponding dry pressure loss although such a setting is unrealistic a similar case might occur for example in the task of finding the optimal flow rate in a single phase packed bed reactor we define a cost function 58 f u i δ p h δ p h max δ p h max k q 2 2 q max q q min 2 q max q min q max q min 2 where δ p h is the dry pressure loss q u i π r col 2 is the gas volumetric flow rate δ p h max is the maximal allowable dry pressure loss enforced by the safety of the column operating conditions q min is the minimal gas flow rate for which the column operations is profitable and q max is the maximal achievable gas flow rate of the production line k 0 is the proportionality constant to scale the relative importance of the terms in 58 we examine the range of the gas inlet velocities u i 0 1 3 0 m s 1 in order to catch even the fine nuances of the flow we use the algorithm 6 with the identification of the parameters to include in the pod basis given by algorithm 7 and construct a reduced order model of dimension ℓ 14 the obtained reduced order model is used to minimize the cost function 58 results of the minimization via two different algorithms simplex by dantzig 1987 and cobyla by powell 1994 are shown in fig 23 in both parts of the figure we show in color the different values of the cost function as computed during the minimization in gray we depict the values of the cost function based on the results of the full order model the algorithm 4 is used for each cost function evaluation the most time consuming step of the optimization is the projection of the results back into the full order space which is a step needed for the cost function evaluation nevertheless the whole optimization process can be completed in a matter of minutes even on a moderately powerful pc for example on a laptop equipped with intel core i5 processor 2 2 specifically the intel core i5 5200u 2 20 ghz processor was used the optimization took approximately 10 minutes when the simplex algorithm was used and approximately 6 minutes for the cobyla algorithm using the same machine the full order model solution necessary for one evaluation of the cost function 58 took approximately 26 h in total to generate the rom used to replace the cfd simulation we needed 14 evaluations of the full order model in order to run the optimization in the original space 29 fom solutions would be needed to find the optimal gas load while using the cobyla algorithm and 46 using the simplex algorithm the time needed to run the optimization in reduced space is negligible compared to the evaluation of the full order model consequently replacing fom by rom will speed up the optimization process approximately two fold with respect to the cobyla algorithm and three fold with respect to the simplex algorithm furthermore the once created rom may be reused for any other optimizations in the same parameter space 6 conclusions the proper orthogonal decomposition with model non linearities treated by the means of the discrete empirical interpolation method probably is the currently most used approach to the model order reduction in this paper we gave a brief summary of the fundamentals of both the proper orthogonal decomposition and the discrete empirical interpolation we made a special emphasis on the systems arising from the finite volume discretization of navier stokes equations and derived a method for the model order reduction specifically adapted for use in conjunction with the openfoam implementation of simple piso and pimple algorithms the proposed method was validated on a number of cases leveraging different capabilities of the openfoam cfd library e g the arbitrary mesh interface method multiple reference frames or multiphase flow in a periodic domain after the validation of the general method we presented an approach to use a reduced order model as an initial guess predictor for the simple algorithm thanks to the availability of a reliable rom we were able to significantly speed up an industrial scale parametric study of gas flow in mellapak type structured packings nomenclature remark 5 due to the number of introduced variables some symbols had to be redefined in the course of the text for example the symbols with a tilde on top of them may represent either direct outputs of openfoam internal routines a kinematic physical variables p or optimal value of a parameter μ however each new symbol definition is commented in the text furthermore the below given list of symbols is not exhaustive if a variable is used only a few times we rely on its in text definition a fom system matrix a ℓ rom system matrix b vector of right hand sides containing non linearities obtained from a cfd solver b auxiliary matrix in integration using θ method c auxiliary vector variable in the deim algorithm d rank of the matrix of snapshots y dimension of v k dimension of the parameter space d nn distance to the nearest neighbor in the parameter space already used for fom evaluation d inv vector containing the diagonal of d 1 d diagonal matrix in the decomposition m x d l u parameter space f vector valued mapping of fom non linearities f ℓ reduced order model non linearities f kinematic volume forces in ns equations f h spatial discretization of f e unit matrix f matrix of snapshots of system non linearities cost function h u h shortened notation used in the simple algorithm i j k indexing variables i interval i indexing vector obtained from the deim algorithm k proportionality constant ℓ pod rank rom dimension l lower triangular matrix in the decomposition m x d l u l differential operator representing spatial terms in a pde l h discrete counterpart of l m number of cells in ω h fom dimension m operator containing velocity terms in ns equations m t temporal part of m m x spatial part of m m x matrix obtained by a fv discretization of m x n number of taken snapshots n matrix obtained by a fv discretization of operator p rank of the pod basis for system non linearities p kinematic pressure p permutation matrix q tempo spatial solution domain r residual r radius s cost function s system snapshots s f face area vector of the face f t time u velocity column of u in the deim algorithm u upper triangular matrix in the decomposition m x d l u auxiliary system matrix in the deim algorithm v fom solution space v ℓ rom solution space subspace of v v fom trajectory continuous v k discrete approximation of v y scalar function y vector valued mapping obtained by a spatial discretization of y y matrix of snapshots greek letters α discrete counter part of the color function in vof method β gas liquid solid contact angle δ current error δ ω i h volume of i th finite volume cell δ ω h matrix with cell volumes on diagonal ε target error method accuracy η ℓ vector valued mapping of substitute variables fourier modes in a rom of dimension ℓ μ parameter μ set of parameters ν fluid kinematic viscosity ϕ j j th member of an orthonormal basis of the space containing system non linearities φ svd based orthogonal basis of the space containing discretized system non linearities φ v volume flux of a fluid ϖ linear interpolation factor ψ j j th member of an orthonormal basis of v ψ svd based discrete orthogonal basis of v k σ j j th singular value σ matrix with singular values of the matrix of snapshots on diagonal ω angular velocity ω spatial solution domain subscripts and superscripts 0 initial guess condition α connected to α f o m connected to fom cfd cont connected to the continuity equation f connected to the face f f with respect to frobenius norm h variable discretized in space imp connected to impeller ℓ connected to rom k variable discretized in time n new iteration time step o current iteration time step p connected to the cell p p connected to the kinematic pressure r relative error r o m connected to rom t connected to temporal terms t matrix transpose x connected to spatial terms direct output of openfoam internal subroutine kinematic variable optimal parameter value variable approximated via linear interpolation averaged variable dimensionless numbers re reynolds number acknowledgments the work was supported by the grant project with no ga19 02288j of the czech science foundation csf within institutional support rvo 61388998 and the centre of excellence for nonlinear dynamic behaviour of advanced materials in engineering cz 02 1 01 0 0 0 0 15 003 0000493 excellent research teams in the framework of operational programme research development and education the author would like to thankfully acknowledge numerous discussions and consults with prof dr michael hinze from the university of hamburg on the topic of model order reduction 
22679,the model order reduction mor is a useful tool for accelerating calculations connected to parametric studies or optimizations of complex systems in this paper we provide a mor method directly applicable to industrial scale problems we consider a posteriori mor based on the proper orthogonal decomposition pod with galerkin projection the problems arising from the nonlinearities in the original model are addressed within the framework of the discrete empirical interpolation method deim the reduced order model rom construction is newly implemented as a part of the open source openfoam cfd library the new implementation is validated on a number of small scale tests and applied to a real life problem of acceleration of a parametric study of flow in a complex geometry of an absorption column based on our tests the application of reduced order model as a predictor for standard simple solution can speed up the solution approximately two fold furthermore higher speed ups may be achieved if the full order model may be completely replaced by rom msc 00 01 99 00 keywords pod deim cfd openfoam 1 introduction current progress in numerical methods and available computational power combined with industrial needs promote development of more and more complex cfd simulations such simulations are expensive from the point of view of the data storage and the time necessary for their evaluation nevertheless industrial practice often calls for parametric studies and optimizations performed using these models fortunately as noted for example by cross and hohenberg 1993 numerous non linear dynamical systems exhibit a low dimensional phenomena in the sense of the term as described in katok and hasselblatt 1997 more precisely if one constructs a matrix from the measured data in our case represented by the numerical solution to the considered models most of the variance and energy is contained in a few modes computed from a singular value decomposition svd of the constructed matrix dimitriu et al 2017 therefore it is possible to apply svd based model order reduction mor techniques to reduce the computational cost and storage requirements of the developed cfd models the most widely used svd based mor technique is the proper orthogonal decomposition pod with galerkin projection volkwein 2013 kahlbacher and volkwein 2007 for a given set of theoretical experimental or computational data the method provides an orthonormal basis the obtained basis is optimally ordered in the least squares sense and the reduced order models rom are constructed by truncating this basis pinnau 2008 the original idea behind pod is known for more than a century and dates back to pearson 1901 furthermore the proper orthogonal decomposition has been independently rediscovered several times from different points of view consequently pod is also known as principal component analysis pca hoetelling 1935 jolliffe 2014 karhunen loeve decomposition karhunen 1946b a total least squares estimation tlse van huffel and lemmerling 2013 schaffrin 2006 leyang 2012 and empirical orthogonal functions eofs lorenz 0000 the pod galerkin approach has been used to construct reduced order models of systems in numerous applications in the present work we focus on simulations of different flows hence we would like to bring to the reader s attention the applications of pod in simulations of compressible flow provided by rowley et al 2004 in an experimental analysis of the flow field in a plane jet performed by shim et al 2013 and in the work of lozovskiy et al 2016 on a use of pod based mor for modeling of shallow water flows in addition many other examples of applications of pod galerkin based mor are mentioned in peng and mohseni 2016 or in chaturantabut and sorensen 2010 the applicability of the pod galerkin approach in its classical formulation is usually limited to problems with linear or bilinear terms chaturantabut and sorensen 2010 nguyen and peraire 2008 however the cfd models relevant to the industry are commonly non linear several approaches have been proposed to address the complexity of evaluating the non linear terms for the pod reduced models in the context of finite element fe finite difference fd and finite volume fv discretizations see e g nguyen and peraire 2008 astrid 2004 willcox 2006 chaturantabut and sorensen 2010 barrault et al 2004 in this work the non linearities present in the original models are treated within the framework of the discrete empirical interpolation method deim of chaturantabut and sorensen 2010 which is a discrete variant of the empirical interpolation method eim of barrault et al 2004 in this paper we develop and validate a link between the pod deim based mor and openfoam a finite volume method fvm based open source library for solution of problems of computational continuum mechanics opencfd 2016 the newly developed reduced order model rom creation technique represents an a posteriori approach to mor cosimo et al 2016 hence the solution of the full order model fom has to be available for the rom creation moreover not only the solution of the system is necessary for the pod deim based model order reduction the method also needs an access to several other data structures which are usually internal to the cfd solver this need to easily access the internal cfd solver variables often results in the use of in house cfd solvers to calculate the fom results however in order to enable a direct order reduction for large scale systems originating in the industrial practice a link between pod deim based mor and a robust enough cfd solver is needed because openfoam is open source it provides an easy access to the needed data structures moreover openfoam has been successfully used to solve industrial scale problems in various fields of cfd thus the newly implemented pod deim based model order reduction can be directly applied to a large variety of real life engineering problems our approach to the model order reduction shares some common traits with the recently published work of stabile and rozza 2018 however we directly construct a reduced order model only for the pressure and use an explicit reconstruction scheme for the velocity field consequently the resulting rom is slightly less accurate than the one obtained by stabile and rozza 2018 but it is inherently stable the paper is structured as follows first we present fundamentals of the proper orthogonal decomposition and discrete empirical interpolation next we propose a method for rom construction for systems arising from simple patankar and spalding 1972 solution of incompressible navier stokes equations the method is validated on a number of small scale examples after the method validation we combine it with a newly developed simple heuristic for optimal selection of snapshots of the full order model solution the paper is concluded by an example of an industrial scale application of the proposed method for optimization of operating conditions of an absorption column 2 fundamentals of proper orthogonal decomposition and discrete empirical interpolation the proper orthogonal decomposition is a projection based method for reducing the dimensions of general large scale ode systems regardless of their origin pinnau 2008 however we focus our attention to the systems obtained from the semi discretization of time dependent or parameter dependent partial differential equations we are particularly interested in model order reduction of large scale ode systems generated by a finite volume fv discretization of incompressible navier stokes equations as a suitable tool for the full order model evaluation and for the preparation of inputs for the reduced order model creation we use the software package openfoam which is based on the finite volume method and used for solution of tasks of the computational fluid dynamics 2 1 problem formulation a scalar non linear pde for an unknown function y r ω r ω r 3 may be rewritten as 1 y l t y 0 where the operator l r ω r represents all terms of the original pde apart from the temporal derivative after the fv semi discretization of eq 1 we obtain the system 2 δ ω h y l h t y 0 let m be the number of cells in the fv discretization mesh ω h then y r r m in 2 is the finite volume spatial semi discretization of the function y l h r ω h r m is the spatial discretization operator corresponding to the operator l and δ ω h diag δ ω 1 h δ ω m h r m m is a diagonal matrix the symbol δ ω i h i 1 m represents the volume of the i th fv volume cell of ω h in openfoam the operator l h has the structure 3 l h t y a t y b t y where implicitly discretized terms are concentrated in a t y and explicitly discretized non linearities and corrections e g for the mesh non orthogonality are used for the construction of the vector b t y the size of the matrix a and of the vector b is determined by the number of cells in ω h because the matrix δ ω h is diagonal its inversion is cheap and one can rewrite eq 2 as a large system of odes 4 y a t y b t y t 0 t y 0 y 0 a t δ ω h 1 a t b t y δ ω h 1 b t y where y 0 r m is a selected initial condition let us assume that a 0 t r m m is a continuous matrix valued mapping and b 0 t r m r m is continuous in both arguments and locally lipschitz continuous with respect to the second argument then 4 has a unique classical solution y c 1 0 t r m c 0 t r m for some maximal time t 0 t volkwein 2013 from now on we assume t t and consequently y c 1 0 t r m the goal of the following sections is to describe y as well as possible by the means of the solution of a yet unspecified replacement problem 5 η ℓ a ℓ t η ℓ f ℓ t η ℓ t 0 t η ℓ 0 η 0 ℓ where a ℓ t r ℓ ℓ and f ℓ t η ℓ r ℓ and ℓ m 2 2 proper orthogonal decomposition let v span ψ j j 1 d be the space containing the solution of the system 4 and ψ j j 1 d its orthonormal basis then it is possible to rewrite the solution of 4 as 6 y t j 1 d η j ψ j t 0 t η j t y t ψ j d dim v m where by we denote an inner product the fourier coefficients η j j 1 d are functions that map 0 t into r the terms of the sum in 6 can be arranged in descending order by the amount of information on the original system they carry by taking into account only the first ℓ d terms of 6 the following ansatz is introduced 7 y ℓ t j 1 ℓ η j ℓ ψ j t 0 t η j ℓ t y ℓ t ψ j ℓ d the ansatz 7 is an approximation of y t provided ℓ d inserting 7 into 4 and assuming that the equality holds after the projection of v on the ℓ dimensional subspace v ℓ span ψ j j 1 ℓ we obtain the reduced order system in form 5 with a new set of unknown functions 8 η ℓ η i ℓ t 0 t r m i 1 ℓ the reduced system matrix 9 a ℓ a i j ℓ r ℓ ℓ a i j ℓ a ψ j ψ i the rom non linearities 10 f ℓ f i ℓ t 0 t r ℓ f i ℓ t η b t j 1 ℓ η j ψ j ψ i and the initial condition 11 η ℓ 0 η 0 ℓ y 0 ψ 1 y 0 ψ l t the dimension of the newly defined system is ℓ d m the quality of the approximation is largely dependent on the choice of basis ψ j j 1 ℓ the proper orthogonal decomposition is a method for finding the in the least squares sense optimal basis ψ j j 1 ℓ the idea of pod is to describe the trajectory v given by 12 v span y t t 0 t v by a few orthonormal functions ψ j j 1 ℓ v ℓ while preserving as much of the information contained in the original system as possible in our case the data is generated by sampling the numerical solution of the full order model 4 at given times 13 s y j k y k t j j 1 n t j 0 t in other words we sample the trajectory v at the time points 0 t 1 t n t these samples are called snapshots because the continuous solution to problem 4 is not available we will restrict our attention to the discrete variant of pod the analogy to the trajectory 12 in the discrete setting is given by 14 v k span y 0 k y 1 k y n k v k with d k dim v k min m n 1 we introduced the superscript k to distinguish between the time continuous solution of 4 y and its discrete approximation y k however in the following text we will work solely with y k and the superscript k will be omitted the discrete variant of the pod basis ψ j j 1 ℓ is generated as described in algorithm 1 remark 1 determination of pod rank ℓ let y r m n n m be the matrix of snapshots also let ψ σ w t be the singular value decomposition of the matrix y we denote y k j 1 k σ j ψ j w j t the approximation of the matrix y generated from ψ σ and w t by taking into account only the first k columns of the matrices ψ and w t and the first k singular values we define the error with respect to the frobenius norm of the approximation of y by y k as 15 δ k 1 y k f y f 1 j 1 k σ j 2 j 1 n σ j 2 we mark ε f the desired accuracy with respect to the frobenius norm of the approximation of y by y k the pod rank ℓ is determined as 16 min k 1 n k such that δ k ε f remark 2 in applications it is usually profitable to use a weighted inner product see e g volkwein 2013 because we work with systems of odes originating in fv spatial discretization of partial differential equations it is profitable to use l 2 weighted inner product for a second order accurate discrete variant of the l 2 weighted inner product the weights directly correspond to δ ω i h i 1 m i e to the volumes of finite volume cells used in the solved problem spatial discretization 2 3 application of pod to openfoam originating systems the proper orthogonal decomposition was originally developed for linear systems of ordinary differential equations of structure 17 y a y b t y t 0 t y 0 y 0 i e for systems with time independent matrix a however in openfoam non linear pdes are linearized prior to the construction of system 4 consequently the system matrix a is time dependent the time dependence of the matrix a would enforce a recalculation of the matrix a ℓ for each rom evaluation which would in turn make the usage of rom uneconomical a way to resolve the time dependence of the matrix a is to sample the system matrices the same way as the full system solution and to interpolate between the full system matrix snapshots if one uses the linear interpolation it is possible to write the approximate system matrix as 18 a ˆ t 1 ϖ t a i 1 ϖ t a i ϖ t t t i 1 t i t i 1 i 1 n substituting the approximation 18 of the matrix a into a ℓ matrix definition 9 one may define an approximate time dependent matrix of the reduced system as 19 a ˆ ℓ t ψ t w a ˆ t ψ 1 ϖ t ψ t w a i 1 ψ ϖ t ψ t w a i ψ 1 ϖ t a i 1 ℓ ϖ t a i ℓ and the reduced order model once it is created stays fully independent on the full system dimension on the other hand it is necessary to either expand the snapshots 20 s y j j 1 n s y j a j a t j j 1 n or to recompute the needed system matrices from the saved values of y during the rom creation 2 4 discrete empirical interpolation method the reduced order model 5 introduced above is non linear however up to now we have not paid any attention to the treatment of non linearity present in the model a number of ways have been proposed to overcome the complexity of the evaluation of the reduced order non linearities e g astrid 2004 barrault et al 2004 hesthaven et al 2016 maday and mula 2013 the method used in this work is the discrete empirical interpolation method deim by chaturantabut and sorensen 2010 in order to mitigate the complexity of the non linearity evaluation the non linearity f ℓ in 5 is approximated by a projection into a subspace generated by the non linear function and spanned by a basis of dimension p m chaturantabut and sorensen 2010 volkwein 2013 the discrete version of the reduced order non linearity 10 is 21 f ℓ t ψ t b t ψ η ℓ t f ℓ t r ℓ t 0 t let n span ϕ j j 1 o be the space containing the non linearity b from 4 where o m is the dimension of the space n let s n b j b t j y j j 1 n denote the set of snapshots of system non linearities constructed the same way as the solution snapshots 13 let us define 22 f t b t ψ η ℓ t f t r m t 0 t we approximate f t by a galerkin ansatz the same way we approximated y t in 6 and 7 23 f t j 1 p c j t ϕ j φ c t φ r m p c t r p t 0 t where p is the dimension of the subspace n p n on which we projected the system non linearity the matrix φ is a discrete pod basis of the non linearity snapshots obtained via algorithm 1 if p m which is one of our requirements on the reduced order model the equality f t φ c t generates an overdetermined system to uniquely specify the vector c t it is sufficient to choose any p rows of φ and f t in deim the rows of φ and f t used to compute the vector c t are selected inductively based on a greedy algorithm the deim is summarized in algorithm 2 for further details on the method the reader is referred to relevant literature e g chaturantabut and sorensen 2010 the outputs of algorithm 2 are used to reduce the computational complexity of evaluation of 21 the indexing vector i is used to construct a matrix p e i 1 e i p where e i j 0 1 0 t is a vector with 1 in row i j and zeros elsewhere if det p t φ 0 the vector c t can be specified as 24 c t p t φ 1 f t we substitute from 24 into 21 and obtain 25 f ℓ t ψ t b t ψ η ℓ t ψ t φ c t ψ t φ p t φ 1 p t b t ψ η ℓ t furthermore if the matrix p can be moved into the argument of the non linearity the final relation is 26 ψ t φ p t φ 1 p t b t ψ η ℓ t ψ t φ p t φ 1 b t p t ψ η ℓ t the matrices ψ t φ r ℓ p p t φ 1 r p p and p t ψ r p ℓ can be precomputed volkwein 2013 all the precomputed quantities are independent of the full dimension m besides if the relation 26 is used the non linearity of the system should only be evaluated in p interpolation points or in the case of a system of odes generated by fv discretization of pde in p selected cells consequently the resulting rom is completely independent of the full system dimension 2 5 pod deim based model order reduction for parameter dependent steady non linear pdes we mark μ d r d d n a set of parameters describing the system for simplicity we assume μ d r i e d 1 the finite volume spatial semi discretization of a parameter dependent steady non linear pdes performed in openfoam generates a system similar to 4 in particular 27 0 a μ y b μ y μ d a μ δ ω h 1 a μ b μ y δ ω h 1 b μ y the construction of rom corresponding to 27 is analogous to the construction of rom for 4 the resulting rom is 28 0 a ˆ ℓ μ η ℓ μ f ˆ ℓ μ η ℓ the matrix a ˆ ℓ μ in 28 is obtained from 19 where we replaced t by μ the vector f ˆ ℓ μ η ℓ is calculated similarly from 25 the generalization of 28 for d 1 is not quite straightforward first the set of snapshots s s n needs to be robust enough to properly describe the dynamics of the studied full order system consequently the number of elements of both pod bases for the solution and for the system non linearity can significantly increase second if d 1 the parameter dependent reduced system matrix a ˆ is obtained from the pre computed reduced system matrices by linear interpolation see 19 for d 2 bi linear interpolation is required to calculate a ˆ for d 3 a tri linear interpolation might be used however the implementation of both the bi and tri linear interpolation is not trivial 3 mor of incompressible navier stokes equations 3 1 the case of parameter dependent steady state to describe our approach to the model order reduction of incompressible navier stokes equations we begin with a steady variant of the equations 29 u u ν u p f u 0 defined on a simply connected bounded domain ω r 3 and supplemented with appropriate boundary data we study the dependence of the solution u p to the system 29 on some parameter μ d r i e u d ω r 3 p d ω r the cfd solver used to compute the full solution of 29 is the simplefoam from the openfoam library opencfd 2016 patankar and spalding 1972 jasak 1996 the system 29 may be rewritten as 30 m x t 0 u p f 0 m x u ν u u u the continuity equation u 0 is pressure free thus the linearization and discretization of 30 leads to a saddle point problem which cannot be directly solved by the methods of numerical linear algebra benzi et al 2005 elman and golub 1994 for simplicity we assume that the discretization of 30 results in a system of linear algebraic equations 31 a m x n t n 0 u h p h f h 0 m x r 3 m 3 m n r m 3 m u h f h r 3 m p h r m such a situation corresponds to the discretization of the navier stokes equations on an orthogonal finite volume mesh ω h with m cells isoz 2018 however the principles of the rom construction remain the same also for more complex problems and non orthogonal meshes note that the operator m x has to be linearized before the construction of the matrix m x consequently the matrix m x depends on the current velocity field in the simple algorithm patankar and spalding 1972 which is the base of the simplefoam solver the velocity u h is expressed directly from the first row of 31 as 32 u h m x 1 f h n t p h and plugged into the second row of 31 to obtain a system of linear algebraic equations 33 n m x 1 n t p h n m x 1 f h where the only unknown is the pressure and which is solvable by standard methods of numerical linear algebra however the inverse m x 1 of the matrix m x is not usually available the issue of the calculation of the inverse m x 1 is mitigated by splitting the matrix m x as m x d l u where d l and u are diagonal lower triangular and upper triangular matrices respectively the inverse m x 1 is approximated as m x 1 d 1 and the following iterations are constructed 34 n d 1 n t p h n n d 1 h u h o u h n d 1 h u h o n t p h h u h o f h u l u h o where we denote the current iteration by the superscript o and the next iteration by the superscript n the reduced order model generated from the solution to 29 computed by the simplefoam solver must take into account the solution procedure the natural variable for solution techniques for the incompressible navier stokes equations based on the solution of the system 33 is the pressure thus it would seem reasonable to base the reduced order model directly on the relations 34 we propose to rewrite the system 27 as 35 0 a μ p h b μ p h a μ n d 1 n t b μ p h n d 1 h u h where u h is the solution for the velocity obtained from the simple iterations the reduced order model 35 needs to be supplemented by a way to calculate the velocity field in the proposed approach there is no evolution equation available for the velocity if the velocity is needed it is reconstructed after the reduced order model is evaluated and projected back into the original space v the explicit relation for velocity in 34 is 36 u h d 1 h u h n t p h the term n t p h in 36 can be easily calculated because the matrix n t r 3 m m is the discretization of the gradient operator and the pressure is obtained by the projection of the reduced variable η p ℓ into the original space however the matrix d 1 r 3 m 3 m and vector h u h r 3 m are not readily available similarly to the treatment of parameter or time dependent system matrix a t it is possible to either expand the solution snapshots to contain all the data needed for rom construction i e the solution for pressure p j h the system non linearities b j the snapshots of system matrices a j and the vectors d j inv diag d j 1 r m and h u j h j 1 n or to store only the snapshots of pressure and velocity fields and to re discretize the problem during the rom preparation this way all the above listed remaining variables can be computed when needed for a subsequent model evaluation it is sufficient to store the matrices a j ℓ r ℓ ℓ j 1 n and vectors f j r ℓ j 1 n however for the reconstruction of velocity field based on the projection of η p ℓ into v it would be necessary to store potentially large vectors d j inv and h u j h and to interpolate between them in order to mitigate this need of a large storage we propose to project these two vectors into small dimensional subspaces as 37 d j inv ℓ d ψ d inv t d j inv j 1 n and h j ℓ h ψ h t h u j h j 1 n where ψ d inv r m ℓ d and ψ h r 3 m ℓ h are pod bases for d j inv and h u j h j 1 n respectively the vectors d j inv ℓ d r ℓ d h j ℓ h r ℓ h j 1 n must be saved for the velocity field reconstruction from the rom results still the whole model remains independent of the fom dimension to reconstruct the velocity field from the rom results for some parameter μ d we first evaluate the reduced order model 35 next we apply similarly to 18 linear interpolation for approximation of vectors d inv ℓ d μ and h ℓ h μ 38 d inv ℓ d μ d ˆ inv ℓ d μ ϖ μ d i 1 inv ℓ d 1 ϖ μ d i inv ℓ d h ℓ h μ h ˆ ℓ h μ ϖ μ h i 1 ℓ h 1 ϖ μ h i ℓ h ϖ μ μ μ i 1 μ i μ i 1 i 1 n finally we project the variables η p ℓ μ d ˆ inv ℓ d μ and h ˆ ℓ h μ back into the original spaces 39 p rom μ ψ η p ℓ μ d rom inv μ ψ d inv d ˆ inv ℓ d μ h rom μ ψ h h ˆ ℓ h μ and reconstruct the velocity field directly from 36 note that in 39 we marked the rom based approximations by the subscript rom furthermore in the following we denote the reconstructed velocity field as u rec the procedure for construction and evaluation of rom for parameter dependent steady state navier stokes equations is summarized in algorithms 3 and 4 remark 3 let us denote the values of μ at which we saved the snapshots s n s as μ 1 μ 2 μ n because of the linear interpolation used to evaluate a ˆ ℓ μ and f ˆ ℓ μ on line 2 and d ˆ inv ℓ d μ and h ˆ ℓ h μ on line 4 of algorithm 4 the generated reduced order model can be used only for μ μ 1 μ n 3 2 the case of transient incompressible navier stokes equations our approach to the derivation and evaluation of rom for transient incompressible navier stokes equations 40 u t u u ν u p f u 0 defined on a solution domain q 0 t ω ω r 3 is almost analogous to the creation of rom for parameter dependent steady state navier stokes equations which is described in the previous part of the text the numerical solution of the system 40 in openfoam is based on the pimple algorithm opencfd 2016 the pressure velocity coupling in the pimple algorithm is similarly to the simple algorithm based on the iterative solution of the equation for pressure analogously to m x operator see 30 we define the operator 41 m m t m x m t u t u m x u ν u u u the full order model is 42 p h a t p h b t p h t 0 t p h 0 p 0 h a t n d 1 n t b t p h n d 1 h u h where we used the matrices n and d and the vector h u h as defined in the previous section in other words to compute the explicit time derivative of pressure necessary for the rom construction we split the operator m as shown in 41 and use only its spatial part m x to compute a t and b t p h in 42 at the moment we do not have a proof that this approach yields an exact pressure time derivative in 42 hence we define p h in the first row of 42 only approximately we use pod and deim to construct a reduced order model for 42 in the form 43 η p ℓ a ˆ p ℓ t η p ℓ f ˆ p ℓ t η p ℓ t 0 t η p ℓ 0 η p 0 ℓ the required snapshots are the same as for the case of the parameter dependent navier stokes equations the algorithm of rom construction for transient incompressible navier stokes equations is identical to algorithm 3 the only additional step during the creation of rom for the transient case is the projection of the initial condition p 0 h into v ℓ to obtain the rom initial condition η p 0 ℓ ψ t p 0 h the integration of rom 43 is similar to the evaluation of rom for parameter dependent steady state navier stokes equations for illustration we present the rom integration by a θ method with fixed time step in algorithm 5 nevertheless any other suitable integration method may be used 4 approach validation and numerical examples in order to validate the proposed method we performed a series of numerical tests we started with a test of the link between pod deim based mor and openfoam on a system that can be readily expressed in the form 1 then we proceeded to the validation of the presented approach to the rom construction for the incompressible navier stokes equations finally we tested mor of a system generated by the volume of fluid vof method hirt and nichols 1981 based model for multiphase flow 4 1 passive scalar advection as a problem that can be expressed directly in the form 1 we selected the advection of passive scalar α that comes from vof simulations of multiphase flows hirt and nichols 1981 after the spatial discretization one obtains the system in the form 2 44 α δ ω h 1 l α h a α t α b α t α t 0 t α 0 α 0 for which it is possible to construct the reduced order model directly by the previously presented methods in 44 we use a shortened notation for example the matrix a α does not explicitly depend on time but it is a function of the time dependent velocity field however at the moment the velocity is not considered a system unknown because we are interested only in the advection of the variable α in fig 1 we show a qualitative comparison between the results of an openfoam cfd simulation full order model fom and the reduced order model rom for the case of a gravity driven multiphase flow down a plate inclined by the angle φ 60 to the horizontal the dimensions of the computational domain are 6 5 0 7 cm the liquid flow rate was selected such that the simulated flow reaches a state quasi periodic in time for further details on the simulation settings see isoz 2019 the cfd simulation was performed on approximately 1 million cells the reduced order model consisted of 46 ordinary differential equations on an examination of fig 1 it can be seen that the rom describes well the general features of the flow however it tends to smooth the gas liquid interface nonetheless there is a rather good qualitative agreement between the rom and cfd simulation to further evaluate on the agreement between the cfd simulation fom and rom we calculated the absolute difference of the fields α f o m and α r o m because the tracked phase volume fractions are from 0 1 the calculated absolute difference coincides with the relative difference 45 α f o m α r o m ε α r α f o m α r o m max α min α for α 0 1 in fig 2 we show only the parts of the computational domain in which ε α r 0 1 for the most of the domain the difference is substantially lower it is visible that the biggest differences between the fields were encountered at the parts of the computational domain with a complex gas liquid interface evolution or in other words with large gradients of α function to get a notion of the difference of the solutions in the whole computational domain let us define the spatial average of ε α r as 46 ε α r i 1 m ε α i r m where m is the number of cells in the computational mesh the value ε α r for the case depicted in figs 1 and 2 is ε α r 0 0088 in fig 3 we show the evolution of ε α r with simulation time for the studied case the applied initial condition corresponds to a dry plate hence the simulation is highly dynamic at the beginning and we would need to use a large number of snapshots to account for this effect however at t 0 3 s the flow becomes quasi periodic and the agreement between fom and rom is significantly improved furthermore comparing figs 2 and 3 it is possible to determine that although the local difference between fom and rom might go up to 30 the difference between the α fields on the whole mesh lies well below 5 thus we conclude that the implementation of the link between pod deim based mor and openfoam was successful and the approach is usable for creation of roms based on equations expressible in the form 1 4 2 incompressible navier stokes equations after the validation of the link between the mor and openfoam we tested the proposed approach to the rom construction for pressure linked incompressible navier stokes equations as the first test case we selected the creation of the reduced order model for the transient laminar flow in the vicinity of a cylindrical obstacle such a flow develops an instability that leads to the formation of the famous von kármán vortex street von karman 1963 a qualitative comparison of the results of the full model fvm simulation of the full navier stokes equations on approximately 18000 cells and the constructed rom system of 7 odes is depicted in fig 4 in agreement with relation 45 we define a mesh averaged relative difference of the fields y f o m and y r o m as 47 ε y r i 1 m ε y i r m ε y i y f o m y r o m max i j y min i j y i 1 2 m j 1 2 n where n is the number of available snapshots of the full solution m is the original model dimension and by max i j y and min i j y we denote the maximum and minimum value of the corresponding matrix of snapshots y y 1 f o m y n f o m in fig 5 we depict the time dependence of ε p r and ε u r it can be seen that the difference between the full order model and the reduced order model for pressure which is our primary variable oscillates around 0 2 for the whole simulation the magnitude of the difference between the velocities is slightly larger around 0 6 however this is to be expected because the velocity field u rec is obtained from p rom via the relation 36 in which the matrix d 1 and the vector h u h are approximated the necessity of approximating these two variables in the relation 36 is imposed by the applied method for the finite volume solution of the incompressible navier stokes equations in the following tests we aim on examining the proposed approach to the model order reduction in the cases which leverage the capabilities of the openfoam library mind that the selected approach to the model order reduction is purely data driven and that the reduced order model is constructed after the evaluation of the full order model consequently all the capabilities of the openfoam library are available for the full order model evaluation to illustrate the situation we selected two different approaches to modeling of mixed vessels we generated a simple two dimensional geometry corresponding to a mixed vessel with baffles the simulated stirred tank has the radius of 10 cm the mixer itself has the radius of 6 5 cm and the baffles are 2 cm long the geometry is illustrated in fig 6 in the first approach the flow in the mixed vessel was kept in the laminar regime and modeled via the so called arbitrary mesh interfaces ami in the simulations containing arbitrary mesh interfaces a part of the mesh is dynamic i e moving in time and another part stays stationary see fig 6 the data between the two mesh parts are shared via an interface for a detailed description of the principles of the arbitrary mesh interfaces we refer the reader to the relevant literature e g jasak 2009 wang et al 2012 mcnaughton et al 2014 in the second approach to the simulation of a mixed vessel we exploit the multiple reference frames mrf method once again the mesh is divided into the moving and stationary regions as it is depicted in fig 6 however both the mesh regions are kept stationary during the simulation specifically the position of the mixer relative to the baffles as it is shown in the left part of fig 6 is maintained the rotating motion of the impeller is simulated via insertion of additional terms into the navier stokes equations for the details on mrf principles the reader is referred to the literature e g luo et al 1994 aubin et al 2004 deglon and meyer 2006 jahoda et al 2007 in the ami test case the mixer was rotating with angular velocity of 2 π rad s 1 let us now define the case reynolds number as 48 re ω imp r imp 2 ν where ω imp is the angular velocity of the impeller r imp is the impeller radius and ν is the fluid kinematic viscosity the flow was kept in the laminar regime by setting such a kinematic viscosity of the fluid that the flow reynolds number defined by 48 would be 100 the used finite volume mesh had approximately 3600 cells and it is depicted in fig 6 the result of the simulation in the openfoam software as well as the results of the generated reduced order model projected back into the original state space are depicted in fig 7 the flow in the simulated conditions is periodic one period corresponds to one quarter of the impeller rotation for the described case we constructed the rom for pressure of dimension ℓ 9 in fig 8 we plot the time evolution of mesh averaged relative difference for pressure and velocity fields it can be seen that ε u r is lower than 2 during the whole simulation the mesh averaged relative error for pressure oscillates between 1 and 3 these oscillations may be caused by the necessity to interpolate the values on the sliding arbitrary mesh interface during the fom evaluation the mrf test case was solved in the same geometry as the ami test case however the mixer was frozen in one position the mrf approach is usually used to study the steady state solutions of flow if the flow is turbulent the turbulence is simulated via the reynolds averaged navier stokes equations see menter 1992 hellsten 1997 however the purpose of the mrf test case in the present work was to evaluate the capabilities of the rom to catch fine flow structures during transient turbulent flows in order to establish the capabilities of the proposed approach to the rom construction with respect to the simulation of transient turbulent flows we simulated the flow in the mrf test case via the large eddy simulation method with the smagorinski subgrid scale model ferziger 1996 the case was modeled as transient with the initial condition corresponding to the fluid at rest the impeller angular velocity was set at 4 π rad s 1 which is twice the velocity used in the ami test case the fluid kinematic viscosity was set at 1 100 of the value used for the ami test case the case reynolds number as defined by 48 was 20000 the simulated velocity field is depicted in the right side of fig 9 four different vortices behind the baffles might be observed during the simulation these vortices detached from the baffles in an arbitrary manner and the flow itself showed a chaotic behavior because of the complex nature of the simulated flow it was necessary to increase the number of the cells in the finite volume mesh to approximately 58000 furthermore 57 pod modes had to be utilized to capture the flow intricacies with the desired accuracy from the qualitative comparison of the fom and rom results depicted in fig 9 it may be seen that even the finer flow structures were successfully captured by the reduced order model in fig 10 we show the evolution of the mesh averaged relative error in the pressure and velocity fields between the fom and rom both the errors were less than 5 during the whole simulation time 4 3 vof based model for multiphase flow the purpose of the last validation case was to test the model order reduction for the interfoam a vof based model for simulations of multiphase flows we simulated a 2 dimensional drop sliding on an infinitely long substrate inclined by φ π 3 to the horizontal the only force driving the flow was the gravity the infinite length of the substrate was approximated by connecting the left and right sides of the solution domain by a cyclic boundary condition the situation is depicted in the middle part of fig 11 the cyclic patch i which is an outlet boundary for the liquid is connected to the cyclic patch ii which consequently becomes an inlet boundary the investigated pair of fluids was water and air which we denote as a and b respectively the used fluid densities were ρ a 997 kg m 3 and ρ b 1 18 kg m 3 the dynamic viscosities of the constituent phases were μ a 8 899 1 0 3 pa s and μ b 1 831 1 0 5 pa s the surface tension between the two phases was specified as γ 0 0728 n m 1 the parameters of the dynamic contact angle model in the dynamicalphacontactangle boundary condition in the interfoam solver were fixed at β 0 70 β a 75 β r 65 and u β 1 m s 1 as the initial condition we prescribed a stagnant drop of radius r drop 2 0 mm deposited in the middle of the solution domain the initial contact angle of the drop was β i 38 6 the flow was solved using the interfoam solver from the openfoam library at first the droplet shrunk to reflect the fact that β i β r then the droplet started sliding down the plate and after approximately 0 2 s it achieved its terminal velocity and shape from that point onward the solution became periodic in fig 12 we show a qualitative comparison of fom and rom results almost at the end of the simulated time interval the exact depicted time was selected such that the droplet would be deposited in the middle of the solution domain in the left part of the figure it is possible to see that the rom tends to smear the gas liquid interface furthermore there are some relicts with α r o m 0 in the part of the solution domain that should be occupied solely by air on the other hand the rom and fom velocity fields seem to correspond rather well please note that the regions with high velocity outside the drop are unphysical this behavior of the interfoam solver is known and well documented see deshpande et al 2012 and the references therein however the goal of the test case was not to provide a physically viable solution but to test the proposed method for rom construction in fig 13 we depict the evolution of the mesh averaged relative error for the three simulated quantities i e the dynamic pressure the velocity and the color function for vof model we would like to point out three observations first all the three plotted errors are higher at the beginning of the simulation when the flow nature is changing and converge to more or less constant values after the periodic flow regime is reached second the droplet was accelerating during the simulation therefore we needed to increase the frequency of taking the solution snapshots during the fom solution this temporal refinement is visible in the increase of the number of plotted markers in fig 13 third the relatively higher values of ε α r compared to ε p r and ε u r are caused by the generation of two different roms for α and p the size of the constructed roms was selected such that the models would have the same order of the mesh averaged relative error i e the same desired accuracy as introduced in remark 1 however the dimensions ℓ α and ℓ p are different and independent one of each other 5 applications of mor for speed up of cfd parametric studies the main goal of the development of the presented approach to the model order reduction was to enable faster parametric studies of complex cfd models in this section we will first propose a simple heuristics for the choice of parameters in the reference interval against the background of rom quality maximization and outline a method to use pod deim rom as a predictor step to the simple algorithm then the proposed method will be used to reduce the computational cost of evaluation of a parametric study of an industrial scale cfd simulation finally we present a simple industry motivated toy problem to outline the capabilities of our approach to mor in optimization of process parameters 5 1 rom as a predictor step for simple algorithm let us use an example to illustrate a possibility of using a pod deim based rom as an initial guess predictor for solution of flow problems via the simple algorithm we consider a two dimensional square domain ω r 2 of side l 1 m the top side of the square is moving with a prescribed velocity of u mw 1 0 0 t m s 1 the remaining three sides are fixed for the pressure we prescribe a zero gradient boundary condition all the square sides the absolute values of pressure are determined by enforcing p 0 in the bottom left corner of ω the described case coincides with the extensively studied cavity case see e g moallemi and jang 1992 botella and peyret 1998 bruneau and saad 2006 which is distributed with openfoam as one of the tutorials the case geometry is depicted in the left side of fig 14 we are interested in a parametric study of the steady state solution to the navier stokes equations for an incompressible fluid in dependence on the problem reynolds number defined as 49 re u mw l ν re 0 1 1000 where ν is the fluid kinematic viscosity because l 1 m and u mw 1 m s 1 the problem reynolds number is inversely proportional to the fluid viscosity ν the goal of using rom as a predictor is to reduce the number of simple iterations needed to solve the flow with the desired accuracy to do so we have to construct a reduced order model that would be able to describe the flow variations for all the values of re of interest as few fom evaluations as possible then the constructed reduced order model can be used to initialize the simple iterations of the full order model to identify the values of parameters suitable for inclusion in the reduced order model we leverage the continuity equation in the navier stokes equations 50 u 0 we mark ω p h ω h the finite volume cell from the mesh ω h and introduce the finite volume discretization of the continuity error as 51 e cont ω p h ω h f f p φ f v where by f p we denote the set of all faces of the cell ω p h and by φ f v s f u f h the volume flux of an incompressible fluid through the face f the symbol s f marks the face area vector of the face f and u f h is the discretized velocity defined in the centroid of the face f note that e cont is a finite volume discretization of u from 50 also the inner sum in 51 represents the local continuity error in each cell ω p h in ω h ideally the field u rec obtained from algorithm 4 given in section 3 should be divergence free however even the solution of the full order model u h is not completely solenoidal we denote e cont u rec ℓ the continuity error obtained for u rec ℓ corresponding to the pod basis ψ j j 1 ℓ and e cont u h the continuity error of the full order model solution if n is the number of saved snapshots of the full order model solution m is the number of cells in ω h and m n then the error e cont u rec ℓ should converge to e cont u h as ℓ n we study the dependence of the solution u p to the system 29 on the parameter μ re μ d r let us assume that we have a prepared reduced order model now let us introduce μ u the vector of parameter values for which the full order model was already evaluated mind that the current rom is based on snapshots of the fom solution computed for μ μ u let μ denote the vector of parameter values of interest for which the fom was not yet evaluated we want to find the best possible μ μ to include in μ u in other words we seek such μ μ that the expansion of the current matrix of snapshots by the fom snapshot computed for μ will improve the most possible the quality of the rom we propose to use the discretized continuity error 51 and define a cost function 52 s cont ω p h ω h f f p φ f v which corresponds to a sum of all the local continuity errors in the mesh ω h the value of the parameter to evaluate the fom in μ μ can be found as 53 μ argmax μ μ s cont μ the proposed approach to the evaluation of a parametric study with rom predictor is summarized in algorithm 6 based on numerical experiments it was found that the performance of the algorithm 6 may be improved by incorporating the distance of the current tested parameter to the nearest parameter already included in the snapshots into the cost function the modified cost function is 54 s cont nn d nn q s cont where d nn marks the distance of the tested parameter μ to its nearest neighbor in μ u the power q may be used to adjust the importance of d nn for the final value of s cont nn for the purpose of this paper we used q 1 3 if the number of parameters of interest d is large the evaluation of s cont for each μ μ might be uneconomical instead it is possible to prepare the rom independently of the parameters of interest let us have a vector of parameters included in the snapshots for the rom creation with its elements ordered in the ascending order 55 μ u μ u 1 μ u d u t r d u μ 1 μ u 1 μ u 2 μ u d u μ d finding the next value of the parameter μ d μ u to be included in the snapshots is equivalent to the problem 56 μ argmax μ d μ u s cont nn μ the function s cont nn is non linear furthermore the optimization is solved on the discontinuous domain d μ u i e on d u 2 subintervals i μ j μ u j μ u j 1 j 2 d u 1 on the other hand we assume that d u is a relatively low number thus the optimization problem 56 can be solved as described in algorithm 7 the computing time of the maximization can be reduced by omitting subintervals of small length remark 4 algorithm 7 may be used instead of lines 6 9 of algorithm 6 the maximization on line 5 of algorithm 7 may be performed by any method suitable for one dimensional bounded optimization e g the brent s method brent 1973 nevertheless for each evaluation of s cont nn it is necessary to compute the fields p rom and u rec from algorithm 4 in fig 15 we depict a typical output from finding optimal snapshots to base the rom on the shown results were obtained for the cavity case where the changed parameter is the flow reynolds number re first we evaluate the full order model for the boundary values of the parameter of interest re 1 0 1 and re d 1000 then we construct rom based on the obtained results and use it to find the next value of the parameter to include in the pod basis the different optimization steps are shown in green in fig 15 and denoted as level 0 0 to find the next parameter to include we used algorithm 7 the found value is marked by a black plus and it corresponds to re 10 next we evaluate the full order model for re 10 and include the obtained snapshot in the matrix of snapshots used for the generation of the reduced order model now we need to maximize the cost function s cont nn on two subintervals re 0 1 10 and re 10 1000 the two optimizations are depicted in orange in fig 15 and denoted as level 1 0 and level 1 1 respectively the final value of the reynolds number to include in the pod basis is chosen as the higher one of the two found maxima it is marked by a black plus and it corresponds to re 1 finally the full order model is evaluated for re 1 the new snapshot is used to construct a new reduced order model the cost function should be now maximized on three subintervals re 0 1 1 re 1 10 and re 10 1000 however the subinterval re 0 1 1 is dismissed as too short the cost function is maximized on the two remaining subintervals the computed maxima are lower than the target cost function value ε s 1 thus we do not update the reduced order model and we jump directly to line 16 of algorithm 6 the obtained reduced order model is used to predict the initial guess for the simple algorithm and to speed up the process of the parametric study evaluation in fig 16 we depict a comparison of the number of simple iterations needed to obtain a fom solution with the same level of accuracy the compared cases are i a cfd simulation without any a priori pressure and velocity fields initialization ii a simulation with the initial guess predicted by a rom of dimension ℓ 6 and the snapshots selected via algorithm 6 extended by algorithm 7 and the cost function 52 and iii a simulation with the initial guess predicted by a rom of dimension ℓ 6 and the snapshots selected similarly as in ii but with the cost function 54 once more the depicted results were computed for the cavity case as it may be seen from fig 16 when the cost function s cont nn was applied we were able to achieve speed up of almost two however we would like to mention two things first the selected range of reynolds numbers to be simulated is rather large the studied parameter changes by four orders of magnitude for most of the practical applications the range of parameters of interest will be significantly more narrow and the results of the pod deim predictor might be better second using the cost function s cont nn defined by 54 instead of s cont introduced in 52 might seem beneficial from the point of view of the final computation speed up nevertheless it seems that the optimal value of the power q in 54 is problem dependent and we do not have any universally valid estimate for it in practice we are not interested in the maximal possible speed up of the calculation but in the actual results of the parametric study hence it does not make much sense to find the optimal value of q for each studied case 5 2 application of pod deim based rom to an industrial scale cfd simulation we would like to illustrate the capabilities of the developed method with respect to simulations of scales applicable in the engineering practice our test is motivated by the needs of chemical industry specifically we are interested in modeling the single phase flow in distillation and absorption columns as it was described in detail in isoz and haidl 2018 our goals are i to save the computational time during the parametric study evaluation and ii to evaluate the possibility to replace the full order model solution by the corresponding rom we take into consideration a single phase flow of the nitrogen gas in an absorption column filled with the mellapak 250 y commercial structured packing we limit our study to the simulation of a single packing element the examined inlet gas velocities range between u i 0 46 m s 1 and u i 4 31 m s 1 the mellapak 250 y geometry and the corresponding mesh are shown in fig 17 the full order model consists of a solution of incompressible reynolds averaged navier stokes equations rans the closure model for turbulence is the k ω shear stress transport model of menter 1992 the used finite volume mesh comprised approximately 5 million cells the first goal of the study is to estimate the dependence of the dry pressure loss i e the difference in pressure above and below the packed bed relative to the bed height on the gas inlet velocity then we want to find an optimal gas load of the mellapak 250 y packing element with respect to the dry pressure loss and the amount of gas processed by the column rom is used as a predictor for simple iterations in order to save computational time during the parametric study evaluation to obtain a viable initial guess for simple it is necessary to estimate five different fields kinematic pressure p velocity u turbulence kinetic energy k specific dissipation rate ω and the turbulence kinematic viscosity ν t the treatment of pressure and velocity fields is exactly the same as described in the previous parts of the text the turbulence kinetic energy and specific dissipation rate are defined by non linear pdes that after the spatial discretization lead directly to systems in the form 1 no evolution equation is available for the turbulence kinematic viscosity hence the field ν t is treated the same way as the fields d inv and h u h see eqs 37 and 38 and their description to test the applicability of the approach to the evaluation of parametric studies described in section 5 1 we generated a reduced order model via algorithm 6 with the cost function s cont nn given by 54 the evolution of s cont nn values during the run of algorithm 6 is shown in fig 18 mind that each level shown in fig 18 represents evaluation of the parametric study of interest via different rom with gradually increasing dimension the final reduced order model had dimension ℓ 6 in fig 19 we compare the number of simple iterations needed to achieve the same level of accuracy of the solution the comparison is made between the cfd with the rom predicted initial guess and a reference cfd simulation at the beginning there is not enough available full order model solutions to fully sample the solution space consequently using the rom based on those incomplete data to speed up the calculation process is counterproductive however when the solution space of the full order model is properly sampled the savings with respect to the number of simple iterations needed to achieve a converged solution become substantial in particular we used the algorithm 6 with the cost function 54 to construct the reduced order model of dimension ℓ 6 and applied this rom as a predictor for the initial guess for the rest of the parametric study the total number of simple iterations needed to evaluate the parametric study was 1246 on the other hand 1942 simple iterations are required to evaluate the parametric study without any initial guess estimate thus the total speed up achieved by using rom as an initial guess predictor for fom was approximately 1 5 moreover if a suitable reduced order model is used as a predictor for the cfd simulation fom the number of the simple iterations necessary to achieve the desired solution accuracy does not seem to depend on the flow reynolds number to examine in detail the difference in the number of iterations we concentrate on the convergence properties of the cfd simulations with a simple field initialization and with the rom predicted initial guess for a system of linear algebraic equations in the form a x b a r m m det a 0 x b r m we define the normalized residual 57 δ x j 1 m b a x j j 1 m a x a x j b a x j where x is the average of the solution vector in fig 20 we show the evolution of the normalized residual for pressure for four different cases the first two cases correspond to the gas inlet velocity of u i 2 18 m s 1 which was selected by the algorithm 6 as the first value of u i to include in the solution snapshots rom used for the prediction of the initial guess for this particular case had the dimension ℓ 2 and was based on the solution of fom for u i 0 46 m s 1 and u i 4 31 m s 1 the solution is not yet well approximated by the rom and the convergence from the rom predicted initial guess is slightly slower than the convergence of the reference cfd simulation the second case depicted in fig 20 represents a situation for which the initial guess was predicted by the final rom constructed via algorithm 6 the dimension of the final rom was ℓ 6 upon the examination of the evolution of δ p it may be seen that the initial pressure residual of the rom predicted case is approximately 10 2 furthermore the computation reaches the goal value of δ p significantly faster than the reference cfd simulation in fig 21 we show the comparison of cfd and rom results for the case of the single phase steady state flow of an incompressible fluid nitrogen gas in the complex geometry of the mellapak 250 y structured packing we depict three slices through the geometry made in x 0 09 x 0 00 and x 0 09 planes the slices are colored according to the cfd calculated velocity field y 0 and according to the relative difference between the converged cfd and rom prediction for the velocity magnitudes y 0 furthermore the part of the geometry lying in the semi space z 0 is shown and colored by the cfd calculated pressure y 0 and by the relative difference between the cfd and rom in pressure y 0 the relative error for pressure was below 1 on most of the computational mesh and never exceeded 3 the relative error in velocity magnitudes stayed below 5 throughout the computational domain to elaborate on the agreement between the converged cfd solution and the reduced order model estimate we concentrate on the packing dry pressure loss δ p h which can be directly measured therefore it is possible to use δ p h to get a notion of the reliability of the cfd simulation itself in the top part of fig 22 we compare the measured dry pressure losses to the cfd and rom estimates 1 1 for a detailed description of the experiments see isoz and haidl 2018 it can be seen that both the cfd and rom results are in a good agreement with the experimental data in the bottom part of the same figure we show relative differences in δ p h between the experimental data and cfd simulation and the cfd simulation and rom results the relative differences between cfd and experiments ranged from 4 to 8 for all the available data the differences between cfd and rom never exceeded 10 and were usually substantially lower therefore we conclude that for the purpose of the engineering calculations the reduced order model estimates may be used instead of the full order model solution once the reduced order model approximating well enough the full order model solution is obtained the full order model may be abandoned and only the reduced order model may be used in subsequent calculations to illustrate the situation we propose a simple toy problem optimization the goal of the optimization is to find the optimal gas load of an absorption column we do not take into account any mass or heat transfer in fact the liquid phase is completely neglected we are interested solely in the amount of gas processed by the column and the corresponding dry pressure loss although such a setting is unrealistic a similar case might occur for example in the task of finding the optimal flow rate in a single phase packed bed reactor we define a cost function 58 f u i δ p h δ p h max δ p h max k q 2 2 q max q q min 2 q max q min q max q min 2 where δ p h is the dry pressure loss q u i π r col 2 is the gas volumetric flow rate δ p h max is the maximal allowable dry pressure loss enforced by the safety of the column operating conditions q min is the minimal gas flow rate for which the column operations is profitable and q max is the maximal achievable gas flow rate of the production line k 0 is the proportionality constant to scale the relative importance of the terms in 58 we examine the range of the gas inlet velocities u i 0 1 3 0 m s 1 in order to catch even the fine nuances of the flow we use the algorithm 6 with the identification of the parameters to include in the pod basis given by algorithm 7 and construct a reduced order model of dimension ℓ 14 the obtained reduced order model is used to minimize the cost function 58 results of the minimization via two different algorithms simplex by dantzig 1987 and cobyla by powell 1994 are shown in fig 23 in both parts of the figure we show in color the different values of the cost function as computed during the minimization in gray we depict the values of the cost function based on the results of the full order model the algorithm 4 is used for each cost function evaluation the most time consuming step of the optimization is the projection of the results back into the full order space which is a step needed for the cost function evaluation nevertheless the whole optimization process can be completed in a matter of minutes even on a moderately powerful pc for example on a laptop equipped with intel core i5 processor 2 2 specifically the intel core i5 5200u 2 20 ghz processor was used the optimization took approximately 10 minutes when the simplex algorithm was used and approximately 6 minutes for the cobyla algorithm using the same machine the full order model solution necessary for one evaluation of the cost function 58 took approximately 26 h in total to generate the rom used to replace the cfd simulation we needed 14 evaluations of the full order model in order to run the optimization in the original space 29 fom solutions would be needed to find the optimal gas load while using the cobyla algorithm and 46 using the simplex algorithm the time needed to run the optimization in reduced space is negligible compared to the evaluation of the full order model consequently replacing fom by rom will speed up the optimization process approximately two fold with respect to the cobyla algorithm and three fold with respect to the simplex algorithm furthermore the once created rom may be reused for any other optimizations in the same parameter space 6 conclusions the proper orthogonal decomposition with model non linearities treated by the means of the discrete empirical interpolation method probably is the currently most used approach to the model order reduction in this paper we gave a brief summary of the fundamentals of both the proper orthogonal decomposition and the discrete empirical interpolation we made a special emphasis on the systems arising from the finite volume discretization of navier stokes equations and derived a method for the model order reduction specifically adapted for use in conjunction with the openfoam implementation of simple piso and pimple algorithms the proposed method was validated on a number of cases leveraging different capabilities of the openfoam cfd library e g the arbitrary mesh interface method multiple reference frames or multiphase flow in a periodic domain after the validation of the general method we presented an approach to use a reduced order model as an initial guess predictor for the simple algorithm thanks to the availability of a reliable rom we were able to significantly speed up an industrial scale parametric study of gas flow in mellapak type structured packings nomenclature remark 5 due to the number of introduced variables some symbols had to be redefined in the course of the text for example the symbols with a tilde on top of them may represent either direct outputs of openfoam internal routines a kinematic physical variables p or optimal value of a parameter μ however each new symbol definition is commented in the text furthermore the below given list of symbols is not exhaustive if a variable is used only a few times we rely on its in text definition a fom system matrix a ℓ rom system matrix b vector of right hand sides containing non linearities obtained from a cfd solver b auxiliary matrix in integration using θ method c auxiliary vector variable in the deim algorithm d rank of the matrix of snapshots y dimension of v k dimension of the parameter space d nn distance to the nearest neighbor in the parameter space already used for fom evaluation d inv vector containing the diagonal of d 1 d diagonal matrix in the decomposition m x d l u parameter space f vector valued mapping of fom non linearities f ℓ reduced order model non linearities f kinematic volume forces in ns equations f h spatial discretization of f e unit matrix f matrix of snapshots of system non linearities cost function h u h shortened notation used in the simple algorithm i j k indexing variables i interval i indexing vector obtained from the deim algorithm k proportionality constant ℓ pod rank rom dimension l lower triangular matrix in the decomposition m x d l u l differential operator representing spatial terms in a pde l h discrete counterpart of l m number of cells in ω h fom dimension m operator containing velocity terms in ns equations m t temporal part of m m x spatial part of m m x matrix obtained by a fv discretization of m x n number of taken snapshots n matrix obtained by a fv discretization of operator p rank of the pod basis for system non linearities p kinematic pressure p permutation matrix q tempo spatial solution domain r residual r radius s cost function s system snapshots s f face area vector of the face f t time u velocity column of u in the deim algorithm u upper triangular matrix in the decomposition m x d l u auxiliary system matrix in the deim algorithm v fom solution space v ℓ rom solution space subspace of v v fom trajectory continuous v k discrete approximation of v y scalar function y vector valued mapping obtained by a spatial discretization of y y matrix of snapshots greek letters α discrete counter part of the color function in vof method β gas liquid solid contact angle δ current error δ ω i h volume of i th finite volume cell δ ω h matrix with cell volumes on diagonal ε target error method accuracy η ℓ vector valued mapping of substitute variables fourier modes in a rom of dimension ℓ μ parameter μ set of parameters ν fluid kinematic viscosity ϕ j j th member of an orthonormal basis of the space containing system non linearities φ svd based orthogonal basis of the space containing discretized system non linearities φ v volume flux of a fluid ϖ linear interpolation factor ψ j j th member of an orthonormal basis of v ψ svd based discrete orthogonal basis of v k σ j j th singular value σ matrix with singular values of the matrix of snapshots on diagonal ω angular velocity ω spatial solution domain subscripts and superscripts 0 initial guess condition α connected to α f o m connected to fom cfd cont connected to the continuity equation f connected to the face f f with respect to frobenius norm h variable discretized in space imp connected to impeller ℓ connected to rom k variable discretized in time n new iteration time step o current iteration time step p connected to the cell p p connected to the kinematic pressure r relative error r o m connected to rom t connected to temporal terms t matrix transpose x connected to spatial terms direct output of openfoam internal subroutine kinematic variable optimal parameter value variable approximated via linear interpolation averaged variable dimensionless numbers re reynolds number acknowledgments the work was supported by the grant project with no ga19 02288j of the czech science foundation csf within institutional support rvo 61388998 and the centre of excellence for nonlinear dynamic behaviour of advanced materials in engineering cz 02 1 01 0 0 0 0 15 003 0000493 excellent research teams in the framework of operational programme research development and education the author would like to thankfully acknowledge numerous discussions and consults with prof dr michael hinze from the university of hamburg on the topic of model order reduction 
