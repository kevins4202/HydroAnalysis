index,text
20645,the study explores storm floods in the yangtze estuary to examine the surge responses to the variation of storm tracks and storm timing under the combined effect of astronomical tides storm surge and runoff a new method of typhoon scenario construction is developed based on a hypothesis of the influenced sphere of the yangtze estuary isye raised in the paper and two representative typhoon tracks the direct landing typhoon dlt and the offshore northward typhoon ont are studied by the worst cases with five scenarios of tidal range using fvcom the result shows that the surge threats of dlt and ont concentrate on the upper estuary and inner estuary respectively the phase shift due to the acceleration of phase speed resulting from the surge tide interaction and the flood current is proposed to be the primary factor increasing surge in the rising tide a transfer of the peak surge position is detected outside the estuary which can well explain the abnormally small surge near the low tide further the larger tidal range tends to attenuate surge levels due to the enhanced depth in the inner and upper estuarine areas keywords storm surge tracks storm timing tide surge interaction the yangtze estuary fvcom 1 introduction storm flooding is a major geophysical threat in the estuary and coastal areas associated with seawall damage and heavy inundation lewis et al 2013 yin et al 2016 zhang and pan 2014 corresponding to the trend of climate warming especially the warmer sea surface ji et al 2018 2019 zhang et al 2018 is expected to increase the average intensity of typhoons by an additional 14 over the northwestern pacific by 2100 mei et al 2015 the cumulative direct economic loss caused by typhoons and storm surges reaches 30 4 billion in the range 2000 2019 according to the ministry of natural resources of the people s republic of china http www mnr gov cn ranking first in all marine disasters in particular the yangtze estuary is trumpet shaped with complex topography in a low lying plain making it vulnerable to sea level variation induced by tropical cyclones the yangtze estuary has been attacked by typhoons frequently in recent years pan and liu 2020 especially in 2018 six typhoons exacerbated adverse effects on its low lying areas storm surge is a complex atmosphere ocean coupled process it is widely concerned that the estimated maximum wind speed is a vital indicator of storm damage berke et al 1984 cyriac et al 2018 the magnitude of storm surge varies with the variation of storm intensity dietrich et al 2018 maximum wind speed error exceeding 20 may cause significant errors in storm surge simulations torres et al 2019 storm size is usually a factor of less focus powell and reinhold 2007 presented a new approach of hurricane damage assessment from a perspective of energy over the entire storm considering the influence of storm size simulated storm surge is found to increase with storm size especially on mildly sloping bottoms and for strong storms irish 2008 storm track is crucial for simulated storm surge which relies heavily on the two determining factors of wind direction and wind duration three components landfall location approach angle and approach speed are studied instead as storm track can hardly be quantified landfall location change has great effects on storm surges of storms with the same intensity sun et al 2015 torres et al 2015 the study on tampa bay shows that typhoons making landfall to the north of the bay mouth can cause larger storm surges than that at or to the south of the bay mouth weisberg and zheng 2006 variations of landfall location can even change the state of surges in the study area a transformation from set up processes to mainly set down processes zhang et al 2018 the study of weisberg and zheng 2006 indicates that the shift in storm approach angles can result in increasing overall storm surge irish 2008 has found that tracks perpendicular to the shoreline tends to produce larger surge than tracks with more oblique approach angles on average by 8 a storm with higher approach speed can result in smaller storm surges li et al 2014 as a certain amount of time is required to build the surface slope by transporting water weisberg and zheng 2006 the 50 slower approach speed in simulation has a decrease in flooding along the open coast while results in larger surges in the estuaries and floodplains along the south atlantic bight thomas et al 2019 meanwhile surge levels can be amplified strikingly by particular storm tracks owing to seiche mori et al 2014 takayabu et al 2015 nearshore topography also contributes significantly to the uncertainty of the storm surge prediction and disaster storm flood is a very localized phenomenon in the light of the storm attributes related to the regional geometry weisberg and zheng 2006 high risk regions are usually the waters with two more barriers a hood shaped or bottle shaped geometry with a broad entrance is likely to induce large storm surges zhang et al 2018 sea level rise is also considered as a crucial factor of storm surge study while the result varies predicted storm surge showed an increasing trend along the coast of the uk and ireland due to the projected relative sea level rise rslr brown et al 2010 2012 lowe et al 2009 and can be enforced which exceeds 30 of the rslr along europe coast vousdoukas et al 2016 while storm surge attenuation is likely to occur where depth changes are relatively large due to the sea level rise arns et al 2015 sea level rise is a pressing but uncertain concern about storm surge and inundation to these coastal areas especially within a long enough time frame as is one of the most discussed aspects of climate change woodworth et al 2011 in conclusion all the key factors mentioned above the storm size the landfall location and the approach angle tell the fact that apart from the intensity the direction of the wind on the target waters is a determinate indicator of storm surge while hard to catch since the wind direction is constantly changing as a typhoon moves heretofore many researchers have tried to study the influence of tracks on storm surges with chiefly two scenario constructing methods of storm tracks some paid more attention to the violent storms the tracks of which are considered as standard ones and then the hypothetical typhoon tracks were constructed by a small distance of translation or a small angle of rotation sebastian et al 2019 wang et al 2018 others studied storm surge by treating tracks as a set of parallels with particular angles and certain intensity zhang et al 2018 the study aims to examine the responses of complex terrain to the variation of storm tracks and storm timing with a new method of typhoon scenario construction to investigate the worst case a hypothesis of the influenced sphere of the yangtze estuary was raised and based on it and the features of historical typhoon tracks a new typhoon scenario construction method was proposed describing the function of the direction of prevailing wind controlling the area the study also provides a reference for similar coastal hazards impacts on the estuarine regions 2 materials and methods 2 1 model description a high resolution three domain model nested with a two dimensional numerical model is established to study the influence of the storm surge coupled with run off and astronomical tide the outer model is the numerical model of the northwest pacific zhang et al 2013 whose tidal levels of open boundary condition are derived from the global ocean tide model nao99 matsumoto et al 2000 with eight tidal constituents m2 s2 n2 k2 k1 o1 q1 p1 the inner model is set up by fvcom a three dimensional primitive equation unstructured grid finite volume ocean model developed by the university of massachusetts in the united states which can simulate complex estuarine areas with varied topography and water depth well chen et al 2003 four vertical layers are used in the model and the grid has various resolutions from 80 m around the coastline of the estuary to 5 km over the deep ocean considering that three dimensional simulations are computationally intensive the original wind drag coefficient c d s is calculated with eq 1 1 c d s 0 0012 if u 10 11 m s 1 10 3 0 49 0 065 u 10 if u 10 11 m s 1 10 3 0 49 0 065 25 if u 10 25 m s 1 where u 10 is the wind velocity at a height of 10 m above the sea surface for the bottom friction coefficient c d b 2 c d b max k 2 i n z z 0 b 2 0 0025 where k 0 4 is the von karman constant z 0 b is the bottom roughness parameter in meters and the value recommend is 0 001 in the ocean 2 2 flux condition the river boundary of the numerical model of storm surge is set at datong station anhui province of china the tidal limit of the yangtze river the flux of the yangtze river at the lower reaches is fairly controllable and stable after the three gorges dam works in 2003 even though typhoons are always accompanied with wide range rainstorms taking the flux during the landfall of typhoon ample as an example the average absolute error of actual flux from 10 july 2018 to 25 july 2018 is 2 7 to the average flow of 45 362 m3 s in datong station consequently the average flow is reasonable to represent the continuously changing flows during storms in the numerical surge model 2 3 meteorological forcing a combined typhoon wind field of reanalysis background wind product and analytical cyclone model is adopted to drive the storm surge model the reanalysis background wind products were extracted from the era interim dataset of ecmwf european centre for medium range weather forecasts http apps ecmwf int datasets data interim full daily levtype sfc the observations of typhoon track records were obtained from the cma sti best track dataset institute of the china meteorological administration http tcdata typhoon org cn zjljsjj zlhq html ying et al 2014 within the scope of hundreds of kilometers near the center of a storm the precision of the background wind field is not high enough to drive the storm surge model not only for the lower wind speed and air pressure deficit near the center but also for the erroneous location of typhoon eye in some cases consequently the method of wind field shift is utilized for a more accurate position of the typhoon center pan et al 2016 and an empirical cyclone model holland 1980 to enlarge the wind speed in the scope of hundreds of kilometers around the center of a typhoon with 3 v g b ρ α r max r p p 0 b e r max r b 0 5 r f 2 where v g is the gradient wind speed at radius r ρ α 1 15 k g m 3 is the air density f 2 ω sin ϕ is the coriolis coefficient ω 7 272 10 5 r a d s is the earth s rotational angular speed ϕ is the latitude p is the ambient pressure and p 0 is the central pressure r max is the radius of maximum winds b is a scaling parameter introduced by holland the radius of maximum winds r max usually tens of kilometers is calculated by this formulation proposed by graham and nunn 1959 4 r max 28 52 tanh 0 0873 ϕ 28 12 22 e p 0 1013 2 33 86 0 2 v 37 22 where v is the forward speed of a typhoon in kilometers the combined wind field can be reconstructed by the following method 5 v c 1 e v m e v q where v m is the empirical cyclone model v q is the reanalysis wind e is a weight factor to ensure a smooth transition between the two wind fields iii and elsberry 1997 6 e c 4 1 c 4 c r 10 r max 2 4 hypothesis of the influenced sphere of the yangtze estuary an average of thirty four tropical cyclones occur in the western pacific each year while only two or three of particular tracks of them may cause serve storm surge in the yangtze estuary the characteristics of such tracks and corresponding variations of the wind fields need to be thoroughly investigated before the study on surge it is no doubt the distance between the study area and a typhoon is a crucial indicator for surge and a closer track may induce larger surge to some extent there are currently no good indicators for evaluating the impact of tropical cyclones on regional scale areas like estuaries considering the structure of a typhoon is approximately circular in the horizontal plane a hypothesis of the influenced sphere of the yangtze estuary isye is thus proposed where the yangtze estuary is simplified as a center point 122 e 31 5 n and the influenced sphere is a circular area whose radius is eight times the radius of the maximum wind speed about 400 km which is a conservative threshold based on history observed surge datum shown in table 1 tracks that are tangent to or intersect the circle are deemed to cause potential surge damage in the yangtze estuary while the rest tracks are not taken into consideration and an indicator regional accumulated cyclone energy race which takes accumulated cyclone energy ace as a reference bell et al 2000 considering the frequency of typhoons the effect of storm size the duration and distance between storm center and the target area is raised herein to assess the influence of typhoons and storm surge on regional scale areas based on the hypothesis of isye each year 7 r a c e i 1 n v i 2 c i where n is the total number of records of the 6 hourly track of typhoons within the scope of isye each year v i is the maximum wind speed of the record point i c i min r i d i 1 is a controlling parameter where r i and d i are the radius of maximum winds and the distance from the simplified center point respectively the yangtze estuary has been attacked frequently by tropical cyclones in recent years fig 1 shows the proposed hypothesis of the isye and typhoons impacting the estuary the influence of tropical cyclones on the yangtze estuary shows a slightly positive linear trend along time by trend analysis of the regional accumulated cyclone energy race from a short term perspective we could observe a higher impact than the average from 1976 to 1991 while a relatively lower and stable impact from 1992 to 2018 however an obvious rising trend in recent years can be detected since 2008 and the index race of 2012 and 2018 reaches its peaks of the last twenty years fig 2 consequently it is inevitable to have a thorough investigation of typhoons and the surges in the yangtze estuary 2 5 typhoon scenarios construction previous studies on peak surge and scenario construction have some shortcomings first the extreme tracks are often constructed from a statistical point of view rather than the mechanism of formation and growth of surge second model verification may not be sufficient enough in the inner wind field prototype typhoons used for model verification are often far away from the study area and the corresponding gauge stations making a good verification of surge induced by the external wind field while lacking verification relating to the inner wind field however the ideal typhoon tracks are often designed to be close to the target area making the inner wind field more significant where the wind speed and direction change drastically in time and space the position of a tropical cyclone is continuously changing in its lifetime as well as the wind speed and direction making it difficult to be estimated over the nearshore areas meanwhile storm surge nearshore is more sensitive to wind direction and its duration besides the intensity based on the hypothesis of the isye there are one hundred and sixty typhoons deemed to have influence on the yangtze estuary in the last seventy years from 1949 to 2018 the cyclone data of which are all that cma has observed so far in the western pacific ocean and two categories of typhoon tracks can be generalized from the perspective of landing or not and the variation of wind direction the direct landing typhoon dlt and the offshore northward typhoon ont dlt is the typhoons that directly make landfall on the coastal areas around the yangtze estuary and ont is offshore typhoons that move northward the former accounts for 57 9 percent of the total typhoons influencing the yangtze estuary while the latter accounts for 42 1 percent typical track of dlt with the approach angle in the same direction as the south branch of the yangtze estuary approximately 296 is raised as a prototype to construct ideal tracks the wind vector azimuth is the direction towards which the wind is blowing it also increases clockwise from north when viewed from above in fig 3 the first three subplots show the three tracks landing on the south the mid and the north of the yangtze estuary respectively the violent changes of wind vector azimuth controlling this area can almost cover all orientations as typhoons transform along the typical tracks of dlt within isye in fig 3 a angle 1 denotes the variation of wind vector azimuth from 206 to 26 as the storm center transforms from point a to b taking the role of promoting storm surge within isye in contrast angle 2 in fig 3 c ranging from 26 to 206 takes a negative role in storm surge as the track s distance to the yangtze estuary grows larger in fig 3 a and 3 c angle 1 and angle 2 would become smaller from both edges to the diagonal maintaining their contributions of promotion to surge for example track1 is the farer version of track1 and angle 1 and angle 1 are the corresponding range of wind vector azimuth respectively winds over the yangtze estuary reverse direction as the eye of a typhoon passing the center of the estuary which is shown by the two arrows in fig 3 b it can be argued that typhoons landing on the south of the estuary may cause larger surges than the rest two tracks of dlt table 1 presents the wind intensity surge height and the distance of each typhoon event between its track and the center of the yangtze estuary surges induced by typhoons making landfall on the south of the estuary dlt s are larger than that landing on the north dlt n which is in agreement with our analysis meanwhile the translation wind field of the three tracks causes storm currents to flow into the estuary with the wind vector azimuth of 296 inducing extensive accumulations of water in the whole estuary the translation wind field of tracks with other approach angles only contributes partly to inducing surges in the yangtze estuary with its components in fig 3 d wind vector azimuth varies from 270 180 angle 3 which is conducive to surge to 180 90 angle 4 which is negative to surge after the eye of a typhoon passes the central axis of the yangtze estuary table 1 indicates that surge height is sensitive to the distance between the track of typhoons and the center of the yangtze estuary under the same intensity for example tc0205 and tc1109 based on the analysis above the typhoon ampil no 1810 is the best track to be a reference to study dlt with only little amendment of the record point location after its landfall on chongming island the center of the yangtze estuary seven derived parallels with the adjacent distance of 48 km approximately the radius of the maximum wind speed are s4 to s7 for the sort landing on the south s3 for the sort landing on the center of the yangtze estuary and s1 and s2 for the sort landing on the north all the other track information remains unchanged except for its translational location ont is studied by the reference of kong rey no 1825 which is one of the common tracks parallel to the shoreline of the yangtze estuary the adjacent distance of the five derived parallel tracks o1 o5 is 48 km of which o1 is on the east side of chongming island fig 4 2 6 influence of storm timing storm timing is also an important component contributing to water level rise due to the interaction of surge and astronomical tide which is especially notable in shallow waters and where the tidal range is large as salek and yasuda 2001 sinha et al 2008 zhang et al 2004 typhoons with different landfall time can have vast differences in surge levels based on the typhoon scenario construction and the numerical simulation tracks that may cause extreme surge and time of extreme surge tes can be figured out for the two kinds of tracks dlt and ont and in each station the influence of storm timing can be studied by changing the timing of the typhoon to make tes coincide with multiple phases of the tides five scenarios of tidal amplitude ranging from 2 8 m to 4 6m by 0 4 m are adopted to study the influence of tidal range on surge levels taking zhongjun station as a reference station more than 180 cases of numerical simulations are run in the study to make tes coincide with all the phases of a tidal cycle in each station the intensity of ont is adjusted to be the same as that of dlt in the study of storm timing fig 5 shows the five characteristic tidal levels a and e are the low tide b and d are the rising mid tide and the falling mid tide respectively c denotes the highest astronomical tide of 2018 the exact time of which is 15 00 24 september 2018 3 results and discussion 3 1 model calibration the yangtze estuary is divided into three main parts of the upper estuary the inner estuary and the outer estuary on the grounds of the geographical and physical setting which is shown in fig 6 so well as the eleven tidal gauge stations overspreading the estuary chongtou station and its upstream is the upper estuary lianxing station and its downstream is the outer estuary the rest stream segment from chongtou station to lianxing station is the inner estuary the measured storm surge during typhoon winnie no 9711 and ampil no 1810 are compared directly with the model output in terms of the root mean square error rmse 8 r m s e i n η m e a s u r e d i η mod e l i 2 n 9 r m s e i n η m e a s u r e d i η mod e l i 2 n max η m e a s u r e d 100 where η m e a s u r e d is the measured storm surge η mod el is the simulated storm surge n is the total number of data in each compared time series the probability density function agreement of their values is assessed by applying the kolmogorov smirnov test k s with a 5 significance level the model reproduces the observed water levels well for the control period the bulk of the gauge stations in the yangtze estuary are characterized by absolute rmse values below 0 20 m during typhoon winnie while rmse 0 20 m are observed in luchao station fig 7 a the validation of storm surge seems to be better during typhoon ampil with rmse values of most stations below 0 10 m except for beicaodong station fig 7 b in fact the model performance ensemble of the two storm surges is roughly at the same level in rmse as the surge height of the former one is almost double the latter besides calibration of the simulation during both two typhoons shows a downtrend in the rsme values upper stream q q plots reveal the model is capable of reproducing the probability distribution function of the measured storm surge the black dots in fig 7 the model overestimated the higher values slightly while the opposite is also found among lower values at some locations which may be on account of the coarse atmospheric forcing and numerical grids however the model is thought to be satisfactory in simulating storm surge within the scope of the study on the influence of typhoon track and storm timing in the yangtze estuary rather than providing accurate operational forecasts this is also confirmed by the results of the kolmogorov smirnov test with a 5 significance level in fig 7 3 2 surge affected by dlt the track s relative position to the yangtze estuary can significantly influence the surge magnitude fig 8 compares the peak surges peak negative surges of the seven storm tracks of dlt the maximum surges of all gauge stations in the yangtze estuary except for lianxing station are induced by track s5 which is at the distance of 2 r max from the center of the yangtze estuary debunking a misconception that the closer track may cause higher surge to the target spot the peak surge of track s5 is found smaller than that of track s3 and s4 in lianxing station the coastline near which is approximately perpendicular to the typhoon track storm currents induced by typhoon translation wind field crash into the bank inducing energy and volume concentration at locations along the coast peak surge of typhoons landing on the north side of the yangtze estuary for example track s1 and s2 is smaller than that landing on the south side and the main process of water level change is negative surge fig 8b which is in good agreement with the results of the wind direction analysis in chap 2 5 the magnitude of the storm surge shows an increasing trend from downstream to upstream in tracks landing on the south side and reaches 3 0 m qinglong station track s5 surge levels are abnormally low in beicaozhong station for its location in the open waters and dikes nearby can hardly influence flooding as they are usually submerged when the storm surge occurs fig 9 storm surge induced by dlt overspreads the whole estuary and reaches its maximum in the upper estuary which indicates that nantong and zhangjiagang of jiangsu province is under great threat of submersion 3 3 surge affected by ont peak surge induced by ont is sensitive to the track offshore distance in the yangtze estuary there is an obvious process of water level rise as well as water level decline when the storm center transforms over the central axis of the yangtze estuary making a short duration of storm surge fig 10 compares the peak surge peak negative surge of the five storm tracks of ont the maximum surges of all gauge stations in the yangtze estuary show a trend that the closer track can induce a higher level of storm surge both peak surge and peak negative surge are induced by track o1 table 2 demonstrates the attenuation of peak surge with the increasing offshore distance of tracks taking the extreme peak surge of o1 as a reference surge level induced by track o2 o3 and o4 with the offshore distance of r max 2 r max and 3 r max are approximately 52 21 and 11 the surge magnitude of o1 respectively the peak surge reduces by approximately 50 as its distance from the yangtze estuary increases by r max within the range of 3 r max complex shelf morphology has great impacts on the surge distributions fig 11 shows that storm surge disasters induced by ont are mainly distributed over the inner estuary and the south banks of both branches suffer huge risk of surge damage due to the sustained onshore winds inducing extreme surges of 4 0 m in the north branch and 2 2m in the south branch respectively xinzheng village and loujiang estuary have eastward geometry with broad entrance prone to promoting accumulations of water induced by westward wind and currents when the eye of a typhoon like ont approaches the axis of the estuary however the shift of the typhoon eye makes a fast surge pattern transform from water set up to water set down the high risk region shanghai especially chongming island is under great threat of submersion due to surge induced by tracks of ont 3 4 surge affected by storm timing peak surges of dlt and ont make responses in the same pattern to the variation of tidal stages fig 12 reveals that surge levels in the flood period are higher than that in the falling period as tes coinciding with the same water level in the major stations surge levels of dlt ont as tes coinciding with the falling mid tide are smaller than that of the rising mid tide by 41 2 64 3 this is contrary to the previous studies that falling tide tends to increase surge level whereas rising tide attenuates surge level lin et al 2012 rego and li 2010 we further extracted surges of the whole tidal cycle for the 5 different sizes of tidal range and got the similar tendency that the rising tide increases surge level in the yangtze estuary fig 13 this can be explained by the effect of tidal wave transformation by the interaction of surge and tide surge tide interaction can affect the magnitude and arrival time of the peak water levels and consequently the surge threat fig 13 also shows that the data amount of surges in the rising stage is less than that in the falling stage implying that the period of rising tide is shorter than that of falling tide during a storm event the cause of tidal wave transformation is the combined effect of riverine topography and the bottom friction in the estuary which would be aggravated by surge a clear phase advance a little phase delay can be found in fig 14 a fig 14b as tes coinciding with the phase of several hours before after the high tide compared to the falling period the steeper curve of the tidal wave of the rising period is more vulnerable to phase shift and will thus induce larger surge level it is of more practical significance to investigate the surge near peak storm levels feng et al 2016 showed two types of semidiurnal surges with different causes of generation in this study we considered the total surge level as the combination of surge due to phase shift lag surge and surge due to local modification local surge as shown in fig 14c the peak water level difference between the storm tide and astronomical tide is the local surge the blue part the total surge value at the high storm tidal level minus the local surge is the lag surge the magenta part fig 15 shows that the lag surge of the rising period contributes more to the total surge at the highest storm tidal level compared to the falling period and it increases as the time lag grows larger and reaches 60 of the total surge level for tracks of dlt however the tidal range seems to have limited effect on the proportion of the lag surge for tracks of ont the tendency is the same not shown the phase shifts during a storm event are easily explained in terms of changes in phase speed on the one hand since both tides and surges to first order are shallow water waves with phase speeds of gh 1 2 where h is the total water depth and g is the acceleration due to gravity positive surge would increase the total water depth relative to the astronomical tidal level resulting in an increased phase speed both directly and because of the effects of bottom friction which is inversely proportional to depth this is consistent with horsburgh and wilson 2007 that the positive surge would advance the tide by enhancing the phase speed of the tidal wave while a negative surge would retard tidal propagation on the other hand the flood current would play a positive role in phase speed as water particles flow into the estuary and vice versa of the falling current it is supported by hu et al 2012 that the propagating velocity of unsteady open channel flows can be expressed by the sum of flow velocity and wave velocity at wave peak 10 c 0 g h u g h q b h where h is a certain characteristic water depth u is a certain characteristic velocity of flow h and q are respectively the water depth and discharge corresponding to u and b is the width of the flume it is therefore concluded that the storm tide is accelerated by the interaction of surge and tide as it propagates from the open sea into the yangtze estuary resulting in a phase advance which clarifies the phenomenon that rising tide increases surge level while falling tide attenuates surge level our results are also confirmed by previous findings in the literature as salek and yasuda 2001 that larger surge would be produced as cyclones make landfall before the high tide fig 12a shows a downward trend of peak surge of dlt in the bulk stations when tes coincides with a higher tidal level the tendency can be explained as shallower water is more conducive to the growth of storm surges surge level and depth are inversely related given the same condition of other factors and can be supported by the study of resio and westerink 2008 while fig 12b shows the opposite tendency of peak surge for ont an uptrend of peak surge of ont is detected when tes coincides with a higher tidal level the phenomenon can be explained by the combined effect of the runoff and the particular track of ont as mentioned in section 2 5 the prevailing wind direction would play a positive role on surge as a storm approaches the yangtze estuary and a negative role after the center of a storm passes the central axis of the estuary and the transformation is a very short duration of about 6 h fig 15 shows the distribution of surge as the storm approaches a b and c and then leaves d the estuary in the case of tes coinciding with the low tide the storm coincides with the combined effect of strong ebb current and the runoff inducing peak surge in the outer estuary while in the inner and upper estuary the main surge process is a slight water set up or even water set down the position of peak surge changed northward rapidly outside the estuary with the translation of the storm and can hardly propagate into the estuary fig 16 the major selected tidal gauge stations are inside the estuary and thus can not capture the peak surge variation outside near low tide that is why the peak surge at low tide small depth is smaller than at high tide from the results of cases of dlt and ont it is also found to be significant that in most circumstances the peak surge levels are smaller than that of the surge only case tidal amplitude 0 especially in the inner and upper estuarine areas fig 12 such a tendency is enhanced when the tidal range is large this is contrary to the previous study kim et al 2008 while partly supported by the study of horsburgh and wilson 2007 that increasing tidal range appears to reduce surge peaks arriving near high water fig 17 compared the water level between cases of the astronomical tide and no tide tidal amplitude 0 it is found that the total water depth grew larger in the inner and upper estuarine areas under the effect of astronomical tide relative to the no tide case thus it is no wonder why the larger tidal range which means deeper water in the estuary attenuates surge level 4 conclusions in this investigation a new method of typhoon scenario construction is proposed to study the storm surge responses to tracks and storm timing by simulating the coupling procedure of astronomical tides storm surge and runoff in the yangtze estuary the model reproduces the observed water levels during the two actual typhoon processes well two typical typhoon tracks the direct landing typhoon dlt and the offshore northward typhoon ont are studied and a new indicator the regional accumulated cyclone energy is raised to assess the impact of cyclones on regional scale areas for tracks of dlt track 2 r max south to the estuary center is detected to induce extreme surges s5 the upper stream clarifies greater surges reaching its maximum of 3 0 m in qinglong station dlt pushes more water into the estuary causing larger scope and longer duration of storm flooding and is most threatening to the upper estuary especially the nearshore areas of nantong and suzhou for tracks of ont a r max farther track to the estuary can result in half attenuation on storm surges within the distance of 3 r max the maximum surge is induced by track o1 and observed as large as 4 0 m in an eastward notch on chongming island surge distribution of ont is the most detrimental to the inner estuary while with a shorter duration mainly affecting the nearshore areas of shanghai our findings reveal that the rising tide increases surge level whereas the falling tide attenuates surge level in the estuary the rising tide curve of the tidal wave is steeper and thus more vulnerable to the phase shift especially to the phase advance a phase advance is usually the result of the acceleration of phase speed which is triggered by the surge tide interaction and the flood current consequently the peak surge occurs in the rising tide the analysis of surge distribution of ont reveals that the position of peak surge would transfer outside the estuary as tes coincides with the low tide the main surge process is a slight water set up or even water set down inside the estuary this can well explain why peak surges are abnormally small near the low tide compared to that near the high tide in the estuary further the larger tidal range is found to attenuate surge level in the inner and upper estuarine areas due to the enhanced water depth credit authorship contribution statement chengtuan yin conceptualization software writing original draft weisheng zhang data curation methodology mengjie xiong writing review editing jinhua wang software caiyang zhou data curation xiping dou supervision jinshan zhang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the work was financially supported by the national key research and development program of china no 2018yfc0407502 
20645,the study explores storm floods in the yangtze estuary to examine the surge responses to the variation of storm tracks and storm timing under the combined effect of astronomical tides storm surge and runoff a new method of typhoon scenario construction is developed based on a hypothesis of the influenced sphere of the yangtze estuary isye raised in the paper and two representative typhoon tracks the direct landing typhoon dlt and the offshore northward typhoon ont are studied by the worst cases with five scenarios of tidal range using fvcom the result shows that the surge threats of dlt and ont concentrate on the upper estuary and inner estuary respectively the phase shift due to the acceleration of phase speed resulting from the surge tide interaction and the flood current is proposed to be the primary factor increasing surge in the rising tide a transfer of the peak surge position is detected outside the estuary which can well explain the abnormally small surge near the low tide further the larger tidal range tends to attenuate surge levels due to the enhanced depth in the inner and upper estuarine areas keywords storm surge tracks storm timing tide surge interaction the yangtze estuary fvcom 1 introduction storm flooding is a major geophysical threat in the estuary and coastal areas associated with seawall damage and heavy inundation lewis et al 2013 yin et al 2016 zhang and pan 2014 corresponding to the trend of climate warming especially the warmer sea surface ji et al 2018 2019 zhang et al 2018 is expected to increase the average intensity of typhoons by an additional 14 over the northwestern pacific by 2100 mei et al 2015 the cumulative direct economic loss caused by typhoons and storm surges reaches 30 4 billion in the range 2000 2019 according to the ministry of natural resources of the people s republic of china http www mnr gov cn ranking first in all marine disasters in particular the yangtze estuary is trumpet shaped with complex topography in a low lying plain making it vulnerable to sea level variation induced by tropical cyclones the yangtze estuary has been attacked by typhoons frequently in recent years pan and liu 2020 especially in 2018 six typhoons exacerbated adverse effects on its low lying areas storm surge is a complex atmosphere ocean coupled process it is widely concerned that the estimated maximum wind speed is a vital indicator of storm damage berke et al 1984 cyriac et al 2018 the magnitude of storm surge varies with the variation of storm intensity dietrich et al 2018 maximum wind speed error exceeding 20 may cause significant errors in storm surge simulations torres et al 2019 storm size is usually a factor of less focus powell and reinhold 2007 presented a new approach of hurricane damage assessment from a perspective of energy over the entire storm considering the influence of storm size simulated storm surge is found to increase with storm size especially on mildly sloping bottoms and for strong storms irish 2008 storm track is crucial for simulated storm surge which relies heavily on the two determining factors of wind direction and wind duration three components landfall location approach angle and approach speed are studied instead as storm track can hardly be quantified landfall location change has great effects on storm surges of storms with the same intensity sun et al 2015 torres et al 2015 the study on tampa bay shows that typhoons making landfall to the north of the bay mouth can cause larger storm surges than that at or to the south of the bay mouth weisberg and zheng 2006 variations of landfall location can even change the state of surges in the study area a transformation from set up processes to mainly set down processes zhang et al 2018 the study of weisberg and zheng 2006 indicates that the shift in storm approach angles can result in increasing overall storm surge irish 2008 has found that tracks perpendicular to the shoreline tends to produce larger surge than tracks with more oblique approach angles on average by 8 a storm with higher approach speed can result in smaller storm surges li et al 2014 as a certain amount of time is required to build the surface slope by transporting water weisberg and zheng 2006 the 50 slower approach speed in simulation has a decrease in flooding along the open coast while results in larger surges in the estuaries and floodplains along the south atlantic bight thomas et al 2019 meanwhile surge levels can be amplified strikingly by particular storm tracks owing to seiche mori et al 2014 takayabu et al 2015 nearshore topography also contributes significantly to the uncertainty of the storm surge prediction and disaster storm flood is a very localized phenomenon in the light of the storm attributes related to the regional geometry weisberg and zheng 2006 high risk regions are usually the waters with two more barriers a hood shaped or bottle shaped geometry with a broad entrance is likely to induce large storm surges zhang et al 2018 sea level rise is also considered as a crucial factor of storm surge study while the result varies predicted storm surge showed an increasing trend along the coast of the uk and ireland due to the projected relative sea level rise rslr brown et al 2010 2012 lowe et al 2009 and can be enforced which exceeds 30 of the rslr along europe coast vousdoukas et al 2016 while storm surge attenuation is likely to occur where depth changes are relatively large due to the sea level rise arns et al 2015 sea level rise is a pressing but uncertain concern about storm surge and inundation to these coastal areas especially within a long enough time frame as is one of the most discussed aspects of climate change woodworth et al 2011 in conclusion all the key factors mentioned above the storm size the landfall location and the approach angle tell the fact that apart from the intensity the direction of the wind on the target waters is a determinate indicator of storm surge while hard to catch since the wind direction is constantly changing as a typhoon moves heretofore many researchers have tried to study the influence of tracks on storm surges with chiefly two scenario constructing methods of storm tracks some paid more attention to the violent storms the tracks of which are considered as standard ones and then the hypothetical typhoon tracks were constructed by a small distance of translation or a small angle of rotation sebastian et al 2019 wang et al 2018 others studied storm surge by treating tracks as a set of parallels with particular angles and certain intensity zhang et al 2018 the study aims to examine the responses of complex terrain to the variation of storm tracks and storm timing with a new method of typhoon scenario construction to investigate the worst case a hypothesis of the influenced sphere of the yangtze estuary was raised and based on it and the features of historical typhoon tracks a new typhoon scenario construction method was proposed describing the function of the direction of prevailing wind controlling the area the study also provides a reference for similar coastal hazards impacts on the estuarine regions 2 materials and methods 2 1 model description a high resolution three domain model nested with a two dimensional numerical model is established to study the influence of the storm surge coupled with run off and astronomical tide the outer model is the numerical model of the northwest pacific zhang et al 2013 whose tidal levels of open boundary condition are derived from the global ocean tide model nao99 matsumoto et al 2000 with eight tidal constituents m2 s2 n2 k2 k1 o1 q1 p1 the inner model is set up by fvcom a three dimensional primitive equation unstructured grid finite volume ocean model developed by the university of massachusetts in the united states which can simulate complex estuarine areas with varied topography and water depth well chen et al 2003 four vertical layers are used in the model and the grid has various resolutions from 80 m around the coastline of the estuary to 5 km over the deep ocean considering that three dimensional simulations are computationally intensive the original wind drag coefficient c d s is calculated with eq 1 1 c d s 0 0012 if u 10 11 m s 1 10 3 0 49 0 065 u 10 if u 10 11 m s 1 10 3 0 49 0 065 25 if u 10 25 m s 1 where u 10 is the wind velocity at a height of 10 m above the sea surface for the bottom friction coefficient c d b 2 c d b max k 2 i n z z 0 b 2 0 0025 where k 0 4 is the von karman constant z 0 b is the bottom roughness parameter in meters and the value recommend is 0 001 in the ocean 2 2 flux condition the river boundary of the numerical model of storm surge is set at datong station anhui province of china the tidal limit of the yangtze river the flux of the yangtze river at the lower reaches is fairly controllable and stable after the three gorges dam works in 2003 even though typhoons are always accompanied with wide range rainstorms taking the flux during the landfall of typhoon ample as an example the average absolute error of actual flux from 10 july 2018 to 25 july 2018 is 2 7 to the average flow of 45 362 m3 s in datong station consequently the average flow is reasonable to represent the continuously changing flows during storms in the numerical surge model 2 3 meteorological forcing a combined typhoon wind field of reanalysis background wind product and analytical cyclone model is adopted to drive the storm surge model the reanalysis background wind products were extracted from the era interim dataset of ecmwf european centre for medium range weather forecasts http apps ecmwf int datasets data interim full daily levtype sfc the observations of typhoon track records were obtained from the cma sti best track dataset institute of the china meteorological administration http tcdata typhoon org cn zjljsjj zlhq html ying et al 2014 within the scope of hundreds of kilometers near the center of a storm the precision of the background wind field is not high enough to drive the storm surge model not only for the lower wind speed and air pressure deficit near the center but also for the erroneous location of typhoon eye in some cases consequently the method of wind field shift is utilized for a more accurate position of the typhoon center pan et al 2016 and an empirical cyclone model holland 1980 to enlarge the wind speed in the scope of hundreds of kilometers around the center of a typhoon with 3 v g b ρ α r max r p p 0 b e r max r b 0 5 r f 2 where v g is the gradient wind speed at radius r ρ α 1 15 k g m 3 is the air density f 2 ω sin ϕ is the coriolis coefficient ω 7 272 10 5 r a d s is the earth s rotational angular speed ϕ is the latitude p is the ambient pressure and p 0 is the central pressure r max is the radius of maximum winds b is a scaling parameter introduced by holland the radius of maximum winds r max usually tens of kilometers is calculated by this formulation proposed by graham and nunn 1959 4 r max 28 52 tanh 0 0873 ϕ 28 12 22 e p 0 1013 2 33 86 0 2 v 37 22 where v is the forward speed of a typhoon in kilometers the combined wind field can be reconstructed by the following method 5 v c 1 e v m e v q where v m is the empirical cyclone model v q is the reanalysis wind e is a weight factor to ensure a smooth transition between the two wind fields iii and elsberry 1997 6 e c 4 1 c 4 c r 10 r max 2 4 hypothesis of the influenced sphere of the yangtze estuary an average of thirty four tropical cyclones occur in the western pacific each year while only two or three of particular tracks of them may cause serve storm surge in the yangtze estuary the characteristics of such tracks and corresponding variations of the wind fields need to be thoroughly investigated before the study on surge it is no doubt the distance between the study area and a typhoon is a crucial indicator for surge and a closer track may induce larger surge to some extent there are currently no good indicators for evaluating the impact of tropical cyclones on regional scale areas like estuaries considering the structure of a typhoon is approximately circular in the horizontal plane a hypothesis of the influenced sphere of the yangtze estuary isye is thus proposed where the yangtze estuary is simplified as a center point 122 e 31 5 n and the influenced sphere is a circular area whose radius is eight times the radius of the maximum wind speed about 400 km which is a conservative threshold based on history observed surge datum shown in table 1 tracks that are tangent to or intersect the circle are deemed to cause potential surge damage in the yangtze estuary while the rest tracks are not taken into consideration and an indicator regional accumulated cyclone energy race which takes accumulated cyclone energy ace as a reference bell et al 2000 considering the frequency of typhoons the effect of storm size the duration and distance between storm center and the target area is raised herein to assess the influence of typhoons and storm surge on regional scale areas based on the hypothesis of isye each year 7 r a c e i 1 n v i 2 c i where n is the total number of records of the 6 hourly track of typhoons within the scope of isye each year v i is the maximum wind speed of the record point i c i min r i d i 1 is a controlling parameter where r i and d i are the radius of maximum winds and the distance from the simplified center point respectively the yangtze estuary has been attacked frequently by tropical cyclones in recent years fig 1 shows the proposed hypothesis of the isye and typhoons impacting the estuary the influence of tropical cyclones on the yangtze estuary shows a slightly positive linear trend along time by trend analysis of the regional accumulated cyclone energy race from a short term perspective we could observe a higher impact than the average from 1976 to 1991 while a relatively lower and stable impact from 1992 to 2018 however an obvious rising trend in recent years can be detected since 2008 and the index race of 2012 and 2018 reaches its peaks of the last twenty years fig 2 consequently it is inevitable to have a thorough investigation of typhoons and the surges in the yangtze estuary 2 5 typhoon scenarios construction previous studies on peak surge and scenario construction have some shortcomings first the extreme tracks are often constructed from a statistical point of view rather than the mechanism of formation and growth of surge second model verification may not be sufficient enough in the inner wind field prototype typhoons used for model verification are often far away from the study area and the corresponding gauge stations making a good verification of surge induced by the external wind field while lacking verification relating to the inner wind field however the ideal typhoon tracks are often designed to be close to the target area making the inner wind field more significant where the wind speed and direction change drastically in time and space the position of a tropical cyclone is continuously changing in its lifetime as well as the wind speed and direction making it difficult to be estimated over the nearshore areas meanwhile storm surge nearshore is more sensitive to wind direction and its duration besides the intensity based on the hypothesis of the isye there are one hundred and sixty typhoons deemed to have influence on the yangtze estuary in the last seventy years from 1949 to 2018 the cyclone data of which are all that cma has observed so far in the western pacific ocean and two categories of typhoon tracks can be generalized from the perspective of landing or not and the variation of wind direction the direct landing typhoon dlt and the offshore northward typhoon ont dlt is the typhoons that directly make landfall on the coastal areas around the yangtze estuary and ont is offshore typhoons that move northward the former accounts for 57 9 percent of the total typhoons influencing the yangtze estuary while the latter accounts for 42 1 percent typical track of dlt with the approach angle in the same direction as the south branch of the yangtze estuary approximately 296 is raised as a prototype to construct ideal tracks the wind vector azimuth is the direction towards which the wind is blowing it also increases clockwise from north when viewed from above in fig 3 the first three subplots show the three tracks landing on the south the mid and the north of the yangtze estuary respectively the violent changes of wind vector azimuth controlling this area can almost cover all orientations as typhoons transform along the typical tracks of dlt within isye in fig 3 a angle 1 denotes the variation of wind vector azimuth from 206 to 26 as the storm center transforms from point a to b taking the role of promoting storm surge within isye in contrast angle 2 in fig 3 c ranging from 26 to 206 takes a negative role in storm surge as the track s distance to the yangtze estuary grows larger in fig 3 a and 3 c angle 1 and angle 2 would become smaller from both edges to the diagonal maintaining their contributions of promotion to surge for example track1 is the farer version of track1 and angle 1 and angle 1 are the corresponding range of wind vector azimuth respectively winds over the yangtze estuary reverse direction as the eye of a typhoon passing the center of the estuary which is shown by the two arrows in fig 3 b it can be argued that typhoons landing on the south of the estuary may cause larger surges than the rest two tracks of dlt table 1 presents the wind intensity surge height and the distance of each typhoon event between its track and the center of the yangtze estuary surges induced by typhoons making landfall on the south of the estuary dlt s are larger than that landing on the north dlt n which is in agreement with our analysis meanwhile the translation wind field of the three tracks causes storm currents to flow into the estuary with the wind vector azimuth of 296 inducing extensive accumulations of water in the whole estuary the translation wind field of tracks with other approach angles only contributes partly to inducing surges in the yangtze estuary with its components in fig 3 d wind vector azimuth varies from 270 180 angle 3 which is conducive to surge to 180 90 angle 4 which is negative to surge after the eye of a typhoon passes the central axis of the yangtze estuary table 1 indicates that surge height is sensitive to the distance between the track of typhoons and the center of the yangtze estuary under the same intensity for example tc0205 and tc1109 based on the analysis above the typhoon ampil no 1810 is the best track to be a reference to study dlt with only little amendment of the record point location after its landfall on chongming island the center of the yangtze estuary seven derived parallels with the adjacent distance of 48 km approximately the radius of the maximum wind speed are s4 to s7 for the sort landing on the south s3 for the sort landing on the center of the yangtze estuary and s1 and s2 for the sort landing on the north all the other track information remains unchanged except for its translational location ont is studied by the reference of kong rey no 1825 which is one of the common tracks parallel to the shoreline of the yangtze estuary the adjacent distance of the five derived parallel tracks o1 o5 is 48 km of which o1 is on the east side of chongming island fig 4 2 6 influence of storm timing storm timing is also an important component contributing to water level rise due to the interaction of surge and astronomical tide which is especially notable in shallow waters and where the tidal range is large as salek and yasuda 2001 sinha et al 2008 zhang et al 2004 typhoons with different landfall time can have vast differences in surge levels based on the typhoon scenario construction and the numerical simulation tracks that may cause extreme surge and time of extreme surge tes can be figured out for the two kinds of tracks dlt and ont and in each station the influence of storm timing can be studied by changing the timing of the typhoon to make tes coincide with multiple phases of the tides five scenarios of tidal amplitude ranging from 2 8 m to 4 6m by 0 4 m are adopted to study the influence of tidal range on surge levels taking zhongjun station as a reference station more than 180 cases of numerical simulations are run in the study to make tes coincide with all the phases of a tidal cycle in each station the intensity of ont is adjusted to be the same as that of dlt in the study of storm timing fig 5 shows the five characteristic tidal levels a and e are the low tide b and d are the rising mid tide and the falling mid tide respectively c denotes the highest astronomical tide of 2018 the exact time of which is 15 00 24 september 2018 3 results and discussion 3 1 model calibration the yangtze estuary is divided into three main parts of the upper estuary the inner estuary and the outer estuary on the grounds of the geographical and physical setting which is shown in fig 6 so well as the eleven tidal gauge stations overspreading the estuary chongtou station and its upstream is the upper estuary lianxing station and its downstream is the outer estuary the rest stream segment from chongtou station to lianxing station is the inner estuary the measured storm surge during typhoon winnie no 9711 and ampil no 1810 are compared directly with the model output in terms of the root mean square error rmse 8 r m s e i n η m e a s u r e d i η mod e l i 2 n 9 r m s e i n η m e a s u r e d i η mod e l i 2 n max η m e a s u r e d 100 where η m e a s u r e d is the measured storm surge η mod el is the simulated storm surge n is the total number of data in each compared time series the probability density function agreement of their values is assessed by applying the kolmogorov smirnov test k s with a 5 significance level the model reproduces the observed water levels well for the control period the bulk of the gauge stations in the yangtze estuary are characterized by absolute rmse values below 0 20 m during typhoon winnie while rmse 0 20 m are observed in luchao station fig 7 a the validation of storm surge seems to be better during typhoon ampil with rmse values of most stations below 0 10 m except for beicaodong station fig 7 b in fact the model performance ensemble of the two storm surges is roughly at the same level in rmse as the surge height of the former one is almost double the latter besides calibration of the simulation during both two typhoons shows a downtrend in the rsme values upper stream q q plots reveal the model is capable of reproducing the probability distribution function of the measured storm surge the black dots in fig 7 the model overestimated the higher values slightly while the opposite is also found among lower values at some locations which may be on account of the coarse atmospheric forcing and numerical grids however the model is thought to be satisfactory in simulating storm surge within the scope of the study on the influence of typhoon track and storm timing in the yangtze estuary rather than providing accurate operational forecasts this is also confirmed by the results of the kolmogorov smirnov test with a 5 significance level in fig 7 3 2 surge affected by dlt the track s relative position to the yangtze estuary can significantly influence the surge magnitude fig 8 compares the peak surges peak negative surges of the seven storm tracks of dlt the maximum surges of all gauge stations in the yangtze estuary except for lianxing station are induced by track s5 which is at the distance of 2 r max from the center of the yangtze estuary debunking a misconception that the closer track may cause higher surge to the target spot the peak surge of track s5 is found smaller than that of track s3 and s4 in lianxing station the coastline near which is approximately perpendicular to the typhoon track storm currents induced by typhoon translation wind field crash into the bank inducing energy and volume concentration at locations along the coast peak surge of typhoons landing on the north side of the yangtze estuary for example track s1 and s2 is smaller than that landing on the south side and the main process of water level change is negative surge fig 8b which is in good agreement with the results of the wind direction analysis in chap 2 5 the magnitude of the storm surge shows an increasing trend from downstream to upstream in tracks landing on the south side and reaches 3 0 m qinglong station track s5 surge levels are abnormally low in beicaozhong station for its location in the open waters and dikes nearby can hardly influence flooding as they are usually submerged when the storm surge occurs fig 9 storm surge induced by dlt overspreads the whole estuary and reaches its maximum in the upper estuary which indicates that nantong and zhangjiagang of jiangsu province is under great threat of submersion 3 3 surge affected by ont peak surge induced by ont is sensitive to the track offshore distance in the yangtze estuary there is an obvious process of water level rise as well as water level decline when the storm center transforms over the central axis of the yangtze estuary making a short duration of storm surge fig 10 compares the peak surge peak negative surge of the five storm tracks of ont the maximum surges of all gauge stations in the yangtze estuary show a trend that the closer track can induce a higher level of storm surge both peak surge and peak negative surge are induced by track o1 table 2 demonstrates the attenuation of peak surge with the increasing offshore distance of tracks taking the extreme peak surge of o1 as a reference surge level induced by track o2 o3 and o4 with the offshore distance of r max 2 r max and 3 r max are approximately 52 21 and 11 the surge magnitude of o1 respectively the peak surge reduces by approximately 50 as its distance from the yangtze estuary increases by r max within the range of 3 r max complex shelf morphology has great impacts on the surge distributions fig 11 shows that storm surge disasters induced by ont are mainly distributed over the inner estuary and the south banks of both branches suffer huge risk of surge damage due to the sustained onshore winds inducing extreme surges of 4 0 m in the north branch and 2 2m in the south branch respectively xinzheng village and loujiang estuary have eastward geometry with broad entrance prone to promoting accumulations of water induced by westward wind and currents when the eye of a typhoon like ont approaches the axis of the estuary however the shift of the typhoon eye makes a fast surge pattern transform from water set up to water set down the high risk region shanghai especially chongming island is under great threat of submersion due to surge induced by tracks of ont 3 4 surge affected by storm timing peak surges of dlt and ont make responses in the same pattern to the variation of tidal stages fig 12 reveals that surge levels in the flood period are higher than that in the falling period as tes coinciding with the same water level in the major stations surge levels of dlt ont as tes coinciding with the falling mid tide are smaller than that of the rising mid tide by 41 2 64 3 this is contrary to the previous studies that falling tide tends to increase surge level whereas rising tide attenuates surge level lin et al 2012 rego and li 2010 we further extracted surges of the whole tidal cycle for the 5 different sizes of tidal range and got the similar tendency that the rising tide increases surge level in the yangtze estuary fig 13 this can be explained by the effect of tidal wave transformation by the interaction of surge and tide surge tide interaction can affect the magnitude and arrival time of the peak water levels and consequently the surge threat fig 13 also shows that the data amount of surges in the rising stage is less than that in the falling stage implying that the period of rising tide is shorter than that of falling tide during a storm event the cause of tidal wave transformation is the combined effect of riverine topography and the bottom friction in the estuary which would be aggravated by surge a clear phase advance a little phase delay can be found in fig 14 a fig 14b as tes coinciding with the phase of several hours before after the high tide compared to the falling period the steeper curve of the tidal wave of the rising period is more vulnerable to phase shift and will thus induce larger surge level it is of more practical significance to investigate the surge near peak storm levels feng et al 2016 showed two types of semidiurnal surges with different causes of generation in this study we considered the total surge level as the combination of surge due to phase shift lag surge and surge due to local modification local surge as shown in fig 14c the peak water level difference between the storm tide and astronomical tide is the local surge the blue part the total surge value at the high storm tidal level minus the local surge is the lag surge the magenta part fig 15 shows that the lag surge of the rising period contributes more to the total surge at the highest storm tidal level compared to the falling period and it increases as the time lag grows larger and reaches 60 of the total surge level for tracks of dlt however the tidal range seems to have limited effect on the proportion of the lag surge for tracks of ont the tendency is the same not shown the phase shifts during a storm event are easily explained in terms of changes in phase speed on the one hand since both tides and surges to first order are shallow water waves with phase speeds of gh 1 2 where h is the total water depth and g is the acceleration due to gravity positive surge would increase the total water depth relative to the astronomical tidal level resulting in an increased phase speed both directly and because of the effects of bottom friction which is inversely proportional to depth this is consistent with horsburgh and wilson 2007 that the positive surge would advance the tide by enhancing the phase speed of the tidal wave while a negative surge would retard tidal propagation on the other hand the flood current would play a positive role in phase speed as water particles flow into the estuary and vice versa of the falling current it is supported by hu et al 2012 that the propagating velocity of unsteady open channel flows can be expressed by the sum of flow velocity and wave velocity at wave peak 10 c 0 g h u g h q b h where h is a certain characteristic water depth u is a certain characteristic velocity of flow h and q are respectively the water depth and discharge corresponding to u and b is the width of the flume it is therefore concluded that the storm tide is accelerated by the interaction of surge and tide as it propagates from the open sea into the yangtze estuary resulting in a phase advance which clarifies the phenomenon that rising tide increases surge level while falling tide attenuates surge level our results are also confirmed by previous findings in the literature as salek and yasuda 2001 that larger surge would be produced as cyclones make landfall before the high tide fig 12a shows a downward trend of peak surge of dlt in the bulk stations when tes coincides with a higher tidal level the tendency can be explained as shallower water is more conducive to the growth of storm surges surge level and depth are inversely related given the same condition of other factors and can be supported by the study of resio and westerink 2008 while fig 12b shows the opposite tendency of peak surge for ont an uptrend of peak surge of ont is detected when tes coincides with a higher tidal level the phenomenon can be explained by the combined effect of the runoff and the particular track of ont as mentioned in section 2 5 the prevailing wind direction would play a positive role on surge as a storm approaches the yangtze estuary and a negative role after the center of a storm passes the central axis of the estuary and the transformation is a very short duration of about 6 h fig 15 shows the distribution of surge as the storm approaches a b and c and then leaves d the estuary in the case of tes coinciding with the low tide the storm coincides with the combined effect of strong ebb current and the runoff inducing peak surge in the outer estuary while in the inner and upper estuary the main surge process is a slight water set up or even water set down the position of peak surge changed northward rapidly outside the estuary with the translation of the storm and can hardly propagate into the estuary fig 16 the major selected tidal gauge stations are inside the estuary and thus can not capture the peak surge variation outside near low tide that is why the peak surge at low tide small depth is smaller than at high tide from the results of cases of dlt and ont it is also found to be significant that in most circumstances the peak surge levels are smaller than that of the surge only case tidal amplitude 0 especially in the inner and upper estuarine areas fig 12 such a tendency is enhanced when the tidal range is large this is contrary to the previous study kim et al 2008 while partly supported by the study of horsburgh and wilson 2007 that increasing tidal range appears to reduce surge peaks arriving near high water fig 17 compared the water level between cases of the astronomical tide and no tide tidal amplitude 0 it is found that the total water depth grew larger in the inner and upper estuarine areas under the effect of astronomical tide relative to the no tide case thus it is no wonder why the larger tidal range which means deeper water in the estuary attenuates surge level 4 conclusions in this investigation a new method of typhoon scenario construction is proposed to study the storm surge responses to tracks and storm timing by simulating the coupling procedure of astronomical tides storm surge and runoff in the yangtze estuary the model reproduces the observed water levels during the two actual typhoon processes well two typical typhoon tracks the direct landing typhoon dlt and the offshore northward typhoon ont are studied and a new indicator the regional accumulated cyclone energy is raised to assess the impact of cyclones on regional scale areas for tracks of dlt track 2 r max south to the estuary center is detected to induce extreme surges s5 the upper stream clarifies greater surges reaching its maximum of 3 0 m in qinglong station dlt pushes more water into the estuary causing larger scope and longer duration of storm flooding and is most threatening to the upper estuary especially the nearshore areas of nantong and suzhou for tracks of ont a r max farther track to the estuary can result in half attenuation on storm surges within the distance of 3 r max the maximum surge is induced by track o1 and observed as large as 4 0 m in an eastward notch on chongming island surge distribution of ont is the most detrimental to the inner estuary while with a shorter duration mainly affecting the nearshore areas of shanghai our findings reveal that the rising tide increases surge level whereas the falling tide attenuates surge level in the estuary the rising tide curve of the tidal wave is steeper and thus more vulnerable to the phase shift especially to the phase advance a phase advance is usually the result of the acceleration of phase speed which is triggered by the surge tide interaction and the flood current consequently the peak surge occurs in the rising tide the analysis of surge distribution of ont reveals that the position of peak surge would transfer outside the estuary as tes coincides with the low tide the main surge process is a slight water set up or even water set down inside the estuary this can well explain why peak surges are abnormally small near the low tide compared to that near the high tide in the estuary further the larger tidal range is found to attenuate surge level in the inner and upper estuarine areas due to the enhanced water depth credit authorship contribution statement chengtuan yin conceptualization software writing original draft weisheng zhang data curation methodology mengjie xiong writing review editing jinhua wang software caiyang zhou data curation xiping dou supervision jinshan zhang writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the work was financially supported by the national key research and development program of china no 2018yfc0407502 
20646,in this article based on the dynamic response of the mining ship and the mining machine in different linkage modes the virtual prototype model of the ore lifting system and the pipeline system load model in the marine dynamic environment are established under different excitation environments the motion response dynamic response and spatial configuration characteristics of the ore lifting system under different linkage speeds and different linkage directions of the mining ship and the mining machine are studied the results of the research demonstrated that the sinking motion of the mining machine is stimulated and the sinking response amplitude of the submersed warehouse is on the rise as the length of the pipeline increases the heave response curve of the submersed warehouse is not strictly a simple harmonic motion but fluctuates up and down in a similar period as the mining ship the nodal force at the connection between the submersed warehouse and the hard tube in the pipeline system increases with the increase of the mining ship s heave amplitude with the growing linkage speed the maximum value of the displacement deviation of the trajectory of the submersed warehouse increases in proportion to the speed the linkage direction of the mining system has little effect on the movement offset of the submersed warehouse and the horizontal linkage is more conducive to the stability of the slurry conveying hose system than the vertical linkage keywords deep sea mining ore conveyor system pipe space configuration kinetics analysis stress analysis 1 introduction the function of the deep sea mining ore lifting system is to raise the ore collected by the seabed mining machine to the mining ship on the sea surface the united states germany france japan south korea and some other countries have conducted such theoretical and experimental research on this the mining method for collecting seabed ore consisting a mining machine to hydraulically lift the ore first then to lift the ore to the sea surface mining machine through a pipeline yoon et al 2007a 2007b fang qiong et al 2006 the structural composition of the deep sea mining lifting system is shown in fig 1 the mining system is mainly composed of slurry conveying hose buoyancy module slurry pump hard tube mining ship submersed warehouse mining machine etc sun et al 2017 during the operation of deep sea mining the mining machine collects the polymetallic nodules present on the bottom of the sea after desilting and crushing it flows into the submersed warehouse from the slurry inlet through the slurry conveying hose under the suction of the slurry pump the ore is transported by a hard tube to the mining ship hailiang 2008 hengling and shaojun 2018 felippa and chung 1981 the dynamic characteristics of the ore lifting system and the dynamic response of the subsystem are not only related to the safe operation of the mining system but also have played a vital role in the early stage of system design and system safety check previous scholars have already done a lot of researches on pipeline system dynamics of the deep sea mining lifting system hereinafter referred to as the ore lifting system the methods of analysis include finite element method and the discrete element method on the one hand the finite element method can flexibly model the lifting pipeline and fully consider the complex dynamic characteristics of the ore lifting system however due to the complex non linear characteristics of large displacement and large rotation in the pipeline of the ore lifting system the finite element method still has some problems in convergence on the other hand compared with the finite element method the discrete element method is superior regarding the issue of the convergence of pipeline system dynamics calculation hong and shah 2018a found out the geometric non linear characteristics of the pipeline and then analyzed the spatial configuration of 1000 m mining system under both forward and reverse flow conditions on the basis of the finite element method chung 2009 simplified the pipeline into non linear beam elements and established a finite element model using the incremental newton raphson method iterative solution to study the linkage speed the mining ship and the mining machine move together referred to as linkage linkage speed refers to the speed of mining ship and mining machine when they move in the same direction and at the same speed and the submersed warehouse of the mining system pipeline offset characteristics under different factors such as quality and subsystem connection based on the abaqus finite element analysis solver hong et al hong and shah 2018b studied the instability of ocean riser systems under the action of ocean currents and proposed a probabilistic fracture mechanics analysis method for pipelines the finite element method is mainly used in the research of the pipeline stress and system configuration but it is difficult to simulate the dynamic response of the overall linkage process linkage process refers to the process that the mining ship and the mining machine move together regarding the research of the pipeline system chen yuxiang et al chen et al 2014 first compared the analytical solution with the dynamic simulation solution of the classical forced beam vibration problem to build a multi body dynamic model of the mining slurry conveying hose the spatial shape and unit stress of the pipeline obtained by the numerical simulation was consistent with the testing results ling sheng et al sheng et al 2002 focused on the non uniform distribution of the system pipeline stress along its axis they proposed a stepped pipeline system and analyzed the influencing factors of the stepped mining system movement state from the aspects of layout design system operation control etc wang gang wang 2009 took the degree of distortion of the horse saddle shape as a safety evaluation standard and mentioned that the submersed warehouse was used as the center to establish a dynamic operation safety zone for the mining machine and a real time query table for the dynamic parameters of the mining machine safety domain based on the discrete element method adamiec et al 2015 introduced the theory of large deflections of large deformation planar slender rod systems charles et al charles et al 1986 studied the resonance problem of a 5846 m mining pipeline and found that the axial stress was the designing stress of the pipeline rather than the bending stress in the aspect of hydraulic analysis and system linkage of lifting pipe oh et al 2014 made an in depth study and deduced the variation law of the total hydrodynamic force following time and seawater depth raed et al raed and guedes soares 2018 conducted a wind tunnel test according to the similarity theory for the slurry conveying hose section of the mining system with the consideration of the edge effect and obtained the discrete test data of the drag coefficient with the angle of wind and the reynolds number by referring to the nonlinear finite element theory and the load increment method the spatial shape of the slurry conveying hose during the movement of the mining machine is observed li yan 2009 established a virtual prototype of a mining system using the commercial multibody dynamics software adams to analyze the overall linkage characteristics of the mining system under different linkage speeds ocean current speeds and downstream and upstream conditions dai yu dai 2013 successfully established a virtual prototype model of a 1000 m mining system with the help of adams and recurdyn the system linkage characteristics of the system in two different acquisition modes horizontal foldback and vertical foldback are analyzed iwona adamiec wojcik et al 2015 analyzed the motion characteristics of the mining system and acquired the results of the estimated fluid load and deformation of the slurry conveying hose connection section of the submersed warehouse liu shaojun et al liu et al 2003 established a 1000 m mining system simulation analysis virtual prototype model carried out dynamic simulation analyses on the process of system deployment recovery obstacle crossing and climbing which provided a preliminary research basis for visual research on deep sea mining systems zhi wang et al wang et al 2012 observed that when the mining machine travels in a straight line the slurry conveying hose can maintain a complete s shape and the lateral runout displacement near the mining machine during the linear travel is greater than the lateral runout near the submersed warehouse under the support of the finite element analysis method the author of this paper formed a finite element analysis model of the mining system analyzed the spatial configuration of the pipeline system and the flow characteristics of fluid in pipes when the mining machine was in different positions xu and xu 2008 xu et al 2012 xu et al 2019 xu et al 2020 the results of liu shaojun liu et al 2003 et al mentioned that the researchers have paid lots of effort and obtained useful information on the overall dynamics of the mining system and the dynamic response of the subsystems and have a deep understanding about the motion response of the mining system in various states but in fact the subsystems in the pipeline system usually have a strong coupling for example the coupling between the heave motion and lateral motion of the mining ship on the other hand the influence of the initial position of the mining ship and the axis of the lifting pipe on the dynamic characteristics of the pipeline system is negligible in the process of pipeline system linkage unconventional movements such as acceleration and deceleration are inevitable as well in the paper based on the mining ship and the mining machine in different linkage modes the virtual prototype model of the ore lifting system and the pipeline system load model in the marine dynamic environment are established moreover the analysis of the motion response of the ore conveying equipment at the lower end of the lifting pipe for deep sea mining operations is also shown in this paper 2 model analysis 2 1 main technical parameters of the mining system with reference to the overall design of a 1000 m offshore pilot test system for ocean polymetallic nodules chen 2006 the deep sea mining system is mainly composed of a terminal acquisition system an ore lifting system and an ore transfer transit system the ore lifting system covers a hard tube system and a slurry conveying hose system compared to the 3000 m mining system and the 1000 m mining system their slurry conveying hoses are both 400 m long and the only difference is that their hard tube lengths are different the hard tube top of the ore lifting system is connected to the mining ship through the moon pool and the connection part is equipped with a motion compensation device in the mining system the submersed warehouse is located at a height of 100 m from the seafloor which is connected to the bottom end of the lifting hard tube the two ends of the slurry conveying hose are connected to the mining machinery and the submersed warehouse respectively the slurry conveying hose has a double saddle shape due to the buoyancy module which can provide the mining machinery with greater freedom of space collection to cope with the complex and changeable deep sea environment this configuration can provide a wide range of collection for mining machines it is based on the technical design research report of the mining pilot system of the china oceanic association in the tenth five year plan tenth five year plan mining sea trial system chief engineer group 2004 and deep sea equipment technology research report china s first deep sea li 2016 the main technical parameters of the 3000 m deep sea mining lifting system are shown in table 1 according to the statistical results of the literature janarthanan et al 2019 park et al 2011 chen et al 2020 tang 2004 the maximum velocity of ocean currents passing through mining areas in china is 1 7 m s nevertheless the literature only indicates the seabed velocity which varies between 0 01 m s and 0 1 m s and does not present the law of the variation of the current velocity with the coastal water depth in the paper the variation rule of the coastal water depth maximum calculation depth is 5000 m is calculated with the graphical change rule provided in wu 2011 taking the ocean surface current velocity of 1 7 m s as an example the calculation formula is as follows 1 v c 0 1 1 6 5000 z 5000 12 where z is the distance from the ocean surface m and v c is the ocean current velocity at z m s as is shown in fig 2 the ocean current velocity decreases with increasing seawater depth from 0 to 1000 m the ocean velocity declines almost linearly as the sea depth increases when the seawater depth are between 2000 and 5000 m the current velocity is stable at around 0 1 m s 2 2 virtual prototype physical model the overall size of the deep sea mining ore lifting system is huge and the internal structure of the system is complicated although the dynamic analysis model of the ore lifting system has been built the internal details of each structural part are not so delicate in the modeling process the energy supply system measurement and control system are regarded as equivalent mass which are added to submersed warehouse and mining machine respectively 2 2 1 model assumptions according to the schematic diagram of the 4000 m deep sea mining lifting system shown in fig 1 the virtual prototype model was established in a ratio of 1 1 to facilitate calculations the following assumptions need to be made before modeling 1 mining ship and mining machine only cover their mass size location of the center of mass and connection method with pipelines while the detailed characteristics of each part were disregarded 2 there were a complicated feeding and feeding mechanisms inside the submersed warehouse the internal details were ignored while modeling and it was equivalent to a mass of 6m 8m 8m length width height 3 the influence of internal flow in the pipeline was not considered 2 2 2 physical model of mining ship and mining machine the mining ship is different from the traditional ship the mining ship must cooperate with the mining machine on the seabed and move together to complete the mining operation at the same time the bottom of the mining ship is also connected with a massive pipeline transportation system and the complex deep sea operating environment requires the use of a heave compensation device referring to the introduction in the literature wu 2011 of china ship science research center the overall dimensions of the mining ship are shown in table 2 during the process of modeling the physical simulation system the overall size and shape of the mining ship mining machine and intermediate tank are designed with the help of ug 5 0 then through the interface technology between ug 5 0 and adams 2018 the generation of the dynamic analysis model is imported into adams 2018 the physical model of the dynamic analysis of the mining ship and the mining machine is shown in fig 3 2 2 3 physical models of hard tube and slurry conveying hose the design of the mining pipeline system refers to the design standards and strength criteria of the deep sea vertical oil and gas pipeline sapietova et al 2017 the hard tube material is p110 steel slurry conveying hose specific parameters are shown in table 3 the application of the discrete element method is used to model pipeline with a certain number of rigid body elements the total length of the hard tube is 4000 m which is divided into 20000 units and each unit length is 0 2 m rigid body elements can simulate their movement characteristics as these elements are connected by sleeve forces the joint of the top of the hard tube and the moon pool of the mining ship are connected by a ball hinge the submersed warehouse and the lower end of the hard tube are connected by a cross hinge because the slurry conveying hose has greater flexibility and less interference with the mining machine a rigid connection between the slurry conveying hose and the mining machine is adopted when building a hard tube model first discretize the rigid body elements of the pipe and then add a sleeve force between every two small elements the mechanical model of sleeve force is shown in fig 4 a in fig 4 a fx fy fz tx ty and tz are the six forces and moment components of the sleeve force the hard tube model is shown in fig 4 b the modeling idea of the slurry conveying hose resembles the hard tube but the physical characteristics of the slurry conveying hose are different from the hard tube in the system the total length of the slurry conveying hose is 400 m which is divided into 800 units and each unit length is 0 5 m in order to ensure that the mining machine has sufficient collection space the slurry conveying hose is provided with a buoyancy module to keep it in the double saddle shape the slurry conveying hose model is shown in fig 4 c 2 2 4 load analysis 1 pipeline gravity the self weight g p of the pipeline unit with length l is 2 g p π 4 g ρ g d 2 d 2 l the self weight of the fluid in the tube unit of length l is 3 w l π 4 g ρ m d 2 l the buoyancy f of a pipe unit of length l is 4 f π 4 g ρ w d 2 l where ρ g is the density of the selected pipeline material kg m3 ρ m represents the mixed density of the ore slurry kg m3 ρ w is the density of seawater ρ w 1037 kg m3 d is the outer diameter of the pipeline m and d is the inner diameter of the pipeline m 2 fluid load when ocean currents and waves pass through marine structures the fluid loads on the pipeline system are mainly inertial forces and drag forces which are related to the acceleration of movement of the waves and current water particles relative to the ocean structures the diameter of the transverse structure of the deep sea mining system pipeline is relatively small compared with the wavelength and it is a small isolated elongated rod shaped structure the system space coordinate description of morison equation under wave action is shown in fig 5 as shown in fig 5 the flow direction is defined as the positive x axis direction the positive y axis direction is perpendicular to the sea level and the x z plane is the sea level taking a infinitesimal body dy at any depth y of the mining pipeline the hydraulic force f h experienced by the infinitesimal body can be expressed as 5 f h 1 2 c d ρ w d u x x u x x 1 4 π c m ρ w d 2 u x t 1 4 π c m ρ w d 2 x where c d is the drag coefficient c m is the inertial coefficient c m is the additional mass force coefficient u x is the horizontal velocity of the sea water particle at position y m s x x and x are the horizontal displacement horizontal velocity and horizontal acceleration of the pipeline at position y respectively according to the linear wave theory in ultra deep water banerjee et al 2014 the available expressions of wave particle velocity and acceleration are as follows 6 u x h 2 ω e k z c o s k x ω t 7 u x t h 2 ω 2 e k z s i n k x ω t in equations 6 and 7 ω 2 π t k ω 2 g where ω is the circular frequency rad s t is the wave period s h is the amplitude m k is the wave number and g is the acceleration of gravity g 9 8 m s2 the drag coefficient c d the inertia coefficient c m and the additional mass force coefficient can be taken as 1 2 2 0 and 1 847 banerjee et al 2014 2 3 pipeline system model as shown in fig 6 a tiny unit dx at any pipeline depth x can be taken as the analyzed pipeline unit and the internal forces on the two sections u and u dx are n and n 1 n n x dx according to the darren bell principle the longitudinal vibration equation of the lifting pipe is as follows 8 e a x c 0 c 1 δ x l 1 c 2 δ x l 2 u t m x 2 u t 2 where u is the vertical displacement of the pipeline unit m a x is the cross sectional area of the lifting pipe m2 c 0 represents the viscous damping coefficient of the mining pipe c 1 and c 2 are the equivalent damping coefficients of the slurry pump and the submersed warehouse l 1 and l 2 are the longitudinal depth the slurry pump and the submersed warehouse δ x is the dirac delta function and m x is the quality of the lifting pipe unit and the quality of the attached components kg m x can be expressed as 9 m x m 0 x m p 1 δ x x 1 m z δ x x 2 where m 0 x is the mass per unit length of the lifting pipe kg m p1 x is the quality of the slurry pump kg and mz represents the quality of the submersed warehouse kg if the top of the lifting pipe has the same movement law as the mining ship the initial boundary conditions of the equation are extracted and the boundary conditions can be written as follows 10 u 0 t u 0 t a s i n ω t u x x l 0 where u 0 t is the displacement of the top of the lifting pipe m and a is its amplitude m it is consistent with the displacement of the mining ship the solution of equation 8 can be expressed as follows 11 u x t 2 l i 1 n b i t sin 2 i 1 π x 2 u o t i 1 2 3 where b i t is the undetermined function of time substituting equation 11 into equation 8 using the galerkin method the following equation can be obtained 12 i 1 n a k i b i t b k i b i t c k i b i t d 1 k u t p 1 k u 0 t p 2 k u 0 t k 1 2 n where a k i δ k i 2 m 1 ϕ i l 1 ϕ k l 1 m 2 ϕ i l 2 ϕ k l 2 b k i δ k i 2 c 0 c 1 ϕ i l 1 ϕ k l 1 c 2 ϕ i l 2 ϕ k l 2 c k i e a 2 n 1 2 π 2 2 δ k i d k i 2 k 2 k 1 π p 1 k 2 2 k 1 π m 1 ϕ k l 1 m 2 ϕ k l 2 p 2 k 2 c 0 2 k 1 π c 1 ϕ k l 1 c 2 ϕ k l 2 k 1 2 where δ k i is the dirac delta function the parameters a b c d u p 1 and p 2 are defined as the following vectors a a k i b b k i c c k i d d 1 k u u v i p 1 p 2 k p 2 p 2 k the state variable x is defined as follows 13 x b 1 b 2 b n b 1 b 2 b n t bringing in variables the state equation under a linear time varying system could be expressed as the equation 14 x e x f u h w 15 u v t g x t in the above formula state matrix e 0 i input matrix f 0 e 1 d external interference matrix h e 1 p 1 e 1 p 2 system interference vector w u 1 u 0 t system interference vector g ϕ 1 ϕ 2 ϕ n 0 0 0 for the lqg linear quadratic gaussian control optimal control problem of the vibration control of the lifting pipe the quadratic performance index j as follows 16 j 0 0 l 2 u v 2 r u 2 t d t 0 0 l 2 x g t g x t r u 2 t d t 0 0 l 2 u v t t u v t r u 2 t d t the first term of the integrand in equation 20 is the inherent displacement response of the lifting pipe and the second term is the displacement response of the active control mechanism r is a weighted value representing the weighted proportion of the second term relative to the first term function according to the separation principle the optimal state feedback vector for control action is as follows 17 u t k x t the state feedback gain matrix k in the above formula is the equation 18 k r 1 fp the p value in the above formula can be obtained by solving the riccati matrix equation 19 p e e t p r 1 p f f t p h t h 0 therefore the closed loop system can be expressed as 20 x e f k x cw 21 u v gx 3 model validation laboratory testing were performed on a 1 1000 scaled deep sea mining system models to study the hydrodynamic forces induced on the ore lifting pipeline system by the passage of regular waves the ratio of the model to the real object is 1 1000 3 1 experimental principle and experimental instrumentations in order to study the linkage characteristics of the deep sea mining lifting system an experiment platform for the deep sea mining lifting system was made according to the similarity laws the experimental platform consists of a measurement and control system a motion control system and a mechanical structure system the design principle of the experimental system is shown in fig 7 a the experimental site is shown in fig 7 b all tests were carried out in the national key laboratory of high performance and complex manufacturing of central south university china the tests were carried out at constant water depth of 4 m which allowed modelling of deep offshore waves the piston type wavemaker can produce both regular and irregular waves wave absorbers at the flume end were mitigating the wave reflection an interface device was used to communicate two independent data systems together the wave iee software provided by zhejiang daming automobile electronic co ltd china was used for data acquisition synchronization of the sensors and signals and post processing analysis of the outputs the waves were selected based on the wave flume limitations the scaling rules by the technical design research report of the mining pilot system of the china oceanic association in the tenth five year plan tenth five year plan mining sea trial system chief engineer group 2004 the wavelengths were estimated using the dispersion equation and all wave cases were meeting the deep water conditions the fresh water in the flume had a mean density of 1001 kg m3 the water temperature was monitored over the course of the experiments the temperature effect on the water density was estimated using faltinsen recommendations and remained below 0 05 faltinsen 1993 to ensure the repeatability of the devices and the measuring system each experiment was repeated five times and the experimental measurement results were its average value a time interval of 20 min was considered between the consequent tests to achieve a calm water condition a number of tests were also repeated in the ore conveying system is not started to verify the performance of the wave flume and the measuring instruments the sampling rate in the wave gauges was 100 hz the standard linear displacement method was used for the wave gauges calibration wherein the relative water level at each gauge was changed at known intervals the relative water level data was correlated against the measured voltages the accuracy of wave gauges was 0 4 mm and the coefficient of variation is 0 35 four underwater cameras were synchronized together to collect simultaneous images from the pipeline system movements during the test the frame rate was set to 15 hz time series of the forces induced by regular waves passing through the hard tube of ore lifting system was measured using load cells fixed at far end of each mooring line prior to each test series the load cells were calibrated using loads applied by known weights the calibration was repeated at the end of each test series the load cells found to remain linear nonhysteresis and to present relatively constant calibration coefficients all over the experiments for each test the steady state portion of the signal which included around 100 wave force moment cycles was selected for data analysis the steady state portion of the measurements was assumed to start after about 10 wave force moment cycles from the wave arrival at upstream wave gauges during the experiment the simulated hoisting hard tube consisted of 100 sections of steel pipe with a length of 10 cm the slurry conveying hose is made of a composite rubber tube with a length of 1 m and a diameter of 5 5 mm the buoyancy module was simulated by adding rope suspension weights at specific locations the submersed warehouse is a rectangular aluminum block with spherical hinge joints at both ends the mining ship is replaced by a synchronous belt motion module assembly the replacement of the simulated mining machines by an automatic tracking trolley and a black strip is pasted on the sink bottom to simulate the movement trajectory of the trolley the froude similarity law was applied for the scaling of the physical model and the wave regime the geometric mechanical specification of the scaled ore lifting system model used in the current experiments are presented in table 4 in the experimental system the movement speed of the mining machine and mining ship can be adjusted within a certain range first under the action of the hydrodynamic load only a static experimental test is performed and analyzed then analyze the configuration of the pipeline system during the system linkage process the linkage process refers to the process in which the mining ship and the mining machine move at the same time the measurement points during the experiment are shown in fig 8 3 2 experiment procedure first start and debug each part of the experimental system separately adjust the relative position of the laser probe high speed camera lens and measurement point to ensure the accuracy of the data collection position of the measurement point then start the synchronous belt module assembly and automatic tracking trolley adjust their speeds to be consistent with the experimental preset value start the motion system and measurement and control systems and read the measured data after the system runs smoothly last adjust different parameters and repeat above steps to obtain comprehensive experimental data 3 3 analysis of test results 3 3 1 static experiment results when the wavelength wave height and wave steepness are the same only change the wave velocity test the displacement of o1 o2 and o3 the average horizontal displacement of measurement points o1 o2 o3 at different wave velocity are shown in table 5 it can be seen from the test results in table 5 that under static conditions as the wave velocity increases the horizontal displacement value of the measurement point becomes larger when the wave is maintained the horizontal displacement value of point o1 is the largest followed by point o2 and the smallest one o3 the reason for it is due to the wave load proportional to the cross sectional area of the structure the load area of the submersed warehouse is greater than the load area of the hard pipes and slurry conveying hose which causes the maximum displacement value near the submersed warehouse however o2 and o3 are both at the buoyancy module point of the slurry conveying hose and the displacement of the o3 point is limited by the mining machine at the end of the slurry conveying hose resulting in the displacement value of o3 point being less than o2 point the numerical calculation result is slightly larger than the experimental test result but the gap of errors between the two is within 9 this is because in the numerical calculation the hydrodynamic load is obtained through theoretical calculation and then is added to the designated measurement point in the form of discrete values during the simulation experiment the hydrodynamic load is dispersed by the environment resulting in the hydrodynamic load at the measurement point being lower than the theoretical calculation value so the experimental measurement result is slightly lower than the numerical calculation result more or less 3 3 2 dynamic experiment results based on the limitations of the experimental site in order to simulate the hydraulic force of ocean current flow only the second wave velocity the maximum wave velocity is 5 04 m s was selected under dynamic experimental conditions it can be true that the analysis of the position offset of the submersed warehouse during the linkage process of the mining system is realized through simulation experiments to obtain the experimental test results and numerical calculation results the time history curve of the submersed warehouse is shown in fig 9 in fig 9 the linkage speed refers to the speed of the mining ship and the mining machine when they move in the same direction and at the same speed from the numerical simulation results and experimental test results shown in fig 9 it can be seen that when the linkage speed of the mining ship and the mining machine is 0 05 m s the displacement of the submersed warehouse in the experimental test oscillates between 16 43 mm and 16 73 mm at this time the submersed warehouse of the numerical simulation oscillated slightly around 16 2 mm and the vibration amplitude was much smaller than the experimental test result when the linkage speed is 0 25 m s the displacement of the intermediate chamber tested in the experiment oscillates between 24 31 mm and 26 72 mm at this time the numerical simulation of the submersed warehouse oscillated slightly around 24 52 mm and its vibration amplitude was much smaller than the experimental test results at this time the experimental results and numerical simulation results show that when the linkage speed is different the displacement difference of the submersed warehouse is small and the error is within 9 the comparative analysis of the experimental results and the numerical calculation results show that the mathematical model of the mining system established in the paper has good adaptability as for why the vibration amplitude of the submersed warehouse measured by the experiment has a big difference when the linkage speed is 0 05 m s and 0 25 m s it may be due to the increase in flexural deformation of the pipeline as the linkage speed increases under the combined action of the damping force of the pipeline structure the inertial force and the seawater hydraulic power irregular random vibrations occurred in the submersed warehouse installed at the lower end of the pipeline and the greater the linkage speed the greater the vibration amplitude 4 linkage characteristic analysis 4 1 response of mining ship heave motion due to the harsh sea conditions the longitudinal vibration of the ore lifting system in the ocean current would lead to the longitudinal deformation and axial tension fluctuation of the pipeline system the factors that affect the safety of the pipeline system mainly include the heave movement of themining ship the parameters of the pipeline system and the current flow velocity changes xu et al 2020 liu et al 2016 when the ore lifting system is operating in the ocean the magnitude and direction of the current speed change with time and space in order to simplify the analysis process the paper only considers the ocean current flow rate at a constant speed on the linkage characteristics of the mine pipeline system into consideration first of all the influence of a single factor on the dynamic response of the pipeline system is analyzed after mastering what the influence of a single factor is the change law of tension and movement of the ore lifting system under the combined action of multiple factors is analyzed 4 1 1 analysis of heave movement of mining system with a different pipeline length the displacement of the mining ship heave movement is affected by many factors such as the mining ship type structure and size but the mining ship movement displacement is generally smaller than the wave height therefore it is assumed that the motion of the mining ship can be expressed by simple harmonic motion and the period of the simple harmonic motion is equal to the wave period given that the wave height is h and the wave period is t the heave displacement of the mining ship can be expressed as 22 y s y s a s i n 2 π t t in equation 22 y s a is the heave amplitude of the mining ship referring to the reference faltinsen 1993 when the sea condition level is 4 and the speed is 1kn 0 514 m s the expression of mining ship heave motion can be expressed as 23 y s 0 368 s i n 0 25 π t when the sea condition level is 5 and the speed is 1kn 0 514 m s the expression of mining ship heave motion can be expressed as 24 y s 0 742 s i n 0 2 π t the submarine manganese nodules are stored in the deep sea of 2000 to 5000 m the mining system responds differently to heave motion with different pipeline lengths according to equations 23 and 24 the heave motion amplitude of the mining ship reaches 0 368 m under the fourth level sea state under the fifth class sea conditions the heaving amplitude of the mining ship reaches 0 742 m regardless of the horizontal movement and rotation of the mining machine at sea the movement of the mining machine is set to vertical sinusoidal heave motion with an amplitude of 0 742 m and a period of 10 s the dynamic response of the pipeline system is analyzed when the pipeline length is 2000 m 3000 m 4000 m and 5000 m fig 10 is a comparison of the calculation results about the heave motion in the mining ship and the submersed warehouse at different seawater depths when there is only a sinusoidal heave excitation fig 10 indicates that when the mining ship performs heave motion with a certain heave amplitude and period the submersed warehouse at the lower end of the lifting pipe will also follow the mining ship to move up and down nonetheless this is not a strict harmonic motion response since the submersed warehouse would be affected by the drag force of seawater while responding to heave motion which interferes with its normal simple harmonic motion response similarly due to the dynamic coupling between the mining ship and the pipeline system the piping system has an inhibitory effect on the movement of the mining ship which causes the movement of the mining ship to produce a saw toothed slight oscillation despite the data without achieving a good curve the movement form of the mining ship still shows a sinusoidal curve law overall the longer the pipeline length is the greater the difference between the movement of the mining ship and the submersed warehouse appears when the pipeline length reaches 5000 m the amplitude of the submersed warehouse has obvious amplification and lag effects relative to the amplitude of the mining ship moreover the difference between amplification and hysteresis is obvious with different seawater depths since the sleeve force connection model is used at the connection of the hard tube unit during modeling this sleeve force connection model can be regarded as a spring damper unit in three directions therefore as the length of the pipeline increases the flexible connection unit plays a certain role in amplifying the mining ship s motion excitation besides the heave motion excitation of the mining ship is transmitted to the submersed warehouse through the hard tube so it is hard to avoid the phase lag effect of the motion response in order to study the influence of the horizontal movement of the mining ship on the longitudinal vibration of the submersed warehouse the mining ship was set to sail in the horizontal direction at a speed of 0 5 m s under the dynamic action of sea waves under the combined action of these two movements the movement response of the submersed warehouse is shown in fig 11 fig 11 a shows the motion response of the submersed warehouse when the pipe length is 2000 m fig 11 b shows the motion response of the submersed warehouse when the pipeline length is 5000 m from the calculation results of this figure it can be seen that whether the pipeline length is 2000 or 5000 m the impact of the horizontal movement of the mining ship on the longitudinal vibration of the submersed warehouse is mainly reflected in the aspects of its vibration under the action of horizontal movement the amplitude of the longitudinal vibration of the submersed warehouse has increased but the increase is not large 4 1 2 analysis of nodal forces at the first and last ends of the pipeline system based on the heave motion response of the mining system in different pipeline lengths the variation law of the nodal force at the top and bottom of the pipeline system in seawater depths from 2000 to 5000 m is obtained as shown in fig 12 the mean and maximum values of the first and last node force of the pipeline system are under different pipeline lengths it can be seen from the calculation results shown in fig 12 that as the length of the pipeline changes the nodal forces at the top and bottom of the pipeline system exhibit different laws the maximum force and average force at the top node increase as the length of the pipe increases when the pipeline length is 2000 m the maximum node force at the top is 113 3 kn when the pipeline length reaches 5000 m the top node force increases to 189 3 kn the latter is 1 67 times than the former the maximum and average values of the nodal force at the bottom almost keep the same condition under different pipeline lengths this is because the nodal force at the bottom of the lifting pipe mainly derives from the weight force and inertial force of the submersed warehouse although the heave motion of the mining ship will cause the tension fluctuation of the pipeline system the tension fluctuation caused by the heave motion is easily absorbed and dissipated by the flexible connection unit in the virtual prototype therefore adding flexible connection units at key connection points of pipeline systems such as submersible pumps submersed warehouse etc can serve as a shock absorber 4 1 3 motion response of the submersed warehouse under different heave amplitudes in order to explore the motion response of the submersed warehouse under different heave amplitudes of the mining ship setting the heave motion amplitudes of the mining ship are 0 2 m 0 4 m 0 6 m 0 8 m and 1 0 m respectively and the heave motion period is 10 s the center of mass of the submersed warehouse is setted as the target measuring point to detect the motion response of the submersed warehouse the time history curve of the motion response of the submersed warehouse is under different heave amplitudes as shown in fig 13 the amplitude of the motion response of the submersed warehouse under different heave motions is extracted and presented in table 6 as can be seen from fig 13 and table 6 the amplitude of the heave transportation of the submersed warehouse at the lower end of the lifting pipe increases with the increase of the heave excitation amplitude of the mining ship and its motion response magnification is about 1 89 times excited by the heave motion of the mining ship there is an amplitude amplification effect in the motion response of the mining system the main reason for the enlargement is that when the submersed warehouse installed at the lower end of the hard tube sinks with the mining ship the hard tube undergoes elastoplastic deformation under the action of inertial force and ocean current hydraulic forces it not only causes the hard tube to be elongated or compressed this effect not only will increase the instability of the subsystem and the reduction of the ore particle transport efficiency inside the submersed warehouse but also may cause fatigue damage to the pipeline system therefore when designing the deep sea mining pipeline system the connection between the mining ship and the hard tube needs to be equipped with wave compensation devices and other energy absorption devices it can also be seen from the calculation results shown in fig 13 that although the motion amplitudes of the submersed warehouse under different excitations are different there is little difference in the motion period it indicates that the motions of the submersed warehouse and the mining ship perform better followability 4 1 4 nodal force analysis of pipeline system under different heave amplitudes the amplitude of the mining ship s heave motion is affected by various parameters such as ocean waves and mining ship structure in order to study the relationship between the nodal force at the junction of the submersed warehouse and the hard tube with time the effect of the mining ship heave motion on the axial nodal force of the pipeline system is analyzed when the amplitude of the mining ship is 0 2 m 0 4 m 0 6 m 0 8 m and the heave period is 10 s the change of the force at the node between the submersed warehouse and the hard tube under different vibration amplitudes is analyzed fig 14 shows the calculation results of the variation law of the nodal force at the junction of the submersed warehouse and the hard tube with time under different heave motion amplitudes it can be seen from the calculation results in fig 14 that with the increase of the heave excitation amplitude of the mining ship the nodal force at the connection between the submersed warehouse and the hard tube is bigger when the heave amplitude of the mining ship is 0 2 m the nodal force varies between 0 579 and 0 574 mn when the heave amplitude of the mining ship is 0 8 m the nodal force varies from 3 119 to 3 165 mn this is because of the greater the heave of the mining ship the greater the motion response of the submersed warehouse located at the lower end of the hard pipe excessive heave motion response will cause instability of the movement of the submersed warehouse resulting in excessive force at the junction between the submersed warehouse and the hard tube at the lower end of the pipeline system when the amplitude of the mining ship is different the maximum tension and the maximum pressure of the node at the junction of the submersed warehouse and the hard tube is still very small it demonstrates that the movement of the submersed warehouse and the movement of the mining ship have better followability and it also shows that the mixed fluid in the hard tube has little effect on the joint force of the pipe the joint force between the submersed warehouse and the hard tube changes sharply with time and there is no obvious simple harmonic change law such as motion response it is because the submersed warehouse has an impact because of the inertial force and fluid drag force while doing heave motion 4 2 analysis of linkage movement of ore lifting system during the linkage process of the ore lifting system the dynamic characteristics of the entire system are affected by various factors such as the linkage speed of the system the linkage direction and the movement state of the mining ship analysis of the motion response of the subsystem of the ore lifting system during the linkage process could provide load forecasting for the ore lifting system 4 2 1 motion response of the submersed warehouse under different linkage speeds for the ideal seabed environment the linear linkage of the mining system is the most common acquisition mode in the acquisition process in the linear linkage process the submersed warehouse follows the movement of the system under the drag of the hard pipe and its movement law is unknown while considering the overall collection efficiency the movement offset of the submersed warehouse during the linkage process is also one of the most important reference factors to determine the linkage speed to focus on observing the movement of the submersed warehouse during the linkage process the actual trajectory of the submersed warehouse is used as the controlled object and set the overall linkage speed change as 0 5 m s 0 8 m s 1 0 m s 1 2 m s 1 5 m s by intercepting simulation animations at different times the linkage conditions of the ore lifting system at a different time when the linkage speed is 0 5 m s are obtained the results are shown in fig 15 from the simulation results in fig 15 which shows a certain lag between the actual trajectory of the submersed warehouse and the mining ship during the linkage process of the mining system at a constant speed in order to further quantify this phenomenon of motion lag a comparative analysis of the results of the comparison between the actual trajectory of the intermediate bin and the ideal trajectory ideal trajectory means that in the linkage process the viscous force of seawater the inertial force of the system and the structural damping force of the pipeline are ignored during the increase of the linkage speed is from 0 5 m s to 1 5 m s the calculation results are shown in fig 16 the difference between the ideal trajectory and the actual trajectory of the submersed warehouse is extracted and the average value between the two is found the relationship curve between the movement offset of the submersed warehouse and the linkage speed as shown in fig 17 in figs 16 and 17 there are a deviation between the actual trajectory of the submersed warehouse and the ideal trajectory and the movement of the submersed warehouse will lag behind the mining ship with the linkage speed increasing the trajectory offset of the submersed warehouse increases as well when the linkage speed is 0 5 m s the average offset of the submersed warehouse movement reaches 1 51 m and when the speed increases to 1 5 m s the offset increases to 7 03 m this is because the movement of the mining ship is transmitted to the submersed warehouse through the hard tube and the movement of the submersed warehouse lags behind the mining ship due to the impact of the fluid load when the pipeline system moves in the sea the greater the linkage speed is the greater the drag force on the pipeline system and the intermediate tank become and the more obvious the hysteresis of the movement shows when there is a large lag in the movement of the submersed warehouse under the effect of the pulling of the hard tube excessive node tension will also cause the submersed warehouse to swing back and forth 4 2 2 effect of linkage speed on slurry conveying hose spatial shape in the ore lifting system the slurry conveying hose is connected to the submersed warehouse and the mining machine through the pipe connection device giving the mining machine a larger collection range in the process of linkage the movement of the slurry conveying hose has great uncertainty and the double saddle shaped structure of the slurry conveying hose in the actual linkage process is the premise to ensure the effective transportation of ore particles raed and guedes soares 2018 it can be seen from the calculation results in section 4 2 1 that when the linkage speed is large there is a large deviation between the actual trajectory of the submersed warehouse and the ideal trajectory which easily leads to instability of the ore lifting system in order to facilitate the analysis of the mutual positional relationship between the slurry conveying hose and the submersed warehouse in the connection process the slurry conveying hose space configuration projection of the slurry conveying hose at different connection speeds is formed by the slurry conveying hose unit and the intermediate center of mass coordinates to form an extraction warehouse the results are shown in fig 18 from the calculation results in fig 18 we can see that the slurry conveying hose can still maintain a clear double saddle shape under different linkage speed of the mining system but the greater the linkage speed the greater the offset of the slurry conveying hose backward it is because of the greater the interlocking speed the greater the fluid drag force on the slurry conveying hose which results in a greater deviation of the slurry conveying hose backward at the same time the movement offset of the connection between the slurry conveying hose and the submersed warehouse is smaller than other parts it is because the submersed warehouse has a larger mass than the hard tube and has a strong anti interference ability so the offset of the slurry conveying hose near the submersed warehouse is small 4 3 linkage direction analysis during the linkage process of the mining system it is divided into horizontal linkage and vertical linkage the schematic diagram is shown in fig 19 in order to analyze the linkage characteristics of the ore lifting system under different linkage directions the system dynamics characteristics under horizontal and vertical linkage motions need to be compared and analyzed when moving at a constant speed the system moving speed is set to 0 5 m s and the moving time to 200 s and the displacement curves of the submersed warehouse and the mining ship in two different directions are obtained the calculation result is shown in fig 20 fig 20 indicates the actual motion trajectory of the submersed warehouse maintains a certain degree of followability with the ideal motion trajectory in the horizontal and vertical directions it shows that the mining machine can maintain certain stability in the horizontal and vertical linkage directions in order to analyze the effect of the linkage process in different directions on the spatial configuration of the slurry conveying hose the calculation results of the three dimensional distribution shape of the slurry conveying hose system within 200 s of movement are extracted as shown in fig 21 from the calculation results of figs 20 and 21 the difference between the actual trajectory and the ideal trajectory is slightly smaller than the difference between the actual trajectory and the ideal trajectory when it is vertically linked moreover during longitudinal linkage the deformation of the slurry conveying hose is more pronounced and the double saddle peak point swings left and right this is because the double saddle shaped slurry conveying hose has a larger bearing surface under the action of seawater when it is longitudinally linked in the horizontal link under the action of the mining machine the slurry conveying hose is equivalent to the pull effect between the front and rear so it can maintain a stable shape therefore in the actual linkage process the vertical linkage mode should be minimized 4 4 effect of lateral drift movement of mining ships on the pipeline system affected by various factors such as complex external environment control accuracy monitoring error and other factors the deviation of the mining machine from the central axis will be inevitable the impact of the mining ship drift distance on pipeline system is studied when the drift distance is 0 m 25 m 50 m 75 m by setting the initial position of the mining ship and extracting the unit coordinates of the pipeline system the spatial configuration of the pipeline at different drift distances of the mining ship is obtained the calculation results are shown in fig 22 fig 22 shows that when the drift distance of the mining ship increases from 0 to 75 m the lateral displacement of the pipeline system increases significantly when the initial drift distance of the mining ship is 25 m the lateral displacement of the submersed warehouse at the end of the pipeline system is 9 56 m when the initial drift distance of the mining ship is 75 m the lateral displacement of the submersed warehouse at the lower end of the pipeline system is 58 2 m which is about 6 times that of the former at the same time the lateral displacement of the lower end of the pipeline system is smaller than the lateral displacement of the upper end of the pipeline system and the movement of the lower end lags behind the upper end this is because the quality of the submersed warehouse connected to the lower end of the piping system is greater than the quality of the piping unit and the submersed warehouse has no power source under the action of inertial force and hydrodynamic force the movement of the lower pipeline unit is contained the initial position offset value of the mining ship will affect the initial state of the mining system the greater the lateral initial offset of the mining ship the more the overall deviation of the pipeline system from the axis in order to study the influence of the lateral drift of the mining machine on the stress of the pipeline system the bending moment change data of the rigid pipe at different initial offsets of the mining machine were extracted the curve of the bending moment of the hard tube under different offsets as shown in fig 23 is obtained from the calculation results in fig 23 the place where the bending moment of the hard tube is relatively large mainly occurs at the top end of the hard tube and the bottom end of the hard tube the bending moment of the middle section of the hard tube is much smaller than the top and bottom end it is since the top of the hard tube is connected to the mining ship the movement resistance is small and the movement response is fast so the bending moment of the pipeline unit close to the mining ship is large the submersed warehouse at the bottom of the hard tube is prone to speed fluctuations due to its large volume and large mass under the action of its inertial force and hydraulic force therefore the bending moment of the piping unit near the submersed warehouse is also greater than the bending moment of the middle part when the drift distance is 75 m the maximum bending moment at the top of the pipeline system is 5000 n m and the maximum bending moment at the bottom is about 4500 n m meanwhile as the drift distance of the mining ship increases the bending moment of the middle section also gradually rises but it is still smaller than the bending moments of the top and bottom ends of the pipeline therefore when designing the pipeline system it is necessary to control the drift distance of the mining ship relative to the pipeline system otherwise it would cause damage to the pipeline system 5 conclusion and suggestion based on the physical model of the deep sea mining and lifting system this paper made a 3000 m deep sea mining and lifting system virtual prototype analysis model to go on researches analyzed the dynamic characteristics of the longitudinal vibration and lateral linkage of the ore lifting system and carried out the experimental research the research conclusions of the paper are as follows 1 under the excitation of the mining ship heave motion the heave response amplitude of the submersed warehouse also increases with the increase of the pipeline length with the influence of the fluid drag force the heave response curve of the submersed warehouse is not strictly a harmonic motion but fluctuates up and down in a similar cycle as the mining ship the nodal force at the connection between the submersed warehouse and the hard tube in the pipeline system becomes bigger and bigger with the increase of the mining ship heave amplitude as the drift distance of the mining machine rises the bending moment in the middle section also gradually increases but the bending moment suffered by the pipeline system mainly occurs at the top and bottom of the pipeline system 2 with the increase of the linkage speed the maximum value of the displacement deviation of the trajectory of the submersed warehouse increases in proportion to the speed the linkage direction of the mining system has little influence on the movement offset of the submersed warehouse and the horizontal linkage is more conducive to the stability of the slurry conveying hose system than the vertical linkage credit authorship contribution statement wei chen writing original draft formal analysis funding acquisition hai liang xu writing review editing funding acquisition neng peng data curation fang qiong yang supervision peng lin project administration declaration of competing interest the authors declare that they have no known competing financialinterestsor personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china 51775561 52006061 natural science fund of hunan province 2018jj2522 hunan provincial department of education project 20b327 18a419 hunan province key research and development program 2019sk2192 2020nk2063 science and technology project of hunan provincial water resources department xskj2019081 56 
20646,in this article based on the dynamic response of the mining ship and the mining machine in different linkage modes the virtual prototype model of the ore lifting system and the pipeline system load model in the marine dynamic environment are established under different excitation environments the motion response dynamic response and spatial configuration characteristics of the ore lifting system under different linkage speeds and different linkage directions of the mining ship and the mining machine are studied the results of the research demonstrated that the sinking motion of the mining machine is stimulated and the sinking response amplitude of the submersed warehouse is on the rise as the length of the pipeline increases the heave response curve of the submersed warehouse is not strictly a simple harmonic motion but fluctuates up and down in a similar period as the mining ship the nodal force at the connection between the submersed warehouse and the hard tube in the pipeline system increases with the increase of the mining ship s heave amplitude with the growing linkage speed the maximum value of the displacement deviation of the trajectory of the submersed warehouse increases in proportion to the speed the linkage direction of the mining system has little effect on the movement offset of the submersed warehouse and the horizontal linkage is more conducive to the stability of the slurry conveying hose system than the vertical linkage keywords deep sea mining ore conveyor system pipe space configuration kinetics analysis stress analysis 1 introduction the function of the deep sea mining ore lifting system is to raise the ore collected by the seabed mining machine to the mining ship on the sea surface the united states germany france japan south korea and some other countries have conducted such theoretical and experimental research on this the mining method for collecting seabed ore consisting a mining machine to hydraulically lift the ore first then to lift the ore to the sea surface mining machine through a pipeline yoon et al 2007a 2007b fang qiong et al 2006 the structural composition of the deep sea mining lifting system is shown in fig 1 the mining system is mainly composed of slurry conveying hose buoyancy module slurry pump hard tube mining ship submersed warehouse mining machine etc sun et al 2017 during the operation of deep sea mining the mining machine collects the polymetallic nodules present on the bottom of the sea after desilting and crushing it flows into the submersed warehouse from the slurry inlet through the slurry conveying hose under the suction of the slurry pump the ore is transported by a hard tube to the mining ship hailiang 2008 hengling and shaojun 2018 felippa and chung 1981 the dynamic characteristics of the ore lifting system and the dynamic response of the subsystem are not only related to the safe operation of the mining system but also have played a vital role in the early stage of system design and system safety check previous scholars have already done a lot of researches on pipeline system dynamics of the deep sea mining lifting system hereinafter referred to as the ore lifting system the methods of analysis include finite element method and the discrete element method on the one hand the finite element method can flexibly model the lifting pipeline and fully consider the complex dynamic characteristics of the ore lifting system however due to the complex non linear characteristics of large displacement and large rotation in the pipeline of the ore lifting system the finite element method still has some problems in convergence on the other hand compared with the finite element method the discrete element method is superior regarding the issue of the convergence of pipeline system dynamics calculation hong and shah 2018a found out the geometric non linear characteristics of the pipeline and then analyzed the spatial configuration of 1000 m mining system under both forward and reverse flow conditions on the basis of the finite element method chung 2009 simplified the pipeline into non linear beam elements and established a finite element model using the incremental newton raphson method iterative solution to study the linkage speed the mining ship and the mining machine move together referred to as linkage linkage speed refers to the speed of mining ship and mining machine when they move in the same direction and at the same speed and the submersed warehouse of the mining system pipeline offset characteristics under different factors such as quality and subsystem connection based on the abaqus finite element analysis solver hong et al hong and shah 2018b studied the instability of ocean riser systems under the action of ocean currents and proposed a probabilistic fracture mechanics analysis method for pipelines the finite element method is mainly used in the research of the pipeline stress and system configuration but it is difficult to simulate the dynamic response of the overall linkage process linkage process refers to the process that the mining ship and the mining machine move together regarding the research of the pipeline system chen yuxiang et al chen et al 2014 first compared the analytical solution with the dynamic simulation solution of the classical forced beam vibration problem to build a multi body dynamic model of the mining slurry conveying hose the spatial shape and unit stress of the pipeline obtained by the numerical simulation was consistent with the testing results ling sheng et al sheng et al 2002 focused on the non uniform distribution of the system pipeline stress along its axis they proposed a stepped pipeline system and analyzed the influencing factors of the stepped mining system movement state from the aspects of layout design system operation control etc wang gang wang 2009 took the degree of distortion of the horse saddle shape as a safety evaluation standard and mentioned that the submersed warehouse was used as the center to establish a dynamic operation safety zone for the mining machine and a real time query table for the dynamic parameters of the mining machine safety domain based on the discrete element method adamiec et al 2015 introduced the theory of large deflections of large deformation planar slender rod systems charles et al charles et al 1986 studied the resonance problem of a 5846 m mining pipeline and found that the axial stress was the designing stress of the pipeline rather than the bending stress in the aspect of hydraulic analysis and system linkage of lifting pipe oh et al 2014 made an in depth study and deduced the variation law of the total hydrodynamic force following time and seawater depth raed et al raed and guedes soares 2018 conducted a wind tunnel test according to the similarity theory for the slurry conveying hose section of the mining system with the consideration of the edge effect and obtained the discrete test data of the drag coefficient with the angle of wind and the reynolds number by referring to the nonlinear finite element theory and the load increment method the spatial shape of the slurry conveying hose during the movement of the mining machine is observed li yan 2009 established a virtual prototype of a mining system using the commercial multibody dynamics software adams to analyze the overall linkage characteristics of the mining system under different linkage speeds ocean current speeds and downstream and upstream conditions dai yu dai 2013 successfully established a virtual prototype model of a 1000 m mining system with the help of adams and recurdyn the system linkage characteristics of the system in two different acquisition modes horizontal foldback and vertical foldback are analyzed iwona adamiec wojcik et al 2015 analyzed the motion characteristics of the mining system and acquired the results of the estimated fluid load and deformation of the slurry conveying hose connection section of the submersed warehouse liu shaojun et al liu et al 2003 established a 1000 m mining system simulation analysis virtual prototype model carried out dynamic simulation analyses on the process of system deployment recovery obstacle crossing and climbing which provided a preliminary research basis for visual research on deep sea mining systems zhi wang et al wang et al 2012 observed that when the mining machine travels in a straight line the slurry conveying hose can maintain a complete s shape and the lateral runout displacement near the mining machine during the linear travel is greater than the lateral runout near the submersed warehouse under the support of the finite element analysis method the author of this paper formed a finite element analysis model of the mining system analyzed the spatial configuration of the pipeline system and the flow characteristics of fluid in pipes when the mining machine was in different positions xu and xu 2008 xu et al 2012 xu et al 2019 xu et al 2020 the results of liu shaojun liu et al 2003 et al mentioned that the researchers have paid lots of effort and obtained useful information on the overall dynamics of the mining system and the dynamic response of the subsystems and have a deep understanding about the motion response of the mining system in various states but in fact the subsystems in the pipeline system usually have a strong coupling for example the coupling between the heave motion and lateral motion of the mining ship on the other hand the influence of the initial position of the mining ship and the axis of the lifting pipe on the dynamic characteristics of the pipeline system is negligible in the process of pipeline system linkage unconventional movements such as acceleration and deceleration are inevitable as well in the paper based on the mining ship and the mining machine in different linkage modes the virtual prototype model of the ore lifting system and the pipeline system load model in the marine dynamic environment are established moreover the analysis of the motion response of the ore conveying equipment at the lower end of the lifting pipe for deep sea mining operations is also shown in this paper 2 model analysis 2 1 main technical parameters of the mining system with reference to the overall design of a 1000 m offshore pilot test system for ocean polymetallic nodules chen 2006 the deep sea mining system is mainly composed of a terminal acquisition system an ore lifting system and an ore transfer transit system the ore lifting system covers a hard tube system and a slurry conveying hose system compared to the 3000 m mining system and the 1000 m mining system their slurry conveying hoses are both 400 m long and the only difference is that their hard tube lengths are different the hard tube top of the ore lifting system is connected to the mining ship through the moon pool and the connection part is equipped with a motion compensation device in the mining system the submersed warehouse is located at a height of 100 m from the seafloor which is connected to the bottom end of the lifting hard tube the two ends of the slurry conveying hose are connected to the mining machinery and the submersed warehouse respectively the slurry conveying hose has a double saddle shape due to the buoyancy module which can provide the mining machinery with greater freedom of space collection to cope with the complex and changeable deep sea environment this configuration can provide a wide range of collection for mining machines it is based on the technical design research report of the mining pilot system of the china oceanic association in the tenth five year plan tenth five year plan mining sea trial system chief engineer group 2004 and deep sea equipment technology research report china s first deep sea li 2016 the main technical parameters of the 3000 m deep sea mining lifting system are shown in table 1 according to the statistical results of the literature janarthanan et al 2019 park et al 2011 chen et al 2020 tang 2004 the maximum velocity of ocean currents passing through mining areas in china is 1 7 m s nevertheless the literature only indicates the seabed velocity which varies between 0 01 m s and 0 1 m s and does not present the law of the variation of the current velocity with the coastal water depth in the paper the variation rule of the coastal water depth maximum calculation depth is 5000 m is calculated with the graphical change rule provided in wu 2011 taking the ocean surface current velocity of 1 7 m s as an example the calculation formula is as follows 1 v c 0 1 1 6 5000 z 5000 12 where z is the distance from the ocean surface m and v c is the ocean current velocity at z m s as is shown in fig 2 the ocean current velocity decreases with increasing seawater depth from 0 to 1000 m the ocean velocity declines almost linearly as the sea depth increases when the seawater depth are between 2000 and 5000 m the current velocity is stable at around 0 1 m s 2 2 virtual prototype physical model the overall size of the deep sea mining ore lifting system is huge and the internal structure of the system is complicated although the dynamic analysis model of the ore lifting system has been built the internal details of each structural part are not so delicate in the modeling process the energy supply system measurement and control system are regarded as equivalent mass which are added to submersed warehouse and mining machine respectively 2 2 1 model assumptions according to the schematic diagram of the 4000 m deep sea mining lifting system shown in fig 1 the virtual prototype model was established in a ratio of 1 1 to facilitate calculations the following assumptions need to be made before modeling 1 mining ship and mining machine only cover their mass size location of the center of mass and connection method with pipelines while the detailed characteristics of each part were disregarded 2 there were a complicated feeding and feeding mechanisms inside the submersed warehouse the internal details were ignored while modeling and it was equivalent to a mass of 6m 8m 8m length width height 3 the influence of internal flow in the pipeline was not considered 2 2 2 physical model of mining ship and mining machine the mining ship is different from the traditional ship the mining ship must cooperate with the mining machine on the seabed and move together to complete the mining operation at the same time the bottom of the mining ship is also connected with a massive pipeline transportation system and the complex deep sea operating environment requires the use of a heave compensation device referring to the introduction in the literature wu 2011 of china ship science research center the overall dimensions of the mining ship are shown in table 2 during the process of modeling the physical simulation system the overall size and shape of the mining ship mining machine and intermediate tank are designed with the help of ug 5 0 then through the interface technology between ug 5 0 and adams 2018 the generation of the dynamic analysis model is imported into adams 2018 the physical model of the dynamic analysis of the mining ship and the mining machine is shown in fig 3 2 2 3 physical models of hard tube and slurry conveying hose the design of the mining pipeline system refers to the design standards and strength criteria of the deep sea vertical oil and gas pipeline sapietova et al 2017 the hard tube material is p110 steel slurry conveying hose specific parameters are shown in table 3 the application of the discrete element method is used to model pipeline with a certain number of rigid body elements the total length of the hard tube is 4000 m which is divided into 20000 units and each unit length is 0 2 m rigid body elements can simulate their movement characteristics as these elements are connected by sleeve forces the joint of the top of the hard tube and the moon pool of the mining ship are connected by a ball hinge the submersed warehouse and the lower end of the hard tube are connected by a cross hinge because the slurry conveying hose has greater flexibility and less interference with the mining machine a rigid connection between the slurry conveying hose and the mining machine is adopted when building a hard tube model first discretize the rigid body elements of the pipe and then add a sleeve force between every two small elements the mechanical model of sleeve force is shown in fig 4 a in fig 4 a fx fy fz tx ty and tz are the six forces and moment components of the sleeve force the hard tube model is shown in fig 4 b the modeling idea of the slurry conveying hose resembles the hard tube but the physical characteristics of the slurry conveying hose are different from the hard tube in the system the total length of the slurry conveying hose is 400 m which is divided into 800 units and each unit length is 0 5 m in order to ensure that the mining machine has sufficient collection space the slurry conveying hose is provided with a buoyancy module to keep it in the double saddle shape the slurry conveying hose model is shown in fig 4 c 2 2 4 load analysis 1 pipeline gravity the self weight g p of the pipeline unit with length l is 2 g p π 4 g ρ g d 2 d 2 l the self weight of the fluid in the tube unit of length l is 3 w l π 4 g ρ m d 2 l the buoyancy f of a pipe unit of length l is 4 f π 4 g ρ w d 2 l where ρ g is the density of the selected pipeline material kg m3 ρ m represents the mixed density of the ore slurry kg m3 ρ w is the density of seawater ρ w 1037 kg m3 d is the outer diameter of the pipeline m and d is the inner diameter of the pipeline m 2 fluid load when ocean currents and waves pass through marine structures the fluid loads on the pipeline system are mainly inertial forces and drag forces which are related to the acceleration of movement of the waves and current water particles relative to the ocean structures the diameter of the transverse structure of the deep sea mining system pipeline is relatively small compared with the wavelength and it is a small isolated elongated rod shaped structure the system space coordinate description of morison equation under wave action is shown in fig 5 as shown in fig 5 the flow direction is defined as the positive x axis direction the positive y axis direction is perpendicular to the sea level and the x z plane is the sea level taking a infinitesimal body dy at any depth y of the mining pipeline the hydraulic force f h experienced by the infinitesimal body can be expressed as 5 f h 1 2 c d ρ w d u x x u x x 1 4 π c m ρ w d 2 u x t 1 4 π c m ρ w d 2 x where c d is the drag coefficient c m is the inertial coefficient c m is the additional mass force coefficient u x is the horizontal velocity of the sea water particle at position y m s x x and x are the horizontal displacement horizontal velocity and horizontal acceleration of the pipeline at position y respectively according to the linear wave theory in ultra deep water banerjee et al 2014 the available expressions of wave particle velocity and acceleration are as follows 6 u x h 2 ω e k z c o s k x ω t 7 u x t h 2 ω 2 e k z s i n k x ω t in equations 6 and 7 ω 2 π t k ω 2 g where ω is the circular frequency rad s t is the wave period s h is the amplitude m k is the wave number and g is the acceleration of gravity g 9 8 m s2 the drag coefficient c d the inertia coefficient c m and the additional mass force coefficient can be taken as 1 2 2 0 and 1 847 banerjee et al 2014 2 3 pipeline system model as shown in fig 6 a tiny unit dx at any pipeline depth x can be taken as the analyzed pipeline unit and the internal forces on the two sections u and u dx are n and n 1 n n x dx according to the darren bell principle the longitudinal vibration equation of the lifting pipe is as follows 8 e a x c 0 c 1 δ x l 1 c 2 δ x l 2 u t m x 2 u t 2 where u is the vertical displacement of the pipeline unit m a x is the cross sectional area of the lifting pipe m2 c 0 represents the viscous damping coefficient of the mining pipe c 1 and c 2 are the equivalent damping coefficients of the slurry pump and the submersed warehouse l 1 and l 2 are the longitudinal depth the slurry pump and the submersed warehouse δ x is the dirac delta function and m x is the quality of the lifting pipe unit and the quality of the attached components kg m x can be expressed as 9 m x m 0 x m p 1 δ x x 1 m z δ x x 2 where m 0 x is the mass per unit length of the lifting pipe kg m p1 x is the quality of the slurry pump kg and mz represents the quality of the submersed warehouse kg if the top of the lifting pipe has the same movement law as the mining ship the initial boundary conditions of the equation are extracted and the boundary conditions can be written as follows 10 u 0 t u 0 t a s i n ω t u x x l 0 where u 0 t is the displacement of the top of the lifting pipe m and a is its amplitude m it is consistent with the displacement of the mining ship the solution of equation 8 can be expressed as follows 11 u x t 2 l i 1 n b i t sin 2 i 1 π x 2 u o t i 1 2 3 where b i t is the undetermined function of time substituting equation 11 into equation 8 using the galerkin method the following equation can be obtained 12 i 1 n a k i b i t b k i b i t c k i b i t d 1 k u t p 1 k u 0 t p 2 k u 0 t k 1 2 n where a k i δ k i 2 m 1 ϕ i l 1 ϕ k l 1 m 2 ϕ i l 2 ϕ k l 2 b k i δ k i 2 c 0 c 1 ϕ i l 1 ϕ k l 1 c 2 ϕ i l 2 ϕ k l 2 c k i e a 2 n 1 2 π 2 2 δ k i d k i 2 k 2 k 1 π p 1 k 2 2 k 1 π m 1 ϕ k l 1 m 2 ϕ k l 2 p 2 k 2 c 0 2 k 1 π c 1 ϕ k l 1 c 2 ϕ k l 2 k 1 2 where δ k i is the dirac delta function the parameters a b c d u p 1 and p 2 are defined as the following vectors a a k i b b k i c c k i d d 1 k u u v i p 1 p 2 k p 2 p 2 k the state variable x is defined as follows 13 x b 1 b 2 b n b 1 b 2 b n t bringing in variables the state equation under a linear time varying system could be expressed as the equation 14 x e x f u h w 15 u v t g x t in the above formula state matrix e 0 i input matrix f 0 e 1 d external interference matrix h e 1 p 1 e 1 p 2 system interference vector w u 1 u 0 t system interference vector g ϕ 1 ϕ 2 ϕ n 0 0 0 for the lqg linear quadratic gaussian control optimal control problem of the vibration control of the lifting pipe the quadratic performance index j as follows 16 j 0 0 l 2 u v 2 r u 2 t d t 0 0 l 2 x g t g x t r u 2 t d t 0 0 l 2 u v t t u v t r u 2 t d t the first term of the integrand in equation 20 is the inherent displacement response of the lifting pipe and the second term is the displacement response of the active control mechanism r is a weighted value representing the weighted proportion of the second term relative to the first term function according to the separation principle the optimal state feedback vector for control action is as follows 17 u t k x t the state feedback gain matrix k in the above formula is the equation 18 k r 1 fp the p value in the above formula can be obtained by solving the riccati matrix equation 19 p e e t p r 1 p f f t p h t h 0 therefore the closed loop system can be expressed as 20 x e f k x cw 21 u v gx 3 model validation laboratory testing were performed on a 1 1000 scaled deep sea mining system models to study the hydrodynamic forces induced on the ore lifting pipeline system by the passage of regular waves the ratio of the model to the real object is 1 1000 3 1 experimental principle and experimental instrumentations in order to study the linkage characteristics of the deep sea mining lifting system an experiment platform for the deep sea mining lifting system was made according to the similarity laws the experimental platform consists of a measurement and control system a motion control system and a mechanical structure system the design principle of the experimental system is shown in fig 7 a the experimental site is shown in fig 7 b all tests were carried out in the national key laboratory of high performance and complex manufacturing of central south university china the tests were carried out at constant water depth of 4 m which allowed modelling of deep offshore waves the piston type wavemaker can produce both regular and irregular waves wave absorbers at the flume end were mitigating the wave reflection an interface device was used to communicate two independent data systems together the wave iee software provided by zhejiang daming automobile electronic co ltd china was used for data acquisition synchronization of the sensors and signals and post processing analysis of the outputs the waves were selected based on the wave flume limitations the scaling rules by the technical design research report of the mining pilot system of the china oceanic association in the tenth five year plan tenth five year plan mining sea trial system chief engineer group 2004 the wavelengths were estimated using the dispersion equation and all wave cases were meeting the deep water conditions the fresh water in the flume had a mean density of 1001 kg m3 the water temperature was monitored over the course of the experiments the temperature effect on the water density was estimated using faltinsen recommendations and remained below 0 05 faltinsen 1993 to ensure the repeatability of the devices and the measuring system each experiment was repeated five times and the experimental measurement results were its average value a time interval of 20 min was considered between the consequent tests to achieve a calm water condition a number of tests were also repeated in the ore conveying system is not started to verify the performance of the wave flume and the measuring instruments the sampling rate in the wave gauges was 100 hz the standard linear displacement method was used for the wave gauges calibration wherein the relative water level at each gauge was changed at known intervals the relative water level data was correlated against the measured voltages the accuracy of wave gauges was 0 4 mm and the coefficient of variation is 0 35 four underwater cameras were synchronized together to collect simultaneous images from the pipeline system movements during the test the frame rate was set to 15 hz time series of the forces induced by regular waves passing through the hard tube of ore lifting system was measured using load cells fixed at far end of each mooring line prior to each test series the load cells were calibrated using loads applied by known weights the calibration was repeated at the end of each test series the load cells found to remain linear nonhysteresis and to present relatively constant calibration coefficients all over the experiments for each test the steady state portion of the signal which included around 100 wave force moment cycles was selected for data analysis the steady state portion of the measurements was assumed to start after about 10 wave force moment cycles from the wave arrival at upstream wave gauges during the experiment the simulated hoisting hard tube consisted of 100 sections of steel pipe with a length of 10 cm the slurry conveying hose is made of a composite rubber tube with a length of 1 m and a diameter of 5 5 mm the buoyancy module was simulated by adding rope suspension weights at specific locations the submersed warehouse is a rectangular aluminum block with spherical hinge joints at both ends the mining ship is replaced by a synchronous belt motion module assembly the replacement of the simulated mining machines by an automatic tracking trolley and a black strip is pasted on the sink bottom to simulate the movement trajectory of the trolley the froude similarity law was applied for the scaling of the physical model and the wave regime the geometric mechanical specification of the scaled ore lifting system model used in the current experiments are presented in table 4 in the experimental system the movement speed of the mining machine and mining ship can be adjusted within a certain range first under the action of the hydrodynamic load only a static experimental test is performed and analyzed then analyze the configuration of the pipeline system during the system linkage process the linkage process refers to the process in which the mining ship and the mining machine move at the same time the measurement points during the experiment are shown in fig 8 3 2 experiment procedure first start and debug each part of the experimental system separately adjust the relative position of the laser probe high speed camera lens and measurement point to ensure the accuracy of the data collection position of the measurement point then start the synchronous belt module assembly and automatic tracking trolley adjust their speeds to be consistent with the experimental preset value start the motion system and measurement and control systems and read the measured data after the system runs smoothly last adjust different parameters and repeat above steps to obtain comprehensive experimental data 3 3 analysis of test results 3 3 1 static experiment results when the wavelength wave height and wave steepness are the same only change the wave velocity test the displacement of o1 o2 and o3 the average horizontal displacement of measurement points o1 o2 o3 at different wave velocity are shown in table 5 it can be seen from the test results in table 5 that under static conditions as the wave velocity increases the horizontal displacement value of the measurement point becomes larger when the wave is maintained the horizontal displacement value of point o1 is the largest followed by point o2 and the smallest one o3 the reason for it is due to the wave load proportional to the cross sectional area of the structure the load area of the submersed warehouse is greater than the load area of the hard pipes and slurry conveying hose which causes the maximum displacement value near the submersed warehouse however o2 and o3 are both at the buoyancy module point of the slurry conveying hose and the displacement of the o3 point is limited by the mining machine at the end of the slurry conveying hose resulting in the displacement value of o3 point being less than o2 point the numerical calculation result is slightly larger than the experimental test result but the gap of errors between the two is within 9 this is because in the numerical calculation the hydrodynamic load is obtained through theoretical calculation and then is added to the designated measurement point in the form of discrete values during the simulation experiment the hydrodynamic load is dispersed by the environment resulting in the hydrodynamic load at the measurement point being lower than the theoretical calculation value so the experimental measurement result is slightly lower than the numerical calculation result more or less 3 3 2 dynamic experiment results based on the limitations of the experimental site in order to simulate the hydraulic force of ocean current flow only the second wave velocity the maximum wave velocity is 5 04 m s was selected under dynamic experimental conditions it can be true that the analysis of the position offset of the submersed warehouse during the linkage process of the mining system is realized through simulation experiments to obtain the experimental test results and numerical calculation results the time history curve of the submersed warehouse is shown in fig 9 in fig 9 the linkage speed refers to the speed of the mining ship and the mining machine when they move in the same direction and at the same speed from the numerical simulation results and experimental test results shown in fig 9 it can be seen that when the linkage speed of the mining ship and the mining machine is 0 05 m s the displacement of the submersed warehouse in the experimental test oscillates between 16 43 mm and 16 73 mm at this time the submersed warehouse of the numerical simulation oscillated slightly around 16 2 mm and the vibration amplitude was much smaller than the experimental test result when the linkage speed is 0 25 m s the displacement of the intermediate chamber tested in the experiment oscillates between 24 31 mm and 26 72 mm at this time the numerical simulation of the submersed warehouse oscillated slightly around 24 52 mm and its vibration amplitude was much smaller than the experimental test results at this time the experimental results and numerical simulation results show that when the linkage speed is different the displacement difference of the submersed warehouse is small and the error is within 9 the comparative analysis of the experimental results and the numerical calculation results show that the mathematical model of the mining system established in the paper has good adaptability as for why the vibration amplitude of the submersed warehouse measured by the experiment has a big difference when the linkage speed is 0 05 m s and 0 25 m s it may be due to the increase in flexural deformation of the pipeline as the linkage speed increases under the combined action of the damping force of the pipeline structure the inertial force and the seawater hydraulic power irregular random vibrations occurred in the submersed warehouse installed at the lower end of the pipeline and the greater the linkage speed the greater the vibration amplitude 4 linkage characteristic analysis 4 1 response of mining ship heave motion due to the harsh sea conditions the longitudinal vibration of the ore lifting system in the ocean current would lead to the longitudinal deformation and axial tension fluctuation of the pipeline system the factors that affect the safety of the pipeline system mainly include the heave movement of themining ship the parameters of the pipeline system and the current flow velocity changes xu et al 2020 liu et al 2016 when the ore lifting system is operating in the ocean the magnitude and direction of the current speed change with time and space in order to simplify the analysis process the paper only considers the ocean current flow rate at a constant speed on the linkage characteristics of the mine pipeline system into consideration first of all the influence of a single factor on the dynamic response of the pipeline system is analyzed after mastering what the influence of a single factor is the change law of tension and movement of the ore lifting system under the combined action of multiple factors is analyzed 4 1 1 analysis of heave movement of mining system with a different pipeline length the displacement of the mining ship heave movement is affected by many factors such as the mining ship type structure and size but the mining ship movement displacement is generally smaller than the wave height therefore it is assumed that the motion of the mining ship can be expressed by simple harmonic motion and the period of the simple harmonic motion is equal to the wave period given that the wave height is h and the wave period is t the heave displacement of the mining ship can be expressed as 22 y s y s a s i n 2 π t t in equation 22 y s a is the heave amplitude of the mining ship referring to the reference faltinsen 1993 when the sea condition level is 4 and the speed is 1kn 0 514 m s the expression of mining ship heave motion can be expressed as 23 y s 0 368 s i n 0 25 π t when the sea condition level is 5 and the speed is 1kn 0 514 m s the expression of mining ship heave motion can be expressed as 24 y s 0 742 s i n 0 2 π t the submarine manganese nodules are stored in the deep sea of 2000 to 5000 m the mining system responds differently to heave motion with different pipeline lengths according to equations 23 and 24 the heave motion amplitude of the mining ship reaches 0 368 m under the fourth level sea state under the fifth class sea conditions the heaving amplitude of the mining ship reaches 0 742 m regardless of the horizontal movement and rotation of the mining machine at sea the movement of the mining machine is set to vertical sinusoidal heave motion with an amplitude of 0 742 m and a period of 10 s the dynamic response of the pipeline system is analyzed when the pipeline length is 2000 m 3000 m 4000 m and 5000 m fig 10 is a comparison of the calculation results about the heave motion in the mining ship and the submersed warehouse at different seawater depths when there is only a sinusoidal heave excitation fig 10 indicates that when the mining ship performs heave motion with a certain heave amplitude and period the submersed warehouse at the lower end of the lifting pipe will also follow the mining ship to move up and down nonetheless this is not a strict harmonic motion response since the submersed warehouse would be affected by the drag force of seawater while responding to heave motion which interferes with its normal simple harmonic motion response similarly due to the dynamic coupling between the mining ship and the pipeline system the piping system has an inhibitory effect on the movement of the mining ship which causes the movement of the mining ship to produce a saw toothed slight oscillation despite the data without achieving a good curve the movement form of the mining ship still shows a sinusoidal curve law overall the longer the pipeline length is the greater the difference between the movement of the mining ship and the submersed warehouse appears when the pipeline length reaches 5000 m the amplitude of the submersed warehouse has obvious amplification and lag effects relative to the amplitude of the mining ship moreover the difference between amplification and hysteresis is obvious with different seawater depths since the sleeve force connection model is used at the connection of the hard tube unit during modeling this sleeve force connection model can be regarded as a spring damper unit in three directions therefore as the length of the pipeline increases the flexible connection unit plays a certain role in amplifying the mining ship s motion excitation besides the heave motion excitation of the mining ship is transmitted to the submersed warehouse through the hard tube so it is hard to avoid the phase lag effect of the motion response in order to study the influence of the horizontal movement of the mining ship on the longitudinal vibration of the submersed warehouse the mining ship was set to sail in the horizontal direction at a speed of 0 5 m s under the dynamic action of sea waves under the combined action of these two movements the movement response of the submersed warehouse is shown in fig 11 fig 11 a shows the motion response of the submersed warehouse when the pipe length is 2000 m fig 11 b shows the motion response of the submersed warehouse when the pipeline length is 5000 m from the calculation results of this figure it can be seen that whether the pipeline length is 2000 or 5000 m the impact of the horizontal movement of the mining ship on the longitudinal vibration of the submersed warehouse is mainly reflected in the aspects of its vibration under the action of horizontal movement the amplitude of the longitudinal vibration of the submersed warehouse has increased but the increase is not large 4 1 2 analysis of nodal forces at the first and last ends of the pipeline system based on the heave motion response of the mining system in different pipeline lengths the variation law of the nodal force at the top and bottom of the pipeline system in seawater depths from 2000 to 5000 m is obtained as shown in fig 12 the mean and maximum values of the first and last node force of the pipeline system are under different pipeline lengths it can be seen from the calculation results shown in fig 12 that as the length of the pipeline changes the nodal forces at the top and bottom of the pipeline system exhibit different laws the maximum force and average force at the top node increase as the length of the pipe increases when the pipeline length is 2000 m the maximum node force at the top is 113 3 kn when the pipeline length reaches 5000 m the top node force increases to 189 3 kn the latter is 1 67 times than the former the maximum and average values of the nodal force at the bottom almost keep the same condition under different pipeline lengths this is because the nodal force at the bottom of the lifting pipe mainly derives from the weight force and inertial force of the submersed warehouse although the heave motion of the mining ship will cause the tension fluctuation of the pipeline system the tension fluctuation caused by the heave motion is easily absorbed and dissipated by the flexible connection unit in the virtual prototype therefore adding flexible connection units at key connection points of pipeline systems such as submersible pumps submersed warehouse etc can serve as a shock absorber 4 1 3 motion response of the submersed warehouse under different heave amplitudes in order to explore the motion response of the submersed warehouse under different heave amplitudes of the mining ship setting the heave motion amplitudes of the mining ship are 0 2 m 0 4 m 0 6 m 0 8 m and 1 0 m respectively and the heave motion period is 10 s the center of mass of the submersed warehouse is setted as the target measuring point to detect the motion response of the submersed warehouse the time history curve of the motion response of the submersed warehouse is under different heave amplitudes as shown in fig 13 the amplitude of the motion response of the submersed warehouse under different heave motions is extracted and presented in table 6 as can be seen from fig 13 and table 6 the amplitude of the heave transportation of the submersed warehouse at the lower end of the lifting pipe increases with the increase of the heave excitation amplitude of the mining ship and its motion response magnification is about 1 89 times excited by the heave motion of the mining ship there is an amplitude amplification effect in the motion response of the mining system the main reason for the enlargement is that when the submersed warehouse installed at the lower end of the hard tube sinks with the mining ship the hard tube undergoes elastoplastic deformation under the action of inertial force and ocean current hydraulic forces it not only causes the hard tube to be elongated or compressed this effect not only will increase the instability of the subsystem and the reduction of the ore particle transport efficiency inside the submersed warehouse but also may cause fatigue damage to the pipeline system therefore when designing the deep sea mining pipeline system the connection between the mining ship and the hard tube needs to be equipped with wave compensation devices and other energy absorption devices it can also be seen from the calculation results shown in fig 13 that although the motion amplitudes of the submersed warehouse under different excitations are different there is little difference in the motion period it indicates that the motions of the submersed warehouse and the mining ship perform better followability 4 1 4 nodal force analysis of pipeline system under different heave amplitudes the amplitude of the mining ship s heave motion is affected by various parameters such as ocean waves and mining ship structure in order to study the relationship between the nodal force at the junction of the submersed warehouse and the hard tube with time the effect of the mining ship heave motion on the axial nodal force of the pipeline system is analyzed when the amplitude of the mining ship is 0 2 m 0 4 m 0 6 m 0 8 m and the heave period is 10 s the change of the force at the node between the submersed warehouse and the hard tube under different vibration amplitudes is analyzed fig 14 shows the calculation results of the variation law of the nodal force at the junction of the submersed warehouse and the hard tube with time under different heave motion amplitudes it can be seen from the calculation results in fig 14 that with the increase of the heave excitation amplitude of the mining ship the nodal force at the connection between the submersed warehouse and the hard tube is bigger when the heave amplitude of the mining ship is 0 2 m the nodal force varies between 0 579 and 0 574 mn when the heave amplitude of the mining ship is 0 8 m the nodal force varies from 3 119 to 3 165 mn this is because of the greater the heave of the mining ship the greater the motion response of the submersed warehouse located at the lower end of the hard pipe excessive heave motion response will cause instability of the movement of the submersed warehouse resulting in excessive force at the junction between the submersed warehouse and the hard tube at the lower end of the pipeline system when the amplitude of the mining ship is different the maximum tension and the maximum pressure of the node at the junction of the submersed warehouse and the hard tube is still very small it demonstrates that the movement of the submersed warehouse and the movement of the mining ship have better followability and it also shows that the mixed fluid in the hard tube has little effect on the joint force of the pipe the joint force between the submersed warehouse and the hard tube changes sharply with time and there is no obvious simple harmonic change law such as motion response it is because the submersed warehouse has an impact because of the inertial force and fluid drag force while doing heave motion 4 2 analysis of linkage movement of ore lifting system during the linkage process of the ore lifting system the dynamic characteristics of the entire system are affected by various factors such as the linkage speed of the system the linkage direction and the movement state of the mining ship analysis of the motion response of the subsystem of the ore lifting system during the linkage process could provide load forecasting for the ore lifting system 4 2 1 motion response of the submersed warehouse under different linkage speeds for the ideal seabed environment the linear linkage of the mining system is the most common acquisition mode in the acquisition process in the linear linkage process the submersed warehouse follows the movement of the system under the drag of the hard pipe and its movement law is unknown while considering the overall collection efficiency the movement offset of the submersed warehouse during the linkage process is also one of the most important reference factors to determine the linkage speed to focus on observing the movement of the submersed warehouse during the linkage process the actual trajectory of the submersed warehouse is used as the controlled object and set the overall linkage speed change as 0 5 m s 0 8 m s 1 0 m s 1 2 m s 1 5 m s by intercepting simulation animations at different times the linkage conditions of the ore lifting system at a different time when the linkage speed is 0 5 m s are obtained the results are shown in fig 15 from the simulation results in fig 15 which shows a certain lag between the actual trajectory of the submersed warehouse and the mining ship during the linkage process of the mining system at a constant speed in order to further quantify this phenomenon of motion lag a comparative analysis of the results of the comparison between the actual trajectory of the intermediate bin and the ideal trajectory ideal trajectory means that in the linkage process the viscous force of seawater the inertial force of the system and the structural damping force of the pipeline are ignored during the increase of the linkage speed is from 0 5 m s to 1 5 m s the calculation results are shown in fig 16 the difference between the ideal trajectory and the actual trajectory of the submersed warehouse is extracted and the average value between the two is found the relationship curve between the movement offset of the submersed warehouse and the linkage speed as shown in fig 17 in figs 16 and 17 there are a deviation between the actual trajectory of the submersed warehouse and the ideal trajectory and the movement of the submersed warehouse will lag behind the mining ship with the linkage speed increasing the trajectory offset of the submersed warehouse increases as well when the linkage speed is 0 5 m s the average offset of the submersed warehouse movement reaches 1 51 m and when the speed increases to 1 5 m s the offset increases to 7 03 m this is because the movement of the mining ship is transmitted to the submersed warehouse through the hard tube and the movement of the submersed warehouse lags behind the mining ship due to the impact of the fluid load when the pipeline system moves in the sea the greater the linkage speed is the greater the drag force on the pipeline system and the intermediate tank become and the more obvious the hysteresis of the movement shows when there is a large lag in the movement of the submersed warehouse under the effect of the pulling of the hard tube excessive node tension will also cause the submersed warehouse to swing back and forth 4 2 2 effect of linkage speed on slurry conveying hose spatial shape in the ore lifting system the slurry conveying hose is connected to the submersed warehouse and the mining machine through the pipe connection device giving the mining machine a larger collection range in the process of linkage the movement of the slurry conveying hose has great uncertainty and the double saddle shaped structure of the slurry conveying hose in the actual linkage process is the premise to ensure the effective transportation of ore particles raed and guedes soares 2018 it can be seen from the calculation results in section 4 2 1 that when the linkage speed is large there is a large deviation between the actual trajectory of the submersed warehouse and the ideal trajectory which easily leads to instability of the ore lifting system in order to facilitate the analysis of the mutual positional relationship between the slurry conveying hose and the submersed warehouse in the connection process the slurry conveying hose space configuration projection of the slurry conveying hose at different connection speeds is formed by the slurry conveying hose unit and the intermediate center of mass coordinates to form an extraction warehouse the results are shown in fig 18 from the calculation results in fig 18 we can see that the slurry conveying hose can still maintain a clear double saddle shape under different linkage speed of the mining system but the greater the linkage speed the greater the offset of the slurry conveying hose backward it is because of the greater the interlocking speed the greater the fluid drag force on the slurry conveying hose which results in a greater deviation of the slurry conveying hose backward at the same time the movement offset of the connection between the slurry conveying hose and the submersed warehouse is smaller than other parts it is because the submersed warehouse has a larger mass than the hard tube and has a strong anti interference ability so the offset of the slurry conveying hose near the submersed warehouse is small 4 3 linkage direction analysis during the linkage process of the mining system it is divided into horizontal linkage and vertical linkage the schematic diagram is shown in fig 19 in order to analyze the linkage characteristics of the ore lifting system under different linkage directions the system dynamics characteristics under horizontal and vertical linkage motions need to be compared and analyzed when moving at a constant speed the system moving speed is set to 0 5 m s and the moving time to 200 s and the displacement curves of the submersed warehouse and the mining ship in two different directions are obtained the calculation result is shown in fig 20 fig 20 indicates the actual motion trajectory of the submersed warehouse maintains a certain degree of followability with the ideal motion trajectory in the horizontal and vertical directions it shows that the mining machine can maintain certain stability in the horizontal and vertical linkage directions in order to analyze the effect of the linkage process in different directions on the spatial configuration of the slurry conveying hose the calculation results of the three dimensional distribution shape of the slurry conveying hose system within 200 s of movement are extracted as shown in fig 21 from the calculation results of figs 20 and 21 the difference between the actual trajectory and the ideal trajectory is slightly smaller than the difference between the actual trajectory and the ideal trajectory when it is vertically linked moreover during longitudinal linkage the deformation of the slurry conveying hose is more pronounced and the double saddle peak point swings left and right this is because the double saddle shaped slurry conveying hose has a larger bearing surface under the action of seawater when it is longitudinally linked in the horizontal link under the action of the mining machine the slurry conveying hose is equivalent to the pull effect between the front and rear so it can maintain a stable shape therefore in the actual linkage process the vertical linkage mode should be minimized 4 4 effect of lateral drift movement of mining ships on the pipeline system affected by various factors such as complex external environment control accuracy monitoring error and other factors the deviation of the mining machine from the central axis will be inevitable the impact of the mining ship drift distance on pipeline system is studied when the drift distance is 0 m 25 m 50 m 75 m by setting the initial position of the mining ship and extracting the unit coordinates of the pipeline system the spatial configuration of the pipeline at different drift distances of the mining ship is obtained the calculation results are shown in fig 22 fig 22 shows that when the drift distance of the mining ship increases from 0 to 75 m the lateral displacement of the pipeline system increases significantly when the initial drift distance of the mining ship is 25 m the lateral displacement of the submersed warehouse at the end of the pipeline system is 9 56 m when the initial drift distance of the mining ship is 75 m the lateral displacement of the submersed warehouse at the lower end of the pipeline system is 58 2 m which is about 6 times that of the former at the same time the lateral displacement of the lower end of the pipeline system is smaller than the lateral displacement of the upper end of the pipeline system and the movement of the lower end lags behind the upper end this is because the quality of the submersed warehouse connected to the lower end of the piping system is greater than the quality of the piping unit and the submersed warehouse has no power source under the action of inertial force and hydrodynamic force the movement of the lower pipeline unit is contained the initial position offset value of the mining ship will affect the initial state of the mining system the greater the lateral initial offset of the mining ship the more the overall deviation of the pipeline system from the axis in order to study the influence of the lateral drift of the mining machine on the stress of the pipeline system the bending moment change data of the rigid pipe at different initial offsets of the mining machine were extracted the curve of the bending moment of the hard tube under different offsets as shown in fig 23 is obtained from the calculation results in fig 23 the place where the bending moment of the hard tube is relatively large mainly occurs at the top end of the hard tube and the bottom end of the hard tube the bending moment of the middle section of the hard tube is much smaller than the top and bottom end it is since the top of the hard tube is connected to the mining ship the movement resistance is small and the movement response is fast so the bending moment of the pipeline unit close to the mining ship is large the submersed warehouse at the bottom of the hard tube is prone to speed fluctuations due to its large volume and large mass under the action of its inertial force and hydraulic force therefore the bending moment of the piping unit near the submersed warehouse is also greater than the bending moment of the middle part when the drift distance is 75 m the maximum bending moment at the top of the pipeline system is 5000 n m and the maximum bending moment at the bottom is about 4500 n m meanwhile as the drift distance of the mining ship increases the bending moment of the middle section also gradually rises but it is still smaller than the bending moments of the top and bottom ends of the pipeline therefore when designing the pipeline system it is necessary to control the drift distance of the mining ship relative to the pipeline system otherwise it would cause damage to the pipeline system 5 conclusion and suggestion based on the physical model of the deep sea mining and lifting system this paper made a 3000 m deep sea mining and lifting system virtual prototype analysis model to go on researches analyzed the dynamic characteristics of the longitudinal vibration and lateral linkage of the ore lifting system and carried out the experimental research the research conclusions of the paper are as follows 1 under the excitation of the mining ship heave motion the heave response amplitude of the submersed warehouse also increases with the increase of the pipeline length with the influence of the fluid drag force the heave response curve of the submersed warehouse is not strictly a harmonic motion but fluctuates up and down in a similar cycle as the mining ship the nodal force at the connection between the submersed warehouse and the hard tube in the pipeline system becomes bigger and bigger with the increase of the mining ship heave amplitude as the drift distance of the mining machine rises the bending moment in the middle section also gradually increases but the bending moment suffered by the pipeline system mainly occurs at the top and bottom of the pipeline system 2 with the increase of the linkage speed the maximum value of the displacement deviation of the trajectory of the submersed warehouse increases in proportion to the speed the linkage direction of the mining system has little influence on the movement offset of the submersed warehouse and the horizontal linkage is more conducive to the stability of the slurry conveying hose system than the vertical linkage credit authorship contribution statement wei chen writing original draft formal analysis funding acquisition hai liang xu writing review editing funding acquisition neng peng data curation fang qiong yang supervision peng lin project administration declaration of competing interest the authors declare that they have no known competing financialinterestsor personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported by the national natural science foundation of china 51775561 52006061 natural science fund of hunan province 2018jj2522 hunan provincial department of education project 20b327 18a419 hunan province key research and development program 2019sk2192 2020nk2063 science and technology project of hunan provincial water resources department xskj2019081 56 
20647,online tuning of vessel models based on onboard measurement data can reduce the uncertainties of vessel motion prediction and therefore potentially increase the safety and cost efficiency for marine operations among the uncertain vessel parameters the roll damping coefficient is very important and highly nonlinear in reality roll damping depends on the sea state and vessel condition this paper proposes two different procedures for tuning the sea state dependent roll damping coefficient together with other uncertain vessel parameters i e 1 step tuning and 2 step tuning procedures in addition a roll damping prediction model based on gaussian process regression is also proposed to predict the roll damping for future sea states based on historical data the tuning procedure together with the proposed prediction model form an iterative closed loop of continuously improving the knowledge about the roll damping online also estimating the model uncertainty based on prior knowledge sampling uncertainties and the applied kernel case studies are presented to demonstrate the procedures keywords online model tuning discrete bayesian updating roll damping gaussian process regression stochastic kriging wave induced vessel motion 1 introduction reliable vessel motion prediction plays a key role for the safety and optimization of maritime and offshore activities among the vessel motions induced by different environmental sources the wave frequent ones can be most critical to predict because they are most difficult to control in engineering practice it is acceptable to simplify the relation between wave elevation and the rigid body vessel motions by linearization of the transfer functions in the frequency domain especially for typical marine operations executed at moderate seas dnvgl st n001 2016 the vessel motion linear transfer functions for the 6 degrees of freedom dofs in complex form are usually also referred to as response amplitude operators raos the roll motion is widely recognized as the most critical and challenging response quantity to predict because the critical roll motion near resonance is extremely influenced by the estimated damping which is significantly underpredicted by the linear potential theory roll damping is highly nonlinear and has therefore attracted huge research interest for more than a century falzarano et al 2015 system modelling usually requires simplifications which result in model uncertainties and errors linearization of roll damping is common practice for seakeeping analysis in order to estimate the linear transfer function between wave elevation and vessel roll motion i e the roll rao for irregular waves the roll damping is linearized by minimizing the error between the linearized and the real system with the assumption that both input to and output from the system are gaussian processes kaplan 1966 this is called stochastic linearization the watanabe inoue takahashi formula may be applied to estimate the total roll damping for varying u vessel forward speed ϕ a roll amplitude ω wave frequency and ship forms himeno 1981 however the estimation seems only acceptable for normally loaded ships near their natural frequencies himeno 1981 a third order polynomial formula may well model the nonlinearity between the non dimensional equivalent linear roll damping b ˆ 44 and the non dimensional frequency ω ˆ for each combination of u ϕ a vessel loading and ship form based on tasai takaki s table reported in english by himeno 1981 however the b ˆ 44 as a function of e g ship form and speed is not clear about half a century ago ikeda himeno tanaka and their teams from osaka prefecture university heavily contributed to understanding and modelling the nonlinear roll damping in a systematic manner their work of separating the roll damping into several components and ignoring their interactions recommended by ittc 2011 basically forms the present engineering practice of ship roll damping estimation in the absence of experimental data known as ikeda s method the equivalent linear roll damping b 44 can be separated as follows himeno 1981 1 b 44 b w b f b e b l b b k where b w is the wave damping b f is the friction damping caused by hull skin friction b e is the damping due to eddy making b l is the linear lift damping b b k is the damping due to the bilge keels among them b w and b l are linearly proportional to roll angular velocity while the other components are nonlinear b f is relatively less important and may be neglected for full scale ships himeno 1981 ikeda et al 1978a b c 1979 proposed formulas for estimating most of the important roll damping components by a semi empirical approach even though ikeda s formulas are recommended by ittc 2011 cautions should be taken because 1 ikeda s formulas are limited to certain ship forms and 2 ikeda s formulas were derived for pure roll motion based on still water condition larsen et al 2019 for example the use of panel methods to predict the wave damping b w with forward speed is theoretically accurate and recommended falzarano et al 2015 over the semi empirical ikeda s formulas ikeda et al 1978b söder et al 2017 found that the ikeda s formulas significantly overestimated the hull lift damping component while underestimating the bilge keel damping by benchmarking with model test data consequently model tests or empirical data are always preferred for new vessel design in order to model the roll damping with sufficient accuracy free decay model tests are normally performed to obtain the roll damping however only at the important damped roll resonance frequency forced rolling model tests can be performed to obtain the roll damping at other frequencies however this is frequently not performed in addition much more model tests are required if the roll amplitude dependent damping coefficients are wanted by fitting to the empirical data the total roll damping can be modelled as functions of vessel speed u vessel draught d roll amplitude ϕ a or wave amplitude a wave frequency ω etc however the scale effects of model tests may significantly affect the accuracy of the roll damping estimation söder and rosén 2015 at present prediction of roll damping based on numerical simulation by computational fluid dynamics cfd codes has also received considerable attention e g irkal et al 2016 however a reliable cfd analysis requires high competence in modelling and understanding the limitations of the codes and the applied algorithms usually results from cfd analyses require validation from model tests both model tests and high fidelity analyses are expensive and time consuming therefore it is of great interest to improve the knowledge of the roll damping for the specific vessel throughout its whole life cycle by using the weather information and the vessel motion measurements onboard in practice the additional damping can be considered as a function of parameters related to the sea state and vessel condition i e b 44 f x where x u d h s t p β w h s is the significant wave height t p is the spectral wave peak period β w is the wave direction with such a roll damping function the rao and roll motions can be estimated at a specific wave and vessel condition by assuming stationarity consequently the improved roll damping model built upon on site measurements can potentially increase the cost efficiency and safety for marine operations it is very challenging to update the roll damping by on site measurements and weather information because 1 measurements and weather information are subject to significant uncertainties bitner gregersen and hagen 1990 qiu et al 2014 and 2 there are also many other vessel parameters subject to uncertainties e g inertia items han et al 2020 therefore all the uncertain parameters should be identified first and tuned simultaneously in a probabilistic way an earlier case study by han et al 2020 indicates that multiple sensors at different locations providing signals of displacements velocities and accelerations can help identifying the uncertain vessel parameters han et al 2021a proposed an algorithm for tuning of vessel model parameters by bayesian inference tuning of the uncertain vessel parameters in a probabilistic approach can improve the knowledge about the real time vessel condition and reduce the model uncertainties quantitatively based on onboard vessel motion measurements and wave information such as h s t p β w directional spreading and spectral shape vessel parameters can be sea state dependent vessel condition dependent or permanent han et al 2020 the sea state dependent parameters e g roll damping usually also depend on vessel conditions e g loading conditions and vessel forward speed han et al 2021a considered a constant roll damping coefficient through different sea states for tuning and pointed out that the algorithm should be further developed to tune vessel roll damping as being sea state dependent the present paper describes the algorithm for tuning of sea state dependent roll damping coefficient together with other vessel parameters in addition it is even more important for this paper to establish an algorithm which prescribes how to model the roll damping as sea state dependent and predict it for the unobserved future sea states this is considered particularly challenging because 1 the tuned roll damping value is only valid for the current sea state which does not directly help predicting the vessel roll damping for other sea states therefore the algorithm should be able to predict the roll damping for the unobserved sea states with improved accuracy based on prior knowledge and historical tuning results for different sea states and vessel conditions 2 as discussed previously it is difficult to define a function in advance that is sufficiently accurate for modelling of roll damping 3 the number of available full scale measurements can be very limited and insufficient under fitting or over fitting can be expected 4 the available measurements may also be concentrated around certain sea states it is questionable to predict roll damping for other sea states by extrapolation based on any fitted curve the paper is organized as follows the basic vessel model tuning algorithm is described in section 2 han et al 2021a for flexible modelling of roll damping gaussian process regression is introduced in section 3 in section 4 two procedures are proposed to modify the basic model tuning algorithm in order to tune and represent roll damping as being sea state dependent numerical case studies are carried out to demonstrate the performance of the proposed tuning procedures and the corresponding roll damping prediction model the basis of the case studies are described in section 5 and the results are shown in section 6 finally section 7 concludes and discusses the findings limitations and future work related to the present research 2 basic vessel model tuning procedure the applied algorithm for tuning of vessel seakeeping parameters based on wave information and vessel motion measurements proposed by han et al 2021a is briefly repeated here for completeness purposes the algorithm is also illustrated in fig 1 firstly the uncertain vessel parameters i e φ 1 φ 2 φ m φ m m 1 2 m are identified based on their sensitivities with respect to the measured vessel motions of primary interest this can be achieved by performing uncertainty and sensitivity analyses e g han et al 2020 the uncertainty ranges of those parameters can be determined based on the relevant prior information such as available design and analysis documentation accuracy of onboard monitoring data and engineering judgement each uncertain parameter φ m is then discretized evenly into i m values within its uncertainty range for a successful tuning it is important to have a sufficiently large uncertainty range for each φ m while the spacing between the discretized values should be sufficiently small to capture any critical nonlinear behaviour considering reasonable uncertainty ranges based on practical prior information 5 to 8 discrete values for each vessel parameter can be sufficient for the tuning combining the uncertain parameters at their discrete values a total number of r i 1 i 2 i m discrete assessment points are defined for calculating the possible raos in addition multiple quantities of vessel motions e g displacement velocity and acceleration for different dofs at different locations are normally required for the tuning process each of the considered measured vessel motion quantities is indexed by j 1 2 j consequently a rao database containing r j raos can be established by performing seakeeping analysis for those measured quantities at those discrete combinations of the uncertain parameters the joint probability distribution of the identified uncertain vessel parameters is denoted as p n φ 1 φ 2 φ m the superscript n stands for the number of completed iterative updates based on the proposed tuning procedure the joint probability distribution is tuned for each stationary wave and vessel condition typically for a vessel in steady condition with respect to heading advancing speed and inertia distribution the stationarity is determined by the duration of a stationary sea state which could vary from 20 min to 3 hr depending on geometrical location with the information on waves e g a wave spectrum vessel motion measurements e g signal x j t for the measured quantity j and a rao database covering the uncertainty ranges of the uncertain vessel parameters the tuning can be performed as follows 1 filter the vessel motion measurements x j t to obtain the vessel motion time series in the wave frequency domain the high frequency components e g signal noise and the low frequency components e g signal bias second order motions are important to be filtered out the filtered signal is denoted as x ˆ j t 2 calculate the standard deviation of the filtered signal σ ˆ j by 2a σ ˆ j t 1 n t x ˆ j t x j 2 n t 1 2b x j t 1 n t x ˆ j t n t where n t is the total number of time steps of the signal and x j is the mean value of the filtered signal the duration of the signal x j t t n t δ t where δ t is the time interval should be selected such that the sea state and vessel condition remains stationary within the duration of t while the sampling variability should be sufficiently small a typical value of t can be 20 min to 1 hr 3 calculate the standard deviations of the possible vessel response σ r j based on the wave spectrum and the candidate rao from the rao database for the measured quantity j i e r a o r j 3a σ r j n 1 n ω s x x r j ω n δ ω 3b s x x r j ω h r j ω β w 2 s ζ ζ ω β w where n ω is the total number of the discretized frequencies for the response spectrum s ζ ζ ω β w is the long crested wave spectrum and s stands for a single sided power spectrum s x x r j ω is the possible response spectrum for the response x corresponding to the measured quantity j based on the vessel parameter combination r h r j ω β w is the corresponding linear transfer function i e r a o r j between wave elevation and vessel response each possible combination of the considered vessel parameters i e ϕ i 1 ϕ i 2 ϕ i m is subscripted with number r 1 2 r where ϕ i m for m 1 2 m is the i m th discrete value of the considered uncertain vessel parameter φ m in the rao database r m 1 m i m is the total number of vessel parameter combinations and i m is the number of the discretized values of φ m in the rao database for all possible vessel parameter combinations σ r j should be calculated 4 less sensitive measured quantities for the considered uncertain vessel parameters at the current sea state s ζ ζ ω β w should be screened out the sensor screening ratio ssr α j is introduced to quantify the importance of the measured quantity j 4a α j σ σ r j σ ˆ j 4b σ σ r j r 1 r σ r j σ r j 2 r 1 4c σ r j r 1 r σ r j r where σ σ r j is the standard deviation of σ r j over r 1 2 r the case study uses a screening criterion of α 0 0 05 if α j α 0 the signal of the quantity j will be excluded during the process of tuning the parameters ssr basically represents the importance of the obtained measurements for tuning of the considered vessel parameters for the present sea state the selection of the criterion value α 0 depends on the uncertainties of the measurements and the system errors introduced by application of linear potential theory to represent the true vessel dynamics within the wave frequency band the influence of the introduced screening criterion on the final tuning results is discussed by detailed sensitivity studies in han et al 2021a 5 calculate the weight factor for each parameter combination r by inverse distance weighting shepard 1968 5 w r j 1 σ r j σ ˆ j p where p r is called the power parameter the choice of the p value depends on the number of considered uncertain parameters their sensitivity and uncertainty ranges and engineering judgements the influence of the p value on the tuning results was studied by han et al 2021a 6 build the likelihood function for updating the joint probability distribution of the considered uncertain parameters φ 1 φ 2 φ m first establish the weight matrix w j for all r 1 2 r in the rao database the weight matrix would have m dimensions with the size of i 1 i 2 i m then linearly interpolate the weight matrix w j from the size of i 1 i 2 i m variable resolution in the rao database to the size of k 1 k 2 k m variable resolution in the discrete joint probability distribution 7 update the joint probability distribution p n 1 φ 1 φ 2 φ m since the likelihood function i e weight matrix w j is presented at limited number of parameter combinations r 1 2 n p r o b where n p r o b m 1 m k m and k m is the number of the discretized values of φ m in the discrete joint probability distribution updating the joint probability distribution based on discrete bayesian inference labbe 2018 must therefore be calculated at those discretized points i e 6 p m f n 1 φ 1 φ m no p m f n φ 1 φ m w j where p m f means the joint probability mass function operator means the element wise multiplication of the two matrices of the same dimension i e a hadamard product scheick 1997 to ensure that the sum of the joint probability mass function remains 1 0 normalization no is required physically the uncertain vessel parameters are continuous variables therefore the joint probability density function pdf is more appropriate to represent their uncertainties numerically the relation between joint pmf and joint pdf can be approximated by 7 p m f ϕ k 1 ϕ k 2 ϕ k m p d f ϕ k 1 ϕ k 2 ϕ k m m 1 m δ φ m where ϕ k m for m 1 2 m is the k m th discrete value for the variable φ m δ φ m is the interval between the discrete values of variable φ m the algorithm applies statistical inference of the direction independent vessel parameters based on onboard measurements and wave information consequently the tuned vessel model can be applied to predict the vessel motion for other sea states and wave directions with quantified parameter uncertainties 3 gaussian process regression gaussian process regression gpr is found to be a very promising solution for roll damping modelling and prediction because 1 it does not require to decide the format of the roll damping function 2 the tuned values of roll damping for the previous sea states and vessel conditions can reasonably influence the prediction of roll damping for future sea states and vessel conditions through the covariance function 3 it also indicates the estimation uncertainty based on the prior knowledge the available samples and the selected kernel function gpr is fundamentally based on the conditional distribution of multivariate gaussian vectors rasmussen and williams 2006 for a n m dimensional multivariate gaussian vector y 8 y y 1 y 2 with sizes n 1 m 1 where y 1 and y 2 are also multivariate gaussian vectors and the mean vector μ and the covariance matrix σ can be written as 9a μ μ 1 μ 2 with sizes n 1 m 1 9b σ σ 11 σ 12 σ 21 σ 22 with sizes n n n m m n m m then the conditional distribution of y 2 on y 1 y 1 is also a multivariate gaussian distribution i e 10a y 2 y 1 y 1 n μ 2 σ 22 10b μ 2 μ 2 σ 21 σ 11 1 y 1 μ 1 10c σ 22 σ 22 σ 21 σ 11 1 σ 12 this means that the distribution of y 2 can be updated based on the known samples y 1 y 1 and the covariance matrix for y 2 and y 1 it is worth noting that updating of the variance matrix σ 22 i e eq 10c does not rely on the observed values of y 1 i e y 1 for a continuous function y f x each y value i e y i f x i i z can be considered as a gaussian distributed random variable i e y i n μ i σ i and all variables are correlated by having samples at some known points x 1 i e y 1 f x 1 y 1 the corresponding predictions at other points e g y 2 f x 2 can be estimated based on eqs 9 and 10 if the covariance matrix of the variables for y 1 and y 2 i e σ can be established the covariance matrix is called the kernel or the similarity function which establishes the correlation among data points it is physically reasonable to consider the kernel covariance coefficient k x i x j c o v i j between y i f x i and y j f x j to be a function of the distance along the input axis i e k x i x j g x i x j among many kernel designs the radial basis function rbf is the most popular kernel i e 11 k x i x j σ f 2 exp 1 2 l 2 x i x j 2 where two hyperparameters are introduced σ f 2 is called signal variance which represents the prior knowledge about the variance of the random process l is called length scale in reality samples are also subject to uncertainties in the input space y the observed samples y can be written as 12 y f x ϵ where the ϵ vector represents the uncertainties for the samples for each sample y i the uncertainty ϵ i is also considered to be a gaussian variable 13 ϵ i n 0 σ y i 2 where σ y i 2 represents the uncertainty level for the observed sample y i consequently for predicting y f x eq 10 can be modified to account for sampling noise 14a y y y n μ k 14b μ μ k y k y 1 y μ y 14c k k k y k y 1 k y where y is the input space y is the observed samples for the input space y is the space to be predicted prediction space μ and k are the conditional mean and the updated kernel i e the similarity function for the prediction space μ and μ y represent the prior means k y and k y are the kernels representing the correlations between the input space and the prediction space calculated based on eq 11 k y can be calculated by 15a k y k y σ y 15b k y k x 1 x 1 k x 1 x j k x 1 x n k x i x j k x i x n k x n x n 15c σ y σ y 1 2 σ y i 2 σ y n 2 where k y is the kernel for the input space with each element calculated based on eq 11 σ y is a n n diagonal matrix note that k y is no longer the covariance matrix for the input space because it includes the uncertainties of the observations eqs 14 and 15 including the sampling uncertainties is called stochastic kriging gpr is a non parametric method meaning that the regression does not require knowing the form or the order of the function gpr is sometimes also considered as an infinite parametric method because it ideally requires infinite samples in order to perfectly model the function fig 2 as an example illustrates how the gpr hyperparameters influence the prediction larger σ y 2 helps to smoothen the fitted curve surface for the sample with uncertainties σ y 2 represents its sample uncertainty error the length scale l indicates how strong the correlation is between the points in that dimension in addition to σ y 2 the length scale may also help the regression avoiding over fitting and under fitting σ f 2 represents the variance of the prior knowledge about the model it can be interpreted as the variance of a point that is far away from all the available sample points i e negligible correlation the stochastic kriging algorithm rasmussen and williams 2006 as implemented in the python package scikit learn sklearn hereafter pedregosa et al 2011 has been used the gpr in sklearn has been demonstrated as near the best gpr programme with respect to its analysis performance and computational speed erickson et al 2018 the gpr model in sklearn assumes zero prior mean it is practically acceptable since the gpr model converges according to the available samples and independent of the provided prior mean if the amount of training data is sufficiently large however to ensure accuracy for research purpose non zero prior mean is considered in the study based on the fact that the prior mean vector does not influence the covariance matrix for the multivariate gaussian distribution i e y y n μ y μ k y k y k y k is equivalent to 16 y μ y y μ n 0 0 k y k y k y k the prior mean will accordingly be subtracted from the values at the data points before the gpr model fitting whereas it will be added to the predicted value for the prediction based on the fitted gpr model tuning the hyperparameters may be based on personal experience and engineering judgement however these hyperparameters can also be automatically optimized by assuming that the input data points y are given at their maximum likelihood the log marginal likelihood for a zero mean prior can be written as rasmussen and williams 2006 17 log p y x log n y 0 k y 1 2 y t k y 1 y 1 2 log k y n 2 log 2 π where n is the number of samples in order to better control the gpr model for the present research the hyperparameters of the kernel are manually determined without applying the sampling dependent optimization in eq 17 4 proposed procedure for tuning of vessel parameters including sea state dependent roll damping 4 1 one step tuning procedure in order to interactively tune sea state dependent roll damping and improve the roll damping prediction model i e the gpr model the model tuning algorithm described in section 2 is modified as illustrated in fig 3 assume that the joint probability distribution of the uncertain vessel parameters have been tuned for n 1 sea states and so as to the gpr model of β 44 the procedure of tuning vessel parameters and updating the gpr model based on the measurements i e x j t j 1 2 j and the corresponding wave information for the next sea state s s n is described below s s n z is the index of the sea state i e sea state number 1 given the wave information for the sea state s s n and the updated gpr model from previous sea states the additional roll damping coefficient β 44 can be predicted in terms of its mean and variance values then the probability mass function of β 44 s s n can be established at the discrete values assuming it is gaussian distributed 2 together with the available knowledge about other uncertain vessel parameters after the previous sea state s s n 1 i e p m f s s n 1 φ 1 φ m 1 the joint probability distribution including β 44 can be calculated by multiplying the probability mass functions of β 44 s s n and the other parameters at their discrete values i e 18 p m f s s n p r i ϕ k 1 ϕ k m 1 ϕ k m p m f s s n 1 ϕ k 1 ϕ k 2 ϕ k m 1 p m f ϕ k m s s n where ϕ k m for m 1 2 m 1 is the k m th discrete value of the parameter φ m ϕ k m s s n is the k m th discrete value of β 44 predicted by the gpr model for the sea state s s n φ m β 44 s s n 3 with the pre established rao database and the received vessel motion measurements for all the j quantities for the sea state s s n the weight matrices can be calculated for each sensor measurement based on the previously described tuning procedure in section 2 4 then the joint probability mass function of vessel parameters can be updated based on eq 6 as the posterior of the vessel parameters for the wave information s s n 5 the posterior mean μ β 44 s s n and standard deviation σ β 44 s s n can be calculated by 19a p m f s s n p o s ϕ k m k 1 1 k 1 k m 1 1 k m 1 p m f s s n p o s ϕ k 1 ϕ k m 19b μ β 44 s s n p o s k m 1 k m ϕ k m p m f s s n p o s ϕ k m 19c σ β 44 s s n p o s k m 1 k m ϕ k m μ β 44 s s n p o s 2 p m f ϕ k m and the posterior of the other parameters can be calculated for each combination by 20 p m f s s n p o s ϕ k 1 ϕ k m 1 k m 1 k m p m f s s n p o s ϕ k 1 ϕ k m the gpr model of β 44 can be updated with the new available information μ β 44 s s n p o s and σ β 44 s s n p o s 6 then for the next sea state the joint p m f s s n p o s φ 1 φ m 1 will become the prior information 4 2 two step tuning procedure for tuning of sea state dependent parameters a larger power parameter p is usually desired due to the very limited number of available measurements for that particular sea state however tuning of other parameters may not require and may not benefit from application of such a large p value the larger the p value is the faster the variance of the parameters can be reduced potentially leading to an over confidence issue the tuning results could be biased han et al 2021a once the variance becomes relatively small the expected value of the tuned parameter becomes very difficult to change considering that all the vessel parameters must be tuned simultaneously the one step tuning procedure could be modified by splitting the bayesian updating into two steps as illustrated in fig 4 the basic idea is to apply two different power parameters p 1 and p 2 where p 1 p 2 to calculate the p m f s s n p o s φ 1 φ m 1 and p m f s s n p o s β 44 separately 5 case study basis case studies were performed in order to investigate the proposed algorithm in detail for illustrative purpose tuning of only 2 vessel parameters simultaneously was considered the roll damping was assumed to be a function of only three independent wave related parameters i e h s t p and β w and can be written as a function of two input characteristics i e h s sin β w and t p 5 1 vessel information and rao database all case studies were based on numerical models for an offshore supply vessel osv close to its ballast condition zero forward speed has been considered the reference coordinate system for the seakeeping analysis is illustrated in fig 5 the x z plane is at the vessel longitudinal symmetry plane and the origin is at the stern of the keel elevation the positive x axis points towards the bow the positive y axis points towards the port and the positive z axis points vertically upwards the wave heading β w as illustrated in fig 5 follows the same coordinate system in a positive going to convention as described in section 2 the rao database should be established to represent the raos for all the considered motions sensor locations and covering the whole uncertainty ranges for the considered uncertain vessel parameters the measurements of vessel heave displacements velocities and accelerations at three locations see fig 5 have been considered as summarized in table 1 assuming that the measurements are independent it is also assumed that there is much available supplementary information regarding the vessel design properties e g operation design report and arrangement drawing and onboard sensors e g ballast monitoring to approximately identify the vessel condition in real time therefore the online vessel model tuning is focused on reducing the uncertainties of the estimated vessel condition resulting from new information becoming available based on measurements the considered uncertain vessel parameters were selected based on the previous parametric sensitivity study han et al 2020 their uncertainty ranges are summarized in table 2 each of the considered vessel parameters was discretized within the specified uncertainty range the number of discrete values is also shown in table 2 in total 9 wave headings between 30 and 150 with a 15 interval were considered in the rao database for all the 9 sensor measurements described in table 1 all the raos were calculated by means of the dnv gl commercial software wasim dnv gl 2018 which is based on application of the rankine panel method kring 1994 5 2 assumed function of additional roll damping as discussed in section 1 the linearized roll damping b 44 can be a function of many parameters e g 21 b 44 g h s t p β w c o g m a s s u ϕ a where c o g is the vessel centre of gravity m a s s is the vessel mass in real applications the gpr model of the roll damping b 44 can be initiated based on the ikeda s formulas mentioned in section 1 then the acquired wave and vessel motion measurements can assist in tuning b 44 and updating the gpr model according to the proposed procedures in section 4 for the purpose of demonstration it was assumed that the roll damping according to the potential theory has been accurately calculated by seakeeping analysis software and the linearized additional roll damping coefficient β 44 can be accurately described as 22a β 44 f h s sin β w ω p 22b β 44 b 44 b w b 44 c r i t where f is a linear function ω p 2 π t p b 44 c r i t is the critical roll damping calculated based on vessel hydrodynamic coefficient matrices of added mass inertia and stiffness the true linear function f illustrated in fig 6 was defined by the data points as summarized in table 3 linear interpolation between the data points was applied extrapolation was not allowed the prior knowledge about β 44 was considered as a constant gaussian process with prior mean of 0 07 and variance of 0 0 2 2 i e 23 β 44 0 n 0 07 0 0 2 2 the prior mean and prior variance of β 44 is also illustrated in fig 6 5 3 scope of case studies two separate cases were studied in detail case gmt investigated the algorithm performance for tuning of gmt and β 44 and updating the prediction model for β 44 simultaneously whereas case xcg investigated the algorithm performance for tuning of xcg and β 44 and updating the prediction model for β 44 simultaneously the prior and true β 44 are described in section 5 2 for demonstration purposes the assumed true values and prior knowledge about the gmt and xcg in the case studies are defined in table 4 demonstration on tuning and prediction of β 44 is the key objective of the case studies therefore no head seas or following seas have been considered it is worth mentioning that the proposed gpr model can also be used for designing experimental test scopes actively i e an adaptive sequential experimental design e g neumann brosig et al 2020 based on available experimental data the gpr model can indicate where the largest uncertainty is to be found consequently the next test can be designed at that point to optimize the test scope however for the vessel in operations the occurrence of sea states is decided by nature consequently the sampling scheme cannot be established in the same way as for adaptive sequential experimental design for the case studies the sea states were randomly simulated as shown in table 5 similar to the case studies demonstrated by han et al 2021a b h s t p and β w were also assumed to be evenly distributed random variables within the specified ranges only for demonstration purposes note that the variables which represent the long term wave conditions are usually not uniformly distributed in the real world all the sea states were assumed to be adequately represented by the pierson moskowitz pm spectrum directional spreading of the sea states was not considered many initial simulations were performed in order to understand how the proposed algorithms will work the initial findings were 1 more samples are required in order to train the gpr model for the case of higher dimension the considered gpr model actually have 3 random input parameters i e ω p h s and β w the random generation of the uniformly and independently distributed h s and β w variables actually leads to a non uniformly distributed h s sin β w consequently a much smaller likelihood of occurrence should be expected along the edges of the considered surface of the β 44 gpr model 2 for the β 44 gpr model the prior variance described in eq 23 should be applied as the hyperparameter signal variance σ f 2 3 each of the two input characteristics of the gpr model i e h s sin β w and ω p requires an independent length scale l for an uncomplicated and smooth true surface such as a polynomial function it seems reasonable to set l to be 10 20 of the total range of each axis parameter 4 for sea state s s n the variance of β 44 s s n after tuning represents the uncertainty of that data point therefore σ y s s n σ β 44 s s n p o s 5 tuning of the sea state dependent β 44 requires a relatively large power parameter p the vessel motion signals were numerically simulated noise was also added to the signals the considered input parameters for noisy signal simulation and case studies are summarized in table 5 the vessel motion measurements for each sea state were simulated for 1 h each case study included 72 sea states the procedure of simulating the noisy vessel motion measurements is illustrated in fig 7 the true response spectrum for response x i e s x x ω can be calculated based on the wave spectrum of the randomly simulated sea state and the corresponding vessel response rao a realization of that response can be generated by 24a x t n 1 n ω c n ω n cos ω n t φ n 24b c n ω n 2 s x x ω n δ ω where φ n 0 2 π is a random phase angle which is continuous and uniformly distributed δ ω is the interval of the discrete radial frequencies ω n and n ω is the total number of discrete frequencies for the response spectrum then the signal noise can be added to each time step of the time series assuming that 1 the signal noise is white noise i e w n n 0 σ n 2 2 and the variance of noise σ n 2 is proportional to the true signal variance σ x 2 defined as snr signal to noise ratio 25 s n r σ x 2 σ n 2 6 results 6 1 one step tuning a number of cases have been analysed also including stochastic variability obtained by means of seed variation a summary of the aggregated results are reported for the purpose of demonstration and documentation of the algorithm performance 6 1 1 case gmt representative results corresponding to two different realizations are included with initial seed number 128 denoted as seed128 and seed number 45 denoted as seed45 note that different initial seed number will determine different sea states with respect to different h s t p β w and seeds for generating virtual noisy signals figs 8 and 9 illustrate the updated gpr model for β 44 after tuning the vessel parameters for 72 sea states information on the randomly generated sea states and the intermediate results with respect to tuning of β 44 are summarized in tables a 6 and a 7 in appendix for seed128 and seed45 respectively the expected values of the tuned β 44 for those 72 sea states are also illustrated as samples in figs 8 and 9 figs 10 and 11 illustrate the tuned results of gmt throughout the 72 sea states for seed128 and seed45 respectively as expected both β 44 gpr models are found to converge towards the presumably true function the posterior knowledge on β 44 in terms of the mean and variance improves significantly based on the simulated vessel motion measurements for 3 days however the results of the tuned gmt become very different for the two presented cases for seed128 case fig 10 the gmt mean fluctuates around the true value when the tuning algorithm finds that the previously tuned gmt deviates significantly from the current observation the variance dramatically increases reflecting the confusion of the system the increasing variance helps the system to adjust the tuning direction note that more simulations with different initial seeds were performed for most simulated cases the tuned gmt fluctuates about 0 5 m and 0 6 m throughout the 72 sea states similarly to the behaviour illustrated in fig 10 on the contrary fig 11 shows that the tuned gmt for case seed45 significantly deviates from the true value the variance was reduced significantly while the mean value of the gmt was quickly tuned to a wrong value this leads to an over confident situation where the tuning system was not able to bounce back to the true value as shown in fig 11 the variance increased significantly between sea state number 45 and 50 and sea state number 66 and 68 the system tried very hard to bounce back towards the true value however it did not manage to change the tuned mean value of the gmt significantly this type of over confidence is dangerous hence a too rapid decrease of the variance for parameters that are not sea state dependent should be avoided the bias associated with the tuned value of the gmt also indicates that the gmt may not be very sensitive to vessel motions for most wave conditions it is worth mentioning that the sequence of the occurring sea states and the corresponding measurements can influence the tuning of the sea state independent parameters i e gmt in this case as well as the updated gpr model for the sea state dependent β 44 however such influence is usually very limited for convergent tuning results with sufficient amount of data and carefully selected power parameter p so that over confident tuning can be avoided divergent tuning results however can be more influenced by the order of the sea state occurrence in reality the tuning is carried out in the sequence of occurrence by nature which means that changing the tuning sequence is not relevant in practice 6 1 2 case xcg based on earlier studies han et al 2020 2021a c the value of xcg is found to have a stronger influence on the vessel motions than the value of gmt therefore as expected tuning of xcg was much more stable than tuning of gmt fig 12 shows the significantly improved gpr model of β 44 compared with the prior knowledge fig 6 the intermediate tuning results of β 44 are summarized in table a 8 in appendix fig 13 shows that the tuned xcg gradually approaches the true value 6 2 two step tuning based on the findings in section 6 1 1 the over confidence low variance implies that the 1 step parameter tuning procedure has difficulties in counteracting the convergence to the wrong value therefore it is of great interest to apply the proposed 2 step tuning procedure as described in section 4 2 so that the sea state independent vessel parameters can be tuned relatively slowly compared with results based on the 1 step tuning procedure the trained gpr models of β 44 approach the true surface in a better way due to the applied higher power parameter for tuning of β 44 tables a 9 and a 10 in appendix summarize the intermediate tuning results of β 44 for case gmt seed45 and case xcg seed128 respectively based on 2 step tuning procedure with respect to tuning of gmt as shown in fig 14 the 2 step tuning algorithm by application of a smaller power parameter leads to smaller fluctuations of the tuned mean values based on the measurements from different sea states the over confidence issue with respect to the gmt variance could therefore mainly be avoided a large variance is preferred instead of a biased estimate resulting from over confidence due to a fictitiously small variance as shown in fig 15 with a smaller power parameter p tuning of the xcg was even accelerated towards the true value approximately between sea state number 15 and 40 the variance decreased more slowly but the expected value converged faster towards the true value 7 conclusions and future work the paper has proposed an algorithm for tuning and prediction of sea state dependent roll damping by an iterative closed loop between the tuning procedure and the gpr based prediction model the tuned β 44 for the current sea state updates the gpr model which in return improves the β 44 prediction for future sea states a simple and representative roll damping function was presumed for the numerical studies for demonstration purposes the numerical case studies have shown that the tuning procedure succeeds to improve the roll damping coefficient estimation the true variation of β 44 is expected to be identified based on the real on site vessel motion measurements and the environment although subjected to some uncertainties with the 1 step tuning algorithm the sea state independent parameters such as gmt and xcg may suffer from the over confidence issue due to the applied large power parameter therefore a 2 step tuning algorithm was proposed by applying two sets of different likelihood functions to update the prior knowledge in order to tune roll damping and other parameters with different confidence level case studies showed that the 2 step tuning algorithm may even accelerate the tuning towards the true value in addition for the biased tuning e g tuning of gmt for initial seed number of 45 the 2 step tuning can at least slow down the divergence even though the proposed tuning framework is expected to improve the estimation of sea state dependent vessel parameters several important limitations should be emphasized for real applications 1 the amount of on site measurements can be limited especially for operations with frequently changing vessel conditions there might be only a few available sea states for a certain vessel condition with respect to inertia distribution and vessel speed therefore it might be reasonable to apply larger length scale l in the rbf kernel of the gpr model in order to make the available updates influence the gpr model as much as possible however under fitting may occur as illustrated in fig 2 2 the proposed algorithm for online tuning of sea state and vessel condition dependent roll damping based on on site measurements cannot fully substitute lab experiments the vessels are designed to survive at extreme and accidental scenarios which probably do not happen on site for a considerably long period therefore tuning based on on site measurements is probably insufficient to find a complete and sufficiently accurate function for representation of roll damping covering the most extreme weather conditions and accidental scenarios lab tests can be designed and optimized but not for on site conditions using on site measurements to improve the knowledge of roll damping for moderate seas is reasonable however predicting the extremes should still rely on model tests and cfd analysis 3 the on site sea states usually vary slowly meaning that the sea state occurring afterwards is normally close to the current sea state this slowly varying characteristics negatively influence the global performance of the gpr model updating however this could also be an advantage in terms of better accuracy in relation to the local input domain of highest interest more useful data can be available in a concentrated sub space of the input parameters e g h s and t p and the environmental condition for the operation in the near future is probably located close to or within this concentrated input space consequently more confidence could be obtained within such input space of great interest for the near future operation in addition future work is essentially required before real applications on board can be achieved 1 as stated in items 2 and 3 of the algorithm limitations the probability of occurrence for wave conditions is not uniformly distributed in the real world hence insufficient observations with respect to gpr modelling are expected at those wave conditions with low probability of occurrence the rbf kernel may be modified so that the length scale l can be location dependent in the input space of the gpr model a larger value of l may be applied for the input sub space with low probability of occurrence so that those less frequently observed samples can have increased influence on a wider range of the input domain 2 the proposed tuning framework as described in section 4 introduces a gpr model which relies on the selection of the kernel and its hyperparameters the hyperparameters of the gpr model can be optimized as described in section 3 however it was found that the optimal solution depends on the initial searching values bounds the amount of training data and the applied algorithm erickson et al 2018 therefore future research should investigate the effects of applying other kernels e g matérn kernel rational quadratic kernel and dot product kernel and the effects of applying the automatic tuning of the kernel s hyperparameters on the results of tuning and predicting vessel parameters 3 the gpr prediction model must be continuously qualitychecked usually a stopping criterion should be introduced in the future to avoid analysis divergence for the β 44 gpr model the stopping criterion could be related to the prediction error for example if the tuned roll damping based on the new measurements is outside of the 99 percentile interval of the available gpr model at that sea state then it might indicate that 1 the gpr model is over confident 2 the tuned results are biased or 3 the vessel condition is changed etc 4 roll damping depends not only on the sea states but also on the vessel conditions such as vessel forward speed and loading conditions future research should demonstrate the tuning algorithm with a more complete roll damping gpr model which is sea state and vessel condition dependent the proposed procedure could be modified by just including parameters with respect to vessel conditions as input parameters to the gpr model 5 in reality the acquired wave information e g on h s and t p is always subject to uncertainties which was not considered in the present paper it is important as part of future work to systematically consider the effects of the weather uncertainties on the model tuning algorithm and the roll damping gpr model 6 in the tuning procedure the values of the power parameter p and the ssr criterion parameter α 0 can significantly influence the tuning results and the selection of both values is at the moment based on trial and error how to determine their values based on available quantitative information about system dimension measurement uncertainty etc can be important to investigate as part of future work nomenclature abbreviations cfd computational fluid dynamics cog centre of gravity gmt correction to the transverse metacentric height due to free surface effects gpr gaussian process regression ittc international towing tank conference osv offshore supply vessel pdf probability density function pm pierson moskowitz spectrum pmf probability mass function rao response amplitude operator rbf radial basis function snr signal to noise ratio ssr sensor screening ratio wn white noise xcg longitudinal coordinate of vessel centre of gravity vectors and matrices μ the conditional mean for the prediction space with the given observations k the updated kernel for the prediction space with the given observations ϵ the noise of the observations y μ the prior mean for the prediction space μ y the prior mean for the input space k the prior covariance for the prediction space k y the kernel for the input space with noise k y the kernel between input and prediction spaces k y the kernel for the input space y the prediction space for the function y f x at x x w j the weight matrix likelihood function based on the received measurements x j t y the observations related to the input space y other symbols α j sensor screening ratio ssr for the measured quantity j β 44 ratio between the additional roll damping and the critical roll damping β w wave direction w r t vessel coordinate system η 3 η 3 η 3 heave displacement velocity acceleration ω wave frequency ω p wave spectral peak frequency ϕ a roll amplitude φ m the uncertain vessel parameter to be tuned m 1 2 m ϕ i m the i m th discrete value of the vessel parameter φ m in the rao database ϕ k m the k m th discrete value of the vessel parameter φ m in the discrete joint probability distribution σ y i 2 the variance of the observation y i σ n 2 variance of noise σ x 2 variance of response σ f 2 signal variance σ σ r j the standard deviation of σ r j over r 1 2 l d o t s r σ r j the predicted standard deviation by using r a o r j σ ˆ j the standard deviation of the filtered signal x ˆ j t b 44 roll damping b b k the damping component of b 44 due to bilge keels b e the damping component of b 44 due to eddy making b f friction damping component of b 44 b l linear lift damping component of b 44 b w wave damping component of b 44 f l p lowpass filter cutoff frequency hz h r j ω β w linear transfer function between wave and vessel heave response for the measured quantity j based on the combination r for the uncertain vessel parameters i e r a o r j h s significant wave height i m the number of discrete values used for rao database for the vessel parameter φ m i m the i m th value of the variable φ m in the rao database j the total number of the measured quantities j the index of the measured quantities representing different motions and their derivatives i e displacement velocity acceleration at various locations k m the number of discrete values used for the probability distribution model for the vessel parameter φ m k m the k m th value of the discretized variable φ m in the probability distribution model l length scale m the number of considered variables for tuning n ω the number of discretized frequencies n t the number of discretized time steps n p r o b the total number of the discrete points for the joint probability distribution n p r o b m 1 m k m p power parameter r the total number of possible vessel parameter combinations to build the rao database r m 1 m i m r a o r j the rao based on the variable combination r for the measured quantity j i e h r j ω β w s ζ ζ ω β w single sided power spectral density of long crested waves s x x ω single sided power spectral density of vessel response x s s n the index of the occurring sea state i e the sea state number t p spectral peak period u vessel forward speed w r j weight factor for the r th variable combination based on measurement of quantity j x j t the original signal for the measured quantity j at time step t x j the mean of the filtered time series x ˆ j t x ˆ j t the filtered time series of x j t credit authorship contribution statement xu han conceptualization methodology software formal analysis data curation writing original draft writing review editing svein sævik writing review editing supervision project administration bernt johan leira writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was made possible through the centre for research based innovation move financially supported by the research council of norway nfr project no 237929 and the consortium partners http www ntnu edu move special thanks are given to section of hydrodynamics stability in dnv for providing the numerical seakeeping models appendix the simulated sea states and tuning of β 44 the parameters summarized in the tables are described as follows s s n sea state number index h s m significant wave height β w wave direction t p s wave spectral peak period β 44 the true value of β 44 according to table 3 β 44 the gpr model predicted β 44 before tuning for sea state s s n σ β 44 2 the gpr model predicted variance of β 44 before tuning for sea state s s n β ˆ 44 the tuned β 44 for sea state s s n σ ˆ β 44 2 the variance of β 44 after tuning for sea state s s n 
20647,online tuning of vessel models based on onboard measurement data can reduce the uncertainties of vessel motion prediction and therefore potentially increase the safety and cost efficiency for marine operations among the uncertain vessel parameters the roll damping coefficient is very important and highly nonlinear in reality roll damping depends on the sea state and vessel condition this paper proposes two different procedures for tuning the sea state dependent roll damping coefficient together with other uncertain vessel parameters i e 1 step tuning and 2 step tuning procedures in addition a roll damping prediction model based on gaussian process regression is also proposed to predict the roll damping for future sea states based on historical data the tuning procedure together with the proposed prediction model form an iterative closed loop of continuously improving the knowledge about the roll damping online also estimating the model uncertainty based on prior knowledge sampling uncertainties and the applied kernel case studies are presented to demonstrate the procedures keywords online model tuning discrete bayesian updating roll damping gaussian process regression stochastic kriging wave induced vessel motion 1 introduction reliable vessel motion prediction plays a key role for the safety and optimization of maritime and offshore activities among the vessel motions induced by different environmental sources the wave frequent ones can be most critical to predict because they are most difficult to control in engineering practice it is acceptable to simplify the relation between wave elevation and the rigid body vessel motions by linearization of the transfer functions in the frequency domain especially for typical marine operations executed at moderate seas dnvgl st n001 2016 the vessel motion linear transfer functions for the 6 degrees of freedom dofs in complex form are usually also referred to as response amplitude operators raos the roll motion is widely recognized as the most critical and challenging response quantity to predict because the critical roll motion near resonance is extremely influenced by the estimated damping which is significantly underpredicted by the linear potential theory roll damping is highly nonlinear and has therefore attracted huge research interest for more than a century falzarano et al 2015 system modelling usually requires simplifications which result in model uncertainties and errors linearization of roll damping is common practice for seakeeping analysis in order to estimate the linear transfer function between wave elevation and vessel roll motion i e the roll rao for irregular waves the roll damping is linearized by minimizing the error between the linearized and the real system with the assumption that both input to and output from the system are gaussian processes kaplan 1966 this is called stochastic linearization the watanabe inoue takahashi formula may be applied to estimate the total roll damping for varying u vessel forward speed ϕ a roll amplitude ω wave frequency and ship forms himeno 1981 however the estimation seems only acceptable for normally loaded ships near their natural frequencies himeno 1981 a third order polynomial formula may well model the nonlinearity between the non dimensional equivalent linear roll damping b ˆ 44 and the non dimensional frequency ω ˆ for each combination of u ϕ a vessel loading and ship form based on tasai takaki s table reported in english by himeno 1981 however the b ˆ 44 as a function of e g ship form and speed is not clear about half a century ago ikeda himeno tanaka and their teams from osaka prefecture university heavily contributed to understanding and modelling the nonlinear roll damping in a systematic manner their work of separating the roll damping into several components and ignoring their interactions recommended by ittc 2011 basically forms the present engineering practice of ship roll damping estimation in the absence of experimental data known as ikeda s method the equivalent linear roll damping b 44 can be separated as follows himeno 1981 1 b 44 b w b f b e b l b b k where b w is the wave damping b f is the friction damping caused by hull skin friction b e is the damping due to eddy making b l is the linear lift damping b b k is the damping due to the bilge keels among them b w and b l are linearly proportional to roll angular velocity while the other components are nonlinear b f is relatively less important and may be neglected for full scale ships himeno 1981 ikeda et al 1978a b c 1979 proposed formulas for estimating most of the important roll damping components by a semi empirical approach even though ikeda s formulas are recommended by ittc 2011 cautions should be taken because 1 ikeda s formulas are limited to certain ship forms and 2 ikeda s formulas were derived for pure roll motion based on still water condition larsen et al 2019 for example the use of panel methods to predict the wave damping b w with forward speed is theoretically accurate and recommended falzarano et al 2015 over the semi empirical ikeda s formulas ikeda et al 1978b söder et al 2017 found that the ikeda s formulas significantly overestimated the hull lift damping component while underestimating the bilge keel damping by benchmarking with model test data consequently model tests or empirical data are always preferred for new vessel design in order to model the roll damping with sufficient accuracy free decay model tests are normally performed to obtain the roll damping however only at the important damped roll resonance frequency forced rolling model tests can be performed to obtain the roll damping at other frequencies however this is frequently not performed in addition much more model tests are required if the roll amplitude dependent damping coefficients are wanted by fitting to the empirical data the total roll damping can be modelled as functions of vessel speed u vessel draught d roll amplitude ϕ a or wave amplitude a wave frequency ω etc however the scale effects of model tests may significantly affect the accuracy of the roll damping estimation söder and rosén 2015 at present prediction of roll damping based on numerical simulation by computational fluid dynamics cfd codes has also received considerable attention e g irkal et al 2016 however a reliable cfd analysis requires high competence in modelling and understanding the limitations of the codes and the applied algorithms usually results from cfd analyses require validation from model tests both model tests and high fidelity analyses are expensive and time consuming therefore it is of great interest to improve the knowledge of the roll damping for the specific vessel throughout its whole life cycle by using the weather information and the vessel motion measurements onboard in practice the additional damping can be considered as a function of parameters related to the sea state and vessel condition i e b 44 f x where x u d h s t p β w h s is the significant wave height t p is the spectral wave peak period β w is the wave direction with such a roll damping function the rao and roll motions can be estimated at a specific wave and vessel condition by assuming stationarity consequently the improved roll damping model built upon on site measurements can potentially increase the cost efficiency and safety for marine operations it is very challenging to update the roll damping by on site measurements and weather information because 1 measurements and weather information are subject to significant uncertainties bitner gregersen and hagen 1990 qiu et al 2014 and 2 there are also many other vessel parameters subject to uncertainties e g inertia items han et al 2020 therefore all the uncertain parameters should be identified first and tuned simultaneously in a probabilistic way an earlier case study by han et al 2020 indicates that multiple sensors at different locations providing signals of displacements velocities and accelerations can help identifying the uncertain vessel parameters han et al 2021a proposed an algorithm for tuning of vessel model parameters by bayesian inference tuning of the uncertain vessel parameters in a probabilistic approach can improve the knowledge about the real time vessel condition and reduce the model uncertainties quantitatively based on onboard vessel motion measurements and wave information such as h s t p β w directional spreading and spectral shape vessel parameters can be sea state dependent vessel condition dependent or permanent han et al 2020 the sea state dependent parameters e g roll damping usually also depend on vessel conditions e g loading conditions and vessel forward speed han et al 2021a considered a constant roll damping coefficient through different sea states for tuning and pointed out that the algorithm should be further developed to tune vessel roll damping as being sea state dependent the present paper describes the algorithm for tuning of sea state dependent roll damping coefficient together with other vessel parameters in addition it is even more important for this paper to establish an algorithm which prescribes how to model the roll damping as sea state dependent and predict it for the unobserved future sea states this is considered particularly challenging because 1 the tuned roll damping value is only valid for the current sea state which does not directly help predicting the vessel roll damping for other sea states therefore the algorithm should be able to predict the roll damping for the unobserved sea states with improved accuracy based on prior knowledge and historical tuning results for different sea states and vessel conditions 2 as discussed previously it is difficult to define a function in advance that is sufficiently accurate for modelling of roll damping 3 the number of available full scale measurements can be very limited and insufficient under fitting or over fitting can be expected 4 the available measurements may also be concentrated around certain sea states it is questionable to predict roll damping for other sea states by extrapolation based on any fitted curve the paper is organized as follows the basic vessel model tuning algorithm is described in section 2 han et al 2021a for flexible modelling of roll damping gaussian process regression is introduced in section 3 in section 4 two procedures are proposed to modify the basic model tuning algorithm in order to tune and represent roll damping as being sea state dependent numerical case studies are carried out to demonstrate the performance of the proposed tuning procedures and the corresponding roll damping prediction model the basis of the case studies are described in section 5 and the results are shown in section 6 finally section 7 concludes and discusses the findings limitations and future work related to the present research 2 basic vessel model tuning procedure the applied algorithm for tuning of vessel seakeeping parameters based on wave information and vessel motion measurements proposed by han et al 2021a is briefly repeated here for completeness purposes the algorithm is also illustrated in fig 1 firstly the uncertain vessel parameters i e φ 1 φ 2 φ m φ m m 1 2 m are identified based on their sensitivities with respect to the measured vessel motions of primary interest this can be achieved by performing uncertainty and sensitivity analyses e g han et al 2020 the uncertainty ranges of those parameters can be determined based on the relevant prior information such as available design and analysis documentation accuracy of onboard monitoring data and engineering judgement each uncertain parameter φ m is then discretized evenly into i m values within its uncertainty range for a successful tuning it is important to have a sufficiently large uncertainty range for each φ m while the spacing between the discretized values should be sufficiently small to capture any critical nonlinear behaviour considering reasonable uncertainty ranges based on practical prior information 5 to 8 discrete values for each vessel parameter can be sufficient for the tuning combining the uncertain parameters at their discrete values a total number of r i 1 i 2 i m discrete assessment points are defined for calculating the possible raos in addition multiple quantities of vessel motions e g displacement velocity and acceleration for different dofs at different locations are normally required for the tuning process each of the considered measured vessel motion quantities is indexed by j 1 2 j consequently a rao database containing r j raos can be established by performing seakeeping analysis for those measured quantities at those discrete combinations of the uncertain parameters the joint probability distribution of the identified uncertain vessel parameters is denoted as p n φ 1 φ 2 φ m the superscript n stands for the number of completed iterative updates based on the proposed tuning procedure the joint probability distribution is tuned for each stationary wave and vessel condition typically for a vessel in steady condition with respect to heading advancing speed and inertia distribution the stationarity is determined by the duration of a stationary sea state which could vary from 20 min to 3 hr depending on geometrical location with the information on waves e g a wave spectrum vessel motion measurements e g signal x j t for the measured quantity j and a rao database covering the uncertainty ranges of the uncertain vessel parameters the tuning can be performed as follows 1 filter the vessel motion measurements x j t to obtain the vessel motion time series in the wave frequency domain the high frequency components e g signal noise and the low frequency components e g signal bias second order motions are important to be filtered out the filtered signal is denoted as x ˆ j t 2 calculate the standard deviation of the filtered signal σ ˆ j by 2a σ ˆ j t 1 n t x ˆ j t x j 2 n t 1 2b x j t 1 n t x ˆ j t n t where n t is the total number of time steps of the signal and x j is the mean value of the filtered signal the duration of the signal x j t t n t δ t where δ t is the time interval should be selected such that the sea state and vessel condition remains stationary within the duration of t while the sampling variability should be sufficiently small a typical value of t can be 20 min to 1 hr 3 calculate the standard deviations of the possible vessel response σ r j based on the wave spectrum and the candidate rao from the rao database for the measured quantity j i e r a o r j 3a σ r j n 1 n ω s x x r j ω n δ ω 3b s x x r j ω h r j ω β w 2 s ζ ζ ω β w where n ω is the total number of the discretized frequencies for the response spectrum s ζ ζ ω β w is the long crested wave spectrum and s stands for a single sided power spectrum s x x r j ω is the possible response spectrum for the response x corresponding to the measured quantity j based on the vessel parameter combination r h r j ω β w is the corresponding linear transfer function i e r a o r j between wave elevation and vessel response each possible combination of the considered vessel parameters i e ϕ i 1 ϕ i 2 ϕ i m is subscripted with number r 1 2 r where ϕ i m for m 1 2 m is the i m th discrete value of the considered uncertain vessel parameter φ m in the rao database r m 1 m i m is the total number of vessel parameter combinations and i m is the number of the discretized values of φ m in the rao database for all possible vessel parameter combinations σ r j should be calculated 4 less sensitive measured quantities for the considered uncertain vessel parameters at the current sea state s ζ ζ ω β w should be screened out the sensor screening ratio ssr α j is introduced to quantify the importance of the measured quantity j 4a α j σ σ r j σ ˆ j 4b σ σ r j r 1 r σ r j σ r j 2 r 1 4c σ r j r 1 r σ r j r where σ σ r j is the standard deviation of σ r j over r 1 2 r the case study uses a screening criterion of α 0 0 05 if α j α 0 the signal of the quantity j will be excluded during the process of tuning the parameters ssr basically represents the importance of the obtained measurements for tuning of the considered vessel parameters for the present sea state the selection of the criterion value α 0 depends on the uncertainties of the measurements and the system errors introduced by application of linear potential theory to represent the true vessel dynamics within the wave frequency band the influence of the introduced screening criterion on the final tuning results is discussed by detailed sensitivity studies in han et al 2021a 5 calculate the weight factor for each parameter combination r by inverse distance weighting shepard 1968 5 w r j 1 σ r j σ ˆ j p where p r is called the power parameter the choice of the p value depends on the number of considered uncertain parameters their sensitivity and uncertainty ranges and engineering judgements the influence of the p value on the tuning results was studied by han et al 2021a 6 build the likelihood function for updating the joint probability distribution of the considered uncertain parameters φ 1 φ 2 φ m first establish the weight matrix w j for all r 1 2 r in the rao database the weight matrix would have m dimensions with the size of i 1 i 2 i m then linearly interpolate the weight matrix w j from the size of i 1 i 2 i m variable resolution in the rao database to the size of k 1 k 2 k m variable resolution in the discrete joint probability distribution 7 update the joint probability distribution p n 1 φ 1 φ 2 φ m since the likelihood function i e weight matrix w j is presented at limited number of parameter combinations r 1 2 n p r o b where n p r o b m 1 m k m and k m is the number of the discretized values of φ m in the discrete joint probability distribution updating the joint probability distribution based on discrete bayesian inference labbe 2018 must therefore be calculated at those discretized points i e 6 p m f n 1 φ 1 φ m no p m f n φ 1 φ m w j where p m f means the joint probability mass function operator means the element wise multiplication of the two matrices of the same dimension i e a hadamard product scheick 1997 to ensure that the sum of the joint probability mass function remains 1 0 normalization no is required physically the uncertain vessel parameters are continuous variables therefore the joint probability density function pdf is more appropriate to represent their uncertainties numerically the relation between joint pmf and joint pdf can be approximated by 7 p m f ϕ k 1 ϕ k 2 ϕ k m p d f ϕ k 1 ϕ k 2 ϕ k m m 1 m δ φ m where ϕ k m for m 1 2 m is the k m th discrete value for the variable φ m δ φ m is the interval between the discrete values of variable φ m the algorithm applies statistical inference of the direction independent vessel parameters based on onboard measurements and wave information consequently the tuned vessel model can be applied to predict the vessel motion for other sea states and wave directions with quantified parameter uncertainties 3 gaussian process regression gaussian process regression gpr is found to be a very promising solution for roll damping modelling and prediction because 1 it does not require to decide the format of the roll damping function 2 the tuned values of roll damping for the previous sea states and vessel conditions can reasonably influence the prediction of roll damping for future sea states and vessel conditions through the covariance function 3 it also indicates the estimation uncertainty based on the prior knowledge the available samples and the selected kernel function gpr is fundamentally based on the conditional distribution of multivariate gaussian vectors rasmussen and williams 2006 for a n m dimensional multivariate gaussian vector y 8 y y 1 y 2 with sizes n 1 m 1 where y 1 and y 2 are also multivariate gaussian vectors and the mean vector μ and the covariance matrix σ can be written as 9a μ μ 1 μ 2 with sizes n 1 m 1 9b σ σ 11 σ 12 σ 21 σ 22 with sizes n n n m m n m m then the conditional distribution of y 2 on y 1 y 1 is also a multivariate gaussian distribution i e 10a y 2 y 1 y 1 n μ 2 σ 22 10b μ 2 μ 2 σ 21 σ 11 1 y 1 μ 1 10c σ 22 σ 22 σ 21 σ 11 1 σ 12 this means that the distribution of y 2 can be updated based on the known samples y 1 y 1 and the covariance matrix for y 2 and y 1 it is worth noting that updating of the variance matrix σ 22 i e eq 10c does not rely on the observed values of y 1 i e y 1 for a continuous function y f x each y value i e y i f x i i z can be considered as a gaussian distributed random variable i e y i n μ i σ i and all variables are correlated by having samples at some known points x 1 i e y 1 f x 1 y 1 the corresponding predictions at other points e g y 2 f x 2 can be estimated based on eqs 9 and 10 if the covariance matrix of the variables for y 1 and y 2 i e σ can be established the covariance matrix is called the kernel or the similarity function which establishes the correlation among data points it is physically reasonable to consider the kernel covariance coefficient k x i x j c o v i j between y i f x i and y j f x j to be a function of the distance along the input axis i e k x i x j g x i x j among many kernel designs the radial basis function rbf is the most popular kernel i e 11 k x i x j σ f 2 exp 1 2 l 2 x i x j 2 where two hyperparameters are introduced σ f 2 is called signal variance which represents the prior knowledge about the variance of the random process l is called length scale in reality samples are also subject to uncertainties in the input space y the observed samples y can be written as 12 y f x ϵ where the ϵ vector represents the uncertainties for the samples for each sample y i the uncertainty ϵ i is also considered to be a gaussian variable 13 ϵ i n 0 σ y i 2 where σ y i 2 represents the uncertainty level for the observed sample y i consequently for predicting y f x eq 10 can be modified to account for sampling noise 14a y y y n μ k 14b μ μ k y k y 1 y μ y 14c k k k y k y 1 k y where y is the input space y is the observed samples for the input space y is the space to be predicted prediction space μ and k are the conditional mean and the updated kernel i e the similarity function for the prediction space μ and μ y represent the prior means k y and k y are the kernels representing the correlations between the input space and the prediction space calculated based on eq 11 k y can be calculated by 15a k y k y σ y 15b k y k x 1 x 1 k x 1 x j k x 1 x n k x i x j k x i x n k x n x n 15c σ y σ y 1 2 σ y i 2 σ y n 2 where k y is the kernel for the input space with each element calculated based on eq 11 σ y is a n n diagonal matrix note that k y is no longer the covariance matrix for the input space because it includes the uncertainties of the observations eqs 14 and 15 including the sampling uncertainties is called stochastic kriging gpr is a non parametric method meaning that the regression does not require knowing the form or the order of the function gpr is sometimes also considered as an infinite parametric method because it ideally requires infinite samples in order to perfectly model the function fig 2 as an example illustrates how the gpr hyperparameters influence the prediction larger σ y 2 helps to smoothen the fitted curve surface for the sample with uncertainties σ y 2 represents its sample uncertainty error the length scale l indicates how strong the correlation is between the points in that dimension in addition to σ y 2 the length scale may also help the regression avoiding over fitting and under fitting σ f 2 represents the variance of the prior knowledge about the model it can be interpreted as the variance of a point that is far away from all the available sample points i e negligible correlation the stochastic kriging algorithm rasmussen and williams 2006 as implemented in the python package scikit learn sklearn hereafter pedregosa et al 2011 has been used the gpr in sklearn has been demonstrated as near the best gpr programme with respect to its analysis performance and computational speed erickson et al 2018 the gpr model in sklearn assumes zero prior mean it is practically acceptable since the gpr model converges according to the available samples and independent of the provided prior mean if the amount of training data is sufficiently large however to ensure accuracy for research purpose non zero prior mean is considered in the study based on the fact that the prior mean vector does not influence the covariance matrix for the multivariate gaussian distribution i e y y n μ y μ k y k y k y k is equivalent to 16 y μ y y μ n 0 0 k y k y k y k the prior mean will accordingly be subtracted from the values at the data points before the gpr model fitting whereas it will be added to the predicted value for the prediction based on the fitted gpr model tuning the hyperparameters may be based on personal experience and engineering judgement however these hyperparameters can also be automatically optimized by assuming that the input data points y are given at their maximum likelihood the log marginal likelihood for a zero mean prior can be written as rasmussen and williams 2006 17 log p y x log n y 0 k y 1 2 y t k y 1 y 1 2 log k y n 2 log 2 π where n is the number of samples in order to better control the gpr model for the present research the hyperparameters of the kernel are manually determined without applying the sampling dependent optimization in eq 17 4 proposed procedure for tuning of vessel parameters including sea state dependent roll damping 4 1 one step tuning procedure in order to interactively tune sea state dependent roll damping and improve the roll damping prediction model i e the gpr model the model tuning algorithm described in section 2 is modified as illustrated in fig 3 assume that the joint probability distribution of the uncertain vessel parameters have been tuned for n 1 sea states and so as to the gpr model of β 44 the procedure of tuning vessel parameters and updating the gpr model based on the measurements i e x j t j 1 2 j and the corresponding wave information for the next sea state s s n is described below s s n z is the index of the sea state i e sea state number 1 given the wave information for the sea state s s n and the updated gpr model from previous sea states the additional roll damping coefficient β 44 can be predicted in terms of its mean and variance values then the probability mass function of β 44 s s n can be established at the discrete values assuming it is gaussian distributed 2 together with the available knowledge about other uncertain vessel parameters after the previous sea state s s n 1 i e p m f s s n 1 φ 1 φ m 1 the joint probability distribution including β 44 can be calculated by multiplying the probability mass functions of β 44 s s n and the other parameters at their discrete values i e 18 p m f s s n p r i ϕ k 1 ϕ k m 1 ϕ k m p m f s s n 1 ϕ k 1 ϕ k 2 ϕ k m 1 p m f ϕ k m s s n where ϕ k m for m 1 2 m 1 is the k m th discrete value of the parameter φ m ϕ k m s s n is the k m th discrete value of β 44 predicted by the gpr model for the sea state s s n φ m β 44 s s n 3 with the pre established rao database and the received vessel motion measurements for all the j quantities for the sea state s s n the weight matrices can be calculated for each sensor measurement based on the previously described tuning procedure in section 2 4 then the joint probability mass function of vessel parameters can be updated based on eq 6 as the posterior of the vessel parameters for the wave information s s n 5 the posterior mean μ β 44 s s n and standard deviation σ β 44 s s n can be calculated by 19a p m f s s n p o s ϕ k m k 1 1 k 1 k m 1 1 k m 1 p m f s s n p o s ϕ k 1 ϕ k m 19b μ β 44 s s n p o s k m 1 k m ϕ k m p m f s s n p o s ϕ k m 19c σ β 44 s s n p o s k m 1 k m ϕ k m μ β 44 s s n p o s 2 p m f ϕ k m and the posterior of the other parameters can be calculated for each combination by 20 p m f s s n p o s ϕ k 1 ϕ k m 1 k m 1 k m p m f s s n p o s ϕ k 1 ϕ k m the gpr model of β 44 can be updated with the new available information μ β 44 s s n p o s and σ β 44 s s n p o s 6 then for the next sea state the joint p m f s s n p o s φ 1 φ m 1 will become the prior information 4 2 two step tuning procedure for tuning of sea state dependent parameters a larger power parameter p is usually desired due to the very limited number of available measurements for that particular sea state however tuning of other parameters may not require and may not benefit from application of such a large p value the larger the p value is the faster the variance of the parameters can be reduced potentially leading to an over confidence issue the tuning results could be biased han et al 2021a once the variance becomes relatively small the expected value of the tuned parameter becomes very difficult to change considering that all the vessel parameters must be tuned simultaneously the one step tuning procedure could be modified by splitting the bayesian updating into two steps as illustrated in fig 4 the basic idea is to apply two different power parameters p 1 and p 2 where p 1 p 2 to calculate the p m f s s n p o s φ 1 φ m 1 and p m f s s n p o s β 44 separately 5 case study basis case studies were performed in order to investigate the proposed algorithm in detail for illustrative purpose tuning of only 2 vessel parameters simultaneously was considered the roll damping was assumed to be a function of only three independent wave related parameters i e h s t p and β w and can be written as a function of two input characteristics i e h s sin β w and t p 5 1 vessel information and rao database all case studies were based on numerical models for an offshore supply vessel osv close to its ballast condition zero forward speed has been considered the reference coordinate system for the seakeeping analysis is illustrated in fig 5 the x z plane is at the vessel longitudinal symmetry plane and the origin is at the stern of the keel elevation the positive x axis points towards the bow the positive y axis points towards the port and the positive z axis points vertically upwards the wave heading β w as illustrated in fig 5 follows the same coordinate system in a positive going to convention as described in section 2 the rao database should be established to represent the raos for all the considered motions sensor locations and covering the whole uncertainty ranges for the considered uncertain vessel parameters the measurements of vessel heave displacements velocities and accelerations at three locations see fig 5 have been considered as summarized in table 1 assuming that the measurements are independent it is also assumed that there is much available supplementary information regarding the vessel design properties e g operation design report and arrangement drawing and onboard sensors e g ballast monitoring to approximately identify the vessel condition in real time therefore the online vessel model tuning is focused on reducing the uncertainties of the estimated vessel condition resulting from new information becoming available based on measurements the considered uncertain vessel parameters were selected based on the previous parametric sensitivity study han et al 2020 their uncertainty ranges are summarized in table 2 each of the considered vessel parameters was discretized within the specified uncertainty range the number of discrete values is also shown in table 2 in total 9 wave headings between 30 and 150 with a 15 interval were considered in the rao database for all the 9 sensor measurements described in table 1 all the raos were calculated by means of the dnv gl commercial software wasim dnv gl 2018 which is based on application of the rankine panel method kring 1994 5 2 assumed function of additional roll damping as discussed in section 1 the linearized roll damping b 44 can be a function of many parameters e g 21 b 44 g h s t p β w c o g m a s s u ϕ a where c o g is the vessel centre of gravity m a s s is the vessel mass in real applications the gpr model of the roll damping b 44 can be initiated based on the ikeda s formulas mentioned in section 1 then the acquired wave and vessel motion measurements can assist in tuning b 44 and updating the gpr model according to the proposed procedures in section 4 for the purpose of demonstration it was assumed that the roll damping according to the potential theory has been accurately calculated by seakeeping analysis software and the linearized additional roll damping coefficient β 44 can be accurately described as 22a β 44 f h s sin β w ω p 22b β 44 b 44 b w b 44 c r i t where f is a linear function ω p 2 π t p b 44 c r i t is the critical roll damping calculated based on vessel hydrodynamic coefficient matrices of added mass inertia and stiffness the true linear function f illustrated in fig 6 was defined by the data points as summarized in table 3 linear interpolation between the data points was applied extrapolation was not allowed the prior knowledge about β 44 was considered as a constant gaussian process with prior mean of 0 07 and variance of 0 0 2 2 i e 23 β 44 0 n 0 07 0 0 2 2 the prior mean and prior variance of β 44 is also illustrated in fig 6 5 3 scope of case studies two separate cases were studied in detail case gmt investigated the algorithm performance for tuning of gmt and β 44 and updating the prediction model for β 44 simultaneously whereas case xcg investigated the algorithm performance for tuning of xcg and β 44 and updating the prediction model for β 44 simultaneously the prior and true β 44 are described in section 5 2 for demonstration purposes the assumed true values and prior knowledge about the gmt and xcg in the case studies are defined in table 4 demonstration on tuning and prediction of β 44 is the key objective of the case studies therefore no head seas or following seas have been considered it is worth mentioning that the proposed gpr model can also be used for designing experimental test scopes actively i e an adaptive sequential experimental design e g neumann brosig et al 2020 based on available experimental data the gpr model can indicate where the largest uncertainty is to be found consequently the next test can be designed at that point to optimize the test scope however for the vessel in operations the occurrence of sea states is decided by nature consequently the sampling scheme cannot be established in the same way as for adaptive sequential experimental design for the case studies the sea states were randomly simulated as shown in table 5 similar to the case studies demonstrated by han et al 2021a b h s t p and β w were also assumed to be evenly distributed random variables within the specified ranges only for demonstration purposes note that the variables which represent the long term wave conditions are usually not uniformly distributed in the real world all the sea states were assumed to be adequately represented by the pierson moskowitz pm spectrum directional spreading of the sea states was not considered many initial simulations were performed in order to understand how the proposed algorithms will work the initial findings were 1 more samples are required in order to train the gpr model for the case of higher dimension the considered gpr model actually have 3 random input parameters i e ω p h s and β w the random generation of the uniformly and independently distributed h s and β w variables actually leads to a non uniformly distributed h s sin β w consequently a much smaller likelihood of occurrence should be expected along the edges of the considered surface of the β 44 gpr model 2 for the β 44 gpr model the prior variance described in eq 23 should be applied as the hyperparameter signal variance σ f 2 3 each of the two input characteristics of the gpr model i e h s sin β w and ω p requires an independent length scale l for an uncomplicated and smooth true surface such as a polynomial function it seems reasonable to set l to be 10 20 of the total range of each axis parameter 4 for sea state s s n the variance of β 44 s s n after tuning represents the uncertainty of that data point therefore σ y s s n σ β 44 s s n p o s 5 tuning of the sea state dependent β 44 requires a relatively large power parameter p the vessel motion signals were numerically simulated noise was also added to the signals the considered input parameters for noisy signal simulation and case studies are summarized in table 5 the vessel motion measurements for each sea state were simulated for 1 h each case study included 72 sea states the procedure of simulating the noisy vessel motion measurements is illustrated in fig 7 the true response spectrum for response x i e s x x ω can be calculated based on the wave spectrum of the randomly simulated sea state and the corresponding vessel response rao a realization of that response can be generated by 24a x t n 1 n ω c n ω n cos ω n t φ n 24b c n ω n 2 s x x ω n δ ω where φ n 0 2 π is a random phase angle which is continuous and uniformly distributed δ ω is the interval of the discrete radial frequencies ω n and n ω is the total number of discrete frequencies for the response spectrum then the signal noise can be added to each time step of the time series assuming that 1 the signal noise is white noise i e w n n 0 σ n 2 2 and the variance of noise σ n 2 is proportional to the true signal variance σ x 2 defined as snr signal to noise ratio 25 s n r σ x 2 σ n 2 6 results 6 1 one step tuning a number of cases have been analysed also including stochastic variability obtained by means of seed variation a summary of the aggregated results are reported for the purpose of demonstration and documentation of the algorithm performance 6 1 1 case gmt representative results corresponding to two different realizations are included with initial seed number 128 denoted as seed128 and seed number 45 denoted as seed45 note that different initial seed number will determine different sea states with respect to different h s t p β w and seeds for generating virtual noisy signals figs 8 and 9 illustrate the updated gpr model for β 44 after tuning the vessel parameters for 72 sea states information on the randomly generated sea states and the intermediate results with respect to tuning of β 44 are summarized in tables a 6 and a 7 in appendix for seed128 and seed45 respectively the expected values of the tuned β 44 for those 72 sea states are also illustrated as samples in figs 8 and 9 figs 10 and 11 illustrate the tuned results of gmt throughout the 72 sea states for seed128 and seed45 respectively as expected both β 44 gpr models are found to converge towards the presumably true function the posterior knowledge on β 44 in terms of the mean and variance improves significantly based on the simulated vessel motion measurements for 3 days however the results of the tuned gmt become very different for the two presented cases for seed128 case fig 10 the gmt mean fluctuates around the true value when the tuning algorithm finds that the previously tuned gmt deviates significantly from the current observation the variance dramatically increases reflecting the confusion of the system the increasing variance helps the system to adjust the tuning direction note that more simulations with different initial seeds were performed for most simulated cases the tuned gmt fluctuates about 0 5 m and 0 6 m throughout the 72 sea states similarly to the behaviour illustrated in fig 10 on the contrary fig 11 shows that the tuned gmt for case seed45 significantly deviates from the true value the variance was reduced significantly while the mean value of the gmt was quickly tuned to a wrong value this leads to an over confident situation where the tuning system was not able to bounce back to the true value as shown in fig 11 the variance increased significantly between sea state number 45 and 50 and sea state number 66 and 68 the system tried very hard to bounce back towards the true value however it did not manage to change the tuned mean value of the gmt significantly this type of over confidence is dangerous hence a too rapid decrease of the variance for parameters that are not sea state dependent should be avoided the bias associated with the tuned value of the gmt also indicates that the gmt may not be very sensitive to vessel motions for most wave conditions it is worth mentioning that the sequence of the occurring sea states and the corresponding measurements can influence the tuning of the sea state independent parameters i e gmt in this case as well as the updated gpr model for the sea state dependent β 44 however such influence is usually very limited for convergent tuning results with sufficient amount of data and carefully selected power parameter p so that over confident tuning can be avoided divergent tuning results however can be more influenced by the order of the sea state occurrence in reality the tuning is carried out in the sequence of occurrence by nature which means that changing the tuning sequence is not relevant in practice 6 1 2 case xcg based on earlier studies han et al 2020 2021a c the value of xcg is found to have a stronger influence on the vessel motions than the value of gmt therefore as expected tuning of xcg was much more stable than tuning of gmt fig 12 shows the significantly improved gpr model of β 44 compared with the prior knowledge fig 6 the intermediate tuning results of β 44 are summarized in table a 8 in appendix fig 13 shows that the tuned xcg gradually approaches the true value 6 2 two step tuning based on the findings in section 6 1 1 the over confidence low variance implies that the 1 step parameter tuning procedure has difficulties in counteracting the convergence to the wrong value therefore it is of great interest to apply the proposed 2 step tuning procedure as described in section 4 2 so that the sea state independent vessel parameters can be tuned relatively slowly compared with results based on the 1 step tuning procedure the trained gpr models of β 44 approach the true surface in a better way due to the applied higher power parameter for tuning of β 44 tables a 9 and a 10 in appendix summarize the intermediate tuning results of β 44 for case gmt seed45 and case xcg seed128 respectively based on 2 step tuning procedure with respect to tuning of gmt as shown in fig 14 the 2 step tuning algorithm by application of a smaller power parameter leads to smaller fluctuations of the tuned mean values based on the measurements from different sea states the over confidence issue with respect to the gmt variance could therefore mainly be avoided a large variance is preferred instead of a biased estimate resulting from over confidence due to a fictitiously small variance as shown in fig 15 with a smaller power parameter p tuning of the xcg was even accelerated towards the true value approximately between sea state number 15 and 40 the variance decreased more slowly but the expected value converged faster towards the true value 7 conclusions and future work the paper has proposed an algorithm for tuning and prediction of sea state dependent roll damping by an iterative closed loop between the tuning procedure and the gpr based prediction model the tuned β 44 for the current sea state updates the gpr model which in return improves the β 44 prediction for future sea states a simple and representative roll damping function was presumed for the numerical studies for demonstration purposes the numerical case studies have shown that the tuning procedure succeeds to improve the roll damping coefficient estimation the true variation of β 44 is expected to be identified based on the real on site vessel motion measurements and the environment although subjected to some uncertainties with the 1 step tuning algorithm the sea state independent parameters such as gmt and xcg may suffer from the over confidence issue due to the applied large power parameter therefore a 2 step tuning algorithm was proposed by applying two sets of different likelihood functions to update the prior knowledge in order to tune roll damping and other parameters with different confidence level case studies showed that the 2 step tuning algorithm may even accelerate the tuning towards the true value in addition for the biased tuning e g tuning of gmt for initial seed number of 45 the 2 step tuning can at least slow down the divergence even though the proposed tuning framework is expected to improve the estimation of sea state dependent vessel parameters several important limitations should be emphasized for real applications 1 the amount of on site measurements can be limited especially for operations with frequently changing vessel conditions there might be only a few available sea states for a certain vessel condition with respect to inertia distribution and vessel speed therefore it might be reasonable to apply larger length scale l in the rbf kernel of the gpr model in order to make the available updates influence the gpr model as much as possible however under fitting may occur as illustrated in fig 2 2 the proposed algorithm for online tuning of sea state and vessel condition dependent roll damping based on on site measurements cannot fully substitute lab experiments the vessels are designed to survive at extreme and accidental scenarios which probably do not happen on site for a considerably long period therefore tuning based on on site measurements is probably insufficient to find a complete and sufficiently accurate function for representation of roll damping covering the most extreme weather conditions and accidental scenarios lab tests can be designed and optimized but not for on site conditions using on site measurements to improve the knowledge of roll damping for moderate seas is reasonable however predicting the extremes should still rely on model tests and cfd analysis 3 the on site sea states usually vary slowly meaning that the sea state occurring afterwards is normally close to the current sea state this slowly varying characteristics negatively influence the global performance of the gpr model updating however this could also be an advantage in terms of better accuracy in relation to the local input domain of highest interest more useful data can be available in a concentrated sub space of the input parameters e g h s and t p and the environmental condition for the operation in the near future is probably located close to or within this concentrated input space consequently more confidence could be obtained within such input space of great interest for the near future operation in addition future work is essentially required before real applications on board can be achieved 1 as stated in items 2 and 3 of the algorithm limitations the probability of occurrence for wave conditions is not uniformly distributed in the real world hence insufficient observations with respect to gpr modelling are expected at those wave conditions with low probability of occurrence the rbf kernel may be modified so that the length scale l can be location dependent in the input space of the gpr model a larger value of l may be applied for the input sub space with low probability of occurrence so that those less frequently observed samples can have increased influence on a wider range of the input domain 2 the proposed tuning framework as described in section 4 introduces a gpr model which relies on the selection of the kernel and its hyperparameters the hyperparameters of the gpr model can be optimized as described in section 3 however it was found that the optimal solution depends on the initial searching values bounds the amount of training data and the applied algorithm erickson et al 2018 therefore future research should investigate the effects of applying other kernels e g matérn kernel rational quadratic kernel and dot product kernel and the effects of applying the automatic tuning of the kernel s hyperparameters on the results of tuning and predicting vessel parameters 3 the gpr prediction model must be continuously qualitychecked usually a stopping criterion should be introduced in the future to avoid analysis divergence for the β 44 gpr model the stopping criterion could be related to the prediction error for example if the tuned roll damping based on the new measurements is outside of the 99 percentile interval of the available gpr model at that sea state then it might indicate that 1 the gpr model is over confident 2 the tuned results are biased or 3 the vessel condition is changed etc 4 roll damping depends not only on the sea states but also on the vessel conditions such as vessel forward speed and loading conditions future research should demonstrate the tuning algorithm with a more complete roll damping gpr model which is sea state and vessel condition dependent the proposed procedure could be modified by just including parameters with respect to vessel conditions as input parameters to the gpr model 5 in reality the acquired wave information e g on h s and t p is always subject to uncertainties which was not considered in the present paper it is important as part of future work to systematically consider the effects of the weather uncertainties on the model tuning algorithm and the roll damping gpr model 6 in the tuning procedure the values of the power parameter p and the ssr criterion parameter α 0 can significantly influence the tuning results and the selection of both values is at the moment based on trial and error how to determine their values based on available quantitative information about system dimension measurement uncertainty etc can be important to investigate as part of future work nomenclature abbreviations cfd computational fluid dynamics cog centre of gravity gmt correction to the transverse metacentric height due to free surface effects gpr gaussian process regression ittc international towing tank conference osv offshore supply vessel pdf probability density function pm pierson moskowitz spectrum pmf probability mass function rao response amplitude operator rbf radial basis function snr signal to noise ratio ssr sensor screening ratio wn white noise xcg longitudinal coordinate of vessel centre of gravity vectors and matrices μ the conditional mean for the prediction space with the given observations k the updated kernel for the prediction space with the given observations ϵ the noise of the observations y μ the prior mean for the prediction space μ y the prior mean for the input space k the prior covariance for the prediction space k y the kernel for the input space with noise k y the kernel between input and prediction spaces k y the kernel for the input space y the prediction space for the function y f x at x x w j the weight matrix likelihood function based on the received measurements x j t y the observations related to the input space y other symbols α j sensor screening ratio ssr for the measured quantity j β 44 ratio between the additional roll damping and the critical roll damping β w wave direction w r t vessel coordinate system η 3 η 3 η 3 heave displacement velocity acceleration ω wave frequency ω p wave spectral peak frequency ϕ a roll amplitude φ m the uncertain vessel parameter to be tuned m 1 2 m ϕ i m the i m th discrete value of the vessel parameter φ m in the rao database ϕ k m the k m th discrete value of the vessel parameter φ m in the discrete joint probability distribution σ y i 2 the variance of the observation y i σ n 2 variance of noise σ x 2 variance of response σ f 2 signal variance σ σ r j the standard deviation of σ r j over r 1 2 l d o t s r σ r j the predicted standard deviation by using r a o r j σ ˆ j the standard deviation of the filtered signal x ˆ j t b 44 roll damping b b k the damping component of b 44 due to bilge keels b e the damping component of b 44 due to eddy making b f friction damping component of b 44 b l linear lift damping component of b 44 b w wave damping component of b 44 f l p lowpass filter cutoff frequency hz h r j ω β w linear transfer function between wave and vessel heave response for the measured quantity j based on the combination r for the uncertain vessel parameters i e r a o r j h s significant wave height i m the number of discrete values used for rao database for the vessel parameter φ m i m the i m th value of the variable φ m in the rao database j the total number of the measured quantities j the index of the measured quantities representing different motions and their derivatives i e displacement velocity acceleration at various locations k m the number of discrete values used for the probability distribution model for the vessel parameter φ m k m the k m th value of the discretized variable φ m in the probability distribution model l length scale m the number of considered variables for tuning n ω the number of discretized frequencies n t the number of discretized time steps n p r o b the total number of the discrete points for the joint probability distribution n p r o b m 1 m k m p power parameter r the total number of possible vessel parameter combinations to build the rao database r m 1 m i m r a o r j the rao based on the variable combination r for the measured quantity j i e h r j ω β w s ζ ζ ω β w single sided power spectral density of long crested waves s x x ω single sided power spectral density of vessel response x s s n the index of the occurring sea state i e the sea state number t p spectral peak period u vessel forward speed w r j weight factor for the r th variable combination based on measurement of quantity j x j t the original signal for the measured quantity j at time step t x j the mean of the filtered time series x ˆ j t x ˆ j t the filtered time series of x j t credit authorship contribution statement xu han conceptualization methodology software formal analysis data curation writing original draft writing review editing svein sævik writing review editing supervision project administration bernt johan leira writing review editing supervision project administration funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was made possible through the centre for research based innovation move financially supported by the research council of norway nfr project no 237929 and the consortium partners http www ntnu edu move special thanks are given to section of hydrodynamics stability in dnv for providing the numerical seakeeping models appendix the simulated sea states and tuning of β 44 the parameters summarized in the tables are described as follows s s n sea state number index h s m significant wave height β w wave direction t p s wave spectral peak period β 44 the true value of β 44 according to table 3 β 44 the gpr model predicted β 44 before tuning for sea state s s n σ β 44 2 the gpr model predicted variance of β 44 before tuning for sea state s s n β ˆ 44 the tuned β 44 for sea state s s n σ ˆ β 44 2 the variance of β 44 after tuning for sea state s s n 
20648,the thermocline which is common in the ocean has an important influence on marine fisheries underwater communication and submarine activities this study proposes a method for detecting and tracking a thermocline using an autonomous underwater vehicle auv which follows the s e n s e p l a n a c t control methodology the adaptive control of the vehicle ensures that the auv can cover the target thermocline as it evolves over time and space additionally this method achieves coverage observation of a highly dynamic water column containing multiple thermoclines through the online evaluation of the vertical thermocline distribution computer simulations are conducted to illustrate the advantages of this algorithm in the field tests an auv is deployed in the south china sea under the guidance of the satellite remote sensing data and the algorithm is run in real time to track the thermoclines with different structures in various environments at the same time a series of ship based conductivity temperature and depth ctd stations are built along the predetermined trajectory of the auv as the cross validation of this method the simulation and field test results demonstrate that the method is effective practical and can better perceive variations of a thermocline keywords thermocline autonomous underwater vehicle adaptive sampling underwater feature tracking 1 introduction in the ocean a thermocline refers to an area where the temperature changes rapidly in the vertical direction hummels 2018 which directly affects the growth rate of primary productivity sharples 1999 and the propagation of sound waves siderius et al 2007 thermoclines have an important influence on marine fisheries underwater communication and submarine activities classical sampling methods based on ships buoys and mooring stations provide important ways for people to understand the ocean but they cannot obtain high resolution data to reveal the fine structure of the ocean process y huang et al 2020 therefore autonomous underwater vehicles auvs with active motion control ability are widely used in the ocean unmanned observation network to achieve fine and low cost measurement of water parameters and have achieved fruitful results branch et al 2019 trygve o fossum et al 2019 zhang et al 2019 at the same time remote sensing technology and marine numerical models provide summary information of the ocean which can determine where to deploy and operate ocean assets to improve survey efficiency trygve fossum et al 2019 smith et al 2010 underwater platforms are utilized in oceanographic surveys to detect the thermocline and track its spatiotemporal variations clabon clabon 2003 developed a method for tracking the thermocline using an upgraded version of the ocean explorer auv this method divides the entire task into three stages determination of the target depth of the thermocline sampling and reciprocating tracking of the thermocline in order to study the internal tidal waves in monterey bay california cazenave et al 2011 proposed a tracking strategy with an isotherm as the target the vehicle was first deployed to perform a short term mission to measure the vertical temperature distribution and a narrow temperature envelope was set up around the thermocline then the vehicle was ordered to run within the temperature envelope to closely track the thermocline woithe and kremer woithe and kremer 2009 of rutgers university proposed a fixed threshold thermocline tracking method to verify the new programming architecture embedded in the slocum glider the simulation results showed that the glider could complete the tracking task well even in a thermocline region with obvious changes cruz and matos 2010 proposed a thermocline adaptive tracking method based on the maximum temperature gradient which was verified by a small mares auv in the douro river this method simplified the vertical distribution of the thermocline and divided it into three layers the upper mixed layer affected by atmosphere and sunlight thermocline layer with a large temperature gradient and relatively static deep water layer the tracking mission was decomposed into a group of state machines with four states and the auv determined whether to trigger another state by comparing the temperature gradient and threshold in contrast to the previous method the threshold could be adjusted online by the peak gradient of the previous profile and a set of correlation coefficients however the problem is that the selection of the coefficients is difficult in highly dynamic regions petillo et al 2010 proposed the concept of autonomous adaptive environmental assessment for the adaptive sampling of ocean features and an average gradient method was proposed to address the problem of thermocline tracking this method uses the mean value of the temperature gradient in the vertical profile as the threshold to detect the thermocline and instructs the auv to perform high resolution sampling within the specified depth range this method has been tested online in both freshwater and saltwater environments and it is suitable for various types of auvs due to its simple configuration zhang et al 2012 proposed a peak gradient based method to track the thermocline and used an adjustable extension parameter d e p e x t e n s i o n to determine the working range of the auv based on the depth of the peak gradient although the depth of the peak temperature gradient varies with different temperature profiles the range of auv undulation around the peak gradient in the vertical direction is fixed therefore in a water column with a strong thermocline the close tracking of the target can be achieved by setting d e p e x t e n s i o n to a small value this method was successfully applied to the tethys auv in monterey bay sun et al 2016 proposed an adaptive threshold method which is a back inference method based on the number of peak points used to set the depth bin size the variance of temperature gradient within the thermocline was used to modify the fixed threshold to enhance the environmental adaptability of the algorithm earlier works on this topic were mainly applied to tracking thermoclines with simple structures papers cruz and matos 2010 petillo et al 2010 and sun et al 2016 improved the level of autonomy by adaptive threshold selection zhang s method zhang et al 2012 regarded the peak gradient as the target which is especially suitable for tracking a strong thermocline with a high horizontal resolution but it is easy to lose the global view they did not focus on the actual tracking effect of the thermocline or feed the tracking results back to the controller to create closed loop tracking of the thermocline in real applications the distribution of the thermocline in the ocean is complicated because of the influence of seasons latitudes or ocean processes gnanadesikan and hallberg 2003 for example in the water column of the vortex multiple thermoclines may coexist in the vertical direction in addition the thickness of the thermocline in the horizontal direction is uneven which creates great challenges to the adaptive detection and tracking of the thermocline considering the above challenges we propose an adaptive coverage tracking method using an auv based on a fixed temperature gradient threshold to achieve the detection and tracking of thermoclines in complex environments the threshold used to detect a thermocline is determined by the actual demands to achieve targeted sampling of interesting regions this method combines prior information and measurements during the mission to reassess the distribution of the thermocline an adaptive controller with a closed loop structure enables the vehicle to perceive whether its sampling range covers the target thermocline which prevents the auv from losing the target or falling into a local view during the missions the feasibility of the algorithm was verified through computer simulation and field experiments the remainder of this paper is organized as follows in section 2 we describe the thermocline tracking algorithm in detail in section 3 we validate the algorithm in a virtual simulation environment in section 4 we introduce field tests and discuss the results in section 5 we discuss the conclusions and future work 2 method for thermocline tracking 2 1 available work the existing adaptive thermocline tracking methods are based on the average temperature gradient petillo et al 2010 and the peak temperature gradient cruz and matos 2010 zhang et al 2012 here methods petillo et al 2010 and zhang et al 2012 will be introduced in detail because these two methods are simple in operation and more representative in addition the feasibility of these two methods has been verified by extensive field experiments 2 1 1 the method based on average gradient the thermocline tracking method based on average gradient petillo et al 2010 provides a new perspective for the tracking of dynamic hydrological features the flow of the algorithm is described below at the beginning the auv is ordered to execute a full depth yo yo trajectory profile and the temperature gradients of adjacent bins are calculated in real time the core idea of the method is to calculate the average temperature gradient of the first full depth profile and using it as the threshold of the tracking algorithm the depth bin whose temperature gradient is greater than this threshold is considered to be in the thermocline and the upper and lower boundaries of the thermocline are determined accordingly in the subsequent tracking task the auv will reciprocate within this pair of determined boundaries to collect data considering that the hydrological features will change significantly over time the auv will perform the full depth profile again to re evaluate the threshold of the thermocline in the current water column after a fixed amount of time t r where t r is no longer than half the length of the hydrological feature time scale and follows the nyquist sampling theorem 2 1 2 the method based on peak gradient the key to the method based on peak gradient proposed by zhang et al 2012 is detection and close tracking of the peak temperature gradient in this method the auv will detect the maximum temperature gradient during each descent or ascent phase and use the corresponding depth d e p t e m p g r a d m a x as the depth of the thermocline the extended depth d e p e x t e n s i o n is defined to ensure that the auv crosses the thermocline with some extra depth range similarly the auv will be ordered to perform a full depth yo yo profile to find the true peak temperature gradient in the water column assuming that the auv is in the descent phase the depth d e p t e m p g r a d m a x at which the maximum temperature gradient is calibrated after reaching the bottom and the target depth of the upcoming ascent phase of the auv is set to d e p t arg et d e p t e m p g r a d m a x d e p e x t e n s i o n the auv repeats the above descent and ascent behaviors to achieve close tracking of the thermocline in order to prevent the auv from losing the global view the author proposes to use the measured temperature range δ t t max t min to improve the existing method where t max and t min are respectively the maximum and minimum temperature on this profile δ t is smaller than the previous profiles indicates that the auv has fallen into local fluctuations and the peak gradient obtained in this profile was local rather than global maxima then the parameter d e p e x t e n s i o n should be increased to capture the true peak gradient the improved method has not been verified online 2 2 adaptive coverage sampling it can be seen from the above introduction that these two behavior based thermocline tracking methods have a s e n s e a c t control structure where sensory information couples directly to action selection as shown in fig 1 a the classic s e n s e a c t architecture only reacts to its surrounding environment such as temperature gradient and ignores the global state or future behavior therefore in view of the limitations of the above methods this paper will propose a deliberate method to adaptive coverage sampling of the thermocline the adaptive coverage sampling method follows the s e n s e p l a n a c t control methodology and the structure is shown in fig 1 b the algorithm procedure requires four basic segments prior information acquisition sensing planning and execution the essential part to note here is the planning stage in which the thermocline will be re evaluated based on the information obtained in the sensing stage then precise data collection strategies will be formulated by fusing prior information and problem constraints the descriptions of each step are outlined in the following sections 2 3 pilot survey the aim of combining the adaptive sampling process with prior information is to guide the deployment of the auv and make better subsequent decisions to refine the thermocline tracking strategies when prior information about the target region to be observed is unavailable an auv is deployed to perform a full depth yo yo profile and send data back to the shore station kemna et al 2018 referred to this as a pilot survey subsequently a series of parameters for thermocline tracking tasks will be set based on the returned data these parameters are as follows d e p m a x the maximum working depth of the auv during the mission the setting of this parameter prevents the auv from diving beyond the depth limit d e p m i n the minimum working depth of the auv during the mission generally this parameter is set to be greater than 0 the purpose is to prevent interference from the upper mixed layer and avoid the influence of water surface tension to save time s i z e b i n the bin size used for calculating the temperature gradient during the motion of the auv the temperature of a single measurement is not representative so the average value measured within a certain range is selected as the temperature of the bin the selection of this parameter is expressed as 1 s i z e b i n 1 f c t d k v s i n θ where f c t d is the sampling frequency of the ctd sensor k is the number of measurement points in each bin v is the velocity of the vehicle and θ is the pitch angle of the auv this parameter is important as it acts as a low pass filter and may affect the detection effect as shown in the following equations 2 t e m p n s i z e b i n f c t d v s i n θ t e m p r a w 3 t e m p g r a d n δ t e m p s i z e b i n b i n n b i n n 1 t e m p n t e m p n 1 d e p t h n d e p t h n 1 where n is the index of the depth bin t e m p r a w is the raw temperature value and t e m p n and d e p t h n are the average temperature and average depth in the n t h bin respectively t e m p g r a d n is the temperature gradient between two adjacent bins if s i z e b i n is too small only a few data points fall into the bin which will cause a large estimation error if s i z e b i n is too large the temperature will be smoothed and the fine scale variation of the temperature cannot be effectively detected g r a d t h r e s h o l d the threshold of the temperature gradient is used for thermocline detection to avoid false detection due to measurement noise or isolated water patches in the water column the algorithm only considers the thermocline is detected when the t e m p g r a d n is greater than g r a d t h r e s h o l d more than n consecutive times where n is used for data filtering the current thermocline judgment standard follows the standard of marine survey where the gradient thresholds for shallow less than 200 m and deep over 200 m water are 0 2 and 0 05 c m respectively hao et al 2012 in practical applications this parameter is determined according to mission requirements and is strictly affected by s i z e b i n c o e e x t e n s i o n the purpose of this parameter is to enable the auv to capture the true thermocline boundaries this parameter is defined to be proportional to the vertical temperature gradient variability index vtgvi represented as 4 c o e e x t e n s i o n μ v t g v i 5 v t g v i 1 m 1 n 2 m t e m p g r a d n t e m p g r a d n 1 where μ is the scale factor which is set to 200 based on the analysis of historical data v t g v i is used as a metric to indicate the level of variability in the present water column m is the total number of bins and t e m p g r a d n t e m p g r a d n 1 is the absolute difference between two adjacent bins v t g v i is larger in a water column with complex and dynamic vertical distribution so a larger c o e e x t e n s i o n is used to ensure coverage observation and vice versa 2 4 perception of the thermocline in the sensing stage a vertical yo yo trajectory is adopted to sense the environment and the t e m p g r a d n calculated with eq 3 is used as a common observation method to detect the boundary of the thermocline we define the state matrix a a 1 a 2 a 3 a 4 t to record the detection results in the descent and ascent phases each element in a is a boolean value where a 1 and a 2 indicate whether the auv has detected and penetrated the thermocline during the descent phase respectively similarly a 3 and a 4 indicate whether the auv has detected and penetrated the thermocline during the ascent phase respectively the boundary matrix b t b 1 b 2 b 3 b 4 t is used to record the corresponding depth of the detected boundaries where b 1 and b 2 are the upper and lower boundaries in descent respectively and b 3 and b 4 are the upper and lower boundaries in ascent respectively at the start of the mission the auv dives from the surface to a depth of d e p m a x assuming that the auv is in the descent phase the upper boundary of the thermocline will be detected while t e m p g r a d n is greater than g r a d t h r e s h o l d more than n consecutive times the auv will record the corresponding depth b 1 and set the state variable a 1 to be true in the subsequent descent if t e m p g r a d n is less than g r a d t h r e s h o l d for n consecutive times the lower boundary b 2 will be recorded this means that the auv has passed through a complete thermocline and the state variable a 2 is set to be true the sensing stage in the ascent is similar to the descent and the details are shown in algorithm 1 algorithm 1 sensing the thermocline information in each yo yo profile image 1 2 5 predicting target depth for next profile whenever the auv completes a yo yo trajectory and rises to the target depth the planning stage is imminent this stage is crucial but filled with challenges as the output of this stage directly affects the tracking performance of the subsequent mission the coverage observation problem of the target thermocline can be simplified as the tracking problem of the time varying boundary after the upper and lower boundaries of the thermocline are clear here the state matrix a and position matrix b t are used to re evaluate the upper and lower boundaries of the thermocline in the current region represented by b t h e r m u b t h e r m l the matrix b a u v u r b a u v l r is defined to represent the working range of the auv in the upcoming profile and b a u v u r 1 b a u v l r 1 is the range of the last profile the evaluation results of the thermocline during the descent and ascent phases can be divided into the following situations 1 if the auv detects complete thermoclines during both the descent and ascent phases a 1 a 2 a 3 a 4 t r u e this indicates that the working range of the auv covers the thermocline therefore the boundaries in the matrix b t recorded in algorithm 1 can be directly used to reflect the position of the thermocline algorithm 2 updating the data collection strategy image 2 2 the thermocline is not detected during the descent and ascent phases a 1 a 2 a 3 a 4 f a l s e in this case there is no thermocline within the current observation range of the auv the virtual thermocline boundaries will be modified to d e p m a x and d e p m i n and the variable c n t r e d e t e c t is accumulated as seen in algorithm 2 this will guide the auv to redetect within a large depth to assess whether the area contains a qualified thermocline 3 there is no thermocline detected in one of the descent and ascent phases a 1 f a l s e or a 3 f a l s e this means that the water column is vertically mixed so the thermocline diminishes in order to prevent the auv from falling into local oscillation the boundaries are modified to be the same as the last profile 4 the complete thermocline is not detected during the descent a 1 t r u e and a 2 f a l s e which means that the auv cannot cover the thermocline completely therefore the downward distance is extended based on the actual working depth of the auv as the virtual lower boundary with the constraint that the extended depth does not exceed the maximum depth d e p m a x as shown in eq 6 5 the complete thermocline is not detected during the ascent a 3 t r u e and a 4 f a l s e similar to 4 we extend the distance upward based on the actual working depth of the auv as the virtual upper boundary with the constraint that the extended depth is not less than the minimum depth d e p m i n as shown in eq 7 the status flag t e r m i n a t e t r a c k will be set to true after a thermocline is undetected by the auv for q consecutive times which means terminating the thermocline tracking q is determined by mission requirements otherwise the auv will further update the boundaries of the thermocline with eqs 8 and 9 in order to improve the robustness of the algorithm we extend the distance outward based on b t h e r m u b t h e r m l to ensure that the auv completely covers the thermocline in the upcoming profile the depth limits of the auv for the next profile are shown in eqs 10 and 11 3 simulation to verify the effectiveness and robustness of the proposed schemes the tracking problem of the thermocline is simulated in matlab r2015a 3 1 thermocline simulation environment to simulate the thermoclines in the ocean a 2 d grid space 100 3600 m with 1 m spacing was generated with a set of overlying 2 d gaussians a data value amplitude of 0 3 was used as a proxy for high temperature gradient c m values the simulation environment contained two types of thermoclines as shown in fig 2 the single thermocline on the left side changes with space and is used to illustrate the performance of the algorithm in an irregular environment the right side contains two thermoclines in the vertical direction to test the algorithm s ability to track multi thermocline there is a gap with weak thermocline strength in the middle to verify the response of the auv after losing the target 3 2 simulation results this section presents the results of the proposed method running in the simulation environment described in section 3 1 in order to form a comparison we also simulated the methods based on the average gradient petillo et al 2010 and peak gradient zhang et al 2012 introduced in section 2 1 the parameters required by each method are listed in table 1 the basic parameters such as the auv speed working limit and pitch angle remain unified we assume that the auv performs tasks strictly in accordance with the set parameters and the ctd sensor is ideal without noise in addition the virtual thermocline established in the simulation environment is smooth without isolated water patches so a satisfactory detection can be achieved by setting n to 1 performance assessment is based on three factors the thermocline coverage ratio tcr mean sampling value msv and multi thermocline coverage mtc the first two indicators are proposed for a single thermocline tracking performance horizontal distance 0 2400 m in fig 2 the third indicator is binary which is used to indicate whether the algorithm can detect and cover a multi thermocline the tcr is defined as 12 t c r 1 a w r t t r t t r with t c r 0 1 where a w r is the auv working range and t t r is the true thermocline range fig 3 shows the sampling trajectories of the auv under the guidance of the three methods a performance comparison is provided in table 2 which shows that the method proposed in this paper generates a trajectory with the most coverage ratio and has the ability to cover a multi thermocline while the method based on peak gradient follows the peak well with the maximum msv it puts too much focus on hot spots leading it to neglect global knowledge about the water column by appropriately sacrificing msv the proposed method is able to acquire more information it can be seen from table 2 although the msv of the proposed method is slightly inferior to that of the peak gradient method it guarantees a high msv at maximum tcr and mtc although the method based on average gradient is not prominent enough the method is simple and requires the fewest task parameters to be configured it should be pointed out that the proposed method can adaptively guide the auv to contract and expand the motion boundary to the true thermocline the single thermocline tracking process in fig 3 a proves this behavior to prevent the auv from falling into local oscillation during the tracking mission the peak gradient method judged whether the auv needed to restart the full depth yo yo profile by comparing the maximum temperature difference between the present and previous profiles as shown in fig 3 b the average gradient method restarts the full depth yo yo profile after the auv moves underwater for a certain time t r as shown in fig 3 c 4 field tests in september 2020 the sea whale auv conducted three thermocline tracking missions in xisha using the algorithm proposed in this paper on september 4 we chose a typical thermocline with a sharp vertical temperature variation located at the blue dot in fig 4 to verify the basic performance of the proposed method task1 then on september 13 combined with satellite remote sensing data we deployed the auv to illustrate the tracking performance of a multi thermocline in a warm vortex located at the green dot in fig 4 task2 and task3 at the same time a series of ship based ctd stations were built along the predetermined trajectory of the auv as the cross validation of this method 4 1 experiment site xisha is located in the eastern part of hainan island in the northern part of the south china sea it is rich in mesoscale and sub mesoscale ocean phenomena yang et al 2016 and plays an important role in oceanic stratification mixing and horizontal transportation that can affect ocean heat biogeochemistry and fisheries mcgillicuddy et al 2007 the topography of the seabed around the xisha islands is complex making it a key area for ocean kinetic energy dissipation therefore this area is of great significance and has attracted the attention of scientists 4 2 vehicle characteristics the sea whale auv as shown in fig 5 is a new type of long range underwater vehicle developed by shenyang institute of automation chinese academy of sciences and is mainly used for ocean observation its maximum working depth is 1000 m and endurance is 2000 km with a speed of 0 7 m s the sea whale auv can work underwater for several weeks in three different modes the auv mode with strong maneuverability underwater glider mode with zigzag motion and lagrange drifting like a buoy with the current huang et al 2019 the thermocline tracking algorithm is written in c and runs on the auv s computing unit in real time during the test the auv moved at a constant speed of 0 7 m s with a 10 pitch angle the ctd sensor had a 0 5 hz sampling frequency according to eq 1 we set the parameter s i z e b i n as 3 m to ensure there were approximately 11 ctd measurements in each bin 4 3 single thermocline tracking mission on september 4 2020 we carried out a pilot survey at a depth of 350 m the variation of temperature gradient of the experiment site shows that the temperature changed sharply in the range of 20 80 m and the v t g v i was 0 0227 as shown in fig 6 the parameter g r a d t h r e s h o l d was set to 0 1 c m and n was set to 2 to avoid false detection and the maximum and minimum working depth limits were 200 and 10 m respectively the depth expansion coefficient c o e e x t e n s i o n was set to 4 according to eq 4 task1 consisted of 3 yo yo profiles which took approximately 7000 s in total and the horizontal distance was approximately 3700 m fig 7 a shows the curves of the temperature gradient measured during the descent and ascent in the first profile fig 7 b shows a scatter plot of the temperature gradient during the entire task the pale yellow background area is the thermocline that meets the threshold and the light gray background area is the auv motion range the upper and lower triangles indicate the top and bottom boundaries of the thermocline respectively and the black dashed line is the working depth limit of the auv using the first yo yo profile as an example for algorithm 1 the depths corresponding to the upper and lower boundaries of the thermocline detected by the auv during the descent were 18 and 75 m respectively however the depths corresponding to the upper and lower boundaries detected during the ascent were 52 and 64 m respectively the auv successfully detected the position and thickness of the thermocline although the range detected during ascent was not comprehensive according to algorithm 2 the target working range of the auv was set to 10 87 m as shown in fig 7 a the thickness of the thermocline detected during the ascent was thinner than that measured in the descent the peak gradient is higher and the corresponding depth is shallower this is due to the temporal and spatial differences in the sampling locations the horizontal distance of the first yo yo profile was approximately 2200 m and took about 4000 s which is more than half the time of the entire task in the last two yo yo profiles the auv working range gradually converged to a smaller space of approximately 8 54 m and completely covered the thermocline this greatly improved the sampling efficiency 4 4 complex thermocline tracking missions on september 4 2020 according to the remote sensing satellite image we found that there was an obvious warm vortex located at the green dot in fig 4 the sea surface height field is shown in fig 8 a we placed the auv at the center of the vortex white dot and ordered it to perform two thermocline tracking tasks westward each task contained four consecutive yo yo profiles the trajectories of these two tasks are shown in fig 8 b and they took approximately 7 h and 45 min the total horizontal distance was approximately 15 4 km meanwhile six ship based ctd stations were constructed at a depth of 300 m along the predetermined trajectory of the auv green square dots to provide verification support according to the pilot survey the vertical temperature distribution in this water column was complex with irregular gradients and the v t g v i was 0 0486 as shown in fig 9 a the temperature changed sharply near 60 and 130 m the g r a d t h r e s h o l d and n were set to 0 1 c m and 2 respectively and the c o e e x t e n s i o n was set to 10 according to eq 4 the trajectories in these two tasks are shown in fig 9 b the auv cannot accurately evaluate the temperature field distribution in the individual descent or ascent phases it can only accurately identify the top thermocline in the descent and bottom thermocline in the ascent taking the first yo yo profile as an example the thermocline identified during the descent is within 45 65 m and 145 157 m during the ascent the working range of the upcoming profile was set to 15 187 m according to algorithm 2 the ctd stations reached deeper 300 m than the maximum depth of the auv the same method was utilized to post process the ship based ctd data the positions of the thermocline obtained by the two methods are listed in table 3 and table 4 which shows that the boundaries of the thermocline identified by the two methods are similar 4 5 discussions based on the performances of the above experiments two issues need to be discussed here first algorithm 2 clearly shows that the c o e e x t e n s i o n used to assist the auv in regaining the global view after falling into local oscillation is an important variable increasing c o e e x t e n s i o n arbitrarily to give the auv a global view is unwise because it reduces the temporal and spatial resolution of the auv sampled data setting c o e e x t e n s i o n too low on the other hand makes it difficult for the auv to find the true target in this article we define the vertical temperature variability index v t g v i for the balance of sampling resolution and target coverage for example the temperature gradient in fig 9 b changes more irregularly in space than in fig 7 b and has a higher v t g v i so a larger c o e e x t e n s i o n is required for coverage sampling in this area according to eq 4 the scale factor μ in eq 4 is chosen empirically and no related studies are available we analyzed the v t g v i in various marine environments using historical data and discovered that when μ is set to 200 the c o e e x t e n s i o n is more conducive to auv to obtain a global view second we combine the thermocline positions detected during the two stages of descent and ascent to assess the current distribution of the thermocline in the water column there are two reasons the real marine environment is complex the distribution of the thermocline in the water column that the auv passes through during the descent and ascent phases varies with time and space so detection results from a single phase are not representative as illustrated in fig 7 a the temperature gradients measured in two phases are different in the first yo yo profile of the task1 moreover the dynamic water column contains a number of discrete patches causing the detection results of a single phase are not global as shown in fig 9 b the water column of the vortex center contains multiple patches in the vertical direction which poses a huge challenge to adaptive coverage sampling therefore combining the information from the two phases to make a decision can reduce the risk of missing the target in the upcoming profile 5 conclusion and future work this work presented a method of using an auv for the adaptive coverage observation of a thermocline with a complex structure this method followed the s e n s e p l a n a c t control methodology the planning stage combined measurements and prior information to re evaluate the thermocline in the current region and further update the data collection strategy a controller with a closed loop structure sensed whether the auv s trajectory covered the target thermocline to prevent it from losing the target and falling into a local view computer simulation results proved that this method can better perceive variations of the thermocline and respond in time compared with the methods proposed in petillo et al 2010 and zhang et al 2012 the field experiments were carried out in xisha south china sea in september 2020 during the experiments we performed tracking work using the method proposed in this paper for two types of thermoclines one with a simple vertical temperature distribution and the other with a complex vertical temperature distribution in the vortex center pilot surveys proved to be an essential pre experimental operation in cases where we did not have a priori information on the target water column we also introduced the metric v t g v i to characterize the complexity of the thermocline and successfully guided the auv to achieve global sensing of the thermocline by adaptively extending the working depth in the experiment on 4 september we demonstrated that this method can sense the contraction of the thermocline in the horizontal direction and the controller with a closed loop structure adjusts the sampling strategy in time according to the sensing results to ensure that the auv s motion range converges to the actual thermocline which improves the sampling efficiency unfortunately we did not check the method of tracking an expanding thermocline but these results were verified and performed successfully in our simulation experiments as shown in fig 3 a we also demonstrated the coverage sampling capability of the method for the complex thermocline on september 13 the auv was deployed in the center of a vortex and instructed to continuously execute 8 yo yo trajectory profiles by comparing the online tracking results with the sampled data from the ship based ctd stations we verified the performance of the method in coverage tracking of multiple thermoclines in highly dynamic waters in future work we intend to use features such as strength thickness and type of thermocline for adaptive selection of the temperature gradient threshold to further reduce human intervention in the task we will also consider using multiple mobile platforms to perform collaborative observations through the sharing of multi point sampling data we adjusted the heading angle of the vehicle to achieve 4 dimensional 3d time adaptive sampling of the target area in the control of a single vehicle we will dynamically adjust the pitch angle and speed of the vehicle in combination with the kinematics model to reduce energy consumption acknowledgments this study was supported by the national key r d program of china no 2017yfc0305801 the state key laboratory of robotics in china no 2015 z09 the national natural science foundation of china no 61821005 and the liaoning provincial natural science foundation no 2020 ms 031 the sea surface height data was downloaded from https resources marine copernicus eu the authors will thank dr xiaofeng qi for operating the ship based ctd station during the experiment which is indispensable for the verification experiment credit authorship contribution statement hao feng investigation algorithm design implementation of simulations and field tests data processing and analysis writing original draft jiancheng yu methodology supervision project administration funding acquisition writing review editingwriting review editing yan huang conceptualization test design implementation of field tests writing review editingwriting review jianan qiao operation and maintenance of auv control system implementation of field tests zhenyu wang operation and maintenance of auv mechanical system data processing zongbo xie operation and maintenance of auv mechanical system implementation of field tests kai liu data processing investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20648,the thermocline which is common in the ocean has an important influence on marine fisheries underwater communication and submarine activities this study proposes a method for detecting and tracking a thermocline using an autonomous underwater vehicle auv which follows the s e n s e p l a n a c t control methodology the adaptive control of the vehicle ensures that the auv can cover the target thermocline as it evolves over time and space additionally this method achieves coverage observation of a highly dynamic water column containing multiple thermoclines through the online evaluation of the vertical thermocline distribution computer simulations are conducted to illustrate the advantages of this algorithm in the field tests an auv is deployed in the south china sea under the guidance of the satellite remote sensing data and the algorithm is run in real time to track the thermoclines with different structures in various environments at the same time a series of ship based conductivity temperature and depth ctd stations are built along the predetermined trajectory of the auv as the cross validation of this method the simulation and field test results demonstrate that the method is effective practical and can better perceive variations of a thermocline keywords thermocline autonomous underwater vehicle adaptive sampling underwater feature tracking 1 introduction in the ocean a thermocline refers to an area where the temperature changes rapidly in the vertical direction hummels 2018 which directly affects the growth rate of primary productivity sharples 1999 and the propagation of sound waves siderius et al 2007 thermoclines have an important influence on marine fisheries underwater communication and submarine activities classical sampling methods based on ships buoys and mooring stations provide important ways for people to understand the ocean but they cannot obtain high resolution data to reveal the fine structure of the ocean process y huang et al 2020 therefore autonomous underwater vehicles auvs with active motion control ability are widely used in the ocean unmanned observation network to achieve fine and low cost measurement of water parameters and have achieved fruitful results branch et al 2019 trygve o fossum et al 2019 zhang et al 2019 at the same time remote sensing technology and marine numerical models provide summary information of the ocean which can determine where to deploy and operate ocean assets to improve survey efficiency trygve fossum et al 2019 smith et al 2010 underwater platforms are utilized in oceanographic surveys to detect the thermocline and track its spatiotemporal variations clabon clabon 2003 developed a method for tracking the thermocline using an upgraded version of the ocean explorer auv this method divides the entire task into three stages determination of the target depth of the thermocline sampling and reciprocating tracking of the thermocline in order to study the internal tidal waves in monterey bay california cazenave et al 2011 proposed a tracking strategy with an isotherm as the target the vehicle was first deployed to perform a short term mission to measure the vertical temperature distribution and a narrow temperature envelope was set up around the thermocline then the vehicle was ordered to run within the temperature envelope to closely track the thermocline woithe and kremer woithe and kremer 2009 of rutgers university proposed a fixed threshold thermocline tracking method to verify the new programming architecture embedded in the slocum glider the simulation results showed that the glider could complete the tracking task well even in a thermocline region with obvious changes cruz and matos 2010 proposed a thermocline adaptive tracking method based on the maximum temperature gradient which was verified by a small mares auv in the douro river this method simplified the vertical distribution of the thermocline and divided it into three layers the upper mixed layer affected by atmosphere and sunlight thermocline layer with a large temperature gradient and relatively static deep water layer the tracking mission was decomposed into a group of state machines with four states and the auv determined whether to trigger another state by comparing the temperature gradient and threshold in contrast to the previous method the threshold could be adjusted online by the peak gradient of the previous profile and a set of correlation coefficients however the problem is that the selection of the coefficients is difficult in highly dynamic regions petillo et al 2010 proposed the concept of autonomous adaptive environmental assessment for the adaptive sampling of ocean features and an average gradient method was proposed to address the problem of thermocline tracking this method uses the mean value of the temperature gradient in the vertical profile as the threshold to detect the thermocline and instructs the auv to perform high resolution sampling within the specified depth range this method has been tested online in both freshwater and saltwater environments and it is suitable for various types of auvs due to its simple configuration zhang et al 2012 proposed a peak gradient based method to track the thermocline and used an adjustable extension parameter d e p e x t e n s i o n to determine the working range of the auv based on the depth of the peak gradient although the depth of the peak temperature gradient varies with different temperature profiles the range of auv undulation around the peak gradient in the vertical direction is fixed therefore in a water column with a strong thermocline the close tracking of the target can be achieved by setting d e p e x t e n s i o n to a small value this method was successfully applied to the tethys auv in monterey bay sun et al 2016 proposed an adaptive threshold method which is a back inference method based on the number of peak points used to set the depth bin size the variance of temperature gradient within the thermocline was used to modify the fixed threshold to enhance the environmental adaptability of the algorithm earlier works on this topic were mainly applied to tracking thermoclines with simple structures papers cruz and matos 2010 petillo et al 2010 and sun et al 2016 improved the level of autonomy by adaptive threshold selection zhang s method zhang et al 2012 regarded the peak gradient as the target which is especially suitable for tracking a strong thermocline with a high horizontal resolution but it is easy to lose the global view they did not focus on the actual tracking effect of the thermocline or feed the tracking results back to the controller to create closed loop tracking of the thermocline in real applications the distribution of the thermocline in the ocean is complicated because of the influence of seasons latitudes or ocean processes gnanadesikan and hallberg 2003 for example in the water column of the vortex multiple thermoclines may coexist in the vertical direction in addition the thickness of the thermocline in the horizontal direction is uneven which creates great challenges to the adaptive detection and tracking of the thermocline considering the above challenges we propose an adaptive coverage tracking method using an auv based on a fixed temperature gradient threshold to achieve the detection and tracking of thermoclines in complex environments the threshold used to detect a thermocline is determined by the actual demands to achieve targeted sampling of interesting regions this method combines prior information and measurements during the mission to reassess the distribution of the thermocline an adaptive controller with a closed loop structure enables the vehicle to perceive whether its sampling range covers the target thermocline which prevents the auv from losing the target or falling into a local view during the missions the feasibility of the algorithm was verified through computer simulation and field experiments the remainder of this paper is organized as follows in section 2 we describe the thermocline tracking algorithm in detail in section 3 we validate the algorithm in a virtual simulation environment in section 4 we introduce field tests and discuss the results in section 5 we discuss the conclusions and future work 2 method for thermocline tracking 2 1 available work the existing adaptive thermocline tracking methods are based on the average temperature gradient petillo et al 2010 and the peak temperature gradient cruz and matos 2010 zhang et al 2012 here methods petillo et al 2010 and zhang et al 2012 will be introduced in detail because these two methods are simple in operation and more representative in addition the feasibility of these two methods has been verified by extensive field experiments 2 1 1 the method based on average gradient the thermocline tracking method based on average gradient petillo et al 2010 provides a new perspective for the tracking of dynamic hydrological features the flow of the algorithm is described below at the beginning the auv is ordered to execute a full depth yo yo trajectory profile and the temperature gradients of adjacent bins are calculated in real time the core idea of the method is to calculate the average temperature gradient of the first full depth profile and using it as the threshold of the tracking algorithm the depth bin whose temperature gradient is greater than this threshold is considered to be in the thermocline and the upper and lower boundaries of the thermocline are determined accordingly in the subsequent tracking task the auv will reciprocate within this pair of determined boundaries to collect data considering that the hydrological features will change significantly over time the auv will perform the full depth profile again to re evaluate the threshold of the thermocline in the current water column after a fixed amount of time t r where t r is no longer than half the length of the hydrological feature time scale and follows the nyquist sampling theorem 2 1 2 the method based on peak gradient the key to the method based on peak gradient proposed by zhang et al 2012 is detection and close tracking of the peak temperature gradient in this method the auv will detect the maximum temperature gradient during each descent or ascent phase and use the corresponding depth d e p t e m p g r a d m a x as the depth of the thermocline the extended depth d e p e x t e n s i o n is defined to ensure that the auv crosses the thermocline with some extra depth range similarly the auv will be ordered to perform a full depth yo yo profile to find the true peak temperature gradient in the water column assuming that the auv is in the descent phase the depth d e p t e m p g r a d m a x at which the maximum temperature gradient is calibrated after reaching the bottom and the target depth of the upcoming ascent phase of the auv is set to d e p t arg et d e p t e m p g r a d m a x d e p e x t e n s i o n the auv repeats the above descent and ascent behaviors to achieve close tracking of the thermocline in order to prevent the auv from losing the global view the author proposes to use the measured temperature range δ t t max t min to improve the existing method where t max and t min are respectively the maximum and minimum temperature on this profile δ t is smaller than the previous profiles indicates that the auv has fallen into local fluctuations and the peak gradient obtained in this profile was local rather than global maxima then the parameter d e p e x t e n s i o n should be increased to capture the true peak gradient the improved method has not been verified online 2 2 adaptive coverage sampling it can be seen from the above introduction that these two behavior based thermocline tracking methods have a s e n s e a c t control structure where sensory information couples directly to action selection as shown in fig 1 a the classic s e n s e a c t architecture only reacts to its surrounding environment such as temperature gradient and ignores the global state or future behavior therefore in view of the limitations of the above methods this paper will propose a deliberate method to adaptive coverage sampling of the thermocline the adaptive coverage sampling method follows the s e n s e p l a n a c t control methodology and the structure is shown in fig 1 b the algorithm procedure requires four basic segments prior information acquisition sensing planning and execution the essential part to note here is the planning stage in which the thermocline will be re evaluated based on the information obtained in the sensing stage then precise data collection strategies will be formulated by fusing prior information and problem constraints the descriptions of each step are outlined in the following sections 2 3 pilot survey the aim of combining the adaptive sampling process with prior information is to guide the deployment of the auv and make better subsequent decisions to refine the thermocline tracking strategies when prior information about the target region to be observed is unavailable an auv is deployed to perform a full depth yo yo profile and send data back to the shore station kemna et al 2018 referred to this as a pilot survey subsequently a series of parameters for thermocline tracking tasks will be set based on the returned data these parameters are as follows d e p m a x the maximum working depth of the auv during the mission the setting of this parameter prevents the auv from diving beyond the depth limit d e p m i n the minimum working depth of the auv during the mission generally this parameter is set to be greater than 0 the purpose is to prevent interference from the upper mixed layer and avoid the influence of water surface tension to save time s i z e b i n the bin size used for calculating the temperature gradient during the motion of the auv the temperature of a single measurement is not representative so the average value measured within a certain range is selected as the temperature of the bin the selection of this parameter is expressed as 1 s i z e b i n 1 f c t d k v s i n θ where f c t d is the sampling frequency of the ctd sensor k is the number of measurement points in each bin v is the velocity of the vehicle and θ is the pitch angle of the auv this parameter is important as it acts as a low pass filter and may affect the detection effect as shown in the following equations 2 t e m p n s i z e b i n f c t d v s i n θ t e m p r a w 3 t e m p g r a d n δ t e m p s i z e b i n b i n n b i n n 1 t e m p n t e m p n 1 d e p t h n d e p t h n 1 where n is the index of the depth bin t e m p r a w is the raw temperature value and t e m p n and d e p t h n are the average temperature and average depth in the n t h bin respectively t e m p g r a d n is the temperature gradient between two adjacent bins if s i z e b i n is too small only a few data points fall into the bin which will cause a large estimation error if s i z e b i n is too large the temperature will be smoothed and the fine scale variation of the temperature cannot be effectively detected g r a d t h r e s h o l d the threshold of the temperature gradient is used for thermocline detection to avoid false detection due to measurement noise or isolated water patches in the water column the algorithm only considers the thermocline is detected when the t e m p g r a d n is greater than g r a d t h r e s h o l d more than n consecutive times where n is used for data filtering the current thermocline judgment standard follows the standard of marine survey where the gradient thresholds for shallow less than 200 m and deep over 200 m water are 0 2 and 0 05 c m respectively hao et al 2012 in practical applications this parameter is determined according to mission requirements and is strictly affected by s i z e b i n c o e e x t e n s i o n the purpose of this parameter is to enable the auv to capture the true thermocline boundaries this parameter is defined to be proportional to the vertical temperature gradient variability index vtgvi represented as 4 c o e e x t e n s i o n μ v t g v i 5 v t g v i 1 m 1 n 2 m t e m p g r a d n t e m p g r a d n 1 where μ is the scale factor which is set to 200 based on the analysis of historical data v t g v i is used as a metric to indicate the level of variability in the present water column m is the total number of bins and t e m p g r a d n t e m p g r a d n 1 is the absolute difference between two adjacent bins v t g v i is larger in a water column with complex and dynamic vertical distribution so a larger c o e e x t e n s i o n is used to ensure coverage observation and vice versa 2 4 perception of the thermocline in the sensing stage a vertical yo yo trajectory is adopted to sense the environment and the t e m p g r a d n calculated with eq 3 is used as a common observation method to detect the boundary of the thermocline we define the state matrix a a 1 a 2 a 3 a 4 t to record the detection results in the descent and ascent phases each element in a is a boolean value where a 1 and a 2 indicate whether the auv has detected and penetrated the thermocline during the descent phase respectively similarly a 3 and a 4 indicate whether the auv has detected and penetrated the thermocline during the ascent phase respectively the boundary matrix b t b 1 b 2 b 3 b 4 t is used to record the corresponding depth of the detected boundaries where b 1 and b 2 are the upper and lower boundaries in descent respectively and b 3 and b 4 are the upper and lower boundaries in ascent respectively at the start of the mission the auv dives from the surface to a depth of d e p m a x assuming that the auv is in the descent phase the upper boundary of the thermocline will be detected while t e m p g r a d n is greater than g r a d t h r e s h o l d more than n consecutive times the auv will record the corresponding depth b 1 and set the state variable a 1 to be true in the subsequent descent if t e m p g r a d n is less than g r a d t h r e s h o l d for n consecutive times the lower boundary b 2 will be recorded this means that the auv has passed through a complete thermocline and the state variable a 2 is set to be true the sensing stage in the ascent is similar to the descent and the details are shown in algorithm 1 algorithm 1 sensing the thermocline information in each yo yo profile image 1 2 5 predicting target depth for next profile whenever the auv completes a yo yo trajectory and rises to the target depth the planning stage is imminent this stage is crucial but filled with challenges as the output of this stage directly affects the tracking performance of the subsequent mission the coverage observation problem of the target thermocline can be simplified as the tracking problem of the time varying boundary after the upper and lower boundaries of the thermocline are clear here the state matrix a and position matrix b t are used to re evaluate the upper and lower boundaries of the thermocline in the current region represented by b t h e r m u b t h e r m l the matrix b a u v u r b a u v l r is defined to represent the working range of the auv in the upcoming profile and b a u v u r 1 b a u v l r 1 is the range of the last profile the evaluation results of the thermocline during the descent and ascent phases can be divided into the following situations 1 if the auv detects complete thermoclines during both the descent and ascent phases a 1 a 2 a 3 a 4 t r u e this indicates that the working range of the auv covers the thermocline therefore the boundaries in the matrix b t recorded in algorithm 1 can be directly used to reflect the position of the thermocline algorithm 2 updating the data collection strategy image 2 2 the thermocline is not detected during the descent and ascent phases a 1 a 2 a 3 a 4 f a l s e in this case there is no thermocline within the current observation range of the auv the virtual thermocline boundaries will be modified to d e p m a x and d e p m i n and the variable c n t r e d e t e c t is accumulated as seen in algorithm 2 this will guide the auv to redetect within a large depth to assess whether the area contains a qualified thermocline 3 there is no thermocline detected in one of the descent and ascent phases a 1 f a l s e or a 3 f a l s e this means that the water column is vertically mixed so the thermocline diminishes in order to prevent the auv from falling into local oscillation the boundaries are modified to be the same as the last profile 4 the complete thermocline is not detected during the descent a 1 t r u e and a 2 f a l s e which means that the auv cannot cover the thermocline completely therefore the downward distance is extended based on the actual working depth of the auv as the virtual lower boundary with the constraint that the extended depth does not exceed the maximum depth d e p m a x as shown in eq 6 5 the complete thermocline is not detected during the ascent a 3 t r u e and a 4 f a l s e similar to 4 we extend the distance upward based on the actual working depth of the auv as the virtual upper boundary with the constraint that the extended depth is not less than the minimum depth d e p m i n as shown in eq 7 the status flag t e r m i n a t e t r a c k will be set to true after a thermocline is undetected by the auv for q consecutive times which means terminating the thermocline tracking q is determined by mission requirements otherwise the auv will further update the boundaries of the thermocline with eqs 8 and 9 in order to improve the robustness of the algorithm we extend the distance outward based on b t h e r m u b t h e r m l to ensure that the auv completely covers the thermocline in the upcoming profile the depth limits of the auv for the next profile are shown in eqs 10 and 11 3 simulation to verify the effectiveness and robustness of the proposed schemes the tracking problem of the thermocline is simulated in matlab r2015a 3 1 thermocline simulation environment to simulate the thermoclines in the ocean a 2 d grid space 100 3600 m with 1 m spacing was generated with a set of overlying 2 d gaussians a data value amplitude of 0 3 was used as a proxy for high temperature gradient c m values the simulation environment contained two types of thermoclines as shown in fig 2 the single thermocline on the left side changes with space and is used to illustrate the performance of the algorithm in an irregular environment the right side contains two thermoclines in the vertical direction to test the algorithm s ability to track multi thermocline there is a gap with weak thermocline strength in the middle to verify the response of the auv after losing the target 3 2 simulation results this section presents the results of the proposed method running in the simulation environment described in section 3 1 in order to form a comparison we also simulated the methods based on the average gradient petillo et al 2010 and peak gradient zhang et al 2012 introduced in section 2 1 the parameters required by each method are listed in table 1 the basic parameters such as the auv speed working limit and pitch angle remain unified we assume that the auv performs tasks strictly in accordance with the set parameters and the ctd sensor is ideal without noise in addition the virtual thermocline established in the simulation environment is smooth without isolated water patches so a satisfactory detection can be achieved by setting n to 1 performance assessment is based on three factors the thermocline coverage ratio tcr mean sampling value msv and multi thermocline coverage mtc the first two indicators are proposed for a single thermocline tracking performance horizontal distance 0 2400 m in fig 2 the third indicator is binary which is used to indicate whether the algorithm can detect and cover a multi thermocline the tcr is defined as 12 t c r 1 a w r t t r t t r with t c r 0 1 where a w r is the auv working range and t t r is the true thermocline range fig 3 shows the sampling trajectories of the auv under the guidance of the three methods a performance comparison is provided in table 2 which shows that the method proposed in this paper generates a trajectory with the most coverage ratio and has the ability to cover a multi thermocline while the method based on peak gradient follows the peak well with the maximum msv it puts too much focus on hot spots leading it to neglect global knowledge about the water column by appropriately sacrificing msv the proposed method is able to acquire more information it can be seen from table 2 although the msv of the proposed method is slightly inferior to that of the peak gradient method it guarantees a high msv at maximum tcr and mtc although the method based on average gradient is not prominent enough the method is simple and requires the fewest task parameters to be configured it should be pointed out that the proposed method can adaptively guide the auv to contract and expand the motion boundary to the true thermocline the single thermocline tracking process in fig 3 a proves this behavior to prevent the auv from falling into local oscillation during the tracking mission the peak gradient method judged whether the auv needed to restart the full depth yo yo profile by comparing the maximum temperature difference between the present and previous profiles as shown in fig 3 b the average gradient method restarts the full depth yo yo profile after the auv moves underwater for a certain time t r as shown in fig 3 c 4 field tests in september 2020 the sea whale auv conducted three thermocline tracking missions in xisha using the algorithm proposed in this paper on september 4 we chose a typical thermocline with a sharp vertical temperature variation located at the blue dot in fig 4 to verify the basic performance of the proposed method task1 then on september 13 combined with satellite remote sensing data we deployed the auv to illustrate the tracking performance of a multi thermocline in a warm vortex located at the green dot in fig 4 task2 and task3 at the same time a series of ship based ctd stations were built along the predetermined trajectory of the auv as the cross validation of this method 4 1 experiment site xisha is located in the eastern part of hainan island in the northern part of the south china sea it is rich in mesoscale and sub mesoscale ocean phenomena yang et al 2016 and plays an important role in oceanic stratification mixing and horizontal transportation that can affect ocean heat biogeochemistry and fisheries mcgillicuddy et al 2007 the topography of the seabed around the xisha islands is complex making it a key area for ocean kinetic energy dissipation therefore this area is of great significance and has attracted the attention of scientists 4 2 vehicle characteristics the sea whale auv as shown in fig 5 is a new type of long range underwater vehicle developed by shenyang institute of automation chinese academy of sciences and is mainly used for ocean observation its maximum working depth is 1000 m and endurance is 2000 km with a speed of 0 7 m s the sea whale auv can work underwater for several weeks in three different modes the auv mode with strong maneuverability underwater glider mode with zigzag motion and lagrange drifting like a buoy with the current huang et al 2019 the thermocline tracking algorithm is written in c and runs on the auv s computing unit in real time during the test the auv moved at a constant speed of 0 7 m s with a 10 pitch angle the ctd sensor had a 0 5 hz sampling frequency according to eq 1 we set the parameter s i z e b i n as 3 m to ensure there were approximately 11 ctd measurements in each bin 4 3 single thermocline tracking mission on september 4 2020 we carried out a pilot survey at a depth of 350 m the variation of temperature gradient of the experiment site shows that the temperature changed sharply in the range of 20 80 m and the v t g v i was 0 0227 as shown in fig 6 the parameter g r a d t h r e s h o l d was set to 0 1 c m and n was set to 2 to avoid false detection and the maximum and minimum working depth limits were 200 and 10 m respectively the depth expansion coefficient c o e e x t e n s i o n was set to 4 according to eq 4 task1 consisted of 3 yo yo profiles which took approximately 7000 s in total and the horizontal distance was approximately 3700 m fig 7 a shows the curves of the temperature gradient measured during the descent and ascent in the first profile fig 7 b shows a scatter plot of the temperature gradient during the entire task the pale yellow background area is the thermocline that meets the threshold and the light gray background area is the auv motion range the upper and lower triangles indicate the top and bottom boundaries of the thermocline respectively and the black dashed line is the working depth limit of the auv using the first yo yo profile as an example for algorithm 1 the depths corresponding to the upper and lower boundaries of the thermocline detected by the auv during the descent were 18 and 75 m respectively however the depths corresponding to the upper and lower boundaries detected during the ascent were 52 and 64 m respectively the auv successfully detected the position and thickness of the thermocline although the range detected during ascent was not comprehensive according to algorithm 2 the target working range of the auv was set to 10 87 m as shown in fig 7 a the thickness of the thermocline detected during the ascent was thinner than that measured in the descent the peak gradient is higher and the corresponding depth is shallower this is due to the temporal and spatial differences in the sampling locations the horizontal distance of the first yo yo profile was approximately 2200 m and took about 4000 s which is more than half the time of the entire task in the last two yo yo profiles the auv working range gradually converged to a smaller space of approximately 8 54 m and completely covered the thermocline this greatly improved the sampling efficiency 4 4 complex thermocline tracking missions on september 4 2020 according to the remote sensing satellite image we found that there was an obvious warm vortex located at the green dot in fig 4 the sea surface height field is shown in fig 8 a we placed the auv at the center of the vortex white dot and ordered it to perform two thermocline tracking tasks westward each task contained four consecutive yo yo profiles the trajectories of these two tasks are shown in fig 8 b and they took approximately 7 h and 45 min the total horizontal distance was approximately 15 4 km meanwhile six ship based ctd stations were constructed at a depth of 300 m along the predetermined trajectory of the auv green square dots to provide verification support according to the pilot survey the vertical temperature distribution in this water column was complex with irregular gradients and the v t g v i was 0 0486 as shown in fig 9 a the temperature changed sharply near 60 and 130 m the g r a d t h r e s h o l d and n were set to 0 1 c m and 2 respectively and the c o e e x t e n s i o n was set to 10 according to eq 4 the trajectories in these two tasks are shown in fig 9 b the auv cannot accurately evaluate the temperature field distribution in the individual descent or ascent phases it can only accurately identify the top thermocline in the descent and bottom thermocline in the ascent taking the first yo yo profile as an example the thermocline identified during the descent is within 45 65 m and 145 157 m during the ascent the working range of the upcoming profile was set to 15 187 m according to algorithm 2 the ctd stations reached deeper 300 m than the maximum depth of the auv the same method was utilized to post process the ship based ctd data the positions of the thermocline obtained by the two methods are listed in table 3 and table 4 which shows that the boundaries of the thermocline identified by the two methods are similar 4 5 discussions based on the performances of the above experiments two issues need to be discussed here first algorithm 2 clearly shows that the c o e e x t e n s i o n used to assist the auv in regaining the global view after falling into local oscillation is an important variable increasing c o e e x t e n s i o n arbitrarily to give the auv a global view is unwise because it reduces the temporal and spatial resolution of the auv sampled data setting c o e e x t e n s i o n too low on the other hand makes it difficult for the auv to find the true target in this article we define the vertical temperature variability index v t g v i for the balance of sampling resolution and target coverage for example the temperature gradient in fig 9 b changes more irregularly in space than in fig 7 b and has a higher v t g v i so a larger c o e e x t e n s i o n is required for coverage sampling in this area according to eq 4 the scale factor μ in eq 4 is chosen empirically and no related studies are available we analyzed the v t g v i in various marine environments using historical data and discovered that when μ is set to 200 the c o e e x t e n s i o n is more conducive to auv to obtain a global view second we combine the thermocline positions detected during the two stages of descent and ascent to assess the current distribution of the thermocline in the water column there are two reasons the real marine environment is complex the distribution of the thermocline in the water column that the auv passes through during the descent and ascent phases varies with time and space so detection results from a single phase are not representative as illustrated in fig 7 a the temperature gradients measured in two phases are different in the first yo yo profile of the task1 moreover the dynamic water column contains a number of discrete patches causing the detection results of a single phase are not global as shown in fig 9 b the water column of the vortex center contains multiple patches in the vertical direction which poses a huge challenge to adaptive coverage sampling therefore combining the information from the two phases to make a decision can reduce the risk of missing the target in the upcoming profile 5 conclusion and future work this work presented a method of using an auv for the adaptive coverage observation of a thermocline with a complex structure this method followed the s e n s e p l a n a c t control methodology the planning stage combined measurements and prior information to re evaluate the thermocline in the current region and further update the data collection strategy a controller with a closed loop structure sensed whether the auv s trajectory covered the target thermocline to prevent it from losing the target and falling into a local view computer simulation results proved that this method can better perceive variations of the thermocline and respond in time compared with the methods proposed in petillo et al 2010 and zhang et al 2012 the field experiments were carried out in xisha south china sea in september 2020 during the experiments we performed tracking work using the method proposed in this paper for two types of thermoclines one with a simple vertical temperature distribution and the other with a complex vertical temperature distribution in the vortex center pilot surveys proved to be an essential pre experimental operation in cases where we did not have a priori information on the target water column we also introduced the metric v t g v i to characterize the complexity of the thermocline and successfully guided the auv to achieve global sensing of the thermocline by adaptively extending the working depth in the experiment on 4 september we demonstrated that this method can sense the contraction of the thermocline in the horizontal direction and the controller with a closed loop structure adjusts the sampling strategy in time according to the sensing results to ensure that the auv s motion range converges to the actual thermocline which improves the sampling efficiency unfortunately we did not check the method of tracking an expanding thermocline but these results were verified and performed successfully in our simulation experiments as shown in fig 3 a we also demonstrated the coverage sampling capability of the method for the complex thermocline on september 13 the auv was deployed in the center of a vortex and instructed to continuously execute 8 yo yo trajectory profiles by comparing the online tracking results with the sampled data from the ship based ctd stations we verified the performance of the method in coverage tracking of multiple thermoclines in highly dynamic waters in future work we intend to use features such as strength thickness and type of thermocline for adaptive selection of the temperature gradient threshold to further reduce human intervention in the task we will also consider using multiple mobile platforms to perform collaborative observations through the sharing of multi point sampling data we adjusted the heading angle of the vehicle to achieve 4 dimensional 3d time adaptive sampling of the target area in the control of a single vehicle we will dynamically adjust the pitch angle and speed of the vehicle in combination with the kinematics model to reduce energy consumption acknowledgments this study was supported by the national key r d program of china no 2017yfc0305801 the state key laboratory of robotics in china no 2015 z09 the national natural science foundation of china no 61821005 and the liaoning provincial natural science foundation no 2020 ms 031 the sea surface height data was downloaded from https resources marine copernicus eu the authors will thank dr xiaofeng qi for operating the ship based ctd station during the experiment which is indispensable for the verification experiment credit authorship contribution statement hao feng investigation algorithm design implementation of simulations and field tests data processing and analysis writing original draft jiancheng yu methodology supervision project administration funding acquisition writing review editingwriting review editing yan huang conceptualization test design implementation of field tests writing review editingwriting review jianan qiao operation and maintenance of auv control system implementation of field tests zhenyu wang operation and maintenance of auv mechanical system data processing zongbo xie operation and maintenance of auv mechanical system implementation of field tests kai liu data processing investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper 
20649,vessel detection and localization based on wake measurements have been used extensively in aerial and satellite reconnaissance here a wake based approach for vessel localization and speed estimation is developed using a grid of pressure sensors on the seabed the sensor array consisted of 9 devices in a 3 3 rectangular grid with 2 5 m spacing between the instruments the array was deployed at a depth of 3 m approximately 2 5 km from the fairway the pressure time series from all sensors were used to estimate vessel speed and the travelling distance of the wake by interpreting the geometry of its time frequency representation the wake direction and an estimate of the vessel course are calculated from the delays of the incoming wake between the sensor locations equivalently based on cross correlations of the signal at neighbouring sensors results for single events are compared with data collected from the vessels self reporting systems ais it is concluded that a grid of pressure sensors can provide a reliable estimation of the vessel location and its speed the presented technique makes it possible to locate ships and their speed and course as the next step towards a vessel traffic monitoring system based on wake recordings keywords ship wake spectral analysis vessel localization ais data pressure sensor 1 introduction the increase in the density of maritime traffic a variety of ship types and multiple uses gradually adds to the complexity of offshore and coastal sea management van westrenen and baldauf 2020 it also generates a higher probability of accidents altan and otay 2018 and raises pressure on the marine claremar et al 2017 zanatta et al 2020 and coastal delpeche ellmann and soomere 2013 environment in particular the introduction of unmanned marine autonomous surface ships additionally increases the related risks due to a reduced recovery capability thieme et al 2018 specifically losing contact with a ship can severely limit the options for maintaining control in critical applications to cope with this risk the ability of coastal services to detect a vessel and estimate its position speed and course are essential our research is motivated by several studies which have developed vessel tracking methods vessel movements can be retrieved from well known sources like radar and radio systems zilman et al 2004 gierull 2019 renga et al 2019 siegert et al 2019 sonar technologies huang et al 2017 acoustic devices and or using direct visual observations from other vessels and the coast fefilatyev et al 2012 magnier and gervaise 2020 some of these methods including sophisticated methods such as those described in pradhan and gupta 2017 zhang et al 2017 and joseph et al 2019 enable vessel detection only determining if there are vessels present in the sea area of interest however before taking appropriate action additional information such as the vessel position speed and sailing course are needed the entire process of assessing these three properties position speed and course is referred to as localization an adequate estimate of these parameters is a key part of composing a recognized maritime picture rmp which represents a set of information necessary for creating situational awareness in maritime operations nato standardization agency 2015 one possible method to achieve this discussed in this paper is to make use of the disturbances left by the passing vessel to the surrounding water panico et al 2017 zhang and jiang 2020 one of the core sources of information about the location properties and sailing parameters of the ship is its wave wake newman 1991 tuck et al 1971 wu and meadows 1991 this problem essentially an inverse ship wave problem newman 1991 does not necessarily have a unique solution for all desired parameters technically one of the simplest properties to determine from recordings of a wake is speed a ship s speed u wave propagation direction with respect to the sailing line θ and wave number k or length l 2 π k are rigorously related 1 k θ g u 2 cos 2 θ where g is the acceleration due to gravity newman 1977 wu 1991 therefore one only needs the wave number k and the wake propagation angle θ of any part of the wake to determine the ship s speed wu 1991 the wave number can be retrieved from the dispersion relation based on wave period or frequency this almost naive approach works well if the ship is following for example traffic separation regulations torsvik et al 2015 and can be used at any distance from the sailing line provided the wake is distinguishable however without a priori information about the sailing line these quantities need to be evaluated simultaneously a straightforward solution to the problem of determining a ships speed and direction can be obtained from the entire two dimensional 2d pattern of ship generated waves wu 1991 wu and meadows 1991 by evaluation of the relevant 2d wave spectrum this approach was discussed by tuck et al 1971 and justified in detail by wu 1991 a limited solution can also be obtained from the one dimensional 1d time series of the wave system this approach requires high resolution images of the water surface that are capable of resolving single wave crests synthetic aperture radar sar images of this quality and the appropriate techniques for extraction of wave patterns have become available only since the turn of the century e g chaillan and courmontagne 2006 courmontagne 2005 and have been relatively recently extended to situations with substantial wind wave background yu and wu 2014 zilman et al 2015 alternatively applications based on scanning laser and image processing have been used in towing tanks and confined environments e g gomit et al 2015 2013 these developments have made it possible to produce highly accurate 2d spectra of ship waves gomit et al 2014 the applications of these techniques have been described in a number of studies estimating parameters of ship characteristics and their motion based on spectral analysis arnold bos et al 2007 present a method for estimates of ship speed and sailing direction based on the entire pattern of its kelvin wake they use the generalized radon transform followed by stochastic matched filtering to reliably detect the loci of the wake signature in the 2d spectrum of the image several methods such as the fractional fourier transform chen et al 2020 or convolutional neural networks kang and kim 2019 have been developed to derive the ship s speed from the sar imagery of its wake this approach has provided a thorough description of linear nonlinear and evanescent modes of the wave wake in spectral space sun et al 2018 and allows for the derivation of several ship motion parameters from these representations fan et al 2019 the 2d or 1d patterns of wakes with the necessary resolution are rarely available to use for the localization of vessels also the described spectral methods are relatively sensitive to noise and missing information about part of the wake if the quality of snapshots of the wake pattern is too low the locus will remain undefined in the spectral space moreover in conflict situations it is likely to be impossible to obtain the required data with the necessary quality some localization and surveillance methods that are valuable on the open sea may not be suitable for use in the littoral zone due to the presence of a rigid coastline which can create false positive contacts for vessel detection aiello et al 2019 and requires extensive resources for on site observation this creates a clear need for additional research to improve the detection and localization of vessels that operate near the shore or in confined waters for this reason we revert to more robust and less demanding albeit at times less exact methods for ship localization and the specification of motion parameters namely we rely on the decomposition of one point recordings of far field wake signals into time frequency representations 3d compositions of time frequency and power here referred to as spectrograms by utilizing short time fourier transform instead of 1d and 2d fast fourier transform as used in cases referred to above recent research into vessel wakes has shown that ship wakes have a content rich structure in the time frequency representation sheremet et al 2012 on many occasions this structure can be extracted from one point recordings of water surface fluctuations measured from above torsvik et al 2015 or from pressure recordings from the seabed sheremet et al 2012 moreover using the relations between different components highlighted in the spectrograms a ship s sailing characteristics including the speed and minimum distance of the sailing line from the measurement site torsvik et al 2015 or changes in the vessel movement such as course and speed alterations pethiyagoda et al 2017 can be calculated the main benefit of this approach is that the loci of single wave components are represented as straight lines asymptotes of the relevant linear dispersion relation at some distance from the point that corresponds to the border of the kelvin wedge pethiyagoda et al 2017 this property makes it possible to reconstruct the location and orientation of these lines on the spectrogram even if there are only a few recorded wave crests that present diverging and transverse waves the crossing point of these two lines transverse and divergent waves is directly related to the point that represents waves at the border of the kelvin wedge it is therefore possible to reduce the problem of determination of a ship s speed to a certain analysis of geometric features in the spectrogram moreover this method is much less sensitive to the presence of other waves in particular background waves with frequencies clearly different from the wake components at the edge of the kelvin wedge can be eliminated by a suitable spectral filter this reflects the general perception that it is easier to detect the presence of a ship sailing using waves portrayed in the spectral domain than from the spatial pattern of its wake motivated by these findings and confirmation that results based on the spectrogram methods developed by torsvik et al 2015 coincide with actual ship sailing data derived from their self reporting systems rätsep et al 2020a the question is whether it is possible to develop a simple remote vessel detection and localization system based on the wake recordings that would contribute additional information to the rmp building process this process usually consists of five steps the first three are generally instrument or sensor based nato standardization agency 2015 these are i vessel detection whether a particular vessel is in the area of interest ii localization and iii recognition providing additional information that would help to recognize either a particular ship or a ship type nato standardization agency 2015 it has been already demonstrated that vessel detection based on the wake readings is possible using multimodal pressure and inertial sensors located on the seabed rätsep et al 2020b careful merging of data from several underwater pressure sensors led to spectrograms with a quality comparable to those derived from readings collected using downward looking echo sounders rätsep et al 2020a torsvik et al 2015 while keeping the sensors concealed rätsep et al 2020b based on these results we address in this paper a further step towards vessel localization the second step of the rmp building process the procedure is divided into two major parts first we use specific features of the geometry of the wake signatures retrieved from spectrograms rätsep et al 2020b to estimate the speed and the distance of the passing vessels by further developing methods suggested by torsvik et al 2015 and developed by pethiyagoda et al 2017 towards utilisation of geometric properties of the loci of ship wakes in spectrograms secondly by applying beamforming theory to the sensor grid here referred to as the phase shift technique we determine the direction of the incoming wake the core idea is to use the time of arrival difference between single wave crests at different locations under the assumption that the crests are locally straight a similar concept has been widely used to quantify wind wave propagation direction borgman 1969 panicker and borgman 1970 and associated alongshore sediment transport seymour and higgins 1978 in previous wave research at a time when directional wave sensors were not yet available see also e g dean and dalrymple 1991 section 7 4 by combining these two methods we show that it is possible to determine the vessel position with its speed and an estimate of its sailing course at the moment in time when the wake was generated the structure of the paper is as follows the paper is divided into 5 sections section 2 provides the mathematical background to the properties of vessel waves in the kelvin wake and geometry needed for the current work also it describes the measurement site sensors data sets and methods used in the analysis process section 3 gives an overview of the results by comparing our calculated vessel locations sailing speeds and courses with the values derived from ais data the limitations challenges and areas of the potential use of the proposed techniques are discussed in section 4 section 5 summarizes the main results 2 methodology and experimental setup 2 1 kelvin wake a moving vessel inevitably leaves behind a system of surface waves a displacement vessel yields a distinctive pattern of surface waves known as the kelvin wake its properties are described in detail in many overviews sorensen 1973 wehausen 1973 newman 1977 soomere 2007 fang et al 2011 the description in this section follows these sources if the ship sails steadily the pattern of generated waves is stationary in the coordinate system attached to the ship the geometry of this pattern can be established provided the dispersion relation of the relevant wave class is known it is sufficient to recognize that i the constant phase curves also the wave crests and troughs are always perpendicular to the wave vector and that ii the local phase velocity celerity c f of stationary waves is equal to the projection of the velocity of the ship onto the direction of the wave vector yih and zhu 1989a 1989b 1989b therefore a wave component that travels steadily at an angle θ with respect to the sailing line has the phase velocity 2 c f ω k u sin θ where ω ω k is the dispersion relation for the produced waves if the ship sails from x to o fig 1 travelling the distance u δ t in time where δ t t 1 t 0 the steady waves only fill a certain circle for example circle 1 or circle 2 in fig 1 during t the radius of this circle is a function of the time and the ratio of the phase speed and group speed c g ω k if the group speed is smaller than the phase speed which is the typical case for water waves the energy released at x covers the distance c g δ t c f δ t and reaches e g in the sailing direction only until a certain point o between x and o the generated waves thus fill circle 2 with a diameter v t c g c f 1 and centred at x x 1 2 v t c g c f 1 consequently steady ship waves only can exist within a triangular area called the kelvin wedge that contains all circles 2 and that is limited by their common tangents going through o the relevant half angle of the apex α of the wedge is defined from the purely geometrical condition 3 sin α 1 2 v t c g c f 1 v t 1 2 v t c g c f 1 1 2 c g c f 1 1 a vessel moving in a deep water regime where ω g k produces the kelvin wedge with its half angle being a r c s i n 1 3 19 28 independent of the vessel speed transverse waves travel along the vessel sailing line fig 2 and divergent waves move away from it fig 2 the two wave systems interact on the borders of the kelvin wedge due to which the cusp waves are generated fig 2 the amplitude of cusp waves which notably exceeds the amplitudes of transverse and divergent waves decays slowly as r 1 3 with the distance r from the vessel kuznetsov et al 2002 the cusp waves propagate at an angle of a r c c o s 2 3 35 16 from the sailing line while transverse components travel at smaller angles reaching 0 at the sailing line the divergent components move at higher angles than cusp waves the properties of this wave system for a vessel sailing in waters of finite depth are governed by the general dispersion relation of water waves ω g k tanh k h that additionally depends on the water depth h for this situation 4 2 c g c f 1 2 k h sinh 1 2 k h and eq 3 has a somewhat more complicated form 5 sin α 1 2 k h sinh 1 2 k h 3 2 k h sinh 1 2 k h or cos 2 α 8 1 2 k h sinh 1 2 k h 3 2 k h sinh 1 2 k h 2 the properties of steady waves located at the border of the kelvin wedge on circle 2 can be easily found from eq 1 and the dispersion relation for divergent waves for this case the triangle ox r is obviously right angled and the angle ox r is π 2 α the triangle xr x is equilateral therefore the angle r xx is θ π π 2 α 2 π 4 α 2 similarly eq 1 becomes much more complicated 6 g k tanh k h 2 k 2 u 2 3 2 k h sinh 1 2 k h eq 6 for the wave number k at the border of the kelvin wedge can be interpreted as the following transcendental equation for with respect to k h sorensen 1973 7 g k tanh k h 2 k h 3 2 k h sinh 1 2 k h u g h 2 eq 7 is just another way of saying that the basic geometric properties of the kelvin wave system depend on the depth froude number 8 f h u g h where u is the speed of the vessel and g is the acceleration due to gravity for ships sailing at subcritical speeds f h 1 this is the case for most ships eq 6 has a real solution and the kelvin wake consists of two systems of waves the deviation of the properties of the kelvin wave from the situation in deep water when f h 1 can thus be characterised using the variations of the angles α and θ fig 3 for relatively fast vessels in shallow waters 0 6 f h 1 the wake is affected by the water depth h and the overall appearance of the kelvin wedge depends on the particular value of f h the changes to the half angle of the kelvin wedge and the angle of cusp wave propagation θ are relatively modest less than 0 05 until f h reaches a value of about 0 6 for larger values of f h the apex angle of the kelvin wedge starts to increase and θ to decrease the deviation of θ from its deep water value reaches 1 at f h 0 767 the wave generation process for transcritical speeds f h 1 is strongly nonlinear and cannot be described in terms of the classic depth froude number soomere 2007 when f h 1 a further increase in f h leads to a decrease in the half angle of the kelvin wedge from its formal limiting value 90 at f h 1 the wave system will consist solely of divergent waves wehausen 1973 pethiyagoda et al 2015 and may even obtain a shape characteristic of a mach stem rabaud and moisy 2013 we do not consider this case in our study as parts of the methodology rely on the presence of divergent waves the method for the identification of properties for the evaluation of the ship s location and speed is based on the spectrogram representation of one point recordings of the wake pethiyagoda et al 2017 showed that in this representation the wake signal is concentrated around the curve that they call the linear dispersion curve fig 4 this curve is described as 9 2 2 ω t 2 4 t t 2 8 where ω is the dimensionless angular frequency of the waves corresponds to diverging waves and to transverse waves and t t y is dimensionless time these two branches meet at the point t 8 ω 3 2 fig 4 both branches approach rapidly to straight lines when t increases the branch for the divergent waves has an asymptote ω t 2 whereas the branch for the transverse waves approaches the horizontal line ω 1 the point where the two branches meet corresponds to the edge of the kelvin waves therefore to cusp waves that are the highest of the far field wake and thus the easiest to detect however from fig 4 it becomes clear that the determination of the coordinates of this point in the spectrogram representation is a complicated task as it is located at the vertical section of the dispersion curve therefore even small errors in the evaluation of the properties of cusp waves may lead to large errors in the estimated frequency of waves and thus to large errors in the estimated ship speed to a first linear approximation the point that represents the edge of the kelvin wedge in this representation is always directly related to the crossing point t 2 ω 1 of these two asymptotes marker a in fig 4 this relationship is invariant with respect to the ship s speed and also with respect to the relevant depth froude number pethiyagoda et al 2017 consequently the aim is to specify this point and not the meeting point of the two branches of the linear dispersion curve the existence of the two asymptotes makes it possible to identify the instant of arrival of the wake in the spectrogram even when only a few components of the wake are detectable e g distinguishable from a relatively high wind wave field as this linear dispersion curve is invariant to the froude number the method itself is insensitive to the variations in this parameter however the performance of the method does depend on the depth froude number as the ratio of the energy of transverse and divergent waves and the extension of the identifiable parts of the two branches varies with the variation in the froude number pethiyagoda et al 2017 an intrinsic limitation is that both branches must be present in the spectrogram therefore the method as described here cannot be used for supercritical speeds when steady transverse waves cannot exist 2 2 measurement site and devices the measurements were conducted on the nearshore of tallinn bay in july 2017 tallinn bay is a semi enclosed area of approximately 10 20 km in size it is located on the south eastern coast of the gulf of finland in the north eastern baltic sea fig 5 it is open to the central part of the gulf of finland to the north and the north west the two entrances to the bay from the north and west are regulated by a local vessel traffic separation scheme fig 5 to retrieve steady wake signatures that would not be affected by the speed and course alternations we focused on vessels approaching the port of tallinn from the north we chose to deploy our measurement devices near the shore of the pikakari peninsula fig 5 katariina jetty to the south east of the measurement site and the tip of pikakari peninsula to the north west shelter the measurement location from waves approaching from the west and south respectively their presence shelters the measurement location from waves generated by the predominant wind and also means that wakes from the vessels sailing out of the port of tallinn or approaching from the west are negligible at the sensor location the sailing direction of vessels that approach the port from the north north west was approximately 159 clockwise from north the deviation of courses from this estimated from ship self reporting systems was typically less than 10 the water depth in part of the traffic separation scheme where the wakes of the approaching vessels could have originated fig 5 ranges from 40 to 70 m passenger vessels entering to port were travelling at 15 to 30 knots 1 1 1 knot is 1 852 km per hour in the mentioned area and therefore they are sailing at subcritical speeds even though the depth froude number for such speeds may reach values about 0 7 on average it was below 0 5 for these froude numbers the deviation of the geometry of the kelvin wedge from the deep water geometry is insignificant fig 3 the data were collected with multimodal pressure and inertial sensors called hydromasts fig 5 ristolainen et al 2019 in total 9 sensors were mounted with an equal horizontal spacing of 2 5 m on an aluminium frame s1 to s9 in fig 5 the frame was deployed at a depth of 3 m on the seabed with an orientation of 22 5 north to properly catch the single wake wave crests of the incoming vessels the frame was secured to the seabed with 8 mm metal bars and additional weights on the corners the hydromasts recorded the absolute pressure of the water column absolute pressure sensor in fig 5 and an estimate of the near bed water velocities using a calibrated relationship with the linear acceleration of the vibrating mast at the top of the device fig 5 this dataset has also been used for automatic vessel wake detection rätsep et al 2020b here however we only use the pressure data the pressure sensors were located near the bottom of the instrument and therefore the readings were obtained at 0 2 m above the seabed the measurement frequency for all the sensors was 100 hz 2 3 data conversion the spectrogram technique involved the conversion of the pressure data into water level elevation and subsequent implementation of the short time fourier transform the main focus was on the retrieval of the ship wake components from the frequency spectrum of the wave data therefore we did not concentrate on actual wave height values power values on the time frequency representation of the pressure data and the sensitivity caused by external sources to the data this technique is based on the process described by rätsep et al 2020b and is presented here only in summary form to provide a complete overview of the procedure the starting point is the geometry of the wake structure retrieved from the corresponding spectrogram based on torsvik et al 2015 and it essentially uses the existence of two asymptotes of the linear dispersion curve of ship waves as a first step outliers values that differed by more than three standard deviations from the mean pressure value were removed from the absolute pressure data an example of input data is given in fig 6 a the data stream originally measured in mv was converted into pressure p 0 pa by a calibration relation established in a test tank 10 p 0 27 1208 p 4475 72 with r 2 0 9 the height of the water column was calculated considering the average depth at the measurement site as h 3 m and the height of the sensor d s 0 2 m above the seabed as this area is microtidal with typical tidal amplitudes a few cm leppäranta and myrberg 2009 tide driven changes to the water depth are ignored the attenuation of water surface fluctuations in the water column was estimated using the relation dean and dalrymple 1991 karimpour and chen 2017 11 p 0 z h s p q ρ g h s ρ g η k p where p 0 is total pressure p is the mean water pressure q represents the water surface fluctuations h s is the depth of the sensor g is gravity acceleration ρ is the water density z is the depth of the sensor with positive values above the water level η is the water surface elevation and k p is the dynamic pressure to the surface elevation conversion factor dean and dalrymple 1991 karimpour and chen 2017 12 k p cosh k h z cosh k h cosh k d s cosh k h here the wavenumber k was calculated following the method proposed by goda 2010 this procedure of reconstruction of wave heights is not essential for our method and we only included it in order to keep the compatibility of our research with other studies that have tracked the water surface the frequency of pressure fluctuations in surface waves exactly matches the frequency of waves therefore possible errors of the conversion of measured data series into wave time series may only affect the wave heights but does not distort the location of high energy fluctuations on the linear dispersion curve wave data were downsampled to the frequency of 5 hz a short time fourier transform was applied in the frequency range of 0 005 0 6 hz periods from 5 3 to 200 s with a step size of 0 005 hz on a uniform scale using a hamming window function of 1024 data points with a length of 204 8 s or about 3 4 min and overlap of 1014 points 203 8 s with a 2 s step each application of the fourier transform produces a discrete representation of the frequencies of identified waves the maximum mismatch of the frequency of the relevant high energy point from the corresponding point of the linear dispersion curve depends on the retrieved frequency and decreases with the increase in this frequency this feature suggests that the asymptotes of the linear dispersion curve are better represented in the time frequency representation fig 4 finally the spectrograms from different sensors were normalised and merged following the idea of using ensemble averaging of the output of different sensors to increase the wake to background noise ratio rätsep et al 2020b the fourier transform does not introduce any systematic bias in the frequency of the retrieved high energy fluctuations however as all sensors are recording the same wave the process of merging the data from 9 sensors does not decrease the typical error in frequency retrieved from a single sensor 2 4 spectrogram analysis speed of the vessel and the distance travelled by the wake vessel localization requires knowledge of the position speed and course we approached the first part of this problem by determining the propagation direction and the distance travelled by its wake to the measurement location under the assumption that a ship sailed more or less with a steady speed and course the two other parameters speed and course were assessed during the analysis process we employed two different and independent techniques a spectrogram technique for finding the speed and the distance that the wake had travelled from its point of origin to the measurement site and a phase shift technique based on the time delays of the incoming wake at the pressure sensors in the grid for estimating the direction of the incoming wake from this information we derive a possible course on which the vessel sails ship wake signatures fig 6b were extracted from the spectrograms using peak detection analysis fig 6c and divided into the divergent and transverse components the speed of the ship and the distance travelled by the wake were determined using relations developed by torsvik et al 2015 and actually stemming from wu 1991 the main wake components used in this process were transverse waves pethiyagoda et al 2018 represented by the almost horizontal branch of an l like signature fig 6b the divergent waves are represented by an inclined branch in this signature in other words the frequency of transverse waves changes insignificantly after the cusp waves have arrived however the frequency of divergent waves varies substantially and almost linearly in this representation for the fixed observation location fig 4 such signals are often referred to as chirp signals or chirps sheremet et al 2012 the cusp waves were associated with the intersection of the two branches of the spectrogram figs 4 and 6b the width of these branches depends on the scale of the image that was tuned manually to achieve optimal extraction this width was also taken into account when estimating the possible errors of estimates of vessel speed and distance finally the features on spectrograms that reflect transverse and divergent components were fitted with straight lines fig 6c torsvik et al 2015 applied three approaches for determining the speed u of the vessel from the spectrogram they all rely on the frequency f of certain components of ship waves if the starting point of the branch for the diverging waves is well defined the ship s speed is torsvik et al 2015 13 u 3 2 g 2 π f c u s p where f c u s p is the frequency of cusp waves marker b in fig 4 this frequency matches the meeting point of the signatures of diverging and transverse waves that corresponds to the non dimensional frequency ω 3 2 in fig 4 alternatively it is possible to use the asymptotic value ω 1 of the signature of the transverse component of the ship wake if we denote the relevant frequency by f t the ship s speed is torsvik et al 2015 14 u g 2 π f t expressions 13 and 14 theoretically lead to the same results their applicability is however greatly different because of the sensitivity of the accuracy of the specification of the relevant frequency as the frequency of cusp speed corresponds to the vertical section of the linear dispersion curve even small errors in the estimates of cusp wave timing may lead to large errors in f c u s p the estimates of f t are evidently much more stable consistent with the described features the approach based on the signature of the transverse component generally leads to a better match of the estimates of the speed of the vessels compared to the ais information rätsep et al 2020a this conjecture is not unexpected as the location of the meeting point of the two branches is much more complicated to identify compared to the frequency of transverse waves for this reason only results obtained using eq 14 are considered in this study the distance from the point of origin of the wake to the sensor was estimated using the ship s speed u and the time interval δ t during which the frequency of the divergent component reached from the cusp wave frequency f c u s p to 2 times higher value 2 f c u s p torsvik et al 2015 to find δ t a linear fit was built for the divergent component the distance l to the measurement site from the point of origin of the vessel wake is torsvik et al 2015 estimated as 15 l 6 u δ t 2 5 detection of wakes to compare our results with actual sailing parameters from passing ships we used data from the vessel self reporting systems automatic identification system ais collected from the area marked in fig 5 vesselfinder 2020 the ais data were recorded on average with 5 min intervals for the majority of the vessels the data included the geographical location retrieved from a gps device timestamp name international maritime organisation number call sign course and speed vesselfinder 2020 in total 249 different vessels were identified with 101 275 ais readings the accuracy of the estimates of the vessel speed depends therefore mostly on the accuracy of timestamps these are normally provided with an accuracy of a few seconds and thus the ais based estimates of speed apparently have errors below 1 due to the relatively intense traffic wakes from several vessels often arriving at the measurement site less than 30 min apart we focused on single strong transverse and divergent component visible and extractable from spectrogram as shown in fig 6 wake events this approach means that we filtered out signals of wakes originating from departing vessels and multiple vessel cases therefore the cases were to some extent hand picked the ais data were sorted into single ship passing events a passing is defined here as a series of consecutive data points indicating the sailing trajectory and time stamps of a ship that passes the measurement site for each position in the passing a corresponding wake origin point was calculated based on the vessel course at that point the ship s position that had the smallest perimeter of a triangle with vertices at the measurement site the ais position and estimated wake origin was chosen as the reference of that particular passing those positions were matched with wake readings we focused on situations where there was only a single vessel within 3 7 km 2 nmi 2 2 nmi is denoted as nautical mile 1 nmi is 1 852 km of the measurement site and travelling faster than 15 knots in a time window of 15 min from the wake event as the closest ais location to the wake origin point on the vessel track may have been before reaching it or after passing it wakes from the vessels sailing below 15 knots were not detected mostly because they were indistinguishable from the background wind waves examples of weak wakes overlapping wakes and single detectable wakes are given in fig 7 fig 7a and d correspond to m s seawind slowing down from its transit speed of 15 knots as it approached the port of tallinn change from solid line to dashed line in fig 7a even though it was a single vessel passing the measurement site in the 30 min window fig 7a the wake structure was not extractable from the spectrogram without additional filtering fig 7d due to the low signal to noise ratio snr therefore this and similar cases were discarded the second case depicts a rush hour near the measurement site two vessels m v hsc express from helsinki from the north and mv victoria i from mariehamn from the north west were entering port more or less at the same time fig 7b two solid lines passing the measurement site this results in two wake structures visible in the spectrogram fig 7e as the determination of the branches of the relevant wave systems and therefore also sailing characteristics of a particular vessel from this pair are complicated without further analysis cases like this were excluded from our analysis the last pair fig 7c and f shows an example of events selected for this study a single vessel m v megastar at 25 knots approached the port of tallinn solid line in fig 7c ais data indicate that this time window contains also two other vessels a patrol boat operated by the estonian police and a border guard board entering the harbour and passing the measurement site with speed less than 15 knots and a yacht sailing up north outside the 2 nmi area despite this additional traffic the spectrogram fig 7f contained only a single discernible wake event with divergent and transverse component visible for extraction these constraints left 70 passings for analysis these vessels were passenger craft ro ro ferries such as m v star and m v superstar and high speed craft like m s hsc express and m s supercat entering the port of tallinn 2 6 the direction of the incoming wake and the travelling course of the vessel the direction of the incoming wake was estimated using the same pressure data but utilized a somewhat different approach outliers were removed in the same manner as described previously instead of down sampling and correcting the data fluctuations were filtered out using a 9th order butterworth filter to ease the estimation of the time delays due to high noise levels and small time shifts of the approach of the wake at different sensors a maximum of 1 6 s at s1 and s9 in fig 5 a relatively large time window 15 min was used to achieve reliable values of the cross correlation this duration matches the typical length of the wake signal figs 6 and 7 to reduce the effect of noise delays were calculated between all possible sensor pairs in total 36 pairs using sensors s1 to s9 from the instrument grid in fig 5 for each pair two possible directions were found using the time delay and the distance between the sensors based on the positions of each pair and wake wave speed of 4 3 m s this phase speed corresponds to transverse waves with a typical period of 7 s in 3 m deep water this resulted maximum of 72 possible combinations for 36 sensor pairs as an example in fig 8 as 36 directions from the 72 were misleading x2 to x15 in fig 8a and around half 16 18 of the sensor pairs were positioned perpendicular to the wavefront for example sensor pairs s1 s4 s4 s7 s1 s7 if the source was x1 in fig 8a which produced high alterations of the found direction then only 18 to 20 directions from the sensor pairs that were more or less parallel to the wavefront for example s1 s2 s2 s3 s1 s3 in fig 8a out of 72 could be considered when finding the actual wave direction for these reasons we applied a histogram analysis carlotto 1987 to determine the population of the angles that could be used to find the wake direction an example is shown in fig 8 as selected bin the actual direction of the incoming wake was calculated as an average of that population with a standard deviation multiplied by 2 indicating the level of uncertainty at 95 indicated with black solid and dashed lines in fig 8 as the location of the devices was chosen in a coastal segment that had an orientation more or less parallel to most of the approaching crests of ship waves shallow water refraction of waves is not taken into account the relevant correction for situations when waves approach the shoreline under larger angles is straightforward but not done here because the intensity of refraction only depends on the wave period finally the courses of the vessels were calculated based on the assumption that vessels were sailing in the deep water regime with a travelling angle of the cusp waves of 35 16 to the calculated direction of propagation of the incoming wake waves this resulted in two different courses one based on the starboard side branch of the vessel wake and another on the port side branch fig 2 as the presented approach for vessel localization based on its wake is confined to a single point on the sailing path one point wake readings do not provide information to decide which of the two proposed courses is the right one this situation is characteristic for various methods of detection of wave propagation direction that define the line along which waves propagate but leave 180 degree ambiguity of the direction engen and johnsen 1995 a possible way forward is to use two clusters of sensors similar to the idea of using two subsequent synthetic aperture radar images to determine the wave propagation direction ouchi et al 1999 the flow chart of the entire analysis process for vessel localization is presented in fig 9 the comparison positions fig 9 used the wake source locations from the ais data as discussed in section 2 5 and calculated positions using the distance from the spectrogram analysis section 2 4 and the direction of the incoming wake section 2 6 the comparison of the vessel sailing speed fig 9 involves the speed from the ais position from the wake source point was derived and the speed value from the spectrogram analysis section 2 4 comparison of the vessel courses fig 9 incorporates differences between the course of the ais position from the wake source point was found and the course derived from the phase shift analysis section 2 6 3 results 3 1 vessel positions we start from the comparison of calculated wake source points with vessel positions derived from the ais data an example of the position calculations is given in fig 10 where m s megastar is approaching the port of tallinn along the track marked by the ais data 30 min of ais track is also shown in fig 7c the spectrogram is presented in figs 6b and 7f initial data in fig 6a and direction estimation in fig 8b the dashed line in fig 10 indicates the track and the dots show the instantaneous vessel positions the square indicates the wake source point on the vessel s path with a circle around it indicating a possible area of uncertainty based on speed and course alterations in this case they are less than 2 7 km apart as calculated from the location closer to the port the distance between the vessel position at the time of wake generation and the closest ais position varied from 5 m to 3 km depending on the availability of the ais data and the sailing speed of the ship the typical interval between the ais positions was around 5 min the calculated vessel position based only on the measurement data a rhombus in fig 10 is estimated to be at 3 9 km from the measurement device the difference between the estimated wake source point and the associated ais position is about 400 m in 49 cases out of 70 in this study as indicated in fig 11 the estimated ship position was less than 1 4 km from the calculated wake origin point in most of these cases 48 the points were closer than 1 km and on 35 occasions less than 600 m location comparison between calculated results and the wake source points retrieved from ais data for all the applicable cases 49 is shown in fig 12 the bias between longitudinal coordinates was 59 m with a standard deviation sd of 237 m and the sd between the latitudinal coordinates was 490 m with a bias of 4 m the average distance between calculated locations and the measurement site was on average 3 2 km with a standard deviation of 0 5 km from the viewpoint of vessel localization the presented technique failed to estimate the position if the difference between the estimated wake source point and the associated ais position was larger than 1 4 km this criterion is somewhat arbitrary and is based on the perception that errors larger than this value may locate the ship either to dry land mazaheri et al 2014 the proportion of failures 21 out 70 was less than 1 3 of the entire set of events from these in 11 cases the direction was not properly resolved from the phase shift technique on 6 occasions the interpretation of wake components in spectrograms was problematic and on 4 occasions problems occurred with both aspects of the presented techniques actual numbers of successful attempts are shown in fig 11 the accuracy of the proposed method was evaluated in terms of an area of uncertainty a dotted line around the rhombus in fig 10 using the spread of data points used by both methods as discussed in 2 4 and 2 6 the length of this area from the line 1 to 3 in fig 10 represents the uncertainty of the distance estimation its width reflects the uncertainty of estimates of the wake components extracted from the spectrogram fig 6c in particular the width from the line 2 to 4 in fig 10 comes from the sensor pair selection process determination of the principal direction for finding the propagation direction of the incoming wake as illustrated in fig 8 the area depicted in fig 10 is 2 8 km long uncertainty of distance estimation from the line 1 to 3 in figs 10 and 2 km wide uncertainty of the computation of the direction from the line 2 to 4 in fig 10 this size of the uncertainty area is typical for most of the 49 successful cases the average area of uncertainty was 1 7 km distance long with sd of 0 85 km and 1 9 km direction wide with sd of 0 46 km the wake direction fluctuations were usually within width of the area 16 the distance length of the area was estimated as varying by an average of 0 86 km from the spread of the data points that contributed to the analysis process 3 2 speed and course of the vessels vessel localization requires estimates of the speed and course of the vessel the results of estimates are depicted in fig 13 and fig 14 the speed estimation was performed successfully in 64 cases fig 11 for which the spectrogram technique was applicable using eq 14 six cases were removed due to a high level of noise which resulted in difficulties when extracting the transverse component automatically the results match vessel speed well at the closest position from the ais data r 2 0 81 whereas standard deviation between the reference ais values and calculated speed was 1 60 knots and bias 0 833 knots consistent with the results in rätsep et al 2020a the speed calculations based on an approximation of the transverse component generally produced adequate results it only occasionally underestimated or overestimated the ais based speed an example of underestimation is point a in fig 13 the m v viking xpress approached at 20 6 knots but our method provided an estimate of the speed of 14 8 knots other methods analyzed in torsvik et al 2015 gave 22 5 knots using the highest energy value as the cusp wave point and 21 5 knots taking the beginning of the divergent wave component for the cusp wave point the most severe overestimation point b in fig 13 occurred when m s supercat was approaching the port at 28 9 knots our approach resulted in an estimate of 34 4 knots whereas the two other methods gave 35 4 knots and 32 2 knots respectively the possible vessel courses were computed by applying the travelling angle of the cusp wave to the opposite direction of the incoming wake as discussed above in the current setup we did not have methods available to estimate which of the two branches port or the starboard side as depicted in fig 2 of the wake reached the measurement site for this reason we calculated possible courses for both situations the orientation of the vessel sailing line was calculated using the 55 cases fig 11 when the wake direction was successfully estimated based on the known angle between the propagation direction of the wake and the sailing line fig 2 the vessel courses from the ais were around 159 10 one set of these orientations set 1 in fig 14 matched well usually within 10 standard deviation from the differences was 3 28 and bias 0 846 the vessel courses evaluated from the ais data this corresponds to the actual situation as the vessels approaching port were north north east from the measurement site when the wake was generated meaning that the measurement site received the starboard branches of their wakes the alternative orientations obtained from the wake direction set 2 in fig 14 which correspond to a port side branch of the wake are about 70 two times of the cusp wave travelling angle of 35 16 with a standard deviation of 3 28 and bias of 71 4 from the actual vessel course in our case this set could be ruled out due to two arguments firstly the general orientation of the traffic separation scheme near the measurement site is 159 339 whereas set 2 proposes courses around 230 secondly the pikakari peninsula lies to the west of tallinn bay which means that if the vessel had approached at a course determined by set 2 then it would have passed a peninsula either dangerously close without considering course changes or grounded near it more generally the magnitude of the offset 70 between the two possible orientations of the sailing line apparently makes it often possible to select the true course in most nearshore applications simply because the other orientation is not feasible 4 discussion since the first application of the spectrogram technique for the interpretation of ship wake measurements sheremet et al 2012 there have been several developments to determine sailing characteristics speed and distance from the measurement location along with the sailing regime torsvik et al 2015 pethiyagoda et al 2017 2018 all these studies rely on the fundamental properties of the ship wave system that are invariant to the distance from the sailing line and the speed of the ship unless the depth froude number exceeds the value of about 0 75 the set of such properties is particularly simple in the spectrogram representation where the two branches of the wake signal rapidly approach well defined asymptotes the adequacy of the retrieved properties therefore basically depends on the capacity of the wake recording systems to extract at least a small set of wave components that allow the reconstruction of these asymptotes in this work we evaluated if a vessel could be positioned and its sailing parameters determined based on one point information that does not include any information on the vessel movement along its course we combined the spectrogram technique to estimate the speed and distance of the passing vessels torsvik et al 2015 extended to the use of pressure data in the nearshore rätsep et al 2020b with a phase shift cross correlation technique to determine the direction of the incoming wake to estimate the vessel s position and course we demonstrated that this approach produced results comparable with the actual data derived from the vessel self reporting systems the techniques used here were highly sensitive to background noise even though some parts of the techniques including the construction of spectrograms is robust it was difficult to obtain suitable wake structures from spectrograms when the vessel was travelling at less than 15 knots rätsep et al 2020a and thus produced very low waves it is also natural to expect that the technique will fail when wind wave background with a substantial proportion of energy in the frequency range of ship wakes masks the wave signal therefore additional means such as convolution techniques should be implemented to extend the developed technique to slower and or smaller vessels that produce relatively small waves and for situations that involve strong wind seas it is likely that the spectrogram technique will still work well in strong swells or short period wind seas where the ship waves have periods different from background periods however as the height of cusp waves decreases as r 1 3 with distance from the fairway even the signal of very large ship waves will be untraceable at very large distances another intrinsic limitation of the presented technique is that substantially relies on the properties of transverse waves as the wake of very fast vessels in shallow waters supercritical wake contain only diverging waves the entire approach is not applicable for the evaluation of vessel distance speed or course for vessels travelling at supercritical speeds as such wakes contain a large proportion of nonlinear waves their wake structure is much more complicated in the spectrogram representation pethiyagoda et al 2017 the developed technique is only directly applicable for single wakes only one wake structure present in the 30 min window however in high traffic regions wakes from several ships sailing with different speed and course may arrive at the measurement devices at the same time as seen on multiple occasions in the tallinn bay experiments this makes the extraction and use of the wake structures in the spectrograms questionable compounded by the effects of interference when applying the phase shift analysis to determine wake direction however a feasible way forward is to use convolution techniques implemented in routines for acoustic localization of multiple ships byun et al 2019 most of the relevant experiments have been conducted in relatively shallow water areas to detect highly powered passenger vessels and analyze the effects of their wakes on the coastal environment torsvik et al 2015 our approach can be even more useful for security and surveillance operations to raise situational awareness in coastal regions where using usual means of vessel detection and localization is too resource demanding aiello et al 2019 or is challenged by intentionally removed localization instrumentation dumitriu et al 2018 we only note that the presented method needs to be modified for shallow regions to incorporate information about wave refraction this change is technically complicated as it must involve ray tracing for each ship wave component but conceptually it is straightforward as refraction intensity only depends on the wave period and water depth however we have also identified a range of problems the maximum possible detection localization distance remains unknown we were able to position a large proportion of passing vessels by their wakes at an average distance of 3 2 km because of two favourable features firstly the local traffic separation scheme guarantees that vessels sail along a prescribed waterway secondly the experiment recorded only passenger ships entering the port to test further distances we need to test this method in an area which is much wider than the approach to the port of tallinn in addition to these problems the developed technique can be complemented by introducing methods for determining the speed and course alterations pethiyagoda et al 2017 2018 2018 another natural extension would be to determine whether ship recognition the third step of the picture building process nato standardization agency 2015 based on their wakes is possible at large scales however the main message of this study is that a vessel monitoring system solely based on the wake information in the wave recordings is practically possible this message is important due to several developments such as the growing number of unmanned marine autonomous surface ships operating in coastal regions or e g refugee vessels which intentionally remove on board localization instrumentation dumitriu et al 2018 we are optimistic as these first results show that vessel localization based on the wake measurements is technically feasible an exciting improvement to the technique used here is that it can be combined with automatic wake detection rätsep et al 2020b these are the first two steps of the picture building process nato standardization agency 2015 needed to improve the situational awareness of naval operations what makes this method preferable for traffic monitoring is that the sensing array can be easily concealed in our case it was set near the beach at a depth around 3 m therefore no special equipment ship or boat were required 5 conclusion the objective of this work was to determine whether vessel localization position speed and course of a ship may be achieved by using wake measurements from a closely spaced array of underwater pressure sensors a grid of 9 sensors was deployed with a horizontal offset of 2 5 m at the depth of 3 m single ship wakes were manually selected from the continuous recording using 30 min windows the properties of the ship movements were matched to ais vessel data a spectrogram technique was implemented for calculating the speed of the passing ship and the distance travelled by the wake the core new developments are the systematic use of the concept of asymptotes of the linear dispersion relation to determine some parameters of the vessel motion and the demonstration that phase shift cross correlation analysis can retrieve the possible courses on which a vessel could be sailing from the direction of the incoming wake we showed that wake data from pressure sensors can be used for surface vessel localization with a positioning error less than 600 m in 50 of the cases credit authorship contribution statement margus rätsep conceptualization methodology formal analysis writing original draft writing review editing kevin e parnell conceptualization writing original draft writing review editing tarmo soomere conceptualization methodology writing original draft writing review editing maarja kruusmaa conceptualization investigation writing original draft asko ristolainen resources investigation writing original draft jeffrey a tuhtan resources investigation writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the estonian ministry of education and research estonian research council grants prg1129 and put 1690 and the european regional development fund program mobilitas pluss reg nr 2014 2020 4 01 16 0024 project mobtt72 and co supported by the estonian center of excellence excite the estonian research infrastructures roadmap object infotechnological mobility observatory imo and the european economic area eea financial mechanism 2014 2021 baltic research programme project emp480 solutions to current and future problems on natural and constructed shorelines eastern baltic sea 
20649,vessel detection and localization based on wake measurements have been used extensively in aerial and satellite reconnaissance here a wake based approach for vessel localization and speed estimation is developed using a grid of pressure sensors on the seabed the sensor array consisted of 9 devices in a 3 3 rectangular grid with 2 5 m spacing between the instruments the array was deployed at a depth of 3 m approximately 2 5 km from the fairway the pressure time series from all sensors were used to estimate vessel speed and the travelling distance of the wake by interpreting the geometry of its time frequency representation the wake direction and an estimate of the vessel course are calculated from the delays of the incoming wake between the sensor locations equivalently based on cross correlations of the signal at neighbouring sensors results for single events are compared with data collected from the vessels self reporting systems ais it is concluded that a grid of pressure sensors can provide a reliable estimation of the vessel location and its speed the presented technique makes it possible to locate ships and their speed and course as the next step towards a vessel traffic monitoring system based on wake recordings keywords ship wake spectral analysis vessel localization ais data pressure sensor 1 introduction the increase in the density of maritime traffic a variety of ship types and multiple uses gradually adds to the complexity of offshore and coastal sea management van westrenen and baldauf 2020 it also generates a higher probability of accidents altan and otay 2018 and raises pressure on the marine claremar et al 2017 zanatta et al 2020 and coastal delpeche ellmann and soomere 2013 environment in particular the introduction of unmanned marine autonomous surface ships additionally increases the related risks due to a reduced recovery capability thieme et al 2018 specifically losing contact with a ship can severely limit the options for maintaining control in critical applications to cope with this risk the ability of coastal services to detect a vessel and estimate its position speed and course are essential our research is motivated by several studies which have developed vessel tracking methods vessel movements can be retrieved from well known sources like radar and radio systems zilman et al 2004 gierull 2019 renga et al 2019 siegert et al 2019 sonar technologies huang et al 2017 acoustic devices and or using direct visual observations from other vessels and the coast fefilatyev et al 2012 magnier and gervaise 2020 some of these methods including sophisticated methods such as those described in pradhan and gupta 2017 zhang et al 2017 and joseph et al 2019 enable vessel detection only determining if there are vessels present in the sea area of interest however before taking appropriate action additional information such as the vessel position speed and sailing course are needed the entire process of assessing these three properties position speed and course is referred to as localization an adequate estimate of these parameters is a key part of composing a recognized maritime picture rmp which represents a set of information necessary for creating situational awareness in maritime operations nato standardization agency 2015 one possible method to achieve this discussed in this paper is to make use of the disturbances left by the passing vessel to the surrounding water panico et al 2017 zhang and jiang 2020 one of the core sources of information about the location properties and sailing parameters of the ship is its wave wake newman 1991 tuck et al 1971 wu and meadows 1991 this problem essentially an inverse ship wave problem newman 1991 does not necessarily have a unique solution for all desired parameters technically one of the simplest properties to determine from recordings of a wake is speed a ship s speed u wave propagation direction with respect to the sailing line θ and wave number k or length l 2 π k are rigorously related 1 k θ g u 2 cos 2 θ where g is the acceleration due to gravity newman 1977 wu 1991 therefore one only needs the wave number k and the wake propagation angle θ of any part of the wake to determine the ship s speed wu 1991 the wave number can be retrieved from the dispersion relation based on wave period or frequency this almost naive approach works well if the ship is following for example traffic separation regulations torsvik et al 2015 and can be used at any distance from the sailing line provided the wake is distinguishable however without a priori information about the sailing line these quantities need to be evaluated simultaneously a straightforward solution to the problem of determining a ships speed and direction can be obtained from the entire two dimensional 2d pattern of ship generated waves wu 1991 wu and meadows 1991 by evaluation of the relevant 2d wave spectrum this approach was discussed by tuck et al 1971 and justified in detail by wu 1991 a limited solution can also be obtained from the one dimensional 1d time series of the wave system this approach requires high resolution images of the water surface that are capable of resolving single wave crests synthetic aperture radar sar images of this quality and the appropriate techniques for extraction of wave patterns have become available only since the turn of the century e g chaillan and courmontagne 2006 courmontagne 2005 and have been relatively recently extended to situations with substantial wind wave background yu and wu 2014 zilman et al 2015 alternatively applications based on scanning laser and image processing have been used in towing tanks and confined environments e g gomit et al 2015 2013 these developments have made it possible to produce highly accurate 2d spectra of ship waves gomit et al 2014 the applications of these techniques have been described in a number of studies estimating parameters of ship characteristics and their motion based on spectral analysis arnold bos et al 2007 present a method for estimates of ship speed and sailing direction based on the entire pattern of its kelvin wake they use the generalized radon transform followed by stochastic matched filtering to reliably detect the loci of the wake signature in the 2d spectrum of the image several methods such as the fractional fourier transform chen et al 2020 or convolutional neural networks kang and kim 2019 have been developed to derive the ship s speed from the sar imagery of its wake this approach has provided a thorough description of linear nonlinear and evanescent modes of the wave wake in spectral space sun et al 2018 and allows for the derivation of several ship motion parameters from these representations fan et al 2019 the 2d or 1d patterns of wakes with the necessary resolution are rarely available to use for the localization of vessels also the described spectral methods are relatively sensitive to noise and missing information about part of the wake if the quality of snapshots of the wake pattern is too low the locus will remain undefined in the spectral space moreover in conflict situations it is likely to be impossible to obtain the required data with the necessary quality some localization and surveillance methods that are valuable on the open sea may not be suitable for use in the littoral zone due to the presence of a rigid coastline which can create false positive contacts for vessel detection aiello et al 2019 and requires extensive resources for on site observation this creates a clear need for additional research to improve the detection and localization of vessels that operate near the shore or in confined waters for this reason we revert to more robust and less demanding albeit at times less exact methods for ship localization and the specification of motion parameters namely we rely on the decomposition of one point recordings of far field wake signals into time frequency representations 3d compositions of time frequency and power here referred to as spectrograms by utilizing short time fourier transform instead of 1d and 2d fast fourier transform as used in cases referred to above recent research into vessel wakes has shown that ship wakes have a content rich structure in the time frequency representation sheremet et al 2012 on many occasions this structure can be extracted from one point recordings of water surface fluctuations measured from above torsvik et al 2015 or from pressure recordings from the seabed sheremet et al 2012 moreover using the relations between different components highlighted in the spectrograms a ship s sailing characteristics including the speed and minimum distance of the sailing line from the measurement site torsvik et al 2015 or changes in the vessel movement such as course and speed alterations pethiyagoda et al 2017 can be calculated the main benefit of this approach is that the loci of single wave components are represented as straight lines asymptotes of the relevant linear dispersion relation at some distance from the point that corresponds to the border of the kelvin wedge pethiyagoda et al 2017 this property makes it possible to reconstruct the location and orientation of these lines on the spectrogram even if there are only a few recorded wave crests that present diverging and transverse waves the crossing point of these two lines transverse and divergent waves is directly related to the point that represents waves at the border of the kelvin wedge it is therefore possible to reduce the problem of determination of a ship s speed to a certain analysis of geometric features in the spectrogram moreover this method is much less sensitive to the presence of other waves in particular background waves with frequencies clearly different from the wake components at the edge of the kelvin wedge can be eliminated by a suitable spectral filter this reflects the general perception that it is easier to detect the presence of a ship sailing using waves portrayed in the spectral domain than from the spatial pattern of its wake motivated by these findings and confirmation that results based on the spectrogram methods developed by torsvik et al 2015 coincide with actual ship sailing data derived from their self reporting systems rätsep et al 2020a the question is whether it is possible to develop a simple remote vessel detection and localization system based on the wake recordings that would contribute additional information to the rmp building process this process usually consists of five steps the first three are generally instrument or sensor based nato standardization agency 2015 these are i vessel detection whether a particular vessel is in the area of interest ii localization and iii recognition providing additional information that would help to recognize either a particular ship or a ship type nato standardization agency 2015 it has been already demonstrated that vessel detection based on the wake readings is possible using multimodal pressure and inertial sensors located on the seabed rätsep et al 2020b careful merging of data from several underwater pressure sensors led to spectrograms with a quality comparable to those derived from readings collected using downward looking echo sounders rätsep et al 2020a torsvik et al 2015 while keeping the sensors concealed rätsep et al 2020b based on these results we address in this paper a further step towards vessel localization the second step of the rmp building process the procedure is divided into two major parts first we use specific features of the geometry of the wake signatures retrieved from spectrograms rätsep et al 2020b to estimate the speed and the distance of the passing vessels by further developing methods suggested by torsvik et al 2015 and developed by pethiyagoda et al 2017 towards utilisation of geometric properties of the loci of ship wakes in spectrograms secondly by applying beamforming theory to the sensor grid here referred to as the phase shift technique we determine the direction of the incoming wake the core idea is to use the time of arrival difference between single wave crests at different locations under the assumption that the crests are locally straight a similar concept has been widely used to quantify wind wave propagation direction borgman 1969 panicker and borgman 1970 and associated alongshore sediment transport seymour and higgins 1978 in previous wave research at a time when directional wave sensors were not yet available see also e g dean and dalrymple 1991 section 7 4 by combining these two methods we show that it is possible to determine the vessel position with its speed and an estimate of its sailing course at the moment in time when the wake was generated the structure of the paper is as follows the paper is divided into 5 sections section 2 provides the mathematical background to the properties of vessel waves in the kelvin wake and geometry needed for the current work also it describes the measurement site sensors data sets and methods used in the analysis process section 3 gives an overview of the results by comparing our calculated vessel locations sailing speeds and courses with the values derived from ais data the limitations challenges and areas of the potential use of the proposed techniques are discussed in section 4 section 5 summarizes the main results 2 methodology and experimental setup 2 1 kelvin wake a moving vessel inevitably leaves behind a system of surface waves a displacement vessel yields a distinctive pattern of surface waves known as the kelvin wake its properties are described in detail in many overviews sorensen 1973 wehausen 1973 newman 1977 soomere 2007 fang et al 2011 the description in this section follows these sources if the ship sails steadily the pattern of generated waves is stationary in the coordinate system attached to the ship the geometry of this pattern can be established provided the dispersion relation of the relevant wave class is known it is sufficient to recognize that i the constant phase curves also the wave crests and troughs are always perpendicular to the wave vector and that ii the local phase velocity celerity c f of stationary waves is equal to the projection of the velocity of the ship onto the direction of the wave vector yih and zhu 1989a 1989b 1989b therefore a wave component that travels steadily at an angle θ with respect to the sailing line has the phase velocity 2 c f ω k u sin θ where ω ω k is the dispersion relation for the produced waves if the ship sails from x to o fig 1 travelling the distance u δ t in time where δ t t 1 t 0 the steady waves only fill a certain circle for example circle 1 or circle 2 in fig 1 during t the radius of this circle is a function of the time and the ratio of the phase speed and group speed c g ω k if the group speed is smaller than the phase speed which is the typical case for water waves the energy released at x covers the distance c g δ t c f δ t and reaches e g in the sailing direction only until a certain point o between x and o the generated waves thus fill circle 2 with a diameter v t c g c f 1 and centred at x x 1 2 v t c g c f 1 consequently steady ship waves only can exist within a triangular area called the kelvin wedge that contains all circles 2 and that is limited by their common tangents going through o the relevant half angle of the apex α of the wedge is defined from the purely geometrical condition 3 sin α 1 2 v t c g c f 1 v t 1 2 v t c g c f 1 1 2 c g c f 1 1 a vessel moving in a deep water regime where ω g k produces the kelvin wedge with its half angle being a r c s i n 1 3 19 28 independent of the vessel speed transverse waves travel along the vessel sailing line fig 2 and divergent waves move away from it fig 2 the two wave systems interact on the borders of the kelvin wedge due to which the cusp waves are generated fig 2 the amplitude of cusp waves which notably exceeds the amplitudes of transverse and divergent waves decays slowly as r 1 3 with the distance r from the vessel kuznetsov et al 2002 the cusp waves propagate at an angle of a r c c o s 2 3 35 16 from the sailing line while transverse components travel at smaller angles reaching 0 at the sailing line the divergent components move at higher angles than cusp waves the properties of this wave system for a vessel sailing in waters of finite depth are governed by the general dispersion relation of water waves ω g k tanh k h that additionally depends on the water depth h for this situation 4 2 c g c f 1 2 k h sinh 1 2 k h and eq 3 has a somewhat more complicated form 5 sin α 1 2 k h sinh 1 2 k h 3 2 k h sinh 1 2 k h or cos 2 α 8 1 2 k h sinh 1 2 k h 3 2 k h sinh 1 2 k h 2 the properties of steady waves located at the border of the kelvin wedge on circle 2 can be easily found from eq 1 and the dispersion relation for divergent waves for this case the triangle ox r is obviously right angled and the angle ox r is π 2 α the triangle xr x is equilateral therefore the angle r xx is θ π π 2 α 2 π 4 α 2 similarly eq 1 becomes much more complicated 6 g k tanh k h 2 k 2 u 2 3 2 k h sinh 1 2 k h eq 6 for the wave number k at the border of the kelvin wedge can be interpreted as the following transcendental equation for with respect to k h sorensen 1973 7 g k tanh k h 2 k h 3 2 k h sinh 1 2 k h u g h 2 eq 7 is just another way of saying that the basic geometric properties of the kelvin wave system depend on the depth froude number 8 f h u g h where u is the speed of the vessel and g is the acceleration due to gravity for ships sailing at subcritical speeds f h 1 this is the case for most ships eq 6 has a real solution and the kelvin wake consists of two systems of waves the deviation of the properties of the kelvin wave from the situation in deep water when f h 1 can thus be characterised using the variations of the angles α and θ fig 3 for relatively fast vessels in shallow waters 0 6 f h 1 the wake is affected by the water depth h and the overall appearance of the kelvin wedge depends on the particular value of f h the changes to the half angle of the kelvin wedge and the angle of cusp wave propagation θ are relatively modest less than 0 05 until f h reaches a value of about 0 6 for larger values of f h the apex angle of the kelvin wedge starts to increase and θ to decrease the deviation of θ from its deep water value reaches 1 at f h 0 767 the wave generation process for transcritical speeds f h 1 is strongly nonlinear and cannot be described in terms of the classic depth froude number soomere 2007 when f h 1 a further increase in f h leads to a decrease in the half angle of the kelvin wedge from its formal limiting value 90 at f h 1 the wave system will consist solely of divergent waves wehausen 1973 pethiyagoda et al 2015 and may even obtain a shape characteristic of a mach stem rabaud and moisy 2013 we do not consider this case in our study as parts of the methodology rely on the presence of divergent waves the method for the identification of properties for the evaluation of the ship s location and speed is based on the spectrogram representation of one point recordings of the wake pethiyagoda et al 2017 showed that in this representation the wake signal is concentrated around the curve that they call the linear dispersion curve fig 4 this curve is described as 9 2 2 ω t 2 4 t t 2 8 where ω is the dimensionless angular frequency of the waves corresponds to diverging waves and to transverse waves and t t y is dimensionless time these two branches meet at the point t 8 ω 3 2 fig 4 both branches approach rapidly to straight lines when t increases the branch for the divergent waves has an asymptote ω t 2 whereas the branch for the transverse waves approaches the horizontal line ω 1 the point where the two branches meet corresponds to the edge of the kelvin waves therefore to cusp waves that are the highest of the far field wake and thus the easiest to detect however from fig 4 it becomes clear that the determination of the coordinates of this point in the spectrogram representation is a complicated task as it is located at the vertical section of the dispersion curve therefore even small errors in the evaluation of the properties of cusp waves may lead to large errors in the estimated frequency of waves and thus to large errors in the estimated ship speed to a first linear approximation the point that represents the edge of the kelvin wedge in this representation is always directly related to the crossing point t 2 ω 1 of these two asymptotes marker a in fig 4 this relationship is invariant with respect to the ship s speed and also with respect to the relevant depth froude number pethiyagoda et al 2017 consequently the aim is to specify this point and not the meeting point of the two branches of the linear dispersion curve the existence of the two asymptotes makes it possible to identify the instant of arrival of the wake in the spectrogram even when only a few components of the wake are detectable e g distinguishable from a relatively high wind wave field as this linear dispersion curve is invariant to the froude number the method itself is insensitive to the variations in this parameter however the performance of the method does depend on the depth froude number as the ratio of the energy of transverse and divergent waves and the extension of the identifiable parts of the two branches varies with the variation in the froude number pethiyagoda et al 2017 an intrinsic limitation is that both branches must be present in the spectrogram therefore the method as described here cannot be used for supercritical speeds when steady transverse waves cannot exist 2 2 measurement site and devices the measurements were conducted on the nearshore of tallinn bay in july 2017 tallinn bay is a semi enclosed area of approximately 10 20 km in size it is located on the south eastern coast of the gulf of finland in the north eastern baltic sea fig 5 it is open to the central part of the gulf of finland to the north and the north west the two entrances to the bay from the north and west are regulated by a local vessel traffic separation scheme fig 5 to retrieve steady wake signatures that would not be affected by the speed and course alternations we focused on vessels approaching the port of tallinn from the north we chose to deploy our measurement devices near the shore of the pikakari peninsula fig 5 katariina jetty to the south east of the measurement site and the tip of pikakari peninsula to the north west shelter the measurement location from waves approaching from the west and south respectively their presence shelters the measurement location from waves generated by the predominant wind and also means that wakes from the vessels sailing out of the port of tallinn or approaching from the west are negligible at the sensor location the sailing direction of vessels that approach the port from the north north west was approximately 159 clockwise from north the deviation of courses from this estimated from ship self reporting systems was typically less than 10 the water depth in part of the traffic separation scheme where the wakes of the approaching vessels could have originated fig 5 ranges from 40 to 70 m passenger vessels entering to port were travelling at 15 to 30 knots 1 1 1 knot is 1 852 km per hour in the mentioned area and therefore they are sailing at subcritical speeds even though the depth froude number for such speeds may reach values about 0 7 on average it was below 0 5 for these froude numbers the deviation of the geometry of the kelvin wedge from the deep water geometry is insignificant fig 3 the data were collected with multimodal pressure and inertial sensors called hydromasts fig 5 ristolainen et al 2019 in total 9 sensors were mounted with an equal horizontal spacing of 2 5 m on an aluminium frame s1 to s9 in fig 5 the frame was deployed at a depth of 3 m on the seabed with an orientation of 22 5 north to properly catch the single wake wave crests of the incoming vessels the frame was secured to the seabed with 8 mm metal bars and additional weights on the corners the hydromasts recorded the absolute pressure of the water column absolute pressure sensor in fig 5 and an estimate of the near bed water velocities using a calibrated relationship with the linear acceleration of the vibrating mast at the top of the device fig 5 this dataset has also been used for automatic vessel wake detection rätsep et al 2020b here however we only use the pressure data the pressure sensors were located near the bottom of the instrument and therefore the readings were obtained at 0 2 m above the seabed the measurement frequency for all the sensors was 100 hz 2 3 data conversion the spectrogram technique involved the conversion of the pressure data into water level elevation and subsequent implementation of the short time fourier transform the main focus was on the retrieval of the ship wake components from the frequency spectrum of the wave data therefore we did not concentrate on actual wave height values power values on the time frequency representation of the pressure data and the sensitivity caused by external sources to the data this technique is based on the process described by rätsep et al 2020b and is presented here only in summary form to provide a complete overview of the procedure the starting point is the geometry of the wake structure retrieved from the corresponding spectrogram based on torsvik et al 2015 and it essentially uses the existence of two asymptotes of the linear dispersion curve of ship waves as a first step outliers values that differed by more than three standard deviations from the mean pressure value were removed from the absolute pressure data an example of input data is given in fig 6 a the data stream originally measured in mv was converted into pressure p 0 pa by a calibration relation established in a test tank 10 p 0 27 1208 p 4475 72 with r 2 0 9 the height of the water column was calculated considering the average depth at the measurement site as h 3 m and the height of the sensor d s 0 2 m above the seabed as this area is microtidal with typical tidal amplitudes a few cm leppäranta and myrberg 2009 tide driven changes to the water depth are ignored the attenuation of water surface fluctuations in the water column was estimated using the relation dean and dalrymple 1991 karimpour and chen 2017 11 p 0 z h s p q ρ g h s ρ g η k p where p 0 is total pressure p is the mean water pressure q represents the water surface fluctuations h s is the depth of the sensor g is gravity acceleration ρ is the water density z is the depth of the sensor with positive values above the water level η is the water surface elevation and k p is the dynamic pressure to the surface elevation conversion factor dean and dalrymple 1991 karimpour and chen 2017 12 k p cosh k h z cosh k h cosh k d s cosh k h here the wavenumber k was calculated following the method proposed by goda 2010 this procedure of reconstruction of wave heights is not essential for our method and we only included it in order to keep the compatibility of our research with other studies that have tracked the water surface the frequency of pressure fluctuations in surface waves exactly matches the frequency of waves therefore possible errors of the conversion of measured data series into wave time series may only affect the wave heights but does not distort the location of high energy fluctuations on the linear dispersion curve wave data were downsampled to the frequency of 5 hz a short time fourier transform was applied in the frequency range of 0 005 0 6 hz periods from 5 3 to 200 s with a step size of 0 005 hz on a uniform scale using a hamming window function of 1024 data points with a length of 204 8 s or about 3 4 min and overlap of 1014 points 203 8 s with a 2 s step each application of the fourier transform produces a discrete representation of the frequencies of identified waves the maximum mismatch of the frequency of the relevant high energy point from the corresponding point of the linear dispersion curve depends on the retrieved frequency and decreases with the increase in this frequency this feature suggests that the asymptotes of the linear dispersion curve are better represented in the time frequency representation fig 4 finally the spectrograms from different sensors were normalised and merged following the idea of using ensemble averaging of the output of different sensors to increase the wake to background noise ratio rätsep et al 2020b the fourier transform does not introduce any systematic bias in the frequency of the retrieved high energy fluctuations however as all sensors are recording the same wave the process of merging the data from 9 sensors does not decrease the typical error in frequency retrieved from a single sensor 2 4 spectrogram analysis speed of the vessel and the distance travelled by the wake vessel localization requires knowledge of the position speed and course we approached the first part of this problem by determining the propagation direction and the distance travelled by its wake to the measurement location under the assumption that a ship sailed more or less with a steady speed and course the two other parameters speed and course were assessed during the analysis process we employed two different and independent techniques a spectrogram technique for finding the speed and the distance that the wake had travelled from its point of origin to the measurement site and a phase shift technique based on the time delays of the incoming wake at the pressure sensors in the grid for estimating the direction of the incoming wake from this information we derive a possible course on which the vessel sails ship wake signatures fig 6b were extracted from the spectrograms using peak detection analysis fig 6c and divided into the divergent and transverse components the speed of the ship and the distance travelled by the wake were determined using relations developed by torsvik et al 2015 and actually stemming from wu 1991 the main wake components used in this process were transverse waves pethiyagoda et al 2018 represented by the almost horizontal branch of an l like signature fig 6b the divergent waves are represented by an inclined branch in this signature in other words the frequency of transverse waves changes insignificantly after the cusp waves have arrived however the frequency of divergent waves varies substantially and almost linearly in this representation for the fixed observation location fig 4 such signals are often referred to as chirp signals or chirps sheremet et al 2012 the cusp waves were associated with the intersection of the two branches of the spectrogram figs 4 and 6b the width of these branches depends on the scale of the image that was tuned manually to achieve optimal extraction this width was also taken into account when estimating the possible errors of estimates of vessel speed and distance finally the features on spectrograms that reflect transverse and divergent components were fitted with straight lines fig 6c torsvik et al 2015 applied three approaches for determining the speed u of the vessel from the spectrogram they all rely on the frequency f of certain components of ship waves if the starting point of the branch for the diverging waves is well defined the ship s speed is torsvik et al 2015 13 u 3 2 g 2 π f c u s p where f c u s p is the frequency of cusp waves marker b in fig 4 this frequency matches the meeting point of the signatures of diverging and transverse waves that corresponds to the non dimensional frequency ω 3 2 in fig 4 alternatively it is possible to use the asymptotic value ω 1 of the signature of the transverse component of the ship wake if we denote the relevant frequency by f t the ship s speed is torsvik et al 2015 14 u g 2 π f t expressions 13 and 14 theoretically lead to the same results their applicability is however greatly different because of the sensitivity of the accuracy of the specification of the relevant frequency as the frequency of cusp speed corresponds to the vertical section of the linear dispersion curve even small errors in the estimates of cusp wave timing may lead to large errors in f c u s p the estimates of f t are evidently much more stable consistent with the described features the approach based on the signature of the transverse component generally leads to a better match of the estimates of the speed of the vessels compared to the ais information rätsep et al 2020a this conjecture is not unexpected as the location of the meeting point of the two branches is much more complicated to identify compared to the frequency of transverse waves for this reason only results obtained using eq 14 are considered in this study the distance from the point of origin of the wake to the sensor was estimated using the ship s speed u and the time interval δ t during which the frequency of the divergent component reached from the cusp wave frequency f c u s p to 2 times higher value 2 f c u s p torsvik et al 2015 to find δ t a linear fit was built for the divergent component the distance l to the measurement site from the point of origin of the vessel wake is torsvik et al 2015 estimated as 15 l 6 u δ t 2 5 detection of wakes to compare our results with actual sailing parameters from passing ships we used data from the vessel self reporting systems automatic identification system ais collected from the area marked in fig 5 vesselfinder 2020 the ais data were recorded on average with 5 min intervals for the majority of the vessels the data included the geographical location retrieved from a gps device timestamp name international maritime organisation number call sign course and speed vesselfinder 2020 in total 249 different vessels were identified with 101 275 ais readings the accuracy of the estimates of the vessel speed depends therefore mostly on the accuracy of timestamps these are normally provided with an accuracy of a few seconds and thus the ais based estimates of speed apparently have errors below 1 due to the relatively intense traffic wakes from several vessels often arriving at the measurement site less than 30 min apart we focused on single strong transverse and divergent component visible and extractable from spectrogram as shown in fig 6 wake events this approach means that we filtered out signals of wakes originating from departing vessels and multiple vessel cases therefore the cases were to some extent hand picked the ais data were sorted into single ship passing events a passing is defined here as a series of consecutive data points indicating the sailing trajectory and time stamps of a ship that passes the measurement site for each position in the passing a corresponding wake origin point was calculated based on the vessel course at that point the ship s position that had the smallest perimeter of a triangle with vertices at the measurement site the ais position and estimated wake origin was chosen as the reference of that particular passing those positions were matched with wake readings we focused on situations where there was only a single vessel within 3 7 km 2 nmi 2 2 nmi is denoted as nautical mile 1 nmi is 1 852 km of the measurement site and travelling faster than 15 knots in a time window of 15 min from the wake event as the closest ais location to the wake origin point on the vessel track may have been before reaching it or after passing it wakes from the vessels sailing below 15 knots were not detected mostly because they were indistinguishable from the background wind waves examples of weak wakes overlapping wakes and single detectable wakes are given in fig 7 fig 7a and d correspond to m s seawind slowing down from its transit speed of 15 knots as it approached the port of tallinn change from solid line to dashed line in fig 7a even though it was a single vessel passing the measurement site in the 30 min window fig 7a the wake structure was not extractable from the spectrogram without additional filtering fig 7d due to the low signal to noise ratio snr therefore this and similar cases were discarded the second case depicts a rush hour near the measurement site two vessels m v hsc express from helsinki from the north and mv victoria i from mariehamn from the north west were entering port more or less at the same time fig 7b two solid lines passing the measurement site this results in two wake structures visible in the spectrogram fig 7e as the determination of the branches of the relevant wave systems and therefore also sailing characteristics of a particular vessel from this pair are complicated without further analysis cases like this were excluded from our analysis the last pair fig 7c and f shows an example of events selected for this study a single vessel m v megastar at 25 knots approached the port of tallinn solid line in fig 7c ais data indicate that this time window contains also two other vessels a patrol boat operated by the estonian police and a border guard board entering the harbour and passing the measurement site with speed less than 15 knots and a yacht sailing up north outside the 2 nmi area despite this additional traffic the spectrogram fig 7f contained only a single discernible wake event with divergent and transverse component visible for extraction these constraints left 70 passings for analysis these vessels were passenger craft ro ro ferries such as m v star and m v superstar and high speed craft like m s hsc express and m s supercat entering the port of tallinn 2 6 the direction of the incoming wake and the travelling course of the vessel the direction of the incoming wake was estimated using the same pressure data but utilized a somewhat different approach outliers were removed in the same manner as described previously instead of down sampling and correcting the data fluctuations were filtered out using a 9th order butterworth filter to ease the estimation of the time delays due to high noise levels and small time shifts of the approach of the wake at different sensors a maximum of 1 6 s at s1 and s9 in fig 5 a relatively large time window 15 min was used to achieve reliable values of the cross correlation this duration matches the typical length of the wake signal figs 6 and 7 to reduce the effect of noise delays were calculated between all possible sensor pairs in total 36 pairs using sensors s1 to s9 from the instrument grid in fig 5 for each pair two possible directions were found using the time delay and the distance between the sensors based on the positions of each pair and wake wave speed of 4 3 m s this phase speed corresponds to transverse waves with a typical period of 7 s in 3 m deep water this resulted maximum of 72 possible combinations for 36 sensor pairs as an example in fig 8 as 36 directions from the 72 were misleading x2 to x15 in fig 8a and around half 16 18 of the sensor pairs were positioned perpendicular to the wavefront for example sensor pairs s1 s4 s4 s7 s1 s7 if the source was x1 in fig 8a which produced high alterations of the found direction then only 18 to 20 directions from the sensor pairs that were more or less parallel to the wavefront for example s1 s2 s2 s3 s1 s3 in fig 8a out of 72 could be considered when finding the actual wave direction for these reasons we applied a histogram analysis carlotto 1987 to determine the population of the angles that could be used to find the wake direction an example is shown in fig 8 as selected bin the actual direction of the incoming wake was calculated as an average of that population with a standard deviation multiplied by 2 indicating the level of uncertainty at 95 indicated with black solid and dashed lines in fig 8 as the location of the devices was chosen in a coastal segment that had an orientation more or less parallel to most of the approaching crests of ship waves shallow water refraction of waves is not taken into account the relevant correction for situations when waves approach the shoreline under larger angles is straightforward but not done here because the intensity of refraction only depends on the wave period finally the courses of the vessels were calculated based on the assumption that vessels were sailing in the deep water regime with a travelling angle of the cusp waves of 35 16 to the calculated direction of propagation of the incoming wake waves this resulted in two different courses one based on the starboard side branch of the vessel wake and another on the port side branch fig 2 as the presented approach for vessel localization based on its wake is confined to a single point on the sailing path one point wake readings do not provide information to decide which of the two proposed courses is the right one this situation is characteristic for various methods of detection of wave propagation direction that define the line along which waves propagate but leave 180 degree ambiguity of the direction engen and johnsen 1995 a possible way forward is to use two clusters of sensors similar to the idea of using two subsequent synthetic aperture radar images to determine the wave propagation direction ouchi et al 1999 the flow chart of the entire analysis process for vessel localization is presented in fig 9 the comparison positions fig 9 used the wake source locations from the ais data as discussed in section 2 5 and calculated positions using the distance from the spectrogram analysis section 2 4 and the direction of the incoming wake section 2 6 the comparison of the vessel sailing speed fig 9 involves the speed from the ais position from the wake source point was derived and the speed value from the spectrogram analysis section 2 4 comparison of the vessel courses fig 9 incorporates differences between the course of the ais position from the wake source point was found and the course derived from the phase shift analysis section 2 6 3 results 3 1 vessel positions we start from the comparison of calculated wake source points with vessel positions derived from the ais data an example of the position calculations is given in fig 10 where m s megastar is approaching the port of tallinn along the track marked by the ais data 30 min of ais track is also shown in fig 7c the spectrogram is presented in figs 6b and 7f initial data in fig 6a and direction estimation in fig 8b the dashed line in fig 10 indicates the track and the dots show the instantaneous vessel positions the square indicates the wake source point on the vessel s path with a circle around it indicating a possible area of uncertainty based on speed and course alterations in this case they are less than 2 7 km apart as calculated from the location closer to the port the distance between the vessel position at the time of wake generation and the closest ais position varied from 5 m to 3 km depending on the availability of the ais data and the sailing speed of the ship the typical interval between the ais positions was around 5 min the calculated vessel position based only on the measurement data a rhombus in fig 10 is estimated to be at 3 9 km from the measurement device the difference between the estimated wake source point and the associated ais position is about 400 m in 49 cases out of 70 in this study as indicated in fig 11 the estimated ship position was less than 1 4 km from the calculated wake origin point in most of these cases 48 the points were closer than 1 km and on 35 occasions less than 600 m location comparison between calculated results and the wake source points retrieved from ais data for all the applicable cases 49 is shown in fig 12 the bias between longitudinal coordinates was 59 m with a standard deviation sd of 237 m and the sd between the latitudinal coordinates was 490 m with a bias of 4 m the average distance between calculated locations and the measurement site was on average 3 2 km with a standard deviation of 0 5 km from the viewpoint of vessel localization the presented technique failed to estimate the position if the difference between the estimated wake source point and the associated ais position was larger than 1 4 km this criterion is somewhat arbitrary and is based on the perception that errors larger than this value may locate the ship either to dry land mazaheri et al 2014 the proportion of failures 21 out 70 was less than 1 3 of the entire set of events from these in 11 cases the direction was not properly resolved from the phase shift technique on 6 occasions the interpretation of wake components in spectrograms was problematic and on 4 occasions problems occurred with both aspects of the presented techniques actual numbers of successful attempts are shown in fig 11 the accuracy of the proposed method was evaluated in terms of an area of uncertainty a dotted line around the rhombus in fig 10 using the spread of data points used by both methods as discussed in 2 4 and 2 6 the length of this area from the line 1 to 3 in fig 10 represents the uncertainty of the distance estimation its width reflects the uncertainty of estimates of the wake components extracted from the spectrogram fig 6c in particular the width from the line 2 to 4 in fig 10 comes from the sensor pair selection process determination of the principal direction for finding the propagation direction of the incoming wake as illustrated in fig 8 the area depicted in fig 10 is 2 8 km long uncertainty of distance estimation from the line 1 to 3 in figs 10 and 2 km wide uncertainty of the computation of the direction from the line 2 to 4 in fig 10 this size of the uncertainty area is typical for most of the 49 successful cases the average area of uncertainty was 1 7 km distance long with sd of 0 85 km and 1 9 km direction wide with sd of 0 46 km the wake direction fluctuations were usually within width of the area 16 the distance length of the area was estimated as varying by an average of 0 86 km from the spread of the data points that contributed to the analysis process 3 2 speed and course of the vessels vessel localization requires estimates of the speed and course of the vessel the results of estimates are depicted in fig 13 and fig 14 the speed estimation was performed successfully in 64 cases fig 11 for which the spectrogram technique was applicable using eq 14 six cases were removed due to a high level of noise which resulted in difficulties when extracting the transverse component automatically the results match vessel speed well at the closest position from the ais data r 2 0 81 whereas standard deviation between the reference ais values and calculated speed was 1 60 knots and bias 0 833 knots consistent with the results in rätsep et al 2020a the speed calculations based on an approximation of the transverse component generally produced adequate results it only occasionally underestimated or overestimated the ais based speed an example of underestimation is point a in fig 13 the m v viking xpress approached at 20 6 knots but our method provided an estimate of the speed of 14 8 knots other methods analyzed in torsvik et al 2015 gave 22 5 knots using the highest energy value as the cusp wave point and 21 5 knots taking the beginning of the divergent wave component for the cusp wave point the most severe overestimation point b in fig 13 occurred when m s supercat was approaching the port at 28 9 knots our approach resulted in an estimate of 34 4 knots whereas the two other methods gave 35 4 knots and 32 2 knots respectively the possible vessel courses were computed by applying the travelling angle of the cusp wave to the opposite direction of the incoming wake as discussed above in the current setup we did not have methods available to estimate which of the two branches port or the starboard side as depicted in fig 2 of the wake reached the measurement site for this reason we calculated possible courses for both situations the orientation of the vessel sailing line was calculated using the 55 cases fig 11 when the wake direction was successfully estimated based on the known angle between the propagation direction of the wake and the sailing line fig 2 the vessel courses from the ais were around 159 10 one set of these orientations set 1 in fig 14 matched well usually within 10 standard deviation from the differences was 3 28 and bias 0 846 the vessel courses evaluated from the ais data this corresponds to the actual situation as the vessels approaching port were north north east from the measurement site when the wake was generated meaning that the measurement site received the starboard branches of their wakes the alternative orientations obtained from the wake direction set 2 in fig 14 which correspond to a port side branch of the wake are about 70 two times of the cusp wave travelling angle of 35 16 with a standard deviation of 3 28 and bias of 71 4 from the actual vessel course in our case this set could be ruled out due to two arguments firstly the general orientation of the traffic separation scheme near the measurement site is 159 339 whereas set 2 proposes courses around 230 secondly the pikakari peninsula lies to the west of tallinn bay which means that if the vessel had approached at a course determined by set 2 then it would have passed a peninsula either dangerously close without considering course changes or grounded near it more generally the magnitude of the offset 70 between the two possible orientations of the sailing line apparently makes it often possible to select the true course in most nearshore applications simply because the other orientation is not feasible 4 discussion since the first application of the spectrogram technique for the interpretation of ship wake measurements sheremet et al 2012 there have been several developments to determine sailing characteristics speed and distance from the measurement location along with the sailing regime torsvik et al 2015 pethiyagoda et al 2017 2018 all these studies rely on the fundamental properties of the ship wave system that are invariant to the distance from the sailing line and the speed of the ship unless the depth froude number exceeds the value of about 0 75 the set of such properties is particularly simple in the spectrogram representation where the two branches of the wake signal rapidly approach well defined asymptotes the adequacy of the retrieved properties therefore basically depends on the capacity of the wake recording systems to extract at least a small set of wave components that allow the reconstruction of these asymptotes in this work we evaluated if a vessel could be positioned and its sailing parameters determined based on one point information that does not include any information on the vessel movement along its course we combined the spectrogram technique to estimate the speed and distance of the passing vessels torsvik et al 2015 extended to the use of pressure data in the nearshore rätsep et al 2020b with a phase shift cross correlation technique to determine the direction of the incoming wake to estimate the vessel s position and course we demonstrated that this approach produced results comparable with the actual data derived from the vessel self reporting systems the techniques used here were highly sensitive to background noise even though some parts of the techniques including the construction of spectrograms is robust it was difficult to obtain suitable wake structures from spectrograms when the vessel was travelling at less than 15 knots rätsep et al 2020a and thus produced very low waves it is also natural to expect that the technique will fail when wind wave background with a substantial proportion of energy in the frequency range of ship wakes masks the wave signal therefore additional means such as convolution techniques should be implemented to extend the developed technique to slower and or smaller vessels that produce relatively small waves and for situations that involve strong wind seas it is likely that the spectrogram technique will still work well in strong swells or short period wind seas where the ship waves have periods different from background periods however as the height of cusp waves decreases as r 1 3 with distance from the fairway even the signal of very large ship waves will be untraceable at very large distances another intrinsic limitation of the presented technique is that substantially relies on the properties of transverse waves as the wake of very fast vessels in shallow waters supercritical wake contain only diverging waves the entire approach is not applicable for the evaluation of vessel distance speed or course for vessels travelling at supercritical speeds as such wakes contain a large proportion of nonlinear waves their wake structure is much more complicated in the spectrogram representation pethiyagoda et al 2017 the developed technique is only directly applicable for single wakes only one wake structure present in the 30 min window however in high traffic regions wakes from several ships sailing with different speed and course may arrive at the measurement devices at the same time as seen on multiple occasions in the tallinn bay experiments this makes the extraction and use of the wake structures in the spectrograms questionable compounded by the effects of interference when applying the phase shift analysis to determine wake direction however a feasible way forward is to use convolution techniques implemented in routines for acoustic localization of multiple ships byun et al 2019 most of the relevant experiments have been conducted in relatively shallow water areas to detect highly powered passenger vessels and analyze the effects of their wakes on the coastal environment torsvik et al 2015 our approach can be even more useful for security and surveillance operations to raise situational awareness in coastal regions where using usual means of vessel detection and localization is too resource demanding aiello et al 2019 or is challenged by intentionally removed localization instrumentation dumitriu et al 2018 we only note that the presented method needs to be modified for shallow regions to incorporate information about wave refraction this change is technically complicated as it must involve ray tracing for each ship wave component but conceptually it is straightforward as refraction intensity only depends on the wave period and water depth however we have also identified a range of problems the maximum possible detection localization distance remains unknown we were able to position a large proportion of passing vessels by their wakes at an average distance of 3 2 km because of two favourable features firstly the local traffic separation scheme guarantees that vessels sail along a prescribed waterway secondly the experiment recorded only passenger ships entering the port to test further distances we need to test this method in an area which is much wider than the approach to the port of tallinn in addition to these problems the developed technique can be complemented by introducing methods for determining the speed and course alterations pethiyagoda et al 2017 2018 2018 another natural extension would be to determine whether ship recognition the third step of the picture building process nato standardization agency 2015 based on their wakes is possible at large scales however the main message of this study is that a vessel monitoring system solely based on the wake information in the wave recordings is practically possible this message is important due to several developments such as the growing number of unmanned marine autonomous surface ships operating in coastal regions or e g refugee vessels which intentionally remove on board localization instrumentation dumitriu et al 2018 we are optimistic as these first results show that vessel localization based on the wake measurements is technically feasible an exciting improvement to the technique used here is that it can be combined with automatic wake detection rätsep et al 2020b these are the first two steps of the picture building process nato standardization agency 2015 needed to improve the situational awareness of naval operations what makes this method preferable for traffic monitoring is that the sensing array can be easily concealed in our case it was set near the beach at a depth around 3 m therefore no special equipment ship or boat were required 5 conclusion the objective of this work was to determine whether vessel localization position speed and course of a ship may be achieved by using wake measurements from a closely spaced array of underwater pressure sensors a grid of 9 sensors was deployed with a horizontal offset of 2 5 m at the depth of 3 m single ship wakes were manually selected from the continuous recording using 30 min windows the properties of the ship movements were matched to ais vessel data a spectrogram technique was implemented for calculating the speed of the passing ship and the distance travelled by the wake the core new developments are the systematic use of the concept of asymptotes of the linear dispersion relation to determine some parameters of the vessel motion and the demonstration that phase shift cross correlation analysis can retrieve the possible courses on which a vessel could be sailing from the direction of the incoming wake we showed that wake data from pressure sensors can be used for surface vessel localization with a positioning error less than 600 m in 50 of the cases credit authorship contribution statement margus rätsep conceptualization methodology formal analysis writing original draft writing review editing kevin e parnell conceptualization writing original draft writing review editing tarmo soomere conceptualization methodology writing original draft writing review editing maarja kruusmaa conceptualization investigation writing original draft asko ristolainen resources investigation writing original draft jeffrey a tuhtan resources investigation writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the estonian ministry of education and research estonian research council grants prg1129 and put 1690 and the european regional development fund program mobilitas pluss reg nr 2014 2020 4 01 16 0024 project mobtt72 and co supported by the estonian center of excellence excite the estonian research infrastructures roadmap object infotechnological mobility observatory imo and the european economic area eea financial mechanism 2014 2021 baltic research programme project emp480 solutions to current and future problems on natural and constructed shorelines eastern baltic sea 
