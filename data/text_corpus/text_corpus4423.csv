index,text
22115,in this paper uncertainty quantification of hydrodynamic forces on the dtc model advancing in shallow water waves is studied first verification and validation v v and uncertainty quantification uq in uncertainty analysis for cfd simulation are compared a state of the art method for uq problems the non intrusive polynomial chaos nipc method is introduced and validated to be effective by studying a stochastic function together with the monte carlo mc method then nipc method is applied to quantify the uncertainty of the resistance heave motion and pitch motion of the dtc model in shallow water waves computations are performed with the cfd software star ccm the uncertainty induced by waves treated as stochastic variables with gaussian distribution is studied uq results obtained by mc method and nipc method are compared with the benchmark data the results obtained by nipc method show better agreement with the benchmark data than those by mc method keywords uncertainty quantification polynomial chaos method monte carlo method cfd shallow water waves nomenclature a wave amplitude m b breadth of the ship m c coefficients of polynomial chaos c b block coefficient d dimension of stochastic variables f nh depth froude number gm metacentric height m i xx moment of inertia about ox axis kg m2 i yy moment of inertia about oy axis kg m2 i zz moment of inertia about oz axis kg m2 k wave number m 1 l pp length between perpendiculars m m mass of the ship kg n runs number of cfd runs n c number of coefficients in pce p order of pce t design design draught m t e encounter period s u uniform distribution x g longitudinal coordinate of the centre of gravity m x longitudinal force on the hull n y dimensionless wall distance z heave motion m z g vertical coordinate of the centre of gravity m δ nm kronecker delta function θ pitch motion rad λ wave length m μ expected value ξ stochastic variable σ standard deviation φ polynomial chaos ψ polynomial chaos aiaa american institute of aeronautics and astronautics asme american society of mechanical engineers cdf cumulative distribution function cfd computational fluid dynamics dfbi dynamic fluid body interaction dtc duisburg test case ev expected value fvm finite volume method ipc intrusive polynomial chaos ittc international towing tank conference lhs latin hypercube sampling mc monte carlo nipc non intrusive polynomial chaos pc polynomial chaos pce polynomial chaos expansion pdf probability density function rans reynolds averaged navier stokes rao response amplitude operator sa sensitivity analysis sd standard deviation ukc under keel clearance uq uncertainty quantification v v verification and validation vof volume of fluid 1 introduction along with the rapid development of computer science and technology computational fluid dynamics cfd technology has been widely and successfully applied in industrial production and scientific research however the quality and credibility of cfd is always a concern verification and validation v v is a useful method for cfd uncertainty analysis verification is to analyze the numerical error in order to ensure the accuracy of numerical methodology validation is mainly to find the modelling errors by comparing the simulated results with experimental ones in the procedure of v v all results are evaluated in conditions of deterministic factors aiaa 1998 provided guidelines and asme 2009 set a standard for v v in cfd ittc 2008 established v v procedures for cfd simulation of ship hydrodynamics eça and hoekstra 2009 investigated the estimation of the numerical uncertainty using grid refinement studies with the method of manufactured solutions they mainly studied three problems of uncertainty evaluation the estimation of the iterative uncertainty the influence of the iterative error on the estimation of the discretization uncertainty and the overall numerical uncertainty eça and hoekstra 2014 presented a procedure for estimating the numerical uncertainty of cfd calculations based on grid refinement studies actually there is a great deal of nondeterministic factors in the real physical problems such as fluid properties boundaries variation of geometry the cumulative effect of these uncertain factors may have a large impact on the results obtained by cfd calculations for these reasons it is necessary to estimate the uncertainty of the system response the main work of uncertainty quantification uq is to characterize the impact of stochastic input parameters on the model quantitatively in other words uq focuses on the statistical characteristics of the response variables such as expected value ev standard deviation sd skewness kurtosis cumulative distribution function cdf and probability density function pdf as a consequence of a set of uncertain input variables with known distribution diez et al 2014 traditional methods for studying uq problems can be divided into two types one is non statistic methods such as sensitivity analysis sa moment methods and perturbation method which are suitable for solving the linear uq problems the other is statistic methods where the most famous one is monte carlo mc method mc method is technically feasible to solve uq problems with large degrees of uncertainty but not efficient in recent years a state of the art method polynomial chaos expansion pce is employed in uq problems which is derived from homogeneous chaos method proposed by wiener 1938 and developed by ghanem and spanos 1991 in solid mechanics field pce method can be divided into intrusive method and non intrusive method according to whether it is necessary to modify the solver intrusive polynomial chaos ipc method requires significant modifications to the solver hence it was only applied to one two dimensional stochastic problems to overcome the difficulties and complexities of ipc method non intrusive polynomial chaos nipc method has been proposed and developed the solver is treated as a black box in nipc method the output variables of interest are expanded in polynomial chaos with unknown polynomial coefficients which can be obtained by projection method or regression method the former is based on a numerical integration the latter performs a regression analysis based on a selected set of points recently several research groups applied this method to cfd field xiu and karniadakis 2002a used galerkin projections and extensions of wiener s pce to solve stochastic differential equations xiu et al 2002 studied the uncertainty propagation in fluid structure interactions using a generalized polynomial chaos method and xiu and karniadakis 2002b 2003 used the same method to model the input uncertainty and its propagation in incompressible flow simulation and steady state diffusion simulation respectively loeven et al 2007 introduced the probabilistic collocation method and used it to solve one dimensional stochastic piston problem together with pce method the uncertainty in stochastic steady flow around a naca0012 airfoil was quantified using probabilistic collocation method loeven 2010 verified the effectiveness of probabilistic collocation method for uq problems via several stochastic cfd cases mathelin and hussaini 2003 presented a method which combines pce method with karhunen loeve decomposition and applied it to a stochastic problem of a quasi one dimensional nozzle flow mathelin et al 2005 discussed two methods for uq problems pce method and stochastic collocation method the results showed that both methods can handle uncertainty propagation efficiently lacor et al 2013 studied three uq problems in cfd field using ipc method supersonic flow in a nozzle lid driven cavity flow and transonic flow in the nasa rotor 37 hosder et al 2006 implemented nipc method to solve two stochastic two dimensional flow problems hosder et al 2007 discussed the effect of three sampling methods random latin hypercube and hammersley when nipc method was applied to solve uq problems hosder and walters 2010 introduced nipc method and studied three uq examples in cfd field salehi et al 2017a presented an efficient approach to stochastic cfd problems they reconstructed the sparse representation of pce using the compressed sensing theory to solve challenging uq problems salehi et al 2017b quantified the uncertainties on the characteristics of turbulent flow in rectangular pipe and asymmetric diffuser using karhunen loeve expansion and nipc method wang and kang 2010 implemented ipc method for a two dimensional compressible stochastic navier stokes equations to demonstrate the uncertainty propagation of a lid driven cavity flow wang et al 2013 presented a robust aerodynamic optimization method based on nipc method and multi objective genetic algorithm schmelter et al 2015 predicted the influence of uncertain inflow conditions in pipes using pce method ahlfeld and montomoli 2017 proposed an efficient method for uq problems based on sparse pce method and studied the uncertainty propagation in turbomachinery as for ship hydrodynamics some scholars have carried out researches he et al 2013 applied one dimensional nipc method to quantify the uncertainties of hydrodynamic performance of the delft catamaran 372 taking into account the effects of geometrical operational and environmental randomness the results showed the feasibility and effectiveness of nipc method for robust design optimization and reliability based design optimization in the field of ship hydrodynamics stern et al 2017 provided an overview of uq and validation methods for industrial problems in ship hydrodynamics field the hydrodynamic performance of a ship will change dramatically when entering shallow water due to the hydrodynamic interaction between the hull and the seabed it is of great significance to investigate the behaviour of ships in shallow and confined navigation areas such as rivers harbors dredged channels and other coastal areas nowadays cfd technique has been applied in study of ship s hydrodynamic performances in restricted waters jachowski 2008 investigated the restricted water effects on ship motion using commercial cfd software fluent senthil and chandra 2013 estimated the resistance of a river sea ship in shallow water based on cfd method carrica et al 2016 studied the performance of kcs container ship in a zigzag test under shallow water condition both experimentally and numerically deng et al 2016 simulated four different pure sway yaw tests in shallow water using their in house numerical solver isis cfd code and the predicted results were compared with the benchmark data liu et al 2016 simulated the viscous flow around the dtc model manoeuvring in shallow water simulations of static drift and pure sway tests at 20 ukc were carried out tezdogan et al 2016a analyzed the dtc model s hydrodynamic performance under different ship draughts with different speeds using the cfd software star ccm and the squat results were compared with experimental data tezdogan et al 2016b conducted a series of simulations of shallow water waves to investigate a full scale large tanker s characteristics and studied the ship s heave pitch motion in head waves at zero speed and various water depths and found that the shallow water effect was an important cause of the vertical movement of the hull terziev et al 2018 investigated the behaviour of dtc model when advancing through restricted shallow waters using three methods cfd slender body theory and empirical method the results showed that there were significant differences in the computed parameters for the ship entering confined waters although the above work is important and excellent the uncertainty induced by stochastic parameters is ignored in this paper the regression based nipc method is applied to stochastic problems related to ship s hydrodynamic performances in shallow water it focuses on uq for the numerical predictions of resistance and motion of the dtc model in shallow water waves normally there are two parts in solving uncertainty quantification problems the first one is to determine the distribution of random input parameters from the reliable data the second one strives to quantify the propagation of uncertainty this paper focuses on the second part 2 mathematical models of uq 2 1 definition of uq problems uq problem is defined as a problem to quantify the uncertainty of response y 1 y f x t ξ where ξ ξ 1 ξ 2 ξ d t is a vector of uncertain input parameters with known joint probability density function p ξ according to the homogeneous chaos theory if the stochastic input variables ξ j j 1 2 d are independent the response y can be expressed as 2 y a 0 φ 0 i 1 1 d a i 1 φ 1 ξ i 1 i 1 1 d i 2 1 i 1 a i 1 i 2 φ 2 ξ i 1 ξ i 2 i 1 1 d i 2 1 i 1 i k 1 i k 1 a i 1 i k φ k ξ i 1 ξ i 2 ξ i k where a x t are functions of deterministic space x and deterministic time t and φ ξ are multivariate polynomials of stochastic variables ξ for a simple use in mathematical formulas the form of equation 2 can be expressed as 3 y i 0 c i ψ i ξ there are one to one correspondences between each polynomial coefficient a and c each orthogonal polynomial φ and ψ mollon et al 2010 in order to solve the uq problem the polynomials are truncated by dimension d 4 y ˆ a 0 φ 0 i 1 1 d a i 1 φ 1 ξ i 1 i 1 1 d i 2 1 i 1 a i 1 i 2 φ 2 ξ i 1 ξ i 2 i 1 1 d i 2 1 i 1 i d 1 i d 1 a i 1 i d φ d ξ i 1 ξ i d i 0 n c 1 c i ψ i where n c is the number of unknown coefficients pce is defined as a polynomial approximation as in equation 4 where ψ ξ satisfies orthogonality to the weight functions 5 ψ n ξ ψ m ξ ψ n 2 ξ δ n m where δ nm is the kronecker delta function the inner product can be defined as 6 ψ n ξ ψ m ξ ψ n ξ ψ m ξ p ξ d ξ where p ξ is the joint probability density function under the assumption of independent stochastic input variables ξ p ξ can be expressed as 7 p ξ i 1 d p i ξ i where p i ξ i is the probability density function of ξ i it can be seen from equation 4 the number of coefficients needed to be calculated is n c given in equation 8 8 n c 1 p p 1 p 1 p 1 2 p 1 d p 1 d p d p d 2 2 orthogonal polynomials pce was originally developed for the hermite polynomials and the gaussian distribution the convergence rate of hermite polynomial chaos is optimum for the gaussian processes salehi et al 2017a as shown in equation 6 orthogonal polynomials have to be reconstructed for each distribution xiu and karniadakis 2002a developed the wiener askey polynomial chaos to deal with more kinds of stochastic variables as shown in table 1 for example the multidimensional legendre polynomials with respect to a second order pce and two random variables ξ ξ 1 ξ 2 t u 1 1 are 9 ψ n 1 ξ 1 ξ 2 1 2 3 ξ 1 2 1 ξ 1 ξ 2 1 2 3 ξ 2 2 1 2 3 projection based nipc method the main idea of projection based nipc method is to use galerkin projection to calculate the coefficients 10 y ˆ ψ k ξ i 0 n c 1 c i ψ i ξ ψ k ξ equation 10 can be transformed as follows because of the orthogonality 11 y ˆ ψ k ξ c k ψ k 2 ξ hence the polynomial coefficients can be expressed as 12 c k 1 ψ k 2 ξ y ˆ ψ k ξ p ξ d ξ the expression involves high dimensional integrals which requires an efficient numerical integration technique 13 c k 1 ψ k 2 ξ w j p ξ j f ˆ x t ξ j ψ k ξ j where w j are weights and ξ j are abscissas in a quadrature scheme for different numerical integration technique different weights and abscissas are needed such as gauss hermite quadrature clenshaw curtis quadrature leja quadrature however such numerical integration techniques suffer from the curse of dimensionality and are time consuming though sparse grid quadrature rules can be used projection based nipc method is efficient for problems with limited input variables while regression based nipc method is viable for problems with a large number of input variables 2 4 regression based nipc method regression based nipc method requires a certain number of sampling points where the responses are computed the number of sampling points m should be more than the number of unknown coefficients n c the over determined system can be expressed as follows 14 ψ 0 ξ 1 ψ n c 1 ξ 1 ψ 0 ξ m ψ n c 1 ξ m c 0 c n c 1 f ˆ x t ξ 1 f ˆ x t ξ m or in a compact form 15 ψ c y the vector of unknown coefficients c can be determined using the least square approach 16 c ψ t ψ 1 ψ t y compared to projection based nipc method the regression based nipc method requires well placed random sampling points instead of quadrature abscissas the influence of the number of sampling points can be analyzed by the oversampling ratio n p defined as 17 n p number of sampling points n c the oversampling ratio of 2 gives a better approximation at each polynomial degree hosder et al 2007 2 5 workflow of nipc method the workflow of uq for cfd problems using nipc method is summarized in fig 1 it is implemented in the following steps step 1 determine the distribution of random input variables and then compute the orthogonal polynomials it is very difficult to obtain the distribution of all random variables accurately it is necessary to assume that the random variables are independent and the distribution is known if the distribution is conventional the orthogonal polynomials can be chosen from table 1 otherwise three term recursion should be conducted step 2 compute the points where the responses will be calculated using cfd method in projection based nipc method quadrature points and quadrature weights have to be solved while in regression based nipc method random sampling points should be well placed by effective sampling methods step 3 calculate the responses of interest for each points by cfd this calculation is most time consuming on one hand many points are needed in the case with high order of pce and multidimensional random variables on the other hand the calculation costs a lot and there may be a lot of output parameters of interest for each point step 4 evaluate the coefficients and then compute the statistical characteristics of output parameters such as ev and sd after solving the coefficients via projection based or regression based nipc method the ev and sd of output variables of interest can be evaluated based on equations 18 and 19 other statistical characteristics such as cdf and pdf can be reconstructed by using mc method 18 μ x t c 0 x t 19 σ 2 x t i 0 n c 1 c i 2 x t ψ i 2 ξ 2 6 comparison of mc method and nipc method mc method is a famous algorithm that uses random numbers to solve computational problems it is considered as a very effective method especially when it is difficult or impossible to use other methods mc method is widely used in optimization numerical integration and probability problems as for uq problems in cfd the main steps of implementing mc method are 1 determine the distribution of random variables 2 generate sampling points using mc method 3 perform cfd calculations at the sampling points 4 obtain the statistical properties such as ev and sd by statistical analysis of cfd results the ev and sd obtained by mc method are expressed as 20 μ x t f x t ξ n runs 21 σ 2 x t f x t ξ μ x t 2 n runs where n runs is the number of cfd runs as mentioned above the first three steps using mc method are necessary in applying regression based nipc method to uq problems as for post processing instead of statistical analysis of cfd results regression based nipc method solves a linear system based on the selected sampling points using least square method as two methods for uq problems mc method and nipc method have the following characteristics both methods do not need to change the solver while ipc method requires much modifications of the codes mc method is straightforward and simple it has a wide range of applications in science and is easy to implement however it requires a lot of computing resources and is usually not feasible for many practical engineering problems therefore mc method is often regarded as a final resort to solving engineering problems recently nipc method has drawn attention of a lot of researchers because of its high accuracy and low computational cost it is more feasible from the engineering point of view 3 sampling methods in this paper latin hypercube sampling lhs giunta et al 2003 is used to generate sampling points it is a stratified sampling method for generating sampling points from a multidimensional distribution in statistical sampling the latin square array refers to a square matrix with only one sample per row and column the latin hypercube is a generalization of the latin square in a multidimensional way each hyperplane perpendicular to the axis contains at most one sample assuming that there are n variables each variable can be divided into m intervals with the same probability then m sample points satisfying the latin hypercube condition can be selected it should be noted that lhs requires the same number of partitions for each variable as m however this method does not require that the number of samples m increases as the number of variables increases 4 case for study 4 1 geometry and main particulars dtc is a 14 000 teu container ship with a single propeller a bulbous bow large bow flare and a transom stern el moctar et al 2012 the hull lines and profile view of dtc are shown in fig 2 in this paper the bare hull of dtc model with a scale ratio 1 88 11 is selected for the simulation main particulars of the dtc model are listed in table 2 4 2 conditions of simulations the conditions of simulations in table 3 are determined by the benchmark test case of the 5th mashcon conference van zwijnsvoorde et al 2019 in this paper the wave height and wave period are treated as stochastic variables with gaussian distribution the specific values of the wave height and wave period are obtained by the lhs method if the polynomial chaos is expanded to 1st order six sampling points are required with respect to two random variables as shown in table 4 5 cfd method 5 1 governing equations and physics modelling in the simulation of the model tests the flow is treated as a three dimensional flow of incompressible viscous fluid the governing equations are the reynolds averaged continuity equation and reynolds averaged navier stokes rans equations cfd computations are performed with the general software star ccm where finite volume method fvm is used the continuity equation and rans equations are linked by using a predictor corrector approach in the solver the sst k ω turbulent model is used to close the governing equations second order upwind scheme is applied to discretize the convection terms the overall solution is implemented by simple algorithm the volume of fluid vof method is adopted to model the free surface in this paper linear wave is adopted dynamic fluid body interaction dfbi module is used to simulate the ship motion the dfbi module enables the solver to calculate the hydrodynamic forces on the ship model and solve the governing equations of rigid body motion the dfbi morphing module in the solver is adopted 5 2 computational domain and boundary conditions to solve a physical problem by cfd method it is necessary to define the initial and boundary conditions depending on the mechanisms in the problem in order to obtain accurate results the computational domain and boundary conditions with the dtc model are shown in fig 3 the inlet boundary and outlet boundary are positioned 1 5l pp and 3 0l pp ahead and behind the hull respectively a velocity inlet boundary condition is set on the inflow plane where head waves are generated the outflow plane is modelled as a pressure outlet which can prevent backflow and keep accurate static pressure the top boundary is located 0 5l pp above the undisturbed free surface and is also modelled as a velocity inlet for purpose of numerical efficiency and convergence the positions of the bottom and side boundaries are consistent with the model tests corresponding to the tank bottom and side walls these boundaries are set as a moving no slip wall the ship hull is set as the no slip wall since only the case of the ship in forward motion along the centre line of the tank is considered the flow field on both sides of the ship is symmetrical it is reasonable to consider only half of the ship and flow field to reduce the computational burden correspondingly the vertical plane that coincides with the longitudinal centre plane of the hull is modelled as a symmetry boundary the vof wave damping module is applied in order to prevent wave reflection the damping length is set approximately 1 5l pp 5 976 m 5 3 mesh generation the trimmed cell mesher in star ccm is used to generate mesh which is a useful tool for producing a high quality unstructured hexahedral grid the mesh in the area around the hull and the expected free surface elevation is refined progressively in order to capture the complex flow features appropriately prism layer mesher is used to generate boundary layer grids adjacent to the hull surface the tank bottom and side walls the y value for the hull surface is less than 1 while the y value for the bottom and side walls is larger than 30 fig 4 provides a cross sectional view of the mesh inside the computational domain fig 5 depicts the entire view of the mesh around the free surface the free surface mesh has refined in the areas where the kelvin waves are expected fig 6 displays the surface mesh on the bow and stern of the hull the mesh density on the surface of the bare hull is refined in order to capture the near wall flow accurately 6 validation of nipc method due to the time consuming cfd calculations it is difficult to conduct large scale random experiments to solve the uq problems in order to demonstrate the validity of the nipc method this section introduces an exponential function as a test case for uq feinberg and langtangen 2015 the results obtained by regression based nipc method are compared with those obtained by mc method 6 1 test function 22 f x a e b x x 0 10 f x can be assumed as a wrapper for some more complicated numerical model the parameters a and b in equation 22 are unknown but their probability distributions are given as 23 a u 1 2 b u 0 1 0 2 the goal is to describe the behaviour of uncertainty propagation via f x function the ev and sd of the function value are investigated 6 2 results of the test case in the test case the polynomial chaos is expanded to 2nd order the sampling points the values of stochastic variables a and b are generated by lhs method the results obtained by mc and nipc methods are shown in fig 7 the numbers of sampling points are 6 72 400 1000 respectively the subfigures of relative error show that the relative differences of the two uq methods are gradually decreasing with the increase of the number of sampling points it can be seen from fig 8 that the convergence of mc method is much slower than the regression based nipc method when the sampling points exceed 100 the results obtained by the regression based nipc method are basically stable 7 results and discussions in this section the regression based nipc method is used to quantify the uncertainty of the resistance the rao of heave and pitch motions of dtc model in shallow water waves the polynomial chaos with two random parameters is expanded to 1st order according to equation 8 there are three unknown coefficients as recommended by hosder et al 2007 six sampling points are generated on which cfd simulations are carried out in the simulations the model is free to heave and pitch taking one of the six cases as an example the flow field details are shown in section 7 1 the results of uq are presented and discussed in section 7 2 7 1 details of flow field fig 9 shows that the y for the hull surface of dtc model is small less than 1 indicating that the cells around the hull can be resolved directly without wall treatment fig 10 illustrates the wave patterns around the dtc model at depth froude number f nh 0 488 and λ l pp 0 55 in one encounter period this figure is obtained based on symmetry half ship mirrored as can be seen the waves generated by the hull with forward speed in shallow water waves are clearly visible while the waves reflected from the side walls of the tank are not obvious the reflected waves dissipate as they further propagate this shows that the bank effect is not significant in this case fig 11 shows the free surface elevation around the dtc model and the pressure distribution on the hull surface in one encounter period the periodic pressure difference between the bow and stern of the hull will cause the pitch motion 7 2 uq results in this subsection the efd and cfd results of heave motion pitch motion and total resistance are post processed the least square method is used to fit the data series of heave pitch motion the total resistance refers to the average longitudinal force on the hull the statistical properties of these variables are obtained by mc method and the regression based nipc method according to the cfd results finally the uq results obtained from the efd and cfd data are compared figs 12 and 13 show the efd cfd data and the fitted sine curves respectively after obtaining the fitted sinusoid the rao of heave and pitch motions can be calculated by the amplitude of sine curve 24 rao heave z 1 a rao pitch θ 1 a k where z 1 is the amplitude of heave motion m θ 1 is the amplitude of pitch motion rad a is the wave amplitude m and k is wave number m 1 it should be noted that the time histories in fig 13 are under the influence of some low frequency oscillations which is mainly represented by the oscillations of the mean values such low frequency oscillations may be due to many reasons such as the reflection from the side wall the numerical errors during iteration typically the oscillations may simply disappear as the simulation time expands if a time window with a short duration is used in the fourier series expansion the value of the first harmonics is less influenced table 5 lists the results of cfd simulations on sampling points and the comparison error and the statistical characteristics obtained by mc method and nipc method are shown in tables 6 8 where x is the total resistance and the comparison error e d is defined as 25 e d d s d 100 where d is the efd value s is the value obtained by mc nipc method in order to demonstrate the results more visually the data in tables 6 8 are displayed in fig 14 it can be seen that the ev of raoheave raopitch and x obtained by nipc method is closer to the experimental value than that by mc method it should be noted that the error bar shown in fig 14 does not only refer to the uncertainty from the numerical calculation but also includes the randomness from the input variables including wave height and wave period in other word the evaluation of uq includes the deviations between the fitting and real curves in fig 13 but it is not sure how much uncertainty is derived from the deviations between the fitting and real curves and how much from the randomness induced by the uncertain input variables in terms of the present methodology it needs to obtain the cfd results as accurate as possible if the cfd results are precise the uncertainty of output variables is completely caused by the randomness of the input variables what is more the sd of cfd results cannot be compared with those of efd data because the experiment did not consider the uncertainty of the parameters to sum up the nipc method is used to assess the ev and sd of the hydrodynamic performances of interest in this section the uncertainty of hydrodynamic performance is induced by wave height and wave period in engineering practice a lot of uncertain parameters exist ubiquitously such as manufacturing errors variation of working conditions operational wear and tear for example many uncertain factors exist in the process of launching an underwater vehicle such as launch depth vehicle velocity and chamber pressure these factors usually are not constant in reality and may influence the attitude control uq enables to model the forward propagation of uncertainty it also increases the understanding of the model by investigating how the uncertain parameters influence the model output furthermore studying the backward propagation of uncertainty provides an insight into how each parameter affects different aspects of the model and it provides a useful approach to realistic stochastic design optimization problems 8 conclusions in this paper v v and uq for cfd uncertainty problems are investigated a state of the art method for uncertainty quantification problems the non intrusive polynomial chaos nipc method is introduced in detail in order to prove the validity of nipc method a uq problem for an exponential function with two random parameters is studied using nipc method and mc method the results show that nipc method is much better than mc method as for the uq problems in cfd stochastic rans based simulations for the dtc model advancing at 100 ukc in shallow water waves are carried out considering its dynamic heave and pitch motions the uncertainty induced by wave parameters treated as stochastic variables with gaussian distribution is studied the results of raoheave raopitch and total resistance obtained by nipc method show better agreement with the benchmark data than those by mc method however the benchmark data were obtained from experiment which was carried out deterministically so that the sd namely error bar cannot be compared with the benchmark data on going and future work includes studying the effect of order of polynomial chaos expansion on the propagation of uncertainty comparing the regression based nipc method with the projection based nipc method extending the present study to a more realistic problem considering more stochastic input variables such as main particulars of the hull and boundary conditions credit authorship contribution statement li xia conceptualization methodology software validation writing original draft shuai yuan visualization data curation formal analysis zaojian zou supervision funding acquisition project administration writing review editing lu zou visualization investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant no 51979164 
22115,in this paper uncertainty quantification of hydrodynamic forces on the dtc model advancing in shallow water waves is studied first verification and validation v v and uncertainty quantification uq in uncertainty analysis for cfd simulation are compared a state of the art method for uq problems the non intrusive polynomial chaos nipc method is introduced and validated to be effective by studying a stochastic function together with the monte carlo mc method then nipc method is applied to quantify the uncertainty of the resistance heave motion and pitch motion of the dtc model in shallow water waves computations are performed with the cfd software star ccm the uncertainty induced by waves treated as stochastic variables with gaussian distribution is studied uq results obtained by mc method and nipc method are compared with the benchmark data the results obtained by nipc method show better agreement with the benchmark data than those by mc method keywords uncertainty quantification polynomial chaos method monte carlo method cfd shallow water waves nomenclature a wave amplitude m b breadth of the ship m c coefficients of polynomial chaos c b block coefficient d dimension of stochastic variables f nh depth froude number gm metacentric height m i xx moment of inertia about ox axis kg m2 i yy moment of inertia about oy axis kg m2 i zz moment of inertia about oz axis kg m2 k wave number m 1 l pp length between perpendiculars m m mass of the ship kg n runs number of cfd runs n c number of coefficients in pce p order of pce t design design draught m t e encounter period s u uniform distribution x g longitudinal coordinate of the centre of gravity m x longitudinal force on the hull n y dimensionless wall distance z heave motion m z g vertical coordinate of the centre of gravity m δ nm kronecker delta function θ pitch motion rad λ wave length m μ expected value ξ stochastic variable σ standard deviation φ polynomial chaos ψ polynomial chaos aiaa american institute of aeronautics and astronautics asme american society of mechanical engineers cdf cumulative distribution function cfd computational fluid dynamics dfbi dynamic fluid body interaction dtc duisburg test case ev expected value fvm finite volume method ipc intrusive polynomial chaos ittc international towing tank conference lhs latin hypercube sampling mc monte carlo nipc non intrusive polynomial chaos pc polynomial chaos pce polynomial chaos expansion pdf probability density function rans reynolds averaged navier stokes rao response amplitude operator sa sensitivity analysis sd standard deviation ukc under keel clearance uq uncertainty quantification v v verification and validation vof volume of fluid 1 introduction along with the rapid development of computer science and technology computational fluid dynamics cfd technology has been widely and successfully applied in industrial production and scientific research however the quality and credibility of cfd is always a concern verification and validation v v is a useful method for cfd uncertainty analysis verification is to analyze the numerical error in order to ensure the accuracy of numerical methodology validation is mainly to find the modelling errors by comparing the simulated results with experimental ones in the procedure of v v all results are evaluated in conditions of deterministic factors aiaa 1998 provided guidelines and asme 2009 set a standard for v v in cfd ittc 2008 established v v procedures for cfd simulation of ship hydrodynamics eça and hoekstra 2009 investigated the estimation of the numerical uncertainty using grid refinement studies with the method of manufactured solutions they mainly studied three problems of uncertainty evaluation the estimation of the iterative uncertainty the influence of the iterative error on the estimation of the discretization uncertainty and the overall numerical uncertainty eça and hoekstra 2014 presented a procedure for estimating the numerical uncertainty of cfd calculations based on grid refinement studies actually there is a great deal of nondeterministic factors in the real physical problems such as fluid properties boundaries variation of geometry the cumulative effect of these uncertain factors may have a large impact on the results obtained by cfd calculations for these reasons it is necessary to estimate the uncertainty of the system response the main work of uncertainty quantification uq is to characterize the impact of stochastic input parameters on the model quantitatively in other words uq focuses on the statistical characteristics of the response variables such as expected value ev standard deviation sd skewness kurtosis cumulative distribution function cdf and probability density function pdf as a consequence of a set of uncertain input variables with known distribution diez et al 2014 traditional methods for studying uq problems can be divided into two types one is non statistic methods such as sensitivity analysis sa moment methods and perturbation method which are suitable for solving the linear uq problems the other is statistic methods where the most famous one is monte carlo mc method mc method is technically feasible to solve uq problems with large degrees of uncertainty but not efficient in recent years a state of the art method polynomial chaos expansion pce is employed in uq problems which is derived from homogeneous chaos method proposed by wiener 1938 and developed by ghanem and spanos 1991 in solid mechanics field pce method can be divided into intrusive method and non intrusive method according to whether it is necessary to modify the solver intrusive polynomial chaos ipc method requires significant modifications to the solver hence it was only applied to one two dimensional stochastic problems to overcome the difficulties and complexities of ipc method non intrusive polynomial chaos nipc method has been proposed and developed the solver is treated as a black box in nipc method the output variables of interest are expanded in polynomial chaos with unknown polynomial coefficients which can be obtained by projection method or regression method the former is based on a numerical integration the latter performs a regression analysis based on a selected set of points recently several research groups applied this method to cfd field xiu and karniadakis 2002a used galerkin projections and extensions of wiener s pce to solve stochastic differential equations xiu et al 2002 studied the uncertainty propagation in fluid structure interactions using a generalized polynomial chaos method and xiu and karniadakis 2002b 2003 used the same method to model the input uncertainty and its propagation in incompressible flow simulation and steady state diffusion simulation respectively loeven et al 2007 introduced the probabilistic collocation method and used it to solve one dimensional stochastic piston problem together with pce method the uncertainty in stochastic steady flow around a naca0012 airfoil was quantified using probabilistic collocation method loeven 2010 verified the effectiveness of probabilistic collocation method for uq problems via several stochastic cfd cases mathelin and hussaini 2003 presented a method which combines pce method with karhunen loeve decomposition and applied it to a stochastic problem of a quasi one dimensional nozzle flow mathelin et al 2005 discussed two methods for uq problems pce method and stochastic collocation method the results showed that both methods can handle uncertainty propagation efficiently lacor et al 2013 studied three uq problems in cfd field using ipc method supersonic flow in a nozzle lid driven cavity flow and transonic flow in the nasa rotor 37 hosder et al 2006 implemented nipc method to solve two stochastic two dimensional flow problems hosder et al 2007 discussed the effect of three sampling methods random latin hypercube and hammersley when nipc method was applied to solve uq problems hosder and walters 2010 introduced nipc method and studied three uq examples in cfd field salehi et al 2017a presented an efficient approach to stochastic cfd problems they reconstructed the sparse representation of pce using the compressed sensing theory to solve challenging uq problems salehi et al 2017b quantified the uncertainties on the characteristics of turbulent flow in rectangular pipe and asymmetric diffuser using karhunen loeve expansion and nipc method wang and kang 2010 implemented ipc method for a two dimensional compressible stochastic navier stokes equations to demonstrate the uncertainty propagation of a lid driven cavity flow wang et al 2013 presented a robust aerodynamic optimization method based on nipc method and multi objective genetic algorithm schmelter et al 2015 predicted the influence of uncertain inflow conditions in pipes using pce method ahlfeld and montomoli 2017 proposed an efficient method for uq problems based on sparse pce method and studied the uncertainty propagation in turbomachinery as for ship hydrodynamics some scholars have carried out researches he et al 2013 applied one dimensional nipc method to quantify the uncertainties of hydrodynamic performance of the delft catamaran 372 taking into account the effects of geometrical operational and environmental randomness the results showed the feasibility and effectiveness of nipc method for robust design optimization and reliability based design optimization in the field of ship hydrodynamics stern et al 2017 provided an overview of uq and validation methods for industrial problems in ship hydrodynamics field the hydrodynamic performance of a ship will change dramatically when entering shallow water due to the hydrodynamic interaction between the hull and the seabed it is of great significance to investigate the behaviour of ships in shallow and confined navigation areas such as rivers harbors dredged channels and other coastal areas nowadays cfd technique has been applied in study of ship s hydrodynamic performances in restricted waters jachowski 2008 investigated the restricted water effects on ship motion using commercial cfd software fluent senthil and chandra 2013 estimated the resistance of a river sea ship in shallow water based on cfd method carrica et al 2016 studied the performance of kcs container ship in a zigzag test under shallow water condition both experimentally and numerically deng et al 2016 simulated four different pure sway yaw tests in shallow water using their in house numerical solver isis cfd code and the predicted results were compared with the benchmark data liu et al 2016 simulated the viscous flow around the dtc model manoeuvring in shallow water simulations of static drift and pure sway tests at 20 ukc were carried out tezdogan et al 2016a analyzed the dtc model s hydrodynamic performance under different ship draughts with different speeds using the cfd software star ccm and the squat results were compared with experimental data tezdogan et al 2016b conducted a series of simulations of shallow water waves to investigate a full scale large tanker s characteristics and studied the ship s heave pitch motion in head waves at zero speed and various water depths and found that the shallow water effect was an important cause of the vertical movement of the hull terziev et al 2018 investigated the behaviour of dtc model when advancing through restricted shallow waters using three methods cfd slender body theory and empirical method the results showed that there were significant differences in the computed parameters for the ship entering confined waters although the above work is important and excellent the uncertainty induced by stochastic parameters is ignored in this paper the regression based nipc method is applied to stochastic problems related to ship s hydrodynamic performances in shallow water it focuses on uq for the numerical predictions of resistance and motion of the dtc model in shallow water waves normally there are two parts in solving uncertainty quantification problems the first one is to determine the distribution of random input parameters from the reliable data the second one strives to quantify the propagation of uncertainty this paper focuses on the second part 2 mathematical models of uq 2 1 definition of uq problems uq problem is defined as a problem to quantify the uncertainty of response y 1 y f x t ξ where ξ ξ 1 ξ 2 ξ d t is a vector of uncertain input parameters with known joint probability density function p ξ according to the homogeneous chaos theory if the stochastic input variables ξ j j 1 2 d are independent the response y can be expressed as 2 y a 0 φ 0 i 1 1 d a i 1 φ 1 ξ i 1 i 1 1 d i 2 1 i 1 a i 1 i 2 φ 2 ξ i 1 ξ i 2 i 1 1 d i 2 1 i 1 i k 1 i k 1 a i 1 i k φ k ξ i 1 ξ i 2 ξ i k where a x t are functions of deterministic space x and deterministic time t and φ ξ are multivariate polynomials of stochastic variables ξ for a simple use in mathematical formulas the form of equation 2 can be expressed as 3 y i 0 c i ψ i ξ there are one to one correspondences between each polynomial coefficient a and c each orthogonal polynomial φ and ψ mollon et al 2010 in order to solve the uq problem the polynomials are truncated by dimension d 4 y ˆ a 0 φ 0 i 1 1 d a i 1 φ 1 ξ i 1 i 1 1 d i 2 1 i 1 a i 1 i 2 φ 2 ξ i 1 ξ i 2 i 1 1 d i 2 1 i 1 i d 1 i d 1 a i 1 i d φ d ξ i 1 ξ i d i 0 n c 1 c i ψ i where n c is the number of unknown coefficients pce is defined as a polynomial approximation as in equation 4 where ψ ξ satisfies orthogonality to the weight functions 5 ψ n ξ ψ m ξ ψ n 2 ξ δ n m where δ nm is the kronecker delta function the inner product can be defined as 6 ψ n ξ ψ m ξ ψ n ξ ψ m ξ p ξ d ξ where p ξ is the joint probability density function under the assumption of independent stochastic input variables ξ p ξ can be expressed as 7 p ξ i 1 d p i ξ i where p i ξ i is the probability density function of ξ i it can be seen from equation 4 the number of coefficients needed to be calculated is n c given in equation 8 8 n c 1 p p 1 p 1 p 1 2 p 1 d p 1 d p d p d 2 2 orthogonal polynomials pce was originally developed for the hermite polynomials and the gaussian distribution the convergence rate of hermite polynomial chaos is optimum for the gaussian processes salehi et al 2017a as shown in equation 6 orthogonal polynomials have to be reconstructed for each distribution xiu and karniadakis 2002a developed the wiener askey polynomial chaos to deal with more kinds of stochastic variables as shown in table 1 for example the multidimensional legendre polynomials with respect to a second order pce and two random variables ξ ξ 1 ξ 2 t u 1 1 are 9 ψ n 1 ξ 1 ξ 2 1 2 3 ξ 1 2 1 ξ 1 ξ 2 1 2 3 ξ 2 2 1 2 3 projection based nipc method the main idea of projection based nipc method is to use galerkin projection to calculate the coefficients 10 y ˆ ψ k ξ i 0 n c 1 c i ψ i ξ ψ k ξ equation 10 can be transformed as follows because of the orthogonality 11 y ˆ ψ k ξ c k ψ k 2 ξ hence the polynomial coefficients can be expressed as 12 c k 1 ψ k 2 ξ y ˆ ψ k ξ p ξ d ξ the expression involves high dimensional integrals which requires an efficient numerical integration technique 13 c k 1 ψ k 2 ξ w j p ξ j f ˆ x t ξ j ψ k ξ j where w j are weights and ξ j are abscissas in a quadrature scheme for different numerical integration technique different weights and abscissas are needed such as gauss hermite quadrature clenshaw curtis quadrature leja quadrature however such numerical integration techniques suffer from the curse of dimensionality and are time consuming though sparse grid quadrature rules can be used projection based nipc method is efficient for problems with limited input variables while regression based nipc method is viable for problems with a large number of input variables 2 4 regression based nipc method regression based nipc method requires a certain number of sampling points where the responses are computed the number of sampling points m should be more than the number of unknown coefficients n c the over determined system can be expressed as follows 14 ψ 0 ξ 1 ψ n c 1 ξ 1 ψ 0 ξ m ψ n c 1 ξ m c 0 c n c 1 f ˆ x t ξ 1 f ˆ x t ξ m or in a compact form 15 ψ c y the vector of unknown coefficients c can be determined using the least square approach 16 c ψ t ψ 1 ψ t y compared to projection based nipc method the regression based nipc method requires well placed random sampling points instead of quadrature abscissas the influence of the number of sampling points can be analyzed by the oversampling ratio n p defined as 17 n p number of sampling points n c the oversampling ratio of 2 gives a better approximation at each polynomial degree hosder et al 2007 2 5 workflow of nipc method the workflow of uq for cfd problems using nipc method is summarized in fig 1 it is implemented in the following steps step 1 determine the distribution of random input variables and then compute the orthogonal polynomials it is very difficult to obtain the distribution of all random variables accurately it is necessary to assume that the random variables are independent and the distribution is known if the distribution is conventional the orthogonal polynomials can be chosen from table 1 otherwise three term recursion should be conducted step 2 compute the points where the responses will be calculated using cfd method in projection based nipc method quadrature points and quadrature weights have to be solved while in regression based nipc method random sampling points should be well placed by effective sampling methods step 3 calculate the responses of interest for each points by cfd this calculation is most time consuming on one hand many points are needed in the case with high order of pce and multidimensional random variables on the other hand the calculation costs a lot and there may be a lot of output parameters of interest for each point step 4 evaluate the coefficients and then compute the statistical characteristics of output parameters such as ev and sd after solving the coefficients via projection based or regression based nipc method the ev and sd of output variables of interest can be evaluated based on equations 18 and 19 other statistical characteristics such as cdf and pdf can be reconstructed by using mc method 18 μ x t c 0 x t 19 σ 2 x t i 0 n c 1 c i 2 x t ψ i 2 ξ 2 6 comparison of mc method and nipc method mc method is a famous algorithm that uses random numbers to solve computational problems it is considered as a very effective method especially when it is difficult or impossible to use other methods mc method is widely used in optimization numerical integration and probability problems as for uq problems in cfd the main steps of implementing mc method are 1 determine the distribution of random variables 2 generate sampling points using mc method 3 perform cfd calculations at the sampling points 4 obtain the statistical properties such as ev and sd by statistical analysis of cfd results the ev and sd obtained by mc method are expressed as 20 μ x t f x t ξ n runs 21 σ 2 x t f x t ξ μ x t 2 n runs where n runs is the number of cfd runs as mentioned above the first three steps using mc method are necessary in applying regression based nipc method to uq problems as for post processing instead of statistical analysis of cfd results regression based nipc method solves a linear system based on the selected sampling points using least square method as two methods for uq problems mc method and nipc method have the following characteristics both methods do not need to change the solver while ipc method requires much modifications of the codes mc method is straightforward and simple it has a wide range of applications in science and is easy to implement however it requires a lot of computing resources and is usually not feasible for many practical engineering problems therefore mc method is often regarded as a final resort to solving engineering problems recently nipc method has drawn attention of a lot of researchers because of its high accuracy and low computational cost it is more feasible from the engineering point of view 3 sampling methods in this paper latin hypercube sampling lhs giunta et al 2003 is used to generate sampling points it is a stratified sampling method for generating sampling points from a multidimensional distribution in statistical sampling the latin square array refers to a square matrix with only one sample per row and column the latin hypercube is a generalization of the latin square in a multidimensional way each hyperplane perpendicular to the axis contains at most one sample assuming that there are n variables each variable can be divided into m intervals with the same probability then m sample points satisfying the latin hypercube condition can be selected it should be noted that lhs requires the same number of partitions for each variable as m however this method does not require that the number of samples m increases as the number of variables increases 4 case for study 4 1 geometry and main particulars dtc is a 14 000 teu container ship with a single propeller a bulbous bow large bow flare and a transom stern el moctar et al 2012 the hull lines and profile view of dtc are shown in fig 2 in this paper the bare hull of dtc model with a scale ratio 1 88 11 is selected for the simulation main particulars of the dtc model are listed in table 2 4 2 conditions of simulations the conditions of simulations in table 3 are determined by the benchmark test case of the 5th mashcon conference van zwijnsvoorde et al 2019 in this paper the wave height and wave period are treated as stochastic variables with gaussian distribution the specific values of the wave height and wave period are obtained by the lhs method if the polynomial chaos is expanded to 1st order six sampling points are required with respect to two random variables as shown in table 4 5 cfd method 5 1 governing equations and physics modelling in the simulation of the model tests the flow is treated as a three dimensional flow of incompressible viscous fluid the governing equations are the reynolds averaged continuity equation and reynolds averaged navier stokes rans equations cfd computations are performed with the general software star ccm where finite volume method fvm is used the continuity equation and rans equations are linked by using a predictor corrector approach in the solver the sst k ω turbulent model is used to close the governing equations second order upwind scheme is applied to discretize the convection terms the overall solution is implemented by simple algorithm the volume of fluid vof method is adopted to model the free surface in this paper linear wave is adopted dynamic fluid body interaction dfbi module is used to simulate the ship motion the dfbi module enables the solver to calculate the hydrodynamic forces on the ship model and solve the governing equations of rigid body motion the dfbi morphing module in the solver is adopted 5 2 computational domain and boundary conditions to solve a physical problem by cfd method it is necessary to define the initial and boundary conditions depending on the mechanisms in the problem in order to obtain accurate results the computational domain and boundary conditions with the dtc model are shown in fig 3 the inlet boundary and outlet boundary are positioned 1 5l pp and 3 0l pp ahead and behind the hull respectively a velocity inlet boundary condition is set on the inflow plane where head waves are generated the outflow plane is modelled as a pressure outlet which can prevent backflow and keep accurate static pressure the top boundary is located 0 5l pp above the undisturbed free surface and is also modelled as a velocity inlet for purpose of numerical efficiency and convergence the positions of the bottom and side boundaries are consistent with the model tests corresponding to the tank bottom and side walls these boundaries are set as a moving no slip wall the ship hull is set as the no slip wall since only the case of the ship in forward motion along the centre line of the tank is considered the flow field on both sides of the ship is symmetrical it is reasonable to consider only half of the ship and flow field to reduce the computational burden correspondingly the vertical plane that coincides with the longitudinal centre plane of the hull is modelled as a symmetry boundary the vof wave damping module is applied in order to prevent wave reflection the damping length is set approximately 1 5l pp 5 976 m 5 3 mesh generation the trimmed cell mesher in star ccm is used to generate mesh which is a useful tool for producing a high quality unstructured hexahedral grid the mesh in the area around the hull and the expected free surface elevation is refined progressively in order to capture the complex flow features appropriately prism layer mesher is used to generate boundary layer grids adjacent to the hull surface the tank bottom and side walls the y value for the hull surface is less than 1 while the y value for the bottom and side walls is larger than 30 fig 4 provides a cross sectional view of the mesh inside the computational domain fig 5 depicts the entire view of the mesh around the free surface the free surface mesh has refined in the areas where the kelvin waves are expected fig 6 displays the surface mesh on the bow and stern of the hull the mesh density on the surface of the bare hull is refined in order to capture the near wall flow accurately 6 validation of nipc method due to the time consuming cfd calculations it is difficult to conduct large scale random experiments to solve the uq problems in order to demonstrate the validity of the nipc method this section introduces an exponential function as a test case for uq feinberg and langtangen 2015 the results obtained by regression based nipc method are compared with those obtained by mc method 6 1 test function 22 f x a e b x x 0 10 f x can be assumed as a wrapper for some more complicated numerical model the parameters a and b in equation 22 are unknown but their probability distributions are given as 23 a u 1 2 b u 0 1 0 2 the goal is to describe the behaviour of uncertainty propagation via f x function the ev and sd of the function value are investigated 6 2 results of the test case in the test case the polynomial chaos is expanded to 2nd order the sampling points the values of stochastic variables a and b are generated by lhs method the results obtained by mc and nipc methods are shown in fig 7 the numbers of sampling points are 6 72 400 1000 respectively the subfigures of relative error show that the relative differences of the two uq methods are gradually decreasing with the increase of the number of sampling points it can be seen from fig 8 that the convergence of mc method is much slower than the regression based nipc method when the sampling points exceed 100 the results obtained by the regression based nipc method are basically stable 7 results and discussions in this section the regression based nipc method is used to quantify the uncertainty of the resistance the rao of heave and pitch motions of dtc model in shallow water waves the polynomial chaos with two random parameters is expanded to 1st order according to equation 8 there are three unknown coefficients as recommended by hosder et al 2007 six sampling points are generated on which cfd simulations are carried out in the simulations the model is free to heave and pitch taking one of the six cases as an example the flow field details are shown in section 7 1 the results of uq are presented and discussed in section 7 2 7 1 details of flow field fig 9 shows that the y for the hull surface of dtc model is small less than 1 indicating that the cells around the hull can be resolved directly without wall treatment fig 10 illustrates the wave patterns around the dtc model at depth froude number f nh 0 488 and λ l pp 0 55 in one encounter period this figure is obtained based on symmetry half ship mirrored as can be seen the waves generated by the hull with forward speed in shallow water waves are clearly visible while the waves reflected from the side walls of the tank are not obvious the reflected waves dissipate as they further propagate this shows that the bank effect is not significant in this case fig 11 shows the free surface elevation around the dtc model and the pressure distribution on the hull surface in one encounter period the periodic pressure difference between the bow and stern of the hull will cause the pitch motion 7 2 uq results in this subsection the efd and cfd results of heave motion pitch motion and total resistance are post processed the least square method is used to fit the data series of heave pitch motion the total resistance refers to the average longitudinal force on the hull the statistical properties of these variables are obtained by mc method and the regression based nipc method according to the cfd results finally the uq results obtained from the efd and cfd data are compared figs 12 and 13 show the efd cfd data and the fitted sine curves respectively after obtaining the fitted sinusoid the rao of heave and pitch motions can be calculated by the amplitude of sine curve 24 rao heave z 1 a rao pitch θ 1 a k where z 1 is the amplitude of heave motion m θ 1 is the amplitude of pitch motion rad a is the wave amplitude m and k is wave number m 1 it should be noted that the time histories in fig 13 are under the influence of some low frequency oscillations which is mainly represented by the oscillations of the mean values such low frequency oscillations may be due to many reasons such as the reflection from the side wall the numerical errors during iteration typically the oscillations may simply disappear as the simulation time expands if a time window with a short duration is used in the fourier series expansion the value of the first harmonics is less influenced table 5 lists the results of cfd simulations on sampling points and the comparison error and the statistical characteristics obtained by mc method and nipc method are shown in tables 6 8 where x is the total resistance and the comparison error e d is defined as 25 e d d s d 100 where d is the efd value s is the value obtained by mc nipc method in order to demonstrate the results more visually the data in tables 6 8 are displayed in fig 14 it can be seen that the ev of raoheave raopitch and x obtained by nipc method is closer to the experimental value than that by mc method it should be noted that the error bar shown in fig 14 does not only refer to the uncertainty from the numerical calculation but also includes the randomness from the input variables including wave height and wave period in other word the evaluation of uq includes the deviations between the fitting and real curves in fig 13 but it is not sure how much uncertainty is derived from the deviations between the fitting and real curves and how much from the randomness induced by the uncertain input variables in terms of the present methodology it needs to obtain the cfd results as accurate as possible if the cfd results are precise the uncertainty of output variables is completely caused by the randomness of the input variables what is more the sd of cfd results cannot be compared with those of efd data because the experiment did not consider the uncertainty of the parameters to sum up the nipc method is used to assess the ev and sd of the hydrodynamic performances of interest in this section the uncertainty of hydrodynamic performance is induced by wave height and wave period in engineering practice a lot of uncertain parameters exist ubiquitously such as manufacturing errors variation of working conditions operational wear and tear for example many uncertain factors exist in the process of launching an underwater vehicle such as launch depth vehicle velocity and chamber pressure these factors usually are not constant in reality and may influence the attitude control uq enables to model the forward propagation of uncertainty it also increases the understanding of the model by investigating how the uncertain parameters influence the model output furthermore studying the backward propagation of uncertainty provides an insight into how each parameter affects different aspects of the model and it provides a useful approach to realistic stochastic design optimization problems 8 conclusions in this paper v v and uq for cfd uncertainty problems are investigated a state of the art method for uncertainty quantification problems the non intrusive polynomial chaos nipc method is introduced in detail in order to prove the validity of nipc method a uq problem for an exponential function with two random parameters is studied using nipc method and mc method the results show that nipc method is much better than mc method as for the uq problems in cfd stochastic rans based simulations for the dtc model advancing at 100 ukc in shallow water waves are carried out considering its dynamic heave and pitch motions the uncertainty induced by wave parameters treated as stochastic variables with gaussian distribution is studied the results of raoheave raopitch and total resistance obtained by nipc method show better agreement with the benchmark data than those by mc method however the benchmark data were obtained from experiment which was carried out deterministically so that the sd namely error bar cannot be compared with the benchmark data on going and future work includes studying the effect of order of polynomial chaos expansion on the propagation of uncertainty comparing the regression based nipc method with the projection based nipc method extending the present study to a more realistic problem considering more stochastic input variables such as main particulars of the hull and boundary conditions credit authorship contribution statement li xia conceptualization methodology software validation writing original draft shuai yuan visualization data curation formal analysis zaojian zou supervision funding acquisition project administration writing review editing lu zou visualization investigation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is supported by the national natural science foundation of china grant no 51979164 
22116,this paper presents control design and nonlinear stability analysis for path following of an underactuated autonomous underwater vehicle auv with dynamics restricted to the longitudinal plane for this auv motion control system the speed of translational dynamics is much slower than that of orientation dynamics such characteristic allows for a mathematical setup which can be naturally treated by standard singular perturbation theory based on this analysis a simple control law is designed with time scale decomposition method which is able to stabilize an auv to desired diving path by selecting desired collective pitch rate and pitch angle its nonlinear stability analysis is performed by constructing lyapunov functions in term of singular perturbation method the paper also proves that the control law is robust in the presence of bounded disturbances and model uncertainties using the small gain theorem furthermore simulation results are presented to illustrate the control performance keywords autonomous underwater vehicle singular perturbation control design nonlinear stability analysis robustness analysis 1 introduction as the increase of marine activities autonomous underwater vehicles auvs gain much more attention in control design for applications in underwater monitoring and surveillance marine biology rescue and search undersea oil detection etc during the past few years many results on motion control of auvs are reported in particular the diving control problem has drawn compelling interest and a number of nonlinear control techniques have been studied to deal with the nonlinear dynamic systems with different focuses from backstepping technique lapierre 2009 xu et al 2015 sliding mode control salgado jimenez et al 2004 xu et al 2015 adaptive control narasimhan et al 2006 li et al 2005 model predictive control mpc li et al 2017 dynamic inversion di ansari and bajodah 2017 or feedback linearization pan et al 2011 to name a few neural networks nns are also parts of nonlinear control techniques which seem to provide improved robustness properties under system uncertainties for instance peng et al 2019 presented a neurodynamic optimization approach for path following control of underactuated auvs subject to velocity and input constraints as well as disturbances in addition peymani and fossen 2015 proposed a novel path following controller for auvs based on the variational principle of analytical mechanics and the lagrange multiplier method all these nonlinear control techniques mentioned above have provided new tools and promising solutions to deal with auv motion control however they usually raise the complexity of controller s structure and thus make it difficult to use them in practice yi et al 2016 moreover the time scale separation caused by different rates of numerous variables is not addressed in these existing articles therefore it is a great significance to develop a nonlinear controller which should be easy to implement in reality and handle a time scale separation it is well established that time scale separation is ubiquitous and a direct application of standard control methods without accounting for the presence of time scale multiplicity may lead to controller ill conditioning and or closed loop instability christofides 2000 hence for practical use the control and analysis of multi time scale processes are usually addressed within the framework of singular perturbations kokotovic et al 1986 ramnath 2010 in that case the time scale separation phenomenon for full dynamics results in two subsystems of lower order slow reduced and fast boundary layer subsystems which can be stabilized separately thus relatively simplifying the control problem this bright idea is appealing to researchers and control engineers its effectiveness has been extensively investigated in control and analysis of aircraft bertrand et al 2011 yan et al 2013 esteban et al 2013 2015 a comprehensive literature review of singular perturbation theory used in aircraft control can be found in naidu et al 2001 during the past two decades some attempts have also been made to address the time scale separation problems in motion control of marine vehicles using the theory of singular perturbation and time scales in canudas de wit et al 2000 a robust nonlinear feedback control was employed for an underwater vehicle manipulator uvm in bhatta et al 2008 several lyapunov based controllers were proposed for wing level flight of underwater gliders with different configurations in ren et al 2014 and yi et al 2016 two different two time scale singular perturbation control laws were developed for rudder roll stabilization rrs and path following of marine surface vessels respectively all these existing works have shown the subtle but powerful capabilities of singular perturbation theory for motion control in the field of ocean engineering however studies on auv motion control in multi time scale structure have hardly been seen in the open literature to my knowledge prestero 2001 proposed a simple inner and outer loop pd controller for the pitch depth diving motion of an underactuated auv but no analytical results are provided so it is difficult to make general conclusions about the control design and stability analysis within the framework of singular perturbations for the path following of underactuated auvs there is an obvious time scale separation phenomenon between the translational dynamics and orientation dynamics similar to that of bertrand et al 2011 therefore the theory of singular perturbation and time scales is a more suitable approach for path following control in practical ocean engineering as illustration above motivated by these observations in this paper i present the control design and stability analysis for path following of underactuated auvs using singular perturbation theory a simplified model for path following control is first given with assumptions of constant surge velocity and vanishingly small heave velocity its singular perturbation model formulation is presented by comparison of the speeds of state variables using time scale decomposition method i design a relatively simple control law and further prove that it makes the full control system asymptotically stable the robustness issue in full system with bounded model uncertainties and disturbances is also studied a unique feature of this work is that the time scale decomposition approach simplifies the design and analysis procedure of the path following control the remainder of the paper is organized as follows section 2 briefly describes the problem formulation section 3 presents the path following controller using theory of singular perturbation and time scales section 4 and section 5 present the nonlinear stability analysis and robustness analysis respectively section 6 provides simulation results for control performance illustrations section 7 summarizes the main contributions of the paper 2 problem formulation 2 1 model of an auv in the vertical plane this subsection briefly introduces a model of an underactuated auv in the vertical plane at first the inertial frame e and body frame b are defined as illustrated in fig 1 using the slender body theory the longitudinal plane is an invariant plane for an underwater vehicle dynamics if i assume that the vehicle is symmetric about the longitudinal axis and neglect lateral disturbances following that the motion of an underactuated auv in the vertical plane can be expressed by kinematic equation 1 x u cos θ w sin θ z u sin θ w cos θ θ q and dynamic equation 2 u 1 m x u x u u u u x u p r o p w 1 m z w z w w w w m u q z u w u w m z g q 2 z u u δ s u 2 δ s q 1 i y y m q m q q q q m u q u q m u w u w m g z g z b sin θ m z g w q m u u δ s u 2 δ s where x and z are the positions of vehicle relative to inertial frame e u and w are surge and heave velocity in the body frame b θ an q are pitch angle and pitch rate of vehicle m and i y y represent mass and moment of inertia of the vehicle z g and z b denote the locations of center of gravity cg and center of buoyancy cb along b 3 direction respectively δ s is the deflection angle of the stern surface see fig 1 the variables x s z s and m s denote the hydrodynamic parameters of the vertical plane dynamics of vehicle model taipan 2 in earlier study lapierre 2009 also note the vehicle model herein is assumed to be nearly neutrally buoyant 2 2 kinematic path following error in this subsection the error dynamics for path following of an auv in the vertical plane is derived as illustrated in fig 1 i define a c 1 reference diving path p d χ with a set of waypoints x i z i i 1 2 3 n p where χ 0 denotes the path variable for any point x p χ z p χ along the reference path θ p is the path tangential angle and given by 3 θ p atan 2 z p χ χ x p χ χ let e and θ e represent the cross track error and path angle tracking error referring to lekkas and fossen 2013 they can be expressed as 4 e x x p χ sin θ p z z p χ cos θ p θ e θ θ p differentiating e and θ e along 1 yields 5 e u sin θ e w cos θ e θ e q q p where q p θ p is referred as the desired pitch rate in order to follow reference diving path for instance q p of a straight line is zero 2 3 control objective in practical case for simplicity researchers and control engineers jalving 1994 fossen 1995 prestero 2001 li et al 2005 usually assume that 1 the surge velocity u remains close to a constant u 0 when the thrust of propeller is fixed 2 the heave velocity w is vanishingly small namely w 0 this is quite realistic since most small underwater vehicles move slowly in the vertical direction fossen 1995 they imply that the path following control system described by dynamic model 2 and kinematic model 5 can be simplified as 6 e u 0 sin θ e θ e q q p q a m q q q q m u q u 0 q m g z g z b sin θ m u u δ s u 0 2 δ s here a 1 i y y m q the control objective herein is to develop a control law δ s in 6 to force an underactuated auv to follow a specified path in the vertical plane additionally the control law should be robust in the presence of bounded disturbances and model uncertainties while guaranteeing a satisfactory performance of the vehicle 3 singular perturbation control this section presents the design of path following controller and is divided into three subsections subsection 3 1 presents the time scale analysis for auv model described by 6 which aims to mold 6 into standard singularly perturbed form subsection 3 2 provides an intuitive description of a generic two time scale system to help understanding the time scale decomposition subsection 3 3 presents the control design using a time scale decomposition method 3 1 time scale analysis it is well established that singular perturbation and hence the time scale slow fast character is often associated with a small parameter multiplying the highest derivative of the differential equation or multiplying some of the state variables of the state equation describing a physical system esteban et al 2013 however often one does not have the small parameter appearing in the above desired form or the small parameter may not be identifiable at all only by physical insight and past experience one knows that a particular dynamics has slow and fast modes naidu et al 2001 inspired by ardema and rajan 1985 i identify the time scale separation of control system 6 by using the concept of the speeds of state variable a brief introduction is given as follows consider a dynamic system y f y u u u where y ℜ n is state vector u ℜ r is control vector and u ℜ r is the set of admissible control inputs due to physical limitation or a desire the state vector y is restricted to a certain region y min i y i y max i here superscript i denotes the i th state variable of which subscript min and max represent respective minimal and maximal values the speed of a state variable is defined as 7 s i y i δ y i f i y u y max i y min i consider a reference value y of the state in the region of interest 8 s i 1 y max i y min i max u u f i y u table 1 gives a order of state variable speeds i observe that θ e and q are fast variables e is slow variable therefore control system 6 can be rewritten as following singularly perturbed form 9 e u 0 sin θ e ε θ e μ q q p ε q μ a m q q q q m u q u 0 q m g z g z b sin θ m u u δ s u 0 2 δ s here ε is an artificial small parameter in order to provide a singular perturbation analysis μ ε 3 2 intuitive description of time scale decomposition for convenience consider the standard singularly perturbed system represented by 10 x f x z ε ε z g x z ε here x e and z θ e q denote slow and fast state variables of the singularly perturbed system 9 in a domain defined by x z b x b z let z ˆ θ ˆ e q ˆ and z θ e q be the quasi steady state qss and boundary layer correction of fast state variable z θ e q respectively according to the singular perturbation theory kokotovic et al 1986 z z z ˆ and z ˆ is an associated root of degenerate equation 11 0 g x z ˆ 0 i thus compute z ˆ h x in a geometric view z ˆ h x is an invariant manifold for system 10 using these results 12 x f x h x 0 f x z ε f x h x 0 ε z g x z ε ε h x t ε h x x x and the decomposition of a two time scale system into two subsystems of lower order is done as follows 1 the fast model is obtained by setting ε to zero yet allowing ε z to be nonzero hence given by 13 d z d τ g x z h x ε here τ t ε is a stretched time scale also note x is treated as a fixed parameter in the fast model 2 the slow model is obtained by assuming the fast model has reached the equilibria thus given by 14 x f x h x 0 as long as the full dynamics is divided into two subsystems of lower order the control law can be designed in each subsystem separately 3 3 controller design in this subsection the design of path following controller is presented as illustrated in fig 2 δ s is chosen as 15 δ s δ s r m g z g z b sin θ m q q q q m u u δ s u 0 2 δ s r δ s t to cancel the nonlinear terms m g z g z b sin θ and m q q q q for simplicity this cancellation results in the system 16 e u 0 sin θ e ε θ e μ q q p ε q μ a m u q u 0 q m u u δ s u 0 2 δ s r i proceed to design δ s r to stabilize the resulting control system 16 using singular perturbation theory as noticed before the control law δ s r is naturally decomposed into two terms 17 δ s r δ s f r δ s s r where δ s s r is designed to stabilize the resulting slow model that is defined by 18 e u 0 sin θ ˆ e and δ s f r is designed to stabilize the resulting fast model that is defined by 19 d θ e d τ μ q q p d q d τ μ a m u q u 0 q m u u δ s u 0 2 δ s f r δ s s r the detailed design of δ s s r and δ s f r is as follows 3 3 1 design of δ s s r the slow model 18 will be stable by selecting a virtual simple feedback control law 20 θ ˆ e k 3 k 4 e here θ ˆ e satisfies θ ˆ e π 2 and k 3 k 4 0 to this end i resort to the degenerate equation which is expressed as 21 0 q ˆ q p 0 m u q u 0 q ˆ m u u δ s u 0 2 δ s s r inspection of the degenerate equation 21 shows that the control law δ s s r can be chosen as 22 δ s s r k 4 θ e k 3 e m u q u 0 q p m u u δ s u 0 2 to guarantee the existence of desired solution z ˆ for the degenerate equation 21 remark 1 in 20 the design parameter k 3 and k 4 are chosen properly according to the vehicle s physical limitations or a desire the choice of k 3 k 4 determines how fast the cross track error converges to zero and can be tuned so that the performance of the system is robust against bounded disturbances 3 3 2 design of δ s f r using these results the fast model 19 is put into 23 d θ e d τ μ q d q d τ μ a m u q u 0 q k 4 θ e m u u δ s u 0 2 δ s f r obviously 23 is similar to the well known damped spring mass control system in which the control law δ s f r aims to stabilize θ e and q to zero base on such characteristic a simple control law δ s f r for the fast model is chosen as 24 δ s f r 1 m u u δ s u 0 2 k 1 θ e k 2 q 1 m u u δ s u 0 2 k 1 θ e k 3 k 4 e k 2 q q p following that 25 d θ e d τ μ q d q d τ μ a m u q u 0 k 2 q k 4 k 1 θ e remark 2 a k 4 k 1 and a m u q u 0 k 2 are the coefficient of elasticity and frictional coefficient of fast controlled dynamics 25 therefore the control gains k 1 k 2 and k 4 can be selected for stabilization in term of the identity of damped spring mass control system which has been well studied ultimately the overall feedback control law δ s is given by 26 δ s 1 m u u δ s u 0 2 k 1 θ e k 3 k 4 e k 2 q q p k 4 θ e k 3 e m u q u 0 q p m g z g z b sin θ m q q q q as illustration above the main advantages of proposed method are summarized as follows 1 the resulting control law is relatively simple and thus easy to implement in reality 2 the control performance can be analyzed in each subsystem independently it leads to a reduction of control complexity 4 nonlinear stability analysis this section presents the nonlinear stability analysis for this two time scale singularly perturbed system by forming lyapunov function candidates 4 1 asymptotic stability analysis for two subsystems considering control law 26 the full system is decomposed into slow model 18 and fast model 25 in this case i select lyapunov candidates 27 v x 1 2 e 2 28 w x z 1 2 z t p z c 2 a θ e 2 1 2 θ e q p 11 p 12 p 12 p 22 θ e q c 2 a θ e 2 here a 1 b a m u q u 0 k 2 c a k 4 k 1 p 11 b a p 12 p 22 1 and p 12 p 21 b 2 a straightforward computation shows that 29 v x x f x h x 0 e u 0 sin k 3 k 4 e 30 w x z z g x z h x ε b 2 2 a 2 θ e b 2 a q c a θ e μ q b 2 a θ e q b μ q c μ θ e 1 2 μ b a q 2 c a b a θ e 2 thus these two subsystems will be stable by selecting control gains that satisfy k 3 k 4 e π 2 k 1 0 k 2 0 k 3 0 and k 4 0 4 2 asymptotic stability analysis for full system referring to saberi et al 1984 and khalil 2002 the following proposition will prove the asymptotic stability of the origin for full system 9 proposition 1 there is a composite lyapunov function u x z 1 n v x n w x z n 0 1 for proving the asymptotic stability of full system 9 if the following conditions hold 1 v x x f x h x 0 α 1 ϕ 1 2 x 2 w x z z g x z h x ε α 2 ϕ 2 2 z 3 w 1 z w x z w 2 z 4 v x x f x z h x ε f x h x 0 b 1 ϕ 1 x ϕ 2 z 5 w x z x w x z z h x x f x z h x 0 b 2 ϕ 1 x ϕ 2 z b 3 ϕ 2 2 z here ϕ i are continuous scalar positive definite functions α i are positive constants b i are nonnegative constants proof of proposition 1 step 1 the derivation of the coefficients and functions in these conditions is outlined as follows recalling 27 30 i satisfy the conditions 1 3 with α 1 2 k 3 u 0 k 4 π α 2 1 2 μ ϕ 1 x e ϕ 2 y b a q 2 b c a 2 θ e 2 w 1 z λ min θ e 2 q 2 2 w 2 z λ max c 2 a θ e 2 q 2 2 here λ min and λ max are minimum and maximum eigenvalues of matrix p respectively using these results v x x f x y h x ε f x h x 0 e u 0 sin θ e u 0 sin θ ˆ e u 0 e θ e a 2 b c u 0 ϕ 1 x ϕ 2 z and w x z x w x z z h x x f x z h x 0 k 3 k 4 b 2 2 a 2 θ e b 2 a q c a θ e b 2 a θ e q k 3 k 4 2 u 0 cos k 3 k 4 e u 0 sin θ e u 0 k 3 k 4 b 2 2 a 2 c a u 0 k 3 k 4 b 2 a θ e b 2 a u 0 k 3 k 4 q k 3 k 4 e θ e u 0 k 3 k 4 b 2 2 a 2 c a u 0 k 3 k 4 b 2 a a 2 b c b 2 a u 0 k 3 k 4 a b k 3 k 4 ϕ 1 x a 2 b c ϕ 2 z ϕ 2 z thus i satisfy the conditions 4 and 5 with b 1 a 2 b c u 0 b 2 b k 3 k 4 and b 3 b a 2 b c here b u 0 k 3 k 4 b 2 2 a 2 c a u 0 k 3 k 4 b 2 a a 2 b c b 2 a u 0 k 3 k 4 a b step 2 calculating the derivative of u x z along the trajectory of the full system 31 u x z 1 n v x x f x h x 0 n ε w x z z g x z h x ε 1 n v x x f x z ε f x h x 0 n w x z x w x z z h x x f x z ε substituting conditions 1 5 into 31 yields 32 u x z 1 n α 1 ϕ 1 2 x n ε α 2 ϕ 2 2 z 1 n b 1 ϕ 1 x ϕ 2 z n b 2 ϕ 1 x ϕ 2 z b 3 ϕ 2 2 z γ t x z λ γ x z where γ x z ϕ 1 x ϕ 2 z and 33 λ 1 n α 1 1 2 1 n b 1 1 2 n b 2 1 2 1 n b 1 1 2 n b 2 n α 2 ε b 3 therefore the derivative of u x z along the trajectory of full system is negative definite when 34 1 n α 1 n α 2 ε b 3 1 2 1 n b 1 1 2 n b 2 2 namely 35 ε α 1 α 2 α 1 b 3 1 n b 1 n b 2 2 4 n 1 n it can be seen that once inequality 35 is satisfied the origin of full system is asymptotically stable that is to say the equation ε α 1 α 2 α 1 b 3 1 n b 1 n b 2 2 4 n 1 n provides a mathematical expression for the upper bounds of the singularly perturbed parameter that defines the two time scale it must be emphasized at the same time that the bounds on the control gains are also defined when guaranteeing 0 ε ε 5 robustness analysis as is known the singularly perturbed system 10 can be viewed as an interconnection of the reduced and boundary layer subsystems the feedback connection of fig 3 therefore provides a convenient setup for studying the robustness issue in singularly perturbed system with model uncertainties and disturbances in term of the small gain theorem to depict the disturbances and unmodeled dynamics the following disturbed dynamics is used in robustness analysis 36 x f x z ε d 1 ε z g x z ε d 2 here d 1 and d 2 d 21 d 22 denote disturbances and unmodeled dynamics acting on the diving control system since environmental disturbances cannot act on kinematics directly d 1 and d 21 only account for model uncertainties specifically they are expressed as d 1 u u 0 sin θ e w cos θ e d 21 0 in the present study d 22 is given by following assumption d 22 s 0 1 s t s 1 q s 2 q q s 3 w m u w u 0 w m z g w q 2 n d m u q q m u w w u u 0 m u u δ s δ s u 2 u 0 2 3 r d d e n v 4 t h here s i 0 1 2 3 are constants the first term s 0 represents the phase lag the second and third terms both intend to valuate the model uncertainties where s 1 q s 2 q q m u w u w m z g w q s 3 w captures the effect of q and w and m u q q m u w w u u 0 m u u δ s δ s u 2 u 0 2 captures the effect of δ u the fourth term d e n v denotes the unknown environmental disturbances let me assume that d 1 and d 2 are bounded and differentiable moreover d 1 l and d 2 l following that the singularly perturbed system 36 can be rewritten as 37 x f x h x 0 f x h x d 2 0 f x h x 0 f x z h x d 2 0 f x h x d 2 0 d 1 z 1 ε g x z h x ε g x z h x d 2 ε g x z h x ε h x x h x d 2 x h x x x h x d 2 t here h x d 2 is a new quasi steady state of fast variable in case of that there exist disturbances and model uncertainties in the control system as illustration above it is not difficult to see that the closed loop system can be represented in the form of fig 3 with h 1 defined by 38 x f x h x 0 f x h x d 2 0 f x h x 0 d 1 y 2 f x h x 0 e 1 y 1 h x x h x d 2 x h x x x k 3 k 4 u 0 s i n k 3 k 4 e u 1 y 2 0 and h 2 defined by 39 z 1 ε g x z h x ε g x z h x d 2 ε g x z h x ε h x d 2 t y 1 1 ε g x z h x ε e 2 y 2 f x z h x d 2 0 f x h x d 2 0 u 0 s i n θ h x d 2 u 0 s i n h x d 2 here e 1 u 1 y 2 e 2 u 2 y 1 u 1 f x h x d 2 0 f x h x 0 d 1 u 0 s i n k 3 k 4 e d 22 k 4 u 0 s i n k 3 k 4 e d 1 u 2 1 ε g x z h x d 2 ε g x z h x ε h x d 2 t 0 d 22 d 22 k 4 q p in this representation the system h 1 is the nominal reduced closed loop system while h 2 represents the effect of the unmodeled dynamics proposition 2 system h 1 is finite gain l p stable for each p 1 proof of proposition 2 this proposition follows by theorem 5 1 of khalil 2002 if system h 1 satisfies 1 c 11 x 2 v x c 12 x 2 2 v x x f x h x 0 c 13 x 2 3 v x x c 14 x 4 f x h x 0 e 1 f x h x 0 l 1 e 1 5 y 1 η 11 x η 12 e 1 here c 11 c 12 c 13 c 14 are positive constants l 1 η 11 η 12 are nonnegative constants recalling lyapunov function v x i satisfy conditions 1 5 with c 11 c 12 1 2 c 13 2 k 3 u 0 k 4 π c 14 1 l 1 1 η 11 u 0 k 3 k 4 2 and η 12 k 3 k 4 hence for each x 0 r 1 and each p 1 the system h 1 is finite gain l p stable proposition 3 system h 2 is finite gain l p stable for each p 1 proof of proposition 3 this proposition follows by theorem 5 1 of khalil 2002 if system h 2 satisfies 1 c 21 z 2 w x z c 22 z 2 2 w x z z 1 ε g x z h x ε c 23 z 2 3 w x z z c 24 z 4 1 ε g x z h x ε e 2 1 ε g x z h x ε l 2 e 2 5 y 2 η 21 z η 22 e 2 here c 21 c 22 c 23 c 24 are positive constants l 2 η 21 and η 22 are nonnegative constants recalling lyapunov function w x z i satisfy conditions 1 5 with c 21 λ min 2 c 22 λ max c 2 a 2 c 23 1 2 b a min 1 c a c 24 b 2 2 a 2 b c a 1 l 2 1 η 21 u 0 and η 22 0 hence for each z 0 r 2 and each p 1 the system h 2 is finite gain l p stable then i have y 1 l γ 1 e 1 l β 1 a n d y 2 l γ 2 e 2 l β 2 specifically γ 1 η 12 η 11 c 12 c 14 l 1 c 11 c 13 a n d γ 2 η 22 η 21 c 22 c 24 l 2 c 21 c 23 according to the small gain theorem once γ 1 γ 2 1 is satisfied the robustness of the closed loop system is guaranteed it shows namely that as long as the surge velocity u 0 and the control gains are restricted in the region d u 0 k i 1 2 3 4 γ 1 γ 2 1 the full control system can be robustly stable even if there exists bounded unmodeled dynamics and disturbances 6 simulation results i illustrate the utility and performance of this closed loop system by the way of numerical simulation the physical and hydrodynamic characteristics used in the vehicle dynamic model are based on a model of taipan 2 used in earlier study lapierre 2009 in these simulations the vehicle model is expected to follow different desired paths in the vertical plane with the same initial conditions x 0 m and z 0 m u 0 86 m s w 0 m s θ 0 deg q 0 rad s δ s 0 deg and x u p r o p u 3 n here ε 0 005 0 038 0 132 u 0 0 866 m s e 50 θ e π 2 and q 0 5 to guarantee the asymptotic stability of diving control system the control gains are chosen as k 1 40 k 2 90 k 3 0 1 0 002 e and k 4 1 without loss of generality actuator saturation and its rate limitation are considered δ s 30 deg and δ s 5 deg s besides in order to demonstrate the robustness of the proposed controller all results are simulated by using dynamics model with environmental disturbances and model uncertainties as follows 40 u 1 m x u x u u u u x u p r o p ℓ 1 w 1 m z w z w w w w m u q z u w u w m z g q 2 z u u δ s u 2 δ s ℓ 2 q 1 i y y m q m q q q q m u q u q m u w u w m g z g z b sin θ m z g w q m u u δ s u 2 δ s ℓ 3 where ℓ 1 10 1 m x u r a n d ℓ 2 0 6 10 w 20 w w 8 q 10 1 m z w r a n d ℓ 3 0 3 10 q 15 q q 6 w 10 1 i y y m q r a n d here r a n d is the zero mean random noise with amplitude of 1 fig 4 shows the simulation results of pitch depth diving control the desired reference depths of several scenarios are as follows 1 z p 0 0 x p 50 2 z p 15 50 x p 200 3 z p 30 200 x p 350 4 z p 45 350 x p 500 5 z p 20 500 x p 650 6 z p 0 x p 650 a simple observation shows that the control law designed for a simplified model works for the original system not only stabilizing the vehicle to the equilibria but also speeding up the convergence process of slow error dynamics as i expect fig 5 shows the simulation results of following a composite reference path which is a combination of four straight lines that defined by 1 z p 0 5 x p 20 0 x p 200 2 z p 120 200 x p 400 3 z p x p 520 400 x p 500 4 z p 20 x p 500 it can be seen that the proposed controller stabilizes the vehicle to a desired straight path quickly even with large initial error besides the dynamic responses of the vehicle are sufficiently fast when pitch angles are suddenly changed due to direct transition from a straight line to another straight line at x 200 x 400 and x 500 fig 6 shows the simulation results of following a sinusoidal path z p 50 sin 0 01 x p π 2 70 comparing the desired path with actual result a good following ability of proposed controller is observed in the case of large initial error referring to all of above simulation results it can be seen that the proposed controller can follow not only straight lines but also curve paths besides the errors are sufficiently small and the good performance can be maintained even in the presence of systematical parametric uncertainties and unknown environmental disturbances therefore i come to a conclusion that these simulation results sufficiently prove the efficiency and effectiveness of the proposed controller 7 conclusion this paper has presents an alternative method for path following control of underactuated auvs a key ingredient is that the time scale separation phenomenon between translational dynamics and orientation dynamics is exploited via a singular perturbation model formulation on the basis of this analysis i design the path following controller using a time scale decomposition approach leading to a relatively simple control law it demonstrates that the control law makes the full system asymptotically stable with a lyapunov function the robustness issue in full system with bounded model uncertainties and disturbances is studied by making use of the feedback connection of singularly perturbed systems and the small gain theorem it shows that the control law also makes the full system finite gain l p stable the main advantage of this method is it allows a reduction of complexity of system control and stability analysis moreover a series of numerical simulations are conducted to illustrate the control performance the simulation results reveal that the proposed controller has effective path following performance and robustness in the presence of bounded disturbances and model uncertainties although my motivating application is to the path following of auvs in the vertical plane the singular perturbation control method is applicable to a variety of problems in auv control community in which the time scale separation widely exists for example in the surge sway roll yaw motion system of auv roll motion is much faster than the others in the horizontal path following model of auv the yaw motion is much fast than the error dynamics nonetheless many important issues still remain untouched future work will focus on disturbance rejection control based on singular perturbation technique as well as extending this approach to auvs with different configurations actuators and control objectives acknowledgments this work is supported by the national natural science foundation of china projects 51879057 51779052 and the fundamental research funds for the central universities heucfg201810 the author would like to thank professors ye li and shuo pang for helpful discussions on this work and the anonymous reviewers for their motivating comments and suggestions 
22116,this paper presents control design and nonlinear stability analysis for path following of an underactuated autonomous underwater vehicle auv with dynamics restricted to the longitudinal plane for this auv motion control system the speed of translational dynamics is much slower than that of orientation dynamics such characteristic allows for a mathematical setup which can be naturally treated by standard singular perturbation theory based on this analysis a simple control law is designed with time scale decomposition method which is able to stabilize an auv to desired diving path by selecting desired collective pitch rate and pitch angle its nonlinear stability analysis is performed by constructing lyapunov functions in term of singular perturbation method the paper also proves that the control law is robust in the presence of bounded disturbances and model uncertainties using the small gain theorem furthermore simulation results are presented to illustrate the control performance keywords autonomous underwater vehicle singular perturbation control design nonlinear stability analysis robustness analysis 1 introduction as the increase of marine activities autonomous underwater vehicles auvs gain much more attention in control design for applications in underwater monitoring and surveillance marine biology rescue and search undersea oil detection etc during the past few years many results on motion control of auvs are reported in particular the diving control problem has drawn compelling interest and a number of nonlinear control techniques have been studied to deal with the nonlinear dynamic systems with different focuses from backstepping technique lapierre 2009 xu et al 2015 sliding mode control salgado jimenez et al 2004 xu et al 2015 adaptive control narasimhan et al 2006 li et al 2005 model predictive control mpc li et al 2017 dynamic inversion di ansari and bajodah 2017 or feedback linearization pan et al 2011 to name a few neural networks nns are also parts of nonlinear control techniques which seem to provide improved robustness properties under system uncertainties for instance peng et al 2019 presented a neurodynamic optimization approach for path following control of underactuated auvs subject to velocity and input constraints as well as disturbances in addition peymani and fossen 2015 proposed a novel path following controller for auvs based on the variational principle of analytical mechanics and the lagrange multiplier method all these nonlinear control techniques mentioned above have provided new tools and promising solutions to deal with auv motion control however they usually raise the complexity of controller s structure and thus make it difficult to use them in practice yi et al 2016 moreover the time scale separation caused by different rates of numerous variables is not addressed in these existing articles therefore it is a great significance to develop a nonlinear controller which should be easy to implement in reality and handle a time scale separation it is well established that time scale separation is ubiquitous and a direct application of standard control methods without accounting for the presence of time scale multiplicity may lead to controller ill conditioning and or closed loop instability christofides 2000 hence for practical use the control and analysis of multi time scale processes are usually addressed within the framework of singular perturbations kokotovic et al 1986 ramnath 2010 in that case the time scale separation phenomenon for full dynamics results in two subsystems of lower order slow reduced and fast boundary layer subsystems which can be stabilized separately thus relatively simplifying the control problem this bright idea is appealing to researchers and control engineers its effectiveness has been extensively investigated in control and analysis of aircraft bertrand et al 2011 yan et al 2013 esteban et al 2013 2015 a comprehensive literature review of singular perturbation theory used in aircraft control can be found in naidu et al 2001 during the past two decades some attempts have also been made to address the time scale separation problems in motion control of marine vehicles using the theory of singular perturbation and time scales in canudas de wit et al 2000 a robust nonlinear feedback control was employed for an underwater vehicle manipulator uvm in bhatta et al 2008 several lyapunov based controllers were proposed for wing level flight of underwater gliders with different configurations in ren et al 2014 and yi et al 2016 two different two time scale singular perturbation control laws were developed for rudder roll stabilization rrs and path following of marine surface vessels respectively all these existing works have shown the subtle but powerful capabilities of singular perturbation theory for motion control in the field of ocean engineering however studies on auv motion control in multi time scale structure have hardly been seen in the open literature to my knowledge prestero 2001 proposed a simple inner and outer loop pd controller for the pitch depth diving motion of an underactuated auv but no analytical results are provided so it is difficult to make general conclusions about the control design and stability analysis within the framework of singular perturbations for the path following of underactuated auvs there is an obvious time scale separation phenomenon between the translational dynamics and orientation dynamics similar to that of bertrand et al 2011 therefore the theory of singular perturbation and time scales is a more suitable approach for path following control in practical ocean engineering as illustration above motivated by these observations in this paper i present the control design and stability analysis for path following of underactuated auvs using singular perturbation theory a simplified model for path following control is first given with assumptions of constant surge velocity and vanishingly small heave velocity its singular perturbation model formulation is presented by comparison of the speeds of state variables using time scale decomposition method i design a relatively simple control law and further prove that it makes the full control system asymptotically stable the robustness issue in full system with bounded model uncertainties and disturbances is also studied a unique feature of this work is that the time scale decomposition approach simplifies the design and analysis procedure of the path following control the remainder of the paper is organized as follows section 2 briefly describes the problem formulation section 3 presents the path following controller using theory of singular perturbation and time scales section 4 and section 5 present the nonlinear stability analysis and robustness analysis respectively section 6 provides simulation results for control performance illustrations section 7 summarizes the main contributions of the paper 2 problem formulation 2 1 model of an auv in the vertical plane this subsection briefly introduces a model of an underactuated auv in the vertical plane at first the inertial frame e and body frame b are defined as illustrated in fig 1 using the slender body theory the longitudinal plane is an invariant plane for an underwater vehicle dynamics if i assume that the vehicle is symmetric about the longitudinal axis and neglect lateral disturbances following that the motion of an underactuated auv in the vertical plane can be expressed by kinematic equation 1 x u cos θ w sin θ z u sin θ w cos θ θ q and dynamic equation 2 u 1 m x u x u u u u x u p r o p w 1 m z w z w w w w m u q z u w u w m z g q 2 z u u δ s u 2 δ s q 1 i y y m q m q q q q m u q u q m u w u w m g z g z b sin θ m z g w q m u u δ s u 2 δ s where x and z are the positions of vehicle relative to inertial frame e u and w are surge and heave velocity in the body frame b θ an q are pitch angle and pitch rate of vehicle m and i y y represent mass and moment of inertia of the vehicle z g and z b denote the locations of center of gravity cg and center of buoyancy cb along b 3 direction respectively δ s is the deflection angle of the stern surface see fig 1 the variables x s z s and m s denote the hydrodynamic parameters of the vertical plane dynamics of vehicle model taipan 2 in earlier study lapierre 2009 also note the vehicle model herein is assumed to be nearly neutrally buoyant 2 2 kinematic path following error in this subsection the error dynamics for path following of an auv in the vertical plane is derived as illustrated in fig 1 i define a c 1 reference diving path p d χ with a set of waypoints x i z i i 1 2 3 n p where χ 0 denotes the path variable for any point x p χ z p χ along the reference path θ p is the path tangential angle and given by 3 θ p atan 2 z p χ χ x p χ χ let e and θ e represent the cross track error and path angle tracking error referring to lekkas and fossen 2013 they can be expressed as 4 e x x p χ sin θ p z z p χ cos θ p θ e θ θ p differentiating e and θ e along 1 yields 5 e u sin θ e w cos θ e θ e q q p where q p θ p is referred as the desired pitch rate in order to follow reference diving path for instance q p of a straight line is zero 2 3 control objective in practical case for simplicity researchers and control engineers jalving 1994 fossen 1995 prestero 2001 li et al 2005 usually assume that 1 the surge velocity u remains close to a constant u 0 when the thrust of propeller is fixed 2 the heave velocity w is vanishingly small namely w 0 this is quite realistic since most small underwater vehicles move slowly in the vertical direction fossen 1995 they imply that the path following control system described by dynamic model 2 and kinematic model 5 can be simplified as 6 e u 0 sin θ e θ e q q p q a m q q q q m u q u 0 q m g z g z b sin θ m u u δ s u 0 2 δ s here a 1 i y y m q the control objective herein is to develop a control law δ s in 6 to force an underactuated auv to follow a specified path in the vertical plane additionally the control law should be robust in the presence of bounded disturbances and model uncertainties while guaranteeing a satisfactory performance of the vehicle 3 singular perturbation control this section presents the design of path following controller and is divided into three subsections subsection 3 1 presents the time scale analysis for auv model described by 6 which aims to mold 6 into standard singularly perturbed form subsection 3 2 provides an intuitive description of a generic two time scale system to help understanding the time scale decomposition subsection 3 3 presents the control design using a time scale decomposition method 3 1 time scale analysis it is well established that singular perturbation and hence the time scale slow fast character is often associated with a small parameter multiplying the highest derivative of the differential equation or multiplying some of the state variables of the state equation describing a physical system esteban et al 2013 however often one does not have the small parameter appearing in the above desired form or the small parameter may not be identifiable at all only by physical insight and past experience one knows that a particular dynamics has slow and fast modes naidu et al 2001 inspired by ardema and rajan 1985 i identify the time scale separation of control system 6 by using the concept of the speeds of state variable a brief introduction is given as follows consider a dynamic system y f y u u u where y ℜ n is state vector u ℜ r is control vector and u ℜ r is the set of admissible control inputs due to physical limitation or a desire the state vector y is restricted to a certain region y min i y i y max i here superscript i denotes the i th state variable of which subscript min and max represent respective minimal and maximal values the speed of a state variable is defined as 7 s i y i δ y i f i y u y max i y min i consider a reference value y of the state in the region of interest 8 s i 1 y max i y min i max u u f i y u table 1 gives a order of state variable speeds i observe that θ e and q are fast variables e is slow variable therefore control system 6 can be rewritten as following singularly perturbed form 9 e u 0 sin θ e ε θ e μ q q p ε q μ a m q q q q m u q u 0 q m g z g z b sin θ m u u δ s u 0 2 δ s here ε is an artificial small parameter in order to provide a singular perturbation analysis μ ε 3 2 intuitive description of time scale decomposition for convenience consider the standard singularly perturbed system represented by 10 x f x z ε ε z g x z ε here x e and z θ e q denote slow and fast state variables of the singularly perturbed system 9 in a domain defined by x z b x b z let z ˆ θ ˆ e q ˆ and z θ e q be the quasi steady state qss and boundary layer correction of fast state variable z θ e q respectively according to the singular perturbation theory kokotovic et al 1986 z z z ˆ and z ˆ is an associated root of degenerate equation 11 0 g x z ˆ 0 i thus compute z ˆ h x in a geometric view z ˆ h x is an invariant manifold for system 10 using these results 12 x f x h x 0 f x z ε f x h x 0 ε z g x z ε ε h x t ε h x x x and the decomposition of a two time scale system into two subsystems of lower order is done as follows 1 the fast model is obtained by setting ε to zero yet allowing ε z to be nonzero hence given by 13 d z d τ g x z h x ε here τ t ε is a stretched time scale also note x is treated as a fixed parameter in the fast model 2 the slow model is obtained by assuming the fast model has reached the equilibria thus given by 14 x f x h x 0 as long as the full dynamics is divided into two subsystems of lower order the control law can be designed in each subsystem separately 3 3 controller design in this subsection the design of path following controller is presented as illustrated in fig 2 δ s is chosen as 15 δ s δ s r m g z g z b sin θ m q q q q m u u δ s u 0 2 δ s r δ s t to cancel the nonlinear terms m g z g z b sin θ and m q q q q for simplicity this cancellation results in the system 16 e u 0 sin θ e ε θ e μ q q p ε q μ a m u q u 0 q m u u δ s u 0 2 δ s r i proceed to design δ s r to stabilize the resulting control system 16 using singular perturbation theory as noticed before the control law δ s r is naturally decomposed into two terms 17 δ s r δ s f r δ s s r where δ s s r is designed to stabilize the resulting slow model that is defined by 18 e u 0 sin θ ˆ e and δ s f r is designed to stabilize the resulting fast model that is defined by 19 d θ e d τ μ q q p d q d τ μ a m u q u 0 q m u u δ s u 0 2 δ s f r δ s s r the detailed design of δ s s r and δ s f r is as follows 3 3 1 design of δ s s r the slow model 18 will be stable by selecting a virtual simple feedback control law 20 θ ˆ e k 3 k 4 e here θ ˆ e satisfies θ ˆ e π 2 and k 3 k 4 0 to this end i resort to the degenerate equation which is expressed as 21 0 q ˆ q p 0 m u q u 0 q ˆ m u u δ s u 0 2 δ s s r inspection of the degenerate equation 21 shows that the control law δ s s r can be chosen as 22 δ s s r k 4 θ e k 3 e m u q u 0 q p m u u δ s u 0 2 to guarantee the existence of desired solution z ˆ for the degenerate equation 21 remark 1 in 20 the design parameter k 3 and k 4 are chosen properly according to the vehicle s physical limitations or a desire the choice of k 3 k 4 determines how fast the cross track error converges to zero and can be tuned so that the performance of the system is robust against bounded disturbances 3 3 2 design of δ s f r using these results the fast model 19 is put into 23 d θ e d τ μ q d q d τ μ a m u q u 0 q k 4 θ e m u u δ s u 0 2 δ s f r obviously 23 is similar to the well known damped spring mass control system in which the control law δ s f r aims to stabilize θ e and q to zero base on such characteristic a simple control law δ s f r for the fast model is chosen as 24 δ s f r 1 m u u δ s u 0 2 k 1 θ e k 2 q 1 m u u δ s u 0 2 k 1 θ e k 3 k 4 e k 2 q q p following that 25 d θ e d τ μ q d q d τ μ a m u q u 0 k 2 q k 4 k 1 θ e remark 2 a k 4 k 1 and a m u q u 0 k 2 are the coefficient of elasticity and frictional coefficient of fast controlled dynamics 25 therefore the control gains k 1 k 2 and k 4 can be selected for stabilization in term of the identity of damped spring mass control system which has been well studied ultimately the overall feedback control law δ s is given by 26 δ s 1 m u u δ s u 0 2 k 1 θ e k 3 k 4 e k 2 q q p k 4 θ e k 3 e m u q u 0 q p m g z g z b sin θ m q q q q as illustration above the main advantages of proposed method are summarized as follows 1 the resulting control law is relatively simple and thus easy to implement in reality 2 the control performance can be analyzed in each subsystem independently it leads to a reduction of control complexity 4 nonlinear stability analysis this section presents the nonlinear stability analysis for this two time scale singularly perturbed system by forming lyapunov function candidates 4 1 asymptotic stability analysis for two subsystems considering control law 26 the full system is decomposed into slow model 18 and fast model 25 in this case i select lyapunov candidates 27 v x 1 2 e 2 28 w x z 1 2 z t p z c 2 a θ e 2 1 2 θ e q p 11 p 12 p 12 p 22 θ e q c 2 a θ e 2 here a 1 b a m u q u 0 k 2 c a k 4 k 1 p 11 b a p 12 p 22 1 and p 12 p 21 b 2 a straightforward computation shows that 29 v x x f x h x 0 e u 0 sin k 3 k 4 e 30 w x z z g x z h x ε b 2 2 a 2 θ e b 2 a q c a θ e μ q b 2 a θ e q b μ q c μ θ e 1 2 μ b a q 2 c a b a θ e 2 thus these two subsystems will be stable by selecting control gains that satisfy k 3 k 4 e π 2 k 1 0 k 2 0 k 3 0 and k 4 0 4 2 asymptotic stability analysis for full system referring to saberi et al 1984 and khalil 2002 the following proposition will prove the asymptotic stability of the origin for full system 9 proposition 1 there is a composite lyapunov function u x z 1 n v x n w x z n 0 1 for proving the asymptotic stability of full system 9 if the following conditions hold 1 v x x f x h x 0 α 1 ϕ 1 2 x 2 w x z z g x z h x ε α 2 ϕ 2 2 z 3 w 1 z w x z w 2 z 4 v x x f x z h x ε f x h x 0 b 1 ϕ 1 x ϕ 2 z 5 w x z x w x z z h x x f x z h x 0 b 2 ϕ 1 x ϕ 2 z b 3 ϕ 2 2 z here ϕ i are continuous scalar positive definite functions α i are positive constants b i are nonnegative constants proof of proposition 1 step 1 the derivation of the coefficients and functions in these conditions is outlined as follows recalling 27 30 i satisfy the conditions 1 3 with α 1 2 k 3 u 0 k 4 π α 2 1 2 μ ϕ 1 x e ϕ 2 y b a q 2 b c a 2 θ e 2 w 1 z λ min θ e 2 q 2 2 w 2 z λ max c 2 a θ e 2 q 2 2 here λ min and λ max are minimum and maximum eigenvalues of matrix p respectively using these results v x x f x y h x ε f x h x 0 e u 0 sin θ e u 0 sin θ ˆ e u 0 e θ e a 2 b c u 0 ϕ 1 x ϕ 2 z and w x z x w x z z h x x f x z h x 0 k 3 k 4 b 2 2 a 2 θ e b 2 a q c a θ e b 2 a θ e q k 3 k 4 2 u 0 cos k 3 k 4 e u 0 sin θ e u 0 k 3 k 4 b 2 2 a 2 c a u 0 k 3 k 4 b 2 a θ e b 2 a u 0 k 3 k 4 q k 3 k 4 e θ e u 0 k 3 k 4 b 2 2 a 2 c a u 0 k 3 k 4 b 2 a a 2 b c b 2 a u 0 k 3 k 4 a b k 3 k 4 ϕ 1 x a 2 b c ϕ 2 z ϕ 2 z thus i satisfy the conditions 4 and 5 with b 1 a 2 b c u 0 b 2 b k 3 k 4 and b 3 b a 2 b c here b u 0 k 3 k 4 b 2 2 a 2 c a u 0 k 3 k 4 b 2 a a 2 b c b 2 a u 0 k 3 k 4 a b step 2 calculating the derivative of u x z along the trajectory of the full system 31 u x z 1 n v x x f x h x 0 n ε w x z z g x z h x ε 1 n v x x f x z ε f x h x 0 n w x z x w x z z h x x f x z ε substituting conditions 1 5 into 31 yields 32 u x z 1 n α 1 ϕ 1 2 x n ε α 2 ϕ 2 2 z 1 n b 1 ϕ 1 x ϕ 2 z n b 2 ϕ 1 x ϕ 2 z b 3 ϕ 2 2 z γ t x z λ γ x z where γ x z ϕ 1 x ϕ 2 z and 33 λ 1 n α 1 1 2 1 n b 1 1 2 n b 2 1 2 1 n b 1 1 2 n b 2 n α 2 ε b 3 therefore the derivative of u x z along the trajectory of full system is negative definite when 34 1 n α 1 n α 2 ε b 3 1 2 1 n b 1 1 2 n b 2 2 namely 35 ε α 1 α 2 α 1 b 3 1 n b 1 n b 2 2 4 n 1 n it can be seen that once inequality 35 is satisfied the origin of full system is asymptotically stable that is to say the equation ε α 1 α 2 α 1 b 3 1 n b 1 n b 2 2 4 n 1 n provides a mathematical expression for the upper bounds of the singularly perturbed parameter that defines the two time scale it must be emphasized at the same time that the bounds on the control gains are also defined when guaranteeing 0 ε ε 5 robustness analysis as is known the singularly perturbed system 10 can be viewed as an interconnection of the reduced and boundary layer subsystems the feedback connection of fig 3 therefore provides a convenient setup for studying the robustness issue in singularly perturbed system with model uncertainties and disturbances in term of the small gain theorem to depict the disturbances and unmodeled dynamics the following disturbed dynamics is used in robustness analysis 36 x f x z ε d 1 ε z g x z ε d 2 here d 1 and d 2 d 21 d 22 denote disturbances and unmodeled dynamics acting on the diving control system since environmental disturbances cannot act on kinematics directly d 1 and d 21 only account for model uncertainties specifically they are expressed as d 1 u u 0 sin θ e w cos θ e d 21 0 in the present study d 22 is given by following assumption d 22 s 0 1 s t s 1 q s 2 q q s 3 w m u w u 0 w m z g w q 2 n d m u q q m u w w u u 0 m u u δ s δ s u 2 u 0 2 3 r d d e n v 4 t h here s i 0 1 2 3 are constants the first term s 0 represents the phase lag the second and third terms both intend to valuate the model uncertainties where s 1 q s 2 q q m u w u w m z g w q s 3 w captures the effect of q and w and m u q q m u w w u u 0 m u u δ s δ s u 2 u 0 2 captures the effect of δ u the fourth term d e n v denotes the unknown environmental disturbances let me assume that d 1 and d 2 are bounded and differentiable moreover d 1 l and d 2 l following that the singularly perturbed system 36 can be rewritten as 37 x f x h x 0 f x h x d 2 0 f x h x 0 f x z h x d 2 0 f x h x d 2 0 d 1 z 1 ε g x z h x ε g x z h x d 2 ε g x z h x ε h x x h x d 2 x h x x x h x d 2 t here h x d 2 is a new quasi steady state of fast variable in case of that there exist disturbances and model uncertainties in the control system as illustration above it is not difficult to see that the closed loop system can be represented in the form of fig 3 with h 1 defined by 38 x f x h x 0 f x h x d 2 0 f x h x 0 d 1 y 2 f x h x 0 e 1 y 1 h x x h x d 2 x h x x x k 3 k 4 u 0 s i n k 3 k 4 e u 1 y 2 0 and h 2 defined by 39 z 1 ε g x z h x ε g x z h x d 2 ε g x z h x ε h x d 2 t y 1 1 ε g x z h x ε e 2 y 2 f x z h x d 2 0 f x h x d 2 0 u 0 s i n θ h x d 2 u 0 s i n h x d 2 here e 1 u 1 y 2 e 2 u 2 y 1 u 1 f x h x d 2 0 f x h x 0 d 1 u 0 s i n k 3 k 4 e d 22 k 4 u 0 s i n k 3 k 4 e d 1 u 2 1 ε g x z h x d 2 ε g x z h x ε h x d 2 t 0 d 22 d 22 k 4 q p in this representation the system h 1 is the nominal reduced closed loop system while h 2 represents the effect of the unmodeled dynamics proposition 2 system h 1 is finite gain l p stable for each p 1 proof of proposition 2 this proposition follows by theorem 5 1 of khalil 2002 if system h 1 satisfies 1 c 11 x 2 v x c 12 x 2 2 v x x f x h x 0 c 13 x 2 3 v x x c 14 x 4 f x h x 0 e 1 f x h x 0 l 1 e 1 5 y 1 η 11 x η 12 e 1 here c 11 c 12 c 13 c 14 are positive constants l 1 η 11 η 12 are nonnegative constants recalling lyapunov function v x i satisfy conditions 1 5 with c 11 c 12 1 2 c 13 2 k 3 u 0 k 4 π c 14 1 l 1 1 η 11 u 0 k 3 k 4 2 and η 12 k 3 k 4 hence for each x 0 r 1 and each p 1 the system h 1 is finite gain l p stable proposition 3 system h 2 is finite gain l p stable for each p 1 proof of proposition 3 this proposition follows by theorem 5 1 of khalil 2002 if system h 2 satisfies 1 c 21 z 2 w x z c 22 z 2 2 w x z z 1 ε g x z h x ε c 23 z 2 3 w x z z c 24 z 4 1 ε g x z h x ε e 2 1 ε g x z h x ε l 2 e 2 5 y 2 η 21 z η 22 e 2 here c 21 c 22 c 23 c 24 are positive constants l 2 η 21 and η 22 are nonnegative constants recalling lyapunov function w x z i satisfy conditions 1 5 with c 21 λ min 2 c 22 λ max c 2 a 2 c 23 1 2 b a min 1 c a c 24 b 2 2 a 2 b c a 1 l 2 1 η 21 u 0 and η 22 0 hence for each z 0 r 2 and each p 1 the system h 2 is finite gain l p stable then i have y 1 l γ 1 e 1 l β 1 a n d y 2 l γ 2 e 2 l β 2 specifically γ 1 η 12 η 11 c 12 c 14 l 1 c 11 c 13 a n d γ 2 η 22 η 21 c 22 c 24 l 2 c 21 c 23 according to the small gain theorem once γ 1 γ 2 1 is satisfied the robustness of the closed loop system is guaranteed it shows namely that as long as the surge velocity u 0 and the control gains are restricted in the region d u 0 k i 1 2 3 4 γ 1 γ 2 1 the full control system can be robustly stable even if there exists bounded unmodeled dynamics and disturbances 6 simulation results i illustrate the utility and performance of this closed loop system by the way of numerical simulation the physical and hydrodynamic characteristics used in the vehicle dynamic model are based on a model of taipan 2 used in earlier study lapierre 2009 in these simulations the vehicle model is expected to follow different desired paths in the vertical plane with the same initial conditions x 0 m and z 0 m u 0 86 m s w 0 m s θ 0 deg q 0 rad s δ s 0 deg and x u p r o p u 3 n here ε 0 005 0 038 0 132 u 0 0 866 m s e 50 θ e π 2 and q 0 5 to guarantee the asymptotic stability of diving control system the control gains are chosen as k 1 40 k 2 90 k 3 0 1 0 002 e and k 4 1 without loss of generality actuator saturation and its rate limitation are considered δ s 30 deg and δ s 5 deg s besides in order to demonstrate the robustness of the proposed controller all results are simulated by using dynamics model with environmental disturbances and model uncertainties as follows 40 u 1 m x u x u u u u x u p r o p ℓ 1 w 1 m z w z w w w w m u q z u w u w m z g q 2 z u u δ s u 2 δ s ℓ 2 q 1 i y y m q m q q q q m u q u q m u w u w m g z g z b sin θ m z g w q m u u δ s u 2 δ s ℓ 3 where ℓ 1 10 1 m x u r a n d ℓ 2 0 6 10 w 20 w w 8 q 10 1 m z w r a n d ℓ 3 0 3 10 q 15 q q 6 w 10 1 i y y m q r a n d here r a n d is the zero mean random noise with amplitude of 1 fig 4 shows the simulation results of pitch depth diving control the desired reference depths of several scenarios are as follows 1 z p 0 0 x p 50 2 z p 15 50 x p 200 3 z p 30 200 x p 350 4 z p 45 350 x p 500 5 z p 20 500 x p 650 6 z p 0 x p 650 a simple observation shows that the control law designed for a simplified model works for the original system not only stabilizing the vehicle to the equilibria but also speeding up the convergence process of slow error dynamics as i expect fig 5 shows the simulation results of following a composite reference path which is a combination of four straight lines that defined by 1 z p 0 5 x p 20 0 x p 200 2 z p 120 200 x p 400 3 z p x p 520 400 x p 500 4 z p 20 x p 500 it can be seen that the proposed controller stabilizes the vehicle to a desired straight path quickly even with large initial error besides the dynamic responses of the vehicle are sufficiently fast when pitch angles are suddenly changed due to direct transition from a straight line to another straight line at x 200 x 400 and x 500 fig 6 shows the simulation results of following a sinusoidal path z p 50 sin 0 01 x p π 2 70 comparing the desired path with actual result a good following ability of proposed controller is observed in the case of large initial error referring to all of above simulation results it can be seen that the proposed controller can follow not only straight lines but also curve paths besides the errors are sufficiently small and the good performance can be maintained even in the presence of systematical parametric uncertainties and unknown environmental disturbances therefore i come to a conclusion that these simulation results sufficiently prove the efficiency and effectiveness of the proposed controller 7 conclusion this paper has presents an alternative method for path following control of underactuated auvs a key ingredient is that the time scale separation phenomenon between translational dynamics and orientation dynamics is exploited via a singular perturbation model formulation on the basis of this analysis i design the path following controller using a time scale decomposition approach leading to a relatively simple control law it demonstrates that the control law makes the full system asymptotically stable with a lyapunov function the robustness issue in full system with bounded model uncertainties and disturbances is studied by making use of the feedback connection of singularly perturbed systems and the small gain theorem it shows that the control law also makes the full system finite gain l p stable the main advantage of this method is it allows a reduction of complexity of system control and stability analysis moreover a series of numerical simulations are conducted to illustrate the control performance the simulation results reveal that the proposed controller has effective path following performance and robustness in the presence of bounded disturbances and model uncertainties although my motivating application is to the path following of auvs in the vertical plane the singular perturbation control method is applicable to a variety of problems in auv control community in which the time scale separation widely exists for example in the surge sway roll yaw motion system of auv roll motion is much faster than the others in the horizontal path following model of auv the yaw motion is much fast than the error dynamics nonetheless many important issues still remain untouched future work will focus on disturbance rejection control based on singular perturbation technique as well as extending this approach to auvs with different configurations actuators and control objectives acknowledgments this work is supported by the national natural science foundation of china projects 51879057 51779052 and the fundamental research funds for the central universities heucfg201810 the author would like to thank professors ye li and shuo pang for helpful discussions on this work and the anonymous reviewers for their motivating comments and suggestions 
22117,the impact performances of one monolithic cylinder and two sandwich cylinders during water entry are investigated by sph method which is validated by an existing experiment the first cylinder is made of aluminum alloy al cylinder the second cylinder is made up of polyurethane core and aluminum alloy layers al pu al cylinder and the third cylinder is made up of aluminum alloy core and polyurethane layers pu al pu cylinder all the cylinders have the same size the research shows that the stress levels and deformations of the cylinders are closely related to the impact forces and their inherent strengths and stiffnesses the deficiency of the al pu al cylinder lies in its poor inherent strength and stiffness resulting in the greatest stress level and deformation under the same initial conditions the deficiency of the al cylinder lies in its large impact force at the same initial velocity which may lead to a high stress level in contrast the impact force and inherent strength and stiffness of pu al pu cylinder are moderate contributing to a lowest stress level at the same initial velocity and a stress level slightly higher than that of al cylinder at the same initial kinetic energy keywords sandwich cylinder water entry sph method impact force stress deformation 1 introduction 1 1 research status of water entry solid hitting water is a kind of physical phenomenon which is commonly occurred in both natural world and engineering field a seabird diving quickly into the water when catching fish a jumping fish falling back into the water a frog jumping into the stream from the shore a rock rolling down into the river a seaplane landing on the sea a broken down airplane crashing lands on the water a re entry module landing on the sea a new ship being launching a missile penetrating into the water as early as 1900 worthington observes the splash pattern and air bubble during the process of a ball falling into the water by means of photographic technology worthington 1900 as the pioneering experimental study it initiated the first stage of research on water entry bell 1924 and maccoll 1928 summarize the mechanism of air bubble generation and evolution based on experimental observations watanabe conducts an experiment of cone hitting water and measures the change law of impact load in the time domain watanabe 1930 these early experimental studies have important inspiration and reference significances for later researches after more than a century of development experiments are still a kind of important means to study the problem of water entry taking the experimental researches in the last 3 years as an example jiang et al carry out an experiment on the water entry of a projectile and investigate the influence of attitude angle and ventilation rate jiang et al 2018 vincent et al carry out experimental studies on the impact force of the wedge body into the water and the water splash pattern the results of which are in line with the results based on a modified mechanical model vincent et al 2018 hassoon et al conduct an experimental study on the mechanical behavior of composite structures hitting water at a constant impact speed hassoon et al 2018a based on semi analytical models and experimental method shams study the hydro elastic slamming on flexible wedges during the process of water entry and exit adel shams et al 2017 hurd et al study the water entry laws of deformable spheres with the help of high speed camera and image processing techniques hurd et al 2017 chen et al test the effect of inclination velocity and attack angle on the water entry of a vehicle to determine the influencing factors on the bounce behavior chen et al 2017 barjasteh et al provide experimental reference for the water entry of asymmetric wedge focusing on the influence of parameters such as bottom angle inclination and impact velocity barjastehhamid and javaherian 2016 generally speaking the result of experimental test is reliable therefore it is always used to verify the effectiveness of analytical and numerical models however the deficiencies like high costs and long operating duration constitute the limitations of water entry experiments sun et al 2018 the earliest analytical model is proposed in 1929 by von karman who abstracts the pontoon model of the seaplane into a two dimensional wedge and presents the von karman model based on the momentum theorem von karman 1929 wagner linearizes the free surface and bernoulli equation and then proposes the wagner model based on equivalent plate theory which lays the foundation for the analytical method of water entry impact wagner 1932 based on the wagner model the original logvinovich model the improved logvinovich model and the generalized wagner model are put forward so that the analytical model of water entry is more and more fine korobkin systematically introduces the mathematical methods of these analytical models and the relations among them alexander 2004 in addition under the framework of wagner s theory korobkin accurately analyzes the water entry of elliptic paraboloid at variable speed and investigates the influence of impact conditions and the surface shape on the impact force and acceleration korobkin 2002 scolan and korobkin make a precise theoretical analysis of the three dimensional water entry from the perspective of energy conservation scolan and korobkin 2003 jalalisendi et al study the rigid body motion and elastic deformation of a beam hitting water in free fall and prove the analytical results experimentally jalalisendi and porfiri 2018 furthermore jalalisendi et al also establish an analytical model of shallow water entry and make a research on the shallow water entry of wedges jalalisendi et al 2017 in general the analytical model is suitable for the structure with a simple geometry oliver 2002 such as wedge plate cylinder parabola etc however the analytical method may be difficult to investigate the water entry of complex structures in engineering applications structural features and boundary conditions are often complex so it is generally difficult to give accurate solutions on the other hand excessive reliance on experimentation may be inefficient and uneconomical taking into account the research cycle and costs with low cost and high efficiency the numerical method could complement the analytical and experimental methods at present in the field of water entry impact numerical methods mainly include finite element method fem finite volume method fvm boundary element method bem constrained interpolation profile cip volume of fluid vof smoothed particle hydrodynamics sph etc derakhshanian et al develop a numerical simulation tool for oblique water entry problems and test its reliability saeed derakhshanian et al 2018 xie et al study the problem of water entry of composite hulls by means of cfd fem coupled algorithm xie et al 2018 yu et al study the water entry of curved wedges using explicit fem yu et al 2018 elhimer et al study the impact of rigid cones on the mixture surface of gas and liquid using explicit fem methods elhimer et al 2017 wang et al study the water impact of three dimensional buoys by using explicit fem wang and soares 2014 hassoon et al use fem method to study the dynamic response of the water impact on flexible composite structures hassoon et al 2018b bilandi et al simulate the vertical water impact of asymmetric wedges on the basis of a combination of fvm and vof rasul niazmand bilandi et al 2018 facci et al make a research on a three dimensional water entry problem of a multi curvature structure by using the combination of fvm and vof andrea 2016 nair et al study the water entry and exit of the axial symmetry structure and track the free surface by means of vof nair and bhattacharyya 2018 iranmanesh et al make a research on the horizontal water entry of three dimensional cylinders with low froude numbers by using vof and investigate the effect of geometric parameters velocity and density on the dimensionless depth iranmanesh and passandideh fard 2017 cheng et al study the problem of the water entry of a wedge subjected to water wave on the basis of higher order bem cheng et al 2018 bao et al make a research on the water entry of a two dimensional oblique wedge using bem in time domain bao et al 2016 wen et al use cip to study the problem of three dimensional water entry wen and qiu 2018 yang et al make a research on the water impact of a two dimensional wedge and a three dimensional cylinder and a catamaran based on cip yang and qiu 2012 this paper uses the sph method the research status of which is detailed in part 1 2 1 2 research status of sph method sph is a meshless lagrangian algorithm first proposed by lucy 1977 and gingold and monaghan 1977 respectively in 1977 it is first used to solve the fission problem of fast rotating stars then monaghan et al introduces the sph method into the numerical calculation of fluid monaghan and gingold 1983 monaghan 1988 1994 monaghan and münzel introduce the basic principles of sph method at length in their works respectively monaghan 1992 münzel 1996 these pioneering studies lay the foundation for the further development of the sph method after entering the 21st century new research and application results have appeared in the field of sph müller makes a research on the strategy for sph method to be applied to fluid simulation and advises several kernel functions müller et al 2003 parshikov et al propose an algorithm of contact interaction between particles parshikov and medin 2002 shao et al present an incompressible sph method which could be used to analyze the newtonian and non newtonian flows with free surfaces shaoedmond and lo 2003 owen gives the tensor generalization of monaghan gingold artificial viscosity michael owen 2004 ata et al solve the problem of inviscid shallow water flows by using sph method ata and soulaïmani 2005 hu et al propose the sph method for multiphase flow and solve the problem of density discontinuity of cross phase interface hu and adams 2006 khayyer et al modify the incompressible sph model to track the surface of the broken waves based on the variable separation method khayyer et al 2008 monaghan et al propose a simple efficient and robust sph algorithm to solve the problem of multifluid flow monaghan and rafiee 2013 crespo et al develop a sph code named dualsphysics which could be used to solve the problems of free surface flow crespo et al 2015 akinci et al present a two way rigid fluid coupling method which is based on momentum conservation and could be used for incompressible sph model akinci et al 2012 yan et al expand the multiphase flow sph algorithm to make it suitable for deformable solid and granular materials yan et al 2016 zhou et al improve the interfacial pressure algorithm of sph model which is used to investigate multiphase flows with large density ratios zhou et al 2016 water impact is a special problem of fluid structure coupling which occurs during the relative movement between water and structures based on sph method monaghan et al investigate the motion of water caused by the impact of a rectangular body which slides down a slope and enters into the water monaghan et al 2003 kulasegaram et al propose an improvement measure to deal with the contact between sph particles and rigid solid boundary kulasegaram et al 2004 gómez gesteira et al make a research on the damage of overtopping wave to offshore platforms and ship decks by using sph method gómez gesteira et al 2005 dalrymple et al improve the sph models in terms of turbulence viscosity density and time integration to simulate the broken waves overtopping wave and the interaction of waves and structures dalrymple and rogers 2006 oger et al build a sph model and introduce a new technique based on particle sampling to evaluate fluid pressure on solid boundaries in response to the water entry of two dimensional wedges oger et al 2006 crespo et al build a 3d sph model to investigate the interaction between a large wave and a dike crespo et al 2007 panciroli et al study hydroelasticity combined with an elastic wedge panciroli et al 2012 nair et al study the energy transfer during the process of several 2 d cylinders hitting water based on an incompressible model nair and tomar 2017 farsi et al discuss the best combination of numerical schemes for 2 d sph simulation of wedge water entry farsi and ghadimi 2014 sun et al investigate the violent interactions between rigid body and free surface based on sph method which is robust and weakly compressible sun et al 2015 ghazanfarian et al study the 2 d water entry and water exit of a rotating circular cylinder using the sub particle scale turbulence model of a lagrangian particle based sph method ghazanfarian et al 2015 ji et al present a large scale water entry simulation with smoothed particle hydrodynamics framework using the parallel architecture of single and multi gpu systems ji et al 2016 2 sph method 2 1 standard sph equations the sph code used in this paper is modified on the basis of liu s sph code liu and liu 2003 liu et al use the standard sph equations which are given by 1 d ρ i d t j 1 n m j v i β v j β w i j x i β d v i α d t j 1 n m j σ i α β ρ i 2 σ j α β ρ j 2 π i j w i j x i β d e i d t 1 2 j 1 n m j p i ρ i 2 p j ρ j 2 π i j v i β v j β w i j x i β 1 2 ρ i τ i α β ε j α β h i d x i α d t v i α where ρ denotes the density v denotes the velocity vector e denotes the internal energy t denotes the time m denotes the mass w denotes the kernel function x denotes the displacement vector σ denotes the stress tensor p denotes the isotropic pressure τ denotes the viscous shear stress ε denotes the strain rate tensor π denotes the artificial viscosity monaghan 1989 h denotes the artificial heat monaghan n denotes the number of particles in the support domain of particle i the superscripts α and β are the labels of index method and the subscripts i and j denote ordinal number of the particles however liu s sph code is a solution to the fluid problem improvements are needed to make it suitable for the problem of solid hitting water these improvements are mainly carried out in respects of sph equations kernel function and constitutive and state equations which are detailed in parts 2 2 to 2 4 2 2 modified sph equations the sph equations are modified on the basis of two aspects one is the interfacial force between solid and fluid and the other is the tensile instability of solids monaghan et al propose an interfacial force suitable for arbitrary boundaries which is given by monaghan and kajtar 2009 2 f i ι k β r i ι r i ι 2 w r i ι h 2 m i m i m ι where the subscript i and ι denotes the fluid particle i and the boundary particle ι respectively k is a constant related to the relative velocity of solid and fluid β is a constant related to kernel function r i ι denotes the radius vector between the fluid particle and the boundary particle r i ι denotes the distance between the fluid particle and the boundary particle and h denotes the smoothing length the constant k is given by 3 k 0 01 c s 2 v 2 where c s 10 v is the velocity of sound and v is the maximum speed of solid relative to the fluid the kernel function w and the constant β is given in part 2 3 after considering the interfacial force the acceleration in equation 1 may be corrected to 4 d v i α d t j 1 n f m j σ i α β ρ i 2 σ j α β ρ j 2 π i j w i j x i β k 1 n b ι 1 n k f i ι m ι π i ι w i j x i β where k denotes the solid body k n f denotes the number of fluid particles in the support domain of the fluid particle i n k denotes the number of boundary particles of the solid body k and n b denotes the number of solid bodies the tensile instability is not taken into account by the standard sph equations it may lead to abnormal deformation of the sph model especially the solid sph model in order to remove the tensile instability monaghan advises an artificial stress which is given by monaghan 2000 5 r i j α β r i α β r j α β where 6 a r i α β ε σ i α β σ i α β 0 0 σ i α β 0 and 6 b r j α β ε σ j α β σ j α β 0 0 σ j α β 0 in equations 6 a and 6 b ε is a constant coefficient and takes the value of 0 2 monaghan 2000 the acceleration given by equation 4 may be further corrected to 7 d v i α d t j 1 n f m j σ i α β ρ i 2 σ j α β ρ j 2 π i j r i j α β f i j n w i j x i β k 1 n b ι 1 n k f i ι m ι π i ι w i j x i β where f i j n w r i j w δ p δ p denotes the average particle spacing in the neighborhood of particle i and n takes the value of 4 monaghan 2000 in addition monaghan also advises that the particles be moved using an average velocity as a result the velocity in equation 1 may be corrected to 8 d x i α d t v i α 0 5 j m j ρ i j v j α v i α w i j replacing the acceleration equation and the velocity equation in equation 1 with equations 7 and 8 the sph equations may eventually be modified as 9 d ρ i d t j 1 n m j v i β v j β w i j x i β d v i α d t j 1 n m j σ i α β ρ i 2 σ j α β ρ j 2 π i j r i j α β f i j n w i j x i β k 1 n b ι 1 n k f i ι m ι π i ι w i j x i β d e i d t 1 2 j 1 n m j p i ρ i 2 p j ρ j 2 π i j v i β v j β w i j x i β 1 2 ρ i τ i α β ε j α β h i d x i α d t v i α 0 5 j m j ρ i j v j α v i α w i j 2 3 kernel function in standard sph method the cubic spline function is used as a kernel function given by liu and liu 2003 10 w r h α 2 3 q 2 1 2 q 3 0 q 1 1 6 2 q 3 1 q 2 0 q 2 where q r h r denotes the particle spacing and α is a constant equaling to 1 h 15 7 π h 2 and 3 2 π h 3 respectively in the case of 1 d 2 d and 3 d dimensions some scholars have been focusing on the wendland kernel function which is given by canelas 2015 11 w r h 7 64 π h 2 1 2 q 2 q 4 q 2 0 q 2 canelas compares the cubic spline function with the wendland function canelas 2015 the cubic spline function and the wendland function are normalized as shown in fig 1 the first and second derivative of the two normalized functions are shown in fig 2 and fig 3 respectively from these three figures it may be seen that the wendland function is similar to the cubic spline function the first derivative of the two is similar as well and the difference is that the second derivative of the wendland function is smoother some scholars have compared the application effects of cubic spline function and wendland function according to monaghan the results obtained by using the two kernel functions are similar but the distribution of particles is more uniform when using the wendland kernel function monaghan 2013 dehnen and alya prove that the use of wendland kernel function may better avoid particle instability walter and aly 2012 for the above considerations this paper uses the wendland function as the kernel function in addition the smooth length is highly correlated with the kernel function as may be seen from equation 11 q r h is greater than or equal to 0 and less than 2 according to monaghan 2013 and walter and aly 2012 q r h is equal to 1 5 this will be followed in this paper as mentioned in part 2 2 the constant β is related to kernel function monaghan et al advise that β 2 when the wendland 2d quartic is used for the fluid dynamics monaghan and kajtar 2009 2 4 constitutive and state equations the constitutive equation is given by gray et al 2001 12 σ α β p δ α β τ α β where δ α β denotes the kronecker symbol which is given by 13 δ α β 1 α β 0 α β for newtonian fluid the τ α β is given by gray et al 2001 14 τ α β μ ε α β where μ denotes the viscosity coefficient 15 ε α β 1 2 v α x β v β x α for elastic solid the τ α β is given by gray et al 2001 16 τ α β τ α γ ω β γ ω α γ τ β γ 2 g ε α β 1 3 δ α β ε γ γ where ω denotes the rotation tensor and g denotes the shear modulus ω and g are given by gray et al 2001 e green and zerna 2012 17 ω 1 2 v α x β v β x α and 18 g e 2 1 υ where e denotes the young modulus and ν denotes the poisson s ratio the equation of state is given by libersky et al 1993 19 p 1 1 2 γ ρ ρ 0 1 p h γ ρ e where ρ 0 denotes the reference density the subscript h denotes the hugoniot curvilinear function γ is the gruneisen parameter and is given by 20 p h a 0 ρ ρ 0 1 b 0 ρ ρ 0 1 2 c 0 ρ ρ 0 1 3 ρ ρ 0 a 0 ρ ρ 0 1 ρ ρ 0 the parameters a 0 b 0 and c 0 are given by 21 a 0 ρ 0 c s 2 b 0 a 0 1 2 s s 1 c 0 a 0 2 s s 1 3 s s 1 2 the parameters c s and s s are contained in the linear impact velocity relation which is given by 22 u s c s s s u p where u s denotes the impact speed u p denotes the particle speed c s denotes the linear correlation between the impact speed and the particle speed and s s denotes the slope 2 5 method validation the sph method used in this paper is validated by comparing it with an existing experiment given by sun and faltinsen 2006 the experiment uses a cylindrical shell made of al the outer diameter of the cylindrical shell is 306 mm the wall thickness is 3 mm and the length is 600 mm the density of al is 2700 kg m3 young s modulus is 73 50 gpa and the poisson s ratio is 0 34 the cylindrical shell falls from a height of 1m above the water surface and touches the water at a speed of 4 429 m s the strain at the bottom of the inner surface of the cylindrical shell is tested in the experiment here a two dimensional sph model is used to simulate the above cylindrical shell hitting water the geometric and material parameters of the cylindrical shell in the sph model is the same as that in the experiment other relevant material parameters are the same as those in table 2 given by part 3 3 the overall model is shown in fig 4 and the detail of the particles is given by fig 5 the size of the water domain in the sph model is 1 m 0 5 m the top edge of water domain is a free surface the side and the bottom edges of water domain is the walls which are treated by means of ghost particles oger et al 2006 the moment the cylindrical shell just touches the water surface is defined as the initial moment according to the experimental conditions the initial velocity of the cylindrical shell entering water is 4 429 m s next is the presentation of the sph results filtered see section 3 4 and their comparison with the experimental results the relative displacement of the cylindrical shell and the water at the time of 25 ms is shown in fig 6 as may be seen from fig 6 the roundness of the cylindrical shell remains good and no abnormal deformation occurs it indicates that the modified sph equations given by part 2 2 may effectively suppress the influence of tensile instability the sph results of the strain at the bottom of the inner surface of the cylindrical shell is shown in fig 7 as may be seen from fig 7 the sph curve matches well with the experimental curve although there are some differences in detail it indicates that the improvements made by this study to the standard sph method are reliable and may be applied to the subsequent research in this paper 3 numerical models 3 1 engineering background this paper is based on a recorder of a small unmanned marine aircraft which may take off fly and land well under good weather conditions the recorder may withstand overload shock and vibration under normal operating conditions the aircraft is carefully examined before field applications to ensure its good condition since all components including the recorder cannot be replaced after take off it is well known that small aircraft are not stable enough and may experience failure or even disintegration when the marine weather conditions deteriorate the data information of the recorder is important for tracking the performance of the aircraft and implementing subsequent improvements so it will be recovered after the failure of the aircraft if the whole aircraft falls into the sea the recorder generally may not be damaged since the composite shell of the craft plays a certain cushioning role however if the small aircraft disintegrates the recorder will fall from the air and hit the sea surface directly at a high speed and may cause damage it is estimated that the recorder touches the water at a speed between 30 m s and 50 m s at the time of the initial design the shell of the recorder is made of aluminum alloy al however in environmental testing al shells often fail therefore series of attempts are made ranging from changing the shape of the shell laying rubber on the outside of the shell using a multi layered al shells etc but it turns out to be ineffective then the sandwich structure with good mechanical prosperities in some cases is proposed by our team in order to increase the development efficiency the original al shell is improved by polyurethane pu which is commonly used in our research work hence two forms of sandwich cylindrical shells are developed and focused on the first consists of pu core and al layers while the second consists of al core and pu layers as a result three hollow cylinders are abstracted as shown in fig 8 the first is a monolithic cylinder made of al the second is a sandwich cylinder made up of pu core and al layers and the third is a sandwich cylinder made up of al core and pu layers all cylinders have the same size the outer diameter is 108 mm and the inner diameter is 72 mm for each sandwich cylinder the core is 10 mm thick and the inner and outer layers are both 4 mm thick for convenience these three hollow cylinders are marked as al cylinder al pu al cylinder and pu al pu cylinder respectively 3 2 particle models every cylinder hits the water vertically the moment a cylinder just touches the water surface is defined as the initial moment as shown in fig 9 in this figure gray represents the cylinder and cyan represents the water the water is static before a cylinder just touches it the width of the water is 600 mm and the depth of the water is 400 mm the top edge of water domain is a free surface the side and the bottom edges of water domain is the walls which are treated by means of ghost particles oger et al 2006 the 2d particle models of the cylinders hitting water are shown in fig 10 which shows only the local details to clearly exhibit the particle characteristics in fig 10 the red particles represent al the blue particles represent pu and the cyan particles represent water the particle spacing is 2 mm thus the al cylinder has 1256 al particles the al pu al cylinder has 560 al particles and 696 pu particles and the pu al pu cylinder has 560 pu particles and 696 al particles from equation 9 it may be seen that the mass of a particle is an important parameter for sph equations after normalized by length the mass of a particle is given by 23 m j ρ j r j 2 where r j denotes the particle spacing the densities of al and pu are given by table 2 in part 3 3 based on equation 23 the mass of an al particle is 0 01112 kg and the mass of a pu particle is 0 00506 kg considering the number of al particles and pu particles of each cylinder the mass of the al cylinder is 13 97 kg the mass of al pu al cylinder is 9 75 kg and the mass of pu al pu cylinder is 10 57 kg two types of initial conditions are considered here the same initial velocity and the same initial kinetic energy generally speaking the impact velocity is concerned when the masses of different structures are equal or similar however the three cylinders studied in this paper have obvious mass differences the same initial kinetic energy may be valuable for evaluating the dynamic properties of the three cylinders as well combined with the engineering background the two types of initial conditions are shown in table 1 where the impact velocities of al cylinder al pu al cylinder and pu al pu cylinder corresponding to the given initial kinetic energy 12 19 kj are 42 m s 50 m s and 48 m s respectively theoretically the smaller the particle spacing the more accurate the sph results however particle spacing could not be infinitely small because 1 too small particle spacing will result in too many particles which makes numerical calculations significantly less efficient 2 as the particle spacing decreases the numerical results tend to stabilize at this time the continued reduction of particle spacing does little to improve the accuracy as a result a trade off between computational accuracy and calculation speed is often taken taking the al cylinder hitting water at an initial velocity of 50 m s as an example the numerical results of the impact force filtered see section 3 4 generated by three particle spacings are compared in fig 11 from this figure it may be seen that when the particle spacing is 2 mm the numerical results tend to stabilize therefore the particle spacing is equal to 2 mm 3 3 material and failure criteria from the constitutive equation and the state equation in section 2 4 it may be seen that there are some important material parameters such as μ g ρ 0 c s s s γ etc which are given by table 2 according to the literatures eswara prasad and wanhill 2017 and yu hua et al 2004 the stress strain relationships of al and pu are shown in figs 12 and 13 as may be seen from these two figures the stress strain relationship of al is nonlinear when its stress exceeds the proportional limit while the stress strain relationship of pu is always nonlinear until the fracture occurs a multilinear approach is used here to approximate the nonlinearity as shown in figs 14 and 15 in the above materials al and pu should meet the strength requirements the strength failure is divided into two categories de silva 2014 one is the yield failure and the other is the fracture failure in engineering applications al mainly has yield failure which is usually evaluated by the theory of distortion energy density and pu mainly has fracture failure which is usually evaluated by the theory of maximum tension stress the strength condition of the theory of distortion energy density is given by 24 σ v o n σ s where σ v o n denotes the von mises stress detailed in part 4 3 and σ s denotes the yield strength according to yu hua et al 2004 the σ s of al is 290 mpa the strength condition of the theory of maximum tension stress is given by 25 σ t σ p where σ t denotes the tensile stress and σ p denotes the principal tensile failure stress according to yu hua et al 2004 the σ p of pu is 43 68 mpa 3 4 data processing the problem of tensile instability of sph method has been mentioned in section 2 2 and the algorithm has been improved by referring to the literature monaghan 2000 to suppress the tensile instability to some extent in fact the tensile instability of sph method may only be suppressed as much as possible but not completely eliminated inevitably generating data noise in order to suppress data noise this paper adopts median and mean filters the fundamentals of which have been given in the literature gonzalez and woods 2018 taking the al cylinder hitting water at an initial velocity of 50 m s as an example the comparison of filtered data and original data of the impact force is given by fig 16 it may be seen from fig 16 that the filter only suppresses the abnormal high frequency oscillation of the curve but does not change the overall trend peak time pulse width etc it may be worth noting here that all the time history curves in this paper also including fig 7 in part 2 5 and fig 11 in part 3 2 have been filtered given the layout of this paper filtering has not been specifically described until this section although it has been applied in previous time history curves 4 results and discussions the discussions mainly involve pressure force acceleration stress and deformation as mentioned in section 3 2 there are two types of initial conditions the same initial velocity 50 m s and the same initial kinetic energy 12 19 kj in order to facilitate the text the arrangement of this part is as follows sections 4 1 to 4 4 are discussed on the main line of the same initial velocity section 4 5 focuses on comparing the differences between the same initial velocity and the same initial kinetic energy section 4 6 analyzes the effect of stress strain relationship on stress and the mechanism analysis is carried out in section 4 7 4 1 impact pressure according to pressure formula sph equations and constitutive equations the pressure is a basic parameter to solve force acceleration stress and deformation therefore this part begins with a discussion of pressure from the point of view of physics fluid pressure and the pressure at solid boundary are easy to understand and the detailed definitions have been given in the literatures white 2009 young and freedman 2015 however the pressure inside the solid is rarely used in theory and engineering the pressure is re recognized from another perspective here volumetric strain of continuum including fluid and solid may be expressed as 26 θ n 1 n ε n where θ denotes the volumetric strain ε denotes the normal strain and n denotes the dimensionality the bulk modulus is given by 27 k d p d v v p θ where k denotes the bulk modulus p denotes the absolute pressure and v denotes the volume here the acoustic treatment method is used that is the change of absolute pressure may be seen as the sound pressure that is the pressure in medium it is derived from equation 27 that 28 p k θ equation 28 has a clear physical meaning pressure is the force required to produce or prevent the change in volume of fluid or solid under the condition of constant mass thus the pressure in a solid with constant mass may be seen as an internal force that prevents the change in the volume it is a component of stress just as shown in the constitutive equation see equation 12 the contours of pressure of fluid and solid are shown in figs 17 18 and 19 the selection of the ruler is not based on fluid pressure or solid pressure but based on a value that is conducive to comprehensive display after repeated comparison it is found that when the scale range of the ruler is 0 20 mpa a better display effect may be obtained from figs 17 18 and 19 it may be seen that 1 both the cylinders and the water are subjected to high pressure near the impact point in the initial stage 0 01 ms 2 then large pressure spreads in the solid while the pressure in the water decreases significantly 3 the propagation laws of underwater pressure are similar in these three cases the underwater pressure diffuses and decays in an arc before 0 20 ms and then further diffuses to an irregular pattern and decays to an low pressure level 4 the distribution laws of pressure in the three cylinders is different for the al cylinder large pressure appears on the inner and outer surfaces and for the al pu al cylinder and pu al pu cylinder large pressure appears near the interfaces of al and pu for structural response the pressure at the fluid solid interface is more important than that at other locations referring to the method of contact mechanics johnson 1985 the mean pressure at the fluid solid interface is named as contact pressure which is given by 29 p i 1 n i p i l i cos θ i i 1 n i l i cos θ i where n i denotes the particle number at the fluid structure interface p i denotes the pressure of the particle i l i denotes the equivalent dimension of the particle i and θ i denotes the azimuth of the particle i the angle between the normal line and a vertical line the equivalent dimension l i is given by 30 l i 0 5 r i 1 r i where r i 1 denotes the spacing between the particle i and the preceding particle and r i denotes the spacing between the particle i and the latter particle based on equation 29 the time history curves of contact pressure are shown in fig 20 from fig 20 it may be seen that 1 all the pressure curves have the same trend i e the peak pressure occurs in the very short period after the cylinders touching the water and then rapidly decays to a lower level 2 the peak pressure of al cylinder is about 40 mpa the peak pressure of al pu al cylinder is about 30 mpa and the peak pressure of pu al pu cylinder is about 34 mpa 4 2 impact force and acceleration the impact force may be solved based on the contact pressure that is 31 f p i 1 n i l i cos θ i according to newton s second law the centroid acceleration is given by 32 a f m c p m c i 1 n i l i cos θ i where m c denotes the mass of the cylinder which has been given in part 3 2 according to equations 31 and 32 the time history curves of impact force and acceleration are shown in figs 21 and 22 respectively from fig 21 it may be seen that 1 all the curves of impact forces have the same trend i e the peak force occurs in the very short period after the cylinders touching the water and then rapidly decays to a lower level 2 the peak force of al cylinder is about 1000 n the peak force of al pu al cylinder is about 760 n and the peak force of pu al pu cylinder is about 840 n from fig 22 it may be seen that 1 all the curves of impact acceleration have the same trend i e the peak acceleration occurs in the very short period after the cylinders touching the water and then rapidly decays to a lower level 2 the peak acceleration of al cylinder is about 72 m s2 the peak acceleration of al pu al cylinder is about 80 m s2 and the peak acceleration of pu al pu cylinder is about 82 m s2 4 3 dynamic stress the sandwich models are made of al and pu as illuminated in part 3 3 the failure of al follows the theory of distortion energy density and the failure of pu follows the theory of maximum tension stress thus two types of stress are focused on here the von mises stress of al and the principal tension stress of pu these two types of stress could be solved on the basis of normal and shear stresses which have been determined by the sph equations constitutive equations and state equations in part 2 for two dimensional problems the normal and shear stresses of the particle i are denoted by σ i x σ i y and τ i x y according to de silva 2014 the principal stress may be solved by the following equation 33 σ 2 σ i x σ i y σ σ i x σ i y τ i x y 2 0 the solution of equation 33 could be given by 34 s i 1 1 2 σ i x σ i y 1 2 σ i x σ i y 2 4 τ i x y 2 s i 2 1 2 σ i x σ i y 1 2 σ i x σ i y 2 4 τ i x y 2 the principal stresses are given by 35 σ i 1 m a x s i 1 s i 2 0 σ i 2 m e d s i 1 s i 2 0 σ i 3 m i n s i 1 s i 2 0 where σ i 1 σ i 2 and σ i 3 denote the major second and third principal stress of the particle i respectively m a x denotes the maximum value m e d denotes the median value and m i n denotes the minimum value according to the theory of distortion energy density de silva 2014 the von mises stress of the particle i is given by 36 σ i v o n 0 5 σ i 1 σ i 2 2 σ i 2 σ i 3 2 σ i 3 σ i 1 2 σ i x 2 σ i y 2 σ i x σ i y 3 τ i x y 2 according to the theory of maximum tension stress de silva 2014 the principal tension stress of the particle i is given by 37 σ i t σ i 1 1 2 σ i x σ i y 1 2 σ i x σ i y 2 4 τ i x y 2 σ x σ y τ x y 2 0 σ x σ y τ x y 2 in engineering applications the maximum stress of the structure is generally concerned as a result the von mises stress and the principal tension stress of a structure may be given by 38 σ v o n max 1 i n i σ i x 2 σ i y 2 σ i x σ i y 3 τ i x y 2 and 39 σ t max 1 i n i m a x 1 2 σ i x σ i y 1 2 σ i x σ i y 2 4 τ i x y 2 0 where n i denotes the particle number of the investigated part the time history curves of stress of al parts of the three cylinders are shown in fig 23 and the time history curves of stress of pu parts of the sandwich cylinders are shown in fig 24 in these figures σ s denotes the yield strength of al and σ p denotes the principal tensile failure stress of pu the values of σ s and σ p are given by yu hua et al 2004 and los alamos scientific lab 1969 respectively from these figures it may be seen that 1 both the peak stress of al cylinder and the peak stress of al layers of al pu al cylinder reaches the limit stress 2 the peak stress of al core of pu al pu is lowest about 250 mpa and less than the limit stress 3 the peak stresses of pu parts of the two sandwich cylinders are both not exceeding 3 mpa far less than the limit stress as may be also seen from figs 23 and 24 the stress differences between al parts and pu parts of the same sandwich cylinder are large for comparison here introduces the concept of stress level which is given by 40 l σ m a x σ v o n σ s σ t σ p 100 through value of l σ it is easy to determine whether the structure has experienced stress failure if l σ is less than 100 the stress of the structure is safe otherwise the structure may experience a stress failure according to figs 23 and 24 and equation 40 the stress levels of al cylinder and al pu al cylinder are both 100 and the stress level of pu al pu cylinder is about 86 the stress contours of the whole cylinders are shown in figs 25 29 respectively considering that the stress of pu is much less than that of al the stress contours of pu parts of sandwich cylinders are extracted separately as shown in figs 27 and 29 for simplicity a normalized scale is used in the stress contours since the time history curves of the maximum stress of all the parts have been given in figs 23 and 24 comparing stress contours with time history curve of maximum stress makes it easy to estimate the stress at each point at a given moment from figs 25 29 it may be seen that 1 the stress of the al cylinder diffuses from its contact point with water to the entire cylinder and the large stress occurs in the area near the highest lowest left and right points of the inner and outer surfaces 2 the stress distribution of the al layers of al pu al cylinder is similar to that of the al cylinder and the large stress position of the pu core is deflected approximately 45 angle relative to the large stress position of the al layer 3 the stress of pu layers of the pu al pu cylinder diffuses from its contact point with water to both sides and the stress of its al core diffuses from the lowest point of its inner cavity to other locations resulting in a pattern similar to that of the al cylinder according to the regularities of stress distribution presented in the stress contours a series of observation points are defined as shown in fig 30 the stress responses of observation points of the cylinders are shown in figs 31 35 the semi logarithmic coordinate system is adopted in figs 33 and 35 to distinguish the stress of each observation point of pu parts since the stress level of pu is especially low for al cylinder it may be seen from fig 31 that 1 the maximum stress of the outer surface is 240 mpa occurring at points 1 and 5 lower than that of the inner surface about 290 mpa and occurring point 10 2 the stress of the point at the internal surface is greater than that of the point at the outside surface in the same direction e g the stress of point 6 is greater than that of point 1 and so on 3 there are some points with similar stresses e g points 1 3 and 5 points 6 8 and 10 etc for al pu al cylinder it may be seen from figs 32 and 33 that 1 the maximum stress of the outer al layer is 260 mpa occurring at point 5 lower than that of the inner al layer about 290 mpa and occurring point 10 2 the maximum stress of the outer surface of the pu core is about 1 mpa occurring at point 13 lower than that of the inner surface of the pu core about 3 mpa and occurring at point 19 for pu al pu cylinder it may be seen from figs 34 and 35 that 1 the maximum stress of the outer surface of al core is about 220 mpa occurring at point 1 lower than that of the inner surface of al core about 250 mpa and occurring point 6 2 the maximum stress of the outer pu layer is about 3 mpa occurring at point 12 greater than that of the inner pu layer about 0 5 mpa and occurring at point 17 3 on the al core the stress of the point at the internal surface is greater than that of the point at the outside surface in the same direction e g the stress of point 6 is greater than that of point 1 and so on however the similar regularity does not exist on the pu layers 4 there are some points with similar stresses e g points 1 3 and 5 points 6 8 and 10 etc 4 4 dynamic deformation the maximum deformation of a hollow cylinder usually occurs on its inner and outer surfaces therefore the deformation of a cylinder may be expressed as 41 δ max 1 i n s δ i where δ denotes the maximum deformation at each time step δ i denotes the deformation of the particle i of the inner and outer surfaces and n s denotes the particle number of the inner and outer surfaces the time history curves of maximum deformations of the three cylinders are shown in fig 36 it may be seen from fig 36 that 1 the peak deformation of the al cylinder is about 0 64 mm 2 the peak deformation of the al pu al cylinder is about 0 92 mm 3 the peak deformation of the pu al pu cylinder is about 0 68 mm therefore the deformation of al cylinder is the smallest the deformation of pu al pu cylinder is slightly larger than that of al cylinder while the deformation of al pu al cylinder is the largest and obviously larger than those of the first two the deformation response at the observation points are shown in figs 37 41 from these figures it may be seen that 1 for al cylinder the maximum deformations of the outer and inner surfaces are both about 0 64 mm occurring at points 5 and 10 respectively there are some points with similar deformations e g points 1 3 and 5 points 1 3 and 5 points 2 and 4 points 6 8 and 10 points 7 and 9 etc 2 for al pu al cylinder the maximum deformation of the outer al layer is about 0 92 mm occurring at point 5 and larger than that of the inner al layer about 0 76 mm and occurring at point 10 the maximum deformation of the outer al layer is equivalent to that of the outer surface of pu core about 0 92 mm and occurring at point 15 and the maximum deformation of the inner al layer is equivalent to that of the inner surface of pu core about 0 76 mm and occurring at point 20 3 for pu al pu cylinder the maximum deformations of the outer and inner surfaces of al core are both 0 24 mm occurring at points 1 and 6 respectively the maximum deformation of the outer pu layer is about 0 68 mm occurring at points 12 and much larger than that of the inner pu layer about 0 24 mm and occurring at point 17 there are some points with similar deformations e g points 1 3 and 5 points 2 and 4 points 6 8 and 10 points 7 and 9 etc 4 5 comparison of two initial conditions at the same initial kinetic energy the time history curves of contact pressures impact forces impact accelerations stresses and deformations are respectively shown in figs 42 47 from these figures it may be seen that 1 the peaks of contact pressures of al al pu al and pu al pu cylinders are about 36 mpa 30 mpa and 32 mpa respectively 2 the peaks of impact forces of al al pu al and pu al pu cylinders are about 900 n 760 n and 800 n respectively 3 the peak accelerations of al al pu al and pu al pu cylinders are 64 m s2 80 m s2 and 76 m s2 4 the peak stress of al cylinder is the lowest about 240 mpa the peak stress of the al core of pu al pu cylinder about 245 mpa is slightly larger than that of the al cylinder and the peak stress of the al layers of al pu al cylinder is the greatest reaching the limit stress 5 the stresses of the pu parts of the two sandwich cylinders are both not exceeding 3 mpa far less than the limit stress 6 the peak deformation of al cylinder is the lowest about 0 48 mm the peak deformation of pu al pu cylinder is moderate about 0 65 mm and the peak deformation of al pu al cylinder is the largest about 0 92 mm next are comparisons of the two initial conditions for simplicity the three cylinders are numbered 0 for al cylinder 1 for al pu al cylinder and 2 for pu al pu cylinder by comparing the time history curves of the cylinders under two types of initial conditions the differences in contact pressures impact forces impact accelerations stress levels and deformations are respectively shown in figs 48 52 where v and ke denote velocity and kinetic energy respectively from figs 48 52 it may be seen that adjusting the first initial condition to the second initial condition has the greatest effect on the results of the al cylinder less on those of the pu al pu cylinder and no effect on those of the al pu al cylinder the detailed differences are as follows 1 at the same initial velocity the al cylinder has the greatest contact pressure impact force and stress level while its acceleration and deformation are both the least the al pu al cylinder has the least contact pressure and impact force and moderate acceleration however its stress level and deformation are both the largest the pu al pu cylinder has moderate contact pressure and impact force the largest acceleration and the lowest stress level and its deformation is slightly larger than that of al cylinder 2 at the same initial kinetic energy the al cylinder has the greatest contact pressure and impact force but the lowest acceleration stress level and deformation the al pu al cylinder has the least contact pressure and impact force but the greatest acceleration stress level and deformation the pu al pu cylinder has moderate contact pressure impact force impact acceleration and deformation and its stress level is just slightly higher than that of al cylinder 4 6 effect of stress strain relationship on stress as may be seen from fig 13 the stress strain relationship of pu is always nonlinear and there is no proportional limit and yield limit like that of al see fig 12 therefore for pu it may not be necessary to make linear and nonlinear comparisons since it is lacking theoretical and engineering basis to reduce its stress strain relationship to a linear model different from that of pu the stress strain relationship of al is linear when the stress does not exceed the proportional limit and non linear when the stress exceeds the proportional limit and there is a yield limit in theoretical research and engineering application the stress strain relationship of al or metal materials with similar characteristics may be simplified into linear bilinear or multilinear model as shown in fig 53 the differences of numerical results generated from these three material models are illustrated by the first kind of initial conditions based on the three material models the time history curves of stresses of al parts of the three cylinders are shown in figs 54 56 respectively for al cylinder it may be seen from fig 54 that the peak stress of linear model is about 310 mpa greater than the yield strength the stress curve of the bilinear model has a horizontal straight segment may be named as stress platform the same below of 290 mpa between 0 10 ms and 0 16 ms the stress curve of the multilinear model has a peak of 290 mpa but no stress platform is formed the reason for the differences is that the yield limit is treated differently by the three material models the linear model is not restricted by yield the bilinear model assumes that there is a yield platform below which the stress increases proportionally with the strain the multilinear model uses a series of line segments with decreasing slope to slowly approach the yield limit until the slope is 0 for the al layers of al pu al cylinder it may be seen from fig 55 that the peak stress of linear model is about 320 mpa greater than the yield strength the stress curve of the bilinear model has a stress platform of 290 mpa between 0 30 ms and 0 42 ms the stress curve of the multilinear model has a peak of 290 mpa but no stress platform is formed the reason for the differences is that the yield limit is treated differently by the three material models which has been explained in the previous paragraph for the al core of pu al pu cylinder it may be seen from fig 56 that the stress curves of the linear model and bilinear model are basically the same and have peak stresses of 270 mpa the peak stress of the multilinear model is about 250 mpa the reason for the coincidence of the stress curves of linear and bilinear models is that the stress strain relationships of the two are both linear between proportional limit and yield limit in contrast the stress strain relationship of the multilinear model is decreasing in slope between proportional limit and yield limit in addition as may be seen from figs 54 56 when the stress exceeds the proportional limit or even reaches the yield strength the difference in numerical results produced by the three material models is not large for the same structure the relative errors of peak stresses generated by different material models does not exceed 10 which may be negligible in some engineering applications 4 7 mechanism analysis generally speaking the stress and deformation of a structure during the impact process are determined by the impact force and the inherent strength and stiffness when other conditions are given johnson 1985 zukas et al 1982 the impact force of the cylinders under two types of initial conditions have been discussed in sections 4 2 and 4 5 respectively in this section the inherent strength and stiffness of the cylinders is investigated the method is to compare stresses and deformations of the cylinders subjected to the same loads and constraints the lower the stress the better the inherent strength the smaller the deformation the better the inherent stiffness according to de silva 2014 strength refers to the ability of a structure to resist yield fracture and other destruction produced by external forces and stiffness refers to the ability of a structure to resist deformation produced by external forces thus the same forces and constraints may be used to compare the inherent strength and stiffness of different structures suppose that the three cylinders are constrained by six degrees of freedom at the bottoms and are excited by the same shock pulse at the tops the shock pulse is given by 42 f t a t τ g t τ 2 where a denotes the amplitude of the shock pulse τ denotes the deadline of the shock pulse and g t denotes the gate function in this example a is equal to 900 n and τ is equal to 0 1 ms the time history curves of von mises stress of al and principal tension stress of pu generated by above shock pulse are shown in figs 57 and 58 respectively from these two figures it may be seen that 1 the peak stress of al cylinder is about 235 mpa less than the yield stress 2 the peak stress of al layers of the al pu al cylinder reaches the yield stress 290 mpa and the peak stress of pu core of the al pu al cylinder is about 4 mpa far less than the principal tensile failure stress 3 the peak stress of al core of the pu al pu cylinder is about 260 mpa greater than that of al cylinder and less than the yield stress and the peak stress of pu layers of the pu al pu cylinder is about 3 mpa obviously less than the principal tensile failure stress according to figs 57 and 58 and equation 40 under the action of shock pulse given by equation 42 the stress level of al pu al cylinder is 100 while the stress level of al cylinder and pu al pu cylinder are 79 and 90 respectively as a result the al pu al cylinder experiences stress failure which does not occur in the al cylinder and pu al pu cylinder it implies that the inherent strength of al cylinder is the best the inherent strength of pu al pu cylinder is moderate and the inherent strength of al pu al cylinder is the worst the time history curves of deformation of the three cylinders subjected to the shock pulse given by equation 42 are shown in fig 59 it may be seen from fig 59 that 1 the maximum deformation of the al cylinder is about 0 50 mm 2 the maximum deformation of the al pu al cylinder is about 1 2 mm 3 the maximum deformation of the pu al pu cylinder is about 0 76 mm it implies that the inherent stiffness of al cylinder is the best the inherent stiffness of pu al pu cylinder is moderate and the inherent stiffness of al pu al cylinder is the worst next is a comparison of the results of the cylinders in three cases the first case is that the cylinders hit water at an initial velocity of 50 m s the second case is that the cylinders hit water at the initial kinetic energy of 12 19 kj and the third case is that the cylinders are subjected to the same shock pulse given by equation 42 the physical quantities such as contact pressure impact force acceleration stress and deformation which reflect the impact performance of cylinder hitting water from different angles have been discussed earlier in essence cylinder hitting water is a kind of collision problem in the existing literatures on collisions johnson 1985 zukas et al 1982 more attention is generally paid to impact force and the resulting stress and deformation which are focused on in this section as well the comparisons of these three main physical quantities are listed in table 3 according to table 3 the following laws may be summarized 1 impact force during water entry the impact forces of the cylinders have similar regularities under two types of initial conditions the impact force of al cylinder is the greatest the impact force of pu al pu cylinder is moderate and the impact force of al pu al cylinder is the least however the differences in the impact forces of the three cylinders at the same initial kinetic energy is less than those at the same initial velocity 2 inherent strength and stiffness the inherent strength and stiffness of the cylinders are compared by comparing the stresses and deformations under the action of the same shock pulse the al cylinder has the best inherent strength and stiffness since its stress and deformation generated by the shock pulse are both smallest similarly it may be deduced that the pu al pu cylinder has moderate inherent strength and stiffness and the al pu al cylinder has the poorest inherent strength and stiffness 3 inducement of stress level and deformation during water entry the al pu al cylinder has the least impact force but its stress and deformation are both the greatest under the two initial conditions attributing to its poor inherent strength and stiffness interestingly the al cylinder has the best inherent strength and stiffness but its stress level reaches the yield limit under the first initial condition attributing to its greatest impact force however the stress level of al cylinder is the lowest under the second initial condition in contrast the pu al pu cylinder has moderate impact force and moderate inherent strength and stiffness which combine to present excellent mechanical properties its stress level is the lowest under the first initial condition and just a little higher that of the al cylinder under the second initial condition furthermore the deformation of the pu al pu cylinder is small as well under both initial conditions 5 conclusions this paper focuses on the impact performances of al cylinder al pu al cylinder and pu al pu cylinder during water entry the sph method is used in this study based on the research status of sph the standard sph method is modified to be suitable for the problem of solid fluid impact the sph method is validated by an existing experiment then the sph models are established and pressure force acceleration stress and deformation are solved and discussed researches show that 1 when the three cylinders hit water at the same initial velocity the pu al pu cylinder has the lowest stress level and a small deformation the al cylinder has a high stress level and the smallest deformation and the al pu al cylinder has the highest stress level and the largest deformation 2 when the three cylinders hit water at the same initial kinetic energy the al cylinder has the lowest stress level and the smallest deformation the pu al pu cylinder has a small deformation and a stress level slightly higher than that of the al cylinder and the al pu al cylinder still has the highest stress level and the largest deformation it indicates that during water entry if the initial velocity is given the pu al pu cylinder has the best resistance to stress failure and deformation if the initial kinetic energy is given the al cylinder has the best resistance to stress failure and deformation and the resistance of pu al pu cylinder to stress failure and deformation is second only to that of al cylinder under these two initial conditions the al pu al cylinder is always the easiest to experience failures resulting from large stress and deformation further studies indicate that the stress and deformation of the cylinders during water entry may be attributed to the combined action of the impact force and their inherent strength and stiffness the defect of the al pu al cylinder is that it has insufficient inherent strength and stiffness resulting in the highest stress level and the largest deformation under the same initial conditions the defect of the al cylinder is that it has the greatest impact force under the same initial conditions especially at the same initial velocity the al cylinder has a high stress level despite having the best inherent strength and stiffness different from the first two cylinders the pu al pu cylinder has moderate impact force and moderate inherent strength and stiffness resulting in good mechanical properties at the same initial velocity the pu al pu cylinder has the lowest stress level and a small deformation at the same initial kinetic energy the pu al pu cylinder has a low stress level just slightly higher than that of the al cylinder and a small deformation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the work is supported by the national natural science foundation of china grant no 51709229 and natural science basic research plan in shaanxi province of china grant no 2018jq5092 
22117,the impact performances of one monolithic cylinder and two sandwich cylinders during water entry are investigated by sph method which is validated by an existing experiment the first cylinder is made of aluminum alloy al cylinder the second cylinder is made up of polyurethane core and aluminum alloy layers al pu al cylinder and the third cylinder is made up of aluminum alloy core and polyurethane layers pu al pu cylinder all the cylinders have the same size the research shows that the stress levels and deformations of the cylinders are closely related to the impact forces and their inherent strengths and stiffnesses the deficiency of the al pu al cylinder lies in its poor inherent strength and stiffness resulting in the greatest stress level and deformation under the same initial conditions the deficiency of the al cylinder lies in its large impact force at the same initial velocity which may lead to a high stress level in contrast the impact force and inherent strength and stiffness of pu al pu cylinder are moderate contributing to a lowest stress level at the same initial velocity and a stress level slightly higher than that of al cylinder at the same initial kinetic energy keywords sandwich cylinder water entry sph method impact force stress deformation 1 introduction 1 1 research status of water entry solid hitting water is a kind of physical phenomenon which is commonly occurred in both natural world and engineering field a seabird diving quickly into the water when catching fish a jumping fish falling back into the water a frog jumping into the stream from the shore a rock rolling down into the river a seaplane landing on the sea a broken down airplane crashing lands on the water a re entry module landing on the sea a new ship being launching a missile penetrating into the water as early as 1900 worthington observes the splash pattern and air bubble during the process of a ball falling into the water by means of photographic technology worthington 1900 as the pioneering experimental study it initiated the first stage of research on water entry bell 1924 and maccoll 1928 summarize the mechanism of air bubble generation and evolution based on experimental observations watanabe conducts an experiment of cone hitting water and measures the change law of impact load in the time domain watanabe 1930 these early experimental studies have important inspiration and reference significances for later researches after more than a century of development experiments are still a kind of important means to study the problem of water entry taking the experimental researches in the last 3 years as an example jiang et al carry out an experiment on the water entry of a projectile and investigate the influence of attitude angle and ventilation rate jiang et al 2018 vincent et al carry out experimental studies on the impact force of the wedge body into the water and the water splash pattern the results of which are in line with the results based on a modified mechanical model vincent et al 2018 hassoon et al conduct an experimental study on the mechanical behavior of composite structures hitting water at a constant impact speed hassoon et al 2018a based on semi analytical models and experimental method shams study the hydro elastic slamming on flexible wedges during the process of water entry and exit adel shams et al 2017 hurd et al study the water entry laws of deformable spheres with the help of high speed camera and image processing techniques hurd et al 2017 chen et al test the effect of inclination velocity and attack angle on the water entry of a vehicle to determine the influencing factors on the bounce behavior chen et al 2017 barjasteh et al provide experimental reference for the water entry of asymmetric wedge focusing on the influence of parameters such as bottom angle inclination and impact velocity barjastehhamid and javaherian 2016 generally speaking the result of experimental test is reliable therefore it is always used to verify the effectiveness of analytical and numerical models however the deficiencies like high costs and long operating duration constitute the limitations of water entry experiments sun et al 2018 the earliest analytical model is proposed in 1929 by von karman who abstracts the pontoon model of the seaplane into a two dimensional wedge and presents the von karman model based on the momentum theorem von karman 1929 wagner linearizes the free surface and bernoulli equation and then proposes the wagner model based on equivalent plate theory which lays the foundation for the analytical method of water entry impact wagner 1932 based on the wagner model the original logvinovich model the improved logvinovich model and the generalized wagner model are put forward so that the analytical model of water entry is more and more fine korobkin systematically introduces the mathematical methods of these analytical models and the relations among them alexander 2004 in addition under the framework of wagner s theory korobkin accurately analyzes the water entry of elliptic paraboloid at variable speed and investigates the influence of impact conditions and the surface shape on the impact force and acceleration korobkin 2002 scolan and korobkin make a precise theoretical analysis of the three dimensional water entry from the perspective of energy conservation scolan and korobkin 2003 jalalisendi et al study the rigid body motion and elastic deformation of a beam hitting water in free fall and prove the analytical results experimentally jalalisendi and porfiri 2018 furthermore jalalisendi et al also establish an analytical model of shallow water entry and make a research on the shallow water entry of wedges jalalisendi et al 2017 in general the analytical model is suitable for the structure with a simple geometry oliver 2002 such as wedge plate cylinder parabola etc however the analytical method may be difficult to investigate the water entry of complex structures in engineering applications structural features and boundary conditions are often complex so it is generally difficult to give accurate solutions on the other hand excessive reliance on experimentation may be inefficient and uneconomical taking into account the research cycle and costs with low cost and high efficiency the numerical method could complement the analytical and experimental methods at present in the field of water entry impact numerical methods mainly include finite element method fem finite volume method fvm boundary element method bem constrained interpolation profile cip volume of fluid vof smoothed particle hydrodynamics sph etc derakhshanian et al develop a numerical simulation tool for oblique water entry problems and test its reliability saeed derakhshanian et al 2018 xie et al study the problem of water entry of composite hulls by means of cfd fem coupled algorithm xie et al 2018 yu et al study the water entry of curved wedges using explicit fem yu et al 2018 elhimer et al study the impact of rigid cones on the mixture surface of gas and liquid using explicit fem methods elhimer et al 2017 wang et al study the water impact of three dimensional buoys by using explicit fem wang and soares 2014 hassoon et al use fem method to study the dynamic response of the water impact on flexible composite structures hassoon et al 2018b bilandi et al simulate the vertical water impact of asymmetric wedges on the basis of a combination of fvm and vof rasul niazmand bilandi et al 2018 facci et al make a research on a three dimensional water entry problem of a multi curvature structure by using the combination of fvm and vof andrea 2016 nair et al study the water entry and exit of the axial symmetry structure and track the free surface by means of vof nair and bhattacharyya 2018 iranmanesh et al make a research on the horizontal water entry of three dimensional cylinders with low froude numbers by using vof and investigate the effect of geometric parameters velocity and density on the dimensionless depth iranmanesh and passandideh fard 2017 cheng et al study the problem of the water entry of a wedge subjected to water wave on the basis of higher order bem cheng et al 2018 bao et al make a research on the water entry of a two dimensional oblique wedge using bem in time domain bao et al 2016 wen et al use cip to study the problem of three dimensional water entry wen and qiu 2018 yang et al make a research on the water impact of a two dimensional wedge and a three dimensional cylinder and a catamaran based on cip yang and qiu 2012 this paper uses the sph method the research status of which is detailed in part 1 2 1 2 research status of sph method sph is a meshless lagrangian algorithm first proposed by lucy 1977 and gingold and monaghan 1977 respectively in 1977 it is first used to solve the fission problem of fast rotating stars then monaghan et al introduces the sph method into the numerical calculation of fluid monaghan and gingold 1983 monaghan 1988 1994 monaghan and münzel introduce the basic principles of sph method at length in their works respectively monaghan 1992 münzel 1996 these pioneering studies lay the foundation for the further development of the sph method after entering the 21st century new research and application results have appeared in the field of sph müller makes a research on the strategy for sph method to be applied to fluid simulation and advises several kernel functions müller et al 2003 parshikov et al propose an algorithm of contact interaction between particles parshikov and medin 2002 shao et al present an incompressible sph method which could be used to analyze the newtonian and non newtonian flows with free surfaces shaoedmond and lo 2003 owen gives the tensor generalization of monaghan gingold artificial viscosity michael owen 2004 ata et al solve the problem of inviscid shallow water flows by using sph method ata and soulaïmani 2005 hu et al propose the sph method for multiphase flow and solve the problem of density discontinuity of cross phase interface hu and adams 2006 khayyer et al modify the incompressible sph model to track the surface of the broken waves based on the variable separation method khayyer et al 2008 monaghan et al propose a simple efficient and robust sph algorithm to solve the problem of multifluid flow monaghan and rafiee 2013 crespo et al develop a sph code named dualsphysics which could be used to solve the problems of free surface flow crespo et al 2015 akinci et al present a two way rigid fluid coupling method which is based on momentum conservation and could be used for incompressible sph model akinci et al 2012 yan et al expand the multiphase flow sph algorithm to make it suitable for deformable solid and granular materials yan et al 2016 zhou et al improve the interfacial pressure algorithm of sph model which is used to investigate multiphase flows with large density ratios zhou et al 2016 water impact is a special problem of fluid structure coupling which occurs during the relative movement between water and structures based on sph method monaghan et al investigate the motion of water caused by the impact of a rectangular body which slides down a slope and enters into the water monaghan et al 2003 kulasegaram et al propose an improvement measure to deal with the contact between sph particles and rigid solid boundary kulasegaram et al 2004 gómez gesteira et al make a research on the damage of overtopping wave to offshore platforms and ship decks by using sph method gómez gesteira et al 2005 dalrymple et al improve the sph models in terms of turbulence viscosity density and time integration to simulate the broken waves overtopping wave and the interaction of waves and structures dalrymple and rogers 2006 oger et al build a sph model and introduce a new technique based on particle sampling to evaluate fluid pressure on solid boundaries in response to the water entry of two dimensional wedges oger et al 2006 crespo et al build a 3d sph model to investigate the interaction between a large wave and a dike crespo et al 2007 panciroli et al study hydroelasticity combined with an elastic wedge panciroli et al 2012 nair et al study the energy transfer during the process of several 2 d cylinders hitting water based on an incompressible model nair and tomar 2017 farsi et al discuss the best combination of numerical schemes for 2 d sph simulation of wedge water entry farsi and ghadimi 2014 sun et al investigate the violent interactions between rigid body and free surface based on sph method which is robust and weakly compressible sun et al 2015 ghazanfarian et al study the 2 d water entry and water exit of a rotating circular cylinder using the sub particle scale turbulence model of a lagrangian particle based sph method ghazanfarian et al 2015 ji et al present a large scale water entry simulation with smoothed particle hydrodynamics framework using the parallel architecture of single and multi gpu systems ji et al 2016 2 sph method 2 1 standard sph equations the sph code used in this paper is modified on the basis of liu s sph code liu and liu 2003 liu et al use the standard sph equations which are given by 1 d ρ i d t j 1 n m j v i β v j β w i j x i β d v i α d t j 1 n m j σ i α β ρ i 2 σ j α β ρ j 2 π i j w i j x i β d e i d t 1 2 j 1 n m j p i ρ i 2 p j ρ j 2 π i j v i β v j β w i j x i β 1 2 ρ i τ i α β ε j α β h i d x i α d t v i α where ρ denotes the density v denotes the velocity vector e denotes the internal energy t denotes the time m denotes the mass w denotes the kernel function x denotes the displacement vector σ denotes the stress tensor p denotes the isotropic pressure τ denotes the viscous shear stress ε denotes the strain rate tensor π denotes the artificial viscosity monaghan 1989 h denotes the artificial heat monaghan n denotes the number of particles in the support domain of particle i the superscripts α and β are the labels of index method and the subscripts i and j denote ordinal number of the particles however liu s sph code is a solution to the fluid problem improvements are needed to make it suitable for the problem of solid hitting water these improvements are mainly carried out in respects of sph equations kernel function and constitutive and state equations which are detailed in parts 2 2 to 2 4 2 2 modified sph equations the sph equations are modified on the basis of two aspects one is the interfacial force between solid and fluid and the other is the tensile instability of solids monaghan et al propose an interfacial force suitable for arbitrary boundaries which is given by monaghan and kajtar 2009 2 f i ι k β r i ι r i ι 2 w r i ι h 2 m i m i m ι where the subscript i and ι denotes the fluid particle i and the boundary particle ι respectively k is a constant related to the relative velocity of solid and fluid β is a constant related to kernel function r i ι denotes the radius vector between the fluid particle and the boundary particle r i ι denotes the distance between the fluid particle and the boundary particle and h denotes the smoothing length the constant k is given by 3 k 0 01 c s 2 v 2 where c s 10 v is the velocity of sound and v is the maximum speed of solid relative to the fluid the kernel function w and the constant β is given in part 2 3 after considering the interfacial force the acceleration in equation 1 may be corrected to 4 d v i α d t j 1 n f m j σ i α β ρ i 2 σ j α β ρ j 2 π i j w i j x i β k 1 n b ι 1 n k f i ι m ι π i ι w i j x i β where k denotes the solid body k n f denotes the number of fluid particles in the support domain of the fluid particle i n k denotes the number of boundary particles of the solid body k and n b denotes the number of solid bodies the tensile instability is not taken into account by the standard sph equations it may lead to abnormal deformation of the sph model especially the solid sph model in order to remove the tensile instability monaghan advises an artificial stress which is given by monaghan 2000 5 r i j α β r i α β r j α β where 6 a r i α β ε σ i α β σ i α β 0 0 σ i α β 0 and 6 b r j α β ε σ j α β σ j α β 0 0 σ j α β 0 in equations 6 a and 6 b ε is a constant coefficient and takes the value of 0 2 monaghan 2000 the acceleration given by equation 4 may be further corrected to 7 d v i α d t j 1 n f m j σ i α β ρ i 2 σ j α β ρ j 2 π i j r i j α β f i j n w i j x i β k 1 n b ι 1 n k f i ι m ι π i ι w i j x i β where f i j n w r i j w δ p δ p denotes the average particle spacing in the neighborhood of particle i and n takes the value of 4 monaghan 2000 in addition monaghan also advises that the particles be moved using an average velocity as a result the velocity in equation 1 may be corrected to 8 d x i α d t v i α 0 5 j m j ρ i j v j α v i α w i j replacing the acceleration equation and the velocity equation in equation 1 with equations 7 and 8 the sph equations may eventually be modified as 9 d ρ i d t j 1 n m j v i β v j β w i j x i β d v i α d t j 1 n m j σ i α β ρ i 2 σ j α β ρ j 2 π i j r i j α β f i j n w i j x i β k 1 n b ι 1 n k f i ι m ι π i ι w i j x i β d e i d t 1 2 j 1 n m j p i ρ i 2 p j ρ j 2 π i j v i β v j β w i j x i β 1 2 ρ i τ i α β ε j α β h i d x i α d t v i α 0 5 j m j ρ i j v j α v i α w i j 2 3 kernel function in standard sph method the cubic spline function is used as a kernel function given by liu and liu 2003 10 w r h α 2 3 q 2 1 2 q 3 0 q 1 1 6 2 q 3 1 q 2 0 q 2 where q r h r denotes the particle spacing and α is a constant equaling to 1 h 15 7 π h 2 and 3 2 π h 3 respectively in the case of 1 d 2 d and 3 d dimensions some scholars have been focusing on the wendland kernel function which is given by canelas 2015 11 w r h 7 64 π h 2 1 2 q 2 q 4 q 2 0 q 2 canelas compares the cubic spline function with the wendland function canelas 2015 the cubic spline function and the wendland function are normalized as shown in fig 1 the first and second derivative of the two normalized functions are shown in fig 2 and fig 3 respectively from these three figures it may be seen that the wendland function is similar to the cubic spline function the first derivative of the two is similar as well and the difference is that the second derivative of the wendland function is smoother some scholars have compared the application effects of cubic spline function and wendland function according to monaghan the results obtained by using the two kernel functions are similar but the distribution of particles is more uniform when using the wendland kernel function monaghan 2013 dehnen and alya prove that the use of wendland kernel function may better avoid particle instability walter and aly 2012 for the above considerations this paper uses the wendland function as the kernel function in addition the smooth length is highly correlated with the kernel function as may be seen from equation 11 q r h is greater than or equal to 0 and less than 2 according to monaghan 2013 and walter and aly 2012 q r h is equal to 1 5 this will be followed in this paper as mentioned in part 2 2 the constant β is related to kernel function monaghan et al advise that β 2 when the wendland 2d quartic is used for the fluid dynamics monaghan and kajtar 2009 2 4 constitutive and state equations the constitutive equation is given by gray et al 2001 12 σ α β p δ α β τ α β where δ α β denotes the kronecker symbol which is given by 13 δ α β 1 α β 0 α β for newtonian fluid the τ α β is given by gray et al 2001 14 τ α β μ ε α β where μ denotes the viscosity coefficient 15 ε α β 1 2 v α x β v β x α for elastic solid the τ α β is given by gray et al 2001 16 τ α β τ α γ ω β γ ω α γ τ β γ 2 g ε α β 1 3 δ α β ε γ γ where ω denotes the rotation tensor and g denotes the shear modulus ω and g are given by gray et al 2001 e green and zerna 2012 17 ω 1 2 v α x β v β x α and 18 g e 2 1 υ where e denotes the young modulus and ν denotes the poisson s ratio the equation of state is given by libersky et al 1993 19 p 1 1 2 γ ρ ρ 0 1 p h γ ρ e where ρ 0 denotes the reference density the subscript h denotes the hugoniot curvilinear function γ is the gruneisen parameter and is given by 20 p h a 0 ρ ρ 0 1 b 0 ρ ρ 0 1 2 c 0 ρ ρ 0 1 3 ρ ρ 0 a 0 ρ ρ 0 1 ρ ρ 0 the parameters a 0 b 0 and c 0 are given by 21 a 0 ρ 0 c s 2 b 0 a 0 1 2 s s 1 c 0 a 0 2 s s 1 3 s s 1 2 the parameters c s and s s are contained in the linear impact velocity relation which is given by 22 u s c s s s u p where u s denotes the impact speed u p denotes the particle speed c s denotes the linear correlation between the impact speed and the particle speed and s s denotes the slope 2 5 method validation the sph method used in this paper is validated by comparing it with an existing experiment given by sun and faltinsen 2006 the experiment uses a cylindrical shell made of al the outer diameter of the cylindrical shell is 306 mm the wall thickness is 3 mm and the length is 600 mm the density of al is 2700 kg m3 young s modulus is 73 50 gpa and the poisson s ratio is 0 34 the cylindrical shell falls from a height of 1m above the water surface and touches the water at a speed of 4 429 m s the strain at the bottom of the inner surface of the cylindrical shell is tested in the experiment here a two dimensional sph model is used to simulate the above cylindrical shell hitting water the geometric and material parameters of the cylindrical shell in the sph model is the same as that in the experiment other relevant material parameters are the same as those in table 2 given by part 3 3 the overall model is shown in fig 4 and the detail of the particles is given by fig 5 the size of the water domain in the sph model is 1 m 0 5 m the top edge of water domain is a free surface the side and the bottom edges of water domain is the walls which are treated by means of ghost particles oger et al 2006 the moment the cylindrical shell just touches the water surface is defined as the initial moment according to the experimental conditions the initial velocity of the cylindrical shell entering water is 4 429 m s next is the presentation of the sph results filtered see section 3 4 and their comparison with the experimental results the relative displacement of the cylindrical shell and the water at the time of 25 ms is shown in fig 6 as may be seen from fig 6 the roundness of the cylindrical shell remains good and no abnormal deformation occurs it indicates that the modified sph equations given by part 2 2 may effectively suppress the influence of tensile instability the sph results of the strain at the bottom of the inner surface of the cylindrical shell is shown in fig 7 as may be seen from fig 7 the sph curve matches well with the experimental curve although there are some differences in detail it indicates that the improvements made by this study to the standard sph method are reliable and may be applied to the subsequent research in this paper 3 numerical models 3 1 engineering background this paper is based on a recorder of a small unmanned marine aircraft which may take off fly and land well under good weather conditions the recorder may withstand overload shock and vibration under normal operating conditions the aircraft is carefully examined before field applications to ensure its good condition since all components including the recorder cannot be replaced after take off it is well known that small aircraft are not stable enough and may experience failure or even disintegration when the marine weather conditions deteriorate the data information of the recorder is important for tracking the performance of the aircraft and implementing subsequent improvements so it will be recovered after the failure of the aircraft if the whole aircraft falls into the sea the recorder generally may not be damaged since the composite shell of the craft plays a certain cushioning role however if the small aircraft disintegrates the recorder will fall from the air and hit the sea surface directly at a high speed and may cause damage it is estimated that the recorder touches the water at a speed between 30 m s and 50 m s at the time of the initial design the shell of the recorder is made of aluminum alloy al however in environmental testing al shells often fail therefore series of attempts are made ranging from changing the shape of the shell laying rubber on the outside of the shell using a multi layered al shells etc but it turns out to be ineffective then the sandwich structure with good mechanical prosperities in some cases is proposed by our team in order to increase the development efficiency the original al shell is improved by polyurethane pu which is commonly used in our research work hence two forms of sandwich cylindrical shells are developed and focused on the first consists of pu core and al layers while the second consists of al core and pu layers as a result three hollow cylinders are abstracted as shown in fig 8 the first is a monolithic cylinder made of al the second is a sandwich cylinder made up of pu core and al layers and the third is a sandwich cylinder made up of al core and pu layers all cylinders have the same size the outer diameter is 108 mm and the inner diameter is 72 mm for each sandwich cylinder the core is 10 mm thick and the inner and outer layers are both 4 mm thick for convenience these three hollow cylinders are marked as al cylinder al pu al cylinder and pu al pu cylinder respectively 3 2 particle models every cylinder hits the water vertically the moment a cylinder just touches the water surface is defined as the initial moment as shown in fig 9 in this figure gray represents the cylinder and cyan represents the water the water is static before a cylinder just touches it the width of the water is 600 mm and the depth of the water is 400 mm the top edge of water domain is a free surface the side and the bottom edges of water domain is the walls which are treated by means of ghost particles oger et al 2006 the 2d particle models of the cylinders hitting water are shown in fig 10 which shows only the local details to clearly exhibit the particle characteristics in fig 10 the red particles represent al the blue particles represent pu and the cyan particles represent water the particle spacing is 2 mm thus the al cylinder has 1256 al particles the al pu al cylinder has 560 al particles and 696 pu particles and the pu al pu cylinder has 560 pu particles and 696 al particles from equation 9 it may be seen that the mass of a particle is an important parameter for sph equations after normalized by length the mass of a particle is given by 23 m j ρ j r j 2 where r j denotes the particle spacing the densities of al and pu are given by table 2 in part 3 3 based on equation 23 the mass of an al particle is 0 01112 kg and the mass of a pu particle is 0 00506 kg considering the number of al particles and pu particles of each cylinder the mass of the al cylinder is 13 97 kg the mass of al pu al cylinder is 9 75 kg and the mass of pu al pu cylinder is 10 57 kg two types of initial conditions are considered here the same initial velocity and the same initial kinetic energy generally speaking the impact velocity is concerned when the masses of different structures are equal or similar however the three cylinders studied in this paper have obvious mass differences the same initial kinetic energy may be valuable for evaluating the dynamic properties of the three cylinders as well combined with the engineering background the two types of initial conditions are shown in table 1 where the impact velocities of al cylinder al pu al cylinder and pu al pu cylinder corresponding to the given initial kinetic energy 12 19 kj are 42 m s 50 m s and 48 m s respectively theoretically the smaller the particle spacing the more accurate the sph results however particle spacing could not be infinitely small because 1 too small particle spacing will result in too many particles which makes numerical calculations significantly less efficient 2 as the particle spacing decreases the numerical results tend to stabilize at this time the continued reduction of particle spacing does little to improve the accuracy as a result a trade off between computational accuracy and calculation speed is often taken taking the al cylinder hitting water at an initial velocity of 50 m s as an example the numerical results of the impact force filtered see section 3 4 generated by three particle spacings are compared in fig 11 from this figure it may be seen that when the particle spacing is 2 mm the numerical results tend to stabilize therefore the particle spacing is equal to 2 mm 3 3 material and failure criteria from the constitutive equation and the state equation in section 2 4 it may be seen that there are some important material parameters such as μ g ρ 0 c s s s γ etc which are given by table 2 according to the literatures eswara prasad and wanhill 2017 and yu hua et al 2004 the stress strain relationships of al and pu are shown in figs 12 and 13 as may be seen from these two figures the stress strain relationship of al is nonlinear when its stress exceeds the proportional limit while the stress strain relationship of pu is always nonlinear until the fracture occurs a multilinear approach is used here to approximate the nonlinearity as shown in figs 14 and 15 in the above materials al and pu should meet the strength requirements the strength failure is divided into two categories de silva 2014 one is the yield failure and the other is the fracture failure in engineering applications al mainly has yield failure which is usually evaluated by the theory of distortion energy density and pu mainly has fracture failure which is usually evaluated by the theory of maximum tension stress the strength condition of the theory of distortion energy density is given by 24 σ v o n σ s where σ v o n denotes the von mises stress detailed in part 4 3 and σ s denotes the yield strength according to yu hua et al 2004 the σ s of al is 290 mpa the strength condition of the theory of maximum tension stress is given by 25 σ t σ p where σ t denotes the tensile stress and σ p denotes the principal tensile failure stress according to yu hua et al 2004 the σ p of pu is 43 68 mpa 3 4 data processing the problem of tensile instability of sph method has been mentioned in section 2 2 and the algorithm has been improved by referring to the literature monaghan 2000 to suppress the tensile instability to some extent in fact the tensile instability of sph method may only be suppressed as much as possible but not completely eliminated inevitably generating data noise in order to suppress data noise this paper adopts median and mean filters the fundamentals of which have been given in the literature gonzalez and woods 2018 taking the al cylinder hitting water at an initial velocity of 50 m s as an example the comparison of filtered data and original data of the impact force is given by fig 16 it may be seen from fig 16 that the filter only suppresses the abnormal high frequency oscillation of the curve but does not change the overall trend peak time pulse width etc it may be worth noting here that all the time history curves in this paper also including fig 7 in part 2 5 and fig 11 in part 3 2 have been filtered given the layout of this paper filtering has not been specifically described until this section although it has been applied in previous time history curves 4 results and discussions the discussions mainly involve pressure force acceleration stress and deformation as mentioned in section 3 2 there are two types of initial conditions the same initial velocity 50 m s and the same initial kinetic energy 12 19 kj in order to facilitate the text the arrangement of this part is as follows sections 4 1 to 4 4 are discussed on the main line of the same initial velocity section 4 5 focuses on comparing the differences between the same initial velocity and the same initial kinetic energy section 4 6 analyzes the effect of stress strain relationship on stress and the mechanism analysis is carried out in section 4 7 4 1 impact pressure according to pressure formula sph equations and constitutive equations the pressure is a basic parameter to solve force acceleration stress and deformation therefore this part begins with a discussion of pressure from the point of view of physics fluid pressure and the pressure at solid boundary are easy to understand and the detailed definitions have been given in the literatures white 2009 young and freedman 2015 however the pressure inside the solid is rarely used in theory and engineering the pressure is re recognized from another perspective here volumetric strain of continuum including fluid and solid may be expressed as 26 θ n 1 n ε n where θ denotes the volumetric strain ε denotes the normal strain and n denotes the dimensionality the bulk modulus is given by 27 k d p d v v p θ where k denotes the bulk modulus p denotes the absolute pressure and v denotes the volume here the acoustic treatment method is used that is the change of absolute pressure may be seen as the sound pressure that is the pressure in medium it is derived from equation 27 that 28 p k θ equation 28 has a clear physical meaning pressure is the force required to produce or prevent the change in volume of fluid or solid under the condition of constant mass thus the pressure in a solid with constant mass may be seen as an internal force that prevents the change in the volume it is a component of stress just as shown in the constitutive equation see equation 12 the contours of pressure of fluid and solid are shown in figs 17 18 and 19 the selection of the ruler is not based on fluid pressure or solid pressure but based on a value that is conducive to comprehensive display after repeated comparison it is found that when the scale range of the ruler is 0 20 mpa a better display effect may be obtained from figs 17 18 and 19 it may be seen that 1 both the cylinders and the water are subjected to high pressure near the impact point in the initial stage 0 01 ms 2 then large pressure spreads in the solid while the pressure in the water decreases significantly 3 the propagation laws of underwater pressure are similar in these three cases the underwater pressure diffuses and decays in an arc before 0 20 ms and then further diffuses to an irregular pattern and decays to an low pressure level 4 the distribution laws of pressure in the three cylinders is different for the al cylinder large pressure appears on the inner and outer surfaces and for the al pu al cylinder and pu al pu cylinder large pressure appears near the interfaces of al and pu for structural response the pressure at the fluid solid interface is more important than that at other locations referring to the method of contact mechanics johnson 1985 the mean pressure at the fluid solid interface is named as contact pressure which is given by 29 p i 1 n i p i l i cos θ i i 1 n i l i cos θ i where n i denotes the particle number at the fluid structure interface p i denotes the pressure of the particle i l i denotes the equivalent dimension of the particle i and θ i denotes the azimuth of the particle i the angle between the normal line and a vertical line the equivalent dimension l i is given by 30 l i 0 5 r i 1 r i where r i 1 denotes the spacing between the particle i and the preceding particle and r i denotes the spacing between the particle i and the latter particle based on equation 29 the time history curves of contact pressure are shown in fig 20 from fig 20 it may be seen that 1 all the pressure curves have the same trend i e the peak pressure occurs in the very short period after the cylinders touching the water and then rapidly decays to a lower level 2 the peak pressure of al cylinder is about 40 mpa the peak pressure of al pu al cylinder is about 30 mpa and the peak pressure of pu al pu cylinder is about 34 mpa 4 2 impact force and acceleration the impact force may be solved based on the contact pressure that is 31 f p i 1 n i l i cos θ i according to newton s second law the centroid acceleration is given by 32 a f m c p m c i 1 n i l i cos θ i where m c denotes the mass of the cylinder which has been given in part 3 2 according to equations 31 and 32 the time history curves of impact force and acceleration are shown in figs 21 and 22 respectively from fig 21 it may be seen that 1 all the curves of impact forces have the same trend i e the peak force occurs in the very short period after the cylinders touching the water and then rapidly decays to a lower level 2 the peak force of al cylinder is about 1000 n the peak force of al pu al cylinder is about 760 n and the peak force of pu al pu cylinder is about 840 n from fig 22 it may be seen that 1 all the curves of impact acceleration have the same trend i e the peak acceleration occurs in the very short period after the cylinders touching the water and then rapidly decays to a lower level 2 the peak acceleration of al cylinder is about 72 m s2 the peak acceleration of al pu al cylinder is about 80 m s2 and the peak acceleration of pu al pu cylinder is about 82 m s2 4 3 dynamic stress the sandwich models are made of al and pu as illuminated in part 3 3 the failure of al follows the theory of distortion energy density and the failure of pu follows the theory of maximum tension stress thus two types of stress are focused on here the von mises stress of al and the principal tension stress of pu these two types of stress could be solved on the basis of normal and shear stresses which have been determined by the sph equations constitutive equations and state equations in part 2 for two dimensional problems the normal and shear stresses of the particle i are denoted by σ i x σ i y and τ i x y according to de silva 2014 the principal stress may be solved by the following equation 33 σ 2 σ i x σ i y σ σ i x σ i y τ i x y 2 0 the solution of equation 33 could be given by 34 s i 1 1 2 σ i x σ i y 1 2 σ i x σ i y 2 4 τ i x y 2 s i 2 1 2 σ i x σ i y 1 2 σ i x σ i y 2 4 τ i x y 2 the principal stresses are given by 35 σ i 1 m a x s i 1 s i 2 0 σ i 2 m e d s i 1 s i 2 0 σ i 3 m i n s i 1 s i 2 0 where σ i 1 σ i 2 and σ i 3 denote the major second and third principal stress of the particle i respectively m a x denotes the maximum value m e d denotes the median value and m i n denotes the minimum value according to the theory of distortion energy density de silva 2014 the von mises stress of the particle i is given by 36 σ i v o n 0 5 σ i 1 σ i 2 2 σ i 2 σ i 3 2 σ i 3 σ i 1 2 σ i x 2 σ i y 2 σ i x σ i y 3 τ i x y 2 according to the theory of maximum tension stress de silva 2014 the principal tension stress of the particle i is given by 37 σ i t σ i 1 1 2 σ i x σ i y 1 2 σ i x σ i y 2 4 τ i x y 2 σ x σ y τ x y 2 0 σ x σ y τ x y 2 in engineering applications the maximum stress of the structure is generally concerned as a result the von mises stress and the principal tension stress of a structure may be given by 38 σ v o n max 1 i n i σ i x 2 σ i y 2 σ i x σ i y 3 τ i x y 2 and 39 σ t max 1 i n i m a x 1 2 σ i x σ i y 1 2 σ i x σ i y 2 4 τ i x y 2 0 where n i denotes the particle number of the investigated part the time history curves of stress of al parts of the three cylinders are shown in fig 23 and the time history curves of stress of pu parts of the sandwich cylinders are shown in fig 24 in these figures σ s denotes the yield strength of al and σ p denotes the principal tensile failure stress of pu the values of σ s and σ p are given by yu hua et al 2004 and los alamos scientific lab 1969 respectively from these figures it may be seen that 1 both the peak stress of al cylinder and the peak stress of al layers of al pu al cylinder reaches the limit stress 2 the peak stress of al core of pu al pu is lowest about 250 mpa and less than the limit stress 3 the peak stresses of pu parts of the two sandwich cylinders are both not exceeding 3 mpa far less than the limit stress as may be also seen from figs 23 and 24 the stress differences between al parts and pu parts of the same sandwich cylinder are large for comparison here introduces the concept of stress level which is given by 40 l σ m a x σ v o n σ s σ t σ p 100 through value of l σ it is easy to determine whether the structure has experienced stress failure if l σ is less than 100 the stress of the structure is safe otherwise the structure may experience a stress failure according to figs 23 and 24 and equation 40 the stress levels of al cylinder and al pu al cylinder are both 100 and the stress level of pu al pu cylinder is about 86 the stress contours of the whole cylinders are shown in figs 25 29 respectively considering that the stress of pu is much less than that of al the stress contours of pu parts of sandwich cylinders are extracted separately as shown in figs 27 and 29 for simplicity a normalized scale is used in the stress contours since the time history curves of the maximum stress of all the parts have been given in figs 23 and 24 comparing stress contours with time history curve of maximum stress makes it easy to estimate the stress at each point at a given moment from figs 25 29 it may be seen that 1 the stress of the al cylinder diffuses from its contact point with water to the entire cylinder and the large stress occurs in the area near the highest lowest left and right points of the inner and outer surfaces 2 the stress distribution of the al layers of al pu al cylinder is similar to that of the al cylinder and the large stress position of the pu core is deflected approximately 45 angle relative to the large stress position of the al layer 3 the stress of pu layers of the pu al pu cylinder diffuses from its contact point with water to both sides and the stress of its al core diffuses from the lowest point of its inner cavity to other locations resulting in a pattern similar to that of the al cylinder according to the regularities of stress distribution presented in the stress contours a series of observation points are defined as shown in fig 30 the stress responses of observation points of the cylinders are shown in figs 31 35 the semi logarithmic coordinate system is adopted in figs 33 and 35 to distinguish the stress of each observation point of pu parts since the stress level of pu is especially low for al cylinder it may be seen from fig 31 that 1 the maximum stress of the outer surface is 240 mpa occurring at points 1 and 5 lower than that of the inner surface about 290 mpa and occurring point 10 2 the stress of the point at the internal surface is greater than that of the point at the outside surface in the same direction e g the stress of point 6 is greater than that of point 1 and so on 3 there are some points with similar stresses e g points 1 3 and 5 points 6 8 and 10 etc for al pu al cylinder it may be seen from figs 32 and 33 that 1 the maximum stress of the outer al layer is 260 mpa occurring at point 5 lower than that of the inner al layer about 290 mpa and occurring point 10 2 the maximum stress of the outer surface of the pu core is about 1 mpa occurring at point 13 lower than that of the inner surface of the pu core about 3 mpa and occurring at point 19 for pu al pu cylinder it may be seen from figs 34 and 35 that 1 the maximum stress of the outer surface of al core is about 220 mpa occurring at point 1 lower than that of the inner surface of al core about 250 mpa and occurring point 6 2 the maximum stress of the outer pu layer is about 3 mpa occurring at point 12 greater than that of the inner pu layer about 0 5 mpa and occurring at point 17 3 on the al core the stress of the point at the internal surface is greater than that of the point at the outside surface in the same direction e g the stress of point 6 is greater than that of point 1 and so on however the similar regularity does not exist on the pu layers 4 there are some points with similar stresses e g points 1 3 and 5 points 6 8 and 10 etc 4 4 dynamic deformation the maximum deformation of a hollow cylinder usually occurs on its inner and outer surfaces therefore the deformation of a cylinder may be expressed as 41 δ max 1 i n s δ i where δ denotes the maximum deformation at each time step δ i denotes the deformation of the particle i of the inner and outer surfaces and n s denotes the particle number of the inner and outer surfaces the time history curves of maximum deformations of the three cylinders are shown in fig 36 it may be seen from fig 36 that 1 the peak deformation of the al cylinder is about 0 64 mm 2 the peak deformation of the al pu al cylinder is about 0 92 mm 3 the peak deformation of the pu al pu cylinder is about 0 68 mm therefore the deformation of al cylinder is the smallest the deformation of pu al pu cylinder is slightly larger than that of al cylinder while the deformation of al pu al cylinder is the largest and obviously larger than those of the first two the deformation response at the observation points are shown in figs 37 41 from these figures it may be seen that 1 for al cylinder the maximum deformations of the outer and inner surfaces are both about 0 64 mm occurring at points 5 and 10 respectively there are some points with similar deformations e g points 1 3 and 5 points 1 3 and 5 points 2 and 4 points 6 8 and 10 points 7 and 9 etc 2 for al pu al cylinder the maximum deformation of the outer al layer is about 0 92 mm occurring at point 5 and larger than that of the inner al layer about 0 76 mm and occurring at point 10 the maximum deformation of the outer al layer is equivalent to that of the outer surface of pu core about 0 92 mm and occurring at point 15 and the maximum deformation of the inner al layer is equivalent to that of the inner surface of pu core about 0 76 mm and occurring at point 20 3 for pu al pu cylinder the maximum deformations of the outer and inner surfaces of al core are both 0 24 mm occurring at points 1 and 6 respectively the maximum deformation of the outer pu layer is about 0 68 mm occurring at points 12 and much larger than that of the inner pu layer about 0 24 mm and occurring at point 17 there are some points with similar deformations e g points 1 3 and 5 points 2 and 4 points 6 8 and 10 points 7 and 9 etc 4 5 comparison of two initial conditions at the same initial kinetic energy the time history curves of contact pressures impact forces impact accelerations stresses and deformations are respectively shown in figs 42 47 from these figures it may be seen that 1 the peaks of contact pressures of al al pu al and pu al pu cylinders are about 36 mpa 30 mpa and 32 mpa respectively 2 the peaks of impact forces of al al pu al and pu al pu cylinders are about 900 n 760 n and 800 n respectively 3 the peak accelerations of al al pu al and pu al pu cylinders are 64 m s2 80 m s2 and 76 m s2 4 the peak stress of al cylinder is the lowest about 240 mpa the peak stress of the al core of pu al pu cylinder about 245 mpa is slightly larger than that of the al cylinder and the peak stress of the al layers of al pu al cylinder is the greatest reaching the limit stress 5 the stresses of the pu parts of the two sandwich cylinders are both not exceeding 3 mpa far less than the limit stress 6 the peak deformation of al cylinder is the lowest about 0 48 mm the peak deformation of pu al pu cylinder is moderate about 0 65 mm and the peak deformation of al pu al cylinder is the largest about 0 92 mm next are comparisons of the two initial conditions for simplicity the three cylinders are numbered 0 for al cylinder 1 for al pu al cylinder and 2 for pu al pu cylinder by comparing the time history curves of the cylinders under two types of initial conditions the differences in contact pressures impact forces impact accelerations stress levels and deformations are respectively shown in figs 48 52 where v and ke denote velocity and kinetic energy respectively from figs 48 52 it may be seen that adjusting the first initial condition to the second initial condition has the greatest effect on the results of the al cylinder less on those of the pu al pu cylinder and no effect on those of the al pu al cylinder the detailed differences are as follows 1 at the same initial velocity the al cylinder has the greatest contact pressure impact force and stress level while its acceleration and deformation are both the least the al pu al cylinder has the least contact pressure and impact force and moderate acceleration however its stress level and deformation are both the largest the pu al pu cylinder has moderate contact pressure and impact force the largest acceleration and the lowest stress level and its deformation is slightly larger than that of al cylinder 2 at the same initial kinetic energy the al cylinder has the greatest contact pressure and impact force but the lowest acceleration stress level and deformation the al pu al cylinder has the least contact pressure and impact force but the greatest acceleration stress level and deformation the pu al pu cylinder has moderate contact pressure impact force impact acceleration and deformation and its stress level is just slightly higher than that of al cylinder 4 6 effect of stress strain relationship on stress as may be seen from fig 13 the stress strain relationship of pu is always nonlinear and there is no proportional limit and yield limit like that of al see fig 12 therefore for pu it may not be necessary to make linear and nonlinear comparisons since it is lacking theoretical and engineering basis to reduce its stress strain relationship to a linear model different from that of pu the stress strain relationship of al is linear when the stress does not exceed the proportional limit and non linear when the stress exceeds the proportional limit and there is a yield limit in theoretical research and engineering application the stress strain relationship of al or metal materials with similar characteristics may be simplified into linear bilinear or multilinear model as shown in fig 53 the differences of numerical results generated from these three material models are illustrated by the first kind of initial conditions based on the three material models the time history curves of stresses of al parts of the three cylinders are shown in figs 54 56 respectively for al cylinder it may be seen from fig 54 that the peak stress of linear model is about 310 mpa greater than the yield strength the stress curve of the bilinear model has a horizontal straight segment may be named as stress platform the same below of 290 mpa between 0 10 ms and 0 16 ms the stress curve of the multilinear model has a peak of 290 mpa but no stress platform is formed the reason for the differences is that the yield limit is treated differently by the three material models the linear model is not restricted by yield the bilinear model assumes that there is a yield platform below which the stress increases proportionally with the strain the multilinear model uses a series of line segments with decreasing slope to slowly approach the yield limit until the slope is 0 for the al layers of al pu al cylinder it may be seen from fig 55 that the peak stress of linear model is about 320 mpa greater than the yield strength the stress curve of the bilinear model has a stress platform of 290 mpa between 0 30 ms and 0 42 ms the stress curve of the multilinear model has a peak of 290 mpa but no stress platform is formed the reason for the differences is that the yield limit is treated differently by the three material models which has been explained in the previous paragraph for the al core of pu al pu cylinder it may be seen from fig 56 that the stress curves of the linear model and bilinear model are basically the same and have peak stresses of 270 mpa the peak stress of the multilinear model is about 250 mpa the reason for the coincidence of the stress curves of linear and bilinear models is that the stress strain relationships of the two are both linear between proportional limit and yield limit in contrast the stress strain relationship of the multilinear model is decreasing in slope between proportional limit and yield limit in addition as may be seen from figs 54 56 when the stress exceeds the proportional limit or even reaches the yield strength the difference in numerical results produced by the three material models is not large for the same structure the relative errors of peak stresses generated by different material models does not exceed 10 which may be negligible in some engineering applications 4 7 mechanism analysis generally speaking the stress and deformation of a structure during the impact process are determined by the impact force and the inherent strength and stiffness when other conditions are given johnson 1985 zukas et al 1982 the impact force of the cylinders under two types of initial conditions have been discussed in sections 4 2 and 4 5 respectively in this section the inherent strength and stiffness of the cylinders is investigated the method is to compare stresses and deformations of the cylinders subjected to the same loads and constraints the lower the stress the better the inherent strength the smaller the deformation the better the inherent stiffness according to de silva 2014 strength refers to the ability of a structure to resist yield fracture and other destruction produced by external forces and stiffness refers to the ability of a structure to resist deformation produced by external forces thus the same forces and constraints may be used to compare the inherent strength and stiffness of different structures suppose that the three cylinders are constrained by six degrees of freedom at the bottoms and are excited by the same shock pulse at the tops the shock pulse is given by 42 f t a t τ g t τ 2 where a denotes the amplitude of the shock pulse τ denotes the deadline of the shock pulse and g t denotes the gate function in this example a is equal to 900 n and τ is equal to 0 1 ms the time history curves of von mises stress of al and principal tension stress of pu generated by above shock pulse are shown in figs 57 and 58 respectively from these two figures it may be seen that 1 the peak stress of al cylinder is about 235 mpa less than the yield stress 2 the peak stress of al layers of the al pu al cylinder reaches the yield stress 290 mpa and the peak stress of pu core of the al pu al cylinder is about 4 mpa far less than the principal tensile failure stress 3 the peak stress of al core of the pu al pu cylinder is about 260 mpa greater than that of al cylinder and less than the yield stress and the peak stress of pu layers of the pu al pu cylinder is about 3 mpa obviously less than the principal tensile failure stress according to figs 57 and 58 and equation 40 under the action of shock pulse given by equation 42 the stress level of al pu al cylinder is 100 while the stress level of al cylinder and pu al pu cylinder are 79 and 90 respectively as a result the al pu al cylinder experiences stress failure which does not occur in the al cylinder and pu al pu cylinder it implies that the inherent strength of al cylinder is the best the inherent strength of pu al pu cylinder is moderate and the inherent strength of al pu al cylinder is the worst the time history curves of deformation of the three cylinders subjected to the shock pulse given by equation 42 are shown in fig 59 it may be seen from fig 59 that 1 the maximum deformation of the al cylinder is about 0 50 mm 2 the maximum deformation of the al pu al cylinder is about 1 2 mm 3 the maximum deformation of the pu al pu cylinder is about 0 76 mm it implies that the inherent stiffness of al cylinder is the best the inherent stiffness of pu al pu cylinder is moderate and the inherent stiffness of al pu al cylinder is the worst next is a comparison of the results of the cylinders in three cases the first case is that the cylinders hit water at an initial velocity of 50 m s the second case is that the cylinders hit water at the initial kinetic energy of 12 19 kj and the third case is that the cylinders are subjected to the same shock pulse given by equation 42 the physical quantities such as contact pressure impact force acceleration stress and deformation which reflect the impact performance of cylinder hitting water from different angles have been discussed earlier in essence cylinder hitting water is a kind of collision problem in the existing literatures on collisions johnson 1985 zukas et al 1982 more attention is generally paid to impact force and the resulting stress and deformation which are focused on in this section as well the comparisons of these three main physical quantities are listed in table 3 according to table 3 the following laws may be summarized 1 impact force during water entry the impact forces of the cylinders have similar regularities under two types of initial conditions the impact force of al cylinder is the greatest the impact force of pu al pu cylinder is moderate and the impact force of al pu al cylinder is the least however the differences in the impact forces of the three cylinders at the same initial kinetic energy is less than those at the same initial velocity 2 inherent strength and stiffness the inherent strength and stiffness of the cylinders are compared by comparing the stresses and deformations under the action of the same shock pulse the al cylinder has the best inherent strength and stiffness since its stress and deformation generated by the shock pulse are both smallest similarly it may be deduced that the pu al pu cylinder has moderate inherent strength and stiffness and the al pu al cylinder has the poorest inherent strength and stiffness 3 inducement of stress level and deformation during water entry the al pu al cylinder has the least impact force but its stress and deformation are both the greatest under the two initial conditions attributing to its poor inherent strength and stiffness interestingly the al cylinder has the best inherent strength and stiffness but its stress level reaches the yield limit under the first initial condition attributing to its greatest impact force however the stress level of al cylinder is the lowest under the second initial condition in contrast the pu al pu cylinder has moderate impact force and moderate inherent strength and stiffness which combine to present excellent mechanical properties its stress level is the lowest under the first initial condition and just a little higher that of the al cylinder under the second initial condition furthermore the deformation of the pu al pu cylinder is small as well under both initial conditions 5 conclusions this paper focuses on the impact performances of al cylinder al pu al cylinder and pu al pu cylinder during water entry the sph method is used in this study based on the research status of sph the standard sph method is modified to be suitable for the problem of solid fluid impact the sph method is validated by an existing experiment then the sph models are established and pressure force acceleration stress and deformation are solved and discussed researches show that 1 when the three cylinders hit water at the same initial velocity the pu al pu cylinder has the lowest stress level and a small deformation the al cylinder has a high stress level and the smallest deformation and the al pu al cylinder has the highest stress level and the largest deformation 2 when the three cylinders hit water at the same initial kinetic energy the al cylinder has the lowest stress level and the smallest deformation the pu al pu cylinder has a small deformation and a stress level slightly higher than that of the al cylinder and the al pu al cylinder still has the highest stress level and the largest deformation it indicates that during water entry if the initial velocity is given the pu al pu cylinder has the best resistance to stress failure and deformation if the initial kinetic energy is given the al cylinder has the best resistance to stress failure and deformation and the resistance of pu al pu cylinder to stress failure and deformation is second only to that of al cylinder under these two initial conditions the al pu al cylinder is always the easiest to experience failures resulting from large stress and deformation further studies indicate that the stress and deformation of the cylinders during water entry may be attributed to the combined action of the impact force and their inherent strength and stiffness the defect of the al pu al cylinder is that it has insufficient inherent strength and stiffness resulting in the highest stress level and the largest deformation under the same initial conditions the defect of the al cylinder is that it has the greatest impact force under the same initial conditions especially at the same initial velocity the al cylinder has a high stress level despite having the best inherent strength and stiffness different from the first two cylinders the pu al pu cylinder has moderate impact force and moderate inherent strength and stiffness resulting in good mechanical properties at the same initial velocity the pu al pu cylinder has the lowest stress level and a small deformation at the same initial kinetic energy the pu al pu cylinder has a low stress level just slightly higher than that of the al cylinder and a small deformation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the work is supported by the national natural science foundation of china grant no 51709229 and natural science basic research plan in shaanxi province of china grant no 2018jq5092 
22118,wake flow behind structures is of fundamental significance and practical interest in ocean engineering several asymmetric flow patterns such as the deflected stationary flip flop and deflected oscillatory wakes behind two cylinders in a side by side arrangement have been reported most recently in the present work direct numerical simulations together with the state of art dynamic mode decomposition are used to reveal the underlying physics of deflected oscillatory wake pattern with low reynolds number and intermediate gap ratio asymmetric flow structures are observed numerically in certain arrangements specially the structure for gap flow is similar to that observed in flip flop pattern induced by the secondary instability but asymmetric here it is found that the drag coefficient and lift coefficient under such circumstances are dominated by the asymmetric gap flow structure rather than the vortex street in the downstream the present work provides a new scenario to the wake flow patterns behind two side by side cylinders with intermediate gap ratios and it is potentially helpful in understanding the vibrating behaviors of adjacent cylinders keywords side by side cylinders deflected flow dynamic mode decomposition lattice boltzmann method secondary instability 1 introduction flow past multiple bodies is an important issue in the design of marine structures such as oil platforms offshore wind farms drilling risers and seabed group pipelines studies on two cylinders with side by side arrangement are usually preferred considering its simple configuration to illustrate interference phenomenon sumner and wong 1999 zhou et al 2000 the wake interference due to near vicinity of the two bluff bodies result in distinct force and wake regimes for stationary configurations alam et al 2017 alam and zhou 2007 chen et al 2003 han et al 2014 islam et al 2016 pang et al 2016 ryu et al 2009 these wake patterns will eventually result in various vortex induced vibration viv behaviors for adjacent flexible cylinders chen et al 2015 cui et al 2014 huera huarte and gharib 2011 kim and alam 2015 liu et al 2001 sanaati and kato 2014 such wake flows are known to have complex characteristics that mainly dependent on two dimensionless parameters the reynolds number re u d ν and the gap ratio g g d here u denotes the free stream velocity d the cylinder diameter ν the kinematic viscosity and g the nearest distance of the two cylinder walls earlier experimental studies show virtually two independent vortex streets with g 5 0 while synchronized wakes in phase or anti phase with 1 0 g 5 0 sumner and wong 1999 the flow patterns shift most drastically within approximately 0 2 g 1 2 sumner and wong 1999 williamson 1985 zdravkovich and pridden 1977 zhou et al 2002 several asymmetric wake patterns such as the deflected stationary flip flop and deflected oscillatory wakes were reported in both numerical and experimental studies among those works kang 2003 did comprehensive numerical simulations for various re and g he observed a deflected wake flow in a very narrow range of parameters for instances re 70 and g 0 5 he inferred such flow pattern as a flip flopping one with considerably large switch over time but didn t capture any flip over phenomenon in their simulations later on mizushima and ino 2008 observed a steady deflected flow at re 57 and g 0 5 via the direct numerical simulation dns carini et al 2015 obtained the same pattern with almost the same parameters via both the dns and manifold approximation mizushima and ino studied the wake flow via linear stability and bifurcation analysis and the wake for re 70 and g 0 5 was concluded as a deflected oscillatory pattern they also conjectured that such pattern originated from a hopf bifurcation and a pitchfork bifurcation according to the authors the unsteady vortex street due to the primary instability is associated the former meanwhile the latter is induced from a stationary unstable mode simultaneously a periodic oscillation of the measured velocity v 2 which is in the vortex street region and related to the pitchfork bifurcation can be observed in fig 4 in mizushima and ino 2008 the time scale for v 2 is close to v 1 which is measured in the gap flow region however it is not discussed in that paper how the pitchfork bifurcation leads to periodic oscillatory flow under such circumstance and why the two time scales are almost the same according to kang s diagram for wake pattern regimes kang 2003 the formation of the deflected wake pattern provides a key insight on how other asymmetric wake patterns such as flip flopping wake develop especially in the gap flow region yet the underlying mechanism of the deflected oscillatory flow is still not well understood so far on the other hand in a stability analysis recently carini et al 2014 presented a new scenario to the flip flop wake pattern behind two side by side cylinders the floquet analysis was performed for the in phase periodic base flow they claimed that the flip flop was originated from a secondary instability the time scale of the secondary instability is one order larger than that of the vortex shedding such new theory has been confirmed by our previous study bai et al 2016 via the dynamic mode decomposition dmd of numerical results from the dns with lattice boltzmann method dns lbm in light of the above studies the physical insight of the deflected oscillatory wake flow is of great interest the present work extends our recent study bai et al 2016 and investigates the underlying mechanism of the deflected wake at re 70 and g 0 5 as well as g 0 75 the numerical methods employed in this study including the lbm and dmd together with physical model and dns simulation setup are introduced in section 2 numerical results are given and discussed in section 3 the conclusions are summarized in section 4 2 numerical methods and simulation setup 2 1 the lattice boltzmann method instead of directly solving the incompressible navier stokes equations the lbm calculates fluid particle density distribution function f governed by the following equation qian et al 1992 to track the movements of fluid particles 1 f α x e α d t t d t f α x t 1 τ f α x t f α eq x t in which f α and f α eq stand for the local fluid particle density distribution function and its equilibrium respectively the subscript α is the index of the speed e which describes the lattice τ is the non dimensional relaxation time of particle collision and d t is the time step for particle streaming the lhs of eq 1 stands for the streaming motion of the particles meanwhile the rhs is the bgk collision term f α eq is a function of the local quantities of the field such as the fluid density ρ the fluid velocity u and the sound speed c s based on the maxwellian distribution the macroscopic fluid properties solved as variables in traditional navier stokes equations such as ρ u and the pressure p now can be calculated based on f α obtained through eq 1 2 2 dns simulation setup flows around two side by side cylinders at re 70 are studied with the dns lbm as shown in fig 1 a square channel with size l x l y 65 d 65 d is considered the inlet flow prescribed with a uniform velocity u comes from the left side passes through two cylinders located at 15 d away from the inlet boundary at the outlet boundary the flow is fully developed with velocity zero gradient in the main flow direction the cylinders are placed symmetrically with distance g g d 0 5 or 0 75 the walls of the cylinders are non slip while the upper and lower boundaries of the channel are slip in order to simplify the following analysis the inlet velocity u and the diameter d are set to be quantities with unit values the dns lbm is used to resolve flow details and produce vorticity fields for the dmd systematic mesh and time step independent tests have been carried out for case with gap ratio g 0 5 before productive simulations in this study time step d t 2 5 e 4 s together with n d 80 n d being the number of lattices per cylinder diameter are adopted for productive dns lbm simulation to get the fully developed wake the durations of simulations are chosen to be 10 times of that used in the paper of kang 2003 2 3 the dynamic mode decomposition method the dmd analysis in this study employs the algorithm proposed in schmid s work schmid 2010 simulation results within a time range are produced with a time interval δ t s and then flow field snapshots are assembled in matrix v n 1 it is assumed that in the dynamic flow system a linear map operator λ can map a given v j onto the following v j 1 in the formulation below 2 v n 1 v 1 v 2 v 3 v n v 1 λ v 1 λ 2 v 1 λ n 1 v 1 the eigenvalues of above equation provide frequency real part and growth rate imaginary part of each mode for the complex dynamic system as soon as the number of snapshots is sufficiently provided to determine the underlying physics the following formula holds 3 λ v n 1 v n 1 2 v n 1 s r in which r denotes the residual of above mapping process by singular value decomposition svd the companion matrix s whose eigenvalues are used to approximate the eigenvalues of the operator λ can be obtained by minimizing the residual r afterwards the ritz values and corresponding eigenvectors of matrix s can thus be used to reconstruct the flow field as introduced by schmid 2010 in this study the time interval between the vorticity snapshots for the dmd is determined according to the frequency results obtained by fft analysis of the drag coefficients c d specifically the sampling frequency is set to be 30 times of the frequency f 1 corresponding to the karman vortex shedding component and this will ensure that the sampling procedure can be used to identify dmd flow modes up to high order as long as the nyquist request is met whose frequency is far away beyond the interest of this work on the other hand the time range of the flow field snapshots in the dmd analysis is determined to be two complete periods corresponding to the lowest frequency wake flow components so that the number of the sampling snapshots is sufficiently enough for the dmd analysis 3 results and discussion time histories of the non dimensional drag coefficients c d and lift coefficients c l for two cases g g d 0 5 and 0 75 are given in fig 2 periodic oscillations of the coefficients which are not presented in kang et al s work kang 2003 can be observed here after 1500 s for all curves it is shown from fig 2 that the mean values and amplitudes of the fluctuations for both coefficients are different for two cylinders at the fully developed state the drag coefficients c d on cylinder 1 are always higher than those of the other cylinder this is due to the fact of flow being deflected toward cylinder 1 which will be studied in detail later in this section for the case with re 70 and g 0 75 the fluctuations of c d on cylinder 1 are much weaker compared with its counterpart as shown in fig 2 a it could also be seen from fig 2 b that the lift coefficients c l on cylinder 1 are always larger than those on the other cylinder for both cases instantaneous vorticity fields at the fully developed state are depicted in fig 3 only the region close to the cylinders is shown for both cases a narrow wake is formed behind cylinder 1 while a wide one is found behind cylinder 2 vortex streets located at about 10 d behind the cylinders can be noticed for both cases to understand the mechanism of the deflected pattern the dmd analysis is adopted a series of vorticity fields snapshots is extracted and used as input of the dmd analysis in particular the vorticity fields of fully developed wake flows with 1622 25 s t 1872 25 s have been prepared for g 0 5 while 2648 875 s t 3290 25 s for g 0 75 the ritz values μ of both cases are given in fig 4 a and c respectively it can be seen that all ritz values are located on the limit cycle and no unstable mode is observed in the fully developed state m i i 0 1 s 1 s 1 s are the main characteristic modes extracted from the data in particular the modes m 0 m 1 and m s correspond to the steady base flow the large scale vortex shedding and the secondary instability due to the gap flow respectively the dmd spectra for two cases are illustrated in fig 4 b and d both spectra are similar to that of the flip flop reported in our previous work bai et al 2016 besides the peak of mean flow s t 0 and the primary peak s t 1 peaks of a small strouhal number s t s as well as the tertiary frequencies s t 1 s t s can be found in fig 4 in order to the clarify the role of the secondary instability in the deflected wake pattern the strouhal number are summarized in table 1 where the subscripts 1 s 1 s 1 s of st are same as those for the dynamic modes denoting the primary vortex shedding mode the secondary instability mode and the two tertiary modes same as what we found for the flip flop wake pattern the relations of s t 1 s s t 1 s t s and s t 1 s s t 1 s t s hold for the present deflected pattern the relation among those four strouhal numbers can be rewritten as a trigonometric formula sin ω 1 t sin ω s t 1 2 cos ω 1 s t cos ω 1 s t where the angular frequency ω i 2 π f i corresponds to the i th strouhal number s t i it is thus evident that the tertiary components are resulted from the nonlinear interaction of the those corresponding to the s t 1 and s t s through advection mechanism as the nonlinear advection in the incompressible navier stokes equation is a production term the tertiary deflected wake modes m 1 s can thus also be explained as a secondary instability phenomenon originated from the primary stability or karman vortex shedding mode additionally the peaks with higher strouhal number st correspond to higher order harmonic modes due to the interaction of the primary vortex shedding mode with itself thus resulting in s t 2 s s t 3 s and so on interaction between these high harmonic modes and the secondary instability mode m s thus resulting in s t 2 s s t 3 s and so on and lastly the interaction between all above dynamic modes this can also be found in fig 5 for the flip flop wake analysis in bai et al 2016 we chose only the flow modes m 0 m 1 m s m 1 s that are needed to understand the underlying physics responsible for the wake flow and force coefficients difference induced by the gap ratio while the higher order components listed above are omitted in discussion corresponding vorticity modes or ritz vectors for s t 0 s t 1 and s t s are m 0 m 1 and m s respectively they are shown in fig 5 with three dimensional representations and two dimensional projections for both g 0 5 and 0 75 different from what we found in the flip flop pattern bai et al 2016 none of these modes is symmetric or anti symmetric as in flip flopping wake with respect to the geometric axis of symmetry vorticity bubbles which represent the recirculation flows are formed behind cylinder 1 in mode m 0 for both cases fig 5 top the sizes of the bubbles are different with respect to different g an alternatively sign varying vorticity pattern located from 10 d behind the cylinders to far downstream region can be found in mode m 1 fig 5 middle such pattern represents the vortex street in the downstream region it is the mode corresponding to the primary instability which results in the karman vortex shedding in the downstream wake corresponding strouhal number s t 1 is of the vortex shedding the patterns of this mode located from 0 d to about 10 d behind cylinders are different from each other for both cases it indicates that the corresponding flow structure in such region is more sensitive to the parameters than that in far downstream region since the two measured velocities v 1 and v 2 in mizushima and ino s work mizushima and ino 2008 share the vortex shedding frequency it is deduced that the oscillation of the velocities at the two specified probes in their work is resulted from the shear layer instability as the sensitivity of the parameters of the mode is different from the locations the bifurcation diagrams differ most specially mode m s is first time found for the deflected wake pattern such modes for both cases are similar to that of the secondary instability extracted from the flip flopping wake flow in our previous work bai et al 2016 however m s here is not symmetric with respect to the geometric axis of symmetry it is speculated that here is also a secondary instability as in the flip flop pattern bai et al 2016 for two cylinders under such arrangements to further understand the effect of the mode m s linear combination of modes m 0 and m s at different phases are depicted in fig 6 for both g 0 75 and 0 5 as can be seen the vorticity bubbles behind cylinder 1 in the mode m 0 are stretched and compressed periodically as a result of mode m s simultaneously fast fourier transfer is performed for c d and results are given in fig 7 corresponding strouhal numbers of the primary peaks are equal to s t s mode m s for both cases it can be concluded that the oscillation of coefficients is dominated by flow structure presented by mode m s rather than the vortex shedding it s also noticed that the vorticity bubble behind cylinder 1 for g 0 75 is longer than that for g 0 5 and the fluctuations of c d for corresponding cylinders with g 0 75 are consequently much weaker compared with the other case as shown in fig 2 another issue arises when we refer to the energy plot in fig 4 the energy of m 1 is almost two orders in magnitude larger than that of m s but it contributes negligibly to c d by checking with fig 3 it can be found that the vortex shedding with s t 1 initiates at around 7 8 d behind the cylinders which induces quite limited drag force fluctuations on both cylinders the second instability mode m s on the other hand dominates in the gap flow region it is more obvious in the psd power spectrum density plot of c d in fig 7 the psds of two cylinders for g 0 5 are quite similar while distinct discrepancy is found for g 0 75 as expected due to size difference of the recirculation bubble behind the flow deflected cylinder it can also be noticed that for cylinder 2 the dynamic mode m 1 s the peak on the right side of s t 1 in fig 7 b and d contributes more than m 1 4 conclusions in summary we investigated the deflected oscillatory wake pattern behind two circular cylinders numerically using the dns lbm and the dmd our results provide the underlying physics of the flow pattern different from the other asymmetric wake patterns such as flip flop the major modes extracted from the flow are all asymmetric with respect to the geometric axis of symmetry an asymmetric flow structure of the gap flow m s which is similar to the symmetric secondary instability in the flip flop wake pattern reported by carini et al 2014 and bai et al 2016 is first time observed in the deflected oscillatory wake pattern at re 70 and g 0 5 as well as g 0 75 it is also found that under such arrangements both c d and c l are dominated by the asymmetric flow structure rather than the vortex street in the downstream the present work provides a new scenario to the wake flow patterns and such scenario will be extended to study flow passing through structures with more complex geometries such as oil platforms drilling risers and wind farm arrangements in ocean engineering acknowledgements this work was supported by the national natural science foundation of china grant no 51809084 91852117 and the max planck society 
22118,wake flow behind structures is of fundamental significance and practical interest in ocean engineering several asymmetric flow patterns such as the deflected stationary flip flop and deflected oscillatory wakes behind two cylinders in a side by side arrangement have been reported most recently in the present work direct numerical simulations together with the state of art dynamic mode decomposition are used to reveal the underlying physics of deflected oscillatory wake pattern with low reynolds number and intermediate gap ratio asymmetric flow structures are observed numerically in certain arrangements specially the structure for gap flow is similar to that observed in flip flop pattern induced by the secondary instability but asymmetric here it is found that the drag coefficient and lift coefficient under such circumstances are dominated by the asymmetric gap flow structure rather than the vortex street in the downstream the present work provides a new scenario to the wake flow patterns behind two side by side cylinders with intermediate gap ratios and it is potentially helpful in understanding the vibrating behaviors of adjacent cylinders keywords side by side cylinders deflected flow dynamic mode decomposition lattice boltzmann method secondary instability 1 introduction flow past multiple bodies is an important issue in the design of marine structures such as oil platforms offshore wind farms drilling risers and seabed group pipelines studies on two cylinders with side by side arrangement are usually preferred considering its simple configuration to illustrate interference phenomenon sumner and wong 1999 zhou et al 2000 the wake interference due to near vicinity of the two bluff bodies result in distinct force and wake regimes for stationary configurations alam et al 2017 alam and zhou 2007 chen et al 2003 han et al 2014 islam et al 2016 pang et al 2016 ryu et al 2009 these wake patterns will eventually result in various vortex induced vibration viv behaviors for adjacent flexible cylinders chen et al 2015 cui et al 2014 huera huarte and gharib 2011 kim and alam 2015 liu et al 2001 sanaati and kato 2014 such wake flows are known to have complex characteristics that mainly dependent on two dimensionless parameters the reynolds number re u d ν and the gap ratio g g d here u denotes the free stream velocity d the cylinder diameter ν the kinematic viscosity and g the nearest distance of the two cylinder walls earlier experimental studies show virtually two independent vortex streets with g 5 0 while synchronized wakes in phase or anti phase with 1 0 g 5 0 sumner and wong 1999 the flow patterns shift most drastically within approximately 0 2 g 1 2 sumner and wong 1999 williamson 1985 zdravkovich and pridden 1977 zhou et al 2002 several asymmetric wake patterns such as the deflected stationary flip flop and deflected oscillatory wakes were reported in both numerical and experimental studies among those works kang 2003 did comprehensive numerical simulations for various re and g he observed a deflected wake flow in a very narrow range of parameters for instances re 70 and g 0 5 he inferred such flow pattern as a flip flopping one with considerably large switch over time but didn t capture any flip over phenomenon in their simulations later on mizushima and ino 2008 observed a steady deflected flow at re 57 and g 0 5 via the direct numerical simulation dns carini et al 2015 obtained the same pattern with almost the same parameters via both the dns and manifold approximation mizushima and ino studied the wake flow via linear stability and bifurcation analysis and the wake for re 70 and g 0 5 was concluded as a deflected oscillatory pattern they also conjectured that such pattern originated from a hopf bifurcation and a pitchfork bifurcation according to the authors the unsteady vortex street due to the primary instability is associated the former meanwhile the latter is induced from a stationary unstable mode simultaneously a periodic oscillation of the measured velocity v 2 which is in the vortex street region and related to the pitchfork bifurcation can be observed in fig 4 in mizushima and ino 2008 the time scale for v 2 is close to v 1 which is measured in the gap flow region however it is not discussed in that paper how the pitchfork bifurcation leads to periodic oscillatory flow under such circumstance and why the two time scales are almost the same according to kang s diagram for wake pattern regimes kang 2003 the formation of the deflected wake pattern provides a key insight on how other asymmetric wake patterns such as flip flopping wake develop especially in the gap flow region yet the underlying mechanism of the deflected oscillatory flow is still not well understood so far on the other hand in a stability analysis recently carini et al 2014 presented a new scenario to the flip flop wake pattern behind two side by side cylinders the floquet analysis was performed for the in phase periodic base flow they claimed that the flip flop was originated from a secondary instability the time scale of the secondary instability is one order larger than that of the vortex shedding such new theory has been confirmed by our previous study bai et al 2016 via the dynamic mode decomposition dmd of numerical results from the dns with lattice boltzmann method dns lbm in light of the above studies the physical insight of the deflected oscillatory wake flow is of great interest the present work extends our recent study bai et al 2016 and investigates the underlying mechanism of the deflected wake at re 70 and g 0 5 as well as g 0 75 the numerical methods employed in this study including the lbm and dmd together with physical model and dns simulation setup are introduced in section 2 numerical results are given and discussed in section 3 the conclusions are summarized in section 4 2 numerical methods and simulation setup 2 1 the lattice boltzmann method instead of directly solving the incompressible navier stokes equations the lbm calculates fluid particle density distribution function f governed by the following equation qian et al 1992 to track the movements of fluid particles 1 f α x e α d t t d t f α x t 1 τ f α x t f α eq x t in which f α and f α eq stand for the local fluid particle density distribution function and its equilibrium respectively the subscript α is the index of the speed e which describes the lattice τ is the non dimensional relaxation time of particle collision and d t is the time step for particle streaming the lhs of eq 1 stands for the streaming motion of the particles meanwhile the rhs is the bgk collision term f α eq is a function of the local quantities of the field such as the fluid density ρ the fluid velocity u and the sound speed c s based on the maxwellian distribution the macroscopic fluid properties solved as variables in traditional navier stokes equations such as ρ u and the pressure p now can be calculated based on f α obtained through eq 1 2 2 dns simulation setup flows around two side by side cylinders at re 70 are studied with the dns lbm as shown in fig 1 a square channel with size l x l y 65 d 65 d is considered the inlet flow prescribed with a uniform velocity u comes from the left side passes through two cylinders located at 15 d away from the inlet boundary at the outlet boundary the flow is fully developed with velocity zero gradient in the main flow direction the cylinders are placed symmetrically with distance g g d 0 5 or 0 75 the walls of the cylinders are non slip while the upper and lower boundaries of the channel are slip in order to simplify the following analysis the inlet velocity u and the diameter d are set to be quantities with unit values the dns lbm is used to resolve flow details and produce vorticity fields for the dmd systematic mesh and time step independent tests have been carried out for case with gap ratio g 0 5 before productive simulations in this study time step d t 2 5 e 4 s together with n d 80 n d being the number of lattices per cylinder diameter are adopted for productive dns lbm simulation to get the fully developed wake the durations of simulations are chosen to be 10 times of that used in the paper of kang 2003 2 3 the dynamic mode decomposition method the dmd analysis in this study employs the algorithm proposed in schmid s work schmid 2010 simulation results within a time range are produced with a time interval δ t s and then flow field snapshots are assembled in matrix v n 1 it is assumed that in the dynamic flow system a linear map operator λ can map a given v j onto the following v j 1 in the formulation below 2 v n 1 v 1 v 2 v 3 v n v 1 λ v 1 λ 2 v 1 λ n 1 v 1 the eigenvalues of above equation provide frequency real part and growth rate imaginary part of each mode for the complex dynamic system as soon as the number of snapshots is sufficiently provided to determine the underlying physics the following formula holds 3 λ v n 1 v n 1 2 v n 1 s r in which r denotes the residual of above mapping process by singular value decomposition svd the companion matrix s whose eigenvalues are used to approximate the eigenvalues of the operator λ can be obtained by minimizing the residual r afterwards the ritz values and corresponding eigenvectors of matrix s can thus be used to reconstruct the flow field as introduced by schmid 2010 in this study the time interval between the vorticity snapshots for the dmd is determined according to the frequency results obtained by fft analysis of the drag coefficients c d specifically the sampling frequency is set to be 30 times of the frequency f 1 corresponding to the karman vortex shedding component and this will ensure that the sampling procedure can be used to identify dmd flow modes up to high order as long as the nyquist request is met whose frequency is far away beyond the interest of this work on the other hand the time range of the flow field snapshots in the dmd analysis is determined to be two complete periods corresponding to the lowest frequency wake flow components so that the number of the sampling snapshots is sufficiently enough for the dmd analysis 3 results and discussion time histories of the non dimensional drag coefficients c d and lift coefficients c l for two cases g g d 0 5 and 0 75 are given in fig 2 periodic oscillations of the coefficients which are not presented in kang et al s work kang 2003 can be observed here after 1500 s for all curves it is shown from fig 2 that the mean values and amplitudes of the fluctuations for both coefficients are different for two cylinders at the fully developed state the drag coefficients c d on cylinder 1 are always higher than those of the other cylinder this is due to the fact of flow being deflected toward cylinder 1 which will be studied in detail later in this section for the case with re 70 and g 0 75 the fluctuations of c d on cylinder 1 are much weaker compared with its counterpart as shown in fig 2 a it could also be seen from fig 2 b that the lift coefficients c l on cylinder 1 are always larger than those on the other cylinder for both cases instantaneous vorticity fields at the fully developed state are depicted in fig 3 only the region close to the cylinders is shown for both cases a narrow wake is formed behind cylinder 1 while a wide one is found behind cylinder 2 vortex streets located at about 10 d behind the cylinders can be noticed for both cases to understand the mechanism of the deflected pattern the dmd analysis is adopted a series of vorticity fields snapshots is extracted and used as input of the dmd analysis in particular the vorticity fields of fully developed wake flows with 1622 25 s t 1872 25 s have been prepared for g 0 5 while 2648 875 s t 3290 25 s for g 0 75 the ritz values μ of both cases are given in fig 4 a and c respectively it can be seen that all ritz values are located on the limit cycle and no unstable mode is observed in the fully developed state m i i 0 1 s 1 s 1 s are the main characteristic modes extracted from the data in particular the modes m 0 m 1 and m s correspond to the steady base flow the large scale vortex shedding and the secondary instability due to the gap flow respectively the dmd spectra for two cases are illustrated in fig 4 b and d both spectra are similar to that of the flip flop reported in our previous work bai et al 2016 besides the peak of mean flow s t 0 and the primary peak s t 1 peaks of a small strouhal number s t s as well as the tertiary frequencies s t 1 s t s can be found in fig 4 in order to the clarify the role of the secondary instability in the deflected wake pattern the strouhal number are summarized in table 1 where the subscripts 1 s 1 s 1 s of st are same as those for the dynamic modes denoting the primary vortex shedding mode the secondary instability mode and the two tertiary modes same as what we found for the flip flop wake pattern the relations of s t 1 s s t 1 s t s and s t 1 s s t 1 s t s hold for the present deflected pattern the relation among those four strouhal numbers can be rewritten as a trigonometric formula sin ω 1 t sin ω s t 1 2 cos ω 1 s t cos ω 1 s t where the angular frequency ω i 2 π f i corresponds to the i th strouhal number s t i it is thus evident that the tertiary components are resulted from the nonlinear interaction of the those corresponding to the s t 1 and s t s through advection mechanism as the nonlinear advection in the incompressible navier stokes equation is a production term the tertiary deflected wake modes m 1 s can thus also be explained as a secondary instability phenomenon originated from the primary stability or karman vortex shedding mode additionally the peaks with higher strouhal number st correspond to higher order harmonic modes due to the interaction of the primary vortex shedding mode with itself thus resulting in s t 2 s s t 3 s and so on interaction between these high harmonic modes and the secondary instability mode m s thus resulting in s t 2 s s t 3 s and so on and lastly the interaction between all above dynamic modes this can also be found in fig 5 for the flip flop wake analysis in bai et al 2016 we chose only the flow modes m 0 m 1 m s m 1 s that are needed to understand the underlying physics responsible for the wake flow and force coefficients difference induced by the gap ratio while the higher order components listed above are omitted in discussion corresponding vorticity modes or ritz vectors for s t 0 s t 1 and s t s are m 0 m 1 and m s respectively they are shown in fig 5 with three dimensional representations and two dimensional projections for both g 0 5 and 0 75 different from what we found in the flip flop pattern bai et al 2016 none of these modes is symmetric or anti symmetric as in flip flopping wake with respect to the geometric axis of symmetry vorticity bubbles which represent the recirculation flows are formed behind cylinder 1 in mode m 0 for both cases fig 5 top the sizes of the bubbles are different with respect to different g an alternatively sign varying vorticity pattern located from 10 d behind the cylinders to far downstream region can be found in mode m 1 fig 5 middle such pattern represents the vortex street in the downstream region it is the mode corresponding to the primary instability which results in the karman vortex shedding in the downstream wake corresponding strouhal number s t 1 is of the vortex shedding the patterns of this mode located from 0 d to about 10 d behind cylinders are different from each other for both cases it indicates that the corresponding flow structure in such region is more sensitive to the parameters than that in far downstream region since the two measured velocities v 1 and v 2 in mizushima and ino s work mizushima and ino 2008 share the vortex shedding frequency it is deduced that the oscillation of the velocities at the two specified probes in their work is resulted from the shear layer instability as the sensitivity of the parameters of the mode is different from the locations the bifurcation diagrams differ most specially mode m s is first time found for the deflected wake pattern such modes for both cases are similar to that of the secondary instability extracted from the flip flopping wake flow in our previous work bai et al 2016 however m s here is not symmetric with respect to the geometric axis of symmetry it is speculated that here is also a secondary instability as in the flip flop pattern bai et al 2016 for two cylinders under such arrangements to further understand the effect of the mode m s linear combination of modes m 0 and m s at different phases are depicted in fig 6 for both g 0 75 and 0 5 as can be seen the vorticity bubbles behind cylinder 1 in the mode m 0 are stretched and compressed periodically as a result of mode m s simultaneously fast fourier transfer is performed for c d and results are given in fig 7 corresponding strouhal numbers of the primary peaks are equal to s t s mode m s for both cases it can be concluded that the oscillation of coefficients is dominated by flow structure presented by mode m s rather than the vortex shedding it s also noticed that the vorticity bubble behind cylinder 1 for g 0 75 is longer than that for g 0 5 and the fluctuations of c d for corresponding cylinders with g 0 75 are consequently much weaker compared with the other case as shown in fig 2 another issue arises when we refer to the energy plot in fig 4 the energy of m 1 is almost two orders in magnitude larger than that of m s but it contributes negligibly to c d by checking with fig 3 it can be found that the vortex shedding with s t 1 initiates at around 7 8 d behind the cylinders which induces quite limited drag force fluctuations on both cylinders the second instability mode m s on the other hand dominates in the gap flow region it is more obvious in the psd power spectrum density plot of c d in fig 7 the psds of two cylinders for g 0 5 are quite similar while distinct discrepancy is found for g 0 75 as expected due to size difference of the recirculation bubble behind the flow deflected cylinder it can also be noticed that for cylinder 2 the dynamic mode m 1 s the peak on the right side of s t 1 in fig 7 b and d contributes more than m 1 4 conclusions in summary we investigated the deflected oscillatory wake pattern behind two circular cylinders numerically using the dns lbm and the dmd our results provide the underlying physics of the flow pattern different from the other asymmetric wake patterns such as flip flop the major modes extracted from the flow are all asymmetric with respect to the geometric axis of symmetry an asymmetric flow structure of the gap flow m s which is similar to the symmetric secondary instability in the flip flop wake pattern reported by carini et al 2014 and bai et al 2016 is first time observed in the deflected oscillatory wake pattern at re 70 and g 0 5 as well as g 0 75 it is also found that under such arrangements both c d and c l are dominated by the asymmetric flow structure rather than the vortex street in the downstream the present work provides a new scenario to the wake flow patterns and such scenario will be extended to study flow passing through structures with more complex geometries such as oil platforms drilling risers and wind farm arrangements in ocean engineering acknowledgements this work was supported by the national natural science foundation of china grant no 51809084 91852117 and the max planck society 
22119,ocean waves are a natural combination of wind sea and swell considering this physical process by comparing the magnitudes of splitting wind sea and swell energy long term wave climate can be classified into four basic components pure wind sea pure swell and two classes of combined seas wind sea stronger and swell stronger from one position in the north atlantic ocean across seasonal analysis on the 44 year 1958 2001 hindcast wave data calculated by wam in the hipocas project it was found that the four wave components behave distinctly hence in this study we propose using a mixture of distributions to perform the copula based statistical modelling of significant wave height and mean zero crossing wave period a case study was dedicated to testify the univariate and bivariate capacity of fitting the results demonstrate that 1 compared to straightforward fitting a distribution to data estimating the marginal distribution of the sea state parameter as a mixture of the four components can improve goodness of fit 2 the proposed copula mixture model can provide an outstanding fit to the bivariate wave data outperforming those constructed by copulas belonging to symmetric khoudraji liebscher and product families as well as the classical conditional modelling approach keywords significant wave height characteristic wave period wind sea swell copulas mixture distributions 1 introduction sea states are jointly governed by the significant wave height h s and characteristic wave period such as the mean zero crossing period t z or the peak period t p the joint probability distribution of h s and t z or t p has been used to describe the wave climate in specific ocean areas and is an essential tool for the design and assessment of coastal and off shore structures to leverage this tool many researchers have attempted to develop a model or method for examples ochi 1978 introduced a bivariate lognormal distribution in which the data of h s t z are separately pre processed to be approximately normally distributed using an exponential transformation before the bivariate lognormal distribution is applied fang and hogben 1982 improved upon this process by introducing a correction for skewness assuming that h s and the wave steepness s p are independent vrijling and bruinsma 1980 proposed a model on the basis of the marginal distributions of h s and s p combined with a function describing t p as a function of h s s p meanwhile haver 1985 and bitner gregersen and haver 1989 adopted the conditional modelling approach cma to model the joint distribution of h s t p by this way the marginal distribution of h s is fitted at first then conditional distributions of t p given by different class of h s are fitted to the data as to relate the parameters of these conditional distributions to the value of h s regression curves are used considering the significant wave height is generally taken as the primary parameter affecting design conditions of ocean structures this approach performs well in general e g bitner gregersen 2015 masina et al 2015 lucas and guedes soares 2015a vanem 2016 orimolade et al 2016 horn et al 2018 and recommended by dnv rp c205 2010 in morton and bowers 1996 a relatively complicated model was introduced the marginal density probability functions of h s and t p are transformed into a so called frechet space then the dependence between h s and t p is described by a complex statistical function to develop the model for the bivariate description of extreme wave heights and wave periods representing relatively deep water sea states repko et al 2004 compared the performances of the above five approaches and models according to the case studies results the model given by vrijling and bruinsma 1980 was recommended by developing an analogy with the measure of association in a fourfold contingency table plackett 1965 proposed a method for constructing a one parameter class of bivariate distributions from given margins athanassoulis et al 1994 applied the plackett bivariate structure to fit the joint distribution of h s and t z moreover nerzic and prevosto 2000 as well as soares and guedes soares 2007 also employed the plackett model to fit the joint distribution of h s and t p prince wright 1995 pre processed the joint environmental data via an extended variant of the box cox transformation box and cox 1964 which has been frequently applied in the modelling of wave time series cunha and guedes soares 1999 guedes soares and cunha 2000 the transformed data were fitted with a bivariate gaussian distribution bitner gregersen et al 1998 compared this method with the cma model and demonstrated that each one has advantages and challenges regarding wave moreover lucas and guedes soares 2015a also compared the goodness of fit of this approach with the cma and plackett model utilising the data of swell wind sea components and combined sea states from australia in addition a box cox transformation was also applied by ferreira and guedes soares 2002 with no assumptions made about the type of distribution the joint distribution of the transformed h s and t z data were estimated by the kernel density similarly the nataf transformation nataf 1962 can transform the initial distribution into a multivariate gaussian distribution which dong et al 2013 applied to the modelling of the joint distribution for the transformed h s and t p data sklar 1959 proposed the concept of copulas in this concept the marginal distributions of dependent variables can be first estimated then their correlation can be presented by a special copula function nelsen 2006 recent advancements in mathematics see nelsen 2006 salvadori et al 2007 joe 1997 joe 2014 durante and sempi 2015 exhibit how copulas may be an efficient tool for investigating the statistical behaviour of dependent variables over the years several studies have been dedicated to the application of copulas to describe the joint behaviours of h s and t z or t p such as de waal and van gelder 2005 salvadori and de michele 2007 de michele et al 2007 corbella and stretch 2013 montes iturrizaga and heredia zavoni 2015 2016 more recently vanem 2016 presented a detailed study on the goodness of fits of various statistical models used for the joint distribution of h s and t z including the cma model bivariate lognormal model and several models based on families of symmetric and asymmetric copulas vanem s results indicate that appropriate statistical models are still challenging to establish furthermore to capture asymmetric dependencies among ocean environmental parameters zhang et al 2018 examined several asymmetric copula functions capable of modelling both linear and nonlinear asymmetric dependence structures between ocean variables the significant wave height average wave period and wind speed in detail based on data fitting and tail dependency characterisations the author s results indicate that the asymmetric copulas have advantages over symmetric copula functions in real applications in fact ocean wave is often of a combined nature consisting of both wind sea and swell bitner gregersen and haver 1991 wind seas are waves under growth or in equilibrium with local wind which usually have short wave lengths and slow propagation speeds they require persistent momentum from the surface wind and are strongly coupled to the local wind janssen 1989 when the local wind diminishes or the waves are generated from elsewhere the residual waves are referred to as swells swells usually have longer wave lengths and faster propagation speeds than wind seas they travel long distances radiating momentum and energy across the ocean jiang and chen 2013 in practice the presence of wind sea and swell affect the design and operability of fixed and floating off shore structures as well as lng terminals and ship operations bitner gregersen 2015 hence increasing attention has been dedicated to the inclusion of wind sea and swell components in a joint met ocean description when conducting reliability studies e g bitner gregersen and haver 1991 lucas and guedes soares 2015a and horn et al 2018 taking this mechanism of ocean wave into consideration as suggested by vanem 2016 it may be more accurate and realistic to use a mixture of distributions to describe the long term joint behaviours of sea state parameters therefore considering that by comparing the magnitudes of splitting wind sea and swell energy the long term wave climates can be classified into four components pure wind sea pw pure swell ps and two classes of combined sea wind sea stronger cw and swell stronger cs in the present study we employ a mixture of distributions to perform the copula based statistical modelling of h s and t z to examine the model s fitting a case study is further dedicated to compare the present model s goodness of fit to those constructed by 1 traditional symmetric copula 2 asymmetric khoudraji liebscher copula 3 asymmetric product copula a generalisation of the khoudraji liebscher copula and 4 classical conditional modelling approach the remainder of this article is organised as follows in section 2 basic concepts of copula theory and its application are introduced then in section 3 the methodology for constructing the asymmetric khoudraji liebscher and product copulas is outlined the copula mixture model along with the wave energy composition criterion used for data pre processing is then introduced in section 4 the results of the case study are presented in section 5 which covers preliminary data analysis marginal and joint statistical models fitting as well as univariate and bivariate goodness of fit comparison finally in section 6 conclusions are drawn 2 copula theory and basics developed by sklar 1959 copulas are functions which couples univariate marginal distributions to their multivariate distribution considering a situation with two dependent random variables x y if f x y x y is a joint distribution function with marginal distributions f x x and f y y let u f x x and v f y y on account of sklar s representation theorem nelsen 2006 there then exists a copula function c u v such that for any x y 1 f x y x y c u v if f x x and f y y are continuous then c u v is unique conversely if c u v is a copula and f x x and f y y are distribution functions then c u v is a joint distribution function with margins of f x x and f y y under the assumption that marginal distributions are continuous with densities f x x and f y y the joint density f x y x y can be derived as 2 f x y x y f x x f y y c u v where c u v is the copula density defined as 3 c u v 2 c u v u v moreover let c u v and c v u represent the partial derivatives of copula functions with respect to u and v 4 c u v c u v u a n d c v u c u v v the conditional distribution functions including f x y x y p x x y y and f y x y x p y y x x can be given by 5 f x y x y c v u a n d f y x y x c u v with densities f x y x y and f y x y x expressed as 6 f x y x y f x x c u v a n d f y x y x f y y c u v the dependence structure between variables is one of the most important characteristic for a multivariate distribution given n pairs of bivariate samples x i y i i 1 n let r i denote the rank of x i among x i i 1 n whereas s i denotes the rank of y i among y i i 1 n the pairs of ranks r i s i i 1 n are the statistics that retain the greatest amount of dependence information genest and favre 2007 based on these ranks two robust nonparametric coefficients have been developed to objectively measure the dependence structure including kendall s τ and spearman s ρ kendall s τ measures the average likelihood ratio dependence whereas spearman s ρ measures the average quadrant dependence both these coefficients range in the interval 1 1 where the lower and upper bounds indicate fully discordant and fully concordant random variable sequences respectively salvadori et al 2014 because the transformations u f x x and v f y y are strictly monotone increasing and will leave the dependence structure unchanged the dependence structure associated with x y is the same as one with transformed variables u v which means c u v itself is a characterisation of the dependence in a pair x y furthermore kendall s τ and spearman s ρ are respectively asymptotically unbiased estimators of 7a τ 4 0 1 0 1 c u v d c u v 1 7b ρ 12 0 1 0 1 c u v d u d v 3 the so called empirical copula c n u v is defined as 8 c n u v 1 n i 1 n 1 1 n 1 r i u 1 n 1 s i v where 1 denotes the indicator function c n u v is the best sample based representation of the copula c u v beyond that there exist varieties of bivariate parametric copula families nelsen 2006 joe 1997 joe 2014 among which the ones most frequently applied in the hydrology community are those with one parameter such as gaussian copula of elliptical family e g salvadori et al 2007 dong et al 2013 li et al 2014 dong et al 2015a jane et al 2016 vanem 2016 gumbel frank clayton and ali mikhail haq copulas of archimedean family e g de michele et al 2007 zhang and singh 2007 salvadori et al 2007 corbella and stretch 2012 corbella and stretch 2013 dong et al 2015 sraj et al 2015 vanem 2016 zhang et al 2018 galambos and hüsler reiss copulas of extreme value family e g shiau 2006 salvadori et al 2007 masina et al 2015 sraj et al 2015 vanem 2016 plackett and farlie gumbel morgenstern copulas of algebraic family e g salvadori et al 2007 montes iturrizaga and heredia zavoni 2015 lucas and guedes soares 2015a vanem 2016 soukissian and karathanasi 2017 these copulas cover a wide range of possible dependency patterns however they all have the disadvantage of being symmetric c u v c v u for every u v 0 1 2 durante et al 2010 more importantly regarding copula based analysis for the joint distribution of multivariate ocean data not all these symmetric copulas are suitable for statistical modelling generally ocean variables such as wind speed wave height and period naturally have quite strong dependencies among each other in this regard the ali mikhail haq 0 18 kendall s τ 0 33 and farlie gumbel morgenstern 0 22 kendall s τ 0 22 copulas may not be appropriate because they can only model data with weakly positive or negative dependencies shiau 2006 zhang and singh 2007 furthermore even stronger dependencies are usually observed at extremes for instance storms with high wind speeds usually induce waves with large heights and periods therefore the clayton and frank copulas might be excluded from the underlying copulas as the clayton copula characterises data asymptotically independent and the frank copula is used for data with weak dependencies at both tails zhang et al 2018 the parameter estimation of the copula based joint probability model can be realised in various ways among which the maximum likelihood ml method is the most widely applied in this approach the maximum likelihood estimators mles of the model parameters are obtained by maximising the bellow log likelihood function 9 i 1 n ln f x y x i y i i 1 n ln f x x i i 1 n ln f y y i i 1 n ln c f x x i f y y i the exact ml method requires the parameters in the marginal distributions and copula function to be estimated simultaneously hence the computation can be intensive alternatively the two stage inference functions for margins ifm method joe 2005 can be used in this case the marginal distributions are estimated in first by separately maximising i 1 n l n f x x i and i 1 n l n f y y i after each distribution is plugged into the corresponding copula function and the function s mle s is further determined by maximising i 1 n l n c f x x i f y y i the ifm method is easily implemented and usually performs well yet it also has the risk of being unduly affected if the models selected for marginal distributions turn out to be inappropriate kim et al 2007 to have a more robust estimation without specifying the margins in this study we apply the maximum pseudo likelihood mpl method genest et al 1995 which updates the ifm method by estimating the mle s of the copula function based on the pairs of u i v i estimated by 10 u i 1 n 1 r i a n d v i 1 n 1 s i concerning a suitable copula function for modelling the joint behaviour of x y the corrected akaike information criterion aicc defined by eq 11 can be adopted to fairly select the preferred copula function among competing candidates the original aic statistic measures the fitting conditions between the model and the data based on entropy concepts whereas the aicc statistic corrects for finite sample sizes n anderson and burnham 2004 clearly other criteria can be used for example the minimum negative log likelihood the bayesian information or the cross validation criterion grønneberg and hjort 2014 salvadori et al 2014 11 a i c c 2 log l 2 p 2 p 1 p 2 n p 2 in eq 11 log l is the log likelihood function for the model p represents the number of estimated parameters the preferred model is the one with the minimum aicc value 3 product copulas approach ocean variables respond differently to the same environmental conditions and are restricted by certain physical limitations for instance it is impossible to have high waves with very short wave periods due to wave breaking hence multivariate ocean data are asymmetric by nature and cannot be modelled in a straightforward manner using symmetric copula families vanem 2016 zhang et al 2018 in recent years significant effort has been expended to develop copulas able to characterise asymmetric dependencies for example capéraà et al 2000 proposed the bivariate archimax copulas and mesiar and jágr 2013 further extended this class to multivariate copulas rodríguez lallana and úbeda flores 2004 introduced a class of bivariate copulas that can generalise some known families such as the farlie gumbel morgenstern copula kim et al 2011 and mesiar and najjari 2014 extended this study to new families of symmetric and asymmetric copulas alfonsi and brigo 2005 proposed a new construction method for asymmetric copulas based on periodic functions meanwhile liebscher 2008 introduced two methods for constructing asymmetric multivariate copulas the first of which is connected with products of copulas and close to what khoudraji 1995 proposed whereas the second is a generalisation of the archimedean family wu 2014 constructed asymmetric copulas using linear convex combinations of copulas also known as the flipped copula specified by salvadori et al 2007 moreover di bernardino and rulliere 2013 constructed a multivariate family of copulas by generalising some known families using a distortion matrix overall among these techniques the most popular and practical method is to formulate a product of copulas following liebscher 2008 a bivariate asymmetric copula function can be generally obtained by 12 c u v j 1 n c j g u j u g v j v where c j j 1 n are the n individual copulas which can be selected from various families of parametric copulas g s j s u v a n d j 1 n are power functions that participate in the asymmetric dependence modelling to ensure that the product of copulas is also a copula function these power functions should satisfy the following properties 1 g s j is strictly increasing in 0 1 and g s j 0 0 g s j 1 1 otherwise g s j is identically equal to 1 2 g s j is continuous on 0 1 3 if there are at least two functions g s j 1 and g s j 2 with 1 j 1 j 2 n which are not identically equal to 1 then g s j x x holds for x 0 1 j 1 n the density of the product copulas shown outlined above can be written as 13 c u v j 1 n c c j 2 c j g u j g v j g u j u g v j v c j g u j g u j u i j n 2 c c i c j c i g v i g v i v in which the partial derivatives c u v and c v u are given by 14 c u v j 1 n c c j c j g u j g u j u a n d c v u j 1 n c c j c j g v j g v j v it is evident that the product copulas are quite rich and versatile through changing the individual copula c j and the power function g i j an infinite number of variants able to capture various types of dependence structures can be generated salvadori et al 2014 moreover it is worth expressing that the simulation of product copulas is also easy to conduct suppose u 1 v 1 u n v n are n independent random vectors respectively generated from c 1 c n then max j 1 n g u j 1 u j max j 1 n g v j 1 v j is a random vector of the product copulas shown in eq 12 liebscher 2008 lists four alternatives suitable for the power function g j k among which the type i power function defined as g s j x x θ s j where θ s j 0 1 and j 1 n θ s j 1 is relatively simpler to use more importantly by utilising a type i power function and setting n 2 the corresponding product copula function becomes the powerful khoudraji liebscher device khoudraji 1995 durante and salvadori 2010 which is a state of the art technique for copula based analysis e g durante and salvadori 2010 de michele et al 2013 salvadori et al 2013 vanem 2016 zhang et al 2018 and recommended for applications of multivariate analysis and design in coastal and off shore engineering salvadori et al 2014 therefore in the present study we adopted a type i power function to construct our product copulas the major difficulty in applying product copulas is the parameter estimation to estimate the mles corresponding to the constrained nonlinear multivariate function i 1 n l n c u i v i a very robust and efficient optimisation algorithm to search for the global optimum solution is essential because the computational effort can become tremendous particularly when more individual copulas are considered in the present study the matlab solver multistart was applied to avoid solutions that converge to local basins the algorithm starts from multiple uniformly distributed points within bounds to search thoroughly for the global optimum 4 copula mixture modelling suppose that the joint distribution of x y is known to be a mixture of n components each component with an order of k k 1 n owns its individual copula function c k and marginal distributions f x k x f y k y mathematically the joint distribution function f x y x y in this case is formulated as 15 f x y x y k 1 n w k f x y k x y k 1 n w k c k f x k x f y k y where w k is the nonnegative weight parameter satisfying w k 0 1 and k 1 n w k 1 accordingly let u k f x k x v k f y k y then the joint density f x y x y herein can be derived as 16 f x y x y k 1 n w k f x y k x y k 1 n w k f x k x f y k y c k u k v k where c k f x k x and f y k y are the densities of c k f x k x and f y k y respectively the marginal distribution of x or y can also be expressed as a mixture distribution for instance in terms of x its marginal distribution function f x x and density f x x can be respectively given by 17 f x x k 1 n w k f x k x a n d f x x k 1 n w k f x k x furthermore because the density f x y x y of the conditional distribution f x y x y is defined by 18 f x y x y f x y x y f y y it is derived that the conditional distribution f x y x y of the copula mixture can be expressed as 19 f x y x y x f x y x y f y y d x x f x y x y d x f y y x k 1 n w k f x y k x y d x k 1 n w k f y k y k 1 n w k x f x y k x y d x k 1 n w k f y k y k 1 n w k f y k y 0 x f x y k x y f y k y d x k 1 n w k f y k y k 1 n w k f y k y 0 x f x y k x y d x k 1 n w k f y k y k 1 n w k f y k y f x y k x y k 1 n w k f y k y k 1 n w k f y k y c v k u k k 1 n w k f y k y where c v k presents the partial derivatives of c k to v k similarly the conditional distribution f y x y x is given by 20 f y x y x k 1 n w k f x k x c u k v k k 1 n w k f x k x in normal conditions such a mixture probability model is difficult to estimate because the widely used expectation maximisation algorithm mclachlan and krishnan 2007 cannot guarantee convergence to the global optimum especially when a large number of parameters are involved wu 1983 nevertheless the h s t z data could be classified according to certain physical features able to distinguish sea state conditions then f x k x f y k y and c k corresponding to the k t h k 1 n order component can be straightforwardly estimated using the mpl method and the associated w k is taken as the occurrence frequency considering that ocean waves are a natural combination of wind sea and swell in the present study we accounted for the following criterion and the flow chart shown in fig 1 demonstrates how to perform the classification following it 4 1 wave energy composition a general sea state consists of a wind sea system and one or more swell systems lucas and guedes soares 2015a b from a spectral perspective the spectrum s ω of the total sea state can be defined as 21 s ω s w ω k 1 n s s k ω where s w ω denotes the wind sea spectrum and s s k ω k 1 n respectively denote the n swell spectra based on these split spectra the energy of wind sea e w and swell e s can be expressed as 22 e w s w ω d ω m 0 w a n d e s k 1 n s s k ω d ω k 1 n m 0 s k where m 0 w and m 0 s k are the zeroth order moment of the wave spectrum in addition to the h s t z data of the total sea state if the simultaneous significant wave height characteristics h s w for wind wave system and h s s k for each swell system had been separated using the spectral partitioning method hanson and phillips 2001 portilla et al 2009 boukhanovsky et al 2007 boukhanovsky and guedes soares 2009 lucas et al 2011 m 0 w and m 0 s k can be calculated by 23 m 0 w 1 16 h s w 2 a n d m 0 s k 1 16 h s s k 2 thus by comparing the relative magnitudes of e w and e s the sea states can be classified into the four components defined in table 1 5 case study 5 1 data preliminary analysis in hipocas hindcast of dynamic processes of the ocean and coastal areas of europe project the hindcast wave data with a time step of 3 h were calculated by wam over a period of 44 year 1958 2001 and have been validated with measured data by pilar et al 2008 during the simulation spectral partitioning has been considered to isolate wind sea and swell characteristics in the present study from one position in the north atlantic ocean located at 19 west longitude 59 north latitude the generated time series of h s t z and simultaneous h s w h s s 1 h s s 2 were extracted for usage to account for the seasonal wave climate variation the raw records were first grouped by season after according to the wave energy composition criterion outlined in section 4 regarding each of the seasonal datasets the four sets of season component h s t z data were further classified it is noted that the time varying feature of ocean data is obvious the current analysis only adopted a relaxed assumption in data pre processing a typical approach for removing the serial correlations contained in time series data can be found in vanem 2016 2018 in which the seasonally normalised data are obtained by subtracting the seasonal mean and dividing by the seasonal standard deviation the overall mean is then reincorporated to demonstrate the joint and marginal behaviours of wave records classified into different components regarding each of the season component sets h s t z scatter plots against the previous seasonal dataset are presented in fig 2 where the corresponding proportions equalling the weight parameter w k of the associated copula mixture are also inserted meanwhile in fig 3 the histograms of marginal h s and t z data are exhibited as can be observed from these figures it is clear that the waves classified into those components are distinct some particular features are noticed wind sea and swell respectively dominate about half of the entire waves by comparison swell has more influence on long term wave climates since merely 8 of the waves are of the pw component the waves dominated by wind sea including those of pw and cw components are in general the steepest successively followed by ones belonging to the cs and ps components meanwhile compared with the waves dominated by swell wind sea dominated waves also appear to have a stronger positive dependence for h s t z especially in the upper tail compared to the cw component which occurs much more frequently in terms of the histogram of the marginal data it seems that the pw component more likely yields waves with higher h s and longer t z in contrast to the waves dominated by wind sea the waves dominated by swell are more often of the ps component which appears to render waves with longer t z for a bivariate copula c durante et al 2010 proposed a natural measure of its asymmetry which is defined as 24 μ p c 0 1 0 1 c u v c v u p d u d v where p is in 1 and for p 25 μ c max u v 0 1 2 c u v c v u first of all to provide an overview of the dependence structure of h s t z in various seasonal and season component sets kendall s τ spearman s ρ and μ in terms of empirical copula c n were calculated the corresponding results are summarised in table 2 compared with the previous seasonal h s t z data it is clear that the h s t z data in the associated season component sets all have higher values of kendall s τ and spearman s ρ such results to some extent contribute to the classification based on wave energy composition because the homologous wave data sharing the same physical characteristics are identified more importantly it is seen that the asymmetry of the h s t z data surprisingly decreases after classification particularly for the pw cw and ps components whose μ remarkably turn out to be generally less than 0 010 this is powerful evidence that symmetric copulas can be applied using this approach 5 2 fitting data to marginal distributions because the estimation of marginal distribution is unrelated to the following copula modelling it was conducted in the first step the three parameters weibull lognormal and lonowe distributions lognormal distribution combined with a weibull tail haver 1985 2019 mathisen and bitner gregersen 1990 moan et al 2005 were fitted to each of the seasonal and season component sets using the ml method detailed in appendix a likewise the preferred marginal model was selected based on aicc table 3 summarises the corresponding statistics in general it is found that the lognormal and lonowe distributions are used prior to the three parameter weibull distribution in most situations the aicc will be probably tuned to fit the body of the distribution whereas in ocean engineering applications it will typically be the upper tail that is important therefore other measures which put a stronger penalty on errors for higher values can be used for further comparison like the anderson darling a d masina et al 2015 and weighted root mean square error wrmse vanem 2016 tests taking this into consideration as to have an insight on the goodness of fit for the upper tail herein the estimated distributions are further demonstrated by fig 4 a and b a for h s and b for t z where the empirical and theoretical marginal cumulative probabilities are compared it is important to note that cases with the minimum aicc are marked along with their mles by red superscripts as can be observed from the results the marginal models selected for statistical analysis are in general better consistent with the data on the upper tail 5 3 fitting data to different copulas in the second step the gaussian gumbel galambos and hüsler reiss copulas were considered for the copula modelling of h s t z data using the various techniques introduced above their corresponding functions c u v densities c u v and partial derivatives c u v are provided in appendix b note that c v u is not listed because these copulas are symmetric initial attempts were made to simply fit the gaussian gumbel galambos and hüsler reiss copulas to the seasonal h s t z data in the transformed u v 0 1 2 space the copula density contour plot against the raw scatterplots could help visualise the goodness of fit here in fig 5 the copula density contours are presented together with the mles to illustrate these estimated symmetric copula models a red diagonal line is drawn in the figure to highlight the departure from symmetry accordingly all the symmetric copula models failed to yield reasonable results nevertheless according to the aicc statistics summarised in table 4 the gaussian copula model preferred except for the summer dataset for which the hüsler reiss copula model is selected regarding the seasonal h s t z data the product copulas were further studied preliminarily we took two individual copulas into account the four symmetric copulas were combined into ten classes of khoudraji liebscher copulas which were then separately fitted to each of the seasonal datasets table 5 summarises the aicc statistics of these khoudraji liebscher copula models through comparison it is found that the models composed of two gaussian copulas tend have minimum aicc values for all seasons followed by those consisting of gaussian and another type of copulas which have the second lowest statistical values therefore the gaussian copula appears to be the most advantageous choice for product copula modelling of seasonal h s t z data although from a practical perspective the product copulas with more individuals are rarely applied the number of parameters needed to conduct simultaneous estimation is quite high which makes the optimisation of the likelihood function converge rather slowly to an uncertain solution here to produce a fair comparison of copula mixtures we use the gaussian as the basic copula to construct the product models with three and four individuals the aicc statistics of which are also listed in table 5 as can be observed the aicc of the gaussian product copula model decreases when more individual copulas are considered this result suggests that the product copula constructed by four gaussian copulas can provide a better fit for the khoudraji liebscher and gaussian product copula n 4 models in the transformed uniform space fig 6 a d respectively demonstrate their fits to each of the seasonal h s t z data as well as the mles as can be observed compared with the models constructed by symmetric copulas the product copula models clearly provide much better fit overall and the asymmetric dependence is well captured whereas it seems that the copula density contours yielded by different product copula models are similar indicating the selection of base copulas is not critical finally the copula mixtures were estimated besides the pw cw and ps components here we also fitted the cs component using a concise symmetric copula considering that it accounts for a relatively small proportion and appears to be rarely associated with extreme events regarding the symmetric copula models fitted to each of the season component sets fig 7 a d respectively demonstrate the models performances along with mles in the transformed uniform space the corresponding aicc statistics are summarised in table 6 according to the results the symmetric copula models collectively exhibit a promising performance in this modelling among which the ones constructed with the gaussian copula are found to be preferred except for the h s t z data of the summer ps component 5 4 comparison of goodness of fits in current engineering practice for the modelling of h s t z the semi empirical cma is most often employed based on the total probability theorem the joint density function f h s t z x y for the conditional model is expressed as the product of the marginal density f h s x and the conditional density f t z h s y x among which the latter is widely accepted to follow the lognormal distribution to achieve a more comprehensive comparison of the statistical models constructed for the joint distribution of h s t z before proceeding with the goodness of fit measurements the seasonal h s t z data were also fitted using this approach the supportive h s data were divided into bins with a 0 5 m size and the lognormal distributions of t z conditional on various classes of h s were fitted then the empirical regression functions represented by eq 26 were estimated to construct the model the corresponding fitted curves along with parameter estimates of a 1 a 2 a 3 and b 1 b 2 b 3 b 4 are demonstrated in fig 8 26a μ h s a 1 a 2 h s a 3 26b σ 2 h s b 1 b 2 exp b 3 h s b 4 to garner an intuitive comparison of goodness of fits regarding each of the seasonal h s t z datasets in fig 9 a d the empirical joint density contour plots are compared with those calculated by the various estimated joint statistical models the total number of wave records falling in each cell 1s 1m are illustrated by the black numbers because waves break when steepness s 2 π h s g t z 2 exceeds certain limit the value of which was observed to generally range from 1 16 to 1 20 battjes 1972 there is a cutoff domain in the space of h s t z this physical process is indicated by the gray domain with a magenta edge in the figure note that on the basis of the seasonal h s t z data herein the maximum steepness for each season is approximated to be 1 15 1 15 1 14 and 1 13 for a more subjective view additionally in the same figure the met ocean contours defined by the inverse first order reliability approach iform winterstein et al 1993 dnv rp c205 2010 were also predicted to compare the fit for extreme sea state conditions because the hindcast waves recorded were generated every 3 h suppose the durations of different season are equal the radius β s n u 1 2 u 2 2 for the seasonal n year contour is defined as φ 1 1 1 365 4 24 3 n noted that φ u 1 f h s x and φ u 2 f t z h s y x based on the results it is apparent that the symmetric copula model mismatches the physical limit on steepness and provides the poorest fit to the wave data the conditional model performs relatively better nevertheless similarly to the symmetric copula models the sea states estimated to have the highest occurrence frequency are obviously deviate more from the raw data the khoudraji liebscher product copula and copula mixture models seem to predict the sea states with better quality by comparison in light of the met ocean contours associated with more extreme sea state conditions the copula mixture model appears to estimate more specific and realistic contours resulting in better tail fitting 5 4 1 univariate analysis the copula mixture model describes the marginal distribution of h s and t z respectively using a mixture of four components meanwhile the conditional model estimates the marginal distribution of t z on the basis of its joint distribution to compare their goodness of fits with the single distribution directly fitted to the data the kolmogorov smirnov k s and anderson darling a d goodness of fit tests were performed montes iturrizaga and heredia zavoni 2015 let f n x be the empirical distribution then the k s and a d statistics of a hypothesised distribution function f x x are respectively defined as 27 k s max f n x f x x 28 a d max f n x f x x f x x 1 f x x although smaller values of these two statistics both suggest higher possibilities that the raw data are from a population with the specified distribution the k s and a d statistics are not equivalent the k s statistic is more sensitive to the deviations occurring in the bulk of the distribution whereas the a d statistic gives more weight to deviations at the tails of the distribution masina et al 2015 because the samples are rather large for seasonal data n is around 365 8 44 4 32120 goodness of fit tests tend to reject their null hypotheses the data are from the underlying distribution here we simply compared the values of these two statistics it is noted that the evaluation could also be performed based on the p values which indicate the significance level that the null hypothesis is accepted and can be approximated by means of the specific parametric bootstrap procedure proposed by genest et al 2009 table 7 summarises the evaluated k s and a d statistics based on the table the conditional model is noticed always to be with the obviously larger k s and a d statistics indicating it is the last choice for the marginal modelling of t z on the other hand the mixed distribution is found to have the minimum test values for all the cases compared this result suggests that estimating the marginal distributions of sea state parameters as a mixture of four components can improve goodness of fit however in general the more complicated model would always give better fit to data but may not generalise as well considering that the akaike information criterion penalizes over parameterization by taking into account the increase in number of parameters anderson and burnham 2004 in table 8 the aicc statistic of the single and mixed kinds of marginal distribution are further compared according to the results the model with a mixed form consistently has the smaller test value which supports the rational of using a mixture of distributions for statistical modelling sea state parameters 5 4 2 bivariate analysis the k s and a d tests are originally designed for univariate goodness of fit tests although they have also been widely used for the evaluation of multivariate distributions genest et al 2009 in this situation the k s and a d statistics are respectively expressed as 29 k s max f n x y f x y x y 30 a d max f n x y f x y x y f x y x y 1 f x y x y in the present study we also evaluated the χ 2 statistic which is designed as the cell specific measure of bivariate goodness of fit regarding the i j cell with boundaries x i 1 x i and y j 1 y j let n i j o denote the number of raw data points falling within the i j cell and let p i j e denote the corresponding expected probability which can be calculated by 31 p i j e f x y x i y j f x y x i 1 y j f x y x i y j 1 f x y x i 1 y j 1 then the χ 2 statistic is defined as 32 χ 2 i j n i j o n p i j e 2 n p i j e where n denotes the total number of observations for the bivariate models we estimated table 9 summarises the evaluated aicc k s a d and χ 2 statistics as expected the copula mixture model clearly outperforms the others for all four cases these results confirm that it is the best choice for modelling of the joint distribution of h s t z the asymmetric khoudraji liebscher and product copula models have the second lowest test values seen from the results it seems that the product copula model does not demonstrate very significant advantages over the khoudraji liebscher copula model therefore considering that the product copula model with more individual copulas is disadvantageous for parameter estimation the khoudraji liebscher copula model would be a better choice finally the conditional and symmetric copula models present the poorest goodness of fit for the bivariate data particularly in terms of the χ 2 statistic the values of which are nearly ten times that of the copula mixture model the aicc k s a d and χ 2 statistics provide an overall indication of the fit to a set of h s t z data whereas the statistics cannot reflect the fit to data representing a specific sea state considering one cell if a data point does not fall inside this cell then it must fall outside the cell mathisen and bitner gregersen 1990 recognised this as a binomial situation and derived the expected standard deviation for the number of data points falling in each cell as 33 σ i j n p i j e 1 p i j e they then proposed to use the normalised cell deviation d i j defined by 34 d i j n i j o n p i j e σ i j to produce a more sophisticated evaluation of the bivariate fits to h s t z wave data values of d i j closer to zero indicate a good fit moreover positive values denote that the hypothesised model assigns a lower probability compared with the actual data in the specific cell whereas the opposite holds true for negative values soukissian and karathanasi 2017 fig 10 exhibits the diagrams of evaluated d i j which are calculated for binned sea states with a size of 0 5s 0 5m as can been observed in the figure the conditional and symmetric copula models underestimate the occurrence probability of the sea states with extreme high and low steepness the former mainly accounts for wind sea and is of more concern for reliability and survivability design whereas the latter possibly affects structures sensitive to long period waves such as submarine pipelines mathisen and bitner gregersen 1990 and lng terminals lucas and guedes soares 2015a on the other hand the conditional and symmetric copula models also overestimate the occurrence probability of sea states with lower values of h s and t z the asymmetric khoudraji liebscher and product copula models to somehow improve these weaknesses however they still are not comparable to the copula mixture model which revealed values of d i j generally close to zero for almost all the binned sea states 6 discussion and conclusions ocean waves consist of both wind sea and swell in terms of the relative magnitudes of splitting wind sea and swell energy the long term wave climate can be considered as a combination of four basic components pure wind sea pw and swell ps and two classes of combined sea wind sea stronger cw and swell stronger cs considering this physical process this paper emphasises the application of a copula mixture for the joint statistical modelling of significant wave height h s and mean zero crossing period t z from one position in the north atlantic ocean the 44 year 1958 2001 hipocas hindcast wave data were extracted and grouped by season for a case study through data analysis it is found that the bivariate distribution of h s t z in different wave components are distinct which confirms the use of a mixture of distributions for the joint statistical modelling of sea state parameters furthermore it is also found that the asymmetry of h s t z data decreases after classification particularly for the pw cw and ps components therefore theoretically the symmetric copulas can be straightforwardly applied for corresponding copula modelling the one parameter copulas including the gaussian gumbel galambos and hüsler reiss copulas were considered for the construction of the proposed copula mixture as well as symmetric and asymmetric khoudraji liebscher copulas and the product copula model following the corrected akaike information criterion aicc it is found that the gaussian copula is the best candidate in the majority of cases which suggests that the gaussian copula may be used as a solid base for copula based modelling of h s t z additionally the cma was also implemented to produce an intuitive comparison of the estimated joint statistical models their joint density contour plots were compared with a contour plot of empirical data meanwhile the met ocean contours defined by the inverse first order reliability approach iform were also predicted the results demonstrate that the symmetric copula model has the disadvantage of mismatching the physical limit on steepness the conditional model performs poorly in estimating the sea states with the highest occurrence frequency compared with the khoudraji liebscher and product copula models the copula mixture model appears to predict more specific and realistic extreme sea state contours the copula mixture model describes the marginal distribution of each sea state parameter also using a mixture of four components meanwhile the conditional model estimates the marginal distribution of t z on the basis of its joint distribution the univariate goodness of fit test in terms of the aicc kolmogorov smirnov k s and anderson darling a d statistics suggests that estimating the marginal distributions of sea state parameters as a mixture of four components can improve goodness of fit moreover the results also indicate that the marginal distribution of t z estimated by the cma may need to be carefully applied for the bivariate goodness of fit test in addition to the aicc k s and a d statistics two cell specific measurements including the χ 2 statistic and normalised cell deviation were also evaluated the results consistently suggest that the copula mixture model outperforms the other models providing quite good fit to the majority of binned sea states the asymmetric khoudraji liebscher and product copula models represent the second best bivariate fit and the asymmetric dependence between the two sea state parameters is well captured compared with the conditional and symmetric copula models with obviously poorer performance the asymmetric khoudraji liebscher and product copula models improve the fit to the sea states with lower values of h s and t z but have the same disadvantage of underestimating the occurrence probability of the sea states with extreme high and low steepness this underestimation is concerning for risk assessment of marine and coastal structures moreover it is also noticed that these two kinds of asymmetric copula models provide similar values of the test statistics considering the difficulty and uncertainty in the estimation of much more complex product copulas the khoudraji liebscher in practice seems to be more feasible for the bivariate modelling of h s t z wave spectrum partitioning based on observed buoy records is difficult and remains challenging however due to the short of measured data and the development of numerical modelling techniques now days the analysis of long term wave climates are far more widely carried out on the basis of hindcasting data in this respect wave models e g wam wavewatch iii or swan since version 41 10 upon request can automatically identify the partitioned spectra using the widely recognised method therefore it is much easier than before to collect the separated wave characteristics h s w and h s s k which gives the possibility to construct the proposed model although the proposed model contains more parameters in cases where those additional wave data could be obtained on one hand it is much easier to perform model estimation compared with the khoudraji liebscher copula model while providing an more realistic representation of the h s t z data on the other hand each mixture of the proposed model has clearly physical meaning therefore they can be used to describe the statistical behaviour of a specific type of waves which can help the engineers gain an insight into the long term wave climate for example in fig 11 the iform contours with respect to each of the classified wave components are presented under this circumstance considering the weight parameter w k indicates the seasonal occurrence of frequency of the k t h mixture the radius β s n u 1 2 u 2 2 is calculated by φ 1 1 1 w k 365 4 24 3 n meanwhile φ u 1 and φ u 2 are defined as f h s k x and f t z k h s k y x respectively all in all the proposed model is powerful for describing the long term wave climate in specific sites and ocean areas while improving the design and assessment of coastal and off shore structures nevertheless further research on using such a mixture model for the bivariate modelling of h s t z is essential future studies should examine the tail dependency explore other kinds of models investigate the physical and statistical differences between classified wave components as well as search for better classification criterion credit author statement yifan lin methodology software validation investigation data curation writing original draft preparation visualization sheng dong conceptualization methodology resources writing reviewing and editing supervision project administration funding acquisition shanshan tao software formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the study was partially supported by the national natural science foundation of china shandong joint fund project u1706226 the national natural science foundation of china 51779236 and the national key research and development program 2016yfc0303401 appendix appendix a marginal distributions three parameter weibull a 1 f w 3 x β x δ β 1 α β exp x δ α β x δ where δ is called the location parameter if δ 0 the model becomes the simple two parameter weibull model α and β are the scale and shape parameters respectively it has been known that the ml estimation in the three parameter weibull distribution is treated anomalously when β 2 hirose 1996 therefore we applied the modified maximum likelihood estimation mmle proposed by cohen and whitten 1982 in this study lognormal a 2 f l n x 1 x σ 2 π exp 1 2 σ 2 ln x μ x 0 where μ and σ are respectively the location and scale parameters whose mles respectively equal to the mean and standard deviation of ln x lonowe a 3 f l w x 1 x σ 2 π exp 1 2 σ 2 ln x μ x η β x β 1 α β exp x α β x η where η is the shifting point from the lognormal distribution to the weibull tail continuity is required for f x x and f x x at x η haver 1985 suppose μ σ and η of the lonowe distribution have been known according to the continuity conditions α and β of the weibull tail can be derived as a 4a β exp ln f l n η ln η ln ln 1 f l n η ln 1 f l n η a 4b α exp ln η ln ln 1 f l n η β accordingly the lonowe distribution should be considered as a three parameter model in the fitting procedure μ and σ are directly estimated from the raw data in the same way as the parameters obtained by applying a lognormal distribution only moan et al 2005 a proper estimation of η is important to get a good fit of the marginal distribution and will significantly affect the extreme value prediction in this study it is done by maximising the log likelihood function log l i 1 n l n f l w x i in which x i i 1 n are the n random samples appendix b copula functions gaussian b 1a c u v φ 2 φ 1 u φ 1 v t 1 t 1 b 1b c u v ϕ 2 φ 1 u φ 1 v t ϕ φ 1 u ϕ φ 1 v b 1c c u v φ φ 1 v t φ 1 u 1 t 2 gumbel b 2a c u v exp a t b t 1 t t 1 b 2b c u v c u v a b t 1 u v a t b t 1 t t 1 a t b t 1 t 2 b 2c c u v c u v u 1 b a t 1 t 1 galambos b 3a c u v u v exp a t b t 1 t t 0 b 3b c u v c u v u v 1 a t b t 1 1 t a t 1 b t 1 a t b t 2 1 t a b t 1 1 t a t b t 1 t b 3c c u v c u v u 1 1 a b t 1 1 t hüsler reiss b 4a c u v exp a φ 1 t t 2 ln a b b φ 1 t t 2 ln b a t 0 b 4b c u v c u v u v φ 1 t t 2 ln b a φ 1 t t 2 ln a b 1 2 t b ϕ 1 t t 2 ln a b b 4c c u v c u v u φ 1 t t 2 ln a b t 2 ϕ 1 t t 2 ln a b t 2 b a ϕ 1 t t 2 ln b a in the above expressions t is the dependence parameter used to measures the degree of association between u and v φ and ϕ are the abbreviations of cumulative and density probability functions of the standard normal distribution respectively similarly φ 2 and ϕ 2 are the abbreviations of cumulative and density probability functions of the bivariate standard normal distribution respectively moreover a and b are defined as a l n u and b l n v respectively for more theoretical introduction to these parametric copula families see joe 1997 2014 
22119,ocean waves are a natural combination of wind sea and swell considering this physical process by comparing the magnitudes of splitting wind sea and swell energy long term wave climate can be classified into four basic components pure wind sea pure swell and two classes of combined seas wind sea stronger and swell stronger from one position in the north atlantic ocean across seasonal analysis on the 44 year 1958 2001 hindcast wave data calculated by wam in the hipocas project it was found that the four wave components behave distinctly hence in this study we propose using a mixture of distributions to perform the copula based statistical modelling of significant wave height and mean zero crossing wave period a case study was dedicated to testify the univariate and bivariate capacity of fitting the results demonstrate that 1 compared to straightforward fitting a distribution to data estimating the marginal distribution of the sea state parameter as a mixture of the four components can improve goodness of fit 2 the proposed copula mixture model can provide an outstanding fit to the bivariate wave data outperforming those constructed by copulas belonging to symmetric khoudraji liebscher and product families as well as the classical conditional modelling approach keywords significant wave height characteristic wave period wind sea swell copulas mixture distributions 1 introduction sea states are jointly governed by the significant wave height h s and characteristic wave period such as the mean zero crossing period t z or the peak period t p the joint probability distribution of h s and t z or t p has been used to describe the wave climate in specific ocean areas and is an essential tool for the design and assessment of coastal and off shore structures to leverage this tool many researchers have attempted to develop a model or method for examples ochi 1978 introduced a bivariate lognormal distribution in which the data of h s t z are separately pre processed to be approximately normally distributed using an exponential transformation before the bivariate lognormal distribution is applied fang and hogben 1982 improved upon this process by introducing a correction for skewness assuming that h s and the wave steepness s p are independent vrijling and bruinsma 1980 proposed a model on the basis of the marginal distributions of h s and s p combined with a function describing t p as a function of h s s p meanwhile haver 1985 and bitner gregersen and haver 1989 adopted the conditional modelling approach cma to model the joint distribution of h s t p by this way the marginal distribution of h s is fitted at first then conditional distributions of t p given by different class of h s are fitted to the data as to relate the parameters of these conditional distributions to the value of h s regression curves are used considering the significant wave height is generally taken as the primary parameter affecting design conditions of ocean structures this approach performs well in general e g bitner gregersen 2015 masina et al 2015 lucas and guedes soares 2015a vanem 2016 orimolade et al 2016 horn et al 2018 and recommended by dnv rp c205 2010 in morton and bowers 1996 a relatively complicated model was introduced the marginal density probability functions of h s and t p are transformed into a so called frechet space then the dependence between h s and t p is described by a complex statistical function to develop the model for the bivariate description of extreme wave heights and wave periods representing relatively deep water sea states repko et al 2004 compared the performances of the above five approaches and models according to the case studies results the model given by vrijling and bruinsma 1980 was recommended by developing an analogy with the measure of association in a fourfold contingency table plackett 1965 proposed a method for constructing a one parameter class of bivariate distributions from given margins athanassoulis et al 1994 applied the plackett bivariate structure to fit the joint distribution of h s and t z moreover nerzic and prevosto 2000 as well as soares and guedes soares 2007 also employed the plackett model to fit the joint distribution of h s and t p prince wright 1995 pre processed the joint environmental data via an extended variant of the box cox transformation box and cox 1964 which has been frequently applied in the modelling of wave time series cunha and guedes soares 1999 guedes soares and cunha 2000 the transformed data were fitted with a bivariate gaussian distribution bitner gregersen et al 1998 compared this method with the cma model and demonstrated that each one has advantages and challenges regarding wave moreover lucas and guedes soares 2015a also compared the goodness of fit of this approach with the cma and plackett model utilising the data of swell wind sea components and combined sea states from australia in addition a box cox transformation was also applied by ferreira and guedes soares 2002 with no assumptions made about the type of distribution the joint distribution of the transformed h s and t z data were estimated by the kernel density similarly the nataf transformation nataf 1962 can transform the initial distribution into a multivariate gaussian distribution which dong et al 2013 applied to the modelling of the joint distribution for the transformed h s and t p data sklar 1959 proposed the concept of copulas in this concept the marginal distributions of dependent variables can be first estimated then their correlation can be presented by a special copula function nelsen 2006 recent advancements in mathematics see nelsen 2006 salvadori et al 2007 joe 1997 joe 2014 durante and sempi 2015 exhibit how copulas may be an efficient tool for investigating the statistical behaviour of dependent variables over the years several studies have been dedicated to the application of copulas to describe the joint behaviours of h s and t z or t p such as de waal and van gelder 2005 salvadori and de michele 2007 de michele et al 2007 corbella and stretch 2013 montes iturrizaga and heredia zavoni 2015 2016 more recently vanem 2016 presented a detailed study on the goodness of fits of various statistical models used for the joint distribution of h s and t z including the cma model bivariate lognormal model and several models based on families of symmetric and asymmetric copulas vanem s results indicate that appropriate statistical models are still challenging to establish furthermore to capture asymmetric dependencies among ocean environmental parameters zhang et al 2018 examined several asymmetric copula functions capable of modelling both linear and nonlinear asymmetric dependence structures between ocean variables the significant wave height average wave period and wind speed in detail based on data fitting and tail dependency characterisations the author s results indicate that the asymmetric copulas have advantages over symmetric copula functions in real applications in fact ocean wave is often of a combined nature consisting of both wind sea and swell bitner gregersen and haver 1991 wind seas are waves under growth or in equilibrium with local wind which usually have short wave lengths and slow propagation speeds they require persistent momentum from the surface wind and are strongly coupled to the local wind janssen 1989 when the local wind diminishes or the waves are generated from elsewhere the residual waves are referred to as swells swells usually have longer wave lengths and faster propagation speeds than wind seas they travel long distances radiating momentum and energy across the ocean jiang and chen 2013 in practice the presence of wind sea and swell affect the design and operability of fixed and floating off shore structures as well as lng terminals and ship operations bitner gregersen 2015 hence increasing attention has been dedicated to the inclusion of wind sea and swell components in a joint met ocean description when conducting reliability studies e g bitner gregersen and haver 1991 lucas and guedes soares 2015a and horn et al 2018 taking this mechanism of ocean wave into consideration as suggested by vanem 2016 it may be more accurate and realistic to use a mixture of distributions to describe the long term joint behaviours of sea state parameters therefore considering that by comparing the magnitudes of splitting wind sea and swell energy the long term wave climates can be classified into four components pure wind sea pw pure swell ps and two classes of combined sea wind sea stronger cw and swell stronger cs in the present study we employ a mixture of distributions to perform the copula based statistical modelling of h s and t z to examine the model s fitting a case study is further dedicated to compare the present model s goodness of fit to those constructed by 1 traditional symmetric copula 2 asymmetric khoudraji liebscher copula 3 asymmetric product copula a generalisation of the khoudraji liebscher copula and 4 classical conditional modelling approach the remainder of this article is organised as follows in section 2 basic concepts of copula theory and its application are introduced then in section 3 the methodology for constructing the asymmetric khoudraji liebscher and product copulas is outlined the copula mixture model along with the wave energy composition criterion used for data pre processing is then introduced in section 4 the results of the case study are presented in section 5 which covers preliminary data analysis marginal and joint statistical models fitting as well as univariate and bivariate goodness of fit comparison finally in section 6 conclusions are drawn 2 copula theory and basics developed by sklar 1959 copulas are functions which couples univariate marginal distributions to their multivariate distribution considering a situation with two dependent random variables x y if f x y x y is a joint distribution function with marginal distributions f x x and f y y let u f x x and v f y y on account of sklar s representation theorem nelsen 2006 there then exists a copula function c u v such that for any x y 1 f x y x y c u v if f x x and f y y are continuous then c u v is unique conversely if c u v is a copula and f x x and f y y are distribution functions then c u v is a joint distribution function with margins of f x x and f y y under the assumption that marginal distributions are continuous with densities f x x and f y y the joint density f x y x y can be derived as 2 f x y x y f x x f y y c u v where c u v is the copula density defined as 3 c u v 2 c u v u v moreover let c u v and c v u represent the partial derivatives of copula functions with respect to u and v 4 c u v c u v u a n d c v u c u v v the conditional distribution functions including f x y x y p x x y y and f y x y x p y y x x can be given by 5 f x y x y c v u a n d f y x y x c u v with densities f x y x y and f y x y x expressed as 6 f x y x y f x x c u v a n d f y x y x f y y c u v the dependence structure between variables is one of the most important characteristic for a multivariate distribution given n pairs of bivariate samples x i y i i 1 n let r i denote the rank of x i among x i i 1 n whereas s i denotes the rank of y i among y i i 1 n the pairs of ranks r i s i i 1 n are the statistics that retain the greatest amount of dependence information genest and favre 2007 based on these ranks two robust nonparametric coefficients have been developed to objectively measure the dependence structure including kendall s τ and spearman s ρ kendall s τ measures the average likelihood ratio dependence whereas spearman s ρ measures the average quadrant dependence both these coefficients range in the interval 1 1 where the lower and upper bounds indicate fully discordant and fully concordant random variable sequences respectively salvadori et al 2014 because the transformations u f x x and v f y y are strictly monotone increasing and will leave the dependence structure unchanged the dependence structure associated with x y is the same as one with transformed variables u v which means c u v itself is a characterisation of the dependence in a pair x y furthermore kendall s τ and spearman s ρ are respectively asymptotically unbiased estimators of 7a τ 4 0 1 0 1 c u v d c u v 1 7b ρ 12 0 1 0 1 c u v d u d v 3 the so called empirical copula c n u v is defined as 8 c n u v 1 n i 1 n 1 1 n 1 r i u 1 n 1 s i v where 1 denotes the indicator function c n u v is the best sample based representation of the copula c u v beyond that there exist varieties of bivariate parametric copula families nelsen 2006 joe 1997 joe 2014 among which the ones most frequently applied in the hydrology community are those with one parameter such as gaussian copula of elliptical family e g salvadori et al 2007 dong et al 2013 li et al 2014 dong et al 2015a jane et al 2016 vanem 2016 gumbel frank clayton and ali mikhail haq copulas of archimedean family e g de michele et al 2007 zhang and singh 2007 salvadori et al 2007 corbella and stretch 2012 corbella and stretch 2013 dong et al 2015 sraj et al 2015 vanem 2016 zhang et al 2018 galambos and hüsler reiss copulas of extreme value family e g shiau 2006 salvadori et al 2007 masina et al 2015 sraj et al 2015 vanem 2016 plackett and farlie gumbel morgenstern copulas of algebraic family e g salvadori et al 2007 montes iturrizaga and heredia zavoni 2015 lucas and guedes soares 2015a vanem 2016 soukissian and karathanasi 2017 these copulas cover a wide range of possible dependency patterns however they all have the disadvantage of being symmetric c u v c v u for every u v 0 1 2 durante et al 2010 more importantly regarding copula based analysis for the joint distribution of multivariate ocean data not all these symmetric copulas are suitable for statistical modelling generally ocean variables such as wind speed wave height and period naturally have quite strong dependencies among each other in this regard the ali mikhail haq 0 18 kendall s τ 0 33 and farlie gumbel morgenstern 0 22 kendall s τ 0 22 copulas may not be appropriate because they can only model data with weakly positive or negative dependencies shiau 2006 zhang and singh 2007 furthermore even stronger dependencies are usually observed at extremes for instance storms with high wind speeds usually induce waves with large heights and periods therefore the clayton and frank copulas might be excluded from the underlying copulas as the clayton copula characterises data asymptotically independent and the frank copula is used for data with weak dependencies at both tails zhang et al 2018 the parameter estimation of the copula based joint probability model can be realised in various ways among which the maximum likelihood ml method is the most widely applied in this approach the maximum likelihood estimators mles of the model parameters are obtained by maximising the bellow log likelihood function 9 i 1 n ln f x y x i y i i 1 n ln f x x i i 1 n ln f y y i i 1 n ln c f x x i f y y i the exact ml method requires the parameters in the marginal distributions and copula function to be estimated simultaneously hence the computation can be intensive alternatively the two stage inference functions for margins ifm method joe 2005 can be used in this case the marginal distributions are estimated in first by separately maximising i 1 n l n f x x i and i 1 n l n f y y i after each distribution is plugged into the corresponding copula function and the function s mle s is further determined by maximising i 1 n l n c f x x i f y y i the ifm method is easily implemented and usually performs well yet it also has the risk of being unduly affected if the models selected for marginal distributions turn out to be inappropriate kim et al 2007 to have a more robust estimation without specifying the margins in this study we apply the maximum pseudo likelihood mpl method genest et al 1995 which updates the ifm method by estimating the mle s of the copula function based on the pairs of u i v i estimated by 10 u i 1 n 1 r i a n d v i 1 n 1 s i concerning a suitable copula function for modelling the joint behaviour of x y the corrected akaike information criterion aicc defined by eq 11 can be adopted to fairly select the preferred copula function among competing candidates the original aic statistic measures the fitting conditions between the model and the data based on entropy concepts whereas the aicc statistic corrects for finite sample sizes n anderson and burnham 2004 clearly other criteria can be used for example the minimum negative log likelihood the bayesian information or the cross validation criterion grønneberg and hjort 2014 salvadori et al 2014 11 a i c c 2 log l 2 p 2 p 1 p 2 n p 2 in eq 11 log l is the log likelihood function for the model p represents the number of estimated parameters the preferred model is the one with the minimum aicc value 3 product copulas approach ocean variables respond differently to the same environmental conditions and are restricted by certain physical limitations for instance it is impossible to have high waves with very short wave periods due to wave breaking hence multivariate ocean data are asymmetric by nature and cannot be modelled in a straightforward manner using symmetric copula families vanem 2016 zhang et al 2018 in recent years significant effort has been expended to develop copulas able to characterise asymmetric dependencies for example capéraà et al 2000 proposed the bivariate archimax copulas and mesiar and jágr 2013 further extended this class to multivariate copulas rodríguez lallana and úbeda flores 2004 introduced a class of bivariate copulas that can generalise some known families such as the farlie gumbel morgenstern copula kim et al 2011 and mesiar and najjari 2014 extended this study to new families of symmetric and asymmetric copulas alfonsi and brigo 2005 proposed a new construction method for asymmetric copulas based on periodic functions meanwhile liebscher 2008 introduced two methods for constructing asymmetric multivariate copulas the first of which is connected with products of copulas and close to what khoudraji 1995 proposed whereas the second is a generalisation of the archimedean family wu 2014 constructed asymmetric copulas using linear convex combinations of copulas also known as the flipped copula specified by salvadori et al 2007 moreover di bernardino and rulliere 2013 constructed a multivariate family of copulas by generalising some known families using a distortion matrix overall among these techniques the most popular and practical method is to formulate a product of copulas following liebscher 2008 a bivariate asymmetric copula function can be generally obtained by 12 c u v j 1 n c j g u j u g v j v where c j j 1 n are the n individual copulas which can be selected from various families of parametric copulas g s j s u v a n d j 1 n are power functions that participate in the asymmetric dependence modelling to ensure that the product of copulas is also a copula function these power functions should satisfy the following properties 1 g s j is strictly increasing in 0 1 and g s j 0 0 g s j 1 1 otherwise g s j is identically equal to 1 2 g s j is continuous on 0 1 3 if there are at least two functions g s j 1 and g s j 2 with 1 j 1 j 2 n which are not identically equal to 1 then g s j x x holds for x 0 1 j 1 n the density of the product copulas shown outlined above can be written as 13 c u v j 1 n c c j 2 c j g u j g v j g u j u g v j v c j g u j g u j u i j n 2 c c i c j c i g v i g v i v in which the partial derivatives c u v and c v u are given by 14 c u v j 1 n c c j c j g u j g u j u a n d c v u j 1 n c c j c j g v j g v j v it is evident that the product copulas are quite rich and versatile through changing the individual copula c j and the power function g i j an infinite number of variants able to capture various types of dependence structures can be generated salvadori et al 2014 moreover it is worth expressing that the simulation of product copulas is also easy to conduct suppose u 1 v 1 u n v n are n independent random vectors respectively generated from c 1 c n then max j 1 n g u j 1 u j max j 1 n g v j 1 v j is a random vector of the product copulas shown in eq 12 liebscher 2008 lists four alternatives suitable for the power function g j k among which the type i power function defined as g s j x x θ s j where θ s j 0 1 and j 1 n θ s j 1 is relatively simpler to use more importantly by utilising a type i power function and setting n 2 the corresponding product copula function becomes the powerful khoudraji liebscher device khoudraji 1995 durante and salvadori 2010 which is a state of the art technique for copula based analysis e g durante and salvadori 2010 de michele et al 2013 salvadori et al 2013 vanem 2016 zhang et al 2018 and recommended for applications of multivariate analysis and design in coastal and off shore engineering salvadori et al 2014 therefore in the present study we adopted a type i power function to construct our product copulas the major difficulty in applying product copulas is the parameter estimation to estimate the mles corresponding to the constrained nonlinear multivariate function i 1 n l n c u i v i a very robust and efficient optimisation algorithm to search for the global optimum solution is essential because the computational effort can become tremendous particularly when more individual copulas are considered in the present study the matlab solver multistart was applied to avoid solutions that converge to local basins the algorithm starts from multiple uniformly distributed points within bounds to search thoroughly for the global optimum 4 copula mixture modelling suppose that the joint distribution of x y is known to be a mixture of n components each component with an order of k k 1 n owns its individual copula function c k and marginal distributions f x k x f y k y mathematically the joint distribution function f x y x y in this case is formulated as 15 f x y x y k 1 n w k f x y k x y k 1 n w k c k f x k x f y k y where w k is the nonnegative weight parameter satisfying w k 0 1 and k 1 n w k 1 accordingly let u k f x k x v k f y k y then the joint density f x y x y herein can be derived as 16 f x y x y k 1 n w k f x y k x y k 1 n w k f x k x f y k y c k u k v k where c k f x k x and f y k y are the densities of c k f x k x and f y k y respectively the marginal distribution of x or y can also be expressed as a mixture distribution for instance in terms of x its marginal distribution function f x x and density f x x can be respectively given by 17 f x x k 1 n w k f x k x a n d f x x k 1 n w k f x k x furthermore because the density f x y x y of the conditional distribution f x y x y is defined by 18 f x y x y f x y x y f y y it is derived that the conditional distribution f x y x y of the copula mixture can be expressed as 19 f x y x y x f x y x y f y y d x x f x y x y d x f y y x k 1 n w k f x y k x y d x k 1 n w k f y k y k 1 n w k x f x y k x y d x k 1 n w k f y k y k 1 n w k f y k y 0 x f x y k x y f y k y d x k 1 n w k f y k y k 1 n w k f y k y 0 x f x y k x y d x k 1 n w k f y k y k 1 n w k f y k y f x y k x y k 1 n w k f y k y k 1 n w k f y k y c v k u k k 1 n w k f y k y where c v k presents the partial derivatives of c k to v k similarly the conditional distribution f y x y x is given by 20 f y x y x k 1 n w k f x k x c u k v k k 1 n w k f x k x in normal conditions such a mixture probability model is difficult to estimate because the widely used expectation maximisation algorithm mclachlan and krishnan 2007 cannot guarantee convergence to the global optimum especially when a large number of parameters are involved wu 1983 nevertheless the h s t z data could be classified according to certain physical features able to distinguish sea state conditions then f x k x f y k y and c k corresponding to the k t h k 1 n order component can be straightforwardly estimated using the mpl method and the associated w k is taken as the occurrence frequency considering that ocean waves are a natural combination of wind sea and swell in the present study we accounted for the following criterion and the flow chart shown in fig 1 demonstrates how to perform the classification following it 4 1 wave energy composition a general sea state consists of a wind sea system and one or more swell systems lucas and guedes soares 2015a b from a spectral perspective the spectrum s ω of the total sea state can be defined as 21 s ω s w ω k 1 n s s k ω where s w ω denotes the wind sea spectrum and s s k ω k 1 n respectively denote the n swell spectra based on these split spectra the energy of wind sea e w and swell e s can be expressed as 22 e w s w ω d ω m 0 w a n d e s k 1 n s s k ω d ω k 1 n m 0 s k where m 0 w and m 0 s k are the zeroth order moment of the wave spectrum in addition to the h s t z data of the total sea state if the simultaneous significant wave height characteristics h s w for wind wave system and h s s k for each swell system had been separated using the spectral partitioning method hanson and phillips 2001 portilla et al 2009 boukhanovsky et al 2007 boukhanovsky and guedes soares 2009 lucas et al 2011 m 0 w and m 0 s k can be calculated by 23 m 0 w 1 16 h s w 2 a n d m 0 s k 1 16 h s s k 2 thus by comparing the relative magnitudes of e w and e s the sea states can be classified into the four components defined in table 1 5 case study 5 1 data preliminary analysis in hipocas hindcast of dynamic processes of the ocean and coastal areas of europe project the hindcast wave data with a time step of 3 h were calculated by wam over a period of 44 year 1958 2001 and have been validated with measured data by pilar et al 2008 during the simulation spectral partitioning has been considered to isolate wind sea and swell characteristics in the present study from one position in the north atlantic ocean located at 19 west longitude 59 north latitude the generated time series of h s t z and simultaneous h s w h s s 1 h s s 2 were extracted for usage to account for the seasonal wave climate variation the raw records were first grouped by season after according to the wave energy composition criterion outlined in section 4 regarding each of the seasonal datasets the four sets of season component h s t z data were further classified it is noted that the time varying feature of ocean data is obvious the current analysis only adopted a relaxed assumption in data pre processing a typical approach for removing the serial correlations contained in time series data can be found in vanem 2016 2018 in which the seasonally normalised data are obtained by subtracting the seasonal mean and dividing by the seasonal standard deviation the overall mean is then reincorporated to demonstrate the joint and marginal behaviours of wave records classified into different components regarding each of the season component sets h s t z scatter plots against the previous seasonal dataset are presented in fig 2 where the corresponding proportions equalling the weight parameter w k of the associated copula mixture are also inserted meanwhile in fig 3 the histograms of marginal h s and t z data are exhibited as can be observed from these figures it is clear that the waves classified into those components are distinct some particular features are noticed wind sea and swell respectively dominate about half of the entire waves by comparison swell has more influence on long term wave climates since merely 8 of the waves are of the pw component the waves dominated by wind sea including those of pw and cw components are in general the steepest successively followed by ones belonging to the cs and ps components meanwhile compared with the waves dominated by swell wind sea dominated waves also appear to have a stronger positive dependence for h s t z especially in the upper tail compared to the cw component which occurs much more frequently in terms of the histogram of the marginal data it seems that the pw component more likely yields waves with higher h s and longer t z in contrast to the waves dominated by wind sea the waves dominated by swell are more often of the ps component which appears to render waves with longer t z for a bivariate copula c durante et al 2010 proposed a natural measure of its asymmetry which is defined as 24 μ p c 0 1 0 1 c u v c v u p d u d v where p is in 1 and for p 25 μ c max u v 0 1 2 c u v c v u first of all to provide an overview of the dependence structure of h s t z in various seasonal and season component sets kendall s τ spearman s ρ and μ in terms of empirical copula c n were calculated the corresponding results are summarised in table 2 compared with the previous seasonal h s t z data it is clear that the h s t z data in the associated season component sets all have higher values of kendall s τ and spearman s ρ such results to some extent contribute to the classification based on wave energy composition because the homologous wave data sharing the same physical characteristics are identified more importantly it is seen that the asymmetry of the h s t z data surprisingly decreases after classification particularly for the pw cw and ps components whose μ remarkably turn out to be generally less than 0 010 this is powerful evidence that symmetric copulas can be applied using this approach 5 2 fitting data to marginal distributions because the estimation of marginal distribution is unrelated to the following copula modelling it was conducted in the first step the three parameters weibull lognormal and lonowe distributions lognormal distribution combined with a weibull tail haver 1985 2019 mathisen and bitner gregersen 1990 moan et al 2005 were fitted to each of the seasonal and season component sets using the ml method detailed in appendix a likewise the preferred marginal model was selected based on aicc table 3 summarises the corresponding statistics in general it is found that the lognormal and lonowe distributions are used prior to the three parameter weibull distribution in most situations the aicc will be probably tuned to fit the body of the distribution whereas in ocean engineering applications it will typically be the upper tail that is important therefore other measures which put a stronger penalty on errors for higher values can be used for further comparison like the anderson darling a d masina et al 2015 and weighted root mean square error wrmse vanem 2016 tests taking this into consideration as to have an insight on the goodness of fit for the upper tail herein the estimated distributions are further demonstrated by fig 4 a and b a for h s and b for t z where the empirical and theoretical marginal cumulative probabilities are compared it is important to note that cases with the minimum aicc are marked along with their mles by red superscripts as can be observed from the results the marginal models selected for statistical analysis are in general better consistent with the data on the upper tail 5 3 fitting data to different copulas in the second step the gaussian gumbel galambos and hüsler reiss copulas were considered for the copula modelling of h s t z data using the various techniques introduced above their corresponding functions c u v densities c u v and partial derivatives c u v are provided in appendix b note that c v u is not listed because these copulas are symmetric initial attempts were made to simply fit the gaussian gumbel galambos and hüsler reiss copulas to the seasonal h s t z data in the transformed u v 0 1 2 space the copula density contour plot against the raw scatterplots could help visualise the goodness of fit here in fig 5 the copula density contours are presented together with the mles to illustrate these estimated symmetric copula models a red diagonal line is drawn in the figure to highlight the departure from symmetry accordingly all the symmetric copula models failed to yield reasonable results nevertheless according to the aicc statistics summarised in table 4 the gaussian copula model preferred except for the summer dataset for which the hüsler reiss copula model is selected regarding the seasonal h s t z data the product copulas were further studied preliminarily we took two individual copulas into account the four symmetric copulas were combined into ten classes of khoudraji liebscher copulas which were then separately fitted to each of the seasonal datasets table 5 summarises the aicc statistics of these khoudraji liebscher copula models through comparison it is found that the models composed of two gaussian copulas tend have minimum aicc values for all seasons followed by those consisting of gaussian and another type of copulas which have the second lowest statistical values therefore the gaussian copula appears to be the most advantageous choice for product copula modelling of seasonal h s t z data although from a practical perspective the product copulas with more individuals are rarely applied the number of parameters needed to conduct simultaneous estimation is quite high which makes the optimisation of the likelihood function converge rather slowly to an uncertain solution here to produce a fair comparison of copula mixtures we use the gaussian as the basic copula to construct the product models with three and four individuals the aicc statistics of which are also listed in table 5 as can be observed the aicc of the gaussian product copula model decreases when more individual copulas are considered this result suggests that the product copula constructed by four gaussian copulas can provide a better fit for the khoudraji liebscher and gaussian product copula n 4 models in the transformed uniform space fig 6 a d respectively demonstrate their fits to each of the seasonal h s t z data as well as the mles as can be observed compared with the models constructed by symmetric copulas the product copula models clearly provide much better fit overall and the asymmetric dependence is well captured whereas it seems that the copula density contours yielded by different product copula models are similar indicating the selection of base copulas is not critical finally the copula mixtures were estimated besides the pw cw and ps components here we also fitted the cs component using a concise symmetric copula considering that it accounts for a relatively small proportion and appears to be rarely associated with extreme events regarding the symmetric copula models fitted to each of the season component sets fig 7 a d respectively demonstrate the models performances along with mles in the transformed uniform space the corresponding aicc statistics are summarised in table 6 according to the results the symmetric copula models collectively exhibit a promising performance in this modelling among which the ones constructed with the gaussian copula are found to be preferred except for the h s t z data of the summer ps component 5 4 comparison of goodness of fits in current engineering practice for the modelling of h s t z the semi empirical cma is most often employed based on the total probability theorem the joint density function f h s t z x y for the conditional model is expressed as the product of the marginal density f h s x and the conditional density f t z h s y x among which the latter is widely accepted to follow the lognormal distribution to achieve a more comprehensive comparison of the statistical models constructed for the joint distribution of h s t z before proceeding with the goodness of fit measurements the seasonal h s t z data were also fitted using this approach the supportive h s data were divided into bins with a 0 5 m size and the lognormal distributions of t z conditional on various classes of h s were fitted then the empirical regression functions represented by eq 26 were estimated to construct the model the corresponding fitted curves along with parameter estimates of a 1 a 2 a 3 and b 1 b 2 b 3 b 4 are demonstrated in fig 8 26a μ h s a 1 a 2 h s a 3 26b σ 2 h s b 1 b 2 exp b 3 h s b 4 to garner an intuitive comparison of goodness of fits regarding each of the seasonal h s t z datasets in fig 9 a d the empirical joint density contour plots are compared with those calculated by the various estimated joint statistical models the total number of wave records falling in each cell 1s 1m are illustrated by the black numbers because waves break when steepness s 2 π h s g t z 2 exceeds certain limit the value of which was observed to generally range from 1 16 to 1 20 battjes 1972 there is a cutoff domain in the space of h s t z this physical process is indicated by the gray domain with a magenta edge in the figure note that on the basis of the seasonal h s t z data herein the maximum steepness for each season is approximated to be 1 15 1 15 1 14 and 1 13 for a more subjective view additionally in the same figure the met ocean contours defined by the inverse first order reliability approach iform winterstein et al 1993 dnv rp c205 2010 were also predicted to compare the fit for extreme sea state conditions because the hindcast waves recorded were generated every 3 h suppose the durations of different season are equal the radius β s n u 1 2 u 2 2 for the seasonal n year contour is defined as φ 1 1 1 365 4 24 3 n noted that φ u 1 f h s x and φ u 2 f t z h s y x based on the results it is apparent that the symmetric copula model mismatches the physical limit on steepness and provides the poorest fit to the wave data the conditional model performs relatively better nevertheless similarly to the symmetric copula models the sea states estimated to have the highest occurrence frequency are obviously deviate more from the raw data the khoudraji liebscher product copula and copula mixture models seem to predict the sea states with better quality by comparison in light of the met ocean contours associated with more extreme sea state conditions the copula mixture model appears to estimate more specific and realistic contours resulting in better tail fitting 5 4 1 univariate analysis the copula mixture model describes the marginal distribution of h s and t z respectively using a mixture of four components meanwhile the conditional model estimates the marginal distribution of t z on the basis of its joint distribution to compare their goodness of fits with the single distribution directly fitted to the data the kolmogorov smirnov k s and anderson darling a d goodness of fit tests were performed montes iturrizaga and heredia zavoni 2015 let f n x be the empirical distribution then the k s and a d statistics of a hypothesised distribution function f x x are respectively defined as 27 k s max f n x f x x 28 a d max f n x f x x f x x 1 f x x although smaller values of these two statistics both suggest higher possibilities that the raw data are from a population with the specified distribution the k s and a d statistics are not equivalent the k s statistic is more sensitive to the deviations occurring in the bulk of the distribution whereas the a d statistic gives more weight to deviations at the tails of the distribution masina et al 2015 because the samples are rather large for seasonal data n is around 365 8 44 4 32120 goodness of fit tests tend to reject their null hypotheses the data are from the underlying distribution here we simply compared the values of these two statistics it is noted that the evaluation could also be performed based on the p values which indicate the significance level that the null hypothesis is accepted and can be approximated by means of the specific parametric bootstrap procedure proposed by genest et al 2009 table 7 summarises the evaluated k s and a d statistics based on the table the conditional model is noticed always to be with the obviously larger k s and a d statistics indicating it is the last choice for the marginal modelling of t z on the other hand the mixed distribution is found to have the minimum test values for all the cases compared this result suggests that estimating the marginal distributions of sea state parameters as a mixture of four components can improve goodness of fit however in general the more complicated model would always give better fit to data but may not generalise as well considering that the akaike information criterion penalizes over parameterization by taking into account the increase in number of parameters anderson and burnham 2004 in table 8 the aicc statistic of the single and mixed kinds of marginal distribution are further compared according to the results the model with a mixed form consistently has the smaller test value which supports the rational of using a mixture of distributions for statistical modelling sea state parameters 5 4 2 bivariate analysis the k s and a d tests are originally designed for univariate goodness of fit tests although they have also been widely used for the evaluation of multivariate distributions genest et al 2009 in this situation the k s and a d statistics are respectively expressed as 29 k s max f n x y f x y x y 30 a d max f n x y f x y x y f x y x y 1 f x y x y in the present study we also evaluated the χ 2 statistic which is designed as the cell specific measure of bivariate goodness of fit regarding the i j cell with boundaries x i 1 x i and y j 1 y j let n i j o denote the number of raw data points falling within the i j cell and let p i j e denote the corresponding expected probability which can be calculated by 31 p i j e f x y x i y j f x y x i 1 y j f x y x i y j 1 f x y x i 1 y j 1 then the χ 2 statistic is defined as 32 χ 2 i j n i j o n p i j e 2 n p i j e where n denotes the total number of observations for the bivariate models we estimated table 9 summarises the evaluated aicc k s a d and χ 2 statistics as expected the copula mixture model clearly outperforms the others for all four cases these results confirm that it is the best choice for modelling of the joint distribution of h s t z the asymmetric khoudraji liebscher and product copula models have the second lowest test values seen from the results it seems that the product copula model does not demonstrate very significant advantages over the khoudraji liebscher copula model therefore considering that the product copula model with more individual copulas is disadvantageous for parameter estimation the khoudraji liebscher copula model would be a better choice finally the conditional and symmetric copula models present the poorest goodness of fit for the bivariate data particularly in terms of the χ 2 statistic the values of which are nearly ten times that of the copula mixture model the aicc k s a d and χ 2 statistics provide an overall indication of the fit to a set of h s t z data whereas the statistics cannot reflect the fit to data representing a specific sea state considering one cell if a data point does not fall inside this cell then it must fall outside the cell mathisen and bitner gregersen 1990 recognised this as a binomial situation and derived the expected standard deviation for the number of data points falling in each cell as 33 σ i j n p i j e 1 p i j e they then proposed to use the normalised cell deviation d i j defined by 34 d i j n i j o n p i j e σ i j to produce a more sophisticated evaluation of the bivariate fits to h s t z wave data values of d i j closer to zero indicate a good fit moreover positive values denote that the hypothesised model assigns a lower probability compared with the actual data in the specific cell whereas the opposite holds true for negative values soukissian and karathanasi 2017 fig 10 exhibits the diagrams of evaluated d i j which are calculated for binned sea states with a size of 0 5s 0 5m as can been observed in the figure the conditional and symmetric copula models underestimate the occurrence probability of the sea states with extreme high and low steepness the former mainly accounts for wind sea and is of more concern for reliability and survivability design whereas the latter possibly affects structures sensitive to long period waves such as submarine pipelines mathisen and bitner gregersen 1990 and lng terminals lucas and guedes soares 2015a on the other hand the conditional and symmetric copula models also overestimate the occurrence probability of sea states with lower values of h s and t z the asymmetric khoudraji liebscher and product copula models to somehow improve these weaknesses however they still are not comparable to the copula mixture model which revealed values of d i j generally close to zero for almost all the binned sea states 6 discussion and conclusions ocean waves consist of both wind sea and swell in terms of the relative magnitudes of splitting wind sea and swell energy the long term wave climate can be considered as a combination of four basic components pure wind sea pw and swell ps and two classes of combined sea wind sea stronger cw and swell stronger cs considering this physical process this paper emphasises the application of a copula mixture for the joint statistical modelling of significant wave height h s and mean zero crossing period t z from one position in the north atlantic ocean the 44 year 1958 2001 hipocas hindcast wave data were extracted and grouped by season for a case study through data analysis it is found that the bivariate distribution of h s t z in different wave components are distinct which confirms the use of a mixture of distributions for the joint statistical modelling of sea state parameters furthermore it is also found that the asymmetry of h s t z data decreases after classification particularly for the pw cw and ps components therefore theoretically the symmetric copulas can be straightforwardly applied for corresponding copula modelling the one parameter copulas including the gaussian gumbel galambos and hüsler reiss copulas were considered for the construction of the proposed copula mixture as well as symmetric and asymmetric khoudraji liebscher copulas and the product copula model following the corrected akaike information criterion aicc it is found that the gaussian copula is the best candidate in the majority of cases which suggests that the gaussian copula may be used as a solid base for copula based modelling of h s t z additionally the cma was also implemented to produce an intuitive comparison of the estimated joint statistical models their joint density contour plots were compared with a contour plot of empirical data meanwhile the met ocean contours defined by the inverse first order reliability approach iform were also predicted the results demonstrate that the symmetric copula model has the disadvantage of mismatching the physical limit on steepness the conditional model performs poorly in estimating the sea states with the highest occurrence frequency compared with the khoudraji liebscher and product copula models the copula mixture model appears to predict more specific and realistic extreme sea state contours the copula mixture model describes the marginal distribution of each sea state parameter also using a mixture of four components meanwhile the conditional model estimates the marginal distribution of t z on the basis of its joint distribution the univariate goodness of fit test in terms of the aicc kolmogorov smirnov k s and anderson darling a d statistics suggests that estimating the marginal distributions of sea state parameters as a mixture of four components can improve goodness of fit moreover the results also indicate that the marginal distribution of t z estimated by the cma may need to be carefully applied for the bivariate goodness of fit test in addition to the aicc k s and a d statistics two cell specific measurements including the χ 2 statistic and normalised cell deviation were also evaluated the results consistently suggest that the copula mixture model outperforms the other models providing quite good fit to the majority of binned sea states the asymmetric khoudraji liebscher and product copula models represent the second best bivariate fit and the asymmetric dependence between the two sea state parameters is well captured compared with the conditional and symmetric copula models with obviously poorer performance the asymmetric khoudraji liebscher and product copula models improve the fit to the sea states with lower values of h s and t z but have the same disadvantage of underestimating the occurrence probability of the sea states with extreme high and low steepness this underestimation is concerning for risk assessment of marine and coastal structures moreover it is also noticed that these two kinds of asymmetric copula models provide similar values of the test statistics considering the difficulty and uncertainty in the estimation of much more complex product copulas the khoudraji liebscher in practice seems to be more feasible for the bivariate modelling of h s t z wave spectrum partitioning based on observed buoy records is difficult and remains challenging however due to the short of measured data and the development of numerical modelling techniques now days the analysis of long term wave climates are far more widely carried out on the basis of hindcasting data in this respect wave models e g wam wavewatch iii or swan since version 41 10 upon request can automatically identify the partitioned spectra using the widely recognised method therefore it is much easier than before to collect the separated wave characteristics h s w and h s s k which gives the possibility to construct the proposed model although the proposed model contains more parameters in cases where those additional wave data could be obtained on one hand it is much easier to perform model estimation compared with the khoudraji liebscher copula model while providing an more realistic representation of the h s t z data on the other hand each mixture of the proposed model has clearly physical meaning therefore they can be used to describe the statistical behaviour of a specific type of waves which can help the engineers gain an insight into the long term wave climate for example in fig 11 the iform contours with respect to each of the classified wave components are presented under this circumstance considering the weight parameter w k indicates the seasonal occurrence of frequency of the k t h mixture the radius β s n u 1 2 u 2 2 is calculated by φ 1 1 1 w k 365 4 24 3 n meanwhile φ u 1 and φ u 2 are defined as f h s k x and f t z k h s k y x respectively all in all the proposed model is powerful for describing the long term wave climate in specific sites and ocean areas while improving the design and assessment of coastal and off shore structures nevertheless further research on using such a mixture model for the bivariate modelling of h s t z is essential future studies should examine the tail dependency explore other kinds of models investigate the physical and statistical differences between classified wave components as well as search for better classification criterion credit author statement yifan lin methodology software validation investigation data curation writing original draft preparation visualization sheng dong conceptualization methodology resources writing reviewing and editing supervision project administration funding acquisition shanshan tao software formal analysis declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the study was partially supported by the national natural science foundation of china shandong joint fund project u1706226 the national natural science foundation of china 51779236 and the national key research and development program 2016yfc0303401 appendix appendix a marginal distributions three parameter weibull a 1 f w 3 x β x δ β 1 α β exp x δ α β x δ where δ is called the location parameter if δ 0 the model becomes the simple two parameter weibull model α and β are the scale and shape parameters respectively it has been known that the ml estimation in the three parameter weibull distribution is treated anomalously when β 2 hirose 1996 therefore we applied the modified maximum likelihood estimation mmle proposed by cohen and whitten 1982 in this study lognormal a 2 f l n x 1 x σ 2 π exp 1 2 σ 2 ln x μ x 0 where μ and σ are respectively the location and scale parameters whose mles respectively equal to the mean and standard deviation of ln x lonowe a 3 f l w x 1 x σ 2 π exp 1 2 σ 2 ln x μ x η β x β 1 α β exp x α β x η where η is the shifting point from the lognormal distribution to the weibull tail continuity is required for f x x and f x x at x η haver 1985 suppose μ σ and η of the lonowe distribution have been known according to the continuity conditions α and β of the weibull tail can be derived as a 4a β exp ln f l n η ln η ln ln 1 f l n η ln 1 f l n η a 4b α exp ln η ln ln 1 f l n η β accordingly the lonowe distribution should be considered as a three parameter model in the fitting procedure μ and σ are directly estimated from the raw data in the same way as the parameters obtained by applying a lognormal distribution only moan et al 2005 a proper estimation of η is important to get a good fit of the marginal distribution and will significantly affect the extreme value prediction in this study it is done by maximising the log likelihood function log l i 1 n l n f l w x i in which x i i 1 n are the n random samples appendix b copula functions gaussian b 1a c u v φ 2 φ 1 u φ 1 v t 1 t 1 b 1b c u v ϕ 2 φ 1 u φ 1 v t ϕ φ 1 u ϕ φ 1 v b 1c c u v φ φ 1 v t φ 1 u 1 t 2 gumbel b 2a c u v exp a t b t 1 t t 1 b 2b c u v c u v a b t 1 u v a t b t 1 t t 1 a t b t 1 t 2 b 2c c u v c u v u 1 b a t 1 t 1 galambos b 3a c u v u v exp a t b t 1 t t 0 b 3b c u v c u v u v 1 a t b t 1 1 t a t 1 b t 1 a t b t 2 1 t a b t 1 1 t a t b t 1 t b 3c c u v c u v u 1 1 a b t 1 1 t hüsler reiss b 4a c u v exp a φ 1 t t 2 ln a b b φ 1 t t 2 ln b a t 0 b 4b c u v c u v u v φ 1 t t 2 ln b a φ 1 t t 2 ln a b 1 2 t b ϕ 1 t t 2 ln a b b 4c c u v c u v u φ 1 t t 2 ln a b t 2 ϕ 1 t t 2 ln a b t 2 b a ϕ 1 t t 2 ln b a in the above expressions t is the dependence parameter used to measures the degree of association between u and v φ and ϕ are the abbreviations of cumulative and density probability functions of the standard normal distribution respectively similarly φ 2 and ϕ 2 are the abbreviations of cumulative and density probability functions of the bivariate standard normal distribution respectively moreover a and b are defined as a l n u and b l n v respectively for more theoretical introduction to these parametric copula families see joe 1997 2014 
