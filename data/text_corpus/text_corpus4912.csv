index,text
24560,the linearity of the bzi biomass photic depth and irradiance regression model for the estimate of depth integrated primary productivity in the water column is evaluated it is shown that the linear model can be derived from traditional production irradiance p i curves by assuming a linear production irradiance relationship a correction tem is obtained for water depth shallower than the photic depth the analysis revealed that the slope of the linear bzi model is determined by the slope of the p i curve following similar steps and assumptions some of the well known nonlinear light functions such as steele s function smith s function and the monod function were analytically integrated yielding nonlinear bzi models which go through the origin naturally allowing zero productivity at zero light the nonlinear model integrated from steele s function was successfully applied to three subtropical estuaries in florida the st lucie estuary on the east coast the caloosahatchee river and estuary and the escambia bay on the west coast despite being more faithful to theory zero intercept the non linear version yielded only slightly better results than the linear model keywords primary production bzi model light functions photic depth subtropical 1 introduction primary productivity is a key ecological variable for understanding coastal estuarine systems estimates of primary productivity are usually required to develop nutrient budgets and calibrate eutrophication models they are also useful for understanding the flow of energy among trophic levels in an estuarine food web primary productivity measurements are resource intensive creating the need for empirical models that predict productivity as a function of factors for which data are more readily available nixon 2009 such as chlorophyll a light availability temperature and nutrients cole and cloern 1987 demonstrated that depth integrated daily gross primary productivity gpp in six different systems san francisco bay neuse river south river puget sound delaware bay and hudson river plume could be empirically modeled as a linear function of the composite variable bzi where b phytoplankton biomass measured as chlorophyll a concentration mg m3 z stands for zp photic zone depth m defined as the depth associated with 1 of surface irradiance and i stands for i0 surface irradiance einstein m2 day here it is par photosynthetically active radiation in the intervening years similar relationships have been demonstrated in other ecosystems brush et al 2002 summarized the work of fourteen separate sources that demonstrated the utility of the composite bzi variable for predicting primary productivity for example keller 1988a and 1988b and kelly and doering 1997 demonstrated that a similar linear relation also held for coastal waters in new england including narragansett bay boston harbor massachusetts bay and cape cod bay other systems included in brush et al 2002 are delaware bay chesapeake bay tomales bay the neuse river and the westerschelde estuary in the netherlands all the sources summarized by brush et al 2002 were from temperate climates few studies have been reported in the literature for tropical and subtropical estuaries cloern et al 2014 but two recent studies mathews et al 2015 murrell et al 2007 have shown successful application of this empirical linear relationship in escambia bay and caloosahatchee river and estuary two shallow gulf of mexico systems in florida the bzi empirical expression describes depth integrated daily production as a function of biomass and a term that quantifies light availability in the water column zpi0 or i0 k where k is the light attenuation coefficient the regressions consistently explain the majority of the variation in production data with most of the r2 values of the regressions better than 0 55 mathews et al 2015 the absence of a nutrient effect in the model is interpreted as indicating that nutrients are not limiting and productivity is largely a function of light availability the absence of a temperature influence is also noteworthy considering that most productivity studies were carried out through at least one year with seasonal variation in temperature yet the relationships are consistent for the study period and across several coastal systems from san francisco bay to puget sound and to new york bight cole and cloern 1987 brush et al 2002 suggested that the eppley curve eppley 1972 a temperature function for maximum phytoplankton growth rate used in traditional primary productivity models underestimated productivity rates in some of the ecosystem models and suggested that the bzi model be used as an alternative despite the success of the bzi model in many estuarine systems issues concerning the regression model remain unresolved it is quite common for the regression equation to have a non zero intercept indicating that there is productivity when the composite variable is zero this situation makes no theoretical sense and several authors boyer et al al 1993 brush et al 2002 keller 1988b suggested that the intercept was an artifact of representing a non linear relationship with a linear model few attempts appear in the literature to provide a fundamental interpretation and validation of the linear relationship through dimensional analysis harris and brush 2012 were the first to demonstrate that the bzi model can be derived from a first principle theory the metabolic theory of ecology mte they also added the boltzman factor to the bzi model to account for temperature dependency of productivity still the dimensional analysis would not specifically point to which i in this case the surface irradiance i0 and which z in this case the photic depth zp should be in the composite bzi variable the primary objective of this paper is to provide a connection between the more traditional primary production model or the p i curves which are usually nonlinear and the empirical bzi model in the process a nonlinear form of bzi model is developed the non zero intercept often seen in the linear regression is explained and a correction term for the linear bzi model in shallow water is provided in the remaining part of this paper first the bzi model and its nonlinear versions are derived by vertically integrating the light functions p i curves in the water column then the linear and nonlinear models are applied to three subtropical estuaries in florida to compare with measured productivity and cross compared with each other 2 methods 2 1 vertical integration of the p i curves photosynthetic processes have been extensively studied in laboratory experiments and in the field to better understand the underlying mechanisms the response of photosynthesis to irradiance is commonly modeled as a photosynthesis irradiance p vs i response curve or light functions jassby and platt 1976 platt and sathyendranath 1993 sakshaug et al 1997 which describes the biomass specific photosynthetic rate as a saturating function of irradiance geider et al 1997 numerous studies describe the mechanistic bases of the p vs i relationship e g baklouti et al 2006 geider et al 1997 these light functions are fitted to reproduce the usual shape of the experimental data so they must have zero primary productivity at zero irradiance baklouti et al 2006 according to jassby and platt 1976 these light functions can all be described in terms of two parameters pm the maximum photosynthetic rate and α the maximum light utilization coefficient see table 2 for a list of parameters used in the equations which is also the initial slope of the p i curve another parameter is an irradiance constant defined as 1 i s p m α is irradiance constant e m 2 day 1 α initial slope mg c mg chla 1 day 1 e m 2 day 1 pm maximum photosynthetic rate already adjusted for the chlorophyll carbon ratio and also adjusted for day light fraction mg c mg chla 1 day 1 the second column in table 1 shows five normalized light functions selected among the most widely used expressions for the light saturation functions where 2 f i p p m i irradiance at any point of water column available for phytoplankton e m 2 day 1 p photosynthetic rate mg c mg chla 1 day 1 all equations are presented in equivalent form and may legitimately be compared with respect to their success in fitting the experimental data jassby and platt 1976 computation of primary productivity often starts with fitting of the measured p i curve to one of the light functions in table 1 or other functions for example henley 1993 and also platt et al 1980 it needs to be pointed out that the p i curves usually describe hourly or shorter production rate as a function of incident light intensity in this study however the assumption is made that they apply to daily production rate and daily light as well it s not uncommon to fit the p i curves using daily rates and daily light malcolm pirnie 2007 murrell et al 2007 productivity at any point in the water column is 3 p r p m b f i where b algal biomass represented by chlorophyll a concentration mg chla m3 pr production at any point in the water column mg c m3 day production for the water column can be obtained by vertically integrating eq 3 4 p d 0 d p m b f i d z p m b 0 d f i d z d depth m z vertical coordinate m pd production for the water column mg c m2 day certain assumptions are necessary for the integration the first assumption is that light intensity declines exponentially with depth following beer s law 5 i i z i 0 e k z where i0 the incident light intensity at surface e m 2 day 1 k light attenuation coefficient m 1 which is a measure of water transparency and is affected by algae organic detritus and inorganic sediment in the water column the maximum depth at which algae can grow is the photic zone depth zp defined by depth at which 1 of surface light can reach and can be found inversely related to k e g brush and brawley 2009 6 z p 4 61 k the second assumption is that the photic zone is well mixed therefore chlorophyll a pm and α which can be potentially influenced by factors such as temperature and nutrient levels are more or less vertically uniform under these assumptions insert one of the light function f i in table 1 into eq 4 and integrate vertically the water column production can be obtained take steele s function as an example p d p m b 0 d f i d z p m b 0 d i i s e i i s d z from eq 5 we have d i k i d z also use eq 6 then the above equation becomes p d 1 4 61 p m b z p 0 d e i i s d i i s that is 7 p d 1 4 61 p m b z p e i d i s e i 0 i s where i0 id light intensities at surface and bottom e m 2 day 1 respectively i d i 0 e k d if the water depth d zp then 7a p d 1 4 61 p m b z p 1 e i 0 i s for other light functions a more general expression can be found 8 p d p m b 0 d f i d z 1 4 61 p m b z p f i 0 where f i0 is the depth integrated light function normalized by the inverse of the light attenuation coefficient k and f i0 is non dimensional 8a f i 0 k 0 d f i d z as a reference f i0 for some of the light functions that can be integrated analytically are listed in table 1 eq 8 can be regarded as a general expression for depth integrated water column primary productivity or the nonlinear bzi model pd is proportional to bzpf i0 which is similar to the linear bzi model f i0 is a nonlinear function of i0 it is clear that the nonlinearity of f i0 is due to the nonlinear nature of f i so it would be logical to work with a linearized p i curve in order to obtain the linear bzi model assuming a simple linear p i relation 9 p α i β where α is the slope for the linear relationship and β is the intercept by definition the p i curve should be forced through origin meaning it must have zero primary productivity at zero irradiance baklouti et al 2006 but in order to fit a linear function to the actual p i curve α could very well be different from the initial slope of the p i curve and a non zero intercept is almost inevitable this could be the reason for the non zero intercept in many of the bzi regression models e g boyer et al 1993 the normalized form of eq 9 following eq 2 is 10 f i α i β p m insert eq 10 into eq 4 and using eqs 5 and 6 yielding 11 p d 1 4 61 α b z p i o 1 e k d min z p d β b eq 11 is the bzi model derived from a linear p i curve the first term contains the bzi composite variable multiplied by a simple correction term for water depth shallower than the photic zone the second term in eq 11 is the intercept of the bzi model though eq 11 may look just like the regression model it is more revealing 1 the slope of the linear bzi model is determined by the slope of the linearized p i curve slope of the linear regression α 4 61 2 a simple correction term e kd allows the linear bzi model to compute pd for water depth shallower than zp this simple correction comes naturally with the linearized p i curve and bear s law the correction term could be important for shallow systems it remains to be seen if this is adequate without the need to perform more complex analysis such as polynomial fitting e g brush and brawley 2009 3 the intercept is a result of non zero intercept β of the linear p i curve if β is zero or forced to be zero there would be no intercept for the bzi model back to eq 7 or 8 which can be regarded as the nonlinear version of eq 11 the advantage of eq 7 or 8 is that it is derived from typical p i curves without further simplification and it can go through the origin allowing zero productivity at zero light the disadvantage is that it requires at least two parameters pm and α in the next subsection both the linear and nonlinear bzi models will be applied to three subtropical estuary systems in florida 2 2 application of the production models to subtropical estuaries 2 2 1 data sources the primary productivity models discussed in the previous section were applied to three subtropical estuaries in florida the st lucie estuary the caloosahatchee river estuary and the escambia bay all three are shallow systems average depths of 2 to 3 m with low to moderate tide tidal range less than 1 2 m the linear regression bzi model has been applied successfully in all three systems malcom pirnie 2007 mathews et al 2015 murrell et al 2007 data for the three estuaries are from three separate primary production studies malcolm pirnie 2007 mathews et al 2015 murrell et al 2007 the st lucie estuary study was carried out over a 15 month period from january 2000 to march 2001 primary productivity was measured at four locations fig 1 each consisting of one shallow site and one deep site representing four different regions of the estuary the south fork the north fork the middle estuary and the lower estuary data collected and analyzed from water samples included salinity temperature nutrients light and light attenuation dissolved oxygen and chlorophyll a primary productivity was measured in situ using the light dark bottle oxygen method as described by strickland and parsons 1972 malcolm pirnie 2007 the caloosahatchee river estuary study was performed in 2009 at four stations from the upper to lower estuary including the tidal portion of the caloosahatchee river and the san carlos bay fig 2 each with five monthly sampling events in 2009 similar to the st lucie estuary study this study included collection and analysis of water samples for nutrients salinity temperature dissolved oxygen and chlorophyll a primary productivity was measured using both in situ and laboratory incubations of the light dark bottle oxygen method mathews et al 2015 for escambia bay unlike the other two studies primary productivity was measured by the incorporation of nah14co3 into particulate organic matter murrell et al 2007 in the upper and lower bay fig 3 light data were measured using a licor sensor and analyzed for the light attenuation coefficient water samples were collected for salinity temperature water quality dissolved oxygen and chlorophyll a 2 2 2 application of the bzi models application of the linear bzi model was straightforward measured daily productivity pd was linearly regressed against the composite variable bzpi0 which was computed from measured biomass photic depth and surface light par for this regression the intercept was forced to be zero the best fit of slope of the regression was used to calculate the initial slope α in eq 11 see table 3 to apply the nonlinear model eq 7 two parameters pm and is or initial slope α are needed both parameters were estimated by fitting the vertically integrated steele function 1962 eq 7 with measured daily data b zp i0 k pd at all sites for each estuary using a least square iterative approach built in the microsoft excel solver the target is the minimum residual between the modeled and measured primary productivity for each estuary only one pair of pm and is or α were obtained for each estuary table 3 3 results modeled primary productivity at each location is shown in the upper two panels for each estuary in figs 4 6 and r2 between modeled and measured data for the nonlinear and linear model are displayed in the lower two panels for the st lucie estuary only the shallow sites are shown in fig 4 a through d but r2 statistics are shown for all the four shallow sites and three deep sites e and f hells gate deep was not included because there were not enough data points for this site is was found to be 26 8 em 2 day 1 and pm 149 7 mg c mg chla 1 day 1 the nonlinear model performed well compared with the linear bzi model for all seven sites r2 are 0 56 and 0 6 for the linear and the nonlinear model respectively for the caloosahatchee river estuary pm and is were found to be 188 3 mg c mg chla 1 day 1 and 27 1 em 2 day 1 respectively both the linear regression bzi model and the nonlinear model using steele s function performed very well explaining 85 and 89 of observed variation fig 5 for the escambia bay pm was found to be 160 9 mg c mg chla 1day 1 and is 31 7 em 2day 1 again both the linear bzi model and the nonlinear model performed very well explaining 77 and 78 of the variation observed in water column productivity respectively fig 6 these results suggest that both the bzi linear regression eq 11 and the nonlinear model eq 7 worked well for the three subtropical estuaries in florida and were able to explain the majority of variation observed in water column primary productivity with the nonlinear model being slightly better the is values from the least square method are very close to each other for the three estuaries note that the r2 value for the nonlinear model depends solely on is while pm mainly influences the magnitude of the computed pd this is because the light limiting function f i and its depth integrated form f i0 depend on is only 4 discussion 4 1 differences and similarities between the linear and nonlinear bzi models from a mathematical point of view the only difference between a linear bzi model and a nonlinear model is that a linearized p i curve was used to derive the former and a nonlinear p i curve such as steele function was used to derive the latter there is also a difference between the slopes used in the two models i e α and α can have different values table 3 this is because α is the initial slope and α may represent an average slope of the p i curve this difference is an indicator of nonlinearity of the p i curve there are conditions under which the two can approach each other principally when is i0 then all the light functions in table 1 can be approximated by f i i is and eqs 7 and 8 can be approximated by 12 p d 1 4 61 α b z p i o 1 e k d which is the same as eq 11 without the intercept term for d zp eq 12 can be further reduced to 13 p d 1 4 61 α b z p i 0 eqs 12 or 13 approximate the linear bzi model the implication is that one can use a linear p i curve without losing much accuracy and it is the slope for the p i curve that seems to be the more important parameter to characterize the photosynthesis processes in the water column the non zero intercept in the linear bzi regression is usually quite small so it is probably acceptable to force the linear model through the origin the performance of the nonlinear model is very close to or only slightly better than the linear model this seems to suggest that the nonlinear model does not provide the benefit one would expect there are a few possible reasons first the nonlinear bzi model is still of empirical nature arising from the empirical p i curves though the vertical integration is very rigorous and second the fit of a nonlinear p i curve at an individual site is usually great with r2 value exceeding 90 malcom pirnie 2007 however the resulting parameters pm α or pm is vary significantly from site to site when fitting the nonlinear bzi model with the observed daily production data for all the sites in the estuary with a single pare of parameters the fitness becomes poorer inevitably and third a different light function may perform better than the steele 1962 function the fact that both the linear and the nonlinear model worked well suggest that both are solid approaches that can be used for the estimate of primary production enabling monitoring programs to reduce the time and intensive investments in primary productivity studies note that fitting the two models differs only in the form of the regression linear or non linear since both use exactly the same data sets there is no difference in cost it also justifies the practice of using pm and is as calibrating parameters in many applications of ecosystem models despite the fact that pm and α obtained from individual p i curves do vary significantly in both space and time jassby and platt 1976 it also justifies or confirms to some extent our early assumption that the commonly used p i functions appear to work for daily growth rates 4 2 influence of temperature and nutrients primary production is known to be influenced by environmental factors such as nutrients and temperature nixon et al 1996 provided one of the most complete nitrogen load vs primary production plots demonstrating a strong relationship similarly kelly 2008 demonstrated a strong relationship between annual primary productivity and dissolved inorganic nitrogen loading using experimental merl mesocosm data and data from various open marine systems a recent review by cloern et al 2014 of annual phytoplankton primary production in 131 ecosystems also suggested the importance of nutrient supply in primary production the effects of temperature on primary production are also well known the eppley curve eppley 1972 is a commonly used temperature function for the maximum growth rate based on database of culture studies in which growth rates of approximately 130 species of phytoplankton were measured at a variety of temperatures under 24 h of continuous illumination and conditions of nutrient sufficiency the relative insensitivity of the primary production models to issues of nutrient limitation and temperature variability indicate that there are some important physiological processes yet to be understood falkowski and raven 1997 but the absence of nutrients and temperature from eq 7 or 11 doesn t necessarily mean nutrients are not limiting nor temperature has no effect our explanation is that the bzi models while showing a strong correlation between primary production and the composite variable do not necessarily exclude the effects of nutrients and temperature as a moderating factor this is because nutrients are often weakly correlated with primary production and are not a good predictor of individual rates of primary production cloern et al 2014 doering 1996 found that even though there is no significant correlation between nutrient loading and chlorophyll a in the st lucie estuary on a monthly scale variation of nutrients could explain 80 of variance observed in chlorophyll a on annual time scale mathews et al 2015 found that deviations from the linear regression bzi model may in part reflect the secondary influences of nutrient levels temperature and salinity temperature and nutrient effects can be represented mathematically through their effect on the photosynthetic parameters pm and α jassby and platt 1976 according to geider et al 1997 nutrient limitation and temperature affect phytoplankton physiology by imposing a limit on the light saturated photosynthesis rate thus pm is considered to be a multiplicative function of temperature and nutrient availability 14 p m p r e f f n f t where pref is the reference growth rate under idealized nutrient and temperature conditions geider et al 1997 and behrenfeld et al 2004 suggest that the initial slope of the p i curve may be variable depending on variations of environmental conditions therefore α can also be described as a multiplicative function of temperature and nutrient limitation 15 α α r e f f n f t the nutrient limitation f n is often represented with monod s equation monod 1949 and the effect of temperature f t m is often described by a q10 law eppley 1972 a recent effort by harris and brush 2012 suggest the boltzman factor e e k t e activation energy k boltzman constant and t absolute temperature could be a good alternative of the temperature function f t eq 8 together with eq 14 have been used in many water quality models e g wasp wool et al 2001 cequal icm cerco and cole 1994 hem3d park et al 1995 alternatively one could also use the combination of eqs 13 and 15 to model algal growth though this has yet to be seen in practical water quality model applications 5 summary in this paper traditional nonlinear production irradiance p i curves or light functions were integrated vertically for the estimate of depth integrated primary production in the water column yielding a nonlinear version of the bzi model it was shown that the linear model can be obtained by assuming a linear production irradiance relationship a simple correction term was obtained for water depth shallower than the photic depth the slope of the linear bzi model was determined by the slope of the p i curve and the intercept often seen in the linear regression model was caused by fitting a nonlinear p i curve with a linear one the nonlinear bzi models are dependent on two parameters 1 pm the maximum production rate and 2 α the initial slope for the corresponding p i curve or is the irradiance constant the nonlinear models can go naturally through the origin allowing zero productivity at zero light the nonlinear model can be reduced to the linear bzi model if i0 is the nonlinear model using steele s function was applied successfully to three subtropical estuaries in florida and produced slightly better results than the linear bzi model the study indicated that it is α the slope of the p i curve that may be the more important parameter to characterize the water column primary production effects of nutrient levels and temperature though not explicitly shown in the bzi model have to be accounted for in primary production models credit authorship contribution statement detong sun conceptualization methodology writing original draft peter h doering supervision data curation writing review editing edward j phlips data curation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we would like to thank yongshan wan for his support and valuable input of this effort we would like also thank teresa coley susan gray chris buzzelli fawen zheng and richard t james at the south florida water management district for their review and valuable comments and suggestions 
24560,the linearity of the bzi biomass photic depth and irradiance regression model for the estimate of depth integrated primary productivity in the water column is evaluated it is shown that the linear model can be derived from traditional production irradiance p i curves by assuming a linear production irradiance relationship a correction tem is obtained for water depth shallower than the photic depth the analysis revealed that the slope of the linear bzi model is determined by the slope of the p i curve following similar steps and assumptions some of the well known nonlinear light functions such as steele s function smith s function and the monod function were analytically integrated yielding nonlinear bzi models which go through the origin naturally allowing zero productivity at zero light the nonlinear model integrated from steele s function was successfully applied to three subtropical estuaries in florida the st lucie estuary on the east coast the caloosahatchee river and estuary and the escambia bay on the west coast despite being more faithful to theory zero intercept the non linear version yielded only slightly better results than the linear model keywords primary production bzi model light functions photic depth subtropical 1 introduction primary productivity is a key ecological variable for understanding coastal estuarine systems estimates of primary productivity are usually required to develop nutrient budgets and calibrate eutrophication models they are also useful for understanding the flow of energy among trophic levels in an estuarine food web primary productivity measurements are resource intensive creating the need for empirical models that predict productivity as a function of factors for which data are more readily available nixon 2009 such as chlorophyll a light availability temperature and nutrients cole and cloern 1987 demonstrated that depth integrated daily gross primary productivity gpp in six different systems san francisco bay neuse river south river puget sound delaware bay and hudson river plume could be empirically modeled as a linear function of the composite variable bzi where b phytoplankton biomass measured as chlorophyll a concentration mg m3 z stands for zp photic zone depth m defined as the depth associated with 1 of surface irradiance and i stands for i0 surface irradiance einstein m2 day here it is par photosynthetically active radiation in the intervening years similar relationships have been demonstrated in other ecosystems brush et al 2002 summarized the work of fourteen separate sources that demonstrated the utility of the composite bzi variable for predicting primary productivity for example keller 1988a and 1988b and kelly and doering 1997 demonstrated that a similar linear relation also held for coastal waters in new england including narragansett bay boston harbor massachusetts bay and cape cod bay other systems included in brush et al 2002 are delaware bay chesapeake bay tomales bay the neuse river and the westerschelde estuary in the netherlands all the sources summarized by brush et al 2002 were from temperate climates few studies have been reported in the literature for tropical and subtropical estuaries cloern et al 2014 but two recent studies mathews et al 2015 murrell et al 2007 have shown successful application of this empirical linear relationship in escambia bay and caloosahatchee river and estuary two shallow gulf of mexico systems in florida the bzi empirical expression describes depth integrated daily production as a function of biomass and a term that quantifies light availability in the water column zpi0 or i0 k where k is the light attenuation coefficient the regressions consistently explain the majority of the variation in production data with most of the r2 values of the regressions better than 0 55 mathews et al 2015 the absence of a nutrient effect in the model is interpreted as indicating that nutrients are not limiting and productivity is largely a function of light availability the absence of a temperature influence is also noteworthy considering that most productivity studies were carried out through at least one year with seasonal variation in temperature yet the relationships are consistent for the study period and across several coastal systems from san francisco bay to puget sound and to new york bight cole and cloern 1987 brush et al 2002 suggested that the eppley curve eppley 1972 a temperature function for maximum phytoplankton growth rate used in traditional primary productivity models underestimated productivity rates in some of the ecosystem models and suggested that the bzi model be used as an alternative despite the success of the bzi model in many estuarine systems issues concerning the regression model remain unresolved it is quite common for the regression equation to have a non zero intercept indicating that there is productivity when the composite variable is zero this situation makes no theoretical sense and several authors boyer et al al 1993 brush et al 2002 keller 1988b suggested that the intercept was an artifact of representing a non linear relationship with a linear model few attempts appear in the literature to provide a fundamental interpretation and validation of the linear relationship through dimensional analysis harris and brush 2012 were the first to demonstrate that the bzi model can be derived from a first principle theory the metabolic theory of ecology mte they also added the boltzman factor to the bzi model to account for temperature dependency of productivity still the dimensional analysis would not specifically point to which i in this case the surface irradiance i0 and which z in this case the photic depth zp should be in the composite bzi variable the primary objective of this paper is to provide a connection between the more traditional primary production model or the p i curves which are usually nonlinear and the empirical bzi model in the process a nonlinear form of bzi model is developed the non zero intercept often seen in the linear regression is explained and a correction term for the linear bzi model in shallow water is provided in the remaining part of this paper first the bzi model and its nonlinear versions are derived by vertically integrating the light functions p i curves in the water column then the linear and nonlinear models are applied to three subtropical estuaries in florida to compare with measured productivity and cross compared with each other 2 methods 2 1 vertical integration of the p i curves photosynthetic processes have been extensively studied in laboratory experiments and in the field to better understand the underlying mechanisms the response of photosynthesis to irradiance is commonly modeled as a photosynthesis irradiance p vs i response curve or light functions jassby and platt 1976 platt and sathyendranath 1993 sakshaug et al 1997 which describes the biomass specific photosynthetic rate as a saturating function of irradiance geider et al 1997 numerous studies describe the mechanistic bases of the p vs i relationship e g baklouti et al 2006 geider et al 1997 these light functions are fitted to reproduce the usual shape of the experimental data so they must have zero primary productivity at zero irradiance baklouti et al 2006 according to jassby and platt 1976 these light functions can all be described in terms of two parameters pm the maximum photosynthetic rate and α the maximum light utilization coefficient see table 2 for a list of parameters used in the equations which is also the initial slope of the p i curve another parameter is an irradiance constant defined as 1 i s p m α is irradiance constant e m 2 day 1 α initial slope mg c mg chla 1 day 1 e m 2 day 1 pm maximum photosynthetic rate already adjusted for the chlorophyll carbon ratio and also adjusted for day light fraction mg c mg chla 1 day 1 the second column in table 1 shows five normalized light functions selected among the most widely used expressions for the light saturation functions where 2 f i p p m i irradiance at any point of water column available for phytoplankton e m 2 day 1 p photosynthetic rate mg c mg chla 1 day 1 all equations are presented in equivalent form and may legitimately be compared with respect to their success in fitting the experimental data jassby and platt 1976 computation of primary productivity often starts with fitting of the measured p i curve to one of the light functions in table 1 or other functions for example henley 1993 and also platt et al 1980 it needs to be pointed out that the p i curves usually describe hourly or shorter production rate as a function of incident light intensity in this study however the assumption is made that they apply to daily production rate and daily light as well it s not uncommon to fit the p i curves using daily rates and daily light malcolm pirnie 2007 murrell et al 2007 productivity at any point in the water column is 3 p r p m b f i where b algal biomass represented by chlorophyll a concentration mg chla m3 pr production at any point in the water column mg c m3 day production for the water column can be obtained by vertically integrating eq 3 4 p d 0 d p m b f i d z p m b 0 d f i d z d depth m z vertical coordinate m pd production for the water column mg c m2 day certain assumptions are necessary for the integration the first assumption is that light intensity declines exponentially with depth following beer s law 5 i i z i 0 e k z where i0 the incident light intensity at surface e m 2 day 1 k light attenuation coefficient m 1 which is a measure of water transparency and is affected by algae organic detritus and inorganic sediment in the water column the maximum depth at which algae can grow is the photic zone depth zp defined by depth at which 1 of surface light can reach and can be found inversely related to k e g brush and brawley 2009 6 z p 4 61 k the second assumption is that the photic zone is well mixed therefore chlorophyll a pm and α which can be potentially influenced by factors such as temperature and nutrient levels are more or less vertically uniform under these assumptions insert one of the light function f i in table 1 into eq 4 and integrate vertically the water column production can be obtained take steele s function as an example p d p m b 0 d f i d z p m b 0 d i i s e i i s d z from eq 5 we have d i k i d z also use eq 6 then the above equation becomes p d 1 4 61 p m b z p 0 d e i i s d i i s that is 7 p d 1 4 61 p m b z p e i d i s e i 0 i s where i0 id light intensities at surface and bottom e m 2 day 1 respectively i d i 0 e k d if the water depth d zp then 7a p d 1 4 61 p m b z p 1 e i 0 i s for other light functions a more general expression can be found 8 p d p m b 0 d f i d z 1 4 61 p m b z p f i 0 where f i0 is the depth integrated light function normalized by the inverse of the light attenuation coefficient k and f i0 is non dimensional 8a f i 0 k 0 d f i d z as a reference f i0 for some of the light functions that can be integrated analytically are listed in table 1 eq 8 can be regarded as a general expression for depth integrated water column primary productivity or the nonlinear bzi model pd is proportional to bzpf i0 which is similar to the linear bzi model f i0 is a nonlinear function of i0 it is clear that the nonlinearity of f i0 is due to the nonlinear nature of f i so it would be logical to work with a linearized p i curve in order to obtain the linear bzi model assuming a simple linear p i relation 9 p α i β where α is the slope for the linear relationship and β is the intercept by definition the p i curve should be forced through origin meaning it must have zero primary productivity at zero irradiance baklouti et al 2006 but in order to fit a linear function to the actual p i curve α could very well be different from the initial slope of the p i curve and a non zero intercept is almost inevitable this could be the reason for the non zero intercept in many of the bzi regression models e g boyer et al 1993 the normalized form of eq 9 following eq 2 is 10 f i α i β p m insert eq 10 into eq 4 and using eqs 5 and 6 yielding 11 p d 1 4 61 α b z p i o 1 e k d min z p d β b eq 11 is the bzi model derived from a linear p i curve the first term contains the bzi composite variable multiplied by a simple correction term for water depth shallower than the photic zone the second term in eq 11 is the intercept of the bzi model though eq 11 may look just like the regression model it is more revealing 1 the slope of the linear bzi model is determined by the slope of the linearized p i curve slope of the linear regression α 4 61 2 a simple correction term e kd allows the linear bzi model to compute pd for water depth shallower than zp this simple correction comes naturally with the linearized p i curve and bear s law the correction term could be important for shallow systems it remains to be seen if this is adequate without the need to perform more complex analysis such as polynomial fitting e g brush and brawley 2009 3 the intercept is a result of non zero intercept β of the linear p i curve if β is zero or forced to be zero there would be no intercept for the bzi model back to eq 7 or 8 which can be regarded as the nonlinear version of eq 11 the advantage of eq 7 or 8 is that it is derived from typical p i curves without further simplification and it can go through the origin allowing zero productivity at zero light the disadvantage is that it requires at least two parameters pm and α in the next subsection both the linear and nonlinear bzi models will be applied to three subtropical estuary systems in florida 2 2 application of the production models to subtropical estuaries 2 2 1 data sources the primary productivity models discussed in the previous section were applied to three subtropical estuaries in florida the st lucie estuary the caloosahatchee river estuary and the escambia bay all three are shallow systems average depths of 2 to 3 m with low to moderate tide tidal range less than 1 2 m the linear regression bzi model has been applied successfully in all three systems malcom pirnie 2007 mathews et al 2015 murrell et al 2007 data for the three estuaries are from three separate primary production studies malcolm pirnie 2007 mathews et al 2015 murrell et al 2007 the st lucie estuary study was carried out over a 15 month period from january 2000 to march 2001 primary productivity was measured at four locations fig 1 each consisting of one shallow site and one deep site representing four different regions of the estuary the south fork the north fork the middle estuary and the lower estuary data collected and analyzed from water samples included salinity temperature nutrients light and light attenuation dissolved oxygen and chlorophyll a primary productivity was measured in situ using the light dark bottle oxygen method as described by strickland and parsons 1972 malcolm pirnie 2007 the caloosahatchee river estuary study was performed in 2009 at four stations from the upper to lower estuary including the tidal portion of the caloosahatchee river and the san carlos bay fig 2 each with five monthly sampling events in 2009 similar to the st lucie estuary study this study included collection and analysis of water samples for nutrients salinity temperature dissolved oxygen and chlorophyll a primary productivity was measured using both in situ and laboratory incubations of the light dark bottle oxygen method mathews et al 2015 for escambia bay unlike the other two studies primary productivity was measured by the incorporation of nah14co3 into particulate organic matter murrell et al 2007 in the upper and lower bay fig 3 light data were measured using a licor sensor and analyzed for the light attenuation coefficient water samples were collected for salinity temperature water quality dissolved oxygen and chlorophyll a 2 2 2 application of the bzi models application of the linear bzi model was straightforward measured daily productivity pd was linearly regressed against the composite variable bzpi0 which was computed from measured biomass photic depth and surface light par for this regression the intercept was forced to be zero the best fit of slope of the regression was used to calculate the initial slope α in eq 11 see table 3 to apply the nonlinear model eq 7 two parameters pm and is or initial slope α are needed both parameters were estimated by fitting the vertically integrated steele function 1962 eq 7 with measured daily data b zp i0 k pd at all sites for each estuary using a least square iterative approach built in the microsoft excel solver the target is the minimum residual between the modeled and measured primary productivity for each estuary only one pair of pm and is or α were obtained for each estuary table 3 3 results modeled primary productivity at each location is shown in the upper two panels for each estuary in figs 4 6 and r2 between modeled and measured data for the nonlinear and linear model are displayed in the lower two panels for the st lucie estuary only the shallow sites are shown in fig 4 a through d but r2 statistics are shown for all the four shallow sites and three deep sites e and f hells gate deep was not included because there were not enough data points for this site is was found to be 26 8 em 2 day 1 and pm 149 7 mg c mg chla 1 day 1 the nonlinear model performed well compared with the linear bzi model for all seven sites r2 are 0 56 and 0 6 for the linear and the nonlinear model respectively for the caloosahatchee river estuary pm and is were found to be 188 3 mg c mg chla 1 day 1 and 27 1 em 2 day 1 respectively both the linear regression bzi model and the nonlinear model using steele s function performed very well explaining 85 and 89 of observed variation fig 5 for the escambia bay pm was found to be 160 9 mg c mg chla 1day 1 and is 31 7 em 2day 1 again both the linear bzi model and the nonlinear model performed very well explaining 77 and 78 of the variation observed in water column productivity respectively fig 6 these results suggest that both the bzi linear regression eq 11 and the nonlinear model eq 7 worked well for the three subtropical estuaries in florida and were able to explain the majority of variation observed in water column primary productivity with the nonlinear model being slightly better the is values from the least square method are very close to each other for the three estuaries note that the r2 value for the nonlinear model depends solely on is while pm mainly influences the magnitude of the computed pd this is because the light limiting function f i and its depth integrated form f i0 depend on is only 4 discussion 4 1 differences and similarities between the linear and nonlinear bzi models from a mathematical point of view the only difference between a linear bzi model and a nonlinear model is that a linearized p i curve was used to derive the former and a nonlinear p i curve such as steele function was used to derive the latter there is also a difference between the slopes used in the two models i e α and α can have different values table 3 this is because α is the initial slope and α may represent an average slope of the p i curve this difference is an indicator of nonlinearity of the p i curve there are conditions under which the two can approach each other principally when is i0 then all the light functions in table 1 can be approximated by f i i is and eqs 7 and 8 can be approximated by 12 p d 1 4 61 α b z p i o 1 e k d which is the same as eq 11 without the intercept term for d zp eq 12 can be further reduced to 13 p d 1 4 61 α b z p i 0 eqs 12 or 13 approximate the linear bzi model the implication is that one can use a linear p i curve without losing much accuracy and it is the slope for the p i curve that seems to be the more important parameter to characterize the photosynthesis processes in the water column the non zero intercept in the linear bzi regression is usually quite small so it is probably acceptable to force the linear model through the origin the performance of the nonlinear model is very close to or only slightly better than the linear model this seems to suggest that the nonlinear model does not provide the benefit one would expect there are a few possible reasons first the nonlinear bzi model is still of empirical nature arising from the empirical p i curves though the vertical integration is very rigorous and second the fit of a nonlinear p i curve at an individual site is usually great with r2 value exceeding 90 malcom pirnie 2007 however the resulting parameters pm α or pm is vary significantly from site to site when fitting the nonlinear bzi model with the observed daily production data for all the sites in the estuary with a single pare of parameters the fitness becomes poorer inevitably and third a different light function may perform better than the steele 1962 function the fact that both the linear and the nonlinear model worked well suggest that both are solid approaches that can be used for the estimate of primary production enabling monitoring programs to reduce the time and intensive investments in primary productivity studies note that fitting the two models differs only in the form of the regression linear or non linear since both use exactly the same data sets there is no difference in cost it also justifies the practice of using pm and is as calibrating parameters in many applications of ecosystem models despite the fact that pm and α obtained from individual p i curves do vary significantly in both space and time jassby and platt 1976 it also justifies or confirms to some extent our early assumption that the commonly used p i functions appear to work for daily growth rates 4 2 influence of temperature and nutrients primary production is known to be influenced by environmental factors such as nutrients and temperature nixon et al 1996 provided one of the most complete nitrogen load vs primary production plots demonstrating a strong relationship similarly kelly 2008 demonstrated a strong relationship between annual primary productivity and dissolved inorganic nitrogen loading using experimental merl mesocosm data and data from various open marine systems a recent review by cloern et al 2014 of annual phytoplankton primary production in 131 ecosystems also suggested the importance of nutrient supply in primary production the effects of temperature on primary production are also well known the eppley curve eppley 1972 is a commonly used temperature function for the maximum growth rate based on database of culture studies in which growth rates of approximately 130 species of phytoplankton were measured at a variety of temperatures under 24 h of continuous illumination and conditions of nutrient sufficiency the relative insensitivity of the primary production models to issues of nutrient limitation and temperature variability indicate that there are some important physiological processes yet to be understood falkowski and raven 1997 but the absence of nutrients and temperature from eq 7 or 11 doesn t necessarily mean nutrients are not limiting nor temperature has no effect our explanation is that the bzi models while showing a strong correlation between primary production and the composite variable do not necessarily exclude the effects of nutrients and temperature as a moderating factor this is because nutrients are often weakly correlated with primary production and are not a good predictor of individual rates of primary production cloern et al 2014 doering 1996 found that even though there is no significant correlation between nutrient loading and chlorophyll a in the st lucie estuary on a monthly scale variation of nutrients could explain 80 of variance observed in chlorophyll a on annual time scale mathews et al 2015 found that deviations from the linear regression bzi model may in part reflect the secondary influences of nutrient levels temperature and salinity temperature and nutrient effects can be represented mathematically through their effect on the photosynthetic parameters pm and α jassby and platt 1976 according to geider et al 1997 nutrient limitation and temperature affect phytoplankton physiology by imposing a limit on the light saturated photosynthesis rate thus pm is considered to be a multiplicative function of temperature and nutrient availability 14 p m p r e f f n f t where pref is the reference growth rate under idealized nutrient and temperature conditions geider et al 1997 and behrenfeld et al 2004 suggest that the initial slope of the p i curve may be variable depending on variations of environmental conditions therefore α can also be described as a multiplicative function of temperature and nutrient limitation 15 α α r e f f n f t the nutrient limitation f n is often represented with monod s equation monod 1949 and the effect of temperature f t m is often described by a q10 law eppley 1972 a recent effort by harris and brush 2012 suggest the boltzman factor e e k t e activation energy k boltzman constant and t absolute temperature could be a good alternative of the temperature function f t eq 8 together with eq 14 have been used in many water quality models e g wasp wool et al 2001 cequal icm cerco and cole 1994 hem3d park et al 1995 alternatively one could also use the combination of eqs 13 and 15 to model algal growth though this has yet to be seen in practical water quality model applications 5 summary in this paper traditional nonlinear production irradiance p i curves or light functions were integrated vertically for the estimate of depth integrated primary production in the water column yielding a nonlinear version of the bzi model it was shown that the linear model can be obtained by assuming a linear production irradiance relationship a simple correction term was obtained for water depth shallower than the photic depth the slope of the linear bzi model was determined by the slope of the p i curve and the intercept often seen in the linear regression model was caused by fitting a nonlinear p i curve with a linear one the nonlinear bzi models are dependent on two parameters 1 pm the maximum production rate and 2 α the initial slope for the corresponding p i curve or is the irradiance constant the nonlinear models can go naturally through the origin allowing zero productivity at zero light the nonlinear model can be reduced to the linear bzi model if i0 is the nonlinear model using steele s function was applied successfully to three subtropical estuaries in florida and produced slightly better results than the linear bzi model the study indicated that it is α the slope of the p i curve that may be the more important parameter to characterize the water column primary production effects of nutrient levels and temperature though not explicitly shown in the bzi model have to be accounted for in primary production models credit authorship contribution statement detong sun conceptualization methodology writing original draft peter h doering supervision data curation writing review editing edward j phlips data curation writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we would like to thank yongshan wan for his support and valuable input of this effort we would like also thank teresa coley susan gray chris buzzelli fawen zheng and richard t james at the south florida water management district for their review and valuable comments and suggestions 
24561,urban population growth has raised concerns about food security agricultural systems are asked to satisfy a growing demand of food while addressing sustainability issues and facing resources constraints ecological footprints are widespread instruments for the study of human impact and dependence on natural resources amongst these tools land food footprint lff is used to measure the land actually used to produce the food needed to satisfy the demand of a given region or country understanding the differences between alternative production methods and the gaps between available and needed land is a crucial issue in order to integrate food security and sustainability issues into the food system the objective of this study is to analyse the land food footprint of tuscany italy for both organic and conventional agriculture taking into account the nexus of diet in this aim land food footprint for the considered production processes is assessed under four different diet scenarios with different levels of animal protein consumption the study suggests that the gap between land needed by organic and conventional agriculture varies considerably between vegetable and animal products it confirms that organic agriculture needs more land than conventional one but the gap between land footprints shrinks because of dietary changes in this study the most important finding is that organic agriculture might feed the case study population if the diet shifts towards a reduced intake of animal protein in fact with a diet reduction of 50 in animal proteins the organic land food footprint value is equal to the conventional land food footprint under the status quo diet scenario indicating that organic agriculture would be able to address food security issues if food consumption was properly adapted to agriculture carrying capacity graphical abstract image graphical abstract keywords sustainable food system land food footprint diet nexus organic agriculture food security 1 introduction the world s population is growing rapidly world s concerns about run away population growth have raised the debate about natural resource carrying capacity for human life the population in urban settlement has shifted from 746 million of 1950 to 4 3 billion of 2020 representing the 56 of the total population in italy the 71 of population lives in urban areas world bank 2020 people migration from the countryside increases food demand and it can be associated to a higher likelihood of farmers losing their lands to urbanisation thus leading to a loss of cultivated land it is estimated that 2050 agricultural production would need to increase by a 50 to meet food demand of a global population assessed up to 9 billion people alexandratos and bruinsma 2012 the challenge of agriculture is to feed an increasing world population with a finite and degraded agricultural land agriculture intensification is traditionally thought as the unique strategy to attain food security goals at global level bengochea paz et al 2020 in fact during the last decades the increasing food demand has been met by increasing crop yields through the implementation of high inputs industrialised farming practices following the green revolution approach borlaug 2000 as a consequence the food system is increasingly contributing to environmental degradation and resource depletion both at local and global level hanson et al 2008 hu et al 2017 guyomard et al 2011 montoya et al 2020 food policies urgently need to face the problems of natural resources scarcity and sustainability of food production consumption systems in order to ensure the viability of a sustainable food system agricultural productivity needs to be coupled with resource conservation and health protection bengochea paz et al 2020 muller et al 2017 tilman et al 2002 walters et al 2016 fulfilling the sustainable development goals sdgs agro ecological farming systems could represent a valid solution to attain agriculture sustainability but its role in ensuring world food security is still discussed connor 2018 rockström et al 2017 the debate around the viability of agro ecological farming systems is arising since food security targets are usually associated with high yield intensive agriculture reganold et al 2016 tuomisto et al 2012 power 2010 as organic and biodynamic agriculture yields are lower than those of conventional agriculture more land is necessary for organic agriculture to produce the same amount of food as the conventional one seufert et al 2012 in addition lower productivity implies less output per amount of cultivated area and less environmental advantages if calculated per amount of food supplied rather than per agricultural area meier et al 2015 several research studies have investigated different aspects of organic agriculture including its environmental performances reganold and wachter 2016 neely and fynn 2012 schader et al 2012 soil nutrient and fertility aspects badgley et al 2007 or agro ecological farming contribution in terms of ecological services and biodiversity issues cazalis et al 2018 mitchell 2013 verifying their contribution to sustainability also in terms of sdgs eyhorn et al 2019 some emerging studies are providing evidence of the feasibility of agro ecological agriculture by adopting a rounded approach to the food system which integrates farming practices consumption and dietary patterns aspects garnett et al 2013 hunter et al 2017 muller et al 2017 galli et al 2020 in this context the contribution of this study is to investigate organic agriculture oa viability in comparison to conventional agriculture ca taking into account different aspects of the production and consumption processes the following main aspects of the food systems are considered farming practices organic biodynamic or conventional agriculture farm typologies mixed vs specialised farms and dietary diversity in order to assess whether and under which conditions organic agriculture shows feasibility in terms of land needed to address food security issues for this purpose the land footprint approach is applied in order to assess the land needed to meet the local population demand of food under different combinations of diet farm typology and farming practices the land footprint refers to the land used to produce the goods and services devoted to satisfy the domestic final demand of a country regardless of the country where this land was actually used arto et al 2012 the land food footprint lff is the quantification of the per capita utilised agricultural area uaa needed to feed the local population and it is essential in order to integrate food security into sustainable agriculture objectives according to the world bank 2014 the value of arable land per person in europe is equal to 0 2 hectare whereas in italy equals 0 1 hectare per person hence the agricultural land scarcity is an emerging problem that food policy needs to address in attaining sustainability the purpose of this study is to assess the amount of land that oa and ca need to satisfy the food demand of the population of tuscany region italy taking into account the nexus of diet the research questions are i what would be the impact of a transition of the farming systems toward oa in terms of agricultural land availability and ii could shifts in the dietary habits and or farm typologies reduce the gap between oa and ca in terms of land food footprint land food footprints for organic and conventional agriculture are assessed on the basis of three different hypothetical diet scenarios plus the status quo diet for all these scenarios specific crop rotation schemes and farm typology for both organic and conventional agriculture are considered the different production and consumption patterns can affect the gap between organic and conventional agriculture in terms of land needed 2 materials and methods in this paper a land footprint approach is adopted in order to assess the food system sustainability as expressed by o brien et al 2015 it is necessary to distinguish between the ecological footprint and land footprint ecological footprint theoretically measures the land area used needed to supply resource consumption and absorb emissions according to o brien et al 2015 and bruckner et al 2014 land footprint as a metric to asses actual land needed to meet specific good demand has only recently been widely implemented using biophysical economic or hybrid accounting methods in particular the biophysical approach assesses the land food footprint lff on the basis of land productivity expressed by yield tonnes per hectare or by a conversion rate providing the amount of a given crop land needed to obtain one unit kg of the consumed food meat milk etc the economic approach accounts the land footprint as different monetary values of the products obtained by the harvest of each considered hectare the hybrid methods combine the biophysical and the economic approach the land footprint approach is used to investigate the change of land footprint over time bosire et al 2015 de ruiter et al 2017 kastner et al 2012 and the differences between land availability and demand land flows at different scales in order to assess land use sustainability and inequality between regions or countries moreover the conservation of local food systems is increasingly recognised as a key factor in the pursuit of sustainable and resilient settlement systems dealing with reallocation of energy and materials flows in a circular economy perspective alexander et al 2015 in their study provide an evaluation of land food footprint with a top down approach based on the agricultural land use and its productivity in terms of capacity of supplying food qiang et al 2013 adopted a bottom up method using trade quantities for each product following qiang et al 2013 this study adopts a bottom up approach based on a consumption oriented methodology that considers the land needed to sustain the per capita annual food consumption of an individual of a given population in this research individual land food footprint of the per capita consumption of meat milk pasta and bread are assessed applying a demand side approach instead of a supply side approach consumption data sources are assocarni for meat assocarni 2015 fao for milk faostat 2014a ismea for pasta ismea 2014 and coldiretti for bread coldiretti 2015 these food typologies are selected because they embody the major food groups in local diet according to de boer et al 2006 meat cereals and milk provide the main part of european dietary proteins in particular in 2013 in italy meat cereals and milk provided the 74 of the total protein intake faostat 2014b and the 54 of the total calorie intake faostat 2014c fig 1 of the italian diet in addition livestock and wheat constitute the two main agricultural production systems istat 2010 data on regional yield of organic and conventional crops are used then a food and feed conversion ratio fcr is applied in order to assess the amount of agricultural land needed to supply one kilogram of each consumed food type different types of land use are considered croplands used to produce crops for human food and grassland croplands used to produced one kilogram of animal product meat and milk the conversion rate of raw materials into edible products through the primary e g milling and secondary processing e g baking is also accounted for an example of the land food footprint approach adopted in this study is presented in fig 2 with reference to animal products this study considers different animals ruminants and non ruminants and a specific conversion rate for each production level according to the approach suggested by de ruiter et al 2017 while de ruiter et al 2017 use the same feed composition amongst different livestock system this study differentiates diet composition in function of species genotype and type of production milk or meat yields of crops used for animal feed expressed in tons of dry matter dm per hectare are reported in table 1 istat 2010 rica rete di informazione contabile agricola 2014 both in oa and ca systems for animal products the specific rearing practices of tuscany farms and their traditional rearing systems are considered simulating two different patterns for organic and conventional rearing practices for the organic rearing system the requirements of reg ce 834 2007 and subsequent changes are taken into account in the conventional animal rearing system indoor rearing is considered whereas for the organic system this study assumes outdoor rearing at least for a part of the animals life and more specifically en plein air rearing systems are adopted for pigs for each animal species a specific feeding system based on cereals and forage is hypothesised for cattle the grassland required for their diet is taken into account both directly pasture and indirectly hay whereas the diets of monogastric animals e g chickens and pigs mainly consist of cereals the nutrient requirements the nutritional value and the ingredients of the diet are computed according to the national institute of agricultural research inra institut national de la recherche agronomique 1988 based on milk and meat forage unit for cattle and poultry whereas for pig nutritional values of the national research council nrc national research council 2012 are applied regional demand of meat is assumed to be supplied by dairy husbandry for the 50 and by cattle husbandry for the rest in accordance with data provided by the national agricultural census in the regional livestock statistics section istat 2010 for the meat supplied by meat cattle autochthonous and french breeds are taken into account as well as the feed requirements for young bulls and cows including the heifers for meat obtained by dairy husbandry the feed requirements and the feed ingested by young bulls were considered while the feed assigned to cows was accounted for in milk production in the organic system natural pasture feed is considered for milk production the quantity of feed directly ingested by dairy cows plus a quota of feed ingested by heifer is considered in this case differences between organic and conventional system are mainly due to the quantity of milk that is produced the fat content of milk and the number of lactations per heifer for pigs feeds for sows weighted on number of produced piglets are considered nrc national research council 2012 in poultry this evaluation has not been done since the feeds ingested by poultry breeder are negligible respect to the number of chicks born per hen the main differences between organic and conventional systems are due to slaughter key parameters such as weight age yield but they are also due to the average daily gains for cows and heifers comparing the two systems organic and conventional both the length of productive life and the number of calves produced differs as well as the number of piglets born for sows in oa and ca feed conversion rate is applied to measure the amount of feed needed to produce one kilogram of animal product nevertheless the amount of feed consumed by breeding animals such as the heifer is also considered in the conversion rate because it has final impact on each kilogram of animal product supplied by the whole production cycle table 2 shows differences between the fcrs of the considered farming systems expressed in kg of dry matter dm for kg of animal product considering all rearing phases for ruminants the difference in diet composition is affected by a fcr which varies in function of different fibre contents in pig and poultry species feed differences between oa and ca are mainly due to the fcr and breeding factors the total amount of diet intake of animal protein is multiplied by its respective conversion ratio to obtain the total amount of crops yield needed to fulfil the diet requirements then the crops yield values are used to assess the land needed to supply the amount of consumed animal food and to define lff for animal protein consumption the whole agricultural production cycle for each key food category including crops rotation is considered as well as all the necessary inputs to produce meat and milk taking into account the full animal chain from cow breeding to calf food waste is not considered in the assessment since it is included in the consumption values also regional import and export of food have not been considered specifically the agricultural area necessary to produce one kilogram of a cereal product is defined by the following eq 1 1 a r e a i f c r i y i e l d i where f c r i and y i e l d i are respectively the food conversion ratio and yield for crop i area for livestock products was computed through a slightly different eq 2 which allows to consider all h ingredients of the diet of the livestock product i 2 a r e a i i 1 k j 1 h f c r i c r o p r e q u i r e m e n t j y i e l d j where a r e a i is expressed as the sum of areas needed to feed the animal i with the h types of crop required for its diet considering both the yield of crop j and a specific feed to food conversion for livestock product i then the land food footprint for the generic item i l f f i is calculated as in 3 l f f i a r e a i c o n s u m p t i o n i land food footprint per capita l f f p c is finally computed as the sum of the land food footprint for the k considered items 4 l f f p c i 1 k l f f i as shown in fig 3 three different land uses are assumed cropland for food cropland for feed and grassland in the rotation pattern two different patterns for organic and conventional agricultural practices are simulated table 3 farm typologies are considered assuming specialised farms crops farms or animal farms and mixed farms crops and animal farms in which wheat is in rotation with feed in this situation the land utilised for feed purposes supplying the meat or milk production systems is accounted for in protein production meat and milk thus reducing the amount of lff for wheat production since meet and milk are obtained as side products of farm crops then as presented in section 1 the individual lff was calculated under four diet scenarios three of which express variation in the amount of animal protein intake and one of these considers an animal protein intake tailored on the agricultural producing capacity in the oa and ca farming systems characterised by differences in rotation patterns farm practises and typologies the four scenarios are as follow i status quo based on the italian average per capita consumption of the selected food items ii diet change with a 50 reduction in animal protein consumption iii sustainable diet related to mixed farming assuming agricultural productivity as a diet constraint iv vegan diet with only vegetable proteins these assumptions are in line with some studies and institutions e g fao and the chinese government stressing the need to reduce meat consumption bryngelsson et al 2016 fcnr 2018 milman and leavenworth 2016 westhoek et al 2014 the third scenario named sustainable diet constrains the diet to be compatible with a sustainable production system as the meat that can be included in the diet is limited to the amount that can be produced using the portion of land set aside by cereals in rotation the amount of meat and milk consumption are converted into protein supply considering for each food type the protein content provided by the usda united states department of agriculture food composition databases usda 2018 then for each of the three scenarios requiring a reduction of meat consumption the meat protein intake is replaced by an equivalent amount of proteins provided by vegetable food such as peas chickpeas lentils and beans the obtained regional land food footprints for each scenario and for oa and ca are then compared to each other and with tuscany available land uaa split into the different available land uses in order to assess the regional land balance 3 results and discussion the regional lff for the status quo scenario shows differences in terms of land balance when compared with available regional uaa istat 2010 and in terms of gap between oa and ca table 4 and 5 in the status quo oa needs in total 34 more land than ca table 5 the regional lff for oa requires almost four times the regional uaa while ca accounts for around the double of uaa the gap between oa and ca varies with respect to each food category for cereals oa needs 14 more land than ca 13 for bread lff and 14 for pasta lff in oa table 5 bread and pasta account for 8 of the total lff while the ca lff for cereals consumption accounts for the 11 of the total lff per capita oa lff for animal products needs 36 more land than ca the values range between the 25 more land for organic pork to 49 for organic poultry the oa lff for animal protein accounts for 92 of the total lff per capita beef lff is the 28 of the total lff pork consumption represents the 23 and poultry accounts for the 13 of the total land food footprint ca animal lff represents the 89 of the total assessed per capita lff beef consumption has the highest lff with the 29 of the lff per capita table 4 and 5 also show the protein and calorie conversion efficiency in ca meat and milk on average provide 146 kg of proteins per hectare and 1829 mega calories mcal per hectare cereals are more efficient providing 355 kg of proteins per hectare and 9076 mcal per hectare in oa animal products provide 88 kg ha of proteins and 1130 mcal ha whereas wheat products provide 308 kg ha of proteins and 7872 mcal ha both in ca and oa bread is the most efficient product in the provision of protein and calorie per hectare amongst animal products milk is the most efficient and beef is the least efficient with reference to the gaps between lff and available land tables 4 and 5 describe a similar situation for ca and oa considering ca the worst land unbalance is due to grassland needed for animal feed whose lff is more than four times greater than the available pasture 137 879 and crop area it must be noted that differently from meat and milk the sum of cereals uaa area in tuscany exceeds for 48 765 hectares the pasta and bread ca lff for cereals there is export of virtual land for durum wheat and import of virtual land for soft wheat this underlines that changes in agricultural management towards the typology of mixed farms could potentially address the unbalance between bread ca lff and available agricultural land by increasing soft wheat cultivated area these results underline the potentiality of agro ecological systems both organic and biodynamic agriculture in terms of food security targets under sustainable nutrition scenarios reduced consumption of animal protein or vegetarian diet in fact those agricultural systems based on mixing animal and crop production in a circular economy perspective show a stronger effect in term of land use efficiency since the complexity and length of their rotation patterns allow animal protein production as secondary products of cereals production these effects are higher if diet choices are based on agricultural carrying capacity and animal protein consumption is sized on the amount of animal protein produced by cereal rotation for ca the land displacement at regional level is relative to animal food lff a similar situation is depicted for oa there is an unbalance between available land and meat milk and bread lff whereas for pasta lff the locally available agricultural land is sufficient to satisfy the local demand for oa the balance between bread and pasta lff and available land would be positive at regional level by shifting agricultural area from durum to soft wheat considering in detail the meat and milk lff composition it can be noted that the temporary grass both in ca and oa represents more than 60 of the total table 7 concentrated livestock feed is locally obtained by maize barley and soybean replaced by field bean in the oa system the percentage of incidences of crops assigned to animal feed i e maize barley and soybean field bean on land use are always lower than 19 organic farms require more land to sustain animal production due to different motivations the lower yields of crops the higher use of pasture the replacement of soybean with field bean and the lower fcr used the second scenario diet change with reduced consumption of animal protein shows a greater lff reduction for oa than for ca table 8 compared to the status quo scenario in fact the greater land requirements for livestock products produce a greater impact on organic consumption shrinking the gap between the two farming systems fig 4 results of this scenario show that a 50 reduction of animal proteins would bring the oa lff very close to the ca lff under the status quo respectively the oa lff is 0 1823 ha per capita whereas the ca lff equals to 0 1819 ha per capita this suggests that animal protein substitution by vegetable protein would allow oa to ensure food security nevertheless the gap between oa and ca lff within this scenario is still around 30 with reference to the sustainable diet scenario based on a mixed farming system productivity a relevant reduction in the gap between oa and ca lff from 34 to 21 respectively about 40 lower than the ca lff for the status quo scenario is found this result underlines that sustainable agriculture viability asks for a societal transition towards sustainable diet as shown in table 6 available land in rotation per capita is greater for oa than for ca due to different rotation patterns for the two production methods consequently a greater amount of meat and then of protein is produced with oa 15 kg around 0 2 kg per week per person compared to ca 13 kg it is interesting to note that this amount of meet 0 2 kg per week per person is almost the quantity traditionally assumed in the mediterranean diet shaped on local agriculture features with reference to the fourth scenario vegan diet results show that there is a greater reduction in organic lff 68 than in conventional lff 59 shrinking the gap between the two farming systems with only 16 of more land for organic production fig 4 showing the role of diet in affecting sustainability of farming systems it must be noted that the oa lff in this scenario is 51 lower than the ca lff under the status quo scenario results of this study suggests that organic agriculture capability of supplying food to a given population is heavily reliant on diet habits stating a strong nexus of lff with diet sustainability of farming system is linked to change in consumption patterns towards healthier more conscious and responsible choices in terms of trade off between consumption of vegetal and animal proteins the dietary approach to lff provides an insight on the performance of oa in terms of food security assurance under specific dietary patterns the oa land footprint is lower than the current ca land footprint implying that changes in animal protein consumption would be required for oa to represent a viable answer toward sustainable food systems even in the perspective of a growing global population consistently with muller et al 2017 this study confirms that organic agriculture needs more land than conventional production systems so that its viability depends on the transition towards sustainable diet choices in the analysis of these results it is important to bear in mind two elements the first which represents the main limitation of this study is the reliability of data sources land food footprint assessment is extremely sensitive to yield and consumption data and these values vary considerably from one source to another future research could help in determining more robust results the second element that should be noted is that land food footprint measures virtual land imports and exports consequently the contribution of this approach in considering regionally based food security should not be interpreted in terms of autarky but regarded as the advantages of a shorter supply chain which allows to reduce fossil fuel consumptions in food transports 4 conclusions the main contribution of this paper is to underline the role of farm typologies and diet changes in the pursuit of sustainability and food security targets the nexus of diets in fact reveals that oa under specific dietary patterns may require less land than ca under current dietary patterns the study provides evidence that the gap between oa and ca can be reduced with dietary shifts up to a small gap that can be easily faced by research efforts in terms of oa dedicated to crop breeding and technological innovation currently oa farms use almost the same crops of ca but cannot use the same external inputs as ca the most significant advantages of the organic rearing system are linked to the improvement of animal welfare less stress on animals fewer breeding problems and longer productive lives that is even truer in relation to well managed organic farms where high quality forages and grazing systems are adopted in this perspective a central role is played by crop and animal breeding research in selecting crop varieties and animals allowing higher yields under oa conditions and thus pursuing sustainable productivity of agriculture likewise more sustainable livestock production techniques are to be found and adopted avoiding competition with food crops and enhancing resource use efficiency and reuse of food waste as feed in a circular economy perspective in addition reduction of food waste can improve oa performance in terms of lff this study suggests that the transition towards organic agriculture asks for the integration of several strategies and policies in a systemic approach considering production and consumption issues in the implementation of horizontal policies the diet nexus approach provides insights for policy makers in terms of actions required to promote dietary changes as a key tool to promote healthy diet habits sustainable agriculture and food security at global level transition towards sustainable agriculture implies rethinking the food systems as well as consumption habits and dietary patterns this would allow to internalise sustainability goals into the demand side involving all food chain stages from farm to fork the application of these approaches calls for the integration of a demand side policy into health agricultural and environmental policies implementing communication and education strategy to fasten transition towards sustainable food consumption as a necessary step for the viability of agro ecological systems the dietary shift scenarios show indeed that organic agriculture may fulfil food security if measures to reduce meat consumption and food waste are undertaken and if innovation efforts are addressed to develop organic agriculture specific techniques and to select genetic material more suitable for a sustainable intensification of organic agriculture further research is needed to better explore the role of traditional diets and biodiversity in ensuring food security and sustainable agriculture viability credit authorship contribution statement g v lombardi project administration conceptualization investigation methodology formal analysis writing original draft writing review editing supervision funding acquisition silvia parrini investigation formal analysis data curation writing review editing r atzori investigation methodology formal analysis data curation visualization writing original draft writing review editing g stefani writing review editing d romano writing review editing m gastaldi writing review editing g liu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors are grateful for support and funding from uniser 
24561,urban population growth has raised concerns about food security agricultural systems are asked to satisfy a growing demand of food while addressing sustainability issues and facing resources constraints ecological footprints are widespread instruments for the study of human impact and dependence on natural resources amongst these tools land food footprint lff is used to measure the land actually used to produce the food needed to satisfy the demand of a given region or country understanding the differences between alternative production methods and the gaps between available and needed land is a crucial issue in order to integrate food security and sustainability issues into the food system the objective of this study is to analyse the land food footprint of tuscany italy for both organic and conventional agriculture taking into account the nexus of diet in this aim land food footprint for the considered production processes is assessed under four different diet scenarios with different levels of animal protein consumption the study suggests that the gap between land needed by organic and conventional agriculture varies considerably between vegetable and animal products it confirms that organic agriculture needs more land than conventional one but the gap between land footprints shrinks because of dietary changes in this study the most important finding is that organic agriculture might feed the case study population if the diet shifts towards a reduced intake of animal protein in fact with a diet reduction of 50 in animal proteins the organic land food footprint value is equal to the conventional land food footprint under the status quo diet scenario indicating that organic agriculture would be able to address food security issues if food consumption was properly adapted to agriculture carrying capacity graphical abstract image graphical abstract keywords sustainable food system land food footprint diet nexus organic agriculture food security 1 introduction the world s population is growing rapidly world s concerns about run away population growth have raised the debate about natural resource carrying capacity for human life the population in urban settlement has shifted from 746 million of 1950 to 4 3 billion of 2020 representing the 56 of the total population in italy the 71 of population lives in urban areas world bank 2020 people migration from the countryside increases food demand and it can be associated to a higher likelihood of farmers losing their lands to urbanisation thus leading to a loss of cultivated land it is estimated that 2050 agricultural production would need to increase by a 50 to meet food demand of a global population assessed up to 9 billion people alexandratos and bruinsma 2012 the challenge of agriculture is to feed an increasing world population with a finite and degraded agricultural land agriculture intensification is traditionally thought as the unique strategy to attain food security goals at global level bengochea paz et al 2020 in fact during the last decades the increasing food demand has been met by increasing crop yields through the implementation of high inputs industrialised farming practices following the green revolution approach borlaug 2000 as a consequence the food system is increasingly contributing to environmental degradation and resource depletion both at local and global level hanson et al 2008 hu et al 2017 guyomard et al 2011 montoya et al 2020 food policies urgently need to face the problems of natural resources scarcity and sustainability of food production consumption systems in order to ensure the viability of a sustainable food system agricultural productivity needs to be coupled with resource conservation and health protection bengochea paz et al 2020 muller et al 2017 tilman et al 2002 walters et al 2016 fulfilling the sustainable development goals sdgs agro ecological farming systems could represent a valid solution to attain agriculture sustainability but its role in ensuring world food security is still discussed connor 2018 rockström et al 2017 the debate around the viability of agro ecological farming systems is arising since food security targets are usually associated with high yield intensive agriculture reganold et al 2016 tuomisto et al 2012 power 2010 as organic and biodynamic agriculture yields are lower than those of conventional agriculture more land is necessary for organic agriculture to produce the same amount of food as the conventional one seufert et al 2012 in addition lower productivity implies less output per amount of cultivated area and less environmental advantages if calculated per amount of food supplied rather than per agricultural area meier et al 2015 several research studies have investigated different aspects of organic agriculture including its environmental performances reganold and wachter 2016 neely and fynn 2012 schader et al 2012 soil nutrient and fertility aspects badgley et al 2007 or agro ecological farming contribution in terms of ecological services and biodiversity issues cazalis et al 2018 mitchell 2013 verifying their contribution to sustainability also in terms of sdgs eyhorn et al 2019 some emerging studies are providing evidence of the feasibility of agro ecological agriculture by adopting a rounded approach to the food system which integrates farming practices consumption and dietary patterns aspects garnett et al 2013 hunter et al 2017 muller et al 2017 galli et al 2020 in this context the contribution of this study is to investigate organic agriculture oa viability in comparison to conventional agriculture ca taking into account different aspects of the production and consumption processes the following main aspects of the food systems are considered farming practices organic biodynamic or conventional agriculture farm typologies mixed vs specialised farms and dietary diversity in order to assess whether and under which conditions organic agriculture shows feasibility in terms of land needed to address food security issues for this purpose the land footprint approach is applied in order to assess the land needed to meet the local population demand of food under different combinations of diet farm typology and farming practices the land footprint refers to the land used to produce the goods and services devoted to satisfy the domestic final demand of a country regardless of the country where this land was actually used arto et al 2012 the land food footprint lff is the quantification of the per capita utilised agricultural area uaa needed to feed the local population and it is essential in order to integrate food security into sustainable agriculture objectives according to the world bank 2014 the value of arable land per person in europe is equal to 0 2 hectare whereas in italy equals 0 1 hectare per person hence the agricultural land scarcity is an emerging problem that food policy needs to address in attaining sustainability the purpose of this study is to assess the amount of land that oa and ca need to satisfy the food demand of the population of tuscany region italy taking into account the nexus of diet the research questions are i what would be the impact of a transition of the farming systems toward oa in terms of agricultural land availability and ii could shifts in the dietary habits and or farm typologies reduce the gap between oa and ca in terms of land food footprint land food footprints for organic and conventional agriculture are assessed on the basis of three different hypothetical diet scenarios plus the status quo diet for all these scenarios specific crop rotation schemes and farm typology for both organic and conventional agriculture are considered the different production and consumption patterns can affect the gap between organic and conventional agriculture in terms of land needed 2 materials and methods in this paper a land footprint approach is adopted in order to assess the food system sustainability as expressed by o brien et al 2015 it is necessary to distinguish between the ecological footprint and land footprint ecological footprint theoretically measures the land area used needed to supply resource consumption and absorb emissions according to o brien et al 2015 and bruckner et al 2014 land footprint as a metric to asses actual land needed to meet specific good demand has only recently been widely implemented using biophysical economic or hybrid accounting methods in particular the biophysical approach assesses the land food footprint lff on the basis of land productivity expressed by yield tonnes per hectare or by a conversion rate providing the amount of a given crop land needed to obtain one unit kg of the consumed food meat milk etc the economic approach accounts the land footprint as different monetary values of the products obtained by the harvest of each considered hectare the hybrid methods combine the biophysical and the economic approach the land footprint approach is used to investigate the change of land footprint over time bosire et al 2015 de ruiter et al 2017 kastner et al 2012 and the differences between land availability and demand land flows at different scales in order to assess land use sustainability and inequality between regions or countries moreover the conservation of local food systems is increasingly recognised as a key factor in the pursuit of sustainable and resilient settlement systems dealing with reallocation of energy and materials flows in a circular economy perspective alexander et al 2015 in their study provide an evaluation of land food footprint with a top down approach based on the agricultural land use and its productivity in terms of capacity of supplying food qiang et al 2013 adopted a bottom up method using trade quantities for each product following qiang et al 2013 this study adopts a bottom up approach based on a consumption oriented methodology that considers the land needed to sustain the per capita annual food consumption of an individual of a given population in this research individual land food footprint of the per capita consumption of meat milk pasta and bread are assessed applying a demand side approach instead of a supply side approach consumption data sources are assocarni for meat assocarni 2015 fao for milk faostat 2014a ismea for pasta ismea 2014 and coldiretti for bread coldiretti 2015 these food typologies are selected because they embody the major food groups in local diet according to de boer et al 2006 meat cereals and milk provide the main part of european dietary proteins in particular in 2013 in italy meat cereals and milk provided the 74 of the total protein intake faostat 2014b and the 54 of the total calorie intake faostat 2014c fig 1 of the italian diet in addition livestock and wheat constitute the two main agricultural production systems istat 2010 data on regional yield of organic and conventional crops are used then a food and feed conversion ratio fcr is applied in order to assess the amount of agricultural land needed to supply one kilogram of each consumed food type different types of land use are considered croplands used to produce crops for human food and grassland croplands used to produced one kilogram of animal product meat and milk the conversion rate of raw materials into edible products through the primary e g milling and secondary processing e g baking is also accounted for an example of the land food footprint approach adopted in this study is presented in fig 2 with reference to animal products this study considers different animals ruminants and non ruminants and a specific conversion rate for each production level according to the approach suggested by de ruiter et al 2017 while de ruiter et al 2017 use the same feed composition amongst different livestock system this study differentiates diet composition in function of species genotype and type of production milk or meat yields of crops used for animal feed expressed in tons of dry matter dm per hectare are reported in table 1 istat 2010 rica rete di informazione contabile agricola 2014 both in oa and ca systems for animal products the specific rearing practices of tuscany farms and their traditional rearing systems are considered simulating two different patterns for organic and conventional rearing practices for the organic rearing system the requirements of reg ce 834 2007 and subsequent changes are taken into account in the conventional animal rearing system indoor rearing is considered whereas for the organic system this study assumes outdoor rearing at least for a part of the animals life and more specifically en plein air rearing systems are adopted for pigs for each animal species a specific feeding system based on cereals and forage is hypothesised for cattle the grassland required for their diet is taken into account both directly pasture and indirectly hay whereas the diets of monogastric animals e g chickens and pigs mainly consist of cereals the nutrient requirements the nutritional value and the ingredients of the diet are computed according to the national institute of agricultural research inra institut national de la recherche agronomique 1988 based on milk and meat forage unit for cattle and poultry whereas for pig nutritional values of the national research council nrc national research council 2012 are applied regional demand of meat is assumed to be supplied by dairy husbandry for the 50 and by cattle husbandry for the rest in accordance with data provided by the national agricultural census in the regional livestock statistics section istat 2010 for the meat supplied by meat cattle autochthonous and french breeds are taken into account as well as the feed requirements for young bulls and cows including the heifers for meat obtained by dairy husbandry the feed requirements and the feed ingested by young bulls were considered while the feed assigned to cows was accounted for in milk production in the organic system natural pasture feed is considered for milk production the quantity of feed directly ingested by dairy cows plus a quota of feed ingested by heifer is considered in this case differences between organic and conventional system are mainly due to the quantity of milk that is produced the fat content of milk and the number of lactations per heifer for pigs feeds for sows weighted on number of produced piglets are considered nrc national research council 2012 in poultry this evaluation has not been done since the feeds ingested by poultry breeder are negligible respect to the number of chicks born per hen the main differences between organic and conventional systems are due to slaughter key parameters such as weight age yield but they are also due to the average daily gains for cows and heifers comparing the two systems organic and conventional both the length of productive life and the number of calves produced differs as well as the number of piglets born for sows in oa and ca feed conversion rate is applied to measure the amount of feed needed to produce one kilogram of animal product nevertheless the amount of feed consumed by breeding animals such as the heifer is also considered in the conversion rate because it has final impact on each kilogram of animal product supplied by the whole production cycle table 2 shows differences between the fcrs of the considered farming systems expressed in kg of dry matter dm for kg of animal product considering all rearing phases for ruminants the difference in diet composition is affected by a fcr which varies in function of different fibre contents in pig and poultry species feed differences between oa and ca are mainly due to the fcr and breeding factors the total amount of diet intake of animal protein is multiplied by its respective conversion ratio to obtain the total amount of crops yield needed to fulfil the diet requirements then the crops yield values are used to assess the land needed to supply the amount of consumed animal food and to define lff for animal protein consumption the whole agricultural production cycle for each key food category including crops rotation is considered as well as all the necessary inputs to produce meat and milk taking into account the full animal chain from cow breeding to calf food waste is not considered in the assessment since it is included in the consumption values also regional import and export of food have not been considered specifically the agricultural area necessary to produce one kilogram of a cereal product is defined by the following eq 1 1 a r e a i f c r i y i e l d i where f c r i and y i e l d i are respectively the food conversion ratio and yield for crop i area for livestock products was computed through a slightly different eq 2 which allows to consider all h ingredients of the diet of the livestock product i 2 a r e a i i 1 k j 1 h f c r i c r o p r e q u i r e m e n t j y i e l d j where a r e a i is expressed as the sum of areas needed to feed the animal i with the h types of crop required for its diet considering both the yield of crop j and a specific feed to food conversion for livestock product i then the land food footprint for the generic item i l f f i is calculated as in 3 l f f i a r e a i c o n s u m p t i o n i land food footprint per capita l f f p c is finally computed as the sum of the land food footprint for the k considered items 4 l f f p c i 1 k l f f i as shown in fig 3 three different land uses are assumed cropland for food cropland for feed and grassland in the rotation pattern two different patterns for organic and conventional agricultural practices are simulated table 3 farm typologies are considered assuming specialised farms crops farms or animal farms and mixed farms crops and animal farms in which wheat is in rotation with feed in this situation the land utilised for feed purposes supplying the meat or milk production systems is accounted for in protein production meat and milk thus reducing the amount of lff for wheat production since meet and milk are obtained as side products of farm crops then as presented in section 1 the individual lff was calculated under four diet scenarios three of which express variation in the amount of animal protein intake and one of these considers an animal protein intake tailored on the agricultural producing capacity in the oa and ca farming systems characterised by differences in rotation patterns farm practises and typologies the four scenarios are as follow i status quo based on the italian average per capita consumption of the selected food items ii diet change with a 50 reduction in animal protein consumption iii sustainable diet related to mixed farming assuming agricultural productivity as a diet constraint iv vegan diet with only vegetable proteins these assumptions are in line with some studies and institutions e g fao and the chinese government stressing the need to reduce meat consumption bryngelsson et al 2016 fcnr 2018 milman and leavenworth 2016 westhoek et al 2014 the third scenario named sustainable diet constrains the diet to be compatible with a sustainable production system as the meat that can be included in the diet is limited to the amount that can be produced using the portion of land set aside by cereals in rotation the amount of meat and milk consumption are converted into protein supply considering for each food type the protein content provided by the usda united states department of agriculture food composition databases usda 2018 then for each of the three scenarios requiring a reduction of meat consumption the meat protein intake is replaced by an equivalent amount of proteins provided by vegetable food such as peas chickpeas lentils and beans the obtained regional land food footprints for each scenario and for oa and ca are then compared to each other and with tuscany available land uaa split into the different available land uses in order to assess the regional land balance 3 results and discussion the regional lff for the status quo scenario shows differences in terms of land balance when compared with available regional uaa istat 2010 and in terms of gap between oa and ca table 4 and 5 in the status quo oa needs in total 34 more land than ca table 5 the regional lff for oa requires almost four times the regional uaa while ca accounts for around the double of uaa the gap between oa and ca varies with respect to each food category for cereals oa needs 14 more land than ca 13 for bread lff and 14 for pasta lff in oa table 5 bread and pasta account for 8 of the total lff while the ca lff for cereals consumption accounts for the 11 of the total lff per capita oa lff for animal products needs 36 more land than ca the values range between the 25 more land for organic pork to 49 for organic poultry the oa lff for animal protein accounts for 92 of the total lff per capita beef lff is the 28 of the total lff pork consumption represents the 23 and poultry accounts for the 13 of the total land food footprint ca animal lff represents the 89 of the total assessed per capita lff beef consumption has the highest lff with the 29 of the lff per capita table 4 and 5 also show the protein and calorie conversion efficiency in ca meat and milk on average provide 146 kg of proteins per hectare and 1829 mega calories mcal per hectare cereals are more efficient providing 355 kg of proteins per hectare and 9076 mcal per hectare in oa animal products provide 88 kg ha of proteins and 1130 mcal ha whereas wheat products provide 308 kg ha of proteins and 7872 mcal ha both in ca and oa bread is the most efficient product in the provision of protein and calorie per hectare amongst animal products milk is the most efficient and beef is the least efficient with reference to the gaps between lff and available land tables 4 and 5 describe a similar situation for ca and oa considering ca the worst land unbalance is due to grassland needed for animal feed whose lff is more than four times greater than the available pasture 137 879 and crop area it must be noted that differently from meat and milk the sum of cereals uaa area in tuscany exceeds for 48 765 hectares the pasta and bread ca lff for cereals there is export of virtual land for durum wheat and import of virtual land for soft wheat this underlines that changes in agricultural management towards the typology of mixed farms could potentially address the unbalance between bread ca lff and available agricultural land by increasing soft wheat cultivated area these results underline the potentiality of agro ecological systems both organic and biodynamic agriculture in terms of food security targets under sustainable nutrition scenarios reduced consumption of animal protein or vegetarian diet in fact those agricultural systems based on mixing animal and crop production in a circular economy perspective show a stronger effect in term of land use efficiency since the complexity and length of their rotation patterns allow animal protein production as secondary products of cereals production these effects are higher if diet choices are based on agricultural carrying capacity and animal protein consumption is sized on the amount of animal protein produced by cereal rotation for ca the land displacement at regional level is relative to animal food lff a similar situation is depicted for oa there is an unbalance between available land and meat milk and bread lff whereas for pasta lff the locally available agricultural land is sufficient to satisfy the local demand for oa the balance between bread and pasta lff and available land would be positive at regional level by shifting agricultural area from durum to soft wheat considering in detail the meat and milk lff composition it can be noted that the temporary grass both in ca and oa represents more than 60 of the total table 7 concentrated livestock feed is locally obtained by maize barley and soybean replaced by field bean in the oa system the percentage of incidences of crops assigned to animal feed i e maize barley and soybean field bean on land use are always lower than 19 organic farms require more land to sustain animal production due to different motivations the lower yields of crops the higher use of pasture the replacement of soybean with field bean and the lower fcr used the second scenario diet change with reduced consumption of animal protein shows a greater lff reduction for oa than for ca table 8 compared to the status quo scenario in fact the greater land requirements for livestock products produce a greater impact on organic consumption shrinking the gap between the two farming systems fig 4 results of this scenario show that a 50 reduction of animal proteins would bring the oa lff very close to the ca lff under the status quo respectively the oa lff is 0 1823 ha per capita whereas the ca lff equals to 0 1819 ha per capita this suggests that animal protein substitution by vegetable protein would allow oa to ensure food security nevertheless the gap between oa and ca lff within this scenario is still around 30 with reference to the sustainable diet scenario based on a mixed farming system productivity a relevant reduction in the gap between oa and ca lff from 34 to 21 respectively about 40 lower than the ca lff for the status quo scenario is found this result underlines that sustainable agriculture viability asks for a societal transition towards sustainable diet as shown in table 6 available land in rotation per capita is greater for oa than for ca due to different rotation patterns for the two production methods consequently a greater amount of meat and then of protein is produced with oa 15 kg around 0 2 kg per week per person compared to ca 13 kg it is interesting to note that this amount of meet 0 2 kg per week per person is almost the quantity traditionally assumed in the mediterranean diet shaped on local agriculture features with reference to the fourth scenario vegan diet results show that there is a greater reduction in organic lff 68 than in conventional lff 59 shrinking the gap between the two farming systems with only 16 of more land for organic production fig 4 showing the role of diet in affecting sustainability of farming systems it must be noted that the oa lff in this scenario is 51 lower than the ca lff under the status quo scenario results of this study suggests that organic agriculture capability of supplying food to a given population is heavily reliant on diet habits stating a strong nexus of lff with diet sustainability of farming system is linked to change in consumption patterns towards healthier more conscious and responsible choices in terms of trade off between consumption of vegetal and animal proteins the dietary approach to lff provides an insight on the performance of oa in terms of food security assurance under specific dietary patterns the oa land footprint is lower than the current ca land footprint implying that changes in animal protein consumption would be required for oa to represent a viable answer toward sustainable food systems even in the perspective of a growing global population consistently with muller et al 2017 this study confirms that organic agriculture needs more land than conventional production systems so that its viability depends on the transition towards sustainable diet choices in the analysis of these results it is important to bear in mind two elements the first which represents the main limitation of this study is the reliability of data sources land food footprint assessment is extremely sensitive to yield and consumption data and these values vary considerably from one source to another future research could help in determining more robust results the second element that should be noted is that land food footprint measures virtual land imports and exports consequently the contribution of this approach in considering regionally based food security should not be interpreted in terms of autarky but regarded as the advantages of a shorter supply chain which allows to reduce fossil fuel consumptions in food transports 4 conclusions the main contribution of this paper is to underline the role of farm typologies and diet changes in the pursuit of sustainability and food security targets the nexus of diets in fact reveals that oa under specific dietary patterns may require less land than ca under current dietary patterns the study provides evidence that the gap between oa and ca can be reduced with dietary shifts up to a small gap that can be easily faced by research efforts in terms of oa dedicated to crop breeding and technological innovation currently oa farms use almost the same crops of ca but cannot use the same external inputs as ca the most significant advantages of the organic rearing system are linked to the improvement of animal welfare less stress on animals fewer breeding problems and longer productive lives that is even truer in relation to well managed organic farms where high quality forages and grazing systems are adopted in this perspective a central role is played by crop and animal breeding research in selecting crop varieties and animals allowing higher yields under oa conditions and thus pursuing sustainable productivity of agriculture likewise more sustainable livestock production techniques are to be found and adopted avoiding competition with food crops and enhancing resource use efficiency and reuse of food waste as feed in a circular economy perspective in addition reduction of food waste can improve oa performance in terms of lff this study suggests that the transition towards organic agriculture asks for the integration of several strategies and policies in a systemic approach considering production and consumption issues in the implementation of horizontal policies the diet nexus approach provides insights for policy makers in terms of actions required to promote dietary changes as a key tool to promote healthy diet habits sustainable agriculture and food security at global level transition towards sustainable agriculture implies rethinking the food systems as well as consumption habits and dietary patterns this would allow to internalise sustainability goals into the demand side involving all food chain stages from farm to fork the application of these approaches calls for the integration of a demand side policy into health agricultural and environmental policies implementing communication and education strategy to fasten transition towards sustainable food consumption as a necessary step for the viability of agro ecological systems the dietary shift scenarios show indeed that organic agriculture may fulfil food security if measures to reduce meat consumption and food waste are undertaken and if innovation efforts are addressed to develop organic agriculture specific techniques and to select genetic material more suitable for a sustainable intensification of organic agriculture further research is needed to better explore the role of traditional diets and biodiversity in ensuring food security and sustainable agriculture viability credit authorship contribution statement g v lombardi project administration conceptualization investigation methodology formal analysis writing original draft writing review editing supervision funding acquisition silvia parrini investigation formal analysis data curation writing review editing r atzori investigation methodology formal analysis data curation visualization writing original draft writing review editing g stefani writing review editing d romano writing review editing m gastaldi writing review editing g liu writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors are grateful for support and funding from uniser 
24562,in a meta ecosystem spatially separated ecosystems are linked by biotic and abiotic cross ecosystem flows hence food webs in a meta ecosystem are functionally linked they are susceptible to multiple stressors threatening ecosystem functions and associated services although empirical studies can help understand stressor effects on meta ecosystem food webs they are often limited by their narrow spatial and temporal scales this limitation may be overcome by process based food web models which allow variable spatial and temporal scales we reviewed process based food web models and their application to aquatic terrestrial and theoretical meta ecosystems we refer to theoretical models as food web models based on theoretical considerations rather than describing a particular natural system we found nineteen aquatic terrestrial models that represented aquatic food webs with flows from terrestrial to aquatic ecosystems most of the aquatic terrestrial models can be applied to study the environmental stressors of eutrophication 15 models and climate change 10 models eight theoretical models were found that study ecosystem stability trophic cascades source sink dynamics co nutrient limitation and co existence of primary consumers the theoretical models are more similar in terms of types of state variables and model complexity i e number of state variables than the aquatic terrestrial models generally the applications of the models have shown that environmental changes cause cross scale effects on food webs in aquatic terrestrial and theoretical meta ecosystems finally we outline major research gaps regarding the directionality of cross ecosystem flows anthropogenic stressors and accessibility of models codes keywords ecology stressors environmental change meta ecosystems mechanistic understanding 1 introduction over the last decades ecology has increased our understanding of the significance of processes operating on multiple temporal and spatial scales loreau et al 2003 this resulted in the development of theoretical concepts like meta population levins 1969 meta community hanski and gilpin 1991 and meta ecosystem loreau et al 2003 which have enhanced environmental management actions schiesari et al 2019 the meta population and meta community concepts represent spatially structured populations of single or multiple species respectively linked by the flow of biotic components of the ecosystem however ecosystems are characterized by the cross ecosystem flows of both biotic and abiotic components polis et al 1997 therefore the meta ecosystem concept extends the meta population and meta community approach through explicit consideration of the cross ecosystem flows of abiotic and biotic components of ecosystems loreau et al 2003 for example aquatic emerging insects are food subsidies for many terrestrial consumers such as insects and birds whereas litter inputs from terrestrial ecosystems support productivity in adjacent aquatic ecosystems nakano and murakami 2001 sabo and power 2002 these aquatic terrestrial flows have the potential to affect top down and bottom up food web control menge et al 1997 thereby establishing the aquatic terrestrial interface richardson et al 2009 sabo and power 2002 and ensuring ecosystem functions trzcinski et al 2016 food webs especially at the aquatic terrestrial interface are affected by multiple anthropogenic stressors including climate change harper and peckarsky 2006 li et al 2011 mosner et al 2011 habitat degradation mikolajewski et al 2015 rowe and ludwig 1991 water pollution graf et al 2019 and invasive species baxter et al 2007 finlay and vredenburg 2007 mineau et al 2012 by anthropogenic stressor we mean any human pressure that causes a change in biological responses outside the range of their natural variation crain et al 2008 understanding the ecological effects of multiple anthropogenic stressors can be challenging because they can lead to non additive ecological responses such as antagonistic and synergistic responses côté et al 2016 empirical studies i e laboratory mesocosm and field studies focusing on meta ecosystems have deepened our understanding of multiple anthropogenic stressors effects on food webs e g mccormick et al 2020 however anthropogenic stressor interactions can change over time and spatial scale whereas most empirical studies focus on narrow temporal and spatial scales allesino 2020 leuzinger et al 2011 process based food web models can allow the prediction of anthropogenic stressor interactions and food web responses over variable temporal and spatial scales as well as the testing of hypotheses and mechanistic assumptions cramer et al 2001 cuddington et al 2013 they may thereby contribute to understanding the functioning of meta ecosystems filling and identifying observation gaps and developing management strategies considering that process based food web models are re usable a review of the type structure and code accessibility of existing models can inform their application for different research questions moreover a synthesis of the results from the application of process based food web models in meta ecosystems can inform the current understanding of meta ecosystems especially because recent reviews on meta ecosystems have focused on empirical studies specifically recent reviews focused on the effect of global change on resource flow between terrestrial and aquatic ecosystems larsen et al 2016 and the importance of alteration of aquatic ecological and biogeochemical linkages to the surrounding terrestrial ecosystems schulz et al 2015 we reviewed process based food web models applied to the aquatic terrestrial interface aquatic terrestrial models and theoretical meta ecosystems theoretical models by theoretical meta ecosystems we mean meta ecosystems where the system types are not explicitly stated we provide a general description of the models and analyze their similarity subsequently we summarize the results from the applications of the models finally we identify research gaps and derive recommendations for future research topics with process based food web models that may improve our understanding of food webs in meta ecosystems 2 0 material and methods we performed a literature search in june 2020 using the search engine isi web of knowledge supplemented by footnote chasing white 2009 the search was conducted in the advanced tab using the keywords ts meta ecosystem or meta population or meta community or aquatic to terrestrial or terrestrial to aquatic or aquatic terrestrial or terrestrial aquatic or aquatic to terrestrial or terrestrial to aquatic or meta habitat and model or simulation and subsid or linkage or coupl or organismal movement or migration or food web or trophic or dispersal the search returned 1009 publications we evaluated these 1009 publications based on the following criteria 1 contained process based food web models 2 focused on aquatic terrestrial or theoretical meta ecosystems 3 captured flows between the ecosystems by food web model we mean a model of organism groups within an ecosystem that are linked by trophic interactions this therefore includes food chains and food webs irrespective of their linkage to an abiotic component e g inorganic nutrients to quantify the similarity between models we conducted a similarity analysis following the method of janssen et al 2015 as in the analysis of ecological similarity between communities of two sites the method treats models as study sites and scores for the presence of state variables as if they were species the resulting binary table is analyzed for model similarity using the sørensen similarity index the index varies between 0 no overlap between the models and 1 models are completely identical supporting information 3 0 description of the models 3 1 general overview we found 19 aquatic terrestrial models developed to study how flows from terrestrial ecosystems affect aquatic food webs while none considered how flows from aquatic ecosystems affect terrestrial food webs fig 1 the models covered food web interactions in various marine and freshwater ecosystems eutrophication was the main application area of the aquatic terrestrial models 15 models while other application areas include climate change 10 models carbon cycle 8 models biodiversity loss 2 models toxicants 2 models invasive species 1 model residential development 1 model windstorm 1 model table 1 we found 8 theoretical models that were developed to study how cross ecosystem flows affect ecosystem stability 3 models trophic cascade 2 models source sink dynamics 1 model co nutrient limitation 1 model and the co existence of primary consumers 1 model table 1 individual organisms were not considered in both the aquatic terrestrial and theoretical models as they used the aggregate population approach which was implemented with either ordinary differential equations 25 models difference equations 1 model or structural dynamic equations 1 model a diversity of programming languages was used in coding the aquatic terrestrial and theoretical models matlab 5 models r 3 models fortran 3 models java 1 model delphi 2 models c c 2 models phyton 1 model pascal 1 model visual basic 1 model stella 1 model and advanced continuous simulation language 2 models of the 27 models i e 19 aquatic terrestrial and 8 theoretical models only 11 aquatic terrestrial models are publicly available and for 7 models the language was not reported supporting information 3 2 similarity of the models the aquatic terrestrial models had a mean similarity of 0 05 and a total of 850 unique state variables fig 2 a generic state variables such as dissolved oxygen phosphate particulate inorganic phosphorus zooplankton increased the similarity between the models considering the low similarity the existing aquatic terrestrial models cover a diverse set of ecosystems and food webs the minimum number of state variables per model was 4 carpentel et al 2016 and the maximum was 291 park et al 2008 the theoretical models had a mean similarity of 0 66 and a total of 19 unique state variables the number of state variables ranged from 6 to 10 fig 2b the high similarity of the theoretical models was expected as they do not specify particular organisms organism groups as state variables but categorize organism groups according to their function e g primary producers 4 0 application of the models sections 4 1 and 4 2 provide summary results of the application of some of the models in the application studies of the models simulations were done to study how general system components e g changes in predator composition and anthropogenic stressors e g eutrophication and warming affect food webs in meta ecosystems the aquatic terrestrial models were applied to study the effects of system components and anthropogenic stressors on food webs whereas the theoretical models were only applied to study the effect of changes in system components on food webs hereafter we refer to both changes in system component and in anthropogenic stressor as environmental change the studies that applied the aquatic terrestrial models in sections 4 1 and 4 2 were parameterized through field measurement experimental data or literature data while studies that applied the theoretical models were mostly parameterized through expert knowledge validation was also carried out for some of the aquatic terrestrial models application studies table 2 4 1 aquatic terrestrial models the application of some of the aquatic terrestrial models can be grouped into studies that applied the eutrophication models to investigate the effects of nutrient flows on the clear turbid state of lakes and studies that applied the non eutrophication models to investigate the effect of other stressors on the aquatic food web 4 1 1 effect of eutrophication on clear turbid state of lakes the eutrophication models contributed to our current understanding that food web interactions play an essential role in the distribution of nitrogen n and phosphorus p in lakes janse et al 1995 puijenbroek et al 2004 lakes are either in a clear macrophytes dominated or turbid phytoplankton dominated state both states are self stabilizing while the nutrient n and p levels at which a switch occurs from turbid to a clear state is much lower than the opposite switch hysteresis according to a model application by janse et al 1998 the critical nutrient level cnl for the transition of a lake between the turbid and clear states depends on both biological and physicochemical factors janse et al 2008 and could vary within a lake janssen et al 2017 the cnl for eutrophication cnleu i e switch from clear to turbid state decreases with an increase in bird herbivory janse et al 1998 temperature mooij et al 2007 2009 nielsen et al 2014 terrestrial particulate organic matter lischke et al 2014 lake fetch janse et al 2008 lake depth janse et al 2008 and a decrease in marsh area janse et al 2001 2008 or water levels janse et al 2008 kong et al 2016 the critical nutrient level for oligotrophication cnloligo i e switch from turbid to clear state decreases with an increase in terrestrial particulate matter lischke et al 2014 lake fetch janse et al 2008 and lake depth janse et al 2008 and a decrease in marsh area janse et al 2008 another model based study on remediation of turbid lakes predicts a reduction in the phosphorus carbon p c ratio of phytoplankton and detritus as a result of a reduction in p flux mobilization from the sediment janse and aldenberg 1990 resulting in p deficiency of algae janse and aldenberg 1991 the higher p c ratios of zooplankton and fish remained unchanged causing a delay in the response of the lake ecosystem to remediation measures janse and aldenberg 1990 1991 a high internal p recycling and assimilation efficiency of the phytoplankton can also cause a delay in lake response to remediation measures janse et al 1992 4 1 2 effect of other stressors on the aquatic food web atlas and palen 2014 roth et al 2007 and vasconcelos et al 2018 examined the effects of environmental change at different ecosystem response levels at the community level vasconcelos et al 2018 predicted that browning flow of terrestrially derived dissolved organic matter decreases benthic and increases pelagic primary production which leads to more pelagic primary and secondary consumers due to active habitat choice this increases the trophic cascade i e indirect top down food web control in the aquatic pelagic zone which was reduced by an increase in temperature due to higher temperature related loss of secondary consumers similarly atlas and palen 2014 predicted that an increase in the flow of terrestrial prey led to an increased trophic cascade in streams through higher secondary consumer biomass which was reduced by an increase in the proportion of armored prey in the stream food web at the population response level roth et al 2007 predicted that reduction of fallen trees into lakes caused by residential development led to a reduction of benthic invertebrate prey however an increase in fishing caused by increased proximity of residential areas led to an increase of benthic invertebrate prey whereas reduction of fallen trees into lakes caused by windstorm had little effect on lake food webs this can be attributed to the differences in the implementation of windstorm and residential development effects during model simulations both disturbances i e windstorm and residential development were initiated at year 50 of 300 year simulations however for residential development the thinning of adult trees occurred at a constant rate per year whereas for windstorm it was implemented as a single event of 65 windfall of adult trees one time pulse stressor beyond the effects of environmental change at various ecosystem response levels carpenter et al 2016 predicted that the effects of terrestrial flows were dependent on the lake trophic levels they predicted that p flow increased phytoplankton and zooplankton biomass however terrestrial particulate organic carbon tpoc decreased phytoplankton biomass and had a weak effect on zooplankton biomass the negative effect of tpoc on phytoplankton was due to increased shading caused by dissolved organic carbon overall the above studies show that stressors propagating from terrestrial ecosystems have cross scale effects on food webs in aquatic ecosystems furthermore model predictions by bellmore et al 2017 showed that strategies to restore aquatic food webs linked to terrestrial flows should consider the aquatic food web structure e g the presence of invasive species 4 2 theoretical models equilibrium and stability analysis are done to analyze food web models a food web model is in equilibrium if the state variables remain unchanged otto and day 2007 stability analysis on a food web model in equilibrium which is done by analyzing the dynamics of populations near equilibrium can inform on stabilizing or destabilizing effects of environmental change on the modelled system an environmental change destabilizes if it pushes the system away from equilibrium whereas it stabilizes if it pushes the system towards equilibrium otto and day 2007 at the ecosystem response level the theoretical models predicted that cross ecosystem flows of nutrients gounand et al 2014 marleau et al 2010 and detritus gounand et al 2014 destabilize meta ecosystems whereas the cross ecosystem flow of primary producers or primary consumers has either neutral or stabilizing effects gounand et al 2014 even though the cross ecosystem flow of primary consumers can stabilize meta ecosystems in combination with nutrients it can cause a destabilizing effect however the onset and spatial scale of the destabilizing effect depends on the meta ecosystem s spatial structure marleau et al 2014 overall according to models meta ecosystems were more stable at a combined cross ecosystem flow of nutrients primary producers primary consumers and detritus compared to a single flow gounand et al 2014 cross ecosystem flow also interacted with various meta ecosystem stabilizing or destabilizing characteristics for example meta ecosystems that are stabilized by ecosystems with different nutrient fertility are further stabilized by the cross ecosystem flow of primary consumers gounand et al 2014 meta ecosystems destabilized by local enrichments of nutrients can be stabilized if the cross ecosystem flow of primary producers or primary consumers are sufficiently strong to redistribute enrichment to the nutrient deficient ecosystem whereas meta ecosystems destabilized by regional enrichments of nutrients can only be stabilized by the intermediate cross ecosystem flow of primary consumers gounand et al 2014 gravel et al 2010 showed that the cross ecosystem flow of nutrients detritus primary producers or primary consumers can reverse the source sinks dynamics of meta ecosystems community level responses were also investigated marleau and guichard 2019 predicted that the cross ecosystem flow of primary consumers with nutrient recycling could generate spatial heterogeneity to allow the coexistence of primary producers where the well mixed system predicts competitive exclusion in terms of top down control in food webs the cross ecosystem flow of nutrients primary producers primary consumers or secondary consumer causes an increased top down control in the recipient ecosystem leroux and loreau 2008 meta ecosystems that exhibit reciprocally pulsed cross ecosystem flow of primary consumers lead to spatial and temporal variability in the strength of top down control in both local and meta ecosystems however top down control is strongest when the reciprocally pulsed cross ecosystem flow of primary consumers is temporally concentrated leroux and loreau 2012 overall similar to the application of the aquatic terrestrial models the above studies have shown that changes in cross ecosystem flows have cross scale effects on food webs in hypothetical meta ecosystems but their effects are often context dependent 5 0 outlook and recommendations in summary our study found that various process based food web models have been developed which has led to a greater understanding of aquatic terrestrial and meta ecosystems in general specifically the reviewed studies have provided predictions that can form the basis of experiments on the effects of environmental change on aquatic terrestrial and meta ecosystem food webs however relative to the theoretical models the aquatic terrestrial models provide a greater diversity of model state variables and complexity not surprisingly owing to its generality the theoretical models have been applied to study the effect of change in system components e g change in cross ecosystem flows heterogeneity of ecosystems not explicitly linked to an anthropogenic stressor on food webs in meta ecosystems in contrast the aquatic terrestrial models were also used to study anthropogenic stressors below we outline major research gaps that limit our understanding of food webs in an aquatic terrestrial interface or meta ecosystem context 5 1 flows and stressors from aquatic to terrestrial food webs the reviewed aquatic terrestrial models focused on how flows from terrestrial ecosystems affect aquatic food webs with none focusing on reciprocal flows similarly only anthropogenic stressors propagating from terrestrial ecosystems to aquatic food webs were considered for example the effects of the reduction in fallen trees caused by residential development and windstorm on lake food webs roth et al 2007 the focus on an aquatic ecosystem is not surprising as aquatic ecosystems generally receive higher cross ecosystem flows ballinger and lake 2006 power et al 2004 caused by the difference in terrain profiles the concave terrain profile of aquatic ecosystems makes them spatial attractors of many flows from terrestrial ecosystems due to gravity unlike the terrestrial ecosystems that exhibit convex terrain profiles consequently the effects of terrestrial flows on aquatic ecosystems have been a major theme in ecosystem ecology for decades likens 1992 schindler and smits 2016 however empirical studies have shown that physically and biologically mediated flows from aquatic ecosystems overcome gravity to affect terrestrial food webs schindler and smits 2016 schulz et al 2015 biologically mediated flows from aquatic to terrestrial ecosystems involve animal movements specifically such flows include the emergence of aquatic insects bartels et al 2012 muehlbauer et al 2014 richardson et al 2009 and the distribution of fish derived energy by foraging terrestrial predators helfield and naiman 2006 in the terrestrial ecosystem physically mediated flows from the aquatic ecosystem involve the movements of nutrients sediments and detritus through floods and subsurface water flows into terrestrial ecosystems schindler and smits 2016 schulz et al 2015 wölz et al 2011 empirical studies have also shown that anthropogenic stressors propagate from the aquatic ecosystem to terrestrial food webs through physically and biologically mediated pathways in the context of anthropogenic stressors propagation via physically mediated pathways dam construction reduces flood intensity and frequency beechie et al 2010 while channelization of an aquatic ecosystem can increase flow velocity leading to channel incision and reduction of flood events schindler and smits 2016 the effects on flood intensity and frequency can reduce adjacent terrestrial community composition li et al 2012 and plant density stave et al 2003 moreover a reduction in flood events can support the spread of less flood tolerant invasive species in an adjacent terrestrial ecosystem e g tamarax sp lovell et al 2009 examples of anthropogenic stressors propagating via biological mediated pathways include the reduction of the quantity of emerging insects or the bioaccumulation of pollutants in emerging insects with consequent effects on terrestrial food webs kraus et al 2014 kraus 2019 paetzold et al 2011 specifically species richness and the spider densities in affected terrestrial food webs can be reduced graf et al 2019 similarly artificial lights can affect emerging insects phenology and physiology perkin et al 2011 with a consequent effect on the composition of riparian predators and scavenger communities manfrin et al 2017 even though the impacts of flows and stressors from aquatic ecosystems on terrestrial food webs are now being quantified the impacts on terrestrial food web trophic interactions are understudied schindler and smits 2016 also the relative importance of physically and biologically mediated pathways in the propagation of anthropogenic stressors from aquatic to terrestrial ecosystems remains unclear for example quantitative comparisons between biologically and physically mediated pathways of the pollutant transport from aquatic to terrestrial ecosystems and associated effects on food webs are lacking schulz and bundschuh 2020 therefore process based food web modeling studies based on empirical evidence focusing on flows and anthropogenic stressors propagating from aquatic to terrestrial ecosystems could help in understanding the relative effects of biologically and physically mediated pathways on terrestrial food webs through model simulations they could also provide clarity on how aquatic to terrestrial anthropogenic stressors and effects on food webs change across various temporal and spatial scales moreover such studies will enable freshwater scientists to convey the relevance of their work to terrestrial managers sullivan and manning 2019 5 2 anthropogenic stressors affect the time space and quality characteristics of aquatic terrestrial flows the reviewed studies focused on how anthropogenic stressors affect the quantity of aquatic terrestrial flows however anthropogenic stressors can also shift the timing quality and spatial characteristics of such flows larsen et al 2016 and consequently affect the recipient s food web for example rising temperature can lead to early emergence and faster development of merolimnic insects harper and peckarsky 2006 reading 1998 and conceivably lead to temporal mismatches with the dietary need of terrestrial consumers similarly climate change can shift the distribution of species poleward e g riparian vegetation conceivably affecting recipient aquatic organisms e g stream detritivores through spatial mismatch doi 2008 in terms of resource quality climate warming of 2 5 c can reduce fatty acids 8 2 to 27 8 in algae hixson and arts 2016 which may indirectly affect terrestrial consumers via an altered nutritional quality of the aquatic subsidy in terms of merolimnic insects consequently future process based food web modeling studies should also focus on how anthropogenic stressors affect the above mentioned characteristics of aquatic terrestrial flows 5 3 models accessibility publicly sharing code increases the reproducibility and transparency of scientific studies gallagher et al 2020 mckiernan et al 2016 scientific journals are adopting guidelines that require scientists to publish their codes stodden et al 2013 this is crucial for models because it avoids the inefficiency of reinventing the wheel and encourages their reusability mooij et al 2010 recently culina et al 2020 found that only 27 of eligible ecology publications shared their code and they called for increased code availability it matches approximately our case as only 11 out of 27 models approximately 41 had their models model codes publicly available hence we second their call for an increase in code availability of process based food web models for meta ecosystems credit authorship contribution statement stephen e osakpolor conceptualization investigation writing original draft writing review editing visualization mira kattwinkel conceptualization investigation writing review editing supervision jens schirmel conceptualization investigation writing review editing supervision alexander feckler writing review editing alessandro manfrin writing review editing ralf b schäfer conceptualization investigation writing review editing supervision visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was funded by the deutsche forschungsgemeinschaft dfg german research foundation 326210499 grk2360 we also acknowledge the support of all members of the systemlink project of the research training group 2360 of university of koblenz landau supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2021 109710 supplementary materials supplementary data 
24562,in a meta ecosystem spatially separated ecosystems are linked by biotic and abiotic cross ecosystem flows hence food webs in a meta ecosystem are functionally linked they are susceptible to multiple stressors threatening ecosystem functions and associated services although empirical studies can help understand stressor effects on meta ecosystem food webs they are often limited by their narrow spatial and temporal scales this limitation may be overcome by process based food web models which allow variable spatial and temporal scales we reviewed process based food web models and their application to aquatic terrestrial and theoretical meta ecosystems we refer to theoretical models as food web models based on theoretical considerations rather than describing a particular natural system we found nineteen aquatic terrestrial models that represented aquatic food webs with flows from terrestrial to aquatic ecosystems most of the aquatic terrestrial models can be applied to study the environmental stressors of eutrophication 15 models and climate change 10 models eight theoretical models were found that study ecosystem stability trophic cascades source sink dynamics co nutrient limitation and co existence of primary consumers the theoretical models are more similar in terms of types of state variables and model complexity i e number of state variables than the aquatic terrestrial models generally the applications of the models have shown that environmental changes cause cross scale effects on food webs in aquatic terrestrial and theoretical meta ecosystems finally we outline major research gaps regarding the directionality of cross ecosystem flows anthropogenic stressors and accessibility of models codes keywords ecology stressors environmental change meta ecosystems mechanistic understanding 1 introduction over the last decades ecology has increased our understanding of the significance of processes operating on multiple temporal and spatial scales loreau et al 2003 this resulted in the development of theoretical concepts like meta population levins 1969 meta community hanski and gilpin 1991 and meta ecosystem loreau et al 2003 which have enhanced environmental management actions schiesari et al 2019 the meta population and meta community concepts represent spatially structured populations of single or multiple species respectively linked by the flow of biotic components of the ecosystem however ecosystems are characterized by the cross ecosystem flows of both biotic and abiotic components polis et al 1997 therefore the meta ecosystem concept extends the meta population and meta community approach through explicit consideration of the cross ecosystem flows of abiotic and biotic components of ecosystems loreau et al 2003 for example aquatic emerging insects are food subsidies for many terrestrial consumers such as insects and birds whereas litter inputs from terrestrial ecosystems support productivity in adjacent aquatic ecosystems nakano and murakami 2001 sabo and power 2002 these aquatic terrestrial flows have the potential to affect top down and bottom up food web control menge et al 1997 thereby establishing the aquatic terrestrial interface richardson et al 2009 sabo and power 2002 and ensuring ecosystem functions trzcinski et al 2016 food webs especially at the aquatic terrestrial interface are affected by multiple anthropogenic stressors including climate change harper and peckarsky 2006 li et al 2011 mosner et al 2011 habitat degradation mikolajewski et al 2015 rowe and ludwig 1991 water pollution graf et al 2019 and invasive species baxter et al 2007 finlay and vredenburg 2007 mineau et al 2012 by anthropogenic stressor we mean any human pressure that causes a change in biological responses outside the range of their natural variation crain et al 2008 understanding the ecological effects of multiple anthropogenic stressors can be challenging because they can lead to non additive ecological responses such as antagonistic and synergistic responses côté et al 2016 empirical studies i e laboratory mesocosm and field studies focusing on meta ecosystems have deepened our understanding of multiple anthropogenic stressors effects on food webs e g mccormick et al 2020 however anthropogenic stressor interactions can change over time and spatial scale whereas most empirical studies focus on narrow temporal and spatial scales allesino 2020 leuzinger et al 2011 process based food web models can allow the prediction of anthropogenic stressor interactions and food web responses over variable temporal and spatial scales as well as the testing of hypotheses and mechanistic assumptions cramer et al 2001 cuddington et al 2013 they may thereby contribute to understanding the functioning of meta ecosystems filling and identifying observation gaps and developing management strategies considering that process based food web models are re usable a review of the type structure and code accessibility of existing models can inform their application for different research questions moreover a synthesis of the results from the application of process based food web models in meta ecosystems can inform the current understanding of meta ecosystems especially because recent reviews on meta ecosystems have focused on empirical studies specifically recent reviews focused on the effect of global change on resource flow between terrestrial and aquatic ecosystems larsen et al 2016 and the importance of alteration of aquatic ecological and biogeochemical linkages to the surrounding terrestrial ecosystems schulz et al 2015 we reviewed process based food web models applied to the aquatic terrestrial interface aquatic terrestrial models and theoretical meta ecosystems theoretical models by theoretical meta ecosystems we mean meta ecosystems where the system types are not explicitly stated we provide a general description of the models and analyze their similarity subsequently we summarize the results from the applications of the models finally we identify research gaps and derive recommendations for future research topics with process based food web models that may improve our understanding of food webs in meta ecosystems 2 0 material and methods we performed a literature search in june 2020 using the search engine isi web of knowledge supplemented by footnote chasing white 2009 the search was conducted in the advanced tab using the keywords ts meta ecosystem or meta population or meta community or aquatic to terrestrial or terrestrial to aquatic or aquatic terrestrial or terrestrial aquatic or aquatic to terrestrial or terrestrial to aquatic or meta habitat and model or simulation and subsid or linkage or coupl or organismal movement or migration or food web or trophic or dispersal the search returned 1009 publications we evaluated these 1009 publications based on the following criteria 1 contained process based food web models 2 focused on aquatic terrestrial or theoretical meta ecosystems 3 captured flows between the ecosystems by food web model we mean a model of organism groups within an ecosystem that are linked by trophic interactions this therefore includes food chains and food webs irrespective of their linkage to an abiotic component e g inorganic nutrients to quantify the similarity between models we conducted a similarity analysis following the method of janssen et al 2015 as in the analysis of ecological similarity between communities of two sites the method treats models as study sites and scores for the presence of state variables as if they were species the resulting binary table is analyzed for model similarity using the sørensen similarity index the index varies between 0 no overlap between the models and 1 models are completely identical supporting information 3 0 description of the models 3 1 general overview we found 19 aquatic terrestrial models developed to study how flows from terrestrial ecosystems affect aquatic food webs while none considered how flows from aquatic ecosystems affect terrestrial food webs fig 1 the models covered food web interactions in various marine and freshwater ecosystems eutrophication was the main application area of the aquatic terrestrial models 15 models while other application areas include climate change 10 models carbon cycle 8 models biodiversity loss 2 models toxicants 2 models invasive species 1 model residential development 1 model windstorm 1 model table 1 we found 8 theoretical models that were developed to study how cross ecosystem flows affect ecosystem stability 3 models trophic cascade 2 models source sink dynamics 1 model co nutrient limitation 1 model and the co existence of primary consumers 1 model table 1 individual organisms were not considered in both the aquatic terrestrial and theoretical models as they used the aggregate population approach which was implemented with either ordinary differential equations 25 models difference equations 1 model or structural dynamic equations 1 model a diversity of programming languages was used in coding the aquatic terrestrial and theoretical models matlab 5 models r 3 models fortran 3 models java 1 model delphi 2 models c c 2 models phyton 1 model pascal 1 model visual basic 1 model stella 1 model and advanced continuous simulation language 2 models of the 27 models i e 19 aquatic terrestrial and 8 theoretical models only 11 aquatic terrestrial models are publicly available and for 7 models the language was not reported supporting information 3 2 similarity of the models the aquatic terrestrial models had a mean similarity of 0 05 and a total of 850 unique state variables fig 2 a generic state variables such as dissolved oxygen phosphate particulate inorganic phosphorus zooplankton increased the similarity between the models considering the low similarity the existing aquatic terrestrial models cover a diverse set of ecosystems and food webs the minimum number of state variables per model was 4 carpentel et al 2016 and the maximum was 291 park et al 2008 the theoretical models had a mean similarity of 0 66 and a total of 19 unique state variables the number of state variables ranged from 6 to 10 fig 2b the high similarity of the theoretical models was expected as they do not specify particular organisms organism groups as state variables but categorize organism groups according to their function e g primary producers 4 0 application of the models sections 4 1 and 4 2 provide summary results of the application of some of the models in the application studies of the models simulations were done to study how general system components e g changes in predator composition and anthropogenic stressors e g eutrophication and warming affect food webs in meta ecosystems the aquatic terrestrial models were applied to study the effects of system components and anthropogenic stressors on food webs whereas the theoretical models were only applied to study the effect of changes in system components on food webs hereafter we refer to both changes in system component and in anthropogenic stressor as environmental change the studies that applied the aquatic terrestrial models in sections 4 1 and 4 2 were parameterized through field measurement experimental data or literature data while studies that applied the theoretical models were mostly parameterized through expert knowledge validation was also carried out for some of the aquatic terrestrial models application studies table 2 4 1 aquatic terrestrial models the application of some of the aquatic terrestrial models can be grouped into studies that applied the eutrophication models to investigate the effects of nutrient flows on the clear turbid state of lakes and studies that applied the non eutrophication models to investigate the effect of other stressors on the aquatic food web 4 1 1 effect of eutrophication on clear turbid state of lakes the eutrophication models contributed to our current understanding that food web interactions play an essential role in the distribution of nitrogen n and phosphorus p in lakes janse et al 1995 puijenbroek et al 2004 lakes are either in a clear macrophytes dominated or turbid phytoplankton dominated state both states are self stabilizing while the nutrient n and p levels at which a switch occurs from turbid to a clear state is much lower than the opposite switch hysteresis according to a model application by janse et al 1998 the critical nutrient level cnl for the transition of a lake between the turbid and clear states depends on both biological and physicochemical factors janse et al 2008 and could vary within a lake janssen et al 2017 the cnl for eutrophication cnleu i e switch from clear to turbid state decreases with an increase in bird herbivory janse et al 1998 temperature mooij et al 2007 2009 nielsen et al 2014 terrestrial particulate organic matter lischke et al 2014 lake fetch janse et al 2008 lake depth janse et al 2008 and a decrease in marsh area janse et al 2001 2008 or water levels janse et al 2008 kong et al 2016 the critical nutrient level for oligotrophication cnloligo i e switch from turbid to clear state decreases with an increase in terrestrial particulate matter lischke et al 2014 lake fetch janse et al 2008 and lake depth janse et al 2008 and a decrease in marsh area janse et al 2008 another model based study on remediation of turbid lakes predicts a reduction in the phosphorus carbon p c ratio of phytoplankton and detritus as a result of a reduction in p flux mobilization from the sediment janse and aldenberg 1990 resulting in p deficiency of algae janse and aldenberg 1991 the higher p c ratios of zooplankton and fish remained unchanged causing a delay in the response of the lake ecosystem to remediation measures janse and aldenberg 1990 1991 a high internal p recycling and assimilation efficiency of the phytoplankton can also cause a delay in lake response to remediation measures janse et al 1992 4 1 2 effect of other stressors on the aquatic food web atlas and palen 2014 roth et al 2007 and vasconcelos et al 2018 examined the effects of environmental change at different ecosystem response levels at the community level vasconcelos et al 2018 predicted that browning flow of terrestrially derived dissolved organic matter decreases benthic and increases pelagic primary production which leads to more pelagic primary and secondary consumers due to active habitat choice this increases the trophic cascade i e indirect top down food web control in the aquatic pelagic zone which was reduced by an increase in temperature due to higher temperature related loss of secondary consumers similarly atlas and palen 2014 predicted that an increase in the flow of terrestrial prey led to an increased trophic cascade in streams through higher secondary consumer biomass which was reduced by an increase in the proportion of armored prey in the stream food web at the population response level roth et al 2007 predicted that reduction of fallen trees into lakes caused by residential development led to a reduction of benthic invertebrate prey however an increase in fishing caused by increased proximity of residential areas led to an increase of benthic invertebrate prey whereas reduction of fallen trees into lakes caused by windstorm had little effect on lake food webs this can be attributed to the differences in the implementation of windstorm and residential development effects during model simulations both disturbances i e windstorm and residential development were initiated at year 50 of 300 year simulations however for residential development the thinning of adult trees occurred at a constant rate per year whereas for windstorm it was implemented as a single event of 65 windfall of adult trees one time pulse stressor beyond the effects of environmental change at various ecosystem response levels carpenter et al 2016 predicted that the effects of terrestrial flows were dependent on the lake trophic levels they predicted that p flow increased phytoplankton and zooplankton biomass however terrestrial particulate organic carbon tpoc decreased phytoplankton biomass and had a weak effect on zooplankton biomass the negative effect of tpoc on phytoplankton was due to increased shading caused by dissolved organic carbon overall the above studies show that stressors propagating from terrestrial ecosystems have cross scale effects on food webs in aquatic ecosystems furthermore model predictions by bellmore et al 2017 showed that strategies to restore aquatic food webs linked to terrestrial flows should consider the aquatic food web structure e g the presence of invasive species 4 2 theoretical models equilibrium and stability analysis are done to analyze food web models a food web model is in equilibrium if the state variables remain unchanged otto and day 2007 stability analysis on a food web model in equilibrium which is done by analyzing the dynamics of populations near equilibrium can inform on stabilizing or destabilizing effects of environmental change on the modelled system an environmental change destabilizes if it pushes the system away from equilibrium whereas it stabilizes if it pushes the system towards equilibrium otto and day 2007 at the ecosystem response level the theoretical models predicted that cross ecosystem flows of nutrients gounand et al 2014 marleau et al 2010 and detritus gounand et al 2014 destabilize meta ecosystems whereas the cross ecosystem flow of primary producers or primary consumers has either neutral or stabilizing effects gounand et al 2014 even though the cross ecosystem flow of primary consumers can stabilize meta ecosystems in combination with nutrients it can cause a destabilizing effect however the onset and spatial scale of the destabilizing effect depends on the meta ecosystem s spatial structure marleau et al 2014 overall according to models meta ecosystems were more stable at a combined cross ecosystem flow of nutrients primary producers primary consumers and detritus compared to a single flow gounand et al 2014 cross ecosystem flow also interacted with various meta ecosystem stabilizing or destabilizing characteristics for example meta ecosystems that are stabilized by ecosystems with different nutrient fertility are further stabilized by the cross ecosystem flow of primary consumers gounand et al 2014 meta ecosystems destabilized by local enrichments of nutrients can be stabilized if the cross ecosystem flow of primary producers or primary consumers are sufficiently strong to redistribute enrichment to the nutrient deficient ecosystem whereas meta ecosystems destabilized by regional enrichments of nutrients can only be stabilized by the intermediate cross ecosystem flow of primary consumers gounand et al 2014 gravel et al 2010 showed that the cross ecosystem flow of nutrients detritus primary producers or primary consumers can reverse the source sinks dynamics of meta ecosystems community level responses were also investigated marleau and guichard 2019 predicted that the cross ecosystem flow of primary consumers with nutrient recycling could generate spatial heterogeneity to allow the coexistence of primary producers where the well mixed system predicts competitive exclusion in terms of top down control in food webs the cross ecosystem flow of nutrients primary producers primary consumers or secondary consumer causes an increased top down control in the recipient ecosystem leroux and loreau 2008 meta ecosystems that exhibit reciprocally pulsed cross ecosystem flow of primary consumers lead to spatial and temporal variability in the strength of top down control in both local and meta ecosystems however top down control is strongest when the reciprocally pulsed cross ecosystem flow of primary consumers is temporally concentrated leroux and loreau 2012 overall similar to the application of the aquatic terrestrial models the above studies have shown that changes in cross ecosystem flows have cross scale effects on food webs in hypothetical meta ecosystems but their effects are often context dependent 5 0 outlook and recommendations in summary our study found that various process based food web models have been developed which has led to a greater understanding of aquatic terrestrial and meta ecosystems in general specifically the reviewed studies have provided predictions that can form the basis of experiments on the effects of environmental change on aquatic terrestrial and meta ecosystem food webs however relative to the theoretical models the aquatic terrestrial models provide a greater diversity of model state variables and complexity not surprisingly owing to its generality the theoretical models have been applied to study the effect of change in system components e g change in cross ecosystem flows heterogeneity of ecosystems not explicitly linked to an anthropogenic stressor on food webs in meta ecosystems in contrast the aquatic terrestrial models were also used to study anthropogenic stressors below we outline major research gaps that limit our understanding of food webs in an aquatic terrestrial interface or meta ecosystem context 5 1 flows and stressors from aquatic to terrestrial food webs the reviewed aquatic terrestrial models focused on how flows from terrestrial ecosystems affect aquatic food webs with none focusing on reciprocal flows similarly only anthropogenic stressors propagating from terrestrial ecosystems to aquatic food webs were considered for example the effects of the reduction in fallen trees caused by residential development and windstorm on lake food webs roth et al 2007 the focus on an aquatic ecosystem is not surprising as aquatic ecosystems generally receive higher cross ecosystem flows ballinger and lake 2006 power et al 2004 caused by the difference in terrain profiles the concave terrain profile of aquatic ecosystems makes them spatial attractors of many flows from terrestrial ecosystems due to gravity unlike the terrestrial ecosystems that exhibit convex terrain profiles consequently the effects of terrestrial flows on aquatic ecosystems have been a major theme in ecosystem ecology for decades likens 1992 schindler and smits 2016 however empirical studies have shown that physically and biologically mediated flows from aquatic ecosystems overcome gravity to affect terrestrial food webs schindler and smits 2016 schulz et al 2015 biologically mediated flows from aquatic to terrestrial ecosystems involve animal movements specifically such flows include the emergence of aquatic insects bartels et al 2012 muehlbauer et al 2014 richardson et al 2009 and the distribution of fish derived energy by foraging terrestrial predators helfield and naiman 2006 in the terrestrial ecosystem physically mediated flows from the aquatic ecosystem involve the movements of nutrients sediments and detritus through floods and subsurface water flows into terrestrial ecosystems schindler and smits 2016 schulz et al 2015 wölz et al 2011 empirical studies have also shown that anthropogenic stressors propagate from the aquatic ecosystem to terrestrial food webs through physically and biologically mediated pathways in the context of anthropogenic stressors propagation via physically mediated pathways dam construction reduces flood intensity and frequency beechie et al 2010 while channelization of an aquatic ecosystem can increase flow velocity leading to channel incision and reduction of flood events schindler and smits 2016 the effects on flood intensity and frequency can reduce adjacent terrestrial community composition li et al 2012 and plant density stave et al 2003 moreover a reduction in flood events can support the spread of less flood tolerant invasive species in an adjacent terrestrial ecosystem e g tamarax sp lovell et al 2009 examples of anthropogenic stressors propagating via biological mediated pathways include the reduction of the quantity of emerging insects or the bioaccumulation of pollutants in emerging insects with consequent effects on terrestrial food webs kraus et al 2014 kraus 2019 paetzold et al 2011 specifically species richness and the spider densities in affected terrestrial food webs can be reduced graf et al 2019 similarly artificial lights can affect emerging insects phenology and physiology perkin et al 2011 with a consequent effect on the composition of riparian predators and scavenger communities manfrin et al 2017 even though the impacts of flows and stressors from aquatic ecosystems on terrestrial food webs are now being quantified the impacts on terrestrial food web trophic interactions are understudied schindler and smits 2016 also the relative importance of physically and biologically mediated pathways in the propagation of anthropogenic stressors from aquatic to terrestrial ecosystems remains unclear for example quantitative comparisons between biologically and physically mediated pathways of the pollutant transport from aquatic to terrestrial ecosystems and associated effects on food webs are lacking schulz and bundschuh 2020 therefore process based food web modeling studies based on empirical evidence focusing on flows and anthropogenic stressors propagating from aquatic to terrestrial ecosystems could help in understanding the relative effects of biologically and physically mediated pathways on terrestrial food webs through model simulations they could also provide clarity on how aquatic to terrestrial anthropogenic stressors and effects on food webs change across various temporal and spatial scales moreover such studies will enable freshwater scientists to convey the relevance of their work to terrestrial managers sullivan and manning 2019 5 2 anthropogenic stressors affect the time space and quality characteristics of aquatic terrestrial flows the reviewed studies focused on how anthropogenic stressors affect the quantity of aquatic terrestrial flows however anthropogenic stressors can also shift the timing quality and spatial characteristics of such flows larsen et al 2016 and consequently affect the recipient s food web for example rising temperature can lead to early emergence and faster development of merolimnic insects harper and peckarsky 2006 reading 1998 and conceivably lead to temporal mismatches with the dietary need of terrestrial consumers similarly climate change can shift the distribution of species poleward e g riparian vegetation conceivably affecting recipient aquatic organisms e g stream detritivores through spatial mismatch doi 2008 in terms of resource quality climate warming of 2 5 c can reduce fatty acids 8 2 to 27 8 in algae hixson and arts 2016 which may indirectly affect terrestrial consumers via an altered nutritional quality of the aquatic subsidy in terms of merolimnic insects consequently future process based food web modeling studies should also focus on how anthropogenic stressors affect the above mentioned characteristics of aquatic terrestrial flows 5 3 models accessibility publicly sharing code increases the reproducibility and transparency of scientific studies gallagher et al 2020 mckiernan et al 2016 scientific journals are adopting guidelines that require scientists to publish their codes stodden et al 2013 this is crucial for models because it avoids the inefficiency of reinventing the wheel and encourages their reusability mooij et al 2010 recently culina et al 2020 found that only 27 of eligible ecology publications shared their code and they called for increased code availability it matches approximately our case as only 11 out of 27 models approximately 41 had their models model codes publicly available hence we second their call for an increase in code availability of process based food web models for meta ecosystems credit authorship contribution statement stephen e osakpolor conceptualization investigation writing original draft writing review editing visualization mira kattwinkel conceptualization investigation writing review editing supervision jens schirmel conceptualization investigation writing review editing supervision alexander feckler writing review editing alessandro manfrin writing review editing ralf b schäfer conceptualization investigation writing review editing supervision visualization declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was funded by the deutsche forschungsgemeinschaft dfg german research foundation 326210499 grk2360 we also acknowledge the support of all members of the systemlink project of the research training group 2360 of university of koblenz landau supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2021 109710 supplementary materials supplementary data 
24563,sensitivity and identifiability analyses 3 results 4 discussion 4 1 similarities between reservoirs 4 2 disparities between reservoirs 4 3 implications for model calibration 4 4 limitations of the sensitivity and identifiability analyses 5 conclusions credit authorship contribution statement acknowledgements appendix supplementary materials albertin 2010 57 67 l baroni 2014 26 34 g beven 2006 18 36 k borgonovo 2016 869 887 e bruce 2018 274 291 l bucak 2018 802 816 t bueche 2019 1 41 t burger 2008 411 423 d cariboni 2007 167 182 j correafilho 2003 79 90 c cui 2016 146 157 y darko 2019 73 86 d douglassmith 2020 124 d farrell 2020 109134 k fenocchi 2019 38 51 a ferretti 2016 666 670 f frassl 2019 181 187 m gal 2014 246 248 g gal 2009 1697 1718 g gupta 2018 8692 8717 h hamby 1994 135 154 d hamilton 1997 91 110 d hipsey 2019 473 523 m imberger 1990 303 476 j advancesinappliedmechanics physicallimnology jones 2018 444 455 h kara 2012 104 121 e ladwig 2018 10 r ladwig 2020 1 45 r lenhart 2002 645 654 t maia 2006 a conssequencessiltinginoperationreservoirsformedbydamsconsequenciasassoreamentonaoperacaodereservatoriosformadosporbarragensthesispostgraduateprograminhydraulicssanitation me 2018 114 133 w morris 1991 161 174 m nelson 2020 129 n norton 2015 166 174 j oreilly 2015 773 781 c ozkundakci 2011 165 185 d pianosi 2016 214 232 f rangelperaza 2016 81 92 j read 2014 142 150 j robson 2014 287 296 b romero 2004 143 160 j rotta 2021 106913 l saltelli 2019 29 39 a saltelli 2008 a journalchemicalinformationmodeling globalsensitivityanalysisprimer santos 2010 r structurephytoplanktonzooplanktoncommunitiesenphasiszooplanktonicsecondaryproductionrelatedenvironmentalfactorsinreservoirslowtieteriverspestruturadascomunidadesfitoplanctonicaezooplanctonicamastersthesispostgraduateprograninecologynaturalresources schladow 1997 111 123 s schmolke 2010 479 486 a shimoda 2016 29 43 y snortheim 2017 39 53 c soares 2020 134 l tan 2018 4681 4699 z uusitalo 2015 24 31 l watanabe 2019 581 590 f weber 2017 96 105 m weng 2020 106556 w yi 2016 74 84 x soaresx2021x109720 soaresx2021x109720xl 2023 08 28t00 00 00 000z 2023 08 28t00 00 00 000z http creativecommons org licenses by nc nd 4 0 2021 elsevier b v all rights reserved 2021 08 31t23 43 04 325z http vtw elsevier com data voc addontypes 50 7 aggregated refined national council for scientific and technological development cnpq conselho nacional de desenvolvimento científico e tecnológico http data elsevier com vocabulary scivalfunders 501100003593 http sws geonames org 3469034 inmet national institute of meteorology cetesb environmental company of the state of s o paulo national water agency ana agência nacional de águas http data elsevier com vocabulary scivalfunders 100009095 http sws geonames org 3469034 this work was supported by the national council for scientific and technological development cnpq additionally we are grateful to the national institute of meteorology inmet the national water agency ana and the environmental company of the state of s o paulo cetesb for the available data this work was supported by the national council for scientific and technological development cnpq additionally we are grateful to the national institute of meteorology inmet the national water agency ana and the environmental company of the state of são paulo cetesb for the available data 0 https doi org 10 15223 policy 017 https doi org 10 15223 policy 037 https doi org 10 15223 policy 012 https doi org 10 15223 policy 029 https doi org 10 15223 policy 004 item s0304 3800 21 00274 x s030438002100274x 1 s2 0 s030438002100274x 10 1016 j ecolmodel 2021 109720 271743 2021 09 14t03 54 49 297988z 2021 10 15 1 s2 0 s030438002100274x main pdf https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x main application pdf eca30ce80715a26f556177db8cdb61a2 main pdf main pdf pdf true 2521630 main 13 1 s2 0 s030438002100274x main 1 png https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x preview image png 2fb212bbe928887b06708f015505b1e5 main 1 png main 1 png png 58426 849 656 image web pdf 1 1 s2 0 s030438002100274x gr1 jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr1 downsampled image jpeg 210a82053842c654313953b66fb2411b gr1 jpg gr1 gr1 jpg jpg 75273 400 753 image downsampled 1 s2 0 s030438002100274x gr2 jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr2 downsampled image jpeg 6069d4ba271e32d21a1019efb9e80f9e gr2 jpg gr2 gr2 jpg jpg 57446 440 690 image downsampled 1 s2 0 s030438002100274x gr3 jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr3 downsampled image jpeg a73084cd34456ed14fecdfd83d5d8e28 gr3 jpg gr3 gr3 jpg jpg 95776 350 801 image downsampled 1 s2 0 s030438002100274x gr4 jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr4 downsampled image jpeg b35a427b0b28480af3e764b2add4b08e gr4 jpg gr4 gr4 jpg jpg 79539 500 710 image downsampled 1 s2 0 s030438002100274x gr5 jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr5 downsampled image jpeg e05fb4a6063a2d0428fb4325ea4da014 gr5 jpg gr5 gr5 jpg jpg 277200 997 732 image downsampled 1 s2 0 s030438002100274x gr1 sml https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr1 thumbnail image gif 52e9281e46b736895ba9fad2b6e0f4e8 gr1 sml gr1 gr1 sml sml 11161 116 219 image thumbnail 1 s2 0 s030438002100274x gr2 sml https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr2 thumbnail image gif 3410c54e85e9f35de666524d614d7b7e gr2 sml gr2 gr2 sml sml 10480 140 219 image thumbnail 1 s2 0 s030438002100274x gr3 sml https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr3 thumbnail image gif 4b1c12600ba22e4fc5164babbe174852 gr3 sml gr3 gr3 sml sml 11585 96 219 image thumbnail 1 s2 0 s030438002100274x gr4 sml https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr4 thumbnail image gif 31106cd617d2aa00c7ed9359a1ad307d gr4 sml gr4 gr4 sml sml 10612 154 219 image thumbnail 1 s2 0 s030438002100274x gr5 sml https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr5 thumbnail image gif cdf91d60b9db6ff9b0f530fb4e58b5bc gr5 sml gr5 gr5 sml sml 17422 163 120 image thumbnail 1 s2 0 s030438002100274x gr1 lrg jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr1 highres image jpeg 396eb1df62e7949e20e7cd1fbafaaf3c gr1 lrg jpg gr1 gr1 lrg jpg jpg 513911 1769 3333 image high res 1 s2 0 s030438002100274x gr2 lrg jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr2 highres image jpeg 29adee0b918beef237a8e91ba593c7c0 gr2 lrg jpg gr2 gr2 lrg jpg jpg 436499 1949 3054 image high res 1 s2 0 s030438002100274x gr3 lrg jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr3 highres image jpeg 793d9a73ce29ea7ecfe2a554b80cc68e gr3 lrg jpg gr3 gr3 lrg jpg jpg 614588 1550 3548 image high res 1 s2 0 s030438002100274x gr4 lrg jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr4 highres image jpeg dbe31ddecc408c417aa56883b8c2d595 gr4 lrg jpg gr4 gr4 lrg jpg jpg 474729 2213 3144 image high res 1 s2 0 s030438002100274x gr5 lrg jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr5 highres image jpeg 56a025fe58019264623509e42c8a0491 gr5 lrg jpg gr5 gr5 lrg jpg jpg 1573150 4417 3242 image high res 1 s2 0 s030438002100274x mmc1 docx https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x mmc1 main application vnd openxmlformats officedocument wordprocessingml document 83e78ef6afb026d1966864081c4c9fd3 mmc1 docx mmc1 mmc1 docx docx 7207026 application 1 s2 0 s030438002100274x si1 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml 99b8b8ef3f3e5ae69ebb1d0e6cdf66aa si1 svg si1 si1 svg svg 531 altimg 1 s2 0 s030438002100274x si2 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml fc87ab7862576a0f75fabe0e2ed35a5b si2 svg si2 si2 svg svg 4317 altimg 1 s2 0 s030438002100274x si3 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml c351e3eda95bdf42462196388f160399 si3 svg si3 si3 svg svg 9408 altimg 1 s2 0 s030438002100274x si4 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml f707da1519ee7a815ea07c9f6db08c47 si4 svg si4 si4 svg svg 4099 altimg 1 s2 0 s030438002100274x si5 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml 477923eddccace2d4114671b662d3b11 si5 svg si5 si5 svg svg 4767 altimg 1 s2 0 s030438002100274x si6 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml badf8cf69dcbf0bf56862349ac4815d0 si6 svg si6 si6 svg svg 4333 altimg 1 s2 0 s030438002100274x si7 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml 4f7cc8861188d8ed4b3f42f169cded29 si7 svg si7 si7 svg svg 3421 altimg 1 s2 0 s030438002100274x si8 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml 838a1673655650ad3089f630ca7f8abf si8 svg si8 si8 svg svg 3805 altimg 1 s2 0 s030438002100274x am pdf https s3 eu west 1 amazonaws com prod ucs content store eu west content egi 10sp3d3hrpw main application pdf 0578cf3a8dde7a3873ff7e1dd76ba8f8 am pdf am am pdf pdf false 1165791 aam pdf ecomod 109720 109720 s0304 3800 21 00274 x 10 1016 j ecolmodel 2021 109720 elsevier b v fig 1 location of the study sites in southeast brazil monitoring stations and their bathymetry bb is barra bonita reservoir pr is promissão reservoir and ti is três irmãos reservoir fig 1 fig 2 conceptual diagram of glm aed model for the current application the white boxes are state variables phytoplankton phyto ammonium nh4 nitrate no3 filterable reactive phosphorus po4 dissolved inorganic carbon dic dissolved organic nitrogen don dissolved organic phosphorus dop dissolved organic carbon doc particulate organic nitrogen pon particulate organic phosphorus pop particulate organic carbon poc and dissolved oxygen do fig 2 fig 3 monthly input data across barra bonita reservoir promissão reservoir and três irmãos reservoir based on hourly meteorological measurements and daily hydrological measurements from 2008 to 2016 air temperature wind speed rainfall relative humidity solar radiation inflow discharge outflow discharge and inflow temperature horizontal lines represent the median 25th and 75th percentiles whiskers indicate the 5th and 95th percentiles fig 3 fig 4 seasonal input loads across barra bonita reservoir bb promissão reservoir pr and três irmãos reservoir ti based on bi monthly measurements from 2008 to 2016 dissolved oxygen nitrate ammonium total phosphorus and chlorophyll a horizontal lines represent the median 25th and 75th percentiles whiskers indicate the 5th and 95th percentiles fig 4 fig 5 sensitivity indicator a and identifiability indicator b for 64 parameters in barra bonita bb promissão pr and três irmãos ti reservoirs based on a 8 year period relative to a dissolved oxygen b total phosphorus c ammonium d nitrate and e chlorophyll a concentration fig 5 table 1 morphometric features aestietê 2019 cesp 2013 mixing regime soares et al 2020 trophic status rotta et al 2021 watanabe et al 2019 and water quality features cetesb 2019 for all reservoirs table 1 barra bonita promissão três irmãos abbreviation bb pr ti initial operation 1964 1975 1991 elevation m a s l 451 5 384 0 328 0 maximum volume 109 m3 3 16 8 11 11 46 surface area at crest km2 226 522 654 maximum depth m 23 5 24 5 45 6 hydraulic residence time days 91 141 442 mixing regime polymictic monomictic monomictic trophic status meso hypereutrophic mesotrophic oligotrophic dissolved oxygen mg l 1 6 72 3 00 7 44 1 54 7 18 0 77 total phosphorus mg l 1 0 18 0 20 0 05 0 07 0 02 0 01 ammonium mg l 1 0 42 0 42 0 17 0 09 0 16 0 06 nitrate mg l 1 3 12 1 15 0 87 0 34 0 45 0 22 chlorophyll a µg l 1 40 64 66 97 24 13 50 93 3 82 2 61 table 2 description of aed parameters their units initial values hipsey et al 2013 and range for the sensitivity analysis table 2 symbol description unit initial value range sedimentation flux fsed oxy sedimentation flux for dissolved oxygen mmol m 2 d 1 6 00 20 00 a 87 50 b fsed amm sedimentation flux for ammonium mmol m 2 d 1 3 00 0 01 a 22 16 c fsed nit sedimentation flux for nitrate mmol m 2 d 1 14 00 14 00 1 87 d fsed frp sedimentation flux for filterable reactive phosphorus mmol m 2 d 1 0 12 0 001 a 0 84 b fsed pop sedimentation flux for particulate organic phosphorus mmol m 2 d 1 0 01 0 01 0 a fsed dop sedimentation flux for dissolved organic phosphorus mmol m 2 d 1 0 03 0 001 a 0 10 a fsed poc sedimentation flux for particulate organic carbon mmol m 2 d 1 0 01 0 009 0 011 fsed doc sedimentation flux for dissolved organic carbon mmol m 2 d 1 30 00 0 01 c 30 00 fsed ch4 sedimentation flux for methane mmol m 2 d 1 0 00 0 10 00 a dissolved oxygen ksed oxy half saturation constant of sediment oxygen flux mmol m 3 15 6 6 8 a 51 6 c theta sed oxy temperature multiplier for sediment oxygen flux 1 08 1 02 d 1 14 d nitrogen rnitrif maximum reaction rate of nitrification at 20 c d 1 0 03 0 01 b 0 34 e rdenit maximum reaction rate of denitrification at 20 c d 1 0 01 0 0005 e 0 50 f knitrif half saturation constant for oxygen dependence of nitrification mmol m 3 62 5 12 5 d 93 7 e kdenit half saturation constant for oxygen dependence of denitrification mmol m 3 15 6 12 5 e 18 0 a ksed amm half saturation constant of ammonium flux mmol m 3 15 6 15 0 a 65 7 c ksed nit half saturation constant of nitrate flux mmol m 3 15 6 15 0 a 23 4 d theta nitrif temperature multiplier for temperature dependence of nitrification 1 08 1 02 e 1 14 e theta denit temperature multiplier for temperature dependence of denitrification 1 08 1 02 1 14 theta sed amm temperature multiplier for sediment ammonium flux 1 08 1 02 1 14 c theta sed nit temperature multiplier for sediment nitrate flux 1 08 1 02 1 14 phosphorus ksed frp half saturation constant of filterable reactive phosphorus flux mmol m 3 15 6 15 6 69 5 c theta sed frp temperature multiplier for sediment phosphate flux 1 08 1 02 1 14 organic matter nitrogen w pon settling rate of detrital nitrogen pool m d 1 1 0 1 0 0 015 a rpon miner maximum rate of hydrolysis of particulate organic nitrogen d 1 0 01 0 003 g 0 80 h rdon miner maximum rate of mineralisation of dissolved organic nitrogen d 1 0 01 0 003 e 0 05 e kpon miner half saturation constant for particulate organic nitrogen breakdown mmol m 3 78 0 31 25 i 156 25 g kdon miner half saturation constant for dissolved organic nitrogen mineralisation mmol m 3 78 0 31 25 i 156 25 g theta pon miner temperature multiplier for particulate organic nitrogen breakdown 1 08 1 02 e 1 14 e theta don miner temperature multiplier for dissolved organic nitrogen mineralisation 1 08 1 02 e 1 14 e organic matter phosphorus w pop settling rate of detrital phosphorus pool m d 1 1 0 1 0 0 03 a rpop miner maximum rate of hydrolysis of particulate organic phosphorus d 1 0 03 0 001 j 0 50 i rdop miner maximum rate of mineralisation of dissolved organic phosphorus d 1 0 05 0 005 e 0 05 kpop miner half saturation constant for particulate organic phosphorus breakdown mmol m 3 78 0 31 25 i 156 25 g kdop miner half saturation constant for dissolved organic phosphorus mineralisation mmol m 3 78 0 31 25 i 78 1 e theta pop miner temperature multiplier for particulate organic phosphorus breakdown 1 08 1 02 e 1 14 e theta dop miner temperature multiplier for dissolved organic phosphorus mineralisation 1 08 1 02 e 1 14 e organic matter carbon w poc settling rate of detrital carbon pool m d 1 1 0 1 0 0 05 a rpoc miner maximum rate of hydrolysis of particulate organic carbon d 1 0 01 0 001 a 0 50 i rdoc miner maximum rate of mineralisation of dissolved organic carbon d 1 0 01 0 001 a 0 50 i kpoc miner half saturation constant for particulate organic carbon breakdown mmol m 3 78 0 31 25 i 156 2 e kdoc miner half saturation constant for dissolved organic carbon mineralisation mmol m 3 78 0 31 25 i 156 2 e theta poc miner temperature multiplier for particulate organic carbon breakdown 1 08 1 02 e 1 14 e theta doc miner temperature multiplier for dissolved organic carbon mineralisation 1 08 1 02 e 1 14 e phytoplankton w p phytoplankton sedimentation rate m d 1 0 02 0 10 k 4 32 b ycc carbon to chlorophyll a ratio mg c mg chl a 1 50 45 55 r growth phytoplankton growth rate at 20 c d 1 1 9 0 6 d 2 9 e theta growth arrhenius temperature scaling for growth 1 08 1 02 1 14 theta std s tandard temperature c 20 0 19 0 c 23 0 l theta opt o ptimum temperature c 28 0 24 0 c 30 0 d theta max m aximum temperature c 35 0 32 0 k 40 0 d i s saturating light intensity µe m 2 s 1 150 150 250 d kephy specific attenuation coefficient for phytoplankton m 1 0 005 0 002 a 0 198 d f pr fraction of primary production lost to exudation d 1 0 005 0 005 0 070 c r resp phytoplankton respiration rate at 20 c d 1 0 05 0 01 d 0 09 m theta resp arrhenius temperature scaling for respiration 1 08 1 02 1 14 k fres fraction of metabolic loss that is respiration 0 25 0 25 0 75 a k fdom fraction of metabolic loss that is dissolved organic matter 0 20 0 20 0 25 a n o nitrogen concentration below which uptake is zero mmol n m 3 0 25 0 a 0 25 k n half saturation concentration of nitrogen mmol n m 3 1 00 0 02 d 3 50 k x ncon constant internal nitrogen concentration mmol n mmol c 1 0 035 0 035 0 380 e p o phosphorus concentration below which uptake is zero mmol p m 3 0 03 0 a 0 03 k p half saturation concentration of phosphorus mmol p m 3 0 05 0 002 d 0 26 e x pcon constant internal phosphorus concentration mmol p mmol c 1 0 0015 0 0015 0 0020 a a farrell et al 2020 b burger et al 2008 c snortheim et al 2017 d kara et al 2012 e fenocchi et al 2019 f me et al 2018 g romero et al 2004 h schladow and hamilton 1997 i aed science manual hipsey et al 2013 j özkundakci et al 2011 k ladwig et al 2018 l bucak et al 2018 m cui et al 2016 as a range of values was not found in the literature the 10 range was adopted table 3 summary of biogeochemical parameters with medium and high identifiability indicator for barra bonita bb promissão pr and três irmãos ti reservoirs table 3 symbol bb pr ti symbol bb pr ti symbol bb pr ti fsed oxy theta sed amm theta doc miner fsed amm theta sed nit ycc fsed nit ksed frp r growth fsed frp theta sed frp theta growth fsed pop w pon theta std fsed poc theta pon miner theta opt fsed doc theta don miner theta max ksed oxy w pop i s theta sed oxy rdop miner r resp rnitrif kdop miner theta resp knitrif theta pop miner k fres kdenit theta dop miner k fdom ksed nit w poc n 0 theta nitrif kdoc miner p 0 theta denit theta poc miner x pcon sensitivity very high high medium low sensitivity and identifiability analyses of parameters for water quality modeling of subtropical reservoirs l m v soares conceptualization formal analysis investigation methodology software writing original draft m c calijuri supervision validation writing review editing funding acquisition university of são paulo at são carlos school of engineering department of hydraulics and sanitation av trabalhador são carlense 400 são carlos sp 13566 590 brazil university of são paulo at são carlos school of engineering department of hydraulics and sanitation av trabalhador são carlense 400 são carlos sp 13566 590 brazil university of são paulo at são carlos school of engineering department of hydraulics and sanitation av trabalhador são carlense 400 são carlos sp 13566 590 brazil corresponding author sensitivity and identifiability analyses are a standard practice in modeling applications to investigate the relative importance of model components that control the system s behavior in this study both analyses were implemented to identify the most influential parameters in a coupled hydrodynamic biogeochemical model applied for three subtropical reservoirs the one dimensional general lake model coupled to aquatic ecodynamics glm aed was used to simulate the dynamics of dissolved oxygen total phosphorus nitrate ammonium and chlorophyll a results reveal consistent sensitivity patterns between reservoirs especially for a subset of temperature multipliers affecting dissolved oxygen and nutrients in contrast the sensitivity of chlorophyll a is highly site specific additionally the majority of parameters are medium or high sensitive which indicates the need for a calibration procedure to improve model accuracy the analyses provide a detailed understanding of the governing ecosystem dynamics as a step forward to model identifiability and guidance for future model calibration keywords lakes aquatic ecosystem biogeochemistry glm aed one at a time method calibration 1 introduction modeling lake ecosystems play an essential role in limnological studies for water quality assessment in response to the increased demand for ecosystem services in conjunction with the degradation of freshwaters at a global scale lake models experienced a rapid growth in the 1990s and 2000s decades also triggered by technological progress expansion and specialization of the modeling community and a new focus on the user interfaces and visualization robson 2014 the rapid advances came along with challenges mostly regarding the most suitable approach and complexity uncertainty and reliability and the usage of complex models and integration approaches gal et al 2014 in recent years lake modeling move towards open source codes further efforts supporting software environments and rich sources of data such as high frequency sensors and satellite images frassl et al 2019 accordingly to the huge advances in lake modeling in the past decades the sensitivity analysis sa has been widespread applied and regarded as a standard practice in modeling applications schmolke et al 2010 shimoda and arhonditsis 2016 following the increased use of sensitivity analysis methods recently reviews assessed its variety motivation and scope norton 2015 compiled the software tools and techniques most used douglas smith et al 2020 stated a practical best practice workflow pianosi et al 2016 suggested guidelines for the proper use of the methods saltelli et al 2019 and discussed its usage to evaluate uncertainty of deterministic models uusitalo et al 2015 the sa can be a helpful tool to investigate the role and importance of model components such as parameters and forcing data in producing model responses for assessing the sa of model parameters the basic idea is to alter their values on the basis of an acceptable range and evaluate the subsequent changes in model output the model is sensitive to a parameter if the outputs change markedly when the parameter value is changed otherwise if the output values change only little it is robust to changes in parameter values within the model thereby implying in a small sensitivity the insights provided by the sa concern both the magnitude of the variations and the direction of change borgonovo and plischke 2016 which can help to understand the model s intrinsic behavior by identifying the governing processes in the system and enhancing model formulations for instance the sa can be conducted for several purposes in ecological modeling including for elucidating which parameters require additional research or are insignificant nelson et al 2020 the consequences from changing the dominant controls of a system gal et al 2009 and the correlation between input parameters and lake characteristics such as residence time meteorological conditions and trophic status bruce et al 2018 finding the global optimal model and by implication the true representation of the system is a difficult task for complex models in face of the non uniqueness or equifinality of parameter values i e the same output can be reached by multiple optimal parameter values which give equally acceptable fits to observational data beven 2006 the equifinality issue re emphasizes the need to apply sa actively in the modeling process the sa is classified into local or global procedures saltelli et al 2004 p 44 a local sensitivity is performed by the one at a time oat method which assesses the model output change against variations of a single parameter while keeping all others fixed at their initial values hamby 1994 the global sensitivity estimates the overall response of model outputs when all parameters vary simultaneously within their perturbation range considering not only the direct influence of each parameter but also the joint influence due to their interactions conceptually the global approach provides a better characterization of the ecosystem s governing processes in the expense of a higher demanding computational effort although the usage of the global sa is advised in the literature e g baroni and tarantola 2014 there are relatively few applications in ecological modeling of aquatic ecosystems and the oat method is still the most largely used technique ferretti et al 2016 similarly to the sa the identifiability analysis applies a performance metric to establish which parameters strongly improve model fit to observed data both sensitivity and identifiability analyses are quite similar but not identical while parameter identifiability depends on the sensitivity of the model s output response to parameter perturbations the converse is not true gupta and razavi 2018 in the context of lake models an identifiability analysis is commonly used to compile a list of influential parameters that have a significant impact on the model response and should be the focus of the calibration procedure e g darko et al 2019 me et al 2018 snortheim et al 2017 tan et al 2018 it is generally true that only a relatively small subset of model parameters dominate a particular output variable however they are hardly to be predicted based on the sole intuition in face of the large number of model parameters and the interactions amongst them the identifiability analysis can largely reduce the complexity of model calibration by factor prioritization saltelli et al 2008 and keeping the insignificant parameters fixed in face of their low influence on model output cariboni et al 2007 the primary objective of this study was to characterize the sensitivity and identifiability of several water quality outputs from a hydrodynamic biogeochemical model general lake model coupled to aquatic eco dynamics glm aed to uncertainty in aed parameters using both the sensitivity analysis and the identifiability analysis the study sites were three subtropical reservoirs in brazil barra bonita reservoir promissão reservoir and três irmãos reservoir for this purpose the aims were 1 to quantify the sensitivity of model outputs to varying parameter values by applying the one at a time method to establish which parameters exert stronger controls on the models dynamical input state output behavior 2 to perform an identifiability analysis to establish which parameters can be perturbed to improve model fit to observed data for calibration guidance and 3 to identify the similarities and disparities in the model s behavior between the reservoirs despite the glm aed model has been widely applied a comprehensive sa on the model s parameters remains limited there are few sa for hydrodynamic parameters in previous glm applications bruce et al 2018 bueche et al 2019 ladwig et al 2018 soares et al 2020 weber et al 2017 and only one study performed the sensitivity analysis of aed model parameters ladwig et al 2020 as the output sensitivity of glm aed model to parameter uncertainty is therefore quite unexplored especially for subtropical reservoirs the motivation of the present analyses was centered on gaining deeper knowledge about the importance of biogeochemical parameters to water quality outputs and the properties of the actual ecosystems as a means to provide potential insights for model applications 2 material and methods 2 1 sites description three reservoirs were selected for the current study barra bonita reservoir bb promissão reservoir pr and três irmãos reservoir ti located southeast brazil in the highest demographic density region in the country fig 1 the reservoirs were chosen for i their varied range of morphometric and water quality features table 1 ii their same climate condition subtropical cwa according to köppen 1948 with an average air temperature of 22 6 c and an annual rainfall of 1400 mm inmet 2019 and iii the availability of field data for model input all three reservoirs were built in the tietê river envisioning electricity generation and navigation to attend to the country demand nowadays the reservoirs are intended for multiple uses between these reservoirs there are other three reservoirs along the river composing a cascade system the other reservoirs were not selected for this study due to the lack of field data there is a remarked gradient from barra bonita reservoir to três irmãos reservoir in terms of water quality and trophic state barra bonita 22 31 11 s 48 32 04 w is a meso hyper eutrophic reservoir located in an urbanized catchment where is situated são paulo metropolitan region and around of 24 million inhabitants ibge 2019 it has been heavily loaded by sewage deriving from urban areas resulting in a high nutrient state frequent hypoxic events and cyanobacteria blooms cetesb 2019 it has a poly mictic regime with short timescales of stratification bb reservoir is the shallowest and smallest of the three study sites with a surface area of 226 km2 maximum depth of 23 5 m and residence time of 91 days promissão reservoir 21 17 51 s 49 46 47 w is meso trophic with average chlorophyll a concentration of 24 13 µg l 1 its mono mictic regime is characterized by summer stratification from october to april with surface temperatures of 25 9 c and hypo limentic temperatures of 22 9 c pr reservoir has a surface area of 522 km2 maximum depth of 24 5 m and residence time of 141 days três irmãos 20 40 10 s 51 17 57 w is the most downstream reservoir of the cascade system and the largest one it is an oligotrophic and mono mictic water body summer stratification is also from october to april with surface temperature of 26 3 c ti reservoir has a surface area of 654 km2 maximum depth of 45 6 m and residence time of around 1 2 year 2 2 model description the process based one dimensional 1d vertical general lake model glm hipsey et al 2019 can be dynamically coupled to the aquatic eco dynamics library aed hipsey et al 2013 for modeling the hydrodynamics and biogeochemical processes in a variety of lentic water bodies such as deep and shallow lakes reservoirs mining pit lakes wastewater ponds and urban wetlands glm aed model was well suited for this study because of its 1 freely and open source availability which encourages future reproduction of the current study 2 the 1d assumption that the vertical gradients are significantly larger than the horizontal ones is valid for the study sites as previously assessed soares et al 2020 and 3 recent applications in peer review studies bucak et al 2018 farrell et al 2020 fenocchi et al 2019 ladwig et al 2018 snortheim et al 2017 weng et al 2020 glm simulates the vertical profiles of temperature salinity and density by accounting for the effect of inflows and outflows on the water balance in addition to surface heating and cooling energy balance and vertical mixing the equations are based on assumptions that are common to previous model applications hamilton and schladow 1997 imberger and patterson 1990 a flexible lagrangian layer structure is used to discretize the water column into horizontal layers with homogeneous physical properties the layer thickness can change by contraction and expansion in response to inflows outflows mixing with adjacent layers and surface mass fluxes the thermal processes of stratification and mixing are computed from the water balance and the energy budget at every time step the water balance accounts for the effects of surface mass fluxes inflows and outflows the energy budget is calculated based on the balance between kinetic and potential energy the available kinetic energy is calculated due to contributions from wind stirring shear production between layers convective overturn and kelvin helmholtz billowing when sufficient turbulent kinetic energy becomes available to overcome stable density gradients then layers merge thereby accounting for the process of mixing hipsey et al 2019 the vertical profile of temperature and the incident shortwave radiation are provided by glm as input to aed at every time step of the simulation they are used for the computation of temperature dependent chemical and biological processes as well as to adjust the light extinction coefficient finally the light extinction coefficient is provided from aed to glm in the next time step of simulation for calculations of the thermal processes aed comprises numerous modules that are designed as individual components allowing for different conceptualizations either simple or complex model components are able to simulate dissolved oxygen do carbon c nitrogen n phosphorus p and silica cycles including organic matter inorganic suspended solids and several functional groups of phytoplankton and zooplankton 2 3 model configuration the general lake model v 2 2 0 was coupled to the aquatic eco dynamics v 4 for the simulation of hydrodynamics and biogeochemical processes in bb pr and ti reservoirs a baseline simulation was run for each reservoir based on a previous application of glm calibrated and validated in which water temperature was simulated accurately and model efficiency was similar across the three reservoirs indicating a robust fit for glm rmse of 1 81 c 1 80 c and 1 42 c and r of 0 83 0 87 and 0 88 for bb pr and ti reservoirs respectively soares et al 2020 all aed parameters were set at their initial values based on hipsey et al 2013 being identical between reservoirs the period of simulation was from the first day with field measurements in 2008 15th january for bb and 12th february for pr and ti to 31st december 2016 with a 1 h time step the statistical software r 3 2 5 was used to simulate and analyses modeling results through the packages glmr hipsey et al 2014 and glm tools read et al 2014 the conceptual model included hydrodynamic processes computed by glm and aed modules of sedimentation fluxes dissolved oxygen carbon nitrogen phosphorus organic matter phytoplankton and suspended solids the dominant geochemical processes in the water column were represented fluxes between water sediment interface constant sediment flux mineralization of dissolved organic matter hydrolysis of particulate organic matter sedimentation of particulate organic matter nitrification denitrification and phytoplankton primary production respiration vertical movement excretion and mortality the phytoplankton composition was limited to include only one group due to the absence of biomass data reported by groups all chlorophyll a concentration was simulated as cyanobacteria the dominant functional group in all three reservoirs cetesb 2019 santos 2010 fixed c n and c p ratios were assumed to model nutrient limitation with a half saturation constant representing the effect of external nutrient concentrations on the phytoplankton growth rate the conceptual diagram of the current application is illustrated in fig 2 2 4 required data glm requires the following input data i reservoir s bathymetry ii meteorological time series iii inflow and outflow discharges and iv inflow temperature and salinity in addition the following physical variables in the water body are required for setting initial conditions for the first day of the simulation and for model performance assessment vertical profile of water temperature and salinity water level and the light extinction coefficient estimated from secchi depth measurements the hypsographic curve of each reservoir was extracted from the bathymetric survey performed by previous studies bb reservoir corrêa filho et al 2003 pr reservoir maia 2006 ti reservoir albertin et al 2010 terrestrial based meteorological stations operated by the national institute of meteorology inmet 2020 provided hourly time series of air temperature wind speed solar radiation air relative humidity and rainfall green markers a c in fig 1 the missing values were filled by linear regression with data from a meteorological station with high correlation coefficient r 0 72 p value 0 05 cloud cover data was not available and it was estimated by glm through the bird clear sky model daily hydrological data inflow and outflow discharge and water level were provided by the national water agency ana 2018 gaps in daily inflow and outflow discharge were rare less than 0 6 of total data and they were filled by linear interpolation inflow temperature and electrical conductivity which was used for the estimation of inflow salinity were measured generally every two months by the environmental company of the state of são paulo cetesb at their main tributaries purple markers a d in fig 1 ana 2019 due to the small salinity content and its low influence in freshwater systems its mean value below 0 2 pss was assumed for the entire simulation period time series of meteorological and hydrological input data for each reservoir is presented in figure s1 in the supplementary material and box plots are used to present monthly means and range of glm input data across all three reservoirs during the simulation period 2008 2016 fig 3 all the assumptions made as well as all the processing of the physical variables required by the hydrodynamic model were assumed exactly the same as a previous application of glm for these reservoirs further detailed description is provided by soares et al 2020 aed requires the daily inflow nutrient concentrations as input data in addition the state variables measured in the water body are required for setting initial conditions for the first day of the simulation and for performance assessment input loads of do nitrate no3 ammonium nh4 total phosphorus tp and chlorophyll a were measured in the tietê river stations a c d in fig 1 and the piracicaba river station b every two months by cetesb purple markers a d in fig 1 ana 2019 given the absence of measured daily input loads a simplification was assumed by computing the average concentration throughout the rainy season from october to march when 80 of annual rainfall occurs and the dry season from april to september for each year of simulation the separation by season was selected in face of the remarked differences regarding inflow discharge and the consequent capacity of nutrient dilution thus the average seasonal value was assumed as a constant for each season nutrient concentrations in minor tributaries were neglected due to the lack of field data time series of water quality input data for each reservoir is presented in figure s2 in the supplementary material and box plots are used to present seasonal means and range of aed input data across all three reservoirs during the simulation period 2008 2016 fig 4 water temperature salinity secchi depth do no3 nh4 tp chlorophyll a and ph were collected from one monitoring station located at a central location in each reservoir yellow markers 1 3 in fig 1 measurements were performed every two months by cetesb 2019 at water surface 2 5 sensitivity and identifiability analyses a local sensitivity and identifiability analyses were applied for the baseline simulation of barra bonita reservoir promissão reservoir and três irmãos reservoir with reference to five state variables do tp no3 nh4 and chlorophyll a a set of 64 aed parameters table 2 was selected for characterizing the entire system glm parameters were not included because their sensitivity analysis was previously assessed for the current study sites soares et al 2020 the one at a time oat method was adopted by quantifying the effect of the variation of a given parameter on the model output while all other parameters were kept at their initial values the local approach was selected based on 1 its simple and intuitive capability to imply that whatever effect observed on the model outputs can be safely attributed to the altered parameter 2 its low computational cost and 3 the local analysis being the state of the art in environmental disciplines as the oat method by far still prevails while a small fraction of studies adopts a global approach ferretti et al 2016 the conventional variation by a fixed percentage of the initial parameter value e g 10 bucak et al 2018 20 bruce et al 2018 and 50 rangel peraza et al 2016 is problematic first because the model response to parameter variations is nonlinear then small initial values lead to a small variation while high initial values lead to a large variation second if the initial parameter value is located nearby the upper or lower bound of the range the variation can lead to inadmissible values beyond the valid boundaries of the range lenhart et al 2002 as the sensitivity of the model output can be significantly different according to the selected perturbation range yi et al 2016 instead of increase and decrease parameter values by a defined percentage each parameter s entire range of possible values was defined by the minimum and maximum values found in previous applications of one dimensional lake models in order to assess true parameter sensitivities table 2 the same initial value 1 08 and range 1 02 1 14 were applied for all temperature multipliers aiming at a better comparison of their impact on each biogeochemical process the sensitivity of the model output to parameters values changing was quantified using a normalized sensitivity indicator si equal to the ratio between the change in a model output variable compared to the baseline model output for the respective variable and the change in model parameter compared to its initial value calculated as 1 s i δ y y δ x x where y is the state variable concentration for the reference value x of the parameter which has a variation δx from its maximum value to its minimum value in a single step i e δx xmaximum xminimum generating a model performance variation δy the identifiability of the model output to parameters values changing was computed by an identifiability indicator using the same eq 1 where y is the model performance the objective function applied for model performance assessment was the root mean square error rmse calculated as 2 r m s e i 1 n s i o i 2 n where n is the number of observations oi and si are the ith observed and simulated data respectively as the 64 parameters were varied from the maximum value to the minimum value in a single step 128 simulations were run for each reservoir thus resulting in a total of 384 simulations a value of si equal to 1 or 1 indicates a proportional change of the model output for the respective change of a model parameter value the sensitivity index was classified according to lenhart et al 2002 into four classes 0 s i 0 05 is small to negligible 0 05 s i 0 20 is medium 0 20 s i 1 00 is high and s i 1 00 is very high the first year of simulation 2008 was considered as a warm up period and thus it was not included to ensure the independence of the simulation results from the initial conditions 3 results in total the sensitivity analysis resulted in 960 values of si which ranged from 13 8 to 29 8 revealing the most critical parameters that govern the simulated water quality outputs in each site a minority of 18 parameter changes resulted in si values within the negligible range i e s i 0 05 in all three reservoirs while the others 46 parameter changes resulted in some sensitivity in model output for at least one of the five state variables fig 5 a overall the sensitivity of model outputs to perturbations of the parameters was quite similar across reservoirs the sensitivity analysis showed that the state variables were strongly affected by 18 out of 20 parameters related to the phytoplankton module additionally it was revealed the importance of temperature multipliers as the state variables presented at least medium sensitivity to the vast majority of them also model outputs displayed considerable sensitivity to the settling rate of organic matter w pon w pop and w poc in contrast a negligible sensitivity was found to most mineralization parameters the performance metric based approach also resulted in 960 identifiability indicators revealing which parameters can be perturbed to improve model fit to in situ data thus indicating on where to focus the calibration effort fig 5b for some specific parameters despite model outputs being highly sensitive the identifiability analysis revealed that their change could promote only a small effect on model performance for instance that was the case for the settling rate of organic matter w pon w pop w poc the sedimentation flux for particulate organic phosphorus pop and dissolved organic phosphorus dop fsed pop fsed doc the saturating light intensity i s the fraction of primary production lost to exudation f pr the fractions of metabolic loss that are respiration and dissolved organic matter f fres k fdom the nutrient concentration below which uptake is zero n o p o and the constant internal nutrient concentration x ncon x pcon common identifiability features could be quantified between reservoirs 1 for dissolved oxygen concentration the temperature multipliers are relevant to optimize its performance metric however there was some effect of varying other parameters on do concentration particularly the sedimentation flux for do no3 and dissolved organic carbon doc fsed oxy fsed nit fsed doc and the phytoplankton growth and respiration rates at 20 c r growth r resp 2 rmse of the nitrogen related output variables nh4 and no3 was attributed mainly to parameters associated with the specific output i e parameters that are part of the equations used to calculate the output variable in question for instance ammonium was strongly determined by the sedimentation flux for nh4 fsed amm nitrification rate r nitrif half saturation constant of nitrification k nitrif and temperature multipliers of nitrification and sediment nh4 flux theta nitrif theta sed amm similarly nitrate was found to be determined by sedimentation flux for no3 fsed nit and temperature multiplier of sediment no3 flux theta sed nit whereas all other parameters had a little effect on this modeled variable 3 in contrast total phosphorus performance metric was mostly affected by parameters that are not directly related to it such as temperature multipliers of sediment nh4 flux and doc mineralization theta sed amm theta doc miner thereby demonstrating the usefulness of the method for exploring the ecosystem the identifiability analysis shares some similarity for the five constituents although clear disparities existed the most notable difference between reservoirs is related to the chlorophyll a concentration while none parameter was identified as relevant in promissão reservoir regarding chlorophyll a at water surface there were thirteen parameters affecting chlorophyll a in barra bonita reservoir all of them from the phytoplankton sub model except for temperature multipliers of doc mineralization and sediment nh4 flux theta doc miner theta sed amm in três irmãos reservoir however the performance metric of chlorophyll a was affected by 35 out of 64 parameters 55 relative to all the sub models components 4 discussion 4 1 similarities between reservoirs the results successfully distinguished the influential parameters for each state variable the temperature multipliers were found as an important factor for the model outputs in barra bonita promissão and três irmãos reservoirs being more influential than their corresponding parameters indeed the temperature coefficients were higher than their related rates for sediment fluxes theta sed oxy fsed oxy theta sed amm fsed amm and theta sed frp fsed frp nitrification theta nitrif rnitrif denitrification theta denit rdenit hydrolysis theta pop miner rpop miner and mineralisation theta don miner rdon miner and theta doc miner rdoc miner the same features were observed for phytoplankton respiration theta resp r resp ecologically this means that water temperature is a dominant driver of simulated water quality outputs by governing many temperature dependent biochemical and physiological processes such as kinetic rates of nutrient transformations and phytoplankton metabolism ultimately seasonality from meteorological drivers is an important input for ecosystem phenology the importance of temperature multipliers influencing state variables as indicated in the sensitivity analysis might be attributed to the regional subtropical climate resulting in quite warm surface waters in the study sites which varied in a range of 16 7 30 9 c in bb reservoir 18 5 33 4 c in pr reservoir and 20 6 32 0 c in ti reservoir soares et al 2020 in this study the entire range of possible values for the temperature multipliers was defined based on values found in previous applications of one dimensional lake models regardless of the site characteristics due to the absence of references from subtropical systems given that parameter uncertainty ranges were not chosen to correspond to site characteristics the uncertainties are greater than what s true for the system which could inflate the sensitivity index metrics in this manner further work is required to define the adequate range of temperature multipliers specifically for subtropical systems despite the parameter uncertainty ranges did not precisely correspond to site characteristics we believe that a different range could refine the results but would not be able to change the high influence of temperature multipliers on model outputs in line with the high sensitivities found for temperature multipliers in simulated biogeochemical dynamics the importance of suitable water temperature is corroborated by the fact that the optimum and maximum temperature were consistently sensitive for the three reservoirs as the temperature multipliers directly affects the response of biogeochemical rates to water temperature potential implications can be foresee in respect to climate change and water warming globally o reilly et al 2015 the important parameters for improving dissolved oxygen performance metric are consistent with qualitative expectations on the basis of the conceptual model do was most affected by parameters that directly affect oxygen utilization in the water column and in the sediments temperature multipliers of nitrification doc mineralization and sediment do flux theta nitrif theta doc miner theta sed oxy and sedimentation flux for do no3 and doc fsed oxy fsed nit fsed doc another informative trend is the strong influence of parameters that indirectly control photosynthetic oxygen production by changing the growth of phytoplankton including growth and respiration rates r growth r resp temperature multipliers for growth and respiration theta growth theta resp and optimum and maximum temperatures theta opt theta max changing phytoplankton growth rate and its temperature multiplier r growth theta growth respiration rate and its temperature multiplier r resp theta resp and optimum and maximum temperature limitation theta opt theta max parameters affected simulated dissolved oxygen and nutrient concentrations whereas parameters related to phytoplankton nutrient uptake had a minimal effect on optimizing the performance metric of state variables the processes of hydrolysis of particulate organic matter into dissolved organic matter and its mineralisation into dissolved inorganic matter appeared highly robust against the parameterization as perturbations of the initial values of hydrolysis rates rpon miner rdon miner rpop miner rdop miner rpoc miner rdoc miner and half saturation constant for breakdown kpon miner kpop miner kpoc miner or mineralization kdon miner kdop miner and kdoc miner rarely produced considerable changes in the performance metric of state variables in face of the consistency of the abovementioned similarities between reservoirs it is expected that the sensitive parameters found in this study could be quite transferable to other reservoirs with the same climate condition 4 2 disparities between reservoirs as expected the sensitivity analysis revealed a consistent response of model outputs to parameters related to the phytoplankton module since all reservoirs are subjected to the same kinetic processes and functional group of phytoplankton thus the dynamic behavior is controlled by almost the same sensitive parameters however remarkable differences appeared on the identifiability analysis regarding chlorophyll a in each reservoir most noticeably in bb and pr reservoirs chlorophyll a was not considerably affected by any parameter out of the phytoplankton sub model except for temperature multipliers of sediment nh4 flux and doc mineralization theta sed amm theta doc miner in bb reservoir the minimum influence of parameters changes on chlorophyll a output may be attributed to the trophic condition in the water bodies as both of them are nutrient rich parameter changes in the assigned range were not enough to provoke considerable changes in chlorophyll a in face of the high availability of tp nh4 and no3 in water surface in contrast in the oligotrophic ti reservoir chlorophyll a was affected by 24 parameters out of 44 55 from the sedimentation flux dissolved oxygen nitrogen phosphorus and organic matter sub models additionally the importance of nutrient related processes for chlorophyll a concentration in ti reservoir was confirmed by the high identifiability indicator for parameters that are related to key mechanisms for regulating nutrient recycling rates such as denitrification nutrient sedimentation fluxes and mineralization of particulate organic phosphorus temperature multipliers of denitrification sediment flux of nh4 no3 po4 and pop mineralization theta denit theta sed amm theta sed nit theta sed frp theta pop miner the differences in model behavior particularly the importance of several parameters for optimizing chlorophyll a in ti reservoir demonstrate that oligotrophic ecosystems are more susceptible to parameterization than meso and eutrophic reservoirs are possibly because eutrophic systems are saturated with nutrients and thus small changes in model parameters are not enough to promote any significant impact on the chlorophyll a prediction the performance metric of chlorophyll a was surprisingly less influenced by the assumed variations in parameters related to the phytoplankton sub model in promissão reservoir however quite similar response was found between bb and ti reservoirs the dynamics of the chlorophyll a at water surface is influenced by the parameters that are related to growth water temperature uptake of phosphorus and more pronounced to autotrophic respiration growth and respiration rates and their temperature multipliers r growth r resp theta growth theta resp standard optimum and maximum temperature theta std theta opt theta max and constant internal phosphorus concentration x pcon the strong influence of parameters that directly alter growth rates and the uptake of phosphorus on chlorophyll a is a common found in the literature darko et al 2019 jones et al 2018 schladow and hamilton 1997 the few exceptions to the similarities between bb and ti reservoirs are the saturating light intensity i s the metabolic loss by excretion to the dissolved organic pool k fdom and the nutrients concentration below which uptake is zero n o p o the moderate influence of light penetration in the water column observed only in bb reservoir can be explained by its poly mictic regime in waters with strong vertical mixing a higher turbidity along the water column reduces transparency resulting in a shallower euphotic zone ultimately affecting the sufficient sunlight for photosynthesis indeed the turbidity was higher in bb reservoir on average 17 3 ntu thus resulting in a lower transparency on average 1 3 m with comparison to the other reservoirs 15 4 ntu and 2 2 m in pr reservoir and 2 0 ntu and 3 9 m in ti reservoir cetesb 2019 the influence of nutrients concentration below which uptake is zero was found only in ti reservoir and can also be explained by the different trophic status between bb and ti reservoirs as discussed above on the basis of the variabilities found for chlorophyll a identifiability it becomes clear that this analysis is required to determine the most influential parameters for a particular water body 4 3 implications for model calibration the outcomes of the sensitivity analysis provided a quantitative measure of the sensitivity of the output variables to the parameters changes highlighting which parameters exert stronger controls on the model s behavior the identifiability analysis was of paramount importance to distinguish which ones can be perturbed to improve the model goodness of fit metric the majority of parameters being medium or high influential on model performance as found in this study clearly indicate that there is a potential uncertainty in their values that should be determined by a calibration procedure to improve model accuracy based on the identifiability analysis a posteriori calibration can concentrate on medium and or high sensitive parameters given their large influence on the governing processes of the ecosystem for instance the number of model parameters to be included in a calibration could be reduced from 64 to 22 in bb reservoir 15 in pr reservoir and 39 in ti reservoir table 3 in view of the still high number of influential parameters on model performance particularly for ti reservoir the efficiency of calibration could benefit by selecting parameters from a descending order of influence i e firstly prioritizing high influential parameters and if needed include other parameters following their identifiability indicator this guidance is valid for a calibration procedure that applies parameter ranges assigned in this study as we adopted the entire range of parameter values found in previous applications of one dimensional lake models it suggests that the present results may find a widespread applicability however the importance of temperature multipliers is likely to be valid only for low latitude systems where regional subtropical climate results in quite warm surface waters it is worth noting that complex models such as glm aed are often subject to equi finality or non uniqueness indicating that there is not a single or unambiguous value to the model parameterization beven 2006 hence during a posterior model calibration there can exist several parameter sets that provide equally suitable model responses to a given measure of goodness of fit between simulated and measured values the identifiability of model outcomes to dissolved oxygen and nutrients have a more generalizable nature as some of the medium high and very high sensitive parameters such as sedimentation no3 flux fsed nit and temperature multipliers for nitrification sediment flux of nh4 no3 and po4 and pop mineralization theta nitrif theta sed amm theta sed nit theta sed frp theta pop miner to cite some are often recognized as sensitive and used as tuning parameters for calibration in different lakes and reservoirs worldwide e g fenocchi et al 2019 gal et al 2009 me et al 2018 snortheim et al 2017 in the case of chlorophyll a in pr reservoir given the low identifiability of the model output to changes in all parameter values it is claimed that the calibration of do and nutrients will be enough to achieve a good performance of chlorophyll a simulation 4 4 limitations of the sensitivity and identifiability analyses for the purpose of this study a local sensitivity and identifiability analyses were conducted on selected model parameters using a one at a time method this approach is computationally very efficient compared to more demanding techniques and chosen in most practical cases both analyses were able to provide the sub set of most influential parameters revealing consistent similarities between reservoirs regarding nutrients parameters as well as the particular sensitivities directly influenced by both the thermal regime and the trophic state which should be assessed individually additionally the method provided insights for supporting a posteriori calibration procedure literature defined ranges were not found for some parameters see table 2 and hence the 10 range from the initial value was adopted which might not captured the real uncertainty of the parameters the one at a time method comprises a relatively simplistic process representation as it is unable to capture the interactions between parameters in such a complex ecological model hence the method only explores a fraction of the input space of variations in parameter values to overcome the inability of the local approach to account for interactions between parameters a multi parameter or a global analysis is required for a complete understanding on how a complex and nonlinear model behaves saltelli et al 2008 in global sensitivity analysis such as the monte carlo approach all model parameters are iteratively adjusted within value ranges resulting in several even thousands of simulations alternatively the morris method morris 1991 is based on the one at a time approach but is classified as a global sensitivity analysis because it samples partial derivatives at multiple locations in the input space while the local approach does not capture some aspects of nonlinearity that can be captured by the global approach we suggest that it is advantageous to consider the local analysis in model evaluation possibly as a preliminary step to provide insights which can be used to improve the design of more demanding methods 5 conclusions the one at a time method was implemented to conduct a local sensitivity and identifiability analyses for a coupled hydrodynamic biogeochemical model glm aed in three subtropical reservoirs the analyses focused on the response of five water quality constituents including do tp nh4 no3 and chlorophyll a to 64 parameters the study shows the capability of the sensitivity analysis to explicitly identify the input parameters that exert the most influence on model outputs according to a defined perturbation range in addition the identifiability analysis revealed the most influential parameters on model performance three important insights were gained through the present analyses first the model behavior could be explained largely based on water temperature as a subset of eight temperature multipliers were consistently high sensitive although these results are specific to bb pr and ti reservoirs this outcome is likely to be an indicator that those dominant parameters are generally important and their sensitivity would be also valid to other similar systems second the patterns of parametric control on chlorophyll a were somewhat unique for each reservoir the differences were attributed to their thermal regime either poly mictic or mono mictic and their trophic status either oligo meso or eutrophic which suggests the importance of conducting systematic identifiability analysis for a specific water body to acquire additional insights into the dynamics of the particular system finally the high number of influential parameters on model performance confirms the need of the calibration procedure aiming at reducing parameter uncertainties and increasing model accuracy for a proper representation of the real ecosystems this study supplies a deep understanding of the simulated governing ecosystem dynamics particularly for the fact that the reservoirs are located in a subtropical climate as a means to overcome the limited information from the subtropics additionally the analysis further provides a potential guidance for prioritizing research efforts by reducing the number of parameters that require calibration in our future work we will calibrate the model for each reservoir based on the sensitivity and identifiability results for better supporting future management decisions in the cascade reservoirs of the tietê river credit authorship contribution statement l m v soares conceptualization formal analysis investigation methodology software writing original draft m c calijuri supervision validation writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national council for scientific and technological development cnpq additionally we are grateful to the national institute of meteorology inmet the national water agency ana and the environmental company of the state of são paulo cetesb for the available data supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2021 109720 appendix supplementary materials image application 1 
24563,sensitivity and identifiability analyses 3 results 4 discussion 4 1 similarities between reservoirs 4 2 disparities between reservoirs 4 3 implications for model calibration 4 4 limitations of the sensitivity and identifiability analyses 5 conclusions credit authorship contribution statement acknowledgements appendix supplementary materials albertin 2010 57 67 l baroni 2014 26 34 g beven 2006 18 36 k borgonovo 2016 869 887 e bruce 2018 274 291 l bucak 2018 802 816 t bueche 2019 1 41 t burger 2008 411 423 d cariboni 2007 167 182 j correafilho 2003 79 90 c cui 2016 146 157 y darko 2019 73 86 d douglassmith 2020 124 d farrell 2020 109134 k fenocchi 2019 38 51 a ferretti 2016 666 670 f frassl 2019 181 187 m gal 2014 246 248 g gal 2009 1697 1718 g gupta 2018 8692 8717 h hamby 1994 135 154 d hamilton 1997 91 110 d hipsey 2019 473 523 m imberger 1990 303 476 j advancesinappliedmechanics physicallimnology jones 2018 444 455 h kara 2012 104 121 e ladwig 2018 10 r ladwig 2020 1 45 r lenhart 2002 645 654 t maia 2006 a conssequencessiltinginoperationreservoirsformedbydamsconsequenciasassoreamentonaoperacaodereservatoriosformadosporbarragensthesispostgraduateprograminhydraulicssanitation me 2018 114 133 w morris 1991 161 174 m nelson 2020 129 n norton 2015 166 174 j oreilly 2015 773 781 c ozkundakci 2011 165 185 d pianosi 2016 214 232 f rangelperaza 2016 81 92 j read 2014 142 150 j robson 2014 287 296 b romero 2004 143 160 j rotta 2021 106913 l saltelli 2019 29 39 a saltelli 2008 a journalchemicalinformationmodeling globalsensitivityanalysisprimer santos 2010 r structurephytoplanktonzooplanktoncommunitiesenphasiszooplanktonicsecondaryproductionrelatedenvironmentalfactorsinreservoirslowtieteriverspestruturadascomunidadesfitoplanctonicaezooplanctonicamastersthesispostgraduateprograninecologynaturalresources schladow 1997 111 123 s schmolke 2010 479 486 a shimoda 2016 29 43 y snortheim 2017 39 53 c soares 2020 134 l tan 2018 4681 4699 z uusitalo 2015 24 31 l watanabe 2019 581 590 f weber 2017 96 105 m weng 2020 106556 w yi 2016 74 84 x soaresx2021x109720 soaresx2021x109720xl 2023 08 28t00 00 00 000z 2023 08 28t00 00 00 000z http creativecommons org licenses by nc nd 4 0 2021 elsevier b v all rights reserved 2021 08 31t23 43 04 325z http vtw elsevier com data voc addontypes 50 7 aggregated refined national council for scientific and technological development cnpq conselho nacional de desenvolvimento científico e tecnológico http data elsevier com vocabulary scivalfunders 501100003593 http sws geonames org 3469034 inmet national institute of meteorology cetesb environmental company of the state of s o paulo national water agency ana agência nacional de águas http data elsevier com vocabulary scivalfunders 100009095 http sws geonames org 3469034 this work was supported by the national council for scientific and technological development cnpq additionally we are grateful to the national institute of meteorology inmet the national water agency ana and the environmental company of the state of s o paulo cetesb for the available data this work was supported by the national council for scientific and technological development cnpq additionally we are grateful to the national institute of meteorology inmet the national water agency ana and the environmental company of the state of são paulo cetesb for the available data 0 https doi org 10 15223 policy 017 https doi org 10 15223 policy 037 https doi org 10 15223 policy 012 https doi org 10 15223 policy 029 https doi org 10 15223 policy 004 item s0304 3800 21 00274 x s030438002100274x 1 s2 0 s030438002100274x 10 1016 j ecolmodel 2021 109720 271743 2021 09 14t03 54 49 297988z 2021 10 15 1 s2 0 s030438002100274x main pdf https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x main application pdf eca30ce80715a26f556177db8cdb61a2 main pdf main pdf pdf true 2521630 main 13 1 s2 0 s030438002100274x main 1 png https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x preview image png 2fb212bbe928887b06708f015505b1e5 main 1 png main 1 png png 58426 849 656 image web pdf 1 1 s2 0 s030438002100274x gr1 jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr1 downsampled image jpeg 210a82053842c654313953b66fb2411b gr1 jpg gr1 gr1 jpg jpg 75273 400 753 image downsampled 1 s2 0 s030438002100274x gr2 jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr2 downsampled image jpeg 6069d4ba271e32d21a1019efb9e80f9e gr2 jpg gr2 gr2 jpg jpg 57446 440 690 image downsampled 1 s2 0 s030438002100274x gr3 jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr3 downsampled image jpeg a73084cd34456ed14fecdfd83d5d8e28 gr3 jpg gr3 gr3 jpg jpg 95776 350 801 image downsampled 1 s2 0 s030438002100274x gr4 jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr4 downsampled image jpeg b35a427b0b28480af3e764b2add4b08e gr4 jpg gr4 gr4 jpg jpg 79539 500 710 image downsampled 1 s2 0 s030438002100274x gr5 jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr5 downsampled image jpeg e05fb4a6063a2d0428fb4325ea4da014 gr5 jpg gr5 gr5 jpg jpg 277200 997 732 image downsampled 1 s2 0 s030438002100274x gr1 sml https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr1 thumbnail image gif 52e9281e46b736895ba9fad2b6e0f4e8 gr1 sml gr1 gr1 sml sml 11161 116 219 image thumbnail 1 s2 0 s030438002100274x gr2 sml https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr2 thumbnail image gif 3410c54e85e9f35de666524d614d7b7e gr2 sml gr2 gr2 sml sml 10480 140 219 image thumbnail 1 s2 0 s030438002100274x gr3 sml https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr3 thumbnail image gif 4b1c12600ba22e4fc5164babbe174852 gr3 sml gr3 gr3 sml sml 11585 96 219 image thumbnail 1 s2 0 s030438002100274x gr4 sml https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr4 thumbnail image gif 31106cd617d2aa00c7ed9359a1ad307d gr4 sml gr4 gr4 sml sml 10612 154 219 image thumbnail 1 s2 0 s030438002100274x gr5 sml https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr5 thumbnail image gif cdf91d60b9db6ff9b0f530fb4e58b5bc gr5 sml gr5 gr5 sml sml 17422 163 120 image thumbnail 1 s2 0 s030438002100274x gr1 lrg jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr1 highres image jpeg 396eb1df62e7949e20e7cd1fbafaaf3c gr1 lrg jpg gr1 gr1 lrg jpg jpg 513911 1769 3333 image high res 1 s2 0 s030438002100274x gr2 lrg jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr2 highres image jpeg 29adee0b918beef237a8e91ba593c7c0 gr2 lrg jpg gr2 gr2 lrg jpg jpg 436499 1949 3054 image high res 1 s2 0 s030438002100274x gr3 lrg jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr3 highres image jpeg 793d9a73ce29ea7ecfe2a554b80cc68e gr3 lrg jpg gr3 gr3 lrg jpg jpg 614588 1550 3548 image high res 1 s2 0 s030438002100274x gr4 lrg jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr4 highres image jpeg dbe31ddecc408c417aa56883b8c2d595 gr4 lrg jpg gr4 gr4 lrg jpg jpg 474729 2213 3144 image high res 1 s2 0 s030438002100274x gr5 lrg jpg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x gr5 highres image jpeg 56a025fe58019264623509e42c8a0491 gr5 lrg jpg gr5 gr5 lrg jpg jpg 1573150 4417 3242 image high res 1 s2 0 s030438002100274x mmc1 docx https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x mmc1 main application vnd openxmlformats officedocument wordprocessingml document 83e78ef6afb026d1966864081c4c9fd3 mmc1 docx mmc1 mmc1 docx docx 7207026 application 1 s2 0 s030438002100274x si1 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml 99b8b8ef3f3e5ae69ebb1d0e6cdf66aa si1 svg si1 si1 svg svg 531 altimg 1 s2 0 s030438002100274x si2 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml fc87ab7862576a0f75fabe0e2ed35a5b si2 svg si2 si2 svg svg 4317 altimg 1 s2 0 s030438002100274x si3 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml c351e3eda95bdf42462196388f160399 si3 svg si3 si3 svg svg 9408 altimg 1 s2 0 s030438002100274x si4 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml f707da1519ee7a815ea07c9f6db08c47 si4 svg si4 si4 svg svg 4099 altimg 1 s2 0 s030438002100274x si5 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml 477923eddccace2d4114671b662d3b11 si5 svg si5 si5 svg svg 4767 altimg 1 s2 0 s030438002100274x si6 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml badf8cf69dcbf0bf56862349ac4815d0 si6 svg si6 si6 svg svg 4333 altimg 1 s2 0 s030438002100274x si7 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml 4f7cc8861188d8ed4b3f42f169cded29 si7 svg si7 si7 svg svg 3421 altimg 1 s2 0 s030438002100274x si8 svg https s3 eu west 1 amazonaws com prod ucs content store eu west content pii s030438002100274x stripin image svg xml 838a1673655650ad3089f630ca7f8abf si8 svg si8 si8 svg svg 3805 altimg 1 s2 0 s030438002100274x am pdf https s3 eu west 1 amazonaws com prod ucs content store eu west content egi 10sp3d3hrpw main application pdf 0578cf3a8dde7a3873ff7e1dd76ba8f8 am pdf am am pdf pdf false 1165791 aam pdf ecomod 109720 109720 s0304 3800 21 00274 x 10 1016 j ecolmodel 2021 109720 elsevier b v fig 1 location of the study sites in southeast brazil monitoring stations and their bathymetry bb is barra bonita reservoir pr is promissão reservoir and ti is três irmãos reservoir fig 1 fig 2 conceptual diagram of glm aed model for the current application the white boxes are state variables phytoplankton phyto ammonium nh4 nitrate no3 filterable reactive phosphorus po4 dissolved inorganic carbon dic dissolved organic nitrogen don dissolved organic phosphorus dop dissolved organic carbon doc particulate organic nitrogen pon particulate organic phosphorus pop particulate organic carbon poc and dissolved oxygen do fig 2 fig 3 monthly input data across barra bonita reservoir promissão reservoir and três irmãos reservoir based on hourly meteorological measurements and daily hydrological measurements from 2008 to 2016 air temperature wind speed rainfall relative humidity solar radiation inflow discharge outflow discharge and inflow temperature horizontal lines represent the median 25th and 75th percentiles whiskers indicate the 5th and 95th percentiles fig 3 fig 4 seasonal input loads across barra bonita reservoir bb promissão reservoir pr and três irmãos reservoir ti based on bi monthly measurements from 2008 to 2016 dissolved oxygen nitrate ammonium total phosphorus and chlorophyll a horizontal lines represent the median 25th and 75th percentiles whiskers indicate the 5th and 95th percentiles fig 4 fig 5 sensitivity indicator a and identifiability indicator b for 64 parameters in barra bonita bb promissão pr and três irmãos ti reservoirs based on a 8 year period relative to a dissolved oxygen b total phosphorus c ammonium d nitrate and e chlorophyll a concentration fig 5 table 1 morphometric features aestietê 2019 cesp 2013 mixing regime soares et al 2020 trophic status rotta et al 2021 watanabe et al 2019 and water quality features cetesb 2019 for all reservoirs table 1 barra bonita promissão três irmãos abbreviation bb pr ti initial operation 1964 1975 1991 elevation m a s l 451 5 384 0 328 0 maximum volume 109 m3 3 16 8 11 11 46 surface area at crest km2 226 522 654 maximum depth m 23 5 24 5 45 6 hydraulic residence time days 91 141 442 mixing regime polymictic monomictic monomictic trophic status meso hypereutrophic mesotrophic oligotrophic dissolved oxygen mg l 1 6 72 3 00 7 44 1 54 7 18 0 77 total phosphorus mg l 1 0 18 0 20 0 05 0 07 0 02 0 01 ammonium mg l 1 0 42 0 42 0 17 0 09 0 16 0 06 nitrate mg l 1 3 12 1 15 0 87 0 34 0 45 0 22 chlorophyll a µg l 1 40 64 66 97 24 13 50 93 3 82 2 61 table 2 description of aed parameters their units initial values hipsey et al 2013 and range for the sensitivity analysis table 2 symbol description unit initial value range sedimentation flux fsed oxy sedimentation flux for dissolved oxygen mmol m 2 d 1 6 00 20 00 a 87 50 b fsed amm sedimentation flux for ammonium mmol m 2 d 1 3 00 0 01 a 22 16 c fsed nit sedimentation flux for nitrate mmol m 2 d 1 14 00 14 00 1 87 d fsed frp sedimentation flux for filterable reactive phosphorus mmol m 2 d 1 0 12 0 001 a 0 84 b fsed pop sedimentation flux for particulate organic phosphorus mmol m 2 d 1 0 01 0 01 0 a fsed dop sedimentation flux for dissolved organic phosphorus mmol m 2 d 1 0 03 0 001 a 0 10 a fsed poc sedimentation flux for particulate organic carbon mmol m 2 d 1 0 01 0 009 0 011 fsed doc sedimentation flux for dissolved organic carbon mmol m 2 d 1 30 00 0 01 c 30 00 fsed ch4 sedimentation flux for methane mmol m 2 d 1 0 00 0 10 00 a dissolved oxygen ksed oxy half saturation constant of sediment oxygen flux mmol m 3 15 6 6 8 a 51 6 c theta sed oxy temperature multiplier for sediment oxygen flux 1 08 1 02 d 1 14 d nitrogen rnitrif maximum reaction rate of nitrification at 20 c d 1 0 03 0 01 b 0 34 e rdenit maximum reaction rate of denitrification at 20 c d 1 0 01 0 0005 e 0 50 f knitrif half saturation constant for oxygen dependence of nitrification mmol m 3 62 5 12 5 d 93 7 e kdenit half saturation constant for oxygen dependence of denitrification mmol m 3 15 6 12 5 e 18 0 a ksed amm half saturation constant of ammonium flux mmol m 3 15 6 15 0 a 65 7 c ksed nit half saturation constant of nitrate flux mmol m 3 15 6 15 0 a 23 4 d theta nitrif temperature multiplier for temperature dependence of nitrification 1 08 1 02 e 1 14 e theta denit temperature multiplier for temperature dependence of denitrification 1 08 1 02 1 14 theta sed amm temperature multiplier for sediment ammonium flux 1 08 1 02 1 14 c theta sed nit temperature multiplier for sediment nitrate flux 1 08 1 02 1 14 phosphorus ksed frp half saturation constant of filterable reactive phosphorus flux mmol m 3 15 6 15 6 69 5 c theta sed frp temperature multiplier for sediment phosphate flux 1 08 1 02 1 14 organic matter nitrogen w pon settling rate of detrital nitrogen pool m d 1 1 0 1 0 0 015 a rpon miner maximum rate of hydrolysis of particulate organic nitrogen d 1 0 01 0 003 g 0 80 h rdon miner maximum rate of mineralisation of dissolved organic nitrogen d 1 0 01 0 003 e 0 05 e kpon miner half saturation constant for particulate organic nitrogen breakdown mmol m 3 78 0 31 25 i 156 25 g kdon miner half saturation constant for dissolved organic nitrogen mineralisation mmol m 3 78 0 31 25 i 156 25 g theta pon miner temperature multiplier for particulate organic nitrogen breakdown 1 08 1 02 e 1 14 e theta don miner temperature multiplier for dissolved organic nitrogen mineralisation 1 08 1 02 e 1 14 e organic matter phosphorus w pop settling rate of detrital phosphorus pool m d 1 1 0 1 0 0 03 a rpop miner maximum rate of hydrolysis of particulate organic phosphorus d 1 0 03 0 001 j 0 50 i rdop miner maximum rate of mineralisation of dissolved organic phosphorus d 1 0 05 0 005 e 0 05 kpop miner half saturation constant for particulate organic phosphorus breakdown mmol m 3 78 0 31 25 i 156 25 g kdop miner half saturation constant for dissolved organic phosphorus mineralisation mmol m 3 78 0 31 25 i 78 1 e theta pop miner temperature multiplier for particulate organic phosphorus breakdown 1 08 1 02 e 1 14 e theta dop miner temperature multiplier for dissolved organic phosphorus mineralisation 1 08 1 02 e 1 14 e organic matter carbon w poc settling rate of detrital carbon pool m d 1 1 0 1 0 0 05 a rpoc miner maximum rate of hydrolysis of particulate organic carbon d 1 0 01 0 001 a 0 50 i rdoc miner maximum rate of mineralisation of dissolved organic carbon d 1 0 01 0 001 a 0 50 i kpoc miner half saturation constant for particulate organic carbon breakdown mmol m 3 78 0 31 25 i 156 2 e kdoc miner half saturation constant for dissolved organic carbon mineralisation mmol m 3 78 0 31 25 i 156 2 e theta poc miner temperature multiplier for particulate organic carbon breakdown 1 08 1 02 e 1 14 e theta doc miner temperature multiplier for dissolved organic carbon mineralisation 1 08 1 02 e 1 14 e phytoplankton w p phytoplankton sedimentation rate m d 1 0 02 0 10 k 4 32 b ycc carbon to chlorophyll a ratio mg c mg chl a 1 50 45 55 r growth phytoplankton growth rate at 20 c d 1 1 9 0 6 d 2 9 e theta growth arrhenius temperature scaling for growth 1 08 1 02 1 14 theta std s tandard temperature c 20 0 19 0 c 23 0 l theta opt o ptimum temperature c 28 0 24 0 c 30 0 d theta max m aximum temperature c 35 0 32 0 k 40 0 d i s saturating light intensity µe m 2 s 1 150 150 250 d kephy specific attenuation coefficient for phytoplankton m 1 0 005 0 002 a 0 198 d f pr fraction of primary production lost to exudation d 1 0 005 0 005 0 070 c r resp phytoplankton respiration rate at 20 c d 1 0 05 0 01 d 0 09 m theta resp arrhenius temperature scaling for respiration 1 08 1 02 1 14 k fres fraction of metabolic loss that is respiration 0 25 0 25 0 75 a k fdom fraction of metabolic loss that is dissolved organic matter 0 20 0 20 0 25 a n o nitrogen concentration below which uptake is zero mmol n m 3 0 25 0 a 0 25 k n half saturation concentration of nitrogen mmol n m 3 1 00 0 02 d 3 50 k x ncon constant internal nitrogen concentration mmol n mmol c 1 0 035 0 035 0 380 e p o phosphorus concentration below which uptake is zero mmol p m 3 0 03 0 a 0 03 k p half saturation concentration of phosphorus mmol p m 3 0 05 0 002 d 0 26 e x pcon constant internal phosphorus concentration mmol p mmol c 1 0 0015 0 0015 0 0020 a a farrell et al 2020 b burger et al 2008 c snortheim et al 2017 d kara et al 2012 e fenocchi et al 2019 f me et al 2018 g romero et al 2004 h schladow and hamilton 1997 i aed science manual hipsey et al 2013 j özkundakci et al 2011 k ladwig et al 2018 l bucak et al 2018 m cui et al 2016 as a range of values was not found in the literature the 10 range was adopted table 3 summary of biogeochemical parameters with medium and high identifiability indicator for barra bonita bb promissão pr and três irmãos ti reservoirs table 3 symbol bb pr ti symbol bb pr ti symbol bb pr ti fsed oxy theta sed amm theta doc miner fsed amm theta sed nit ycc fsed nit ksed frp r growth fsed frp theta sed frp theta growth fsed pop w pon theta std fsed poc theta pon miner theta opt fsed doc theta don miner theta max ksed oxy w pop i s theta sed oxy rdop miner r resp rnitrif kdop miner theta resp knitrif theta pop miner k fres kdenit theta dop miner k fdom ksed nit w poc n 0 theta nitrif kdoc miner p 0 theta denit theta poc miner x pcon sensitivity very high high medium low sensitivity and identifiability analyses of parameters for water quality modeling of subtropical reservoirs l m v soares conceptualization formal analysis investigation methodology software writing original draft m c calijuri supervision validation writing review editing funding acquisition university of são paulo at são carlos school of engineering department of hydraulics and sanitation av trabalhador são carlense 400 são carlos sp 13566 590 brazil university of são paulo at são carlos school of engineering department of hydraulics and sanitation av trabalhador são carlense 400 são carlos sp 13566 590 brazil university of são paulo at são carlos school of engineering department of hydraulics and sanitation av trabalhador são carlense 400 são carlos sp 13566 590 brazil corresponding author sensitivity and identifiability analyses are a standard practice in modeling applications to investigate the relative importance of model components that control the system s behavior in this study both analyses were implemented to identify the most influential parameters in a coupled hydrodynamic biogeochemical model applied for three subtropical reservoirs the one dimensional general lake model coupled to aquatic ecodynamics glm aed was used to simulate the dynamics of dissolved oxygen total phosphorus nitrate ammonium and chlorophyll a results reveal consistent sensitivity patterns between reservoirs especially for a subset of temperature multipliers affecting dissolved oxygen and nutrients in contrast the sensitivity of chlorophyll a is highly site specific additionally the majority of parameters are medium or high sensitive which indicates the need for a calibration procedure to improve model accuracy the analyses provide a detailed understanding of the governing ecosystem dynamics as a step forward to model identifiability and guidance for future model calibration keywords lakes aquatic ecosystem biogeochemistry glm aed one at a time method calibration 1 introduction modeling lake ecosystems play an essential role in limnological studies for water quality assessment in response to the increased demand for ecosystem services in conjunction with the degradation of freshwaters at a global scale lake models experienced a rapid growth in the 1990s and 2000s decades also triggered by technological progress expansion and specialization of the modeling community and a new focus on the user interfaces and visualization robson 2014 the rapid advances came along with challenges mostly regarding the most suitable approach and complexity uncertainty and reliability and the usage of complex models and integration approaches gal et al 2014 in recent years lake modeling move towards open source codes further efforts supporting software environments and rich sources of data such as high frequency sensors and satellite images frassl et al 2019 accordingly to the huge advances in lake modeling in the past decades the sensitivity analysis sa has been widespread applied and regarded as a standard practice in modeling applications schmolke et al 2010 shimoda and arhonditsis 2016 following the increased use of sensitivity analysis methods recently reviews assessed its variety motivation and scope norton 2015 compiled the software tools and techniques most used douglas smith et al 2020 stated a practical best practice workflow pianosi et al 2016 suggested guidelines for the proper use of the methods saltelli et al 2019 and discussed its usage to evaluate uncertainty of deterministic models uusitalo et al 2015 the sa can be a helpful tool to investigate the role and importance of model components such as parameters and forcing data in producing model responses for assessing the sa of model parameters the basic idea is to alter their values on the basis of an acceptable range and evaluate the subsequent changes in model output the model is sensitive to a parameter if the outputs change markedly when the parameter value is changed otherwise if the output values change only little it is robust to changes in parameter values within the model thereby implying in a small sensitivity the insights provided by the sa concern both the magnitude of the variations and the direction of change borgonovo and plischke 2016 which can help to understand the model s intrinsic behavior by identifying the governing processes in the system and enhancing model formulations for instance the sa can be conducted for several purposes in ecological modeling including for elucidating which parameters require additional research or are insignificant nelson et al 2020 the consequences from changing the dominant controls of a system gal et al 2009 and the correlation between input parameters and lake characteristics such as residence time meteorological conditions and trophic status bruce et al 2018 finding the global optimal model and by implication the true representation of the system is a difficult task for complex models in face of the non uniqueness or equifinality of parameter values i e the same output can be reached by multiple optimal parameter values which give equally acceptable fits to observational data beven 2006 the equifinality issue re emphasizes the need to apply sa actively in the modeling process the sa is classified into local or global procedures saltelli et al 2004 p 44 a local sensitivity is performed by the one at a time oat method which assesses the model output change against variations of a single parameter while keeping all others fixed at their initial values hamby 1994 the global sensitivity estimates the overall response of model outputs when all parameters vary simultaneously within their perturbation range considering not only the direct influence of each parameter but also the joint influence due to their interactions conceptually the global approach provides a better characterization of the ecosystem s governing processes in the expense of a higher demanding computational effort although the usage of the global sa is advised in the literature e g baroni and tarantola 2014 there are relatively few applications in ecological modeling of aquatic ecosystems and the oat method is still the most largely used technique ferretti et al 2016 similarly to the sa the identifiability analysis applies a performance metric to establish which parameters strongly improve model fit to observed data both sensitivity and identifiability analyses are quite similar but not identical while parameter identifiability depends on the sensitivity of the model s output response to parameter perturbations the converse is not true gupta and razavi 2018 in the context of lake models an identifiability analysis is commonly used to compile a list of influential parameters that have a significant impact on the model response and should be the focus of the calibration procedure e g darko et al 2019 me et al 2018 snortheim et al 2017 tan et al 2018 it is generally true that only a relatively small subset of model parameters dominate a particular output variable however they are hardly to be predicted based on the sole intuition in face of the large number of model parameters and the interactions amongst them the identifiability analysis can largely reduce the complexity of model calibration by factor prioritization saltelli et al 2008 and keeping the insignificant parameters fixed in face of their low influence on model output cariboni et al 2007 the primary objective of this study was to characterize the sensitivity and identifiability of several water quality outputs from a hydrodynamic biogeochemical model general lake model coupled to aquatic eco dynamics glm aed to uncertainty in aed parameters using both the sensitivity analysis and the identifiability analysis the study sites were three subtropical reservoirs in brazil barra bonita reservoir promissão reservoir and três irmãos reservoir for this purpose the aims were 1 to quantify the sensitivity of model outputs to varying parameter values by applying the one at a time method to establish which parameters exert stronger controls on the models dynamical input state output behavior 2 to perform an identifiability analysis to establish which parameters can be perturbed to improve model fit to observed data for calibration guidance and 3 to identify the similarities and disparities in the model s behavior between the reservoirs despite the glm aed model has been widely applied a comprehensive sa on the model s parameters remains limited there are few sa for hydrodynamic parameters in previous glm applications bruce et al 2018 bueche et al 2019 ladwig et al 2018 soares et al 2020 weber et al 2017 and only one study performed the sensitivity analysis of aed model parameters ladwig et al 2020 as the output sensitivity of glm aed model to parameter uncertainty is therefore quite unexplored especially for subtropical reservoirs the motivation of the present analyses was centered on gaining deeper knowledge about the importance of biogeochemical parameters to water quality outputs and the properties of the actual ecosystems as a means to provide potential insights for model applications 2 material and methods 2 1 sites description three reservoirs were selected for the current study barra bonita reservoir bb promissão reservoir pr and três irmãos reservoir ti located southeast brazil in the highest demographic density region in the country fig 1 the reservoirs were chosen for i their varied range of morphometric and water quality features table 1 ii their same climate condition subtropical cwa according to köppen 1948 with an average air temperature of 22 6 c and an annual rainfall of 1400 mm inmet 2019 and iii the availability of field data for model input all three reservoirs were built in the tietê river envisioning electricity generation and navigation to attend to the country demand nowadays the reservoirs are intended for multiple uses between these reservoirs there are other three reservoirs along the river composing a cascade system the other reservoirs were not selected for this study due to the lack of field data there is a remarked gradient from barra bonita reservoir to três irmãos reservoir in terms of water quality and trophic state barra bonita 22 31 11 s 48 32 04 w is a meso hyper eutrophic reservoir located in an urbanized catchment where is situated são paulo metropolitan region and around of 24 million inhabitants ibge 2019 it has been heavily loaded by sewage deriving from urban areas resulting in a high nutrient state frequent hypoxic events and cyanobacteria blooms cetesb 2019 it has a poly mictic regime with short timescales of stratification bb reservoir is the shallowest and smallest of the three study sites with a surface area of 226 km2 maximum depth of 23 5 m and residence time of 91 days promissão reservoir 21 17 51 s 49 46 47 w is meso trophic with average chlorophyll a concentration of 24 13 µg l 1 its mono mictic regime is characterized by summer stratification from october to april with surface temperatures of 25 9 c and hypo limentic temperatures of 22 9 c pr reservoir has a surface area of 522 km2 maximum depth of 24 5 m and residence time of 141 days três irmãos 20 40 10 s 51 17 57 w is the most downstream reservoir of the cascade system and the largest one it is an oligotrophic and mono mictic water body summer stratification is also from october to april with surface temperature of 26 3 c ti reservoir has a surface area of 654 km2 maximum depth of 45 6 m and residence time of around 1 2 year 2 2 model description the process based one dimensional 1d vertical general lake model glm hipsey et al 2019 can be dynamically coupled to the aquatic eco dynamics library aed hipsey et al 2013 for modeling the hydrodynamics and biogeochemical processes in a variety of lentic water bodies such as deep and shallow lakes reservoirs mining pit lakes wastewater ponds and urban wetlands glm aed model was well suited for this study because of its 1 freely and open source availability which encourages future reproduction of the current study 2 the 1d assumption that the vertical gradients are significantly larger than the horizontal ones is valid for the study sites as previously assessed soares et al 2020 and 3 recent applications in peer review studies bucak et al 2018 farrell et al 2020 fenocchi et al 2019 ladwig et al 2018 snortheim et al 2017 weng et al 2020 glm simulates the vertical profiles of temperature salinity and density by accounting for the effect of inflows and outflows on the water balance in addition to surface heating and cooling energy balance and vertical mixing the equations are based on assumptions that are common to previous model applications hamilton and schladow 1997 imberger and patterson 1990 a flexible lagrangian layer structure is used to discretize the water column into horizontal layers with homogeneous physical properties the layer thickness can change by contraction and expansion in response to inflows outflows mixing with adjacent layers and surface mass fluxes the thermal processes of stratification and mixing are computed from the water balance and the energy budget at every time step the water balance accounts for the effects of surface mass fluxes inflows and outflows the energy budget is calculated based on the balance between kinetic and potential energy the available kinetic energy is calculated due to contributions from wind stirring shear production between layers convective overturn and kelvin helmholtz billowing when sufficient turbulent kinetic energy becomes available to overcome stable density gradients then layers merge thereby accounting for the process of mixing hipsey et al 2019 the vertical profile of temperature and the incident shortwave radiation are provided by glm as input to aed at every time step of the simulation they are used for the computation of temperature dependent chemical and biological processes as well as to adjust the light extinction coefficient finally the light extinction coefficient is provided from aed to glm in the next time step of simulation for calculations of the thermal processes aed comprises numerous modules that are designed as individual components allowing for different conceptualizations either simple or complex model components are able to simulate dissolved oxygen do carbon c nitrogen n phosphorus p and silica cycles including organic matter inorganic suspended solids and several functional groups of phytoplankton and zooplankton 2 3 model configuration the general lake model v 2 2 0 was coupled to the aquatic eco dynamics v 4 for the simulation of hydrodynamics and biogeochemical processes in bb pr and ti reservoirs a baseline simulation was run for each reservoir based on a previous application of glm calibrated and validated in which water temperature was simulated accurately and model efficiency was similar across the three reservoirs indicating a robust fit for glm rmse of 1 81 c 1 80 c and 1 42 c and r of 0 83 0 87 and 0 88 for bb pr and ti reservoirs respectively soares et al 2020 all aed parameters were set at their initial values based on hipsey et al 2013 being identical between reservoirs the period of simulation was from the first day with field measurements in 2008 15th january for bb and 12th february for pr and ti to 31st december 2016 with a 1 h time step the statistical software r 3 2 5 was used to simulate and analyses modeling results through the packages glmr hipsey et al 2014 and glm tools read et al 2014 the conceptual model included hydrodynamic processes computed by glm and aed modules of sedimentation fluxes dissolved oxygen carbon nitrogen phosphorus organic matter phytoplankton and suspended solids the dominant geochemical processes in the water column were represented fluxes between water sediment interface constant sediment flux mineralization of dissolved organic matter hydrolysis of particulate organic matter sedimentation of particulate organic matter nitrification denitrification and phytoplankton primary production respiration vertical movement excretion and mortality the phytoplankton composition was limited to include only one group due to the absence of biomass data reported by groups all chlorophyll a concentration was simulated as cyanobacteria the dominant functional group in all three reservoirs cetesb 2019 santos 2010 fixed c n and c p ratios were assumed to model nutrient limitation with a half saturation constant representing the effect of external nutrient concentrations on the phytoplankton growth rate the conceptual diagram of the current application is illustrated in fig 2 2 4 required data glm requires the following input data i reservoir s bathymetry ii meteorological time series iii inflow and outflow discharges and iv inflow temperature and salinity in addition the following physical variables in the water body are required for setting initial conditions for the first day of the simulation and for model performance assessment vertical profile of water temperature and salinity water level and the light extinction coefficient estimated from secchi depth measurements the hypsographic curve of each reservoir was extracted from the bathymetric survey performed by previous studies bb reservoir corrêa filho et al 2003 pr reservoir maia 2006 ti reservoir albertin et al 2010 terrestrial based meteorological stations operated by the national institute of meteorology inmet 2020 provided hourly time series of air temperature wind speed solar radiation air relative humidity and rainfall green markers a c in fig 1 the missing values were filled by linear regression with data from a meteorological station with high correlation coefficient r 0 72 p value 0 05 cloud cover data was not available and it was estimated by glm through the bird clear sky model daily hydrological data inflow and outflow discharge and water level were provided by the national water agency ana 2018 gaps in daily inflow and outflow discharge were rare less than 0 6 of total data and they were filled by linear interpolation inflow temperature and electrical conductivity which was used for the estimation of inflow salinity were measured generally every two months by the environmental company of the state of são paulo cetesb at their main tributaries purple markers a d in fig 1 ana 2019 due to the small salinity content and its low influence in freshwater systems its mean value below 0 2 pss was assumed for the entire simulation period time series of meteorological and hydrological input data for each reservoir is presented in figure s1 in the supplementary material and box plots are used to present monthly means and range of glm input data across all three reservoirs during the simulation period 2008 2016 fig 3 all the assumptions made as well as all the processing of the physical variables required by the hydrodynamic model were assumed exactly the same as a previous application of glm for these reservoirs further detailed description is provided by soares et al 2020 aed requires the daily inflow nutrient concentrations as input data in addition the state variables measured in the water body are required for setting initial conditions for the first day of the simulation and for performance assessment input loads of do nitrate no3 ammonium nh4 total phosphorus tp and chlorophyll a were measured in the tietê river stations a c d in fig 1 and the piracicaba river station b every two months by cetesb purple markers a d in fig 1 ana 2019 given the absence of measured daily input loads a simplification was assumed by computing the average concentration throughout the rainy season from october to march when 80 of annual rainfall occurs and the dry season from april to september for each year of simulation the separation by season was selected in face of the remarked differences regarding inflow discharge and the consequent capacity of nutrient dilution thus the average seasonal value was assumed as a constant for each season nutrient concentrations in minor tributaries were neglected due to the lack of field data time series of water quality input data for each reservoir is presented in figure s2 in the supplementary material and box plots are used to present seasonal means and range of aed input data across all three reservoirs during the simulation period 2008 2016 fig 4 water temperature salinity secchi depth do no3 nh4 tp chlorophyll a and ph were collected from one monitoring station located at a central location in each reservoir yellow markers 1 3 in fig 1 measurements were performed every two months by cetesb 2019 at water surface 2 5 sensitivity and identifiability analyses a local sensitivity and identifiability analyses were applied for the baseline simulation of barra bonita reservoir promissão reservoir and três irmãos reservoir with reference to five state variables do tp no3 nh4 and chlorophyll a a set of 64 aed parameters table 2 was selected for characterizing the entire system glm parameters were not included because their sensitivity analysis was previously assessed for the current study sites soares et al 2020 the one at a time oat method was adopted by quantifying the effect of the variation of a given parameter on the model output while all other parameters were kept at their initial values the local approach was selected based on 1 its simple and intuitive capability to imply that whatever effect observed on the model outputs can be safely attributed to the altered parameter 2 its low computational cost and 3 the local analysis being the state of the art in environmental disciplines as the oat method by far still prevails while a small fraction of studies adopts a global approach ferretti et al 2016 the conventional variation by a fixed percentage of the initial parameter value e g 10 bucak et al 2018 20 bruce et al 2018 and 50 rangel peraza et al 2016 is problematic first because the model response to parameter variations is nonlinear then small initial values lead to a small variation while high initial values lead to a large variation second if the initial parameter value is located nearby the upper or lower bound of the range the variation can lead to inadmissible values beyond the valid boundaries of the range lenhart et al 2002 as the sensitivity of the model output can be significantly different according to the selected perturbation range yi et al 2016 instead of increase and decrease parameter values by a defined percentage each parameter s entire range of possible values was defined by the minimum and maximum values found in previous applications of one dimensional lake models in order to assess true parameter sensitivities table 2 the same initial value 1 08 and range 1 02 1 14 were applied for all temperature multipliers aiming at a better comparison of their impact on each biogeochemical process the sensitivity of the model output to parameters values changing was quantified using a normalized sensitivity indicator si equal to the ratio between the change in a model output variable compared to the baseline model output for the respective variable and the change in model parameter compared to its initial value calculated as 1 s i δ y y δ x x where y is the state variable concentration for the reference value x of the parameter which has a variation δx from its maximum value to its minimum value in a single step i e δx xmaximum xminimum generating a model performance variation δy the identifiability of the model output to parameters values changing was computed by an identifiability indicator using the same eq 1 where y is the model performance the objective function applied for model performance assessment was the root mean square error rmse calculated as 2 r m s e i 1 n s i o i 2 n where n is the number of observations oi and si are the ith observed and simulated data respectively as the 64 parameters were varied from the maximum value to the minimum value in a single step 128 simulations were run for each reservoir thus resulting in a total of 384 simulations a value of si equal to 1 or 1 indicates a proportional change of the model output for the respective change of a model parameter value the sensitivity index was classified according to lenhart et al 2002 into four classes 0 s i 0 05 is small to negligible 0 05 s i 0 20 is medium 0 20 s i 1 00 is high and s i 1 00 is very high the first year of simulation 2008 was considered as a warm up period and thus it was not included to ensure the independence of the simulation results from the initial conditions 3 results in total the sensitivity analysis resulted in 960 values of si which ranged from 13 8 to 29 8 revealing the most critical parameters that govern the simulated water quality outputs in each site a minority of 18 parameter changes resulted in si values within the negligible range i e s i 0 05 in all three reservoirs while the others 46 parameter changes resulted in some sensitivity in model output for at least one of the five state variables fig 5 a overall the sensitivity of model outputs to perturbations of the parameters was quite similar across reservoirs the sensitivity analysis showed that the state variables were strongly affected by 18 out of 20 parameters related to the phytoplankton module additionally it was revealed the importance of temperature multipliers as the state variables presented at least medium sensitivity to the vast majority of them also model outputs displayed considerable sensitivity to the settling rate of organic matter w pon w pop and w poc in contrast a negligible sensitivity was found to most mineralization parameters the performance metric based approach also resulted in 960 identifiability indicators revealing which parameters can be perturbed to improve model fit to in situ data thus indicating on where to focus the calibration effort fig 5b for some specific parameters despite model outputs being highly sensitive the identifiability analysis revealed that their change could promote only a small effect on model performance for instance that was the case for the settling rate of organic matter w pon w pop w poc the sedimentation flux for particulate organic phosphorus pop and dissolved organic phosphorus dop fsed pop fsed doc the saturating light intensity i s the fraction of primary production lost to exudation f pr the fractions of metabolic loss that are respiration and dissolved organic matter f fres k fdom the nutrient concentration below which uptake is zero n o p o and the constant internal nutrient concentration x ncon x pcon common identifiability features could be quantified between reservoirs 1 for dissolved oxygen concentration the temperature multipliers are relevant to optimize its performance metric however there was some effect of varying other parameters on do concentration particularly the sedimentation flux for do no3 and dissolved organic carbon doc fsed oxy fsed nit fsed doc and the phytoplankton growth and respiration rates at 20 c r growth r resp 2 rmse of the nitrogen related output variables nh4 and no3 was attributed mainly to parameters associated with the specific output i e parameters that are part of the equations used to calculate the output variable in question for instance ammonium was strongly determined by the sedimentation flux for nh4 fsed amm nitrification rate r nitrif half saturation constant of nitrification k nitrif and temperature multipliers of nitrification and sediment nh4 flux theta nitrif theta sed amm similarly nitrate was found to be determined by sedimentation flux for no3 fsed nit and temperature multiplier of sediment no3 flux theta sed nit whereas all other parameters had a little effect on this modeled variable 3 in contrast total phosphorus performance metric was mostly affected by parameters that are not directly related to it such as temperature multipliers of sediment nh4 flux and doc mineralization theta sed amm theta doc miner thereby demonstrating the usefulness of the method for exploring the ecosystem the identifiability analysis shares some similarity for the five constituents although clear disparities existed the most notable difference between reservoirs is related to the chlorophyll a concentration while none parameter was identified as relevant in promissão reservoir regarding chlorophyll a at water surface there were thirteen parameters affecting chlorophyll a in barra bonita reservoir all of them from the phytoplankton sub model except for temperature multipliers of doc mineralization and sediment nh4 flux theta doc miner theta sed amm in três irmãos reservoir however the performance metric of chlorophyll a was affected by 35 out of 64 parameters 55 relative to all the sub models components 4 discussion 4 1 similarities between reservoirs the results successfully distinguished the influential parameters for each state variable the temperature multipliers were found as an important factor for the model outputs in barra bonita promissão and três irmãos reservoirs being more influential than their corresponding parameters indeed the temperature coefficients were higher than their related rates for sediment fluxes theta sed oxy fsed oxy theta sed amm fsed amm and theta sed frp fsed frp nitrification theta nitrif rnitrif denitrification theta denit rdenit hydrolysis theta pop miner rpop miner and mineralisation theta don miner rdon miner and theta doc miner rdoc miner the same features were observed for phytoplankton respiration theta resp r resp ecologically this means that water temperature is a dominant driver of simulated water quality outputs by governing many temperature dependent biochemical and physiological processes such as kinetic rates of nutrient transformations and phytoplankton metabolism ultimately seasonality from meteorological drivers is an important input for ecosystem phenology the importance of temperature multipliers influencing state variables as indicated in the sensitivity analysis might be attributed to the regional subtropical climate resulting in quite warm surface waters in the study sites which varied in a range of 16 7 30 9 c in bb reservoir 18 5 33 4 c in pr reservoir and 20 6 32 0 c in ti reservoir soares et al 2020 in this study the entire range of possible values for the temperature multipliers was defined based on values found in previous applications of one dimensional lake models regardless of the site characteristics due to the absence of references from subtropical systems given that parameter uncertainty ranges were not chosen to correspond to site characteristics the uncertainties are greater than what s true for the system which could inflate the sensitivity index metrics in this manner further work is required to define the adequate range of temperature multipliers specifically for subtropical systems despite the parameter uncertainty ranges did not precisely correspond to site characteristics we believe that a different range could refine the results but would not be able to change the high influence of temperature multipliers on model outputs in line with the high sensitivities found for temperature multipliers in simulated biogeochemical dynamics the importance of suitable water temperature is corroborated by the fact that the optimum and maximum temperature were consistently sensitive for the three reservoirs as the temperature multipliers directly affects the response of biogeochemical rates to water temperature potential implications can be foresee in respect to climate change and water warming globally o reilly et al 2015 the important parameters for improving dissolved oxygen performance metric are consistent with qualitative expectations on the basis of the conceptual model do was most affected by parameters that directly affect oxygen utilization in the water column and in the sediments temperature multipliers of nitrification doc mineralization and sediment do flux theta nitrif theta doc miner theta sed oxy and sedimentation flux for do no3 and doc fsed oxy fsed nit fsed doc another informative trend is the strong influence of parameters that indirectly control photosynthetic oxygen production by changing the growth of phytoplankton including growth and respiration rates r growth r resp temperature multipliers for growth and respiration theta growth theta resp and optimum and maximum temperatures theta opt theta max changing phytoplankton growth rate and its temperature multiplier r growth theta growth respiration rate and its temperature multiplier r resp theta resp and optimum and maximum temperature limitation theta opt theta max parameters affected simulated dissolved oxygen and nutrient concentrations whereas parameters related to phytoplankton nutrient uptake had a minimal effect on optimizing the performance metric of state variables the processes of hydrolysis of particulate organic matter into dissolved organic matter and its mineralisation into dissolved inorganic matter appeared highly robust against the parameterization as perturbations of the initial values of hydrolysis rates rpon miner rdon miner rpop miner rdop miner rpoc miner rdoc miner and half saturation constant for breakdown kpon miner kpop miner kpoc miner or mineralization kdon miner kdop miner and kdoc miner rarely produced considerable changes in the performance metric of state variables in face of the consistency of the abovementioned similarities between reservoirs it is expected that the sensitive parameters found in this study could be quite transferable to other reservoirs with the same climate condition 4 2 disparities between reservoirs as expected the sensitivity analysis revealed a consistent response of model outputs to parameters related to the phytoplankton module since all reservoirs are subjected to the same kinetic processes and functional group of phytoplankton thus the dynamic behavior is controlled by almost the same sensitive parameters however remarkable differences appeared on the identifiability analysis regarding chlorophyll a in each reservoir most noticeably in bb and pr reservoirs chlorophyll a was not considerably affected by any parameter out of the phytoplankton sub model except for temperature multipliers of sediment nh4 flux and doc mineralization theta sed amm theta doc miner in bb reservoir the minimum influence of parameters changes on chlorophyll a output may be attributed to the trophic condition in the water bodies as both of them are nutrient rich parameter changes in the assigned range were not enough to provoke considerable changes in chlorophyll a in face of the high availability of tp nh4 and no3 in water surface in contrast in the oligotrophic ti reservoir chlorophyll a was affected by 24 parameters out of 44 55 from the sedimentation flux dissolved oxygen nitrogen phosphorus and organic matter sub models additionally the importance of nutrient related processes for chlorophyll a concentration in ti reservoir was confirmed by the high identifiability indicator for parameters that are related to key mechanisms for regulating nutrient recycling rates such as denitrification nutrient sedimentation fluxes and mineralization of particulate organic phosphorus temperature multipliers of denitrification sediment flux of nh4 no3 po4 and pop mineralization theta denit theta sed amm theta sed nit theta sed frp theta pop miner the differences in model behavior particularly the importance of several parameters for optimizing chlorophyll a in ti reservoir demonstrate that oligotrophic ecosystems are more susceptible to parameterization than meso and eutrophic reservoirs are possibly because eutrophic systems are saturated with nutrients and thus small changes in model parameters are not enough to promote any significant impact on the chlorophyll a prediction the performance metric of chlorophyll a was surprisingly less influenced by the assumed variations in parameters related to the phytoplankton sub model in promissão reservoir however quite similar response was found between bb and ti reservoirs the dynamics of the chlorophyll a at water surface is influenced by the parameters that are related to growth water temperature uptake of phosphorus and more pronounced to autotrophic respiration growth and respiration rates and their temperature multipliers r growth r resp theta growth theta resp standard optimum and maximum temperature theta std theta opt theta max and constant internal phosphorus concentration x pcon the strong influence of parameters that directly alter growth rates and the uptake of phosphorus on chlorophyll a is a common found in the literature darko et al 2019 jones et al 2018 schladow and hamilton 1997 the few exceptions to the similarities between bb and ti reservoirs are the saturating light intensity i s the metabolic loss by excretion to the dissolved organic pool k fdom and the nutrients concentration below which uptake is zero n o p o the moderate influence of light penetration in the water column observed only in bb reservoir can be explained by its poly mictic regime in waters with strong vertical mixing a higher turbidity along the water column reduces transparency resulting in a shallower euphotic zone ultimately affecting the sufficient sunlight for photosynthesis indeed the turbidity was higher in bb reservoir on average 17 3 ntu thus resulting in a lower transparency on average 1 3 m with comparison to the other reservoirs 15 4 ntu and 2 2 m in pr reservoir and 2 0 ntu and 3 9 m in ti reservoir cetesb 2019 the influence of nutrients concentration below which uptake is zero was found only in ti reservoir and can also be explained by the different trophic status between bb and ti reservoirs as discussed above on the basis of the variabilities found for chlorophyll a identifiability it becomes clear that this analysis is required to determine the most influential parameters for a particular water body 4 3 implications for model calibration the outcomes of the sensitivity analysis provided a quantitative measure of the sensitivity of the output variables to the parameters changes highlighting which parameters exert stronger controls on the model s behavior the identifiability analysis was of paramount importance to distinguish which ones can be perturbed to improve the model goodness of fit metric the majority of parameters being medium or high influential on model performance as found in this study clearly indicate that there is a potential uncertainty in their values that should be determined by a calibration procedure to improve model accuracy based on the identifiability analysis a posteriori calibration can concentrate on medium and or high sensitive parameters given their large influence on the governing processes of the ecosystem for instance the number of model parameters to be included in a calibration could be reduced from 64 to 22 in bb reservoir 15 in pr reservoir and 39 in ti reservoir table 3 in view of the still high number of influential parameters on model performance particularly for ti reservoir the efficiency of calibration could benefit by selecting parameters from a descending order of influence i e firstly prioritizing high influential parameters and if needed include other parameters following their identifiability indicator this guidance is valid for a calibration procedure that applies parameter ranges assigned in this study as we adopted the entire range of parameter values found in previous applications of one dimensional lake models it suggests that the present results may find a widespread applicability however the importance of temperature multipliers is likely to be valid only for low latitude systems where regional subtropical climate results in quite warm surface waters it is worth noting that complex models such as glm aed are often subject to equi finality or non uniqueness indicating that there is not a single or unambiguous value to the model parameterization beven 2006 hence during a posterior model calibration there can exist several parameter sets that provide equally suitable model responses to a given measure of goodness of fit between simulated and measured values the identifiability of model outcomes to dissolved oxygen and nutrients have a more generalizable nature as some of the medium high and very high sensitive parameters such as sedimentation no3 flux fsed nit and temperature multipliers for nitrification sediment flux of nh4 no3 and po4 and pop mineralization theta nitrif theta sed amm theta sed nit theta sed frp theta pop miner to cite some are often recognized as sensitive and used as tuning parameters for calibration in different lakes and reservoirs worldwide e g fenocchi et al 2019 gal et al 2009 me et al 2018 snortheim et al 2017 in the case of chlorophyll a in pr reservoir given the low identifiability of the model output to changes in all parameter values it is claimed that the calibration of do and nutrients will be enough to achieve a good performance of chlorophyll a simulation 4 4 limitations of the sensitivity and identifiability analyses for the purpose of this study a local sensitivity and identifiability analyses were conducted on selected model parameters using a one at a time method this approach is computationally very efficient compared to more demanding techniques and chosen in most practical cases both analyses were able to provide the sub set of most influential parameters revealing consistent similarities between reservoirs regarding nutrients parameters as well as the particular sensitivities directly influenced by both the thermal regime and the trophic state which should be assessed individually additionally the method provided insights for supporting a posteriori calibration procedure literature defined ranges were not found for some parameters see table 2 and hence the 10 range from the initial value was adopted which might not captured the real uncertainty of the parameters the one at a time method comprises a relatively simplistic process representation as it is unable to capture the interactions between parameters in such a complex ecological model hence the method only explores a fraction of the input space of variations in parameter values to overcome the inability of the local approach to account for interactions between parameters a multi parameter or a global analysis is required for a complete understanding on how a complex and nonlinear model behaves saltelli et al 2008 in global sensitivity analysis such as the monte carlo approach all model parameters are iteratively adjusted within value ranges resulting in several even thousands of simulations alternatively the morris method morris 1991 is based on the one at a time approach but is classified as a global sensitivity analysis because it samples partial derivatives at multiple locations in the input space while the local approach does not capture some aspects of nonlinearity that can be captured by the global approach we suggest that it is advantageous to consider the local analysis in model evaluation possibly as a preliminary step to provide insights which can be used to improve the design of more demanding methods 5 conclusions the one at a time method was implemented to conduct a local sensitivity and identifiability analyses for a coupled hydrodynamic biogeochemical model glm aed in three subtropical reservoirs the analyses focused on the response of five water quality constituents including do tp nh4 no3 and chlorophyll a to 64 parameters the study shows the capability of the sensitivity analysis to explicitly identify the input parameters that exert the most influence on model outputs according to a defined perturbation range in addition the identifiability analysis revealed the most influential parameters on model performance three important insights were gained through the present analyses first the model behavior could be explained largely based on water temperature as a subset of eight temperature multipliers were consistently high sensitive although these results are specific to bb pr and ti reservoirs this outcome is likely to be an indicator that those dominant parameters are generally important and their sensitivity would be also valid to other similar systems second the patterns of parametric control on chlorophyll a were somewhat unique for each reservoir the differences were attributed to their thermal regime either poly mictic or mono mictic and their trophic status either oligo meso or eutrophic which suggests the importance of conducting systematic identifiability analysis for a specific water body to acquire additional insights into the dynamics of the particular system finally the high number of influential parameters on model performance confirms the need of the calibration procedure aiming at reducing parameter uncertainties and increasing model accuracy for a proper representation of the real ecosystems this study supplies a deep understanding of the simulated governing ecosystem dynamics particularly for the fact that the reservoirs are located in a subtropical climate as a means to overcome the limited information from the subtropics additionally the analysis further provides a potential guidance for prioritizing research efforts by reducing the number of parameters that require calibration in our future work we will calibrate the model for each reservoir based on the sensitivity and identifiability results for better supporting future management decisions in the cascade reservoirs of the tietê river credit authorship contribution statement l m v soares conceptualization formal analysis investigation methodology software writing original draft m c calijuri supervision validation writing review editing funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work was supported by the national council for scientific and technological development cnpq additionally we are grateful to the national institute of meteorology inmet the national water agency ana and the environmental company of the state of são paulo cetesb for the available data supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2021 109720 appendix supplementary materials image application 1 
24564,humanity is facing many grand challenges at unprecedented rates nearly everywhere and at all levels yet virtually all these challenges can be traced back to the decision and behavior of autonomous agents that constitute the complex systems under such challenges agent based modeling has been developed and employed to address such challenges for a few decades with great achievements and caveats this article reviews the advances of abm in social ecological and socio ecological systems compare abm with other traditional equation based models provide guidelines for abm novice modelers and reviewers and point out the challenges and impending tasks that need to be addressed for the abm community we further point out great opportunities arising from new forms of data data science and artificial intelligence showing that agent behavioral rules can be derived through data mining and machine learning towards the end we call for a new science of agent based complex systems acs that can pave an effective way to tackle the grand challenges keywords agent based complex systems agent based modelling socioecological systems data science artificial intelligence 1 agent based complex systems agent based complex systems acs largely equivalent to complex adaptive systems often include heterogeneous subsystems autonomous entities nonlinear relationships and multiple interactions among them arthur 1999 axelrod and cohen 1999 crawford et al 2005 levin et al 2013 individual actors make decisions and interact with one another or with their local and or remote environment giving rise to or shaping emergent outcomes which in turn affect the agents behaviors and interactions coleman 1987 railsback and grimm 2012 such systems may bear complexity features such as path dependence contingency self organization and emergence not analytically tractable from system components and their attributes alone bankes 2002 manson 2001 national research council 2014 a large amount of efforts have been invested in exploring complex systems axelrod and cohen 1999 grimm et al 2005 helbing et al 2015 levin et al 2013 2012 manson 2001 and the corresponding methods and tools cardinot et al 2019 kravari and bassiliades 2015 railsback et al 2006 from scientists of various backgrounds in biology cell simulation has included thousands of genes and millions of molecules karr et al 2012 in chemistry complex molecules have been investigated digitally in terms of their structure and properties before they are manufactured in the lab lewars 2011 in climate science the whole earth models couple atmospheric and ocean circulation dynamics to study global warming at ever finer spatiotemporal resolution lau and ploshay 2013 particularly worth of mention is the contribution from physics which traditionally using the language of mathematics focuses on theory and empirics e g experiment results later on physicists started to define and leverage complex systems theory as they were engaged in explaining deterministic chaos quantum entanglement protein folding spin glasses etc the system behavior crucially depends on its details such as interactions between constituent parts which lead to collective behavior and define the macro state perc 2017 the macro state would in turn affect the states of constituents and interactions making them co evolve over time all such observations and explorations especially those in statistical physics and quantum mechanics have substantially nurtured the growth of complex systems theory for detail on the contribution of physics in complexity science we refer to a review article holovatch et al 2017 also studies of complex adaptive systems have benefited from and are instrumental to efforts in understanding global macroeconomic network stock market political parties social insect colonies immune system and internet connections an et al 2020 axelrod and cohen 1999 cumming 2008 in this context more progress on acs theory development is needed in social ecological grimm and berger 2016 and social ecological sciences an et al 2020 2014a taking social ecological or human environment research as an example acs models are lagging behind in this field and have in particular not yet developed a productive culture of model analysis and testing schulze et al 2017 in social and ecological systems more efforts and achievements have been obtained see sections 3 1 and 3 2 yet they are fragmented less communicated to other disciplines and or not distilled into complex systems science level the development of a culture of system representation and exploration including model analysis and testing may enable scientists to develop acs models and principles distill commonalities from locale specifics test and generalize site independent hypotheses and ultimately formalize theories applicable to the acs under investigation this context leads to our efforts in this synthesis paper regarding modeling acs 2 history of agent based modeling agent based models abms for agent based modeling we use the acronym abm throughout the paper adopt a realist typically objectivist ontology where observable actions are modeled with a detailed representation of agents that live in complex environments grimm and railsback 2005 stillman et al 2015 in ecology abms are often called individual based models the abm approach focuses on the uniqueness of individuals and interactions among them or between these individuals and the associated environment s abms are used whenever one or more of the following aspects of real acs is considered essential for answering a certain question agents are different in some variables and such differences are essential for agent behavior and or systems dynamics agents interact locally in space or networks agents live in time varying and heterogeneous environment s agents adapt their behavior to the current and sometimes projected future state of themselves and their environment in their pursuit of a certain objective these aspects particularly agents flexible and diverse behavioral responses observed in human society or nature are not easily found in simplified models evans et al 2013 hence abm allows for studying a wider range of behavioral phenomena or processes and addressing many empirical and theoretical problems arthur 1999 axelrod and cohen 1999 lindkvist and norberg 2014 manson 2001 which are axiomatically complex technologically agent based modeling has emerged and prospered with the advent of increasingly available computing power new forms of data and capability of data handling and storage given complexities in acs it has been suggested that the abm approach be employed to understand harness and improve rather than fully control acs structure and function taking innovative actions to steer the system of interest in beneficial directions axelrod and cohen 1999 the use of agent based models for empirical study and scientific inquiry has increased rapidly among various scientific communities over the last two decades the number of authors and new authors who develop or use abms has been steadily increasing at an exponential rate since the mid 1990s fig 1 spanning research fields including ecology epidemiology land system science sociology and archaeology fig 2 see also the paper by vincent 2018 further advances in abm have led to the founding of the journal of artificial societies and social simulation in 1998 and several scientific associations in both europe and the us in the 2000s as a climax of abm popularity a pnas special issue was published in 2002 as an aftermath of the national academy of sciences sackler colloquium where abms were greeted with enthusiasm because of the potential revolution it may bring up in scientific inquiry bankes 2002 this hype faded with time as scientists sometimes tend to rush to a new approach that promises to solve previously intractable problems and then revert to familiar techniques as the unanticipated difficulties of the new approach are uncovered grimm and railsback 2005 p xi progress in agent based modeling has been slower than initially anticipated bonabeau 2002 huston et al 1988 in critical areas such as abm validation and identifying outcomes that differ from or are better than those from other types of models an et al 2014a grimm et al 2005 grimm and berger 2016 grimm and railsback 2005 rindfuss et al 2008 thiele and grimm 2015 interestingly such questions are not always asked of other model types subsequent progress with advancing abm methodology has been slow reflecting the fact that any tool for tackling complex systems comprised of agents in different contexts has to cope with complexity inherent in such systems these challenges can explain at least partially frustration with the approach and even general doubts about its usefulness e g couclelis 2002 roughgarden 2012 with the recent appearance of new forms of data e g micro level or individual level data from different sources such as citizen sensors smart meters and remote sensing and the unprecedented ability to better understand the system s under investigation the popularity of abms as a modeling tool continues increasing fig 1 abms are useful for integrating a variety of data and models from multiple disciplines for addressing problems across spatial temporal and organizational scales and for various mind experiments hypothesis testing or scenario explorations an et al 2014a 2005 borrill and tesfatsion 2011 2011 gimblett 2002 grimm 1999 abms are also increasingly being used to facilitate cooperation in inter or transdisciplinary settings where they support communication and understanding across disciplines and knowledge systems of scientists and non scientists for example via participatory modeling ramanath and gilbert 2004 voinov and bousquet 2010 3 abms in ecological social and social ecological systems 3 1 abm in ecological systems in ecology the use of abms often referred to as individual based models or ibms started about 10 years earlier than in other disciplines deangelis and gross 1992 huston et al 1988 liu 1993 initially abms were used to take into account heterogenous individuals and interactions between them at the local not global scale increasingly ecological abms are also representing adaptive behavior in ecological abms organisms are simulated as agents that move fight or flee browse or feed reproduce or form and maintain territories based on some internal state of each organism and its often imperfect knowledge of the environment with some goals such as optimal fitness deangelis and diaz 2019 in an increasing proportion of these models individual organisms make decisions to achieve some goal that increases fitness such as growth or survival these models have focused on the importance of many individual level behavioral differences such as bold vs conservative behavior in fish various responses to intra and inter specific competition and tradeoffs between growth mortality and early and late reproduction all such differences affect community dynamics making abm highly useful to account for details in individual behavioral traits in addition to age sex body mass and so on as well as feedback effects deangelis and diaz 2019 ecologists contributed to the maturation of agent based modeling through developing a standard format for model formulation and communication named the overview design concepts details odd protocol grimm et al 2006 polhill 2010 polhill et al 2008 other contributions from ecologists include testing a general strategy for achieving structural realism via verification and validation e g through pattern oriented modelling grimm et al 2005 grimm and railsback 2012a the increasing use of first principles e g energy budgets physiology objective seeking heuristic decision algorithms to represent agents behaviors martin et al 2013 railsback and harvey 2013 2002 scheiter et al 2013 and the establishment of sensitivity analysis as a required element of model analysis ligmann zielinska et al 2020 furthermore ecologists have developed a general framework for designing and documenting model evaluation which is particularly important for models developed for decision or policy support augusiak et al 2014 grimm et al 2020a 2014 schmolke et al 2010 ecology is also pioneering the modeling of adaptive decision making there are situations that traditional models mostly those aiming to optimize certain long term goals cannot handle well for instance agents respond via heuristics or rules of thumb of decision making to handle immediate reactions to changes in their environment e g food and perceived risk another good example is the emotion system of giske et al s fish model giske et al 2013 which integrates information motivation and physiological states in order to determine emotions which in turn form the basis for decisions and subsequent behavioral outcomes abms are especially suitable for answering ecological and evolutionary questions because they allow incorporating intra specific variation learning and adaptation relatively easily whereas inclusion of all of them in other model types was rarely if ever done akin to social systems see below abm in ecology has moved towards convergence to some cognitive models including the fuzzy cognitive maps social hierarchies e g within primate troops cheney and seyfarth 1992 and neurobiological mechanisms leading to the merger of population biology and behavioral ecology and the growing importance of neurophysiology as predicted by wilson 1975 3 2 abm in social systems in social systems the importance of individual actions has also long been recognized as a critical driver of relevant processes ostrom 2009 o sullivan et al 2012 p 113 turner et al 2003 the individuals in these systems often embedded in various networks are heterogeneous depending on the objective of a certain project agents could be entities at varying levels for instance cities are comprised of individual heterogeneous actors that are interconnected at multiple levels which is analogous to organisms embedded in relevant hierarchical structures or networks batty 2013 these heterogenous agents continuously interact with one another and with their environment this emphasis on networks of individuals as a vital driver of social systems will et al 2020 aligns well with broader changes in how cities and other systems are beginning to be viewed batty 2013 1 1 the united nations predicts that by 2050 around 66 of the world s population will be living in urban areas this expansion in urban populations will create significant challenges in creating sustainable and healthy cities with critical challenges needing to be met in improving water and transportation infrastructure air pollution and waste management as well as provision of adequate housing energy health care education and employment this is just one example of the complex and multi layered societal economic and environmental challenges that governments and policymakers need innovative solutions to while many models have been developed to address the impacts of future transport housing or healthcare initiatives most uses are purely empirical they lack any consideration of the individuals and their actions and interactions that drive many of the processes behind these challenges instead of distilling cities into homogeneous units whereby it was virtually impossible to say anything meaningful about the inner workings or micro dynamics batty 2008 cities are now being viewed as dynamic organisms that are a product of networks comprised of individual heterogeneous actors that are interconnected at multiple levels batty 2013 the relationships between these actors are often non linear changing both spatially and temporally when viewing a city in this way the emphasis is on modeling capturing and replicating new emergent properties in a complex system comprised of individual components that evolve and interact instead of a holistic approach to simulating social systems such as cities aggregate mathematical approaches such as spatial interaction models batty 1976 are still commonly used whilst the behavioral foundations of these models are well understood random utility discrete choice models etc more can be done to draw out the subtleties and detail of individual behavior and emergent social processes especially in the context of increasing empirical evidence in this context mobile phone and social media data could give unprecedented insights into individual behavior mobility and their networks without an understanding of how these social processes play in shaping or affecting social systems dynamics it is virtually impossible to verify any predictive simulation outcomes i e to know whether the forecasts of how a social system will react to a specific impulse in the future are robust despite new individual level data sets in abundance considering and recognizing the importance of each individual including the processes representing individual decisions and interactions as well as patterns that emerge from such processes has been largely absent from many modeling efforts abms can play an important role representing both the individual and social processes when studying social systems and their emergence axelrod and tesfatsion 2006 bae and koo 2008 crabtree et al 2017 crawford et al 2005 crooks and hailegiorgis 2014 makowsky and rubin 2013 malleson et al 2010 this is partially because abm has the ability to embody the characteristics and behaviors of individual entities e g humans households but can also capture system wide emergent processes abms bear the capabilities to model learning and adapting processes an 2012 cumming 2008 milner gulland 2012 and are thus able to explain or project macro level features such as nonlinearity and thresholds self organization uncertainty unpredictability surprising outcomes legacy effects time lags and resilience an 2012 levin et al 2013 2012 liu et al 2007 consequently social systems manifest features prevalent in many acs liu et al 2007 ecological modeling is not burdened with one of the major challenges in agent based modeling as in social systems representing human behavior an 2012 groeneveld et al 2017 heckbert et al 2010 levin et al 2013 schlüter et al 2017 schulze et al 2017 verburg et al 2016 whilst agent based modeling can adopt innovations from ecological modeling which is already happening to some degree vincenot 2018 modeling human decisions and behavior remains a big challenge building on traditional simple optimization algorithms progress has been made in cognitive frameworks for modeling human behavior and examples include the beliefs desires and intentions bdi and the physical emotional cognitive and social factors frameworks pecs conte and paolucci 2014 schmidt 2002 in the bdi framework agents are endowed with a set of beliefs about their environment and about themselves desires expressed as computational states that are to be maintained and intentions computational states that the agents aim to achieve modeling human decisions and behaviors is becoming an area of increased research activity for other approaches to modeling human decisions in abm such as microeconomic models space theory based models and institution based models we refer to an and others an 2012 groeneveld et al 2017 schill et al 2019 schlüter et al 2017 to date agent based models have proven successful as a tool for integrating knowledge across stakeholders to solve management issues to understand co evolution and emergent phenomena and to address adaptive management issues called for by sustainability science examples are abundant such as those in land use and land cover change groeneveld et al 2017 parker et al 2003 and in common pool resource research poteete et al 2010 schulze et al 2017 seidl 2015 voinov and bousquet 2010 3 3 abms in social ecological systems social ecological systems ses ostrom 2009 turner et al 2003 also manifest the following features prevalent in many pure social or ecological systems according to liu et al liu et al 2007 and others irwin and geoghegan 2001 lindkvist et al 2017 malanson et al 2006 zvoleff and an 2014 heterogeneity reciprocal effects and feedback loops nonlinearity and thresholds surprising outcomes observable as a result of human nature couplings legacy effects and time lags and resilience levin et al 2012 liu et al 2007 synonyms of social ecological systems include complex human environment systems an et al 2020 2005 national research council 2014 coupled human and natural systems chans liu et al 2007 and social environmental systems schlüter et al 2012a such systems are by nature complex adaptive systems bearing properties of self organization uncertainty unpredictability and non linear dynamics levin et al 2012 the actors in these systems are heterogeneous continuously interacting with one another and with their environment learning and adapting an 2012 cumming 2008 milner gulland 2012 computational models are exemplary tools for understanding social ecological systems as complex adaptive systems with the aim to increase our understanding of interactions adaptive decision making co evolution and emergent phenomena schlüter et al 2012b however many challenges and possibilities remain in social ecological sciences to advance our understanding of social ecological systems more models need to explicitly be designed to focus on the feedbacks among actors and between actors and their environments as with social systems another challenge hinges upon modeling human decision making and behavior the methodological frontiers to address these needs include using patterns or stylized facts to validate model output and to guide parameter settings using mixed methods approaches by including surveys interviews participatory modeling and laboratory experiments to improve the representation of social ecological systems and human behavior grimm et al 2005 heckbert et al 2010 schulze et al 2017 and incorporating qualitative data finally more transdisciplinary and interdisciplinary collaborations are key to increase the quality of models that address social ecological systems because of the inherent interdisciplinary nature of research in these systems schulze et al 2017 a common real world application of abm in socio ecological studies is to inform policy to advance the use of abms for decision and management support communication of model development analysis documentation and presentation need substantial improvement towards more systematic and transparent ways heckbert et al 2010 müller et al 2013 schulze et al 2017 abms have a potentially important role in normative institutional and policy design for social ecological systems once researchers have empirically compelling representations of human behaviors in abms one can test the extent to which a new proposed policy or design might result in adverse unintended consequences for example agent based computational platforms for the exploration of new market designs for electric power systems are highly complex systems that involve intricate interactions among human physical and environmental agents traditional disciplinary boundaries social sciences engineering physical sciences etc are a major detriment for such transdisciplinary abm application areas 4 traditional methods and models in acs science different model types represent different tools traditions and basic assumptions about how systems under investigation work ideally the perspectives represented by different model types are related to one another vincenot et al 2016 2011 below we briefly review differences and complementarity between abm and other kinds of models 4 1 weaknesses of non abm approaches in acs traditional mathematical or analytic models are often based on a few simple equations or rules including differential equations dynamic state variable models ideal free distribution models game theory models systems dynamics models and statistical methods to explain the complexity of acs such traditional mathematical or analytic models have shown a variety of strengths and weaknesses statistical models and system dynamics models are powerful in characterizing systems at an aggregate level while lacking the ability to represent heterogeneous actors that interact with one another equation based and game theoretic models polasky et al 2011 and system dynamics models are useful for representing feedbacks between systems and for explaining macro level characteristics but lack the ability to represent the micro level processes and interactions heckbert et al 2010 additionally these methods cannot represent adaptive decision making and the co evolutionary aspect of acs except for bayesian networks and evolutionary models where a decision of one agent at one site or point in time may influence other agents decisions system events and system level outcomes at different locations or later times thus these non abm approaches fail in capturing the essence of acs folke et al 2010 which is problematic for improving governance and management strategies for increasing the sustainability of social ecological systems in situations where interactions among agents are contingent on experience and agents adapt to that experience traditional equation based models are often limited if not impossible for deriving the dynamic consequences traditional mathematical modeling approaches miss the capacity to handle some immediate proximate complexities that agents encounter making it difficult to handle variation in individuals and their decision making in complex situations where agents have no experience abm scientists employ a range of useful techniques such as genetic algorithms and artificial neural networks enabling agents to respond quickly and adequately deangelis and diaz 2019 in such instances agent based modeling often offers the only practical method of analysis 4 2 complementarity and fuzzy boundaries with non abm models our exclusive focus on abms does not imply that we downplay ignore or even deny the important role of other types of models in particular mathematical and statistical models on the contrary many abms one type of mechanistic models incorporate such types of models abms do not replace but complement traditional mathematical or analytic models and they share many challenges in areas such as inverse parameterization analysis of model robustness coupling with traditional process based models and sensitivity and uncertainty analysis moreover the boundaries between abm and traditional models are becoming porous the majority of mathematical models are no longer solved analytically but numerically which means that they are simulation models as much as abms consequently many of the issues with abms reported here may also apply to mathematical modeling seppelt and richter for example report on the solution of systems dynamics models we can show that solutions a differ if different development tools are chosen but the same numerical procedure is selected b depend on undocumented implementation details c vary even for the same tool but for different versions and d are generated but with no notifications on numerical problems even if these could be identified seppelt and richter 2005 as discussed in the paper by tesfatsion 2017 most agent based models are not simply the computational implementation of a model or set of models previously developed in equation or whatever form rather agent based modeling often proceeds from agent taxonomy and flow diagrams to pseudo code and finally to software programs that can be compiled and run in this case the software programs are the models in principle any abm software program can decompose to or equivalently be represented in abstract form as a system of discrete time or discrete event difference equations starting from user specified initial conditions tesfatsion 2017 however these analytical representations become increasingly complex as the number of agents and rules defining their behavior increase 4 3 robustness analysis robustness analysis refers to building a set of similar yet distinct models of the same phenomenon examining whether these models may lead to similar results despite their different assumptions parameters and or even model structures levins 1966 robustness analysis was formulated for simple mathematical models but has recently been generalized for abm grimm and berger 2016 different simpler versions of an abm are created in the attempt to systematically break the models and thereby identify key mechanisms and limitations to explanations provided by an abm robustness analysis will help establish a new culture of communicating models instead of only making sure that the model is realistic because it reproduces observations we also need to demonstrate when and why the proposed mechanisms break down the purpose of robustness analysis and related analyses is not only to obtain essential insights into the chosen study sites but also about explicitly finding out what essential spatial temporal or organizational scales what key processes patterns what feedback loops heterogeneity or tipping points thresholds and so on may give rise to various aspects of complexity including but not limited to emergence surprising outcomes resilience and path dependence 4 4 coupling of abm with other process based models coupling abm with traditional process based models is an emerging research frontier in acs research especially in earth system modeling and water resources system analysis among a set of major challenges highlighted in this domain e g coupling abm with other models agents decision rules and spatial scale issues how to fully address human behavior and its effect on the natural environment such as irrigation streamflow regulation and groundwater pumping and dynamically capture the feedback of natural processes influencing human behaviors such as climate change mitigation to form a tight or two way coupling between abm and process based models is a major challenge 4 5 handling uncertainty as the agent based modeling method matures there are opportunities to begin to adapt useful methods from longer established fields in order to improve the rigor of agent based modeling this is especially true with respect to how agent based models deal with uncertainty there are several reasons why uncertainty can make its way into model results it might be a result of noise in the input data that are used to parameterize the model or because the model rules themselves are poorly specified the model is not adequately representing the system that it is designed to represent other fields particularly the environmental sciences such as meteorology and hydrology have decades of experience in developing methods to quantify and manage uncertainty one of these is ensemble modeling an ensemble is a group of models that are run simultaneously murphy et al 2004 the models are probabilistic so naturally begin to diverge during the course of a simulation by analysing the range of outcomes across an ensemble of models it is possible to begin to better understand how uncertain the outputs are where most models are broadly in agreement in their results there is less uncertainty compared to the situation where the models diverge substantially one way to prevent a simulation from diverging from reality would be to occasionally incorporate more up to date data and adjust the model accordingly there are a range of techniques that come under the banner of data assimilation that are designed for exactly this purpose however they have largely evolved from fields such as meteorology i e to incorporate up to date environmental data into weather forecasts and it is not clear whether they are appropriate for use in agent based modeling some have begun to explore this area clay et al 2020 long and hu 2017 malleson et al 2020 rai and hu 2013 2013 ward et al 2016 but only with the simplest agent based models the marriage of data assimilation methods and agent based models could be transformative for the ways that some systems are modelled consider the following example regarding the benefits of data assimilation approaches adapted from swarup and mortveit 2020 agent based modeling is an ideal tool to model disease spread but typically models are restricted to hypothetical scenarios however with the abundance of new data that are available in near real time a high spatiotemporal resolution agent based model of a national or global disease spread could be executed in real time using data assimilation techniques to incorporate the most up to date disease surveillance data the model could not only be used to make short term predictions to highlight the emergence of potential new clusters or as a virtual laboratory to test potential mitigation policies but could also be used to highlight areas where its predictions are the least certain and would hence benefit from additional local data collection 5 challenges in agent based modeling the increasing recognition and application of abms in a wide range of disciplines should not warrant overlooking or downplaying the challenges that the abm community needs to address in order to establish itself as a rigorous tool for advancing acs science these challenges if not addressed with the highest priority in abm research can lead to ad hoc design of models which are nontransparent and untestable and in turn useless or even harmful for theory development and application in the long run specifically challenges abound in many aspects such as 1 basic difficulties in model development communication understanding verification and validation 2 difficulties regarding coherence because of the substantial variation in platforms programming languages model details and sophistication and modeler s preferences 3 difficulties in computational efficiency as most abms are developed on personal computers but see these two papers tang et al 2011 tang and bennett 2011 for exceptions 4 inadequate model module transparency and reusability which partially contributes to the challenge of verifying validating and analyzing model outcomes including model sensitivity and 5 difficulties in generalizing findings and scaling them across scales an 2012 an et al 2005 heppenstall et al 2016 o sullivan and manson 2015 parker et al 2003 we acknowledge that these challenges limit the usefulness of abms in scientific inquiry and empirical problem solving domains nonetheless it is worth pointing out that the basic principles of modeling starting with a question and trying to find the right set of key processes of a system s internal organization apply to any kind of mechanistic modeling consequently the challenges to be mentioned below regarding communication understanding verification validation and so on are general and not specific for abms 5 1 integrated human environment abms the connections between human and environmental systems were assumed to be decomposable into a set of simple unidirectional relationships which has hindered understanding of these systems an et al 2014a many complexity features e g those observed in several empirical social ecological systems section 3 3 call for coupling of human and nature systems in this context researchers have proposed the coupled human and natural systems chans framework building on complex systems theory liu et al 2007 section 3 3 however there still exist many unanswered questions when people work under this framework how do we customize the complexity of the representation of ecological and human processes to the intended purpose of the model exploratory or theoretical participatory descriptive or predictive how do the relative temporal scales of the ecological and human processes in the target system influence the representation of ecological processes static simple state transitions dynamic or influence the nature e g tightness of the coupling between ecological and human components of the model building on a fundamental philosophy of methodological individualism abm has a unique ontology that represents key real world actors as heterogeneous individual agents carrying attributes and actions including interactions with other agents and or their environment this ontology allows a bottom up style examination of many emergent outcomes that are prevalent in human environment systems abms are therefore very useful in modeling social ecological human environmental systems given the complexity nonlinearity and heterogeneity in particular qualities that exist in these systems for instance abms should provide unique insights when modelers tackle issues around harmonizing social and environmental data that are subject to various spatial and temporal scales extents resolutions or incorporate low level processes and interactions within and between both dimensions of the chans system furthermore abms provide a platform to perform policy or mind experiments or visualize outcomes under certain policy interventions 5 2 modeling human behavior one hotspot research area is modeling human decision making in acs especially decisions regarding their interaction with the environment here we refer to conceiving decision making at an individual level rather than embedding it in social institutional and spatial contexts o sullivan et al 2012 representing adaptive behavior is challenging in abms in general including the behavior of cells in tissues bacteria plants or animals because it has to be based on first principles such as energy budgets martin et al 2013 fitness seeking railsback and harvey 2002 photosynthesis scheiter et al 2013 or stoichiometry sinsabaugh et al 2013 representing human behavior however adds further complexity because of social interactions in increasingly complex networks anticipation of the behavior of others which is addressed for simple settings in game theory and memory learning and emotions which all can lead to different decision algorithms in different contexts current practice in representing human behavior is limited schlüter et al 2017 and dominated by simple optimization algorithms moreover there is no culture of rigorous theory development which would require that alternative representations be implemented and tested for their ability to reproduce multiple patterns observed in real social systems the key feature of this pattern oriented theory development grimm and railsback 2012a railsback and grimm 2012 is that we would not strive to find a perfect representation of behavior of single individuals in simplified settings such as in behavioral ecology and economics but to select representations which are good enough to reproduce patterns observed at both the agent s and system s levels such tested representations should be referred to as theories of behavior and could constitute re useable building blocks for representing human behavior in general it is also expected though that different theories are needed in different contexts so there might be no unique representation of human behavior for example during a panic in a theater it is sufficient to represent humans as brownian agents while in other contexts we might need to include emotions and employ complex approaches such as neural networks and genetic algorithms to predict how agents respond to certain situations eliassen et al 2016 2009 giske et al 2014 lindkvist and norberg 2014 one of the hallmarks of abm is its ability to capture and model human behavior ironically this is also one of the areas in which abm has been heavily criticized heppenstall et al 2016 following the typology set out by kennedy 2012 there are two broad ways to classify behavior through mathematical or cognitive approaches the mathematical approach centers on the custom coding of behaviors within the simulation for example using random number generators to select a predefined possible choice e g to buy or sell pumain and sanders 2013 to understand human behavior in a more nuanced way and to take account of factors such as individual preferences local knowledge and environment developments of key things such as threshold based rules are very important these allow events to trigger a specific agent behavior for example moving to a new location within a neighborhood crooks 2010 these approaches have great utility when the behavior is both well understood and documented a second contrasting approach to simulating human behavior uses conceptual cognitive frameworks here more abstract concepts such as beliefs desires and intentions bdi rao and georgeff 1991 or physical emotional cognitive and social factors pecs schmidt 2002 are embedded within individual agents both the bdi and pecs frameworks have been successfully applied to modeling human behavior within social sciences for instance for modeling the drivers of criminal behavior in an a spatial model that uses the bdi framework see brantingham et al 2005 for a geographically explicit model that represents behavior through the pecs framework see malleson et al 2013 second representing agents decision making processes in human environment studies remains another major challenge here it is important to correct a major misconception still being expressed by some commentators uninformed about the powerful capabilities of modern software namely the misconception that abm representations of human decision makers must necessarily be stupid to the contrary the constraints on agent decision making implied by abms are constraints inherent in every real world social system the decision making representation methods used by abm agents can range from simple behavioral rules to decentralized optimization to sophisticated anticipatory learning algorithms for the approximate achievement of intertemporal objectives a framework for mapping and comparing human decision making in models of socio ecological systems dubbed mohub modeling human behavior has recently been published schlüter et al 2017 with the aim to facilitate choices of how to model human decision making this is important because of the strong impact assumptions on human behavior may have for model outcomes and its final impact on e g policy recommendations 5 3 abm transparency and reusability lack of transparency and reusability in abm code has been mentioned as one of the bottleneck problems for the abm community an et al 2014a evans et al 2013 national research council 2014 parker et al 2003 part of this problem stems from a lack of central development within abm abm has a somewhat fragmented development with advances being made in different disciplines for example validation approaches in ecology grimm et al 2005 and handing of space in geography heppenstall et al 2016 without adequate transparency and reusability it is not only very difficult to verify and validate abms but a large amount of resources are wasted such as modules and programming libraries that have been developed and tested by abm experts and could have been reused in human dynamics research the lack of open source software packages has become a major impediment to the promotion of abm the availability and widespread use of source codes will play a critical role in the adoption of new perspectives and ideas enhancing abm more toolkits are needed to interface the open source revolution and abm seeking cross fertilization between these two fast growing communities there are though initiatives to tackle the challenge of documenting and presenting agent based models fortunately the development of presentation protocols for abm is now an active area of research grimm et al developed the overview design concepts details odd protocol as a standard format for describing abms in ecology and beyond grimm et al 2020b 2010 2006 it provides a fixed structure and terminology making model descriptions start with an overview of the model s purpose entities state variables scales and processes and their scheduling followed by listing how important design concepts for abms such as emergence or interactions have been considered finally details on initialization input data and all process representations submodels are given the purpose of odd is to facilitate reading and understanding to provide exactly the same kind of information always in the same sections and to provide all details that are needed for re implementing the model the use of the odd has improved transparency in abm but limitations remain because verbal model description will always include ambiguities grimm et al 2020b moreover for specific classes of models a more refined structure might be useful this is in particular the case for modeling human behavior therefore müller et al suggested odd d adding elements that facilitate selecting and documenting important features in models of human decision making müller et al 2013 some scholars have criticism for applying odd to abms in all situations but suggest development of multiple standardized presentation protocols which should be tailored to the purpose and development of a modeling effort reusability is fostered by archives of existing models which include not only the program code but also instructions for use and transparent model descriptions preferably using the odd protocol the model library of comses net has become a useful platform where modelers can seek building blocks to incorporate in their own models it even provides a database with all agent and individual based models published so far netlogo wilensky 1999 specifically designed for abms and increasingly used for implementing abms is easy to learn railsback and grimm 2012 wilensky and rand 2015 and computationally less limited than generally believed railsback et al 2017 another route to reuse of models is model re implementation instead of starting each modeling project from scratch thiele and grimm suggest to scan existing models and try and re implement the most suitable one thiele and grimm 2015 even if the final model only includes a few elements of the re implemented model starting from an existing model saves a considerable amount of time for model formulation which then can be invested in model analysis and improvement re implementation also fosters theory development because researchers can try and break models to identify elements and processes that are essential for the model to produce realistic results computational modeling in general needs to go beyond showing that a model looks right by showing where and when they go wrong grimm and berger 2016 thiele and grimm 2015 5 4 abm verification and validation verification and validation of abms has been a problem besetting abm modelers and users for many years an et al 2014b 2005 manson 2002 national research council 2014 parker et al 2003 many issues arise from this difficulty couclelis 2002 although this problem is not confined to abm it also besets other domains of modeling for instance the global climate research community is struggling with the credibility of different general circulation models when they cannot reproduce the historical climate without robust model validation and a joint understanding of what model validation and verification is the reliability of abm cannot be established limiting its usefulness and application in various contexts an et al 2014b brown et al 2008 augusiak et al reviewed terminology regarding the term validation and came to the conclusion that this term cannot be used for any practical purpose anymore because it is impossible to boil down its wildly varying definitions and interpretations to a single one augusiak et al 2014 as a solution they suggest the artificial term evaludation a merger of evaluation and validation which covers all elements of iterative model development model purpose conceptual model data evaluation software verification model output verification and corroboration and model analysis they then point out that the general notion of validation often is too narrow requiring that as in physics a model makes predictions of features that were not used for model calibration i e independent or secondary predictions it is thus important to distinguish between model verification which shows that the model reproduces calibration patterns and model corroboration which is about independent predictions documenting how all these elements were addressed during model development is facilitated by using the standard documentation format trace grimm et al 2014 empirical validation of abms is a highly active research area as discussed in tesfatsion s paper tesfatsion 2017 abm permits model builders with scientific objectives to strive for the simultaneous achievement of four distinct aspects of empirical validation i e 1 input validation are the exogenous inputs for the model empirically meaningful and appropriate for the purpose at hand 2 process validation how well do the physical biological institutional and social processes represented within the model reflect real world aspects important for the purpose at hand are all process specifications consistent with essential scaffolding constraints such as physical laws stock flow relationships and accounting identities 3 descriptive output validation how well are model generated outputs able to capture the salient features of the sample data used for model identification and 4 predictive output validation how well are model generated outputs able to forecast distributions or distribution moments for sample data withheld from model identification or for data acquired at a later time or a different place this pursuit of comprehensive empirical validation will of course be tempered in practice by data limitations even in an era of big data and data advances data availability and quality remain important concerns computational limitations such as round off error truncation error and error propagation also remain a concern fortunately advances in computer technology and numerical approximation procedures are rapidly reducing these limitations 5 5 big data and high performance abm this potential of abm s capacity to leverage big data is improved by the increasing availability of big data such as high resolution remote sensing imagery social media data and large detailed human socioeconomic datasets wang et al 2013 ye and he 2016 big data are characterized by their characteristics in terms of volume size of data velocity update frequency variety types of data veracity quality of data and value importance currently abms are largely based on data from relatively small or local scales limiting the usefulness of abm in large spatial extent and high resolution contexts for a small set of exceptions that use parallel computing see the work by tang and associates tang et al 2011 tang and bennett 2011 while there is a growing use of agent based models for a variety of applications there are several key challenges that need to be overcome these range across the spectrum from theory to practice and from hypothesis to application crooks 2010 however the greatest challenge to abm is akin to many other modelling methodologies in that the realism that an abm can bring to a simulation is highly dependent on the quality of the data that it uses i e veracity for big data agents require accurate individual level behavioural data if they are to produce simulation results that can be used for policy without rigorous calibration fine tuning the model and validation testing the model on unknown data of the abm any outputs are essentially meaningless a typical abm can include hundreds to millions of heterogeneous agents each operating their own individual rule sets calibrating and validating these models with stochasticity therefore requires a huge amount of individual level data and leads to massive intermediate or output data e g based on considerable monte carlo runs in other words even if the spatial extent of an abm is not large the modelling steps from verification calibration validation to experimentation can easily pose a big data driven challenge fortunately big data can potentially provide the level of detail required the term big data is somewhat misleading which refers to both traditional large data sets for example national censuses as well as new digital information generated from social media high resolution satellite imagery gene sequencing data and the like with the proliferation of social media information generated and disseminated from these outlets has become an important part of our everyday lives our ways of examining social spatial interactions are increasingly transformed by the development of more powerful computing technologies emerging big and open data sources and new perspectives on social spatial processes shaw et al 2016 social media such as twitter capture data about individual behavior and movements that have previously been absent from modelling efforts e g considering the veracity issue as more social media data are increasingly available agent based modelling has been used to predict human behavior like posting forwarding or replying to a message with regard to topics and sentiments ye and lee 2016 despite the obvious potential of big data there are considerable issues to overcome such as bias noise generalization and in some cases the ethics of whether researchers should be using this kind of data heppenstall et al 2016 to resolve the big data and computing challenges facing abms high performance computing enabled by state of the art cyberinfrastructure represents a unique solution a series of abms based on high performance computing have been reported in the literature tang et al 2011 tang and bennett 2011 tang and jia 2014 high performance abms often focus on large spatiotemporal extents and or fine resolutions tang and jia 2014 large scale abms rely on two typical parallelisms message passing and shared memory wilkinson and allen 2004 which allow for dividing e g via spatial domain decomposition ding and densham 1996 wang and armstrong 2003 a model into smaller sub models that can be deployed to high performance computing resources for parallel computing tang and wang 2009 message passing shared memory or the combination of both enables the inter processor communication for data or information required by neighbouring sub models gong et al 2013 shook et al 2013 this high performance computing solution is not only suitable for abms with large spatiotemporal extent and fine resolutions but also can facilitate the use of small scale abms in need of huge computational support these small scale abms often require a significant number of monte carlo repetitions through alternative modelling phases including calibration verification validation sensitivity and uncertainty analysis and experimentation for scenario analysis these massive monte carlo runs while independent of each other can be deployed to and thus accelerated by high performance computing resources tang and bennett 2010 5 6 spatially explicit abms there are many modeling issues that apply to but are not limited to spatially explicit models e g the effects of random number generators the way to handle boundary conditions the effects of spatial structure and model type on abm evaluation e g via sensitivity analysis the effects of spatial resolution extent and data on model calibration and validation and the possibility and benefits of employing alternative spatial representation in comparison to the traditional cartesian space e g adoption of relative space in abm an et al 2015 informed decisions on these issues may be conducive to developing more robust abms we refer readers with interest in this domain to manson et al 2020 finally the above challenges are also affected by the spatial scale issue of abm setup abms are often developed with an implicit assumption that agents interact with each other within a system however agents across distant systems around the world have rarely been taken into consideration even though they are increasingly interacting to understand and manage such complex distant interactions an integrated framework of telecoupling has been developed liu et al 2013 http telecoupling org telecoupling is defined as socioeconomic and environmental interactions between multiple social ecological systems over distances as an umbrella concept it encompasses many processes such as migration trade tourism species invasion environmental flows foreign direct investment and disease spread telecouplings have profound implications for global sustainability and human well being as they can transform the structure function pattern process and dynamics of social ecological systems across local to global scales thus it is necessary to develop a new set of abms telecoupled agent based models liu et al 2014 6 opportunities from artificial intelligence and data science the challenges summarized in section 5 not only limit the usefulness of abms in scientific inquiry and empirical problem solving domains but also hamper our understanding of acs structure and processes fortunately the advances in artificial intelligence unique new forms of data and data science will substantially help address these challenges 6 1 opportunities from artificial intelligence starting in the l950s modern artificial intelligence ai has aimed to emulate the natural intelligence seen in human or animal behavior under a critical assumption that to a large degree machines can be made to simulate human intelligence typically this means being able to demonstrate cognitive functions usually displayed by humans such as goal oriented behavior learning reasoning knowledge representation planning language processing and problem solving such as the ability to move and manipulate objects by e g robots ai is also an academic discipline for its own right albeit one that is highly fragmented ai leverages both traditional e g statistical methods mathematical optimization economics and non traditional methods e g artificial neural networks computational intelligence to understand and simulate human intelligence sub disciplines of ai range from those associated with the use and development of statistical techniques such as regression to recognize patterns in data to the creation of human like intelligent robots that are able to perceive their environment and learn to conduct particular tasks e g recognizing an object and interacting with it considering the goals and methods of ai ai appears a natural solution for the abm challenges described above although the ability to create truly intelligent agents is obviously extremely relevant to abm most agent based models do not actually require agents with such a high degree of intelligence the contribution of ai to abm is most keenly felt by developments that are more commonly used in data science such as machine learning regression neural networks reinforcement learning etc however progress has been slower than expected with data limitations being one of the most fundamental reasons as most ai methods that could be employed to build intelligent agents require large amounts of often individual level data and such sources were not readily available in the past alongside the methodological developments that are emerging under the banner of ai there has been another transformative change that has fostered the success of ai related developments and is directly relevant to abm the emergence of big data 6 2 opportunities from big data the advent of big data may provide a solution for using ai to nourish abms the usefulness of big data should be highlighted in understanding agent based complex systems as noted we have increasing amounts of individual level data but a challenge remains in how to link disparate data sets and extract useful information and insights offered by these data it is not only burdensome in obtaining storing cleaning or mining such new forms of data but there are also ethical problems with sources such as gps telemetry social media and remote sensing when we aim at revealing detailed information about individual actions or local processes furthermore it may be more challenging to resolve biases from big data than from carefully crafted traditional data the majority of published applications use more traditional data types which is most likely due to the fact that modelers are more comfortable with manipulating traditional sources of data e g census data various sample data robinson et al 2007 rather than mining new forms of data or consider these new sources of data as too noisy biased or inaccurate despite these challenges big data may provide us with new avenues with which to explore how people perceive use and react to events in the spaces around them and the potential to incorporate these observations into our models in near real time moreover many of these sources of data allow us to examine connections between people organizations and space thus offering a new perspective with which to construct artificial worlds build environmental layers and derive behaviors that motivate agents to make certain choices and take certain actions such data micro data mostly driven models including abms may suffer from a serious drawback they are heavily data driven or data centered with little consideration of theory as a result it is almost impossible to reproduce model results or to interpret them for instance othman et al created an abm of the rail network in singapore which used only train ticket purchasing data as its input othman et al 2015 there is an implicit assumption that models built using new forms of micro data will capture the essential processes that are taking place in these systems however abms that represent dynamical processes as snapshots in time can be misleading hassan et al 2008 this leads to another weakness of many micro data driven models without actually knowing much about the important processes that need to be captured it is an almost impossible task to build models that are representative of the real world and generate meaningful results yet modern data science especially combined with artificial intelligence may help substantially address this challenge 6 3 opportunities from qualitative data another prominent issue is the lack of using qualitative data particularly ethnographic data such as text images videos and audio documents in abm agar 2005 for exceptions see the work by lindkvist et al and schulze et al lindkvist et al 2017 schulze et al 2017 this trend matches the basic idea of pattern oriented modelling grimm et al 2005 grimm and railsback 2012b railsback and grimm 2019 where a combination of several qualitative or weak patterns which a model is supposed to reproduce can be as effective or even more so than using a single highly detailed pattern to reject unsuitable submodels and parameter combinations a typically weak but still quantifiable pattern refers to a situation in which certain variables for example population size average wealth average and higher moments of age or time needed to recover from a disturbance event stay within certain intervals an emerging literature has noted that ethnography can be systematically used to inform both functions of social processes and decision making rules within abms provide insight into selecting outcome variables for analysis increase abm quality and empirical accuracy especially in representing human decision making and social systems tubaro and casilli 2010 for instance the modelling agent systems based on institutional analysis framework maia has been used for participatory abm development with ethnographic data ghorbani et al 2015 although yang and gilbert developed guidelines for ethnographically informed abms there remains a need to more broadly apply and refine both the maia framework and modeling guidelines yang and gilbert 2008 increasing the use of qualitative data is challenging as few researchers are competent in both abm building and qualitative ethnographic data collection and analysis tubaro and casilli 2010 addressing this challenge requires either training new interdisciplinary abm researchers or increasing collaboration among quantitatively and qualitatively trained researchers further qualitative data are often seen as lacking rigor and there is a need to bridge the cultural gap between quantitative and qualitative researchers regardless agent based modelers and qualitative researchers share the overlapping goal to understand mechanisms and processes in social systems yang and gilbert 2008 making increased collaboration a compelling means to strengthen abms representation of the system s and social processes methodological challenges arise in areas such as translating qualitative data to quantitative model parameters and model generalization from inherently context specific ethnographic data when extracting patterns and identifying thresholds or multipliers from qualitative data such as field notes from participant observation there will inevitably be instances of unjustifiable magic constraints in the code yang and gilbert 2008 p 7 further there will be places where the code must be made more precise or concrete than the context of the qualitative data would allow when faced with the challenge of defining parameters based on qualitative data the most important consideration is not the specific numbers but on whether the numbers can reproduce or represent the patterns identified in the qualitative data then as with any abm the impact of parameter variations should be addressed via sensitivity analysis and discussed in the context of the ethnographic case or ideally cases yang and gilbert 2008 6 4 opportunities from data science the field of data science refers to the use of scientific methods programming tools and appropriate data infrastructures to derive insight from data that can lead to a better understanding of some underlying phenomena successful data science methods or techniques are emerging in many areas of research or empirical applications for example convolutional neural networks cnns have demonstrated success in classifying or segmenting hyperspectral satellite imagery ma et al 2019 and detecting targets from aerial vehicle imagery vidalmata et al 2020 recurrent neural networks rnns have been a popular option for time series forecasting with vast applications ranging from modeling covid 19 transmission chimmula and zhang 2020 to upcoming earthquake prediction graph neural networks gnns recently emerged to model predictive tasks defined over a graph or a network kipf and welling 2016 such as to capture the complex spatial patterns underlying graph structured geospatial data zhu and liu 2018 or to model the information propagation or event prediction in a social network fan et al 2019 many above data science techniques with essential contribution from artificial intelligence data analytics and high performance computing can be extremely valuable as a means of deriving insight from data to inform the basic structure of a model i e to provide empirical support for underlying theories as well as to calibrate and or validate agent based models crooks and wise demonstrate how crowdsourced spatial data can be used to better understand the real world situation after a humanitarian crisis and use that new information to inform an agent based model to support relief efforts crooks and wise 2013 similarly crols and malleson use real time footfall data coupled with an agent based model to estimate the demographics of visitors to a town center crols and malleson 2019 even deep generative models have been introduced to synthesize high fidelity data samples with realistic representations of the underlying spatial correlation structure for gis applications klemmer et al 2019 below we briefly review two kinds of machine learning machine learning via regression in addition to providing a means to generate data that can be used to calibrate and validate agent based models big data and associated data science techniques can also be used to improve the behavior of agents one of the most well known data science techniques is machine learning ml as a subfield of artificial intelligence ml refers to a suite of algorithms that have a generic structure but can be parameterized to detect relationships in data through a process of training specifically ml extracts patterns and learns accurate predictive models from often massive data without being explicitly programmed put another way ml learns a predictive function from data training involves feeding data to the algorithm so that it can estimate the parameter values that best allow it to distinguish between different patterns in the data supervised ml algorithms are provided with data that have already been labeled so the aim of the training process is to identify which input values lead to a given output probably the most widely used supervised machine learning technique is linear regression a regression equation typically has the form y α β 1 x 1 β n x n ϵ where y is the dependent variable to be predicted and x 1 x n are the independent variables the model is trained with data so that the parameters α and β s s 1 2 n can be estimated in that way the generic model structure can be parameterized to detect relationships in vastly different data sets regression equations are commonly used to better understand a particular phenomenon e g to provide empirical support for a given theory and use this information to inform an agent based model but they can also be used directly to control the behavior of the agents for example zhang et al present an agent based model of solar panel adoption that includes agents whose behavioral choices rather than being programmed directly are determined through the application of a regression model zhang et al 2016 machine learning via neural networks in recent years more advanced machine learning techniques have evolved to model non linear patterns that cannot be represented by standard regression techniques of these neural networks have emerged as one of the most versatile algorithms a neural network consists of layers of nodes that are connected by links fig 3 as input data are fed into the algorithm nodes receive messages from parent i e message sending nodes and fire messages to their child message receiving nodes depending on whether the messages that they receive as input are greater or lesser than some threshold like a regression equation these thresholds are parameters that need to be optimized a process called back casting allows the neural network to estimate optimal values for these parameters from training data neural networks were inspired by the structure of the brains of animals so are of obvious interest to agent based modelers it is feasible that rather than attempting to define decision rules for agents by hand each agent could be implemented with their own neural network in a similar way to zhang et al s agents who had their own regression equations zhang et al 2016 then the process of calibrating the model would involve optimizing the neural networks for all the agents however the uses of neural networks to control the behavior of agents directly are relatively rare this could be because the process of calibrating a model could be extremely difficult a single neural network typically requires very large volumes of training data so a model that consists of large numbers of independent neural networks one per agent would be very challenging indeed or perhaps they are not seen as attractive because it is very difficult to interpret why a neural network makes its predictions a gnn typically learns node representations by recursively aggregating information from their neighborhood nodes classical gnn tasks include graph classification e g molecular structure classification ying et al 2018 node classification e g publication classification in an article network karimi et al 2019 kipf and welling 2016 link prediction e g predicting integrations in a social networks zhang and chen 2018 and collaborative filtering e g recommendation systems like amazon or netflix wang et al 2019 most population level interactions come naturally in the form of graphs and can be modeled as graph edges for example in geospatial data spatial objects can be represented as nodes and their topological attribute relationships are represented as links making gnns the natural model choice furthermore gnns can be cascaded with other models such as cnns for joint information extraction on the individual level though cnns or so and interaction modeling on the population level through a gnn furthermore gnns can be cascaded with other models such as cnns for joint information extraction on the individual level though cnns or so and interaction modeling on the population level through a gnn a concrete example of using gnns to derive behavioral rules of networked entities can be found in a recent application in the autonomous flocking of multi agent robot swarms the authors consider a decentralized network of moving robot agents each agent is viewed as a node in a dynamic graph with two agents within a communication range connected by an edge and changes in this one graph are determined by both gnn and rnn a gnn is applied on top of the graph for aggregating and forecasting the population level behavior patterns further each individual agent node can perceive the visual environment and extract features by its own convolutional neural network cnn which processes each drone s visual input like eyes note that each node or agent has its own cnn the resulting model is then a cnn gnn stack and can be trained from end to end similar ideas can be potentially extended to handling any dynamic network with semantically rich nodes such as forecasting covid 19 transmission by exploiting the multimedia information from a social network where people are the nodes and person person contacts are the links that change over time this would enable modelers to use a unique rnn for each agent and model each person s nodes health status over time an rnn can be a naïve baseline itself without considering population influences while a gnn can be used to model the population level interactions edges that change over time too 6 5 agents learn and form behavior one area where neural networks are offering a promising route forward is through allowing agents to learn about their environment for themselves a valuable feature of an agent based model is that the behavior of agents can tell us something about the underlying system but we lose this advantage if the agents themselves are black boxes and we cannot understand why agents make decisions as they do we can better understand why agents make their decisions through methods such as reinforcement learning where positive behaviors are learned through repeated exposure to an environment through building and refining deep neural networks such networks may capture uncertainty and incomplete knowledge representations with large scale individual tracking data it may be possible to teach agents how to navigate spaces as if they were humans these learning agents may both better reflect the actual behaviors of humans and model their behavior under changing conditions progress is rapidly being made elsewhere banino et al 2018 but integration into geographical modelling remains a challenge but see e g work by abdulkareem et al abdulkareem et al 2019 using bayesian networks to help simulate complex decision making with regards to potential cholera infection agent behavioral learning can also happen with the aid of big data for instance with time series data of particles mass charge and geographic positioning information data gnn can be trained to derive closed form symbolic expressions of newtonian force laws and hamiltonians cranmer et al 2020 the authors begin with a starting graph say with n1 particles and n2 edges describing their relationships the authors use 1 an edge model to represent links edges among all n1 particles here is the key of their work there are many potential equations they aim to find them by gnn they are expressed as inductive biases which represent potential math functions of newtonian force laws here the goal is to use gnn to select function type and fine tune the value of all parameters in the corresponding function say one of the functions is named f1 then the authors use 2 a node model in which each node particle receives all the messages from all the rest n1 1 of the particles with the magnitude of each message i e amount of gravity calculated from the candidate function say f1 the authors use 3 a global model to aggregate and update the status of all messages and nodes over time below is the selection process once a gnn based function e g f1 plus number of parameters as part of complexity is used the authors calculate the status of all particles and compare them to the observed data of these particles i e the time series of particle data or spatial panel data mentioned at the start of this text a certain measure normalized mean square error or nmse is used to choose among the different alternative functions plus parameter values with model complexity number of parameters and operators in control the authors use the occam s razor rule to choose the final function or symbolic regression outcome when the nmse is large the same or close one with the least amount of complexity is the winner finally the authors found that the symbolic closed form model derived from ml is what newtonian force laws express 7 significance this article aims to air critical state of the art abm issues and provide a venue to seek resolutions first we bring several compelling abm problems and challenges to the forefront at the right timing with insight from key community leaders and practitioners at a time in which the use of abms is exploding but maintains a series of unresolved challenges this paper has used input from around 100 exceptional scientists with very diverse backgrounds http complexities org abm17 to depict the state of the art about abms providing inspirations and directions for many related fields to break new ground we have developed a set of guidelines for modelers and reviewers and for novices see supplementary information at the same time we provide a comparison of commonly used abm toolkits and software packages given the existence of 85 platforms or toolkits for abm and recommendations for abm acs education see supplementary information furthermore we provide a review of the use of abm in coping with covid 19 challenges this article is not only a pile of papers facts strengths and challenges related to abm but also aims to provide new insights into the field of modeling acs point out impending tasks and envision long term directions of acs studies in the short term we show the huge opportunities provided by data science and artificial intelligence section 6 in the long run we call for an ai informed acs science which warrants a transdisciplinary approach under the transdisciplinary approach all relevant disciplines are fused more seamlessly to detect and express mechanisms that have generated macro level outcomes fig 4 historically science benefited from the so called multidisciplinary approach fig s4a which features a concurrent parallel investigation of the same phenomena or subject from many relevant disciplinary perspectives or an integration of them conte and paolucci 2014 an advance in scientific inquiry is to invest in interdisciplinary efforts which aim to interweave knowledge theory and methods from many relevant disciplines performing multilevel and modular modeling fig s4b under transdisciplinary efforts artificial intelligence data science and domain knowledge will be interweaved to generate pathways or mechanisms that are more meaningful effective and less error prone in understanding and envisioning acs fig s4c with a clearer picture of abm strengths weaknesses available resources and impending tasks and future directions more potential users or developers and even commercial companies will be attracted to engage more with the abm community allocating necessary resources to the science technology and application of abm enhancing abm software and capabilities declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we are indebted to financial support from the national science foundation nsf through the method measure statistics and geography and spatial sciences bcs 1638446 and the dynamics of integrated socio environmental systems programs bcs 1826839 and deb 1924111 we thank the participants of the abm 17 symposium sponsored by the above nsf grant http complexities org abm17 for input and comments this project has received funding from the european research council erc under the european union s horizon 2020 research and innovation program grant agreement no 757455 and through an esrc alan turing joint fellowship es r007918 1 supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2021 109685 appendix supplementary materials image application 1 
24564,humanity is facing many grand challenges at unprecedented rates nearly everywhere and at all levels yet virtually all these challenges can be traced back to the decision and behavior of autonomous agents that constitute the complex systems under such challenges agent based modeling has been developed and employed to address such challenges for a few decades with great achievements and caveats this article reviews the advances of abm in social ecological and socio ecological systems compare abm with other traditional equation based models provide guidelines for abm novice modelers and reviewers and point out the challenges and impending tasks that need to be addressed for the abm community we further point out great opportunities arising from new forms of data data science and artificial intelligence showing that agent behavioral rules can be derived through data mining and machine learning towards the end we call for a new science of agent based complex systems acs that can pave an effective way to tackle the grand challenges keywords agent based complex systems agent based modelling socioecological systems data science artificial intelligence 1 agent based complex systems agent based complex systems acs largely equivalent to complex adaptive systems often include heterogeneous subsystems autonomous entities nonlinear relationships and multiple interactions among them arthur 1999 axelrod and cohen 1999 crawford et al 2005 levin et al 2013 individual actors make decisions and interact with one another or with their local and or remote environment giving rise to or shaping emergent outcomes which in turn affect the agents behaviors and interactions coleman 1987 railsback and grimm 2012 such systems may bear complexity features such as path dependence contingency self organization and emergence not analytically tractable from system components and their attributes alone bankes 2002 manson 2001 national research council 2014 a large amount of efforts have been invested in exploring complex systems axelrod and cohen 1999 grimm et al 2005 helbing et al 2015 levin et al 2013 2012 manson 2001 and the corresponding methods and tools cardinot et al 2019 kravari and bassiliades 2015 railsback et al 2006 from scientists of various backgrounds in biology cell simulation has included thousands of genes and millions of molecules karr et al 2012 in chemistry complex molecules have been investigated digitally in terms of their structure and properties before they are manufactured in the lab lewars 2011 in climate science the whole earth models couple atmospheric and ocean circulation dynamics to study global warming at ever finer spatiotemporal resolution lau and ploshay 2013 particularly worth of mention is the contribution from physics which traditionally using the language of mathematics focuses on theory and empirics e g experiment results later on physicists started to define and leverage complex systems theory as they were engaged in explaining deterministic chaos quantum entanglement protein folding spin glasses etc the system behavior crucially depends on its details such as interactions between constituent parts which lead to collective behavior and define the macro state perc 2017 the macro state would in turn affect the states of constituents and interactions making them co evolve over time all such observations and explorations especially those in statistical physics and quantum mechanics have substantially nurtured the growth of complex systems theory for detail on the contribution of physics in complexity science we refer to a review article holovatch et al 2017 also studies of complex adaptive systems have benefited from and are instrumental to efforts in understanding global macroeconomic network stock market political parties social insect colonies immune system and internet connections an et al 2020 axelrod and cohen 1999 cumming 2008 in this context more progress on acs theory development is needed in social ecological grimm and berger 2016 and social ecological sciences an et al 2020 2014a taking social ecological or human environment research as an example acs models are lagging behind in this field and have in particular not yet developed a productive culture of model analysis and testing schulze et al 2017 in social and ecological systems more efforts and achievements have been obtained see sections 3 1 and 3 2 yet they are fragmented less communicated to other disciplines and or not distilled into complex systems science level the development of a culture of system representation and exploration including model analysis and testing may enable scientists to develop acs models and principles distill commonalities from locale specifics test and generalize site independent hypotheses and ultimately formalize theories applicable to the acs under investigation this context leads to our efforts in this synthesis paper regarding modeling acs 2 history of agent based modeling agent based models abms for agent based modeling we use the acronym abm throughout the paper adopt a realist typically objectivist ontology where observable actions are modeled with a detailed representation of agents that live in complex environments grimm and railsback 2005 stillman et al 2015 in ecology abms are often called individual based models the abm approach focuses on the uniqueness of individuals and interactions among them or between these individuals and the associated environment s abms are used whenever one or more of the following aspects of real acs is considered essential for answering a certain question agents are different in some variables and such differences are essential for agent behavior and or systems dynamics agents interact locally in space or networks agents live in time varying and heterogeneous environment s agents adapt their behavior to the current and sometimes projected future state of themselves and their environment in their pursuit of a certain objective these aspects particularly agents flexible and diverse behavioral responses observed in human society or nature are not easily found in simplified models evans et al 2013 hence abm allows for studying a wider range of behavioral phenomena or processes and addressing many empirical and theoretical problems arthur 1999 axelrod and cohen 1999 lindkvist and norberg 2014 manson 2001 which are axiomatically complex technologically agent based modeling has emerged and prospered with the advent of increasingly available computing power new forms of data and capability of data handling and storage given complexities in acs it has been suggested that the abm approach be employed to understand harness and improve rather than fully control acs structure and function taking innovative actions to steer the system of interest in beneficial directions axelrod and cohen 1999 the use of agent based models for empirical study and scientific inquiry has increased rapidly among various scientific communities over the last two decades the number of authors and new authors who develop or use abms has been steadily increasing at an exponential rate since the mid 1990s fig 1 spanning research fields including ecology epidemiology land system science sociology and archaeology fig 2 see also the paper by vincent 2018 further advances in abm have led to the founding of the journal of artificial societies and social simulation in 1998 and several scientific associations in both europe and the us in the 2000s as a climax of abm popularity a pnas special issue was published in 2002 as an aftermath of the national academy of sciences sackler colloquium where abms were greeted with enthusiasm because of the potential revolution it may bring up in scientific inquiry bankes 2002 this hype faded with time as scientists sometimes tend to rush to a new approach that promises to solve previously intractable problems and then revert to familiar techniques as the unanticipated difficulties of the new approach are uncovered grimm and railsback 2005 p xi progress in agent based modeling has been slower than initially anticipated bonabeau 2002 huston et al 1988 in critical areas such as abm validation and identifying outcomes that differ from or are better than those from other types of models an et al 2014a grimm et al 2005 grimm and berger 2016 grimm and railsback 2005 rindfuss et al 2008 thiele and grimm 2015 interestingly such questions are not always asked of other model types subsequent progress with advancing abm methodology has been slow reflecting the fact that any tool for tackling complex systems comprised of agents in different contexts has to cope with complexity inherent in such systems these challenges can explain at least partially frustration with the approach and even general doubts about its usefulness e g couclelis 2002 roughgarden 2012 with the recent appearance of new forms of data e g micro level or individual level data from different sources such as citizen sensors smart meters and remote sensing and the unprecedented ability to better understand the system s under investigation the popularity of abms as a modeling tool continues increasing fig 1 abms are useful for integrating a variety of data and models from multiple disciplines for addressing problems across spatial temporal and organizational scales and for various mind experiments hypothesis testing or scenario explorations an et al 2014a 2005 borrill and tesfatsion 2011 2011 gimblett 2002 grimm 1999 abms are also increasingly being used to facilitate cooperation in inter or transdisciplinary settings where they support communication and understanding across disciplines and knowledge systems of scientists and non scientists for example via participatory modeling ramanath and gilbert 2004 voinov and bousquet 2010 3 abms in ecological social and social ecological systems 3 1 abm in ecological systems in ecology the use of abms often referred to as individual based models or ibms started about 10 years earlier than in other disciplines deangelis and gross 1992 huston et al 1988 liu 1993 initially abms were used to take into account heterogenous individuals and interactions between them at the local not global scale increasingly ecological abms are also representing adaptive behavior in ecological abms organisms are simulated as agents that move fight or flee browse or feed reproduce or form and maintain territories based on some internal state of each organism and its often imperfect knowledge of the environment with some goals such as optimal fitness deangelis and diaz 2019 in an increasing proportion of these models individual organisms make decisions to achieve some goal that increases fitness such as growth or survival these models have focused on the importance of many individual level behavioral differences such as bold vs conservative behavior in fish various responses to intra and inter specific competition and tradeoffs between growth mortality and early and late reproduction all such differences affect community dynamics making abm highly useful to account for details in individual behavioral traits in addition to age sex body mass and so on as well as feedback effects deangelis and diaz 2019 ecologists contributed to the maturation of agent based modeling through developing a standard format for model formulation and communication named the overview design concepts details odd protocol grimm et al 2006 polhill 2010 polhill et al 2008 other contributions from ecologists include testing a general strategy for achieving structural realism via verification and validation e g through pattern oriented modelling grimm et al 2005 grimm and railsback 2012a the increasing use of first principles e g energy budgets physiology objective seeking heuristic decision algorithms to represent agents behaviors martin et al 2013 railsback and harvey 2013 2002 scheiter et al 2013 and the establishment of sensitivity analysis as a required element of model analysis ligmann zielinska et al 2020 furthermore ecologists have developed a general framework for designing and documenting model evaluation which is particularly important for models developed for decision or policy support augusiak et al 2014 grimm et al 2020a 2014 schmolke et al 2010 ecology is also pioneering the modeling of adaptive decision making there are situations that traditional models mostly those aiming to optimize certain long term goals cannot handle well for instance agents respond via heuristics or rules of thumb of decision making to handle immediate reactions to changes in their environment e g food and perceived risk another good example is the emotion system of giske et al s fish model giske et al 2013 which integrates information motivation and physiological states in order to determine emotions which in turn form the basis for decisions and subsequent behavioral outcomes abms are especially suitable for answering ecological and evolutionary questions because they allow incorporating intra specific variation learning and adaptation relatively easily whereas inclusion of all of them in other model types was rarely if ever done akin to social systems see below abm in ecology has moved towards convergence to some cognitive models including the fuzzy cognitive maps social hierarchies e g within primate troops cheney and seyfarth 1992 and neurobiological mechanisms leading to the merger of population biology and behavioral ecology and the growing importance of neurophysiology as predicted by wilson 1975 3 2 abm in social systems in social systems the importance of individual actions has also long been recognized as a critical driver of relevant processes ostrom 2009 o sullivan et al 2012 p 113 turner et al 2003 the individuals in these systems often embedded in various networks are heterogeneous depending on the objective of a certain project agents could be entities at varying levels for instance cities are comprised of individual heterogeneous actors that are interconnected at multiple levels which is analogous to organisms embedded in relevant hierarchical structures or networks batty 2013 these heterogenous agents continuously interact with one another and with their environment this emphasis on networks of individuals as a vital driver of social systems will et al 2020 aligns well with broader changes in how cities and other systems are beginning to be viewed batty 2013 1 1 the united nations predicts that by 2050 around 66 of the world s population will be living in urban areas this expansion in urban populations will create significant challenges in creating sustainable and healthy cities with critical challenges needing to be met in improving water and transportation infrastructure air pollution and waste management as well as provision of adequate housing energy health care education and employment this is just one example of the complex and multi layered societal economic and environmental challenges that governments and policymakers need innovative solutions to while many models have been developed to address the impacts of future transport housing or healthcare initiatives most uses are purely empirical they lack any consideration of the individuals and their actions and interactions that drive many of the processes behind these challenges instead of distilling cities into homogeneous units whereby it was virtually impossible to say anything meaningful about the inner workings or micro dynamics batty 2008 cities are now being viewed as dynamic organisms that are a product of networks comprised of individual heterogeneous actors that are interconnected at multiple levels batty 2013 the relationships between these actors are often non linear changing both spatially and temporally when viewing a city in this way the emphasis is on modeling capturing and replicating new emergent properties in a complex system comprised of individual components that evolve and interact instead of a holistic approach to simulating social systems such as cities aggregate mathematical approaches such as spatial interaction models batty 1976 are still commonly used whilst the behavioral foundations of these models are well understood random utility discrete choice models etc more can be done to draw out the subtleties and detail of individual behavior and emergent social processes especially in the context of increasing empirical evidence in this context mobile phone and social media data could give unprecedented insights into individual behavior mobility and their networks without an understanding of how these social processes play in shaping or affecting social systems dynamics it is virtually impossible to verify any predictive simulation outcomes i e to know whether the forecasts of how a social system will react to a specific impulse in the future are robust despite new individual level data sets in abundance considering and recognizing the importance of each individual including the processes representing individual decisions and interactions as well as patterns that emerge from such processes has been largely absent from many modeling efforts abms can play an important role representing both the individual and social processes when studying social systems and their emergence axelrod and tesfatsion 2006 bae and koo 2008 crabtree et al 2017 crawford et al 2005 crooks and hailegiorgis 2014 makowsky and rubin 2013 malleson et al 2010 this is partially because abm has the ability to embody the characteristics and behaviors of individual entities e g humans households but can also capture system wide emergent processes abms bear the capabilities to model learning and adapting processes an 2012 cumming 2008 milner gulland 2012 and are thus able to explain or project macro level features such as nonlinearity and thresholds self organization uncertainty unpredictability surprising outcomes legacy effects time lags and resilience an 2012 levin et al 2013 2012 liu et al 2007 consequently social systems manifest features prevalent in many acs liu et al 2007 ecological modeling is not burdened with one of the major challenges in agent based modeling as in social systems representing human behavior an 2012 groeneveld et al 2017 heckbert et al 2010 levin et al 2013 schlüter et al 2017 schulze et al 2017 verburg et al 2016 whilst agent based modeling can adopt innovations from ecological modeling which is already happening to some degree vincenot 2018 modeling human decisions and behavior remains a big challenge building on traditional simple optimization algorithms progress has been made in cognitive frameworks for modeling human behavior and examples include the beliefs desires and intentions bdi and the physical emotional cognitive and social factors frameworks pecs conte and paolucci 2014 schmidt 2002 in the bdi framework agents are endowed with a set of beliefs about their environment and about themselves desires expressed as computational states that are to be maintained and intentions computational states that the agents aim to achieve modeling human decisions and behaviors is becoming an area of increased research activity for other approaches to modeling human decisions in abm such as microeconomic models space theory based models and institution based models we refer to an and others an 2012 groeneveld et al 2017 schill et al 2019 schlüter et al 2017 to date agent based models have proven successful as a tool for integrating knowledge across stakeholders to solve management issues to understand co evolution and emergent phenomena and to address adaptive management issues called for by sustainability science examples are abundant such as those in land use and land cover change groeneveld et al 2017 parker et al 2003 and in common pool resource research poteete et al 2010 schulze et al 2017 seidl 2015 voinov and bousquet 2010 3 3 abms in social ecological systems social ecological systems ses ostrom 2009 turner et al 2003 also manifest the following features prevalent in many pure social or ecological systems according to liu et al liu et al 2007 and others irwin and geoghegan 2001 lindkvist et al 2017 malanson et al 2006 zvoleff and an 2014 heterogeneity reciprocal effects and feedback loops nonlinearity and thresholds surprising outcomes observable as a result of human nature couplings legacy effects and time lags and resilience levin et al 2012 liu et al 2007 synonyms of social ecological systems include complex human environment systems an et al 2020 2005 national research council 2014 coupled human and natural systems chans liu et al 2007 and social environmental systems schlüter et al 2012a such systems are by nature complex adaptive systems bearing properties of self organization uncertainty unpredictability and non linear dynamics levin et al 2012 the actors in these systems are heterogeneous continuously interacting with one another and with their environment learning and adapting an 2012 cumming 2008 milner gulland 2012 computational models are exemplary tools for understanding social ecological systems as complex adaptive systems with the aim to increase our understanding of interactions adaptive decision making co evolution and emergent phenomena schlüter et al 2012b however many challenges and possibilities remain in social ecological sciences to advance our understanding of social ecological systems more models need to explicitly be designed to focus on the feedbacks among actors and between actors and their environments as with social systems another challenge hinges upon modeling human decision making and behavior the methodological frontiers to address these needs include using patterns or stylized facts to validate model output and to guide parameter settings using mixed methods approaches by including surveys interviews participatory modeling and laboratory experiments to improve the representation of social ecological systems and human behavior grimm et al 2005 heckbert et al 2010 schulze et al 2017 and incorporating qualitative data finally more transdisciplinary and interdisciplinary collaborations are key to increase the quality of models that address social ecological systems because of the inherent interdisciplinary nature of research in these systems schulze et al 2017 a common real world application of abm in socio ecological studies is to inform policy to advance the use of abms for decision and management support communication of model development analysis documentation and presentation need substantial improvement towards more systematic and transparent ways heckbert et al 2010 müller et al 2013 schulze et al 2017 abms have a potentially important role in normative institutional and policy design for social ecological systems once researchers have empirically compelling representations of human behaviors in abms one can test the extent to which a new proposed policy or design might result in adverse unintended consequences for example agent based computational platforms for the exploration of new market designs for electric power systems are highly complex systems that involve intricate interactions among human physical and environmental agents traditional disciplinary boundaries social sciences engineering physical sciences etc are a major detriment for such transdisciplinary abm application areas 4 traditional methods and models in acs science different model types represent different tools traditions and basic assumptions about how systems under investigation work ideally the perspectives represented by different model types are related to one another vincenot et al 2016 2011 below we briefly review differences and complementarity between abm and other kinds of models 4 1 weaknesses of non abm approaches in acs traditional mathematical or analytic models are often based on a few simple equations or rules including differential equations dynamic state variable models ideal free distribution models game theory models systems dynamics models and statistical methods to explain the complexity of acs such traditional mathematical or analytic models have shown a variety of strengths and weaknesses statistical models and system dynamics models are powerful in characterizing systems at an aggregate level while lacking the ability to represent heterogeneous actors that interact with one another equation based and game theoretic models polasky et al 2011 and system dynamics models are useful for representing feedbacks between systems and for explaining macro level characteristics but lack the ability to represent the micro level processes and interactions heckbert et al 2010 additionally these methods cannot represent adaptive decision making and the co evolutionary aspect of acs except for bayesian networks and evolutionary models where a decision of one agent at one site or point in time may influence other agents decisions system events and system level outcomes at different locations or later times thus these non abm approaches fail in capturing the essence of acs folke et al 2010 which is problematic for improving governance and management strategies for increasing the sustainability of social ecological systems in situations where interactions among agents are contingent on experience and agents adapt to that experience traditional equation based models are often limited if not impossible for deriving the dynamic consequences traditional mathematical modeling approaches miss the capacity to handle some immediate proximate complexities that agents encounter making it difficult to handle variation in individuals and their decision making in complex situations where agents have no experience abm scientists employ a range of useful techniques such as genetic algorithms and artificial neural networks enabling agents to respond quickly and adequately deangelis and diaz 2019 in such instances agent based modeling often offers the only practical method of analysis 4 2 complementarity and fuzzy boundaries with non abm models our exclusive focus on abms does not imply that we downplay ignore or even deny the important role of other types of models in particular mathematical and statistical models on the contrary many abms one type of mechanistic models incorporate such types of models abms do not replace but complement traditional mathematical or analytic models and they share many challenges in areas such as inverse parameterization analysis of model robustness coupling with traditional process based models and sensitivity and uncertainty analysis moreover the boundaries between abm and traditional models are becoming porous the majority of mathematical models are no longer solved analytically but numerically which means that they are simulation models as much as abms consequently many of the issues with abms reported here may also apply to mathematical modeling seppelt and richter for example report on the solution of systems dynamics models we can show that solutions a differ if different development tools are chosen but the same numerical procedure is selected b depend on undocumented implementation details c vary even for the same tool but for different versions and d are generated but with no notifications on numerical problems even if these could be identified seppelt and richter 2005 as discussed in the paper by tesfatsion 2017 most agent based models are not simply the computational implementation of a model or set of models previously developed in equation or whatever form rather agent based modeling often proceeds from agent taxonomy and flow diagrams to pseudo code and finally to software programs that can be compiled and run in this case the software programs are the models in principle any abm software program can decompose to or equivalently be represented in abstract form as a system of discrete time or discrete event difference equations starting from user specified initial conditions tesfatsion 2017 however these analytical representations become increasingly complex as the number of agents and rules defining their behavior increase 4 3 robustness analysis robustness analysis refers to building a set of similar yet distinct models of the same phenomenon examining whether these models may lead to similar results despite their different assumptions parameters and or even model structures levins 1966 robustness analysis was formulated for simple mathematical models but has recently been generalized for abm grimm and berger 2016 different simpler versions of an abm are created in the attempt to systematically break the models and thereby identify key mechanisms and limitations to explanations provided by an abm robustness analysis will help establish a new culture of communicating models instead of only making sure that the model is realistic because it reproduces observations we also need to demonstrate when and why the proposed mechanisms break down the purpose of robustness analysis and related analyses is not only to obtain essential insights into the chosen study sites but also about explicitly finding out what essential spatial temporal or organizational scales what key processes patterns what feedback loops heterogeneity or tipping points thresholds and so on may give rise to various aspects of complexity including but not limited to emergence surprising outcomes resilience and path dependence 4 4 coupling of abm with other process based models coupling abm with traditional process based models is an emerging research frontier in acs research especially in earth system modeling and water resources system analysis among a set of major challenges highlighted in this domain e g coupling abm with other models agents decision rules and spatial scale issues how to fully address human behavior and its effect on the natural environment such as irrigation streamflow regulation and groundwater pumping and dynamically capture the feedback of natural processes influencing human behaviors such as climate change mitigation to form a tight or two way coupling between abm and process based models is a major challenge 4 5 handling uncertainty as the agent based modeling method matures there are opportunities to begin to adapt useful methods from longer established fields in order to improve the rigor of agent based modeling this is especially true with respect to how agent based models deal with uncertainty there are several reasons why uncertainty can make its way into model results it might be a result of noise in the input data that are used to parameterize the model or because the model rules themselves are poorly specified the model is not adequately representing the system that it is designed to represent other fields particularly the environmental sciences such as meteorology and hydrology have decades of experience in developing methods to quantify and manage uncertainty one of these is ensemble modeling an ensemble is a group of models that are run simultaneously murphy et al 2004 the models are probabilistic so naturally begin to diverge during the course of a simulation by analysing the range of outcomes across an ensemble of models it is possible to begin to better understand how uncertain the outputs are where most models are broadly in agreement in their results there is less uncertainty compared to the situation where the models diverge substantially one way to prevent a simulation from diverging from reality would be to occasionally incorporate more up to date data and adjust the model accordingly there are a range of techniques that come under the banner of data assimilation that are designed for exactly this purpose however they have largely evolved from fields such as meteorology i e to incorporate up to date environmental data into weather forecasts and it is not clear whether they are appropriate for use in agent based modeling some have begun to explore this area clay et al 2020 long and hu 2017 malleson et al 2020 rai and hu 2013 2013 ward et al 2016 but only with the simplest agent based models the marriage of data assimilation methods and agent based models could be transformative for the ways that some systems are modelled consider the following example regarding the benefits of data assimilation approaches adapted from swarup and mortveit 2020 agent based modeling is an ideal tool to model disease spread but typically models are restricted to hypothetical scenarios however with the abundance of new data that are available in near real time a high spatiotemporal resolution agent based model of a national or global disease spread could be executed in real time using data assimilation techniques to incorporate the most up to date disease surveillance data the model could not only be used to make short term predictions to highlight the emergence of potential new clusters or as a virtual laboratory to test potential mitigation policies but could also be used to highlight areas where its predictions are the least certain and would hence benefit from additional local data collection 5 challenges in agent based modeling the increasing recognition and application of abms in a wide range of disciplines should not warrant overlooking or downplaying the challenges that the abm community needs to address in order to establish itself as a rigorous tool for advancing acs science these challenges if not addressed with the highest priority in abm research can lead to ad hoc design of models which are nontransparent and untestable and in turn useless or even harmful for theory development and application in the long run specifically challenges abound in many aspects such as 1 basic difficulties in model development communication understanding verification and validation 2 difficulties regarding coherence because of the substantial variation in platforms programming languages model details and sophistication and modeler s preferences 3 difficulties in computational efficiency as most abms are developed on personal computers but see these two papers tang et al 2011 tang and bennett 2011 for exceptions 4 inadequate model module transparency and reusability which partially contributes to the challenge of verifying validating and analyzing model outcomes including model sensitivity and 5 difficulties in generalizing findings and scaling them across scales an 2012 an et al 2005 heppenstall et al 2016 o sullivan and manson 2015 parker et al 2003 we acknowledge that these challenges limit the usefulness of abms in scientific inquiry and empirical problem solving domains nonetheless it is worth pointing out that the basic principles of modeling starting with a question and trying to find the right set of key processes of a system s internal organization apply to any kind of mechanistic modeling consequently the challenges to be mentioned below regarding communication understanding verification validation and so on are general and not specific for abms 5 1 integrated human environment abms the connections between human and environmental systems were assumed to be decomposable into a set of simple unidirectional relationships which has hindered understanding of these systems an et al 2014a many complexity features e g those observed in several empirical social ecological systems section 3 3 call for coupling of human and nature systems in this context researchers have proposed the coupled human and natural systems chans framework building on complex systems theory liu et al 2007 section 3 3 however there still exist many unanswered questions when people work under this framework how do we customize the complexity of the representation of ecological and human processes to the intended purpose of the model exploratory or theoretical participatory descriptive or predictive how do the relative temporal scales of the ecological and human processes in the target system influence the representation of ecological processes static simple state transitions dynamic or influence the nature e g tightness of the coupling between ecological and human components of the model building on a fundamental philosophy of methodological individualism abm has a unique ontology that represents key real world actors as heterogeneous individual agents carrying attributes and actions including interactions with other agents and or their environment this ontology allows a bottom up style examination of many emergent outcomes that are prevalent in human environment systems abms are therefore very useful in modeling social ecological human environmental systems given the complexity nonlinearity and heterogeneity in particular qualities that exist in these systems for instance abms should provide unique insights when modelers tackle issues around harmonizing social and environmental data that are subject to various spatial and temporal scales extents resolutions or incorporate low level processes and interactions within and between both dimensions of the chans system furthermore abms provide a platform to perform policy or mind experiments or visualize outcomes under certain policy interventions 5 2 modeling human behavior one hotspot research area is modeling human decision making in acs especially decisions regarding their interaction with the environment here we refer to conceiving decision making at an individual level rather than embedding it in social institutional and spatial contexts o sullivan et al 2012 representing adaptive behavior is challenging in abms in general including the behavior of cells in tissues bacteria plants or animals because it has to be based on first principles such as energy budgets martin et al 2013 fitness seeking railsback and harvey 2002 photosynthesis scheiter et al 2013 or stoichiometry sinsabaugh et al 2013 representing human behavior however adds further complexity because of social interactions in increasingly complex networks anticipation of the behavior of others which is addressed for simple settings in game theory and memory learning and emotions which all can lead to different decision algorithms in different contexts current practice in representing human behavior is limited schlüter et al 2017 and dominated by simple optimization algorithms moreover there is no culture of rigorous theory development which would require that alternative representations be implemented and tested for their ability to reproduce multiple patterns observed in real social systems the key feature of this pattern oriented theory development grimm and railsback 2012a railsback and grimm 2012 is that we would not strive to find a perfect representation of behavior of single individuals in simplified settings such as in behavioral ecology and economics but to select representations which are good enough to reproduce patterns observed at both the agent s and system s levels such tested representations should be referred to as theories of behavior and could constitute re useable building blocks for representing human behavior in general it is also expected though that different theories are needed in different contexts so there might be no unique representation of human behavior for example during a panic in a theater it is sufficient to represent humans as brownian agents while in other contexts we might need to include emotions and employ complex approaches such as neural networks and genetic algorithms to predict how agents respond to certain situations eliassen et al 2016 2009 giske et al 2014 lindkvist and norberg 2014 one of the hallmarks of abm is its ability to capture and model human behavior ironically this is also one of the areas in which abm has been heavily criticized heppenstall et al 2016 following the typology set out by kennedy 2012 there are two broad ways to classify behavior through mathematical or cognitive approaches the mathematical approach centers on the custom coding of behaviors within the simulation for example using random number generators to select a predefined possible choice e g to buy or sell pumain and sanders 2013 to understand human behavior in a more nuanced way and to take account of factors such as individual preferences local knowledge and environment developments of key things such as threshold based rules are very important these allow events to trigger a specific agent behavior for example moving to a new location within a neighborhood crooks 2010 these approaches have great utility when the behavior is both well understood and documented a second contrasting approach to simulating human behavior uses conceptual cognitive frameworks here more abstract concepts such as beliefs desires and intentions bdi rao and georgeff 1991 or physical emotional cognitive and social factors pecs schmidt 2002 are embedded within individual agents both the bdi and pecs frameworks have been successfully applied to modeling human behavior within social sciences for instance for modeling the drivers of criminal behavior in an a spatial model that uses the bdi framework see brantingham et al 2005 for a geographically explicit model that represents behavior through the pecs framework see malleson et al 2013 second representing agents decision making processes in human environment studies remains another major challenge here it is important to correct a major misconception still being expressed by some commentators uninformed about the powerful capabilities of modern software namely the misconception that abm representations of human decision makers must necessarily be stupid to the contrary the constraints on agent decision making implied by abms are constraints inherent in every real world social system the decision making representation methods used by abm agents can range from simple behavioral rules to decentralized optimization to sophisticated anticipatory learning algorithms for the approximate achievement of intertemporal objectives a framework for mapping and comparing human decision making in models of socio ecological systems dubbed mohub modeling human behavior has recently been published schlüter et al 2017 with the aim to facilitate choices of how to model human decision making this is important because of the strong impact assumptions on human behavior may have for model outcomes and its final impact on e g policy recommendations 5 3 abm transparency and reusability lack of transparency and reusability in abm code has been mentioned as one of the bottleneck problems for the abm community an et al 2014a evans et al 2013 national research council 2014 parker et al 2003 part of this problem stems from a lack of central development within abm abm has a somewhat fragmented development with advances being made in different disciplines for example validation approaches in ecology grimm et al 2005 and handing of space in geography heppenstall et al 2016 without adequate transparency and reusability it is not only very difficult to verify and validate abms but a large amount of resources are wasted such as modules and programming libraries that have been developed and tested by abm experts and could have been reused in human dynamics research the lack of open source software packages has become a major impediment to the promotion of abm the availability and widespread use of source codes will play a critical role in the adoption of new perspectives and ideas enhancing abm more toolkits are needed to interface the open source revolution and abm seeking cross fertilization between these two fast growing communities there are though initiatives to tackle the challenge of documenting and presenting agent based models fortunately the development of presentation protocols for abm is now an active area of research grimm et al developed the overview design concepts details odd protocol as a standard format for describing abms in ecology and beyond grimm et al 2020b 2010 2006 it provides a fixed structure and terminology making model descriptions start with an overview of the model s purpose entities state variables scales and processes and their scheduling followed by listing how important design concepts for abms such as emergence or interactions have been considered finally details on initialization input data and all process representations submodels are given the purpose of odd is to facilitate reading and understanding to provide exactly the same kind of information always in the same sections and to provide all details that are needed for re implementing the model the use of the odd has improved transparency in abm but limitations remain because verbal model description will always include ambiguities grimm et al 2020b moreover for specific classes of models a more refined structure might be useful this is in particular the case for modeling human behavior therefore müller et al suggested odd d adding elements that facilitate selecting and documenting important features in models of human decision making müller et al 2013 some scholars have criticism for applying odd to abms in all situations but suggest development of multiple standardized presentation protocols which should be tailored to the purpose and development of a modeling effort reusability is fostered by archives of existing models which include not only the program code but also instructions for use and transparent model descriptions preferably using the odd protocol the model library of comses net has become a useful platform where modelers can seek building blocks to incorporate in their own models it even provides a database with all agent and individual based models published so far netlogo wilensky 1999 specifically designed for abms and increasingly used for implementing abms is easy to learn railsback and grimm 2012 wilensky and rand 2015 and computationally less limited than generally believed railsback et al 2017 another route to reuse of models is model re implementation instead of starting each modeling project from scratch thiele and grimm suggest to scan existing models and try and re implement the most suitable one thiele and grimm 2015 even if the final model only includes a few elements of the re implemented model starting from an existing model saves a considerable amount of time for model formulation which then can be invested in model analysis and improvement re implementation also fosters theory development because researchers can try and break models to identify elements and processes that are essential for the model to produce realistic results computational modeling in general needs to go beyond showing that a model looks right by showing where and when they go wrong grimm and berger 2016 thiele and grimm 2015 5 4 abm verification and validation verification and validation of abms has been a problem besetting abm modelers and users for many years an et al 2014b 2005 manson 2002 national research council 2014 parker et al 2003 many issues arise from this difficulty couclelis 2002 although this problem is not confined to abm it also besets other domains of modeling for instance the global climate research community is struggling with the credibility of different general circulation models when they cannot reproduce the historical climate without robust model validation and a joint understanding of what model validation and verification is the reliability of abm cannot be established limiting its usefulness and application in various contexts an et al 2014b brown et al 2008 augusiak et al reviewed terminology regarding the term validation and came to the conclusion that this term cannot be used for any practical purpose anymore because it is impossible to boil down its wildly varying definitions and interpretations to a single one augusiak et al 2014 as a solution they suggest the artificial term evaludation a merger of evaluation and validation which covers all elements of iterative model development model purpose conceptual model data evaluation software verification model output verification and corroboration and model analysis they then point out that the general notion of validation often is too narrow requiring that as in physics a model makes predictions of features that were not used for model calibration i e independent or secondary predictions it is thus important to distinguish between model verification which shows that the model reproduces calibration patterns and model corroboration which is about independent predictions documenting how all these elements were addressed during model development is facilitated by using the standard documentation format trace grimm et al 2014 empirical validation of abms is a highly active research area as discussed in tesfatsion s paper tesfatsion 2017 abm permits model builders with scientific objectives to strive for the simultaneous achievement of four distinct aspects of empirical validation i e 1 input validation are the exogenous inputs for the model empirically meaningful and appropriate for the purpose at hand 2 process validation how well do the physical biological institutional and social processes represented within the model reflect real world aspects important for the purpose at hand are all process specifications consistent with essential scaffolding constraints such as physical laws stock flow relationships and accounting identities 3 descriptive output validation how well are model generated outputs able to capture the salient features of the sample data used for model identification and 4 predictive output validation how well are model generated outputs able to forecast distributions or distribution moments for sample data withheld from model identification or for data acquired at a later time or a different place this pursuit of comprehensive empirical validation will of course be tempered in practice by data limitations even in an era of big data and data advances data availability and quality remain important concerns computational limitations such as round off error truncation error and error propagation also remain a concern fortunately advances in computer technology and numerical approximation procedures are rapidly reducing these limitations 5 5 big data and high performance abm this potential of abm s capacity to leverage big data is improved by the increasing availability of big data such as high resolution remote sensing imagery social media data and large detailed human socioeconomic datasets wang et al 2013 ye and he 2016 big data are characterized by their characteristics in terms of volume size of data velocity update frequency variety types of data veracity quality of data and value importance currently abms are largely based on data from relatively small or local scales limiting the usefulness of abm in large spatial extent and high resolution contexts for a small set of exceptions that use parallel computing see the work by tang and associates tang et al 2011 tang and bennett 2011 while there is a growing use of agent based models for a variety of applications there are several key challenges that need to be overcome these range across the spectrum from theory to practice and from hypothesis to application crooks 2010 however the greatest challenge to abm is akin to many other modelling methodologies in that the realism that an abm can bring to a simulation is highly dependent on the quality of the data that it uses i e veracity for big data agents require accurate individual level behavioural data if they are to produce simulation results that can be used for policy without rigorous calibration fine tuning the model and validation testing the model on unknown data of the abm any outputs are essentially meaningless a typical abm can include hundreds to millions of heterogeneous agents each operating their own individual rule sets calibrating and validating these models with stochasticity therefore requires a huge amount of individual level data and leads to massive intermediate or output data e g based on considerable monte carlo runs in other words even if the spatial extent of an abm is not large the modelling steps from verification calibration validation to experimentation can easily pose a big data driven challenge fortunately big data can potentially provide the level of detail required the term big data is somewhat misleading which refers to both traditional large data sets for example national censuses as well as new digital information generated from social media high resolution satellite imagery gene sequencing data and the like with the proliferation of social media information generated and disseminated from these outlets has become an important part of our everyday lives our ways of examining social spatial interactions are increasingly transformed by the development of more powerful computing technologies emerging big and open data sources and new perspectives on social spatial processes shaw et al 2016 social media such as twitter capture data about individual behavior and movements that have previously been absent from modelling efforts e g considering the veracity issue as more social media data are increasingly available agent based modelling has been used to predict human behavior like posting forwarding or replying to a message with regard to topics and sentiments ye and lee 2016 despite the obvious potential of big data there are considerable issues to overcome such as bias noise generalization and in some cases the ethics of whether researchers should be using this kind of data heppenstall et al 2016 to resolve the big data and computing challenges facing abms high performance computing enabled by state of the art cyberinfrastructure represents a unique solution a series of abms based on high performance computing have been reported in the literature tang et al 2011 tang and bennett 2011 tang and jia 2014 high performance abms often focus on large spatiotemporal extents and or fine resolutions tang and jia 2014 large scale abms rely on two typical parallelisms message passing and shared memory wilkinson and allen 2004 which allow for dividing e g via spatial domain decomposition ding and densham 1996 wang and armstrong 2003 a model into smaller sub models that can be deployed to high performance computing resources for parallel computing tang and wang 2009 message passing shared memory or the combination of both enables the inter processor communication for data or information required by neighbouring sub models gong et al 2013 shook et al 2013 this high performance computing solution is not only suitable for abms with large spatiotemporal extent and fine resolutions but also can facilitate the use of small scale abms in need of huge computational support these small scale abms often require a significant number of monte carlo repetitions through alternative modelling phases including calibration verification validation sensitivity and uncertainty analysis and experimentation for scenario analysis these massive monte carlo runs while independent of each other can be deployed to and thus accelerated by high performance computing resources tang and bennett 2010 5 6 spatially explicit abms there are many modeling issues that apply to but are not limited to spatially explicit models e g the effects of random number generators the way to handle boundary conditions the effects of spatial structure and model type on abm evaluation e g via sensitivity analysis the effects of spatial resolution extent and data on model calibration and validation and the possibility and benefits of employing alternative spatial representation in comparison to the traditional cartesian space e g adoption of relative space in abm an et al 2015 informed decisions on these issues may be conducive to developing more robust abms we refer readers with interest in this domain to manson et al 2020 finally the above challenges are also affected by the spatial scale issue of abm setup abms are often developed with an implicit assumption that agents interact with each other within a system however agents across distant systems around the world have rarely been taken into consideration even though they are increasingly interacting to understand and manage such complex distant interactions an integrated framework of telecoupling has been developed liu et al 2013 http telecoupling org telecoupling is defined as socioeconomic and environmental interactions between multiple social ecological systems over distances as an umbrella concept it encompasses many processes such as migration trade tourism species invasion environmental flows foreign direct investment and disease spread telecouplings have profound implications for global sustainability and human well being as they can transform the structure function pattern process and dynamics of social ecological systems across local to global scales thus it is necessary to develop a new set of abms telecoupled agent based models liu et al 2014 6 opportunities from artificial intelligence and data science the challenges summarized in section 5 not only limit the usefulness of abms in scientific inquiry and empirical problem solving domains but also hamper our understanding of acs structure and processes fortunately the advances in artificial intelligence unique new forms of data and data science will substantially help address these challenges 6 1 opportunities from artificial intelligence starting in the l950s modern artificial intelligence ai has aimed to emulate the natural intelligence seen in human or animal behavior under a critical assumption that to a large degree machines can be made to simulate human intelligence typically this means being able to demonstrate cognitive functions usually displayed by humans such as goal oriented behavior learning reasoning knowledge representation planning language processing and problem solving such as the ability to move and manipulate objects by e g robots ai is also an academic discipline for its own right albeit one that is highly fragmented ai leverages both traditional e g statistical methods mathematical optimization economics and non traditional methods e g artificial neural networks computational intelligence to understand and simulate human intelligence sub disciplines of ai range from those associated with the use and development of statistical techniques such as regression to recognize patterns in data to the creation of human like intelligent robots that are able to perceive their environment and learn to conduct particular tasks e g recognizing an object and interacting with it considering the goals and methods of ai ai appears a natural solution for the abm challenges described above although the ability to create truly intelligent agents is obviously extremely relevant to abm most agent based models do not actually require agents with such a high degree of intelligence the contribution of ai to abm is most keenly felt by developments that are more commonly used in data science such as machine learning regression neural networks reinforcement learning etc however progress has been slower than expected with data limitations being one of the most fundamental reasons as most ai methods that could be employed to build intelligent agents require large amounts of often individual level data and such sources were not readily available in the past alongside the methodological developments that are emerging under the banner of ai there has been another transformative change that has fostered the success of ai related developments and is directly relevant to abm the emergence of big data 6 2 opportunities from big data the advent of big data may provide a solution for using ai to nourish abms the usefulness of big data should be highlighted in understanding agent based complex systems as noted we have increasing amounts of individual level data but a challenge remains in how to link disparate data sets and extract useful information and insights offered by these data it is not only burdensome in obtaining storing cleaning or mining such new forms of data but there are also ethical problems with sources such as gps telemetry social media and remote sensing when we aim at revealing detailed information about individual actions or local processes furthermore it may be more challenging to resolve biases from big data than from carefully crafted traditional data the majority of published applications use more traditional data types which is most likely due to the fact that modelers are more comfortable with manipulating traditional sources of data e g census data various sample data robinson et al 2007 rather than mining new forms of data or consider these new sources of data as too noisy biased or inaccurate despite these challenges big data may provide us with new avenues with which to explore how people perceive use and react to events in the spaces around them and the potential to incorporate these observations into our models in near real time moreover many of these sources of data allow us to examine connections between people organizations and space thus offering a new perspective with which to construct artificial worlds build environmental layers and derive behaviors that motivate agents to make certain choices and take certain actions such data micro data mostly driven models including abms may suffer from a serious drawback they are heavily data driven or data centered with little consideration of theory as a result it is almost impossible to reproduce model results or to interpret them for instance othman et al created an abm of the rail network in singapore which used only train ticket purchasing data as its input othman et al 2015 there is an implicit assumption that models built using new forms of micro data will capture the essential processes that are taking place in these systems however abms that represent dynamical processes as snapshots in time can be misleading hassan et al 2008 this leads to another weakness of many micro data driven models without actually knowing much about the important processes that need to be captured it is an almost impossible task to build models that are representative of the real world and generate meaningful results yet modern data science especially combined with artificial intelligence may help substantially address this challenge 6 3 opportunities from qualitative data another prominent issue is the lack of using qualitative data particularly ethnographic data such as text images videos and audio documents in abm agar 2005 for exceptions see the work by lindkvist et al and schulze et al lindkvist et al 2017 schulze et al 2017 this trend matches the basic idea of pattern oriented modelling grimm et al 2005 grimm and railsback 2012b railsback and grimm 2019 where a combination of several qualitative or weak patterns which a model is supposed to reproduce can be as effective or even more so than using a single highly detailed pattern to reject unsuitable submodels and parameter combinations a typically weak but still quantifiable pattern refers to a situation in which certain variables for example population size average wealth average and higher moments of age or time needed to recover from a disturbance event stay within certain intervals an emerging literature has noted that ethnography can be systematically used to inform both functions of social processes and decision making rules within abms provide insight into selecting outcome variables for analysis increase abm quality and empirical accuracy especially in representing human decision making and social systems tubaro and casilli 2010 for instance the modelling agent systems based on institutional analysis framework maia has been used for participatory abm development with ethnographic data ghorbani et al 2015 although yang and gilbert developed guidelines for ethnographically informed abms there remains a need to more broadly apply and refine both the maia framework and modeling guidelines yang and gilbert 2008 increasing the use of qualitative data is challenging as few researchers are competent in both abm building and qualitative ethnographic data collection and analysis tubaro and casilli 2010 addressing this challenge requires either training new interdisciplinary abm researchers or increasing collaboration among quantitatively and qualitatively trained researchers further qualitative data are often seen as lacking rigor and there is a need to bridge the cultural gap between quantitative and qualitative researchers regardless agent based modelers and qualitative researchers share the overlapping goal to understand mechanisms and processes in social systems yang and gilbert 2008 making increased collaboration a compelling means to strengthen abms representation of the system s and social processes methodological challenges arise in areas such as translating qualitative data to quantitative model parameters and model generalization from inherently context specific ethnographic data when extracting patterns and identifying thresholds or multipliers from qualitative data such as field notes from participant observation there will inevitably be instances of unjustifiable magic constraints in the code yang and gilbert 2008 p 7 further there will be places where the code must be made more precise or concrete than the context of the qualitative data would allow when faced with the challenge of defining parameters based on qualitative data the most important consideration is not the specific numbers but on whether the numbers can reproduce or represent the patterns identified in the qualitative data then as with any abm the impact of parameter variations should be addressed via sensitivity analysis and discussed in the context of the ethnographic case or ideally cases yang and gilbert 2008 6 4 opportunities from data science the field of data science refers to the use of scientific methods programming tools and appropriate data infrastructures to derive insight from data that can lead to a better understanding of some underlying phenomena successful data science methods or techniques are emerging in many areas of research or empirical applications for example convolutional neural networks cnns have demonstrated success in classifying or segmenting hyperspectral satellite imagery ma et al 2019 and detecting targets from aerial vehicle imagery vidalmata et al 2020 recurrent neural networks rnns have been a popular option for time series forecasting with vast applications ranging from modeling covid 19 transmission chimmula and zhang 2020 to upcoming earthquake prediction graph neural networks gnns recently emerged to model predictive tasks defined over a graph or a network kipf and welling 2016 such as to capture the complex spatial patterns underlying graph structured geospatial data zhu and liu 2018 or to model the information propagation or event prediction in a social network fan et al 2019 many above data science techniques with essential contribution from artificial intelligence data analytics and high performance computing can be extremely valuable as a means of deriving insight from data to inform the basic structure of a model i e to provide empirical support for underlying theories as well as to calibrate and or validate agent based models crooks and wise demonstrate how crowdsourced spatial data can be used to better understand the real world situation after a humanitarian crisis and use that new information to inform an agent based model to support relief efforts crooks and wise 2013 similarly crols and malleson use real time footfall data coupled with an agent based model to estimate the demographics of visitors to a town center crols and malleson 2019 even deep generative models have been introduced to synthesize high fidelity data samples with realistic representations of the underlying spatial correlation structure for gis applications klemmer et al 2019 below we briefly review two kinds of machine learning machine learning via regression in addition to providing a means to generate data that can be used to calibrate and validate agent based models big data and associated data science techniques can also be used to improve the behavior of agents one of the most well known data science techniques is machine learning ml as a subfield of artificial intelligence ml refers to a suite of algorithms that have a generic structure but can be parameterized to detect relationships in data through a process of training specifically ml extracts patterns and learns accurate predictive models from often massive data without being explicitly programmed put another way ml learns a predictive function from data training involves feeding data to the algorithm so that it can estimate the parameter values that best allow it to distinguish between different patterns in the data supervised ml algorithms are provided with data that have already been labeled so the aim of the training process is to identify which input values lead to a given output probably the most widely used supervised machine learning technique is linear regression a regression equation typically has the form y α β 1 x 1 β n x n ϵ where y is the dependent variable to be predicted and x 1 x n are the independent variables the model is trained with data so that the parameters α and β s s 1 2 n can be estimated in that way the generic model structure can be parameterized to detect relationships in vastly different data sets regression equations are commonly used to better understand a particular phenomenon e g to provide empirical support for a given theory and use this information to inform an agent based model but they can also be used directly to control the behavior of the agents for example zhang et al present an agent based model of solar panel adoption that includes agents whose behavioral choices rather than being programmed directly are determined through the application of a regression model zhang et al 2016 machine learning via neural networks in recent years more advanced machine learning techniques have evolved to model non linear patterns that cannot be represented by standard regression techniques of these neural networks have emerged as one of the most versatile algorithms a neural network consists of layers of nodes that are connected by links fig 3 as input data are fed into the algorithm nodes receive messages from parent i e message sending nodes and fire messages to their child message receiving nodes depending on whether the messages that they receive as input are greater or lesser than some threshold like a regression equation these thresholds are parameters that need to be optimized a process called back casting allows the neural network to estimate optimal values for these parameters from training data neural networks were inspired by the structure of the brains of animals so are of obvious interest to agent based modelers it is feasible that rather than attempting to define decision rules for agents by hand each agent could be implemented with their own neural network in a similar way to zhang et al s agents who had their own regression equations zhang et al 2016 then the process of calibrating the model would involve optimizing the neural networks for all the agents however the uses of neural networks to control the behavior of agents directly are relatively rare this could be because the process of calibrating a model could be extremely difficult a single neural network typically requires very large volumes of training data so a model that consists of large numbers of independent neural networks one per agent would be very challenging indeed or perhaps they are not seen as attractive because it is very difficult to interpret why a neural network makes its predictions a gnn typically learns node representations by recursively aggregating information from their neighborhood nodes classical gnn tasks include graph classification e g molecular structure classification ying et al 2018 node classification e g publication classification in an article network karimi et al 2019 kipf and welling 2016 link prediction e g predicting integrations in a social networks zhang and chen 2018 and collaborative filtering e g recommendation systems like amazon or netflix wang et al 2019 most population level interactions come naturally in the form of graphs and can be modeled as graph edges for example in geospatial data spatial objects can be represented as nodes and their topological attribute relationships are represented as links making gnns the natural model choice furthermore gnns can be cascaded with other models such as cnns for joint information extraction on the individual level though cnns or so and interaction modeling on the population level through a gnn furthermore gnns can be cascaded with other models such as cnns for joint information extraction on the individual level though cnns or so and interaction modeling on the population level through a gnn a concrete example of using gnns to derive behavioral rules of networked entities can be found in a recent application in the autonomous flocking of multi agent robot swarms the authors consider a decentralized network of moving robot agents each agent is viewed as a node in a dynamic graph with two agents within a communication range connected by an edge and changes in this one graph are determined by both gnn and rnn a gnn is applied on top of the graph for aggregating and forecasting the population level behavior patterns further each individual agent node can perceive the visual environment and extract features by its own convolutional neural network cnn which processes each drone s visual input like eyes note that each node or agent has its own cnn the resulting model is then a cnn gnn stack and can be trained from end to end similar ideas can be potentially extended to handling any dynamic network with semantically rich nodes such as forecasting covid 19 transmission by exploiting the multimedia information from a social network where people are the nodes and person person contacts are the links that change over time this would enable modelers to use a unique rnn for each agent and model each person s nodes health status over time an rnn can be a naïve baseline itself without considering population influences while a gnn can be used to model the population level interactions edges that change over time too 6 5 agents learn and form behavior one area where neural networks are offering a promising route forward is through allowing agents to learn about their environment for themselves a valuable feature of an agent based model is that the behavior of agents can tell us something about the underlying system but we lose this advantage if the agents themselves are black boxes and we cannot understand why agents make decisions as they do we can better understand why agents make their decisions through methods such as reinforcement learning where positive behaviors are learned through repeated exposure to an environment through building and refining deep neural networks such networks may capture uncertainty and incomplete knowledge representations with large scale individual tracking data it may be possible to teach agents how to navigate spaces as if they were humans these learning agents may both better reflect the actual behaviors of humans and model their behavior under changing conditions progress is rapidly being made elsewhere banino et al 2018 but integration into geographical modelling remains a challenge but see e g work by abdulkareem et al abdulkareem et al 2019 using bayesian networks to help simulate complex decision making with regards to potential cholera infection agent behavioral learning can also happen with the aid of big data for instance with time series data of particles mass charge and geographic positioning information data gnn can be trained to derive closed form symbolic expressions of newtonian force laws and hamiltonians cranmer et al 2020 the authors begin with a starting graph say with n1 particles and n2 edges describing their relationships the authors use 1 an edge model to represent links edges among all n1 particles here is the key of their work there are many potential equations they aim to find them by gnn they are expressed as inductive biases which represent potential math functions of newtonian force laws here the goal is to use gnn to select function type and fine tune the value of all parameters in the corresponding function say one of the functions is named f1 then the authors use 2 a node model in which each node particle receives all the messages from all the rest n1 1 of the particles with the magnitude of each message i e amount of gravity calculated from the candidate function say f1 the authors use 3 a global model to aggregate and update the status of all messages and nodes over time below is the selection process once a gnn based function e g f1 plus number of parameters as part of complexity is used the authors calculate the status of all particles and compare them to the observed data of these particles i e the time series of particle data or spatial panel data mentioned at the start of this text a certain measure normalized mean square error or nmse is used to choose among the different alternative functions plus parameter values with model complexity number of parameters and operators in control the authors use the occam s razor rule to choose the final function or symbolic regression outcome when the nmse is large the same or close one with the least amount of complexity is the winner finally the authors found that the symbolic closed form model derived from ml is what newtonian force laws express 7 significance this article aims to air critical state of the art abm issues and provide a venue to seek resolutions first we bring several compelling abm problems and challenges to the forefront at the right timing with insight from key community leaders and practitioners at a time in which the use of abms is exploding but maintains a series of unresolved challenges this paper has used input from around 100 exceptional scientists with very diverse backgrounds http complexities org abm17 to depict the state of the art about abms providing inspirations and directions for many related fields to break new ground we have developed a set of guidelines for modelers and reviewers and for novices see supplementary information at the same time we provide a comparison of commonly used abm toolkits and software packages given the existence of 85 platforms or toolkits for abm and recommendations for abm acs education see supplementary information furthermore we provide a review of the use of abm in coping with covid 19 challenges this article is not only a pile of papers facts strengths and challenges related to abm but also aims to provide new insights into the field of modeling acs point out impending tasks and envision long term directions of acs studies in the short term we show the huge opportunities provided by data science and artificial intelligence section 6 in the long run we call for an ai informed acs science which warrants a transdisciplinary approach under the transdisciplinary approach all relevant disciplines are fused more seamlessly to detect and express mechanisms that have generated macro level outcomes fig 4 historically science benefited from the so called multidisciplinary approach fig s4a which features a concurrent parallel investigation of the same phenomena or subject from many relevant disciplinary perspectives or an integration of them conte and paolucci 2014 an advance in scientific inquiry is to invest in interdisciplinary efforts which aim to interweave knowledge theory and methods from many relevant disciplines performing multilevel and modular modeling fig s4b under transdisciplinary efforts artificial intelligence data science and domain knowledge will be interweaved to generate pathways or mechanisms that are more meaningful effective and less error prone in understanding and envisioning acs fig s4c with a clearer picture of abm strengths weaknesses available resources and impending tasks and future directions more potential users or developers and even commercial companies will be attracted to engage more with the abm community allocating necessary resources to the science technology and application of abm enhancing abm software and capabilities declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements we are indebted to financial support from the national science foundation nsf through the method measure statistics and geography and spatial sciences bcs 1638446 and the dynamics of integrated socio environmental systems programs bcs 1826839 and deb 1924111 we thank the participants of the abm 17 symposium sponsored by the above nsf grant http complexities org abm17 for input and comments this project has received funding from the european research council erc under the european union s horizon 2020 research and innovation program grant agreement no 757455 and through an esrc alan turing joint fellowship es r007918 1 supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j ecolmodel 2021 109685 appendix supplementary materials image application 1 
