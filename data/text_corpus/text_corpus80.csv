index,text
400,image based modelling of porous media to study the transport and reaction processes has become an essential tool the availability of increasingly large image datasets at high resolution creates a need to develop algorithms that can process massive size images at a low computational cost this study presents an efficient workflow to extract pore networks from large size porous domains using a watershed segmentation with geometrical domain decomposition the method subdivides a porous image into smaller overlapping subdomains and performs a watershed segmentation on each subdomain in parallel or serial modes of operation to save cpu time or memory ram respectively the computational performance of the algorithm was analyzed on a large size image and found to consume 50 percent less memory and upto 7 times less cpu time than the standard watershed implementation pore networks of four massive digital rock images were extracted and the the effective permeability predicted by the networks agreed well with previously investigated values illustrating the accuracy of the method an additional application of this method taking advantage of the reduced computational cost is the upgrading of low resolution image it was found that increasing the resolution of a coarse image leads to more accurate predictions by helping the watershed segmenation prouduce a more faithful pore network model the developed algorithm is implemented in python and included in the open source project porespy it uses highly optimized and efficient modules such as dask and numba to obtain the maximum performance the domain decomposition approach used here will also lend itself well to processing on distributed memory clusters enabling the processing of even larger porous domains keywords pore network modelling porous media x ray computed tomography domain decomposition watershed segmentation 1 introduction image based modelling of porous media to study transport and reaction processes has become a key tool thanks to the relentless increase in computational power gerke et al 2020a b parvan et al 2020 sadeghi et al 2020 santos et al 2020 sheng and thompson 2016 this has been accompanied and spurred on by the advancement of 3d imaging techniques such as x ray micro and nano computed tomography ct and focused ion beam scanning electron microscopy fib sem that have enabled the acquisition of massive domains at resolutions better than a fraction of micron for instance domains can be imaged with current ct techniques as large as 2000 voxels across and essentially unlimited in height since scans can be stitched together jackson et al 2020 soulaine et al 2016 wang et al 2019 modelling transport processes especially complex ones involving reactions and multiple coupled physics using numerical techniques known collectively as direct numerical simulation dns on such large domains strain even the most advanced modern workstations however one common remedy is to use pore network modeling pnm which is the most efficient when compared to other pore scale modelling approaches song et al 2019 and its importance has been well established in modelling transport processes of various types of porous media khan et al 2020 sadeghi et al 2019 thomson et al 2018 torayev et al 2018 the promise of using pnms to efficiently model complex transport processes in large domains is currently limited by the network extraction step which can take hours or more there are three main approaches to network extraction and they all depend on image analysis which can be resource and computationally intensive the approaches are 1 maximal ball dong et al 2008 dong and blunt 2009 2 skeletonization or medial axis thinning al raoush and willson 2005 bakke and øren 1997 3 watershed segmentation sheppard et al 2005 as well as some hybrid techniques gerke et al 2020 miao et al 2017 the present work focuses on the third approach by adapting the snow algorithm developed by gostick 2017 the main computational bottleneck of this algorithm is the watershed segmentation step which requires high computational memory ram and a significant amount of cpu time as the size of the 3d image approaches and exceeds 10003 voxels it should be stressed that the present work can be applied to any technique that uses a watershed segementation since it is applied to the result of the watershed and is therefore agnostic to how the watershed was performed there have been a few recent attempts to accelerate the network extraction by employing parallelization rabbani et al 2019 approached the problem by dividing the image into several subdomains and performing watershed segmentation on each subdomain individually a pore network was then extracted from each subdomain and these networks were subsequently stitched together to get one large network the stitching was done by analyzing the interaction of the throats at the intersection of two neighboring subdomains although their algorithm obtained an increase in computational efficiency the accuracy was sacrificed since the pore connections and throat radius at the intersections of two domains are handled based on aribitrary stitching rules the final pore network was found to differ noticably from the network extracted from a single large domain and moreoever the result depended significantly on the number and size of subdomains used kohanpur and valocchi 2020 developed a stitching method to join the two neighbouring subdomains statistically similar to the approach of rabbani et al 2019 stitching networks post extraction introduces errors in the predicted transport properties and the relative error changes depending on the number of subdomains to remedy the limitations of stitching networks post extraction the present work focused on obtaining a watershed via parallelizing the watershed step then performing network extraction on the entire image a key factor to note is that the number of segmented regions in a large image is far fewer than the number of voxels therefore if a segmented image can be obtained efficiently the network extraction step can be applied to the segmentation without concern for efficiency in general there are two approaches to parallelizing the watershed redefining the inner workings of the algorithm to work in a truly parallel way or dividing the image into chunks then applying an existing algorithm on each chunk individually kornilov and safonov 2018 moga and gabbouj 1998a b moga et al 1998 the first approach is quite challenging because as pointed out in several reviews roerdink and meijster 2000 romero zaliz and reinoso gordo 2018 the watershed is inherently iterative or sequential in nature requiring multiple passes over the image typical performance gains for algorithms in this category are between 2 4x on 8 core machines moga and gabbouj 1998a b nicolescu et al 1999 romero zaliz and reinoso gordo 2018 wagner et al 2009 the best performance gain on more than 10003 voxels images was achieved by wagner et al 2009 who reported an average speed up of 5x on a machine with 8 cores but conceded that the accuracy of the segmentation may not be maintained their speed up was also inflated since they parallelized the immersion algorithm of vincent and soille 1991 which is faster than the marker based segmentation of meyer and beucher 1990 and beucher 1994 as no preprocessing steps to define markers are required attempts have also been made to develop parallelized algorithms for use on distributed memory systems moga and gabbouj 1998a b moga et al 1998 but again the need to share information between nodes during the processing limits the performance gains in general intrinsically parallel algorithm only achieve moderate speed improvements each implementation is specific to one type of watershed and they involve sophisticated implementations that are not widely available for use by porous media researchers the other approach to parallelization is referred to as divide and conquer or geometric domain decomposition where the image is divided into chunks and each is processed separately followed by a post processing step to recombine each chunk back into a single domain this approach offers several useful advantages as it can be run on distributed memory systems as well as shared memory machines with ease the former has the benefit that many nodes can be requisitioned and or each node can have a large amount of ram for processing massive images of course this requires access to specialized computational resources because no information is exchanged between processes domain decomposition schemes can optionally be run asynchronously meaning that a single shared memory machine can be used to analyze large images by processing each chunk in series this allows the use of normal desktop or even laptop computers on images that would otherwise be infeasibly large domain decomposition schemes can also be run in parallel on shared memory high performance workstations allowing a high degree of flexibility in how they are run another advantage is that the user is free to choose which watershed algorithm is applied to each domain for instance it has been shown that a marker based watershed with carefully selected markers is necessary to obtain a valid network from porous media images gostick 2017 so the ability to choose the algorithm and its settings is critical as another scenario if one had access to a distributed memory system each node could use an internally parallelized algorithm of the type discussed above and domain decomposition could be used to harness many nodes significantly increasing the computational performance the downside of the domain decomposision approach is that the accuracy of the segmentation is not assured as it depends on the handling of interfaces between each subdomain which is one of the major points addressed in this work this work presents a pore network extraction workflow that is based on parallelized watershed segmentation using domain decomposition the proposed algorithm is conceptually simple requiring only that each subdomain overlaps its neighbor by a sufficient amount to prevent edge artifacts and followed by relabeling of watershed basins by comparison of the overlapping regions all of this is done in the pre and post processing steps so the actual watershed function is untouched crucially the proposed approach can extract an identical network as that without domain decomposition and the result is independent of the number of subdomains the developed algorithm s computational performance was tested on a variety of large images and shown to be many times faster than the currently available approaches based on existing single core implementations the presented algorithm by working on each subsection of the image separately can also be applied in serial processing mode for cases where ram is limited and the effectiveness of this scheme was also explored the proposed domain decomposition algorithm therefore offers the option of fast parallelized processing on high performance workstations with many cores and ample ram or slower serial processing on lesser machines with limited cores and ram the possibility also exists for the present algorithm to be deployed on distributed memory systems though this aspect was not explored in the present work an additional benefit of the present approach is that any watershed algorithm can be applied allowing users to customize the scheme for their own workflow lastly and most practically this present algorithm is implemented using widely accessible open source python tools such as the scipy stack virtanen et al 2020 dask rocklin 2015 and numba lam et al 2015 the algorithm is included in the in open source project porespy gostick et al 2019 and the output of code is also well aligned with open source pore networking modelling project openpnm gostick et al 2016 2 methodology 2 1 x ray micro computed tomography image samples to investigate the computational performance and geometric domain decomposition artifacts if any 13 different types of 3d datasets were used these included the x ray μct images of different types of rocks provided by imperial college london dong 2007 dong and blunt 2009 random sphere packings were generated using porespy gostick et al 2019 and massive size images of the fontainebleau sandstone samples were constructed by institute for computational physics at the university of stuttgart hilfer and zauner 2011 a large size bentheimer sanstone image obtained by jackson et al 2020 was downloaded from the digitalrockportal samuel et al 2019 the sizes resolutions and porosities of images used in different studies are shown in table 1 equal size subdomains were created from the original images during the domain decomposition process so some images were cropped by a few voxels to make it evenly divisible by the decomposition ratio and their final cropped size are mentioned in the respective study 2 2 network extraction algorithm the snow algorithm as elaborated in gostick 2017 was used to perform a marker based watershed segmentation and network extraction for all steps in this study the algorithm uses a gaussian blur and two custom filters to remove spurious peaks from the distance transform before performing marker based watershed segmentation on 3d image a detailed comparison with commonly used extraction algorithms and modelling approaches are provided in gostick 2017 and khan et al 2019 the segmented regions obtained using snow algorithm are then used to extract geometrical and structural information of the network the workflow for the snow pore network extraction methodology is shown in fig 1 a 2 3 domain decomposition algorithm the main computational bottleneck of the snow network extraction algorithm fig 1a was the watershed step as the size of the image increases overall memory and cpu time increases significantly to the point that it becomes impractical to extract a network on a common laptop or desktop computer which has on average 16 to 24 gb ram the high computational cost of this step can be avoided if the image is divided into smaller manageable sub domains and watershed segmentation is performed on each individually these sub domains can then later be stitched together before the network extraction step if this stitching is done carefully it is possible to get an identical pore network to that which would be obtained from applying the watershed on the single large domain the overall process for domain decomposition developed in this study is shown in fig 1b the algorithm is implemented in python using highly optimized and efficient python packages that can handle large size image data sets such as dask rocklin 2015 and numba lam et al 2015 the source code is included in the porespy networks module as snow partitioning parallel fig 2 a to d shows essential steps of algorithm implementation on a 2d slice of a 3d porous material dataset the step by step description of the workflow shown in figs 1 and 2 is as follows 2 3 1 overlapping thickness the image is first divided into smaller sub domains such that each sub domain has some overlapping parts in neighbouring sub domains overlapping is essential to avoid edge artifacts when stitching the result back together but determining the amount of overlap is challenging the calculation criteria for estimating the overlapping thickness is based on the fact that it should be equal to or slightly greater than the size of the largest region in the image or more precisely the largest region touching each subdomain boundary however regions are not available for inspection until after the segmentation so a proxy metric must be used such as the largest pore as well be described below fig 3 a shows a 2d slice of random sphere packing image which is divided into two sub domains to get the correct watershed segmentation of each sub domain the boundary of each must be extended into the neighbouring sub domains such that it contains the maximum diameter sphere or at least centre marker of the sphere as shown in fig 3b this thickness can be determined in one of two ways the simplest is finding the maximum value in the distance transform 1 1 note that the distance transform step can also be somewhat time consuming but a recently released python implementation of felzenszwalb and huttenlocher 2012 meijster et al 2000 has drastically improved both the time and the ram required compard to the native scipy implementation virtanen et al 2020 of the binary image fig 3c since the distance transform must be calculated anyway as input to the watershed segmentation the overlap should then be 2x higher than this value to ensure that the if the largest pores happen to lie on a divisional boundary it will be completely encapsulated in both chunks and its watershed basin will be present in both subdomains this approach may fail if the pore regions are elongated since the distance transform gives only the shortest dimension of a pore region alternatively the overlap size can be approximated by scaling down the image size by a factor of 2 or more then performing a watershed on the coarsened image although this loss of resolution degrades the watershed the point is to find the largest region which will be the least impacted the amount of overlap can then be found as the largest dimension of a bounding box around the largest region as shown in fig 3d if the material is anisotropic the second approach is recommended despite being more complicated but in this work the first approach is used throughout naturally increasing the size of the overlap also increases the computational costs since the overlapped regions are effectively processed twice because since they appear in both subdomains strategies for reducing the overlap are discussed and compared later 2 3 2 number of divisions this number of subdomains created from the binary image can be adjusted depending on the computational resources available either to utilize all the cores available or to minimize the amount of ram consumed if the image size in any axis is not evenly divisible by the desired number of division then the image must be cropped accordingly or else the algorithm can give erroneous results in the current implementation this limitation is due to the difficulty in getting the access of extra slices of subdomains during stitching process as explained in section 2 3 5 but was deemed acceptable given that at most 9 voxels would be sacrificed and the images are implicitly very large image future enhancement in the algorithm should address this more precisely the size of subdomains at this step does not include the overlapping thickness which is added after the numbers of divisions are specified also it should be noted that the size of the overlap should not exceed the size of the subdomains so there is an upper limit to how finely the domain can be decomposed this essentially defines the upper limit of subdivision and the user should be cautious not to provide very large numbers of division 2 3 3 modes of operation once the extended subdomains are created the algorithm can be run in either parallel or serial mode in the parallel mode of operation each subdomain is processed simultaneously on one core of the cpu the serial mode of operation processes subdomains one by one and utilizes only one core of cpu this reduces the ram usage to a great extent but computational time increases compared to the standard watershed on the entire image overall computational performance graphs are discussed in detail in the results and discussion section 3 2 2 3 4 snow algorithm on subdomains after selecting the mode of operation the snow algorithm is applied to each extended subdomain this step is performed in a loop until all subdomains are processed the output is a list of watershed segmentations of each extended subdomain fig 2b at this point the overlapping thickness of each subdomain is trimmed such that only a 1 voxel thick slice of neighbouring subdomains is kept fig 2c this extra slice is essential for the stitching operation as detailed in section 2 3 5 furthermore the watershed basins in the subdomains are relabeled by sequentially finding the maximum label in the first subdomain in the list and adding that number to the labels of the next and so on this step ensures that there will be no duplicate labels in the final recomposed image 2 3 5 subdomains stitching after the relabeling process subdomains are stitched with neighbouring subdomains using the information embedded in the extra slice associated with each neighbouring subdomain fig 2d since the last slice of each subdomain and the first slice in the neighbouring subdomain are twins they should have the same number of regions and the regions should concide with each other also the two slices will have an equal number of voxels in all twin regions if the overlapped thickness was sufficient once these conditions are met the region labels of the extra slice are used to replace the twin region labels in the neighbouring subdomains the stitching process is performed along one axis at a time to avoid incorrect relabeling of regions in the corners and edges of the subdomains because these regions can span more than two neighbouring subdomains 2 3 6 trim extra slices once the relabeling process is completed for all the subdivisions the extra slices in each subdomain are deleted and the subdomains are recomposed into a single large image the output of this step is a segmented image that has the same shape as the original input binary image the segmented image labels are then resequenced to ensure they are contiguous since some labels are missing after the relabeling step also region labels are spatially randomized such that neighbouring regions have significantly different values which aids visualization of the porous domain 2 3 7 pore network extraction the segmented image is used to extract a pore network using porespy builtin regions to network function which scans through all regions in the segmented image and extracts geometrical and structural features of pores and throats the extraction process and definition of geometrical features are thoroughly explained in gostick 2017 in addition to extracting the pore network the algorithm can create boundary pores to define boundary conditions during the simulation process the detail of creating boundary pores is discussed by khan et al 2019 2 4 random walker simulation all of the rock images investigated here have reported values for the permeability coefficient which can be compared to value predicted the extracted network it was also desired to compare tortuosity or formation factors values which are not as readily available to remedy this the effective diffusivity of the images was estimated by discrete random walker simulation this approach is less computationally expensive than dns simulations e g such as the commonly used lattice boltzmann method liu et al 2016 pan et al 2004 while dealing with large size image datasets dns require the use of a supercomputer which is contrary to the aims of the present study an open source python package pytrax tranter et al 2019 was used to perform random walker simulation a comparison of the computational efficiency of the algorithm with lbm was given by khan et al 2019 the random walker algorithm finds the pore phase tortuosity of the binary porous domain using mean square displacement msd 105 random walkers were used eq 1 was used to find msd where p x t represents the probability density function of a walker at location x and time t codling et al 2008 and can be described by equation 2 1 msd x 2 p x t dx 2 p x t 1 4 π dt exp x 2 4 dt the mean square displacement msd of a walker that is subjected to follow an unbiased movement traces a gaussian distribution the touristy factor τ 1 can be found by plotting gradient of msd over time t the tortuosity τ calculated can be used to find the formation factor of the porous domain of porosity ε according to davies 1984 the formation factor is defined as the ratio of effective diffusivity to bulk diffusivity of nitrogen gas in air 2 03 10 5 m2 s kim and gostick 2019 and calculated according to eq 3 as follows 3 d eff d bulk ε τ 3 results and discussion 3 1 algorithm validation the validation of the domain decomposition algorithm was performed on five different types of 3d images id 1 5 mentioned in table 1 the number of segmented regions with and without domain decomposition was counted to ensure no regions were created or lost at the intersection of subdomains the decomposition ratio defined as the ratio of the shape of the original image to the shape of the subdomain was varied from 2 to 4 to ensure algorithm robustness at decomposition ratio 3 it was necessary to crop the image slightly to perfectly divide it into equal size subdomains the results are summarized in table 2 and show that the domain decomposition algorithm returns an identical number of segmented regions as compared to the segmentation without domain decomposition the small differences in a few cases never more than 2 regions are due to the size of the structuring element in the peak trimming method of snow algorithm and not associated with domain decomposition algorithm further improvements of the peak detection method can remove this difference but overall it represents a very small error considering the number of regions in the images these results also indicate robustness for different materials indicating that it can be used on other different types of porous domains such as metallic foams de carvalho et al 2017 membranes sundaramoorthi et al 2016 and battery electrodes khan et al 2020 3 2 quantification of computational performance to analyze cpu time and memory usage of the domain decomposition algorithm two different large size 3d image samples of sandstones were used in the study the specifications of the images id 6 7 are shown in table 1 the cpu time was defined as the time required to excecute all code including preprocessing and postprocessing steps such as calculating overlap thickness relableling and stitching etc to measure computational performance with increasing numbers of voxels the images were divided into 16 different size samples such that each sample size was obtained by dividing the z axis of the original image with an integer n between 1 to 16 the algorithm was tested on lenovo thinkstation p500 workstation having e5 1650 v3 3 cpu 16 cores and 256 gb ram during parallel and series computation the input samples were subdivided only along the z axis and no subdivision was performed in y and z axis so that the number of overlapping voxels scaled proportionally to the number of divisions for serial operation each subdomain was processed in a single core one by one while in parallel operation all subdomains were simultaneously processed in the separate cores the computational results were also compared with the legacy snow algorithm that uses scipy virtanen et al 2020 implementation of watershed segmentation the cpu time and memory usage are plotted against the number of voxels and results are shown in fig 4 a and b respectively it can be seen that snow parallel is significantly faster than snow legacy and as the number of voxels increases the computational efficiency increases many fold in the case when the actual images of bentheimer sandstone is subdivided into 16 domains snow parallel is 7 times faster than snow legacy this shows an appreciable increase in computational performance fig 4c and d shows cpu time performance and speed up gains against number of cores without changing number of voxels in samples the speed up in the simulation was defined as the ratio of cpu time without domain decomposition to the cpu time requied by n cores with domain decomposition from fig 4c and d it can be seen that total computational time decreased to approximately 7 times as compared to single core simulation in principle dividing the image into 16 subdomains with no overlap should give 16x speedup neglecting the time of any preprocessing and postprocessing steps such as overlap calculation relabeling and stitching in practice this was found to only result in a 10x speed up presumably due to overhead of the parallelization and data i o between the cpus and ram however some overlap is necessary for the algorithm to stitch the subdomains together and this overlap is responsible for reducing the speed up from 10x to 7x section 3 4 investigates the impact of the overlap size on speed and memory usages as well as segmentation accuracy fig 4 also shows that snow serial is relatively slower than snow legacy from fig 4a it appears that snow serial implementation is approximately 1 5 and 30 slower than snow legacy in bentheimer and fontainebleau sample respectivily but the major advantage of this mode of operation is significant reduction in ram usage as shown in fig 4b snow serial uses 2x less ram than snow legacy for equivalent size domains in both samples this allows a user with lesser computational resources to extract relatively larger porous domains which were not possible with snow legacy also it should be noted that snow parallel consumes more ram than the legacy snow algorithm this is because during the domain decomposition process snow algorithm is applied on all the subdomains simultaneously adding up ram usage of all subdomains together 3 3 pore network extraction of large size tomograms the domain decomposition algorithm was applied to four large size tomograms of porous rocks id 1 2 3 7 the sizes of these tomograms are given in table 1 the decomposition ratio of 4 was used to extract the pore network from berea bentheimer and doddington sandstone while the domain decomposition ratio was set to 6 for fontainebleau image of size 20483 voxel the extracted pore networks were used to simulate directional effective permeabilities for single phase flow using steady state stokes flow the pore network model conduit was assumed to consists of two half pores i and j and their interconnecting throat k to find sizes of each half pore and interconnecting throat spherical and cylindrical geometries were used respectively the overall conductance of conduit was calculated using series resistor model 4 1 g ij 1 g ik 1 g k 1 g jk where conductance in each half pore and interconnecting throat is calculated using hagen poiseuille equation as 5 g n a n 2 8 π μ l n i j k figs 5 7 shows overlayed pore network of the porous domain pore size colour map and z axis pressure field in the extracted pore network for berea bentheimer and doddington sandstone the large size fontainebleau overlaid pore network pore sizes and pressure field are shown in fig 8 the results of effective permeabilities for single phase flow in each direction are shown in table 3 the average values of permeabilities were compared with previously reported results in dong and blunt 2009 fredrich et al 1993 muljadi et al 2016 and thomson et al 2019 it can be seen that the results estimated by the presented algorithm match well with other efforts but with far less computational cost than the previously adopted computational approaches 3 4 impact of overlap thickness on speed and accuracy the overlapping of the subdomains represents a computational inefficiency since these voxels are processed multiple times in all of the results shown elsewhere in this work the amount of overlap was conservatively estimated by finding the global maximum of the distance transform a study was performed to determine the impact that reducing or increasing this overlap could have on computational time ram usage and accuracy a 10243 image of berea sandstone id 1 was used and divided into 8 cubic subdomains the standard overlap thickness calculated using distance transform approach was 58 voxels and represented as dashed vertical line in fig 11 fig 11 b shows that a 20 reduction in computational time and ram usage can be obtained by reducing the overlap from 58 to 20 intriguingly fig 11 a shows that the number of regions obtained by the watershed is nearly stable above 20 voxels of overlap similarly fig 11 c shows that the permeability and tortuosity of the extracted networks are unaffected by the reduced overlap size above 20 voxels unfortunately there is a sudden and drastic reduction in the accuracy of the results below 20 voxels creating a precarious situation the value of 20 voxels presumably depends on the sample morphology pore size and image resolution further investigation of this lower limit should be considered in future work the substantial gains in performance do suggest that a safe but less conservative estimate of overlap should be found one possibility is to calculate the local thickness of a downsampled image then the values only along the subdomain boundaries could be scanned for a local maximum this would in all probability provide a smaller value for the overlap that would still be sufficient the present implementation only allows for a single value of overlap thickness for all subdomains but this local approach would provide estimates for each pair of neighboring domains in principle allowing the smallest possible subdomains to be analyzed such optimizations are left for future studies 3 5 pore network extraction of scaled up images since domain decomposition saves the computational cost of network extraction it can be used to perform a pore network extraction on a scaled up image with almost the same amount of computational power that would have been consumed on a relatively small size domain using snow legacy the importance of image resolution enhancement has been discussed in karsanina et al 2018 and karsanina and gerke 2018 to illustrate this advantage the effective diffusivity results of three different samples of the same porous domain were analyzed at a different level of image resolution firstly a large high resolution image was used next the high resolution image was scaled down by a factor of 2 by binning the image to artificially reduce its resolution and lastly the artificially reduced image scaled up the size of the actual original high resolution binary image using a nearest neighbour interpolation note that higher order interpolations may provide even better results but this detail was left for future work pore network extraction on all three images was performed using the presented domain decomposition algorithm this process was applied to five different types of porous image id 1 2 3 4 and 14 and the results of extracted pores number and effective diffusivities formation factor for all samples are shown in figs 9 and 10 respectively the formation factors were calculated for each high resolution image in all three directions using random walks and an average value is reported in fig 10 from the results in fig 9 it can be seen that like other extraction algorithms when the resolution is reduced the number of regions found by the watershed is impacted almost always reduced which indicates that the watershed segmentation is indeed resolution dependent the reason low resolution samples have fewer regions is that the fewer markers are found at low resolution and hence marker based watershed segmentation merges two or more regions into one when low resolution images are rescaled back up to the original size the number of regions approaches very nearly back to the value found on the original high resolution images this is a very promising result since it suggests that natively low resolution images can be artificially scaled up to improve the accuracy of the segmentation and extraction the trends seen for the number of regions are also echoed in the formation factor values predicted by the extracted networks as can be seen in fig 10 a c which reports the network formation factor for all samples at all resolutions along with the results of the random walker simulation on the high resolution image as a reference indicated by the line this indicates that increasing the resolution of a natively low resolution image not only improves the watershed segmentation but simultaneously improves the accuracy of the extracted network the impact of resolution on watershed segmentation and the accuracy of the subsequently extracted networks is worth deeper study for instance the resolution effect was almost absent from the sphere pack shown in fig 10 d and e this effect is probably due to the fact that sphere packs have a narrow pore size distribution whereas the natural material has a wider distribution and the smaller pore are probably not well segmented in any case the outcome of this sub study is that instead of reducing an image to a manageable size before network extraction it is now possible and recommended to enlarge the image before extraction 4 conclusions and future work an efficient geometric domain decomposition algorithm was developed to extract pore networks from massive size images of porous domains the algorithm subdivides the image into small subdomains with sufficient overlap and these are further processed to get a watershed segmentation for use in the snow algorithm validation of the algorithm was performed on various types of porous materials and found to give identical results in terms of number of watershed basins found to that obtained without performing domain decomposition one key feature of the proposed decomposition approach is that it can be applied to all subdomains in parallel for enhanced speed or each one in serial for reduced ram usage the serial mode of operation reduces ram usage to 50 percent compared to the legacy approach this allows a user to process large porous domains on a computer with limited or average computational capacity on the other hand the parallel mode of operation decreases cpu time by 7 times in the tested image enabling the processing of larger domains much faster than the legacy method typically images are often scaled down to more manageable sizes before processing due to the improved performance of the proposed algorithm it becomes feasible to process larger images a study was performed to see if artificially increasing the size of a low resolution image resulted in improved outcomes the pore network extracted from a scaled up domain was found to give more accurate results than those obtained from a low resolution image and the results approached those of the original high resolution image the developed algorithm is implemented in the open source python package porespy using highly optimized and efficient python packages such as dask and numba there are improvements that could be made to the proposed algorithm for instance the dask library is able to parallelize across distributed nodes as well as the shared memory approach used here which could enable the segmentation of even larger images credit authorship contribution statement zohaib atiq khan conceptualization data curation formal analysis investigation methodology validation visualization writing original draft writing review editing ali elkamel conceptualization funding acquisition project administration resources supervision writing original draft writing review editing jeff t gostick conceptualization project administration resources software supervision writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to thank the university of engineering and technology lahore new campus pakistan as well as the natural science and engineering research council nserc of canada for their funding and support to make this research possible special thanks to university of waterloo canada for the doctoral thesis completion award 2020 awarded to zohaib atiq khan to carry out this research 
400,image based modelling of porous media to study the transport and reaction processes has become an essential tool the availability of increasingly large image datasets at high resolution creates a need to develop algorithms that can process massive size images at a low computational cost this study presents an efficient workflow to extract pore networks from large size porous domains using a watershed segmentation with geometrical domain decomposition the method subdivides a porous image into smaller overlapping subdomains and performs a watershed segmentation on each subdomain in parallel or serial modes of operation to save cpu time or memory ram respectively the computational performance of the algorithm was analyzed on a large size image and found to consume 50 percent less memory and upto 7 times less cpu time than the standard watershed implementation pore networks of four massive digital rock images were extracted and the the effective permeability predicted by the networks agreed well with previously investigated values illustrating the accuracy of the method an additional application of this method taking advantage of the reduced computational cost is the upgrading of low resolution image it was found that increasing the resolution of a coarse image leads to more accurate predictions by helping the watershed segmenation prouduce a more faithful pore network model the developed algorithm is implemented in python and included in the open source project porespy it uses highly optimized and efficient modules such as dask and numba to obtain the maximum performance the domain decomposition approach used here will also lend itself well to processing on distributed memory clusters enabling the processing of even larger porous domains keywords pore network modelling porous media x ray computed tomography domain decomposition watershed segmentation 1 introduction image based modelling of porous media to study transport and reaction processes has become a key tool thanks to the relentless increase in computational power gerke et al 2020a b parvan et al 2020 sadeghi et al 2020 santos et al 2020 sheng and thompson 2016 this has been accompanied and spurred on by the advancement of 3d imaging techniques such as x ray micro and nano computed tomography ct and focused ion beam scanning electron microscopy fib sem that have enabled the acquisition of massive domains at resolutions better than a fraction of micron for instance domains can be imaged with current ct techniques as large as 2000 voxels across and essentially unlimited in height since scans can be stitched together jackson et al 2020 soulaine et al 2016 wang et al 2019 modelling transport processes especially complex ones involving reactions and multiple coupled physics using numerical techniques known collectively as direct numerical simulation dns on such large domains strain even the most advanced modern workstations however one common remedy is to use pore network modeling pnm which is the most efficient when compared to other pore scale modelling approaches song et al 2019 and its importance has been well established in modelling transport processes of various types of porous media khan et al 2020 sadeghi et al 2019 thomson et al 2018 torayev et al 2018 the promise of using pnms to efficiently model complex transport processes in large domains is currently limited by the network extraction step which can take hours or more there are three main approaches to network extraction and they all depend on image analysis which can be resource and computationally intensive the approaches are 1 maximal ball dong et al 2008 dong and blunt 2009 2 skeletonization or medial axis thinning al raoush and willson 2005 bakke and øren 1997 3 watershed segmentation sheppard et al 2005 as well as some hybrid techniques gerke et al 2020 miao et al 2017 the present work focuses on the third approach by adapting the snow algorithm developed by gostick 2017 the main computational bottleneck of this algorithm is the watershed segmentation step which requires high computational memory ram and a significant amount of cpu time as the size of the 3d image approaches and exceeds 10003 voxels it should be stressed that the present work can be applied to any technique that uses a watershed segementation since it is applied to the result of the watershed and is therefore agnostic to how the watershed was performed there have been a few recent attempts to accelerate the network extraction by employing parallelization rabbani et al 2019 approached the problem by dividing the image into several subdomains and performing watershed segmentation on each subdomain individually a pore network was then extracted from each subdomain and these networks were subsequently stitched together to get one large network the stitching was done by analyzing the interaction of the throats at the intersection of two neighboring subdomains although their algorithm obtained an increase in computational efficiency the accuracy was sacrificed since the pore connections and throat radius at the intersections of two domains are handled based on aribitrary stitching rules the final pore network was found to differ noticably from the network extracted from a single large domain and moreoever the result depended significantly on the number and size of subdomains used kohanpur and valocchi 2020 developed a stitching method to join the two neighbouring subdomains statistically similar to the approach of rabbani et al 2019 stitching networks post extraction introduces errors in the predicted transport properties and the relative error changes depending on the number of subdomains to remedy the limitations of stitching networks post extraction the present work focused on obtaining a watershed via parallelizing the watershed step then performing network extraction on the entire image a key factor to note is that the number of segmented regions in a large image is far fewer than the number of voxels therefore if a segmented image can be obtained efficiently the network extraction step can be applied to the segmentation without concern for efficiency in general there are two approaches to parallelizing the watershed redefining the inner workings of the algorithm to work in a truly parallel way or dividing the image into chunks then applying an existing algorithm on each chunk individually kornilov and safonov 2018 moga and gabbouj 1998a b moga et al 1998 the first approach is quite challenging because as pointed out in several reviews roerdink and meijster 2000 romero zaliz and reinoso gordo 2018 the watershed is inherently iterative or sequential in nature requiring multiple passes over the image typical performance gains for algorithms in this category are between 2 4x on 8 core machines moga and gabbouj 1998a b nicolescu et al 1999 romero zaliz and reinoso gordo 2018 wagner et al 2009 the best performance gain on more than 10003 voxels images was achieved by wagner et al 2009 who reported an average speed up of 5x on a machine with 8 cores but conceded that the accuracy of the segmentation may not be maintained their speed up was also inflated since they parallelized the immersion algorithm of vincent and soille 1991 which is faster than the marker based segmentation of meyer and beucher 1990 and beucher 1994 as no preprocessing steps to define markers are required attempts have also been made to develop parallelized algorithms for use on distributed memory systems moga and gabbouj 1998a b moga et al 1998 but again the need to share information between nodes during the processing limits the performance gains in general intrinsically parallel algorithm only achieve moderate speed improvements each implementation is specific to one type of watershed and they involve sophisticated implementations that are not widely available for use by porous media researchers the other approach to parallelization is referred to as divide and conquer or geometric domain decomposition where the image is divided into chunks and each is processed separately followed by a post processing step to recombine each chunk back into a single domain this approach offers several useful advantages as it can be run on distributed memory systems as well as shared memory machines with ease the former has the benefit that many nodes can be requisitioned and or each node can have a large amount of ram for processing massive images of course this requires access to specialized computational resources because no information is exchanged between processes domain decomposition schemes can optionally be run asynchronously meaning that a single shared memory machine can be used to analyze large images by processing each chunk in series this allows the use of normal desktop or even laptop computers on images that would otherwise be infeasibly large domain decomposition schemes can also be run in parallel on shared memory high performance workstations allowing a high degree of flexibility in how they are run another advantage is that the user is free to choose which watershed algorithm is applied to each domain for instance it has been shown that a marker based watershed with carefully selected markers is necessary to obtain a valid network from porous media images gostick 2017 so the ability to choose the algorithm and its settings is critical as another scenario if one had access to a distributed memory system each node could use an internally parallelized algorithm of the type discussed above and domain decomposition could be used to harness many nodes significantly increasing the computational performance the downside of the domain decomposision approach is that the accuracy of the segmentation is not assured as it depends on the handling of interfaces between each subdomain which is one of the major points addressed in this work this work presents a pore network extraction workflow that is based on parallelized watershed segmentation using domain decomposition the proposed algorithm is conceptually simple requiring only that each subdomain overlaps its neighbor by a sufficient amount to prevent edge artifacts and followed by relabeling of watershed basins by comparison of the overlapping regions all of this is done in the pre and post processing steps so the actual watershed function is untouched crucially the proposed approach can extract an identical network as that without domain decomposition and the result is independent of the number of subdomains the developed algorithm s computational performance was tested on a variety of large images and shown to be many times faster than the currently available approaches based on existing single core implementations the presented algorithm by working on each subsection of the image separately can also be applied in serial processing mode for cases where ram is limited and the effectiveness of this scheme was also explored the proposed domain decomposition algorithm therefore offers the option of fast parallelized processing on high performance workstations with many cores and ample ram or slower serial processing on lesser machines with limited cores and ram the possibility also exists for the present algorithm to be deployed on distributed memory systems though this aspect was not explored in the present work an additional benefit of the present approach is that any watershed algorithm can be applied allowing users to customize the scheme for their own workflow lastly and most practically this present algorithm is implemented using widely accessible open source python tools such as the scipy stack virtanen et al 2020 dask rocklin 2015 and numba lam et al 2015 the algorithm is included in the in open source project porespy gostick et al 2019 and the output of code is also well aligned with open source pore networking modelling project openpnm gostick et al 2016 2 methodology 2 1 x ray micro computed tomography image samples to investigate the computational performance and geometric domain decomposition artifacts if any 13 different types of 3d datasets were used these included the x ray μct images of different types of rocks provided by imperial college london dong 2007 dong and blunt 2009 random sphere packings were generated using porespy gostick et al 2019 and massive size images of the fontainebleau sandstone samples were constructed by institute for computational physics at the university of stuttgart hilfer and zauner 2011 a large size bentheimer sanstone image obtained by jackson et al 2020 was downloaded from the digitalrockportal samuel et al 2019 the sizes resolutions and porosities of images used in different studies are shown in table 1 equal size subdomains were created from the original images during the domain decomposition process so some images were cropped by a few voxels to make it evenly divisible by the decomposition ratio and their final cropped size are mentioned in the respective study 2 2 network extraction algorithm the snow algorithm as elaborated in gostick 2017 was used to perform a marker based watershed segmentation and network extraction for all steps in this study the algorithm uses a gaussian blur and two custom filters to remove spurious peaks from the distance transform before performing marker based watershed segmentation on 3d image a detailed comparison with commonly used extraction algorithms and modelling approaches are provided in gostick 2017 and khan et al 2019 the segmented regions obtained using snow algorithm are then used to extract geometrical and structural information of the network the workflow for the snow pore network extraction methodology is shown in fig 1 a 2 3 domain decomposition algorithm the main computational bottleneck of the snow network extraction algorithm fig 1a was the watershed step as the size of the image increases overall memory and cpu time increases significantly to the point that it becomes impractical to extract a network on a common laptop or desktop computer which has on average 16 to 24 gb ram the high computational cost of this step can be avoided if the image is divided into smaller manageable sub domains and watershed segmentation is performed on each individually these sub domains can then later be stitched together before the network extraction step if this stitching is done carefully it is possible to get an identical pore network to that which would be obtained from applying the watershed on the single large domain the overall process for domain decomposition developed in this study is shown in fig 1b the algorithm is implemented in python using highly optimized and efficient python packages that can handle large size image data sets such as dask rocklin 2015 and numba lam et al 2015 the source code is included in the porespy networks module as snow partitioning parallel fig 2 a to d shows essential steps of algorithm implementation on a 2d slice of a 3d porous material dataset the step by step description of the workflow shown in figs 1 and 2 is as follows 2 3 1 overlapping thickness the image is first divided into smaller sub domains such that each sub domain has some overlapping parts in neighbouring sub domains overlapping is essential to avoid edge artifacts when stitching the result back together but determining the amount of overlap is challenging the calculation criteria for estimating the overlapping thickness is based on the fact that it should be equal to or slightly greater than the size of the largest region in the image or more precisely the largest region touching each subdomain boundary however regions are not available for inspection until after the segmentation so a proxy metric must be used such as the largest pore as well be described below fig 3 a shows a 2d slice of random sphere packing image which is divided into two sub domains to get the correct watershed segmentation of each sub domain the boundary of each must be extended into the neighbouring sub domains such that it contains the maximum diameter sphere or at least centre marker of the sphere as shown in fig 3b this thickness can be determined in one of two ways the simplest is finding the maximum value in the distance transform 1 1 note that the distance transform step can also be somewhat time consuming but a recently released python implementation of felzenszwalb and huttenlocher 2012 meijster et al 2000 has drastically improved both the time and the ram required compard to the native scipy implementation virtanen et al 2020 of the binary image fig 3c since the distance transform must be calculated anyway as input to the watershed segmentation the overlap should then be 2x higher than this value to ensure that the if the largest pores happen to lie on a divisional boundary it will be completely encapsulated in both chunks and its watershed basin will be present in both subdomains this approach may fail if the pore regions are elongated since the distance transform gives only the shortest dimension of a pore region alternatively the overlap size can be approximated by scaling down the image size by a factor of 2 or more then performing a watershed on the coarsened image although this loss of resolution degrades the watershed the point is to find the largest region which will be the least impacted the amount of overlap can then be found as the largest dimension of a bounding box around the largest region as shown in fig 3d if the material is anisotropic the second approach is recommended despite being more complicated but in this work the first approach is used throughout naturally increasing the size of the overlap also increases the computational costs since the overlapped regions are effectively processed twice because since they appear in both subdomains strategies for reducing the overlap are discussed and compared later 2 3 2 number of divisions this number of subdomains created from the binary image can be adjusted depending on the computational resources available either to utilize all the cores available or to minimize the amount of ram consumed if the image size in any axis is not evenly divisible by the desired number of division then the image must be cropped accordingly or else the algorithm can give erroneous results in the current implementation this limitation is due to the difficulty in getting the access of extra slices of subdomains during stitching process as explained in section 2 3 5 but was deemed acceptable given that at most 9 voxels would be sacrificed and the images are implicitly very large image future enhancement in the algorithm should address this more precisely the size of subdomains at this step does not include the overlapping thickness which is added after the numbers of divisions are specified also it should be noted that the size of the overlap should not exceed the size of the subdomains so there is an upper limit to how finely the domain can be decomposed this essentially defines the upper limit of subdivision and the user should be cautious not to provide very large numbers of division 2 3 3 modes of operation once the extended subdomains are created the algorithm can be run in either parallel or serial mode in the parallel mode of operation each subdomain is processed simultaneously on one core of the cpu the serial mode of operation processes subdomains one by one and utilizes only one core of cpu this reduces the ram usage to a great extent but computational time increases compared to the standard watershed on the entire image overall computational performance graphs are discussed in detail in the results and discussion section 3 2 2 3 4 snow algorithm on subdomains after selecting the mode of operation the snow algorithm is applied to each extended subdomain this step is performed in a loop until all subdomains are processed the output is a list of watershed segmentations of each extended subdomain fig 2b at this point the overlapping thickness of each subdomain is trimmed such that only a 1 voxel thick slice of neighbouring subdomains is kept fig 2c this extra slice is essential for the stitching operation as detailed in section 2 3 5 furthermore the watershed basins in the subdomains are relabeled by sequentially finding the maximum label in the first subdomain in the list and adding that number to the labels of the next and so on this step ensures that there will be no duplicate labels in the final recomposed image 2 3 5 subdomains stitching after the relabeling process subdomains are stitched with neighbouring subdomains using the information embedded in the extra slice associated with each neighbouring subdomain fig 2d since the last slice of each subdomain and the first slice in the neighbouring subdomain are twins they should have the same number of regions and the regions should concide with each other also the two slices will have an equal number of voxels in all twin regions if the overlapped thickness was sufficient once these conditions are met the region labels of the extra slice are used to replace the twin region labels in the neighbouring subdomains the stitching process is performed along one axis at a time to avoid incorrect relabeling of regions in the corners and edges of the subdomains because these regions can span more than two neighbouring subdomains 2 3 6 trim extra slices once the relabeling process is completed for all the subdivisions the extra slices in each subdomain are deleted and the subdomains are recomposed into a single large image the output of this step is a segmented image that has the same shape as the original input binary image the segmented image labels are then resequenced to ensure they are contiguous since some labels are missing after the relabeling step also region labels are spatially randomized such that neighbouring regions have significantly different values which aids visualization of the porous domain 2 3 7 pore network extraction the segmented image is used to extract a pore network using porespy builtin regions to network function which scans through all regions in the segmented image and extracts geometrical and structural features of pores and throats the extraction process and definition of geometrical features are thoroughly explained in gostick 2017 in addition to extracting the pore network the algorithm can create boundary pores to define boundary conditions during the simulation process the detail of creating boundary pores is discussed by khan et al 2019 2 4 random walker simulation all of the rock images investigated here have reported values for the permeability coefficient which can be compared to value predicted the extracted network it was also desired to compare tortuosity or formation factors values which are not as readily available to remedy this the effective diffusivity of the images was estimated by discrete random walker simulation this approach is less computationally expensive than dns simulations e g such as the commonly used lattice boltzmann method liu et al 2016 pan et al 2004 while dealing with large size image datasets dns require the use of a supercomputer which is contrary to the aims of the present study an open source python package pytrax tranter et al 2019 was used to perform random walker simulation a comparison of the computational efficiency of the algorithm with lbm was given by khan et al 2019 the random walker algorithm finds the pore phase tortuosity of the binary porous domain using mean square displacement msd 105 random walkers were used eq 1 was used to find msd where p x t represents the probability density function of a walker at location x and time t codling et al 2008 and can be described by equation 2 1 msd x 2 p x t dx 2 p x t 1 4 π dt exp x 2 4 dt the mean square displacement msd of a walker that is subjected to follow an unbiased movement traces a gaussian distribution the touristy factor τ 1 can be found by plotting gradient of msd over time t the tortuosity τ calculated can be used to find the formation factor of the porous domain of porosity ε according to davies 1984 the formation factor is defined as the ratio of effective diffusivity to bulk diffusivity of nitrogen gas in air 2 03 10 5 m2 s kim and gostick 2019 and calculated according to eq 3 as follows 3 d eff d bulk ε τ 3 results and discussion 3 1 algorithm validation the validation of the domain decomposition algorithm was performed on five different types of 3d images id 1 5 mentioned in table 1 the number of segmented regions with and without domain decomposition was counted to ensure no regions were created or lost at the intersection of subdomains the decomposition ratio defined as the ratio of the shape of the original image to the shape of the subdomain was varied from 2 to 4 to ensure algorithm robustness at decomposition ratio 3 it was necessary to crop the image slightly to perfectly divide it into equal size subdomains the results are summarized in table 2 and show that the domain decomposition algorithm returns an identical number of segmented regions as compared to the segmentation without domain decomposition the small differences in a few cases never more than 2 regions are due to the size of the structuring element in the peak trimming method of snow algorithm and not associated with domain decomposition algorithm further improvements of the peak detection method can remove this difference but overall it represents a very small error considering the number of regions in the images these results also indicate robustness for different materials indicating that it can be used on other different types of porous domains such as metallic foams de carvalho et al 2017 membranes sundaramoorthi et al 2016 and battery electrodes khan et al 2020 3 2 quantification of computational performance to analyze cpu time and memory usage of the domain decomposition algorithm two different large size 3d image samples of sandstones were used in the study the specifications of the images id 6 7 are shown in table 1 the cpu time was defined as the time required to excecute all code including preprocessing and postprocessing steps such as calculating overlap thickness relableling and stitching etc to measure computational performance with increasing numbers of voxels the images were divided into 16 different size samples such that each sample size was obtained by dividing the z axis of the original image with an integer n between 1 to 16 the algorithm was tested on lenovo thinkstation p500 workstation having e5 1650 v3 3 cpu 16 cores and 256 gb ram during parallel and series computation the input samples were subdivided only along the z axis and no subdivision was performed in y and z axis so that the number of overlapping voxels scaled proportionally to the number of divisions for serial operation each subdomain was processed in a single core one by one while in parallel operation all subdomains were simultaneously processed in the separate cores the computational results were also compared with the legacy snow algorithm that uses scipy virtanen et al 2020 implementation of watershed segmentation the cpu time and memory usage are plotted against the number of voxels and results are shown in fig 4 a and b respectively it can be seen that snow parallel is significantly faster than snow legacy and as the number of voxels increases the computational efficiency increases many fold in the case when the actual images of bentheimer sandstone is subdivided into 16 domains snow parallel is 7 times faster than snow legacy this shows an appreciable increase in computational performance fig 4c and d shows cpu time performance and speed up gains against number of cores without changing number of voxels in samples the speed up in the simulation was defined as the ratio of cpu time without domain decomposition to the cpu time requied by n cores with domain decomposition from fig 4c and d it can be seen that total computational time decreased to approximately 7 times as compared to single core simulation in principle dividing the image into 16 subdomains with no overlap should give 16x speedup neglecting the time of any preprocessing and postprocessing steps such as overlap calculation relabeling and stitching in practice this was found to only result in a 10x speed up presumably due to overhead of the parallelization and data i o between the cpus and ram however some overlap is necessary for the algorithm to stitch the subdomains together and this overlap is responsible for reducing the speed up from 10x to 7x section 3 4 investigates the impact of the overlap size on speed and memory usages as well as segmentation accuracy fig 4 also shows that snow serial is relatively slower than snow legacy from fig 4a it appears that snow serial implementation is approximately 1 5 and 30 slower than snow legacy in bentheimer and fontainebleau sample respectivily but the major advantage of this mode of operation is significant reduction in ram usage as shown in fig 4b snow serial uses 2x less ram than snow legacy for equivalent size domains in both samples this allows a user with lesser computational resources to extract relatively larger porous domains which were not possible with snow legacy also it should be noted that snow parallel consumes more ram than the legacy snow algorithm this is because during the domain decomposition process snow algorithm is applied on all the subdomains simultaneously adding up ram usage of all subdomains together 3 3 pore network extraction of large size tomograms the domain decomposition algorithm was applied to four large size tomograms of porous rocks id 1 2 3 7 the sizes of these tomograms are given in table 1 the decomposition ratio of 4 was used to extract the pore network from berea bentheimer and doddington sandstone while the domain decomposition ratio was set to 6 for fontainebleau image of size 20483 voxel the extracted pore networks were used to simulate directional effective permeabilities for single phase flow using steady state stokes flow the pore network model conduit was assumed to consists of two half pores i and j and their interconnecting throat k to find sizes of each half pore and interconnecting throat spherical and cylindrical geometries were used respectively the overall conductance of conduit was calculated using series resistor model 4 1 g ij 1 g ik 1 g k 1 g jk where conductance in each half pore and interconnecting throat is calculated using hagen poiseuille equation as 5 g n a n 2 8 π μ l n i j k figs 5 7 shows overlayed pore network of the porous domain pore size colour map and z axis pressure field in the extracted pore network for berea bentheimer and doddington sandstone the large size fontainebleau overlaid pore network pore sizes and pressure field are shown in fig 8 the results of effective permeabilities for single phase flow in each direction are shown in table 3 the average values of permeabilities were compared with previously reported results in dong and blunt 2009 fredrich et al 1993 muljadi et al 2016 and thomson et al 2019 it can be seen that the results estimated by the presented algorithm match well with other efforts but with far less computational cost than the previously adopted computational approaches 3 4 impact of overlap thickness on speed and accuracy the overlapping of the subdomains represents a computational inefficiency since these voxels are processed multiple times in all of the results shown elsewhere in this work the amount of overlap was conservatively estimated by finding the global maximum of the distance transform a study was performed to determine the impact that reducing or increasing this overlap could have on computational time ram usage and accuracy a 10243 image of berea sandstone id 1 was used and divided into 8 cubic subdomains the standard overlap thickness calculated using distance transform approach was 58 voxels and represented as dashed vertical line in fig 11 fig 11 b shows that a 20 reduction in computational time and ram usage can be obtained by reducing the overlap from 58 to 20 intriguingly fig 11 a shows that the number of regions obtained by the watershed is nearly stable above 20 voxels of overlap similarly fig 11 c shows that the permeability and tortuosity of the extracted networks are unaffected by the reduced overlap size above 20 voxels unfortunately there is a sudden and drastic reduction in the accuracy of the results below 20 voxels creating a precarious situation the value of 20 voxels presumably depends on the sample morphology pore size and image resolution further investigation of this lower limit should be considered in future work the substantial gains in performance do suggest that a safe but less conservative estimate of overlap should be found one possibility is to calculate the local thickness of a downsampled image then the values only along the subdomain boundaries could be scanned for a local maximum this would in all probability provide a smaller value for the overlap that would still be sufficient the present implementation only allows for a single value of overlap thickness for all subdomains but this local approach would provide estimates for each pair of neighboring domains in principle allowing the smallest possible subdomains to be analyzed such optimizations are left for future studies 3 5 pore network extraction of scaled up images since domain decomposition saves the computational cost of network extraction it can be used to perform a pore network extraction on a scaled up image with almost the same amount of computational power that would have been consumed on a relatively small size domain using snow legacy the importance of image resolution enhancement has been discussed in karsanina et al 2018 and karsanina and gerke 2018 to illustrate this advantage the effective diffusivity results of three different samples of the same porous domain were analyzed at a different level of image resolution firstly a large high resolution image was used next the high resolution image was scaled down by a factor of 2 by binning the image to artificially reduce its resolution and lastly the artificially reduced image scaled up the size of the actual original high resolution binary image using a nearest neighbour interpolation note that higher order interpolations may provide even better results but this detail was left for future work pore network extraction on all three images was performed using the presented domain decomposition algorithm this process was applied to five different types of porous image id 1 2 3 4 and 14 and the results of extracted pores number and effective diffusivities formation factor for all samples are shown in figs 9 and 10 respectively the formation factors were calculated for each high resolution image in all three directions using random walks and an average value is reported in fig 10 from the results in fig 9 it can be seen that like other extraction algorithms when the resolution is reduced the number of regions found by the watershed is impacted almost always reduced which indicates that the watershed segmentation is indeed resolution dependent the reason low resolution samples have fewer regions is that the fewer markers are found at low resolution and hence marker based watershed segmentation merges two or more regions into one when low resolution images are rescaled back up to the original size the number of regions approaches very nearly back to the value found on the original high resolution images this is a very promising result since it suggests that natively low resolution images can be artificially scaled up to improve the accuracy of the segmentation and extraction the trends seen for the number of regions are also echoed in the formation factor values predicted by the extracted networks as can be seen in fig 10 a c which reports the network formation factor for all samples at all resolutions along with the results of the random walker simulation on the high resolution image as a reference indicated by the line this indicates that increasing the resolution of a natively low resolution image not only improves the watershed segmentation but simultaneously improves the accuracy of the extracted network the impact of resolution on watershed segmentation and the accuracy of the subsequently extracted networks is worth deeper study for instance the resolution effect was almost absent from the sphere pack shown in fig 10 d and e this effect is probably due to the fact that sphere packs have a narrow pore size distribution whereas the natural material has a wider distribution and the smaller pore are probably not well segmented in any case the outcome of this sub study is that instead of reducing an image to a manageable size before network extraction it is now possible and recommended to enlarge the image before extraction 4 conclusions and future work an efficient geometric domain decomposition algorithm was developed to extract pore networks from massive size images of porous domains the algorithm subdivides the image into small subdomains with sufficient overlap and these are further processed to get a watershed segmentation for use in the snow algorithm validation of the algorithm was performed on various types of porous materials and found to give identical results in terms of number of watershed basins found to that obtained without performing domain decomposition one key feature of the proposed decomposition approach is that it can be applied to all subdomains in parallel for enhanced speed or each one in serial for reduced ram usage the serial mode of operation reduces ram usage to 50 percent compared to the legacy approach this allows a user to process large porous domains on a computer with limited or average computational capacity on the other hand the parallel mode of operation decreases cpu time by 7 times in the tested image enabling the processing of larger domains much faster than the legacy method typically images are often scaled down to more manageable sizes before processing due to the improved performance of the proposed algorithm it becomes feasible to process larger images a study was performed to see if artificially increasing the size of a low resolution image resulted in improved outcomes the pore network extracted from a scaled up domain was found to give more accurate results than those obtained from a low resolution image and the results approached those of the original high resolution image the developed algorithm is implemented in the open source python package porespy using highly optimized and efficient python packages such as dask and numba there are improvements that could be made to the proposed algorithm for instance the dask library is able to parallelize across distributed nodes as well as the shared memory approach used here which could enable the segmentation of even larger images credit authorship contribution statement zohaib atiq khan conceptualization data curation formal analysis investigation methodology validation visualization writing original draft writing review editing ali elkamel conceptualization funding acquisition project administration resources supervision writing original draft writing review editing jeff t gostick conceptualization project administration resources software supervision writing original draft writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement the authors would like to thank the university of engineering and technology lahore new campus pakistan as well as the natural science and engineering research council nserc of canada for their funding and support to make this research possible special thanks to university of waterloo canada for the doctoral thesis completion award 2020 awarded to zohaib atiq khan to carry out this research 
401,we present an eulerian stochastic advection diffusion reaction sadr model and use it to explain incomplete mixing typically observed in transport experiments with bimolecular reactions unlike traditional advection dispersion reaction adr models the sadr model describes mechanical and diffusive mixing as two separate processes in the sadr model mechanical mixing is driven by random advective velocity whose variance is given by the coefficient of mechanical dispersion the diffusive mixing is modeled as a fickian diffusion process with the effective diffusion coefficient we demonstrate that the sum of the two coefficients is equal to the dispersion coefficient but only the effective diffusion coefficient contributes to the mixing controlled reactions we use experimental results of gramling et al to show that for transport and bimolecular reactions in porous media the sadr model is significantly more accurate than the adr model which overestimates the concentration of the reaction product by as much as 60 we also show that the sadr model predicts an experimentally observed bell shaped spatial distribution of the reactive product concentration while the adr model results in a concentration distribution with an unphysical kink keywords bimolecular reactions incomplete mixing stochastic transport model mechanical mixing tracer test 1 introduction reactive transport is ubiquitous in natural and man made systems at small scales reactive transport is dominated by thermally induced velocity fluctuations and langevin type stochastic diffusion reaction models are well established and provide an accurate description of mixing controlled reactions risken 1984 rey and cardy 1999 deem and park 1998 atzberger 2010 in large scale applications e g atmospheric transport and transport in porous media velocity variations are caused by unresolved flow processes e g turbulence and pore scale flow and reactive transport is described by deterministic in the absence of parametric uncertainty advection dispersion reaction adr equations with constant reaction rate coefficients however the adr equations tend to overestimate the extent of mixing controlled reactions gramling et al 2002 tartakovsky et al 2008 tartakovsky 2010 bolster et al 2010 ginn 2018 roubinet and tartakovsky 2013 siuliukina and tartakovsky 2018 solutes mix by two distinct mechanisms 1 molecular diffusion and 2 mechanical mixing caused by variations in the fluid velocity advecting the solutes the dispersion theory assumes that solutes are fully mixed within a representative elementary volume rev with the characteristic length l fig 1 and treats both mechanisms as fickian diffusive processes at the hydrodynamic scale equations for a general advection convection diffusion reaction process with n species arises naturally from mass conservation considerations pandis and seinfeld 2006 bear 1988 1 t c i d i 2 c i v c i r i c 1 c n i 1 n where the advection velocity v satisfies the navier stokes equations ci is the concentration of the ith component di is the molecular diffusion constant and ri is the rate of the chemical reaction generating or consuming the ith species in the case of reactive transport in the atmosphere ocean or a river the advective velocity field v is often turbulent and can have a non zero divergence i e air flow can be compressible in the case of transport in porous media v is the pore scale velocity field defined by the navier stokes equations bear 1988 however the direct calculations of pore scale velocity v are not practical and eq 1 is commonly replaced with the adr model quintard et al 2001 bear 1988 2 t c i d 2 c i v c i r i c 1 c n i 1 n here v and c i are the respective averages of v and ci over the rev and d is the dispersion tensor in the advection diffusion reaction eq 1 the v ci term models advection and mechanical mixing and the di 2 ci term models diffusive mixing on the other hand in the adr eq 2 both the mechanical and diffusive mixings are modeled by the d 2 c i term we hypothesize that this is the main reason why the adr model often fails to accurately predict mixing controlled reactions in atmospheric and ocean modeling subgrid models are commonly used to approximate v and its effect on mechanical mixing frederiksen 2012 in subsurface transport applications the state of the art involves using stochastic lagrangian particle models benson and meerschaert 2009 leborgne et al 2008 bolster et al 2010 tartakovsky et al 2008 tartakovsky 2010 ding et al 2013 while some of these models accurately describe reactive transport experiments their discrete nature complicates analytical and numerical analysis e g parameters may require calibration and the lagrangian particle model results may be resolution dependent benson and meerschaert 2009 another approach is to use the adr model with empirical time dependent reaction rate coefficients sanchez vila et al 0000 porta et al 2012 or delayed diffusive mixing with a time dependent release rate ginn 2018 the main challenge in such models is parameterization of time dependent rates for transport with flow field and or boundary conditions e g solute injection rate that vary in time in lagrangian particle models tartakovsky et al 2008 tartakovsky 2010 herrera et al 2017 it is natural to model mechanical and diffusive mixing separately in these methods the mechanical mixing is produced by a random motion of computational particles and the diffusive mixing results from a mass exchange between particles here we propose the stochastic advection dispersion reaction sadr model that provides a similar separate treatment of the two mixing mechanisms but in the eulerian partial differential equation pde framework eulerian pde models have several advantages over lagrangian particle models the accuracy including error estimates and convergence rate of their numerical solutions is better understood and in some cases eulerian pdes admit analytical solutions while lagrangian particle models in general do not when available analytical solutions provide a deeper understanding of physical systems than their numerical counterparts and significantly simplify the model parameterization for example we obtain in this work the analytical solution of a special case of the sadr equations describing column experiments gramling et al 2002 with a bimolecular mixing controlled reaction we use this analytical solution to estimate the effective diffusion coefficient in the sadr model the rest of the parameters in the sadr model are the same as or can be directly obtained from the parameters in the corresponding adr model we also present an empirical approach for estimating the effective diffusion coefficient from the parameters in the adr model that does not rely on the results of reactive transport experiments we find a good agreement between the values of the effective diffusion coefficient obtained from the empirical relationship and fitting the analytical solution to the experimental data the adr model significantly overestimates the mass of the reaction product by as much as 60 in some cases in the column experiments reported in gramling et al 2002 it was also found in gramling et al 2002 that the concentration of the reaction product as a function of space has a smooth bell shape while the adr concentration has an unphysical kink at the point where the concentration reaches its maximum we find that the sadr model provides a much better fit to the experimental data albeit at the expense of introducing an extra parameter and produces the correct bell shape of the concentration distribution 2 stochastic advection diffusion reaction model in this section we present the sadr model which is an effective model that is defined on the scale l in the adr model 2 it is assumed that solutes are well mixed on the scale l this mixing is due to large scale velocity variations within the averaging volume and hydrodynamic dispersion the former stems from variations in pore size and complex pore geometry and the latter is the result of velocity variations within individual pores and molecular diffusion chemical reactions especially of the bimolecular type create large concentration gradients on scales much smaller than l which violates this assumption in the sadr model we assume that the solutes are fully mixed on the scale l that is much smaller than l furthermore we assume that the full mixing is a fickian process with the effective diffusion coefficient dm mechanical mixing in the sadr model is caused by random advection velocity the mean velocity is determined from the effective deterministic darcy flow equations the rigorous definition of l and l for nonlinear e g bimolecular reactive transport is non trivial and not pursued in this work we formulate the sadr model as the eulerian stochastic partial differential equation 3 t c i d m 2 c i v c i r i c 1 c n i 1 n here v v v is the random divergence free advective velocity with mean v and random fluctuations v the concentration of the ith species is given by the ensemble average of ci 4 c i x t a c i x t u p v u d u where a is the functional space of all possible realizations of v x t u a and pv u is the multipoint probability density function pdf of the random field v x t next we define the statistical distribution of v such that in the absence of chemical reactions i e r i c 1 c n 0 the average concentration is equaled to the darcy scale concentration c i x t c i x t the average velocity satisfies the darcy law v k θ h where k is the hydraulic conductivity h is the hydraulic head and θ is porosity and continuity equation k h 0 subject to the appropriate initial and boundary conditions random fluctuations v have a gaussian probability distribution function pv u and the covariance function v x t v y τ 2 d d ρ x y δ t τ here δ is the dirac delta function ρ is a correlation function e g an exponential or gaussian such that ρ 0 1 and d d and d m are the mechanical and effective diffusion tensors respectively which are defined later in appendix a we show that for the such defined statistical distribution of v and r i c 1 c n 0 the following conditions are satisfied d d d m d c i x t c i x t in two and three spatial dimensions and c i x t c i x t in one spatial dimension furthermore we postulate that the d d d m d relationship also holds for reactive transport in the following we demonstrate that for the nonlinear mixing controlled reaction a b y the dispersion model overestimates the concentration of the reaction product y i e y x t y x t we use data from the column reactive transport experiments of gramling et al 2002 to validate our model on the scale l these experiments can be described by the one dimensional version of eq 2 or 3 therefore the rest of this paper focuses on the one dimensional sadr equations 5 t c i d m x 2 c i v t x c i r i c 1 c n i 1 n the covariance function for one dimensional divergence free v is 6 v t v τ 2 d d δ t τ where dd is the mechanical dispersion coefficient and d m d d d here d is the longitudinal component of d that for example can be determined from a conservative tracer experiment bear 1988 3 application of the adr and sadr models to column experiments 3 1 column experiments in the following we compare predictions of the adr and sadr models with the experimental data of gramling et al 2002 and demonstrate that the sadr model is more accurate than the adr model for a wide range of peclet numbers p e v d d m where d is the average soil grain diameter and dm is the molecular diffusion constant a 36 cm long and 5 5 cm wide chamber filled with cryolite sand was used in the experiments of gramling et al 2002 the chamber was initially saturated with a solution containing edta 4 with a concentration of c 0 0 02 m in three different experiments the edta 4 solution was displaced with a solution containing 0 02 m of cuso4 with flow rates corresponding to p e 2 24 10 3 1 54 104 and 1 24 105 the instantaneous homogeneous irreversible reaction between the two solutes formed the reaction product cuedta 2 whose concentration was measured using a charge coupled device camera gramling et al 2002 fig 2 depicts the experimentally measured change of the total mass of cuedta 2 in the chamber with time and fig 3 shows distributions of the cuedta 2 concentration along the flow direction 3 2 modeling the experiments with the adr equations in gramling et al 2002 the evolution of the species concentrations in these experiments is described by the one dimensional adr model 2 7 t a d m x 2 a v x a k a b t b d m x 2 b v x b k a b t c d m x 2 c v x c k a b where a x t b x t and c x t are the concentrations of cuso4 edta 4 and cuedta 2 respectively and k is the reaction rate constant the domain was assumed to be semi infinite with the prescribed concentration boundary conditions bcs at x 0 8 a x 0 t c 0 b x 0 t 0 c x 0 t 0 and free outflow boundary conditions at x 9 x a x t x b x t x c x t 0 according to gramling et al 2002 the reaction rate in these experiments is k 2 3 10 9 m 1 s 1 and the time scale of the reaction is several orders of magnitude faster than the time scale of the shortest of these experiments therefore is was concluded that the reaction could be treated as instantaneous under the assumption of an instantaneous reaction an analytical solution for the reaction product concentration is gramling et al 2002 10 c x t c 0 2 erfc x v t 2 d t and the total mass of the reactive product per unit area is 11 m t c 0 1 c 0 0 c x t d x 2 d t π d t π exp v 2 t 4 d 1 2 v t erfc v t 2 d t for the ratio of advection length to the diffusion length greater than one v t d t 1 the expression for m t can be approximated as 12 m t c 0 2 d t π fig 2 displays mass m in grams as a function of the pore volume s measured in three experiments with different pe as reported in gramling et al 2002 fig 2 also shows m τ obtained from eq 12 as m s 2 d λ s π where the coefficient λ converts m t in the units of moles per cm2 and t in seconds to m and s as well as m s computed from eq 12 in gramling et al 2002 we were not able to estimate λ based on the information reported in gramling et al 2002 therefore we found λ by fitting the analytical solution 12 to the plots of this solution in gramling et al 2002 as λ 16 28 2 92 and 0 35 s g2 cm2 for p e 2 24 10 3 1 54 104 and 1 24 105 respectively fig 3 compares the analytical solution 10 and experimental measurements of c x t for the three pe both these figures show that the adr model overestimates the concentration and mass of the reaction product by more than 20 for all considered pe the values of v and d in eqs 10 and 12 were measured from conservative tracer experiments in gramling et al 2002 and are given in table 1 3 3 modeling the experiments with the sadr equations the sadr model for these experiments takes the form 13 t a d m x 2 a v t x a k a b t b d m x 2 b v t x b k a b t c d m x 2 c v t x c k a b the concentrations of the species are given by cuso 4 a edta 4 b and cuedta 2 c using the change of variables 14 y x 0 t v t d t x v t 0 t v t d t x v t γ t we rewrite these equations as 15 t a d m y 2 a k a b t b d m y 2 b k a b t c d m y 2 c k a b under the assumption of an instantaneous reaction these equations have an approximate analytical solution gramling et al 2002 which for the variable c in terms of the old coordinate x takes the form 16 c x t γ c 0 2 erfc x v t γ t 2 d m t here γ 0 t v t d t is a random variable given that v has the gaussian probability density with zero mean and the covariance given by eq 6 γ also has the gaussian probability density p γ with the variance 2ddt 17 p γ γ 1 4 π d d t exp γ 2 4 d d t where γ is a coordinate in the space of the random variable γ finally the reactive product concentration cuedta 2 is given by 18 c x t c x t γ p γ γ d γ and the mass of cuedta 2 per unit area is found as 19 m t c 0 1 c 0 0 c x t d x 2 d m t π d t π exp v 2 t 4 d 1 2 v t erfc v t 2 d t for t d v 2 this expression reduces to 20 m t c 0 2 d m t π eqs 19 and 20 are the main theoretical results of this work the comparison of these equations with eqs 11 and 12 reveals that 1 the mechanical mixing contributes to the reaction only at early times t d v 2 when the reaction front is located close to the boundary at x 0 2 at later times the reaction front moves away from the x 0 boundary and only d m d contributes to the reaction and 3 the reactive system never gets fully mixed as suggested by the advection dispersion model we note that while the only difference between eqs 20 and 12 is the coefficient dm in eq 20 and d in eq 12 it is not correct to say that the adr model with d d m can accurately model the experiments for example the adr model with d d m would incorrectly estimate concentrations cuso 4 cuedta 2 and edta 4 cuedta 2 and therefore predict incorrect concentrations cuso4 and edta 4 in the following we demonstrate that the sadr model results in a smooth shape of cuedta 2 as a function of x while the adr model predicts the shape of cuedta 2 with an unphysical kink where the concentration reaches its maximum we find dm by fitting eq 20 to the reactive product mass obtained from experiments see fig 2 and report these values in table 1 next we validate the model by computing the average concentration from eq 18 and comparing it with the concentration found from the experiment fig 3 shows that the concentration found from the sadr equations agrees with the experimental values for all considered pe while the dispersion model eq 10 overestimates the maximum concentration by as much as 60 also the adr concentrations have an unphysical kink at the point where the concentrations reach their maxima while both the experimental and sadr model concentrations have smooth bell shaped profiles in ginn 2018 the adr model was modified to better match the experimental data by introducing mobile to mobile phase mass transfer with a time dependent mass transfer rate but the resulting concentration profiles still had unphysical kinks it is important to reiterate that solutions 19 and 20 are obtained from the one dimensional sadr model which disregards the effects of transverse mechanical and diffusive mixing processes on reactive transport the results in figs 2 and 3 demonstrate that the one dimensional sadr model accurately describes these experiments therefore at the time scale of the considered experiments the contributions of transverse mechanical and diffusive mixing to m t are not significant these experiments were conducted for t 1732 233 and 29 s for p e 2 24 10 3 1 54 104 and 1 24 105 respectively in all these experiments t is smaller than the diffusion time τ d 2 d m 24142 9 s and the effective diffusion time τ e f f w 2 d m 25208 2750 and 263 s for p e 2 24 10 3 1 54 104 and 1 24 105 respectively where w is the flow cell width for t τ and or t τeff the effect of transverse mixing can be more pronounced and the solution of the two and three dimensional sadr models for m t might deviate from the one dimensional solutions 19 and 20 finally we want to mention the multiple scale expansion analysis of the adr equation for reactive transport with nonlinear heterogeneous reactions in terms of pe and damkohler da numbers in battiato and tartakovsky 2011 da describes the ratio of reaction time to diffusion time and is equal to infinity under the assumption of an instantaneous reaction as is the case in the considered experiments according to battiato and tartakovsky 2011 the sufficient conditions for adrs to approximate the pore scale equations with error ϵ 1 include p e 1 ϵ 2 da pe ϵ and da ϵ the physical explanation for this conclusion is that under the above conditions there is no guarantee that the solutes get fully mixed on the rev scale one implication of this analysis is that the adr equation with d a 0 provides an accurate approximation of subsurface transport but only if t is sufficiently large e g in aris taylor analysis of dispersion in a pipe t should be greater than 3τ for the dispersion model to become accurate aris 1956 on the other hand for da 1 there is no guarantee that the adr model will provide an accurate approximation of the pore scale adr equations with a heterogeneous reaction for any t even though the analysis in battiato and tartakovsky 2011 does not directly apply to the reactive transport with the homogeneous bimolecular reaction considered here there is no reason to conclude that the adr model 7 is an accurate approximation for the system even for t much larger than τ and τeff this is because the very fast instantaneous bimolecular reaction violates the conditions with respect to da and prevents the solutes from becoming fully mixed at the rev scale 4 empirical parameterization of the sadr model finally we propose an empirical approach to estimate dm and dd for cases when these coefficients cannot be readily obtained from reactive transport experiments as described in section 3 3 we assume that the dispersion coefficient as a function of pe is available from a conservative transport experiment and follows the empirical relationship coelho et al 1997 21 d d m α p e 1 β where dm is the molecular diffusion coefficient and 0 α 0 5 and 0 β 0 5 are known experimentally determined constants expanding eq 21 in a taylor series in powers of β yields 22 d d m α p e 1 β log p e β 2 log p e 2 2 o β 3 only the zero order in β term in eq 22 is independent of molecular diffusion and therefore contributes to the mechanical dispersion therefore we define dd and dm as 23 d d d m α p e and 24 d m d d d in the following we refer to the dm and dd coefficients computed from eqs 23 and 24 as the first order coefficients to demonstrate the accuracy of the proposed sadr model parameterization we use eqs 21 24 to compute the first order dm and dd coefficients for the considered experiments for these experiments dm d and pe values are listed in table 1 as reported in gramling et al 2002 the parameters α 0 34 and β 0 14 are found by fitting eq 21 to d as a function of pe see fig 4 then the values of the first order dm and dd coefficients are computed from eqs 23 and 24 and are given in table 1 in eq 22 we truncated the taylor expansion at the 5th order in β that resulted in a truncation error of less than 1 fig 5 shows the first order dm and dm obtained by fitting eq 20 to the experimental m t data we see that eq 23 gives a good estimate of dm especially for smaller pe fig 5 also reveals that dm scales as peξ where ξ 1 β in three dimensional problems eqs 21 24 can be used to define both longitudinal and transverse components of the dispersion mechanical dispersion and effective diffusion tensors the coefficients α and β are different for the longitudinal and transverse tensor components and could be determined from conservative tracer experiments 5 discussion and conclusions we proposed an eulerian pde sadr model for multicomponent reactive transport in porous media and obtained a one dimensional analytical solution for the boundary and initial conditions reported in gramling et al 2002 using the experimental data of gramling et al 2002 we demonstrated that the one dimensional sadr model is more accurate than the classical adr model with a constant reaction rate coefficient specifically the adr model significantly overestimates the mass of the reaction product by as much as 60 in some cases measured in the column experiments of gramling et al 2002 it was also found in gramling et al 2002 that the concentration of the reaction product as a function of space has a smooth bell shape while the adr concentration has an unphysical kink at the point where the concentration reaches its maximum we found that the sadr model provides a much better fit to the experimental data and produces the correct bell shape of the spatial concentration distribution the sadr model considers purely mechanical and diffusive mixing as two separate processes characterized by the mechanical dd and effective diffusing dm coefficients respectively the sum of these two coefficients equals the dispersion coefficient in the adr model d d d d m in three dimensional problems all these coefficients are tensors while separate treatment of mechanical and diffusive mixing have been used in some lagrangian particle models to the best of our knowledge sadr is the first model that provides such treatment in the eulerian pde framework the sadr model predicts that in the column experiments of gramling et al 2002 only the effective diffusion coefficient contributes to the reaction as opposed to the dispersion coefficient in the adr model which is the reason why the adr model overestimates the mass of the reaction product the sadr model has only one additional independent parameter dm compared to the adr model we presented two approaches for estimating dm in the first approach dm was found by fitting the analytical solution of the one dimensional sadr equation to the experimental data in gramling et al 2002 in the second approach dm was estimated from the parameters in the adr model dm and d as a function of pe all these parameters can be estimated from conservative tracer tests we observed good agreement between dm values obtained from the two approaches the important feature of the sadr model is that it uses the same description of reactions as the standard adr model and constant reaction rate coefficients which can be determined in batch experiments this is different from the adr models with time dependent reaction and or mass transfer rate coefficients which depend on initial and boundary conditions and are hard to estimate a priory the concept of separating mechanical mixing and diffusive mixing is not limited to transport in porous media and the sadr model can be extended to other fields credit authorship contribution statement alexandre m tartakovsky conceptualization methodology software formal analysis validation investigation writing original draft project administration funding acquisition david barajas solano investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the advanced scientific computing research program of the u s department of energy doe office of science pacific northwest national laboratory is operated by battelle for the doe under contract de ac05 76rl01830 appendix a derivation of equations for c consider the stochastic partial differential equation a 1 t c d m 2 c v c where v v v is the random divergence free advective velocity v 0 with mean v v v is the average pore velocity and random fluctuations v a 2 v x t v y τ 2 d d ρ x y δ t τ here δ x y is the dirac delta function ρ x y is the correlation function ρ 0 1 and d d and d m are the mechanical and effective diffusion tensors respectively the darcy scale concentration c x t is given by the ensemble average of c in this appendix we show that c x t c x t where c x t is the concentration satisfying the standard darcy scale advection dispersion equation a 3 t c d 2 c v c and that the dispersion coefficient is given by d d d d m there are several ways to obtain a pde for ci x t including the eulerian eddy diffusivity and macrodispersion theories see for example kraichnan 1987 mccomb 1990 neuman 1993 here we are following derivations as presented in jarman and tartakovsky 2013 writing c x t in eq a 1 as c x t c x t c x t and taking the ensemble average of eq a 1 yields a 4 t c d m 2 c v c v c defining green s function g x t y s g x t y s g x t y s as the solution of the equation a 5 t g d m 2 g v g δ x y δ t s subject to the appropriate homogeneous boundary conditions the exact expression for v c is a 6 v c 0 t ω v x t v y s t g x t y s y c y s d y d s 0 t ω v x t g x t y s v y s t y c y s d y d s 0 t ω v x t g x t y s y v y s t c y s d y d s assuming that g and v are jointly gaussian eq a 7 reduces to zhang 1995 a 7 v c 0 t ω v x t v y s t g x t y s y c y s d y d s assuming that c y s varies slowly relative to v yields a 8 v c 0 t ω v x t v y s t g x t y s d y d s c x t next we define the macro dispersion coefficient a 9 d m d 0 t ω v x t v y s t g x t y s d y d s then the equation for c takes the form a 10 t c d m d m d 2 c v c noting that v v to prove that c x t c x t and d d d d m it only remains to show that d m d d d we will prove this for an advection dispersion problem defined on an infinite three dimensional domain with an instantaneous source located at the point 0 0 0 and the average velocity v v 0 0 t green s function for this problem is a 11 g x t y s 1 4 π d m t s 3 2 exp x 1 y 1 v t s 2 x 2 y 2 2 x 3 y 3 2 4 d m t s note that a 12 0 t δ t s g x t y s d s 1 2 δ x y substituting eqs a 2 and a 11 into the left hand side of eq a 9 and using eq a 12 yields a 13 d m d d d ω ρ x y δ x y d y d d finally we note that in three spatial dimensions and as a result of the approximation in eq a 8 c c the accuracy of this approximation was extensively studied in jarman and tartakovsky 2013 and references therein in one spatial dimension it was proven in jarman and tartakovsky 2013 that c c 
401,we present an eulerian stochastic advection diffusion reaction sadr model and use it to explain incomplete mixing typically observed in transport experiments with bimolecular reactions unlike traditional advection dispersion reaction adr models the sadr model describes mechanical and diffusive mixing as two separate processes in the sadr model mechanical mixing is driven by random advective velocity whose variance is given by the coefficient of mechanical dispersion the diffusive mixing is modeled as a fickian diffusion process with the effective diffusion coefficient we demonstrate that the sum of the two coefficients is equal to the dispersion coefficient but only the effective diffusion coefficient contributes to the mixing controlled reactions we use experimental results of gramling et al to show that for transport and bimolecular reactions in porous media the sadr model is significantly more accurate than the adr model which overestimates the concentration of the reaction product by as much as 60 we also show that the sadr model predicts an experimentally observed bell shaped spatial distribution of the reactive product concentration while the adr model results in a concentration distribution with an unphysical kink keywords bimolecular reactions incomplete mixing stochastic transport model mechanical mixing tracer test 1 introduction reactive transport is ubiquitous in natural and man made systems at small scales reactive transport is dominated by thermally induced velocity fluctuations and langevin type stochastic diffusion reaction models are well established and provide an accurate description of mixing controlled reactions risken 1984 rey and cardy 1999 deem and park 1998 atzberger 2010 in large scale applications e g atmospheric transport and transport in porous media velocity variations are caused by unresolved flow processes e g turbulence and pore scale flow and reactive transport is described by deterministic in the absence of parametric uncertainty advection dispersion reaction adr equations with constant reaction rate coefficients however the adr equations tend to overestimate the extent of mixing controlled reactions gramling et al 2002 tartakovsky et al 2008 tartakovsky 2010 bolster et al 2010 ginn 2018 roubinet and tartakovsky 2013 siuliukina and tartakovsky 2018 solutes mix by two distinct mechanisms 1 molecular diffusion and 2 mechanical mixing caused by variations in the fluid velocity advecting the solutes the dispersion theory assumes that solutes are fully mixed within a representative elementary volume rev with the characteristic length l fig 1 and treats both mechanisms as fickian diffusive processes at the hydrodynamic scale equations for a general advection convection diffusion reaction process with n species arises naturally from mass conservation considerations pandis and seinfeld 2006 bear 1988 1 t c i d i 2 c i v c i r i c 1 c n i 1 n where the advection velocity v satisfies the navier stokes equations ci is the concentration of the ith component di is the molecular diffusion constant and ri is the rate of the chemical reaction generating or consuming the ith species in the case of reactive transport in the atmosphere ocean or a river the advective velocity field v is often turbulent and can have a non zero divergence i e air flow can be compressible in the case of transport in porous media v is the pore scale velocity field defined by the navier stokes equations bear 1988 however the direct calculations of pore scale velocity v are not practical and eq 1 is commonly replaced with the adr model quintard et al 2001 bear 1988 2 t c i d 2 c i v c i r i c 1 c n i 1 n here v and c i are the respective averages of v and ci over the rev and d is the dispersion tensor in the advection diffusion reaction eq 1 the v ci term models advection and mechanical mixing and the di 2 ci term models diffusive mixing on the other hand in the adr eq 2 both the mechanical and diffusive mixings are modeled by the d 2 c i term we hypothesize that this is the main reason why the adr model often fails to accurately predict mixing controlled reactions in atmospheric and ocean modeling subgrid models are commonly used to approximate v and its effect on mechanical mixing frederiksen 2012 in subsurface transport applications the state of the art involves using stochastic lagrangian particle models benson and meerschaert 2009 leborgne et al 2008 bolster et al 2010 tartakovsky et al 2008 tartakovsky 2010 ding et al 2013 while some of these models accurately describe reactive transport experiments their discrete nature complicates analytical and numerical analysis e g parameters may require calibration and the lagrangian particle model results may be resolution dependent benson and meerschaert 2009 another approach is to use the adr model with empirical time dependent reaction rate coefficients sanchez vila et al 0000 porta et al 2012 or delayed diffusive mixing with a time dependent release rate ginn 2018 the main challenge in such models is parameterization of time dependent rates for transport with flow field and or boundary conditions e g solute injection rate that vary in time in lagrangian particle models tartakovsky et al 2008 tartakovsky 2010 herrera et al 2017 it is natural to model mechanical and diffusive mixing separately in these methods the mechanical mixing is produced by a random motion of computational particles and the diffusive mixing results from a mass exchange between particles here we propose the stochastic advection dispersion reaction sadr model that provides a similar separate treatment of the two mixing mechanisms but in the eulerian partial differential equation pde framework eulerian pde models have several advantages over lagrangian particle models the accuracy including error estimates and convergence rate of their numerical solutions is better understood and in some cases eulerian pdes admit analytical solutions while lagrangian particle models in general do not when available analytical solutions provide a deeper understanding of physical systems than their numerical counterparts and significantly simplify the model parameterization for example we obtain in this work the analytical solution of a special case of the sadr equations describing column experiments gramling et al 2002 with a bimolecular mixing controlled reaction we use this analytical solution to estimate the effective diffusion coefficient in the sadr model the rest of the parameters in the sadr model are the same as or can be directly obtained from the parameters in the corresponding adr model we also present an empirical approach for estimating the effective diffusion coefficient from the parameters in the adr model that does not rely on the results of reactive transport experiments we find a good agreement between the values of the effective diffusion coefficient obtained from the empirical relationship and fitting the analytical solution to the experimental data the adr model significantly overestimates the mass of the reaction product by as much as 60 in some cases in the column experiments reported in gramling et al 2002 it was also found in gramling et al 2002 that the concentration of the reaction product as a function of space has a smooth bell shape while the adr concentration has an unphysical kink at the point where the concentration reaches its maximum we find that the sadr model provides a much better fit to the experimental data albeit at the expense of introducing an extra parameter and produces the correct bell shape of the concentration distribution 2 stochastic advection diffusion reaction model in this section we present the sadr model which is an effective model that is defined on the scale l in the adr model 2 it is assumed that solutes are well mixed on the scale l this mixing is due to large scale velocity variations within the averaging volume and hydrodynamic dispersion the former stems from variations in pore size and complex pore geometry and the latter is the result of velocity variations within individual pores and molecular diffusion chemical reactions especially of the bimolecular type create large concentration gradients on scales much smaller than l which violates this assumption in the sadr model we assume that the solutes are fully mixed on the scale l that is much smaller than l furthermore we assume that the full mixing is a fickian process with the effective diffusion coefficient dm mechanical mixing in the sadr model is caused by random advection velocity the mean velocity is determined from the effective deterministic darcy flow equations the rigorous definition of l and l for nonlinear e g bimolecular reactive transport is non trivial and not pursued in this work we formulate the sadr model as the eulerian stochastic partial differential equation 3 t c i d m 2 c i v c i r i c 1 c n i 1 n here v v v is the random divergence free advective velocity with mean v and random fluctuations v the concentration of the ith species is given by the ensemble average of ci 4 c i x t a c i x t u p v u d u where a is the functional space of all possible realizations of v x t u a and pv u is the multipoint probability density function pdf of the random field v x t next we define the statistical distribution of v such that in the absence of chemical reactions i e r i c 1 c n 0 the average concentration is equaled to the darcy scale concentration c i x t c i x t the average velocity satisfies the darcy law v k θ h where k is the hydraulic conductivity h is the hydraulic head and θ is porosity and continuity equation k h 0 subject to the appropriate initial and boundary conditions random fluctuations v have a gaussian probability distribution function pv u and the covariance function v x t v y τ 2 d d ρ x y δ t τ here δ is the dirac delta function ρ is a correlation function e g an exponential or gaussian such that ρ 0 1 and d d and d m are the mechanical and effective diffusion tensors respectively which are defined later in appendix a we show that for the such defined statistical distribution of v and r i c 1 c n 0 the following conditions are satisfied d d d m d c i x t c i x t in two and three spatial dimensions and c i x t c i x t in one spatial dimension furthermore we postulate that the d d d m d relationship also holds for reactive transport in the following we demonstrate that for the nonlinear mixing controlled reaction a b y the dispersion model overestimates the concentration of the reaction product y i e y x t y x t we use data from the column reactive transport experiments of gramling et al 2002 to validate our model on the scale l these experiments can be described by the one dimensional version of eq 2 or 3 therefore the rest of this paper focuses on the one dimensional sadr equations 5 t c i d m x 2 c i v t x c i r i c 1 c n i 1 n the covariance function for one dimensional divergence free v is 6 v t v τ 2 d d δ t τ where dd is the mechanical dispersion coefficient and d m d d d here d is the longitudinal component of d that for example can be determined from a conservative tracer experiment bear 1988 3 application of the adr and sadr models to column experiments 3 1 column experiments in the following we compare predictions of the adr and sadr models with the experimental data of gramling et al 2002 and demonstrate that the sadr model is more accurate than the adr model for a wide range of peclet numbers p e v d d m where d is the average soil grain diameter and dm is the molecular diffusion constant a 36 cm long and 5 5 cm wide chamber filled with cryolite sand was used in the experiments of gramling et al 2002 the chamber was initially saturated with a solution containing edta 4 with a concentration of c 0 0 02 m in three different experiments the edta 4 solution was displaced with a solution containing 0 02 m of cuso4 with flow rates corresponding to p e 2 24 10 3 1 54 104 and 1 24 105 the instantaneous homogeneous irreversible reaction between the two solutes formed the reaction product cuedta 2 whose concentration was measured using a charge coupled device camera gramling et al 2002 fig 2 depicts the experimentally measured change of the total mass of cuedta 2 in the chamber with time and fig 3 shows distributions of the cuedta 2 concentration along the flow direction 3 2 modeling the experiments with the adr equations in gramling et al 2002 the evolution of the species concentrations in these experiments is described by the one dimensional adr model 2 7 t a d m x 2 a v x a k a b t b d m x 2 b v x b k a b t c d m x 2 c v x c k a b where a x t b x t and c x t are the concentrations of cuso4 edta 4 and cuedta 2 respectively and k is the reaction rate constant the domain was assumed to be semi infinite with the prescribed concentration boundary conditions bcs at x 0 8 a x 0 t c 0 b x 0 t 0 c x 0 t 0 and free outflow boundary conditions at x 9 x a x t x b x t x c x t 0 according to gramling et al 2002 the reaction rate in these experiments is k 2 3 10 9 m 1 s 1 and the time scale of the reaction is several orders of magnitude faster than the time scale of the shortest of these experiments therefore is was concluded that the reaction could be treated as instantaneous under the assumption of an instantaneous reaction an analytical solution for the reaction product concentration is gramling et al 2002 10 c x t c 0 2 erfc x v t 2 d t and the total mass of the reactive product per unit area is 11 m t c 0 1 c 0 0 c x t d x 2 d t π d t π exp v 2 t 4 d 1 2 v t erfc v t 2 d t for the ratio of advection length to the diffusion length greater than one v t d t 1 the expression for m t can be approximated as 12 m t c 0 2 d t π fig 2 displays mass m in grams as a function of the pore volume s measured in three experiments with different pe as reported in gramling et al 2002 fig 2 also shows m τ obtained from eq 12 as m s 2 d λ s π where the coefficient λ converts m t in the units of moles per cm2 and t in seconds to m and s as well as m s computed from eq 12 in gramling et al 2002 we were not able to estimate λ based on the information reported in gramling et al 2002 therefore we found λ by fitting the analytical solution 12 to the plots of this solution in gramling et al 2002 as λ 16 28 2 92 and 0 35 s g2 cm2 for p e 2 24 10 3 1 54 104 and 1 24 105 respectively fig 3 compares the analytical solution 10 and experimental measurements of c x t for the three pe both these figures show that the adr model overestimates the concentration and mass of the reaction product by more than 20 for all considered pe the values of v and d in eqs 10 and 12 were measured from conservative tracer experiments in gramling et al 2002 and are given in table 1 3 3 modeling the experiments with the sadr equations the sadr model for these experiments takes the form 13 t a d m x 2 a v t x a k a b t b d m x 2 b v t x b k a b t c d m x 2 c v t x c k a b the concentrations of the species are given by cuso 4 a edta 4 b and cuedta 2 c using the change of variables 14 y x 0 t v t d t x v t 0 t v t d t x v t γ t we rewrite these equations as 15 t a d m y 2 a k a b t b d m y 2 b k a b t c d m y 2 c k a b under the assumption of an instantaneous reaction these equations have an approximate analytical solution gramling et al 2002 which for the variable c in terms of the old coordinate x takes the form 16 c x t γ c 0 2 erfc x v t γ t 2 d m t here γ 0 t v t d t is a random variable given that v has the gaussian probability density with zero mean and the covariance given by eq 6 γ also has the gaussian probability density p γ with the variance 2ddt 17 p γ γ 1 4 π d d t exp γ 2 4 d d t where γ is a coordinate in the space of the random variable γ finally the reactive product concentration cuedta 2 is given by 18 c x t c x t γ p γ γ d γ and the mass of cuedta 2 per unit area is found as 19 m t c 0 1 c 0 0 c x t d x 2 d m t π d t π exp v 2 t 4 d 1 2 v t erfc v t 2 d t for t d v 2 this expression reduces to 20 m t c 0 2 d m t π eqs 19 and 20 are the main theoretical results of this work the comparison of these equations with eqs 11 and 12 reveals that 1 the mechanical mixing contributes to the reaction only at early times t d v 2 when the reaction front is located close to the boundary at x 0 2 at later times the reaction front moves away from the x 0 boundary and only d m d contributes to the reaction and 3 the reactive system never gets fully mixed as suggested by the advection dispersion model we note that while the only difference between eqs 20 and 12 is the coefficient dm in eq 20 and d in eq 12 it is not correct to say that the adr model with d d m can accurately model the experiments for example the adr model with d d m would incorrectly estimate concentrations cuso 4 cuedta 2 and edta 4 cuedta 2 and therefore predict incorrect concentrations cuso4 and edta 4 in the following we demonstrate that the sadr model results in a smooth shape of cuedta 2 as a function of x while the adr model predicts the shape of cuedta 2 with an unphysical kink where the concentration reaches its maximum we find dm by fitting eq 20 to the reactive product mass obtained from experiments see fig 2 and report these values in table 1 next we validate the model by computing the average concentration from eq 18 and comparing it with the concentration found from the experiment fig 3 shows that the concentration found from the sadr equations agrees with the experimental values for all considered pe while the dispersion model eq 10 overestimates the maximum concentration by as much as 60 also the adr concentrations have an unphysical kink at the point where the concentrations reach their maxima while both the experimental and sadr model concentrations have smooth bell shaped profiles in ginn 2018 the adr model was modified to better match the experimental data by introducing mobile to mobile phase mass transfer with a time dependent mass transfer rate but the resulting concentration profiles still had unphysical kinks it is important to reiterate that solutions 19 and 20 are obtained from the one dimensional sadr model which disregards the effects of transverse mechanical and diffusive mixing processes on reactive transport the results in figs 2 and 3 demonstrate that the one dimensional sadr model accurately describes these experiments therefore at the time scale of the considered experiments the contributions of transverse mechanical and diffusive mixing to m t are not significant these experiments were conducted for t 1732 233 and 29 s for p e 2 24 10 3 1 54 104 and 1 24 105 respectively in all these experiments t is smaller than the diffusion time τ d 2 d m 24142 9 s and the effective diffusion time τ e f f w 2 d m 25208 2750 and 263 s for p e 2 24 10 3 1 54 104 and 1 24 105 respectively where w is the flow cell width for t τ and or t τeff the effect of transverse mixing can be more pronounced and the solution of the two and three dimensional sadr models for m t might deviate from the one dimensional solutions 19 and 20 finally we want to mention the multiple scale expansion analysis of the adr equation for reactive transport with nonlinear heterogeneous reactions in terms of pe and damkohler da numbers in battiato and tartakovsky 2011 da describes the ratio of reaction time to diffusion time and is equal to infinity under the assumption of an instantaneous reaction as is the case in the considered experiments according to battiato and tartakovsky 2011 the sufficient conditions for adrs to approximate the pore scale equations with error ϵ 1 include p e 1 ϵ 2 da pe ϵ and da ϵ the physical explanation for this conclusion is that under the above conditions there is no guarantee that the solutes get fully mixed on the rev scale one implication of this analysis is that the adr equation with d a 0 provides an accurate approximation of subsurface transport but only if t is sufficiently large e g in aris taylor analysis of dispersion in a pipe t should be greater than 3τ for the dispersion model to become accurate aris 1956 on the other hand for da 1 there is no guarantee that the adr model will provide an accurate approximation of the pore scale adr equations with a heterogeneous reaction for any t even though the analysis in battiato and tartakovsky 2011 does not directly apply to the reactive transport with the homogeneous bimolecular reaction considered here there is no reason to conclude that the adr model 7 is an accurate approximation for the system even for t much larger than τ and τeff this is because the very fast instantaneous bimolecular reaction violates the conditions with respect to da and prevents the solutes from becoming fully mixed at the rev scale 4 empirical parameterization of the sadr model finally we propose an empirical approach to estimate dm and dd for cases when these coefficients cannot be readily obtained from reactive transport experiments as described in section 3 3 we assume that the dispersion coefficient as a function of pe is available from a conservative transport experiment and follows the empirical relationship coelho et al 1997 21 d d m α p e 1 β where dm is the molecular diffusion coefficient and 0 α 0 5 and 0 β 0 5 are known experimentally determined constants expanding eq 21 in a taylor series in powers of β yields 22 d d m α p e 1 β log p e β 2 log p e 2 2 o β 3 only the zero order in β term in eq 22 is independent of molecular diffusion and therefore contributes to the mechanical dispersion therefore we define dd and dm as 23 d d d m α p e and 24 d m d d d in the following we refer to the dm and dd coefficients computed from eqs 23 and 24 as the first order coefficients to demonstrate the accuracy of the proposed sadr model parameterization we use eqs 21 24 to compute the first order dm and dd coefficients for the considered experiments for these experiments dm d and pe values are listed in table 1 as reported in gramling et al 2002 the parameters α 0 34 and β 0 14 are found by fitting eq 21 to d as a function of pe see fig 4 then the values of the first order dm and dd coefficients are computed from eqs 23 and 24 and are given in table 1 in eq 22 we truncated the taylor expansion at the 5th order in β that resulted in a truncation error of less than 1 fig 5 shows the first order dm and dm obtained by fitting eq 20 to the experimental m t data we see that eq 23 gives a good estimate of dm especially for smaller pe fig 5 also reveals that dm scales as peξ where ξ 1 β in three dimensional problems eqs 21 24 can be used to define both longitudinal and transverse components of the dispersion mechanical dispersion and effective diffusion tensors the coefficients α and β are different for the longitudinal and transverse tensor components and could be determined from conservative tracer experiments 5 discussion and conclusions we proposed an eulerian pde sadr model for multicomponent reactive transport in porous media and obtained a one dimensional analytical solution for the boundary and initial conditions reported in gramling et al 2002 using the experimental data of gramling et al 2002 we demonstrated that the one dimensional sadr model is more accurate than the classical adr model with a constant reaction rate coefficient specifically the adr model significantly overestimates the mass of the reaction product by as much as 60 in some cases measured in the column experiments of gramling et al 2002 it was also found in gramling et al 2002 that the concentration of the reaction product as a function of space has a smooth bell shape while the adr concentration has an unphysical kink at the point where the concentration reaches its maximum we found that the sadr model provides a much better fit to the experimental data and produces the correct bell shape of the spatial concentration distribution the sadr model considers purely mechanical and diffusive mixing as two separate processes characterized by the mechanical dd and effective diffusing dm coefficients respectively the sum of these two coefficients equals the dispersion coefficient in the adr model d d d d m in three dimensional problems all these coefficients are tensors while separate treatment of mechanical and diffusive mixing have been used in some lagrangian particle models to the best of our knowledge sadr is the first model that provides such treatment in the eulerian pde framework the sadr model predicts that in the column experiments of gramling et al 2002 only the effective diffusion coefficient contributes to the reaction as opposed to the dispersion coefficient in the adr model which is the reason why the adr model overestimates the mass of the reaction product the sadr model has only one additional independent parameter dm compared to the adr model we presented two approaches for estimating dm in the first approach dm was found by fitting the analytical solution of the one dimensional sadr equation to the experimental data in gramling et al 2002 in the second approach dm was estimated from the parameters in the adr model dm and d as a function of pe all these parameters can be estimated from conservative tracer tests we observed good agreement between dm values obtained from the two approaches the important feature of the sadr model is that it uses the same description of reactions as the standard adr model and constant reaction rate coefficients which can be determined in batch experiments this is different from the adr models with time dependent reaction and or mass transfer rate coefficients which depend on initial and boundary conditions and are hard to estimate a priory the concept of separating mechanical mixing and diffusive mixing is not limited to transport in porous media and the sadr model can be extended to other fields credit authorship contribution statement alexandre m tartakovsky conceptualization methodology software formal analysis validation investigation writing original draft project administration funding acquisition david barajas solano investigation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the advanced scientific computing research program of the u s department of energy doe office of science pacific northwest national laboratory is operated by battelle for the doe under contract de ac05 76rl01830 appendix a derivation of equations for c consider the stochastic partial differential equation a 1 t c d m 2 c v c where v v v is the random divergence free advective velocity v 0 with mean v v v is the average pore velocity and random fluctuations v a 2 v x t v y τ 2 d d ρ x y δ t τ here δ x y is the dirac delta function ρ x y is the correlation function ρ 0 1 and d d and d m are the mechanical and effective diffusion tensors respectively the darcy scale concentration c x t is given by the ensemble average of c in this appendix we show that c x t c x t where c x t is the concentration satisfying the standard darcy scale advection dispersion equation a 3 t c d 2 c v c and that the dispersion coefficient is given by d d d d m there are several ways to obtain a pde for ci x t including the eulerian eddy diffusivity and macrodispersion theories see for example kraichnan 1987 mccomb 1990 neuman 1993 here we are following derivations as presented in jarman and tartakovsky 2013 writing c x t in eq a 1 as c x t c x t c x t and taking the ensemble average of eq a 1 yields a 4 t c d m 2 c v c v c defining green s function g x t y s g x t y s g x t y s as the solution of the equation a 5 t g d m 2 g v g δ x y δ t s subject to the appropriate homogeneous boundary conditions the exact expression for v c is a 6 v c 0 t ω v x t v y s t g x t y s y c y s d y d s 0 t ω v x t g x t y s v y s t y c y s d y d s 0 t ω v x t g x t y s y v y s t c y s d y d s assuming that g and v are jointly gaussian eq a 7 reduces to zhang 1995 a 7 v c 0 t ω v x t v y s t g x t y s y c y s d y d s assuming that c y s varies slowly relative to v yields a 8 v c 0 t ω v x t v y s t g x t y s d y d s c x t next we define the macro dispersion coefficient a 9 d m d 0 t ω v x t v y s t g x t y s d y d s then the equation for c takes the form a 10 t c d m d m d 2 c v c noting that v v to prove that c x t c x t and d d d d m it only remains to show that d m d d d we will prove this for an advection dispersion problem defined on an infinite three dimensional domain with an instantaneous source located at the point 0 0 0 and the average velocity v v 0 0 t green s function for this problem is a 11 g x t y s 1 4 π d m t s 3 2 exp x 1 y 1 v t s 2 x 2 y 2 2 x 3 y 3 2 4 d m t s note that a 12 0 t δ t s g x t y s d s 1 2 δ x y substituting eqs a 2 and a 11 into the left hand side of eq a 9 and using eq a 12 yields a 13 d m d d d ω ρ x y δ x y d y d d finally we note that in three spatial dimensions and as a result of the approximation in eq a 8 c c the accuracy of this approximation was extensively studied in jarman and tartakovsky 2013 and references therein in one spatial dimension it was proven in jarman and tartakovsky 2013 that c c 
402,an analytical model is proposed in this study to describe transient drawdown induced by non darcian flow in a confined aquifer with a single well circulation groundwater heat pump system the izbash equation and a linearization method are employed to describe non darcian flow in the horizontal direction of a confined aquifer and to approximate the nonlinear term in the governing equation respectively by applying a combination of the laplace and fourier cosine transforms an approximate analytical solution in the laplace domain is obtained which is numerically inverted to obtain transient drawdown in the time domain using the stehfest algorithm method the results of the derived analytical solution for the special case of darcian flow m 1 correspond well with the existing solution derived using darcy s law the steady state analytical solution in the time domain is obtained by applying the fourier cosine transform moreover the sensitivity analysis is performed to investigate the influence of selected parameters such as the power index m the radial hydraulic conductivity kr the aquifer specific storage s and the length of the sealed section d2 on drawdown the results show that each parameter has its influence period on drawdown and that drawdown is more sensitive to the power index m compared to other parameters keywords izbash equation linearization method non darcian flow geothermal energy groundwater heat pump system 1 introduction it is well known that darcy s law which defines a linear relationship between the fluid flux and the hydraulic gradient has been commonly used to address groundwater flow problems in practical engineering applications however the fluid flow becomes non darcian when the fluid flux is smaller or larger than a specific flux interval wilkinson 1955 slepicka 1961 bear 1972 zoorabadi et al 2015 zhou et al 2015 when the relationship between the fluid flux and the hydraulic gradient deviates from classical darcy s law the flow becomes non darcian under these circumstances researchers point out that darcy s law is not sufficient to describe groundwater flow miller and low 1963 bear 1972 barker and herbert 1977 sen 1985 a variety of equations has been derived to characterize the relationship between the fluid flux and the hydraulic gradient for non darcian flow forchheimer 1901 izbash 1931 muskat 1938 rose 1951 escande 1953 generally these equations can be divided into two categories power functions and polynomial functions wen et al 2013 the first category assumes that the fluid flux is a power function of the hydraulic gradient while the second category states that the fluid flux can be described as a second order polynomial function of the hydraulic gradient among equations of these two categories the forchheimer and izbash equations are widely applied to describe non darcian flow e g sen 1989 sen 1990 wen et al 2008a b moutsopoulos et al 2009 mathias and todman 2010 yeh and chang 2013 sedghi asl et al 2014 chen et al 2015 houben 2015 until now a variety of approximate or semi analytical solutions for non darcian flow toward a fully or partially penetrating well has been derived for these two equations for instance sen 1989 1990 presented an analytical solution which takes into account the non darcian flow described using the forchheimer law toward an infinitesimal well or a large diameter well an approximate analytical solution considering the effect of non darcian flow which is defined by the forchheimer equation was derived by wu 2002 moutsopoulos and tsihrintzis 2005 presented an approximate analytical solution for nonlinear flow through porous media described using the forchheimer equation another approximate solution for forchheimer s flow toward a well is presented by mathias et al 2008 applying the izbash equation sen 2000 provided an analytical solution for transient drawdown for non darcian flow to a fully penetrating well in a confined aquifer later based on the izbash equation many efforts have been made by wen et al 2008 to develop analytical solutions describing non darcian flow towards a fully penetrating well they presented several approximate analytical solutions in the laplace domain considering the effect of wellbore storage and a well radius in different aquifer systems furthermore for non darcian flow toward a partially penetrating well wen et al 2013 presented a semi analytical solution in the laplace domain while neglecting the effect of the well radius they also investigated non darcian flow toward a larger diameter partially penetrating well in a confined aquifer wen et al 2014 an analytical solution describing non darcian flow to a partially penetrating well in a confined aquifer while considering the effect of a finite thickness skin was presented by feng and wen 2016 in addition to analytical solutions numerical solutions for non darcian flow toward wells have also been developed wu 2002 employed the finite difference method to solve non darcian flow described using the forchheimer equation through a fractured reservoir based on the assumption that the forchheimer equation can describe non darcian flow mathias et al 2008 investigated flow toward a fully penetrating well in a confined aquifer using the numerical model based on the finite difference method wen et al 2009 developed a similar numerical model using the finite difference method and the assumption that the izbash equation can be employed to describe the non darcian flow finally mathias and wen 2015 performed a numerical simulation of non darcian flow in leaky aquifers using the forchheimer equation a special well structure referred to as a single well circulation system fig 1 is commonly applied in practical engineering applications in a single well circulation system a single borehole is divided into two partially penetrating wells by well packers as shown in figs 1 and 2 which are used to block water injected in the injection well to flow to the pumping well the lower partially penetrating well is a pumping well with the pumping rate q and the upper partially penetrating well is an injection well for injecting water at the same rate q thus the single well circulation system can be considered as a combination of two partially penetrating wells to the best of our knowledge little research work has been done on groundwater flow in a single well circulation system ni et al 2011 presented an analytical solution describing the transient drawdown of groundwater induced by the operation of a single well circulation groundwater heat pump system subsequently tu et al 2019 and tu et al 2020 developed an analytical solution describing the transient drawdown distribution and obtained a steady state analytical solution in the time domain using the laplace transform it should be pointed out that these studies on groundwater flow in a single well circulation system are based on the assumption of darcian flow however because of very high hydraulic gradients and enhanced flow velocities due to the convergence of flow lines mathias et al 2008 yeh and chang 2013 a considerable number of researchers assumed that the flow in coarse grained and fractured media near the wells likely becomes non darcian the non darcian flow may also occur due to high fluxes near the wells especially when the pumping injection rates are relatively large wan et al 2013 wen et al 2013 wen et al 2014 feng and wen 2016 however the research on groundwater flow in a single well circulation system has so far been based on the assumption of the validity of darcy s law which may not be adequate to describe the groundwater flow in such a system practical engineering implementations of single well circulation groundwater heat pump systems require favorable aquifer conditions which allow water flow at relatively high velocities to continuously provide a significant amount of water the hydraulic conductivity of such aquifers should be at least 10 3m s or higher wu et al 2015 rybach 2015 besides relatively large pumping rates usually about 50 100 m3 h rybach 2015 are designed to meet the enormous energy demand therefore the flow near the wells in a confined aquifer with a single well circulation system is particularly prone to become non darcian as a result of high flow velocities and hydraulic gradients to the best of our knowledge most studies on non darcian flow have focused on systems with fully or partially penetrating wells e g wu 2002 mathias et al 2008 wen et al 2008 yeh and chang 2013 wen et al 2013 mathias and wen et al 2015 feng and wen 2016 while no analytical model has so far considered non darcian flow in a single well circulation system it is therefore necessary to develop a new analytical model for investigating the effects of non darcian flow in a confined aquifer with a single well circulation system this will help in improving our understanding of the complex groundwater flow regime in single well circulation systems which can be very beneficial for future investigations of heat convection in such systems the aim of this study is to extend the analytical solution based on darcy s law to non darcian flow conditions and to investigate the effects of non darcian flow in a confined aquifer with a single well circulation system this could have theoretical significance for the applications of single well circulation groundwater heat pump systems due to relatively high pumping rates and large hydraulic conductivities in single well circulation systems the horizontal flow velocity is usually very high and non darcian flow near the wells likely occurs the flow in the horizontal direction is therefore assumed to be non darcian on the other hand the flow velocity in the vertical direction is relatively small compared with the horizontal flow velocity in order to make the analytical model tractable the flow in the vertical direction is assumed to be darcian such assumptions have been often adopted when dealing with non darcian flow problems and when the flow velocity in the vertical direction is considered wen et al 2013 wen et al 2014 feng and wen 2016 the izbash equation is used to describe non darcian flow and a linearization approximation method proposed by wen et al 2008 is employed to solve the nonlinear term in the governing equation this latter method has been shown to address this nonlinear problem efficiently the approximate analytical solution in the laplace domain is obtained by applying the laplace and fourier cosine transforms the steady state solution in the time domain is also developed using the linearization approximation method and the fourier cosine transform moreover sensitivity analysis is performed to investigate the influence of different parameters on drawdown 2 mathematical model 2 1 model setup fig 2 presents a schematic diagram that describes groundwater flow in a confined aquifer with a single well circulation system non darcian flow is likely to occur because of the high flow velocity in the horizontal direction near the well especially for a relatively large pumping rate in this case non darcian flow near the well needs to be considered due to a unique well structure the flow in the vertical direction which is assumed to be darcian cannot be neglected additional assumptions for this model are made 1 the confined aquifer is treated as homogeneous and anisotropic with a uniform thickness d and infinite in the horizontal direction 2 the underlying and overlying layers of the confined aquifer are both impermeable 3 the specific discharge qr in the horizontal direction is assumed to be constant along the screen the same assumption as in wen et al 2013 4 the pumping and injection rates q positive and negative values denote pumping and injection respectively are constant and 5 the well radius rw is infinitesimally small and can be neglected based on the above descriptions and assumptions the governing equation for the mathematical model can be written as follows 1 q r r q r r q z z s s r z t t where t is time t rand z represent the radial and vertical coordinates respectively l s refers to the specific storage of an aquifer l 1 qr and qz denote the horizontal and vertical fluid fluxes respectively lt 1 and s is groundwater drawdown l before the system starts functioning groundwater drawdown is assumed to be zero and the initial conditions for the system can be described as 2 s r z 0 0 the boundary conditions at infinity in the horizontal direction r and the bottom and top of a confined aquifer z 0 and z d are given as follows respectively 3 s z t 0 and 4 s r 0 t z 0 and 5 s r d t z 0 where d is the thickness of a confined aquifer l with the assumption that the wellbore storage is neglected the boundary conditions near the well can be expressed as 6 lim r 0 r q r q 2 π d 1 0 z d 1 0 d 1 z d 1 d 2 q 2 π d 3 d 1 d 2 z d where the pumping and injection rate q positive for pumping and negative for injection are the same and constant l3t 1 d 1 d 2 and d 3 denote the lengths of well screens for pumping sealed and injection wells respectively l izbash 1931 presented a power law relationship between the hydraulic gradient and water flux which can be employed to describe the non darcian flow in this model the horizontal specific discharge described by the izbash equation for two dimensional flow same as in wen et al 2013 can be given as 7 q r q r m 1 k r s r z t r where kr is the quasi wen et al 2006 radial hydraulic conductivity and the non darcian exponent m in the izbash s equation is an empirical coefficient that ranges between 1 and 2 and denotes the degree of deviation from linearity izbash 1931 bordier and zimmer 2000 when m 1 the flow is treated as pre linear flow and when 1 m 2 the flow becomes post linear flow izbash 1931 wen et al 2006 it should be pointed out that eq 7 reduces to darcy s law when m 1 due to various factors such as shapes and arrangements of pores and complex flow paths the non darcian exponent m varies in space and time bordier and zimmer 2000 wen et al 2006 it is thus quite difficult to determine and quantify its value in practical engineering applications although some researchers soni et al 1978 watanable 1982 chen et al 2015 have attempted to determine the value of the non darcian exponent m this issue has not yet been well resolved in order to make the proposed models tractable the non darcian exponent m is often assumed to be constant when dealing with non darcian flow problems e g sen 2000 wen et al 2006 2008 quinn et al 2011 2013 wen et al 2013 liu et al 2016 however adopting a constant non darcian exponent m in the izbash s equation imposes some limitations when describing the non darcian flow to overcome these limitations still remains an open issue and a very interesting topic for future investigations the flow in the vertical direction is assumed to be darcian which is described as 8 q z k z s r z t z where kz represents the vertical hydraulic conductivity since the flow in the horizontal direction is against the direction of the r coordinate the specific discharge qr is always negative thus eq 7 can be furtherly reduced as 9 q r m k r s r z t r 2 2 approximate analytical solution the governing equation of the mathematical model is obtained by substituting eqs 8 and 9 into eq 1 10 k r m q r m 1 2 s r z t r 2 k r r q r m 1 s r z t r k z 2 s r z t z 2 s s r z t t it is noteworthy that eq 10 is a nonlinear equation due to the nonlinear term qr m 1 solving such a nonlinear equation may not be tractable using rigorous mathematical means however a linearization approximation method proposed by wen et al 2008 may be used to address this problem this method has been successfully applied to find analytical solutions for other non darcian problems e g wen et al 2008 wen et al 2013 feng and wen 2016 by applying the linearization approximation method the nonlinear term can be approximately described as 11 q r m 1 q 2 π r d m 1 substituting eq 11 into eq 10 one can obtain 12 2 s r z t r 2 m r s r z t r m k z k r q 2 π r d m 1 2 s r z t z 2 m s k r q 2 π r d m 1 s r z t t eq 12 is a linear partial differential equation which can be solved using the laplace and fourier cosine transforms a detailed derivation of the solution of this partial differential equation can be seen in appendix a an approximate analytical solution of non darcian flow for the drawdown in the laplace domain is given as 13 s r z p 2 α 3 m 2 3 m q 2 π d 1 m d 1 q 2 π d 3 m d 3 p d k r α γ 2 3 m r 1 m 2 k 1 m 3 m 2 α 3 m r 3 m 2 n 1 4 φ 3 m 2 3 m q 2 π d 1 m s i n n π d 1 d q 2 π d 3 m s i n n π d 1 d 2 d n π p k r φ γ 2 3 m r 1 m 2 k 1 m 3 m 2 φ 3 m r 3 m 2 c o s n π z d where φ m k z n 2 π 2 m p s d 2 k r d 2 q 2 π d m 1 α m p s k r q 2 π d m 1 s is the solution of drawdown in the laplace domain γ denotes the gamma function k ν represents the modified bessel function of the second kind with an order of ν and n and p are the fourier and laplace variables respectively due to the presence of the bessel function k ν term it may not be possible to obtain the analytical solution of eq 13 in the time domain however several numerical inverse methods e g stehfest 1970a b crump 1976 de hoog et al 1982 can be employed to transform the analytical solution in the laplace domain to the time domain in this work an inverse laplace transform is numerically conducted using the stehfest method which has been shown to address such inverse problems efficiently and accurately wen et al 2008 a program has been developed in matlab to calculate the solution for drawdown in the time domain based on the stehfest method the number of terms n which are used in the inversion needs to be specified before performing it multiple numerical studies have shown that the solution gives accurate and stable results with n 18 similarly the infinite series of eq 13 converges when n 20 therefore to increase computational efficiency n 18 and n 20 are employed in the following calculations 2 3 an analytical solution at a steady state when the operation time of the system is long enough the changes in drawdown near wells become stable and the flow reaches steady state conditions in this case s r z t t 0 and eq 12 becomes 14 2 s r z r 2 m r s r z r m k z k r q 2 π r d m 1 2 s r z z 2 0 for this linear partial differential equation the analytical solution at a steady state in the time domain is obtained by applying the fourier cosine transform see appendix b 15 r z q 2 π d 1 m d 1 q 2 π d 3 m d 3 d k r γ 2 3 m 3 m r 1 m n 1 4 ω 3 m 2 3 m q 2 π d 1 m s i n n π d 1 d q 2 π d 3 m s i n n π d 1 d 2 d n π k r ω γ 2 3 m r 1 m 2 k 1 m 3 m 2 ω 3 m r 3 m 2 cos n π z d where ω m k z k r n 2 π 2 d 2 q 2 π d m 1 and s is the drawdown in the time domain 2 4 simplification of the analytical solution when m 1 the flow becomes darcian flow and the analytical solution of eq 13 is as follows 16 s r z p n 1 q np k r π 2 sin n π d 1 d d 1 sin n π d 1 d 2 d d 3 k 0 β r cos n π z d where β k z k r n 2 π 2 d 2 p s k r and k 0 is the modified bessel function of the second kind with an order of zero the eq 16 is the same as the analytical solution derived by tu et al 2020 for darcian flow in a confined aquifer with a single well circulation system 3 results and discussion 3 1 drawdown versus time as a function of the power index the influence of the power index m from 1 to 2 on drawdown observed at r 5 m and z 15 m is analyzed first when q 60 m3 h d 40 m d1 15 m d2 10 m d3 15 m s 0 0001 m 1 kr 0 1 m h m and kz 0 01 m h for the case of m 1 darcian flow it can be observed in fig 3 that the drawdown calculated using the new analytical solution matches well the results of the analytical solution of ni et al 2011 the results in fig 3 indicate that the power index influences drawdown during the entire pumping period a larger value of the power index results in larger drawdown at the beginning and smaller drawdown at later times fig 3 a similar influence can also be found in wen et al 2013 a larger power index in the izbash equation indicates more significant deviations from darcian flow and results in greater flow turbulence at early times the elastic release process of an aquifer may be accelerated for a larger power index consequently larger drawdown is observed at early times for a larger power index as pumping time increases drawdowns for different power indices approach a steady state when t 10 h indicating that the process of elastic release of an aquifer is approximately complete meanwhile pumped water comes mainly from the region relatively far away from the pumping well larger flow turbulence induced by a larger power index is likely to result in larger recharge therefore it can be seen that drawdown is smaller for a larger power index at late times moreover fig 3 also indicates that drawdown reaches a steady state more quickly when the power index is larger 3 2 drawdown versus time as a function of the radial hydraulic conductivity fig 4 depicts temporal drawdown distribution curves observed at r 5 m and z 15 m for different radial hydraulic conductivities kr from 0 01 to 0 1 m h other parameters are as follows q 60 m3 h m 1 5 d 40 m d1 15 m d2 10 m d3 15 m s 0 0001 m 1 and kz 0 01 m h it is interesting to note that the influence of the radial hydraulic conductivity on drawdown is similar to that of the power index as indicated in fig 4 drawdown increases with the radial hydraulic conductivity at the beginning while smaller drawdown is obtained for larger radial hydraulic conductivities at late times the reasons for this phenomenon can be explained as follows at early times larger hydraulic conductivities induce faster groundwater flow due to the faster spreading of the suction zone in the depression cone groundwater can be replenished promptly consequently larger drawdown for a larger hydraulic conductivity at early times can be found at late times when the flow reaches a quasi steady state recharge occurs from areas relatively far away from the well smaller hydraulic conductivities will then result in a larger influence range of the depression cone and larger drawdown additionally it is worth noting that drawdown approaches a steady state more quickly with increasing radial hydraulic conductivities fig 4 3 3 drawdown versus time as a function of the aquifer specific storage the curves in fig 5 show the temporal drawdown distributions observed at r 5 m and z 15 m calculated using the aquifer specific storage s from 0 0001 to 0 001 m 1 the other parameters used to calculate the curves in the figure are as follows q 60 m3 h m 1 5 d 40 m d1 15 m d2 10 m d3 15 m kr 0 1 m h m and kz 0 01 m h it is demonstrated in fig 5 that drawdown is smaller for a larger aquifer specific storage and vice versa at early times a larger aquifer specific storage indicates that the aquifer can release more groundwater when other conditions remain the same moreover at late times t 1 h when the process of the storage release from the aquifer is almost complete drawdown curves merge for different aquifer specific storages fig 5 drawdowns approach a steady state at late times and the influence of different aquifer specific storages on drawdown is negligible 3 4 drawdown versus time as a function of the size of the sealed section fig 6 shows drawdowns versus time observed at r 5 m and z 15 m for different lengths of the sealed section d2 from 6 to 14 m in this case the thickness of the aquifer is kept constant and the lengths of well screens for pumping and injection wells d1 and d3 respectively are correspondingly adjusted when the length of the sealed section changes other parameters used in this case are q 60 m3 h m 1 5 s 0 0001 m 1 kr 0 1 m h m and kz 0 01 m h the curves shown in fig 6 indicate that changes in drawdown are significant when the length of the sealed section is reduced from 14 to 8 m also larger lengths of the sealed section result in smaller drawdowns since the aquifer thickness and the pumping rate remain constant the borehole with a longer length of the sealed section has a shorter length of the pumping screen and a correspondingly larger pumping rate for a unit length of the well screen it is thus not surprising that larger drawdowns are obtained for shorter lengths of the sealed section however the influence of the further reduction in the length of the sealed section from 8 to 6 m on drawdown is almost imperceptible also differences in drawdown are smaller for smaller lengths of the sealed section e g from 6 to 10 m than for larger lengths of the sealed section moreover when t 1 h drawdowns approach a steady state and the curves are parallel 3 5 drawdown versus distance as a function of the pumping time it is also important to analyze drawdown versus the radial distance for different pumping times for t 0 1 1 10 h and at a steady state the other parameters are as follows q 60 m3 h m 1 5 d 40 m d1 15 m d2 10 m d3 15 m s 0 0001 m 1 kr 0 1 m h m and kz 0 01 m h the steady state analytical solution eq 15 is employed in this figure as a reference it can be observed in fig 7 that drawdown curves merge for different pumping times when the radial distance r 1 m indicating that groundwater flow in the area around the pumping well reaches a steady state quickly for the region further away from the well r 1 m drawdown curves start deviating from each other this is because the flow in this region is still unsteady and will take longer to reach a steady state moreover drawdown at t 10 h is very close to that at a steady state which means that groundwater flow in a confined aquifer for a single well circulation system approaches a steady state relatively quickly 3 6 drawdown versus distance as a function of the power index temporal drawdown distribution curves versus a radial distance for different values of the power index m from 1 to 2 are shown in fig 8 the other parameters used in this figure are the same as before i e q 60 m3 h d 40 m d1 15 m d2 10 m d3 15 m t 10 h s 0 0001 m 1 kr 0 1 m h m and kz 0 01 m h it can be observed in fig 8 that a smaller value of the power index results in a larger drawdown for r 100 m however at larger radial distances drawdown for smaller values of the power index is smaller than for its larger values this is consistent with the results in fig 3 implying that flow near the pumping well reached a steady state when the pumping time t 10 h while a steady state was not reached in the area far away from the pumping well fig 8 3 7 drawdown contours at a steady state drawdown contours displayed in fig 9 are obtained using the analytical solution of eq 15 for steady state conditions the following parameters are used in this scenario q 60 m3 h m 1 5 d 40 m d1 15 m d2 10 m d3 15 m s 0 0001 m 1 kr 0 1 m h m and kz 0 01 m h as shown in fig 7 changes in drawdown are very large for small r less than 0 5 m causing contours to be too dense to be displayed in fig 9 therefore the starting point on a horizontal axis in fig 9 is at r 0 5 m due to flow symmetry contours for steady state drawdown are symmetric along a horizontal line at z 20 m the middle of a confined aquifer where drawdown is equal to zero fig 9 and vary tremendously along the well axis when a single well circulation system functions properly pressure differences between the injection zone and the suction zone will yield relatively large hydraulic gradients near the wells thus drawdown contours near the borehole are much denser than further away from the pumping or injection wells 3 8 sensitivity analysis the global sensitivity analysis is an effective method that can be employed to analyze the sensitivity of the model output to changes in each input parameter saltelli et al 2000 in particular the sobol s indices have been widely employed as sensitivity measures in many applications involving hydrological van werkhoven et al 2009 ciriello and di federico 2012 di federico and ciriello 2012 brunetti et al 2016 and environmental nossent et al 2011 pianosi et al 2015 models this is because no assumptions of linearity or monotonicity are required for the adopted interpretative model sobol 1993 archer et al 1997 these indices can provide accurate information about the model output variance related to a single parameter or associated with interactions of multiple parameters a more detailed description of the sobol method can be found in sobol 2001 according to the definition given by sobol 1993 the sobol sensitivity indices can be expressed as the ratio of the partial model variance to the total model variance 17 first order s i v i v 18 second order s i j v i j v where vi represents the partial variance of the model associated with the ith parameter vij represents the partial variance of the model associated with the interaction of the ith and jth parameters and v is the total variance the first order or principal sensitivity indices si called the main effect indices are used to describe contributions of a single parameter to the total variance of the model output the influence of the interaction of two input parameters on the model output variance is denoted as the second order index sij the total sensitivity indices s t i ciriello and di federico 2012 represent the main effect of a given parameter the ith parameter and all its interactions with other parameters up to the kth order k denotes the number of input parameters which can be expressed as follows 19 total s t i s i j i s i j the evaluation of sensitivity indices is performed for the following parameters the power index m the radial hydraulic conductivity kr the aquifer specific storage s and the length of the sealed section d2 table 1 shows the range of all evaluated parameters other conditions used when conducting the global sensitivity analysis are as follows q 60 m3 h d 40 m d1 d 3 40 d2 2 and kz 0 01 m h fig 10 presents temporal changes in total sensitivity indices for selected input parameters it can be seen that two parameters show a significant influence on the model output variance these are the power index m and the radial hydraulic conductivity kr the total sensitivity index for the power index m is initially small then increases with time reaches a peak value near t 20 h and then remains constant with time the radial hydraulic conductivity kr shows a similar trend as the power index m except that it has a lower peak value when reaching a steady state the total sensitivity index for the specific storage s has initially a very high value then sharply decreases until near t 10 h and then gradually drops to almost zero after t 40 h this indicates that the specific storage s has a negligible influence on the model output finally the overall behavior of the total sensitivity index for the length of the sealed section d2 is remarkably similar to that of the specific storage s except that the total sensitivity indices reach a constant minimum value after large time which is much larger compared with that for the specific storage s 4 conclusions in this work an analytical model has been developed to describe non darcian flow in a confined aquifer with a sing well circulation system non darcian flow in the horizontal direction is described using the izbash equation and a linearization approach presented by wen et al 2008 is employed to approximate the nonlinear term in the governing equation then using the laplace and fourier cosine transforms the analytical solution in the laplace domain is obtained which is numerically inverted into the time domain using the stehfest method the main findings from this work can be drawn as follows 1 larger values of the power index m and the radial hydraulic conductivity kr result in larger drawdown at early times and smaller drawdown at late times groundwater flow approaches a steady state faster for larger values of the power index m and the radial hydraulic conductivity kr 2 larger values of the aquifer specific storage s result in smaller drawdown while the influence of s on drawdown is negligible at late times 3 smaller lengths of the sealed section d2 result in larger drawdown however a further reduction in the length of the sealed section d2 below a certain critical length leads to imperceptible changes in drawdown 4 the contours for steady state drawdown vary significantly along the well axis and are symmetric around a horizontal line in the middle between the injection and suction sections z 20 m in our example where drawdown is equal to zero 5 each parameter has its influence period on drawdown drawdown is the most sensitive to the length of the sealed section d2 and the aquifer specific storage s at early times and the power index m in particular and the radial hydraulic conductivity kr at late times credit authorship contribution statement kun tu conceptualization methodology writing original draft software qiang wu supervision project administration funding acquisition jirka simunek supervision resources writing review editing ke zhu methodology software chaofan chen conceptualization formal analysis weiyu zheng software formal analysis yifan zeng conceptualization investigation shengheng xu formal analysis declaration of competing interest we declare that we have no financial and personal relationships with other people or organizations that can inappropriately influence our work there is no professional or other personal interest of any nature or kind in any product service and or company that could be construed as influencing the position presented in or the review of the manuscript entitled an approximate analytical solution for non darcian flow in a confined aquifer with a single well circulation groundwater heat pump system acknowledgments the authors gratefully acknowledge the financial support from the key program of the national natural science foundation of china grant no 41430318 the national scientific and technical support program of china grant no 2016yfc0801801 the national natural science foundation of china grant no 41572222 41602262 41702261 and the china scholarship council no 201806430053 appendix a derivation of the approximate analytical solution the governing equation after applying the linearization method can be given as a1 2 s r z t r 2 m r s r z t r m k z k r q 2 π r d m 1 2 s r z t z 2 m s k r q 2 π r d m 1 s r z t t the laplace transform with respect to time t is applied to eq a1 to get a2 2 s r z p r 2 m r s r z p r m k z k r q 2 π r d m 1 2 s r z p z 2 m s k r q 2 π r d m 1 p s r z p where p and s are the laplace variable and drawdown in the laplace domain respectively then the fourier cosine transform is used to the second order partial derivative with respect to coordinate z in eq a2 to obtain a3 f c 2 s r z p z 2 0 d 2 s r z p z 2 c o s n π z d d z n 2 π 2 d 2 s r n p where n n 0 1 2 3 is the fourier variable and s r n p denotes the fourier cosine transform of drawdown by substituting eq a3 to eq a2 we get a4 d 2 s r n p d r 2 m r d s r n p d r m k z n 2 π 2 m p s d 2 k r d 2 q 2 π r d m 1 s r n p by defining φ m k z n 2 π 2 m p s d 2 k r d 2 q 2 π d m 1 eq a4 can be reduced to a5 d 2 s r n p d r 2 m r d s r n p d r φ r 1 m s r n p 0 eq a5 is a linear differential equation of the second order the general solution of eq a5 can be described as a6 s r n p r 1 m 2 c 1 i 1 m 3 m 2 φ 3 m r 3 m 2 c 2 k 1 m 3 m 2 φ 3 m r 3 m 2 where i 1 m 3 m and k 1 m 3 m are the modified bessel functions of the first and second kind with the order of 1 m 3 m respectively the integration constants c 1 and c 2 can be determined according to boundary conditions by applying the laplace and fourier cosine transforms to eq 3 one can obtain a7 s n p 0 considering the property of the modified bessel function of the first kind and substituting eq a7 to eq a6 one gets a8 c 1 0 eq a6 can then be rewritten as a9 s r n p c 2 r 1 m 2 k 1 m 3 m 2 φ 3 m r 3 m 2 combining the izbash equation and the linearization method the boundary conditions of eq 6 can be given as a10 lim r 0 s r z t r 1 k r q 2 π r d 1 m 0 z d 1 0 d 1 z d 1 d 2 1 k r q 2 π r d 3 m d 1 d 2 z d applying the laplace and fourier cosine transforms to eq a10 one can obtain a11 lim r 0 d s r n p d r lim r 0 d n π p k r q 2 π r d 1 m s i n n π d 1 d q 2 π r d 3 m s i n n π d 1 d 2 d the modified bessel function has the following properties spanier and oldham 1987 a12 x d k ν x d x υ k ν x x k ν 1 x and a13 k ν x k ν x and a14 k ν x γ ν 2 x 2 ν x 0 ν 0 from eqs a9 a12 a13 and a14 one has a15 lim r 0 d s r n p d r 1 2 lim r 0 c 2 1 r m φ γ 2 3 m φ 3 m 2 3 m the integration constant c 2 can then be obtained from eqs a11 and a15 as a16 c 2 2 d φ 3 m 2 3 m q 2 π d 1 m s i n n π d 1 d q 2 π d 3 m s i n n π d 1 d 2 d n π p k r φ γ 2 3 m substituting eq a16 to eq a9 one gets a17 s r n p 2 d φ 3 m 2 3 m q 2 π d 1 m s i n n π d 1 d q 2 π d 3 m s i n n π d 1 d 2 d n π p k r φ γ 2 3 m r 1 m 2 k 1 m 3 m 2 φ 3 m r 3 m 2 when the inverse fourier transform is employed to eq 17 one can obtain a18 s r z p 1 d s r 0 p 2 d n 1 s r n p c o s n π z d when n 0 similar processes are applied to solve eq a5 and boundary conditions and finally the integration constant c 2 can be obtained as a19 c 2 2 α 3 m 2 3 m q 2 π d 1 m d 1 q 2 π d 3 m d 3 p k r α γ 2 3 m where α m p s k r q 2 π d m 1 then with eq a19 one has a20 s r 0 p 2 α 3 m 2 3 m q 2 π d 1 m d 1 q 2 π d 3 m d 3 p k r α γ 2 3 m r 1 m 2 k 1 m 3 m 2 α 3 m r 3 m 2 finally the analytical solution in the laplace domain can be obtained by substituting eqs a17 and a20 to eq a18 appendix b derivation of the steady state analytical solution similarly the fourier cosine transform is used to the second order partial derivative with respect to coordinate z in eq 14 to get b1 f c 2 s r z z 2 0 d 2 s r z z 2 c o s n π z d d z n 2 π 2 d 2 s r n where s is drawdown in the fourier domain by applying the fourier cosine transform to eq 14 and combining it with eq b1 eq 14 can then be reduced to b2 d 2 s r n d r m r d s r n d r ω r 1 m s r n 0 in which ω m k z k r n 2 π 2 d 2 q 2 π d m 1 the general solution of eq b2 is obtained as b3 s r n r 1 m 2 c 3 i 1 m 3 m 2 ω 3 m r 3 m 2 c 4 k 1 m 3 m 2 ω 3 m r 3 m 2 where c 3 and c 4 are integration constants i 1 m 3 m and k 1 m 3 m denote the modified bessel functions of the first and second kind with the order of 1 m 3 m respectively using the boundary condition eq 3 the constant c 3 can be obtained by applying the fourier transform and properties of the modified bessel function leading to c 3 0 then eq b3 can be further written as b4 s r n c 4 r 1 m 2 k 1 m 3 m 2 ω 3 m r 3 m 2 using the fourier cosine transform to eq 6 one can obtain b5 lim r 0 d s r n d r lim r 0 d n π k r q 2 π r d 1 m s i n n π d 1 d q 2 π r d 3 m s i n n π d 1 d 2 d with eq b4 and the properties of the modified bessel function as described in eqs a12 a13 and a14 one has b6 lim r 0 d s r n d r 1 2 lim r 0 c 4 1 r m ω γ 2 3 m ω 3 m 2 3 m combining eqs b5 and b6 the constant c 4 can be given as b7 c 4 2 d ω 3 m 2 3 m q 2 π d 1 m s i n n π d 1 d q 2 π d 3 m s i n n π d 1 d 2 d n π k r ω γ 2 3 m substituting eq b7 to eq b4 one can obtain b8 s r n 2 d ω 3 m 2 3 m q 2 π d 1 m s i n n π d 1 d q 2 π d 3 m s i n n π d 1 d 2 d n π k r ω γ 2 3 m r 1 m 2 k 1 m 3 m 2 ω 3 m r 3 m 2 applying the inverse of fourier cosine transform to eq b8 one has b9 s r z 1 d s r 0 2 d n 1 s r n cos n π z d when n 0 eq b2 with corresponding boundary conditions can be solved using similar methods then using properties of the modified bessel function from eq a12 to eq a14 the term s r 0 in eq b9 can be obtained as b10 s r 0 q 2 π d 1 m d 1 q 2 π d 3 m d 3 k r γ 2 3 m 3 m r 1 m substituting eqs b8 and b10 to eq b9 we can eventually obtain the steady state analytical solution in the time domain 
402,an analytical model is proposed in this study to describe transient drawdown induced by non darcian flow in a confined aquifer with a single well circulation groundwater heat pump system the izbash equation and a linearization method are employed to describe non darcian flow in the horizontal direction of a confined aquifer and to approximate the nonlinear term in the governing equation respectively by applying a combination of the laplace and fourier cosine transforms an approximate analytical solution in the laplace domain is obtained which is numerically inverted to obtain transient drawdown in the time domain using the stehfest algorithm method the results of the derived analytical solution for the special case of darcian flow m 1 correspond well with the existing solution derived using darcy s law the steady state analytical solution in the time domain is obtained by applying the fourier cosine transform moreover the sensitivity analysis is performed to investigate the influence of selected parameters such as the power index m the radial hydraulic conductivity kr the aquifer specific storage s and the length of the sealed section d2 on drawdown the results show that each parameter has its influence period on drawdown and that drawdown is more sensitive to the power index m compared to other parameters keywords izbash equation linearization method non darcian flow geothermal energy groundwater heat pump system 1 introduction it is well known that darcy s law which defines a linear relationship between the fluid flux and the hydraulic gradient has been commonly used to address groundwater flow problems in practical engineering applications however the fluid flow becomes non darcian when the fluid flux is smaller or larger than a specific flux interval wilkinson 1955 slepicka 1961 bear 1972 zoorabadi et al 2015 zhou et al 2015 when the relationship between the fluid flux and the hydraulic gradient deviates from classical darcy s law the flow becomes non darcian under these circumstances researchers point out that darcy s law is not sufficient to describe groundwater flow miller and low 1963 bear 1972 barker and herbert 1977 sen 1985 a variety of equations has been derived to characterize the relationship between the fluid flux and the hydraulic gradient for non darcian flow forchheimer 1901 izbash 1931 muskat 1938 rose 1951 escande 1953 generally these equations can be divided into two categories power functions and polynomial functions wen et al 2013 the first category assumes that the fluid flux is a power function of the hydraulic gradient while the second category states that the fluid flux can be described as a second order polynomial function of the hydraulic gradient among equations of these two categories the forchheimer and izbash equations are widely applied to describe non darcian flow e g sen 1989 sen 1990 wen et al 2008a b moutsopoulos et al 2009 mathias and todman 2010 yeh and chang 2013 sedghi asl et al 2014 chen et al 2015 houben 2015 until now a variety of approximate or semi analytical solutions for non darcian flow toward a fully or partially penetrating well has been derived for these two equations for instance sen 1989 1990 presented an analytical solution which takes into account the non darcian flow described using the forchheimer law toward an infinitesimal well or a large diameter well an approximate analytical solution considering the effect of non darcian flow which is defined by the forchheimer equation was derived by wu 2002 moutsopoulos and tsihrintzis 2005 presented an approximate analytical solution for nonlinear flow through porous media described using the forchheimer equation another approximate solution for forchheimer s flow toward a well is presented by mathias et al 2008 applying the izbash equation sen 2000 provided an analytical solution for transient drawdown for non darcian flow to a fully penetrating well in a confined aquifer later based on the izbash equation many efforts have been made by wen et al 2008 to develop analytical solutions describing non darcian flow towards a fully penetrating well they presented several approximate analytical solutions in the laplace domain considering the effect of wellbore storage and a well radius in different aquifer systems furthermore for non darcian flow toward a partially penetrating well wen et al 2013 presented a semi analytical solution in the laplace domain while neglecting the effect of the well radius they also investigated non darcian flow toward a larger diameter partially penetrating well in a confined aquifer wen et al 2014 an analytical solution describing non darcian flow to a partially penetrating well in a confined aquifer while considering the effect of a finite thickness skin was presented by feng and wen 2016 in addition to analytical solutions numerical solutions for non darcian flow toward wells have also been developed wu 2002 employed the finite difference method to solve non darcian flow described using the forchheimer equation through a fractured reservoir based on the assumption that the forchheimer equation can describe non darcian flow mathias et al 2008 investigated flow toward a fully penetrating well in a confined aquifer using the numerical model based on the finite difference method wen et al 2009 developed a similar numerical model using the finite difference method and the assumption that the izbash equation can be employed to describe the non darcian flow finally mathias and wen 2015 performed a numerical simulation of non darcian flow in leaky aquifers using the forchheimer equation a special well structure referred to as a single well circulation system fig 1 is commonly applied in practical engineering applications in a single well circulation system a single borehole is divided into two partially penetrating wells by well packers as shown in figs 1 and 2 which are used to block water injected in the injection well to flow to the pumping well the lower partially penetrating well is a pumping well with the pumping rate q and the upper partially penetrating well is an injection well for injecting water at the same rate q thus the single well circulation system can be considered as a combination of two partially penetrating wells to the best of our knowledge little research work has been done on groundwater flow in a single well circulation system ni et al 2011 presented an analytical solution describing the transient drawdown of groundwater induced by the operation of a single well circulation groundwater heat pump system subsequently tu et al 2019 and tu et al 2020 developed an analytical solution describing the transient drawdown distribution and obtained a steady state analytical solution in the time domain using the laplace transform it should be pointed out that these studies on groundwater flow in a single well circulation system are based on the assumption of darcian flow however because of very high hydraulic gradients and enhanced flow velocities due to the convergence of flow lines mathias et al 2008 yeh and chang 2013 a considerable number of researchers assumed that the flow in coarse grained and fractured media near the wells likely becomes non darcian the non darcian flow may also occur due to high fluxes near the wells especially when the pumping injection rates are relatively large wan et al 2013 wen et al 2013 wen et al 2014 feng and wen 2016 however the research on groundwater flow in a single well circulation system has so far been based on the assumption of the validity of darcy s law which may not be adequate to describe the groundwater flow in such a system practical engineering implementations of single well circulation groundwater heat pump systems require favorable aquifer conditions which allow water flow at relatively high velocities to continuously provide a significant amount of water the hydraulic conductivity of such aquifers should be at least 10 3m s or higher wu et al 2015 rybach 2015 besides relatively large pumping rates usually about 50 100 m3 h rybach 2015 are designed to meet the enormous energy demand therefore the flow near the wells in a confined aquifer with a single well circulation system is particularly prone to become non darcian as a result of high flow velocities and hydraulic gradients to the best of our knowledge most studies on non darcian flow have focused on systems with fully or partially penetrating wells e g wu 2002 mathias et al 2008 wen et al 2008 yeh and chang 2013 wen et al 2013 mathias and wen et al 2015 feng and wen 2016 while no analytical model has so far considered non darcian flow in a single well circulation system it is therefore necessary to develop a new analytical model for investigating the effects of non darcian flow in a confined aquifer with a single well circulation system this will help in improving our understanding of the complex groundwater flow regime in single well circulation systems which can be very beneficial for future investigations of heat convection in such systems the aim of this study is to extend the analytical solution based on darcy s law to non darcian flow conditions and to investigate the effects of non darcian flow in a confined aquifer with a single well circulation system this could have theoretical significance for the applications of single well circulation groundwater heat pump systems due to relatively high pumping rates and large hydraulic conductivities in single well circulation systems the horizontal flow velocity is usually very high and non darcian flow near the wells likely occurs the flow in the horizontal direction is therefore assumed to be non darcian on the other hand the flow velocity in the vertical direction is relatively small compared with the horizontal flow velocity in order to make the analytical model tractable the flow in the vertical direction is assumed to be darcian such assumptions have been often adopted when dealing with non darcian flow problems and when the flow velocity in the vertical direction is considered wen et al 2013 wen et al 2014 feng and wen 2016 the izbash equation is used to describe non darcian flow and a linearization approximation method proposed by wen et al 2008 is employed to solve the nonlinear term in the governing equation this latter method has been shown to address this nonlinear problem efficiently the approximate analytical solution in the laplace domain is obtained by applying the laplace and fourier cosine transforms the steady state solution in the time domain is also developed using the linearization approximation method and the fourier cosine transform moreover sensitivity analysis is performed to investigate the influence of different parameters on drawdown 2 mathematical model 2 1 model setup fig 2 presents a schematic diagram that describes groundwater flow in a confined aquifer with a single well circulation system non darcian flow is likely to occur because of the high flow velocity in the horizontal direction near the well especially for a relatively large pumping rate in this case non darcian flow near the well needs to be considered due to a unique well structure the flow in the vertical direction which is assumed to be darcian cannot be neglected additional assumptions for this model are made 1 the confined aquifer is treated as homogeneous and anisotropic with a uniform thickness d and infinite in the horizontal direction 2 the underlying and overlying layers of the confined aquifer are both impermeable 3 the specific discharge qr in the horizontal direction is assumed to be constant along the screen the same assumption as in wen et al 2013 4 the pumping and injection rates q positive and negative values denote pumping and injection respectively are constant and 5 the well radius rw is infinitesimally small and can be neglected based on the above descriptions and assumptions the governing equation for the mathematical model can be written as follows 1 q r r q r r q z z s s r z t t where t is time t rand z represent the radial and vertical coordinates respectively l s refers to the specific storage of an aquifer l 1 qr and qz denote the horizontal and vertical fluid fluxes respectively lt 1 and s is groundwater drawdown l before the system starts functioning groundwater drawdown is assumed to be zero and the initial conditions for the system can be described as 2 s r z 0 0 the boundary conditions at infinity in the horizontal direction r and the bottom and top of a confined aquifer z 0 and z d are given as follows respectively 3 s z t 0 and 4 s r 0 t z 0 and 5 s r d t z 0 where d is the thickness of a confined aquifer l with the assumption that the wellbore storage is neglected the boundary conditions near the well can be expressed as 6 lim r 0 r q r q 2 π d 1 0 z d 1 0 d 1 z d 1 d 2 q 2 π d 3 d 1 d 2 z d where the pumping and injection rate q positive for pumping and negative for injection are the same and constant l3t 1 d 1 d 2 and d 3 denote the lengths of well screens for pumping sealed and injection wells respectively l izbash 1931 presented a power law relationship between the hydraulic gradient and water flux which can be employed to describe the non darcian flow in this model the horizontal specific discharge described by the izbash equation for two dimensional flow same as in wen et al 2013 can be given as 7 q r q r m 1 k r s r z t r where kr is the quasi wen et al 2006 radial hydraulic conductivity and the non darcian exponent m in the izbash s equation is an empirical coefficient that ranges between 1 and 2 and denotes the degree of deviation from linearity izbash 1931 bordier and zimmer 2000 when m 1 the flow is treated as pre linear flow and when 1 m 2 the flow becomes post linear flow izbash 1931 wen et al 2006 it should be pointed out that eq 7 reduces to darcy s law when m 1 due to various factors such as shapes and arrangements of pores and complex flow paths the non darcian exponent m varies in space and time bordier and zimmer 2000 wen et al 2006 it is thus quite difficult to determine and quantify its value in practical engineering applications although some researchers soni et al 1978 watanable 1982 chen et al 2015 have attempted to determine the value of the non darcian exponent m this issue has not yet been well resolved in order to make the proposed models tractable the non darcian exponent m is often assumed to be constant when dealing with non darcian flow problems e g sen 2000 wen et al 2006 2008 quinn et al 2011 2013 wen et al 2013 liu et al 2016 however adopting a constant non darcian exponent m in the izbash s equation imposes some limitations when describing the non darcian flow to overcome these limitations still remains an open issue and a very interesting topic for future investigations the flow in the vertical direction is assumed to be darcian which is described as 8 q z k z s r z t z where kz represents the vertical hydraulic conductivity since the flow in the horizontal direction is against the direction of the r coordinate the specific discharge qr is always negative thus eq 7 can be furtherly reduced as 9 q r m k r s r z t r 2 2 approximate analytical solution the governing equation of the mathematical model is obtained by substituting eqs 8 and 9 into eq 1 10 k r m q r m 1 2 s r z t r 2 k r r q r m 1 s r z t r k z 2 s r z t z 2 s s r z t t it is noteworthy that eq 10 is a nonlinear equation due to the nonlinear term qr m 1 solving such a nonlinear equation may not be tractable using rigorous mathematical means however a linearization approximation method proposed by wen et al 2008 may be used to address this problem this method has been successfully applied to find analytical solutions for other non darcian problems e g wen et al 2008 wen et al 2013 feng and wen 2016 by applying the linearization approximation method the nonlinear term can be approximately described as 11 q r m 1 q 2 π r d m 1 substituting eq 11 into eq 10 one can obtain 12 2 s r z t r 2 m r s r z t r m k z k r q 2 π r d m 1 2 s r z t z 2 m s k r q 2 π r d m 1 s r z t t eq 12 is a linear partial differential equation which can be solved using the laplace and fourier cosine transforms a detailed derivation of the solution of this partial differential equation can be seen in appendix a an approximate analytical solution of non darcian flow for the drawdown in the laplace domain is given as 13 s r z p 2 α 3 m 2 3 m q 2 π d 1 m d 1 q 2 π d 3 m d 3 p d k r α γ 2 3 m r 1 m 2 k 1 m 3 m 2 α 3 m r 3 m 2 n 1 4 φ 3 m 2 3 m q 2 π d 1 m s i n n π d 1 d q 2 π d 3 m s i n n π d 1 d 2 d n π p k r φ γ 2 3 m r 1 m 2 k 1 m 3 m 2 φ 3 m r 3 m 2 c o s n π z d where φ m k z n 2 π 2 m p s d 2 k r d 2 q 2 π d m 1 α m p s k r q 2 π d m 1 s is the solution of drawdown in the laplace domain γ denotes the gamma function k ν represents the modified bessel function of the second kind with an order of ν and n and p are the fourier and laplace variables respectively due to the presence of the bessel function k ν term it may not be possible to obtain the analytical solution of eq 13 in the time domain however several numerical inverse methods e g stehfest 1970a b crump 1976 de hoog et al 1982 can be employed to transform the analytical solution in the laplace domain to the time domain in this work an inverse laplace transform is numerically conducted using the stehfest method which has been shown to address such inverse problems efficiently and accurately wen et al 2008 a program has been developed in matlab to calculate the solution for drawdown in the time domain based on the stehfest method the number of terms n which are used in the inversion needs to be specified before performing it multiple numerical studies have shown that the solution gives accurate and stable results with n 18 similarly the infinite series of eq 13 converges when n 20 therefore to increase computational efficiency n 18 and n 20 are employed in the following calculations 2 3 an analytical solution at a steady state when the operation time of the system is long enough the changes in drawdown near wells become stable and the flow reaches steady state conditions in this case s r z t t 0 and eq 12 becomes 14 2 s r z r 2 m r s r z r m k z k r q 2 π r d m 1 2 s r z z 2 0 for this linear partial differential equation the analytical solution at a steady state in the time domain is obtained by applying the fourier cosine transform see appendix b 15 r z q 2 π d 1 m d 1 q 2 π d 3 m d 3 d k r γ 2 3 m 3 m r 1 m n 1 4 ω 3 m 2 3 m q 2 π d 1 m s i n n π d 1 d q 2 π d 3 m s i n n π d 1 d 2 d n π k r ω γ 2 3 m r 1 m 2 k 1 m 3 m 2 ω 3 m r 3 m 2 cos n π z d where ω m k z k r n 2 π 2 d 2 q 2 π d m 1 and s is the drawdown in the time domain 2 4 simplification of the analytical solution when m 1 the flow becomes darcian flow and the analytical solution of eq 13 is as follows 16 s r z p n 1 q np k r π 2 sin n π d 1 d d 1 sin n π d 1 d 2 d d 3 k 0 β r cos n π z d where β k z k r n 2 π 2 d 2 p s k r and k 0 is the modified bessel function of the second kind with an order of zero the eq 16 is the same as the analytical solution derived by tu et al 2020 for darcian flow in a confined aquifer with a single well circulation system 3 results and discussion 3 1 drawdown versus time as a function of the power index the influence of the power index m from 1 to 2 on drawdown observed at r 5 m and z 15 m is analyzed first when q 60 m3 h d 40 m d1 15 m d2 10 m d3 15 m s 0 0001 m 1 kr 0 1 m h m and kz 0 01 m h for the case of m 1 darcian flow it can be observed in fig 3 that the drawdown calculated using the new analytical solution matches well the results of the analytical solution of ni et al 2011 the results in fig 3 indicate that the power index influences drawdown during the entire pumping period a larger value of the power index results in larger drawdown at the beginning and smaller drawdown at later times fig 3 a similar influence can also be found in wen et al 2013 a larger power index in the izbash equation indicates more significant deviations from darcian flow and results in greater flow turbulence at early times the elastic release process of an aquifer may be accelerated for a larger power index consequently larger drawdown is observed at early times for a larger power index as pumping time increases drawdowns for different power indices approach a steady state when t 10 h indicating that the process of elastic release of an aquifer is approximately complete meanwhile pumped water comes mainly from the region relatively far away from the pumping well larger flow turbulence induced by a larger power index is likely to result in larger recharge therefore it can be seen that drawdown is smaller for a larger power index at late times moreover fig 3 also indicates that drawdown reaches a steady state more quickly when the power index is larger 3 2 drawdown versus time as a function of the radial hydraulic conductivity fig 4 depicts temporal drawdown distribution curves observed at r 5 m and z 15 m for different radial hydraulic conductivities kr from 0 01 to 0 1 m h other parameters are as follows q 60 m3 h m 1 5 d 40 m d1 15 m d2 10 m d3 15 m s 0 0001 m 1 and kz 0 01 m h it is interesting to note that the influence of the radial hydraulic conductivity on drawdown is similar to that of the power index as indicated in fig 4 drawdown increases with the radial hydraulic conductivity at the beginning while smaller drawdown is obtained for larger radial hydraulic conductivities at late times the reasons for this phenomenon can be explained as follows at early times larger hydraulic conductivities induce faster groundwater flow due to the faster spreading of the suction zone in the depression cone groundwater can be replenished promptly consequently larger drawdown for a larger hydraulic conductivity at early times can be found at late times when the flow reaches a quasi steady state recharge occurs from areas relatively far away from the well smaller hydraulic conductivities will then result in a larger influence range of the depression cone and larger drawdown additionally it is worth noting that drawdown approaches a steady state more quickly with increasing radial hydraulic conductivities fig 4 3 3 drawdown versus time as a function of the aquifer specific storage the curves in fig 5 show the temporal drawdown distributions observed at r 5 m and z 15 m calculated using the aquifer specific storage s from 0 0001 to 0 001 m 1 the other parameters used to calculate the curves in the figure are as follows q 60 m3 h m 1 5 d 40 m d1 15 m d2 10 m d3 15 m kr 0 1 m h m and kz 0 01 m h it is demonstrated in fig 5 that drawdown is smaller for a larger aquifer specific storage and vice versa at early times a larger aquifer specific storage indicates that the aquifer can release more groundwater when other conditions remain the same moreover at late times t 1 h when the process of the storage release from the aquifer is almost complete drawdown curves merge for different aquifer specific storages fig 5 drawdowns approach a steady state at late times and the influence of different aquifer specific storages on drawdown is negligible 3 4 drawdown versus time as a function of the size of the sealed section fig 6 shows drawdowns versus time observed at r 5 m and z 15 m for different lengths of the sealed section d2 from 6 to 14 m in this case the thickness of the aquifer is kept constant and the lengths of well screens for pumping and injection wells d1 and d3 respectively are correspondingly adjusted when the length of the sealed section changes other parameters used in this case are q 60 m3 h m 1 5 s 0 0001 m 1 kr 0 1 m h m and kz 0 01 m h the curves shown in fig 6 indicate that changes in drawdown are significant when the length of the sealed section is reduced from 14 to 8 m also larger lengths of the sealed section result in smaller drawdowns since the aquifer thickness and the pumping rate remain constant the borehole with a longer length of the sealed section has a shorter length of the pumping screen and a correspondingly larger pumping rate for a unit length of the well screen it is thus not surprising that larger drawdowns are obtained for shorter lengths of the sealed section however the influence of the further reduction in the length of the sealed section from 8 to 6 m on drawdown is almost imperceptible also differences in drawdown are smaller for smaller lengths of the sealed section e g from 6 to 10 m than for larger lengths of the sealed section moreover when t 1 h drawdowns approach a steady state and the curves are parallel 3 5 drawdown versus distance as a function of the pumping time it is also important to analyze drawdown versus the radial distance for different pumping times for t 0 1 1 10 h and at a steady state the other parameters are as follows q 60 m3 h m 1 5 d 40 m d1 15 m d2 10 m d3 15 m s 0 0001 m 1 kr 0 1 m h m and kz 0 01 m h the steady state analytical solution eq 15 is employed in this figure as a reference it can be observed in fig 7 that drawdown curves merge for different pumping times when the radial distance r 1 m indicating that groundwater flow in the area around the pumping well reaches a steady state quickly for the region further away from the well r 1 m drawdown curves start deviating from each other this is because the flow in this region is still unsteady and will take longer to reach a steady state moreover drawdown at t 10 h is very close to that at a steady state which means that groundwater flow in a confined aquifer for a single well circulation system approaches a steady state relatively quickly 3 6 drawdown versus distance as a function of the power index temporal drawdown distribution curves versus a radial distance for different values of the power index m from 1 to 2 are shown in fig 8 the other parameters used in this figure are the same as before i e q 60 m3 h d 40 m d1 15 m d2 10 m d3 15 m t 10 h s 0 0001 m 1 kr 0 1 m h m and kz 0 01 m h it can be observed in fig 8 that a smaller value of the power index results in a larger drawdown for r 100 m however at larger radial distances drawdown for smaller values of the power index is smaller than for its larger values this is consistent with the results in fig 3 implying that flow near the pumping well reached a steady state when the pumping time t 10 h while a steady state was not reached in the area far away from the pumping well fig 8 3 7 drawdown contours at a steady state drawdown contours displayed in fig 9 are obtained using the analytical solution of eq 15 for steady state conditions the following parameters are used in this scenario q 60 m3 h m 1 5 d 40 m d1 15 m d2 10 m d3 15 m s 0 0001 m 1 kr 0 1 m h m and kz 0 01 m h as shown in fig 7 changes in drawdown are very large for small r less than 0 5 m causing contours to be too dense to be displayed in fig 9 therefore the starting point on a horizontal axis in fig 9 is at r 0 5 m due to flow symmetry contours for steady state drawdown are symmetric along a horizontal line at z 20 m the middle of a confined aquifer where drawdown is equal to zero fig 9 and vary tremendously along the well axis when a single well circulation system functions properly pressure differences between the injection zone and the suction zone will yield relatively large hydraulic gradients near the wells thus drawdown contours near the borehole are much denser than further away from the pumping or injection wells 3 8 sensitivity analysis the global sensitivity analysis is an effective method that can be employed to analyze the sensitivity of the model output to changes in each input parameter saltelli et al 2000 in particular the sobol s indices have been widely employed as sensitivity measures in many applications involving hydrological van werkhoven et al 2009 ciriello and di federico 2012 di federico and ciriello 2012 brunetti et al 2016 and environmental nossent et al 2011 pianosi et al 2015 models this is because no assumptions of linearity or monotonicity are required for the adopted interpretative model sobol 1993 archer et al 1997 these indices can provide accurate information about the model output variance related to a single parameter or associated with interactions of multiple parameters a more detailed description of the sobol method can be found in sobol 2001 according to the definition given by sobol 1993 the sobol sensitivity indices can be expressed as the ratio of the partial model variance to the total model variance 17 first order s i v i v 18 second order s i j v i j v where vi represents the partial variance of the model associated with the ith parameter vij represents the partial variance of the model associated with the interaction of the ith and jth parameters and v is the total variance the first order or principal sensitivity indices si called the main effect indices are used to describe contributions of a single parameter to the total variance of the model output the influence of the interaction of two input parameters on the model output variance is denoted as the second order index sij the total sensitivity indices s t i ciriello and di federico 2012 represent the main effect of a given parameter the ith parameter and all its interactions with other parameters up to the kth order k denotes the number of input parameters which can be expressed as follows 19 total s t i s i j i s i j the evaluation of sensitivity indices is performed for the following parameters the power index m the radial hydraulic conductivity kr the aquifer specific storage s and the length of the sealed section d2 table 1 shows the range of all evaluated parameters other conditions used when conducting the global sensitivity analysis are as follows q 60 m3 h d 40 m d1 d 3 40 d2 2 and kz 0 01 m h fig 10 presents temporal changes in total sensitivity indices for selected input parameters it can be seen that two parameters show a significant influence on the model output variance these are the power index m and the radial hydraulic conductivity kr the total sensitivity index for the power index m is initially small then increases with time reaches a peak value near t 20 h and then remains constant with time the radial hydraulic conductivity kr shows a similar trend as the power index m except that it has a lower peak value when reaching a steady state the total sensitivity index for the specific storage s has initially a very high value then sharply decreases until near t 10 h and then gradually drops to almost zero after t 40 h this indicates that the specific storage s has a negligible influence on the model output finally the overall behavior of the total sensitivity index for the length of the sealed section d2 is remarkably similar to that of the specific storage s except that the total sensitivity indices reach a constant minimum value after large time which is much larger compared with that for the specific storage s 4 conclusions in this work an analytical model has been developed to describe non darcian flow in a confined aquifer with a sing well circulation system non darcian flow in the horizontal direction is described using the izbash equation and a linearization approach presented by wen et al 2008 is employed to approximate the nonlinear term in the governing equation then using the laplace and fourier cosine transforms the analytical solution in the laplace domain is obtained which is numerically inverted into the time domain using the stehfest method the main findings from this work can be drawn as follows 1 larger values of the power index m and the radial hydraulic conductivity kr result in larger drawdown at early times and smaller drawdown at late times groundwater flow approaches a steady state faster for larger values of the power index m and the radial hydraulic conductivity kr 2 larger values of the aquifer specific storage s result in smaller drawdown while the influence of s on drawdown is negligible at late times 3 smaller lengths of the sealed section d2 result in larger drawdown however a further reduction in the length of the sealed section d2 below a certain critical length leads to imperceptible changes in drawdown 4 the contours for steady state drawdown vary significantly along the well axis and are symmetric around a horizontal line in the middle between the injection and suction sections z 20 m in our example where drawdown is equal to zero 5 each parameter has its influence period on drawdown drawdown is the most sensitive to the length of the sealed section d2 and the aquifer specific storage s at early times and the power index m in particular and the radial hydraulic conductivity kr at late times credit authorship contribution statement kun tu conceptualization methodology writing original draft software qiang wu supervision project administration funding acquisition jirka simunek supervision resources writing review editing ke zhu methodology software chaofan chen conceptualization formal analysis weiyu zheng software formal analysis yifan zeng conceptualization investigation shengheng xu formal analysis declaration of competing interest we declare that we have no financial and personal relationships with other people or organizations that can inappropriately influence our work there is no professional or other personal interest of any nature or kind in any product service and or company that could be construed as influencing the position presented in or the review of the manuscript entitled an approximate analytical solution for non darcian flow in a confined aquifer with a single well circulation groundwater heat pump system acknowledgments the authors gratefully acknowledge the financial support from the key program of the national natural science foundation of china grant no 41430318 the national scientific and technical support program of china grant no 2016yfc0801801 the national natural science foundation of china grant no 41572222 41602262 41702261 and the china scholarship council no 201806430053 appendix a derivation of the approximate analytical solution the governing equation after applying the linearization method can be given as a1 2 s r z t r 2 m r s r z t r m k z k r q 2 π r d m 1 2 s r z t z 2 m s k r q 2 π r d m 1 s r z t t the laplace transform with respect to time t is applied to eq a1 to get a2 2 s r z p r 2 m r s r z p r m k z k r q 2 π r d m 1 2 s r z p z 2 m s k r q 2 π r d m 1 p s r z p where p and s are the laplace variable and drawdown in the laplace domain respectively then the fourier cosine transform is used to the second order partial derivative with respect to coordinate z in eq a2 to obtain a3 f c 2 s r z p z 2 0 d 2 s r z p z 2 c o s n π z d d z n 2 π 2 d 2 s r n p where n n 0 1 2 3 is the fourier variable and s r n p denotes the fourier cosine transform of drawdown by substituting eq a3 to eq a2 we get a4 d 2 s r n p d r 2 m r d s r n p d r m k z n 2 π 2 m p s d 2 k r d 2 q 2 π r d m 1 s r n p by defining φ m k z n 2 π 2 m p s d 2 k r d 2 q 2 π d m 1 eq a4 can be reduced to a5 d 2 s r n p d r 2 m r d s r n p d r φ r 1 m s r n p 0 eq a5 is a linear differential equation of the second order the general solution of eq a5 can be described as a6 s r n p r 1 m 2 c 1 i 1 m 3 m 2 φ 3 m r 3 m 2 c 2 k 1 m 3 m 2 φ 3 m r 3 m 2 where i 1 m 3 m and k 1 m 3 m are the modified bessel functions of the first and second kind with the order of 1 m 3 m respectively the integration constants c 1 and c 2 can be determined according to boundary conditions by applying the laplace and fourier cosine transforms to eq 3 one can obtain a7 s n p 0 considering the property of the modified bessel function of the first kind and substituting eq a7 to eq a6 one gets a8 c 1 0 eq a6 can then be rewritten as a9 s r n p c 2 r 1 m 2 k 1 m 3 m 2 φ 3 m r 3 m 2 combining the izbash equation and the linearization method the boundary conditions of eq 6 can be given as a10 lim r 0 s r z t r 1 k r q 2 π r d 1 m 0 z d 1 0 d 1 z d 1 d 2 1 k r q 2 π r d 3 m d 1 d 2 z d applying the laplace and fourier cosine transforms to eq a10 one can obtain a11 lim r 0 d s r n p d r lim r 0 d n π p k r q 2 π r d 1 m s i n n π d 1 d q 2 π r d 3 m s i n n π d 1 d 2 d the modified bessel function has the following properties spanier and oldham 1987 a12 x d k ν x d x υ k ν x x k ν 1 x and a13 k ν x k ν x and a14 k ν x γ ν 2 x 2 ν x 0 ν 0 from eqs a9 a12 a13 and a14 one has a15 lim r 0 d s r n p d r 1 2 lim r 0 c 2 1 r m φ γ 2 3 m φ 3 m 2 3 m the integration constant c 2 can then be obtained from eqs a11 and a15 as a16 c 2 2 d φ 3 m 2 3 m q 2 π d 1 m s i n n π d 1 d q 2 π d 3 m s i n n π d 1 d 2 d n π p k r φ γ 2 3 m substituting eq a16 to eq a9 one gets a17 s r n p 2 d φ 3 m 2 3 m q 2 π d 1 m s i n n π d 1 d q 2 π d 3 m s i n n π d 1 d 2 d n π p k r φ γ 2 3 m r 1 m 2 k 1 m 3 m 2 φ 3 m r 3 m 2 when the inverse fourier transform is employed to eq 17 one can obtain a18 s r z p 1 d s r 0 p 2 d n 1 s r n p c o s n π z d when n 0 similar processes are applied to solve eq a5 and boundary conditions and finally the integration constant c 2 can be obtained as a19 c 2 2 α 3 m 2 3 m q 2 π d 1 m d 1 q 2 π d 3 m d 3 p k r α γ 2 3 m where α m p s k r q 2 π d m 1 then with eq a19 one has a20 s r 0 p 2 α 3 m 2 3 m q 2 π d 1 m d 1 q 2 π d 3 m d 3 p k r α γ 2 3 m r 1 m 2 k 1 m 3 m 2 α 3 m r 3 m 2 finally the analytical solution in the laplace domain can be obtained by substituting eqs a17 and a20 to eq a18 appendix b derivation of the steady state analytical solution similarly the fourier cosine transform is used to the second order partial derivative with respect to coordinate z in eq 14 to get b1 f c 2 s r z z 2 0 d 2 s r z z 2 c o s n π z d d z n 2 π 2 d 2 s r n where s is drawdown in the fourier domain by applying the fourier cosine transform to eq 14 and combining it with eq b1 eq 14 can then be reduced to b2 d 2 s r n d r m r d s r n d r ω r 1 m s r n 0 in which ω m k z k r n 2 π 2 d 2 q 2 π d m 1 the general solution of eq b2 is obtained as b3 s r n r 1 m 2 c 3 i 1 m 3 m 2 ω 3 m r 3 m 2 c 4 k 1 m 3 m 2 ω 3 m r 3 m 2 where c 3 and c 4 are integration constants i 1 m 3 m and k 1 m 3 m denote the modified bessel functions of the first and second kind with the order of 1 m 3 m respectively using the boundary condition eq 3 the constant c 3 can be obtained by applying the fourier transform and properties of the modified bessel function leading to c 3 0 then eq b3 can be further written as b4 s r n c 4 r 1 m 2 k 1 m 3 m 2 ω 3 m r 3 m 2 using the fourier cosine transform to eq 6 one can obtain b5 lim r 0 d s r n d r lim r 0 d n π k r q 2 π r d 1 m s i n n π d 1 d q 2 π r d 3 m s i n n π d 1 d 2 d with eq b4 and the properties of the modified bessel function as described in eqs a12 a13 and a14 one has b6 lim r 0 d s r n d r 1 2 lim r 0 c 4 1 r m ω γ 2 3 m ω 3 m 2 3 m combining eqs b5 and b6 the constant c 4 can be given as b7 c 4 2 d ω 3 m 2 3 m q 2 π d 1 m s i n n π d 1 d q 2 π d 3 m s i n n π d 1 d 2 d n π k r ω γ 2 3 m substituting eq b7 to eq b4 one can obtain b8 s r n 2 d ω 3 m 2 3 m q 2 π d 1 m s i n n π d 1 d q 2 π d 3 m s i n n π d 1 d 2 d n π k r ω γ 2 3 m r 1 m 2 k 1 m 3 m 2 ω 3 m r 3 m 2 applying the inverse of fourier cosine transform to eq b8 one has b9 s r z 1 d s r 0 2 d n 1 s r n cos n π z d when n 0 eq b2 with corresponding boundary conditions can be solved using similar methods then using properties of the modified bessel function from eq a12 to eq a14 the term s r 0 in eq b9 can be obtained as b10 s r 0 q 2 π d 1 m d 1 q 2 π d 3 m d 3 k r γ 2 3 m 3 m r 1 m substituting eqs b8 and b10 to eq b9 we can eventually obtain the steady state analytical solution in the time domain 
403,precipitation and dissolution are prime processes in carbonate rocks and being able to monitor them is of major importance for aquifer and reservoir exploitation or environmental studies electrical conductivity is a physical property sensitive both to transport phenomena of porous media and to dissolution and precipitation processes however its quantitative use depends on the effectiveness of the petrophysical relationship to relate the electrical conductivity to hydrological properties of interest in this work we develop a new physically based model to estimate the electrical conductivity by upscaling a microstructural description of water saturated fractal porous media this model is successfully compared to published data from both unconsolidated and consolidated samples or during precipitation and dissolution numerical experiments for the latter we show that the permeability can be linked to the predicted electrical conductivity keywords electrical conductivity fractal model dissolution and precipitation processes carbonate rocks permeability 1 introduction carbonates represent a large part of the sedimentary rocks covering the earth and carbonate aquifers store a large part of fresh water which is a key resource for society needs karst aquifers are extremely complex systems because of the important chemical interactions between rock matrix and water leading to strong chemical processes such as dissolution and precipitation studying these environments can benefit from the use of non invasive tools such as the ones propose in hydrogeophysics to monitor flow and transport quantitatively e g hubbard and linde 2011 binley et al 2015 among the geophysical methods used for hydrological purposes in carbonate formations electrical and electromagnetic methods have already shown their usefulness and are increasingly used e g chalikakis et al 2011 revil et al 2012 binley et al 2015 electrical methods such as direct current dc resistivity and induced polarization ip involve acquisitions with flexible configurations of electrodes in galvanic or capacitive contact with the subsurface hubbard and linde 2011 these methods are increasingly used in different approaches to cover a larger field of applications from samples measurements in the lab e g wu et al 2010 to measurements in one or between several boreholes e g daily et al 1992 and 3d or 4d monitoring with time lapse imaging or with permanent surveys e g watlet et al 2018 saneiyan et al 2019 mary et al 2020 geophysical methods based on electromagnetic induction emi consist in the deployment of electromagnetic coils in which an electric current of varying frequency is injected depending on the frequency range the distance and size of the coils for injection and reception the depth of investigation can be highly variable reynolds 1998 as for the electrical methods emi based methods can be deployed from the ground surface in boreholes and in an airborne manner e g paine 2003 these methods enable to determine the spatial distribution of the electrical conductivity in the subsurface they are hence very useful in karst system to detect the emergence of a sinkhole to identify infiltration area or to map ghost rock features e g jardani et al 2006 chalikakis et al 2011 kaufmann and deceuster 2014 watlet et al 2018 the electrical conductivity can then be related to properties of interest for hydrogeological characterization through the use of accurate petrophysical relationships binley and kemna 2005 in recent works electrical conductivity models are used to characterize chemical processes between rock matrix and pore water such as dissolution and precipitation e g leroy et al 2017 niu and zhang 2019 indeed geoelectrical measurements are an efficient proxy to describe pore space geometry e g garing et al 2014 jougnot et al 2018 and transport properties e g jougnot et al 2009 2010 hamamoto et al 2010 maineult et al 2018 the electrical conductivity σ s m of a water saturated porous medium e g carbonate rocks is a petrophysical property related to electrical conduction in the electrolyte through the transport of charges by ions then σ is linked to pore fluid electrical conductivity σw s m and to porous medium microstructural properties such as porosity ϕ pore geometry and surface roughness archie 1942 proposed a widely used empirical relationship for clean clay free porous media that links σ and σw to ϕ as follows 1 σ σ w ϕ m where m is the cementation exponent defined between 1 3 and 4 4 for unconsolidated samples and for most of well connected sedimentary rocks e g friedman 2005 for low pore water conductivity porous medium electrical conductivity can also depend on a second mechanism which can be described by the surface conductivity term σs s m this contribution to the overall rock electrical conductivity is caused by the presence of charged surface sites on the minerals this causes the development of the so called electrical double layer edl with counterions i e ions of the opposite charges distributed in the stern layer and the diffuse layer hunter 1981 chelidze and gueguen 1999 leroy and revil 2004 groundwater in carbonate reservoirs typically presents a conductivity comprised between 3 0 10 2 s m and 8 0 10 2 s m e g liñán baena et al 2009 meyerhoff et al 2014 jeannin et al 2016 while carbonate rich rocks surface conductivity can range from 2 9 10 4 s m to 1 7 10 2 s m depending on the amount of clay guichet et al 2006 li et al 2016 soueid ahmed et al 2020 thus for the study of dissolution and precipitation of water saturated carbonate rocks at standard values of σw the surface conductivity is generally low and can be neglected e g cherubini et al 2019 the small surface conductivity can nevertheless be considered as a parallel conductivity with an adjustable value e g waxman and smits 1968 weller et al 1958 revil et al 2014 2 σ 1 f σ w σ s the formation factor f is thus assessed using a petrophysical law besides since the late 1950 s many models linking σ to σw were developed most of these relationships have been obtained from the effective medium theory e g pride 1994 bussian 1983 revil et al 1998 ellis et al 2010 volume averaging e g linde et al 2006 revil and linde 2006 the percolation theory e g broadbent and hammersley 1957 hunt et al 2014 or the cylindrical tube model e g pfannkuch 1972 kennedy and herrick 2012 more recently the use of fractal theory e g yu and li 2001 mandelbrot 2004 of pore size has shown good results to describe petrophysical properties among which the electrical conductivity e g guarracino and jougnot 2018 thanh et al 2019 meanwhile several models have been developed to study macroscopic transport properties and chemical reactions by describing the porous matrix microscale geometry e g reis and acock 1994 guarracino et al 2014 niu and zhang 2019 and theoretical petrophysical models of electrical conductivity have been derived to relate the pore structure to transport parameters e g johnson et al 1986 revil and cathles 1999 glover et al 2006 permeability prediction from electrical measurements is the subject of various research studies and these models often rely on petrophysical parameters such as the tortuosity e g revil et al 1998 niu and zhang 2019 moreover the use of models such as archie 1942 and carman 1939 to relate the formation factor the porosity and the permeability is reasonable for simple porous media such as unconsolidated packs with spherical grains but it is less reliable for real rock samples or to study the effect of dissolution and precipitation processes the aim of the present study is to develop a petrophysical model based on micro structural parameters such as the tortuosity the constrictivity i e parameter which is related to bottleneck effect in pores described by holzer et al 2013 and the johnson length e g johnson et al 1986 bernabé and maineult 2015 to express the electrical conductivity and to evaluate the role of pore structure the present manuscript is divided into three parts we first develop equations to describe the electrical conductivity of a porous medium with pores defined as tortuous capillaries that follow a fractal size distribution and presenting sinusoidal variations of their aperture then the model is linked to other transport parameters such as permeability and ionic diffusion coefficient in the second part we test the model sensitivity and we compare its performance with thanh et al 2019 fractal model in the third part we confront the model to datasets presenting an increasing complexity first data come from synthetic unconsolidated samples then they are taken from natural rock samples with a growing pore space intricacy finally we analyze the model response to numerical simulations of dissolution and precipitation highlighting its interest as a monitoring tool for such critical processes 2 theoretical developments based on the approach of guarracino et al 2014 we propose a model assuming a porous medium represented as a fractal distribution of equivalent tortuous capillaries in a cylindrical representative elementary volume rev with a radius r m and a length l m fig 1 a in this model the surface conductivity σs is neglected σ s 0 2 1 pore scale 2 1 1 pore geometry the porous medium is conceptualized as an equivalent bundle of capillaries as presented in fig 1b each tortuous pore present a varying radius r x m defined with the following sinusoidal expression 3 r x r r sin 2 π λ x r 1 2 a sin 2 π λ x where r is the average pore radius m r the amplitude of the radius size fluctuation m and λ is the wavelength m the parameter a is the pore radius fluctuation ratio defined by a r 2 r which values range from 0 to 0 5 note that a 0 corresponds to cylindrical pores r x r while a 0 5 corresponds to periodically closed pores for each pore we define the section area a p x π r x 2 m2 most of the models found in the literature and describing the porous medium with a fractal distribution define a pore length scaling with pore radius e g yu and cheng 2002 yu et al 2003 guarracino et al 2014 thanh et al 2019 however in this study we consider a constant tortuous length l m for all the pores because it reduces the number of adjustable parameters while maintaining the model accuracy this constant tortuosity value should be interpreted as an effective macroscopic value for all tube lengths l is the length taken at the center of the capillary thus the tortuosity τ is also a constant for all pores and is defined as 4 τ l l in this case the volume of a single pore v p r m3 can be computed by integrating its section area ap x over the tortuous length l 5 v p r 0 l π r x 2 d x according to eqs 3 and 4 and assuming that λ l volume vp defined in eq 5 becomes 6 v p r π r 2 1 2 a 2 τ l 2 1 2 pore electrical conductivity we express electrical properties at pore scale before obtaining them for the porous medium by upscaling because the rev can be considered as an equivalent circuit of parallel conductances when σs is neglected the electrical conductance σ p o r e r s of a single sinusoidal pore is defined by 7 σ p o r e r 0 l 1 σ w π r x 2 d x 1 where σw s m is the pore water conductivity replacing eq 3 in eq 7 and assuming λ l the electrical conductance of a single pore can be expressed as 8 σ p o r e r σ w π r 2 1 4 a 2 3 2 τ l following ohm s law the electric voltage δv v between the edges of the capillary 0 and l is defined as 9 δ v i r σ p o r e i r where i r a is the electric current flowing through the pore that can be expressed as follows 10 i r π σ w r 2 1 4 a 2 3 2 τ l δ v we thus define the contribution to the porous medium conductivity from a single pore σ p r s m by multiplying the pore conductance with a geometric factor f g π r 2 l m 11 σ p r σ p o r e r f g r 2 1 4 a 2 3 2 σ w τ r 2 when a 0 the expression of σ p r simplifies itself as in the case of cylindrical tortuous pores developed by pfannkuch 1972 2 2 upscaling procedure using a fractal distribution to obtain the electrical conductivity of the porous medium at the rev scale we need a pore size distribution we conceptualize the porous medium by a fractal distribution of capillaries according to the notations of guarracino et al 2014 and thanh et al 2019 based on the fractal theory for porous media tyler and wheatcraft 1990 yu and cheng 2002 12 n r r m a x r d p where n is the number of capillaries whose average radius are equal or larger than r dp is the fractal dimension of pore size and r max m is the maximum average radius of pores in the rev fractal distributions can be used to describe objects of different euclidean dimensions e g 1 dimension for a line 2 dimensions for a surface and 3 dimensions for a volume in this study the pore size distribution is considered as a fractal distribution of capillary sections on a plane i e in 2 dimensions therefore the fractal dimension dp is defined from 1 to 2 among many other papers see yu and cheng 2002 yu et al 2003 nevertheless dp is a unique parameter for each porous medium as it strongly depends on the pore size distribution its impact has been quantified by tyler and wheatcraft 1990 with a porous medium defined as a sierpinski carpet from the pore size distribution defined in eq 12 the total number of capillaries equals to 13 n t o t r max r min d p with r min m the minimum average radius from eq 12 the number of radii lying between r and r d r is 14 d n d p r max d p r d p 1 d r where d n is the number of pores with an average radius comprised in the infinitesimal range between r and r d r the minus sign implies that the number of pores decreases when the average radius increases yu et al 2003 soldi et al 2017 thanh et al 2019 2 3 rev scale in the present section we present the macroscopic properties at the rev scale obtained from the upscaling procedure 2 3 1 porosity we can express the porosity ϕ of the rev by integrating the pore volume over the fractal distribution as follows 15 ϕ r min r max v p r d n π r 2 l then by replacing eqs 14 and 6 into eq 15 it yields to 16 ϕ 1 2 a 2 τ d p r max d p r 2 2 d p r max 2 d p r min 2 d p this expression requires 2 d p 0 which is always true see yu and li 2001 note that this expression corresponds to the model of guarracino et al 2014 when the tortuosity is the same for all the capillary sizes 2 3 2 electrical conductivity as defined in the kirchhoff s current law the electric current of the rev i a is the sum of the electric currents of all the capillaries when the surface conductivity is neglected it can be obtained by integrating the electric current of each pore 17 i r min r max i r d n according to eqs 4 10 and 14 i can be expressed as follows 18 i σ w π 1 4 a 2 3 2 d p r max d p 2 d p τ l δ v r max 2 d p r min 2 d p the ohm s law at the rev scale yields to 19 i σ r e v π r 2 δ v l where σrev is the electrical conductivity of the rev s m by combining eqs 18 and 19 σrev is expressed as 20 σ r e v σ w d p r max d p 1 4 a 2 3 2 r 2 τ 2 d p r max 2 d p r min 2 d p finally substituting eq 16 into eq 20 yields to 21 σ r e v σ w ϕ 1 4 a 2 3 2 τ 2 1 2 a 2 note that if a 0 and τ 1 eq 21 becomes σ r e v σ w ϕ which is the expression of archie s law for m 1 where the porous medium is composed of a bundle of straight capillaries with no tortuosity see clennell 1997 the electrical conductivity can be rewritten depending on the tortuosity τ and on the constrictivity f as 22 σ r e v σ w ϕ f τ 2 the constrictivity f is thus defined as 23 f 1 4 a 2 3 2 1 2 a 2 the above equation highlights that the pore fluctuation ratio a plays the role of the constriction factor defined by petersen 1958 constrictivity f ranges between 0 e g for trapped pores and 1 e g for cylindrical pores with constant radius as for the tortuosity τ there is no suitable method to determine constrictivity value directly from core samples but only some mathematical expressions for ideal simplified geometries see holzer et al 2013 for a review therefore very high tortuosity values e g niu and zhang 2019 must be due to that in most studies the bottleneck effect is not considered 2 3 3 formation factor the model from archie 1942 links the rock electrical conductivity to the pore water conductivity and the porosity with the cementation exponent which is an empirical parameter kennedy and herrick 2012 propose to analyze electrical conductivity data using a physics based model which conceptualizes the porous medium with pore throats and pore bodies as in this study and defines the electrical conductivity as follows 24 σ r e v g σ w ϕ where g is an explicit geometrical factor defined between 0 and 1 according to our models g can be expressed by 25 g 1 4 a 2 3 2 τ 2 1 2 a 2 f τ 2 this geometrical factor can be called the connectedness glover 2015 while the formation factor f is defined by 26 f σ w σ r e v substituting eq 21 into eq 26 yields to 27 f τ 2 1 2 a 2 ϕ 1 4 a 2 3 2 τ 2 ϕ f the formation factor f can also be related to the connectedness g as f 1 ϕ g 2 4 evolution of the petrophysical parameters the formation factor defined by eq 27 depends linearly with the inverse of porosity 1 ϕ however the petrophysical parameters a and τ may be dependent on porosity for certain types of rocks or during dissolution or precipitation processes in these cases the formation factor will show a non linear dependence with 1 ϕ and can be expressed in general as 28 f ϕ τ ϕ 2 1 2 a ϕ 2 ϕ 1 4 a ϕ 2 3 2 in section 4 2 we test our model against different datasets from literature using logarithmic laws for the dependence of petrophysical parameters a ϕ and τ ϕ with porosity following existing models from the literature see ghanbarian et al 2013 for a review about the tortuosity thus we define a ϕ and τ ϕ as 29 a ϕ p a log ϕ and 30 τ ϕ 1 p τ log ϕ where pa and pτ are empirical parameters note that 0 and 1 i e first terms in eqs 29 and 30 respectively correspond to the minimum values reached by a ϕ and τ ϕ when ϕ 1 expressing tortuosity as a logarithmic function of porosity has already proven its effectiveness in the literature comiti and renaud 1989 ghanbarian et al 2013 zhang et al 2020 however this is to the best of our knowledge the first attempt to propose a constrictivity model as a function of porosity then by replacing eqs 29 and 30 in eq 28 the expression of the proposed model for the formation factor f becomes 31 f ϕ 1 p τ log ϕ 2 1 2 p a log ϕ 2 ϕ 1 4 p a log ϕ 2 3 2 note that the model parameters from thanh et al 2019 another porous medium description following a fractal distribution of pores also present logarithmic dependencies with the porosity ϕ 2 5 electrical conductivity and transport parameters 2 5 1 from electrical conductivity to permeability the electrical conductivity is a useful geophysical property to describe the pore space geometry here we propose to express the permeability as a function of the electrical conductivity using our model at pore scale sisavath et al 2001 propose the following expression for the flow rate q p r m3 s in a single capillary 32 q p r π 8 ρ g μ δ h l 0 l 1 r 4 x d x 1 where ρ is the water density kg m3 g is the standard gravity acceleration m s2 μ is the water viscosity pa s and δh is the hydraulic head across the rev m substituting eq 3 in eq 32 and assuming λ l it yields 33 q p r π 8 ρ g μ δ h τ l r 4 1 4 a 2 3 2 then the total volumetric flow rate qrev m3 s is obtained by integrating eq 33 over all capillaries i e at the rev scale 34 q rev r min r max q p r dn ρ g 1 4 a 2 3 2 d p r max d p π δ h 8 μ 4 d p τ l r max 4 d p r min 4 d p based on darcy s law for saturated porous media the total volumetric flow rate can be expressed as 35 q r e v π r 2 ρ g μ k r e v δ h l where krev is the rev permeability m2 then combining eqs 34 and 35 it yields to 36 k r e v 1 4 a 2 3 2 d p r max d p 8 r 2 4 d p τ r max 4 d p r min 4 d p considering r min r max eq 36 can be simplified as 37 k r e v 1 4 a 2 3 2 d p r max 4 8 r 2 4 d p τ using the same simplification on eq 16 the expression of porosity becomes 38 ϕ 1 2 a 2 τ d p r max 2 r 2 2 d p then combining eqs 37 and 38 yields to 39 k r e v 2 d p 4 d p 1 4 a 2 3 2 1 2 a 2 r max 2 8 τ 2 ϕ finally the combination of eqs 27 and 39 leads to 40 k r e v 2 d p 4 d p r max 2 8 f note that eq 40 relates permeability to electrical conductivity through the formation factor see eq 26 this expression can be linked to the model of johnson et al 1986 41 k r e v λ 2 8 f where λ also known as the johnson length is a characteristic pore size m of dynamically connected pores banavar and schwartz 1987 ghanbarian 2020 some authors proposed theoretical relationships to determine this characteristic length λ while revil and cathles 1999 or glover et al 2006 link it to the average grain diameter some other publications work on the determination of λ assuming a porous medium composed of cylindrical pores e g banavar and johnson 1987 niu and zhang 2019 considering the proposed model λ can therefore be written as follows 42 λ 2 d p 4 d p r max 2 5 2 from electrical conductivity to ionic diffusion coefficient ionic diffusion can be described at rev scale by the fick s law fick 1995 43 j t d e f f π r 2 δ c l where jt mol s is the diffusive mass flow rate deff m2 s is the effective diffusion coefficient and δc mol m3 is the solute concentration difference between the rev edges guarracino et al 2014 propose to express deff as a function of the tortuosity which in their model depends on the capillary size in our model we consider that the tortuosity is constant thus by reproducing the same development proposed by guarracino et al 2014 we obtain 44 d e f f d w 1 4 a 2 3 2 ϕ 1 2 a 2 τ 2 which can be simplified as 45 d e f f d w f ϕ τ 2 this last expression of deff as a function of the tortuosity τ and the constrictivity f allows to retrieve the same equation as van brakel and heertjes 1974 with both the effect of the tortuosity and the constrictivity replacing eq 27 in eq 45 yields to 46 d e f f d w f which implies 47 f σ w σ r e v d w d e f f this result has already been demonstrated by kyi and batchelor 1994 and jougnot et al 2009 among others it means that the formation factor can be used for both electrical conductivity or diffuse properties this point is consistent with the fact that ohm and fick laws are diffusion equations where the transport of ions take place in the same pore space the difference lies in the fact that ionic conduction and ionic diffusion consider the electric potential gradient and the ionic concentration gradient respectively 3 model analysis and evaluation our model expresses the evolution of the formation factor f as a function of the porosity ϕ the tortuosity τ and the constrictivity through the pore radius fluctuation ratio a eq 27 here we explore wide ranges of values for a and τ to quantify their influence on the formation factor f fig 2 and compare our model with the model from thanh et al 2019 for the fractal dimension of the tortuosity dτ 1 to appreciate the contribution of the constrictivity to the porous medium description fig 2a and b show variations of f as a function of the porosity ϕ when only a or τ varies on fig 2a parameter a varies from 0 to 0 49 and tortuosity τ 5 0 we test the case of a constant pore aperture when a 0 but we do not reach a 0 5 because this means that the pores are periodically closed see the definition of a in section 2 1 1 and this corresponds to an infinitely resistive rock only made of non connected porosity on fig 2b tortuosity τ varies from 1 to 20 and parameter a 0 1 τ 1 implies straight pores i e l l fig 2c present variations of f as a function of the tortuosity τ for different values of a and a fixed porosity ϕ 0 4 fig 2d is the density plot of log10 f for a range of values of a and τ and with a fixed porosity value ϕ 0 4 from the analysis of fig 2a and b one can note that the formation factor decreases when porosity increases this was expected because more the water saturated medium is porous more its electrical conductivity is close to pore water electrical conductivity furthermore we observe that both parameters a and τ have a strong effect on formation factor variation ranges indeed f ϕ curve can be shifted by more than 3 orders of magnitude with variations of a or τ and as expected the formation factor increases when τ or a increases indeed when these parameters increase the porous medium becomes more complex the increase of parameter a means that periodical aperture of capillaries decreases i e more constrictivity while the increase of τ means that pores become more tortuous i e more tortuosity besides for a close to 0 i e without aperture variation curves from thanh et al 2019 model are similar with the curves from our model this is consistent with the fact that thanh et al 2019 also conceptualize the porous media as a fractal distribution of capillaries however when a increases the curves explore very different ranges of f values fig 2a and c the density plot presented on fig 2d compares the effect of a and τ variations for a constant porosity ϕ 0 4 it appears that for a fixed value of τ variations of a have a low effect on log of f values on the contrary variations of τ for one value of a have stronger effect on log of f ranges however it should be noted that this representation can be biased because value ranges of a and τ are very different thus it is difficult to asses if the tortuosity τ has really much more effect on formation factor than parameter a nevertheless it has the advantage to represent the combined effect of a and τ on the formation factor 4 results and discussion to assess the performance of the proposed model we compare predicted values to datasets from the literature are listed in table 1 and ordered with a growing complexity indeed data from friedman and robinson 2002 and bolève et al 2007 are taken from experiments made on unconsolidated medium then garing et al 2014 revil et al 2014 and cherubini et al 2019 studied natural consolidated samples from carbonate rocks and sandstone samples finally niu and zhang 2019 present numerical but dynamic data under dissolution and precipitation conditions for each dataset the adjusted parameters of the proposed model are listed in table 1 values have been determined using a monte carlo inversion of eqs 21 and 27 which express the porous medium electrical conductivity σrev as a function of the pore water conductivity σw and the formation factor f as a function of the porosity ϕ respectively an additional term σs for the surface conductivity s m is used to fit the data out of the application range of the proposed model that is for low values of pore water conductivity when the surface conductivity cannot be neglected as the proposed model is intended to be mostly used on carbonate rocks which are known to have low surface conductivity this physical parameter has not been taken into account in the theoretical development of the expression of the electrical conductivity of the porous medium however it can be added considering a parallel model e g waxman and smits 1968 börner and schön 1991 48 σ r e v 1 f σ w σ s a more advanced approach of parallel model is proposed by thanh et al 2019 including the contribution of the surface conductance in the overall capillary bundle electrical conductivity table 1 lists also the computed error ϵ of the adjusted model in statistics ϵ is called the mean absolute percentage error mape it is expressed in percent and defined as follow 49 ϵ 1 n d i 1 n d p i m p i d p i d 100 where nd pd and pm refer to the number of data the electrical property from data and the electrical property from the model respectively this type of error has been chosen to compare the ability of the model to reproduce the experimental values for all the datasets even if they are expressed as σrev σw or as f ϕ 4 1 testing the model on unconsolidated media the proposed model is first confronted to datasets from friedman and robinson 2002 and bolève et al 2007 obtained for unconsolidated samples in these tests only one set of parameters a τ and σs when needed is adjusted to fit with each dataset bolève et al 2007 measured the electrical conductivity of glass beads samples for different values of the pore water conductivity σw from 10 4 s m to 10 1 s m on s1a s2 s3 s4 s5 and s6 see fig 3 for all samples bolève et al 2007 reported a constant porosity of 40 while grain diameters are comprised between 56 µm for s1a and 3000 µm for s6 see fig 3 for more details table 1 shows that the adjusted model parameters a and τ have rather similar values for all the samples from bolève et al 2007 this can be explained by the fact that all samples have the same pore geometry but scaled at different size indeed for homogeneous samples of glass beads the beads space arrangement is quite independent of the spheres size therefore the pore network of all samples presents similar properties such as tortuosity see also the discussion in guarracino and jougnot 2018 and constrictivity which directly depends on parameters a and τ moreover a and τ are close to their minimum limits i e a 0 and τ 1 this is due to the simple pore space geometry created by samples made of homogeneous glass spheres this explains the model good fit for straight capillaries i e thanh et al 2019 however it can be noticed that surface conductivity decreases while grain diameter increases this is not a surprise considering that for the same volume samples of smaller beads have a larger specific surface than samples of bigger beads see for example the discussion in glover and déry 2010 friedman and robinson 2002 determined the formation factor f for samples of glass beads sand and tuff grains with different values of porosity ϕ see fig 4 as the model best fit is determined with a monte carlo approach accepted models are also plotted on fig 4 the acceptance criterion is defined individually for each dataset and corresponds to a certain value of the mape ϵ for samples from friedman and robinson 2002 this criterion is fixed at ϵ 1 or 2 these are low values meaning a really good fit from the model we observe from table 1 that a and τ values are close to each other for all samples from friedman and robinson 2002 however these parameters have higher values than for bolève et al 2007 dataset this comes from the fact that some complexity is added in the dataset from friedman and robinson 2002 indeed the samples of friedman and robinson 2002 combine particles of different sizes in this case smaller grains can fill the voids left by bigger grains this grains arrangement decreases the medium porosity but increases its tortuosity and constrictivity furthermore sand and tuff grains have rougher surface and are less spherical than glass beads this explains the misfit increase between data and model for glass sand and tuff samples friedman and robinson 2002 nevertheless even for tuff grains the misfit between data and model is still very low compared to the computed mape from bolève et al 2007 samples this is due to that for bolève et al 2007 a wide range of pore water conductivity values is explored and thus electrical properties vary much more over 3 orders of magnitude than in the case of friedman and robinson 2002 4 2 testing the model on consolidated rock samples in this section we test our model against datasets of garing et al 2014 revil et al 2014 and cherubini et al 2019 they study carbonate samples from the reef unit of ses sitjoles site from mallorca fontainebleau sandstones and two estaillades limestones rodolith packstones respectively revil et al 2014 obtained a wide range of formation factor values for a large set of fontainebleau sandstone core samples over a large range of porosity we first test our model with constant values of a and τ but we observed that the model could not fit data see fig 5 a this can be explained by the fact that this dataset is composed of numerous sandstone samples presenting a wide range of porosity values from 0 045 to 0 22 therefore we consider that the samples have distinct pore geometry which is describable by a ϕ and τ ϕ distributions presented in section 2 4 and plotted on fig 5b and c we observe that parameters a and τ logarithmic evolution with the porosity ϕ are physically plausible as lower porosity can reflect more complex medium geometries i e more constrictive and more tortuous described with higher values of a and τ on fig 5a we also plot the model from thanh et al 2019 even if the curve presents a slope similar to dataset it overestimates the formation factor despite a quite wide dispersion of the formation factor data for the lowest porosities it appears that the proposed model is well adjusted to the dataset indeed the proposed model mape ϵ 22 62 see table 1 while ϵ 89 63 for the model from thanh et al 2019 note that the relatively high mape value comes from the large spread of the formation factor values thus it seems that taking into account the constrictivity of the porous medium in addition to the tortuosity highly improves modeling fig 6 shows the dependence of electrical conductivity with pore water electrical conductivity for two limestone samples named l1 and l2 from cherubini et al 2019 table 1 shows that model parameters and surface conductivity values are larger than for the unconsolidated samples from bolève et al 2007 and friedman and robinson 2002 this is explained by the fact that natural rock samples can present a more complex geometry and larger specific surface area than glass beads samples cherubini et al 2019 predict the surface electrical conductivity with the model from revil et al 2014 they obtain σ s 7 0 10 4 s m which is very close to the value obtained in this study furthermore the computed errors for the dataset of bolève et al 2007 and for these limestones are close to each other this test illustrates that even for more complex porous media the proposed model has still a good data resolution garing et al 2014 conducted x ray microtomography measurements on carbonate samples to classify them by pore types and thus they highlight three groups 1 inter samples present intergranular pores this pore shape is quite comparable with sandstones porosity type 2 multi samples hold multiple porosity types intergranular moldic and vugular microtomograms of multi samples show small but well connected pores the analyze conducted by garing et al 2014 revealed that for samples with smaller porosity pores are smaller on average but still numerous and well connected even for a reduced microporosity 3 vuggy samples possess vugular porosity microtomography highlights the presence of few vugs badly connected which are less numerous for samples of lower porosity fig 7 presents the results of formation factor computation versus porosity as for the dataset from revil et al 2014 the proposed model is adjusted using eq 31 which considers that model parameters are logarithmic functions of porosity despite some dispersion for inter and vuggy samples i e the acceptance criterion ϵ 40 the model explains well the data for all porosity types and present low mape values table 1 the analysis of parameters pa and pτ reveals that they present consistent values for the different porosity types indeed for vuggy samples pa is small while pτ is high fig 7c according to eqs 29 and 30 these values lead to low and high values for a and τ respectively table 1 and this is consistent with the microtomography analysis from garing et al 2014 indeed since these samples present large vugs badly connected i e few microporosity the microstructure is very tortuous but pores are not constricted furthermore for samples with lower porosity vugs are still present in vuggy samples but they are less numerous which leads to a microstructure even more tortuous but nearly as constrictive as for the more porous samples moreover for inter and multi samples fig 7a and b pa and pτ are closer in value to the parameters of the sandstone samples from revil et al 2014 than to the parameters of vuggy samples because they have among other types for the multi samples intergranular porosity note that higher pτ value can be attributed to the more complex structure of carbonate minerals compared to sandstone samples furthermore the high value of pa for the multi samples can be explained with the microtomography observations from garing et al 2014 indeed constrictivity increases a lot for samples with lower porosity because microporosity is reduced while there are less molds and vugs consequently we conclude that this detailed analysis of model parameters help us to retrieve some characteristic features of the pore space from electrical conductivity measurement 4 3 electrical conductivity monitoring of precipitation and dissolution processes in this section we consider the numerical datasets from niu and zhang 2019 these authors conduct numerical simulations of dissolution and precipitation reactions on digital representations of microstructural images they simulate the dissolution of a carbonate mudstone sample and the precipitation of a sample of loosely packed ooids for the carbonate mudstone sample the pore space image is obtained from a microtomography scan while the ooids sample is a synthetic compression of sparsely distributed spherical particles niu and zhang 2018 the carbonate mudstone sample has an initial porosity of 13 and the ooids sample has an initial porosity of 30 2 in numerical simulations the main hypothesis of niu and zhang 2019 is that fluid transport is advection dominated then under this condition they studied two limiting cases for both dissolution and precipitation the transport limited case and the reaction limited case nunes et al 2016 in the transport limited case the reaction at the solid liquid interface is limited by the diffusion of reactants to and from the solid surface in the reaction limited case the reaction is limited by the reaction rate at the solid liquid interface their results are presented in figs 8 a b and 9 a b it appears that for both precipitation and dissolution the transport limited case influences the most electrical and fluid flow properties indeed it can be seen in fig 8a that for reaction limited precipitation a 10 decrease in porosity leads to an increase in the formation factor from 7 5 to 20 while for transport limited precipitation the formation factor reaches 140 for a porosity decrease of less than 2 in case of dissolution fig 8b for a similar decrease of the formation factor porosity increases only by 3 in the transport limited case while it has to increase by 15 in the reaction limited case the same observations can be made on fig 9a and b the variations of permeability are much greater in the transport limited case than in the reaction limited case for a lower porosity variation the authors of this study justify the shapes of f and krev curves with their observations on the digital representations of the microstructural evolution in the reaction limited case they observe that precipitated or dissolved minerals are uniformly distributed over grain surfaces this consequently barely affects electrical and fluid flow properties on the contrary in the transport limited case dissolution and precipitation mainly occur in some specific areas where fluid velocity is high this significantly modifies electrical and fluid flow patterns in the case of transport limited precipitation new particles accumulate in pore throats while minerals are preferentially dissolved in the already well opened channels to adjust the proposed model to the data a first set of parameters a and τ has been determined at the initial state with the monte carlo approach then only parameter a is adjusted with the model to each new data point using the least square method we consider that only a is affected by dissolution and precipitation because these processes mostly affect the pore shape indeed the results of the pore network modeling developed by steinwinder and beckingham 2019 to simulate the impact of pore scale alterations by dissolution and precipitation on permeability show that pore throats are important parameters to take into account however for the proposed model of this study the assumption that only a varies requires slow processes of dissolution and precipitation in order to keep the cylindrical shape of pores guarracino et al 2014 besides we fit parameter a at each time step rather than using the logarithmic law since it lacks physical meaning to explain this parameter time evolution niu and zhang 2019 computed the hydraulic tortuosity τh from the simulated fluid velocity field for all of their data they found nearly constant values defined between 1 and 2 as we computed τ 1 3 and τ 1 8 in precipitation and dissolution respectively these results are within the predicted range of the simulated data from niu and zhang 2019 and confirm our hypothesis that constrictivity is the pore feature most impacted by dissolution and precipitation processes however to interpret the evolution of the formation factor during dissolution f decreases and precipitation f increases niu and zhang 2019 computed the electrical tortuosity τ e f ϕ no unit of their porous medium and obtained high values from 2 to 200 varying over 1 to 2 decades for the transport limited cases these overestimated values of the medium tortuosity highlight that constrictivity and the bottleneck effect should not be neglected to evaluate how dissolution and precipitation processes affect the pore structure fig 8 a and b show that in each case the proposed model accurately fits the data with computed errors lower than 1 see table 1 as presented on fig 8c and d parameter a follows monotonous variations it decreases when the porosity increases we define a as the ratio of the sinusoidal pore aperture r over the mean pore radius r see the definition of a in section 2 1 1 when a increases it can be caused by the increase of r which involves a stronger periodical constriction of the pore aperture and or by the decrease of the mean pore radius r on the contrary when a decreases it implies the increase of r and or the decrease of r which lead to thicker pores with smoother pore walls respectively these variations are consistent with the fact that precipitation and dissolution affect the pore geometry through the sample in case of precipitation pore throats shrink while they are enlarged with dissolution it can also be observed on fig 8c and d that a shows stronger variations in the transport limited case than in the reaction limited case this is consistent with the fact that transport limited reactions occur in localized areas which will strongly affect the pore properties the relation between the permeability krev and the johnson length λ is obtained by combining eqs 39 and 42 50 k r e v λ 2 1 4 a 2 3 2 1 2 a 2 ϕ 8 τ 2 the values of parameters a and τ are taken from the adjusted models of the formation factor thus the johnson length λ is the only adjustable parameter to fit the data and is fitted with the least square method values are given in tables 1 and 2 on fig 9a and b one can observe that for each case the model accurately fits the data with computed errors lower than 1 see table 2 as presented on fig 9c and d parameter λ follows monotonous variations it increases with porosity it can also be observed that λ varies more in the transport limited case than in the reaction limited case for the reaction limited dissolution it is even nearly constant niu and zhang 2019 found johnson lengths with the same order of magnitude and with similar variations except in the case of transport limited precipitation where their values do not follow a monotonous behavior for low porosity values either way niu and zhang 2019 interpret the jonhson length as an effective radius of their porous medium which shows monotonous variations during precipitation λ decreases and dissolution λ increases in the proposed model the parameter a describes how dissolution and precipitation processes affect the shape of the pore radius i e its constrictivity while λ is linked to the fractal distribution of pore size dp and to the maximum average radius r max as we suppose dissolution and precipitation slow enough not to interfere with the pore size distribution dp remains constant for each sample on the contrary when dissolution or precipitations occurs it is expected for the pores to grow or to shrink respectively therefore the monotonous variations of λ highlight the increase or decrease of r max during dissolution or precipitation respectively this result is in accordance with the variations of a which can impact r consequently we describe the pore space evolution during dissolution and precipitation as illustrated in fig 10 indeed the decrease of a is caused by dissolution which enlarges the pore and flattens its pore walls on the contrary precipitation affects the pores by increasing a which means that pores shrink and become more periodically constricted because of r increase we thus believe that this interpretation of the electrical conductivity measurement is an important issue for future research on the impact of dissolution and precipitation on the pore shape 5 conclusion in the present work we express the electrical conductivity and the formation factor of the porous medium in terms of effective petrophysical parameters such as the tortuosity and the constrictivity the model is based on the conceptualization of the pore space as a fractal cumulative distribution of tortuous capillaries with a sinusoidal variation of their radius i e periodical pore throats by means of an upscaling procedure we link the electrical conductivity to transport parameters such as permeability and ionic diffusion coefficient the proposed model successfully predicts electrical conductivity and formation factor of unconsolidated samples and natural consolidated rock samples for datasets of sandstones or carbonates with large range of porosity values we set that a and τ follow logarithmic functions of ϕ these empirical relations allow the model to accurately fit the datasets on one hand for the sandstone samples the prediction fits much better than previously published models while on the other hand the model parameter analysis shows strong agreement with the porosity types description thanks to x ray microtomography investigations on carbonate samples even if our model is designed for porous media in which the surface conductivity can be neglected it is possible to take it into account at very low salinity we do not express it as a function of the pore structure parameters but determine its value empirically the comparison of its value with the one found for other models on the same datasets shows that this approach is consistent and reasonable for the purpose of this model the model is finally compared to a numerical dataset from simulations of dissolution and precipitation reactions on digital representations of microstructural images the model can reproduce structural changes linked to these processes by only adjusting a single parameter related to the medium constrictivity the pore radius fluctuation ratio a we observe that this parameter follows monotonous variations under dissolution or precipitation conditions that makes it a good witness of these chemical processes effect on the pore structure we believe that the present study contributes to a better understanding of the links between the electrical conductivity measurement the pore space characteristics and the evolution of the microstructural properties of the porous medium subjected to dissolution and precipitation processes therefore enhancing the possibility of using hydrogeophysical tools for the study of carbonate hydrosystems in the future we will extend this approach to partially saturated conditions and include these new petrophysical models in an integrated hydrogeophysical approach to better understand hydrosystems in the critical zone 6 notations parameter definition unit l rev length m r rev radius m r pore radius m r average pore radius m r amplitude of the radius size fluctuation m λ wavelength m a pore radius fluctuation ratio a p rev section area m 2 l tortuous length m τ tortuosity v p r volume of a single pore m 3 σ p o r e r electrical conductance of a single pore s ρ w pore water electrical resistivity ω m σ w pore water electrical conductivity s m δ v electric voltage v i r electric current flowing through a single pore a σ p r contribution to the porous medium conductivity from a single pore s m f g geometric factor m n r number of pores of radius equal or larger than r r max maximum average pore radius m d p fractal dimension of pore size n t o t total number of pores r min minimum average pore radius m ϕ porosity i rev electric current a σ r e v rev electrical conductivity s m f constrictivity g connectedness f formation factor q p r flow rate of a single pore m 3 s ρ density of water kg m 3 g standard gravity m s 2 μ water viscosity pa s δ h hydraulic charge across the rev m q r e v total volumetric flow rate m 3 s k r e v rev permeability m 2 λ johnson length m j t diffusive solute mass flow rate mol s d w water diffusion coefficient m 2 s d e f f effective diffusion coefficient m 2 s δ c solute concentration differences mol m 3 m cementation exponent σ s surface conductivity s m ϵ mean absolute percentage error n d number of data p i m electrical property from the model p i d electrical property from the data p a coefficient to define a ϕ p τ coefficient to define τ ϕ τ h hydraulic tortuosity τ e electrical tortuosity credit authorship contribution statement flore rembert conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization damien jougnot conceptualization methodology writing review editing supervision project administration funding acquisition luis guarracino conceptualization methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors warmly thank qifei niu and the other anonymous reviewer for the constructive comments that helped to greatly improve the manuscript quality the authors wish to thank the editor for the effective editing process the authors strongly thank the financial support of the cnrs insu ec2co program for funding the startrek système pétrophysique de caractérisation du transport réactif en milieu karstique project the authors are also very thankful for the wise comments of roger guérin supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2020 103742 appendix a supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
403,precipitation and dissolution are prime processes in carbonate rocks and being able to monitor them is of major importance for aquifer and reservoir exploitation or environmental studies electrical conductivity is a physical property sensitive both to transport phenomena of porous media and to dissolution and precipitation processes however its quantitative use depends on the effectiveness of the petrophysical relationship to relate the electrical conductivity to hydrological properties of interest in this work we develop a new physically based model to estimate the electrical conductivity by upscaling a microstructural description of water saturated fractal porous media this model is successfully compared to published data from both unconsolidated and consolidated samples or during precipitation and dissolution numerical experiments for the latter we show that the permeability can be linked to the predicted electrical conductivity keywords electrical conductivity fractal model dissolution and precipitation processes carbonate rocks permeability 1 introduction carbonates represent a large part of the sedimentary rocks covering the earth and carbonate aquifers store a large part of fresh water which is a key resource for society needs karst aquifers are extremely complex systems because of the important chemical interactions between rock matrix and water leading to strong chemical processes such as dissolution and precipitation studying these environments can benefit from the use of non invasive tools such as the ones propose in hydrogeophysics to monitor flow and transport quantitatively e g hubbard and linde 2011 binley et al 2015 among the geophysical methods used for hydrological purposes in carbonate formations electrical and electromagnetic methods have already shown their usefulness and are increasingly used e g chalikakis et al 2011 revil et al 2012 binley et al 2015 electrical methods such as direct current dc resistivity and induced polarization ip involve acquisitions with flexible configurations of electrodes in galvanic or capacitive contact with the subsurface hubbard and linde 2011 these methods are increasingly used in different approaches to cover a larger field of applications from samples measurements in the lab e g wu et al 2010 to measurements in one or between several boreholes e g daily et al 1992 and 3d or 4d monitoring with time lapse imaging or with permanent surveys e g watlet et al 2018 saneiyan et al 2019 mary et al 2020 geophysical methods based on electromagnetic induction emi consist in the deployment of electromagnetic coils in which an electric current of varying frequency is injected depending on the frequency range the distance and size of the coils for injection and reception the depth of investigation can be highly variable reynolds 1998 as for the electrical methods emi based methods can be deployed from the ground surface in boreholes and in an airborne manner e g paine 2003 these methods enable to determine the spatial distribution of the electrical conductivity in the subsurface they are hence very useful in karst system to detect the emergence of a sinkhole to identify infiltration area or to map ghost rock features e g jardani et al 2006 chalikakis et al 2011 kaufmann and deceuster 2014 watlet et al 2018 the electrical conductivity can then be related to properties of interest for hydrogeological characterization through the use of accurate petrophysical relationships binley and kemna 2005 in recent works electrical conductivity models are used to characterize chemical processes between rock matrix and pore water such as dissolution and precipitation e g leroy et al 2017 niu and zhang 2019 indeed geoelectrical measurements are an efficient proxy to describe pore space geometry e g garing et al 2014 jougnot et al 2018 and transport properties e g jougnot et al 2009 2010 hamamoto et al 2010 maineult et al 2018 the electrical conductivity σ s m of a water saturated porous medium e g carbonate rocks is a petrophysical property related to electrical conduction in the electrolyte through the transport of charges by ions then σ is linked to pore fluid electrical conductivity σw s m and to porous medium microstructural properties such as porosity ϕ pore geometry and surface roughness archie 1942 proposed a widely used empirical relationship for clean clay free porous media that links σ and σw to ϕ as follows 1 σ σ w ϕ m where m is the cementation exponent defined between 1 3 and 4 4 for unconsolidated samples and for most of well connected sedimentary rocks e g friedman 2005 for low pore water conductivity porous medium electrical conductivity can also depend on a second mechanism which can be described by the surface conductivity term σs s m this contribution to the overall rock electrical conductivity is caused by the presence of charged surface sites on the minerals this causes the development of the so called electrical double layer edl with counterions i e ions of the opposite charges distributed in the stern layer and the diffuse layer hunter 1981 chelidze and gueguen 1999 leroy and revil 2004 groundwater in carbonate reservoirs typically presents a conductivity comprised between 3 0 10 2 s m and 8 0 10 2 s m e g liñán baena et al 2009 meyerhoff et al 2014 jeannin et al 2016 while carbonate rich rocks surface conductivity can range from 2 9 10 4 s m to 1 7 10 2 s m depending on the amount of clay guichet et al 2006 li et al 2016 soueid ahmed et al 2020 thus for the study of dissolution and precipitation of water saturated carbonate rocks at standard values of σw the surface conductivity is generally low and can be neglected e g cherubini et al 2019 the small surface conductivity can nevertheless be considered as a parallel conductivity with an adjustable value e g waxman and smits 1968 weller et al 1958 revil et al 2014 2 σ 1 f σ w σ s the formation factor f is thus assessed using a petrophysical law besides since the late 1950 s many models linking σ to σw were developed most of these relationships have been obtained from the effective medium theory e g pride 1994 bussian 1983 revil et al 1998 ellis et al 2010 volume averaging e g linde et al 2006 revil and linde 2006 the percolation theory e g broadbent and hammersley 1957 hunt et al 2014 or the cylindrical tube model e g pfannkuch 1972 kennedy and herrick 2012 more recently the use of fractal theory e g yu and li 2001 mandelbrot 2004 of pore size has shown good results to describe petrophysical properties among which the electrical conductivity e g guarracino and jougnot 2018 thanh et al 2019 meanwhile several models have been developed to study macroscopic transport properties and chemical reactions by describing the porous matrix microscale geometry e g reis and acock 1994 guarracino et al 2014 niu and zhang 2019 and theoretical petrophysical models of electrical conductivity have been derived to relate the pore structure to transport parameters e g johnson et al 1986 revil and cathles 1999 glover et al 2006 permeability prediction from electrical measurements is the subject of various research studies and these models often rely on petrophysical parameters such as the tortuosity e g revil et al 1998 niu and zhang 2019 moreover the use of models such as archie 1942 and carman 1939 to relate the formation factor the porosity and the permeability is reasonable for simple porous media such as unconsolidated packs with spherical grains but it is less reliable for real rock samples or to study the effect of dissolution and precipitation processes the aim of the present study is to develop a petrophysical model based on micro structural parameters such as the tortuosity the constrictivity i e parameter which is related to bottleneck effect in pores described by holzer et al 2013 and the johnson length e g johnson et al 1986 bernabé and maineult 2015 to express the electrical conductivity and to evaluate the role of pore structure the present manuscript is divided into three parts we first develop equations to describe the electrical conductivity of a porous medium with pores defined as tortuous capillaries that follow a fractal size distribution and presenting sinusoidal variations of their aperture then the model is linked to other transport parameters such as permeability and ionic diffusion coefficient in the second part we test the model sensitivity and we compare its performance with thanh et al 2019 fractal model in the third part we confront the model to datasets presenting an increasing complexity first data come from synthetic unconsolidated samples then they are taken from natural rock samples with a growing pore space intricacy finally we analyze the model response to numerical simulations of dissolution and precipitation highlighting its interest as a monitoring tool for such critical processes 2 theoretical developments based on the approach of guarracino et al 2014 we propose a model assuming a porous medium represented as a fractal distribution of equivalent tortuous capillaries in a cylindrical representative elementary volume rev with a radius r m and a length l m fig 1 a in this model the surface conductivity σs is neglected σ s 0 2 1 pore scale 2 1 1 pore geometry the porous medium is conceptualized as an equivalent bundle of capillaries as presented in fig 1b each tortuous pore present a varying radius r x m defined with the following sinusoidal expression 3 r x r r sin 2 π λ x r 1 2 a sin 2 π λ x where r is the average pore radius m r the amplitude of the radius size fluctuation m and λ is the wavelength m the parameter a is the pore radius fluctuation ratio defined by a r 2 r which values range from 0 to 0 5 note that a 0 corresponds to cylindrical pores r x r while a 0 5 corresponds to periodically closed pores for each pore we define the section area a p x π r x 2 m2 most of the models found in the literature and describing the porous medium with a fractal distribution define a pore length scaling with pore radius e g yu and cheng 2002 yu et al 2003 guarracino et al 2014 thanh et al 2019 however in this study we consider a constant tortuous length l m for all the pores because it reduces the number of adjustable parameters while maintaining the model accuracy this constant tortuosity value should be interpreted as an effective macroscopic value for all tube lengths l is the length taken at the center of the capillary thus the tortuosity τ is also a constant for all pores and is defined as 4 τ l l in this case the volume of a single pore v p r m3 can be computed by integrating its section area ap x over the tortuous length l 5 v p r 0 l π r x 2 d x according to eqs 3 and 4 and assuming that λ l volume vp defined in eq 5 becomes 6 v p r π r 2 1 2 a 2 τ l 2 1 2 pore electrical conductivity we express electrical properties at pore scale before obtaining them for the porous medium by upscaling because the rev can be considered as an equivalent circuit of parallel conductances when σs is neglected the electrical conductance σ p o r e r s of a single sinusoidal pore is defined by 7 σ p o r e r 0 l 1 σ w π r x 2 d x 1 where σw s m is the pore water conductivity replacing eq 3 in eq 7 and assuming λ l the electrical conductance of a single pore can be expressed as 8 σ p o r e r σ w π r 2 1 4 a 2 3 2 τ l following ohm s law the electric voltage δv v between the edges of the capillary 0 and l is defined as 9 δ v i r σ p o r e i r where i r a is the electric current flowing through the pore that can be expressed as follows 10 i r π σ w r 2 1 4 a 2 3 2 τ l δ v we thus define the contribution to the porous medium conductivity from a single pore σ p r s m by multiplying the pore conductance with a geometric factor f g π r 2 l m 11 σ p r σ p o r e r f g r 2 1 4 a 2 3 2 σ w τ r 2 when a 0 the expression of σ p r simplifies itself as in the case of cylindrical tortuous pores developed by pfannkuch 1972 2 2 upscaling procedure using a fractal distribution to obtain the electrical conductivity of the porous medium at the rev scale we need a pore size distribution we conceptualize the porous medium by a fractal distribution of capillaries according to the notations of guarracino et al 2014 and thanh et al 2019 based on the fractal theory for porous media tyler and wheatcraft 1990 yu and cheng 2002 12 n r r m a x r d p where n is the number of capillaries whose average radius are equal or larger than r dp is the fractal dimension of pore size and r max m is the maximum average radius of pores in the rev fractal distributions can be used to describe objects of different euclidean dimensions e g 1 dimension for a line 2 dimensions for a surface and 3 dimensions for a volume in this study the pore size distribution is considered as a fractal distribution of capillary sections on a plane i e in 2 dimensions therefore the fractal dimension dp is defined from 1 to 2 among many other papers see yu and cheng 2002 yu et al 2003 nevertheless dp is a unique parameter for each porous medium as it strongly depends on the pore size distribution its impact has been quantified by tyler and wheatcraft 1990 with a porous medium defined as a sierpinski carpet from the pore size distribution defined in eq 12 the total number of capillaries equals to 13 n t o t r max r min d p with r min m the minimum average radius from eq 12 the number of radii lying between r and r d r is 14 d n d p r max d p r d p 1 d r where d n is the number of pores with an average radius comprised in the infinitesimal range between r and r d r the minus sign implies that the number of pores decreases when the average radius increases yu et al 2003 soldi et al 2017 thanh et al 2019 2 3 rev scale in the present section we present the macroscopic properties at the rev scale obtained from the upscaling procedure 2 3 1 porosity we can express the porosity ϕ of the rev by integrating the pore volume over the fractal distribution as follows 15 ϕ r min r max v p r d n π r 2 l then by replacing eqs 14 and 6 into eq 15 it yields to 16 ϕ 1 2 a 2 τ d p r max d p r 2 2 d p r max 2 d p r min 2 d p this expression requires 2 d p 0 which is always true see yu and li 2001 note that this expression corresponds to the model of guarracino et al 2014 when the tortuosity is the same for all the capillary sizes 2 3 2 electrical conductivity as defined in the kirchhoff s current law the electric current of the rev i a is the sum of the electric currents of all the capillaries when the surface conductivity is neglected it can be obtained by integrating the electric current of each pore 17 i r min r max i r d n according to eqs 4 10 and 14 i can be expressed as follows 18 i σ w π 1 4 a 2 3 2 d p r max d p 2 d p τ l δ v r max 2 d p r min 2 d p the ohm s law at the rev scale yields to 19 i σ r e v π r 2 δ v l where σrev is the electrical conductivity of the rev s m by combining eqs 18 and 19 σrev is expressed as 20 σ r e v σ w d p r max d p 1 4 a 2 3 2 r 2 τ 2 d p r max 2 d p r min 2 d p finally substituting eq 16 into eq 20 yields to 21 σ r e v σ w ϕ 1 4 a 2 3 2 τ 2 1 2 a 2 note that if a 0 and τ 1 eq 21 becomes σ r e v σ w ϕ which is the expression of archie s law for m 1 where the porous medium is composed of a bundle of straight capillaries with no tortuosity see clennell 1997 the electrical conductivity can be rewritten depending on the tortuosity τ and on the constrictivity f as 22 σ r e v σ w ϕ f τ 2 the constrictivity f is thus defined as 23 f 1 4 a 2 3 2 1 2 a 2 the above equation highlights that the pore fluctuation ratio a plays the role of the constriction factor defined by petersen 1958 constrictivity f ranges between 0 e g for trapped pores and 1 e g for cylindrical pores with constant radius as for the tortuosity τ there is no suitable method to determine constrictivity value directly from core samples but only some mathematical expressions for ideal simplified geometries see holzer et al 2013 for a review therefore very high tortuosity values e g niu and zhang 2019 must be due to that in most studies the bottleneck effect is not considered 2 3 3 formation factor the model from archie 1942 links the rock electrical conductivity to the pore water conductivity and the porosity with the cementation exponent which is an empirical parameter kennedy and herrick 2012 propose to analyze electrical conductivity data using a physics based model which conceptualizes the porous medium with pore throats and pore bodies as in this study and defines the electrical conductivity as follows 24 σ r e v g σ w ϕ where g is an explicit geometrical factor defined between 0 and 1 according to our models g can be expressed by 25 g 1 4 a 2 3 2 τ 2 1 2 a 2 f τ 2 this geometrical factor can be called the connectedness glover 2015 while the formation factor f is defined by 26 f σ w σ r e v substituting eq 21 into eq 26 yields to 27 f τ 2 1 2 a 2 ϕ 1 4 a 2 3 2 τ 2 ϕ f the formation factor f can also be related to the connectedness g as f 1 ϕ g 2 4 evolution of the petrophysical parameters the formation factor defined by eq 27 depends linearly with the inverse of porosity 1 ϕ however the petrophysical parameters a and τ may be dependent on porosity for certain types of rocks or during dissolution or precipitation processes in these cases the formation factor will show a non linear dependence with 1 ϕ and can be expressed in general as 28 f ϕ τ ϕ 2 1 2 a ϕ 2 ϕ 1 4 a ϕ 2 3 2 in section 4 2 we test our model against different datasets from literature using logarithmic laws for the dependence of petrophysical parameters a ϕ and τ ϕ with porosity following existing models from the literature see ghanbarian et al 2013 for a review about the tortuosity thus we define a ϕ and τ ϕ as 29 a ϕ p a log ϕ and 30 τ ϕ 1 p τ log ϕ where pa and pτ are empirical parameters note that 0 and 1 i e first terms in eqs 29 and 30 respectively correspond to the minimum values reached by a ϕ and τ ϕ when ϕ 1 expressing tortuosity as a logarithmic function of porosity has already proven its effectiveness in the literature comiti and renaud 1989 ghanbarian et al 2013 zhang et al 2020 however this is to the best of our knowledge the first attempt to propose a constrictivity model as a function of porosity then by replacing eqs 29 and 30 in eq 28 the expression of the proposed model for the formation factor f becomes 31 f ϕ 1 p τ log ϕ 2 1 2 p a log ϕ 2 ϕ 1 4 p a log ϕ 2 3 2 note that the model parameters from thanh et al 2019 another porous medium description following a fractal distribution of pores also present logarithmic dependencies with the porosity ϕ 2 5 electrical conductivity and transport parameters 2 5 1 from electrical conductivity to permeability the electrical conductivity is a useful geophysical property to describe the pore space geometry here we propose to express the permeability as a function of the electrical conductivity using our model at pore scale sisavath et al 2001 propose the following expression for the flow rate q p r m3 s in a single capillary 32 q p r π 8 ρ g μ δ h l 0 l 1 r 4 x d x 1 where ρ is the water density kg m3 g is the standard gravity acceleration m s2 μ is the water viscosity pa s and δh is the hydraulic head across the rev m substituting eq 3 in eq 32 and assuming λ l it yields 33 q p r π 8 ρ g μ δ h τ l r 4 1 4 a 2 3 2 then the total volumetric flow rate qrev m3 s is obtained by integrating eq 33 over all capillaries i e at the rev scale 34 q rev r min r max q p r dn ρ g 1 4 a 2 3 2 d p r max d p π δ h 8 μ 4 d p τ l r max 4 d p r min 4 d p based on darcy s law for saturated porous media the total volumetric flow rate can be expressed as 35 q r e v π r 2 ρ g μ k r e v δ h l where krev is the rev permeability m2 then combining eqs 34 and 35 it yields to 36 k r e v 1 4 a 2 3 2 d p r max d p 8 r 2 4 d p τ r max 4 d p r min 4 d p considering r min r max eq 36 can be simplified as 37 k r e v 1 4 a 2 3 2 d p r max 4 8 r 2 4 d p τ using the same simplification on eq 16 the expression of porosity becomes 38 ϕ 1 2 a 2 τ d p r max 2 r 2 2 d p then combining eqs 37 and 38 yields to 39 k r e v 2 d p 4 d p 1 4 a 2 3 2 1 2 a 2 r max 2 8 τ 2 ϕ finally the combination of eqs 27 and 39 leads to 40 k r e v 2 d p 4 d p r max 2 8 f note that eq 40 relates permeability to electrical conductivity through the formation factor see eq 26 this expression can be linked to the model of johnson et al 1986 41 k r e v λ 2 8 f where λ also known as the johnson length is a characteristic pore size m of dynamically connected pores banavar and schwartz 1987 ghanbarian 2020 some authors proposed theoretical relationships to determine this characteristic length λ while revil and cathles 1999 or glover et al 2006 link it to the average grain diameter some other publications work on the determination of λ assuming a porous medium composed of cylindrical pores e g banavar and johnson 1987 niu and zhang 2019 considering the proposed model λ can therefore be written as follows 42 λ 2 d p 4 d p r max 2 5 2 from electrical conductivity to ionic diffusion coefficient ionic diffusion can be described at rev scale by the fick s law fick 1995 43 j t d e f f π r 2 δ c l where jt mol s is the diffusive mass flow rate deff m2 s is the effective diffusion coefficient and δc mol m3 is the solute concentration difference between the rev edges guarracino et al 2014 propose to express deff as a function of the tortuosity which in their model depends on the capillary size in our model we consider that the tortuosity is constant thus by reproducing the same development proposed by guarracino et al 2014 we obtain 44 d e f f d w 1 4 a 2 3 2 ϕ 1 2 a 2 τ 2 which can be simplified as 45 d e f f d w f ϕ τ 2 this last expression of deff as a function of the tortuosity τ and the constrictivity f allows to retrieve the same equation as van brakel and heertjes 1974 with both the effect of the tortuosity and the constrictivity replacing eq 27 in eq 45 yields to 46 d e f f d w f which implies 47 f σ w σ r e v d w d e f f this result has already been demonstrated by kyi and batchelor 1994 and jougnot et al 2009 among others it means that the formation factor can be used for both electrical conductivity or diffuse properties this point is consistent with the fact that ohm and fick laws are diffusion equations where the transport of ions take place in the same pore space the difference lies in the fact that ionic conduction and ionic diffusion consider the electric potential gradient and the ionic concentration gradient respectively 3 model analysis and evaluation our model expresses the evolution of the formation factor f as a function of the porosity ϕ the tortuosity τ and the constrictivity through the pore radius fluctuation ratio a eq 27 here we explore wide ranges of values for a and τ to quantify their influence on the formation factor f fig 2 and compare our model with the model from thanh et al 2019 for the fractal dimension of the tortuosity dτ 1 to appreciate the contribution of the constrictivity to the porous medium description fig 2a and b show variations of f as a function of the porosity ϕ when only a or τ varies on fig 2a parameter a varies from 0 to 0 49 and tortuosity τ 5 0 we test the case of a constant pore aperture when a 0 but we do not reach a 0 5 because this means that the pores are periodically closed see the definition of a in section 2 1 1 and this corresponds to an infinitely resistive rock only made of non connected porosity on fig 2b tortuosity τ varies from 1 to 20 and parameter a 0 1 τ 1 implies straight pores i e l l fig 2c present variations of f as a function of the tortuosity τ for different values of a and a fixed porosity ϕ 0 4 fig 2d is the density plot of log10 f for a range of values of a and τ and with a fixed porosity value ϕ 0 4 from the analysis of fig 2a and b one can note that the formation factor decreases when porosity increases this was expected because more the water saturated medium is porous more its electrical conductivity is close to pore water electrical conductivity furthermore we observe that both parameters a and τ have a strong effect on formation factor variation ranges indeed f ϕ curve can be shifted by more than 3 orders of magnitude with variations of a or τ and as expected the formation factor increases when τ or a increases indeed when these parameters increase the porous medium becomes more complex the increase of parameter a means that periodical aperture of capillaries decreases i e more constrictivity while the increase of τ means that pores become more tortuous i e more tortuosity besides for a close to 0 i e without aperture variation curves from thanh et al 2019 model are similar with the curves from our model this is consistent with the fact that thanh et al 2019 also conceptualize the porous media as a fractal distribution of capillaries however when a increases the curves explore very different ranges of f values fig 2a and c the density plot presented on fig 2d compares the effect of a and τ variations for a constant porosity ϕ 0 4 it appears that for a fixed value of τ variations of a have a low effect on log of f values on the contrary variations of τ for one value of a have stronger effect on log of f ranges however it should be noted that this representation can be biased because value ranges of a and τ are very different thus it is difficult to asses if the tortuosity τ has really much more effect on formation factor than parameter a nevertheless it has the advantage to represent the combined effect of a and τ on the formation factor 4 results and discussion to assess the performance of the proposed model we compare predicted values to datasets from the literature are listed in table 1 and ordered with a growing complexity indeed data from friedman and robinson 2002 and bolève et al 2007 are taken from experiments made on unconsolidated medium then garing et al 2014 revil et al 2014 and cherubini et al 2019 studied natural consolidated samples from carbonate rocks and sandstone samples finally niu and zhang 2019 present numerical but dynamic data under dissolution and precipitation conditions for each dataset the adjusted parameters of the proposed model are listed in table 1 values have been determined using a monte carlo inversion of eqs 21 and 27 which express the porous medium electrical conductivity σrev as a function of the pore water conductivity σw and the formation factor f as a function of the porosity ϕ respectively an additional term σs for the surface conductivity s m is used to fit the data out of the application range of the proposed model that is for low values of pore water conductivity when the surface conductivity cannot be neglected as the proposed model is intended to be mostly used on carbonate rocks which are known to have low surface conductivity this physical parameter has not been taken into account in the theoretical development of the expression of the electrical conductivity of the porous medium however it can be added considering a parallel model e g waxman and smits 1968 börner and schön 1991 48 σ r e v 1 f σ w σ s a more advanced approach of parallel model is proposed by thanh et al 2019 including the contribution of the surface conductance in the overall capillary bundle electrical conductivity table 1 lists also the computed error ϵ of the adjusted model in statistics ϵ is called the mean absolute percentage error mape it is expressed in percent and defined as follow 49 ϵ 1 n d i 1 n d p i m p i d p i d 100 where nd pd and pm refer to the number of data the electrical property from data and the electrical property from the model respectively this type of error has been chosen to compare the ability of the model to reproduce the experimental values for all the datasets even if they are expressed as σrev σw or as f ϕ 4 1 testing the model on unconsolidated media the proposed model is first confronted to datasets from friedman and robinson 2002 and bolève et al 2007 obtained for unconsolidated samples in these tests only one set of parameters a τ and σs when needed is adjusted to fit with each dataset bolève et al 2007 measured the electrical conductivity of glass beads samples for different values of the pore water conductivity σw from 10 4 s m to 10 1 s m on s1a s2 s3 s4 s5 and s6 see fig 3 for all samples bolève et al 2007 reported a constant porosity of 40 while grain diameters are comprised between 56 µm for s1a and 3000 µm for s6 see fig 3 for more details table 1 shows that the adjusted model parameters a and τ have rather similar values for all the samples from bolève et al 2007 this can be explained by the fact that all samples have the same pore geometry but scaled at different size indeed for homogeneous samples of glass beads the beads space arrangement is quite independent of the spheres size therefore the pore network of all samples presents similar properties such as tortuosity see also the discussion in guarracino and jougnot 2018 and constrictivity which directly depends on parameters a and τ moreover a and τ are close to their minimum limits i e a 0 and τ 1 this is due to the simple pore space geometry created by samples made of homogeneous glass spheres this explains the model good fit for straight capillaries i e thanh et al 2019 however it can be noticed that surface conductivity decreases while grain diameter increases this is not a surprise considering that for the same volume samples of smaller beads have a larger specific surface than samples of bigger beads see for example the discussion in glover and déry 2010 friedman and robinson 2002 determined the formation factor f for samples of glass beads sand and tuff grains with different values of porosity ϕ see fig 4 as the model best fit is determined with a monte carlo approach accepted models are also plotted on fig 4 the acceptance criterion is defined individually for each dataset and corresponds to a certain value of the mape ϵ for samples from friedman and robinson 2002 this criterion is fixed at ϵ 1 or 2 these are low values meaning a really good fit from the model we observe from table 1 that a and τ values are close to each other for all samples from friedman and robinson 2002 however these parameters have higher values than for bolève et al 2007 dataset this comes from the fact that some complexity is added in the dataset from friedman and robinson 2002 indeed the samples of friedman and robinson 2002 combine particles of different sizes in this case smaller grains can fill the voids left by bigger grains this grains arrangement decreases the medium porosity but increases its tortuosity and constrictivity furthermore sand and tuff grains have rougher surface and are less spherical than glass beads this explains the misfit increase between data and model for glass sand and tuff samples friedman and robinson 2002 nevertheless even for tuff grains the misfit between data and model is still very low compared to the computed mape from bolève et al 2007 samples this is due to that for bolève et al 2007 a wide range of pore water conductivity values is explored and thus electrical properties vary much more over 3 orders of magnitude than in the case of friedman and robinson 2002 4 2 testing the model on consolidated rock samples in this section we test our model against datasets of garing et al 2014 revil et al 2014 and cherubini et al 2019 they study carbonate samples from the reef unit of ses sitjoles site from mallorca fontainebleau sandstones and two estaillades limestones rodolith packstones respectively revil et al 2014 obtained a wide range of formation factor values for a large set of fontainebleau sandstone core samples over a large range of porosity we first test our model with constant values of a and τ but we observed that the model could not fit data see fig 5 a this can be explained by the fact that this dataset is composed of numerous sandstone samples presenting a wide range of porosity values from 0 045 to 0 22 therefore we consider that the samples have distinct pore geometry which is describable by a ϕ and τ ϕ distributions presented in section 2 4 and plotted on fig 5b and c we observe that parameters a and τ logarithmic evolution with the porosity ϕ are physically plausible as lower porosity can reflect more complex medium geometries i e more constrictive and more tortuous described with higher values of a and τ on fig 5a we also plot the model from thanh et al 2019 even if the curve presents a slope similar to dataset it overestimates the formation factor despite a quite wide dispersion of the formation factor data for the lowest porosities it appears that the proposed model is well adjusted to the dataset indeed the proposed model mape ϵ 22 62 see table 1 while ϵ 89 63 for the model from thanh et al 2019 note that the relatively high mape value comes from the large spread of the formation factor values thus it seems that taking into account the constrictivity of the porous medium in addition to the tortuosity highly improves modeling fig 6 shows the dependence of electrical conductivity with pore water electrical conductivity for two limestone samples named l1 and l2 from cherubini et al 2019 table 1 shows that model parameters and surface conductivity values are larger than for the unconsolidated samples from bolève et al 2007 and friedman and robinson 2002 this is explained by the fact that natural rock samples can present a more complex geometry and larger specific surface area than glass beads samples cherubini et al 2019 predict the surface electrical conductivity with the model from revil et al 2014 they obtain σ s 7 0 10 4 s m which is very close to the value obtained in this study furthermore the computed errors for the dataset of bolève et al 2007 and for these limestones are close to each other this test illustrates that even for more complex porous media the proposed model has still a good data resolution garing et al 2014 conducted x ray microtomography measurements on carbonate samples to classify them by pore types and thus they highlight three groups 1 inter samples present intergranular pores this pore shape is quite comparable with sandstones porosity type 2 multi samples hold multiple porosity types intergranular moldic and vugular microtomograms of multi samples show small but well connected pores the analyze conducted by garing et al 2014 revealed that for samples with smaller porosity pores are smaller on average but still numerous and well connected even for a reduced microporosity 3 vuggy samples possess vugular porosity microtomography highlights the presence of few vugs badly connected which are less numerous for samples of lower porosity fig 7 presents the results of formation factor computation versus porosity as for the dataset from revil et al 2014 the proposed model is adjusted using eq 31 which considers that model parameters are logarithmic functions of porosity despite some dispersion for inter and vuggy samples i e the acceptance criterion ϵ 40 the model explains well the data for all porosity types and present low mape values table 1 the analysis of parameters pa and pτ reveals that they present consistent values for the different porosity types indeed for vuggy samples pa is small while pτ is high fig 7c according to eqs 29 and 30 these values lead to low and high values for a and τ respectively table 1 and this is consistent with the microtomography analysis from garing et al 2014 indeed since these samples present large vugs badly connected i e few microporosity the microstructure is very tortuous but pores are not constricted furthermore for samples with lower porosity vugs are still present in vuggy samples but they are less numerous which leads to a microstructure even more tortuous but nearly as constrictive as for the more porous samples moreover for inter and multi samples fig 7a and b pa and pτ are closer in value to the parameters of the sandstone samples from revil et al 2014 than to the parameters of vuggy samples because they have among other types for the multi samples intergranular porosity note that higher pτ value can be attributed to the more complex structure of carbonate minerals compared to sandstone samples furthermore the high value of pa for the multi samples can be explained with the microtomography observations from garing et al 2014 indeed constrictivity increases a lot for samples with lower porosity because microporosity is reduced while there are less molds and vugs consequently we conclude that this detailed analysis of model parameters help us to retrieve some characteristic features of the pore space from electrical conductivity measurement 4 3 electrical conductivity monitoring of precipitation and dissolution processes in this section we consider the numerical datasets from niu and zhang 2019 these authors conduct numerical simulations of dissolution and precipitation reactions on digital representations of microstructural images they simulate the dissolution of a carbonate mudstone sample and the precipitation of a sample of loosely packed ooids for the carbonate mudstone sample the pore space image is obtained from a microtomography scan while the ooids sample is a synthetic compression of sparsely distributed spherical particles niu and zhang 2018 the carbonate mudstone sample has an initial porosity of 13 and the ooids sample has an initial porosity of 30 2 in numerical simulations the main hypothesis of niu and zhang 2019 is that fluid transport is advection dominated then under this condition they studied two limiting cases for both dissolution and precipitation the transport limited case and the reaction limited case nunes et al 2016 in the transport limited case the reaction at the solid liquid interface is limited by the diffusion of reactants to and from the solid surface in the reaction limited case the reaction is limited by the reaction rate at the solid liquid interface their results are presented in figs 8 a b and 9 a b it appears that for both precipitation and dissolution the transport limited case influences the most electrical and fluid flow properties indeed it can be seen in fig 8a that for reaction limited precipitation a 10 decrease in porosity leads to an increase in the formation factor from 7 5 to 20 while for transport limited precipitation the formation factor reaches 140 for a porosity decrease of less than 2 in case of dissolution fig 8b for a similar decrease of the formation factor porosity increases only by 3 in the transport limited case while it has to increase by 15 in the reaction limited case the same observations can be made on fig 9a and b the variations of permeability are much greater in the transport limited case than in the reaction limited case for a lower porosity variation the authors of this study justify the shapes of f and krev curves with their observations on the digital representations of the microstructural evolution in the reaction limited case they observe that precipitated or dissolved minerals are uniformly distributed over grain surfaces this consequently barely affects electrical and fluid flow properties on the contrary in the transport limited case dissolution and precipitation mainly occur in some specific areas where fluid velocity is high this significantly modifies electrical and fluid flow patterns in the case of transport limited precipitation new particles accumulate in pore throats while minerals are preferentially dissolved in the already well opened channels to adjust the proposed model to the data a first set of parameters a and τ has been determined at the initial state with the monte carlo approach then only parameter a is adjusted with the model to each new data point using the least square method we consider that only a is affected by dissolution and precipitation because these processes mostly affect the pore shape indeed the results of the pore network modeling developed by steinwinder and beckingham 2019 to simulate the impact of pore scale alterations by dissolution and precipitation on permeability show that pore throats are important parameters to take into account however for the proposed model of this study the assumption that only a varies requires slow processes of dissolution and precipitation in order to keep the cylindrical shape of pores guarracino et al 2014 besides we fit parameter a at each time step rather than using the logarithmic law since it lacks physical meaning to explain this parameter time evolution niu and zhang 2019 computed the hydraulic tortuosity τh from the simulated fluid velocity field for all of their data they found nearly constant values defined between 1 and 2 as we computed τ 1 3 and τ 1 8 in precipitation and dissolution respectively these results are within the predicted range of the simulated data from niu and zhang 2019 and confirm our hypothesis that constrictivity is the pore feature most impacted by dissolution and precipitation processes however to interpret the evolution of the formation factor during dissolution f decreases and precipitation f increases niu and zhang 2019 computed the electrical tortuosity τ e f ϕ no unit of their porous medium and obtained high values from 2 to 200 varying over 1 to 2 decades for the transport limited cases these overestimated values of the medium tortuosity highlight that constrictivity and the bottleneck effect should not be neglected to evaluate how dissolution and precipitation processes affect the pore structure fig 8 a and b show that in each case the proposed model accurately fits the data with computed errors lower than 1 see table 1 as presented on fig 8c and d parameter a follows monotonous variations it decreases when the porosity increases we define a as the ratio of the sinusoidal pore aperture r over the mean pore radius r see the definition of a in section 2 1 1 when a increases it can be caused by the increase of r which involves a stronger periodical constriction of the pore aperture and or by the decrease of the mean pore radius r on the contrary when a decreases it implies the increase of r and or the decrease of r which lead to thicker pores with smoother pore walls respectively these variations are consistent with the fact that precipitation and dissolution affect the pore geometry through the sample in case of precipitation pore throats shrink while they are enlarged with dissolution it can also be observed on fig 8c and d that a shows stronger variations in the transport limited case than in the reaction limited case this is consistent with the fact that transport limited reactions occur in localized areas which will strongly affect the pore properties the relation between the permeability krev and the johnson length λ is obtained by combining eqs 39 and 42 50 k r e v λ 2 1 4 a 2 3 2 1 2 a 2 ϕ 8 τ 2 the values of parameters a and τ are taken from the adjusted models of the formation factor thus the johnson length λ is the only adjustable parameter to fit the data and is fitted with the least square method values are given in tables 1 and 2 on fig 9a and b one can observe that for each case the model accurately fits the data with computed errors lower than 1 see table 2 as presented on fig 9c and d parameter λ follows monotonous variations it increases with porosity it can also be observed that λ varies more in the transport limited case than in the reaction limited case for the reaction limited dissolution it is even nearly constant niu and zhang 2019 found johnson lengths with the same order of magnitude and with similar variations except in the case of transport limited precipitation where their values do not follow a monotonous behavior for low porosity values either way niu and zhang 2019 interpret the jonhson length as an effective radius of their porous medium which shows monotonous variations during precipitation λ decreases and dissolution λ increases in the proposed model the parameter a describes how dissolution and precipitation processes affect the shape of the pore radius i e its constrictivity while λ is linked to the fractal distribution of pore size dp and to the maximum average radius r max as we suppose dissolution and precipitation slow enough not to interfere with the pore size distribution dp remains constant for each sample on the contrary when dissolution or precipitations occurs it is expected for the pores to grow or to shrink respectively therefore the monotonous variations of λ highlight the increase or decrease of r max during dissolution or precipitation respectively this result is in accordance with the variations of a which can impact r consequently we describe the pore space evolution during dissolution and precipitation as illustrated in fig 10 indeed the decrease of a is caused by dissolution which enlarges the pore and flattens its pore walls on the contrary precipitation affects the pores by increasing a which means that pores shrink and become more periodically constricted because of r increase we thus believe that this interpretation of the electrical conductivity measurement is an important issue for future research on the impact of dissolution and precipitation on the pore shape 5 conclusion in the present work we express the electrical conductivity and the formation factor of the porous medium in terms of effective petrophysical parameters such as the tortuosity and the constrictivity the model is based on the conceptualization of the pore space as a fractal cumulative distribution of tortuous capillaries with a sinusoidal variation of their radius i e periodical pore throats by means of an upscaling procedure we link the electrical conductivity to transport parameters such as permeability and ionic diffusion coefficient the proposed model successfully predicts electrical conductivity and formation factor of unconsolidated samples and natural consolidated rock samples for datasets of sandstones or carbonates with large range of porosity values we set that a and τ follow logarithmic functions of ϕ these empirical relations allow the model to accurately fit the datasets on one hand for the sandstone samples the prediction fits much better than previously published models while on the other hand the model parameter analysis shows strong agreement with the porosity types description thanks to x ray microtomography investigations on carbonate samples even if our model is designed for porous media in which the surface conductivity can be neglected it is possible to take it into account at very low salinity we do not express it as a function of the pore structure parameters but determine its value empirically the comparison of its value with the one found for other models on the same datasets shows that this approach is consistent and reasonable for the purpose of this model the model is finally compared to a numerical dataset from simulations of dissolution and precipitation reactions on digital representations of microstructural images the model can reproduce structural changes linked to these processes by only adjusting a single parameter related to the medium constrictivity the pore radius fluctuation ratio a we observe that this parameter follows monotonous variations under dissolution or precipitation conditions that makes it a good witness of these chemical processes effect on the pore structure we believe that the present study contributes to a better understanding of the links between the electrical conductivity measurement the pore space characteristics and the evolution of the microstructural properties of the porous medium subjected to dissolution and precipitation processes therefore enhancing the possibility of using hydrogeophysical tools for the study of carbonate hydrosystems in the future we will extend this approach to partially saturated conditions and include these new petrophysical models in an integrated hydrogeophysical approach to better understand hydrosystems in the critical zone 6 notations parameter definition unit l rev length m r rev radius m r pore radius m r average pore radius m r amplitude of the radius size fluctuation m λ wavelength m a pore radius fluctuation ratio a p rev section area m 2 l tortuous length m τ tortuosity v p r volume of a single pore m 3 σ p o r e r electrical conductance of a single pore s ρ w pore water electrical resistivity ω m σ w pore water electrical conductivity s m δ v electric voltage v i r electric current flowing through a single pore a σ p r contribution to the porous medium conductivity from a single pore s m f g geometric factor m n r number of pores of radius equal or larger than r r max maximum average pore radius m d p fractal dimension of pore size n t o t total number of pores r min minimum average pore radius m ϕ porosity i rev electric current a σ r e v rev electrical conductivity s m f constrictivity g connectedness f formation factor q p r flow rate of a single pore m 3 s ρ density of water kg m 3 g standard gravity m s 2 μ water viscosity pa s δ h hydraulic charge across the rev m q r e v total volumetric flow rate m 3 s k r e v rev permeability m 2 λ johnson length m j t diffusive solute mass flow rate mol s d w water diffusion coefficient m 2 s d e f f effective diffusion coefficient m 2 s δ c solute concentration differences mol m 3 m cementation exponent σ s surface conductivity s m ϵ mean absolute percentage error n d number of data p i m electrical property from the model p i d electrical property from the data p a coefficient to define a ϕ p τ coefficient to define τ ϕ τ h hydraulic tortuosity τ e electrical tortuosity credit authorship contribution statement flore rembert conceptualization methodology software validation formal analysis investigation data curation writing original draft writing review editing visualization damien jougnot conceptualization methodology writing review editing supervision project administration funding acquisition luis guarracino conceptualization methodology writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the authors warmly thank qifei niu and the other anonymous reviewer for the constructive comments that helped to greatly improve the manuscript quality the authors wish to thank the editor for the effective editing process the authors strongly thank the financial support of the cnrs insu ec2co program for funding the startrek système pétrophysique de caractérisation du transport réactif en milieu karstique project the authors are also very thankful for the wise comments of roger guérin supplementary material supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2020 103742 appendix a supplementary materials supplementary data s1 supplementary raw research data this is open data under the cc by license http creativecommons org licenses by 4 0 supplementary data s1 
404,an isobar generated by a line or point sink draining a confined semi infinite aquifer is an analytic curve to which a steady 2 d plane or axisymmetric darcian flow converges this sink may represent an excavation ditch or wadi on earth or a channel on mars the strength of the sink controls the form of the ditch depression for 2 d flow the shape of the isobar varies from a zero depth channel to a semicircle for axisymmetric flow depressions as flat as a disk or as deep as a hemisphere are reconstructed in the model of axisymmetric flow a fictitious j r philip s point sink is mirrored by an infinite array of sinks and sources placed along a vertical line perpendicular to a horizontal water table a topographic depression is kept at constant capillary pressure water content kirchhoff potential none of these singularities belongs to the real flow domain evaporating unsaturated gardnerian soil saturated flow towards a triangular empty or partially filled ditch is tackled by conformal mappings and the solution of riemann s problem in a reference plane the obtained seepage flow rate is used as a right hand side in an ode of a cauchy problem the solution of which gives the draw up curves i e the rise of the water level in an initially empty trench hydrus 2d computations for flows in saturated and unsaturated soils match well the analytical solutions the modeling results are applied to assessments of real hydrological fluxes on earth and paleo reconstructions of martian hydrology geomorphology keywords analytic and hydrus solutions for darcian 2 d and axisymmetric flows in saturated and unsaturated soils towards drainage ditches and topographic depressions evaporation and seepage exfiltration from shallow groundwater complex potential and conformal mappings method of images with sinks and sources for the laplace equation and ade boundary value problems involving seepage faces on earth and mars isobars isotachs constant piezometric head and kirchhoff potential lines abbreviations ade advective dispersion equation bvp boundary value problem df dupuit forchheimer lhs rhs left hand side right hand side ode ordinary differential equation osdp optimal shape design problem pk 62 77 polubarinova kochina p ya 1962 theory of ground water movement princeton university press princeton the second edition of the book in russian was published in 1977 nauka moscow vg van genuchten 1 introduction i had to live in the desert before i could understand the full value of grass in a green ditch ella maillart analytical models of 2 d seepage towards drainage ditches and trenches constructed by civil geotechnical and agricultural engineers used the machinery of complex variables anderson 2013 aravin and numerov 1953 bear 1972 kirkham and powers 1972 polubarinova kochina 1962 1977 hereafter abbreviated as pk 62 77 skaggs et al 1999 strack 1989 vedernikov 1939 in particular by tackling free boundaries of darcian flows the so called phreatic surfaces we recall see e g radcliffe and šimůnek 2010 that transient 3 d saturated unsaturated flows in porous media when both water and soil are incompressible obey the richards equation 0 θ t k p h where θ t x y z is the volumetric moisture content is the nabla operator in cartesian or cylindrical coordinates k p x y z is the hydraulic conductivity function h t x y z p z is the total head p is the pressure head z is a vertical coordinate and p θ is a capillary pressure water retention function fixed for each soil eq 0 involves the darsy law v k p h where v is the darcian flux vector and the principle of mass conservation boundary value problems hereafter abbreviated as bvps are solved for eq 0 by specifying initial conditions e g θ 0 x y z as well as imposing physically meaningful boundary conditions e g dirichlet s neumann s only numerical codes like hydrus 3d šimůnek et al 2016 tackle such problems for arbitrary 3d transient flows eq 0 is a highly nonlinear parabolic pde for steady flows its lhs vanishes and the equation becomes elliptic if the flow is purely saturated and the porous medium is homogeneous then k p ks where ks is the saturated hydraulic conductivity and eq 0 is reduced to a linear laplace equation for a special class of soils with an exponential k p function gardner 1958 the kirchhoff transform makes possible a linearization such that eq 0 is reduced to a linear advective dispersion equation ade with respect to a kirchhoff potential the ade can be analytically solved for solitary or systematically placed singularities kacimov 2007 philip 1968 1971 pullan 1990 raats 1971 1972 more details on bvps for the laplace equation and the ade are given in sections 2 5 of the ms the total head for saturated seepage in undeformable porous media obeys the laplace equation and therefore the mathematical commonality between flows of ideal fluids zhukovskii 1948 and pore water motion has been widely explored pk 62 77 strack 1989 the method of images and the theory of bvps henrici 1993 have been engaged in this paper we combine these traditional analytical and new numerical hydrus 2d šimůnek et al 2016 methods to problems of groundwater and soil water movement from shallow confined and unconfined aquifers towards ditches and topographic depressions common in desert landforms of arid hyperarid climates of oman and mars a practical motivation of our work stems from a daunting problem of groundwater inundation caused by a rapid rise of the water table in perched unconfined and shallow confined aquifers detected in many urban areas of the world see e g attard et al 2016 barron et al 2013 chaudhary 2012 coda et al 2019 howard and israfilov 2012 jha et al 2012 kazemi 2011 lerner 2003 lerner and harris 2008 medovar et al 2018 naik et al 2008 porse et al 2016 preene and fisher 2015 quan et al 2010 schirmer et al 2013 vázquez suñé et al 2005 vogwill 2016 surprisingly the arid countries of arabia despite the hydrological mantra on water deficit and groundwater depletion encounter the same problem of waterlogging of urban structures by shallow groundwater as the cities in humid zones e g abu rizaiza et al 1989 abu rizaiza 1999 al rawas and qamaruddin 1998 al sefry and şen 2006 al senafy 2011 al senafy et al 2015 alsharhan et al 2020 bob et al 2016 kreibich and thieken 2008 it is noteworthy that urbanization in the southwest of the usa caused similar negative hydrological impacts amplification of flash flood intensities due to reduced evapotranspiration see e g goudie 2013 in the metropolitan area of muscat at the campus of sultan qaboos university squ the groundwater inundation has become evident even without any piezometry in recent years subsurface water seeped out in natural topographic depressions man made excavations ditches and drainage channels called wadis large wet spots or ponded areas at squ are bio marked by adjacent lush wild vegetation in the desert climate of oman this vegetation in some places pops up virtually as maillart s grass in green ditches see the epigraph the studied squ field is located in a hyperarid zone of the batinah coast oman arabia e g alsharhan et al 2001 2020 the investigated wadi section was about 1 km long with several excavated pits trenches and natural depressions for instance one of the excavations has the following coordinates northing 619721 easting 2608729 47 5 m above the level in the sea of oman urbanization of the field started in the mid 1980s before which the site was a desert with scattered shrubs and trees currently a significant part of the campus area is paved which reduced natural evapotranspiration waterlogging and associated lush vegetation are geotechnically deleterious putting foundations of the squ buildings roads subsurface cables etc in jeopardy even when the salinity of the rising groundwater is small secondary salinization of the topsoil is also widespread in oman when the rise of the water table is from an aquifer of poor groundwater quality fieldwork was carried out in november june 2020 at the squ campus auger holes ditches and excavations were constructed and groundwater monitored to assess soil moisture oozing fluxes above shallow perched and confined aquifers detected in the study area the motivation of this work also stems from our intention to attract the attention of planet mars hydrologists who model seepage of martian groundwater into remotely scanned relief features of the red planet and the legacy of experts in irrigation and drainage engineering who during the 20th century assembled a good arsenal of analytical and numerical methods for investigations of the motion of pore water towards drains bear 1972 kirkham and powers 1972 skaggs et al 1999 2012 strack 1989 vedernikov 1939 zhukovskii 1948 mars is a hyperarid planet where the remotely analyzed landforms craters dunes endorheic lakes and playas pits alcoves gullies recurring slope lineae fluvio lacustrine basins fans shallow dust horizons streaks amphitheater headed valleys sapping valleys etc and hydrological elements springs outseeps deep fracture conduits seepage spots which convey liquid water brine and martian gases are studied the alleged paleo and current dynamics of martian pore fluids are elaborated for example in abotalib and heggy 2019 bhardwaj et al 2019 boatwright and head 2019 edwards and piqueux 2016 goldspiel and squyres 2011 grimm et al 2014 hobbs et al 2014 kereszturi et al 2010 kochel and piper 1986 luo et al 2011 malin and carr 1999 malin and edgett 2000 marra et al 2014 2015 michalski et al 2013 mukherjee et al 2020 and salese et al 2019 for hypothetical martian aquifers both unconfined and artesian ks is assessed from proxy data see e g the posited nominal value in goldspiel and squyres 2011 luo et al 2011 evaluated the hydraulic conductivity from the solution of inverse problems of the hydrological cycle on mars boatwright and head 2019 assumed that the conductivity exponentially decreases with the martian depth we note that even the darcy law is sometimes not correctly formulated by martian hydrologists see e g an erroneous eq 1 in abotalib and heggy 2019 although purely unsaturated flows are also hypothesized edwards and piqueux 2016 grimm et al 2014 to occur on mars to the best of our knowledge martian hydrologists e g luo et al 2011 have so far used only flow models for saturated soils models of darcian flows towards drainage ditches commonly conceptualize the ditches as rectangles in vertical cross sections having vertical slopes afruzi et al 2014 barua and alam 2013 chahar and vadodaria 2008 2012 gureghian and youngs 1975 sarmah and tiwari 2018 youngs 1975 1990 1994 however natural ephemeral river channels both on earth and mars as well as constructed drainage ditches and trenches often have non rectangular shapes grotzinger et al 2014 kocurek et al 2020 excavations pits and natural depressions are often axisymmetric and mild sloped see e g goldspiel and squyres 2011 only in few studies have phreatic seepage and flows in the unsaturated zone to non rectangular trapezoidal and curvilinear draining entities been analytically examined pk 77 reported solutions by bazanov p 150 of her book and vedernikov pp 181 182 see also ilyinsky and kacimov 1992a kacimov 2005 2006a kacimov and obnosov 2002 we note that although luo et al 2011 sketched trapezoidal draining channels in their models of groundwater discharge into these channels they posited the dupuit forchheimer hereafter abbreviated as df model which actually ignores the shape of channels marra et al 2014 2015 conceptualized and studied experimentally in sandboxes seepage into real trapezoidal channels allegedly occurring on mars but unfortunately did not refer to a plethora of theoretical studies of this type of seepage to draining channels on our own planet see e g aravin and numerov 1953 pk 62 77 vedernikov 1939 this work is organized as follows in section 2 we develop a simple analytical solution for a 2 d not df confined flow to a curvilinear ditch draining a saturated confined aquifer some natural wadi channels in our study area are arcuate like ones on mars malin and carr 1999 but as the first approximation we ignore the 3 d effect our ditch contour is an isobar generated by a line sink in section 3 we obtain a similar solution for a point sink in an axisymmetric flow towards a crater shaped isobar the piezometric head being still a harmonic function in section 4 we assemble an infinite array of j r philip s sinks sources of the advective dispersion equation ade for the kirchhoff potential which models an axisymmetric steady water movement from a horizontal water table towards a topographic depression in a partially saturated so called gardner soil in section 5 and appendix i 2 d seepage towards a triangular empty or partially filled ditch is studied by the machinery of holomorphic functions all analytical solutions of sections 2 5 are tested against hydrus 2d numerical simulations in section 6 we outline applications to arid zone hydrology and in particular to martian hydrology 2 a line sink generated seepage face ditch draining a confined aquifer unlike hobbs et al 2014 who could not identify confining layers in the form of bedrocks and caprocks of hydrostratigraphic units in the martian regolith massif we when making excavations on our squ site indeed crashed a low permeable caliche layer at a depth of 1 5 2 m typical values of ks for low permeable cemented layers also called calcrete petrocalcic horizons see e g duniway et al 2010 formed by the precipitation of carbonates or gypsum due to intensive evaporation in semi arid arid and hyper arid regions are given in the literature 10 4 to 10 6 cm s al yaqout and townsend 2004 0 0002 to 0 008 m day heilweil and watt 2011 2 8 10 7 m s mujica and bea 2020 among others in most reported cases these strata hydrologically cap the vadose zone rather than a perched or confined aquifer in our situation we could not excavate deeper to the next low permeable horizon and therefore in fig 1 a the aquifer is not confined from below we note that genesis of the caliche in the squ soil profile is similar to what michalski et al 2013 argued about the impact of the upwelling martian groundwater on the sequence of cemented sediments of the red planet specifically a periodic upwelling rise of groundwater in squ shallow perched unconfined aquifers and intensive evaporation from the water table has allegedly formed the caliche and self confined this aquifer by a caprock fig 1a when we punctured the caliche by the jcb scoop groundwater gushed into the excavation and filled it to the level of h a fig 1a within 2 hours we collected soil sediment samples measured ks using standard techniques see e g al shukaily et al 2020b and ascribed the obtained value to the textural class of hydrus 2d sands fig 1a shows a vertical cross section of an empty ditch b 0 mc 0 which drains a dry soil layer above a horizontal aquifuge and a confined homogeneous and isotropic aquifer having at saturation a hydraulic conductivity ks beneath an originally impermeable layer caprock abca point a in fig 1a is at infinity on the riemann sphere if the excavation depth h counted from abca point m is the deepest point of the ditch is below the aquifuge groundwater discharges into the ditch bmc symmetric and having the width 2 l with the total flow rate q d m2 s we assume that flow takes place only below the aquifuge goldspiel and squyres 2011 call this layer aquiclude that is in the vernacular of groundwater hydrology strack 1989 a martian misnomer because goldspiel and squyres 2011 model impermeable rather than leaky confining layers at a point ah fig 1a located a certain distance l a l a l from o a remote piezometer shows an elevation h a for simplicity we ignore groundwater exfiltration upward through the caliche in fig 1a i e leaky layer aquitard flow scenarios as considered by kacimov and obnosov 2008 2019 we introduce cartesian coordinates ox y and the complex physical coordinate z x i y fig 1b in this section we study the case of an empty ditch i e the pressure head p along bmc is zero the emptiness of the ditch can be ensured by either a high manning slope in the direction perpendicular to the plane of fig 1a so that all seeped water rapidly flows away as surface water see e g al shukaili et al 2020a or by intensive evaporation provided h is relatively small and climate is arid enough we note that surface water flow perpendicular to the plane of fig 1 i e along the ditch can be easily tracked on earth in our fieldwork we detected what malin and edgett 2000 called a martian seepage fed surface runoff slow hortonian motion downslope a ditch with velocities of few mm s on mars the juxtaposition of groundwater and surface water flows reconstructed from the contemporary martian landforms is purely hypothetical malin and carr 1999 as we have already pointed out in section 1 a saturated 2 d flow from a homogeneous aquifer into a ditch fig 1a obeys laplace s equation 1 δ h x y 0 where v u v k s h is the darcian velocity vector u and v are its horizontal and vertical components h is the total piezometric head h p y where the pore water pressure is p ρ d gp g is gravity acceleration 9 8 m s2 on earth and3 7 m s2 on mars and ρ d is pore fluid s groundwater brine soil moisture density we emphasize that eq 1 and all the results below do not assume a quasi horizontal pore water motion as it is postulated for instance in the df model of boatwright and head 2019 and luo et al 2011 we introduce the complex potential w φ iψ φ ksh the stream function ψ and a velocity potential φ are conjugate harmonic functions due to symmetry we consider only the right half of the physical domain gz fig 1b the following dimensionless quantities are introduced h l a x y z r h h a p h l a x y z r h h a p l w q d w q d k s l v u v v u v k s where r 0 r is the modulus of point z x i y in the aquifer fig 1a the complex potential domain gw is depicted in fig 1c the piezometric head is assumed to be zero at points b and c the image of the bmc isobar in g is a specific curve whose shape is unknown far away from the ditch the piezometric head is constant ha along a circle of a radius la in gz fig 1a the image of this circle is a segment ahav in gw fig 1c now we use the trick implemented by zhukovskii 1948 in fluid mechanics of ideal fluids see recent applications in belotserkovsky and lifanov 1992 also employed in problems of subsurface mechanics of steady and transient darcian flows fujii and kacimov 1998 kacimov 1992 2000a 2007 2009 kacimov et al 2009 kacimov and obnosov 2002 pk 62 77 strack 1989 2020 vedernikov 1939 we place a line sink of intensity q 2qd at the origin of coordinates the complex potential of this sink is 2 w i q d 2 q d π ln z z r exp i ν r x 2 y 2 h q d π ln z ψ q d 2 q d π v v q d π r where ν is the argument of z it is evident from eq 2 that the streamlines of this flow are rays converging to point o in fig 1b the isotachs and equipotential lines are semicircles centered at the same point now we restrict r in eq 2 to only a positive pressure part of the half plane in fig 1a i e we use eq 2 for the reconstruction of bmc by plotting the curve which is determined by the following explicit formula 3 q d ln x 2 y 2 π y 0 x 1 h y 0 the depth h of the ditch is found from the solution of the equation 4 q d log y π y and is equal to 5 h q d w π q d π where w stands for the lambert w function implemented as productlog in wolfram s 1991 mathematica fig 2 a shows the mc contours for sink generated ditches fig 1b plotted for qd 0 2 1 and 5 86 curves 1 2 and 3 respectively curve 1 in fig 2b shows h qd from eq 3 it is obvious that for small qd the ditch degenerates into a horizontal segment while in another limit lim q d h 1 bmc becomes a semicircle the analytical solution 2 5 is similar to those obtained by bazanov see pk 62 77 and kacimov and obnosov 2002 for empty ditches reconstructed by the specification of boundaries corresponding to bmc in the hodograph or other auxiliary planes e g the plane of the zhukovskii holomorphic function which is defined as w i z see pk 62 77 we also recall the analytical and numerical solutions of dagan 1964 and gjerde and tyvand 1992 who studied potential transient 2 d not df flows towards horizontal drains modeled by linear sinks and empty circles correspondingly curve 2 in fig 2b shows a qd the cross sectional area a of bmc in fig 1a is evaluated by the nintegrate routine of mathematica as 6 a 2 0 1 y x d x fig 3 shows the results of modeling with hydrus 2d šimůnek et al 2016 we selected qd 0 2 π in the analytical solution 3 with the help of eqs 3 and 5 we generated 10 points on mc imported them from mathematica into hydrus and made a spline curve in dimensional quantities used by hydrus also hydrus uses z for the vertical coordinate fig 3a shows the hydrus modeling domain bounded by an isobaric curve mc for which we selected l 100 cm soil is loam from the hydrus soil catalog the horizontal and vertical segments cah and mav in fig 3 are no flow lines we selected l a 500 cm i e we assumed a quarter circle ahav with a radius of 500 cm to be a line with a constant piezometric head we recall that hydrus unlike pk 62 77 and strack 1989 uses h as a notation for the pressure head along which we set h a 32 2 cm this value was found at r 500 cm for a selected value of q d from the logarithmic variation of h x along ca counting from the fiducial point c where h c 0 see eq 2 fig 3b shows the isotachs also constant h and φ contours and fig 3c shows the streamlines the origin of the spatial coordinates is retained in fig 3 to indicate the position of the generating sink hydrus results match very well the analytical solution 3 a point sink generated dimple draining a confined aquifer in this section we use the same procedure as in section 2 for the case of axisymmetric flow towards a depression bmc shown in fig 4 in an axial cross section we select a system of cylindrical coordinates oz ρ κ where z is a vertical coordinate the same now as in hydrus 2d ρ x 2 y 2 r ρ 2 z 2 and the angular coordinate κ vanishes from the analysis due to axial symmetry at the origin o we now place a point sink of intensity q d m3 s the piezometric head caused by a point sink is pk 62 77 7 h q d 2 π k s 1 r 1 r where r is the radius of the depression that coincides with the r and ρ coordinate of points b and c in fig 4 eq 7 sets up the total head equal to zero in these reference points the depression of a depth h is empty and therefore the pressure head p b m c 0 along this curve in fig 4 a surface in 3 d at a remote point ah located at a distance r a r a r from point o fig 4 we have 8 h a q d 2 π k s r point ah is a surrogate infinity of the infinite point a on the riemann sphere the head of eq 8 is illustrated in a remote piezometer sketched in fig 4 we recall pk 62 77 that for flow to a 3 d sink the piezometric head at infinity is finite unlike for a 2 d sink section 2 for which the head at infinity point a in fig 1b logarithmically blows up to infinity we introduce dimensionless quantities h z ρ r h p ha ra h z ρ r h p h a r a q d q d 2 π k s r 2 v u v v u ρ v z k s where u v are now the radial and vertical velocity components from eq 7 a zero pressure isobar seepage face bmc is reconstructed similarly to eq 3 by an equation 9 ρ 1 1 z q d 2 z 2 0 ρ 1 h z 0 we note that some martian hydrologists use the term aquifer sapping face and crater wall goldspiel and squyres 2011 for what is called a seepage face in terrestrial civil engineering strack 1989 eq 9 defines a quartic line the depth h is found from eq 9 which at ρ 0 is reduced to a quadratic equation having the following physically meaningful solution 10 h q d 2 4 q d q d 2 we used eqs 9 10 and calculated the volume of the depression bmc in fig 4 as a body of revolution 11 v π h 0 ρ 2 z d z π q d 6 q d 2 6 q d 6 4 q d q d 4 q d fig 5 a shows the isobars mc for qd 0 2 1 2 curves 1 3 correspondingly in fig 5b the curves 10 and 11 are plotted obviously for lim q d 0 h 1 and lim q d v 2 π 3 bmc becomes a hemisphere in this limit while for small qd we get a disk the results of hydrus 2d simulations in dimensional quantities corresponding to the analytical case of qd 0 2 are presented in fig 6 as in section 2 fig 3 we considered a loamy soil we selected the radius r of the hydrus axisymmetric depression to be 100 cm using eqs 9 and 10 we generated ten discrete points on mc and made a hydrus spline seepage face the radius r a of a constant piezometric head quarter circle ahav was 500 cm according to eq 8 the total head h a p a h 20 cm at point ah and therefore along ahav i e the hydrus pressure head is p a v 520 cm at point av fig 6a presents steady state pressure head isolines fig 6b illustrated isotachs and fig 6c plots the streamlines fig 6bc perfectly fit the analytical solution in the next section we focus on an opposite case of steady flow in a purely unsaturated gardner soil albeit the same trick will be used viz we place a fictitious sink in the air and use real isobars to construct topographic craters dimples 4 an isobaric depression reconstructed from philip s point sink array and hydrus 2d simulations analytical solutions of sections 2 and 3 ignored flow in the unsaturated zone and the capillary fringe which are important in the case of small scale drainage entities e g abit et al 2008 silliman et al 2002 in this section we incorporate into an analytical quasilinear model all three physical factors which control seepage the gravitational force on earth or mars darcian resistance of the soil and capillarity we use a constitutive relation for the phase conductivity 12 k u n k s exp α p p where kun p for p 0 is an unsaturated hydraulic conductivity αp const 0 is the sorptive number 1 m gardner 1958 see also raats 1973 j r philip 1968 pioneered utilizing eq 12 for modeling 2d and 3d unsaturated flows see e g pullan 1990 raats et al 2002 the soil constant αp is related to the vg hydrus parameters α and n via well known empiric relations acharya et al 2012 we used eq 10 from ghezzehei et al 2007 the evaporation arises from a steady upward flow from a horizontal shallow water table w 1 w 0 w 2 to a hot and dry soil surface bmc fig 7 where the pressure head is constant p p s p s 0 this surface has a topographic depression with the deepest point m at a depth h 0 counted from the soil surface which is horizontal and flat far away from the topographic trough in fig 7 i e the water table is at a given depth b above a flat soil surface near remote points b and c bmc in fig 7 can also be related to the sapping valleys on mars see e g salese et al 2019 albeit there is a difference in scales the martian depth of the water table z s z 1 is 4 5 km while at squ the shallow groundwater table is only several tens of cm deep the depression in fig 7 is axisymmetric like in section 3 the axis of symmetry coincides with the oz axis of a cylindrical system of coordinates oz ρ introduced similarly as in section 3 above to be consistent with philip we orient oz downward thus the unsaturated soil in 3 d is sandwiched between the w 1 w 0 w 2 plane and the soil surface obtained by the revolution of bmc with respect to the axis oz in fig 7 there are no physical singularities representing drains subsurface emitters or plant roots in this soil layer the contour bmc in fig 7 is obtained in the following manner philip 1989 obnosov and kacimov 2018 a fictitious point sink of intensity q p m3 s is placed at the origin of coordinates such that the water table is beneath this sink at a depth of z 1 0 a fictitious horizontal isobaric plane f 1 f 0 f 2 is placed at the level z z 2 z 2 0 as illustrated in fig 7 at this plane the pressure head p p 0 is specified points b and c in fig 7 of an intermediate isobar between two sandwiching isobaric planes f 1 f 0 f 2 and w 1 w 0 w 2 are at the level of z s which can be either positive or negative fictitious point sources and sinks of intensity q p mirror each other with respect to the planes f 1 f 0 f 2 and w 1 w 0 w 2 only the first fictitious source under the water table placed on the oz axis at a depth of 2 z 1 is shown in fig 7 the array of an infinite number of such sinks sources generates a family of isobars some of which are real two dashed lines p p 2 p p 1 p 2 p 1 p s are sketched in fig 7 and others are fictitious two dotted lines p p 2 p p 1 p s p 2 p 1 are sketched in fig 7 mathematically instead of bmc in fig 7 we can select another soil surface for example any of the two dashed isobars practically we proceed in the following manner one goes to the field with a theta probe and collects the moisture content θs from the topsoil of a real depression having certain geometrical sizes b h if θs and hence p s is almost constant in the depression and on a flat surface away from the depression then the position z 1 z 2 of the origin of coordinates sink s locus and the strength q p of zhukovskii s sinks sources array should be mathematically adjusted in such a manner that the physical field depression becomes close to a mathematical isobar bmc in fig 7 in what follows we illustrate this algorithm routinely see philip 1968 raats 1970 obnosov and kacimov 2018 we introduce the kirchhoff potential ω which is often called the matric flux potential 13 ω ρ z p k u n u d u k u n p ρ z α p ω k s α p i e ω is the kirchhoff potential along w 1 w 0 w 2 obviously the lines of a constant kirchhoff potential are also isobars the values of corresponding pressure heads are found directly from eq 13 and isowetness curves the corresponding water content is found from eq 13 and the soil water retention function we introduce dimensionless quantities z b h z s z 1 z 2 ρ r h p z b h z s z 1 z 2 ρ r h p α 2 ω ω ω q p q p α ω v u v v u p v z k s for which the richards eq 0 is reduced to a linear ade 14 δ ω α p ω z u ρ ω ρ v z α p ω ω z where δ is the laplacian operator in ρ z and u ρ and v z are the radial and vertical velocity components then we adapt philip s 1989 and obnosov and kacimov 2018 solutions to the case of flow in fig 7 and obtain a series 15 ω ω 0 exp 2 z 1 z 2 exp 2 z z 2 exp 2 z z 2 1 exp 2 z 1 z 2 1 q p exp z 8 π exp r r exp r 1 r 1 exp r 2 r 2 exp r 3 r 3 exp r 4 r 4 r ρ 2 z 2 r 1 ρ 2 z 2 z 1 2 r 2 ρ 2 z 2 z 2 2 r 3 ρ 2 z 2 z 1 2 z 2 2 r 4 ρ 2 z 2 z 1 2 z 2 2 where the constant ω0 exp α p z 2 0 ω0 1 is the kirchhoff potential along f 1 f 0 f 2 at points b and c which are located on a physical isobar whose remote wings are above the sink in fig 7 we have ω ω s exp α p z 2 for ω0 ω s 1 the first term on the rhs of eq 15 determines 1 d unsaturated evaporative flow from w 1 w 0 w 2 to f 1 f 0 f 2 in the layer z 1 z z 2 the terms in the square brackets of eq 15 are responsible for sinks and sources and consequently for mirrored imaged with respect to the plains z z 1 and z z 2 we emphasize that philip 1989 and obnosov and kacimov 2018 studied flow for one real source representing a subsurface irrigation emitter while all in fig 7 and eq 15 are fictitious a trick similar to ours was used by zhukovskii 1948 in his famous formula for aerodynamics of ideal fluids he combined mathematical singularities of a characteristic holomorphic function two dipoles and vortex the latter placed inside an airfoil e g an impermeable cylinder zhukovskii also ignored a fictitious flow inside an airfoil in the vicinity of the vortex and only considered an exterior of a mathematical separatrix streamline cylinder we confine real darcian flow not by streamlines for the sake of brevity we have not even introduced the stokes stream function see obnosov and kacimov 2018 but by two isobars bmc and w 1 w 0 w 2 in fig 7 the results of computations based on eq 15 where the series was truncated to 5 terms are plotted by the contourplot routine of mathematica in fig 8 for z 1 z 2 ω0 qp 1 1 0 2 1 as an example in fig 8 we selected an isobar bm as the real depressed isobaric soil surface maintained at the kirchhoff potential ω s 0 26 for this isobar we used the findroot routine of mathematica and evaluated zm 0 389 zb zs 0 177 i e the dimensionless depth of the depression in fig 8 is h 0 566 hydrus 2d simulations are presented in fig 9 we used silt loam with the hydrus triad of the vg soil hydraulic parameters α n ks 2 1 m 1 41 1 08 m day we followed ghezzehei et al 2007 and made gardners s soil having αp 1 3α n i e αp 3 67 1 m in fig 9a a hydrus axial section is shown for the case of the pressure head p m c 0 82 m the flow domain which corresponds to the analytical depression has the hydrus coordinates zm 0 13 m zc 0 23 m and z w2 0 55 m the analytical isobar mc is converted to the hydrus spline curve similarly as in sections 2 and 3 fig 9b and c show the hydrus isobars and streamlines as is evident from fig 9c the ditch funnels up the flux of moisture from the water table that also evaporates at the almost flat part of the soil surface near point c in other words a simple flow tube is realized in fig 9c in fig 9d we assumed a wetter soil surface with p m c 0 63 m the origin of coordinates o is again like in figs 8 and 9a at the locus of the analytic imaginary sink the geometry of the flow domain has changed as compared to fig 9a the corresponding analytical depression mc has now the hydrus coordinates zm 0 1 m zc 0 176 m and z w2 0 55 m the isobars are shown in fig 9d they seem uninteresting like ones in fig 9b fig 9e presents hydrus streamlines which are more interesting indeed the flow topology is different from one in fig 9c specifically like in kacimov and youngs 2005 who studied a seemingly trivial flow domain having a nontrivial two sheet riemann surface in the hodograph plane see also anderson 2013 in fig 9e we see a separatrix ssswsd which divides the unsaturated domain into three subdomains in the first one counted from the left in fig 9e moisture ascends from segment w 0 sw of the water table to the closest deepest section msd of the ditch surface like in fig 9c at the rest of the water table segment sww 2 moisture descends infiltrates from ssc on the soil surface third subdomain pointsw is a stagnation point stagnation points and separatrix streamlines also appeared in raats 1977 for steady flows to an array of the parallel line sinks in unsaturated gardner soils in hydrus the numerical value of the velocity vector at this point x 0 35 m attains a sharp minimum 1 3 10 5 m day the second and most interesting subdomain in fig 9e is bounded by the separatrix streamline and a curve segment sdhpss along this isobar we recall that p m c 0 63 m moisture infiltrates into the soil through hpss and exfiltrates back into the atmosphere through sdhp making a u turn therefore the whole flow domain in fig 9e represents a complex flow tube similar to one in the potential flow shown in fig 62 of pk 77 it is noteworthy that in potential flows governed by the laplace equation this type of separatrix complex flow tubes emerges in situations when the boundary of the flow domain has three or more equipotential components fig 9c and e illustrate that in ade governed unsaturated flow a complex topology can appear in a domain bounded by two lines surfaces of a constant kirchhoff potential a hinge point hp in fig 9e is similar to ones in the classical tothian see e g kirkham 1947 toth 2009 topology of purely saturated flows controlled by gravity darcian resistance and topography of the isobaric ground surfaces postulated by toth along which groundwater infiltrates exfiltrates but without taking into account unsaturated flow in the vadose zone at the point hp the darcian velocity vector is tangential to the soil slope we rephrase if the velocity vector is decoupled into the components normal and tangential to the local soil surface then at hp the normal component is zero along sdhp this normal component is oriented from the soil to the air whereas along hpss the normal component points into the soil to summarize in the analysis of flow in an unsaturated soil represented in fig 9d and e we amended the tothian 2009 physical factors by capillarity of the soil we then got a topological pattern shown upside down at the forefront of the freeze and cherry 1979 and in a normal way in figs 2 25 2 26 of radcliffe and šimůnek 2010 5 a triangular ditch in a confined aquifer ιn this section we return to steady and capillarity free flow in saturated soil we consider 2 d potential flow in a vertical plane fig 10 a and use the notations of section 2 i e the complex physical coordinate is again z x i y a caprock of a confined aquifer is now breached by a triangular isosceles ditch b 0 mc 0 having a bank slope πω 0 ω 1 2 the flow domain gz is now the half plane y 0 with a triangular indent bmc ditch s depth is h l tan πω unlike in section 2 we allow water to accumulate in the ditch up the horizon b 1 c 1 at the level h w the piezometric head at infinity point a in fig 10ab is infinite but as in section 2 we replace this infinity by a surrogate infinity viz an equipotential line avah shown as a dashed semicircle and a segment in fig 10a and b respectively practically in a remote piezometer located distance l a from the ditch axis the total head h a counted from points b and c is measured the overall flow rate into the ditch is q t the domain gw of the complex potential w is sketched in fig 10b the boundary conditions for w are 16 ϕ k y along b b 1 and c c 1 ϕ k h w along b 1 m and m c 1 ψ q t 2 along a b ψ q t 2 along a c to the dimensionless quantities introduced in section 2 we add h w l a h a h w l a h a l q t q t k s l we map the tetragon gz onto a ha a lf plane η 0 of a reference plane ζ ξ iη fig 10c with the correspondence of points m 0 a b 1 c 1 b 1 β c 1 β appendix i presents the details of our solution an alternative method for the analytical solution see the taxonomy of these methods in aravin and numerov 1953 see also bear 1972 involves a conformal mapping of gz onto a mirror image of the pentagon in the hodograph plane fig 10d sketches such a half plane with two semi infinite cuts for the case of an empty ditch fig 11 shows the function qt h curve 1 computed by eq a9 for ha 3 and la 5 similarly to al shukaili et al 2020b and kacimov 1985 we introduce the morel seytoux dimensional seepage flow rate μ q t k s a a h l curve 2 in fig 11 plots the function μ h the minimum of the function is μ 6 085 and h 1 177 this minimum can be interpreted as a solution to the following optimal shape design problem osdp similar to ones solved in kacimov 2005 2006b osdp 1 determine an empty ditch into which a minimal quantity q t of water seeps provided the ditch area a and remote piezometric data h a and l a are fixed curve 2 in fig 11 provides evidence that there is a unique and global solution to osdp1 the minimum is mild similar to ones in kacimov 1985 i e triangular ditches having slopes close to the best one will not deviate much from the best minimal seepage exfiltration rates problems similar to osdp1 are common in civil engineering when a pit e g for a building foundation is excavated and minimum exfiltration is desired or pit s drainage measures are planned for comparisons in fig 12 we present the results of hydrus simulations for the tetrad of parameters h l l a h a 50 cm 100 cm 500 cm 300 cm fig 12a shows the isobars fig 12b illustrates the isotachs in the analytical solution the darcian velocity approaches infinity at points m and c at the same time it attains a minimal value which corresponds to the tip of the cut in the hodograph domain fig 10d hydrus shows the same in fig 12c we plot the distribution of the velocities along the ditch side mc where a minimum v 43 1 cm day is attained at sd 66 7 cm where sd is the arc coordinate counted from point m in fig 10a curves like the one in fig 12c are useful for the assessment of erosional stability of slopes of ditches since heaving and suffusion are determined by exit values and directions of hydraulic gradient vectors i for example pk 62 77 considers the condition i 1 as a criterion of instability according to which fig 12c illustrates that the ditch side mc in fig 12 is absolutely unstable at any sd the hydrus computed morel seytoux factor μ is equal to 6 97 for the trench in fig 12 while the analytical solution gives μ 7 08 we computed other triangular ditches in hydrus 2d by using a discrete variation of the slope angle we evaluated q t from the steady state limit of the cumulative flux into the ditch from a feeding semicircle fig 10a dashed curve then we converted this dimensional q t into the dimensionless μ which fits well the analytical curve 2 in fig 11 collation of solutions for seepage into a triangular ditch and sink generated ditch in section 2 is done in the following manner for the case presented in fig 11 we use eq 2 and evaluate qd πha lnla 3π ln5 5 86 the corresponding isobar is shown as curve 3 in fig 2 using eq 6 we evaluated the area and the morel seytoux factor μ 5 94 we surmise that this is a global optimum in the class of arbitrary ditch shapes next we considered a general case of a partially filled ditch fig 10a in fig 13 curves 1 3 show the graphs of the functions qt hw for three ditch slopes π 6 π 4 and π 3 and the same ha 3 and la 5 as in fig 11 in the regimes of partial filling we can solve osdps similar to osdp1 regional groundwater flow can be easily taken into account similarly to ilyinsky and kacimov 1992b the analytical solution to the steady problem can be readily extended to a transient regime of exfiltration into a gradually filling ditch we assume that the value h a in fig 10a is high enough such that when we make a ditch seepage into it does not reduce much h a and the soil in fig 10a remains saturated an aquifer remains confined let us assume similarly as in hydrus that during the transient seepage phase the porous skeleton and water are incompressible if evaporation from the ditch is ignored then from the principle of mass conservation the following ode follows 17 d a s d t q t h t where t is dimensional time and a s t is the area of the swelling triangle b 1 c 1 m in fig 10a for comparisons see al shukaili et al 2020b where emptying of triangular trenches has been studied obviously the initial condition in eq 17 is a s 0 0 i e seepage filling commences from an empty ditch stage we put a s t h h w t 2 cotan π ω into eq 17 and get the following cauchy problem 18 2 cotan π ω h w t h d h w t d t q t h w t h w 0 0 0 t we used the ndsolve routine of mathematica to solve the nonlinear 1 st order ode 18 numerically with the rhs taken from eq a9 for this purpose we interpolated 51 point values of q t h w see curve 1 in the steady state problem the results of computations are shown in fig 13 in dimensionless quantities to which we added a dimensionless time t t ks l in fig 14 we plotted the functions hw t obtained from the solution of eq 18 for ha 3 and la 5 and the same ditch slopes ω 1 6 1 4 and 1 3 curves 1 3 correspondingly as is evident from these draw up curves the ditches are filled out in finite time intervals tf 0 115 0 175 0 24 respectively at t tf seepage into a ditch continues due to an artesian pressure in an aquifer and exfiltrating water has to be removed e g pumped out if we want to keep points c and b in fig 10a at zero pressure heads i e not ponded that is equivalent to the condition that the horizon bc remains static see in kacimov 1991 a similar flow regime in a horizontal plane the type of curves in fig 14 can be used for the determination of ks similarly to al shukaili et al 2020b and kacimov 2000b that is also useful for deep structure constructors when pumping tests in deep confined aquifers are not feasible if an aquifer is unconfined then for a suddenly emptied ditch or an auger hole kacimov 2000 b tf a transient analytical solution can be compared with a numerical one which involves a new reservoir boundary condition of hydrus šimůnek et al 2018 this new hydrus option allows for the consideration of variable storage of a furrow channel or wellbore e g bristow et al 2020 sasidharan et al 2018 2019 2020 the contours of which are subject to the condition of a constant piezometric head on the submerged part and a seepage face on the empty part of the draining entity hydrus then considers flow into or out of the reservoir through its interface with the subsurface transport domain to depend on the prevailing conditions in the transport domain such as the position of the groundwater table or piezometric heads and external fluxes such as pumping or injection or evaporation or precipitation the furrow reservoir šimůnek et al 2018 can be adapted for our triangular ditch the problem considered in fig 12 was rerun under transient conditions starting with an empty ditch with dimensional sizes of h 50 cm and l 100 cm corresponding to the case illustrated by curve 1 in fig 14 the hydrus draw up curve h w t is shown in fig 15 there is a perfect match between the results in fig 15 and curve 1 in fig 14 from the analytical solution in dimensionless variables we also compared the transient fluxes into the half ditch i e the analytical qt 2 from fig 11 curve 1 and one computed by hydrus for example at t 0 1day the hydrus flux is about 6075 cm2 day whereas the analytical flux q t 2 is 6063 cm2 day 6 comparison of terrestrial and martian evaporating spots as an example let us consider depression 1 qd 0 2 in fig 5 assume r 100 cm h 35 cm and a loamy soil having ks 25 cm day let the water evaporate from the disk πr 2 with a constant intensity e in order to keep the crater empty this value has to be e 0 2 25 π 1 6 cm day which is according to the penman monteith equation and field measurements of evaporation a too high value even in the empty quarters of oman if one wants to reconstruct the desertification of mars or intercept ascending moisture fluxes from the deep water table such as for example in the process of mars colonization then the topography like the one in fig 9 should be taken into account similarly as what we have on earth hummocky terrains or even earth dams kacimov and brown 2015 generate complex 2d and 3d toth type darcian fluxes specifically flat landforms with a homogeneous vadose zone and a shallow water table are easy to examine for water storage and fluxes it suffices to measure the depth of the water table and the pressure head moisture content of the topsoil to infer what is the value and direction of the flux if the vadose zone is heterogeneous the flux magnitudes can attain nontrivial extrema even of a simplest type of a two layered soil kacimov et al 2019 fig 9e illustrates that routine measurements of the boundary condition on soil surfaces with depressions are not sufficient for the determination of the directions and magnitudes of the motion of water governed by the richards equation 7 concluding remarks the mainstream groundwater hydrology focuses on mar managed aquifer recharge a method of replenishing aquifers especially in arid environments we are putting forward the opposite concept of mad managed aquifer discharge of shallow aquifers which have to be intelligently drained to mitigate the damage inflicted by groundwater inundation the analysis in this paper will be useful in planned drainage of water logged built up areas and further studies in dryland ecohydrology camporeale et al 2019 maillart s desert ditches of central asia similarly as ones in humid holland can be viewed as a technique of lowering a shallow water table or piezometric surface the shape of these ditches can be mathematically approximated by isobars made by hydrodynamic sinks comparable with zhukovskii s method of a smart composition of singularities in aerodynamics the darcian flows governed by the laplace equation in saturated media or ade for steady flows in unsaturated media can be viewed as created by intelligently located singularities the resulting isobars model the outlets in seepage to empty curvilinear ditches and depressions seepage to triangular ditches both empty and partially filled is modeled by conformal mappings and the bvp method the transient stage of filling i e the variable storage in ditches is examined by solving a cauchy problem for a nonlinear ode with type curves showing how rapidly the ditch is filled up hydrus 2d simulations well agree with analytical modeling analytical solutions and hydrus reconstruct jointly isobars isohumes isotachs and streamlines the theoretical arsenal of soil physicists and civil engineers working with earth and mars soil and water systems the proper design of ditches pits and other artificial excavations to be operated in shallow water table environments as well as an understanding of subsurface hydrology of natural wadis and depressions can incorporate the findings of this paper declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported bysultan qaboos university via the grant rise of water table and its mitigation at squ campus grant dr rg 17 and it was carried out as part of the development program of the scientific and educational mathematical center of the volga federal district agreement no 075 02 2020 1478 helpful comments by two anonymous referees are highly appreciated supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2020 103732 appendix b supplementary materials image application 1 appendix the schwarz christoffel integral maps conformally the reference half plane on gz a1 z ζ i h c 1 1 i h 0 ζ 1 τ 2 ω τ 2 ω d τ 1 i h b ζ 2 1 2 ω 1 ω b 1 2 ω 1 ω where b and b ζ 2 are the complete and incomplete beta functions respectively abramowitz and stegun 1969 formula 6 6 1 the positive constant c 1 2 b 1 2 ω 1 ω in a1 is determined from the condition z 1 1 note that z ζ obeys the symmetry condition z ζ z ζ as it should be from eq a1 along two seepage faces bb 1 and cc 1 we have a2 y ξ h b ξ 2 1 2 ω 1 ω b 1 2 ω 1 ω 1 β ξ 1 where β is the affix of point c 1 we determine β from the relation y β hw that gives a3 b β 2 1 2 ω 1 ω b 1 2 ω 1 ω h h w h next we introduce a holomorphic function a4 w ζ w ζ i q t π arcsin ζ the function a4 in accordance with 16 and properties of the function arcsin satisfies the conditions re w ξ y ξ ξ 1 β β 1 re w ξ h w ξ β β im w ξ 0 ξ 1 1 here y ξ is determined in eq a2 then the function w 0 ζ w ζ 1 ζ 2 obeys the following conditions along the ξ axis a5 re w 0 ξ y ξ 1 ξ 2 ξ 1 β β 1 re w 0 ξ h w 1 ξ 2 ξ β β re w 0 ξ 0 ξ 1 1 eqs a5 comprise a riemann schwartz bvp henrici 1993 pk 62 77 the function w ζ is finite at two transition points ξ 1 continuous at points β and has a logarithmic singularity at infinity hence the function w 0 ζ has integrable singularities at points ξ 1 and vanishes at infinity therefore the unique solution of the problem a5 gives the schwartz operator for the upper half plane henrici 1993 pk 62 77 thus after simple algebra we get a6 w ζ 2 ζ 1 ζ 2 π i h w 0 β d τ 1 τ 2 τ 2 ζ 2 β 1 y τ d τ 1 τ 2 τ 2 ζ 2 where for the sake of definiteness the branch of the radical 1 ζ 2 is fixed positive for ζ ξ 1 1 in the upper half plane this branch and therefore the function a6 satisfy the symmetry condition w ζ w ζ the integrals in a6 are evaluated by the sokhotski plemely formula the first for ζ ξ 0 β and the second for ζ ξ β 1 henrici 1993 we illustrate the computations for the case of an empty ditch hw h we use the piezometric data at point ah fig 10a i e φ a ha first from eq a1 along the ray ca we get a7 x ξ 1 2 1 h 2 1 ξ τ 2 1 ω τ 2 ω d τ b 1 2 ω 1 ω ξ 1 from eq a5 we determine the affix γ of point ah in the reference plane fig 10c a8 l a x γ we use the findroot routine of mathematica to solve eq a8 for γ we put the found root of eq a8 into eq a6 and at ϕ a ϕ γ q t log γ γ 2 1 π re w γ arrive at the equality a9 q t 2 γ γ 2 1 log γ γ 2 1 h w 0 β d τ 1 τ 2 γ 2 τ 2 β 1 y τ d τ 1 τ 2 γ 2 τ 2 π ϕ a log γ γ 2 1 
404,an isobar generated by a line or point sink draining a confined semi infinite aquifer is an analytic curve to which a steady 2 d plane or axisymmetric darcian flow converges this sink may represent an excavation ditch or wadi on earth or a channel on mars the strength of the sink controls the form of the ditch depression for 2 d flow the shape of the isobar varies from a zero depth channel to a semicircle for axisymmetric flow depressions as flat as a disk or as deep as a hemisphere are reconstructed in the model of axisymmetric flow a fictitious j r philip s point sink is mirrored by an infinite array of sinks and sources placed along a vertical line perpendicular to a horizontal water table a topographic depression is kept at constant capillary pressure water content kirchhoff potential none of these singularities belongs to the real flow domain evaporating unsaturated gardnerian soil saturated flow towards a triangular empty or partially filled ditch is tackled by conformal mappings and the solution of riemann s problem in a reference plane the obtained seepage flow rate is used as a right hand side in an ode of a cauchy problem the solution of which gives the draw up curves i e the rise of the water level in an initially empty trench hydrus 2d computations for flows in saturated and unsaturated soils match well the analytical solutions the modeling results are applied to assessments of real hydrological fluxes on earth and paleo reconstructions of martian hydrology geomorphology keywords analytic and hydrus solutions for darcian 2 d and axisymmetric flows in saturated and unsaturated soils towards drainage ditches and topographic depressions evaporation and seepage exfiltration from shallow groundwater complex potential and conformal mappings method of images with sinks and sources for the laplace equation and ade boundary value problems involving seepage faces on earth and mars isobars isotachs constant piezometric head and kirchhoff potential lines abbreviations ade advective dispersion equation bvp boundary value problem df dupuit forchheimer lhs rhs left hand side right hand side ode ordinary differential equation osdp optimal shape design problem pk 62 77 polubarinova kochina p ya 1962 theory of ground water movement princeton university press princeton the second edition of the book in russian was published in 1977 nauka moscow vg van genuchten 1 introduction i had to live in the desert before i could understand the full value of grass in a green ditch ella maillart analytical models of 2 d seepage towards drainage ditches and trenches constructed by civil geotechnical and agricultural engineers used the machinery of complex variables anderson 2013 aravin and numerov 1953 bear 1972 kirkham and powers 1972 polubarinova kochina 1962 1977 hereafter abbreviated as pk 62 77 skaggs et al 1999 strack 1989 vedernikov 1939 in particular by tackling free boundaries of darcian flows the so called phreatic surfaces we recall see e g radcliffe and šimůnek 2010 that transient 3 d saturated unsaturated flows in porous media when both water and soil are incompressible obey the richards equation 0 θ t k p h where θ t x y z is the volumetric moisture content is the nabla operator in cartesian or cylindrical coordinates k p x y z is the hydraulic conductivity function h t x y z p z is the total head p is the pressure head z is a vertical coordinate and p θ is a capillary pressure water retention function fixed for each soil eq 0 involves the darsy law v k p h where v is the darcian flux vector and the principle of mass conservation boundary value problems hereafter abbreviated as bvps are solved for eq 0 by specifying initial conditions e g θ 0 x y z as well as imposing physically meaningful boundary conditions e g dirichlet s neumann s only numerical codes like hydrus 3d šimůnek et al 2016 tackle such problems for arbitrary 3d transient flows eq 0 is a highly nonlinear parabolic pde for steady flows its lhs vanishes and the equation becomes elliptic if the flow is purely saturated and the porous medium is homogeneous then k p ks where ks is the saturated hydraulic conductivity and eq 0 is reduced to a linear laplace equation for a special class of soils with an exponential k p function gardner 1958 the kirchhoff transform makes possible a linearization such that eq 0 is reduced to a linear advective dispersion equation ade with respect to a kirchhoff potential the ade can be analytically solved for solitary or systematically placed singularities kacimov 2007 philip 1968 1971 pullan 1990 raats 1971 1972 more details on bvps for the laplace equation and the ade are given in sections 2 5 of the ms the total head for saturated seepage in undeformable porous media obeys the laplace equation and therefore the mathematical commonality between flows of ideal fluids zhukovskii 1948 and pore water motion has been widely explored pk 62 77 strack 1989 the method of images and the theory of bvps henrici 1993 have been engaged in this paper we combine these traditional analytical and new numerical hydrus 2d šimůnek et al 2016 methods to problems of groundwater and soil water movement from shallow confined and unconfined aquifers towards ditches and topographic depressions common in desert landforms of arid hyperarid climates of oman and mars a practical motivation of our work stems from a daunting problem of groundwater inundation caused by a rapid rise of the water table in perched unconfined and shallow confined aquifers detected in many urban areas of the world see e g attard et al 2016 barron et al 2013 chaudhary 2012 coda et al 2019 howard and israfilov 2012 jha et al 2012 kazemi 2011 lerner 2003 lerner and harris 2008 medovar et al 2018 naik et al 2008 porse et al 2016 preene and fisher 2015 quan et al 2010 schirmer et al 2013 vázquez suñé et al 2005 vogwill 2016 surprisingly the arid countries of arabia despite the hydrological mantra on water deficit and groundwater depletion encounter the same problem of waterlogging of urban structures by shallow groundwater as the cities in humid zones e g abu rizaiza et al 1989 abu rizaiza 1999 al rawas and qamaruddin 1998 al sefry and şen 2006 al senafy 2011 al senafy et al 2015 alsharhan et al 2020 bob et al 2016 kreibich and thieken 2008 it is noteworthy that urbanization in the southwest of the usa caused similar negative hydrological impacts amplification of flash flood intensities due to reduced evapotranspiration see e g goudie 2013 in the metropolitan area of muscat at the campus of sultan qaboos university squ the groundwater inundation has become evident even without any piezometry in recent years subsurface water seeped out in natural topographic depressions man made excavations ditches and drainage channels called wadis large wet spots or ponded areas at squ are bio marked by adjacent lush wild vegetation in the desert climate of oman this vegetation in some places pops up virtually as maillart s grass in green ditches see the epigraph the studied squ field is located in a hyperarid zone of the batinah coast oman arabia e g alsharhan et al 2001 2020 the investigated wadi section was about 1 km long with several excavated pits trenches and natural depressions for instance one of the excavations has the following coordinates northing 619721 easting 2608729 47 5 m above the level in the sea of oman urbanization of the field started in the mid 1980s before which the site was a desert with scattered shrubs and trees currently a significant part of the campus area is paved which reduced natural evapotranspiration waterlogging and associated lush vegetation are geotechnically deleterious putting foundations of the squ buildings roads subsurface cables etc in jeopardy even when the salinity of the rising groundwater is small secondary salinization of the topsoil is also widespread in oman when the rise of the water table is from an aquifer of poor groundwater quality fieldwork was carried out in november june 2020 at the squ campus auger holes ditches and excavations were constructed and groundwater monitored to assess soil moisture oozing fluxes above shallow perched and confined aquifers detected in the study area the motivation of this work also stems from our intention to attract the attention of planet mars hydrologists who model seepage of martian groundwater into remotely scanned relief features of the red planet and the legacy of experts in irrigation and drainage engineering who during the 20th century assembled a good arsenal of analytical and numerical methods for investigations of the motion of pore water towards drains bear 1972 kirkham and powers 1972 skaggs et al 1999 2012 strack 1989 vedernikov 1939 zhukovskii 1948 mars is a hyperarid planet where the remotely analyzed landforms craters dunes endorheic lakes and playas pits alcoves gullies recurring slope lineae fluvio lacustrine basins fans shallow dust horizons streaks amphitheater headed valleys sapping valleys etc and hydrological elements springs outseeps deep fracture conduits seepage spots which convey liquid water brine and martian gases are studied the alleged paleo and current dynamics of martian pore fluids are elaborated for example in abotalib and heggy 2019 bhardwaj et al 2019 boatwright and head 2019 edwards and piqueux 2016 goldspiel and squyres 2011 grimm et al 2014 hobbs et al 2014 kereszturi et al 2010 kochel and piper 1986 luo et al 2011 malin and carr 1999 malin and edgett 2000 marra et al 2014 2015 michalski et al 2013 mukherjee et al 2020 and salese et al 2019 for hypothetical martian aquifers both unconfined and artesian ks is assessed from proxy data see e g the posited nominal value in goldspiel and squyres 2011 luo et al 2011 evaluated the hydraulic conductivity from the solution of inverse problems of the hydrological cycle on mars boatwright and head 2019 assumed that the conductivity exponentially decreases with the martian depth we note that even the darcy law is sometimes not correctly formulated by martian hydrologists see e g an erroneous eq 1 in abotalib and heggy 2019 although purely unsaturated flows are also hypothesized edwards and piqueux 2016 grimm et al 2014 to occur on mars to the best of our knowledge martian hydrologists e g luo et al 2011 have so far used only flow models for saturated soils models of darcian flows towards drainage ditches commonly conceptualize the ditches as rectangles in vertical cross sections having vertical slopes afruzi et al 2014 barua and alam 2013 chahar and vadodaria 2008 2012 gureghian and youngs 1975 sarmah and tiwari 2018 youngs 1975 1990 1994 however natural ephemeral river channels both on earth and mars as well as constructed drainage ditches and trenches often have non rectangular shapes grotzinger et al 2014 kocurek et al 2020 excavations pits and natural depressions are often axisymmetric and mild sloped see e g goldspiel and squyres 2011 only in few studies have phreatic seepage and flows in the unsaturated zone to non rectangular trapezoidal and curvilinear draining entities been analytically examined pk 77 reported solutions by bazanov p 150 of her book and vedernikov pp 181 182 see also ilyinsky and kacimov 1992a kacimov 2005 2006a kacimov and obnosov 2002 we note that although luo et al 2011 sketched trapezoidal draining channels in their models of groundwater discharge into these channels they posited the dupuit forchheimer hereafter abbreviated as df model which actually ignores the shape of channels marra et al 2014 2015 conceptualized and studied experimentally in sandboxes seepage into real trapezoidal channels allegedly occurring on mars but unfortunately did not refer to a plethora of theoretical studies of this type of seepage to draining channels on our own planet see e g aravin and numerov 1953 pk 62 77 vedernikov 1939 this work is organized as follows in section 2 we develop a simple analytical solution for a 2 d not df confined flow to a curvilinear ditch draining a saturated confined aquifer some natural wadi channels in our study area are arcuate like ones on mars malin and carr 1999 but as the first approximation we ignore the 3 d effect our ditch contour is an isobar generated by a line sink in section 3 we obtain a similar solution for a point sink in an axisymmetric flow towards a crater shaped isobar the piezometric head being still a harmonic function in section 4 we assemble an infinite array of j r philip s sinks sources of the advective dispersion equation ade for the kirchhoff potential which models an axisymmetric steady water movement from a horizontal water table towards a topographic depression in a partially saturated so called gardner soil in section 5 and appendix i 2 d seepage towards a triangular empty or partially filled ditch is studied by the machinery of holomorphic functions all analytical solutions of sections 2 5 are tested against hydrus 2d numerical simulations in section 6 we outline applications to arid zone hydrology and in particular to martian hydrology 2 a line sink generated seepage face ditch draining a confined aquifer unlike hobbs et al 2014 who could not identify confining layers in the form of bedrocks and caprocks of hydrostratigraphic units in the martian regolith massif we when making excavations on our squ site indeed crashed a low permeable caliche layer at a depth of 1 5 2 m typical values of ks for low permeable cemented layers also called calcrete petrocalcic horizons see e g duniway et al 2010 formed by the precipitation of carbonates or gypsum due to intensive evaporation in semi arid arid and hyper arid regions are given in the literature 10 4 to 10 6 cm s al yaqout and townsend 2004 0 0002 to 0 008 m day heilweil and watt 2011 2 8 10 7 m s mujica and bea 2020 among others in most reported cases these strata hydrologically cap the vadose zone rather than a perched or confined aquifer in our situation we could not excavate deeper to the next low permeable horizon and therefore in fig 1 a the aquifer is not confined from below we note that genesis of the caliche in the squ soil profile is similar to what michalski et al 2013 argued about the impact of the upwelling martian groundwater on the sequence of cemented sediments of the red planet specifically a periodic upwelling rise of groundwater in squ shallow perched unconfined aquifers and intensive evaporation from the water table has allegedly formed the caliche and self confined this aquifer by a caprock fig 1a when we punctured the caliche by the jcb scoop groundwater gushed into the excavation and filled it to the level of h a fig 1a within 2 hours we collected soil sediment samples measured ks using standard techniques see e g al shukaily et al 2020b and ascribed the obtained value to the textural class of hydrus 2d sands fig 1a shows a vertical cross section of an empty ditch b 0 mc 0 which drains a dry soil layer above a horizontal aquifuge and a confined homogeneous and isotropic aquifer having at saturation a hydraulic conductivity ks beneath an originally impermeable layer caprock abca point a in fig 1a is at infinity on the riemann sphere if the excavation depth h counted from abca point m is the deepest point of the ditch is below the aquifuge groundwater discharges into the ditch bmc symmetric and having the width 2 l with the total flow rate q d m2 s we assume that flow takes place only below the aquifuge goldspiel and squyres 2011 call this layer aquiclude that is in the vernacular of groundwater hydrology strack 1989 a martian misnomer because goldspiel and squyres 2011 model impermeable rather than leaky confining layers at a point ah fig 1a located a certain distance l a l a l from o a remote piezometer shows an elevation h a for simplicity we ignore groundwater exfiltration upward through the caliche in fig 1a i e leaky layer aquitard flow scenarios as considered by kacimov and obnosov 2008 2019 we introduce cartesian coordinates ox y and the complex physical coordinate z x i y fig 1b in this section we study the case of an empty ditch i e the pressure head p along bmc is zero the emptiness of the ditch can be ensured by either a high manning slope in the direction perpendicular to the plane of fig 1a so that all seeped water rapidly flows away as surface water see e g al shukaili et al 2020a or by intensive evaporation provided h is relatively small and climate is arid enough we note that surface water flow perpendicular to the plane of fig 1 i e along the ditch can be easily tracked on earth in our fieldwork we detected what malin and edgett 2000 called a martian seepage fed surface runoff slow hortonian motion downslope a ditch with velocities of few mm s on mars the juxtaposition of groundwater and surface water flows reconstructed from the contemporary martian landforms is purely hypothetical malin and carr 1999 as we have already pointed out in section 1 a saturated 2 d flow from a homogeneous aquifer into a ditch fig 1a obeys laplace s equation 1 δ h x y 0 where v u v k s h is the darcian velocity vector u and v are its horizontal and vertical components h is the total piezometric head h p y where the pore water pressure is p ρ d gp g is gravity acceleration 9 8 m s2 on earth and3 7 m s2 on mars and ρ d is pore fluid s groundwater brine soil moisture density we emphasize that eq 1 and all the results below do not assume a quasi horizontal pore water motion as it is postulated for instance in the df model of boatwright and head 2019 and luo et al 2011 we introduce the complex potential w φ iψ φ ksh the stream function ψ and a velocity potential φ are conjugate harmonic functions due to symmetry we consider only the right half of the physical domain gz fig 1b the following dimensionless quantities are introduced h l a x y z r h h a p h l a x y z r h h a p l w q d w q d k s l v u v v u v k s where r 0 r is the modulus of point z x i y in the aquifer fig 1a the complex potential domain gw is depicted in fig 1c the piezometric head is assumed to be zero at points b and c the image of the bmc isobar in g is a specific curve whose shape is unknown far away from the ditch the piezometric head is constant ha along a circle of a radius la in gz fig 1a the image of this circle is a segment ahav in gw fig 1c now we use the trick implemented by zhukovskii 1948 in fluid mechanics of ideal fluids see recent applications in belotserkovsky and lifanov 1992 also employed in problems of subsurface mechanics of steady and transient darcian flows fujii and kacimov 1998 kacimov 1992 2000a 2007 2009 kacimov et al 2009 kacimov and obnosov 2002 pk 62 77 strack 1989 2020 vedernikov 1939 we place a line sink of intensity q 2qd at the origin of coordinates the complex potential of this sink is 2 w i q d 2 q d π ln z z r exp i ν r x 2 y 2 h q d π ln z ψ q d 2 q d π v v q d π r where ν is the argument of z it is evident from eq 2 that the streamlines of this flow are rays converging to point o in fig 1b the isotachs and equipotential lines are semicircles centered at the same point now we restrict r in eq 2 to only a positive pressure part of the half plane in fig 1a i e we use eq 2 for the reconstruction of bmc by plotting the curve which is determined by the following explicit formula 3 q d ln x 2 y 2 π y 0 x 1 h y 0 the depth h of the ditch is found from the solution of the equation 4 q d log y π y and is equal to 5 h q d w π q d π where w stands for the lambert w function implemented as productlog in wolfram s 1991 mathematica fig 2 a shows the mc contours for sink generated ditches fig 1b plotted for qd 0 2 1 and 5 86 curves 1 2 and 3 respectively curve 1 in fig 2b shows h qd from eq 3 it is obvious that for small qd the ditch degenerates into a horizontal segment while in another limit lim q d h 1 bmc becomes a semicircle the analytical solution 2 5 is similar to those obtained by bazanov see pk 62 77 and kacimov and obnosov 2002 for empty ditches reconstructed by the specification of boundaries corresponding to bmc in the hodograph or other auxiliary planes e g the plane of the zhukovskii holomorphic function which is defined as w i z see pk 62 77 we also recall the analytical and numerical solutions of dagan 1964 and gjerde and tyvand 1992 who studied potential transient 2 d not df flows towards horizontal drains modeled by linear sinks and empty circles correspondingly curve 2 in fig 2b shows a qd the cross sectional area a of bmc in fig 1a is evaluated by the nintegrate routine of mathematica as 6 a 2 0 1 y x d x fig 3 shows the results of modeling with hydrus 2d šimůnek et al 2016 we selected qd 0 2 π in the analytical solution 3 with the help of eqs 3 and 5 we generated 10 points on mc imported them from mathematica into hydrus and made a spline curve in dimensional quantities used by hydrus also hydrus uses z for the vertical coordinate fig 3a shows the hydrus modeling domain bounded by an isobaric curve mc for which we selected l 100 cm soil is loam from the hydrus soil catalog the horizontal and vertical segments cah and mav in fig 3 are no flow lines we selected l a 500 cm i e we assumed a quarter circle ahav with a radius of 500 cm to be a line with a constant piezometric head we recall that hydrus unlike pk 62 77 and strack 1989 uses h as a notation for the pressure head along which we set h a 32 2 cm this value was found at r 500 cm for a selected value of q d from the logarithmic variation of h x along ca counting from the fiducial point c where h c 0 see eq 2 fig 3b shows the isotachs also constant h and φ contours and fig 3c shows the streamlines the origin of the spatial coordinates is retained in fig 3 to indicate the position of the generating sink hydrus results match very well the analytical solution 3 a point sink generated dimple draining a confined aquifer in this section we use the same procedure as in section 2 for the case of axisymmetric flow towards a depression bmc shown in fig 4 in an axial cross section we select a system of cylindrical coordinates oz ρ κ where z is a vertical coordinate the same now as in hydrus 2d ρ x 2 y 2 r ρ 2 z 2 and the angular coordinate κ vanishes from the analysis due to axial symmetry at the origin o we now place a point sink of intensity q d m3 s the piezometric head caused by a point sink is pk 62 77 7 h q d 2 π k s 1 r 1 r where r is the radius of the depression that coincides with the r and ρ coordinate of points b and c in fig 4 eq 7 sets up the total head equal to zero in these reference points the depression of a depth h is empty and therefore the pressure head p b m c 0 along this curve in fig 4 a surface in 3 d at a remote point ah located at a distance r a r a r from point o fig 4 we have 8 h a q d 2 π k s r point ah is a surrogate infinity of the infinite point a on the riemann sphere the head of eq 8 is illustrated in a remote piezometer sketched in fig 4 we recall pk 62 77 that for flow to a 3 d sink the piezometric head at infinity is finite unlike for a 2 d sink section 2 for which the head at infinity point a in fig 1b logarithmically blows up to infinity we introduce dimensionless quantities h z ρ r h p ha ra h z ρ r h p h a r a q d q d 2 π k s r 2 v u v v u ρ v z k s where u v are now the radial and vertical velocity components from eq 7 a zero pressure isobar seepage face bmc is reconstructed similarly to eq 3 by an equation 9 ρ 1 1 z q d 2 z 2 0 ρ 1 h z 0 we note that some martian hydrologists use the term aquifer sapping face and crater wall goldspiel and squyres 2011 for what is called a seepage face in terrestrial civil engineering strack 1989 eq 9 defines a quartic line the depth h is found from eq 9 which at ρ 0 is reduced to a quadratic equation having the following physically meaningful solution 10 h q d 2 4 q d q d 2 we used eqs 9 10 and calculated the volume of the depression bmc in fig 4 as a body of revolution 11 v π h 0 ρ 2 z d z π q d 6 q d 2 6 q d 6 4 q d q d 4 q d fig 5 a shows the isobars mc for qd 0 2 1 2 curves 1 3 correspondingly in fig 5b the curves 10 and 11 are plotted obviously for lim q d 0 h 1 and lim q d v 2 π 3 bmc becomes a hemisphere in this limit while for small qd we get a disk the results of hydrus 2d simulations in dimensional quantities corresponding to the analytical case of qd 0 2 are presented in fig 6 as in section 2 fig 3 we considered a loamy soil we selected the radius r of the hydrus axisymmetric depression to be 100 cm using eqs 9 and 10 we generated ten discrete points on mc and made a hydrus spline seepage face the radius r a of a constant piezometric head quarter circle ahav was 500 cm according to eq 8 the total head h a p a h 20 cm at point ah and therefore along ahav i e the hydrus pressure head is p a v 520 cm at point av fig 6a presents steady state pressure head isolines fig 6b illustrated isotachs and fig 6c plots the streamlines fig 6bc perfectly fit the analytical solution in the next section we focus on an opposite case of steady flow in a purely unsaturated gardner soil albeit the same trick will be used viz we place a fictitious sink in the air and use real isobars to construct topographic craters dimples 4 an isobaric depression reconstructed from philip s point sink array and hydrus 2d simulations analytical solutions of sections 2 and 3 ignored flow in the unsaturated zone and the capillary fringe which are important in the case of small scale drainage entities e g abit et al 2008 silliman et al 2002 in this section we incorporate into an analytical quasilinear model all three physical factors which control seepage the gravitational force on earth or mars darcian resistance of the soil and capillarity we use a constitutive relation for the phase conductivity 12 k u n k s exp α p p where kun p for p 0 is an unsaturated hydraulic conductivity αp const 0 is the sorptive number 1 m gardner 1958 see also raats 1973 j r philip 1968 pioneered utilizing eq 12 for modeling 2d and 3d unsaturated flows see e g pullan 1990 raats et al 2002 the soil constant αp is related to the vg hydrus parameters α and n via well known empiric relations acharya et al 2012 we used eq 10 from ghezzehei et al 2007 the evaporation arises from a steady upward flow from a horizontal shallow water table w 1 w 0 w 2 to a hot and dry soil surface bmc fig 7 where the pressure head is constant p p s p s 0 this surface has a topographic depression with the deepest point m at a depth h 0 counted from the soil surface which is horizontal and flat far away from the topographic trough in fig 7 i e the water table is at a given depth b above a flat soil surface near remote points b and c bmc in fig 7 can also be related to the sapping valleys on mars see e g salese et al 2019 albeit there is a difference in scales the martian depth of the water table z s z 1 is 4 5 km while at squ the shallow groundwater table is only several tens of cm deep the depression in fig 7 is axisymmetric like in section 3 the axis of symmetry coincides with the oz axis of a cylindrical system of coordinates oz ρ introduced similarly as in section 3 above to be consistent with philip we orient oz downward thus the unsaturated soil in 3 d is sandwiched between the w 1 w 0 w 2 plane and the soil surface obtained by the revolution of bmc with respect to the axis oz in fig 7 there are no physical singularities representing drains subsurface emitters or plant roots in this soil layer the contour bmc in fig 7 is obtained in the following manner philip 1989 obnosov and kacimov 2018 a fictitious point sink of intensity q p m3 s is placed at the origin of coordinates such that the water table is beneath this sink at a depth of z 1 0 a fictitious horizontal isobaric plane f 1 f 0 f 2 is placed at the level z z 2 z 2 0 as illustrated in fig 7 at this plane the pressure head p p 0 is specified points b and c in fig 7 of an intermediate isobar between two sandwiching isobaric planes f 1 f 0 f 2 and w 1 w 0 w 2 are at the level of z s which can be either positive or negative fictitious point sources and sinks of intensity q p mirror each other with respect to the planes f 1 f 0 f 2 and w 1 w 0 w 2 only the first fictitious source under the water table placed on the oz axis at a depth of 2 z 1 is shown in fig 7 the array of an infinite number of such sinks sources generates a family of isobars some of which are real two dashed lines p p 2 p p 1 p 2 p 1 p s are sketched in fig 7 and others are fictitious two dotted lines p p 2 p p 1 p s p 2 p 1 are sketched in fig 7 mathematically instead of bmc in fig 7 we can select another soil surface for example any of the two dashed isobars practically we proceed in the following manner one goes to the field with a theta probe and collects the moisture content θs from the topsoil of a real depression having certain geometrical sizes b h if θs and hence p s is almost constant in the depression and on a flat surface away from the depression then the position z 1 z 2 of the origin of coordinates sink s locus and the strength q p of zhukovskii s sinks sources array should be mathematically adjusted in such a manner that the physical field depression becomes close to a mathematical isobar bmc in fig 7 in what follows we illustrate this algorithm routinely see philip 1968 raats 1970 obnosov and kacimov 2018 we introduce the kirchhoff potential ω which is often called the matric flux potential 13 ω ρ z p k u n u d u k u n p ρ z α p ω k s α p i e ω is the kirchhoff potential along w 1 w 0 w 2 obviously the lines of a constant kirchhoff potential are also isobars the values of corresponding pressure heads are found directly from eq 13 and isowetness curves the corresponding water content is found from eq 13 and the soil water retention function we introduce dimensionless quantities z b h z s z 1 z 2 ρ r h p z b h z s z 1 z 2 ρ r h p α 2 ω ω ω q p q p α ω v u v v u p v z k s for which the richards eq 0 is reduced to a linear ade 14 δ ω α p ω z u ρ ω ρ v z α p ω ω z where δ is the laplacian operator in ρ z and u ρ and v z are the radial and vertical velocity components then we adapt philip s 1989 and obnosov and kacimov 2018 solutions to the case of flow in fig 7 and obtain a series 15 ω ω 0 exp 2 z 1 z 2 exp 2 z z 2 exp 2 z z 2 1 exp 2 z 1 z 2 1 q p exp z 8 π exp r r exp r 1 r 1 exp r 2 r 2 exp r 3 r 3 exp r 4 r 4 r ρ 2 z 2 r 1 ρ 2 z 2 z 1 2 r 2 ρ 2 z 2 z 2 2 r 3 ρ 2 z 2 z 1 2 z 2 2 r 4 ρ 2 z 2 z 1 2 z 2 2 where the constant ω0 exp α p z 2 0 ω0 1 is the kirchhoff potential along f 1 f 0 f 2 at points b and c which are located on a physical isobar whose remote wings are above the sink in fig 7 we have ω ω s exp α p z 2 for ω0 ω s 1 the first term on the rhs of eq 15 determines 1 d unsaturated evaporative flow from w 1 w 0 w 2 to f 1 f 0 f 2 in the layer z 1 z z 2 the terms in the square brackets of eq 15 are responsible for sinks and sources and consequently for mirrored imaged with respect to the plains z z 1 and z z 2 we emphasize that philip 1989 and obnosov and kacimov 2018 studied flow for one real source representing a subsurface irrigation emitter while all in fig 7 and eq 15 are fictitious a trick similar to ours was used by zhukovskii 1948 in his famous formula for aerodynamics of ideal fluids he combined mathematical singularities of a characteristic holomorphic function two dipoles and vortex the latter placed inside an airfoil e g an impermeable cylinder zhukovskii also ignored a fictitious flow inside an airfoil in the vicinity of the vortex and only considered an exterior of a mathematical separatrix streamline cylinder we confine real darcian flow not by streamlines for the sake of brevity we have not even introduced the stokes stream function see obnosov and kacimov 2018 but by two isobars bmc and w 1 w 0 w 2 in fig 7 the results of computations based on eq 15 where the series was truncated to 5 terms are plotted by the contourplot routine of mathematica in fig 8 for z 1 z 2 ω0 qp 1 1 0 2 1 as an example in fig 8 we selected an isobar bm as the real depressed isobaric soil surface maintained at the kirchhoff potential ω s 0 26 for this isobar we used the findroot routine of mathematica and evaluated zm 0 389 zb zs 0 177 i e the dimensionless depth of the depression in fig 8 is h 0 566 hydrus 2d simulations are presented in fig 9 we used silt loam with the hydrus triad of the vg soil hydraulic parameters α n ks 2 1 m 1 41 1 08 m day we followed ghezzehei et al 2007 and made gardners s soil having αp 1 3α n i e αp 3 67 1 m in fig 9a a hydrus axial section is shown for the case of the pressure head p m c 0 82 m the flow domain which corresponds to the analytical depression has the hydrus coordinates zm 0 13 m zc 0 23 m and z w2 0 55 m the analytical isobar mc is converted to the hydrus spline curve similarly as in sections 2 and 3 fig 9b and c show the hydrus isobars and streamlines as is evident from fig 9c the ditch funnels up the flux of moisture from the water table that also evaporates at the almost flat part of the soil surface near point c in other words a simple flow tube is realized in fig 9c in fig 9d we assumed a wetter soil surface with p m c 0 63 m the origin of coordinates o is again like in figs 8 and 9a at the locus of the analytic imaginary sink the geometry of the flow domain has changed as compared to fig 9a the corresponding analytical depression mc has now the hydrus coordinates zm 0 1 m zc 0 176 m and z w2 0 55 m the isobars are shown in fig 9d they seem uninteresting like ones in fig 9b fig 9e presents hydrus streamlines which are more interesting indeed the flow topology is different from one in fig 9c specifically like in kacimov and youngs 2005 who studied a seemingly trivial flow domain having a nontrivial two sheet riemann surface in the hodograph plane see also anderson 2013 in fig 9e we see a separatrix ssswsd which divides the unsaturated domain into three subdomains in the first one counted from the left in fig 9e moisture ascends from segment w 0 sw of the water table to the closest deepest section msd of the ditch surface like in fig 9c at the rest of the water table segment sww 2 moisture descends infiltrates from ssc on the soil surface third subdomain pointsw is a stagnation point stagnation points and separatrix streamlines also appeared in raats 1977 for steady flows to an array of the parallel line sinks in unsaturated gardner soils in hydrus the numerical value of the velocity vector at this point x 0 35 m attains a sharp minimum 1 3 10 5 m day the second and most interesting subdomain in fig 9e is bounded by the separatrix streamline and a curve segment sdhpss along this isobar we recall that p m c 0 63 m moisture infiltrates into the soil through hpss and exfiltrates back into the atmosphere through sdhp making a u turn therefore the whole flow domain in fig 9e represents a complex flow tube similar to one in the potential flow shown in fig 62 of pk 77 it is noteworthy that in potential flows governed by the laplace equation this type of separatrix complex flow tubes emerges in situations when the boundary of the flow domain has three or more equipotential components fig 9c and e illustrate that in ade governed unsaturated flow a complex topology can appear in a domain bounded by two lines surfaces of a constant kirchhoff potential a hinge point hp in fig 9e is similar to ones in the classical tothian see e g kirkham 1947 toth 2009 topology of purely saturated flows controlled by gravity darcian resistance and topography of the isobaric ground surfaces postulated by toth along which groundwater infiltrates exfiltrates but without taking into account unsaturated flow in the vadose zone at the point hp the darcian velocity vector is tangential to the soil slope we rephrase if the velocity vector is decoupled into the components normal and tangential to the local soil surface then at hp the normal component is zero along sdhp this normal component is oriented from the soil to the air whereas along hpss the normal component points into the soil to summarize in the analysis of flow in an unsaturated soil represented in fig 9d and e we amended the tothian 2009 physical factors by capillarity of the soil we then got a topological pattern shown upside down at the forefront of the freeze and cherry 1979 and in a normal way in figs 2 25 2 26 of radcliffe and šimůnek 2010 5 a triangular ditch in a confined aquifer ιn this section we return to steady and capillarity free flow in saturated soil we consider 2 d potential flow in a vertical plane fig 10 a and use the notations of section 2 i e the complex physical coordinate is again z x i y a caprock of a confined aquifer is now breached by a triangular isosceles ditch b 0 mc 0 having a bank slope πω 0 ω 1 2 the flow domain gz is now the half plane y 0 with a triangular indent bmc ditch s depth is h l tan πω unlike in section 2 we allow water to accumulate in the ditch up the horizon b 1 c 1 at the level h w the piezometric head at infinity point a in fig 10ab is infinite but as in section 2 we replace this infinity by a surrogate infinity viz an equipotential line avah shown as a dashed semicircle and a segment in fig 10a and b respectively practically in a remote piezometer located distance l a from the ditch axis the total head h a counted from points b and c is measured the overall flow rate into the ditch is q t the domain gw of the complex potential w is sketched in fig 10b the boundary conditions for w are 16 ϕ k y along b b 1 and c c 1 ϕ k h w along b 1 m and m c 1 ψ q t 2 along a b ψ q t 2 along a c to the dimensionless quantities introduced in section 2 we add h w l a h a h w l a h a l q t q t k s l we map the tetragon gz onto a ha a lf plane η 0 of a reference plane ζ ξ iη fig 10c with the correspondence of points m 0 a b 1 c 1 b 1 β c 1 β appendix i presents the details of our solution an alternative method for the analytical solution see the taxonomy of these methods in aravin and numerov 1953 see also bear 1972 involves a conformal mapping of gz onto a mirror image of the pentagon in the hodograph plane fig 10d sketches such a half plane with two semi infinite cuts for the case of an empty ditch fig 11 shows the function qt h curve 1 computed by eq a9 for ha 3 and la 5 similarly to al shukaili et al 2020b and kacimov 1985 we introduce the morel seytoux dimensional seepage flow rate μ q t k s a a h l curve 2 in fig 11 plots the function μ h the minimum of the function is μ 6 085 and h 1 177 this minimum can be interpreted as a solution to the following optimal shape design problem osdp similar to ones solved in kacimov 2005 2006b osdp 1 determine an empty ditch into which a minimal quantity q t of water seeps provided the ditch area a and remote piezometric data h a and l a are fixed curve 2 in fig 11 provides evidence that there is a unique and global solution to osdp1 the minimum is mild similar to ones in kacimov 1985 i e triangular ditches having slopes close to the best one will not deviate much from the best minimal seepage exfiltration rates problems similar to osdp1 are common in civil engineering when a pit e g for a building foundation is excavated and minimum exfiltration is desired or pit s drainage measures are planned for comparisons in fig 12 we present the results of hydrus simulations for the tetrad of parameters h l l a h a 50 cm 100 cm 500 cm 300 cm fig 12a shows the isobars fig 12b illustrates the isotachs in the analytical solution the darcian velocity approaches infinity at points m and c at the same time it attains a minimal value which corresponds to the tip of the cut in the hodograph domain fig 10d hydrus shows the same in fig 12c we plot the distribution of the velocities along the ditch side mc where a minimum v 43 1 cm day is attained at sd 66 7 cm where sd is the arc coordinate counted from point m in fig 10a curves like the one in fig 12c are useful for the assessment of erosional stability of slopes of ditches since heaving and suffusion are determined by exit values and directions of hydraulic gradient vectors i for example pk 62 77 considers the condition i 1 as a criterion of instability according to which fig 12c illustrates that the ditch side mc in fig 12 is absolutely unstable at any sd the hydrus computed morel seytoux factor μ is equal to 6 97 for the trench in fig 12 while the analytical solution gives μ 7 08 we computed other triangular ditches in hydrus 2d by using a discrete variation of the slope angle we evaluated q t from the steady state limit of the cumulative flux into the ditch from a feeding semicircle fig 10a dashed curve then we converted this dimensional q t into the dimensionless μ which fits well the analytical curve 2 in fig 11 collation of solutions for seepage into a triangular ditch and sink generated ditch in section 2 is done in the following manner for the case presented in fig 11 we use eq 2 and evaluate qd πha lnla 3π ln5 5 86 the corresponding isobar is shown as curve 3 in fig 2 using eq 6 we evaluated the area and the morel seytoux factor μ 5 94 we surmise that this is a global optimum in the class of arbitrary ditch shapes next we considered a general case of a partially filled ditch fig 10a in fig 13 curves 1 3 show the graphs of the functions qt hw for three ditch slopes π 6 π 4 and π 3 and the same ha 3 and la 5 as in fig 11 in the regimes of partial filling we can solve osdps similar to osdp1 regional groundwater flow can be easily taken into account similarly to ilyinsky and kacimov 1992b the analytical solution to the steady problem can be readily extended to a transient regime of exfiltration into a gradually filling ditch we assume that the value h a in fig 10a is high enough such that when we make a ditch seepage into it does not reduce much h a and the soil in fig 10a remains saturated an aquifer remains confined let us assume similarly as in hydrus that during the transient seepage phase the porous skeleton and water are incompressible if evaporation from the ditch is ignored then from the principle of mass conservation the following ode follows 17 d a s d t q t h t where t is dimensional time and a s t is the area of the swelling triangle b 1 c 1 m in fig 10a for comparisons see al shukaili et al 2020b where emptying of triangular trenches has been studied obviously the initial condition in eq 17 is a s 0 0 i e seepage filling commences from an empty ditch stage we put a s t h h w t 2 cotan π ω into eq 17 and get the following cauchy problem 18 2 cotan π ω h w t h d h w t d t q t h w t h w 0 0 0 t we used the ndsolve routine of mathematica to solve the nonlinear 1 st order ode 18 numerically with the rhs taken from eq a9 for this purpose we interpolated 51 point values of q t h w see curve 1 in the steady state problem the results of computations are shown in fig 13 in dimensionless quantities to which we added a dimensionless time t t ks l in fig 14 we plotted the functions hw t obtained from the solution of eq 18 for ha 3 and la 5 and the same ditch slopes ω 1 6 1 4 and 1 3 curves 1 3 correspondingly as is evident from these draw up curves the ditches are filled out in finite time intervals tf 0 115 0 175 0 24 respectively at t tf seepage into a ditch continues due to an artesian pressure in an aquifer and exfiltrating water has to be removed e g pumped out if we want to keep points c and b in fig 10a at zero pressure heads i e not ponded that is equivalent to the condition that the horizon bc remains static see in kacimov 1991 a similar flow regime in a horizontal plane the type of curves in fig 14 can be used for the determination of ks similarly to al shukaili et al 2020b and kacimov 2000b that is also useful for deep structure constructors when pumping tests in deep confined aquifers are not feasible if an aquifer is unconfined then for a suddenly emptied ditch or an auger hole kacimov 2000 b tf a transient analytical solution can be compared with a numerical one which involves a new reservoir boundary condition of hydrus šimůnek et al 2018 this new hydrus option allows for the consideration of variable storage of a furrow channel or wellbore e g bristow et al 2020 sasidharan et al 2018 2019 2020 the contours of which are subject to the condition of a constant piezometric head on the submerged part and a seepage face on the empty part of the draining entity hydrus then considers flow into or out of the reservoir through its interface with the subsurface transport domain to depend on the prevailing conditions in the transport domain such as the position of the groundwater table or piezometric heads and external fluxes such as pumping or injection or evaporation or precipitation the furrow reservoir šimůnek et al 2018 can be adapted for our triangular ditch the problem considered in fig 12 was rerun under transient conditions starting with an empty ditch with dimensional sizes of h 50 cm and l 100 cm corresponding to the case illustrated by curve 1 in fig 14 the hydrus draw up curve h w t is shown in fig 15 there is a perfect match between the results in fig 15 and curve 1 in fig 14 from the analytical solution in dimensionless variables we also compared the transient fluxes into the half ditch i e the analytical qt 2 from fig 11 curve 1 and one computed by hydrus for example at t 0 1day the hydrus flux is about 6075 cm2 day whereas the analytical flux q t 2 is 6063 cm2 day 6 comparison of terrestrial and martian evaporating spots as an example let us consider depression 1 qd 0 2 in fig 5 assume r 100 cm h 35 cm and a loamy soil having ks 25 cm day let the water evaporate from the disk πr 2 with a constant intensity e in order to keep the crater empty this value has to be e 0 2 25 π 1 6 cm day which is according to the penman monteith equation and field measurements of evaporation a too high value even in the empty quarters of oman if one wants to reconstruct the desertification of mars or intercept ascending moisture fluxes from the deep water table such as for example in the process of mars colonization then the topography like the one in fig 9 should be taken into account similarly as what we have on earth hummocky terrains or even earth dams kacimov and brown 2015 generate complex 2d and 3d toth type darcian fluxes specifically flat landforms with a homogeneous vadose zone and a shallow water table are easy to examine for water storage and fluxes it suffices to measure the depth of the water table and the pressure head moisture content of the topsoil to infer what is the value and direction of the flux if the vadose zone is heterogeneous the flux magnitudes can attain nontrivial extrema even of a simplest type of a two layered soil kacimov et al 2019 fig 9e illustrates that routine measurements of the boundary condition on soil surfaces with depressions are not sufficient for the determination of the directions and magnitudes of the motion of water governed by the richards equation 7 concluding remarks the mainstream groundwater hydrology focuses on mar managed aquifer recharge a method of replenishing aquifers especially in arid environments we are putting forward the opposite concept of mad managed aquifer discharge of shallow aquifers which have to be intelligently drained to mitigate the damage inflicted by groundwater inundation the analysis in this paper will be useful in planned drainage of water logged built up areas and further studies in dryland ecohydrology camporeale et al 2019 maillart s desert ditches of central asia similarly as ones in humid holland can be viewed as a technique of lowering a shallow water table or piezometric surface the shape of these ditches can be mathematically approximated by isobars made by hydrodynamic sinks comparable with zhukovskii s method of a smart composition of singularities in aerodynamics the darcian flows governed by the laplace equation in saturated media or ade for steady flows in unsaturated media can be viewed as created by intelligently located singularities the resulting isobars model the outlets in seepage to empty curvilinear ditches and depressions seepage to triangular ditches both empty and partially filled is modeled by conformal mappings and the bvp method the transient stage of filling i e the variable storage in ditches is examined by solving a cauchy problem for a nonlinear ode with type curves showing how rapidly the ditch is filled up hydrus 2d simulations well agree with analytical modeling analytical solutions and hydrus reconstruct jointly isobars isohumes isotachs and streamlines the theoretical arsenal of soil physicists and civil engineers working with earth and mars soil and water systems the proper design of ditches pits and other artificial excavations to be operated in shallow water table environments as well as an understanding of subsurface hydrology of natural wadis and depressions can incorporate the findings of this paper declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments this work was supported bysultan qaboos university via the grant rise of water table and its mitigation at squ campus grant dr rg 17 and it was carried out as part of the development program of the scientific and educational mathematical center of the volga federal district agreement no 075 02 2020 1478 helpful comments by two anonymous referees are highly appreciated supplementary materials supplementary material associated with this article can be found in the online version at doi 10 1016 j advwatres 2020 103732 appendix b supplementary materials image application 1 appendix the schwarz christoffel integral maps conformally the reference half plane on gz a1 z ζ i h c 1 1 i h 0 ζ 1 τ 2 ω τ 2 ω d τ 1 i h b ζ 2 1 2 ω 1 ω b 1 2 ω 1 ω where b and b ζ 2 are the complete and incomplete beta functions respectively abramowitz and stegun 1969 formula 6 6 1 the positive constant c 1 2 b 1 2 ω 1 ω in a1 is determined from the condition z 1 1 note that z ζ obeys the symmetry condition z ζ z ζ as it should be from eq a1 along two seepage faces bb 1 and cc 1 we have a2 y ξ h b ξ 2 1 2 ω 1 ω b 1 2 ω 1 ω 1 β ξ 1 where β is the affix of point c 1 we determine β from the relation y β hw that gives a3 b β 2 1 2 ω 1 ω b 1 2 ω 1 ω h h w h next we introduce a holomorphic function a4 w ζ w ζ i q t π arcsin ζ the function a4 in accordance with 16 and properties of the function arcsin satisfies the conditions re w ξ y ξ ξ 1 β β 1 re w ξ h w ξ β β im w ξ 0 ξ 1 1 here y ξ is determined in eq a2 then the function w 0 ζ w ζ 1 ζ 2 obeys the following conditions along the ξ axis a5 re w 0 ξ y ξ 1 ξ 2 ξ 1 β β 1 re w 0 ξ h w 1 ξ 2 ξ β β re w 0 ξ 0 ξ 1 1 eqs a5 comprise a riemann schwartz bvp henrici 1993 pk 62 77 the function w ζ is finite at two transition points ξ 1 continuous at points β and has a logarithmic singularity at infinity hence the function w 0 ζ has integrable singularities at points ξ 1 and vanishes at infinity therefore the unique solution of the problem a5 gives the schwartz operator for the upper half plane henrici 1993 pk 62 77 thus after simple algebra we get a6 w ζ 2 ζ 1 ζ 2 π i h w 0 β d τ 1 τ 2 τ 2 ζ 2 β 1 y τ d τ 1 τ 2 τ 2 ζ 2 where for the sake of definiteness the branch of the radical 1 ζ 2 is fixed positive for ζ ξ 1 1 in the upper half plane this branch and therefore the function a6 satisfy the symmetry condition w ζ w ζ the integrals in a6 are evaluated by the sokhotski plemely formula the first for ζ ξ 0 β and the second for ζ ξ β 1 henrici 1993 we illustrate the computations for the case of an empty ditch hw h we use the piezometric data at point ah fig 10a i e φ a ha first from eq a1 along the ray ca we get a7 x ξ 1 2 1 h 2 1 ξ τ 2 1 ω τ 2 ω d τ b 1 2 ω 1 ω ξ 1 from eq a5 we determine the affix γ of point ah in the reference plane fig 10c a8 l a x γ we use the findroot routine of mathematica to solve eq a8 for γ we put the found root of eq a8 into eq a6 and at ϕ a ϕ γ q t log γ γ 2 1 π re w γ arrive at the equality a9 q t 2 γ γ 2 1 log γ γ 2 1 h w 0 β d τ 1 τ 2 γ 2 τ 2 β 1 y τ d τ 1 τ 2 γ 2 τ 2 π ϕ a log γ γ 2 1 
