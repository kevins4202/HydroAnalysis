index,text
21450,the flow induced vibration fiv responses of two rigidly connected cylinders in various arrangements have been studied numerically using the two dimensional incompressible navier stokes equations coupling with a fourth order runge kutta method four different values of the angle of incidence α and two different values of center to center pitch p between the two cylinders have been selected for the study the fiv response amplitudes lock in regions hydrodynamic force coefficients phase portraits and flow fields have been systematically compared the numerical results demonstrate that for p 4d and increasing α the maximum value of the total mean drag coefficient tentatively increases however the maximum response amplitude shows a decreasing tendency furthermore the maximum amplitude for p 4d occurs when α 0 at v r 7 for p 4d and α 0 the response amplitude remains a certain value during the large v r range which is caused by the participation of the wake induced vibration for p 2d the maximum amplitude happens when α 30 at v r 12 for p 2d when α 90 owing to the proximity induced galloping during the large v r range the response amplitude increases slightly with increased v r displaying no desynchronization characteristics keywords flow induced vibration rigidly connected cylinders galloping hydrodynamic force coefficient flow pattern 1 introduction when vortices are shed in fluid flowing past a circular cylinder the cylinder may be subjected to time dependent drag and lift forces over a certain reynolds re number range if the cylinder is flexibly mounted these hydrodynamic forces may cause the cylinder to vibrate the lift and drag forces may induce the vibrations in cross flow cf and in line il directions respectively which collectively are referred as vortex induced vibrations viv blevins 2001 viv of cylindrical structures is of practical interest to many branches of ocean engineering for example it influences the dynamic characteristics of mooring cables petroleum production risers and pipelines gao et al 2019a since viv may cause significant fatigue damage deterioration and even collapse to the structure viv prediction of the structure is one of the key issues of the structure s design the viv problems of a single cylinder have been studied by many researchers in past decades feng 1968 bearman 1984 khalak and williamson 1999 facchinetti et al 2004 srinil and zanganeh 2012 gao et al 2018 2019b wang et al 2019 zhu et al 2019a 2020 based on these studies some important mechanisms of the viv problem have been unraveled for example when the vortex shedding frequency f v is close to the natural frequency f n of the structure the lock in synchronization phenomenon occurs there exist many vortex shedding flow patterns in the wake region such as a 2s mode representing two single vortices formed per cycle a 2p mode meaning two pairs of vortices formed per cycle and a 2t mode comprised of two triplet of vortices in each cycle with the rapid development of the offshore oil and gas industry a group of multiple cylinders in close proximity are often used in the ocean engineering when a flow with a certain re number past multiple cylinders arranged in proximity the flow induced vibration fiv may occur fiv of multiple cylinders can be classified into two categories viz viv and wake induced vibration wiv zhao et al 2016a the primary difference between viv and wiv is the excitation mechanism of the structural vibration the former vibration is excited by the vortex shedding and it occurs in both upstream and downstream cylinders however the latter vibration is excited by the wake of the upstream cylinder hence it can only occur in the downstream cylinder due to the complex interference of the wake between the adjacent cylinders compared with a single cylinder the flow characteristics behind the multiple cylinders are much more complicated among the configurations of the multiple cylinders arranged in proximity the simplest one is the two circular cylinders of equal diameter sumner et al 2000 as shown in fig 1 the geometry of the two cylinders each of equal diameter of d subjected to a steady flow of v is set by the center to center pitch p between the two cylinders and the angle of incidence α with respect to the line through the two cylinder centers alternatively the geometry can also be determined by the longitudinal separation l and the transverse separation t according to the boundary conditions of the two adjacent cylinders the related studies in last decade can be divided into a the studies on the two stationary cylinders which are directed mainly toward the flow characteristics including the hydrodynamic forces and flow wake patterns hesam and navid 2011 huang and sworn 2013 tong et al 2015 vu et al 2016 hsu et al 2017 jiao and wu 2018 schewe and jacobs 2019 and b the studies on the fiv problems of the two oscillating cylinders as shown in table 1 based on table 1 several important observations can be easily found as follows a the number of numerical studies is larger than that of the experimental ones owing to the cost of the numerical method being lower than that of the physical experiment further the numerical studies are usually conducted in two dimensional low re number flow re vd ν ν is the kinematic viscosity of the flow comparatively the re number studied in the experimental methods are much higher that is to say the numerical studies corresponding with the low re number flow are focused in revealing some important mechanisms of the fiv response characteristics however the experimental studies associated with the high re number flow are more realistic with respect to the practical ocean engineering b based on the general classification method the configuration of the two adjacent cylinders has three different arrangements i e tandem side by side and staggered arrangements as shown in fig 1 for the tandem arrangement the values of α and t are both zero for the side by side arrangement the value of α is 90 and the value of l is zero whereas for the staggered arrangement both l and t have non zero values and the value of α satisfies the condition that 0 α 90 in fact the tandem and side by side arrangements can be treated as two special ones among the staggered arrangements c according to the direction of the structural vibration the studies can be categorized into two groups one group deals with the vibration only in the cf direction where the structure has only one degree of freedom dof and the other group corresponds to the vibration in both cf and il directions simultaneously where the structure has two dofs d for two identical cylinders in a tandem arrangement in a flow there exists a critical value for the center to center pitch p when the pitch is larger than the critical value the vortex shedding are occurred from both upstream and downstream cylinders comparatively when the pitch is less than the critical value the vortex shedding is found to only occur from the downstream cylinder in the offshore and gas engineering two pipelines or riser pipes in close proximity are often strapped together owing to the economical and operational considerations the two close by cylinders can be treated as two rigidly connected cylinders they vibrate simultaneously and have the same response displacements as shown in table 1 compared with a large number of publications dedicated to two freely oscillating cylinders there are much fewer studies on two rigidly connected cylinders furthermore among these limited studies the two rigidly coupled cylinders with tandem and side by side arrangements only vibrated in the cf direction are considered zhao 2013 zhao et al 2016b from these studies on two rigidly connected cylinders it can be found that the center to center pitch has significant effect on the flow induced vibration response furthermore for the tandem arrangement the maximum response amplitude of the two rigidly coupled cylinders is always larger than that of a single cylinder however for the case of two rigidly connected cylinders arranged in different staggered configurations the vibration characteristics of the cylinders and the flow characteristics in the wake region behind the cylinders are not known moreover if the rigidly connected cylinders are allowed to vibrate in both cf and il directions how does the il vibration influence the cf vibration hence to pursue the answers for the aforesaid issues we conducted studies which are based on the research of zhao 2013 and zhao et al 2016b the following part of the paper is divided into four sections in section 2 a brief description of the problem is given in section 3 the governing equations and the numerical methods are presented in section 4 the response amplitudes the hydrodynamic force coefficients and the phase portraits as well as the flow fields behind the two cylinders for two different values of p and four different values of α have been systematically studied finally in section 5 conclusions drawn from the present study are given 2 problem description as shown in fig 2 two circular cylinders of diameter d 0 1 m are symmetrically arranged with respect to the origin o of the cartesian coordinates fig 2 a shows the definition of the flow configuration and geometrical parameters p and α fig 2 b represents the detailed information of the rectangular computational domain and its boundary conditions where x and y represent the il and cf directions respectively the computational domain is a rectangular region with a size of 80d il direction 60d cf direction in the il direction the distances between the inlet and outlet boundaries to the center of the two rigidly connected cylinders are 30d and 50d respectively in the cf direction the computational domain ranges from 30d to 30d the steady uniform velocity is used at the inlet boundary as u v and v 0 where u and v are the velocity components in x and y directions respectively at the outlet the zero gradient condition for the flow velocities along the two vibration directions u x 0 and v x 0 and zero condition for reference pressure p 0 have been applied for assuring a fully developed flow the upper and lower boundary conditions have been imposed by employing a free slip symmetry plane boundary condition with u y 0 and v 0 further the no slip wall condition has been applied on the cylinder surface as shown in the dashed circle in fig 2 b the two rigidly connected cylinders vibrate as a single unit in both cf and il directions simultaneously the main parameters invoked in our study have been listed in table 2 we employ the re number mass ratio and damping ratio values that are invoked in zhao s study zhao 2013 the re number has been fixed at 150 implying that the flow velocity v remains constant the reduced velocity v r has been changed via the natural frequency f n of the oscillating system where v r was formulated as v r v f n d this method of changing v r has also been used in several previous numerical studies bourguet and jacono 2014 gao et al 2018 carmo and meneghini have found that the flow wake behind the cylinder has negligible three dimensional turbulent characteristics when re is less than 190 carmo and meneghini 2006 therefore the present numerical model for re 150 can be studied using two dimensional numerical simulations when compared to the three dimensional simulation the computational cost of the two dimensional study can be significantly reduced furthermore the outcomes of the two dimensional study can provide a useful guidance for the forthcoming three dimensional study based on the reduced mass m red of 2 in zhao s study zhao 2013 the mass ratio m in our study has been selected as 2 6 notably m red in zhao s study is defined as m red m ρd 2 whereas m in our study is formulated as m m πρd 2 4 here ρ is the fluid density and m is the total mass of the vibration system per unit length including the structural mass m s and the added fluid mass m a it is given by m a c a m d in which m d is the displaced mass of fluid due to the cylinder per unit length and c a is the added mass coefficient the damping ratio ζ has been set as zero in both zhao s and our studies for obtaining the maximum vibration amplitude from the previous literature review zhao et al 2016a we note that for the two rigidly connected cylinders with identical diameters there mainly exists two groups based on the effect of the center to center pitch p on the fiv characteristics these cases are viz a when p is larger than a critical value the vortex shedding can happen from both the upstream and downstream cylinders thus the fiv is dominated by the viv b when p is less than a critical value the vortex shedding can only be occurred from the downstream cylinder and leads to that the fiv is dominated by the viv and wiv simultaneously this critical value is about 3 0d 3 5d depending on the re number to study the vibration responses of the two rigidly connected cylinders with different arrangements we have taken two typical values p 4d within the first group and p 2d within the second group that are selected for the numerical study for each pitch p four different angles of incidence α 0 30 60 and 90 have been considered for p 4d the range of the reduced velocity changes from 1 to 15 however for p 2d the range varies from 1 to 30 further the vibration responses of the single cylinder have also been studied for the purpose of the comparison analysis 3 numerical method the low re number re 150 flow past the two rigidly connected cylinders is treated as a two dimensional 2d incompressible flow the governing equations for mass and momentum conservation are written as follows zhu et al 2019b 1 u i x i 0 2 u i t u j u i x j 1 ρ p x i ν 2 u i x j x j where x i and x j are the cartesian coordinates in the i and j directions respectively the variables u i and u j represent the instantaneous components of the velocities in the i and j directions respectively whereas t is the time and p is the pressure the two rigidly coupled cylinders vibrate as a single unit and have the same vibration characteristics in both cf and il directions therefore the vibration system can be visualized as a two degree of freedom 2dof mass spring damper system the 2dof dynamic motions in the cf and il directions have been described bao et al 2012 gao et al 2020a 2020b as 3 d 2 x t d t 2 2 ζ ω 0 d x t d t ω 0 2 x t f d t m d 2 y t d t 2 2 ζ ω 0 d y t d t ω 0 2 y t f l t m where x t dx t dt and d 2 x t dt 2 denote the vibration displacement velocity and acceleration of the two coupled connected cylinders in the il direction respectively whereas y t dy t dt and d 2 y t dt 2 represent the corresponding quantities in the cf direction respectively in eq 3 ω 0 is the natural circular frequency and expressed as ω 0 2πf n since v r is determined based on the diameter of the single cylinder f d t and f l t are selected in our study as the averaged values of the hydrodynamic forces acting on the two cylinders expressed as 4 f d t f d 1 t f d 2 t 2 f l t f l 1 t f l 2 t 2 in eq 4 f d1 t and f l1 t represent the instantaneous drag force and lift force acting on the upstream cylinder respectively whereas f d2 t and f l2 t denote the corresponding quantities exerted on the downstream cylinder respectively boundary conditions on cylinder surfaces are imposed by 5 u t d x t d t v t d y t d t the initial conditions are that the vibration displacements and velocities in both x and y directions are zero expressed as 6 x 0 d x 0 d t 0 y 0 d y 0 d t 0 the two rigidly connected cylinders can be regarded as a single unit executing rigid motion in the x y plane therefore based on the nonlinear vibration of the single degree of freedom partial system the dynamic equation can be solved independently here the second part of eq 3 which describes the vibration in the cf direction is selected as an example and it can be rewritten as gao et al 2020a 2020b 7 d y t d t v t d v t d t f l t m ω 0 2 y t 2 ζ ω 0 v t the classical fourth order runge kutta method has been employed to discretize eq 7 and the detailed information on this method can be found in our previous studies gao et al 2018 2020a 2020b the equations of motion in eq 3 with the initial condition of eq 6 have been solved simultaneously with the governing equations viz eqs 1 and 2 to compute the velocity u v and displacement x y in the il and cf directions then the cylinders are placed at the new position to regenerate the grid the dynamic mesh method has been used to perform mesh deformation based on the motion of the boundary and to perform any needed adaption of the mesh to update the grid successfully two accompanying moving zones around the two cylinders which have the same translational motions with the cylinders are defined to update the grid accordingly the mesh in the accompanying moving zones are unchanged while the mesh in the outer region changes in every time step the finite volume method has been employed to discretize the mass and momentum conservation equations the simple method is used for coupling the pressure and velocity the second order and bounded central differencing schemes have been applied to discretize the pressure and momentum respectively a second order implicit method in time domain has been applied the motion of the cylinder is enforced using the user defined functions all the above governing equations have been solved using the commercial computational fluid dynamics software package fluent 18 0 fig 3 shows the sketches of the complete and localized meshes of the computational domain a previous study has found that the effect of domain width on the structural response can be negligible when the featured ratio of the domain width and the longitudinal size is larger than 10 zhao et al 2012 as shown in fig 3 the longitudinal size is the projected length in the cf direction of the distance between the top side of the downstream cylinder and the bottom side of the upstream cylinder in our study among all the simulation cases the longitudinal size has the maximum value of 5d for p 4d at α 90 implying that the featured ratio has the minimum value of 12 it can be seen that all the featured ratios are larger than 10 and satisfy the neglecting condition of the boundary effects the total computational fluid domain is divided into two zones viz the deformation and the accompanying moving zones as shown in fig 3 a and b the blue deformation zones outside the two cylinders are meshed using triangular elements which can be adjusted and updated based on the translation of the structure the red and purple accompanying moving zones around the two cylinders as shown in fig 3 c and d are meshed using structural quadrilateral elements which varies synchronously with the motions of the cylinders 4 results and discussion 4 1 mesh independency study and numerical method validation the mesh independency study and the numerical method validation should be conducted before proceeding to the related issues under investigation for verifying the accuracy and usefulness of our numerical method we have employed two sets of meshes for p 4d and 2d each stated differently the number of the total elements for one pitch remains constant when v r and α are changed here the selections are α 30 for v r 6 0 and α 30 for v r 12 0 for conducting the mesh independency study for p 4d and 2d respectively tables 3 and 4 list the compared results of the vibration responses a y d and f s f n employing three different meshes and f s is the dominant frequency of the structural vibration in the cf direction which can be obtained by applying a fast fourier transform fft to a stable time history of the vibration displacement in the cf direction the dimensionless vibration displacements a y d are given as 8 a y d y max y min 2 d where y max and y min are the maximum and minimum vibration displacements in the cf direction during a selected stable time respectively fig 4 shows the time histories of the viv displacements in the cf direction for three different meshes we note that all the vibration amplitudes in the cf direction for different meshes become highly steady with the increased time we note from tables 3 and 4 that for the mesh resolution refined from m1 to m2 by increasing the number of the elements the corresponding variations of a y d and f s f n for the two selected cases have been increased with non negligible magnitudes however for a further refinement from m2 to m3 the variations of a y d and f s f n can be negligible the numerical results using m3 grid are very close to the results using m2 grid the simulations have been conducted with the intel core i5 8400 platform transient simulations have typically consumed about 9 h for the m2 grid and 12 h for the m3 grid therefore the m2 grid system provided a good compromise between precision and required time and it is sufficient for the present study subsequent to the mesh independency study the reliability of the present numerical method will further be validated in our early studies gao et al 2018 2020a 2020b we have successfully proved that our numerical method employed in the current work can predict both the viv responses of a single cylinder in an infinite flow and near a plane wall highly satisfactory however the predictability of this method over the vibration responses of the two rigidly connected cylinders reliably needs a further validation here the cases of p 4d in tandem and side by side arrangements are compared with zhao s numerical results zhao 2013 to note the two rigidly connected cylinders are restricted to vibrate only in the cf direction during this validation study in accordance with the same constraint condition of the cylinders in study by zhao fig 5 provides the compared results of the response amplitudes in the cf direction for both tandem and side by side arrangements as shown in fig 5 b for the side by side arrangement the response amplitude at the low reduced velocity range 1 v r 3 is almost negligible as v r increases from 3 to 3 5 the response amplitude shows a tendency for sudden jump and arrives at the maximum value when v r 4 5 obviously displaying lock in characteristics when v r is further increased the response amplitude follows a downward trend when v r increases from 7 to 7 5 the response jumps down quickly concomitantly the reduced velocity enters into the desynchronization region for the tandem arrangement as v r increases the amplitude shows an increasing trend initially followed by a decreasing trend that is similar to the side by side arrangement however for a large reduced velocity v r 7 5 there exists an obvious difference between the two different arrangements as follows for a side by side arrangement the response amplitude is negligible a y d 0 1 apparently indicating the desynchronization characteristics however for a tandem arrangement as shown in fig 5 a owing to the participation of the wiv the vibration response amplitude still remains at a certain value a y d 0 3 the comparison of the results demonstrate that for the two different arrangements including the side by side and the tandem ones our numerical results agree very well with that of zhao 2013 combined with our previous validations gao et al 2018 2020a 2020b the numerical method employed in this work can precisely predict the vibration responses of a single cylinder and two rigidly connected cylinders vibrating only in the cf direction since there is no available data for the vibration responses of the two rigidly coupled cylinders simultaneously vibrating in both the cf and il directions no additional validation has been performed 4 2 cylinder response amplitudes fig 6 shows the cylinder response amplitudes in both cf and il directions for p 4d and 2d with different arrangements based on these amplitudes the lock in characteristics of the vibrations have been further studied here the lock in region is determined as given in the following the vibration amplitudes within the lock in region should be larger than the half of the maximum amplitude during the entire v r range this determination method of the lock in region has also been employed in certain previous studies facchinetti et al 2004 gao et al 2020a applying this method the lock in regions and widths can be easily obtained for the two rigidly connected cylinders with different arrangements as shown in table 5 we note from fig 6 a that for p 4d when α 0 as v r increases the response amplitude in the cf direction jumps up quickly and reaches the maximum value of 0 78d at v r 7 0 which is larger than the maximum amplitude of 0 61d at v r 5 0 for the single cylinder as v r is further increased the difference between the response amplitude of the two rigidly connected cylinders and that of the single cylinder becomes larger when v r exceeds 8 0 the response amplitude of the two rigidly cylinders still remains at a certain value a y 0 2d having no desynchronization characteristics however the response amplitude of the single cylinder is almost zero apparently displaying desynchronization characteristics particularly the vibration characteristics for the specific case p 4d α 0 v r 8 are caused by the participation of the wiv which is induced by the wake interference between the two cylinders besides the vibration is simultaneously dominated by the wiv and the viv as shown in table 5 the lock in region for p 4d when α 0 is 5 v r 10 and it is wider than 4 v r 7 for the single cylinder for p 4d when α is increased to 30 the response amplitude in the cf direction reaches the maximum value of 0 73d at v r 6 which is a little smaller than that for α 0 during the large v r range v r 7 0 compared with α 0 the response amplitude for α 30 is significantly decreased for e g at v r 15 the response amplitude for α 30 is 0 09d which is negligible for the value of 0 26d corresponding to α 0 this can be explained as follows for α 30 the wake interference between the two cylinders becomes much weaker further resulting in the vibration being dominated by the viv as α is further increased to 60 and 90 the wake interference is almost negligible causing the two rigidly connected cylinders to have almost the same response amplitudes with the single cylinder the lock in regions for p 4d when α 30 60 and 90 are all distributed in the range of 4 v r 7 also having the same region with the single cylinder as α increases the maximum amplitude in the cf direction shows a decreasing trend for p 4d comparing fig 6 b and a obviously shows that the vibration characteristics of the response amplitude of the two rigidly connected cylinders in the cf direction for p 2d are much complex than those for p 4d for p 2d when α 0 the response amplitude reaches its maximum value of 0 25d at v r 5 which is negligible for the corresponding value for the single cylinder when v r exceeds 8 the response amplitude is very small and changes little with increased v r the lock in region for p 2d when α 0 is 5 v r 6 having the narrowest lock in region among all the simulated arrangements the maximum response amplitudes in the cf direction are 0 79d and 0 63d respectively for p 2d when α is increased to 30 and 60 as shown in table 5 for p 2d the lock in regions for α 30 and 60 are 6 v r 19 and 4 v r 13 respectively which are both much larger than that for the single cylinder when α is further increased to 90 the response amplitude has the maximum value of 0 60d at v r 6 and the lock in region is 4 v r 9 during the two v r ranges including v r 23 when α 30 and v r 14 when α 60 the response amplitudes both show slightly decreasing tendency with increased v r obviously displaying desynchronization characteristics nevertheless the response amplitude for the side by side arrangement α 90 tends to slightly increase when v r 11 accordingly this slight increase for α 90 is effectuated by the proximity induced galloping of the two cylinders the detailed information behind this phenomenon will be further studied in combination with the characteristics of the flow fields in section 4 4 as shown in fig 6 c for p 4d and α 0 30 and 60 the maximum vibration amplitudes in the il direction are 0 025d 0 11d and 0 039d respectively and all of which exceeds the maximum amplitude of 0 022d for the single cylinder for p 4d and α 90 the response amplitude of the two rigidly coupled cylinders in the il direction displays the same vibration characteristics with that for the single cylinder from fig 6 d for p 2d and α 0 the response amplitude in the il direction can be negligible however as α is increased to 30 60 and 90 the amplitudes in the il direction reach the maximum values of 0 42d 0 16d and 0 26d respectively all of which are much larger than that for the single cylinder 4 3 hydrodynamic force coefficients and phase portraits the hydrodynamic force coefficients contain lift and drag force coefficients based on the instantaneous drag and lift forces expressed in eq 4 the two instantaneous hydrodynamic force coefficients for each cylinder and the total instantaneous coefficients of the total force sum of fluid forces acting on both cylinders can be easily obtained by the normalization of the corresponding instantaneous hydrodynamic forces as 9 c d up t f d 1 t 1 2 ρ d v 2 c d down t f d 2 t 1 2 ρ d v 2 c l up t f l 1 t 1 2 ρ d v 2 c l down t f l 2 t 1 2 ρ d v 2 c d total t f d 1 t f d 2 t 1 2 ρ d v 2 c l total t f l 1 t f l 2 t 1 2 ρ d v 2 in eq 9 the subscripts up and down stand for the upstream and downstream cylinders respectively further the subscript total denotes both the cylinders subsequent to finding the instantaneous lift and drag force coefficients and taking n sampling points during the stable period the mean drag force coefficient and the root mean squared rms value of the lift force coefficient for the upstream cylinder the downstream cylinder and both the cylinders can be computed as 10 c d mean up 1 n i 1 i n c d up i c l mean up 1 n i 1 i n c l up i c l rms up 1 n i 1 i n c l up i c l mean up 2 c d mean down 1 n i 1 i n c d down i c l mean down 1 n i 1 i n c l down i c l rms down 1 n i 1 i n c l down i c l mean down 2 c d mean total 1 n i 1 i n c d total i c l mean total 1 n i 1 i n c l total i c l rms total 1 n i 1 i n c l total i c l mean total 2 fig 7 shows the variation of the mean drag coefficient for each cylinder and the mean drag coefficient based on the total drag force for different p and α as shown in fig 7 a and c for p 4d and α 0 there exist huge disparities between the mean drag coefficients of the upstream and downstream cylinders with that of the single cylinder further in comparison to the upstream cylinder the difference between the downstream cylinder and the single cylinder is much larger which is effectuated by the wake interference on the downstream cylinder being much more prominent than the effect on the upstream cylinder when α 30 the differences between the mean drag coefficients of the two cylinders with that of the single cylinder become negligible as α is further increased to 60 and 90 the mean drag coefficients of both the cylinders have proximate values with that of the single cylinder fig 7 e indicates that when α 60 and 90 the total mean drag coefficient is almost twice that of the single cylinder furthermore the total mean drag coefficient has an upward tendency as α increases fig 7 b and d indicate that for p 2d when α 0 the mean drag coefficients of the upstream and downstream cylinders are both much smaller than that of the single cylinder the mean drag coefficients of the downstream cylinder at all other reduced velocities have negative values for p 2d and α 0 except for the maximum value at v r 5 which can be explained as follows the shear layer separated from the downstream cylinder cannot roll into a free vortex in the gap region for α 0 at small gap p 2d caused by the small response amplitude in the cf direction as shown in fig 6 b instead the shear layer reattaches to the downstream cylinder this reattachment causes the downstream cylinder to be completely inside the wake formed by the upstream cylinder further leading to a negative drag force for p 2d as α is increased from 0 to 90 upward trend is noted for the maximum values of the mean drag coefficients for the upstream and downstream cylinders as well as the total cylinders fig 8 presents the rms lift coefficient of each cylinder and the rms lift coefficient based on the total lift force for different p and α according to fig 8 a and c for p 4d and for the four arrangements α 0 30 60 and 90 the maximum value of the rms lift coefficient of the upstream cylinder is always smaller than that of the single cylinder however the maximum value of the rms lift coefficient of the downstream cylinder is usually larger than that of the single cylinder stated differently the maximum value of the rms lift coefficient for the downstream cylinder is usually larger than that of the upstream cylinder when p 2d for the four arrangements the maximum values of the rms lift coefficients of the upstream and downstream cylinders are both obviously smaller than that of the single cylinder we note from comparing the total lift coefficients in fig 8 and the corresponding cf displacements in fig 6 that the reduced velocity v r which has the maximum lift coefficient is usually smaller than the reduced velocity for p 4d and 2d further it has the maximum vibration amplitude in the cf direction it is induced by the phase between the lift force and the response displacement figs 9 and 10 present the phase portraits of the total lift force coefficient and the vibration displacement in the cf direction for p 4d and 2d respectively for p 4d and 2d as v r increases the phase portraits both rotate at an anti clockwise direction for p 4d when v r 4 the phase portrait is single valued which implies that there exists only one value of c l total for each y d however as v r increases the phase portrait becomes double valued showing that there exist two values of c l total for each y d the single valued phase portrait implies that the value of c l total is only determined by the value of y d and have relationship with the move direction of the cylinders however the double values phase portrait implies that the value of c l total is determined by the value of y d and the move direction of the cylinders simultaneously as v r is further increased the phase portrait recurs showing the single valued characteristics for p 4d and 2d whether the fiv response is dominated by viv or wiv can be conveniently determined by the response characteristics of the phase portrait as shown in fig 9 all the phase portraits display periodic characteristics or stated differently the phase portraits can be repeatable as time increases it indicates that the fiv responses are all dominated by viv for p 4d however the phase portraits for p 2d are more sophisticated than those for p 4d for the sake of convenience here only the case of α 90 for p 2d is selected for the study when v r 4 the phase portrait shows periodic characteristics indicating that the fiv response is dominated by viv when v r 10 the phase portrait is very chaotic and unrepeatable indicating that the fiv response is dominated by wiv 4 4 flow fields to get a clear picture of the flow regimes varied with v r and α the instantaneous vorticity contours of different v r and α when the two rigidly connected cylinders obtain the maximum vibration amplitude in the cf direction are shown in fig 11 according to fig 11 a for p 4d and increasing α the width of the vortex street behind the two cylinders has an increasing tendency however the wake interference between the two cylinders tends to decrease as α increases to 90 the wake interference remains negligible comparison of fig 11 a and b indicates that the wake interference between the two cylinders for p 2d is much more complicated than that of p 4d fig 12 15 present the detailed information on the wake dynamic characteristics in the flow fields behind the two rigidly connected cylinders owing to the large number of the simulation cases only certain typical cases have been selected for the numerical study in this section for investigating the intrinsic mechanisms of the wake dynamics the time series and amplitude spectra of the normalized values of the vibration displacements and hydrodynamic forces in the cf and il directions as well as five instantaneous vorticity contours at five typical vibration points locations a b c d and e have been analyzed concurrently the non dimensional vorticity given in the figures has been calculated with ω v x u y v d for p 4d and α 0 two reduced velocities v r 7 and 10 have been selected for studying the response characteristics during the lock in and wake induced vibration regions respectively for v r 7 the response amplitude in the cf direction has the maximum value of 0 78d however the vibration displacements in both cf and il directions vary very periodically with single dominant frequencies of 0 133 and 0 265 respectively the normalized dominant frequency in the il direction is twice that in the cf direction further the total lift force is always in phase with the vibration displacement in the cf direction while the total drag force is always out of phase with the vibration displacement in the il direction here the vortex separated from the top side of the upstream cylinder labeled a has been selected as the typical one for the detailed analysis of the vortex evolution as shown in fig 12 a the vortex a has been cut into two vortices labeled a1 and a2 at location b subsequent to the impingement on the downstream cylinder the vortex a2 with weak strength will be dissipated quickly in the wake region however the vortex a1 will merge with the vortex b separated from the downstream cylinder the vortices a1 and b are comparable in strength generally the vortex evolution for v r 7 includes several complicated actions such as the impingement on the structural surface the vortex dissipating action and the vortex coalescing action thus the exact flow pattern of the vortex shedding behind the two rigidly connected cylinders cannot be easily determined according to fig 12 b both the vibration displacements in the cf and il directions for v r 10 vary steadily showing the same characteristics with those for v r 7 however for v r 10 the vibration displacement in the cf direction is completely out of phase with the total lift force which displays completely opposite characteristics with that for v r 7 comparing fig 12 b and a the lift force magnitudes of the upstream and downstream cylinders are comparable for v r 7 on the contrary the lift force magnitude of the upstream cylinder is much larger than that of the downstream cylinder for v r 10 taking the evolution of the vortex a separated from the top side of the upstream cylinder as an example the vortex a is split into two vortices labeled a1 and a2 at location b subsequent to the impingement on the downstream cylinder the vortex a2 with weak strength will vanish quickly in the wake region comparatively the vortex a1 with high strength will shed freely in the wake region we observe from the instantaneous vorticity contours at locations b and c that the shear layer b generated from the downstream cylinder cannot roll up into a free vortex independently instead it can only be merged into the vortex a1 comparison of the flow field at the left of the blacked dashed line at location a with the field at location e obviously indicates that the vortex shedding flow pattern for v r 10 displays a symmetric 2s mode for p 4d and α 30 the response amplitude in the cf direction at v r 6 reaches the maximum value of 0 73d the vibration displacement in the cf direction varies periodically with only one peak frequency however the vibration displacement in the il direction shows quasi periodic characteristics with two peak frequencies the lift and drag forces of the upstream cylinder have proximate values to the corresponding quantities of the downstream cylinder from the five instantaneous vorticity contours for v r 6 shown in fig 13 a the clockwise vortex a shed from the inner surface of the upstream cylinder is impinged on the surface of the downstream cylinder and subsequently cut into two vortices labeled a1 and a2 the vortex a1 will merge with the vortex b which is shed from the outer surface of the downstream cylinder however the vortex a2 will dissipate quickly in the free wake region the counter clockwise vortex c separated from the outer surface of the upstream cylinder merges with the vortex d generated from the inner surface of the downstream cylinder displaying the similar vortex evolution characteristics with the clockwise vortices a and b furthermore the clockwise and counter clockwise vortices in the free wake region have very comparable intensities owing to the complex characteristics of the vortex evolution the vortex shedding flow pattern for p 4d α 30 and v r 6 has no apparent 2s or 2p modes for p 4d and α 90 the response amplitude in the cf direction at v r 5 has the maximum value of 0 59d as shown in fig 13 b the flow wake behind the upstream cylinder displays the in phase synchronized pattern along with that behind the downstream cylinder the vortices distributed in the free wake region are apparently arrayed in four rows there is no coalescing action for the vortices with the same rotational direction owing to the large vibration amplitude in the cf direction further the vortex shedding flow pattern can be easily found to have a 2p mode for p 2d and α 0 the response amplitude in the cf direction at v r 5 reaches the maximum value of 0 25d the vibration displacement in the cf direction has only one peak frequency while the one in the il direction has two peak frequencies however both the total lift and drag forces have only one peak frequency owing to the small vibration amplitude in the cf direction the two shear layers separated from the top and bottom surfaces of the upstream cylinder are both stretched and continuously reattached to the surface of the downstream cylinder the vortex shedding flow pattern behind the two rigidly connected cylinders displays a symmetric 2s mode within each vibration period for p 2d and α 30 the response amplitude in the cf direction at v r 12 has the maximum value of 0 79d the vibration displacements in the cf and il directions both vary periodically with only one peak frequency on the contrary there exist many frequency components for the total lift and drag forces implying that the vortex interactions are sophisticated as shown in fig 14 b separated by the counter clockwise vortex labeled d the clockwise vortex labeled a generated from the inner surface of the upstream cylinder and the clockwise vortex labeled b generated from the outer surface of the downstream cylinder cannot merge however the counter clockwise vortex labeled c generated from the outer surface of the upstream cylinder and the counter clockwise vortex labeled d can be merged in the wake region these different characteristics of the clockwise and counter clockwise vortices further effectuate the vortex shedding flow pattern to be an asymmetric 2s mode for p 2d and α 90 two typical reduced velocities v r 6 and 12 have been selected for studying the response characteristics within the lock in and proximity induced galloping regions respectively when v r 6 the response amplitude in the cf direction reaches the maximum value of 0 6d the vibration displacement in both the cf direction and the total lift force vary periodically with only one peak frequency however both the vibration displacements in the il direction and the total drag force have several peak frequencies all of which are distributed in a narrow band the magnitudes of the lift and drag forces exerted on the upstream cylinder are comparable with those of the corresponding hydrodynamic forces acting on the downstream cylinder respectively as shown in fig 15 b when v r 12 the vibration displacements and the hydrodynamic forces in both cf and il directions have several peak frequencies displaying chaotic characteristics for this specific case p 2d α 90 and v r 12 the mean lift forces of the upstream and downstream cylinders have negative and positive values respectively which is affected by the asymmetry in the flow owing to the proximity effect of the two cylinders this vibration induced by the asymmetric lift force is termed as the proximity induced galloping vibration for p 2d and α 90 the vortex shedding behind both the cylinders for v r 6 and 12 have no regular flow patterns owing to the chaotic response characteristics of the cylinder vibration 5 conclusions the fiv responses of the two rigidly connected cylinders in different arrangements have been studied numerically with the mass ratio and reynolds number fixed at the constant values of 2 6 and 150 respectively the damping ratio is set to zero to encourage high amplitude oscillations two typical center to center distances between the two cylinders p 4d and 2d have been selected for the numerical study the angle of incidence α varies in the range of 0 90 with an increment of 30 the two dimensional incompressible flow model coupled with a fourth order runge kutta method have been employed to solve the governing equations the fiv responses including the response amplitude lock in region hydrodynamic force coefficient and flow fields have been determined and analyzed systematically based on these results the following conclusions can be drawn 1 the fiv response is a combination of viv and wiv for p 4d and α 0 owing to the strong wake interference between the two cylinders as α is increased to 30 the wake interference becomes much weaker further resulting in the fiv response being dominated by viv when α is further increased to 60 and 90 the wake interference becomes almost negligible hence the fiv response has almost the same response with the single cylinder for p 4d the maximum amplitude occurs at v r 7 when α 0 compared with p 4d the vibration characteristics for p 2d are much more complicated especially the fiv response for p 2d when α 90 has no desynchronization characteristics during the large v r range which is caused by the participation of the proximity induced vibration 2 the mean drag coefficients of the upstream and downstream cylinders are both obviously different from that of the single cylinder for p 4d and α 0 and 30 whereas for α 60 and 90 the mean drag coefficients of the two cylinders are proximate to that of the single cylinder the maximum value of the rms lift coefficient of the upstream cylinder is usually larger than that of the downstream cylinder for all four simulated arrangements viz for α 0 30 60 and 90 the maximum values of the mean drag coefficients for each individual cylinder and total cylinders all display increasing tendencies for p 2d when α is increased from 0 to 90 for the four simulated arrangements the maximum values of the rms lift coefficients of the upstream and downstream cylinders are both smaller than that of the single cylinder 3 for p 4d α 0 at v r 7 and α 30 at v r 6 the exact flow pattern of the vortex shedding behind the two rigidly connected cylinders cannot be easily distinguished owing to the complicated actions of vortex evolution however for α 0 at v r 10 and α 90 at v r 5 the vortex shedding flow pattern clearly display a symmetric 2s mode and a 2p mode respectively for p 2d with α 0 at v r 5 and α 30 at v r 12 the flow pattern shows a symmetric 2s mode and an asymmetric 2s mode respectively comparatively the vortex shedding flow pattern display irregular modes for α 90 at v r 6 and 12 which is caused by the chaotic vibration characteristics credit authorship contribution statement yun gao conceptualization methodology supervision funding acquisition writing original draft bin yang software data curation hongjun zhu formal analysis geng peng validation zhuangzhuang zhang writing review editing ganghui pan writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national science foundation of china 51609206 open fund project of the state key laboratory of coastal and offshore engineering in dalian university of technology lp2002 
21450,the flow induced vibration fiv responses of two rigidly connected cylinders in various arrangements have been studied numerically using the two dimensional incompressible navier stokes equations coupling with a fourth order runge kutta method four different values of the angle of incidence α and two different values of center to center pitch p between the two cylinders have been selected for the study the fiv response amplitudes lock in regions hydrodynamic force coefficients phase portraits and flow fields have been systematically compared the numerical results demonstrate that for p 4d and increasing α the maximum value of the total mean drag coefficient tentatively increases however the maximum response amplitude shows a decreasing tendency furthermore the maximum amplitude for p 4d occurs when α 0 at v r 7 for p 4d and α 0 the response amplitude remains a certain value during the large v r range which is caused by the participation of the wake induced vibration for p 2d the maximum amplitude happens when α 30 at v r 12 for p 2d when α 90 owing to the proximity induced galloping during the large v r range the response amplitude increases slightly with increased v r displaying no desynchronization characteristics keywords flow induced vibration rigidly connected cylinders galloping hydrodynamic force coefficient flow pattern 1 introduction when vortices are shed in fluid flowing past a circular cylinder the cylinder may be subjected to time dependent drag and lift forces over a certain reynolds re number range if the cylinder is flexibly mounted these hydrodynamic forces may cause the cylinder to vibrate the lift and drag forces may induce the vibrations in cross flow cf and in line il directions respectively which collectively are referred as vortex induced vibrations viv blevins 2001 viv of cylindrical structures is of practical interest to many branches of ocean engineering for example it influences the dynamic characteristics of mooring cables petroleum production risers and pipelines gao et al 2019a since viv may cause significant fatigue damage deterioration and even collapse to the structure viv prediction of the structure is one of the key issues of the structure s design the viv problems of a single cylinder have been studied by many researchers in past decades feng 1968 bearman 1984 khalak and williamson 1999 facchinetti et al 2004 srinil and zanganeh 2012 gao et al 2018 2019b wang et al 2019 zhu et al 2019a 2020 based on these studies some important mechanisms of the viv problem have been unraveled for example when the vortex shedding frequency f v is close to the natural frequency f n of the structure the lock in synchronization phenomenon occurs there exist many vortex shedding flow patterns in the wake region such as a 2s mode representing two single vortices formed per cycle a 2p mode meaning two pairs of vortices formed per cycle and a 2t mode comprised of two triplet of vortices in each cycle with the rapid development of the offshore oil and gas industry a group of multiple cylinders in close proximity are often used in the ocean engineering when a flow with a certain re number past multiple cylinders arranged in proximity the flow induced vibration fiv may occur fiv of multiple cylinders can be classified into two categories viz viv and wake induced vibration wiv zhao et al 2016a the primary difference between viv and wiv is the excitation mechanism of the structural vibration the former vibration is excited by the vortex shedding and it occurs in both upstream and downstream cylinders however the latter vibration is excited by the wake of the upstream cylinder hence it can only occur in the downstream cylinder due to the complex interference of the wake between the adjacent cylinders compared with a single cylinder the flow characteristics behind the multiple cylinders are much more complicated among the configurations of the multiple cylinders arranged in proximity the simplest one is the two circular cylinders of equal diameter sumner et al 2000 as shown in fig 1 the geometry of the two cylinders each of equal diameter of d subjected to a steady flow of v is set by the center to center pitch p between the two cylinders and the angle of incidence α with respect to the line through the two cylinder centers alternatively the geometry can also be determined by the longitudinal separation l and the transverse separation t according to the boundary conditions of the two adjacent cylinders the related studies in last decade can be divided into a the studies on the two stationary cylinders which are directed mainly toward the flow characteristics including the hydrodynamic forces and flow wake patterns hesam and navid 2011 huang and sworn 2013 tong et al 2015 vu et al 2016 hsu et al 2017 jiao and wu 2018 schewe and jacobs 2019 and b the studies on the fiv problems of the two oscillating cylinders as shown in table 1 based on table 1 several important observations can be easily found as follows a the number of numerical studies is larger than that of the experimental ones owing to the cost of the numerical method being lower than that of the physical experiment further the numerical studies are usually conducted in two dimensional low re number flow re vd ν ν is the kinematic viscosity of the flow comparatively the re number studied in the experimental methods are much higher that is to say the numerical studies corresponding with the low re number flow are focused in revealing some important mechanisms of the fiv response characteristics however the experimental studies associated with the high re number flow are more realistic with respect to the practical ocean engineering b based on the general classification method the configuration of the two adjacent cylinders has three different arrangements i e tandem side by side and staggered arrangements as shown in fig 1 for the tandem arrangement the values of α and t are both zero for the side by side arrangement the value of α is 90 and the value of l is zero whereas for the staggered arrangement both l and t have non zero values and the value of α satisfies the condition that 0 α 90 in fact the tandem and side by side arrangements can be treated as two special ones among the staggered arrangements c according to the direction of the structural vibration the studies can be categorized into two groups one group deals with the vibration only in the cf direction where the structure has only one degree of freedom dof and the other group corresponds to the vibration in both cf and il directions simultaneously where the structure has two dofs d for two identical cylinders in a tandem arrangement in a flow there exists a critical value for the center to center pitch p when the pitch is larger than the critical value the vortex shedding are occurred from both upstream and downstream cylinders comparatively when the pitch is less than the critical value the vortex shedding is found to only occur from the downstream cylinder in the offshore and gas engineering two pipelines or riser pipes in close proximity are often strapped together owing to the economical and operational considerations the two close by cylinders can be treated as two rigidly connected cylinders they vibrate simultaneously and have the same response displacements as shown in table 1 compared with a large number of publications dedicated to two freely oscillating cylinders there are much fewer studies on two rigidly connected cylinders furthermore among these limited studies the two rigidly coupled cylinders with tandem and side by side arrangements only vibrated in the cf direction are considered zhao 2013 zhao et al 2016b from these studies on two rigidly connected cylinders it can be found that the center to center pitch has significant effect on the flow induced vibration response furthermore for the tandem arrangement the maximum response amplitude of the two rigidly coupled cylinders is always larger than that of a single cylinder however for the case of two rigidly connected cylinders arranged in different staggered configurations the vibration characteristics of the cylinders and the flow characteristics in the wake region behind the cylinders are not known moreover if the rigidly connected cylinders are allowed to vibrate in both cf and il directions how does the il vibration influence the cf vibration hence to pursue the answers for the aforesaid issues we conducted studies which are based on the research of zhao 2013 and zhao et al 2016b the following part of the paper is divided into four sections in section 2 a brief description of the problem is given in section 3 the governing equations and the numerical methods are presented in section 4 the response amplitudes the hydrodynamic force coefficients and the phase portraits as well as the flow fields behind the two cylinders for two different values of p and four different values of α have been systematically studied finally in section 5 conclusions drawn from the present study are given 2 problem description as shown in fig 2 two circular cylinders of diameter d 0 1 m are symmetrically arranged with respect to the origin o of the cartesian coordinates fig 2 a shows the definition of the flow configuration and geometrical parameters p and α fig 2 b represents the detailed information of the rectangular computational domain and its boundary conditions where x and y represent the il and cf directions respectively the computational domain is a rectangular region with a size of 80d il direction 60d cf direction in the il direction the distances between the inlet and outlet boundaries to the center of the two rigidly connected cylinders are 30d and 50d respectively in the cf direction the computational domain ranges from 30d to 30d the steady uniform velocity is used at the inlet boundary as u v and v 0 where u and v are the velocity components in x and y directions respectively at the outlet the zero gradient condition for the flow velocities along the two vibration directions u x 0 and v x 0 and zero condition for reference pressure p 0 have been applied for assuring a fully developed flow the upper and lower boundary conditions have been imposed by employing a free slip symmetry plane boundary condition with u y 0 and v 0 further the no slip wall condition has been applied on the cylinder surface as shown in the dashed circle in fig 2 b the two rigidly connected cylinders vibrate as a single unit in both cf and il directions simultaneously the main parameters invoked in our study have been listed in table 2 we employ the re number mass ratio and damping ratio values that are invoked in zhao s study zhao 2013 the re number has been fixed at 150 implying that the flow velocity v remains constant the reduced velocity v r has been changed via the natural frequency f n of the oscillating system where v r was formulated as v r v f n d this method of changing v r has also been used in several previous numerical studies bourguet and jacono 2014 gao et al 2018 carmo and meneghini have found that the flow wake behind the cylinder has negligible three dimensional turbulent characteristics when re is less than 190 carmo and meneghini 2006 therefore the present numerical model for re 150 can be studied using two dimensional numerical simulations when compared to the three dimensional simulation the computational cost of the two dimensional study can be significantly reduced furthermore the outcomes of the two dimensional study can provide a useful guidance for the forthcoming three dimensional study based on the reduced mass m red of 2 in zhao s study zhao 2013 the mass ratio m in our study has been selected as 2 6 notably m red in zhao s study is defined as m red m ρd 2 whereas m in our study is formulated as m m πρd 2 4 here ρ is the fluid density and m is the total mass of the vibration system per unit length including the structural mass m s and the added fluid mass m a it is given by m a c a m d in which m d is the displaced mass of fluid due to the cylinder per unit length and c a is the added mass coefficient the damping ratio ζ has been set as zero in both zhao s and our studies for obtaining the maximum vibration amplitude from the previous literature review zhao et al 2016a we note that for the two rigidly connected cylinders with identical diameters there mainly exists two groups based on the effect of the center to center pitch p on the fiv characteristics these cases are viz a when p is larger than a critical value the vortex shedding can happen from both the upstream and downstream cylinders thus the fiv is dominated by the viv b when p is less than a critical value the vortex shedding can only be occurred from the downstream cylinder and leads to that the fiv is dominated by the viv and wiv simultaneously this critical value is about 3 0d 3 5d depending on the re number to study the vibration responses of the two rigidly connected cylinders with different arrangements we have taken two typical values p 4d within the first group and p 2d within the second group that are selected for the numerical study for each pitch p four different angles of incidence α 0 30 60 and 90 have been considered for p 4d the range of the reduced velocity changes from 1 to 15 however for p 2d the range varies from 1 to 30 further the vibration responses of the single cylinder have also been studied for the purpose of the comparison analysis 3 numerical method the low re number re 150 flow past the two rigidly connected cylinders is treated as a two dimensional 2d incompressible flow the governing equations for mass and momentum conservation are written as follows zhu et al 2019b 1 u i x i 0 2 u i t u j u i x j 1 ρ p x i ν 2 u i x j x j where x i and x j are the cartesian coordinates in the i and j directions respectively the variables u i and u j represent the instantaneous components of the velocities in the i and j directions respectively whereas t is the time and p is the pressure the two rigidly coupled cylinders vibrate as a single unit and have the same vibration characteristics in both cf and il directions therefore the vibration system can be visualized as a two degree of freedom 2dof mass spring damper system the 2dof dynamic motions in the cf and il directions have been described bao et al 2012 gao et al 2020a 2020b as 3 d 2 x t d t 2 2 ζ ω 0 d x t d t ω 0 2 x t f d t m d 2 y t d t 2 2 ζ ω 0 d y t d t ω 0 2 y t f l t m where x t dx t dt and d 2 x t dt 2 denote the vibration displacement velocity and acceleration of the two coupled connected cylinders in the il direction respectively whereas y t dy t dt and d 2 y t dt 2 represent the corresponding quantities in the cf direction respectively in eq 3 ω 0 is the natural circular frequency and expressed as ω 0 2πf n since v r is determined based on the diameter of the single cylinder f d t and f l t are selected in our study as the averaged values of the hydrodynamic forces acting on the two cylinders expressed as 4 f d t f d 1 t f d 2 t 2 f l t f l 1 t f l 2 t 2 in eq 4 f d1 t and f l1 t represent the instantaneous drag force and lift force acting on the upstream cylinder respectively whereas f d2 t and f l2 t denote the corresponding quantities exerted on the downstream cylinder respectively boundary conditions on cylinder surfaces are imposed by 5 u t d x t d t v t d y t d t the initial conditions are that the vibration displacements and velocities in both x and y directions are zero expressed as 6 x 0 d x 0 d t 0 y 0 d y 0 d t 0 the two rigidly connected cylinders can be regarded as a single unit executing rigid motion in the x y plane therefore based on the nonlinear vibration of the single degree of freedom partial system the dynamic equation can be solved independently here the second part of eq 3 which describes the vibration in the cf direction is selected as an example and it can be rewritten as gao et al 2020a 2020b 7 d y t d t v t d v t d t f l t m ω 0 2 y t 2 ζ ω 0 v t the classical fourth order runge kutta method has been employed to discretize eq 7 and the detailed information on this method can be found in our previous studies gao et al 2018 2020a 2020b the equations of motion in eq 3 with the initial condition of eq 6 have been solved simultaneously with the governing equations viz eqs 1 and 2 to compute the velocity u v and displacement x y in the il and cf directions then the cylinders are placed at the new position to regenerate the grid the dynamic mesh method has been used to perform mesh deformation based on the motion of the boundary and to perform any needed adaption of the mesh to update the grid successfully two accompanying moving zones around the two cylinders which have the same translational motions with the cylinders are defined to update the grid accordingly the mesh in the accompanying moving zones are unchanged while the mesh in the outer region changes in every time step the finite volume method has been employed to discretize the mass and momentum conservation equations the simple method is used for coupling the pressure and velocity the second order and bounded central differencing schemes have been applied to discretize the pressure and momentum respectively a second order implicit method in time domain has been applied the motion of the cylinder is enforced using the user defined functions all the above governing equations have been solved using the commercial computational fluid dynamics software package fluent 18 0 fig 3 shows the sketches of the complete and localized meshes of the computational domain a previous study has found that the effect of domain width on the structural response can be negligible when the featured ratio of the domain width and the longitudinal size is larger than 10 zhao et al 2012 as shown in fig 3 the longitudinal size is the projected length in the cf direction of the distance between the top side of the downstream cylinder and the bottom side of the upstream cylinder in our study among all the simulation cases the longitudinal size has the maximum value of 5d for p 4d at α 90 implying that the featured ratio has the minimum value of 12 it can be seen that all the featured ratios are larger than 10 and satisfy the neglecting condition of the boundary effects the total computational fluid domain is divided into two zones viz the deformation and the accompanying moving zones as shown in fig 3 a and b the blue deformation zones outside the two cylinders are meshed using triangular elements which can be adjusted and updated based on the translation of the structure the red and purple accompanying moving zones around the two cylinders as shown in fig 3 c and d are meshed using structural quadrilateral elements which varies synchronously with the motions of the cylinders 4 results and discussion 4 1 mesh independency study and numerical method validation the mesh independency study and the numerical method validation should be conducted before proceeding to the related issues under investigation for verifying the accuracy and usefulness of our numerical method we have employed two sets of meshes for p 4d and 2d each stated differently the number of the total elements for one pitch remains constant when v r and α are changed here the selections are α 30 for v r 6 0 and α 30 for v r 12 0 for conducting the mesh independency study for p 4d and 2d respectively tables 3 and 4 list the compared results of the vibration responses a y d and f s f n employing three different meshes and f s is the dominant frequency of the structural vibration in the cf direction which can be obtained by applying a fast fourier transform fft to a stable time history of the vibration displacement in the cf direction the dimensionless vibration displacements a y d are given as 8 a y d y max y min 2 d where y max and y min are the maximum and minimum vibration displacements in the cf direction during a selected stable time respectively fig 4 shows the time histories of the viv displacements in the cf direction for three different meshes we note that all the vibration amplitudes in the cf direction for different meshes become highly steady with the increased time we note from tables 3 and 4 that for the mesh resolution refined from m1 to m2 by increasing the number of the elements the corresponding variations of a y d and f s f n for the two selected cases have been increased with non negligible magnitudes however for a further refinement from m2 to m3 the variations of a y d and f s f n can be negligible the numerical results using m3 grid are very close to the results using m2 grid the simulations have been conducted with the intel core i5 8400 platform transient simulations have typically consumed about 9 h for the m2 grid and 12 h for the m3 grid therefore the m2 grid system provided a good compromise between precision and required time and it is sufficient for the present study subsequent to the mesh independency study the reliability of the present numerical method will further be validated in our early studies gao et al 2018 2020a 2020b we have successfully proved that our numerical method employed in the current work can predict both the viv responses of a single cylinder in an infinite flow and near a plane wall highly satisfactory however the predictability of this method over the vibration responses of the two rigidly connected cylinders reliably needs a further validation here the cases of p 4d in tandem and side by side arrangements are compared with zhao s numerical results zhao 2013 to note the two rigidly connected cylinders are restricted to vibrate only in the cf direction during this validation study in accordance with the same constraint condition of the cylinders in study by zhao fig 5 provides the compared results of the response amplitudes in the cf direction for both tandem and side by side arrangements as shown in fig 5 b for the side by side arrangement the response amplitude at the low reduced velocity range 1 v r 3 is almost negligible as v r increases from 3 to 3 5 the response amplitude shows a tendency for sudden jump and arrives at the maximum value when v r 4 5 obviously displaying lock in characteristics when v r is further increased the response amplitude follows a downward trend when v r increases from 7 to 7 5 the response jumps down quickly concomitantly the reduced velocity enters into the desynchronization region for the tandem arrangement as v r increases the amplitude shows an increasing trend initially followed by a decreasing trend that is similar to the side by side arrangement however for a large reduced velocity v r 7 5 there exists an obvious difference between the two different arrangements as follows for a side by side arrangement the response amplitude is negligible a y d 0 1 apparently indicating the desynchronization characteristics however for a tandem arrangement as shown in fig 5 a owing to the participation of the wiv the vibration response amplitude still remains at a certain value a y d 0 3 the comparison of the results demonstrate that for the two different arrangements including the side by side and the tandem ones our numerical results agree very well with that of zhao 2013 combined with our previous validations gao et al 2018 2020a 2020b the numerical method employed in this work can precisely predict the vibration responses of a single cylinder and two rigidly connected cylinders vibrating only in the cf direction since there is no available data for the vibration responses of the two rigidly coupled cylinders simultaneously vibrating in both the cf and il directions no additional validation has been performed 4 2 cylinder response amplitudes fig 6 shows the cylinder response amplitudes in both cf and il directions for p 4d and 2d with different arrangements based on these amplitudes the lock in characteristics of the vibrations have been further studied here the lock in region is determined as given in the following the vibration amplitudes within the lock in region should be larger than the half of the maximum amplitude during the entire v r range this determination method of the lock in region has also been employed in certain previous studies facchinetti et al 2004 gao et al 2020a applying this method the lock in regions and widths can be easily obtained for the two rigidly connected cylinders with different arrangements as shown in table 5 we note from fig 6 a that for p 4d when α 0 as v r increases the response amplitude in the cf direction jumps up quickly and reaches the maximum value of 0 78d at v r 7 0 which is larger than the maximum amplitude of 0 61d at v r 5 0 for the single cylinder as v r is further increased the difference between the response amplitude of the two rigidly connected cylinders and that of the single cylinder becomes larger when v r exceeds 8 0 the response amplitude of the two rigidly cylinders still remains at a certain value a y 0 2d having no desynchronization characteristics however the response amplitude of the single cylinder is almost zero apparently displaying desynchronization characteristics particularly the vibration characteristics for the specific case p 4d α 0 v r 8 are caused by the participation of the wiv which is induced by the wake interference between the two cylinders besides the vibration is simultaneously dominated by the wiv and the viv as shown in table 5 the lock in region for p 4d when α 0 is 5 v r 10 and it is wider than 4 v r 7 for the single cylinder for p 4d when α is increased to 30 the response amplitude in the cf direction reaches the maximum value of 0 73d at v r 6 which is a little smaller than that for α 0 during the large v r range v r 7 0 compared with α 0 the response amplitude for α 30 is significantly decreased for e g at v r 15 the response amplitude for α 30 is 0 09d which is negligible for the value of 0 26d corresponding to α 0 this can be explained as follows for α 30 the wake interference between the two cylinders becomes much weaker further resulting in the vibration being dominated by the viv as α is further increased to 60 and 90 the wake interference is almost negligible causing the two rigidly connected cylinders to have almost the same response amplitudes with the single cylinder the lock in regions for p 4d when α 30 60 and 90 are all distributed in the range of 4 v r 7 also having the same region with the single cylinder as α increases the maximum amplitude in the cf direction shows a decreasing trend for p 4d comparing fig 6 b and a obviously shows that the vibration characteristics of the response amplitude of the two rigidly connected cylinders in the cf direction for p 2d are much complex than those for p 4d for p 2d when α 0 the response amplitude reaches its maximum value of 0 25d at v r 5 which is negligible for the corresponding value for the single cylinder when v r exceeds 8 the response amplitude is very small and changes little with increased v r the lock in region for p 2d when α 0 is 5 v r 6 having the narrowest lock in region among all the simulated arrangements the maximum response amplitudes in the cf direction are 0 79d and 0 63d respectively for p 2d when α is increased to 30 and 60 as shown in table 5 for p 2d the lock in regions for α 30 and 60 are 6 v r 19 and 4 v r 13 respectively which are both much larger than that for the single cylinder when α is further increased to 90 the response amplitude has the maximum value of 0 60d at v r 6 and the lock in region is 4 v r 9 during the two v r ranges including v r 23 when α 30 and v r 14 when α 60 the response amplitudes both show slightly decreasing tendency with increased v r obviously displaying desynchronization characteristics nevertheless the response amplitude for the side by side arrangement α 90 tends to slightly increase when v r 11 accordingly this slight increase for α 90 is effectuated by the proximity induced galloping of the two cylinders the detailed information behind this phenomenon will be further studied in combination with the characteristics of the flow fields in section 4 4 as shown in fig 6 c for p 4d and α 0 30 and 60 the maximum vibration amplitudes in the il direction are 0 025d 0 11d and 0 039d respectively and all of which exceeds the maximum amplitude of 0 022d for the single cylinder for p 4d and α 90 the response amplitude of the two rigidly coupled cylinders in the il direction displays the same vibration characteristics with that for the single cylinder from fig 6 d for p 2d and α 0 the response amplitude in the il direction can be negligible however as α is increased to 30 60 and 90 the amplitudes in the il direction reach the maximum values of 0 42d 0 16d and 0 26d respectively all of which are much larger than that for the single cylinder 4 3 hydrodynamic force coefficients and phase portraits the hydrodynamic force coefficients contain lift and drag force coefficients based on the instantaneous drag and lift forces expressed in eq 4 the two instantaneous hydrodynamic force coefficients for each cylinder and the total instantaneous coefficients of the total force sum of fluid forces acting on both cylinders can be easily obtained by the normalization of the corresponding instantaneous hydrodynamic forces as 9 c d up t f d 1 t 1 2 ρ d v 2 c d down t f d 2 t 1 2 ρ d v 2 c l up t f l 1 t 1 2 ρ d v 2 c l down t f l 2 t 1 2 ρ d v 2 c d total t f d 1 t f d 2 t 1 2 ρ d v 2 c l total t f l 1 t f l 2 t 1 2 ρ d v 2 in eq 9 the subscripts up and down stand for the upstream and downstream cylinders respectively further the subscript total denotes both the cylinders subsequent to finding the instantaneous lift and drag force coefficients and taking n sampling points during the stable period the mean drag force coefficient and the root mean squared rms value of the lift force coefficient for the upstream cylinder the downstream cylinder and both the cylinders can be computed as 10 c d mean up 1 n i 1 i n c d up i c l mean up 1 n i 1 i n c l up i c l rms up 1 n i 1 i n c l up i c l mean up 2 c d mean down 1 n i 1 i n c d down i c l mean down 1 n i 1 i n c l down i c l rms down 1 n i 1 i n c l down i c l mean down 2 c d mean total 1 n i 1 i n c d total i c l mean total 1 n i 1 i n c l total i c l rms total 1 n i 1 i n c l total i c l mean total 2 fig 7 shows the variation of the mean drag coefficient for each cylinder and the mean drag coefficient based on the total drag force for different p and α as shown in fig 7 a and c for p 4d and α 0 there exist huge disparities between the mean drag coefficients of the upstream and downstream cylinders with that of the single cylinder further in comparison to the upstream cylinder the difference between the downstream cylinder and the single cylinder is much larger which is effectuated by the wake interference on the downstream cylinder being much more prominent than the effect on the upstream cylinder when α 30 the differences between the mean drag coefficients of the two cylinders with that of the single cylinder become negligible as α is further increased to 60 and 90 the mean drag coefficients of both the cylinders have proximate values with that of the single cylinder fig 7 e indicates that when α 60 and 90 the total mean drag coefficient is almost twice that of the single cylinder furthermore the total mean drag coefficient has an upward tendency as α increases fig 7 b and d indicate that for p 2d when α 0 the mean drag coefficients of the upstream and downstream cylinders are both much smaller than that of the single cylinder the mean drag coefficients of the downstream cylinder at all other reduced velocities have negative values for p 2d and α 0 except for the maximum value at v r 5 which can be explained as follows the shear layer separated from the downstream cylinder cannot roll into a free vortex in the gap region for α 0 at small gap p 2d caused by the small response amplitude in the cf direction as shown in fig 6 b instead the shear layer reattaches to the downstream cylinder this reattachment causes the downstream cylinder to be completely inside the wake formed by the upstream cylinder further leading to a negative drag force for p 2d as α is increased from 0 to 90 upward trend is noted for the maximum values of the mean drag coefficients for the upstream and downstream cylinders as well as the total cylinders fig 8 presents the rms lift coefficient of each cylinder and the rms lift coefficient based on the total lift force for different p and α according to fig 8 a and c for p 4d and for the four arrangements α 0 30 60 and 90 the maximum value of the rms lift coefficient of the upstream cylinder is always smaller than that of the single cylinder however the maximum value of the rms lift coefficient of the downstream cylinder is usually larger than that of the single cylinder stated differently the maximum value of the rms lift coefficient for the downstream cylinder is usually larger than that of the upstream cylinder when p 2d for the four arrangements the maximum values of the rms lift coefficients of the upstream and downstream cylinders are both obviously smaller than that of the single cylinder we note from comparing the total lift coefficients in fig 8 and the corresponding cf displacements in fig 6 that the reduced velocity v r which has the maximum lift coefficient is usually smaller than the reduced velocity for p 4d and 2d further it has the maximum vibration amplitude in the cf direction it is induced by the phase between the lift force and the response displacement figs 9 and 10 present the phase portraits of the total lift force coefficient and the vibration displacement in the cf direction for p 4d and 2d respectively for p 4d and 2d as v r increases the phase portraits both rotate at an anti clockwise direction for p 4d when v r 4 the phase portrait is single valued which implies that there exists only one value of c l total for each y d however as v r increases the phase portrait becomes double valued showing that there exist two values of c l total for each y d the single valued phase portrait implies that the value of c l total is only determined by the value of y d and have relationship with the move direction of the cylinders however the double values phase portrait implies that the value of c l total is determined by the value of y d and the move direction of the cylinders simultaneously as v r is further increased the phase portrait recurs showing the single valued characteristics for p 4d and 2d whether the fiv response is dominated by viv or wiv can be conveniently determined by the response characteristics of the phase portrait as shown in fig 9 all the phase portraits display periodic characteristics or stated differently the phase portraits can be repeatable as time increases it indicates that the fiv responses are all dominated by viv for p 4d however the phase portraits for p 2d are more sophisticated than those for p 4d for the sake of convenience here only the case of α 90 for p 2d is selected for the study when v r 4 the phase portrait shows periodic characteristics indicating that the fiv response is dominated by viv when v r 10 the phase portrait is very chaotic and unrepeatable indicating that the fiv response is dominated by wiv 4 4 flow fields to get a clear picture of the flow regimes varied with v r and α the instantaneous vorticity contours of different v r and α when the two rigidly connected cylinders obtain the maximum vibration amplitude in the cf direction are shown in fig 11 according to fig 11 a for p 4d and increasing α the width of the vortex street behind the two cylinders has an increasing tendency however the wake interference between the two cylinders tends to decrease as α increases to 90 the wake interference remains negligible comparison of fig 11 a and b indicates that the wake interference between the two cylinders for p 2d is much more complicated than that of p 4d fig 12 15 present the detailed information on the wake dynamic characteristics in the flow fields behind the two rigidly connected cylinders owing to the large number of the simulation cases only certain typical cases have been selected for the numerical study in this section for investigating the intrinsic mechanisms of the wake dynamics the time series and amplitude spectra of the normalized values of the vibration displacements and hydrodynamic forces in the cf and il directions as well as five instantaneous vorticity contours at five typical vibration points locations a b c d and e have been analyzed concurrently the non dimensional vorticity given in the figures has been calculated with ω v x u y v d for p 4d and α 0 two reduced velocities v r 7 and 10 have been selected for studying the response characteristics during the lock in and wake induced vibration regions respectively for v r 7 the response amplitude in the cf direction has the maximum value of 0 78d however the vibration displacements in both cf and il directions vary very periodically with single dominant frequencies of 0 133 and 0 265 respectively the normalized dominant frequency in the il direction is twice that in the cf direction further the total lift force is always in phase with the vibration displacement in the cf direction while the total drag force is always out of phase with the vibration displacement in the il direction here the vortex separated from the top side of the upstream cylinder labeled a has been selected as the typical one for the detailed analysis of the vortex evolution as shown in fig 12 a the vortex a has been cut into two vortices labeled a1 and a2 at location b subsequent to the impingement on the downstream cylinder the vortex a2 with weak strength will be dissipated quickly in the wake region however the vortex a1 will merge with the vortex b separated from the downstream cylinder the vortices a1 and b are comparable in strength generally the vortex evolution for v r 7 includes several complicated actions such as the impingement on the structural surface the vortex dissipating action and the vortex coalescing action thus the exact flow pattern of the vortex shedding behind the two rigidly connected cylinders cannot be easily determined according to fig 12 b both the vibration displacements in the cf and il directions for v r 10 vary steadily showing the same characteristics with those for v r 7 however for v r 10 the vibration displacement in the cf direction is completely out of phase with the total lift force which displays completely opposite characteristics with that for v r 7 comparing fig 12 b and a the lift force magnitudes of the upstream and downstream cylinders are comparable for v r 7 on the contrary the lift force magnitude of the upstream cylinder is much larger than that of the downstream cylinder for v r 10 taking the evolution of the vortex a separated from the top side of the upstream cylinder as an example the vortex a is split into two vortices labeled a1 and a2 at location b subsequent to the impingement on the downstream cylinder the vortex a2 with weak strength will vanish quickly in the wake region comparatively the vortex a1 with high strength will shed freely in the wake region we observe from the instantaneous vorticity contours at locations b and c that the shear layer b generated from the downstream cylinder cannot roll up into a free vortex independently instead it can only be merged into the vortex a1 comparison of the flow field at the left of the blacked dashed line at location a with the field at location e obviously indicates that the vortex shedding flow pattern for v r 10 displays a symmetric 2s mode for p 4d and α 30 the response amplitude in the cf direction at v r 6 reaches the maximum value of 0 73d the vibration displacement in the cf direction varies periodically with only one peak frequency however the vibration displacement in the il direction shows quasi periodic characteristics with two peak frequencies the lift and drag forces of the upstream cylinder have proximate values to the corresponding quantities of the downstream cylinder from the five instantaneous vorticity contours for v r 6 shown in fig 13 a the clockwise vortex a shed from the inner surface of the upstream cylinder is impinged on the surface of the downstream cylinder and subsequently cut into two vortices labeled a1 and a2 the vortex a1 will merge with the vortex b which is shed from the outer surface of the downstream cylinder however the vortex a2 will dissipate quickly in the free wake region the counter clockwise vortex c separated from the outer surface of the upstream cylinder merges with the vortex d generated from the inner surface of the downstream cylinder displaying the similar vortex evolution characteristics with the clockwise vortices a and b furthermore the clockwise and counter clockwise vortices in the free wake region have very comparable intensities owing to the complex characteristics of the vortex evolution the vortex shedding flow pattern for p 4d α 30 and v r 6 has no apparent 2s or 2p modes for p 4d and α 90 the response amplitude in the cf direction at v r 5 has the maximum value of 0 59d as shown in fig 13 b the flow wake behind the upstream cylinder displays the in phase synchronized pattern along with that behind the downstream cylinder the vortices distributed in the free wake region are apparently arrayed in four rows there is no coalescing action for the vortices with the same rotational direction owing to the large vibration amplitude in the cf direction further the vortex shedding flow pattern can be easily found to have a 2p mode for p 2d and α 0 the response amplitude in the cf direction at v r 5 reaches the maximum value of 0 25d the vibration displacement in the cf direction has only one peak frequency while the one in the il direction has two peak frequencies however both the total lift and drag forces have only one peak frequency owing to the small vibration amplitude in the cf direction the two shear layers separated from the top and bottom surfaces of the upstream cylinder are both stretched and continuously reattached to the surface of the downstream cylinder the vortex shedding flow pattern behind the two rigidly connected cylinders displays a symmetric 2s mode within each vibration period for p 2d and α 30 the response amplitude in the cf direction at v r 12 has the maximum value of 0 79d the vibration displacements in the cf and il directions both vary periodically with only one peak frequency on the contrary there exist many frequency components for the total lift and drag forces implying that the vortex interactions are sophisticated as shown in fig 14 b separated by the counter clockwise vortex labeled d the clockwise vortex labeled a generated from the inner surface of the upstream cylinder and the clockwise vortex labeled b generated from the outer surface of the downstream cylinder cannot merge however the counter clockwise vortex labeled c generated from the outer surface of the upstream cylinder and the counter clockwise vortex labeled d can be merged in the wake region these different characteristics of the clockwise and counter clockwise vortices further effectuate the vortex shedding flow pattern to be an asymmetric 2s mode for p 2d and α 90 two typical reduced velocities v r 6 and 12 have been selected for studying the response characteristics within the lock in and proximity induced galloping regions respectively when v r 6 the response amplitude in the cf direction reaches the maximum value of 0 6d the vibration displacement in both the cf direction and the total lift force vary periodically with only one peak frequency however both the vibration displacements in the il direction and the total drag force have several peak frequencies all of which are distributed in a narrow band the magnitudes of the lift and drag forces exerted on the upstream cylinder are comparable with those of the corresponding hydrodynamic forces acting on the downstream cylinder respectively as shown in fig 15 b when v r 12 the vibration displacements and the hydrodynamic forces in both cf and il directions have several peak frequencies displaying chaotic characteristics for this specific case p 2d α 90 and v r 12 the mean lift forces of the upstream and downstream cylinders have negative and positive values respectively which is affected by the asymmetry in the flow owing to the proximity effect of the two cylinders this vibration induced by the asymmetric lift force is termed as the proximity induced galloping vibration for p 2d and α 90 the vortex shedding behind both the cylinders for v r 6 and 12 have no regular flow patterns owing to the chaotic response characteristics of the cylinder vibration 5 conclusions the fiv responses of the two rigidly connected cylinders in different arrangements have been studied numerically with the mass ratio and reynolds number fixed at the constant values of 2 6 and 150 respectively the damping ratio is set to zero to encourage high amplitude oscillations two typical center to center distances between the two cylinders p 4d and 2d have been selected for the numerical study the angle of incidence α varies in the range of 0 90 with an increment of 30 the two dimensional incompressible flow model coupled with a fourth order runge kutta method have been employed to solve the governing equations the fiv responses including the response amplitude lock in region hydrodynamic force coefficient and flow fields have been determined and analyzed systematically based on these results the following conclusions can be drawn 1 the fiv response is a combination of viv and wiv for p 4d and α 0 owing to the strong wake interference between the two cylinders as α is increased to 30 the wake interference becomes much weaker further resulting in the fiv response being dominated by viv when α is further increased to 60 and 90 the wake interference becomes almost negligible hence the fiv response has almost the same response with the single cylinder for p 4d the maximum amplitude occurs at v r 7 when α 0 compared with p 4d the vibration characteristics for p 2d are much more complicated especially the fiv response for p 2d when α 90 has no desynchronization characteristics during the large v r range which is caused by the participation of the proximity induced vibration 2 the mean drag coefficients of the upstream and downstream cylinders are both obviously different from that of the single cylinder for p 4d and α 0 and 30 whereas for α 60 and 90 the mean drag coefficients of the two cylinders are proximate to that of the single cylinder the maximum value of the rms lift coefficient of the upstream cylinder is usually larger than that of the downstream cylinder for all four simulated arrangements viz for α 0 30 60 and 90 the maximum values of the mean drag coefficients for each individual cylinder and total cylinders all display increasing tendencies for p 2d when α is increased from 0 to 90 for the four simulated arrangements the maximum values of the rms lift coefficients of the upstream and downstream cylinders are both smaller than that of the single cylinder 3 for p 4d α 0 at v r 7 and α 30 at v r 6 the exact flow pattern of the vortex shedding behind the two rigidly connected cylinders cannot be easily distinguished owing to the complicated actions of vortex evolution however for α 0 at v r 10 and α 90 at v r 5 the vortex shedding flow pattern clearly display a symmetric 2s mode and a 2p mode respectively for p 2d with α 0 at v r 5 and α 30 at v r 12 the flow pattern shows a symmetric 2s mode and an asymmetric 2s mode respectively comparatively the vortex shedding flow pattern display irregular modes for α 90 at v r 6 and 12 which is caused by the chaotic vibration characteristics credit authorship contribution statement yun gao conceptualization methodology supervision funding acquisition writing original draft bin yang software data curation hongjun zhu formal analysis geng peng validation zhuangzhuang zhang writing review editing ganghui pan writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this research was supported by the national science foundation of china 51609206 open fund project of the state key laboratory of coastal and offshore engineering in dalian university of technology lp2002 
21451,maritime autonomous surface ships mass attract increasing attention in recent years researchers aim at developing fully autonomous systems that replace the role of human operators studies either focus on supporting conflict collision detection for manned ships or solving conflict automatically for unmanned ships the cooperation between human and machine has been less focused on in existing studies however this type of cooperation is essential both in practice and in the future firstly demands on navigational assistance are still strong for supporting navigators in manned ships secondly mass with different autonomy levels require increasing cooperation between human operators and machines e g monitoring automation remotely controlling the ship etc thirdly the intelligence of human and the machines is highly complementary moreover fully autonomous ships cannot replace all the manual ships overnight therefore the future waterborne transport system will be a system in which both human operated vessels and autonomous vessels exist in this article we firstly provide an overview of existing modes of human machine interaction hmi during ship collision avoidance then we propose a framework of hmi oriented collision avoidance system hmi cas whose decision making process is interpretable and interactive for human operators the hmi cas facilitates automatic collision avoidance and enables the human operators to take over the control of the mass safely moreover the proposed framework acknowledges the under actuated feature of ships simulations are carried out to demonstrate the proposed hmi cas the results show that the proposed hmi cas can not only control the under actuated mass to avoid collision automatically but also share the decision making with human operators and support the operators to control the mass keywords human machine interaction collision avoidance system under actuated ship shared decision making mass 1 introduction 1 1 background maritime autonomous surface ships mass have been receiving numerous attention and discussions from the public and the academic which is expected to reduce human errors on board to improve navigational safety and to increase the efficiency of waterborne traffic systems hence various prototypes of mass have been proposed in recent years liu et al 2016 schiaretti et al 2017 the ultimate aim of relevant studies is at removing human operators in the control loop which is however still unrealistic teaching the automation to understand regulations is still challenging and the trust of the public on the autonomous ships is still questionable in fact the machines and the human are needless to be adversarial human intelligence and machine intelligence are complementary where the first one is good at interpreting navigational regulations and the second one has advantages of computing powers hhuang et al 2020a communication and cooperation between human and automation become important in the development of autonomous vehicles koopman and wagner 2017 in other words the interactions between the human and the machine in collision avoidance are essential for developing relevant automatic or even autonomous systems in various mass which were rarely discussed in existing research 1 2 motivation fig 1 demonstrates the system that integrates two loops without considering human machine interactions hmis one is with humans on board noted as the manual loop the other is without humans noted as the unmanned loop a switch is employed to change the control mode between two loops in the unmanned loop the guidance system is in charge of finding a collision free solution and the control system is designed to execute this solution e g desired forces trajectories etc since humans on board are not considered in this loop the outputs of the guidance system or the control system are usually difficult for humans to read to intervene and to implement for instance if the guidance system outputs the desired forces in each direction how to allocate these forces to steers is a question for human operators alternatively the system might offer a collision free trajectory or a set of steers that are readable for human but steering the ship to each waypoint or following each planned steer sticking to a planned schedule is also challenging for human operators if a human operator wants to intervene in the automatic collision avoidance process e g the automation will violate regulations etc the operator needs to switch to the manual loop then the operator has to analyze the encounters again find out possible collision free solutions and implement the solution by himself herself in this hybrid system the interaction between humans and machines is little and there is a lack of information exchange between them neither of the manned system nor the unmanned system in fig 1 is perfect if the existing manned system is reliable there would not be room for developing unmanned systems in many accidents the operators take evasive actions too late or no actions in urgent cases graziano et al 2016 besides the traditional navigation assistant systems lack the function of suggesting collision free solutions tam et al 2009 which is a strength of the unmanned system on the other hand the unmanned loop is also not perfect in particular how can the unmanned systems understand regulations is still an open question campbell et al 2012 where human knowledge is indispensable therefore a connection between these two loops could be a win win solution where a system incorporating hmis is needed however to the best of our knowledge studies on the manned ship or the unmanned ship do not incorporate the cooperation between human and machines in finding a collision free solution in manned ship studies the human is supported by the machines to detect dangers goerlandt et al 2015 while finding a collision free solution is in charge of human operators in unmanned ship studies the machine is supposed to be highly intelligent and there is no interface for operators to interact cooperate with the machine zheng 2016 that is the human operator or the machine works independently in finding a solution i e evasive decisions are either made by a human ożoga and montewka 2018 or a machine liu et al 2016 and the knowledge intelligence between the human and the machine is not shared 1 3 contributions as presented above limited studies focused on supporting the cooperation between humans and machines in conflict resolution for ships since the advantages of the human and the automatic systems are highly complementary the combination will not only help the automatic systems gain knowledge from the human supporting rule compliant actions in the unmanned ship but also help human on board take a correct operation in time in the manned ship in brief supporting hmis in decision making would combine the advantages of the human and the machine in preventing ship collisions which is a necessary step for developing various mass type i iii however few collision avoidance research considered hmis in decision making thus the main research question for this study is how can a collision avoidance system that combines the wisdom of human and intelligence of machines in collision avoidance be developed the main contributions of this article is as follows 1 we overview the hmis levels of the existing cas research and offer a clarification of hmis in mass with different autonomy levels 2 we propose a human machine interaction oriented collision avoidance system hmi cas incorporating hybrid intelligence that combines the complementary strengths of human operators and artificial agents 3 the proposed hmi cas visualizes the decision space of the machine and allows the human operators to intervene which makes the decision making process interpretable and interactive for human operators 4 we take the under actuated ship dynamics into consideration in the proposed hmi cas 1 4 outline the structure of this article is addressed as follows an overview of existing collision avoidance methods is presented in section 2 followed by the framework of the hmi cas incorporating under actuated ships has been shown in section 4 section 5 includes simulations to demonstrate the proposed hmi cas and section 6 discusses the main findings of this article conclusion and directions for future research are summarized in section 7 1 5 literature review on ship collision avoidance from existing collision avoidance systems cass two categorizes are observed one focuses on developing alert systems for reminding human operators to detect dangers while supporting the operator to find collision free solutions is not a focus the other one concentrates on developing the automatic system that avoids collisions automatically for mass while interacting with human operators are not considered to our best knowledge supporting hmis in conflict resolution is rarely addressed in the literature huang et al 2020a chen et al 1 6 hmis in conflict resolutions the interaction between human and machines in collision avoidance mainly refers to information exchanges to see how the existing cass support the interactions during conflicts we firstly categorized the forms of outputs of various cass and then categorize hmis according to the information flow between machine and human operators then the feature of existing collision avoidance algorithms regarding the categorized forms of interactions is clarified the information delivering to human include but not limited to 1 one collision free solution noted as u 2 one best solution that minimizes the utility function noted as u 3 a finite number of safe solutions noted as u 4 a closed region of collision free solutions noted as u 5 all closed regions of unsafe solutions noted as κ i u i human operators can conduct the following operations using the above information a switching to manual mode when human operators prefer to steer the ship by themselves or the solution found is not fully satisfied b accepting the solution c changing the solution by modifying the utility function when the operator does not satisfy the selected best solution by machine d picking up one solution in given finite solutions u when the machine does not pick up any solution to human operators or the chosen one is not satisfied the machine shows several solution candidates e picking up one solution in a given collision free set u when the machine does not pick up any solution to human operators or the chosen one is not satisfied the machine shows a set of feasible solutions f validating the safety of inputted solution when the machine does not pick up any solution or the chosen one is not satisfied the machine shows unsafe solutions illustrations of the solution forms and relevant services are shown in table 1 the solution space of the ships is presented and each point in this space represents one maneuver the black dot of type 1 in table 1 shows one type of information service that the machine delivers one feasible but not necessarily optimal collision free solution to human operators in type 2 the mark means the machine offers an optimal collision free solution in type 3 the dots are the optional collision free solutions that the machine can find in type 4 a sub space of solution space containing collision free solutions is colored in blue in type 5 instead of finding a collision free set the machine identifies all the solution sub spaces leading to the collision colored in grey in many cases the combinations of these information types are needed to achieve more hmi types 1 7 solution forms of existing algorithms in huang et al 2020a the algorithms for conflict resolution have been categorized into 5 groups with 14 representative algorithms in this section the representative algorithms regarding the demand of hmis addressed in section 2 1 are compared and shown in table 2 rule based methods usually offer one feasible solution to operators or mass controllers the feasible solution could be a course naeem et al 2012 a speed perera et al 2012 or a pattern enlarge rudder angle until it is collision free fang et al 2017 etc in these studies fuzzy logic based methods are popular perera et al 2012 wu et al 2020 nevertheless since the collision check is not inclusive some algorithms might not guarantee that the solution is collision free virtual vector methods offer a solution that might not be optimal but collision free the solution could be a collision free course by artificial potential field apf lyu and yin 2018 or a collision free trajectory generated by limited cycle method lcm mahini et al 2013 soltan et al 2010 discrete inputs group follows a common idea that firstly discretizes the control space and then finds the solution brute force search checks the solutions from the discrete control space and returns one collision free solution dynamic window dw serigstad 2017 and decision disc dd benjamin et al 2006 kuwata et al 2014 enable to offer alternative solutions and an optimal solution these algorithms search each feasible solution in solution space and the optimal solution is found in these solutions however since the control space is discretized these algorithms cannot offer a continuous solution space to users besides the dw implies stopping the ship is always a safe option and dd assumes the target ship sailing with constant speed and course which are not always the case at sea discrete inputs optimization and lattice based search contain an optimization finding one collision free solution thus they can directly offer an optimal solution to users continuous inputs methods search collision free solutions in a continuous space both visual cone vc and model predictive control based collision avoidance mpc ca can find one collision free solution while mpc ca could offer a solution to minimize a predefined cost function velocity obstacle vo algorithm firstly identify the unsafe region in solution space i e k and then find an optimal solution in the complimentary space i e k two representative algorithms of the re planning group are fast marching method fmm and projected obstacle area poa fmm firstly assigns a cost map and then finds an optimal path poa assigns a prohibit region around the predicted position of obstacle and finds one path to avoid the prohibited region from table 2 one can observe that different methods can provide different information and support relevant hmis it is worth noting that only vo algorithms can provide various types of information listed in section 2 1 i e 1 5 and then can support all types of hmis ãf 1 8 a generic framework of hmi cas as mentioned in section 1 and 2 hmi for mass with different autonomy levels requires different types of information thus to develop the cas supporting hmis the hmi cas needs to offer various forms of solutions i e one feasible solution one optimal solution several feasible solutions feasible ranges of solutions and dangerous solutions 1 9 focuses of hmi cas different from the hybrid system presented in fig 1 this manuscript aims at adding an interaction between the automatic system and human specifically between the guidance system and human operators the red arrows shown in fig 2 guidance system provides information to human and human sends commands to guidance system e g authorization intervention etc the cas and an interface are composing of the collision avoidance module in the guidance system the entire gnc system with the designed cas and interface is named as human machine interaction oriented collision avoidance system hmi cas to incarnate the connection between human operators and the guidance system an interface is introduced that supports information exchange an illustration of this idea is shown in fig 3 the blue arrow shows the information flow in the cas which delivers information to human operators the green arrows represent the inputted information by humans which feeds the human s decision backs to the machine and influences the behavior of the ship 1 10 a generic framework of hmi cas an abstract representation of hmi cas is shown in fig 4 the proposed hmi cas has two modes manual mode and autonomous mode when there is no human intervention the own ship follows the waypoints and automatically takes evasive actions i e autonomous mode the framework of this system based on the gnc system three basic systems are inclusive the guidance system the navigation system and the control system the navigation system contains sensors and transceivers that allow the ship to sense the surrounding environment and to exchange its state with other ships the obtained information is inputted to the guidance system the guidance system is performing as a brain that makes decisions according to obtained information moreover this electronic brain is allowed to interact with humans via the designed interface the control system contains a controller that implements the input solution from the guidance system and output relevant command to actuators i e propeller and rudder to support interaction between human operators and the gnc system an interface is added to the guidance system thus three main modules are included in the guidance system i e global planner local planner and interface the structure of each module is shown in fig 5 global planner generates a planned waypoint for the system which guides the ship to the destination noted as wp this waypoint is generated by path planning algorithms or input by human operators local planner generates a collision free solution considering the observed information planned waypoints and human s feedbacks etc noted as u interface has two main functions for one it presents information for human operators e g a set of solutions leading to collisions a set of collision free solutions and a selected solution to human operators for the other it collects orders from human and sends it back to local motion planner system the orders could be an alternative solution a command to stop continue the existing mode etc 2 global planner global planner contains a path planning module in which various deliberate algorithms can be used e g a liu et al 2019 theta kim et al 2014 dijkstra fast marching method liu and bucknall 2016 potential field xue et al 2009 etc an overview of these algorithms is shown in campbell et al 2012 the basis of these methods is a known roadmap some other algorithms need an inputted cost function that is minimized to find the path alternatively instead of using path planning algorithms human operators also can directly input a desired path given the input optimized path the global planner also needs to find out which waypoint is activated i e the waypoint that the ship is heading to 3 local planner local planner is the focus of the guidance system which is in charge of finding a collision free solution it consists of three key processes i e trajectory prediction conflict detection and conflict resolution the trajectory prediction outputs the trajectories of the os and the ts i e x i t and x j t based on these predicted outcomes the conflict detection calculates the relevant collision risk and triggers an alarm and conflict resolution if necessary lastly the conflict resolution finds a collision free solution according to input information from trajectory prediction conflict detection and feedbacks from a human the outputted information is delivered to the interface module and the control system if no command from the interface the optimal solution will be executed by the control system 4 interface interface is designed for the interactions between human operators and the machine which shows the supporting information for collision avoidance and collects feedback from human operators the information from the machine includes collision free solutions best solutions dangerous solutions etc since the input information from conflict resolution might not be directly readable for human operators we design a mapping sub module that presents the resolution space this map together with a solution selected by the machine is projected in the human machine interface the human operator can then read the map to understand the selected solution of the machine authorize the system to continue intervene in the system or find a new solution if necessary the information from human operators to the machine is the new solution they input in the interface noted as u human this new solution is sent back to the mapping sub module that translates the solution to the machine s language 4 1 requirements on hmi cas for achieving hmis although the manual mode is kept the function for the designed hmi cas is to show the decision process of the machine providing the opportunity for human to intervene in the decisions in this way the operator can build trust with this new system and then the operator does not need to stay onboard for directly controlling the ship the human operators then can intervene interact with the machine in offshore control centers in brief the hmi cas can be applied to mass with different autonomy levels where human is involving this system supports human in the following aspects 1 to identify who have conflicts with the own ship 2 to notice whether it is necessary to take actions 3 to show how does the cas system avoid the dangers 4 to be aware of what kind of operations are dangerous safe 5 to inform whether the chosen solution by the human is safe unsafe 6 to intervene in automated collision avoidance if necessary to meet these demands the interface in hmi cas needs to be user friendly in particular the interface facilitates the users to read the information to understand the collision free solutions selected by the machine and to intervene in the conflict resolution moreover this system needs to support various types of cooperation in conflict resolution thus the conflict resolution in the local planner module needs to offer various types of solutions for users for instance one collision free solution one best solution a set of safe unsafe solutions etc from the comparison in section 2 2 we find that the vo algorithm meets our demands firstly the vo algorithm presents a set of dangerous solutions i e k that allows the human operators to validate their solutions safe or not secondly the optimization in the complementary of k set is possible these features can satisfy the demand of human machine cooperation in the proposed hmi cas moreover the form of the solution of vo algorithms is friendly for human operators to read and to implement therefore in this article a family of vo algorithms is adopted for developing the proposed hmi cas when applying the vo algorithms in the maritime domain this family of algorithms has some limitations firstly the vo algorithm assumes the target ship sail with constant speed and course which is noted as semi dynamic ts secondly the dynamics of the ship are ignored in finding a collision free solution some modifications are made to overcome the limitations in huang et al 2018 researchers introduced a non linear vo algorithm and a probabilistic vo to deal with semi dynamic ts in huang et al 2019 the authors incorporate the ship dynamics by using the generalized vo gvo algorithm in which the ship is fully actuated in this article we employed the gvo algorithm to achieve the proposed hmi cas and consider under actuated ships that are more common in practice hmi cas considering under actuated ship dynamics 4 2 under actuated ship dynamics in general the ship is an under actuated vehicle with two types of control inputs i e thrust t and torque n the surge speed is controlled by thrust and the yaw is determined by torque while the sway speed is not directly influenced by control inputs a representation of such ship dynamics can be formulated as follows 1 i 3 3 0 3 3 0 3 3 m 3 3 x r ψ v c v v d v v b 6 2 τ where x is the system state containing coordinates x y heading angle ψ and v that consists of linear velocities u v and angular velocity r τ is inputs vector with thrust t and torque n m c v d v and r ψ are inertia matrix coriolis centripetal matrix damping matrix and rotation matrix respectively moreover b 6 2 0 2 3 1 0 0 0 0 1 t details refer to fossen 2002 illustration of the coordination system is presented in fig 6 moreover we add a pd controller as a high level controller and switch the control input from the force τ to the desired velocity u the pd controller is formulated as 2 τ k p u g x k d g x k p g x k d g x k p u where g x is an observed function kp and kd are feedback gains let formulate the observe function as 3 g x v and x g x v x then the new system with the pd controller uses the desired velocity as inputs i e u 4 i 0 0 m bk d v 1 r ψ t v t c v t v t d v t v t k p v x t i 0 0 m bk d v 1 bk p u t f x u 5 i 0 0 m bk d v 1 r ψ t v t c v t v t d v t v t k p v x t i 0 0 m bk d v 1 bk p u t f x u since equations 4 and 5 is non linear we can approximate the state of the ship with the help of runge kutta rk integration and taylor expansion law specifically we can formulate the position of the ship at time t via the changes of the desired velocity δ u u u 0 6 x t 0 t f x 0 u 0 d τ 0 t δ x τ d τ x t g t δ u where g t 0 t e a t τ b d τ with a f x and b f u and x is the estimated state of the ship calculated via rk method with a known initial state x 0 and a known initial input u 0 4 3 gvo algorithm considering under actuated dynamics given equation 6 the position of the ship at time t is formulated as 7 p i t c x i t c g t δ u i where c i 2 2 0 2 4 contains a 2 by 2 identical matrix and a 2 by 4 zero matrix thus the necessary condition of collision at time t is presented as 8 p i t p j t c o n f p c o n f p is the adjacent safety region surrounding the target ship if the ship is represented as a circle the confp is a set of positions that lead to the overlap of two circles i e an enlarged circle as shown in the upper panel of fig 7 if the ship is formulated as an ellipse the confp would shape as an enlarged ellipse as shown in the lower panel of fig 7 in this article the circular shaped ship is accepted and circular confp is used equation 8 is the condition of a collision which means the os violates the safety region of the ts by solving equation 8 a sub set of changes of the desired velocity leading to a collision at time t is collected i e 9 δ u i c g t 1 c x i t p j t c o n f p suo t then the changes in the desired velocity leading to a collision are the union of subsets i e 10 uo t suo t 4 4 under actuated ship with a pd controller there are two possible choices to handle the changes from full actuated dynamics to under actuated dynamics the first choice is releasing the constraint on sway direction and asking the ship to track the desired surge speed u and desired heading ψ thus u consists of surge speed and heading since this system is stable the sway speed will converge to 0 with time goes infinite that implies the following settings 11 u u ψ 12 g x v x 0 0 0 1 0 0 0 0 1 0 0 0 x 13 g x v x substitute equation 11 13 back to equations 5 10 then the uo set of u leading to a collision is collected the second choice sets u as a combination of resultant speed u and course χ i e we have 14 u u χ 15 g x u 2 v 2 ψ atan v u 16 g x 0 0 0 u u 2 v 2 v u 2 v 2 0 0 0 1 v u 2 v 2 u u 2 v 2 0 x v x substitute 14 16 back to 4 6 10 then the resultant speeds and courses leading to a collision are collected in the uo sets 4 5 optimization for auto mode the auto mode of the hmi cas neglects the regulations the task of finding rule compliant actions is assigned to human operators who are experts in understanding rules the hmi cas only offers an optimal solution to human operators regarding cost function defined in equation 19 the rules for finding a new desired velocity in hmi cas is changed as follows and they are presented in order of priority prior to that some symbols are explained reference velocity is noted as r the origin of the space is noted as o that represents the desired velocity in the last control loop u 0 and u is the optimal desired velocity in this control loop rule 1 if δ r r u 0 uo the os is expected to choose r i e u r rule 2 if o uo the os prefers to continue with its initial desired velocity u u 0 rule 3 a new u is close to its current velocity satisfying δ u u u 0 uo when the reference velocity and the initial desired velocity are both unsafe finding a new solution is necessary i e rule 3 is activated this problem can be modeled as a non convex optimization problem since the solution space ℝ 2 uo ij is non convex the final control input for ship i not only needs to fall in ℝ 2 uo ij but also satisfy the kinematic constraints i e u u min u max and ψ ψ max ψ max noted as u i b o u n d thus the feasible space for ship i to prevent collision with ship j is u i j f e a uo ij u i b o u n d an illustration has been shown in fig 8 1 obviously u i j f e a is non convex and an approximation of feasible space is necessary i approximation of feasible space firstly a convex hull is employed to approximate the intersection of uo ij and u i b o u n d noted as ch uo ij u i b o u n d see fig 8 2 secondly the closest point on the boundary of ch uo ij u i b o u n d to the initial desired velocity u 0 is found which is w 17 w argmin u ch uo ij u i b o u n d u u 0 where refers to the boundary of a set in alonso mora et al 2018 the authors reported when the target velocity is on the boundary of the vo set two vehicles will approach each other infinitely close thus in this system a repulsive term w ˆ is adopted with w w w w w ˆ and w ˆ 0 02 as shown in fig 8 3 lastly u i j f e a is approximated via a linear constraint that is formulated as 18 u i j f e a u u w w u 0 0 if u 0 ch uo ij u i b o u n d u u w w u 0 0 otherwise in return the feasible space becomes convex see fig 8 3 ii formulation of the optimization problem based on the approximated feasible space the collision problem can be formulated as a quadratic problem 19 minimize j u o u i u i u i 0 t a u 0 0 a ψ u i u i 0 subject to u i j i u i j f e a and u i u i b o u n d the matrix diagonal matrix is introduced to reflect the experience in ship navigation that course turning is more popular in collision avoidance at sea i e a u a ψ 4 6 case studies in this section a two ship scenario is simulated to demonstrate the proposed hmi cas in different modes i e auto mode section 5 2 1 and manual mode section 5 2 2 moreover to show the performance of the hmi cas in multiple ships section 5 2 3 is presented where the ships are all installed the hmi cas and performing in auto mode 4 7 setups in simulations cybership ii is chosen as a basic ship model the scale factor of the ship is 1 70 the length of the ship in the real world is 87 85 m the safety distance of the ship in the real world is set as 0 2 nm which is 4 times of the ship length without a special explanation all the parameters in simulations are in the real world to obtain the parameters in the scaled world the froude scaling law is used read more in the appendix in paper huang et al 2019 the feedback gains of ships are kp diag 100 200 10 and kd diag 5 5 5 for fully actuated ship and kp diag 100 10 and kd diag 5 5 for under actuated ship the course turning has priority for ship avoiding collisions thus a u 81 and a ψ 1 the confp is approximated by its circumscribed polygon i e a 24 side polygon the simulator is designed on matlab r2018b both the two ship encounter and multi ship encounter are considered in the two ship encounter scenario the ship under control is named as own ship os the os is located at the origin of the coordination i e 0 0 and sails to the north with 10 knots the encountering ship labeled no 2 is the target ship ts the ts sails to the southwest with a speed of 10 knot in this scenario the ts is sail with a constant speed and course since the ts is the stand on ship according to colregs in the multiple encounter scenario the ship located at the origin is the os and other ships are placed around the os the layout of these ships are shown in fig 12 1 4 8 two ship scenarios setting of two ship encounter scenario using the hmi cas in this scenario the os is controlled by hmi cas while human operators just monitor the ship to see the difference due to different dynamics and different tracking modes three groups of experiments are designed standard group sg employs the fully actuated ship which uses the same setting in huang et al 2019 control group 1 cg1 uses the under actuated ship and tracks the surge speed and heading while the sway speed is uncontrollable control group 2 cg2 also uses the same under actuated ship in cg1 but tracks the resultant speed and course instead of surge speed and heading the layout of the encounter and the initial uo space of the os in these three groups are presented in panel 2 4 in fig 9 in these panels the horizontal axis indicates changes on the desired heading and the vertical axis shows the changes on the desired speed the negative directions refer to the port side turning and deceleration while the positive directions indicate the starboard side turning and acceleration in each panel the red region represents the desired velocity leading to a collision with one obstacle i e ship no 2 while the blank region is collision free the red asterisk in these panels shows the optimal solution that hmi cas found which suggest port side turnings the control space then is presented to human operators via the interface in section 3 and the operators can gain the following information services 1 ship no 2 is dangerous for the os since the existing velocity is inside of the red region generated by ship no 2 2 it is necessary to take actions since the existing velocity is inside of the red region 3 the desired velocity inside of the reg region is dangerous while arbitrary velocity out of the red region is safe 4 the red asterisk in the control space is the suggested optimal solution by hmi cas and without intervention from human operators this solution will be executed by the system auto mode 5 when the operator disagrees with the suggested solution the operator can choose another solution from the blank region and feedback it to the system manual mode 6 when the operator shows the velocity inside the red region an alarm is triggered for reminding the operators that the chosen velocity is unsafe two ship encounter scenario using the auto mode of the hmi cas since the collision free control space is non convex a linearization of the feasible control space is needed the result of the optimization indicates that the port side turn is optimal i e the machine suggests port side turns to avoid the collision subsequently the os is increasing its heading for sg and cg1 or its course for cg2 to prevent the collision the behaviors of the ship in succeeding time are recorded in fig 10 in fig 10 panel a shows the trajectories of the ships and panel b is their relative distance over time the lines in red represent the result from sg the lines in green refer to cg1 and those in red are from cg2 for panel c h the upper panels show the surge speed sway speed resultant speed and the desired speed the lower panels show the course heading and the desired heading or course from the relative distance over time it is observed that all these groups can support the ship to avoid collision successfully however the process of collision avoidance is different in sg the os is fully actuated and the sway speed is tracked to be 0 m s thus the trajectory of the os the line in black is nearly straight with curvature when the ship is turning see panel a however the trajectories of the os in cg1 and cg2 are more smooth which are consists of curves in cg1 the ship gives up the sway speed and tracks the desired surge speed and heading therefore from panel e and f it is observed that the sway speed exceeds 3 knots which is 30 of the full surge speed moreover since the sway speed also influences the heading of the ship the overshooting of the heading is also observed panel g and h show that the states of the ship in cg2 in which the ship tracks the resultant speed and course which perform better than cg1 specifically the sway speed is not exceeding 2 knots and the overshooting of course is also not obvious moreover the cg2 has fewer oscillations read more in section 6 3 4 8 1 two ship encounter scenario using the manual mode of the hmi cas in the auto mode the hmi cas can support the ship to avoid collisions while the evasive action might violate the colreg rules then a manual mode is activated to prevent violations in the two ship encounter scenario the os is the give way ship and the ts is the stand on ship and the give way ship in this encounter scenario is not allowed to take port side turns for this simple scenario it is possible to add an additional rule to prevent the port side turn in the auto mode however for more complicated encounter scenarios it is challenging since the regulations do not enumerate all rule compliant actions the interpretations of regulations and the judgments of the encounter situation are all depending on the experience of navigators which might differ from one to another to avoid rule violations in the complicated encounters the hmi cas can be turned to the manual mode the manual mode presents the solution space as in the auto mode while human operators enable to interact with the system specifically they can assign a new collision free solution that is out of uo sets to the system in this way human knowledge is introduced into the decision making process especially in the understanding of rules fig 11 demonstrates this mode in three groups presented in section 5 2 1 i e sg cg1 and cg2 in these systems the human operators intervene in the initial choice of the system and monitor the collision avoidance process in each group panel a presents the trajectories and panel b provides the relative distance panel c and d show the recorded states of the ship in sg panel e and f present the states of the ship in cg1 panel g and h display the ship s states in cg2 when the starboard solution is the input from the human operators the ship would not return to the port side turn in the next time step since the port side solution is no longer optimal similar to the results presented in fig 10 the sg with the fully actuated dynamic has the best performance when the ship is underactuated cg2 has less oscillation and overshooting the lower panels in the third and the last column 4 9 multiple ship scenario in this section all the ships have installed hmi cass and switched them to auto mode moreover to reduce the oscillation the pd controller will track the course and resultant speed this simulation is used to demonstrate the performance of hmi cas in multiple encounter scenarios when the ship is under actuated the ships are cooperative and find a collision free solution according to their order specifically the no 1 ship would find its collision free solution first and share its predicted trajectory with other ships the no 2 ship then finds its solution based on the updated trajectory of the no 1 ship and other ships trajectory this process repeats for the succeeding ships these settings give the back ships higher priorities than the front ships in an extreme case the front ships have found collision free solutions and the last ship does not need to change its course and speed the layout of the encounter scenario is presented in the first panel in fig 12 all the ships head to a common point 0 1 5 nm with speed 10 knots thus 0 15 h later all ships would collide at the common point if no evasive actions are taken fig 12 shows the vision from the no 1 ship at the beginning where the panel 1 is the layout 2 is the uo sets in control space 3 shows relative distance solid lines and the predicted relative distance dotted lines 4 speeds and desired speeds 5 course and desired course and 6 1 nm around the no 1 ship showing course heading and trajectories since the origin of the panel 2 is in the uo sets which implies the desired initial velocity and the reference velocity are both unsafe the ship determines to find a new collision free solution i e rule 3 is activated from the panel it is observed that the collision free area the area in the blank is non convex thus the approximation of the collision free space in section 4 4 is introduced through an optimization process an optimal collision free solution is found which is reducing the resultant speed by 5 knots and turns to the starboard side right hand side this strategy basically asks the ship to postpone the collision with the no 4 ship fig 13 shows the encounter scenario after 16 s the no 1 ship detects that the initial desired velocity is too close to the uo set which might result in the collision with the no 4 ship thus the ship activates the hmi cas to find a new collision free solution in 2 panel a new solution is found the new solution basically requires the ship to keep its resultant speed but to increase its starboard turning by 13 that means the course of the ship changes from 86 to 73 fig 14 shows the vision from the no 1 ship at the end of the simulator from the relative distance over time panel 3 it is observed that all the relative distances are larger than the safety distance it means that the ship avoids collisions safely panel 4 and 5 show the recorded speeds and courses over time 5 discussion in this section the performance and the feature of the hmi cas are discussed followed by the limitations found during simulations and the relevant solutions 5 1 a portable connecting human knowledge and automation via hmi cas as shown in section 5 2 1 the automatic system might offer a solution that is violating rules or not encouraged by navigators to prevent this kind of behavior human operators are in charge of monitoring the system the traditional collision avoidance methods do not offer the portable that facilitates human operators to join the collision avoidance process firstly some solutions of cas are unfriendly for human operators to read and understand e g a series of forces at different moments secondly some solutions offer one collision free solution with no information for human operators to modify and judge the solution e g one optimal trajectory subsequently if the operators do not satisfy the solution suggested by machines they have to analyze the encounter situation again find a new solution and validate their new solution by their experience the proposed hmi cas in contrast offers the portable that allows the cooperation between human operators and the automatic systems the human and the machine can both get benefit from the cooperation the hmi cas visualizes the solution space marking dangerous solutions that helps human operators in the following three aspects firstly the human operators then can judge the safety of the ship by checking the location of the existing velocity in the space secondly since the optimal solution by the system is also displayed in the solution space the operators can easily judge whether the solution is violating regulations or not see section 5 2 2 thirdly the operators can validate their new solution via the solution space if they do not agree with the suggested solution in brief the human operators are supported by the machine to read the solution to understand and to intervene in the automatic system the human operators on the other hand also support the automatic system firstly human operators help the automatic system to be rule compliant to date the rule compliant automatic system is still challenging in various automation specifically the interpretation of regulations depends on navigators experience and good seamanship that differ from one another using the proposed hmi cas the operators can use their own experience to judge the machines solution if the solution is violating rules or the good seamanship the operators then can modify the solution by inputting a new solution secondly operators help the automation to find a solution when there is no collision free solution by using auto mode the auto mode is based on the approximation of the feasible solution space see fig 8 when we use a half plane to represent the dangerous space some collision free solutions are inevitably excluded thus in an extreme situation it is possible that there are no solutions in auto mode while the human operators can easily identify a collision free solution out of uo sets in brief the development of the automatic system in mass is not completely excluding the human from the system but incorporating human s intelligence to contribute to a safer and smarter system 5 2 potential of the proposed hmi cas there are some potentials of the proposed hmi cas that also can be expected firstly it is possible to accept different cost functions in equation 19 the auto mode uses a quadratic cost function that minimizes the changes in controls it is also possible to incorporate a cost function minimizing the consumption of fuel oil secondly it also helps manned ships to cooperate with fully unmanned ships proposed in chen et al 2018 for manned ships how to cooperate with unmanned ships or vice versa is an unsolved problem the proposed system offers a possible for the manned ship to cooperate with the unmanned ship specifically the hmi cas helps human operators to communicate with unmanned ships and visualizes the solutions leading to a collision with unmanned ships thirdly the proposed hmi cas enables to suggest the time for applying the last maneuvers in literature huang and van gelder 2020 a time varying collision risk tcr measure is proposed which is measured as the room for maneuver the tcr level for the os is presented in fig 9 tcr reaches 1 means there are no collision free solutions found by the machine therefore the operators can postpone the suggested solution by the machine until the tcr reaches 1 after the tcr reaches 1 the cooperation between ships is necessary to prevent accidents 5 3 eliminating oscillation in the hmi cas according to the simulation results the underactuated ship may have oscillations during collision avoidance using hmi cas see figs 9 and 10 thus we conclude that the oscillation becomes larger when the ship is underactuated compared with cg2 it is observed that the oscillation is much severe when the ship cannot control the sway speed cg1 the oscillation behavior might be incompliant with the colregs and maritime practice thus it requires further studies to restrain the frequency of the oscillation in van den berg et al 2008 the oscillation behavior of the vehicle using the velocity obstacle algorithm has been reported where the oscillation is generated due to the incoordination between ships specifically two vehicles make the decision together and both assume that the other ship continues the existing speed however in this manuscript the cause of oscillation is different since the ships are coordinated and updated their behavior one be one the oscillation behavior appearing in this manuscript is mainly caused by the errors due to the successive linearization in equation 6 the errors due to linearization would cause the boundary of the uo set slightly different from it is presented in solution space therefore when the os detects the reference velocity is just out of uo sets it immediately changes its desired velocity to the reference velocity i e u r however when the ship steers to the desired velocity the linearized system is also updated the new uo set based on the updated linearized system might indicate the desired velocity is unsafe thus the ship steers back to the original collision free velocity to reduce the oscillations of under actuated ships it is recommended to accept the setting of cg2 that tracks the course and resultant speed instead of the heading and surge speed moreover in section 4 4 more measures are introduced to reduce oscillations for instance the uo set should be enlarged e g a larger repulsive term w ˆ is considered the ship is designed not to change its desired input frequently e g rule 2 and rule 3 are introduced these measures can reduce the oscillation but cannot prevent it another approach is including reachability analysis in the construction of uo sets specifically the upper bounds of the errors are estimated by reachability analysis and the uo sets are enlarged accordingly this idea would be discussed and considered in future studies 5 4 control authority transition between human mode to machine mode as we demonstrated in section 5 2 the control authority is switched to human operators when the machine detects inputs from human operators specifically when operators observe the possible violation of rules the operators can choose a new collision free solution out of uo set by input devices e g touch screen etc when operators do not input a new decision the auto mode would execute the solution automatically i e automatic collision avoidance the existing setting of control transition can be used in mass i iii while the human operators onboard or in the remote control centre should monitor the hmi cas all time which is similar to the l2 level of driving automation sae international 2016 to achieve a higher level of driving automation i e conditional automation l3 high automation l4 etc the studies on the transition of control authority should be added to the proposed hmi cas these studies include the timing of control transition the way of early alert and decision supports that help operators to build situation awareness as soon as possible the mixture of control during control transition etc some results from self driving cars can offer several clues while rigorous tests for the maritime environment are still needed since the working environment the background of drivers certificate of skill etc are so different 5 5 conclusions and future research in the transition to autonomous eras the demand for human machine interaction hmi is increasing however few existing collision avoidance systems cass can support the cooperation between human operators and the automatic system during collision avoidance in this article an cas that is interpretable and interactive for human operators is proposed which is called human machine interaction oriented collision avoidance system hmi cas the hmi cas presents its collision free decision and the solution space to human operators so that human operators can read the intentions of the machines understand collision free decision offered by the machine and intervene in the decision made making processes of the machines during collision avoidance the proposed system aims at helping human operators and machine to share their intelligence in solving collision avoidance problem i e hybrid intelligence combining the complementary strengths of human operators and machines by comparing existing collision avoidance algorithms a family of velocity obstacle algorithms has been found which firstly visualizes the solution space and then finds an optimal solution specifically to consider the under actuated dynamics of the ship a generalized velocity obstacle gvo algorithm has been applied to the proposed hmi cas system to handle the under actuated dynamics two modes of control are proposed control group 1 cg1 the ship only tracks heading and surge speed cg2 the ship tracks course and resultant speed to test and to demonstrate the performance of the hmi cas on board several simulations are introduced where the ship is assumed to be fully actuated standard group sg and under actuated cg1 and cg2 the results reveal that all these settings can support the ship to avoid collision automatically and support hmis moreover since the solution space is visualized it is convenient for human operators to detect rule violation behavior and to intervene in the automation during collision avoidance by comparing the collision avoidance process in sg cg1 and cg2 we also observed that the setting from cg1 would easily result in severe oscillations during collision avoidance which would be dangerous for the ship thus we recommend accepting cg2 settings for the hmi cas when the ship is under actuated with the proposed hmi cas the machine visualizes the solution space to human operators and makes the automation process transparent for human users which helps them read understand and intervene in the system on the other hand human operators can help the automatic system be rule compliant the potentials of the hmi cas include accept different cost functions helps manned ships to cooperate with fully unmanned ships suggest the time for applying the last maneuver further research considers the following directions 1 testing the hmi cas with different model ships in simulator environment and physical experiments 2 introducing the studies on reachability analysis for reducing the oscillation 3 investigating the characteristics of human machine interactions in the maritime environment 4 considering the dynamics of rudder servo systems and the irregular shapes of the ships 5 considering uncertainty of other ships behavior by identifying ship patterns e g the technique presented in huang et al 2020b credit authorship contribution statement yamin huang conceptualization methodology data curation writing original draft visualization writing review editing linying chen conceptualization methodology writing review editing investigation rudy r negenborn funding acquisition resources p h a j m van gelder resources project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research is supported by the fundamental research funds for the central universities in wuhan university of technology wut 203144001 203112003 and the researchlab autonomous shipping in delft university of technology abbreviations apf artificial potential field cass collision avoidance systems colregs convention on the international regulations for preventing collisions at sea confp conflict positions dd decision disc dw dynamic window fmm fast marching method gnc guidance navigation and control gvo generalized vo hmi human machine interaction hmi cas hmi oriented collision avoidance systems lcm limited cycle method mass maritime autonomous surface ships mpc ca model predictive control based cg control group collision avoidance os own ship pd proportional derivative poa projected obstacle area rk runge kutta sg standard group suo sub uo set tcr time varying collision risk ts target ship vc visual cone vo velocity obstacle notations a wight in cost function j uo g x observe function g t response function to the δ u j uo quadratic cost function k d p feedback gains n torque o the origin of the control space p position of ship r angular velocity yaw r reference velocity to the system suo t sub uo set at time t t thrust u surge speed u desired surge speed u desired velocity vector u desired resultant speed u the control space of the ship uo a set in control space u lead to collision v sway speed v velocity vector consists of u v and r v 2 by 6 matrix w closest point on the boundary to u 0 w ˆ a repulsive term adding to w x position in x axis x state vector of the ship y position in y axis τ input vector consists of thrust and torque χ desired course ψ heading of the ship ψ desired heading b ship body frame n inertial frame matrices 0 zero matrix a linearized system matric w r t state x at x 0 b linearized input matric w r t input u at u 0 b input matrix c output matrix c v coriolis centripetal matrix d v damping matrix i identity matrix m mass matrix consists of rigid body mass and added mass operators superscripts and subscripts ch an operator returning convex hull complement of the value set r an operators returning rotated vector derivative of the value an operator returning the boundary of a set estimation of the value δ difference between and u 0 i ship i related value 0 initial state f ship j related value optimal value min minimal value b o u n d boundary of the value max minimal value f e a feasible range of the value m n a m by n matrix human human determined value u v a value in surge heading direction 
21451,maritime autonomous surface ships mass attract increasing attention in recent years researchers aim at developing fully autonomous systems that replace the role of human operators studies either focus on supporting conflict collision detection for manned ships or solving conflict automatically for unmanned ships the cooperation between human and machine has been less focused on in existing studies however this type of cooperation is essential both in practice and in the future firstly demands on navigational assistance are still strong for supporting navigators in manned ships secondly mass with different autonomy levels require increasing cooperation between human operators and machines e g monitoring automation remotely controlling the ship etc thirdly the intelligence of human and the machines is highly complementary moreover fully autonomous ships cannot replace all the manual ships overnight therefore the future waterborne transport system will be a system in which both human operated vessels and autonomous vessels exist in this article we firstly provide an overview of existing modes of human machine interaction hmi during ship collision avoidance then we propose a framework of hmi oriented collision avoidance system hmi cas whose decision making process is interpretable and interactive for human operators the hmi cas facilitates automatic collision avoidance and enables the human operators to take over the control of the mass safely moreover the proposed framework acknowledges the under actuated feature of ships simulations are carried out to demonstrate the proposed hmi cas the results show that the proposed hmi cas can not only control the under actuated mass to avoid collision automatically but also share the decision making with human operators and support the operators to control the mass keywords human machine interaction collision avoidance system under actuated ship shared decision making mass 1 introduction 1 1 background maritime autonomous surface ships mass have been receiving numerous attention and discussions from the public and the academic which is expected to reduce human errors on board to improve navigational safety and to increase the efficiency of waterborne traffic systems hence various prototypes of mass have been proposed in recent years liu et al 2016 schiaretti et al 2017 the ultimate aim of relevant studies is at removing human operators in the control loop which is however still unrealistic teaching the automation to understand regulations is still challenging and the trust of the public on the autonomous ships is still questionable in fact the machines and the human are needless to be adversarial human intelligence and machine intelligence are complementary where the first one is good at interpreting navigational regulations and the second one has advantages of computing powers hhuang et al 2020a communication and cooperation between human and automation become important in the development of autonomous vehicles koopman and wagner 2017 in other words the interactions between the human and the machine in collision avoidance are essential for developing relevant automatic or even autonomous systems in various mass which were rarely discussed in existing research 1 2 motivation fig 1 demonstrates the system that integrates two loops without considering human machine interactions hmis one is with humans on board noted as the manual loop the other is without humans noted as the unmanned loop a switch is employed to change the control mode between two loops in the unmanned loop the guidance system is in charge of finding a collision free solution and the control system is designed to execute this solution e g desired forces trajectories etc since humans on board are not considered in this loop the outputs of the guidance system or the control system are usually difficult for humans to read to intervene and to implement for instance if the guidance system outputs the desired forces in each direction how to allocate these forces to steers is a question for human operators alternatively the system might offer a collision free trajectory or a set of steers that are readable for human but steering the ship to each waypoint or following each planned steer sticking to a planned schedule is also challenging for human operators if a human operator wants to intervene in the automatic collision avoidance process e g the automation will violate regulations etc the operator needs to switch to the manual loop then the operator has to analyze the encounters again find out possible collision free solutions and implement the solution by himself herself in this hybrid system the interaction between humans and machines is little and there is a lack of information exchange between them neither of the manned system nor the unmanned system in fig 1 is perfect if the existing manned system is reliable there would not be room for developing unmanned systems in many accidents the operators take evasive actions too late or no actions in urgent cases graziano et al 2016 besides the traditional navigation assistant systems lack the function of suggesting collision free solutions tam et al 2009 which is a strength of the unmanned system on the other hand the unmanned loop is also not perfect in particular how can the unmanned systems understand regulations is still an open question campbell et al 2012 where human knowledge is indispensable therefore a connection between these two loops could be a win win solution where a system incorporating hmis is needed however to the best of our knowledge studies on the manned ship or the unmanned ship do not incorporate the cooperation between human and machines in finding a collision free solution in manned ship studies the human is supported by the machines to detect dangers goerlandt et al 2015 while finding a collision free solution is in charge of human operators in unmanned ship studies the machine is supposed to be highly intelligent and there is no interface for operators to interact cooperate with the machine zheng 2016 that is the human operator or the machine works independently in finding a solution i e evasive decisions are either made by a human ożoga and montewka 2018 or a machine liu et al 2016 and the knowledge intelligence between the human and the machine is not shared 1 3 contributions as presented above limited studies focused on supporting the cooperation between humans and machines in conflict resolution for ships since the advantages of the human and the automatic systems are highly complementary the combination will not only help the automatic systems gain knowledge from the human supporting rule compliant actions in the unmanned ship but also help human on board take a correct operation in time in the manned ship in brief supporting hmis in decision making would combine the advantages of the human and the machine in preventing ship collisions which is a necessary step for developing various mass type i iii however few collision avoidance research considered hmis in decision making thus the main research question for this study is how can a collision avoidance system that combines the wisdom of human and intelligence of machines in collision avoidance be developed the main contributions of this article is as follows 1 we overview the hmis levels of the existing cas research and offer a clarification of hmis in mass with different autonomy levels 2 we propose a human machine interaction oriented collision avoidance system hmi cas incorporating hybrid intelligence that combines the complementary strengths of human operators and artificial agents 3 the proposed hmi cas visualizes the decision space of the machine and allows the human operators to intervene which makes the decision making process interpretable and interactive for human operators 4 we take the under actuated ship dynamics into consideration in the proposed hmi cas 1 4 outline the structure of this article is addressed as follows an overview of existing collision avoidance methods is presented in section 2 followed by the framework of the hmi cas incorporating under actuated ships has been shown in section 4 section 5 includes simulations to demonstrate the proposed hmi cas and section 6 discusses the main findings of this article conclusion and directions for future research are summarized in section 7 1 5 literature review on ship collision avoidance from existing collision avoidance systems cass two categorizes are observed one focuses on developing alert systems for reminding human operators to detect dangers while supporting the operator to find collision free solutions is not a focus the other one concentrates on developing the automatic system that avoids collisions automatically for mass while interacting with human operators are not considered to our best knowledge supporting hmis in conflict resolution is rarely addressed in the literature huang et al 2020a chen et al 1 6 hmis in conflict resolutions the interaction between human and machines in collision avoidance mainly refers to information exchanges to see how the existing cass support the interactions during conflicts we firstly categorized the forms of outputs of various cass and then categorize hmis according to the information flow between machine and human operators then the feature of existing collision avoidance algorithms regarding the categorized forms of interactions is clarified the information delivering to human include but not limited to 1 one collision free solution noted as u 2 one best solution that minimizes the utility function noted as u 3 a finite number of safe solutions noted as u 4 a closed region of collision free solutions noted as u 5 all closed regions of unsafe solutions noted as κ i u i human operators can conduct the following operations using the above information a switching to manual mode when human operators prefer to steer the ship by themselves or the solution found is not fully satisfied b accepting the solution c changing the solution by modifying the utility function when the operator does not satisfy the selected best solution by machine d picking up one solution in given finite solutions u when the machine does not pick up any solution to human operators or the chosen one is not satisfied the machine shows several solution candidates e picking up one solution in a given collision free set u when the machine does not pick up any solution to human operators or the chosen one is not satisfied the machine shows a set of feasible solutions f validating the safety of inputted solution when the machine does not pick up any solution or the chosen one is not satisfied the machine shows unsafe solutions illustrations of the solution forms and relevant services are shown in table 1 the solution space of the ships is presented and each point in this space represents one maneuver the black dot of type 1 in table 1 shows one type of information service that the machine delivers one feasible but not necessarily optimal collision free solution to human operators in type 2 the mark means the machine offers an optimal collision free solution in type 3 the dots are the optional collision free solutions that the machine can find in type 4 a sub space of solution space containing collision free solutions is colored in blue in type 5 instead of finding a collision free set the machine identifies all the solution sub spaces leading to the collision colored in grey in many cases the combinations of these information types are needed to achieve more hmi types 1 7 solution forms of existing algorithms in huang et al 2020a the algorithms for conflict resolution have been categorized into 5 groups with 14 representative algorithms in this section the representative algorithms regarding the demand of hmis addressed in section 2 1 are compared and shown in table 2 rule based methods usually offer one feasible solution to operators or mass controllers the feasible solution could be a course naeem et al 2012 a speed perera et al 2012 or a pattern enlarge rudder angle until it is collision free fang et al 2017 etc in these studies fuzzy logic based methods are popular perera et al 2012 wu et al 2020 nevertheless since the collision check is not inclusive some algorithms might not guarantee that the solution is collision free virtual vector methods offer a solution that might not be optimal but collision free the solution could be a collision free course by artificial potential field apf lyu and yin 2018 or a collision free trajectory generated by limited cycle method lcm mahini et al 2013 soltan et al 2010 discrete inputs group follows a common idea that firstly discretizes the control space and then finds the solution brute force search checks the solutions from the discrete control space and returns one collision free solution dynamic window dw serigstad 2017 and decision disc dd benjamin et al 2006 kuwata et al 2014 enable to offer alternative solutions and an optimal solution these algorithms search each feasible solution in solution space and the optimal solution is found in these solutions however since the control space is discretized these algorithms cannot offer a continuous solution space to users besides the dw implies stopping the ship is always a safe option and dd assumes the target ship sailing with constant speed and course which are not always the case at sea discrete inputs optimization and lattice based search contain an optimization finding one collision free solution thus they can directly offer an optimal solution to users continuous inputs methods search collision free solutions in a continuous space both visual cone vc and model predictive control based collision avoidance mpc ca can find one collision free solution while mpc ca could offer a solution to minimize a predefined cost function velocity obstacle vo algorithm firstly identify the unsafe region in solution space i e k and then find an optimal solution in the complimentary space i e k two representative algorithms of the re planning group are fast marching method fmm and projected obstacle area poa fmm firstly assigns a cost map and then finds an optimal path poa assigns a prohibit region around the predicted position of obstacle and finds one path to avoid the prohibited region from table 2 one can observe that different methods can provide different information and support relevant hmis it is worth noting that only vo algorithms can provide various types of information listed in section 2 1 i e 1 5 and then can support all types of hmis ãf 1 8 a generic framework of hmi cas as mentioned in section 1 and 2 hmi for mass with different autonomy levels requires different types of information thus to develop the cas supporting hmis the hmi cas needs to offer various forms of solutions i e one feasible solution one optimal solution several feasible solutions feasible ranges of solutions and dangerous solutions 1 9 focuses of hmi cas different from the hybrid system presented in fig 1 this manuscript aims at adding an interaction between the automatic system and human specifically between the guidance system and human operators the red arrows shown in fig 2 guidance system provides information to human and human sends commands to guidance system e g authorization intervention etc the cas and an interface are composing of the collision avoidance module in the guidance system the entire gnc system with the designed cas and interface is named as human machine interaction oriented collision avoidance system hmi cas to incarnate the connection between human operators and the guidance system an interface is introduced that supports information exchange an illustration of this idea is shown in fig 3 the blue arrow shows the information flow in the cas which delivers information to human operators the green arrows represent the inputted information by humans which feeds the human s decision backs to the machine and influences the behavior of the ship 1 10 a generic framework of hmi cas an abstract representation of hmi cas is shown in fig 4 the proposed hmi cas has two modes manual mode and autonomous mode when there is no human intervention the own ship follows the waypoints and automatically takes evasive actions i e autonomous mode the framework of this system based on the gnc system three basic systems are inclusive the guidance system the navigation system and the control system the navigation system contains sensors and transceivers that allow the ship to sense the surrounding environment and to exchange its state with other ships the obtained information is inputted to the guidance system the guidance system is performing as a brain that makes decisions according to obtained information moreover this electronic brain is allowed to interact with humans via the designed interface the control system contains a controller that implements the input solution from the guidance system and output relevant command to actuators i e propeller and rudder to support interaction between human operators and the gnc system an interface is added to the guidance system thus three main modules are included in the guidance system i e global planner local planner and interface the structure of each module is shown in fig 5 global planner generates a planned waypoint for the system which guides the ship to the destination noted as wp this waypoint is generated by path planning algorithms or input by human operators local planner generates a collision free solution considering the observed information planned waypoints and human s feedbacks etc noted as u interface has two main functions for one it presents information for human operators e g a set of solutions leading to collisions a set of collision free solutions and a selected solution to human operators for the other it collects orders from human and sends it back to local motion planner system the orders could be an alternative solution a command to stop continue the existing mode etc 2 global planner global planner contains a path planning module in which various deliberate algorithms can be used e g a liu et al 2019 theta kim et al 2014 dijkstra fast marching method liu and bucknall 2016 potential field xue et al 2009 etc an overview of these algorithms is shown in campbell et al 2012 the basis of these methods is a known roadmap some other algorithms need an inputted cost function that is minimized to find the path alternatively instead of using path planning algorithms human operators also can directly input a desired path given the input optimized path the global planner also needs to find out which waypoint is activated i e the waypoint that the ship is heading to 3 local planner local planner is the focus of the guidance system which is in charge of finding a collision free solution it consists of three key processes i e trajectory prediction conflict detection and conflict resolution the trajectory prediction outputs the trajectories of the os and the ts i e x i t and x j t based on these predicted outcomes the conflict detection calculates the relevant collision risk and triggers an alarm and conflict resolution if necessary lastly the conflict resolution finds a collision free solution according to input information from trajectory prediction conflict detection and feedbacks from a human the outputted information is delivered to the interface module and the control system if no command from the interface the optimal solution will be executed by the control system 4 interface interface is designed for the interactions between human operators and the machine which shows the supporting information for collision avoidance and collects feedback from human operators the information from the machine includes collision free solutions best solutions dangerous solutions etc since the input information from conflict resolution might not be directly readable for human operators we design a mapping sub module that presents the resolution space this map together with a solution selected by the machine is projected in the human machine interface the human operator can then read the map to understand the selected solution of the machine authorize the system to continue intervene in the system or find a new solution if necessary the information from human operators to the machine is the new solution they input in the interface noted as u human this new solution is sent back to the mapping sub module that translates the solution to the machine s language 4 1 requirements on hmi cas for achieving hmis although the manual mode is kept the function for the designed hmi cas is to show the decision process of the machine providing the opportunity for human to intervene in the decisions in this way the operator can build trust with this new system and then the operator does not need to stay onboard for directly controlling the ship the human operators then can intervene interact with the machine in offshore control centers in brief the hmi cas can be applied to mass with different autonomy levels where human is involving this system supports human in the following aspects 1 to identify who have conflicts with the own ship 2 to notice whether it is necessary to take actions 3 to show how does the cas system avoid the dangers 4 to be aware of what kind of operations are dangerous safe 5 to inform whether the chosen solution by the human is safe unsafe 6 to intervene in automated collision avoidance if necessary to meet these demands the interface in hmi cas needs to be user friendly in particular the interface facilitates the users to read the information to understand the collision free solutions selected by the machine and to intervene in the conflict resolution moreover this system needs to support various types of cooperation in conflict resolution thus the conflict resolution in the local planner module needs to offer various types of solutions for users for instance one collision free solution one best solution a set of safe unsafe solutions etc from the comparison in section 2 2 we find that the vo algorithm meets our demands firstly the vo algorithm presents a set of dangerous solutions i e k that allows the human operators to validate their solutions safe or not secondly the optimization in the complementary of k set is possible these features can satisfy the demand of human machine cooperation in the proposed hmi cas moreover the form of the solution of vo algorithms is friendly for human operators to read and to implement therefore in this article a family of vo algorithms is adopted for developing the proposed hmi cas when applying the vo algorithms in the maritime domain this family of algorithms has some limitations firstly the vo algorithm assumes the target ship sail with constant speed and course which is noted as semi dynamic ts secondly the dynamics of the ship are ignored in finding a collision free solution some modifications are made to overcome the limitations in huang et al 2018 researchers introduced a non linear vo algorithm and a probabilistic vo to deal with semi dynamic ts in huang et al 2019 the authors incorporate the ship dynamics by using the generalized vo gvo algorithm in which the ship is fully actuated in this article we employed the gvo algorithm to achieve the proposed hmi cas and consider under actuated ships that are more common in practice hmi cas considering under actuated ship dynamics 4 2 under actuated ship dynamics in general the ship is an under actuated vehicle with two types of control inputs i e thrust t and torque n the surge speed is controlled by thrust and the yaw is determined by torque while the sway speed is not directly influenced by control inputs a representation of such ship dynamics can be formulated as follows 1 i 3 3 0 3 3 0 3 3 m 3 3 x r ψ v c v v d v v b 6 2 τ where x is the system state containing coordinates x y heading angle ψ and v that consists of linear velocities u v and angular velocity r τ is inputs vector with thrust t and torque n m c v d v and r ψ are inertia matrix coriolis centripetal matrix damping matrix and rotation matrix respectively moreover b 6 2 0 2 3 1 0 0 0 0 1 t details refer to fossen 2002 illustration of the coordination system is presented in fig 6 moreover we add a pd controller as a high level controller and switch the control input from the force τ to the desired velocity u the pd controller is formulated as 2 τ k p u g x k d g x k p g x k d g x k p u where g x is an observed function kp and kd are feedback gains let formulate the observe function as 3 g x v and x g x v x then the new system with the pd controller uses the desired velocity as inputs i e u 4 i 0 0 m bk d v 1 r ψ t v t c v t v t d v t v t k p v x t i 0 0 m bk d v 1 bk p u t f x u 5 i 0 0 m bk d v 1 r ψ t v t c v t v t d v t v t k p v x t i 0 0 m bk d v 1 bk p u t f x u since equations 4 and 5 is non linear we can approximate the state of the ship with the help of runge kutta rk integration and taylor expansion law specifically we can formulate the position of the ship at time t via the changes of the desired velocity δ u u u 0 6 x t 0 t f x 0 u 0 d τ 0 t δ x τ d τ x t g t δ u where g t 0 t e a t τ b d τ with a f x and b f u and x is the estimated state of the ship calculated via rk method with a known initial state x 0 and a known initial input u 0 4 3 gvo algorithm considering under actuated dynamics given equation 6 the position of the ship at time t is formulated as 7 p i t c x i t c g t δ u i where c i 2 2 0 2 4 contains a 2 by 2 identical matrix and a 2 by 4 zero matrix thus the necessary condition of collision at time t is presented as 8 p i t p j t c o n f p c o n f p is the adjacent safety region surrounding the target ship if the ship is represented as a circle the confp is a set of positions that lead to the overlap of two circles i e an enlarged circle as shown in the upper panel of fig 7 if the ship is formulated as an ellipse the confp would shape as an enlarged ellipse as shown in the lower panel of fig 7 in this article the circular shaped ship is accepted and circular confp is used equation 8 is the condition of a collision which means the os violates the safety region of the ts by solving equation 8 a sub set of changes of the desired velocity leading to a collision at time t is collected i e 9 δ u i c g t 1 c x i t p j t c o n f p suo t then the changes in the desired velocity leading to a collision are the union of subsets i e 10 uo t suo t 4 4 under actuated ship with a pd controller there are two possible choices to handle the changes from full actuated dynamics to under actuated dynamics the first choice is releasing the constraint on sway direction and asking the ship to track the desired surge speed u and desired heading ψ thus u consists of surge speed and heading since this system is stable the sway speed will converge to 0 with time goes infinite that implies the following settings 11 u u ψ 12 g x v x 0 0 0 1 0 0 0 0 1 0 0 0 x 13 g x v x substitute equation 11 13 back to equations 5 10 then the uo set of u leading to a collision is collected the second choice sets u as a combination of resultant speed u and course χ i e we have 14 u u χ 15 g x u 2 v 2 ψ atan v u 16 g x 0 0 0 u u 2 v 2 v u 2 v 2 0 0 0 1 v u 2 v 2 u u 2 v 2 0 x v x substitute 14 16 back to 4 6 10 then the resultant speeds and courses leading to a collision are collected in the uo sets 4 5 optimization for auto mode the auto mode of the hmi cas neglects the regulations the task of finding rule compliant actions is assigned to human operators who are experts in understanding rules the hmi cas only offers an optimal solution to human operators regarding cost function defined in equation 19 the rules for finding a new desired velocity in hmi cas is changed as follows and they are presented in order of priority prior to that some symbols are explained reference velocity is noted as r the origin of the space is noted as o that represents the desired velocity in the last control loop u 0 and u is the optimal desired velocity in this control loop rule 1 if δ r r u 0 uo the os is expected to choose r i e u r rule 2 if o uo the os prefers to continue with its initial desired velocity u u 0 rule 3 a new u is close to its current velocity satisfying δ u u u 0 uo when the reference velocity and the initial desired velocity are both unsafe finding a new solution is necessary i e rule 3 is activated this problem can be modeled as a non convex optimization problem since the solution space ℝ 2 uo ij is non convex the final control input for ship i not only needs to fall in ℝ 2 uo ij but also satisfy the kinematic constraints i e u u min u max and ψ ψ max ψ max noted as u i b o u n d thus the feasible space for ship i to prevent collision with ship j is u i j f e a uo ij u i b o u n d an illustration has been shown in fig 8 1 obviously u i j f e a is non convex and an approximation of feasible space is necessary i approximation of feasible space firstly a convex hull is employed to approximate the intersection of uo ij and u i b o u n d noted as ch uo ij u i b o u n d see fig 8 2 secondly the closest point on the boundary of ch uo ij u i b o u n d to the initial desired velocity u 0 is found which is w 17 w argmin u ch uo ij u i b o u n d u u 0 where refers to the boundary of a set in alonso mora et al 2018 the authors reported when the target velocity is on the boundary of the vo set two vehicles will approach each other infinitely close thus in this system a repulsive term w ˆ is adopted with w w w w w ˆ and w ˆ 0 02 as shown in fig 8 3 lastly u i j f e a is approximated via a linear constraint that is formulated as 18 u i j f e a u u w w u 0 0 if u 0 ch uo ij u i b o u n d u u w w u 0 0 otherwise in return the feasible space becomes convex see fig 8 3 ii formulation of the optimization problem based on the approximated feasible space the collision problem can be formulated as a quadratic problem 19 minimize j u o u i u i u i 0 t a u 0 0 a ψ u i u i 0 subject to u i j i u i j f e a and u i u i b o u n d the matrix diagonal matrix is introduced to reflect the experience in ship navigation that course turning is more popular in collision avoidance at sea i e a u a ψ 4 6 case studies in this section a two ship scenario is simulated to demonstrate the proposed hmi cas in different modes i e auto mode section 5 2 1 and manual mode section 5 2 2 moreover to show the performance of the hmi cas in multiple ships section 5 2 3 is presented where the ships are all installed the hmi cas and performing in auto mode 4 7 setups in simulations cybership ii is chosen as a basic ship model the scale factor of the ship is 1 70 the length of the ship in the real world is 87 85 m the safety distance of the ship in the real world is set as 0 2 nm which is 4 times of the ship length without a special explanation all the parameters in simulations are in the real world to obtain the parameters in the scaled world the froude scaling law is used read more in the appendix in paper huang et al 2019 the feedback gains of ships are kp diag 100 200 10 and kd diag 5 5 5 for fully actuated ship and kp diag 100 10 and kd diag 5 5 for under actuated ship the course turning has priority for ship avoiding collisions thus a u 81 and a ψ 1 the confp is approximated by its circumscribed polygon i e a 24 side polygon the simulator is designed on matlab r2018b both the two ship encounter and multi ship encounter are considered in the two ship encounter scenario the ship under control is named as own ship os the os is located at the origin of the coordination i e 0 0 and sails to the north with 10 knots the encountering ship labeled no 2 is the target ship ts the ts sails to the southwest with a speed of 10 knot in this scenario the ts is sail with a constant speed and course since the ts is the stand on ship according to colregs in the multiple encounter scenario the ship located at the origin is the os and other ships are placed around the os the layout of these ships are shown in fig 12 1 4 8 two ship scenarios setting of two ship encounter scenario using the hmi cas in this scenario the os is controlled by hmi cas while human operators just monitor the ship to see the difference due to different dynamics and different tracking modes three groups of experiments are designed standard group sg employs the fully actuated ship which uses the same setting in huang et al 2019 control group 1 cg1 uses the under actuated ship and tracks the surge speed and heading while the sway speed is uncontrollable control group 2 cg2 also uses the same under actuated ship in cg1 but tracks the resultant speed and course instead of surge speed and heading the layout of the encounter and the initial uo space of the os in these three groups are presented in panel 2 4 in fig 9 in these panels the horizontal axis indicates changes on the desired heading and the vertical axis shows the changes on the desired speed the negative directions refer to the port side turning and deceleration while the positive directions indicate the starboard side turning and acceleration in each panel the red region represents the desired velocity leading to a collision with one obstacle i e ship no 2 while the blank region is collision free the red asterisk in these panels shows the optimal solution that hmi cas found which suggest port side turnings the control space then is presented to human operators via the interface in section 3 and the operators can gain the following information services 1 ship no 2 is dangerous for the os since the existing velocity is inside of the red region generated by ship no 2 2 it is necessary to take actions since the existing velocity is inside of the red region 3 the desired velocity inside of the reg region is dangerous while arbitrary velocity out of the red region is safe 4 the red asterisk in the control space is the suggested optimal solution by hmi cas and without intervention from human operators this solution will be executed by the system auto mode 5 when the operator disagrees with the suggested solution the operator can choose another solution from the blank region and feedback it to the system manual mode 6 when the operator shows the velocity inside the red region an alarm is triggered for reminding the operators that the chosen velocity is unsafe two ship encounter scenario using the auto mode of the hmi cas since the collision free control space is non convex a linearization of the feasible control space is needed the result of the optimization indicates that the port side turn is optimal i e the machine suggests port side turns to avoid the collision subsequently the os is increasing its heading for sg and cg1 or its course for cg2 to prevent the collision the behaviors of the ship in succeeding time are recorded in fig 10 in fig 10 panel a shows the trajectories of the ships and panel b is their relative distance over time the lines in red represent the result from sg the lines in green refer to cg1 and those in red are from cg2 for panel c h the upper panels show the surge speed sway speed resultant speed and the desired speed the lower panels show the course heading and the desired heading or course from the relative distance over time it is observed that all these groups can support the ship to avoid collision successfully however the process of collision avoidance is different in sg the os is fully actuated and the sway speed is tracked to be 0 m s thus the trajectory of the os the line in black is nearly straight with curvature when the ship is turning see panel a however the trajectories of the os in cg1 and cg2 are more smooth which are consists of curves in cg1 the ship gives up the sway speed and tracks the desired surge speed and heading therefore from panel e and f it is observed that the sway speed exceeds 3 knots which is 30 of the full surge speed moreover since the sway speed also influences the heading of the ship the overshooting of the heading is also observed panel g and h show that the states of the ship in cg2 in which the ship tracks the resultant speed and course which perform better than cg1 specifically the sway speed is not exceeding 2 knots and the overshooting of course is also not obvious moreover the cg2 has fewer oscillations read more in section 6 3 4 8 1 two ship encounter scenario using the manual mode of the hmi cas in the auto mode the hmi cas can support the ship to avoid collisions while the evasive action might violate the colreg rules then a manual mode is activated to prevent violations in the two ship encounter scenario the os is the give way ship and the ts is the stand on ship and the give way ship in this encounter scenario is not allowed to take port side turns for this simple scenario it is possible to add an additional rule to prevent the port side turn in the auto mode however for more complicated encounter scenarios it is challenging since the regulations do not enumerate all rule compliant actions the interpretations of regulations and the judgments of the encounter situation are all depending on the experience of navigators which might differ from one to another to avoid rule violations in the complicated encounters the hmi cas can be turned to the manual mode the manual mode presents the solution space as in the auto mode while human operators enable to interact with the system specifically they can assign a new collision free solution that is out of uo sets to the system in this way human knowledge is introduced into the decision making process especially in the understanding of rules fig 11 demonstrates this mode in three groups presented in section 5 2 1 i e sg cg1 and cg2 in these systems the human operators intervene in the initial choice of the system and monitor the collision avoidance process in each group panel a presents the trajectories and panel b provides the relative distance panel c and d show the recorded states of the ship in sg panel e and f present the states of the ship in cg1 panel g and h display the ship s states in cg2 when the starboard solution is the input from the human operators the ship would not return to the port side turn in the next time step since the port side solution is no longer optimal similar to the results presented in fig 10 the sg with the fully actuated dynamic has the best performance when the ship is underactuated cg2 has less oscillation and overshooting the lower panels in the third and the last column 4 9 multiple ship scenario in this section all the ships have installed hmi cass and switched them to auto mode moreover to reduce the oscillation the pd controller will track the course and resultant speed this simulation is used to demonstrate the performance of hmi cas in multiple encounter scenarios when the ship is under actuated the ships are cooperative and find a collision free solution according to their order specifically the no 1 ship would find its collision free solution first and share its predicted trajectory with other ships the no 2 ship then finds its solution based on the updated trajectory of the no 1 ship and other ships trajectory this process repeats for the succeeding ships these settings give the back ships higher priorities than the front ships in an extreme case the front ships have found collision free solutions and the last ship does not need to change its course and speed the layout of the encounter scenario is presented in the first panel in fig 12 all the ships head to a common point 0 1 5 nm with speed 10 knots thus 0 15 h later all ships would collide at the common point if no evasive actions are taken fig 12 shows the vision from the no 1 ship at the beginning where the panel 1 is the layout 2 is the uo sets in control space 3 shows relative distance solid lines and the predicted relative distance dotted lines 4 speeds and desired speeds 5 course and desired course and 6 1 nm around the no 1 ship showing course heading and trajectories since the origin of the panel 2 is in the uo sets which implies the desired initial velocity and the reference velocity are both unsafe the ship determines to find a new collision free solution i e rule 3 is activated from the panel it is observed that the collision free area the area in the blank is non convex thus the approximation of the collision free space in section 4 4 is introduced through an optimization process an optimal collision free solution is found which is reducing the resultant speed by 5 knots and turns to the starboard side right hand side this strategy basically asks the ship to postpone the collision with the no 4 ship fig 13 shows the encounter scenario after 16 s the no 1 ship detects that the initial desired velocity is too close to the uo set which might result in the collision with the no 4 ship thus the ship activates the hmi cas to find a new collision free solution in 2 panel a new solution is found the new solution basically requires the ship to keep its resultant speed but to increase its starboard turning by 13 that means the course of the ship changes from 86 to 73 fig 14 shows the vision from the no 1 ship at the end of the simulator from the relative distance over time panel 3 it is observed that all the relative distances are larger than the safety distance it means that the ship avoids collisions safely panel 4 and 5 show the recorded speeds and courses over time 5 discussion in this section the performance and the feature of the hmi cas are discussed followed by the limitations found during simulations and the relevant solutions 5 1 a portable connecting human knowledge and automation via hmi cas as shown in section 5 2 1 the automatic system might offer a solution that is violating rules or not encouraged by navigators to prevent this kind of behavior human operators are in charge of monitoring the system the traditional collision avoidance methods do not offer the portable that facilitates human operators to join the collision avoidance process firstly some solutions of cas are unfriendly for human operators to read and understand e g a series of forces at different moments secondly some solutions offer one collision free solution with no information for human operators to modify and judge the solution e g one optimal trajectory subsequently if the operators do not satisfy the solution suggested by machines they have to analyze the encounter situation again find a new solution and validate their new solution by their experience the proposed hmi cas in contrast offers the portable that allows the cooperation between human operators and the automatic systems the human and the machine can both get benefit from the cooperation the hmi cas visualizes the solution space marking dangerous solutions that helps human operators in the following three aspects firstly the human operators then can judge the safety of the ship by checking the location of the existing velocity in the space secondly since the optimal solution by the system is also displayed in the solution space the operators can easily judge whether the solution is violating regulations or not see section 5 2 2 thirdly the operators can validate their new solution via the solution space if they do not agree with the suggested solution in brief the human operators are supported by the machine to read the solution to understand and to intervene in the automatic system the human operators on the other hand also support the automatic system firstly human operators help the automatic system to be rule compliant to date the rule compliant automatic system is still challenging in various automation specifically the interpretation of regulations depends on navigators experience and good seamanship that differ from one another using the proposed hmi cas the operators can use their own experience to judge the machines solution if the solution is violating rules or the good seamanship the operators then can modify the solution by inputting a new solution secondly operators help the automation to find a solution when there is no collision free solution by using auto mode the auto mode is based on the approximation of the feasible solution space see fig 8 when we use a half plane to represent the dangerous space some collision free solutions are inevitably excluded thus in an extreme situation it is possible that there are no solutions in auto mode while the human operators can easily identify a collision free solution out of uo sets in brief the development of the automatic system in mass is not completely excluding the human from the system but incorporating human s intelligence to contribute to a safer and smarter system 5 2 potential of the proposed hmi cas there are some potentials of the proposed hmi cas that also can be expected firstly it is possible to accept different cost functions in equation 19 the auto mode uses a quadratic cost function that minimizes the changes in controls it is also possible to incorporate a cost function minimizing the consumption of fuel oil secondly it also helps manned ships to cooperate with fully unmanned ships proposed in chen et al 2018 for manned ships how to cooperate with unmanned ships or vice versa is an unsolved problem the proposed system offers a possible for the manned ship to cooperate with the unmanned ship specifically the hmi cas helps human operators to communicate with unmanned ships and visualizes the solutions leading to a collision with unmanned ships thirdly the proposed hmi cas enables to suggest the time for applying the last maneuvers in literature huang and van gelder 2020 a time varying collision risk tcr measure is proposed which is measured as the room for maneuver the tcr level for the os is presented in fig 9 tcr reaches 1 means there are no collision free solutions found by the machine therefore the operators can postpone the suggested solution by the machine until the tcr reaches 1 after the tcr reaches 1 the cooperation between ships is necessary to prevent accidents 5 3 eliminating oscillation in the hmi cas according to the simulation results the underactuated ship may have oscillations during collision avoidance using hmi cas see figs 9 and 10 thus we conclude that the oscillation becomes larger when the ship is underactuated compared with cg2 it is observed that the oscillation is much severe when the ship cannot control the sway speed cg1 the oscillation behavior might be incompliant with the colregs and maritime practice thus it requires further studies to restrain the frequency of the oscillation in van den berg et al 2008 the oscillation behavior of the vehicle using the velocity obstacle algorithm has been reported where the oscillation is generated due to the incoordination between ships specifically two vehicles make the decision together and both assume that the other ship continues the existing speed however in this manuscript the cause of oscillation is different since the ships are coordinated and updated their behavior one be one the oscillation behavior appearing in this manuscript is mainly caused by the errors due to the successive linearization in equation 6 the errors due to linearization would cause the boundary of the uo set slightly different from it is presented in solution space therefore when the os detects the reference velocity is just out of uo sets it immediately changes its desired velocity to the reference velocity i e u r however when the ship steers to the desired velocity the linearized system is also updated the new uo set based on the updated linearized system might indicate the desired velocity is unsafe thus the ship steers back to the original collision free velocity to reduce the oscillations of under actuated ships it is recommended to accept the setting of cg2 that tracks the course and resultant speed instead of the heading and surge speed moreover in section 4 4 more measures are introduced to reduce oscillations for instance the uo set should be enlarged e g a larger repulsive term w ˆ is considered the ship is designed not to change its desired input frequently e g rule 2 and rule 3 are introduced these measures can reduce the oscillation but cannot prevent it another approach is including reachability analysis in the construction of uo sets specifically the upper bounds of the errors are estimated by reachability analysis and the uo sets are enlarged accordingly this idea would be discussed and considered in future studies 5 4 control authority transition between human mode to machine mode as we demonstrated in section 5 2 the control authority is switched to human operators when the machine detects inputs from human operators specifically when operators observe the possible violation of rules the operators can choose a new collision free solution out of uo set by input devices e g touch screen etc when operators do not input a new decision the auto mode would execute the solution automatically i e automatic collision avoidance the existing setting of control transition can be used in mass i iii while the human operators onboard or in the remote control centre should monitor the hmi cas all time which is similar to the l2 level of driving automation sae international 2016 to achieve a higher level of driving automation i e conditional automation l3 high automation l4 etc the studies on the transition of control authority should be added to the proposed hmi cas these studies include the timing of control transition the way of early alert and decision supports that help operators to build situation awareness as soon as possible the mixture of control during control transition etc some results from self driving cars can offer several clues while rigorous tests for the maritime environment are still needed since the working environment the background of drivers certificate of skill etc are so different 5 5 conclusions and future research in the transition to autonomous eras the demand for human machine interaction hmi is increasing however few existing collision avoidance systems cass can support the cooperation between human operators and the automatic system during collision avoidance in this article an cas that is interpretable and interactive for human operators is proposed which is called human machine interaction oriented collision avoidance system hmi cas the hmi cas presents its collision free decision and the solution space to human operators so that human operators can read the intentions of the machines understand collision free decision offered by the machine and intervene in the decision made making processes of the machines during collision avoidance the proposed system aims at helping human operators and machine to share their intelligence in solving collision avoidance problem i e hybrid intelligence combining the complementary strengths of human operators and machines by comparing existing collision avoidance algorithms a family of velocity obstacle algorithms has been found which firstly visualizes the solution space and then finds an optimal solution specifically to consider the under actuated dynamics of the ship a generalized velocity obstacle gvo algorithm has been applied to the proposed hmi cas system to handle the under actuated dynamics two modes of control are proposed control group 1 cg1 the ship only tracks heading and surge speed cg2 the ship tracks course and resultant speed to test and to demonstrate the performance of the hmi cas on board several simulations are introduced where the ship is assumed to be fully actuated standard group sg and under actuated cg1 and cg2 the results reveal that all these settings can support the ship to avoid collision automatically and support hmis moreover since the solution space is visualized it is convenient for human operators to detect rule violation behavior and to intervene in the automation during collision avoidance by comparing the collision avoidance process in sg cg1 and cg2 we also observed that the setting from cg1 would easily result in severe oscillations during collision avoidance which would be dangerous for the ship thus we recommend accepting cg2 settings for the hmi cas when the ship is under actuated with the proposed hmi cas the machine visualizes the solution space to human operators and makes the automation process transparent for human users which helps them read understand and intervene in the system on the other hand human operators can help the automatic system be rule compliant the potentials of the hmi cas include accept different cost functions helps manned ships to cooperate with fully unmanned ships suggest the time for applying the last maneuver further research considers the following directions 1 testing the hmi cas with different model ships in simulator environment and physical experiments 2 introducing the studies on reachability analysis for reducing the oscillation 3 investigating the characteristics of human machine interactions in the maritime environment 4 considering the dynamics of rudder servo systems and the irregular shapes of the ships 5 considering uncertainty of other ships behavior by identifying ship patterns e g the technique presented in huang et al 2020b credit authorship contribution statement yamin huang conceptualization methodology data curation writing original draft visualization writing review editing linying chen conceptualization methodology writing review editing investigation rudy r negenborn funding acquisition resources p h a j m van gelder resources project administration declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgement this research is supported by the fundamental research funds for the central universities in wuhan university of technology wut 203144001 203112003 and the researchlab autonomous shipping in delft university of technology abbreviations apf artificial potential field cass collision avoidance systems colregs convention on the international regulations for preventing collisions at sea confp conflict positions dd decision disc dw dynamic window fmm fast marching method gnc guidance navigation and control gvo generalized vo hmi human machine interaction hmi cas hmi oriented collision avoidance systems lcm limited cycle method mass maritime autonomous surface ships mpc ca model predictive control based cg control group collision avoidance os own ship pd proportional derivative poa projected obstacle area rk runge kutta sg standard group suo sub uo set tcr time varying collision risk ts target ship vc visual cone vo velocity obstacle notations a wight in cost function j uo g x observe function g t response function to the δ u j uo quadratic cost function k d p feedback gains n torque o the origin of the control space p position of ship r angular velocity yaw r reference velocity to the system suo t sub uo set at time t t thrust u surge speed u desired surge speed u desired velocity vector u desired resultant speed u the control space of the ship uo a set in control space u lead to collision v sway speed v velocity vector consists of u v and r v 2 by 6 matrix w closest point on the boundary to u 0 w ˆ a repulsive term adding to w x position in x axis x state vector of the ship y position in y axis τ input vector consists of thrust and torque χ desired course ψ heading of the ship ψ desired heading b ship body frame n inertial frame matrices 0 zero matrix a linearized system matric w r t state x at x 0 b linearized input matric w r t input u at u 0 b input matrix c output matrix c v coriolis centripetal matrix d v damping matrix i identity matrix m mass matrix consists of rigid body mass and added mass operators superscripts and subscripts ch an operator returning convex hull complement of the value set r an operators returning rotated vector derivative of the value an operator returning the boundary of a set estimation of the value δ difference between and u 0 i ship i related value 0 initial state f ship j related value optimal value min minimal value b o u n d boundary of the value max minimal value f e a feasible range of the value m n a m by n matrix human human determined value u v a value in surge heading direction 
21452,coastal bridges are vulnerable to extreme surges and waves during tsunamis and hurricanes many of them have been significantly damaged or destroyed during past extreme weather events such as hurricane katrina in 2005 although extensive experimental work and numerical simulations have been carried out focusing on identifying the damage mechanisms of coastal bridges impacted by extreme waves the coastal bridge deck needs to withstand the combined actions of waves and wind strong winds can easily deform the water surface and influence how waves impact the coastal bridge deck and the final resultant hydrodynamic load hence there is a strong need for investigating the hydrodynamic characteristics of coastal bridges under the joint action of wind and surge waves the direct effects of wind on the hydrodynamic load of a bridge deck under the impact of extreme surge waves had not been taken into account in past studies to fill this knowledge gap in this paper a high resolution numerical wave wind tank is established by solving the governing equations of two phase incompressible flow using the finite volume method the hydrodynamic load of coastal bridge deck under joint action of solitary wave and wind are numerically investigated by considering the effects of several prominent factors i e wind speed wave height submersion depth and water depth the results show that strong wind can greatly enhance the impacting intensity of solitary waves on bridge deck resulting in greater horizontal and vertical hydrodynamic loads it is believed that findings of this study can further enhance our understanding on damage mechanism of coastal bridge decks during hurricanes keywords wave wind interaction bridge deck simulation two phase flow solitary wave 1 introduction coastal bridges are vulnerable to extreme surge and waves generated during hurricanes large wind generated surface waves accompanied with an increasing in surge elevation can easily cause severe devastations to coastal regions around the world during extreme weather conditions i e katrina in 2005 ike in 2008 and sandy in 2012 the rise in water level brought by hurricanes allows extreme surges and waves to directly impact the superstructures of coastal bridges which can result in their damage and collapse padgett et al 2008 stearns and padgett 2012 this topic needs urgent attention in light of hurricanes generally becoming stronger and more frequent and the substantial increase in the number of category iv and v storms over the past 35 years nrdc 2015 since coastal bridges are important for coastal socioeconomic development and disaster relief past research extensively studied the damage mechanisms of coastal bridges exposed to extreme surge waves through experiments and numerical simulations such studies began as early as the 1960s when el ghamry 1963 and french 1969 analyzed the hydrodynamic load of bridge deck without girders under solitary waves based on two dimensional 2d flume experiments later denson 1978 1980 studied the hydrodynamic loads on a 1 24 scale bridge model when impacted by the joint action of waves and current studies of hydrodynamic impacts on bridge decks during storms became highly relevant in recent years driven by the urgent need in developing improving the resiliency of coastal regions following hurricane katrina in 2005 douglass et al 2006 reviewed the damaging mechanisms of coastal bridges under wave impact using experimental data and proposed a simple method to estimate the vertical and horizontal components of hydrodynamic load applied to the bridge deck few years later large scale three dimensional 3d experimental work was carried out by cuomo et al 2009 using a 1 10 scale bridge model to study the complicated interactions between regular waves and bridge deck based on these results the authors proposed an ad hoc prediction method for both quasi static and impulsive wave loads many additional experiments studying these interactions were carried out since kerenyi et al 2009 bradner et al 2011 seiffert et al 2014 2015 hayatdavoodi et al 2014 2015 besides experimental investigations various numerical models have been also applied to investigate the hydrodynamic characteristics of coastal bridges under different types of surface waves xu and cai 2015a wei and dalrymple 2016 xu et al 2016 2018 cai et al 2017 qu et al 2017 2020 sun et al 2020 bozorgnia 2012 numerically calculated the hydrodynamic loads of a bridge deck by solving the compressible euler equations xu and cai 2015b presented a numerical investigation of hydrodynamic load of solitary waves on the biloxi bay bridge decks with inclinations seiffert and his colleagues performed numerical studies on the impact processes of solitary waves seiffert et al 2014 2015 hayatdavoodi et al 2014 and cnoidal waves hayatdavoodi et al 2015 on a typical bridge deck effects of prominent factors i e wave height submergence depth and water depth on the hydrodynamic wave loadings of bridge deck were discussed in their works the hydrodynamic loads of a movable bridge deck under stokes wave and solitary wave have been numerically investigated by xu and cai 2015a and cai et al 2017 more recently huang et al 2018 2019a 2019b studied the hydrodynamic characteristics of a box girder bridge impacted by solitary and regular waves by applying a newly developed coupled modelling system fvcom sifum qu et al 2019b qu et al 2016 tang et al 2014 qu et al 2019a numerically investigated the hydrodynamic loads of a typical highway bridge deck under the impact of real world tsunami wave profile in a full scale destructive surge waves impacting coastal bridges are mostly observed during hurricanes with strong onshore winds hence in severe conditions found during hurricanes the coastal bridge deck has to withstand the complex joint actions of waves and wind and their interactions although hydrodynamic loads of bridge decks under combined action of wave and current had recently been investigated by huang et al 2018 and qu et al 2018 the joint impacting loads of wind and wave on coastal bridge deck had not yet been studied strong winds can easily deform the water surface and influence the waves impacts on coastal bridge decks and resultant hydrodynamic loads many experiments were conducted over the past few decades such as those focused on wind effects on the wave runup ward et al 1994 1996 and 1998 feddersen and veron 2005 wave breaking processes banner and phillips 1974 banner 1990 douglass 1990 and overtopping of coastal structures iwagaki et al 1966 medina 1998 these experiments found that low wind speeds have little effect on run up but higher wind speeds can greatly increase the run up heights of waves ward et al 1998 besides wave shoaling energy can greatly increase due to onshore winds and wave shapes can substantially change feddersen and veron 2005 as reported in the experiment work of douglass 1990 local wind can significantly influence the breaker location geometry and type of nearshore breaking waves onshore winds cause waves to break earlier and in deeper water further from shore and offshore winds cause waves to break later and in shallower water closer to shore iwagaki et al 1966 confirmed that wind can greatly enhance the rate of wave overtopping on vertical seawalls in addition to experiment work numerical simulations have been gradually carried out to study wind interactions with waves in recent years usually the wind effects can be modelled using jeffreys sheltering jeffreys 1925 1926 and miles shearing mechanism miles 1993 1996 by introducing a free surface pressure term or energy source dissipation terms at the free surface boundary as external forces however these mechanisms cannot take into account the dynamics of viscosity and turbulence of air and the effects of the waves on the air flow chen et al 2004 touboul et al 2006 kharif et al 2008 recently two phase models have been proved to be an effective research tool to study the wind effects on wave propagation yan and ma 2010 overtopping seawall li and he 2011 hieu et al 2014 and runup and breaking processes on sloped beach xie 2013 2014 which overcomes the drawbacks of numerical models using jeffreys sheltering jeffreys 1925 1926 and miles shearing mechanism miles 1993 1996 hence in present paper a two phase flow model has been applied to systematically study the hydrodynamic load of a coastal bridge deck under joint action of solitary wave and wind the remainder of the paper is organized as follows section 2 describes the governing equations and corresponding numerical methods model validation results are presented in section 3 hydrodynamic loads of bridge deck under joint action of solitary wave and wind are discussed in section 4 concluding remarks are presented in section 5 2 governing equations and numerical method the governing equations of the numerical model used in the study are the three dimensional continuity and navier stokes equations which can be expressed in the vector form as 1 u i t 0 2 ρ u i t ρ u j u i x j p x i x j μ eff u i x j u j x i ρ ρ ref g i where u is the flow velocity t is the time p is the pressure ρ is the density of air water mixture ρ r e f is the reference density μ eff μ l μ t is the effective viscosity including the laminar viscosity μ l and turbulence viscosity μ t and g i is the acceleration of gravity our model uses a reference density to eliminate the hydrostatic pressure accumulation in the gas phase region the actual pressure is p ˆ p ρ ref r i g i where r i is the vector that starts from the reference point to the locations where the actual pressure values are calculated to solve the governing equations 1 and 2 the non staggered finite volume method was implemented on unstructured mesh the velocity and pressure are coupled using pressure implicit split operator piso method proposed by issa 1986 the deferred correction proposed by fergizer and peric 2002 was applied to discretize the convective terms which combines the first order upwind scheme and the second order gamma scheme proposed by jasak 1996 following fergizer and peric 2002 the diffusion term was approximated as the central difference by using values at the auxiliary nodes which lie at the intersection of the cell face normal and straight lines connecting the node of the control volume and the neighboring nodes the pressure gradient term was treated the same way as the diffusion term in addition the gravity term could be included in a source term that was constant or could be computed implicitly the momentum interpolation method proposed by rhie and chow 1982 has been implemented to interpolate the velocities at the faces of the control cell for model stability an adaptive time step size was determined from gravity convective and viscous terms balcázar et al 2014 in this paper the turbulent viscosity μ t is determined by applying the classic wilcox s k ω turbulence model wilcox 1994 the governing equations of the kinetic energy k and the specific turbulent dissipation ω are read as 3 ρ k t ρ u j k x j x j μ l μ t σ k k x j 2 μ t s 2 ρ k ω 4 ρ ω t ρ u j ω x j x j μ l μ t σ ω ω x j 2 c μ c ω 1 ρ s 2 c ω 2 ρ ω 2 where c μ 0 09 c ω 1 5 9 c ω 2 5 6 and σ ω σ k 2 the term s 2 is constituted of the mean rate of the strain tensor 5 s 1 2 u j x i u i x j the interface between air and water is resolved by applying volume of fluid method vof the transportation equation of volume of fluid can be read as 6 γ t γ u i x i 0 where γ is the volume fraction of water in a cell and is defined by whether the control volume is filled by water or air as 7 γ 0 a i r 0 γ 1 i n t e r f a c e γ 1 w a t e r the local density and laminar viscosity as functions of γ can be calculated as 8 ρ ρ air γ ρ water ρ air 9 μ l μ air γ μ water μ air in this paper we used the volume of fluid method named switching technique for advection and capturing of surfaces stacs proposed by darwish and moukalled 2006 to resolve the free surface between water and air the method is designed to switch between different high resolution differencing schemes to yield a bounded volume of fluid filled according to the free surface orientation for more details regarding stacs method readers are referred to darwish and moukalled 2006 the computational layout of numerical wave tank is plotted in fig 1 where h is still water depth and h is the input wave height nonslip condition is applied at walls which include the channel bottom and deck surfaces a symmetry boundary condition is imposed on the top of the computational domain neumann conditions with zero gradients are used for pressure at the inlet outlet and walls the reference point is located at upper right corner of the computational domain when the wave enters the computational domain the lowest point of wind forcing has to change with the movement of the water surface at the inlet according to xie 2014 uniform wind speed is imposed 0 05 h above the water surface to avoiding wind induced distortion of wave profile at high speed wind in addition a damping zone is imposed at the outlet to dampen the vertical component of velocity to reduce water surface oscillations 3 model calibration 3 1 solitary wave in straight channel in this section the propagation of a solitary wave in a straight channel is numerically simulated with and without wind the predicted water surface elevation and velocity distributions along the water depth are compared with analytical solution for solitary wave without wind the entire computational domain is 50 m in length and 3 m in height the still water depth h is 1 0 m and input wave height h is 0 2 m 40 mesh layers are used to resolve the wave height the predicted water surface elevations are compared with analytical solutions at different time instances for solitary wave without wind fig 2 it is seen that the predictions are in good agreement with the analytical solutions to investigate the effects of wind on the propagation of solitary two different wave speed are selected u w 1c and 2c here c is shallow water wave speed which equals gh 3 1 m s comparisons of water surface elevation along the straight channel is plotted in fig 3 the presence of wind can cause solitary waves to propagate more quickly producing free surface oscillations in the leeward side of the solitary wave meanwhile the wave height of the solitary wave is reduced a little bit fig 4 depicts the comparisons of velocity distributions between prediction and analytical solution along water depth at windward side x 15 m and leeward side x 20 m of solitary wave it is observed that the predicted velocities along water depth are in good agreement with corresponding analytical solutions at both windward side and leeward side for solitary wave without wind in addition it is seen that horizontal velocity gradually increases with wind speed at the windward side along water depth fig 4a however this trend is not observed for the horizontal velocity at the leeward side of solitary wave due to the water surface oscillations fig 4b the wind seems to have limited influence on the variations of vertical velocity distribution as demonstrated above the computational capability of our numerical model in predicting solitary wave propagation and the effects of wind are well calibrated overall the solitary wave appears to propagate more quickly with wind present which may contribute to a greater impinging intensity at structures 3 2 solitary wave impacting bridge deck with girders to verify the computational capability of our numerical model in predicting the hydrodynamic loads solitary wave impinging a bridge deck with girders is numerically simulated in this section the predicted time series of water surface elevations and hydrodynamic loads are compared with corresponding measurements hayatdavoodi et al 2014 fig 5 plots the experimental layout in which a bridge deck with girders and three elevation sensors wg1 wg2 and wg3 are placed along the flume the deck with girders in the experiment is a 1 35 scale model of the bridge deck shown in fig 11 which is representative of a typical coastal bridge deck the deck s span length is 14 92 cm the bridge deck is 0 305 m in width and 1 27 cm in thickness in the computation the upper surface of the deck at 0 0172 m below the still water level the still water depth h is 0 086 m and wave height h is 0 0258 m the entire computational domain is 8 m in length and 0 228 m in height the deck is located 2 62 m downward from the inlet of the computational domain three group of meshes are generated to verify the sufficiency of mesh resolution the coarse mesh medium mesh and dense mesh consist of 43 576 110 760 and 447 504 mesh elements respectively with the finest grid spacing next to the wall of the deck being 0 001 m the total hydrodynamic load on the deck has been calculated from the integration of pressure and shear stress on its walls the predicted time series of hydrodynamic loads are compared with corresponding measurements as shown in fig 6 in the fig 6 f h and f v denote the load in the horizontal and vertical direction respectively as seen in fig 6 prediction and measurement for horizontal and vertical components of hydrodynamic load are in a reasonable agreement especially with regards to the peak values and corresponding temporal evolution the predicted time series of water elevation are also in good agreement with experimental measurements fig 7 however there is certain discrepancy between the prediction and measurement for water elevation fig 7c which could be attributed to the small thickness of the bridge deck model and complexity of the flow wave and their interactions with the bridge deck similar differences are also reported in hayatdavoodi et al 2014 and qu et al 2017 2018 2019b it is also observed that because results obtained with different mesh resolution are close to each other they can be considered mesh independent in addition the resolution of the finest mesh is believed to be sufficient and will be used for the following computations 3 3 breaking regular waves under steady wind since there are not experiment data available for hydrodynamic characteristics of solitary wave under onshore wind the evolution of breaking regular waves under onshore wind on a slope beach is numerically simulated the predicted time series of water surface elevation and horizontal and vertical velocities are compared with corresponding experiment data which was collected by jiang et al 2020 using a wind wave flume located in the hydraulics modeling laboratory of the changsha university of science and technology china the wave flume is 45 m long 0 8 m wide and 1 m deep the computational layout is plotted in fig 8 the spacing distance between wave piston to the toe of the slope beach of 1 10 is 13 25 m seven wave gauges wg are installed along the beach slope at x 0 0 6 1 2 1 8 2 4 3 1 and 3 6 m one velocity sensor is installed at x 0 45 and z 0 2 m the still water depth h is 0 4 m and incident wave height h is 0 07 m the onshore wind speed u w is 5 m s in the computation 50 mesh layers are used to resolve the wave height region to meet the mesh resolution requirement the predicted time series of water elevations at different wave gauges under steady wind are compared with corresponding measurements as shown in fig 9 it is seen that the predicted water elevations are in good agreement with experiment data for both the peak values and the temporal evolution it is also observed that our numerical model can accurately capture the whole breaking processes of the regular wave on the slope beach fig 10 plots the time series of horizontal and vertical velocities recorded at the velocity sensor overall the predicted velocities are in reasonable agreement with the measurements as demonstrated above the computational capability of our numerical model in predicting the hydrodynamic characteristics of waves under the effect of onshore wind is well verified 4 results and discussion the following sections investigate the hydrodynamic characteristics of coastal bridge deck under joint action of solitary wave and onshore wind effects of prominent factors i e wind speed u w wave height h submersion depth s and water depth h on the hydrodynamic loads of bridge deck are discussed as reported in qu et al 2018 most of the damage was observed as the hurricane approached the coastal region hence only the effects of onshore wind on the process of solitary wave impinging bridge deck is considered in this study as in qu et al 2017 2018 the submersion depth s is defined in such a way that s is measured from the bottom of bridge girders to the still water level a positive s means some portion of the deck girder is submerged in water a negative s means the bottom of the girders is located above the still water level the full scale of bridge deck model presented in section 3 2 but with girders are used in the rest of computation runs as shown in fig 11 the computational domain is 300 m in length and 25 m in height the bridge deck model is placed 120 m downward from the inlet of the computational domain a similar mesh resolution as the dense mesh presented in section 3 2 is implemented the total mesh elements used in the computations range from 399 580 to 401 400 in the following sections the predicted hydrodynamic loads velocity and time are normalized using 10 f v f v a h ρ gh 11 f h f h a v ρ gh 12 u u gh 13 p p ρ gh 14 t t g h where a h and a v are used to represent the width and front height of bridge deck respectively and a h 10 67 m and a v 1 77 m in addition a unit span length 1 m of the deck was used 4 1 hydrodynamic phenomena this section focusses on the hydrodynamic characteristics of coastal bridge deck under the combined impact of a solitary wave and onshore winds in the computation still water depth h is set as 6 m input wave height h is 1 8 m and wind speed u w is 4 c and c gh 30 7 m s hence the normalized wind speed u w u w c equals 4 in addition the submersion depth of the bridge deck s is set as 0 m fig 12 plots the snapshots of velocity contour at different time instances it is seen that as wave crest approaches the bridge site noticeable fluctuations in the water surface are observed due to the blowing effects of wind this was not observed for the solitary wave without wind fig 12a it is because that when the wind blows over the water surface due to the viscous effects near the interface between air and water a series of water surface waves of low amplitude and high frequency can be generated which finally result in the noticeable fluctuations in the water surface fig 12b when the wave crest impinges the bridge deck the wave impact is enhanced and a greater amount of overtopping water is seen for the solitary wave with wind fig 12b meanwhile a thin water layer with high speed is found near the surface of the waterbody which is mainly attributed to wind induced surface shear stress and form drag force from the imbalance of pressure ahead and behind the wave as overtopping water passes over bridge deck a large area with high flow speed is observed below the bridge deck and a portion of the chamber region is filled with water fig 12c as waves leave the bridge site vortices form at the tips of the bridge girders which are partially caused by the suction effects due to the sudden drop of water elevation below the deck fig 12d due to the existence of onshore wind flow structures of these vortices are greatly reshaped fig 13 plots the comparison of vector velocity distribution around the bridge deck under solitary waves with and without wind wind speed clearly impacts the flow speed near the air water interface but otherwise wind effects on the vector velocity distribution are very limited to further analyze the wind effects on solitary waves the vertical velocity distribution at 1 m downstream from the front side of bridge deck is plotted for t 24 29 fig 14 it clearly shows that blowing wind can increase the magnitudes of both horizontal and vertical velocities along water depth the pressure distribution is also greatly influenced by the blowing wind fig 15 as observed in fig 15 wind produces large vortex structures on the bridge deck surface and air flow with high speed induces a relative low pressure the combination of these can result in noticeable contribution to the lift force of the bridge deck time series of hydrodynamic loads of bridge deck under joint action of solitary wave and wind are plotted in fig 16 as seen in fig 16a the peak value of horizontal load of bridge deck under joint action of solitary wave and wind is slightly lower than that without wind however a greater slamming force is observed in the horizontal direction fig 16a because the blowing wind can increase the both horizontal velocity along water depth as shown in fig 14a since the presence of wind produces low pressure over the top of bridge deck and the unsteady air flow structures around bridge deck a positive vertical load is observed with some fluctuations fig 16b the peak value of vertical load of bridge deck under solitary wave and wind is larger than that without wind approximately increasing by 4 2 it is believed that an increasing in wind speed can further increase the vertical load because of an enhanced sucking effect of blowing wind over bridge deck due to blowing effects of wind higher water elevation is seen for the wave gauge installed at the front side of bridge deck fig 17 a meanwhile maximum water elevation recorded at the rear side of bridge deck under solitary wave and wind is slightly lower than that without wind fig 17b overall the results clearly showed that wind can have noticeable impacts on the propagation of solitary wave and its impacting intensity at bridge deck 4 2 effects of wind speed wave height submersion depth and water depth to investigate the effects of wind speed on the hydrodynamic characteristics of coastal bridge deck under the impact of solitary wave five different wind speeds are selected i e u w 0 2 3 4 5 and 6 which represent the onshore wind speed u w 0 15 3 23 1 30 7 38 4 and 46 0 m s respectively under the same still water depth condition h 6 m in the computation the wave height h is kept as 1 8 m and submersion depth is set as s 0 fig 18 depicts the snapshots of velocity contour of a solitary wave impinging the bridge deck at different time instances under different wind speed it is seen that when wind speed is lower than u w 2 effects of blowing wind are very limited the distributions of velocity contour are nearly identical for the solitary wave with and without wind fig 18a and b when u w 2 effects of wind on solitary wave impinging coastal bridge deck become apparent namely the intensified fluctuations of water surface reshaped velocity contour and increased overtopping water as shown in fig 18c d e and f fig 19 plots time series of hydrodynamic loads of bridge deck under different wind speeds and fig 20 plots the variation of maximum hydrodynamic loads with wind speed the figures clearly show that although the amplitude of force oscillations increases with wind speed the maximum horizontal loads on the bridge deck remain nearly the same figs 19a and 20a however the maximums of vertical loads of bridge deck monotonically increase with wind speed in a linear fashion similar force oscillations are also observed for the vertical loads figs 19b and 20b increases in the horizontal and vertical loads under different wind speeds range from 0 6 to 1 8 and 2 4 13 2 respectively showing significant influence of wind speed on the hydrodynamic loads of the bridge deck under the combined action of the solitary wave and wind variations of the hydrodynamic loads of the bridge deck with wave heights under constant wind speed are discussed by selecting four different wave height ratios i e h h 0 1 0 2 0 3 and 0 4 in the computations the still water depth h is kept as 6 m and wind speed is set as u w 4 it is found that when the height ratio is low h h 0 1 the amplitude of water surface oscillations due to blowing wind is approximately on the order of the input wave height fig 21 a as wave height increases h h 0 2 the impacts of winds become more apparent with as the wave profile increasingly deforms fig 21b the slamming force is dominant for horizontal load of bridge deck fig 22 a as wave height further increases the solitary wave with wind produces stronger wave impacts with more overtopping water fig 21c and d and the quasi static force becomes dominant for horizontal load of bridge deck fig 22a since an increase in wave height can result in a higher wave celerity waves will impact the bridge deck earlier with greater impacting intensity fig 22 fig 23 depicts the variations of maximum hydrodynamic loads of the bridge deck with wave height for solitary waves with and without wind it is seen that the maximum values of the horizontal and vertical loads increase monotonically with wave height with wind maximum values of horizontal loads are nearly same as that of solitary wave without wind except when h h 0 2 fig 23a nevertheless with wind solitary wave always produce greater vertical loads fig 23b increases in the horizontal and vertical loads under different wave height ratios range from 0 5 to 39 6 and 4 2 16 6 respectively as hurricanes approach the coastal region the water depth in the ocean bay increases in addition bridge decks may have different clearance heights along the coastal bridge spanning the bay hence bridge decks may possibly be fully or partially submerged in this section five different submersion depth s are selected i e s s av 1 2 0 1 2 1 and 3 2 to investigate the effects of submersion depth on the hydrodynamic characteristics of coastal bridge deck under the joint action of solitary wave and wind the still water depth h is kept as 6 m the input wave height and wind speed are set as h 1 8 m and u w 4 respectively fig 24 plots the snapshots of velocity contours of solitary wave impinging bridge deck at different time instances and submersion depths it is seen that strong wave slamming is observed when s 1 2 fig 24a due to the blocking effect of the bridge deck a relatively higher flow speed is found in the region between bridge girders and computational bottom in the case with wind meanwhile the magnitude of flow speed in this region significantly increases with submersion depth s fig 24b c d and e furthermore there is more overtopping water as s increases comparisons of hydrodynamic loads over time for the cases with and without wind and different submersion depths are plotted in fig 25 maximum values of hydrodynamic loads under different submersion depth are plotted in fig 26 when the bridge deck is elevated above the still water level s 1 2 a large slamming force peak is observed for the horizontal and vertical loads as submersion depth increases maximum horizontal loads increase until s 3 2 when s 3 2 maximum of horizontal load decreases little bit figs 25a and 26a when s 1 2 the maximum vertical loads gradually increase until s 3 2 fig 26b buoyancy forces contribute substantially to the vertical loads fig 25b when s 3 2 maximum of vertical load substantially decreases due to the very strong overtopping water and the weight of overtopping water balances some portion of vertical load when the bridge deck is fully submerged in water the effects of wind the on hydrodynamic characteristics of the bridge deck is very limited and can be ignored increases in the horizontal and vertical loads under different submersion depths range from 0 6 to 3 3 and 0 2 7 6 respectively effects of water depth on the hydrodynamic loads of a bridge deck under joint action of solitary wave and wind are discussed by selecting four different water depths i e h 5 6 7 and 8 m the wave height h is kept as 1 8 m the nondimensional wind speed is set as u w 4 which gives the wind speed u w 28 01 30 7 33 14 and 35 43 m s under water depth h 5 6 7 and 8 m respectively with wind a larger water area with higher is observed near the front of bridge deck and below bridge girders fig 27 fig 28 plots the time series of hydrodynamic loads of bridge deck under different water depth it is seen that the solitary wave impinges the bridge deck slightly earlier with increasing water depth the peak values of both horizontal and vertical components of hydrodynamic load applied to bridge deck decreases with water depth fig 25 differences in the horizontal component of hydrodynamic loads for solitary wave with and without wind are very limited fig 26a due to the blowing effect of wind maximum values of the vertical component of the hydrodynamic load on the bridge deck is always greater than that of solitary wave without wind overall increases in the horizontal load and vertical loads under different water depths range from 0 5 to 3 2 and 2 1 4 2 respectively see fig 29 5 conclusions in coastal environments coastal bridges may have to withstand extreme winds and waves i e during hurricanes and tsunamis the effects of ocean surface winds on the propagation of waves and their combined impacts and interactions with coastal bridges have been largely ignored in prior work this paper presents a first attempt to elucidate the hydrodynamic characteristics and damage mechanisms of coastal bridge deck under combined action of solitary waves and winds this is accomplished via a high resolution numerical wave wind tank set up which solves the governing equations of two phase incompressible flow based on the finite volume method effects of several prominent factors i e wind speed wave height submersion depth and water depth have been analyzed the major conclusions drawn from this paper can be summarized as follows 1 the presence of wind has significant impacts on the propagation of solitary waves and the intensity of their impacts at the bridge deck as wave crests approach the bridge noticeable fluctuations in the water surface are observed due to the blowing effects of wind strong blowing wind can produce a relatively lower pressure on the top of the bridge deck contributing to the vertical component of the hydrodynamic loads applied to the bridge deck 2 it is found that when wind speed is low u w 2 effects of blowing wind are very limited once u w 2 winds can have substantial effects intensified fluctuations of the water surface reshaped velocity contours and increasing amounts of overtopping water although maximum vertical hydrodynamic loads on the bridge deck were found to monotonically and linearly increase with wind speed maximum values of horizontal hydrodynamic loads remained approximately constant changes in the horizontal and vertical loads as function of wind speed ranged from 0 6 to 1 8 and 2 4 13 2 respectively demonstrating the substantial impacts that wind speed may have on the hydrodynamic loads applied to the bridge deck 3 when input wave heights are small i e h h 0 1 the amplitude of water surface oscillations due to blowing wind was observed to be on the same order as the input wave height as wave height increases to h h 0 2 the impacts of wind on the wave impinging become more apparent with an intensified deformed wave profile meanwhile the slamming force is dominant for horizontal load of bridge deck as wave height further increases h h 0 2 the solitary wave with wind produced greater wave impacts with more overtopping water and the quasi static force becomes dominant for the horizontal component of the hydrodynamic load applied to the bridge deck both maximums of the horizontal and vertical components of hydrodynamic load were found to increase monotonically with wave height increases in the horizontal and vertical components of hydrodynamic load under different wave height ratios ranged from 0 5 to 39 6 and 4 2 16 6 respectively 4 when the bridge deck is elevated above still water level s 1 2 a large slamming force peak is observed for both horizontal and vertical components of hydrodynamic load when the bridge deck is submerged fully into water the effects of wind on the hydrodynamic characteristics of bridge deck is very limited and can be ignored increases in the horizontal and vertical components of hydrodynamic load under different submersion depths range from 0 6 to 3 3 and 0 2 7 6 respectively 5 peak values of both horizontal and vertical components of hydrodynamic load applied to bridge deck decreased with water depth due to the blowing effect of wind the maximum vertical component of the hydrodynamic load under solitary waves with wind is always greater than that of the solitary wave without wind overall increases in the horizontal and vertical components of hydrodynamic load under different water depths ranged from 0 5 to 3 2 and 2 1 4 2 respectively it is believed that the findings made in this work can further enhance our understanding on the hydrodynamic characteristics of coastal bridges under joint impact of extreme surge wave and strong wind and can be instructive for future bridge designs to some extent credit authorship contribution statement k qu conceptualization methodology writing original draft funding acquisition b h wen validation formal analysis s kraatz writing review editing b deng writing review editing c b jiang supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is sponsored by the national natural science foundation of china 51809021 51839002 51879015 partial support comes from the hunan science and technology plan program 2019rs1049 natural science foundation of hunan province china 2020jj5582 and the research foundation of education bureau of hunan province china 19a024 special thanks go to the anonymous reviewers for their careful reading of the manuscript and valuable comments 
21452,coastal bridges are vulnerable to extreme surges and waves during tsunamis and hurricanes many of them have been significantly damaged or destroyed during past extreme weather events such as hurricane katrina in 2005 although extensive experimental work and numerical simulations have been carried out focusing on identifying the damage mechanisms of coastal bridges impacted by extreme waves the coastal bridge deck needs to withstand the combined actions of waves and wind strong winds can easily deform the water surface and influence how waves impact the coastal bridge deck and the final resultant hydrodynamic load hence there is a strong need for investigating the hydrodynamic characteristics of coastal bridges under the joint action of wind and surge waves the direct effects of wind on the hydrodynamic load of a bridge deck under the impact of extreme surge waves had not been taken into account in past studies to fill this knowledge gap in this paper a high resolution numerical wave wind tank is established by solving the governing equations of two phase incompressible flow using the finite volume method the hydrodynamic load of coastal bridge deck under joint action of solitary wave and wind are numerically investigated by considering the effects of several prominent factors i e wind speed wave height submersion depth and water depth the results show that strong wind can greatly enhance the impacting intensity of solitary waves on bridge deck resulting in greater horizontal and vertical hydrodynamic loads it is believed that findings of this study can further enhance our understanding on damage mechanism of coastal bridge decks during hurricanes keywords wave wind interaction bridge deck simulation two phase flow solitary wave 1 introduction coastal bridges are vulnerable to extreme surge and waves generated during hurricanes large wind generated surface waves accompanied with an increasing in surge elevation can easily cause severe devastations to coastal regions around the world during extreme weather conditions i e katrina in 2005 ike in 2008 and sandy in 2012 the rise in water level brought by hurricanes allows extreme surges and waves to directly impact the superstructures of coastal bridges which can result in their damage and collapse padgett et al 2008 stearns and padgett 2012 this topic needs urgent attention in light of hurricanes generally becoming stronger and more frequent and the substantial increase in the number of category iv and v storms over the past 35 years nrdc 2015 since coastal bridges are important for coastal socioeconomic development and disaster relief past research extensively studied the damage mechanisms of coastal bridges exposed to extreme surge waves through experiments and numerical simulations such studies began as early as the 1960s when el ghamry 1963 and french 1969 analyzed the hydrodynamic load of bridge deck without girders under solitary waves based on two dimensional 2d flume experiments later denson 1978 1980 studied the hydrodynamic loads on a 1 24 scale bridge model when impacted by the joint action of waves and current studies of hydrodynamic impacts on bridge decks during storms became highly relevant in recent years driven by the urgent need in developing improving the resiliency of coastal regions following hurricane katrina in 2005 douglass et al 2006 reviewed the damaging mechanisms of coastal bridges under wave impact using experimental data and proposed a simple method to estimate the vertical and horizontal components of hydrodynamic load applied to the bridge deck few years later large scale three dimensional 3d experimental work was carried out by cuomo et al 2009 using a 1 10 scale bridge model to study the complicated interactions between regular waves and bridge deck based on these results the authors proposed an ad hoc prediction method for both quasi static and impulsive wave loads many additional experiments studying these interactions were carried out since kerenyi et al 2009 bradner et al 2011 seiffert et al 2014 2015 hayatdavoodi et al 2014 2015 besides experimental investigations various numerical models have been also applied to investigate the hydrodynamic characteristics of coastal bridges under different types of surface waves xu and cai 2015a wei and dalrymple 2016 xu et al 2016 2018 cai et al 2017 qu et al 2017 2020 sun et al 2020 bozorgnia 2012 numerically calculated the hydrodynamic loads of a bridge deck by solving the compressible euler equations xu and cai 2015b presented a numerical investigation of hydrodynamic load of solitary waves on the biloxi bay bridge decks with inclinations seiffert and his colleagues performed numerical studies on the impact processes of solitary waves seiffert et al 2014 2015 hayatdavoodi et al 2014 and cnoidal waves hayatdavoodi et al 2015 on a typical bridge deck effects of prominent factors i e wave height submergence depth and water depth on the hydrodynamic wave loadings of bridge deck were discussed in their works the hydrodynamic loads of a movable bridge deck under stokes wave and solitary wave have been numerically investigated by xu and cai 2015a and cai et al 2017 more recently huang et al 2018 2019a 2019b studied the hydrodynamic characteristics of a box girder bridge impacted by solitary and regular waves by applying a newly developed coupled modelling system fvcom sifum qu et al 2019b qu et al 2016 tang et al 2014 qu et al 2019a numerically investigated the hydrodynamic loads of a typical highway bridge deck under the impact of real world tsunami wave profile in a full scale destructive surge waves impacting coastal bridges are mostly observed during hurricanes with strong onshore winds hence in severe conditions found during hurricanes the coastal bridge deck has to withstand the complex joint actions of waves and wind and their interactions although hydrodynamic loads of bridge decks under combined action of wave and current had recently been investigated by huang et al 2018 and qu et al 2018 the joint impacting loads of wind and wave on coastal bridge deck had not yet been studied strong winds can easily deform the water surface and influence the waves impacts on coastal bridge decks and resultant hydrodynamic loads many experiments were conducted over the past few decades such as those focused on wind effects on the wave runup ward et al 1994 1996 and 1998 feddersen and veron 2005 wave breaking processes banner and phillips 1974 banner 1990 douglass 1990 and overtopping of coastal structures iwagaki et al 1966 medina 1998 these experiments found that low wind speeds have little effect on run up but higher wind speeds can greatly increase the run up heights of waves ward et al 1998 besides wave shoaling energy can greatly increase due to onshore winds and wave shapes can substantially change feddersen and veron 2005 as reported in the experiment work of douglass 1990 local wind can significantly influence the breaker location geometry and type of nearshore breaking waves onshore winds cause waves to break earlier and in deeper water further from shore and offshore winds cause waves to break later and in shallower water closer to shore iwagaki et al 1966 confirmed that wind can greatly enhance the rate of wave overtopping on vertical seawalls in addition to experiment work numerical simulations have been gradually carried out to study wind interactions with waves in recent years usually the wind effects can be modelled using jeffreys sheltering jeffreys 1925 1926 and miles shearing mechanism miles 1993 1996 by introducing a free surface pressure term or energy source dissipation terms at the free surface boundary as external forces however these mechanisms cannot take into account the dynamics of viscosity and turbulence of air and the effects of the waves on the air flow chen et al 2004 touboul et al 2006 kharif et al 2008 recently two phase models have been proved to be an effective research tool to study the wind effects on wave propagation yan and ma 2010 overtopping seawall li and he 2011 hieu et al 2014 and runup and breaking processes on sloped beach xie 2013 2014 which overcomes the drawbacks of numerical models using jeffreys sheltering jeffreys 1925 1926 and miles shearing mechanism miles 1993 1996 hence in present paper a two phase flow model has been applied to systematically study the hydrodynamic load of a coastal bridge deck under joint action of solitary wave and wind the remainder of the paper is organized as follows section 2 describes the governing equations and corresponding numerical methods model validation results are presented in section 3 hydrodynamic loads of bridge deck under joint action of solitary wave and wind are discussed in section 4 concluding remarks are presented in section 5 2 governing equations and numerical method the governing equations of the numerical model used in the study are the three dimensional continuity and navier stokes equations which can be expressed in the vector form as 1 u i t 0 2 ρ u i t ρ u j u i x j p x i x j μ eff u i x j u j x i ρ ρ ref g i where u is the flow velocity t is the time p is the pressure ρ is the density of air water mixture ρ r e f is the reference density μ eff μ l μ t is the effective viscosity including the laminar viscosity μ l and turbulence viscosity μ t and g i is the acceleration of gravity our model uses a reference density to eliminate the hydrostatic pressure accumulation in the gas phase region the actual pressure is p ˆ p ρ ref r i g i where r i is the vector that starts from the reference point to the locations where the actual pressure values are calculated to solve the governing equations 1 and 2 the non staggered finite volume method was implemented on unstructured mesh the velocity and pressure are coupled using pressure implicit split operator piso method proposed by issa 1986 the deferred correction proposed by fergizer and peric 2002 was applied to discretize the convective terms which combines the first order upwind scheme and the second order gamma scheme proposed by jasak 1996 following fergizer and peric 2002 the diffusion term was approximated as the central difference by using values at the auxiliary nodes which lie at the intersection of the cell face normal and straight lines connecting the node of the control volume and the neighboring nodes the pressure gradient term was treated the same way as the diffusion term in addition the gravity term could be included in a source term that was constant or could be computed implicitly the momentum interpolation method proposed by rhie and chow 1982 has been implemented to interpolate the velocities at the faces of the control cell for model stability an adaptive time step size was determined from gravity convective and viscous terms balcázar et al 2014 in this paper the turbulent viscosity μ t is determined by applying the classic wilcox s k ω turbulence model wilcox 1994 the governing equations of the kinetic energy k and the specific turbulent dissipation ω are read as 3 ρ k t ρ u j k x j x j μ l μ t σ k k x j 2 μ t s 2 ρ k ω 4 ρ ω t ρ u j ω x j x j μ l μ t σ ω ω x j 2 c μ c ω 1 ρ s 2 c ω 2 ρ ω 2 where c μ 0 09 c ω 1 5 9 c ω 2 5 6 and σ ω σ k 2 the term s 2 is constituted of the mean rate of the strain tensor 5 s 1 2 u j x i u i x j the interface between air and water is resolved by applying volume of fluid method vof the transportation equation of volume of fluid can be read as 6 γ t γ u i x i 0 where γ is the volume fraction of water in a cell and is defined by whether the control volume is filled by water or air as 7 γ 0 a i r 0 γ 1 i n t e r f a c e γ 1 w a t e r the local density and laminar viscosity as functions of γ can be calculated as 8 ρ ρ air γ ρ water ρ air 9 μ l μ air γ μ water μ air in this paper we used the volume of fluid method named switching technique for advection and capturing of surfaces stacs proposed by darwish and moukalled 2006 to resolve the free surface between water and air the method is designed to switch between different high resolution differencing schemes to yield a bounded volume of fluid filled according to the free surface orientation for more details regarding stacs method readers are referred to darwish and moukalled 2006 the computational layout of numerical wave tank is plotted in fig 1 where h is still water depth and h is the input wave height nonslip condition is applied at walls which include the channel bottom and deck surfaces a symmetry boundary condition is imposed on the top of the computational domain neumann conditions with zero gradients are used for pressure at the inlet outlet and walls the reference point is located at upper right corner of the computational domain when the wave enters the computational domain the lowest point of wind forcing has to change with the movement of the water surface at the inlet according to xie 2014 uniform wind speed is imposed 0 05 h above the water surface to avoiding wind induced distortion of wave profile at high speed wind in addition a damping zone is imposed at the outlet to dampen the vertical component of velocity to reduce water surface oscillations 3 model calibration 3 1 solitary wave in straight channel in this section the propagation of a solitary wave in a straight channel is numerically simulated with and without wind the predicted water surface elevation and velocity distributions along the water depth are compared with analytical solution for solitary wave without wind the entire computational domain is 50 m in length and 3 m in height the still water depth h is 1 0 m and input wave height h is 0 2 m 40 mesh layers are used to resolve the wave height the predicted water surface elevations are compared with analytical solutions at different time instances for solitary wave without wind fig 2 it is seen that the predictions are in good agreement with the analytical solutions to investigate the effects of wind on the propagation of solitary two different wave speed are selected u w 1c and 2c here c is shallow water wave speed which equals gh 3 1 m s comparisons of water surface elevation along the straight channel is plotted in fig 3 the presence of wind can cause solitary waves to propagate more quickly producing free surface oscillations in the leeward side of the solitary wave meanwhile the wave height of the solitary wave is reduced a little bit fig 4 depicts the comparisons of velocity distributions between prediction and analytical solution along water depth at windward side x 15 m and leeward side x 20 m of solitary wave it is observed that the predicted velocities along water depth are in good agreement with corresponding analytical solutions at both windward side and leeward side for solitary wave without wind in addition it is seen that horizontal velocity gradually increases with wind speed at the windward side along water depth fig 4a however this trend is not observed for the horizontal velocity at the leeward side of solitary wave due to the water surface oscillations fig 4b the wind seems to have limited influence on the variations of vertical velocity distribution as demonstrated above the computational capability of our numerical model in predicting solitary wave propagation and the effects of wind are well calibrated overall the solitary wave appears to propagate more quickly with wind present which may contribute to a greater impinging intensity at structures 3 2 solitary wave impacting bridge deck with girders to verify the computational capability of our numerical model in predicting the hydrodynamic loads solitary wave impinging a bridge deck with girders is numerically simulated in this section the predicted time series of water surface elevations and hydrodynamic loads are compared with corresponding measurements hayatdavoodi et al 2014 fig 5 plots the experimental layout in which a bridge deck with girders and three elevation sensors wg1 wg2 and wg3 are placed along the flume the deck with girders in the experiment is a 1 35 scale model of the bridge deck shown in fig 11 which is representative of a typical coastal bridge deck the deck s span length is 14 92 cm the bridge deck is 0 305 m in width and 1 27 cm in thickness in the computation the upper surface of the deck at 0 0172 m below the still water level the still water depth h is 0 086 m and wave height h is 0 0258 m the entire computational domain is 8 m in length and 0 228 m in height the deck is located 2 62 m downward from the inlet of the computational domain three group of meshes are generated to verify the sufficiency of mesh resolution the coarse mesh medium mesh and dense mesh consist of 43 576 110 760 and 447 504 mesh elements respectively with the finest grid spacing next to the wall of the deck being 0 001 m the total hydrodynamic load on the deck has been calculated from the integration of pressure and shear stress on its walls the predicted time series of hydrodynamic loads are compared with corresponding measurements as shown in fig 6 in the fig 6 f h and f v denote the load in the horizontal and vertical direction respectively as seen in fig 6 prediction and measurement for horizontal and vertical components of hydrodynamic load are in a reasonable agreement especially with regards to the peak values and corresponding temporal evolution the predicted time series of water elevation are also in good agreement with experimental measurements fig 7 however there is certain discrepancy between the prediction and measurement for water elevation fig 7c which could be attributed to the small thickness of the bridge deck model and complexity of the flow wave and their interactions with the bridge deck similar differences are also reported in hayatdavoodi et al 2014 and qu et al 2017 2018 2019b it is also observed that because results obtained with different mesh resolution are close to each other they can be considered mesh independent in addition the resolution of the finest mesh is believed to be sufficient and will be used for the following computations 3 3 breaking regular waves under steady wind since there are not experiment data available for hydrodynamic characteristics of solitary wave under onshore wind the evolution of breaking regular waves under onshore wind on a slope beach is numerically simulated the predicted time series of water surface elevation and horizontal and vertical velocities are compared with corresponding experiment data which was collected by jiang et al 2020 using a wind wave flume located in the hydraulics modeling laboratory of the changsha university of science and technology china the wave flume is 45 m long 0 8 m wide and 1 m deep the computational layout is plotted in fig 8 the spacing distance between wave piston to the toe of the slope beach of 1 10 is 13 25 m seven wave gauges wg are installed along the beach slope at x 0 0 6 1 2 1 8 2 4 3 1 and 3 6 m one velocity sensor is installed at x 0 45 and z 0 2 m the still water depth h is 0 4 m and incident wave height h is 0 07 m the onshore wind speed u w is 5 m s in the computation 50 mesh layers are used to resolve the wave height region to meet the mesh resolution requirement the predicted time series of water elevations at different wave gauges under steady wind are compared with corresponding measurements as shown in fig 9 it is seen that the predicted water elevations are in good agreement with experiment data for both the peak values and the temporal evolution it is also observed that our numerical model can accurately capture the whole breaking processes of the regular wave on the slope beach fig 10 plots the time series of horizontal and vertical velocities recorded at the velocity sensor overall the predicted velocities are in reasonable agreement with the measurements as demonstrated above the computational capability of our numerical model in predicting the hydrodynamic characteristics of waves under the effect of onshore wind is well verified 4 results and discussion the following sections investigate the hydrodynamic characteristics of coastal bridge deck under joint action of solitary wave and onshore wind effects of prominent factors i e wind speed u w wave height h submersion depth s and water depth h on the hydrodynamic loads of bridge deck are discussed as reported in qu et al 2018 most of the damage was observed as the hurricane approached the coastal region hence only the effects of onshore wind on the process of solitary wave impinging bridge deck is considered in this study as in qu et al 2017 2018 the submersion depth s is defined in such a way that s is measured from the bottom of bridge girders to the still water level a positive s means some portion of the deck girder is submerged in water a negative s means the bottom of the girders is located above the still water level the full scale of bridge deck model presented in section 3 2 but with girders are used in the rest of computation runs as shown in fig 11 the computational domain is 300 m in length and 25 m in height the bridge deck model is placed 120 m downward from the inlet of the computational domain a similar mesh resolution as the dense mesh presented in section 3 2 is implemented the total mesh elements used in the computations range from 399 580 to 401 400 in the following sections the predicted hydrodynamic loads velocity and time are normalized using 10 f v f v a h ρ gh 11 f h f h a v ρ gh 12 u u gh 13 p p ρ gh 14 t t g h where a h and a v are used to represent the width and front height of bridge deck respectively and a h 10 67 m and a v 1 77 m in addition a unit span length 1 m of the deck was used 4 1 hydrodynamic phenomena this section focusses on the hydrodynamic characteristics of coastal bridge deck under the combined impact of a solitary wave and onshore winds in the computation still water depth h is set as 6 m input wave height h is 1 8 m and wind speed u w is 4 c and c gh 30 7 m s hence the normalized wind speed u w u w c equals 4 in addition the submersion depth of the bridge deck s is set as 0 m fig 12 plots the snapshots of velocity contour at different time instances it is seen that as wave crest approaches the bridge site noticeable fluctuations in the water surface are observed due to the blowing effects of wind this was not observed for the solitary wave without wind fig 12a it is because that when the wind blows over the water surface due to the viscous effects near the interface between air and water a series of water surface waves of low amplitude and high frequency can be generated which finally result in the noticeable fluctuations in the water surface fig 12b when the wave crest impinges the bridge deck the wave impact is enhanced and a greater amount of overtopping water is seen for the solitary wave with wind fig 12b meanwhile a thin water layer with high speed is found near the surface of the waterbody which is mainly attributed to wind induced surface shear stress and form drag force from the imbalance of pressure ahead and behind the wave as overtopping water passes over bridge deck a large area with high flow speed is observed below the bridge deck and a portion of the chamber region is filled with water fig 12c as waves leave the bridge site vortices form at the tips of the bridge girders which are partially caused by the suction effects due to the sudden drop of water elevation below the deck fig 12d due to the existence of onshore wind flow structures of these vortices are greatly reshaped fig 13 plots the comparison of vector velocity distribution around the bridge deck under solitary waves with and without wind wind speed clearly impacts the flow speed near the air water interface but otherwise wind effects on the vector velocity distribution are very limited to further analyze the wind effects on solitary waves the vertical velocity distribution at 1 m downstream from the front side of bridge deck is plotted for t 24 29 fig 14 it clearly shows that blowing wind can increase the magnitudes of both horizontal and vertical velocities along water depth the pressure distribution is also greatly influenced by the blowing wind fig 15 as observed in fig 15 wind produces large vortex structures on the bridge deck surface and air flow with high speed induces a relative low pressure the combination of these can result in noticeable contribution to the lift force of the bridge deck time series of hydrodynamic loads of bridge deck under joint action of solitary wave and wind are plotted in fig 16 as seen in fig 16a the peak value of horizontal load of bridge deck under joint action of solitary wave and wind is slightly lower than that without wind however a greater slamming force is observed in the horizontal direction fig 16a because the blowing wind can increase the both horizontal velocity along water depth as shown in fig 14a since the presence of wind produces low pressure over the top of bridge deck and the unsteady air flow structures around bridge deck a positive vertical load is observed with some fluctuations fig 16b the peak value of vertical load of bridge deck under solitary wave and wind is larger than that without wind approximately increasing by 4 2 it is believed that an increasing in wind speed can further increase the vertical load because of an enhanced sucking effect of blowing wind over bridge deck due to blowing effects of wind higher water elevation is seen for the wave gauge installed at the front side of bridge deck fig 17 a meanwhile maximum water elevation recorded at the rear side of bridge deck under solitary wave and wind is slightly lower than that without wind fig 17b overall the results clearly showed that wind can have noticeable impacts on the propagation of solitary wave and its impacting intensity at bridge deck 4 2 effects of wind speed wave height submersion depth and water depth to investigate the effects of wind speed on the hydrodynamic characteristics of coastal bridge deck under the impact of solitary wave five different wind speeds are selected i e u w 0 2 3 4 5 and 6 which represent the onshore wind speed u w 0 15 3 23 1 30 7 38 4 and 46 0 m s respectively under the same still water depth condition h 6 m in the computation the wave height h is kept as 1 8 m and submersion depth is set as s 0 fig 18 depicts the snapshots of velocity contour of a solitary wave impinging the bridge deck at different time instances under different wind speed it is seen that when wind speed is lower than u w 2 effects of blowing wind are very limited the distributions of velocity contour are nearly identical for the solitary wave with and without wind fig 18a and b when u w 2 effects of wind on solitary wave impinging coastal bridge deck become apparent namely the intensified fluctuations of water surface reshaped velocity contour and increased overtopping water as shown in fig 18c d e and f fig 19 plots time series of hydrodynamic loads of bridge deck under different wind speeds and fig 20 plots the variation of maximum hydrodynamic loads with wind speed the figures clearly show that although the amplitude of force oscillations increases with wind speed the maximum horizontal loads on the bridge deck remain nearly the same figs 19a and 20a however the maximums of vertical loads of bridge deck monotonically increase with wind speed in a linear fashion similar force oscillations are also observed for the vertical loads figs 19b and 20b increases in the horizontal and vertical loads under different wind speeds range from 0 6 to 1 8 and 2 4 13 2 respectively showing significant influence of wind speed on the hydrodynamic loads of the bridge deck under the combined action of the solitary wave and wind variations of the hydrodynamic loads of the bridge deck with wave heights under constant wind speed are discussed by selecting four different wave height ratios i e h h 0 1 0 2 0 3 and 0 4 in the computations the still water depth h is kept as 6 m and wind speed is set as u w 4 it is found that when the height ratio is low h h 0 1 the amplitude of water surface oscillations due to blowing wind is approximately on the order of the input wave height fig 21 a as wave height increases h h 0 2 the impacts of winds become more apparent with as the wave profile increasingly deforms fig 21b the slamming force is dominant for horizontal load of bridge deck fig 22 a as wave height further increases the solitary wave with wind produces stronger wave impacts with more overtopping water fig 21c and d and the quasi static force becomes dominant for horizontal load of bridge deck fig 22a since an increase in wave height can result in a higher wave celerity waves will impact the bridge deck earlier with greater impacting intensity fig 22 fig 23 depicts the variations of maximum hydrodynamic loads of the bridge deck with wave height for solitary waves with and without wind it is seen that the maximum values of the horizontal and vertical loads increase monotonically with wave height with wind maximum values of horizontal loads are nearly same as that of solitary wave without wind except when h h 0 2 fig 23a nevertheless with wind solitary wave always produce greater vertical loads fig 23b increases in the horizontal and vertical loads under different wave height ratios range from 0 5 to 39 6 and 4 2 16 6 respectively as hurricanes approach the coastal region the water depth in the ocean bay increases in addition bridge decks may have different clearance heights along the coastal bridge spanning the bay hence bridge decks may possibly be fully or partially submerged in this section five different submersion depth s are selected i e s s av 1 2 0 1 2 1 and 3 2 to investigate the effects of submersion depth on the hydrodynamic characteristics of coastal bridge deck under the joint action of solitary wave and wind the still water depth h is kept as 6 m the input wave height and wind speed are set as h 1 8 m and u w 4 respectively fig 24 plots the snapshots of velocity contours of solitary wave impinging bridge deck at different time instances and submersion depths it is seen that strong wave slamming is observed when s 1 2 fig 24a due to the blocking effect of the bridge deck a relatively higher flow speed is found in the region between bridge girders and computational bottom in the case with wind meanwhile the magnitude of flow speed in this region significantly increases with submersion depth s fig 24b c d and e furthermore there is more overtopping water as s increases comparisons of hydrodynamic loads over time for the cases with and without wind and different submersion depths are plotted in fig 25 maximum values of hydrodynamic loads under different submersion depth are plotted in fig 26 when the bridge deck is elevated above the still water level s 1 2 a large slamming force peak is observed for the horizontal and vertical loads as submersion depth increases maximum horizontal loads increase until s 3 2 when s 3 2 maximum of horizontal load decreases little bit figs 25a and 26a when s 1 2 the maximum vertical loads gradually increase until s 3 2 fig 26b buoyancy forces contribute substantially to the vertical loads fig 25b when s 3 2 maximum of vertical load substantially decreases due to the very strong overtopping water and the weight of overtopping water balances some portion of vertical load when the bridge deck is fully submerged in water the effects of wind the on hydrodynamic characteristics of the bridge deck is very limited and can be ignored increases in the horizontal and vertical loads under different submersion depths range from 0 6 to 3 3 and 0 2 7 6 respectively effects of water depth on the hydrodynamic loads of a bridge deck under joint action of solitary wave and wind are discussed by selecting four different water depths i e h 5 6 7 and 8 m the wave height h is kept as 1 8 m the nondimensional wind speed is set as u w 4 which gives the wind speed u w 28 01 30 7 33 14 and 35 43 m s under water depth h 5 6 7 and 8 m respectively with wind a larger water area with higher is observed near the front of bridge deck and below bridge girders fig 27 fig 28 plots the time series of hydrodynamic loads of bridge deck under different water depth it is seen that the solitary wave impinges the bridge deck slightly earlier with increasing water depth the peak values of both horizontal and vertical components of hydrodynamic load applied to bridge deck decreases with water depth fig 25 differences in the horizontal component of hydrodynamic loads for solitary wave with and without wind are very limited fig 26a due to the blowing effect of wind maximum values of the vertical component of the hydrodynamic load on the bridge deck is always greater than that of solitary wave without wind overall increases in the horizontal load and vertical loads under different water depths range from 0 5 to 3 2 and 2 1 4 2 respectively see fig 29 5 conclusions in coastal environments coastal bridges may have to withstand extreme winds and waves i e during hurricanes and tsunamis the effects of ocean surface winds on the propagation of waves and their combined impacts and interactions with coastal bridges have been largely ignored in prior work this paper presents a first attempt to elucidate the hydrodynamic characteristics and damage mechanisms of coastal bridge deck under combined action of solitary waves and winds this is accomplished via a high resolution numerical wave wind tank set up which solves the governing equations of two phase incompressible flow based on the finite volume method effects of several prominent factors i e wind speed wave height submersion depth and water depth have been analyzed the major conclusions drawn from this paper can be summarized as follows 1 the presence of wind has significant impacts on the propagation of solitary waves and the intensity of their impacts at the bridge deck as wave crests approach the bridge noticeable fluctuations in the water surface are observed due to the blowing effects of wind strong blowing wind can produce a relatively lower pressure on the top of the bridge deck contributing to the vertical component of the hydrodynamic loads applied to the bridge deck 2 it is found that when wind speed is low u w 2 effects of blowing wind are very limited once u w 2 winds can have substantial effects intensified fluctuations of the water surface reshaped velocity contours and increasing amounts of overtopping water although maximum vertical hydrodynamic loads on the bridge deck were found to monotonically and linearly increase with wind speed maximum values of horizontal hydrodynamic loads remained approximately constant changes in the horizontal and vertical loads as function of wind speed ranged from 0 6 to 1 8 and 2 4 13 2 respectively demonstrating the substantial impacts that wind speed may have on the hydrodynamic loads applied to the bridge deck 3 when input wave heights are small i e h h 0 1 the amplitude of water surface oscillations due to blowing wind was observed to be on the same order as the input wave height as wave height increases to h h 0 2 the impacts of wind on the wave impinging become more apparent with an intensified deformed wave profile meanwhile the slamming force is dominant for horizontal load of bridge deck as wave height further increases h h 0 2 the solitary wave with wind produced greater wave impacts with more overtopping water and the quasi static force becomes dominant for the horizontal component of the hydrodynamic load applied to the bridge deck both maximums of the horizontal and vertical components of hydrodynamic load were found to increase monotonically with wave height increases in the horizontal and vertical components of hydrodynamic load under different wave height ratios ranged from 0 5 to 39 6 and 4 2 16 6 respectively 4 when the bridge deck is elevated above still water level s 1 2 a large slamming force peak is observed for both horizontal and vertical components of hydrodynamic load when the bridge deck is submerged fully into water the effects of wind on the hydrodynamic characteristics of bridge deck is very limited and can be ignored increases in the horizontal and vertical components of hydrodynamic load under different submersion depths range from 0 6 to 3 3 and 0 2 7 6 respectively 5 peak values of both horizontal and vertical components of hydrodynamic load applied to bridge deck decreased with water depth due to the blowing effect of wind the maximum vertical component of the hydrodynamic load under solitary waves with wind is always greater than that of the solitary wave without wind overall increases in the horizontal and vertical components of hydrodynamic load under different water depths ranged from 0 5 to 3 2 and 2 1 4 2 respectively it is believed that the findings made in this work can further enhance our understanding on the hydrodynamic characteristics of coastal bridges under joint impact of extreme surge wave and strong wind and can be instructive for future bridge designs to some extent credit authorship contribution statement k qu conceptualization methodology writing original draft funding acquisition b h wen validation formal analysis s kraatz writing review editing b deng writing review editing c b jiang supervision funding acquisition declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements this work is sponsored by the national natural science foundation of china 51809021 51839002 51879015 partial support comes from the hunan science and technology plan program 2019rs1049 natural science foundation of hunan province china 2020jj5582 and the research foundation of education bureau of hunan province china 19a024 special thanks go to the anonymous reviewers for their careful reading of the manuscript and valuable comments 
21453,in the iacs harmonized common structural rules it is hoped that the fatigue damage to ship structures caused by springing can be rationally analysed in the case of limited resources in a basin it is impossible to carry out model tests of wave induced vibrations for many short term sea states based on wave load transfer function under regular waves a simplified method is established to evaluate the nonlinear springing and fatigue damage to ship structures under many different short term and long term sea states and is proposed by using wave loads of wave frequency and high frequency components the wave loading model tests of a 308 000 dwt vlcc very large crude container and a 205 000 dwt vlbc very large bulk carrier are carried out moreover the springing influence on structural fatigue is assessed in short term sea states by using stress data measured from model tests furthermore the springing influence on structural fatigue is studied in long term sea states for some typical sea routes it is concluded that the impact of springing is obvious on a vlcc and vlbc under ballast conditions and differs for various routes the simplified method can assess the fatigue damage due to springing properly keywords oil tanker bulk carrier springing fatigue model test nomenclature l pp length between the ship perpendiculars b breadth of the ship d depth of the ship at midship section i v vertical inertia of ship section a w amplitude of incident wave h w wave height of incident wave s w wave energy spectrum f wave frequency ω wave circular frequency ω e encountering wave circular frequency ω 2 node two node vibration frequency h s one third of significant wave height t z average zero crossing period m 5 vertical bending moment at midship j section modulus c stress concentration factor at hotspot t time ξ wave height time history of incident wave ε initial phase of incident wave ε l initial phase of low frequency component relative to incident wave ε h initial phase of high frequency component relative to incident wave m l amplitude of bending moment response of low frequency component m h amplitude of bending moment response of high frequency component r l wave load transfer function of low frequency component r h wave load transfer function of high frequency component n w total number of regular incident wave m slope constant of s n curve m slope constant of s n curve a material constant of s n curve a material constant of s n curve s alternating stress range n stress cycle times s q stress range at point q n q stress cycle times at point q 1 introduction because the natural frequency or eigenfrequencies of the two node vibration of a traditional hull ship is much higher than the exciting frequency of a wave load the wave induced vibration is not obvious with an increase in the main dimensions of ship structures and the wide application of high strength steel and large hull openings ship structures have become increasingly elastic in the marine environment and the phenomenon of fluid structure interaction has become increasingly obvious during a decrease in hull girder rigidity the two node vibration frequency of the ship hull will be located in the main frequency range of the external wave excitation load so there will be obvious wave induced vibration called springing phenomena storhaug et al 2003 park et al 2004 storhaug 2007 wu and moan 2007 iijima et al 2008 pedersen and jensen 2009 wang et al 2012 the fatigue damage caused by the wave induced vibration of a container ship in heading seas is studied by model testing and numerical calculation drummen et al 2008 the measurement results show that 40 of the total fatigue damage is caused by wave induced vibration but the numerical prediction is larger reaching 50 in recent years the iacs international association of classification societies has put forward the requirements for the influence of wave induced vibration on the fatigue life of hull structures in hcsr harmonized common structural rules it is hoped that the industrial circle can rationally analyse the cumulative fatigue damage of hull structures caused by wave induced vibration and provide a basis for scientific analysis iacs 2013 all major classification societies and relevant institutions around the world have participated in the academic discussion of relevant issues therefore it is urgent to study the influence of wave induced vibration on the fatigue life of structures in the field of full scale measurement a full scale measurement was carried out on an ore carrier with a perpendicular length of 281 m moe et al 2005 the test time lasted nearly four months on the pacific route from the united states to china and japan when the significant wave height was up to 3 m or more the vibration damage of the lowest bending mode accounted for nearly half of the total fatigue damage full scale measurements were conducted on a typical capesize bulk carrier storhaug and moe 2007 the measurement period was from november 2003 to may 2005 the measurement results for the ship were compared with data moe et al 2005 which showed that 56 of the total damage was caused by springing a three year onboard survey of a 6700 teu container ship was performed between 1998 and 2001 okada et al 2006 according to an analysis of the measured data the cumulative fatigue damage ratios with and without springing were 0 105 and 0 050 respectively the cumulative fatigue damage with springing doubled in the field of numerical prediction the second order nonlinear hydroelasticity theory was proposed wu et al 1997 the nonlinear springing of a very large ore carrier was calculated using the three dimensional second order nonlinear hydroelastic code in the frequency domain hu et al 2012 the wave load transfer functions of zero speed forward speed heading waves and oblique waves were given the hydroelastic responses in irregular waves were compared with those in model tests and the influence of springing on structural fatigue was evaluated furthermore the three dimensional linear and nonlinear frequency domain hydroelasticity methods were adopted to conduct theoretical analysis and model test comparisons of very large ore carriers and lng ships wang 2012 at the same time the effects of the structural damping ship draught loading conditions and hull rigidity have been analysed and the effects of springing on fatigue life have been studied the nonlinear hydroelastic responses springing and whipping of a large bulk carrier in an infinite water depth were studied by means of the inner and outer region matching method and model tests yang et al 2018 the nonlinear hydroelastic responses vertical bending moment and horizontal bending moment of a 13 000 teu were numerically assessed by the rankine source method and a numerical damping beach in the time domain chen et al 2019 the wave induced motions and loads of a ship with a bow flare advancing in harsh irregular waves were investigated both numerically and experimentally jiao et al 2019 it is very time consuming to estimate the nonlinear wave loads of various short term sea states and their effects on structural fatigue by numerical calculation the calculation of a single short term sea condition takes approximately several hours and the completion of the scatter diagram of a long term sea state requires several days moreover it costs considerable money and time to study the nonlinear wave characteristics of short term sea conditions through model tests to effectively evaluate the nonlinear springing of ship hulls under various short term sea conditions a simplified calculation method for analysing nonlinear wave induced vibrations under short term sea conditions is proposed by using the characteristics of low frequency and high frequency moment transfer functions in regular wave tank model tests in the paper the springing characteristics of one 308 000 dwt vlcc and one 205 000 dwt vlbc will be analysed through wave load model tests finally the influence of high frequency vibration on the cumulative fatigue damage in different routes is obtained based on the analysis of the cumulative fatigue damage which can provide a reference for improving the structural safety of a very large ship 2 simplified analysis method of the springing influence on structure fatigue in general the nonlinear springing in irregular wave cases needs to be calculated by a nonlinear hydroelastic program or model test in the frequency domain the time domain or a basin test it is always time consuming to carry out one calculation for each irregular short term sea state to analyse the nonlinear wave induced vibration in irregular wave cases and its influence on structural fatigue quickly a simplified method is proposed to calculate the nonlinear wave induced vibration in irregular wave cases based on the load transfer functions of regular waves which are obtained by numerical prediction and model testing 2 1 springing mechanism on ship hull when the ship speed in heading seas is up to 15 7 knots the issc two parameter spectrum under different zero crossing periods is shown in fig 1 where the ordinate represents the wave energy the expression of the issc two parameter spectrum is as follows the average zero crossing period of the natural sea wave ranges from 3 s to 18 s and the encountering frequency of the main energy is from 0 03 hz to 0 6 hz which is less than the natural vibration frequency of the hull girder see fig 2 1 s w ω 124 h s 2 t z 4 ω 5 e 496 t z 4 ω 4 it is concluded that the frequencies of most wave energy are far less than the two node vibration frequency of the hull girder which shows that it is difficult for the wave frequency forces to excite wave induced vibration however the multi frequency components caused by nonlinear wave forces can induce considerable wave induced vibration for example the 1 2 and 1 3 times two node vibration frequency of the hull girder are 0 32 hz and 0 21 hz respectively in addition the wave energy is still large near such wave encountering frequencies especially for irregular waves with a small average wave period such irregular waves cases will excite considerable wave induced vibration of the hull girder 2 2 simplified calculation method for the springing responses of ship hulls wave exciting forces mainly include linear wave frequency forces multi frequency forces sum frequency forces and difference frequency forces the simplified method is mainly based on the following assumptions a a low frequency regular incident wave can excite at least two regular wave response components with different frequencies one is the wave frequency or low frequency response corresponding to the encountering frequency and the other is the high order multi frequency or high frequency response corresponding to the two node resonant frequency of the ship hull b the wave induced vibrations of the hull girder are mainly excited by high order multi frequency forces while the response components under sum frequency and difference frequency forces are excited by smaller energy for the purpose of simplification the combined moment responses of the hull structure under regular waves are expressed as the superposition of the above two frequency components 2 m t m l cos ω e t ε ε l m h cos ω 2 node t ε ε h an approximation of the combined low frequency and high frequency responses of the hull girder excited by any regular wave can be obtained by this method and the low frequency and high frequency wave load transfer functions can be obtained from model testing as shown in fig 16 and fig 17 of section 4 2 the time history of the wave energy spectrum can be simulated by the equal frequency interval or equal energy method and its expression is as follows the initial phase ε i of the incident wave is generated from wave testing or a random generator 3 ξ t i 1 n w ξ i cos ω i t ε i in the case of irregular incident waves there are not only high order multi frequency forces but also other high order sum frequency forces in the case of regular incident waves this simplified method is used to express the high frequency vibration responses of the hull girder when considering only high order multi frequency wave forces without other sum frequency wave forces then the time domain expression of the combined moment m responses under an irregular incident wave is as follows 4a m t i 1 n w m l i cos ω e i t ε i ε l i m h i cos ω 2 node t ε i ε h i and the bending moments of m li and m hi are obtained by the following equations 4b m l i ξ i r l i 4c m h i ξ i r h i where r l i and r h i denote the wave load transfer functions of low frequency and high frequency components respectively which could be obtained by model tests or numerical prediction then the time histories of the stress responses of different structures are obtained by dividing the moment responses of the hull girder by the section modulus the fatigue stress range and load parameters are calculated by the rain flow counting method hu et al 2010 the structural stress range s is calculated by the following formula 5 s c m j 2 3 s n method and cumulative fatigue damage the bilinear s n curve is generally used to assess the cumulative fatigue damage of hull structures in general n q 107 m 3 0 and m 5 0 are assumed 6a n s m a n s m a n n q n n q 6b a n q a n q m m the cumulative fatigue damage of the ship structures is expressed as follows 7 d i 1 n 1 n i where n denotes the total number of stress cycles obtained by the rain flow counting method and n i is solved by eq 6a for different stress range levels 3 model test design taking a 308 000 dwt vlcc and a 205 000 dwt vlbc as the research objects the scale ratios of the model test are 1 55 and 1 50 respectively the main similarity relations between full scale ship and model test are shown in table 1 the particular parameters of the vlcc and vlbc are listed in table 2 and table 3 respectively according to the hcsr code iacs 2013 the fatigue strengths of the vlcc and vlbc are evaluated under two loading conditions namely a full load and ballast load and the design speed is adopted based on the loading manual in combination with the still water bending moment and draft two typical loading conditions a full load arrival and ballast departure are selected in the model tests the two model tests were carried out in the towing tank of cssrc china ship scientific research center as well as the dimensions and vertical inertia of the section of the backbone fot the two ships in the model tests are respectively shown in table 4 and table 5 the ship model designs meet the principles of geometric similarity kinematic similarity and dynamic similarity and the details are as follows dai et al 2007 a the shape of the ship model is similar to that of a real ship b the longitudinal weight distributions of the ship model and the real ship and the second moment or circular radius about the center of gravity are similar c the vibration frequencies and modal shapes of the vertical bending vibration modes are similar and d the froude number and wave factor are similar the ten segment elastic ship model combines a fibreglass reinforced plastic hull with a straight steel beam as shown in fig 3 and fig 4 the measured backbone adopts a variable cross section to ensure that the vertical vibration stiffness is as consistent with the real ship as possible the measured error and uncertainty of the measured data from the model test is approximately 5 which is the conclusion of experience and summary of model tests in the towing tank of cssrc for many years see fig 5 the vertical bending moment responses obtained by hammering tests of the two ships are respectively shown in figs 6 and 7 it is difficult to distinguish between springing and whipping because both exciting forces would induce high frequency bending moment responses in the hull girder the main concern in the paper is springing to avoid slamming as much as possible in the regular wave model test the wave heights are 80 mm and 200 mm which are equivalent to wave heights of 4 m and 10 m respectively for a full scale ship the video and response signals in the model test show that in the 80 mm wave height case there is only springing and slight slamming but in the 200 mm wave height case there is considerable slamming at the same time the representative responses of the bending moment in the 80 mm and 200 mm wave height cases are shown in fig 10 fig 14 4 analysis of the experimental results 4 1 the results in still water the resonant frequencies of the first three orders of the vertical vibration modes of the ship hull are measured by the hammering test at zero speed in still water and the results are shown in table 6 table 8 if there is no additional explanation the experimental scale and nondimensional expression are used in the experimental analysis the vibration frequencies are also assessed by the 3d hydroelastic method in the frequency domain wu 1984 yang et al 2020 which shows that the hydroelastic method is very effective for predicting the resonant frequencies of the ship hull in a fluid the error of the resonant frequency of the two node vibration is less than 6 4 this comparison demonstrates the accuracy of the stiffness of the backbone beam and the mass distribution in the model test furthermore the error of the resonant frequency of the three node vibration is less than 3 0 and the error of the resonant frequency of the four node vibration is less than 19 8 the main reason is that the ten segment model test cannot accurately simulate the vertical four node bending moment vibration the damping ratios of the two node vertical bending mode are shown in table 9 which are obtained by decaying tests in still water 4 2 regular wave cases a signal analysis the typical time history of a regular wave case at the midship section under ballast conditions of the vlcc with a forward speed of 15 7 knots is shown in fig 9 including the wave signal and vertical bending moment signal at the midship section see fig 8 the bending moment response curve at the midship section of the vlcc has considerable high frequency components by observing the model test video no slamming is observed and it can be concluded that considerable springing has occurred after bandpass filtering the signal in fig 9 the low frequency and high frequency signals are obtained the low frequency and high frequency time histories and the energy spectrogram of the various frequency components are shown in fig 10 it can be seen from the springing time history in fig 10 a that there is considerable springing in the regular wave case and the amplitude of the high frequency part is stable without attenuation in fig 10 b the peak value at 1 2 hz is the wave encountering frequency component and four times the frequency of the wave encountering frequency basically coincides with the two node vibration frequency of the hull girder which causes considerable two node vibration this phenomenon shows that the multi frequency forces in the nonlinear wave loads induced by a change in the instantaneous wetted surface of the ship hull may cause resonance of the ship beam which leads to the nonlinear wave induced vibration test data analysis and observations of the test video suggest that wave induced vibration occurs at four wavelengths wavelength to ship length ratios of 0 2 0 325 0 496 and 0 6 of the vlbc under the ballast condition as shown in fig 11 and fig 13 it can be seen from these figures that the bending moment responses at the midship section have considerable springing phenomena that is in addition to the bending moment component which changes according to the encountering frequency of the wave there is also a bending moment component which changes according to the first order i e two node vertical global vibration frequency of the hull girder which is stable and not attenuated the wave frequency bending moment the high frequency moment and the combined moment at the midship section of the vlbc under ballast conditions are given in table 10 wm denotes the wave frequency bending moment hm represents the high frequency bending moment cm represents the combined bending moment it can be seen from the analysis of the proportion of wave bending moment components in table 10 and the spectrum characteristics of the bending moment in figs 11 b fig 12 b and fig 13 b that the high frequency bending moment with the change in the first order i e two node vertical global vibration frequency of the hull girder is the main component which is greater than the energy of the wave frequency component fig 14 shows the typical record curve under high wave height conditions h 200 mm of the vlbc under the ballast condition in heading seas the record implies that there are a considerable number of high frequency phenomena in the bending moment response curve at the midship section according to the test video the slamming phenomenon occurs during the test case however due to the small vibration attenuation damping it is difficult to separate the springing and whipping in the signal this record also shows that the bending moment energy of the high frequency component which varies according to the first order global vibration frequency of the hull girder is relatively large accounting for the main component at the same time there is a multi frequency phenomenon between the low frequency component and the first order vertical global vibration frequency however as the slamming effect is not the focus of the paper it will not be discussed in detail b wave load transfer function to express the relationship between the encountering frequency and its multi frequency component and the two node vertical vibration of the hull the encountering frequency is adopted as the transverse coordinate of the wave bending moment in heading seas as shown in figs 16 and 17 however because the encountering frequency corresponding to the regular wave conditions in the paper is 0 2 rad s 0 3 rad s which is far from the two node vertical vibration frequency it is unnecessary to use the encountering frequency as the abscissa and the wavelength as the abscissa can better reflect the load principle see fig 18 and fig 19 the nondimensional transfer functions of the vertical bending moment at the midship section of the vlcc and vlbc are shown in figs 16 19 where wasim wm represents the calculated wave frequency bending moment by the commercial software wasim of dnvgl which is a potential codes for calculating rigid motions and wave loads of the floating structures with speed based on rankine source in time domain and the hydrodynamic models have 812 panels and 794 panels on the wetted surface for and vlcc and vlbc respectively shown in fig 15 in addition the corresponding curve trends of wm and wasim wm in figs 16 19 are relatively similar showing the reliability of the numerical calculation results and the experimental results however it also shows that there is a certain error between the numerical prediction and the experimental results figs 16 and 17 show that there are considerable wave induced vibration phenomena caused by multi frequency forces after the nondimensional wave encountering frequency ω e l g exceeds about 5 5 at the same time for the vlcc and vlbc the high frequency response under the ballast condition is greater than that under the full load condition according to the results in figs 16 b and fig 17 b except for the significant high frequency response of the shorter wavelength ω e l g ranges from approximately 5 5 to 9 0 there is also a large high frequency response component near λ l 1 0 i e ω e l g is approximately 3 5 this is because the nonlinear hydrodynamic external load induced by the heave and pitch motion in the condition is large accompanied by a slight slamming found in the test video but the slight whipping and spring components cannot be split in general the results in the figures show that the magnitude of the high order bending moment component is considerable when sailing in heading seas but no obvious high frequency phenomenon is found in following seas as shown in figs 18 and 19 the simplified method could be carried out based on wave loading transfer function of the experimental data and the numerical prediction although the non dimensional wave encountering frequencies exceeding about 5 5 the numerical method fails to predict the wave frequency component of the wave loads since the magnitude of wave frequency component of wave load exceeding about 5 5 is comparatively small compared to hight frequency component which has little influence on the overall results of fatigue assessment on the other hand the fatigue wave load prediction in this paper is based on the model test results the predicted results of linear wave load here are only for reference of course more accurate prediction results of wave load of wave frequency component and high frequency component can lead to more accurate fatigue damage analysis results 4 3 irregular wave cases to investigate the phenomenon of springing in irregular waves six kinds of irregular wave model tests have been carried out under the ballast and full load conditions the corresponding significant wave height of the full scale ship is approximately 3 5 m for the vlcc and vlbc the response curves of the vertical bending moment in the time and frequency domains at the midship section are shown in fig 20 to fig 23 it is concluded that there are considerable high frequency bending moment response components in the recorded signals moreover there is a considerable springing phenomenon under each of the four conditions shown in figs 20 23 since the frequencies of the main wave energy are far less than the two node vibration frequencies of the hull girder the wave induced vibration at this time should be excited by the high frequency nonlinear wave force such as the multi frequency forces and the sum frequency forces from the response curve in the time domain it can be seen that the high frequency component is basically a regular waveform and the corresponding period is the vertical two node vibration period from the response spectrum it is concluded that the high frequency energy is mainly concentrated near the vertical two node vibration frequency which further supports the rationality of the previous assumption of the simplified method in section 2 2 5 impact of nonlinear springing on structural fatigue 5 1 short term sea state the time domain curve and frequency spectrogram of the vertical bending moment responses of the hull under the short term sea conditions can be obtained by the simplified calculation method proposed above as shown in fig 24 and fig 25 it takes only a few seconds to complete the calculation with a current mainstream computer which is much less than the few hours using the nonlinear program in the time domain the experimental results under the corresponding conditions are listed in the figures at the same time it can be seen in figs 24 and 25 that the numerical results are consistent with the measured data which shows the rationality of the simplified calculation method of wave induced vibration the irregular wave in the model test is generally tested during 500 s for each short term sea state which is equivalent to 1 h for the full scale ship in an actual sea state to calculate the influence of wave induced vibration on the fatigue of the hull structure in the short term sea state and to further verify the effectiveness of the simplified calculation method the 1 h cumulative fatigue damage of the typical members of the main deck is calculated based on the moment results measured in the model test for the short term sea state according to the iacs code iacs 2013 and the structural types of hotspots the section modulus and stress concentration coefficient of the upper deck of the vlcc are 56 4 m3 and 1 12 respectively and the section modulus and stress concentration coefficient of main deck of the vlbc are 55 4 m3 and 2 0 respectively the scf stress concentration factors of the upper deck is chosen based on the suggestion of simplified stress analysis method for fatigue strength in hcsr rules iacs 2013 which is based on beam model and the scf are relative to the structural connecting style and structural opening in order to conduct representative research the selected value of scf for the vlcc and vlbc in the paper is near the upper and lower limits of scf in hcsr rules for different upper deck structures moreover the s n curve is selected from the d curve of the hcsr code iacs 2013 the calculation results are shown in table 11 and table 12 it can be found that the smaller the zero crossing period t z is the greater the ratio between the fatigue damages induced by the combined and wave frequency bending moments this indicates the greater impact of the wave induced vibration on the structure fatigue at the same time the maximum difference between the results calculated by the simplified calculation method and the model test results is 25 and the minimum difference is 2 7 furthermore the maximum difference between the numerical results of fatigue damage and the model test results is 25 and the difference between the calculated stress and the test results is 5 8 because the fatigue results are 3 5 times the structural stress 5 2 long term sea state due to the expensive cost and time of model tests there are only a few results in the short term sea state that have been measured in the model tests to study the effect of wave induced vibration on fatigue in the long term sea state the simplified method proposed in the paper can be used for fast and effective calculations to illustrate the problem six routes are chosen including the north atlantic australia south america middle east west africa and the globe the design life of the vlcc and vlbc is set to 25 years according to the hcsr code iacs 2013 and the service coefficient is set to 0 85 it is supposed that the occurrence probability of following seas and heading seas is the same and that of the ballast condition and full load is the same the other parameters are the same as those in the previous section one typical statistical results of the altering stress range in 3 h short term sea state from the scatter diagram of the long term sea state by the rain flow counting method is shown in fig 26 from table 13 and table 14 it is concluded that the nonlinear springing effect on structural fatigue is more considerable under the ballast condition than under the full load case the serious combination is ballast and heading seas the results of the combined result wave frequency result are between 2 18 and 3 59 in table 13 and those in table 14 are between 1 30 and 1 88 the phenomenon of wave induced vibration in table 14 is more considerable than that in table 13 because the stress results of the vlbc are larger and the fatigue parameter m is mainly taken as 3 0 while the stress results of the vlcc are smaller and the fatigue parameter m is mainly taken as 5 0 for the vlcc with m 5 0 the fatigue damage results of the combined result wave frequency result are from 2 18 to 3 59 so the bending moment results of the combined result wave frequency result are from 1 17 to 1 29 for the vlbc with m 3 0 the fatigue damage results of the combined result wave frequency result are from 1 30 to 1 88 so the bending moment results of the combined result wave frequency result are from 1 09 to 1 23 therefore the total vertical bending moment levels of the vlcc and vlbc should be increased by 9 29 considering the springing influence on fatigue life under the ballast condition in heading seas from the calculation results in tables 13 and 14 the following conclusions can be drawn a the stress under full load conditions is large so the fatigue damage is greater than that under ballast conditions b the response of the high frequency bending moment under ballast conditions is more significant so the ratio of cumulative fatigue damage caused by nonlinear springing to the linear result is larger than that under full load conditions c the response of the high frequency bending moment is more significant in heading seas thus the ratio of the cumulative fatigue damage caused by nonlinear springing to the linear result is larger than that in following seas on the one hand the results of the combined result wave frequency result are 1 37 2 45 and 1 21 1 52 for the vlcc and the vlbc respectively as shown in table 15 on the other hand the fatigue damage varies greatly under different routes the worst is the north atlantic and the second most serious is the sea state of south america followed by the globe 6 summary and conclusions based on the ten segmented wave load model tests of the vlcc and vlbc the nonlinear wave induced vibration phenomenon is studied at the same time a simplified method is proposed to calculate the influence of wave induced vibration on the fatigue damage of the ship structure which is obtained by numerical prediction and model testing the method accounts for two bending moments including the wave frequency component and the high frequency component some important conclusions are as follows a the errors of the resonant frequencies of two node vibration three node vibration and four node vibration between the numerical prediction and experimental data are less than 6 4 3 0 and 19 8 respectively this indicates that the ten segment model test could not accurately simulate the vertical four node bending moment vibration b there are considerable wave induced vibration phenomena caused by multi frequency forces after the nondimensional wave encountering frequency ω e l g exceeds 5 5 at the same time for the vlcc and vlbc the high frequency response under ballast conditions is greater than that under full load conditions although the significant high frequency response of shorter wavelength ω e l g ranges from approximately 5 5 to 9 0 there is also a large high frequency response component near the λ l 1 0 i e ω e l g is approximately 3 5 this is because the nonlinear hydrodynamic external load induced by the heave and pitch motion in the condition is large and accompanied by a slight slamming c if the influence of wave induced vibration on fatigue damage is considered the total longitudinal bending moment levels of the vlcc and vlbc should be increased by 9 29 under the ballast load in heading seas d the ratio of fatigue damage between springing and without springing is 1 37 2 45 and 1 21 1 52 for the vlcc and the vlbc respectively the fatigue damage varies greatly under different routes the worst is the north atlantic and the second most serious is the sea state of south america followed by the globe credit authorship contribution statement peng yang conceptualization methodology writing review editing wei zhang data curation writing original draft jun ding visualization investigation xuekang gu supervision haosen chen software validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the study is supported by the natural science foundation of hainan province of china grant no 519qn188 and the national natural science foundation of china study on fluid structure interaction dynamic responses of the very large deep sea fishery platform 
21453,in the iacs harmonized common structural rules it is hoped that the fatigue damage to ship structures caused by springing can be rationally analysed in the case of limited resources in a basin it is impossible to carry out model tests of wave induced vibrations for many short term sea states based on wave load transfer function under regular waves a simplified method is established to evaluate the nonlinear springing and fatigue damage to ship structures under many different short term and long term sea states and is proposed by using wave loads of wave frequency and high frequency components the wave loading model tests of a 308 000 dwt vlcc very large crude container and a 205 000 dwt vlbc very large bulk carrier are carried out moreover the springing influence on structural fatigue is assessed in short term sea states by using stress data measured from model tests furthermore the springing influence on structural fatigue is studied in long term sea states for some typical sea routes it is concluded that the impact of springing is obvious on a vlcc and vlbc under ballast conditions and differs for various routes the simplified method can assess the fatigue damage due to springing properly keywords oil tanker bulk carrier springing fatigue model test nomenclature l pp length between the ship perpendiculars b breadth of the ship d depth of the ship at midship section i v vertical inertia of ship section a w amplitude of incident wave h w wave height of incident wave s w wave energy spectrum f wave frequency ω wave circular frequency ω e encountering wave circular frequency ω 2 node two node vibration frequency h s one third of significant wave height t z average zero crossing period m 5 vertical bending moment at midship j section modulus c stress concentration factor at hotspot t time ξ wave height time history of incident wave ε initial phase of incident wave ε l initial phase of low frequency component relative to incident wave ε h initial phase of high frequency component relative to incident wave m l amplitude of bending moment response of low frequency component m h amplitude of bending moment response of high frequency component r l wave load transfer function of low frequency component r h wave load transfer function of high frequency component n w total number of regular incident wave m slope constant of s n curve m slope constant of s n curve a material constant of s n curve a material constant of s n curve s alternating stress range n stress cycle times s q stress range at point q n q stress cycle times at point q 1 introduction because the natural frequency or eigenfrequencies of the two node vibration of a traditional hull ship is much higher than the exciting frequency of a wave load the wave induced vibration is not obvious with an increase in the main dimensions of ship structures and the wide application of high strength steel and large hull openings ship structures have become increasingly elastic in the marine environment and the phenomenon of fluid structure interaction has become increasingly obvious during a decrease in hull girder rigidity the two node vibration frequency of the ship hull will be located in the main frequency range of the external wave excitation load so there will be obvious wave induced vibration called springing phenomena storhaug et al 2003 park et al 2004 storhaug 2007 wu and moan 2007 iijima et al 2008 pedersen and jensen 2009 wang et al 2012 the fatigue damage caused by the wave induced vibration of a container ship in heading seas is studied by model testing and numerical calculation drummen et al 2008 the measurement results show that 40 of the total fatigue damage is caused by wave induced vibration but the numerical prediction is larger reaching 50 in recent years the iacs international association of classification societies has put forward the requirements for the influence of wave induced vibration on the fatigue life of hull structures in hcsr harmonized common structural rules it is hoped that the industrial circle can rationally analyse the cumulative fatigue damage of hull structures caused by wave induced vibration and provide a basis for scientific analysis iacs 2013 all major classification societies and relevant institutions around the world have participated in the academic discussion of relevant issues therefore it is urgent to study the influence of wave induced vibration on the fatigue life of structures in the field of full scale measurement a full scale measurement was carried out on an ore carrier with a perpendicular length of 281 m moe et al 2005 the test time lasted nearly four months on the pacific route from the united states to china and japan when the significant wave height was up to 3 m or more the vibration damage of the lowest bending mode accounted for nearly half of the total fatigue damage full scale measurements were conducted on a typical capesize bulk carrier storhaug and moe 2007 the measurement period was from november 2003 to may 2005 the measurement results for the ship were compared with data moe et al 2005 which showed that 56 of the total damage was caused by springing a three year onboard survey of a 6700 teu container ship was performed between 1998 and 2001 okada et al 2006 according to an analysis of the measured data the cumulative fatigue damage ratios with and without springing were 0 105 and 0 050 respectively the cumulative fatigue damage with springing doubled in the field of numerical prediction the second order nonlinear hydroelasticity theory was proposed wu et al 1997 the nonlinear springing of a very large ore carrier was calculated using the three dimensional second order nonlinear hydroelastic code in the frequency domain hu et al 2012 the wave load transfer functions of zero speed forward speed heading waves and oblique waves were given the hydroelastic responses in irregular waves were compared with those in model tests and the influence of springing on structural fatigue was evaluated furthermore the three dimensional linear and nonlinear frequency domain hydroelasticity methods were adopted to conduct theoretical analysis and model test comparisons of very large ore carriers and lng ships wang 2012 at the same time the effects of the structural damping ship draught loading conditions and hull rigidity have been analysed and the effects of springing on fatigue life have been studied the nonlinear hydroelastic responses springing and whipping of a large bulk carrier in an infinite water depth were studied by means of the inner and outer region matching method and model tests yang et al 2018 the nonlinear hydroelastic responses vertical bending moment and horizontal bending moment of a 13 000 teu were numerically assessed by the rankine source method and a numerical damping beach in the time domain chen et al 2019 the wave induced motions and loads of a ship with a bow flare advancing in harsh irregular waves were investigated both numerically and experimentally jiao et al 2019 it is very time consuming to estimate the nonlinear wave loads of various short term sea states and their effects on structural fatigue by numerical calculation the calculation of a single short term sea condition takes approximately several hours and the completion of the scatter diagram of a long term sea state requires several days moreover it costs considerable money and time to study the nonlinear wave characteristics of short term sea conditions through model tests to effectively evaluate the nonlinear springing of ship hulls under various short term sea conditions a simplified calculation method for analysing nonlinear wave induced vibrations under short term sea conditions is proposed by using the characteristics of low frequency and high frequency moment transfer functions in regular wave tank model tests in the paper the springing characteristics of one 308 000 dwt vlcc and one 205 000 dwt vlbc will be analysed through wave load model tests finally the influence of high frequency vibration on the cumulative fatigue damage in different routes is obtained based on the analysis of the cumulative fatigue damage which can provide a reference for improving the structural safety of a very large ship 2 simplified analysis method of the springing influence on structure fatigue in general the nonlinear springing in irregular wave cases needs to be calculated by a nonlinear hydroelastic program or model test in the frequency domain the time domain or a basin test it is always time consuming to carry out one calculation for each irregular short term sea state to analyse the nonlinear wave induced vibration in irregular wave cases and its influence on structural fatigue quickly a simplified method is proposed to calculate the nonlinear wave induced vibration in irregular wave cases based on the load transfer functions of regular waves which are obtained by numerical prediction and model testing 2 1 springing mechanism on ship hull when the ship speed in heading seas is up to 15 7 knots the issc two parameter spectrum under different zero crossing periods is shown in fig 1 where the ordinate represents the wave energy the expression of the issc two parameter spectrum is as follows the average zero crossing period of the natural sea wave ranges from 3 s to 18 s and the encountering frequency of the main energy is from 0 03 hz to 0 6 hz which is less than the natural vibration frequency of the hull girder see fig 2 1 s w ω 124 h s 2 t z 4 ω 5 e 496 t z 4 ω 4 it is concluded that the frequencies of most wave energy are far less than the two node vibration frequency of the hull girder which shows that it is difficult for the wave frequency forces to excite wave induced vibration however the multi frequency components caused by nonlinear wave forces can induce considerable wave induced vibration for example the 1 2 and 1 3 times two node vibration frequency of the hull girder are 0 32 hz and 0 21 hz respectively in addition the wave energy is still large near such wave encountering frequencies especially for irregular waves with a small average wave period such irregular waves cases will excite considerable wave induced vibration of the hull girder 2 2 simplified calculation method for the springing responses of ship hulls wave exciting forces mainly include linear wave frequency forces multi frequency forces sum frequency forces and difference frequency forces the simplified method is mainly based on the following assumptions a a low frequency regular incident wave can excite at least two regular wave response components with different frequencies one is the wave frequency or low frequency response corresponding to the encountering frequency and the other is the high order multi frequency or high frequency response corresponding to the two node resonant frequency of the ship hull b the wave induced vibrations of the hull girder are mainly excited by high order multi frequency forces while the response components under sum frequency and difference frequency forces are excited by smaller energy for the purpose of simplification the combined moment responses of the hull structure under regular waves are expressed as the superposition of the above two frequency components 2 m t m l cos ω e t ε ε l m h cos ω 2 node t ε ε h an approximation of the combined low frequency and high frequency responses of the hull girder excited by any regular wave can be obtained by this method and the low frequency and high frequency wave load transfer functions can be obtained from model testing as shown in fig 16 and fig 17 of section 4 2 the time history of the wave energy spectrum can be simulated by the equal frequency interval or equal energy method and its expression is as follows the initial phase ε i of the incident wave is generated from wave testing or a random generator 3 ξ t i 1 n w ξ i cos ω i t ε i in the case of irregular incident waves there are not only high order multi frequency forces but also other high order sum frequency forces in the case of regular incident waves this simplified method is used to express the high frequency vibration responses of the hull girder when considering only high order multi frequency wave forces without other sum frequency wave forces then the time domain expression of the combined moment m responses under an irregular incident wave is as follows 4a m t i 1 n w m l i cos ω e i t ε i ε l i m h i cos ω 2 node t ε i ε h i and the bending moments of m li and m hi are obtained by the following equations 4b m l i ξ i r l i 4c m h i ξ i r h i where r l i and r h i denote the wave load transfer functions of low frequency and high frequency components respectively which could be obtained by model tests or numerical prediction then the time histories of the stress responses of different structures are obtained by dividing the moment responses of the hull girder by the section modulus the fatigue stress range and load parameters are calculated by the rain flow counting method hu et al 2010 the structural stress range s is calculated by the following formula 5 s c m j 2 3 s n method and cumulative fatigue damage the bilinear s n curve is generally used to assess the cumulative fatigue damage of hull structures in general n q 107 m 3 0 and m 5 0 are assumed 6a n s m a n s m a n n q n n q 6b a n q a n q m m the cumulative fatigue damage of the ship structures is expressed as follows 7 d i 1 n 1 n i where n denotes the total number of stress cycles obtained by the rain flow counting method and n i is solved by eq 6a for different stress range levels 3 model test design taking a 308 000 dwt vlcc and a 205 000 dwt vlbc as the research objects the scale ratios of the model test are 1 55 and 1 50 respectively the main similarity relations between full scale ship and model test are shown in table 1 the particular parameters of the vlcc and vlbc are listed in table 2 and table 3 respectively according to the hcsr code iacs 2013 the fatigue strengths of the vlcc and vlbc are evaluated under two loading conditions namely a full load and ballast load and the design speed is adopted based on the loading manual in combination with the still water bending moment and draft two typical loading conditions a full load arrival and ballast departure are selected in the model tests the two model tests were carried out in the towing tank of cssrc china ship scientific research center as well as the dimensions and vertical inertia of the section of the backbone fot the two ships in the model tests are respectively shown in table 4 and table 5 the ship model designs meet the principles of geometric similarity kinematic similarity and dynamic similarity and the details are as follows dai et al 2007 a the shape of the ship model is similar to that of a real ship b the longitudinal weight distributions of the ship model and the real ship and the second moment or circular radius about the center of gravity are similar c the vibration frequencies and modal shapes of the vertical bending vibration modes are similar and d the froude number and wave factor are similar the ten segment elastic ship model combines a fibreglass reinforced plastic hull with a straight steel beam as shown in fig 3 and fig 4 the measured backbone adopts a variable cross section to ensure that the vertical vibration stiffness is as consistent with the real ship as possible the measured error and uncertainty of the measured data from the model test is approximately 5 which is the conclusion of experience and summary of model tests in the towing tank of cssrc for many years see fig 5 the vertical bending moment responses obtained by hammering tests of the two ships are respectively shown in figs 6 and 7 it is difficult to distinguish between springing and whipping because both exciting forces would induce high frequency bending moment responses in the hull girder the main concern in the paper is springing to avoid slamming as much as possible in the regular wave model test the wave heights are 80 mm and 200 mm which are equivalent to wave heights of 4 m and 10 m respectively for a full scale ship the video and response signals in the model test show that in the 80 mm wave height case there is only springing and slight slamming but in the 200 mm wave height case there is considerable slamming at the same time the representative responses of the bending moment in the 80 mm and 200 mm wave height cases are shown in fig 10 fig 14 4 analysis of the experimental results 4 1 the results in still water the resonant frequencies of the first three orders of the vertical vibration modes of the ship hull are measured by the hammering test at zero speed in still water and the results are shown in table 6 table 8 if there is no additional explanation the experimental scale and nondimensional expression are used in the experimental analysis the vibration frequencies are also assessed by the 3d hydroelastic method in the frequency domain wu 1984 yang et al 2020 which shows that the hydroelastic method is very effective for predicting the resonant frequencies of the ship hull in a fluid the error of the resonant frequency of the two node vibration is less than 6 4 this comparison demonstrates the accuracy of the stiffness of the backbone beam and the mass distribution in the model test furthermore the error of the resonant frequency of the three node vibration is less than 3 0 and the error of the resonant frequency of the four node vibration is less than 19 8 the main reason is that the ten segment model test cannot accurately simulate the vertical four node bending moment vibration the damping ratios of the two node vertical bending mode are shown in table 9 which are obtained by decaying tests in still water 4 2 regular wave cases a signal analysis the typical time history of a regular wave case at the midship section under ballast conditions of the vlcc with a forward speed of 15 7 knots is shown in fig 9 including the wave signal and vertical bending moment signal at the midship section see fig 8 the bending moment response curve at the midship section of the vlcc has considerable high frequency components by observing the model test video no slamming is observed and it can be concluded that considerable springing has occurred after bandpass filtering the signal in fig 9 the low frequency and high frequency signals are obtained the low frequency and high frequency time histories and the energy spectrogram of the various frequency components are shown in fig 10 it can be seen from the springing time history in fig 10 a that there is considerable springing in the regular wave case and the amplitude of the high frequency part is stable without attenuation in fig 10 b the peak value at 1 2 hz is the wave encountering frequency component and four times the frequency of the wave encountering frequency basically coincides with the two node vibration frequency of the hull girder which causes considerable two node vibration this phenomenon shows that the multi frequency forces in the nonlinear wave loads induced by a change in the instantaneous wetted surface of the ship hull may cause resonance of the ship beam which leads to the nonlinear wave induced vibration test data analysis and observations of the test video suggest that wave induced vibration occurs at four wavelengths wavelength to ship length ratios of 0 2 0 325 0 496 and 0 6 of the vlbc under the ballast condition as shown in fig 11 and fig 13 it can be seen from these figures that the bending moment responses at the midship section have considerable springing phenomena that is in addition to the bending moment component which changes according to the encountering frequency of the wave there is also a bending moment component which changes according to the first order i e two node vertical global vibration frequency of the hull girder which is stable and not attenuated the wave frequency bending moment the high frequency moment and the combined moment at the midship section of the vlbc under ballast conditions are given in table 10 wm denotes the wave frequency bending moment hm represents the high frequency bending moment cm represents the combined bending moment it can be seen from the analysis of the proportion of wave bending moment components in table 10 and the spectrum characteristics of the bending moment in figs 11 b fig 12 b and fig 13 b that the high frequency bending moment with the change in the first order i e two node vertical global vibration frequency of the hull girder is the main component which is greater than the energy of the wave frequency component fig 14 shows the typical record curve under high wave height conditions h 200 mm of the vlbc under the ballast condition in heading seas the record implies that there are a considerable number of high frequency phenomena in the bending moment response curve at the midship section according to the test video the slamming phenomenon occurs during the test case however due to the small vibration attenuation damping it is difficult to separate the springing and whipping in the signal this record also shows that the bending moment energy of the high frequency component which varies according to the first order global vibration frequency of the hull girder is relatively large accounting for the main component at the same time there is a multi frequency phenomenon between the low frequency component and the first order vertical global vibration frequency however as the slamming effect is not the focus of the paper it will not be discussed in detail b wave load transfer function to express the relationship between the encountering frequency and its multi frequency component and the two node vertical vibration of the hull the encountering frequency is adopted as the transverse coordinate of the wave bending moment in heading seas as shown in figs 16 and 17 however because the encountering frequency corresponding to the regular wave conditions in the paper is 0 2 rad s 0 3 rad s which is far from the two node vertical vibration frequency it is unnecessary to use the encountering frequency as the abscissa and the wavelength as the abscissa can better reflect the load principle see fig 18 and fig 19 the nondimensional transfer functions of the vertical bending moment at the midship section of the vlcc and vlbc are shown in figs 16 19 where wasim wm represents the calculated wave frequency bending moment by the commercial software wasim of dnvgl which is a potential codes for calculating rigid motions and wave loads of the floating structures with speed based on rankine source in time domain and the hydrodynamic models have 812 panels and 794 panels on the wetted surface for and vlcc and vlbc respectively shown in fig 15 in addition the corresponding curve trends of wm and wasim wm in figs 16 19 are relatively similar showing the reliability of the numerical calculation results and the experimental results however it also shows that there is a certain error between the numerical prediction and the experimental results figs 16 and 17 show that there are considerable wave induced vibration phenomena caused by multi frequency forces after the nondimensional wave encountering frequency ω e l g exceeds about 5 5 at the same time for the vlcc and vlbc the high frequency response under the ballast condition is greater than that under the full load condition according to the results in figs 16 b and fig 17 b except for the significant high frequency response of the shorter wavelength ω e l g ranges from approximately 5 5 to 9 0 there is also a large high frequency response component near λ l 1 0 i e ω e l g is approximately 3 5 this is because the nonlinear hydrodynamic external load induced by the heave and pitch motion in the condition is large accompanied by a slight slamming found in the test video but the slight whipping and spring components cannot be split in general the results in the figures show that the magnitude of the high order bending moment component is considerable when sailing in heading seas but no obvious high frequency phenomenon is found in following seas as shown in figs 18 and 19 the simplified method could be carried out based on wave loading transfer function of the experimental data and the numerical prediction although the non dimensional wave encountering frequencies exceeding about 5 5 the numerical method fails to predict the wave frequency component of the wave loads since the magnitude of wave frequency component of wave load exceeding about 5 5 is comparatively small compared to hight frequency component which has little influence on the overall results of fatigue assessment on the other hand the fatigue wave load prediction in this paper is based on the model test results the predicted results of linear wave load here are only for reference of course more accurate prediction results of wave load of wave frequency component and high frequency component can lead to more accurate fatigue damage analysis results 4 3 irregular wave cases to investigate the phenomenon of springing in irregular waves six kinds of irregular wave model tests have been carried out under the ballast and full load conditions the corresponding significant wave height of the full scale ship is approximately 3 5 m for the vlcc and vlbc the response curves of the vertical bending moment in the time and frequency domains at the midship section are shown in fig 20 to fig 23 it is concluded that there are considerable high frequency bending moment response components in the recorded signals moreover there is a considerable springing phenomenon under each of the four conditions shown in figs 20 23 since the frequencies of the main wave energy are far less than the two node vibration frequencies of the hull girder the wave induced vibration at this time should be excited by the high frequency nonlinear wave force such as the multi frequency forces and the sum frequency forces from the response curve in the time domain it can be seen that the high frequency component is basically a regular waveform and the corresponding period is the vertical two node vibration period from the response spectrum it is concluded that the high frequency energy is mainly concentrated near the vertical two node vibration frequency which further supports the rationality of the previous assumption of the simplified method in section 2 2 5 impact of nonlinear springing on structural fatigue 5 1 short term sea state the time domain curve and frequency spectrogram of the vertical bending moment responses of the hull under the short term sea conditions can be obtained by the simplified calculation method proposed above as shown in fig 24 and fig 25 it takes only a few seconds to complete the calculation with a current mainstream computer which is much less than the few hours using the nonlinear program in the time domain the experimental results under the corresponding conditions are listed in the figures at the same time it can be seen in figs 24 and 25 that the numerical results are consistent with the measured data which shows the rationality of the simplified calculation method of wave induced vibration the irregular wave in the model test is generally tested during 500 s for each short term sea state which is equivalent to 1 h for the full scale ship in an actual sea state to calculate the influence of wave induced vibration on the fatigue of the hull structure in the short term sea state and to further verify the effectiveness of the simplified calculation method the 1 h cumulative fatigue damage of the typical members of the main deck is calculated based on the moment results measured in the model test for the short term sea state according to the iacs code iacs 2013 and the structural types of hotspots the section modulus and stress concentration coefficient of the upper deck of the vlcc are 56 4 m3 and 1 12 respectively and the section modulus and stress concentration coefficient of main deck of the vlbc are 55 4 m3 and 2 0 respectively the scf stress concentration factors of the upper deck is chosen based on the suggestion of simplified stress analysis method for fatigue strength in hcsr rules iacs 2013 which is based on beam model and the scf are relative to the structural connecting style and structural opening in order to conduct representative research the selected value of scf for the vlcc and vlbc in the paper is near the upper and lower limits of scf in hcsr rules for different upper deck structures moreover the s n curve is selected from the d curve of the hcsr code iacs 2013 the calculation results are shown in table 11 and table 12 it can be found that the smaller the zero crossing period t z is the greater the ratio between the fatigue damages induced by the combined and wave frequency bending moments this indicates the greater impact of the wave induced vibration on the structure fatigue at the same time the maximum difference between the results calculated by the simplified calculation method and the model test results is 25 and the minimum difference is 2 7 furthermore the maximum difference between the numerical results of fatigue damage and the model test results is 25 and the difference between the calculated stress and the test results is 5 8 because the fatigue results are 3 5 times the structural stress 5 2 long term sea state due to the expensive cost and time of model tests there are only a few results in the short term sea state that have been measured in the model tests to study the effect of wave induced vibration on fatigue in the long term sea state the simplified method proposed in the paper can be used for fast and effective calculations to illustrate the problem six routes are chosen including the north atlantic australia south america middle east west africa and the globe the design life of the vlcc and vlbc is set to 25 years according to the hcsr code iacs 2013 and the service coefficient is set to 0 85 it is supposed that the occurrence probability of following seas and heading seas is the same and that of the ballast condition and full load is the same the other parameters are the same as those in the previous section one typical statistical results of the altering stress range in 3 h short term sea state from the scatter diagram of the long term sea state by the rain flow counting method is shown in fig 26 from table 13 and table 14 it is concluded that the nonlinear springing effect on structural fatigue is more considerable under the ballast condition than under the full load case the serious combination is ballast and heading seas the results of the combined result wave frequency result are between 2 18 and 3 59 in table 13 and those in table 14 are between 1 30 and 1 88 the phenomenon of wave induced vibration in table 14 is more considerable than that in table 13 because the stress results of the vlbc are larger and the fatigue parameter m is mainly taken as 3 0 while the stress results of the vlcc are smaller and the fatigue parameter m is mainly taken as 5 0 for the vlcc with m 5 0 the fatigue damage results of the combined result wave frequency result are from 2 18 to 3 59 so the bending moment results of the combined result wave frequency result are from 1 17 to 1 29 for the vlbc with m 3 0 the fatigue damage results of the combined result wave frequency result are from 1 30 to 1 88 so the bending moment results of the combined result wave frequency result are from 1 09 to 1 23 therefore the total vertical bending moment levels of the vlcc and vlbc should be increased by 9 29 considering the springing influence on fatigue life under the ballast condition in heading seas from the calculation results in tables 13 and 14 the following conclusions can be drawn a the stress under full load conditions is large so the fatigue damage is greater than that under ballast conditions b the response of the high frequency bending moment under ballast conditions is more significant so the ratio of cumulative fatigue damage caused by nonlinear springing to the linear result is larger than that under full load conditions c the response of the high frequency bending moment is more significant in heading seas thus the ratio of the cumulative fatigue damage caused by nonlinear springing to the linear result is larger than that in following seas on the one hand the results of the combined result wave frequency result are 1 37 2 45 and 1 21 1 52 for the vlcc and the vlbc respectively as shown in table 15 on the other hand the fatigue damage varies greatly under different routes the worst is the north atlantic and the second most serious is the sea state of south america followed by the globe 6 summary and conclusions based on the ten segmented wave load model tests of the vlcc and vlbc the nonlinear wave induced vibration phenomenon is studied at the same time a simplified method is proposed to calculate the influence of wave induced vibration on the fatigue damage of the ship structure which is obtained by numerical prediction and model testing the method accounts for two bending moments including the wave frequency component and the high frequency component some important conclusions are as follows a the errors of the resonant frequencies of two node vibration three node vibration and four node vibration between the numerical prediction and experimental data are less than 6 4 3 0 and 19 8 respectively this indicates that the ten segment model test could not accurately simulate the vertical four node bending moment vibration b there are considerable wave induced vibration phenomena caused by multi frequency forces after the nondimensional wave encountering frequency ω e l g exceeds 5 5 at the same time for the vlcc and vlbc the high frequency response under ballast conditions is greater than that under full load conditions although the significant high frequency response of shorter wavelength ω e l g ranges from approximately 5 5 to 9 0 there is also a large high frequency response component near the λ l 1 0 i e ω e l g is approximately 3 5 this is because the nonlinear hydrodynamic external load induced by the heave and pitch motion in the condition is large and accompanied by a slight slamming c if the influence of wave induced vibration on fatigue damage is considered the total longitudinal bending moment levels of the vlcc and vlbc should be increased by 9 29 under the ballast load in heading seas d the ratio of fatigue damage between springing and without springing is 1 37 2 45 and 1 21 1 52 for the vlcc and the vlbc respectively the fatigue damage varies greatly under different routes the worst is the north atlantic and the second most serious is the sea state of south america followed by the globe credit authorship contribution statement peng yang conceptualization methodology writing review editing wei zhang data curation writing original draft jun ding visualization investigation xuekang gu supervision haosen chen software validation declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgements the study is supported by the natural science foundation of hainan province of china grant no 519qn188 and the national natural science foundation of china study on fluid structure interaction dynamic responses of the very large deep sea fishery platform 
21454,low cost commercial micro electro mechanical system mems based inertial motion unit is used for sea surface wave measurements a buoy is developed based on the capacitive silicon based accelerometer gyroscope magnetometer sensor with radically simplified architecture allowing a significant reduction of the buoy hull size down to 14 cm diameter and hence increased high frequency sensitivity the proposed buoy design is suitable for short term manual wave measurements with minimal deployment recovery efforts and or experiments where knowledge of the high frequency part of the spectrum is preferable the buoy data is validated in a field experiment at the black sea stationary research platform using reference measurements of the six wire resistive wave gauge the strapped down buoy measurements are transformed into the georeferenced buoy tilts and vertical acceleration using small wave slope approximation the classical longuet higgins et al 1961 approach is used for directional wave spectra estimation under 1 to 15 m s wind speed pure wind and mixed sea conditions the significant wave height wave peak period wave direction and spectral width are well reproduced by the buoy the buoy geometric cut off frequency about 2 5 hz corresponding to wavelength twice the hull diameter is at least 2 5 times better than that of commercially available buoys the sub peak low frequency noise typical for accelerometer derived spectra is wind dependent and thus is clearly not the intrinsic sensor noise but rather results from the buoy non linear response to the waves the detected high frequency 4 f 80 hz spectrum tail also depends on the wind speed in accord with the short wave wind driven wave spectrum model the observed high frequency sensitivity may be useful for short wave sensing beyond the geometric cut off frequency with mems based sensors keywords sea surface buoy short gravity waves inertial motion unit micro electro mechanical system 1 introduction surface wave buoy is the most common platform for in situ sea state measurements first buoys were designed to measure the hull linear acceleration and pitch roll angles along with the earth magnetic field for true azimuth referencing barber 1946 longuet higgins et al 1961 establishing of global navigation satellite systems have provided a new concept of wave buoy measurements based on the satellite signal analysis the so called gps buoys both types of sensors as well as their combination have become widespread in various oceanographic applications e g ndbc buoys for long term records not limited to wave measurements only meindl and hamilton 1992 specialized wave sensors e g datawell triaxys burdette et al 1978 steele et al 1985 miles et al 2003 the swift drifter for air sea interaction investigation thomson 2012 the skib for wave current interaction studies veras guimarães et al 2018 a tempting aspect of the wave buoy performance improvement is decreasing of the hull size aimed at better sensitivity to the shorter waves the typical size of the accelerometer based buoy is about 1 m or more while conventional gps buoy is 40 cm in diameter providing a high frequency cut off of the estimated wave spectrum at about 0 4 0 6 hz though the most energetic waves are normally resolved the unresolved short wave part of the spectrum is of critical importance for the air sea interaction investigation upper layer dynamics studies ocean remote sensing techniques development etc see donelan and pierson 1987 hara et al 1998 kudryavtsev et al 1999 and references therein the size of traditional gimbaled accelerometer sensors and corresponding geometric cut off wavelength cannot be significantly reduced because a mechanically stabilized system cannot be too small the same holds for the gps based sensors that must meet the requirement for some minimal gps antenna size herbers et al 2012 the possible solution is to use hull fixed strapped down accelerometers earle and bush 1982 earle et al 1984 formerly this simplification was aimed at reducing buoy power consumption and total production expenses at the cost of vertical acceleration signal contamination by non vertical motions today with progress in the micro electro mechanical system mems technology ultra compact inertial motion units imu are widely available and used in a variety of applications e g robotics unmanned aerial vehicle control wearable electronics entertainment industry etc ocean wave sensing is not an exception in this list miles et al 2003 macisaac and naeth 2013 naeth et al 2016 crandle et al 2016 the marked feature of a modern mems based imu is the possibility to measure the angular rate of the sensor providing three more degrees of freedom in the orientation retrieval algorithm the so called 9dof sensor the tri axis accelerometer gyroscope and magnetometer virtually this allows for direct orientation retrieval and elimination of the strapping down effects but finite sensor noise makes the problem non trivial but still solvable krogstad et al 1999 miles et al 2003 tengberg et al 2018 generally mems based wave buoys are based on the imu specially adapted to the wave motion measurements seaview systems inc 2019 maritime 2019 axys technologies inc 2005 in these imus raw signals of the 9dof sensor are processed with a proprietary firmware outputting the parameters necessary for the directional wave spectrum estimates e g hull heave pitch and roll on the one hand this precludes any fine tuning of the algorithms used for the hull orientation retrieval on the other hand this makes these imus many times more expensive and bigger than the 9dof sensor itself for example a commercial off the shelf 9dof sensor housed in a 3 3 1 mm package is available at the wholesale price of about 1 5 eur it is understood that with minimal hardware necessary for data acquisition such a small sensor can be used to build an ultra small buoy capable to resolve much shorter waves compared to the commercially available buoys the goal of the present study is to check if a conventional capacitive silicone based mems sensor quite small cheap and formerly targeted at the entertainment industry is sufficient to measure the sea surface waves all possible useful features of the traditional wave buoys like long term autonomy endurance renewable power source remote control data access are intentionally sacrificed to reduce the buoy hull size and to extend the sensitivity bandwidth the only ability of the micro controller unit driving the sensor is to store the raw measurements on a flash memory card to process it in the post deployment stage the buoy hardware is enclosed in the plastic container which can be plugged into a discus float of desirable size we had several days of field experiments at the black sea research platform measuring waves using this buoy prototype and a six wire resistive wave gauge from these simultaneous measurements and the longuet higgins et al 1961 classical approach to estimate the directional wave spectrum we show that the standard wave parameters can be confidently retrieved using our buoy with total costs several times less than the typical wave buoy the proposed design provides at least twice wider bandwidth as well as much easier deployment recovery due to the reduced hull size a feature useful in short term oceanographic campaigns or dedicated field experiments with tens to hundreds of drifting non recoverable buoys 2 the buoy the buoy fig 1 is built up around the capacitive silicone based mems sensor mpu9250 invensense inc 2016 combining tri axis accelerometer vibratory gyroscope and hall effect magnetometer the sensor is controlled via the i2c bus by the arduino pro micro 3 3 v 8 mhz board based on the atmega328 8 bit micro controller the raw sensor readings are stored on a micro sdhc flash memory card up to 32 gb is supported the time reference is provided by the onboard ds3121 real time clock unit the power is supplied with the 14250 3 7 v 280 mah li ion battery rechargeable via the tp4056 board the buoy interface has the micro usb socket for battery charging the micro sdhc slot for memory card changing and the 4 pin dip switch for buoy activation and control the circuits and battery are packed into a plastic hull polyethylene terephthalate bottle preform which has a stainless steel lug sealed with a rubber gasket within the hull the total buoy weight is 52 g the hull is inserted into the expanded polystyrene 14 cm diameter discus shaped float to provide additional buoyancy and stability of the buoy the hull is tied to the reel using the 0 5 mm braided line enduring up to 50 kg tensile strength during the measurements the buoy is freely drifting with the sea surface until the whole holding line 150 m length is reeled off after that the buoy can be pulled back using the line and continue the measurements from the initial point if a longer time series is necessary for better statistical averaging the pulling back time intervals are discarded based on the measured gravity vector it deviates significantly from the vertical when the buoy is pulled back the restriction of this partly drifting regime is the limited continuous fragment duration and hence spectrum frequency resolution determined by the ratio of holding line length and drift current velocity for example for the 150 m line length and typical 1 min fragment duration the maximal drift velocity is about 2 5 m s at the same time the drifting design avoids tethering and its impact on the measurements as well as doppler shift distortions due to the long wave orbital motions the raw sensor readings ten channels three components for accelerometer gyroscope and magnetometer and sensor temperature are sampled as a two byte word sequence maximal stable sampling frequency allowed by the buoy hardware is 160 hz per channel even at that high frequency the raw data rate is 5 88 mb h and an 8gb flash card stores up to 56 days of raw data while the maximal deployment time 15 h is limited by the battery capacity average current consumption is 18 ma thus the raw data is recorded at the highest possible sampling rate 160 hz for better data quality control the full scale range of measured values is set to 2 g for the accelerometer where g 9 8 m s 2 is the gravitational acceleration 500 deg s for the gyroscope and 4800 μ t for the magnetometer 3 experiment field buoy measurements were carried out at the black sea research stationary platform fixed at the 30 m depth 600 m south east of the kikeneiz cape 4 4 2 3 3 5 n 3 3 5 9 0 4 e the measurements were taken on june 3 5 2019 with wind speed varying from 1 m s to 15 m s and dominant waves not exceeding 40 m in length the buoy was deployed several times per experiment day for about 30 min in the sea simultaneously the directional surface wave spectra were measured by the six wire resistive wave gauges arranged in a centered pentagon of radius 0 25 m installed on the 11 m length mechanized boom standard meteorological parameters including wind speed and direction were continuously monitored by the local meteorological sensors installed on the platform mast fig 2 gives an overview of the environmental conditions during the experiment on the first experiment day 03 jun a rather pure wind sea was observed while on the next two days there were some upwind 04 jun and cross wind 05 jun swell systems mixed to the wind sea the sea water and air temperatures were 21 c and 25 c respectively 4 data processing we follow the approach by longuet higgins et al 1961 to estimate the sea surface directional spectrum from time series analysis the method is based on the linear wave theory and truncated fourier expansion of the directional spreading function only the first five fourier series terms can be unambiguously retrieved with this approach this truncated form of the spreading function limits the resulting directional resolution of the method and can result in negative spectrum areas to overcome this issue various extended and sophisticated techniques have been proposed see reviews by benoit 1993 krogstad 2005 unlike these approaches the straightforward longuet higgins et al 1961 method being free of additional statistical assumptions parameter tuning and possible spurious spectral peaks remains a standard in the routine wave data processing e g earle et al 1996 krogstad and trulsen 2010 veras guimarães et al 2018 briefly the linear wave theory provides the relationship between wave frequency and wavenumber 2 π f 2 g k tanh k h where f is the wave frequency g is the gravitational acceleration k is the wavenumber h is the water depth in our experimental conditions the shallow water effects are negligible thus we use deep water wave approximation tanh k h 1 following the notations of earle et al 1996 the elevation spectrum is represented as the first five terms of fourier series s f θ a 0 2 n 1 2 a n cos n θ b n sin n θ or separating the spectrum into the omnidirectional part c ζ ζ f and directional spreading function d f θ s f θ c ζ ζ f d f θ where c ζ ζ π a 0 1 d f θ 1 π 1 2 n 1 2 r n cos n θ θ n and r n a n 2 b n 2 a 0 2 θ n 1 n arctan b n a n where θ 1 and θ 2 are the mean and principal wave direction respectively directional width of the spectrum as determined from the first and second angular moments reads 3 σ n 7 3 n 2 1 r n five fourier coefficients a 0 a 1 a 2 b 1 and b 2 are calculated from the power spectral density estimate of the measured time series s 12 c 12 i q 12 where c is the co spectrum q is the quadrature spectrum the subscripts 1 and 2 correspond to one of the measured signals e g elevation tilt acceleration the spectrum is calculated using fast fourier transform with averaging over consequent 1 min signal segments 4 1 reference wave gauge signal processing the wave gauge simultaneously measures surface elevations at the known spatial grid from these data if more than three signals are available one can estimate instantaneous first order surface geometry averaged over the grid scale 0 5 m in our case this technique the triplet analysis is well established and presented in detail by krogstad 2005 an example of applying this method to the wave gauge used in this study as well as more details on the practical usage of this instrument can be found in bondur et al 2016 briefly the instantaneous surface elevations measured by the wave gauge strings are fitted by a plane using least squares method yielding north south ζ y and east west ζ x surface tilts and elevation ζ for which the longuet higgins et al 1961 parameters read as follows a 0 c ζ ζ π a 1 q ζ x k π b 1 q ζ y k π a 2 c x x c y y k 2 π b 2 2 c x y k 2 π with the subscripts ζ is for the elevation positive upwards x is for the east west tilt y is for the north south tilt the wavenumber k is computed from the ratio of elevation and slope spectra k 2 c x x c y y c ζ ζ 4 2 buoy measurements the imu used in the buoy measures gravity rotation rate and magnetic field vectors in the reference frame linked to the buoy hull strapped down sensor to apply the longuet higgins et al 1961 approach one needs to know the georeferenced vertical acceleration and tilts let the reference frame of the sensor fig 3 x y z axes is transformed into the earth reference frame x y z axes pointed to the east north and upwards respectively by the rotation matrix r that relates the measured and georeferenced signals 4 a r a ω r ω m r m where the lowercase a ω m are the measured acceleration rotation rate and magnetic field respectively while the capitals a ω m correspond to the georeferenced vectors if the buoy accurately follows the water surface ζ ζ x y t the z axis is normal to the surface tangent plane the buoy tilts corresponds to the sea surface slopes ζ x ζ x and ζ y ζ y for the sake of convenience we represent the total rotation transform r as i r 1 the rotation around z axis by an angle ϕ the buoy azimuth angle and ii r 2 the consequent buoy tilting that matches the buoy vertical axis z axis to the sea surface normal the rotation matrices of these transforms read as follows korn and korn 1968 r r 1 r 2 r 1 cos ϕ sin ϕ 0 sin ϕ cos ϕ 0 0 0 1 r 2 1 1 ρ 1 ρ ζ y 2 ϵ 2 ρ ζ x ζ y ϵ 2 ζ x ρ ζ x ζ y ϵ 2 1 ρ ζ x 2 ϵ 2 ζ y ζ x ζ y 1 where ρ 1 ϵ 2 1 and ϵ ζ x 2 ζ y 2 is the total sea surface slope next we adopt the small slope approximation ϵ 1 in which the total transform matrix can be written 5 r cos ϕ sin ϕ ζ x cos ϕ ζ y sin ϕ sin ϕ cos ϕ ζ x sin ϕ ζ y cos ϕ ζ x ζ y 1 1 o ϵ 2 the accelerometer measures the gravity vector rather than the sensor kinematic accelerations thus the apparent gravity signals resulted from wave motion are a x g o ϵ a y g o ϵ a z g o ϵ g accounting for eqs 4 and 5 the accelerometer measurements can be expressed via the wave motion accelerations a x a x g ζ x cos ϕ a y g ζ y sin ϕ o ϵ 2 a y a x g ζ x cos ϕ a y g ζ y sin ϕ o ϵ 2 6 a z a z o ϵ 2 the wave motion accelerations are a x g ζ x o ϵ 2 and a y g ζ y o ϵ 2 thus the horizontal accelerometer signals a x and a y are not related to the linear wave properties and reflect the wave nonlinearity and or imperfect buoy following of the water surface the surface rotation rates in vertical planes are determined by wave motion ω x 2 π f o ϵ and ω y 2 π f o ϵ while in the horizontal plane it is of the same order or slower ω z 2 π f o ϵ from eqs 4 and 5 we have expressions for the gyroscope measurements 7 ω x ω x cos ϕ ω y sin ϕ o ϵ 2 8 ω y ω x sin ϕ ω y cos ϕ o ϵ 2 9 ω z ω z o ϵ 2 to the first order in slope the surface radial frequency can also be written korn and korn 1968 10 ω x ζ y t o ϵ 2 11 ω y ζ x t o ϵ 2 12 ω z ϕ t o ϵ 2 the magnetic field in the earth reference frame is known and supposed to be constant during the measurements thus the magnetic field vector measured by the sensor is determined by eqs 4 and 5 13 m x m x m z ζ x cos ϕ m y m z ζ y sin ϕ o ϵ 2 14 m y m x m z ζ x sin ϕ m y m z ζ y cos ϕ o ϵ 2 m z m z m x ζ x m y ζ y o ϵ 2 4 3 buoy signal processing for convenience we introduce complex variables m m x i m y m m x i m y ω ω x i ω y ω ω x i ω y ζ ζ x i ζ y where i is an imaginary unit in these notations the georeferenced tilts can be obtained in two ways using either gyroscope data and eqs 7 8 10 11 or magnetometer data and eqs 13 14 15 ζ t i ω ω e i ϕ π 2 16 ζ m e i ϕ m m z provided buoy azimuth angle ϕ is known this angle is calculated by integrating the gyroscope rotation rate in the horizontal plane see eqs 9 12 ϕ t ϕ 1 t ϕ 0 ϕ 1 t 0 t ω z d t where ϕ 0 is the integration constant determined from eq 16 ϕ 0 arg m e i ϕ 1 m where arg is the argument of a complex number and denotes averaging over a time interval much longer than the dominant wave period we used the same 1 min fragment averaging as for the fourier spectrum estimation we tried both approaches eqs 15 and 16 and found only a slight cosmetic difference favoring the gyroscope derived tilts in the final validation results thus we used eq 15 for the buoy tilts estimation the vertical accelerometer signal a z can be used as a proxy for the georeferenced vertical wave acceleration a z in the linear wave approximation see eq 6 for the tilts and vertical acceleration the longuet higgins et al 1961 parameters for spectrum estimation are as follows a 0 c a a π 2 π f 4 a 1 q a x k π 2 π f 2 b 1 q a y k π 2 π f 2 a 2 c x x c y y k 2 π b 2 2 c x y k 2 π with the subscripts a is for the vertical acceleration x is for the east west tilt y is for the north south tilt and k is computed from the acceleration and slope spectra ratio k 2 2 π f 4 c x x c y y c a a 5 calibration and accuracy check the wave gauge was calibrated during the experiment by simply raising and lowering the whole wave gauge chassis by multiple known elevations averaging out surface wave signal provided the raw signal calibration dependence with final wave height retrieval accuracy of better than 1 cm the buoy sensor was calibrated in several steps with special attention paid to the noise performance evaluation first the zero offsets were estimated from a set of measurements with various sensor orientations second the sensor static noise was estimated at different temperatures third the motion response was checked in a laboratory experiment with the sensor rotating at a variable rate with a different orbit radius in fact this calibration was aimed at checking the specification parameters provided by the manufacturer invensense inc 2016 the comparison of declared and estimated parameters are given in table 1 generally all estimated values are found falling within the specification limits below we briefly represent each step of the calibration and discuss the parameters most important for wave measurements 5 1 magnetometer and accelerometer zero offset there is a non zero offset in all sensor measurements when they are expected to be zero a typical mems sensor drawback the gyroscope offset can be estimated from a single orientation static record when the true rotation rate signal is zero the magnetic field and acceleration measurements always contain a non zero true signal thus their offsets are estimated from a set of measurements with various orientations let the arbitrary true vector v is measured by a sensor with constant offset vector v 0 then for each sensor reference frame we have v x v x 0 2 v y v y 0 2 v z v z 0 2 c 2 where v x v y v z are the measurements v x 0 v y 0 v z 0 are the unknown offsets and c is the unknown constant true vector absolute value gravitational acceleration is known but the local magnetic field can be distorted at different earth location this equation can be rewritten 17 v x v x 0 v y v y 0 v z v z 0 c 2 2 v 0 2 2 v 2 2 with more than five non co linear orientations eqs 17 give an overdetermined linear equation system that is solved by the least square error method notice for the magnetic offset estimation the sensor can be rotated continuously while in the acceleration calibration the sensor should be stabilized in each orientation to provide a constant absolute value of the true acceleration pure gravitational acceleration 5 2 gyroscope zero offset azimuth referencing in the proposed method is based on the matching the gyroscope derived and magnetic derived azimuths averaged over 1 min fragments within the fragment the estimated azimuth angle can drift due to the gyroscope offset the offset is estimated from a single static calibration record made before the measurements yet the offset is a function of sensor temperature t s thus we also have made the static calibration at t s varied from 15 c to 55 c fig 4 we have found that the gyroscope offset variation never exceeds the specification limits table 1 in the presented t s limits generally during the wave measurements the sensor temperature is well stabilized by the surrounding water in our experiment the sensor temperature was always t s 25 5 c in this range the offset trend is about 0 021 deg s c for the z axis rotation rate component this resulted in a no more than 0 21 deg s offset uncertainty and thus at worst in a 12 deg azimuth error accumulated during the 1 min intervals and corresponding spectrum width broadening we tolerated this error and assumed the gyroscope offset constant for the whole dataset noting that in worse conditions e g larger sensor temperature variability the error can be minimized using the calibrated offset temperature dependence 5 3 scale factors absolute measurements are related to the raw sensor readings by scale factors in the present method the absolute sea surface elevations and tilts are retrieved from the accelerations and rotation rates respectively while the magnetic vector is always normalized by its absolute value i e only magnetic vector orientation matters and magnetic scale factor is ignored the accelerometer and gyroscope scale factors were estimated in the calibration experiment with the sensor mounted on a rigid bar rotated by a motor when the bar rotated uniformly at a given radial speed ω there was a constant centrifugal acceleration in the sensor frame of reference a ω 2 ρ where ρ is the radius of the sensor orbit the rotation rate was changed by varying the voltage applied to the motor and precisely validated from the number of cycles per record duration the orbit radius was also changed by moving the sensor along the bar by a known distance with the sensor z axis aligned to the bar axis the orbit inclination was leveled to a horizontal and vertical plane to check the z axis acceleration component response to ideally a constant and the most variable artificial acceleration respectively as a result the accelerometer and gyroscope scale factors estimated in this laboratory experiment fig 5 match the manufacturer values within a 1 confidence interval table 1 while the specification declares a 3 scale factor tolerance 5 4 noise floor and sensitivity in wave measurements the critical issue of mems based sensors is the accelerometer noise floor transforming water surface accelerations into elevations involves double integration or in the spectral domain dividing the acceleration power spectrum by an f 4 factor this procedure inevitably impacts the low frequency part of the resulting elevation spectrum the accelerometer noise floor indicated in the specification was checked using the static calibration data the noise floor of y axis acceleration was found somewhat higher than that of the x axis and z axis but still generally lower than the specification value fig 6 lower curves the total root mean square noise was also found within the expected limits in the operational sensor temperature range t s 25 5 c table 1 to estimate the motion influence on the noise performance of the accelerometer we used the signals of the sensor rotating at a constant rate but with different horizontal orbit radius i e different constant centrifugal acceleration along z axis fig 6 upper curves the peaks at f 2 2 hz and some multiple frequencies correspond to the sensor rotation frequency due to imperfect orbit alignment in the horizontal plane and a small portion of oscillating gravitational acceleration projection outside the peaks the spectrum slightly increases towards zero frequency with a certain increase of the low frequency level at higher centrifugal accelerations on the one hand this result can be interpreted as a motion impact on the accelerometer noise floor on the other hand we made this check record with a simple gear reduction motor thus some rotation noise could still contaminate this estimated non static noise floor of the sensor moreover the real accelerations observed in the sea are normally less than g 9 8 m s 2 the higher values mean wave breaking thus in the worst case if the rotation noise is misread as an intrinsic noise the non static noise floor upper level is no more than 1 0 3 m 2 s 3 another important noise related parameter of the sensor is the minimal detectable wave height determined by the noise floor and the accelerometer quantization error δ a 6 1 0 4 m s 2 the inverse scale factor table 1 since the wave height ζ is dependent on both acceleration and wave frequency ζ a 2 π f 2 the minimal detectable wave height cannot be directly evaluated without knowledge of the wave spectrum thus we estimate the noise equivalent significant wave height swh from the noise spectrum truncated below the peak frequency f p the static noise spectrum is used for this estimate because the weakest signals are considered the wave height quantization error was estimated for the monochromatic wave of the corresponding frequency δ ζ δ a 2 π f p 2 as a measure for f p we choose two characteristic values 0 2 hz typical value for the present experiment data black sea and 0 05 hz typical ocean swell frequency all estimated values table 2 are of the order of millimeters and can be ignored because typical real peak wave heights are measured by decimeters and meters 6 results 6 1 check ratio we start the buoy performance demonstration with presentation of the so called check ratio η which is the ratio between the wave amplitudes estimated from buoy tilts and vertical acceleration longuet higgins et al 1961 krogstad et al 1999 datawell 2019 also known as wave ellipticity the ratio between horizontal and vertical orbital motion amplitudes η g c x x c y y c a a for deep water waves the approximation applicable for our data the check ratio should be 1 the deviation of η from 1 can be treated as a signal corruption due to non ideal wave following check ratios of all available records have rather similar behavior fig 7a a 1 05 1 1 leveled plateau from wave spectral peak frequency f p 0 2 0 3 hz to 5 f p and a local maximum at the frequency f b 2 5 hz the observed check ratio can be qualitatively reproduced by the following simple response model for the one dimensional linear wave z a cos k x we assume that the buoy simply flattens linearly interpolates the water surface beneath it fig 7b the true wave elevation and slope at some point x 0 are ζ a cos k x 0 and ζ x a k sin k x 0 if the buoy is located at the point x 0 it measures somewhat different elevation and slope ζ ζ 1 ζ 2 2 a cos k r cos k x 0 ζ x ζ 2 ζ 1 2 r a sin k r sin k x 0 r where r is the buoy radius thus the buoy amplitude response functions for the elevation the same as acceleration and slope are cos k r and sinc k r sin k r k r respectively with accounting for shallow wave orbit stretching the tanh k h factor the check ratio η for this model reads 18 η 1 tanh k h sinc 2 k r cos 2 k r the model predicts a peak of the check ratio at k r π 2 corresponding to f b 2 36 hz actual buoy float radius is r 7 cm fig 7a red line somewhat less than the observed frequency f b 2 5 hz at this special point the buoy geometric cut off frequency f b hereinafter the model η jumps to infinity while the observed η does not physically this means that when the buoy size equals the half wavelength the sensor stops to respond to the true elevation because the wave profile is interpolated to zero adding noise removes the singularity in the model 19 η 1 tanh k h sinc 2 k r n 1 cos 2 k r n 2 where n 1 and n 2 are the noise to signal ratios for slope and acceleration data respectively for simplicity we ignored the frequency dependence of the noise to signal ratios and decreased the buoy radius to account for the two dimensionality of the buoy in the one dimension model the model qualitatively fits the data fig 7a blue line with n 1 0 35 n 2 0 40 and buoy radius decreased by 20 to r 5 5 cm at the sub peak frequencies the model does not match observations suggesting that its rapid growth towards zero frequency is not caused by the shallow water effects below the peak the linear wave signals tend to zero and the check ratio is totally governed by the tilt and acceleration noise levels this noise is not primarily the intrinsic sensor noise but rather a low frequency motion noise or a result of non linear harmonics krogstad and trulsen 2010 as it will be discussed further 6 2 particular wave situations directional and omnidirectional wave characteristics typical for each of the three experiment days estimated from buoy and reference wage gauge measurements are shown in the figs 8 9 10 from the wave gauge observations the first day jun 03 can be characterized by a pure wind sea generated by west wind fig 8 the wave spectral density was close to the f 4 sloped spectrum the toba s 1973 parameterization is shown for the comparison on the second day jun 04 there was a rather strong swell opposite to the wind blowing from the east fig 9 next day jun 05 the wind has been turned around again while the swell well separated from the wind peak f p 0 8 hz but much weaker than the day before was coming from the upwind to cross wind direction fig 10 a comparison of the directional spreading functions figs 8 10a b reveals a slight but systematic difference between the wave gauge and buoy data the wave gauge fails to estimate directional wave parameters at f 1 2 hz because the wave gauge has a lower cut off frequency corresponding to twice the base length 50 cm f w 1 2 hz the same mismatch is also seen in the wave directions figs 8 10c and directional widths figs 8 10d that are generally similar below f w but at higher frequencies the wave gauge θ becomes noisy while σ grows faster the 1d spectra figs 8 10e are also consistent for f p f 1 hz while at higher frequencies the wave gauge spectral density is somewhat higher this can be explained by the doppler shift of the high frequency components riding on the longer waves the drifting buoy lagrangian sensor is free of this effect while the wave gauge eulerian sensor is not this is highlighted by the measurements on 05 jun fig 10e in this case the doppler shift from the rather weak long wave swell is small hence the short wave part of the buoy and wave gauge spectra are more consistent numerical simulations of this effect korotkevich 2008 indicate an increase of the spectrum at f 5 f p for typical 0 1 peak wave steepness similarly to our observations in the sub peak frequency range f f p the buoy 1d spectra are unrealistically high as confirmed by the wave gauge measurements buoy wave direction θ also differs from the wave gauge measurements at these frequencies 6 3 overall comparison admitting the inability of the buoy to reproduce the sub peak part of the wave spectrum we correct the buoy data for the further estimates by zeroing the spectra below their first local minima dashed lines in figs 8 10e notice the similar high pass filtering is a common practice for the accelerometer based buoys datawell 2019 with this correction applied the buoy 2d spectra generally agree with wave gauge data at the frequencies reliable for validation f f w fig 11a wave direction and spectral width plotted against frequency are consistent but also demonstrate increased scatter at high frequencies fig 11b c yet the basic integral wave characteristics are vastly determined by the spectral peak thus the significant wave height h s 4 s f d f wave peak period t p 1 f p and peak wave directions θ 1 f p from both wave gauge and buoy data are consistent within the 95 confidence interval due to sampling variability fig 12 there is a 7 bias in the estimated peak wave directions that can be explained first by the quite complex wave conditions for records 10 11 12 on 05 jun young wind waves on the background of several misaligned swell systems fig 10 second a possible magnetic field distortion at the experiment site due to the large amount of metal platform material the issues of low frequency noise and high frequency sensitivity are discussed in more detail in the next section 7 discussion in general comparing the buoy and reference wave gauge measurements we can note that the buoy performance is similar to that of the wave gauge for the most energetic waves resolved by the wave gauge f p f f w thus the basic wave parameters are well reproduced the high frequency waves f w f f b are resolved better by the buoy than by the wave gauge with the upper frequency limit determined by the buoy cut off frequency f b 2 5 hz in the sub peak frequency range f f p there is a noise distorting the real wave signal but this is a common problem of any accelerometer based sensor ashton and johanning 2015 amplified by the f 4 factor relating elevation and acceleration spectra the calibration test records see section 5 suggest that the nature of this noise is not sensor intrinsic the static specification noise is less than 10 5 m 2 s 3 as proved by the static test records this is 2 to 4 orders weaker than the wave signal below f p fig 13a color and black lines respectively the upper level of the non static noise level is 1 0 3 m 2 s 3 but expected to be lower in more rigorous laboratory conditions see discussion in section 5 4 even so this level is much less than the low frequency noise observed in the sea the non intrinsic origin of this noise is also understood from a clear dependence of its level on the wind speed that is seen in fig 13a based on the ocean and wave tank measurements by a 1 5 m discus hulled buoy stewart 1977 suggested that the low frequency noise arises due to the non linear response of the buoy on the high frequency motions this effect is inherent in various non linear systems e g a microwave radar transfer function yurovsky et al 2018 including the self nonlinearity of the sea surface as well krogstad and trulsen 2010 thus provided the short wave roughness is wind dependent the low frequency spectral density reflects the variance of high frequency components the nonlinearity of the buoy response arises due to the imperfect surface following and depends on the sensor position relative to the hull metacenter they both can be minimized by a more sophisticated signal processing and advanced hull design but for the present study we stop at this point because the low frequency noise floor of our buoy is comparable to the similar devices e g 0 023 m 2 s 3 level reported by veras guimarães et al 2018 for the skib buoy at 6 m s wind speed this result also suggests that today buoy performance generally depends on the hull design and data processing algorithm rather than on the signal to noise ratio of the sensor thus conventional low cost mems based imus can be effectively used for ocean wave measurements the high frequency limit of the buoy operating frequency range is determined by its hull size in line with stewart s 1977 results the attenuation starts to be visible fig 13a at the frequency corresponding to twice the hull diameter f b 2 5 hz above this frequency the spectrum is significantly damped as it is seen from the comparison with theoretical acceleration spectra compare fig 13a and b simulated using the kudryavtsev et al 1999 semi empirical model trained on the optical measurements yurovskaya et al 2013 in simulations the peak frequency was fixed at 0 2 hz by varying the wave age with wind speed an interesting feature is that the spectrum is not damped to the noise floor for f 40 hz and the buoy is yet sensitive to the wave components shorter than the hull size a well known feature of the short wave surface spectrum is its wind dependent tail though been attenuated this tail is still reproduced by the buoy measurements with similar variability at the given wind speed range this is proved by the frequency dependence of the spectrum wind exponent α f s f u s 0 f u α f the slope of spectrum wind dependence in a log log scale α is estimated from the linear regression model ln s s 0 α ln u where u is the wind speed the wind exponent is not sensitive to the absolute level of the spectrum nor the attenuation factor imposed by the buoy response function and thus can be directly compared to the theory fig 13c at frequencies from peak to f 4 hz the measurements and the model show similar trends but differ each other in magnitude reflecting the fact that the dominating waves at the experiment site and time are not purely wind driven as suggested by the model at high frequencies f 4 hz the measurements and the model demonstrate a surprising agreement up to f 8 hz 3 cm wavelength at even higher frequencies f 8 hz the measured wind exponent saturates at about 1 5 level while the model one keeps increasing despite the detected discrepancies the overall consistency is encouraging in the respect that the kudryavtsev et al 1999 model was developed based on completely different data apparently this remarkable short wave sensitivity is possible thanks to a good performance of the mems based imu at high frequencies due to their ultra small size at these frequencies the sensor of the buoy is sensitive to the wave motions itself as well as to the ambient acoustic noise generated by surface waves farrell and munk 2008 the transfer function at these frequencies including resonant hull effects acoustic sensitivity etc is complex but a proper calibration can help to extend the operating range of mems based buoy to the scales even shorter than the hull diameter this falls out the scope of the present study but opens a perspective to develop a new contact sensor for the short wave spectrum investigation an important subject generally attainable by remote sensing techniques only 8 conclusion we present a wave buoy based on one of the low cost capacitive silicon based micro electro mechanical system mems sensors mpu9250 invensense inc 2016 that now are widely used in the entertainment industry and wearable electronics the buoy prototype is tested in a field experiment at the black sea research platform under 1 to 15 m s wind speed and up to 40 m dominant wavelengths the experiment besides standard meteorological observations included the six wire wave gauge measurements for reference directional surface spectra estimates the imu raw signals tri axis acceleration rotation rate and magnetic field are stored on a microsd flash memory card and processed after the measurements the buoy design is intentionally simplified to reduce its hull size and thus increase the short wave sensitivity the measurements are performed in a drifting regime to avoid the impact of holding line and doppler shifts of long waves the classical longuet higgins et al 1961 method is used to compute directional spectra the georeferenced buoy tilts and vertical acceleration are derived to the first order in slope from the strapped down accelerometer magnetometer and gyroscope measurements in this small wave slope approximation the buoy and reference wave gauge measurements broadly agree in the frequency range of most energetic waves thus the standard wave parameters significant wave height wave peak period and direction are well reproduced by the first order buoy estimates the directional spectra high frequency cut off of the buoy is higher than that of the wave gauge for the 14 cm discus buoy float this cut off corresponds to wavelength twice the buoy diameter f b 2 5 hz in line with stewart s 1977 findings at the same time the sub peak spectrum is distorted by the wind dependent low frequency noise arising due to the non linear hull response to the surface waves a common problem of accelerometer based buoy measurements rather than sensor noise issue these results demonstrate that low cost mems based sensors can be used for surface wave measurements at the cost of autonomy the final buoy size can be significantly reduced providing wider surface wave bandwidth as compared to the traditional buoys in our case the cut off frequency is at least 2 5 times higher compared to the smallest 40 cm diameter buoys available on the market this can be useful in short term field campaigns when instrument deployment recovery time is crucial and or knowledge of short waves is necessary the economy effect can be significant if a fleet of numerous buoys is required an interesting feature of the developed buoy is its high frequency sensitivity beyond the geometric cut off frequency the acceleration signal is not attenuated to the static noise but up to a scale factor follows the theory kudryavtsev et al 1999 predicting the wind dependent short wave spectrum tail the plausible mechanism of this short wave sensitivity apart from the high frequency surface motion is acoustic ambient noise generated by short waves farrell and munk 2008 this question needs further investigation which may help to extend the buoy operating frequency range credit authorship contribution statement yury yu yurovsky conceptualization data curation formal analysis methodology software validation visualization writing original draft vladimir a dulov project administration methodology supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the buoy prototype development and field experiments were funded by the fsbsi frc mhi ras state order russia goszadanie no 0827 2019 0004 the data analysis performed in this work was funded by the russian science foundation under grant no 17 77 30019 and rshu state order russia goszadanie no 0763 2020 0005 the authors are grateful to vladimir kudryavtsev for providing the source code of the short wave spectrum model 
21454,low cost commercial micro electro mechanical system mems based inertial motion unit is used for sea surface wave measurements a buoy is developed based on the capacitive silicon based accelerometer gyroscope magnetometer sensor with radically simplified architecture allowing a significant reduction of the buoy hull size down to 14 cm diameter and hence increased high frequency sensitivity the proposed buoy design is suitable for short term manual wave measurements with minimal deployment recovery efforts and or experiments where knowledge of the high frequency part of the spectrum is preferable the buoy data is validated in a field experiment at the black sea stationary research platform using reference measurements of the six wire resistive wave gauge the strapped down buoy measurements are transformed into the georeferenced buoy tilts and vertical acceleration using small wave slope approximation the classical longuet higgins et al 1961 approach is used for directional wave spectra estimation under 1 to 15 m s wind speed pure wind and mixed sea conditions the significant wave height wave peak period wave direction and spectral width are well reproduced by the buoy the buoy geometric cut off frequency about 2 5 hz corresponding to wavelength twice the hull diameter is at least 2 5 times better than that of commercially available buoys the sub peak low frequency noise typical for accelerometer derived spectra is wind dependent and thus is clearly not the intrinsic sensor noise but rather results from the buoy non linear response to the waves the detected high frequency 4 f 80 hz spectrum tail also depends on the wind speed in accord with the short wave wind driven wave spectrum model the observed high frequency sensitivity may be useful for short wave sensing beyond the geometric cut off frequency with mems based sensors keywords sea surface buoy short gravity waves inertial motion unit micro electro mechanical system 1 introduction surface wave buoy is the most common platform for in situ sea state measurements first buoys were designed to measure the hull linear acceleration and pitch roll angles along with the earth magnetic field for true azimuth referencing barber 1946 longuet higgins et al 1961 establishing of global navigation satellite systems have provided a new concept of wave buoy measurements based on the satellite signal analysis the so called gps buoys both types of sensors as well as their combination have become widespread in various oceanographic applications e g ndbc buoys for long term records not limited to wave measurements only meindl and hamilton 1992 specialized wave sensors e g datawell triaxys burdette et al 1978 steele et al 1985 miles et al 2003 the swift drifter for air sea interaction investigation thomson 2012 the skib for wave current interaction studies veras guimarães et al 2018 a tempting aspect of the wave buoy performance improvement is decreasing of the hull size aimed at better sensitivity to the shorter waves the typical size of the accelerometer based buoy is about 1 m or more while conventional gps buoy is 40 cm in diameter providing a high frequency cut off of the estimated wave spectrum at about 0 4 0 6 hz though the most energetic waves are normally resolved the unresolved short wave part of the spectrum is of critical importance for the air sea interaction investigation upper layer dynamics studies ocean remote sensing techniques development etc see donelan and pierson 1987 hara et al 1998 kudryavtsev et al 1999 and references therein the size of traditional gimbaled accelerometer sensors and corresponding geometric cut off wavelength cannot be significantly reduced because a mechanically stabilized system cannot be too small the same holds for the gps based sensors that must meet the requirement for some minimal gps antenna size herbers et al 2012 the possible solution is to use hull fixed strapped down accelerometers earle and bush 1982 earle et al 1984 formerly this simplification was aimed at reducing buoy power consumption and total production expenses at the cost of vertical acceleration signal contamination by non vertical motions today with progress in the micro electro mechanical system mems technology ultra compact inertial motion units imu are widely available and used in a variety of applications e g robotics unmanned aerial vehicle control wearable electronics entertainment industry etc ocean wave sensing is not an exception in this list miles et al 2003 macisaac and naeth 2013 naeth et al 2016 crandle et al 2016 the marked feature of a modern mems based imu is the possibility to measure the angular rate of the sensor providing three more degrees of freedom in the orientation retrieval algorithm the so called 9dof sensor the tri axis accelerometer gyroscope and magnetometer virtually this allows for direct orientation retrieval and elimination of the strapping down effects but finite sensor noise makes the problem non trivial but still solvable krogstad et al 1999 miles et al 2003 tengberg et al 2018 generally mems based wave buoys are based on the imu specially adapted to the wave motion measurements seaview systems inc 2019 maritime 2019 axys technologies inc 2005 in these imus raw signals of the 9dof sensor are processed with a proprietary firmware outputting the parameters necessary for the directional wave spectrum estimates e g hull heave pitch and roll on the one hand this precludes any fine tuning of the algorithms used for the hull orientation retrieval on the other hand this makes these imus many times more expensive and bigger than the 9dof sensor itself for example a commercial off the shelf 9dof sensor housed in a 3 3 1 mm package is available at the wholesale price of about 1 5 eur it is understood that with minimal hardware necessary for data acquisition such a small sensor can be used to build an ultra small buoy capable to resolve much shorter waves compared to the commercially available buoys the goal of the present study is to check if a conventional capacitive silicone based mems sensor quite small cheap and formerly targeted at the entertainment industry is sufficient to measure the sea surface waves all possible useful features of the traditional wave buoys like long term autonomy endurance renewable power source remote control data access are intentionally sacrificed to reduce the buoy hull size and to extend the sensitivity bandwidth the only ability of the micro controller unit driving the sensor is to store the raw measurements on a flash memory card to process it in the post deployment stage the buoy hardware is enclosed in the plastic container which can be plugged into a discus float of desirable size we had several days of field experiments at the black sea research platform measuring waves using this buoy prototype and a six wire resistive wave gauge from these simultaneous measurements and the longuet higgins et al 1961 classical approach to estimate the directional wave spectrum we show that the standard wave parameters can be confidently retrieved using our buoy with total costs several times less than the typical wave buoy the proposed design provides at least twice wider bandwidth as well as much easier deployment recovery due to the reduced hull size a feature useful in short term oceanographic campaigns or dedicated field experiments with tens to hundreds of drifting non recoverable buoys 2 the buoy the buoy fig 1 is built up around the capacitive silicone based mems sensor mpu9250 invensense inc 2016 combining tri axis accelerometer vibratory gyroscope and hall effect magnetometer the sensor is controlled via the i2c bus by the arduino pro micro 3 3 v 8 mhz board based on the atmega328 8 bit micro controller the raw sensor readings are stored on a micro sdhc flash memory card up to 32 gb is supported the time reference is provided by the onboard ds3121 real time clock unit the power is supplied with the 14250 3 7 v 280 mah li ion battery rechargeable via the tp4056 board the buoy interface has the micro usb socket for battery charging the micro sdhc slot for memory card changing and the 4 pin dip switch for buoy activation and control the circuits and battery are packed into a plastic hull polyethylene terephthalate bottle preform which has a stainless steel lug sealed with a rubber gasket within the hull the total buoy weight is 52 g the hull is inserted into the expanded polystyrene 14 cm diameter discus shaped float to provide additional buoyancy and stability of the buoy the hull is tied to the reel using the 0 5 mm braided line enduring up to 50 kg tensile strength during the measurements the buoy is freely drifting with the sea surface until the whole holding line 150 m length is reeled off after that the buoy can be pulled back using the line and continue the measurements from the initial point if a longer time series is necessary for better statistical averaging the pulling back time intervals are discarded based on the measured gravity vector it deviates significantly from the vertical when the buoy is pulled back the restriction of this partly drifting regime is the limited continuous fragment duration and hence spectrum frequency resolution determined by the ratio of holding line length and drift current velocity for example for the 150 m line length and typical 1 min fragment duration the maximal drift velocity is about 2 5 m s at the same time the drifting design avoids tethering and its impact on the measurements as well as doppler shift distortions due to the long wave orbital motions the raw sensor readings ten channels three components for accelerometer gyroscope and magnetometer and sensor temperature are sampled as a two byte word sequence maximal stable sampling frequency allowed by the buoy hardware is 160 hz per channel even at that high frequency the raw data rate is 5 88 mb h and an 8gb flash card stores up to 56 days of raw data while the maximal deployment time 15 h is limited by the battery capacity average current consumption is 18 ma thus the raw data is recorded at the highest possible sampling rate 160 hz for better data quality control the full scale range of measured values is set to 2 g for the accelerometer where g 9 8 m s 2 is the gravitational acceleration 500 deg s for the gyroscope and 4800 μ t for the magnetometer 3 experiment field buoy measurements were carried out at the black sea research stationary platform fixed at the 30 m depth 600 m south east of the kikeneiz cape 4 4 2 3 3 5 n 3 3 5 9 0 4 e the measurements were taken on june 3 5 2019 with wind speed varying from 1 m s to 15 m s and dominant waves not exceeding 40 m in length the buoy was deployed several times per experiment day for about 30 min in the sea simultaneously the directional surface wave spectra were measured by the six wire resistive wave gauges arranged in a centered pentagon of radius 0 25 m installed on the 11 m length mechanized boom standard meteorological parameters including wind speed and direction were continuously monitored by the local meteorological sensors installed on the platform mast fig 2 gives an overview of the environmental conditions during the experiment on the first experiment day 03 jun a rather pure wind sea was observed while on the next two days there were some upwind 04 jun and cross wind 05 jun swell systems mixed to the wind sea the sea water and air temperatures were 21 c and 25 c respectively 4 data processing we follow the approach by longuet higgins et al 1961 to estimate the sea surface directional spectrum from time series analysis the method is based on the linear wave theory and truncated fourier expansion of the directional spreading function only the first five fourier series terms can be unambiguously retrieved with this approach this truncated form of the spreading function limits the resulting directional resolution of the method and can result in negative spectrum areas to overcome this issue various extended and sophisticated techniques have been proposed see reviews by benoit 1993 krogstad 2005 unlike these approaches the straightforward longuet higgins et al 1961 method being free of additional statistical assumptions parameter tuning and possible spurious spectral peaks remains a standard in the routine wave data processing e g earle et al 1996 krogstad and trulsen 2010 veras guimarães et al 2018 briefly the linear wave theory provides the relationship between wave frequency and wavenumber 2 π f 2 g k tanh k h where f is the wave frequency g is the gravitational acceleration k is the wavenumber h is the water depth in our experimental conditions the shallow water effects are negligible thus we use deep water wave approximation tanh k h 1 following the notations of earle et al 1996 the elevation spectrum is represented as the first five terms of fourier series s f θ a 0 2 n 1 2 a n cos n θ b n sin n θ or separating the spectrum into the omnidirectional part c ζ ζ f and directional spreading function d f θ s f θ c ζ ζ f d f θ where c ζ ζ π a 0 1 d f θ 1 π 1 2 n 1 2 r n cos n θ θ n and r n a n 2 b n 2 a 0 2 θ n 1 n arctan b n a n where θ 1 and θ 2 are the mean and principal wave direction respectively directional width of the spectrum as determined from the first and second angular moments reads 3 σ n 7 3 n 2 1 r n five fourier coefficients a 0 a 1 a 2 b 1 and b 2 are calculated from the power spectral density estimate of the measured time series s 12 c 12 i q 12 where c is the co spectrum q is the quadrature spectrum the subscripts 1 and 2 correspond to one of the measured signals e g elevation tilt acceleration the spectrum is calculated using fast fourier transform with averaging over consequent 1 min signal segments 4 1 reference wave gauge signal processing the wave gauge simultaneously measures surface elevations at the known spatial grid from these data if more than three signals are available one can estimate instantaneous first order surface geometry averaged over the grid scale 0 5 m in our case this technique the triplet analysis is well established and presented in detail by krogstad 2005 an example of applying this method to the wave gauge used in this study as well as more details on the practical usage of this instrument can be found in bondur et al 2016 briefly the instantaneous surface elevations measured by the wave gauge strings are fitted by a plane using least squares method yielding north south ζ y and east west ζ x surface tilts and elevation ζ for which the longuet higgins et al 1961 parameters read as follows a 0 c ζ ζ π a 1 q ζ x k π b 1 q ζ y k π a 2 c x x c y y k 2 π b 2 2 c x y k 2 π with the subscripts ζ is for the elevation positive upwards x is for the east west tilt y is for the north south tilt the wavenumber k is computed from the ratio of elevation and slope spectra k 2 c x x c y y c ζ ζ 4 2 buoy measurements the imu used in the buoy measures gravity rotation rate and magnetic field vectors in the reference frame linked to the buoy hull strapped down sensor to apply the longuet higgins et al 1961 approach one needs to know the georeferenced vertical acceleration and tilts let the reference frame of the sensor fig 3 x y z axes is transformed into the earth reference frame x y z axes pointed to the east north and upwards respectively by the rotation matrix r that relates the measured and georeferenced signals 4 a r a ω r ω m r m where the lowercase a ω m are the measured acceleration rotation rate and magnetic field respectively while the capitals a ω m correspond to the georeferenced vectors if the buoy accurately follows the water surface ζ ζ x y t the z axis is normal to the surface tangent plane the buoy tilts corresponds to the sea surface slopes ζ x ζ x and ζ y ζ y for the sake of convenience we represent the total rotation transform r as i r 1 the rotation around z axis by an angle ϕ the buoy azimuth angle and ii r 2 the consequent buoy tilting that matches the buoy vertical axis z axis to the sea surface normal the rotation matrices of these transforms read as follows korn and korn 1968 r r 1 r 2 r 1 cos ϕ sin ϕ 0 sin ϕ cos ϕ 0 0 0 1 r 2 1 1 ρ 1 ρ ζ y 2 ϵ 2 ρ ζ x ζ y ϵ 2 ζ x ρ ζ x ζ y ϵ 2 1 ρ ζ x 2 ϵ 2 ζ y ζ x ζ y 1 where ρ 1 ϵ 2 1 and ϵ ζ x 2 ζ y 2 is the total sea surface slope next we adopt the small slope approximation ϵ 1 in which the total transform matrix can be written 5 r cos ϕ sin ϕ ζ x cos ϕ ζ y sin ϕ sin ϕ cos ϕ ζ x sin ϕ ζ y cos ϕ ζ x ζ y 1 1 o ϵ 2 the accelerometer measures the gravity vector rather than the sensor kinematic accelerations thus the apparent gravity signals resulted from wave motion are a x g o ϵ a y g o ϵ a z g o ϵ g accounting for eqs 4 and 5 the accelerometer measurements can be expressed via the wave motion accelerations a x a x g ζ x cos ϕ a y g ζ y sin ϕ o ϵ 2 a y a x g ζ x cos ϕ a y g ζ y sin ϕ o ϵ 2 6 a z a z o ϵ 2 the wave motion accelerations are a x g ζ x o ϵ 2 and a y g ζ y o ϵ 2 thus the horizontal accelerometer signals a x and a y are not related to the linear wave properties and reflect the wave nonlinearity and or imperfect buoy following of the water surface the surface rotation rates in vertical planes are determined by wave motion ω x 2 π f o ϵ and ω y 2 π f o ϵ while in the horizontal plane it is of the same order or slower ω z 2 π f o ϵ from eqs 4 and 5 we have expressions for the gyroscope measurements 7 ω x ω x cos ϕ ω y sin ϕ o ϵ 2 8 ω y ω x sin ϕ ω y cos ϕ o ϵ 2 9 ω z ω z o ϵ 2 to the first order in slope the surface radial frequency can also be written korn and korn 1968 10 ω x ζ y t o ϵ 2 11 ω y ζ x t o ϵ 2 12 ω z ϕ t o ϵ 2 the magnetic field in the earth reference frame is known and supposed to be constant during the measurements thus the magnetic field vector measured by the sensor is determined by eqs 4 and 5 13 m x m x m z ζ x cos ϕ m y m z ζ y sin ϕ o ϵ 2 14 m y m x m z ζ x sin ϕ m y m z ζ y cos ϕ o ϵ 2 m z m z m x ζ x m y ζ y o ϵ 2 4 3 buoy signal processing for convenience we introduce complex variables m m x i m y m m x i m y ω ω x i ω y ω ω x i ω y ζ ζ x i ζ y where i is an imaginary unit in these notations the georeferenced tilts can be obtained in two ways using either gyroscope data and eqs 7 8 10 11 or magnetometer data and eqs 13 14 15 ζ t i ω ω e i ϕ π 2 16 ζ m e i ϕ m m z provided buoy azimuth angle ϕ is known this angle is calculated by integrating the gyroscope rotation rate in the horizontal plane see eqs 9 12 ϕ t ϕ 1 t ϕ 0 ϕ 1 t 0 t ω z d t where ϕ 0 is the integration constant determined from eq 16 ϕ 0 arg m e i ϕ 1 m where arg is the argument of a complex number and denotes averaging over a time interval much longer than the dominant wave period we used the same 1 min fragment averaging as for the fourier spectrum estimation we tried both approaches eqs 15 and 16 and found only a slight cosmetic difference favoring the gyroscope derived tilts in the final validation results thus we used eq 15 for the buoy tilts estimation the vertical accelerometer signal a z can be used as a proxy for the georeferenced vertical wave acceleration a z in the linear wave approximation see eq 6 for the tilts and vertical acceleration the longuet higgins et al 1961 parameters for spectrum estimation are as follows a 0 c a a π 2 π f 4 a 1 q a x k π 2 π f 2 b 1 q a y k π 2 π f 2 a 2 c x x c y y k 2 π b 2 2 c x y k 2 π with the subscripts a is for the vertical acceleration x is for the east west tilt y is for the north south tilt and k is computed from the acceleration and slope spectra ratio k 2 2 π f 4 c x x c y y c a a 5 calibration and accuracy check the wave gauge was calibrated during the experiment by simply raising and lowering the whole wave gauge chassis by multiple known elevations averaging out surface wave signal provided the raw signal calibration dependence with final wave height retrieval accuracy of better than 1 cm the buoy sensor was calibrated in several steps with special attention paid to the noise performance evaluation first the zero offsets were estimated from a set of measurements with various sensor orientations second the sensor static noise was estimated at different temperatures third the motion response was checked in a laboratory experiment with the sensor rotating at a variable rate with a different orbit radius in fact this calibration was aimed at checking the specification parameters provided by the manufacturer invensense inc 2016 the comparison of declared and estimated parameters are given in table 1 generally all estimated values are found falling within the specification limits below we briefly represent each step of the calibration and discuss the parameters most important for wave measurements 5 1 magnetometer and accelerometer zero offset there is a non zero offset in all sensor measurements when they are expected to be zero a typical mems sensor drawback the gyroscope offset can be estimated from a single orientation static record when the true rotation rate signal is zero the magnetic field and acceleration measurements always contain a non zero true signal thus their offsets are estimated from a set of measurements with various orientations let the arbitrary true vector v is measured by a sensor with constant offset vector v 0 then for each sensor reference frame we have v x v x 0 2 v y v y 0 2 v z v z 0 2 c 2 where v x v y v z are the measurements v x 0 v y 0 v z 0 are the unknown offsets and c is the unknown constant true vector absolute value gravitational acceleration is known but the local magnetic field can be distorted at different earth location this equation can be rewritten 17 v x v x 0 v y v y 0 v z v z 0 c 2 2 v 0 2 2 v 2 2 with more than five non co linear orientations eqs 17 give an overdetermined linear equation system that is solved by the least square error method notice for the magnetic offset estimation the sensor can be rotated continuously while in the acceleration calibration the sensor should be stabilized in each orientation to provide a constant absolute value of the true acceleration pure gravitational acceleration 5 2 gyroscope zero offset azimuth referencing in the proposed method is based on the matching the gyroscope derived and magnetic derived azimuths averaged over 1 min fragments within the fragment the estimated azimuth angle can drift due to the gyroscope offset the offset is estimated from a single static calibration record made before the measurements yet the offset is a function of sensor temperature t s thus we also have made the static calibration at t s varied from 15 c to 55 c fig 4 we have found that the gyroscope offset variation never exceeds the specification limits table 1 in the presented t s limits generally during the wave measurements the sensor temperature is well stabilized by the surrounding water in our experiment the sensor temperature was always t s 25 5 c in this range the offset trend is about 0 021 deg s c for the z axis rotation rate component this resulted in a no more than 0 21 deg s offset uncertainty and thus at worst in a 12 deg azimuth error accumulated during the 1 min intervals and corresponding spectrum width broadening we tolerated this error and assumed the gyroscope offset constant for the whole dataset noting that in worse conditions e g larger sensor temperature variability the error can be minimized using the calibrated offset temperature dependence 5 3 scale factors absolute measurements are related to the raw sensor readings by scale factors in the present method the absolute sea surface elevations and tilts are retrieved from the accelerations and rotation rates respectively while the magnetic vector is always normalized by its absolute value i e only magnetic vector orientation matters and magnetic scale factor is ignored the accelerometer and gyroscope scale factors were estimated in the calibration experiment with the sensor mounted on a rigid bar rotated by a motor when the bar rotated uniformly at a given radial speed ω there was a constant centrifugal acceleration in the sensor frame of reference a ω 2 ρ where ρ is the radius of the sensor orbit the rotation rate was changed by varying the voltage applied to the motor and precisely validated from the number of cycles per record duration the orbit radius was also changed by moving the sensor along the bar by a known distance with the sensor z axis aligned to the bar axis the orbit inclination was leveled to a horizontal and vertical plane to check the z axis acceleration component response to ideally a constant and the most variable artificial acceleration respectively as a result the accelerometer and gyroscope scale factors estimated in this laboratory experiment fig 5 match the manufacturer values within a 1 confidence interval table 1 while the specification declares a 3 scale factor tolerance 5 4 noise floor and sensitivity in wave measurements the critical issue of mems based sensors is the accelerometer noise floor transforming water surface accelerations into elevations involves double integration or in the spectral domain dividing the acceleration power spectrum by an f 4 factor this procedure inevitably impacts the low frequency part of the resulting elevation spectrum the accelerometer noise floor indicated in the specification was checked using the static calibration data the noise floor of y axis acceleration was found somewhat higher than that of the x axis and z axis but still generally lower than the specification value fig 6 lower curves the total root mean square noise was also found within the expected limits in the operational sensor temperature range t s 25 5 c table 1 to estimate the motion influence on the noise performance of the accelerometer we used the signals of the sensor rotating at a constant rate but with different horizontal orbit radius i e different constant centrifugal acceleration along z axis fig 6 upper curves the peaks at f 2 2 hz and some multiple frequencies correspond to the sensor rotation frequency due to imperfect orbit alignment in the horizontal plane and a small portion of oscillating gravitational acceleration projection outside the peaks the spectrum slightly increases towards zero frequency with a certain increase of the low frequency level at higher centrifugal accelerations on the one hand this result can be interpreted as a motion impact on the accelerometer noise floor on the other hand we made this check record with a simple gear reduction motor thus some rotation noise could still contaminate this estimated non static noise floor of the sensor moreover the real accelerations observed in the sea are normally less than g 9 8 m s 2 the higher values mean wave breaking thus in the worst case if the rotation noise is misread as an intrinsic noise the non static noise floor upper level is no more than 1 0 3 m 2 s 3 another important noise related parameter of the sensor is the minimal detectable wave height determined by the noise floor and the accelerometer quantization error δ a 6 1 0 4 m s 2 the inverse scale factor table 1 since the wave height ζ is dependent on both acceleration and wave frequency ζ a 2 π f 2 the minimal detectable wave height cannot be directly evaluated without knowledge of the wave spectrum thus we estimate the noise equivalent significant wave height swh from the noise spectrum truncated below the peak frequency f p the static noise spectrum is used for this estimate because the weakest signals are considered the wave height quantization error was estimated for the monochromatic wave of the corresponding frequency δ ζ δ a 2 π f p 2 as a measure for f p we choose two characteristic values 0 2 hz typical value for the present experiment data black sea and 0 05 hz typical ocean swell frequency all estimated values table 2 are of the order of millimeters and can be ignored because typical real peak wave heights are measured by decimeters and meters 6 results 6 1 check ratio we start the buoy performance demonstration with presentation of the so called check ratio η which is the ratio between the wave amplitudes estimated from buoy tilts and vertical acceleration longuet higgins et al 1961 krogstad et al 1999 datawell 2019 also known as wave ellipticity the ratio between horizontal and vertical orbital motion amplitudes η g c x x c y y c a a for deep water waves the approximation applicable for our data the check ratio should be 1 the deviation of η from 1 can be treated as a signal corruption due to non ideal wave following check ratios of all available records have rather similar behavior fig 7a a 1 05 1 1 leveled plateau from wave spectral peak frequency f p 0 2 0 3 hz to 5 f p and a local maximum at the frequency f b 2 5 hz the observed check ratio can be qualitatively reproduced by the following simple response model for the one dimensional linear wave z a cos k x we assume that the buoy simply flattens linearly interpolates the water surface beneath it fig 7b the true wave elevation and slope at some point x 0 are ζ a cos k x 0 and ζ x a k sin k x 0 if the buoy is located at the point x 0 it measures somewhat different elevation and slope ζ ζ 1 ζ 2 2 a cos k r cos k x 0 ζ x ζ 2 ζ 1 2 r a sin k r sin k x 0 r where r is the buoy radius thus the buoy amplitude response functions for the elevation the same as acceleration and slope are cos k r and sinc k r sin k r k r respectively with accounting for shallow wave orbit stretching the tanh k h factor the check ratio η for this model reads 18 η 1 tanh k h sinc 2 k r cos 2 k r the model predicts a peak of the check ratio at k r π 2 corresponding to f b 2 36 hz actual buoy float radius is r 7 cm fig 7a red line somewhat less than the observed frequency f b 2 5 hz at this special point the buoy geometric cut off frequency f b hereinafter the model η jumps to infinity while the observed η does not physically this means that when the buoy size equals the half wavelength the sensor stops to respond to the true elevation because the wave profile is interpolated to zero adding noise removes the singularity in the model 19 η 1 tanh k h sinc 2 k r n 1 cos 2 k r n 2 where n 1 and n 2 are the noise to signal ratios for slope and acceleration data respectively for simplicity we ignored the frequency dependence of the noise to signal ratios and decreased the buoy radius to account for the two dimensionality of the buoy in the one dimension model the model qualitatively fits the data fig 7a blue line with n 1 0 35 n 2 0 40 and buoy radius decreased by 20 to r 5 5 cm at the sub peak frequencies the model does not match observations suggesting that its rapid growth towards zero frequency is not caused by the shallow water effects below the peak the linear wave signals tend to zero and the check ratio is totally governed by the tilt and acceleration noise levels this noise is not primarily the intrinsic sensor noise but rather a low frequency motion noise or a result of non linear harmonics krogstad and trulsen 2010 as it will be discussed further 6 2 particular wave situations directional and omnidirectional wave characteristics typical for each of the three experiment days estimated from buoy and reference wage gauge measurements are shown in the figs 8 9 10 from the wave gauge observations the first day jun 03 can be characterized by a pure wind sea generated by west wind fig 8 the wave spectral density was close to the f 4 sloped spectrum the toba s 1973 parameterization is shown for the comparison on the second day jun 04 there was a rather strong swell opposite to the wind blowing from the east fig 9 next day jun 05 the wind has been turned around again while the swell well separated from the wind peak f p 0 8 hz but much weaker than the day before was coming from the upwind to cross wind direction fig 10 a comparison of the directional spreading functions figs 8 10a b reveals a slight but systematic difference between the wave gauge and buoy data the wave gauge fails to estimate directional wave parameters at f 1 2 hz because the wave gauge has a lower cut off frequency corresponding to twice the base length 50 cm f w 1 2 hz the same mismatch is also seen in the wave directions figs 8 10c and directional widths figs 8 10d that are generally similar below f w but at higher frequencies the wave gauge θ becomes noisy while σ grows faster the 1d spectra figs 8 10e are also consistent for f p f 1 hz while at higher frequencies the wave gauge spectral density is somewhat higher this can be explained by the doppler shift of the high frequency components riding on the longer waves the drifting buoy lagrangian sensor is free of this effect while the wave gauge eulerian sensor is not this is highlighted by the measurements on 05 jun fig 10e in this case the doppler shift from the rather weak long wave swell is small hence the short wave part of the buoy and wave gauge spectra are more consistent numerical simulations of this effect korotkevich 2008 indicate an increase of the spectrum at f 5 f p for typical 0 1 peak wave steepness similarly to our observations in the sub peak frequency range f f p the buoy 1d spectra are unrealistically high as confirmed by the wave gauge measurements buoy wave direction θ also differs from the wave gauge measurements at these frequencies 6 3 overall comparison admitting the inability of the buoy to reproduce the sub peak part of the wave spectrum we correct the buoy data for the further estimates by zeroing the spectra below their first local minima dashed lines in figs 8 10e notice the similar high pass filtering is a common practice for the accelerometer based buoys datawell 2019 with this correction applied the buoy 2d spectra generally agree with wave gauge data at the frequencies reliable for validation f f w fig 11a wave direction and spectral width plotted against frequency are consistent but also demonstrate increased scatter at high frequencies fig 11b c yet the basic integral wave characteristics are vastly determined by the spectral peak thus the significant wave height h s 4 s f d f wave peak period t p 1 f p and peak wave directions θ 1 f p from both wave gauge and buoy data are consistent within the 95 confidence interval due to sampling variability fig 12 there is a 7 bias in the estimated peak wave directions that can be explained first by the quite complex wave conditions for records 10 11 12 on 05 jun young wind waves on the background of several misaligned swell systems fig 10 second a possible magnetic field distortion at the experiment site due to the large amount of metal platform material the issues of low frequency noise and high frequency sensitivity are discussed in more detail in the next section 7 discussion in general comparing the buoy and reference wave gauge measurements we can note that the buoy performance is similar to that of the wave gauge for the most energetic waves resolved by the wave gauge f p f f w thus the basic wave parameters are well reproduced the high frequency waves f w f f b are resolved better by the buoy than by the wave gauge with the upper frequency limit determined by the buoy cut off frequency f b 2 5 hz in the sub peak frequency range f f p there is a noise distorting the real wave signal but this is a common problem of any accelerometer based sensor ashton and johanning 2015 amplified by the f 4 factor relating elevation and acceleration spectra the calibration test records see section 5 suggest that the nature of this noise is not sensor intrinsic the static specification noise is less than 10 5 m 2 s 3 as proved by the static test records this is 2 to 4 orders weaker than the wave signal below f p fig 13a color and black lines respectively the upper level of the non static noise level is 1 0 3 m 2 s 3 but expected to be lower in more rigorous laboratory conditions see discussion in section 5 4 even so this level is much less than the low frequency noise observed in the sea the non intrinsic origin of this noise is also understood from a clear dependence of its level on the wind speed that is seen in fig 13a based on the ocean and wave tank measurements by a 1 5 m discus hulled buoy stewart 1977 suggested that the low frequency noise arises due to the non linear response of the buoy on the high frequency motions this effect is inherent in various non linear systems e g a microwave radar transfer function yurovsky et al 2018 including the self nonlinearity of the sea surface as well krogstad and trulsen 2010 thus provided the short wave roughness is wind dependent the low frequency spectral density reflects the variance of high frequency components the nonlinearity of the buoy response arises due to the imperfect surface following and depends on the sensor position relative to the hull metacenter they both can be minimized by a more sophisticated signal processing and advanced hull design but for the present study we stop at this point because the low frequency noise floor of our buoy is comparable to the similar devices e g 0 023 m 2 s 3 level reported by veras guimarães et al 2018 for the skib buoy at 6 m s wind speed this result also suggests that today buoy performance generally depends on the hull design and data processing algorithm rather than on the signal to noise ratio of the sensor thus conventional low cost mems based imus can be effectively used for ocean wave measurements the high frequency limit of the buoy operating frequency range is determined by its hull size in line with stewart s 1977 results the attenuation starts to be visible fig 13a at the frequency corresponding to twice the hull diameter f b 2 5 hz above this frequency the spectrum is significantly damped as it is seen from the comparison with theoretical acceleration spectra compare fig 13a and b simulated using the kudryavtsev et al 1999 semi empirical model trained on the optical measurements yurovskaya et al 2013 in simulations the peak frequency was fixed at 0 2 hz by varying the wave age with wind speed an interesting feature is that the spectrum is not damped to the noise floor for f 40 hz and the buoy is yet sensitive to the wave components shorter than the hull size a well known feature of the short wave surface spectrum is its wind dependent tail though been attenuated this tail is still reproduced by the buoy measurements with similar variability at the given wind speed range this is proved by the frequency dependence of the spectrum wind exponent α f s f u s 0 f u α f the slope of spectrum wind dependence in a log log scale α is estimated from the linear regression model ln s s 0 α ln u where u is the wind speed the wind exponent is not sensitive to the absolute level of the spectrum nor the attenuation factor imposed by the buoy response function and thus can be directly compared to the theory fig 13c at frequencies from peak to f 4 hz the measurements and the model show similar trends but differ each other in magnitude reflecting the fact that the dominating waves at the experiment site and time are not purely wind driven as suggested by the model at high frequencies f 4 hz the measurements and the model demonstrate a surprising agreement up to f 8 hz 3 cm wavelength at even higher frequencies f 8 hz the measured wind exponent saturates at about 1 5 level while the model one keeps increasing despite the detected discrepancies the overall consistency is encouraging in the respect that the kudryavtsev et al 1999 model was developed based on completely different data apparently this remarkable short wave sensitivity is possible thanks to a good performance of the mems based imu at high frequencies due to their ultra small size at these frequencies the sensor of the buoy is sensitive to the wave motions itself as well as to the ambient acoustic noise generated by surface waves farrell and munk 2008 the transfer function at these frequencies including resonant hull effects acoustic sensitivity etc is complex but a proper calibration can help to extend the operating range of mems based buoy to the scales even shorter than the hull diameter this falls out the scope of the present study but opens a perspective to develop a new contact sensor for the short wave spectrum investigation an important subject generally attainable by remote sensing techniques only 8 conclusion we present a wave buoy based on one of the low cost capacitive silicon based micro electro mechanical system mems sensors mpu9250 invensense inc 2016 that now are widely used in the entertainment industry and wearable electronics the buoy prototype is tested in a field experiment at the black sea research platform under 1 to 15 m s wind speed and up to 40 m dominant wavelengths the experiment besides standard meteorological observations included the six wire wave gauge measurements for reference directional surface spectra estimates the imu raw signals tri axis acceleration rotation rate and magnetic field are stored on a microsd flash memory card and processed after the measurements the buoy design is intentionally simplified to reduce its hull size and thus increase the short wave sensitivity the measurements are performed in a drifting regime to avoid the impact of holding line and doppler shifts of long waves the classical longuet higgins et al 1961 method is used to compute directional spectra the georeferenced buoy tilts and vertical acceleration are derived to the first order in slope from the strapped down accelerometer magnetometer and gyroscope measurements in this small wave slope approximation the buoy and reference wave gauge measurements broadly agree in the frequency range of most energetic waves thus the standard wave parameters significant wave height wave peak period and direction are well reproduced by the first order buoy estimates the directional spectra high frequency cut off of the buoy is higher than that of the wave gauge for the 14 cm discus buoy float this cut off corresponds to wavelength twice the buoy diameter f b 2 5 hz in line with stewart s 1977 findings at the same time the sub peak spectrum is distorted by the wind dependent low frequency noise arising due to the non linear hull response to the surface waves a common problem of accelerometer based buoy measurements rather than sensor noise issue these results demonstrate that low cost mems based sensors can be used for surface wave measurements at the cost of autonomy the final buoy size can be significantly reduced providing wider surface wave bandwidth as compared to the traditional buoys in our case the cut off frequency is at least 2 5 times higher compared to the smallest 40 cm diameter buoys available on the market this can be useful in short term field campaigns when instrument deployment recovery time is crucial and or knowledge of short waves is necessary the economy effect can be significant if a fleet of numerous buoys is required an interesting feature of the developed buoy is its high frequency sensitivity beyond the geometric cut off frequency the acceleration signal is not attenuated to the static noise but up to a scale factor follows the theory kudryavtsev et al 1999 predicting the wind dependent short wave spectrum tail the plausible mechanism of this short wave sensitivity apart from the high frequency surface motion is acoustic ambient noise generated by short waves farrell and munk 2008 this question needs further investigation which may help to extend the buoy operating frequency range credit authorship contribution statement yury yu yurovsky conceptualization data curation formal analysis methodology software validation visualization writing original draft vladimir a dulov project administration methodology supervision writing review editing declaration of competing interest the authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper acknowledgments the buoy prototype development and field experiments were funded by the fsbsi frc mhi ras state order russia goszadanie no 0827 2019 0004 the data analysis performed in this work was funded by the russian science foundation under grant no 17 77 30019 and rshu state order russia goszadanie no 0763 2020 0005 the authors are grateful to vladimir kudryavtsev for providing the source code of the short wave spectrum model 
